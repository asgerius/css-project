[{"tags": ["haskell", "vector"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1551909282, "post_id": 55032707, "comment_id": 96818101, "body": "You can&#39;t! Unboxed values have to be fixed size"}, {"owner": {"reputation": 203, "user_id": 827415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9c5b6a24d960070ad2cb62b55146ca05?s=128&d=identicon&r=PG", "display_name": "Invoke", "link": "https://stackoverflow.com/users/827415/invoke"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1551909578, "post_id": 55032707, "comment_id": 96818224, "body": "I updated the post making it explicit the desired type I would like to have, in this case <code>Vector (Vector Int)</code>. That would mean, Int is unboxed and the size is known."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1551909635, "post_id": 55032707, "comment_id": 96818243, "body": "So the outer vector will be a boxed vector. <code>V.Vector (VU.Vector Int)</code>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1551911204, "post_id": 55032707, "comment_id": 96818778, "body": "While the size of <code>Int</code> is known, the size of <code>VU.Vector Int</code> is not because the number of Int elements in the vector is dynamic.  You could have a static length vector.  You could use the vector from <code>fixed-vector</code> for fixed size unboxed vectors."}, {"owner": {"reputation": 203, "user_id": 827415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9c5b6a24d960070ad2cb62b55146ca05?s=128&d=identicon&r=PG", "display_name": "Invoke", "link": "https://stackoverflow.com/users/827415/invoke"}, "edited": false, "score": 0, "creation_date": 1551919790, "post_id": 55032707, "comment_id": 96821273, "body": "I will check the library <code>fixed-vector</code> and see if that fits to the action I am trying to perform."}], "owner": {"reputation": 203, "user_id": 827415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9c5b6a24d960070ad2cb62b55146ca05?s=128&d=identicon&r=PG", "display_name": "Invoke", "link": "https://stackoverflow.com/users/827415/invoke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1551920398, "creation_date": 1551908916, "last_edit_date": 1551920398, "question_id": 55032707, "link": "https://stackoverflow.com/questions/55032707/haskell-from-vectors-to-unboxed-vectors", "title": "Haskell: From Vectors to Unboxed Vectors", "body": "<p>Today I was working in transforming some code that used <code>Data.Vector</code> to a more \"memory efficient\" <code>Data.Vector.Unboxed</code> when I suddenly realized a missing instance.</p>\n\n<p>If I do this in <code>ghci</code>:</p>\n\n<pre><code>import qualified Data.Vector as V\nV.singleton V.empty :: V.Vector (V.Vector Int)\n[[]]\n</code></pre>\n\n<p>That is correct, Vector was printed correctly. However, if I try the same with <code>Vector.Unboxed</code>:</p>\n\n<pre><code>import qualified Data.Vector.Unboxed as VU\n:set -XFlexibleContexts\nVU.singleton VU.empty :: VU.Vector (VU.Vector Int)\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>&lt;interactive&gt;:10:1: error:\n    \u2022 No instance for (VU.Unbox (VU.Vector Int))\n        arising from a use of \u2018VU.singleton\u2019\n    \u2022 In the expression:\n          VU.singleton VU.empty :: VU.Vector (VU.Vector Int)\n      In an equation for \u2018it\u2019:\n          it = VU.singleton VU.empty :: VU.Vector (VU.Vector Int)\n</code></pre>\n\n<p>Which drives me to the question, how do I correctly implement an unboxed vector of vectors?</p>\n\n<hr>\n\n<hr>\n\n<p>Side note:</p>\n\n<p>The objective I was trying to reach was a generic <code>splitChunks</code> function, with the basic premise of splitting a vector into sub vectors of fixed size, a very primitive implementation using common vectors was as follows:</p>\n\n<pre><code>-- With an arbitrary vector and a positive integer of known size it will create a vector that has splitted the original into sections. Example:\n-- vec = [1,2,3,4,5,6,7,8,9,10]\n-- size = 4\n-- result = [[1,2,3,4],[5,6,7,8],[9,10]]\nsplitChunks :: V.Vector p -&gt; Int -&gt; V.Vector (V.Vector p)\nsplitChunks vec size\n    | size &lt;= 0 = V.empty\n    | otherwise = fst $ until condition opr (V.empty, vec)\n    where condition = V.null . snd\n          opr (x, y) = let (l, r) = V.splitAt size y in (V.snoc x l, r)\n</code></pre>\n\n<p>Then, when I tried to move from Vector to Vector.Unboxed, I got the same problem as described before.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551904822, "post_id": 55031665, "comment_id": 96816199, "body": "That&#39;s just the type signature of a function. If you provide more context and explain exactly which part you don&#39;t understand, you might get some helpful answers, but as it is we don&#39;t really know what the question is."}, {"owner": {"reputation": 27, "user_id": 11071950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c2d14cda72662327a3981d072e761de?s=128&d=identicon&r=PG&f=1", "display_name": "karim doe", "link": "https://stackoverflow.com/users/11071950/karim-doe"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551905171, "post_id": 55031665, "comment_id": 96816350, "body": "its supposed to merge 2 sorted list into a sorted list"}, {"owner": {"reputation": 27, "user_id": 11071950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c2d14cda72662327a3981d072e761de?s=128&d=identicon&r=PG&f=1", "display_name": "karim doe", "link": "https://stackoverflow.com/users/11071950/karim-doe"}, "edited": false, "score": 1, "creation_date": 1551905538, "post_id": 55031665, "comment_id": 96816486, "body": "@Micheal litchard so sad to hear you downvoted me."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 4, "creation_date": 1551905591, "post_id": 55031665, "comment_id": 96816512, "body": "I&#39;m not downvoting you. I&#39;m downvoting a bad question. This site is about good questions with good answers. It&#39;s not about you."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1551906608, "creation_date": 1551906608, "answer_id": 55032189, "question_id": 55031665, "link": "https://stackoverflow.com/questions/55031665/what-does-this-mean-in-haskell-homerge-ord-b-a-b-a-a-a/55032189#55032189", "title": "what does this mean in Haskell homerge :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a] -&gt; [a]", "body": "<p><code>homerge</code> takes 3 arguments: a function of type <code>a -&gt; b</code> and two lists of type <code>[a]</code>. The return value is another list of type <code>[a]</code>.</p>\n\n<p>The <code>Ord</code> constraint means that the return type of the first argument must be a type with an <code>Ord</code> instance, so that the values can be compared with <code>&lt;</code>, <code>&gt;</code>, etc.</p>\n\n<p>An <code>Ord</code> constraint is <em>not</em> required for <code>a</code>, so this function lets you merge lists of values that aren't otherwise immediately comparable, for example complex  numbers. Two complex numbers <code>a + bi</code> and <code>c + di</code> aren't directly comparable, but you <em>can</em> order them by their real parts (checking <code>a &lt; c</code>) or their imaginary parts (checking <code>b &lt; d</code>).</p>\n\n<pre><code>homerge realPart [2 :+ 5] [3 :+ 4]  -- [2 :+ 5, 3 :+ 4]\nhomerge imagPart [2 :+ 5] [3 :+ 4]  -- [3 :+ 4, 2 :+ 5]\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11071950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c2d14cda72662327a3981d072e761de?s=128&d=identicon&r=PG&f=1", "display_name": "karim doe", "link": "https://stackoverflow.com/users/11071950/karim-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551916383, "creation_date": 1551904123, "last_edit_date": 1551916383, "question_id": 55031665, "link": "https://stackoverflow.com/questions/55031665/what-does-this-mean-in-haskell-homerge-ord-b-a-b-a-a-a", "title": "what does this mean in Haskell homerge :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a] -&gt; [a]", "body": "<p>im learning Haskell but I'm having a hard time trying to break down the meaning of </p>\n\n<pre><code>homerge :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>do we take a tuple and list?\nim confused please help me out thanks</p>\n\n<p>so  the homerge  merges two sorted lists into a sorted list.\nbut I don't understand the</p>\n\n<pre><code>homerge :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>\"Implement the higher order insertion sort algorithm hoMergeSort which is similar to merge sort except that an element x is placed before an element y if <code>fun x &lt; fun y where fun :: a -&gt; b</code> is a function taken as input by higher order merge sort. In other words, the result of evaluating hoMergeSort fun xs should be a list [y1,y2,..., yn]\"\nthis is the whole question just to provide context</p>\n"}, {"tags": ["parsing", "haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551904727, "post_id": 55031613, "comment_id": 96816154, "body": "My own Haskell experience/knowledge isn&#39;t enough to answer your question, but I must correct you on one point: monads in general have nothing to do with providing any kind of &quot;safety net&quot;. It&#39;s true that some monads have a notion of failure &quot;built-in&quot; (notably <code>Maybe</code> and <code>Either e</code>), but monads in general do not."}, {"owner": {"reputation": 163, "user_id": 4176054, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b3dea5d8110fa3b72db315ea5b9a03e?s=128&d=identicon&r=PG&f=1", "display_name": "Sifu", "link": "https://stackoverflow.com/users/4176054/sifu"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551906314, "post_id": 55031613, "comment_id": 96816821, "body": "So it actually depends on the implementation then? I thought the whole idea was to be able to string together many computations without worrying about edge cases, wouldn&#39;t that require fail safe for monads?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1551907998, "post_id": 55031613, "comment_id": 96817529, "body": "I&#39;m surprised that your <code>Monad</code> instance doesn&#39;t give a syntax error. As far as I know you can&#39;t pattern match on a tuple by simply leaving out the first argument. As for the question itself, it would be tricky to answer without knowing how <code>Parser</code> is defined."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1551908998, "post_id": 55031613, "comment_id": 96817973, "body": "You seem to be (ab)using single-element lists as a replacement for <code>Maybe</code>. Why not just use <code>Maybe</code> directly?"}, {"owner": {"reputation": 163, "user_id": 4176054, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b3dea5d8110fa3b72db315ea5b9a03e?s=128&d=identicon&r=PG&f=1", "display_name": "Sifu", "link": "https://stackoverflow.com/users/4176054/sifu"}, "edited": false, "score": 0, "creation_date": 1551910592, "post_id": 55031613, "comment_id": 96818587, "body": "Sadly I&#39;m not free to change the definition so I have to work around it."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 2, "last_activity_date": 1551909371, "creation_date": 1551909371, "answer_id": 55032793, "question_id": 55031613, "link": "https://stackoverflow.com/questions/55031613/making-a-monad-succeed-with-failure-in-haskell/55032793#55032793", "title": "Making a monad succeed with failure in haskell", "body": "<p>Here's how you could implement <code>notFollowedBy</code> in your parser:</p>\n\n<pre><code>notFollowedBy :: Parser b a -&gt; Parser b ()\nnotFollowedBy p = P (\\inp -&gt; case parse p inp of\n                                [] -&gt; [((), inp)]\n                                _  -&gt; [])\n</code></pre>\n\n<p>This definition relies on being able to access the internals of <code>Parser</code> (specifically the <code>P</code> constructor).</p>\n\n<p>Alternatively you can do the following:</p>\n\n<pre><code>notFollowedBy p = do\n    inp &lt;- getState\n    case parse p inp of\n        [] -&gt; return ()\n        _  -&gt; fail \"sub-parse succeeded\"\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 4176054, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b3dea5d8110fa3b72db315ea5b9a03e?s=128&d=identicon&r=PG&f=1", "display_name": "Sifu", "link": "https://stackoverflow.com/users/4176054/sifu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 55032793, "answer_count": 1, "score": 0, "last_activity_date": 1551920396, "creation_date": 1551903893, "last_edit_date": 1551920396, "question_id": 55031613, "link": "https://stackoverflow.com/questions/55031613/making-a-monad-succeed-with-failure-in-haskell", "title": "Making a monad succeed with failure in haskell", "body": "<p>I have a parser monad that looks like this:</p>\n\n<pre><code>data Parser b a = P(b -&gt; [(a, b)])\ninstance Monad (Parser p) where\n  p &gt;&gt;= f = P $ \\inp -&gt; case parse p inp of\n                           [] -&gt; []\n                           [(v, inp')] -&gt; parse (f v) inp'\n</code></pre>\n\n<p>I also have the following functions/parsers for getting and setting the state of the parser:</p>\n\n<pre><code>getState :: Parser b b\ngetState = P(\\inp -&gt; [(inp, inp)])\n\nsetState b -&gt; Parser b ()\nsetState s = P(\\inp -&gt; [(), s)]\n</code></pre>\n\n<p>Additionally, I have a Parser function that looks ahead to see if there is more to parse without consuming anything:</p>\n\n<pre><code>lookahead :: Parser b a -&gt; Parser b ()\nlookahead p = do\n                state &lt;- getState\n                result &lt;- p\n                setState state\n                return result\n</code></pre>\n\n<p>Now, suppose I want to write a Parser function that succeeds if <em>another parser fails</em>: It should fail if there are more to consume and succeed if there isn't. </p>\n\n<pre><code>notFollowedBy :: Parser b a -&gt; Parser b ()\nnotFollowedBy p = do --statements\n</code></pre>\n\n<p>The intended usage is to disallow illegal parsers to continue, according to some grammar.</p>\n\n<p>This has me kind of stumped: To my (limited) understanding of Monads, they provide you with a  safety net in case any of the evaluations fails. Is there a (good and recommended) way to make this function do the opposite?</p>\n"}, {"tags": ["haskell", "cookbook", "monoids", "semigroup"], "comments": [{"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1551894924, "post_id": 55029296, "comment_id": 96811448, "body": "If I make <code>Option</code> an instance of Semigroup without explicit implementation it compiles with warnings. So first part answered, new question: can I avoid making <code>Option</code> an instance of <code>Semigroup</code> or at least make the process a little easier? Here the lack of profound knowledge rears its head."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1551895047, "post_id": 55029296, "comment_id": 96811510, "body": "No, you can&#39;t. You have to give an instance of <code>Semigroup</code>"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1551895141, "post_id": 55029296, "comment_id": 96811552, "body": "And also, you don&#39;t need to implement <code>mappend</code> now, it&#39;s been moved to <code>Semigroup</code>, which is why it&#39;s required. The book was probably written before the move (which is as of GHC 8.4)"}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 444, "user_id": 1738581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febb5b5c9b48bfc151565fb2571fd529?s=128&d=identicon&r=PG", "display_name": "tgrez", "link": "https://stackoverflow.com/users/1738581/tgrez"}, "edited": false, "score": 0, "creation_date": 1551896021, "post_id": 55029296, "comment_id": 96811976, "body": "@tgrez: if I implement <code>mempty</code> in the Monoid instance and move <code>mappend</code> to the <code>Semigroup</code> instance and change it to <code>&lt;&gt;</code> it compiles and works fine, but I don&#39;t get the logic of it anymore. Shouldn&#39;t <code>mempty</code> have a <code>Semigroup</code> equivalent as well then?"}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1551896051, "post_id": 55029296, "comment_id": 96811987, "body": "@FyodorSoikin: You pointed out the direction, so thanks for that."}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 1, "creation_date": 1551896473, "post_id": 55029296, "comment_id": 96812167, "body": "<code>Monoid</code> has <code>mempty</code>, and not <code>Semigroup</code>, as <code>Monoid</code> is more restrictive than <code>Semigroup</code>."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1551897877, "post_id": 55029296, "comment_id": 96812820, "body": "@Bob Dalgeleish: that I found out, but how to make the instance, if my type needs to rely on two different typeclasses that are also related in terms of super and sub classes...."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1551898196, "post_id": 55029296, "comment_id": 96812933, "body": "Whatever books you are reading were probably written before <code>Semigroup</code> became a superclass of <code>Monoid</code>. It used to be that <code>Monoid</code> defined both <code>mempty</code> and <code>mappend</code> by itself. Now, <code>Semigroup</code> provides <code>&lt;&gt;</code> (aka <code>mappend</code>), and any class that has a <code>Monoid</code> instance must already have a <code>Semigroup</code> instance. Further, you can still define <code>mappend</code> if you want for backwards compatibility, but its default value <code>mappend = (&lt;&gt;)</code> is sufficient."}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "closed_date": 1551898922, "answer_count": 0, "score": 0, "last_activity_date": 1551898558, "creation_date": 1551894518, "question_id": 55029296, "link": "https://stackoverflow.com/questions/55029296/haskell-cookbook-monoid-instance", "closed_reason": "Duplicate", "title": "Haskell Cookbook, Monoid instance", "body": "<p>Repeating the books until I am sure to get it right. Got this in the Haskell Cookbook: </p>\n\n<pre><code>data Option = Option { boolOption :: Bool, selections :: [String] }\n            deriving Show\ninstance Monoid Option where\n        mempty = Option False []\n       (Option b1 s1) `mappend` (Option b2 s2) = Option (b1 || b2) (s1 ++ s2)\n</code></pre>\n\n<p>Got this from compiler: </p>\n\n<pre><code>error:\n    \u2022 No instance for (Semigroup Option)\n        arising from the superclasses of an instance declaration\n    \u2022 In the instance declaration for \u2018Monoid Option\u2019\n    |\n116 | instance Monoid Option where \n    |          ^^^^^^^^^^^^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>Is the book wrong or outdated here? Does <code>Option</code> also need to be an instance of <code>Semigroup</code>? </p>\n"}, {"tags": ["parsing", "haskell", "input"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1551891674, "post_id": 55028224, "comment_id": 96809483, "body": "<code>deleteSecond a [] = newList</code> what is <code>newList</code> here?"}, {"owner": {"reputation": 49, "user_id": 8525527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2aba394be7b6fe51b0ca80e7db6c8f?s=128&d=identicon&r=PG&f=1", "display_name": "viga11", "link": "https://stackoverflow.com/users/8525527/viga11"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1551891984, "post_id": 55028224, "comment_id": 96809689, "body": "A new new list that should be the answer, I tried to defined it with the <code>(let newList = x:[])</code> statement below"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551891990, "post_id": 55028224, "comment_id": 96809699, "body": "<code>let</code> without a corresponding <code>in</code> is invalid outside of a <code>do</code> expression."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1551893788, "post_id": 55028224, "comment_id": 96810837, "body": "@viga11 Aaaahhh! That sounds like you&#39;re trying to manage state! No no, think functionally!"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8525527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2aba394be7b6fe51b0ca80e7db6c8f?s=128&d=identicon&r=PG&f=1", "display_name": "viga11", "link": "https://stackoverflow.com/users/8525527/viga11"}, "edited": false, "score": 0, "creation_date": 1551891608, "post_id": 55028317, "comment_id": 96809443, "body": "I was trying to make a new list and then add the element <code>x</code> of the original to that new list I was creating."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 6, "last_activity_date": 1551891188, "creation_date": 1551891188, "answer_id": 55028317, "question_id": 55028224, "link": "https://stackoverflow.com/questions/55028224/tareahaskell-hs3669-error-parse-error-on-input/55028317#55028317", "title": "TareaHaskell.hs:36:69: error: parse error on input &#39;)&#39;", "body": "<p>The problem is that the parser isn't expecting the <code>)</code> in this code:</p>\n\n<pre><code>(let newList = x:[])\n</code></pre>\n\n<p>because it's invalid in Haskell to have a <code>let</code> statement that isn't followed by <code>in</code>. (With the exception of inside a <code>do</code> block.)</p>\n\n<p>It's really not clear to me what your actual intention is, but all <code>let</code> is for is to give a more complex expression a temporary name inside a block of code. A <code>let</code> statement without an accompanying <code>in</code> doesn't make any sense, and is causing your parse error here.</p>\n"}, {"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 4, "last_activity_date": 1551893801, "last_edit_date": 1551893801, "creation_date": 1551891544, "answer_id": 55028432, "question_id": 55028224, "link": "https://stackoverflow.com/questions/55028224/tareahaskell-hs3669-error-parse-error-on-input/55028432#55028432", "title": "TareaHaskell.hs:36:69: error: parse error on input &#39;)&#39;", "body": "<p>Your code is a little over complicated. If you simplified it'd be more clear where the problem is, but</p>\n\n<pre><code>let newList = x:[]\n</code></pre>\n\n<p>is only valid if the next symbol is <code>in</code>. The parser is complaining that you're trying to parenthesize it for no reason. A let..in statement is just a way of temporarily binding a name to a value for the purpose of the expression.</p>\n\n<pre><code>let var = value in expr\n</code></pre>\n\n<hr>\n\n<p>As far as the problem itself: this is pretty easy to solve with explicit recursion.</p>\n\n<pre><code>removeSecond :: (Eq a) -&gt; [a] -&gt; [a]\nremoveSecond = go False\n  where go _     _      []     = []\n        go True  needle (x:xs) | needle == x = xs\n                               | otherwise   = x : go True needle xs\n        go False needle (x:xs) | needle == x = x : go True needle xs\n                               | otherwise   = x : go False needle xs\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8525527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2aba394be7b6fe51b0ca80e7db6c8f?s=128&d=identicon&r=PG&f=1", "display_name": "viga11", "link": "https://stackoverflow.com/users/8525527/viga11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1551929698, "creation_date": 1551890868, "last_edit_date": 1551929698, "question_id": 55028224, "link": "https://stackoverflow.com/questions/55028224/tareahaskell-hs3669-error-parse-error-on-input", "title": "TareaHaskell.hs:36:69: error: parse error on input &#39;)&#39;", "body": "<p>This is my  first time trying Haskell. I'm trying to make a function that takes an element and a list and removes the second appearance of the item. For example, if the element is <code>2</code> and the list is <code>[2,3,4,2,5,2]</code> the result would be <code>[2, 3, 4, 5, 2]</code>.</p>\n\n<p>However I am getting this error:</p>\n\n<pre><code>TareaHaskell.hs:36:69: error: parse error on input \u2018)\u2019\n   |\n36 |     | ( (a == x) &amp;&amp; not (isItIn x newList) ) = ( (let newList = x:[]) &amp;&amp; (deleteSecond a xs) ) \n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>isItIn :: (Eq a ) =&gt; a -&gt; [a] -&gt; Bool\nisItIn a [] = False\nisItIn a (x:xs) = if a == x\n                  then True\n                  else isItIn a xs\n\ndeleteSecond :: (Eq a ) =&gt; a -&gt; ( [a] -&gt; [a] )\ndeleteSecond a [] = newList\ndeleteSecond a (x:xs)\n    | ( (a == x) &amp;&amp; not (isItIn x newList) ) = ( (let newList = x:[]) &amp;&amp; (deleteSecond a xs) )\n    | (a == x) &amp;&amp; (isItIn x newList) = (deleteSecond a xs)\n    | otherwise = let newList = x:[] &amp;&amp; deleteSecond a xs\n</code></pre>\n\n<p>I read it might be a problem with the indentation however I already tried using spaces, moving it back and forth, and it still isn't working.\nI am also using Notepad++ and Sublime to help with the indentation and nothing.</p>\n"}, {"tags": ["haskell", "purescript"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1551893745, "post_id": 55026743, "comment_id": 96810801, "body": "<a href=\"https://hackage.haskell.org/package/array-0.5.3.0/docs/Data-Array.html#v:-33-\" rel=\"nofollow noreferrer\"><code>!</code></a>?"}], "answers": [{"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 3, "last_activity_date": 1551888065, "creation_date": 1551888065, "answer_id": 55027341, "question_id": 55026743, "link": "https://stackoverflow.com/questions/55026743/get-nth-array-from-2nd-array/55027341#55027341", "title": "get nth array from 2nd array", "body": "<p>I am pretty sure you cannot define an array as <code>{[1,2,3], [4,5,6], [7,8,9]}</code>, at least if we're talking about <code>Data.Array</code>.</p>\n\n<h1>Lists</h1>\n\n<p>If you are talking about a list, then if you look on <a href=\"https://www.haskell.org/hoogle/?hoogle=%5Ba%5D%20-%3E%20int%20-%3E%20a\" rel=\"nofollow noreferrer\">Hoogle</a> for <code>[a] -&gt; int -&gt; a</code>, you'll see <code>(!!) :: [a] -&gt; Int -&gt; a</code> is the function you're looking for. If you just need the second one, you can have point free</p>\n\n<pre><code>getSecond :: [[Int]] -&gt; [Int]\ngetSecond = (!!2)\n</code></pre>\n\n<h1>Arrays</h1>\n\n<p>If you're talking about <code>Data.Array</code>, then with a similar Hoogle search you'll find there's a function for that as well: <code>(!) :: Ix i =&gt; Array i e -&gt; i -&gt; e</code></p>\n\n<p>your array should be defined as <code>Array Int (Array Int Int)</code>, and your function would be</p>\n\n<pre><code>getSecond :: Array Int (Array Int Int) -&gt; Array Int Int\ngetSecond = (!2)\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 8492733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VICGi.jpg?s=128&g=1", "display_name": "Voro", "link": "https://stackoverflow.com/users/8492733/voro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551888065, "creation_date": 1551886354, "question_id": 55026743, "link": "https://stackoverflow.com/questions/55026743/get-nth-array-from-2nd-array", "title": "get nth array from 2nd array", "body": "<p>I tried to get nth array from 2d array but I couldn't.\nFor example, I need to get second array. \n{[1,2,3], [4,5,6], [7,8,9]}</p>\n\n<pre><code>getElementIndex :: Array (Array Int) Int -&gt; Array Int\n</code></pre>\n\n<p>How should I implement this function? \nThanks in advance.</p>\n"}, {"tags": ["haskell", "gloss"], "answers": [{"comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551913943, "post_id": 55026598, "comment_id": 96819823, "body": "It seems like this only links the file with the binary, but it still needs to be installed with cabal. I am looking for a way to embed it in the binary so thats independent"}], "tags": [], "owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "is_accepted": false, "score": 3, "last_activity_date": 1551885944, "creation_date": 1551885944, "answer_id": 55026598, "question_id": 55026330, "link": "https://stackoverflow.com/questions/55026330/include-sprites-into-binary-gloss-library/55026598#55026598", "title": "Include sprites into binary -- Gloss library", "body": "<p>One approach is to use Data Files with cabal.</p>\n\n<p>The idea is that you add all data files (text, images, sprites, other binaries) you want to bundle with your application and access at runtime under the <code>Data-Files</code> header in your .cabal file.</p>\n\n<p>This will cause cabal to generate a Paths module for you, which you can access in whatever module needs it.</p>\n\n<p>More info can be found <a href=\"http://neilmitchell.blogspot.com/2008/02/adding-data-files-using-cabal.html\" rel=\"nofollow noreferrer\">here</a>!</p>\n"}, {"comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551914164, "post_id": 55028046, "comment_id": 96819897, "body": "I can&#39;t seem to understand how to use it, and the documentation is not the best. Could you please just give an example on how I&#39;d need to chance my code to get the bmp"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551914455, "post_id": 55028046, "comment_id": 96819984, "body": "Ok,looks like I need to convert the Q expr into a ByteString and then i can use <code>bitmapOfByteString</code>"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551926331, "post_id": 55028046, "comment_id": 96822724, "body": "You use something like <code>$(embedFile &quot;file.bmp&quot;)</code>. You&#39;ll need to enable the <code>TemplateHaskell</code> pragma."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 2, "last_activity_date": 1551890291, "creation_date": 1551890291, "answer_id": 55028046, "question_id": 55026330, "link": "https://stackoverflow.com/questions/55026330/include-sprites-into-binary-gloss-library/55028046#55028046", "title": "Include sprites into binary -- Gloss library", "body": "<p>You can use the file-embed package, which uses Template Haskell to embed files.</p>\n\n<p><a href=\"https://www.stackage.org/package/file-embed\" rel=\"nofollow noreferrer\">https://www.stackage.org/package/file-embed</a></p>\n"}], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 2, "accepted_answer_id": 55028046, "answer_count": 2, "score": 4, "last_activity_date": 1551890291, "creation_date": 1551885115, "question_id": 55026330, "link": "https://stackoverflow.com/questions/55026330/include-sprites-into-binary-gloss-library", "title": "Include sprites into binary -- Gloss library", "body": "<p>I am trying to make a flappy bird game in Haskell and I'd like to know if there's a way to \"compile\" the .bmp files into the binary? So I can only share the executable and don't need a folder with the sprites.</p>\n\n<p>I am using <code>gloss-1.13.0.1</code> and loading the bmp as</p>\n\n<pre><code>bg0Pic = unsafePerformIO . loadBMP $ \"bg0.bmp\"\n</code></pre>\n\n<p>I know <code>unsafePerformIO</code> is not good practice but that's not of my concern yet. Should I use a different approach so that the compiler knows I need that image or is there just no way to do that?</p>\n\n<p>Can find the whole code on <a href=\"https://github.com/lollobaldo/Haskell-Flappy-Bird/blob/master/fb.hs\" rel=\"nofollow noreferrer\">GitHub</a></p>\n"}, {"tags": ["macos", "haskell", "shared-libraries", "cabal", "dylib"], "comments": [{"owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1551946047, "post_id": 55025842, "comment_id": 96828818, "body": "I found the top answer very confusing (shared libraries are distinguished from dynamically loaded modules but both can be dynamically loaded and shared are called dylib/dynamiclib?). But it does say <code>It is not possible to link against bundles as if they were shared libraries. However, it is possible that a bundle is linked against real shared libraries; those will be loaded automatically when the bundle is loaded.</code> Can Cabal do that?"}, {"owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1551953574, "post_id": 55025842, "comment_id": 96833255, "body": "In our case, it seems like we can work around it by linking to the libs that the .so links to, so I&#39;ll close this as dupe. (I still have some unanswered questions, but now my only motivation to have them answered is curiosity.)"}], "owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1551953590, "answer_count": 0, "score": 0, "last_activity_date": 1551953640, "creation_date": 1551883720, "last_edit_date": 1551953640, "question_id": 55025842, "link": "https://stackoverflow.com/questions/55025842/haskell-cabal-possible-to-link-to-so-file-on-macos", "closed_reason": "Duplicate", "title": "Haskell/cabal: Possible to link to .so file on macos?", "body": "<p>On a mac, I've done <code>brew install freetds</code>, which gives me a file <code>libtdsodbc.so</code>. Now I try to link to that by putting the path to it in <code>extra-lib-dirs</code> in my .cabal, but I get </p>\n\n<pre><code>* Missing (or bad) C library: tdsodbc\nThis problem can usually be solved by installing the system package that\nprovides this library (you may need the \"-dev\" version). If the library is\nalready installed but in a non-standard location then you can use the flags\n--extra-include-dirs= and --extra-lib-dirs= to specify where it is.If the\nlibrary file does exist, it may contain errors that are caught by the C\ncompiler at the preprocessing stage. In this case you can re-run configure\nwith the verbosity flag -v3 to see the error messages.\n\n</code></pre>\n\n<p>Doing <code>stack build --verbose</code> shows me the command that fails was cabal configure, so I run that again with <code>-v3</code> appended, which tells me:</p>\n\n<pre><code>/usr/bin/gcc -fno-stack-protector /var/folders/bq/4xy9knvx413dwltf9c6ngvvm0000gt/T/29185-4.c -o /var/folders/bq/4xy9knvx413dwltf9c6ngvvm\n0000gt/T/29185-5 '-D__GLASGOW_HASKELL__=804' '-Ddarwin_BUILD_OS=1' '-Dx86_64_BUILD_ARCH=1' '-Ddarwin_HOST_OS=1' '-Dx86_64_HOST_ARCH=1' -\nI.stack-work/dist/x86_64-osx/Cabal-2.2.0.1/build/autogen -I. -I/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/base-4\n.11.1.0/include -I/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/integer-gmp-1.0.2.0/include -I/Users/unhammer/.stac\nk/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/include -ltdsodbc -L/Users/unhammer/src/tds/lib -L/Users/unhammer/.stack/programs/x86_64-o\nsx/ghc-8.4.3/lib/ghc-8.4.3/base-4.11.1.0 -L/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/integer-gmp-1.0.2.0 -L/Use\nrs/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/ghc-prim-0.5.2.0 -L/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/l\nib/ghc-8.4.3/rts                                                                                                   \n/usr/bin/gcc returned ExitFailure 1 with error message:\nld: can't link with bundle (MH_BUNDLE) only dylibs (MH_DYLIB) file\n'/Users/unhammer/src/tds/lib/libtdsodbc.so' for architecture x86_64                                                                     \nclang: error: linker command failed with exit code 1 (use -v to see                                                                     \ninvocation)                                                                                                                             \n/usr/bin/gcc -fno-stack-protector /var/folders/bq/4xy9knvx413dwltf9c6ngvvm0000gt/T/29185-6.c -o /var/folders/bq/4xy9knvx413dwltf9c6ngvvm\n0000gt/T/29185-7 -ltdsodbc -L/Users/unhammer/src/tds/lib -L/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/base-4.11.1.0 -L/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/integer-gmp-1.0.2.0 -L/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/ghc-prim-0.5.2.0 -L/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/rts             \n/usr/bin/gcc returned ExitFailure 254 with error message:\nld: can't link with bundle (MH_BUNDLE) only dylibs (MH_DYLIB) file\n'/Users/unhammer/src/tds/lib/libtdsodbc.so' for architecture x86_64\nclang: error: unable to execute command: Segmentation fault: 11\nclang: error: linker command failed due to signal (use -v to see invocation)\n/usr/bin/gcc -fno-stack-protector /var/folders/bq/4xy9knvx413dwltf9c6ngvvm0000gt/T/29185-8.c -o /var/folders/bq/4xy9knvx413dwltf9c6ngvvm\n0000gt/T/29185-9 -ltdsodbc -L/Users/unhammer/src/tds/lib -L/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/base-4.11.\n1.0 -L/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/integer-gmp-1.0.2.0 -L/Users/unhammer/.stack/programs/x86_64-os\nx/ghc-8.4.3/lib/ghc-8.4.3/ghc-prim-0.5.2.0 -L/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/rts\n/usr/bin/gcc returned ExitFailure 1 with error message:\nld: can't link with bundle (MH_BUNDLE) only dylibs (MH_DYLIB) file\n'/Users/unhammer/src/tds/lib/libtdsodbc.so' for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see\ninvocation)\n/usr/bin/gcc -fno-stack-protector /var/folders/bq/4xy9knvx413dwltf9c6ngvvm0000gt/T/29185-10.c -o /var/folders/bq/4xy9knvx413dwltf9c6ngvv\nm0000gt/T/29185-11 -c '-D__GLASGOW_HASKELL__=804' '-Ddarwin_BUILD_OS=1' '-Dx86_64_BUILD_ARCH=1' '-Ddarwin_HOST_OS=1' '-Dx86_64_HOST_ARCH\n=1' -I.stack-work/dist/x86_64-osx/Cabal-2.2.0.1/build/autogen -I. -I/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/b\nase-4.11.1.0/include -I/Users/unhammer/.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/integer-gmp-1.0.2.0/include -I/Users/unhammer/\n.stack/programs/x86_64-osx/ghc-8.4.3/lib/ghc-8.4.3/include                                                                              \n</code></pre>\n\n<p>Why can't <code>ld</code> link to MH_BUNDLE? Can cabal only link to <code>dylib</code>'s on mac, or do I need some special options?</p>\n\n<hr>\n\n<p>EDIT: Solved by instead linking to the dylib's that the .so links to.</p>\n"}, {"tags": ["performance", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1551882667, "post_id": 55025238, "comment_id": 96803774, "body": "Could not reproduce. <code>ghc -O2 test &amp;&amp; echo 10000 | &#47;usr&#47;bin&#47;time .&#47;test</code> says this took 11s on my several-year-old computer. How are you getting these timing numbers? What is the Java code you are comparing to?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1551883156, "post_id": 55025238, "comment_id": 96804110, "body": "(For an example of why I ask for the Java code, I&#39;d be willing to bet that you have something like <code>for(i = 2; i &lt;= n&#47;2; i++)</code> inside your <code>primeNumber</code> check -- this is <i>not</i> the same algorithm as you&#39;ve used here, which counts down instead of up! That change alone on my machine cuts the time from 11s to 3s.)"}, {"owner": {"reputation": 39, "user_id": 8126536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af00bfc1ab95ab268ec1dfe80b59637b?s=128&d=identicon&r=PG&f=1", "display_name": "jhamra", "link": "https://stackoverflow.com/users/8126536/jhamra"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551884469, "post_id": 55025238, "comment_id": 96804976, "body": "I provided the java code. I used sqrt function in java, but i couldnt apply it in haskell, however with dividing by 2 the java program still is super fast."}, {"owner": {"reputation": 39, "user_id": 8126536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af00bfc1ab95ab268ec1dfe80b59637b?s=128&d=identicon&r=PG&f=1", "display_name": "jhamra", "link": "https://stackoverflow.com/users/8126536/jhamra"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551884556, "post_id": 55025238, "comment_id": 96805034, "body": "Maybe its due to my machine? I am running the haskell code with the haskell plattformer ghci.exe and the java program with cmd."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 8126536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af00bfc1ab95ab268ec1dfe80b59637b?s=128&d=identicon&r=PG&f=1", "display_name": "jhamra", "link": "https://stackoverflow.com/users/8126536/jhamra"}, "edited": false, "score": 0, "creation_date": 1551885006, "post_id": 55026235, "comment_id": 96805344, "body": "That helped. Thanks!"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 6, "last_activity_date": 1551884797, "last_edit_date": 1592644375, "creation_date": 1551884797, "answer_id": 55026235, "question_id": 55025238, "link": "https://stackoverflow.com/questions/55025238/haskell-program-runs-very-slow/55026235#55026235", "title": "Haskell program runs very slow", "body": "<h1>Compile it!</h1>\n<p>Haskell code in GHCi is far from optimised; try to compile it into a binary with <code>ghc -o prime prime.hs</code> or even better use <code>-O2</code> optimisation. I had a script once that took 5min in GHCi but mere seconds once compiled.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 9, "last_activity_date": 1551888137, "creation_date": 1551888137, "answer_id": 55027362, "question_id": 55025238, "link": "https://stackoverflow.com/questions/55025238/haskell-program-runs-very-slow/55027362#55027362", "title": "Haskell program runs very slow", "body": "<p>When doing timing measurements, always compile; ghci is designed for a fast change-rebuild-run loop, not for speedy execution of the produced code. However, even after following this advice there is a huge timing difference between your two snippets.</p>\n\n<p>The key difference between your java and Haskell is using sqrt instead of dividing by 2. Your originals, on my machine:</p>\n\n<pre><code>% javac Test.java &amp;&amp; echo 10000 | /usr/bin/time java Test &gt;/dev/null                             \n0.21user 0.02system 0:00.13elapsed 186%CPU (0avgtext+0avgdata 38584maxresident)k\n0inputs+0outputs (0major+5823minor)pagefaults 0swaps\n% ghc -O2 test &amp;&amp; echo 10000 | /usr/bin/time ./test &gt;/dev/null\n8.85user 0.00system 0:08.87elapsed 99%CPU (0avgtext+0avgdata 4668maxresident)k\n0inputs+0outputs (0major+430minor)pagefaults 0swaps\n</code></pre>\n\n<p>So 0.2s for java, 8.9s for Haskell. After switching to using square root with the following change:</p>\n\n<pre><code>- primeNumber x = primNumberRec x (div x 2)\n+ primeNumber x = primNumberRec x (ceiling (sqrt (fromIntegral x)))\n</code></pre>\n\n<p>I get the following timing for the Haskell:</p>\n\n<pre><code>% ghc -O2 test &amp;&amp; echo 10000 | /usr/bin/time ./test &gt;/dev/null\n0.07user 0.00system 0:00.07elapsed 98%CPU (0avgtext+0avgdata 4560maxresident)k\n0inputs+0outputs (0major+427minor)pagefaults 0swaps\n</code></pre>\n\n<p>Now 3x faster than the java code. (And of course there are significantly better algorithms that will make it even faster still.)</p>\n"}], "owner": {"reputation": 39, "user_id": 8126536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af00bfc1ab95ab268ec1dfe80b59637b?s=128&d=identicon&r=PG&f=1", "display_name": "jhamra", "link": "https://stackoverflow.com/users/8126536/jhamra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1551936279, "creation_date": 1551881883, "last_edit_date": 1551936279, "question_id": 55025238, "link": "https://stackoverflow.com/questions/55025238/haskell-program-runs-very-slow", "title": "Haskell program runs very slow", "body": "<p>I wrote my first program calculating prime numbers. However it runs really slow, and I can't figure out why. I wrote similar code in java and for n = 10000 the java program doesn't take any time, while the Haskell program takes like 2 minutes.</p>\n\n<pre><code>import Data.List\nmain = do\n    print \"HowManyPrimes? - OnlyInteger\"\n    inputNumber &lt;- getLine\n    let x = (read inputNumber :: Int)\n    print (firstNPrimes x)\n\n-- prime - algorithm\nprimeNumber:: Int -&gt; Bool\nprimeNumber 2 = True\nprimeNumber x = primNumberRec x (div x 2)\n\nprimNumberRec:: Int -&gt; Int -&gt; Bool\nprimNumberRec x y\n      |y == 0 = False\n      |y == 1 = True \n      |mod x y == 0 = False\n      |otherwise = primNumberRec x (y-1)\n\n-- prime numbers till n\nprimesTillN:: Int -&gt; [Int]\nprimesTillN n = 2:[ x | x &lt;- [3,5..n], primeNumber x ]\n\n\n--firstNPrimes\nfirstNPrimes:: Int -&gt; [Int]\nfirstNPrimes 0 = []\nfirstNPrimes n = 2: take (n-1) [x|x &lt;- [3,5..], primeNumber x]\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>Similar java code:</p>\n\n<pre><code>import java.util.Scanner;\npublic class PrimeNumbers{\n\nstatic Scanner scan = new Scanner(System.in);\n\npublic boolean primeAlgorithm(int x){\n    if (x &lt; 2)\n        return false;\n    return primeAlgorithm(x, (int)Math.sqrt(x));\n}\n\npublic boolean primeAlgorithm(int x, int divider){\n    if (divider == 1)\n        return true;\n    if (x%divider == 0)\n        return false;\n    return primeAlgorithm(x, divider-1);\n}\n\npublic static void main(String[] args){\n\n    PrimeNumbers p = new PrimeNumbers();\n    int howManyPrimes = scan.nextInt();\n    int number = 3;\n    while(howManyPrimes!=0){\n        if(p.primeAlgorithm(number)){\n            System.out.print(number+\" \");\n            howManyPrimes--;\n        }\n        number+=2;\n    }\n\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 4, "creation_date": 1551864628, "post_id": 55019526, "comment_id": 96792915, "body": "<code>x==y</code> is <code>True</code> because both <code>x</code> and <code>y</code> are <code>()</code>. They&#39;re not actions - that would be the case if you defined <code>x = ...</code> instead of <code>x &lt;- ...</code>, in which case you&#39;d get an error because the type <code>IO ()</code> can&#39;t be checked for equality."}, {"owner": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 0, "creation_date": 1551865825, "post_id": 55019526, "comment_id": 96793606, "body": "You could use a free monad to gain equality and testability but they have a cost: see <a href=\"https://stackoverflow.com/questions/13352205/what-are-free-monads\" title=\"what are free monads\">stackoverflow.com/questions/13352205/what-are-free-monads</a> (you can read about caveats and alternatives here: <a href=\"https://markkarpov.com/post/free-monad-considered-harmful.html\" rel=\"nofollow noreferrer\">markkarpov.com/post/free-monad-considered-harmful.html</a>)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1551879454, "post_id": 55019526, "comment_id": 96801806, "body": "<code>argsParser</code> is doing too many things. Something like <code>argsParser :: [String] -&gt; Either ArgsError [String]</code> returns either the valid strings or an error (<code>data ArgsError = NoArgs | NoFilename | TooManyArgs</code>) that some other function can act on."}], "answers": [{"comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1551886149, "post_id": 55019697, "comment_id": 96806065, "body": "Well, if you <i>could</i> compare IO actions it would be really useful. You could start with <code>print True == print foundFermatCounterExample</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1551888410, "post_id": 55019697, "comment_id": 96807506, "body": "@PaulJohnson That sounds misleading to me. I can compare Bools, but where does <code>True == foundFermatCounterExample</code> actually get me? It&#39;s not <code>(==)</code>&#39;s fault if you pass it arguments that may loop forever before producing their value."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551895256, "post_id": 55019697, "comment_id": 96811607, "body": "@DanielWagner Determining if two arbitrary <code>IO ()</code> values do the same thing in all circumstances is equivalent to solving the halting problem. If you can solve the halting problem then you can prove Fermat&#39;s last theorem by testing if a search for a counter-example will halt. You don&#39;t actually run the search, you just submit it to your halting test."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1551895804, "post_id": 55019697, "comment_id": 96811855, "body": "@PaulJohnson My point is that determining if two arbitrary <code>Bool</code> terms do the same thing in all circumstances is <i>also</i> equivalent to solving the halting problem. Since that is not a difference between <code>Bool</code> and <code>IO ()</code>, it cannot be the explanation for the difference that we have <code>instance Eq Bool</code> but not <code>instance Eq (IO ())</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551899122, "post_id": 55019697, "comment_id": 96813330, "body": "@DanielWagner My guess is that <code>Bool</code>&#39;s bottoms are uninteresting (<code>error &quot;..&quot;, undefined, fix id, ...</code>) so we like to pretend they do not really exist, hence we accept <code>instance Eq Bool</code>. Indeed, if we did not do that, no meaningful <code>Eq</code> instance could exist for any type. Instead, <code>IO ()</code> bottoms can be quite interesting, like <code>forever (print 42)</code>. Further, even if we ignored bottoms, to compare <code>x,y :: IO a</code> (assuming <code>Eq a</code>), we would need to actually run IO actions, but that would only produce an <code>IO Bool</code>, and using unsafe ops to get a <code>Bool</code> would be a very bad move."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551901426, "post_id": 55019697, "comment_id": 96814521, "body": "<code>foundFermatCounterExample</code> seems to me to be a <code>Bool</code> which might or might not be bottom and, if it is bottom, qualifies as an &quot;interesting&quot; bottom. <code>forever (print 42)</code> is not bottom at all, and is no good as an explanation either, since <code>repeat 42</code> is analogous and does not prevent us from having an <code>Eq</code> instance for lists. I do not see why I must accept a priori that comparing IO actions requires running them. (N.B. I&#39;m not saying we <i>should</i> have <code>instance Eq (IO ())</code> -- just that these arguments aren&#39;t convincing ones!)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551903614, "post_id": 55019697, "comment_id": 96815682, "body": "Interesting discussion, but we&#39;ve known for about 25 years now that <code>foundFermatCounterExample</code> will indeed be bottom. Funny how FLT still seems to be the first example people reach for of a difficult &quot;unsolved&quot; problem. Probably should be the Riemann Hypothesis now :) (My knowledge of pure mathematics research is about 10 years out of date though...)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 12, "last_activity_date": 1551871933, "last_edit_date": 1551871933, "creation_date": 1551864680, "answer_id": 55019697, "question_id": 55019526, "link": "https://stackoverflow.com/questions/55019526/how-to-check-if-an-io-is-equivalent-to-another-io/55019697#55019697", "title": "How to check if an IO () is equivalent to another IO ()?", "body": "<p>You can't compare an IO action to another one. Computability theory states that there is no way to decide whether two IO values are equivalent. Consequently, there is no instance <code>Eq (IO a)</code> in Haskell.</p>\n\n<p>At best, you can try to run the two actions, observe their effect from outside, and compare their effects -- this won't always work (e.g. if an action is an infinite loop, if the action requires user input) but it could be close enough. Implementing this check could be done by running the actions as subprocesses, redirecting their standard output/error.</p>\n\n<p>(Why do you want to compare IO actions, though? That's pretty unusual)</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1551884625, "last_edit_date": 1551884625, "creation_date": 1551882610, "answer_id": 55025473, "question_id": 55019526, "link": "https://stackoverflow.com/questions/55019526/how-to-check-if-an-io-is-equivalent-to-another-io/55025473#55025473", "title": "How to check if an IO () is equivalent to another IO ()?", "body": "<p>First, simplify  <code>argsParser</code> into something that <em>just</em> checks the number\nof args; don't do any IO yet.</p>\n\n<pre><code>import System.IO\n\ndata ArgsError = NoArgs | NoFilename | TooManyArgs\ninstance Show ArgsError where\n    show NoArgs = \"no args specified\"\n    show NoFilename = \"no file name specified\"\n    show TooManyArgs = \"too many arguments\"\n\nvalidateArgs :: [String] -&gt; Either ArgsError [String]\nvalidateArgs args | null args = Left NoArgs\n                  | length args &lt; 2 = Left NoFilename\n                  | length args &gt; 2 = Left TooManyArgs\n                  | otherwise = Right args\n\ngoAhead :: [String] -&gt; IO ()\n-- as before\n</code></pre>\n\n<p>Now you just need a <em>handler</em> for the <code>Either ArgsError [String]</code> value, which is a simply application of <code>either :: (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c</code>.</p>\n\n<pre><code>main = do\n    args &lt;- getArgs\n    either (hPrint stderr) goAhead (validatedArgs args)\n</code></pre>\n\n<p>You can now easily test <code>validateArgs</code>, and arguably <code>either (hPrint stderr) goAhead</code> doesn't <em>need</em> to be tested.</p>\n"}], "owner": {"reputation": 161, "user_id": 10975456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d798ef4fd773cffbea0fdf0d17ec780?s=128&d=identicon&r=PG&f=1", "display_name": "distro.obs", "link": "https://stackoverflow.com/users/10975456/distro-obs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 55019697, "answer_count": 2, "score": 0, "last_activity_date": 1551884625, "creation_date": 1551864130, "question_id": 55019526, "link": "https://stackoverflow.com/questions/55019526/how-to-check-if-an-io-is-equivalent-to-another-io", "title": "How to check if an IO () is equivalent to another IO ()?", "body": "<p>I'm using <code>hspec</code> to do some basic testing.</p>\n\n<p>I have a <code>argsParser</code> function which given some arguments, returns or rather prints their validity.</p>\n\n<pre><code>argsParser :: [String] -&gt; IO ()\nargsParser args | null args = print \"no args provided\"\n                | not $ null args &amp;&amp; length args &lt; 2 = print \"no file name provided\"\n                | length args &gt; 2 == print \"too many arguments\"\n                | otherwise = goAhead args\n</code></pre>\n\n<p>The problem is I'm not sure how I'd compare <code>IO ()</code> with another <code>IO ()</code>.</p>\n\n<p>I thought maybe <code>liftIO</code> could help but </p>\n\n<pre><code>x &lt;- liftIO $ print \"something\"\ny &lt;- liftIO $ print \"anything\"\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>x == y = True\n</code></pre>\n\n<p>which I suspect is because both are <code>actions</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "edited": false, "score": 2, "creation_date": 1551854342, "post_id": 55016528, "comment_id": 96787722, "body": "Is the answer to this question enough to get you started? <a href=\"https://stackoverflow.com/questions/55013159/how-do-you-sum-the-individual-elements-of-a-pair-in-a-list\" title=\"how do you sum the individual elements of a pair in a list\">stackoverflow.com/questions/55013159/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 11155889, "user_type": "registered", "profile_image": "https://graph.facebook.com/2061960637257779/picture?type=large", "display_name": "Aking186", "link": "https://stackoverflow.com/users/11155889/aking186"}, "reply_to_user": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "edited": false, "score": 1, "creation_date": 1552361960, "post_id": 55016528, "comment_id": 96969717, "body": "Yes, thank you very much. Just got back to this, so couldn&#39;t reply for a while!"}], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1551934410, "last_edit_date": 1551934410, "creation_date": 1551933544, "answer_id": 55036201, "question_id": 55016528, "link": "https://stackoverflow.com/questions/55016528/how-do-i-find-the-average-of-a-list-of-coordinate-tuples-in-haskell/55036201#55036201", "title": "How do I find the Average of a List of Coordinate Tuples in Haskell?", "body": "<p>This will work without a space leak and without breaking stream fusion:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\nimport Data.Foldable (foldl')\n\ncentroid :: (Fractional n, Foldable t) =&gt; t (n, n) -&gt; (n, n)\ncentroid coords = (xsum/count, ysum/count)\n where (xsum,ysum,count) = foldl' go (0,0,0) coords\n       go (!xs,!ys,!c) (x,y) = (xs + x, ys + y, c + 1)\n</code></pre>\n\n<p>Feel free to replace / with `div` and Fractional with Integral if you want, and/or add realToFrac if necessary to make your types work out. Also, if you don't want to use BangPatterns, you can use seq on all three elements instead.</p>\n"}], "owner": {"reputation": 11, "user_id": 11155889, "user_type": "registered", "profile_image": "https://graph.facebook.com/2061960637257779/picture?type=large", "display_name": "Aking186", "link": "https://stackoverflow.com/users/11155889/aking186"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551934410, "creation_date": 1551851997, "question_id": 55016528, "link": "https://stackoverflow.com/questions/55016528/how-do-i-find-the-average-of-a-list-of-coordinate-tuples-in-haskell", "title": "How do I find the Average of a List of Coordinate Tuples in Haskell?", "body": "<p>How do I add a list of tuples in Haskell which represent x and y coordinates and then find the average of all the x values and y values (basically trying to find a centroid).</p>\n\n<p>So lets say I had an input list of [(1,1),(2,2),(3,6)] and I want the output to be (2,3).</p>\n"}, {"tags": ["haskell", "tuples"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1551891286, "post_id": 55016346, "comment_id": 96809237, "body": "<code>Test</code> cannot be a name of a function. Function names start with a lowercase letter."}, {"owner": {"reputation": 11, "user_id": 11157844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/073a97292ad3de8555e403f7e6d24709?s=128&d=identicon&r=PG&f=1", "display_name": "Gina Pudra", "link": "https://stackoverflow.com/users/11157844/gina-pudra"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1551894481, "post_id": 55016346, "comment_id": 96811228, "body": "Oh, sorry, I was using lowercase functions, I just changed it to &quot;Test&quot; for examples sake."}], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551856546, "post_id": 55016711, "comment_id": 96788640, "body": "Alternatively, <code>(fst . function) (1, x)</code>. While it does have that extra pair of parentheses, which is one reason why I too prefer the solution with <code>$</code>, it does avoid the messy nesting, and demonstrates that if the OP wants to do this a lot they can define a new function as <code>fst . function</code>. (And that last sentence is one reason why <code>function</code> is not a good name for a function...)"}, {"owner": {"reputation": 11, "user_id": 11157844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/073a97292ad3de8555e403f7e6d24709?s=128&d=identicon&r=PG&f=1", "display_name": "Gina Pudra", "link": "https://stackoverflow.com/users/11157844/gina-pudra"}, "edited": false, "score": 0, "creation_date": 1551894645, "post_id": 55016711, "comment_id": 96811310, "body": "Oh, it wasn&#39;t actually called function, I just changed it to function for examples sake."}, {"owner": {"reputation": 11, "user_id": 11157844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/073a97292ad3de8555e403f7e6d24709?s=128&d=identicon&r=PG&f=1", "display_name": "Gina Pudra", "link": "https://stackoverflow.com/users/11157844/gina-pudra"}, "edited": false, "score": 0, "creation_date": 1551894774, "post_id": 55016711, "comment_id": 96811381, "body": "Thank you Fyodor and Robin. Fyodor, what I ended up doing with it was change it to            test c = fst d where d = function(1, c);   I was mostly trying to figure out why my initial implementation wasn&#39;t working, and you have answered that."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1551894783, "post_id": 55016711, "comment_id": 96811387, "body": "My answer did not rely on it to be called <code>function</code>. The whole explanation still stands, regardless of what it&#39;s called."}, {"owner": {"reputation": 11, "user_id": 11157844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/073a97292ad3de8555e403f7e6d24709?s=128&d=identicon&r=PG&f=1", "display_name": "Gina Pudra", "link": "https://stackoverflow.com/users/11157844/gina-pudra"}, "edited": false, "score": 0, "creation_date": 1552085436, "post_id": 55016711, "comment_id": 96891832, "body": "Oh, sorry, that comment was meant for Robin."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 3, "last_activity_date": 1551889614, "last_edit_date": 1551889614, "creation_date": 1551852806, "answer_id": 55016711, "question_id": 55016346, "link": "https://stackoverflow.com/questions/55016346/how-fst-on-function-that-output-tuples-works-in-haskell/55016711#55016711", "title": "How fst on function that output tuples works in Haskell?", "body": "<p>You simply got the syntax wrong.</p>\n\n<p><code>f x</code> means \"<em>apply (call) function <code>f</code> to argument <code>x</code></em>\". </p>\n\n<p>Similarly, <code>f x y</code> means \"apply function <code>f</code> to arguments <code>x</code> and <code>y</code>\".</p>\n\n<p>Your example <code>function(1, c)</code> means \"<em>apply function <code>function</code> to argument <code>(1, c)</code></em>\". Don't let the absence of a space before the opening paren fool you: <code>(1, c)</code> does not mean \"<em>call function with two arguments</em>\" (as it would in, say, C or Java), it means \"<em>make a pair with two components, <code>1</code> and <code>c</code></em>\". This pair is then used as a single argument for <code>function</code>.</p>\n\n<p>Now, the next expression, <code>fst function (1, c)</code> means \"<em>apply function <code>fst</code> to two arguments - <code>function</code> and <code>(1, c)</code></em>\". This is obviously not what you meant. Instead, you meant to first call <code>function</code> with argument <code>(1, c)</code>, and then pass the result as argument to <code>fst</code>. To express this, you may use parentheses:</p>\n\n<pre><code>test c = fst (function (1, c))\n</code></pre>\n\n<p>But of course this is now too many parentheses. To avoid the extra pair, you may use the ubiquitous operator <code>$</code>:</p>\n\n<pre><code>test c = fst $ function (1, c)\n</code></pre>\n\n<p>This operator doesn't really do anything interesting, it just applies the function on the left to the argument on the right:</p>\n\n<pre><code>f $ x = f x\n</code></pre>\n\n<p>The value of this operator is that it makes it possible for the function application to not have the highest precedence, and thus get rid of extra parentheses.</p>\n"}], "owner": {"reputation": 11, "user_id": 11157844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/073a97292ad3de8555e403f7e6d24709?s=128&d=identicon&r=PG&f=1", "display_name": "Gina Pudra", "link": "https://stackoverflow.com/users/11157844/gina-pudra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551894494, "creation_date": 1551851126, "last_edit_date": 1551894494, "question_id": 55016346, "link": "https://stackoverflow.com/questions/55016346/how-fst-on-function-that-output-tuples-works-in-haskell", "title": "How fst on function that output tuples works in Haskell?", "body": "<p>I'm trying to figure out how tuples work in Haskell, and how you can get certain data values from tuples. </p>\n\n<p>I have the following code, and this runs properly, and prints out the tuple output I expect:</p>\n\n<pre><code>test :: Integer -&gt; (Integer, Integer)\ntest c =  function(1, c)\n</code></pre>\n\n<p>However, when I try to get just the first value from the tuple, as shown below, </p>\n\n<pre><code>test :: Integer -&gt; Integer\ntest c = fst function(1, c)\n</code></pre>\n\n<p>I get the following error</p>\n\n<ul>\n<li>Couldn't match expected type '((Integer, Integer) -> Integer, b0)' with actual type '(Integer, Integer) -> (Integer, Integer)'</li>\n</ul>\n\n<p>Any help or advice would be appreciated. Thanks in advance.</p>\n"}, {"tags": ["string", "list", "haskell", "io"], "comments": [{"owner": {"reputation": 17, "user_id": 8833844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b0388f48843396d1087557491e649f2?s=128&d=identicon&r=PG&f=1", "display_name": "theGreatOne", "link": "https://stackoverflow.com/users/8833844/thegreatone"}, "edited": false, "score": 0, "creation_date": 1551846079, "post_id": 55015503, "comment_id": 96785086, "body": "And by non-recursive, I mean using the test function once. I know <code>map</code> is recursive but I only care about test not being recursive."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551856172, "post_id": 55015503, "comment_id": 96788474, "body": "Regarding your comment about <code>print</code> and <code>putStrLn</code>, they&#39;re similar but it&#39;s important to know the difference. I was about to explain it myself, but while googling to check I wasn&#39;t being stupid I found <a href=\"https://stackoverflow.com/questions/19288652/difference-between-print-and-putstrln-in-haskell\">this question</a> which is exactly this, with a good detailed answer."}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1551847455, "post_id": 55015701, "comment_id": 96785426, "body": "And <code>mapM</code> has many cousins, including <code>traverse</code> for applicative traversals over foldable structures (including lists)."}, {"owner": {"reputation": 17, "user_id": 8833844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b0388f48843396d1087557491e649f2?s=128&d=identicon&r=PG&f=1", "display_name": "theGreatOne", "link": "https://stackoverflow.com/users/8833844/thegreatone"}, "edited": false, "score": 0, "creation_date": 1551848486, "post_id": 55015701, "comment_id": 96785723, "body": "Thanks that was so easy with that function! Sort of takes the understanding out of the equation though. I may have a look at the source code for it then."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1551848549, "post_id": 55015701, "comment_id": 96785741, "body": "The source code for it is very simple, but recursive, and you explicitly said you didn&#39;t want recursion."}, {"owner": {"reputation": 17, "user_id": 8833844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b0388f48843396d1087557491e649f2?s=128&d=identicon&r=PG&f=1", "display_name": "theGreatOne", "link": "https://stackoverflow.com/users/8833844/thegreatone"}, "edited": false, "score": 0, "creation_date": 1551849426, "post_id": 55015701, "comment_id": 96785995, "body": "I don&#39;t want my test function to be recursive but I am fine using recursive functions. It&#39;s more just me trying to learn more methods other than coding the whole thing myself, as I already know how to solve this question with a self-made recursive function. Mostly just expanding my knowledge of Haskell and the functions it comes with."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 5, "last_activity_date": 1551881238, "last_edit_date": 1551881238, "creation_date": 1551847292, "answer_id": 55015701, "question_id": 55015503, "link": "https://stackoverflow.com/questions/55015503/is-it-possible-in-haskell-to-apply-the-function-putstrln-to-every-element-of-a-l/55015701#55015701", "title": "Is it possible in Haskell to apply the function putStrLn to every element of a list of Strings, have it print to the screen, while being non recursive", "body": "<p>There is a special version of <code>map</code> that works with monadic functions, it's called <a href=\"https://www.stackage.org/haddock/lts-13.10/base-4.12.0.0/Prelude.html#v:mapM\" rel=\"nofollow noreferrer\"><code>mapM</code></a>:</p>\n\n<pre><code>test :: [String] -&gt; IO [()]\ntest x = mapM putStrLn x\n</code></pre>\n\n<p>Note that this way the return type of <code>test</code> is a list of units - that's because each call to <code>putStrLn</code> returns a unit, so result of applying it to each element in a list would be a list of units. If you'd rather not deal with this silliness and have the return type be a plain unit, use the special version <a href=\"https://www.stackage.org/haddock/lts-13.10/base-4.12.0.0/Prelude.html#v:mapM_\" rel=\"nofollow noreferrer\"><code>mapM_</code></a>:</p>\n\n<pre><code>test :: [String] -&gt; IO ()\ntest x = mapM_ putStrLn x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1551847748, "creation_date": 1551847748, "answer_id": 55015775, "question_id": 55015503, "link": "https://stackoverflow.com/questions/55015503/is-it-possible-in-haskell-to-apply-the-function-putstrln-to-every-element-of-a-l/55015775#55015775", "title": "Is it possible in Haskell to apply the function putStrLn to every element of a list of Strings, have it print to the screen, while being non recursive", "body": "<blockquote>\n  <p>I was thinking of making a temp :: String variable and have each String appended to temp and then putStrLn temp</p>\n</blockquote>\n\n<p>Good idea.  A pattern of \"render the message\" then a separate \"emit the message\" is often nice to have long term.</p>\n\n<pre><code>test xs = let temp = unlines (map show xs)\n          in putStrLn temp\n</code></pre>\n\n<p>Or just</p>\n\n<pre><code>test xs = putStrLn (unlines (show &lt;$&gt; xs))\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>test = putStrLn . unlines . map show\n</code></pre>\n\n<blockquote>\n  <p>Not entirely sure what the output of the function was supposed to be either which also gave me issues.</p>\n</blockquote>\n\n<p>Well you made a list of IO actions:</p>\n\n<pre><code>test :: [String] -&gt; [IO ()]\ntest x = map (\\a-&gt;putStrLn a) x\n</code></pre>\n\n<p>So with this list of IO actions when do you want to execute them? Now? Just once? The first one many times the rest never?   In what order?</p>\n\n<p>Presumably you want to execute them all now.  Let's also eta reduce <code>(\\a -&gt; putStrLn a)</code> to just <code>putStrLn</code> since that means the same thing:</p>\n\n<pre><code>test :: [String] -&gt; IO ()\ntest x = sequence_ (map (\\a-&gt;putStrLn a) x)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8833844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b0388f48843396d1087557491e649f2?s=128&d=identicon&r=PG&f=1", "display_name": "theGreatOne", "link": "https://stackoverflow.com/users/8833844/thegreatone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 55015701, "answer_count": 2, "score": 0, "last_activity_date": 1551881238, "creation_date": 1551845955, "question_id": 55015503, "link": "https://stackoverflow.com/questions/55015503/is-it-possible-in-haskell-to-apply-the-function-putstrln-to-every-element-of-a-l", "title": "Is it possible in Haskell to apply the function putStrLn to every element of a list of Strings, have it print to the screen, while being non recursive", "body": "<p>I am trying to make a function that takes a list of strings and executes the command <code>putStrLn</code> or <code>print</code> (I think they are basically equivalent, please correct me if I am wrong as I'm still new to Haskell) to every element and have it printed out on my terminal screen. I was experimenting with the <code>map</code> function and also with lambda/anonymous functions as I already know how to do this recursively but wanted to try a more complex non recursive version. <code>map</code> returned a list of the type IO() which was not what I was going for and my attempts at lambda functions did not go according to plan. The basic code was:</p>\n\n<pre><code>test :: [String] -&gt; something\ntest x = map (\\a-&gt;putStrLn a) x -- output for this function would have to be [IO()]\n</code></pre>\n\n<p>Not entirely sure what the output of the function was supposed to be either which also gave me issues. </p>\n\n<p>I was thinking of making a <code>temp :: String</code> variable and have each String appended to temp and then <code>putStrLn temp</code> but was not sure how to do that entirely. I though using <code>where</code> would be viable but I still ran into issues. I know how to do this in languages like java and C but I am still quite new to Haskell. Any help would be appreciated.</p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551828309, "post_id": 55013159, "comment_id": 96780986, "body": "You&#39;ve defined the function using a pattern that only matches a list consisting of a <i>single</i> pair (consisting of the values <code>x</code> and <code>y</code>). I think you mean <code>func xs = map fst xs</code> (where <code>xs</code> is the conventional way to refer to a list) - but this isn&#39;t right either, and won&#39;t compile (because it produces a <code>[Double]</code> result). <code>map</code> always produces a list - you will probably need <code>map</code> as part of the solution but the final result can&#39;t be a call to <code>map</code>."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 2, "creation_date": 1551829590, "post_id": 55013159, "comment_id": 96781327, "body": "What&#39;s the error? Have you looked at it?"}, {"owner": {"reputation": 893, "user_id": 6248287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPegr.jpg?s=128&g=1", "display_name": "\u019b\u019b\u019b", "link": "https://stackoverflow.com/users/6248287/%c6%9b%c6%9b%c6%9b"}, "edited": false, "score": 0, "creation_date": 1551843079, "post_id": 55013159, "comment_id": 96784431, "body": "write down a few examples then you&#39;ll see the pattern. you need to accumulate the first and the second element of each pair in the list. You can use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:foldr\" rel=\"nofollow noreferrer\">foldr</a> to accumulate values or use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:unzip\" rel=\"nofollow noreferrer\">unzip</a>."}], "answers": [{"comments": [{"owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "edited": false, "score": 3, "creation_date": 1551829523, "post_id": 55013273, "comment_id": 96781311, "body": "To bradrn&#39;s very fine answer I would add <code>funct_4 = foldr (\\(a,b) (aa, bb) -&gt; (a+aa, b+bb)) (0,0)</code>  Summation over a list is the classic example of where to use <code>fold</code>."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1551829669, "post_id": 55013273, "comment_id": 96781361, "body": "<code>unzip</code> is another option: <code>let (fsts, snds) = unzip list in (sum fsts, sum snds)</code>"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "edited": false, "score": 1, "creation_date": 1551832247, "post_id": 55013273, "comment_id": 96782021, "body": "@JohnF.Miller I did consider adding an example of <code>foldr</code> - and this is indeed a classic sample - but I thought <code>foldr</code> may be a bit confusing for a beginner. I probably should have added it for completeness."}, {"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1551841215, "post_id": 55013273, "comment_id": 96784035, "body": "@4castle Or more concise one <code>bimap sum sum (unzip list)</code> with <code>Data.Bifunctor</code> imported. Anyway, <code>let ... in</code> expression is clear enough."}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 7, "last_activity_date": 1551828796, "creation_date": 1551828796, "answer_id": 55013273, "question_id": 55013159, "link": "https://stackoverflow.com/questions/55013159/how-do-you-sum-the-individual-elements-of-a-pair-in-a-list/55013273#55013273", "title": "How do you sum the individual elements of a pair in a list?", "body": "<p>First, let's take your current, non-working definition:</p>\n\n<pre><code>func :: [(Double,Double)] -&gt; (Double,Double)\nfunc [(x, y)] = map fst (x,y)\n</code></pre>\n\n<p>This has several things wrong with it:</p>\n\n<ul>\n<li>Your pattern match <code>[(x, y)]</code> only matches a list with exactly one element. Any list with 2 or more elements will cause an error since they do not match.</li>\n<li><code>map</code> cannot be applied to tuples; it can only be applied to lists.</li>\n<li>Even if you could <code>map</code> over a tuple, <code>fst</code> must be applied to a tuple directly - <code>fst (a, b)</code> gives <code>a</code>, while <code>map fst (a, b)</code> doesn't make sense.</li>\n</ul>\n\n<p>Let's look at some alternate definitions.</p>\n\n<h1>List comprehension</h1>\n\n<pre><code>func_1 :: [(Double,Double)] -&gt; (Double,Double)\nfunc_1 list =\n    let fsts = [ a | (a, _) &lt;- list ]\n        snds = [ b | (_, b) &lt;- list ]\n    in (sum fsts, sum snds)\n</code></pre>\n\n<p>This separately extracts each first element from the list, then each second element from the list, then adds them together.</p>\n\n<h1>Mapping</h1>\n\n<pre><code>func_2 :: [(Double,Double)] -&gt; (Double,Double)\nfunc_2 list =\n    let fsts = map fst list\n        snds = map snd list\n    in (sum fsts, sum snds)\n</code></pre>\n\n<p>Maps <code>fst</code> over each element of the input list to get a list of all first elements of the list. Then maps <code>snd</code> to do the same for second elements.</p>\n\n<h1>Recursion</h1>\n\n<pre><code>func_3 :: [(Double,Double)] -&gt; (Double,Double)\nfunc_3 [] = (0, 0)\nfunc_3 ((a,b) : xs) =\n    let (a', b') = func_3 xs\n    in (a+a', b+b')\n</code></pre>\n\n<p>A bit of a different approach. Lists in Haskell are formed recursively: <code>[a, b, c]</code> is equivalent to <code>(a : (b : (c : [])))</code>. This means we can use pattern matching to get the first element of the list as well as all the other elements of the list. This definition works in two parts:</p>\n\n<ul>\n<li>If the list has no elements, just return <code>(0, 0)</code> (the <em>base case</em>).</li>\n<li>If the list has at least one element, take the rest of the list (e.g. <code>[b, c]</code> if <code>[a, b, c]</code> was given, or <code>[]</code> if <code>[a]</code> was given), calculate its sum using <code>func_3</code> again, then add the first element back on.</li>\n</ul>\n"}], "owner": {"reputation": 19, "user_id": 8692871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb1e004103a621b1f4bab3137bbfec8?s=128&d=identicon&r=PG&f=1", "display_name": "EatRocks", "link": "https://stackoverflow.com/users/8692871/eatrocks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "accepted_answer_id": 55013273, "answer_count": 1, "score": 0, "last_activity_date": 1551829678, "creation_date": 1551828050, "last_edit_date": 1551829678, "question_id": 55013159, "link": "https://stackoverflow.com/questions/55013159/how-do-you-sum-the-individual-elements-of-a-pair-in-a-list", "title": "How do you sum the individual elements of a pair in a list?", "body": "<p>Im trying to take the first and second element of the pair from a list so they can be summed. Here is my code, I am not sure why it is giving an error</p>\n\n<pre><code>func :: [(Double,Double)] -&gt; (Double,Double)\nfunc [(x, y)] = map fst (x,y)\n</code></pre>\n"}, {"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1551827260, "post_id": 55013019, "comment_id": 96780733, "body": "<code>displayList</code> never returns a String in any case. It always returns <code>IO</code>, so <code>... ++ displayList theRest</code> doesn&#39;t make sense. You&#39;d be better off having this function construct and return a String, then printing the String as needed."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551827355, "post_id": 55013019, "comment_id": 96780762, "body": "the problem is that you&#39;re trying to concatenate a <code>String</code> (or <code>[Char]</code>, which means the same thing) with the result of <code>displayList</code>, which is <code>IO ()</code> - and it&#39;s fairly obvious you can&#39;t do this. I&#39;m not sure exactly how you want this to be output, but you probably want to call <code>putStrLn (show firstUnit)</code> then recursively call <code>displayList</code> on <code>theRest</code>. And by &quot;then&quot; I mean sequence the 2 IO actions, either in a <code>do</code> block or with the <code>&gt;&gt;</code> operator (which is the same, it&#39;s what the <code>do</code> block translates to)."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1551827529, "post_id": 55013019, "comment_id": 96780802, "body": "You&#39;d have the same problem in any programming language (including imperative languages). You need to figure out whether you want <code>displayList</code> to build and return a string, or whether it should output stuff (and return nothing)."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1551827612, "post_id": 55013019, "comment_id": 96780824, "body": "What you currently have is like saying <code>printf(&quot;%d\\n%s&quot;, firstUnit, printf(theRest))</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1551828828, "post_id": 55013225, "comment_id": 96781127, "body": "Even better version: <code>displayList ns = mapM_ print ns</code>"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 4, "last_activity_date": 1551828745, "last_edit_date": 1592644375, "creation_date": 1551828492, "answer_id": 55013225, "question_id": 55013019, "link": "https://stackoverflow.com/questions/55013019/putstrln-io-error-when-trying-to-display-a-list/55013225#55013225", "title": "putStrLn IO() error when trying to display a list", "body": "<h1>The Problem</h1>\n<p>The problem with your code is fairly obvious: as the compiler tells you, you're trying to concatenate a string (<code>((show firstUnit) ++</code>) with an <code>IO()</code> (the return type of your function)</p>\n<h1>Solution</h1>\n<p>The solution can take two paths: either you want a function that returns the whole string, and then prints it all in one, or just print it step by step recursively. What I mean is:</p>\n<h2>Return a string</h2>\n<pre><code>displayList :: [Int] -&gt; IO()\ndisplayList = putStrLn . helper\n  where\n    helper :: [Int] -&gt; String\n    helper [] = &quot;&quot;\n    helper (n:ns) = show n ++ &quot;\\n&quot; ++ helper ns\n</code></pre>\n<p>This approach works fine, but I believe it's not tidy nor clear.</p>\n<h2>Better version</h2>\n<pre><code>displayList' :: [Int] -&gt; IO()\ndisplayList' [] = putStrLn &quot;&quot;\ndisplayList' (n:ns) =  putStrLn (show n) &gt;&gt; displayList' ns\n</code></pre>\n<p>I think you can see how this version is easier to read. Also note that <code>print :: Show a =&gt; a -&gt; IO()</code> works exactly as <code>putStrLn . show</code></p>\n"}], "owner": {"reputation": 17, "user_id": 8833844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b0388f48843396d1087557491e649f2?s=128&d=identicon&r=PG&f=1", "display_name": "theGreatOne", "link": "https://stackoverflow.com/users/8833844/thegreatone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 55013225, "answer_count": 1, "score": -1, "last_activity_date": 1551846261, "creation_date": 1551827070, "last_edit_date": 1551846261, "question_id": 55013019, "link": "https://stackoverflow.com/questions/55013019/putstrln-io-error-when-trying-to-display-a-list", "title": "putStrLn IO() error when trying to display a list", "body": "<p>I was playing around with making custom list displays. The concept is really simple but I keep getting an IO() error. My code is:</p>\n\n<pre><code>displayList :: [Int] -&gt; IO()\ndisplayList [] = putStrLn \"\"\ndisplayList (firstUnit:theRest) =  putStrLn (show firstUnit ++ \"\\n\" ++ \n                                   displayList theRest)\n</code></pre>\n\n<p>The error code I am getting is:</p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018IO ()\u2019\n\u2022 In the second argument of \u2018(++)\u2019, namely \u2018(displayList theRest)\u2019\n  In the first argument of \u2018putStrLn\u2019, namely\n    \u2018((show firstUnit) ++ (displayList theRest))\u2019\n  In the expression:\n    putStrLn ((show firstUnit) ++ (displayList theRest))\n</code></pre>\n\n<p>The specific part of the line that is getting the error is the <code>displayList theRest</code> not the <code>putStrLn ((show firstUnit) ++</code> part. </p>\n\n<p>I think I understand what is happening which is that when <code>displayList theRest</code> is called in the line with the error it has the potential eventually after a few recursive calls to return an IO() type from the line <code>displayList [] = putStrLn \"\"</code> which is not supported as input in the <code>putStrLn</code> function. Would anyone know a way to solve this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551816512, "post_id": 55010612, "comment_id": 96776298, "body": "well as the error indicates, <code>instance Vertex Point a</code> doesn&#39;t work at all - you were much closer with your original <code>instance Vertex Point</code> - since your definition of <code>Vertex</code> means that only types of &quot;kind&quot; <code>* -&gt; *</code> (ie. types which take one concrete type to produce another concrete type), which <code>Point</code> is but <code>Point a</code> isn&#39;t. I&#39;m not sure what your actual question is - but there are some errors in your posted code which prevent it compiling. Is the question that you don&#39;t know how to fix them?"}, {"owner": {"reputation": 107, "user_id": 8570613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4950cab4e9cc1254340f56af9c1c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Egor  Kolyshkin", "link": "https://stackoverflow.com/users/8570613/egor-kolyshkin"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551817012, "post_id": 55010612, "comment_id": 96776540, "body": "Yes, but with original <code>instance Vertex Point</code> i can&#39;t use mathematical operations with Point parameters. So i can&#39;t figure how to write it in correct way."}], "answers": [{"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 2, "last_activity_date": 1551817449, "creation_date": 1551817449, "answer_id": 55010973, "question_id": 55010612, "link": "https://stackoverflow.com/questions/55010612/haskell-data-types-with-context/55010973#55010973", "title": "Haskell Data types with context", "body": "<p>The following version is corrected so that it compiles:</p>\n\n<pre><code>data Point a = Point a a\n\nclass XY c where\n\n    x :: c a -&gt; a\n\n    y :: c a -&gt; a\n\nclass XY c =&gt; Vertex c where\n\n    translate :: (Num a) =&gt; c a -&gt; c a -&gt; c a\n\n    scale :: (Num a) =&gt; a -&gt; c a -&gt; c a\n\n    rotate :: (Floating a) =&gt; a -&gt; c a -&gt; c a\n\ninstance XY Point where\n\n    x (Point first second) = first\n\n    y (Point first second) = second\n\ninstance Vertex Point where\n\n    translate xy1 xy2 = Point (x xy1 + x xy2) (y xy1 + y xy2)\n\n    scale a xy = Point ((*a) $ x xy) ((*a) $ y xy)\n\n    rotate a xy = Point ((x xy) * cosA - (y xy) * sinA) ((x xy) * sinA + (y xy) * cosA) where\n                    cosA = cos a\n                    sinA = sin a\n</code></pre>\n\n<p>There were only 2 changes needed, in fact:</p>\n\n<ul>\n<li><p>I have added type constraints on <code>a</code> for the methods of the <code>XY</code> class. Otherwise, you can't use functions such as <code>+</code> which you have in the implementation of the instance for <code>Point</code>. (GHC actually makes this exact suggestion in one of the error messages it throws when trying to compile your version.) Note that these have to go on the class, not the instance, because the instance declaration makes no mention of the type <code>a</code> (even though the implementation does). If you don't put the constraints in the class then the methods are expected to work for <em>all</em> possible types <code>a</code>.</p></li>\n<li><p><code>x</code> and <code>y</code> are in fact functions, so you can't multiply them with numbers like <code>sinA</code>. I suspect you just got confused here and could have figured out what to do - you needed to apply them to the <code>xy</code> (the \"point\" itself) to get the \"x\" and \"y\" \"co-ordinates\".</p></li>\n</ul>\n\n<p>So actually you were pretty close, and just needed to pay attention to what the compiler was telling you. GHC's error messages can seem a bit obscure when you're new to Haskell, but with a bit of practice you soon see that they're (often, although not always) quite helpful.</p>\n"}, {"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551818066, "post_id": 55011003, "comment_id": 96777009, "body": "Thanks for the insights, I&#39;ll definitely reread this a few times so that I understand why this is better than the solution I offered (which to be honest I didn&#39;t think too deeply about but just made the minimal changes necessary to the OP&#39;s code so that it compiled)."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1551817867, "last_edit_date": 1551817867, "creation_date": 1551817552, "answer_id": 55011003, "question_id": 55010612, "link": "https://stackoverflow.com/questions/55010612/haskell-data-types-with-context/55011003#55011003", "title": "Haskell Data types with context", "body": "<p>Aww. This well-known problem is a pet peeve of mine. The correct\u2122 solution is to make the <code>XY</code> and <code>Point</code> classes <strong>not</strong> for parametric types. The scalar argument becomes an associated type synonym, and everything works easily:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nclass XY p where\n  type Component p :: *\n  x :: p -&gt; Component p\n  y :: p -&gt; Component p\n\nclass XY p =&gt; Vertex p where\n  translate :: p -&gt; p -&gt; p\n  scale :: Component p -&gt; p -&gt; p\n  rotate :: Component p -&gt; p -&gt; p\n</code></pre>\n\n<blockquote>\n  <p>N.B. In fact you could even consider simplifying this to always use the same component type, since you'll likely never need anything else:<pre><code>class XY p where\n  x :: p -> Double\n  y :: p -> Double\nclass XY p => Vertex p where\n  translate :: p -> p -> p\n  scale :: Double -> p -> p\n  rotate :: Double -> p -> p</code></pre></p>\n</blockquote>\n\n<p>With the non-parametric form, you can now easily add a number-type constraint exactly where it's needed, namely in the <code>instance Vertex Point</code> instance:</p>\n\n<pre><code>instance XY (Point a) where\n  type Component (Point a) = a\n  x (Point xc _) = xc\n  y (Point _ yc) = yc\n\ninstance Floating a =&gt; Vertex (Point a) where\n  translate xy1 xy2 = Point (x xy1 + x xy2) (y xy1 + y xy2)\n  scale a xy = Point ((*a) $ x xy) ((*a) $ y xy)\n  rotate a xy = Point (x * cosA - y * sinA) (x * sinA + y * cosA)\n   where cosA = cos a\n         sinA = sin a\n</code></pre>\n\n<p>For some reason<sup>\u2020</sup>, most people however prefer to make classes for geometric entities parametric over the scalar type, which is not only completely unnecessary but also <em>un-geometric</em>, because proper geometry is emphatically <strong>not</strong> depended of an actual basis decomposition.</p>\n\n<p><hr>\n<sup>\u2020</sup><sub>Actually I'm fairly certain what the reason is: Edward Kmett's decision to use parameterised types in <a href=\"http://hackage.haskell.org/package/linear\" rel=\"noreferrer\">the <code>linear</code> library</a>. He should have known better, especially since Conal Elliott's <a href=\"http://hackage.haskell.org/package/vector-space\" rel=\"noreferrer\"><code>vector-space</code> library</a>, which does it the right way, has been around for longer already.</sub></p>\n"}], "owner": {"reputation": 107, "user_id": 8570613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4950cab4e9cc1254340f56af9c1c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Egor  Kolyshkin", "link": "https://stackoverflow.com/users/8570613/egor-kolyshkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 55010973, "answer_count": 2, "score": 2, "last_activity_date": 1551861559, "creation_date": 1551815974, "last_edit_date": 1551861559, "question_id": 55010612, "link": "https://stackoverflow.com/questions/55010612/haskell-data-types-with-context", "title": "Haskell Data types with context", "body": "<p>I want to write base implementation for Vertex.</p>\n\n<pre><code>data Point a = Point a a\n\nclass XY c where\n\n    x :: c a -&gt; a\n\n    y :: c a -&gt; a\n\nclass XY c =&gt; Vertex c where\n\n    translate :: c a -&gt; c a -&gt; c a\n\n    scale :: a -&gt; c a -&gt; c a\n\n    rotate :: a -&gt; c a -&gt; c a\n\ninstance XY Point where\n\n    x (Point first second) = first\n\n    y (Point first second) = second\n\ninstance Vertex Point where\n\n    translate xy1 xy2 = Point (x xy1 + x xy2) (y xy1 + y xy2)\n\n    scale a xy = Point ((*a) $ x xy) ((*a) $ y xy)\n\n    rotate a xy = Point (x * cosA - y * sinA) (x * sinA + y * cosA) where\n                    cosA = cos a\n                    sinA = sin a\n</code></pre>\n\n<p>I have to create <code>instance</code> of typeclass Vertex with implementation of Floating typeclass in Point type parameter. \nIf i implement it like <code>instance (Floating a) =&gt; Vertex Point a where</code> i get: </p>\n\n<pre><code> Expected kind \u2018* -&gt; Constraint\u2019,\n        but \u2018Vertex Point\u2019 has kind \u2018Constraint\u2019\n</code></pre>\n\n<p>What is the correct way to write it in Haskell?</p>\n"}, {"tags": ["json", "parsing", "haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 1238, "user_id": 759901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56175c4faa3db6d594ed7a0688b0c296?s=128&d=identicon&r=PG", "display_name": "leshow", "link": "https://stackoverflow.com/users/759901/leshow"}, "edited": false, "score": 0, "creation_date": 1551821061, "post_id": 55010881, "comment_id": 96778381, "body": "Both preferably"}, {"owner": {"reputation": 1238, "user_id": 759901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56175c4faa3db6d594ed7a0688b0c296?s=128&d=identicon&r=PG", "display_name": "leshow", "link": "https://stackoverflow.com/users/759901/leshow"}, "edited": false, "score": 0, "creation_date": 1551821430, "post_id": 55010881, "comment_id": 96778544, "body": "Is there a way to write the FromJSON instance in a way that would be more efficient?"}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 1, "creation_date": 1551832993, "post_id": 55010881, "comment_id": 96782183, "body": "You shouldn&#39;t need to use <code>.Internal</code> module, Public <a href=\"https://hackage.haskell.org/package/aeson-1.4.2.0/docs/Data-Aeson-Encoding.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/aeson-1.4.2.0/docs/&hellip;</a> is enough. If it&#39;s not, please open an issue, so we can discuss."}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 2, "creation_date": 1551833065, "post_id": 55010881, "comment_id": 96782200, "body": "There are no way to write different (more efficient or not) <code>FromJSON</code> instances. There might be if there&#39;s luck with GSoC 2019. See <a href=\"https://summer.haskell.org/ideas.html#tokenstream-json-parsing\" rel=\"nofollow noreferrer\">summer.haskell.org/ideas.html#tokenstream-json-parsing</a>"}, {"owner": {"reputation": 1238, "user_id": 759901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56175c4faa3db6d594ed7a0688b0c296?s=128&d=identicon&r=PG", "display_name": "leshow", "link": "https://stackoverflow.com/users/759901/leshow"}, "reply_to_user": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1551883037, "post_id": 55010881, "comment_id": 96804024, "body": "Thank you @phadej for your additional information. <code>text</code> is also exported from Data.Aeson.Encoding, so no problems there either."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1551899308, "post_id": 55010881, "comment_id": 96813420, "body": "Thanks @phadej, I updated the link above.  Glad to see the GSOC idea also."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 3, "last_activity_date": 1551899248, "last_edit_date": 1551899248, "creation_date": 1551817021, "answer_id": 55010881, "question_id": 55009866, "link": "https://stackoverflow.com/questions/55009866/efficient-aeson-parsing-for-sum-type-toencoding/55010881#55010881", "title": "Efficient Aeson parsing for sum type toEncoding", "body": "<p>As far as I know, Aeson does not provide an alternative to <code>fromJSON</code> for parsing / decoding.  The docs explain that <code>toEncoding</code> allows more efficient encoding / serialization - going from the Haskell in-memory representation to the wire format.  It's not clear from your question which direction you require to be fast.</p>\n\n<p>You can provide an explicit <code>toEncoding</code> following the pattern of your <code>toJSON</code>.  <a href=\"https://hackage.haskell.org/package/aeson-1.4.2.0/docs/Data-Aeson-Encoding.html\" rel=\"nofollow noreferrer\">Data.Aeson.Encoding</a> provides a bunch of helper functions for writing these:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>    toEncoding = \\case\n        SplitHorizontalLayout -&gt; text \"splith\"\n        SplitVerticalLayout   -&gt; text \"splitv\"\n        StackedLayout         -&gt; text \"stacked\"\n        TabbedLayout          -&gt; text \"tabbed\"\n        DockAreaLayout        -&gt; text \"dockarea\"\n        OutputLayout          -&gt; text \"output\"\n</code></pre>\n"}], "owner": {"reputation": 1238, "user_id": 759901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56175c4faa3db6d594ed7a0688b0c296?s=128&d=identicon&r=PG", "display_name": "leshow", "link": "https://stackoverflow.com/users/759901/leshow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 55010881, "answer_count": 1, "score": 3, "last_activity_date": 1551899248, "creation_date": 1551812818, "last_edit_date": 1551818916, "question_id": 55009866, "link": "https://stackoverflow.com/questions/55009866/efficient-aeson-parsing-for-sum-type-toencoding", "title": "Efficient Aeson parsing for sum type toEncoding", "body": "<p>I'm parsing a third party JSON structure into my own set of types. I'd like to parse in the most efficient way possible (I'm parsing data sent over a unix socket with Network.Socket)</p>\n\n<p>Aeson's documentation claims that parsing with toEncoding yields up to a 3x speedup over toJSON, however I don't understand how to write a valid instance using toEncoding for my simple sum type.</p>\n\n<p>for example:</p>\n\n<pre><code>data NodeLayout =\n    SplitHorizontalLayout\n    | SplitVerticalLayout\n    | StackedLayout\n    | TabbedLayout\n    | DockAreaLayout\n    | OutputLayout\n    deriving (Eq, Generic)\n\ninstance ToJSON NodeLayout where\n    toJSON = \\case\n        SplitHorizontalLayout -&gt; \"splith\"\n        SplitVerticalLayout   -&gt; \"splitv\"\n        StackedLayout         -&gt; \"stacked\"\n        TabbedLayout          -&gt; \"tabbed\"\n        DockAreaLayout        -&gt; \"dockarea\"\n        OutputLayout          -&gt; \"output\"\n\ninstance FromJSON NodeLayout where\n    parseJSON (String s) = pure $ case s of\n        \"splith\"   -&gt; SplitHorizontalLayout\n        \"splitv\"   -&gt; SplitVerticalLayout\n        \"stacked\"  -&gt; StackedLayout\n        \"tabbed\"   -&gt; TabbedLayout\n        \"dockarea\" -&gt; DockAreaLayout\n        \"output\"   -&gt; OutputLayout\n        _          -&gt; error \"Received unrecognized NodeLayout\"\n    parseJSON _ = error \"Error parsing NodeLayout\"\n</code></pre>\n\n<p>I have other data types that will receive Vectors of this, but sometimes I receive a single value that needs to be parsed individually. How does one efficiently parse strings into sum types using toEncoding?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1551800082, "post_id": 55006287, "comment_id": 96767853, "body": "This should be a simple application of <code>map</code> together with a function that compares if the two elements of the pair are the same or not"}, {"owner": {"reputation": 415, "user_id": 10484793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec95469fb82b965d3ee2f22d1cea5ce?s=128&d=identicon&r=PG&f=1", "display_name": "SavannahGemp", "link": "https://stackoverflow.com/users/10484793/savannahgemp"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551800451, "post_id": 55006287, "comment_id": 96768070, "body": "how can i use map in this case? maybe i don&#39;t understand what map does but i don&#39;t see it."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 4, "creation_date": 1551800630, "post_id": 55006287, "comment_id": 96768217, "body": "<code>zipWith (&#47;=) list1 list2</code>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1551800644, "post_id": 55006287, "comment_id": 96768226, "body": "sounds like perhaps you don&#39;t understand what <code>map</code> does, in which case all I can suggest is to look it up, eg <a href=\"http://learnyouahaskell.com/higher-order-functions#maps-and-filters\" rel=\"nofollow noreferrer\">here</a> is a brief explanation with some good examples. (The entire book by the way is the best introduction to Haskell that I know.)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1551800675, "post_id": 55006287, "comment_id": 96768244, "body": "@Alec - yes, good point :)"}, {"owner": {"reputation": 415, "user_id": 10484793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec95469fb82b965d3ee2f22d1cea5ce?s=128&d=identicon&r=PG&f=1", "display_name": "SavannahGemp", "link": "https://stackoverflow.com/users/10484793/savannahgemp"}, "edited": false, "score": 0, "creation_date": 1551801216, "post_id": 55006287, "comment_id": 96768632, "body": "i kinda understand what map does but not with tuples. like.. how do i access a tuple? if i wanna increment every element by 3 i do +3 but what do i do if i wanna compare 2 booleans in a tuple?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551802797, "post_id": 55006287, "comment_id": 96769519, "body": "you write a function of type <code>(Bool, Bool) -&gt; Bool</code> which checks if the two components are equal or not"}, {"owner": {"reputation": 325, "user_id": 10759740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa69b17ab54deb4330b263ea093c485?s=128&d=identicon&r=PG&f=1", "display_name": "R Y", "link": "https://stackoverflow.com/users/10759740/r-y"}, "edited": false, "score": 0, "creation_date": 1551804485, "post_id": 55006287, "comment_id": 96770510, "body": "To access a tuple in a lambda, you destructure it like you would lists: <code>\\(x, y) -&gt; f(x, y)</code>.  You can also provide a named function that takes a bool, bool tuple and returns a boolean value, like so: <code>xorTuple (x, y) = x &#47;= y</code>.  Then you would use <code>map xorTuple list3</code>."}], "answers": [{"tags": [], "owner": {"reputation": 325, "user_id": 10759740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa69b17ab54deb4330b263ea093c485?s=128&d=identicon&r=PG&f=1", "display_name": "R Y", "link": "https://stackoverflow.com/users/10759740/r-y"}, "is_accepted": true, "score": 1, "last_activity_date": 1551804228, "creation_date": 1551804228, "answer_id": 55007677, "question_id": 55006287, "link": "https://stackoverflow.com/questions/55006287/haskell-compare-booleans-in-tuples-created-with-zip/55007677#55007677", "title": "Haskell: Compare booleans in tuples created with zip", "body": "<p>As @Alec commented above, what it looks like you want is something like the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:zipWith\" rel=\"nofollow noreferrer\"><code>zipWith</code></a> function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>list1 = [True, True, False]\nlist2 = [True, False, False]\nlist4 = zipWith (/=) list1 list2\n</code></pre>\n\n<p>That will give you <code>[False, True, False]</code> in ghci.  If you wanted to use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:map\" rel=\"nofollow noreferrer\"><code>map</code></a>, then you'd do something like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>list1 = [True, True, False]\nlist2 = [True, False, False]\nlist3 = zip list1 list2\nlist4 = map (\\(x, y) -&gt; x /= y) list3\n</code></pre>\n"}], "owner": {"reputation": 415, "user_id": 10484793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec95469fb82b965d3ee2f22d1cea5ce?s=128&d=identicon&r=PG&f=1", "display_name": "SavannahGemp", "link": "https://stackoverflow.com/users/10484793/savannahgemp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 55007677, "answer_count": 1, "score": 0, "last_activity_date": 1551858628, "creation_date": 1551799835, "last_edit_date": 1551858628, "question_id": 55006287, "link": "https://stackoverflow.com/questions/55006287/haskell-compare-booleans-in-tuples-created-with-zip", "title": "Haskell: Compare booleans in tuples created with zip", "body": "<p>I'm new to haskell.\nWhat I want to do is the XOR operation:\nI get 2 boolean lists and i zip them, getting a list of tuples of booleans.\nNow i want to compare the elements inside of the tupels.</p>\n\n<p>E.G.</p>\n\n<pre><code>list1 = [true,true,false]\n\nlist2 = [true,false,false]\n\nlist 3 = zip list1 list2 \n</code></pre>\n\n<p>now from this list i wanna get a list list4 = [false,true,false]. so if in a tuple in the list there are a true and a false, in the solution list it would be true, else false. How can I do this?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 4, "creation_date": 1551798657, "post_id": 55005862, "comment_id": 96766922, "body": "surely it should just be <code>return t = Leaf t</code> (or, equivalently, <code>return = Leaf</code>) ?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 8, "creation_date": 1551798991, "post_id": 55005862, "comment_id": 96767163, "body": "just seen your edit, as it says you have to make the type an instance of Applicative (and before that, Functor), before you make the Monad instance. (Note that whatever you define as <code>pure</code> here - which should be <code>Leaf</code> - will become the <code>return</code> definition for the <code>Monad</code> instance, so you don&#39;t have to define it again.)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1551801101, "post_id": 55005862, "comment_id": 96768556, "body": "You can not partially apply <code>Node</code> and get a tree: if you do, you get a function, since that&#39;s what partial application is for. In this case, you don&#39;t need <code>Node</code>, you can simply use <code>Leaf t</code> for a tree with only one leaf."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1551812178, "post_id": 55005862, "comment_id": 96774390, "body": "While <code>return = Leaf</code> has presented you with another error it is correct and you have gotten further in your implementation.  Keep <code>return = Leaf</code> and now fix this next issue instead of going backwards."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 2, "creation_date": 1551819953, "post_id": 55005862, "comment_id": 96777843, "body": "Your problem is that you want to write down various instances for a binary tree and you don\u2019t know how/are running into difficulties or errors. You should try to make sure that when you ask a question it focuses on how to solve your problem rather than how to solve the difficulties you run into with your attempted solution. The reason is that it may be that your attempted solution will never work and so any answer won\u2019t be useful to you, and the difficulty you run into typically won\u2019t be relevant to anyone else (or indeed yourself)."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 1, "creation_date": 1551820190, "post_id": 55005862, "comment_id": 96777957, "body": "<a href=\"https://stackoverflow.com/q/6798699/4942760\">Related?</a>"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551798687, "creation_date": 1551798495, "last_edit_date": 1551798687, "question_id": 55005862, "link": "https://stackoverflow.com/questions/55005862/how-to-partially-create-a-type", "title": "How to partially create a type", "body": "<p>I am trying to create my <code>Btree</code> monad and i do not know how to define the <code>return</code> for this since , i want to put the value in the <code>Node (Leaf value)</code> and leave the other branch empty.</p>\n\n<pre><code>module Tree where \n    import Control.Monad\n\n    data Btree a=Node (Btree a)(Btree a)|Leaf a \n</code></pre>\n\n<p>The problem arises if i want to inject a value in the Monad:</p>\n\n<pre><code>    instance Monad Btree  where \n      (&gt;&gt;=) (Leaf x) f = f x\n      (&gt;&gt;=) (Node a b) f=Node (a&gt;&gt;=f) (b&gt;&gt;=f)\n      return t=Node (Leaf t)  # i want to partially apply `Node` to not have to specify the other branch . Do i need an additional ADT  ?  `Leaf/Node/Root` ? for single elements ?\n</code></pre>\n\n<p><strong>P.S</strong> When trying to run this with <code>return=Leaf</code> or <code>return t=Node (Leaf t)(Leaf t)</code> i also get the error:</p>\n\n<pre><code>* No instance for (Applicative Btree)\n        arising from the superclasses of an instance declaration\n    * In the instance declaration for `Monad Btree'\n</code></pre>\n"}, {"tags": ["haskell", "monads", "applicative"], "answers": [{"tags": [], "owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "is_accepted": false, "score": 11, "last_activity_date": 1551792203, "creation_date": 1551792203, "answer_id": 55003903, "question_id": 55003519, "link": "https://stackoverflow.com/questions/55003519/haskell-do-syntactically-inline-monad-unpacking-with-left-arrow/55003903#55003903", "title": "Haskell do (syntactically) inline monad unpacking with left arrow", "body": "<p>You can use LambdaCase here!</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE LambdaCase #-} \n\ndoStuff = do\n  fooM &gt;&gt;= \\case\n    Foo x -&gt; ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 2, "creation_date": 1551796818, "post_id": 55004110, "comment_id": 96765701, "body": "@fakedrake: Did you notice the other answer given 30 minutes before you wrote this comment?"}, {"owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 0, "creation_date": 1552399026, "post_id": 55004110, "comment_id": 96987888, "body": "I did but it does not address my final note which is very important. The correct answer seems to be &quot;there is no such thing&quot; so I accepted this and upvoted the other one."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 3, "last_activity_date": 1551792839, "creation_date": 1551792839, "answer_id": 55004110, "question_id": 55003519, "link": "https://stackoverflow.com/questions/55003519/haskell-do-syntactically-inline-monad-unpacking-with-left-arrow/55004110#55004110", "title": "Haskell do (syntactically) inline monad unpacking with left arrow", "body": "<p>I don't think any such thing exists; if it did, I would only expect it to work for <code>case</code>, and not inside of arbitrary expressions as your second example does.</p>\n\n<p>I looked through the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html\" rel=\"nofollow noreferrer\">list of GHC language extensions</a> and none of them look promising.</p>\n"}], "owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "accepted_answer_id": 55004110, "answer_count": 2, "score": 1, "last_activity_date": 1551792839, "creation_date": 1551791089, "question_id": 55003519, "link": "https://stackoverflow.com/questions/55003519/haskell-do-syntactically-inline-monad-unpacking-with-left-arrow", "title": "Haskell do (syntactically) inline monad unpacking with left arrow", "body": "<p>I can't find where I saw this but I found somewhere on a reddit discussion the following syntax in a do block:</p>\n\n<pre><code>do\n  case (&lt;- fooM) of\n    Foo x -&gt; ..\n    ...\n</code></pre>\n\n<p>instead of the usual</p>\n\n<pre><code>do\n  foo &lt;- fooM\n  case foo of\n    Foo x -&gt; ..\n    ...\n</code></pre>\n\n<p>Which would be extremely useful but it doesn't seem to work (without a language extension) and I was wondering if it was just shorthand of the post author or if I am missing a language extension. </p>\n\n<p>Note that I understand that this syntax is ambiguous for example</p>\n\n<pre><code>(`execState` 0) $ do\n  return $ (&lt;- put 3) &lt;&gt; (&lt;- put 4) &lt;&gt; (&lt;- put 5)\n</code></pre>\n\n<p>We may get 3, 4 or 5 but there could be semantics to mitigate this.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 2, "creation_date": 1551775583, "post_id": 54998541, "comment_id": 96753106, "body": "Note that you can use the script feature of Stack to easily reproduce things: <a href=\"https://haskell.fpcomplete.com/tutorial/stack-script#script-interpreter\" rel=\"nofollow noreferrer\">haskell.fpcomplete.com/tutorial/stack-script#script-interpre&zwnj;&#8203;ter</a>  That will be useful for others to reproduce your problems exactly."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 7, "last_activity_date": 1551776836, "last_edit_date": 1551776836, "creation_date": 1551775503, "answer_id": 54998647, "question_id": 54998541, "link": "https://stackoverflow.com/questions/54998541/couldnt-match-type-char-with-data-text-internal-text/54998647#54998647", "title": "Couldn&#39;t match type \u2018[Char]\u2019 with \u2018Data.Text.Internal.Text\u2019", "body": "<p>You need to put <code>OverloadedStrings</code> extension on top of the file:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack script --resolver lts-12.7\n{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.Aeson\nimport qualified Data.Text.Lazy.Encoding as T\nimport qualified Data.Text.Lazy.IO as T\nimport GHC.Exts\n\nval :: Value\nval =\n  Object $\n  fromList\n    [ (\"numbers\", Array $ fromList [Number 1, Number 2, Number 3])\n    , (\"boolean\", Bool True)\n    ]\n\nmain :: IO ()\nmain = T.putStrLn . T.decodeUtf8 . encode $ val\n</code></pre>\n\n<p>And on executing them:</p>\n\n<pre><code>$ stack fuse.hs\n{\"boolean\":true,\"numbers\":[1,2,3]}\n</code></pre>\n\n<p>To understand the reasons on why that makes it work, <a href=\"https://stackoverflow.com/a/54824657/1651941\">refer to this answer</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": true, "score": 6, "last_activity_date": 1551777749, "last_edit_date": 1551777749, "creation_date": 1551775697, "answer_id": 54998718, "question_id": 54998541, "link": "https://stackoverflow.com/questions/54998541/couldnt-match-type-char-with-data-text-internal-text/54998718#54998718", "title": "Couldn&#39;t match type \u2018[Char]\u2019 with \u2018Data.Text.Internal.Text\u2019", "body": "<p>The error you get is about wrong string representation. Haskell has many of them, e.g. <code>ByteString</code> (strict or lazy), <code>Text</code> (strict or lazy), <code>String</code> (alias for <code>[Char]</code>). The last one is the default and also the one you should avoid most of the time.</p>\n\n<p>Aeson library uses the <code>Text</code> as string representation. You can fix your code using <code>T.pack</code> before the string (to convert it to Text), like this:</p>\n\n<pre><code>val :: Value\nval =\n  Object $\n  fromList\n    [ (T.pack \"numbers\", Array $ fromList [Number 1, Number 2, Number 3])\n    , (T.pack \"boolean\", Bool True)\n    ]\n</code></pre>\n\n<p>Or you can just enable <code>OverloadedStrings</code> extension. When it's on then Haskell compiler will try to figure out which string representation it should use. Just put <code>{-# LANGUAGE OverloadedStrings #-}</code> at the top of your file and it should work.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "accepted_answer_id": 54998718, "answer_count": 2, "score": 2, "last_activity_date": 1551777749, "creation_date": 1551775160, "question_id": 54998541, "link": "https://stackoverflow.com/questions/54998541/couldnt-match-type-char-with-data-text-internal-text", "title": "Couldn&#39;t match type \u2018[Char]\u2019 with \u2018Data.Text.Internal.Text\u2019", "body": "<p>I am trying to figure out, how to build <code>JSON</code> in <code>Haskell</code> with the following example: </p>\n\n<pre><code>module Main where\n\n\nimport GHC.Exts\nimport Data.Aeson\nimport qualified Data.Text.Lazy.IO as T\nimport qualified Data.Text.Lazy.Encoding as T\n\nval :: Value\nval = Object $ fromList [\n  (\"numbers\", Array $ fromList [Number 1, Number 2, Number 3]),\n  (\"boolean\", Bool True) ]\n\nmain :: IO ()\nmain = T.putStrLn . T.decodeUtf8 . encode $ val\n</code></pre>\n\n<p>When I tried to compile, the compiler complains:</p>\n\n<pre><code>    \u2022 Couldn't match type \u2018[Char]\u2019 with \u2018Data.Text.Internal.Text\u2019\n      Expected type: Item Object\n        Actual type: ([Char], Value)\n    \u2022 In the expression: (\"boolean\", Bool True)\n      In the first argument of \u2018fromList\u2019, namely\n        \u2018[(\"numbers\", Array $ fromList [Number 1, Number 2, ....]),\n          (\"boolean\", Bool True)]\u2019\n      In the second argument of \u2018($)\u2019, namely\n        \u2018fromList\n           [(\"numbers\", Array $ fromList [Number 1, Number 2, ....]),\n            (\"boolean\", Bool True)]\u2019\n   |\n12 |   (\"boolean\", Bool True) ]\n   |   ^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "gadt", "existential-type"], "comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1551787596, "post_id": 54997889, "comment_id": 96760196, "body": "Strictly speaking, <code>GetSomeStuff</code> is only isomorphic to <code>sigma a. GetStuff a</code> (a type which doesn\u2019t exist in Haskell). In particular note that <code>[GetSomeStuff]</code> and <code>[GetStuff a]</code> are not isomorphic. Alternatively, consider that no halting function of type <code>GetSomeStuff -&gt; GetStuff a</code> exists."}, {"owner": {"reputation": 28428, "user_id": 754787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08882f84df51f9b100d5ed532ee1ca0a?s=128&d=identicon&r=PG", "display_name": "Didier Dupont", "link": "https://stackoverflow.com/users/754787/didier-dupont"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 1, "creation_date": 1551944541, "post_id": 54997889, "comment_id": 96828094, "body": "@DanRobertson I meant between (Some GetStuff) and GetSomeStuff. I added an implementation above, it feels ok to me, but I&#39;m just getting my feet wet here. Do I miss something ?"}], "answers": [{"comments": [{"owner": {"reputation": 28428, "user_id": 754787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08882f84df51f9b100d5ed532ee1ca0a?s=128&d=identicon&r=PG", "display_name": "Didier Dupont", "link": "https://stackoverflow.com/users/754787/didier-dupont"}, "edited": false, "score": 0, "creation_date": 1551860261, "post_id": 54998716, "comment_id": 96790427, "body": "Thank you. Quite a lot to digest, and quite a lot to learn to. Feels like using all the extensions at once."}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "reply_to_user": {"reputation": 28428, "user_id": 754787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08882f84df51f9b100d5ed532ee1ca0a?s=128&d=identicon&r=PG", "display_name": "Didier Dupont", "link": "https://stackoverflow.com/users/754787/didier-dupont"}, "edited": false, "score": 0, "creation_date": 1551879642, "post_id": 54998716, "comment_id": 96801926, "body": "@DidierDupont that&#39;s usual collection of extenesions if one want to use <code>DataKinds</code> (for type-level lists in this answer). I can amend the answer with explanation of them, if it would help"}, {"owner": {"reputation": 28428, "user_id": 754787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08882f84df51f9b100d5ed532ee1ca0a?s=128&d=identicon&r=PG", "display_name": "Didier Dupont", "link": "https://stackoverflow.com/users/754787/didier-dupont"}, "edited": false, "score": 0, "creation_date": 1551905511, "post_id": 54998716, "comment_id": 96816478, "body": "Not to worry, I see what most of them are related to, and the extensions&#39; documentation is ok. Nice to have a list of interesting thing to look at."}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 1, "last_activity_date": 1551775694, "creation_date": 1551775694, "answer_id": 54998716, "question_id": 54997889, "link": "https://stackoverflow.com/questions/54997889/eq-or-ord-instances-for-existential-gadt/54998716#54998716", "title": "Eq or Ord instances for existential GADT", "body": "<p>Starting with your example</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE ExistentialQuantification #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE StandaloneDeriving #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE DataKinds, KindSignatures #-}\n{-# LANGUAGE EmptyCase #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# OPTIONS_GHC -Wall #-}\n\nimport Data.Type.Equality\n\ndata Car\ndata Food\n\ndata CarRental  = CarRental  {passengers :: Int, mileage :: Int}\n  deriving (Eq, Ord)\ndata ErrandList = ErrandList {avoidJunkFood :: Bool}\n  deriving (Eq, Ord)\n\ndata GetStuff a where\n  RentACar :: CarRental  -&gt; GetStuff Car\n  BuyFood  :: ErrandList -&gt; GetStuff Food\n\ndata Some t = forall a. Some (t a)\n</code></pre>\n\n<p>You'll need to write an instance of\n<a href=\"http://hackage.haskell.org/package/dependent-sum-0.4/docs/Data-GADT-Compare.html#t:GEq\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/dependent-sum-0.4/docs/Data-GADT-Compare.html#t:GEq</a></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class GEq f where\n  geq :: f a -&gt; f b -&gt; Maybe (a :~: b)\n</code></pre>\n\n<p>Then you'll be able to define an instance of <code>Eq (Some f)</code></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance GEq f =&gt; Eq (Some f) where\n    Some fa == Some fb = case geq fa fb of\n        Just Refl -&gt; True\n        Nothing   -&gt; False\n</code></pre>\n\n<p>Writing an instance by hand is repetitive, but not awful.\nNote that I wrote in the way without \"catch all\" last case.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance GEq GetStuff where\n  geq (RentACar x) z = case z of\n    RentACar x' -&gt; if x == x' then Just Refl else Nothing\n    _           -&gt; Nothing\n\n  geq (BuyFood x) z = case z of\n    BuyFood x' -&gt; if x == x' then Just Refl else Nothing\n    _          -&gt; Nothing\n</code></pre>\n\n<p>There's a <code>GCompare</code> class for <code>Ord</code> of GADTs.</p>\n\n<p>So the problem reduces to \"how to derive <code>GEq</code> or <code>GCompare</code> automatically\".\nI think that for special GADTs, like your <code>GetStuff</code>, you can\nwrite quick-n-dirty TH, to generate the code.</p>\n\n<p><code>Generic</code>-like alternative I can think of would require you to\nwrite conversion functions from and to <code>GetStuff</code>, which\nmight be a win if you need to write more generic functions.\nLet's explore that too. First we define a generic representation\nof GADTs we are interested in:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Sum (cs :: [(*, *)]) a where\n  Z :: a :~: c -&gt; b -&gt; Sum ( '(c, b) ': cs) a\n  S :: Sum cs a -&gt; Sum (c ': cs) a\n</code></pre>\n\n<p>We can convert between <code>GetStuff</code> and <code>Sum</code>.\nThat we'll need to write for each GADT, this is <em>O(n)</em> where <code>n</code> is constructors count.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type GetStuffCode =\n  '[ '(Car, CarRental)\n  ,  '(Food, ErrandList)\n  ]\n\ntoSum :: GetStuff a -&gt; Sum GetStuffCode a\ntoSum (RentACar x) = Z Refl x\ntoSum (BuyFood x)  = S (Z Refl x)\n\nfromSum :: Sum GetStuffCode a -&gt; GetStuff a\nfromSum (Z Refl x)     = RentACar x\nfromSum (S (Z Refl x)) = BuyFood x\nfromSum (S (S x))      = case x of {} -- silly GHC requires this :)\n</code></pre>\n\n<p>Now, as we have generic representation, <code>Sum</code>, we can write generic\nfunctions. Equality, <code>GGEq</code> for <em>Generic Gadt Equality</em>\nThe class looks like <code>GEq</code>, but we use <code>Sum</code> as an arguments.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class GGEq code where\n  ggeq :: Sum code a -&gt; Sum code b -&gt; Maybe (a :~: b)\n</code></pre>\n\n<p>We'll need two instances, for nil and cons <em>codes</em>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance GGEq '[] where\n  ggeq x _ = case x of {}\n\ninstance (Eq b, '(x, b) ~ c, GGEq cs) =&gt; GGEq (c ': cs) where\n  ggeq (Z Refl x) (Z Refl y) = if x == y then Just Refl else Nothing\n  ggeq (S x)      (S y)      = ggeq x y\n\n  ggeq (Z _ _) (S _)   = Nothing\n  ggeq (S _)  (Z _ _) = Nothing\n</code></pre>\n\n<p>Using that machinery, writing <code>geq</code> for <code>GetStuff</code> is trivial:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>geq1 :: GetStuff a -&gt; GetStuff b -&gt; Maybe (a :~: b)\ngeq1 x y = ggeq (toSum x) (toSum y)\n</code></pre>\n"}], "owner": {"reputation": 28428, "user_id": 754787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08882f84df51f9b100d5ed532ee1ca0a?s=128&d=identicon&r=PG", "display_name": "Didier Dupont", "link": "https://stackoverflow.com/users/754787/didier-dupont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 54998716, "answer_count": 1, "score": 2, "last_activity_date": 1551905910, "creation_date": 1551772588, "last_edit_date": 1551905910, "question_id": 54997889, "link": "https://stackoverflow.com/questions/54997889/eq-or-ord-instances-for-existential-gadt", "title": "Eq or Ord instances for existential GADT", "body": "<p>Is there a convenient way to get an instance of <code>Ord</code> (or <code>Eq</code>) to compare any two values of a GADT, irrespective of the type parameter. </p>\n\n<p>In the GADT, the type parameter is phantom, just meant to associate each constructor with a type, e.g. the GADT represent keys/queries, and the type parameter is the type of the associated value/result. </p>\n\n<p>To illustrate: </p>\n\n<pre><code>{-# LANGUAGE GADTs, Rank2Types #-}\n\ndata Car = Car   -- whatever\ndata Food = Food\n\ndata CarRental  = CarRental  {passengers :: Int, mileage :: Int}\n  deriving (Eq, Ord)\ndata ErrandList = ErrandList {avoidJunkFood :: Bool}\n  deriving (Eq, Ord)\n\ndata GetStuff a where\n  RentACar :: CarRental  -&gt; GetStuff Car\n  BuyFood  :: ErrandList -&gt; GetStuff Food\n\ndata Some t = forall a. Some (t a)\n</code></pre>\n\n<p><code>GetStuff</code> is a GADT, so that each item is associated with a result type, <code>Car</code> or <code>Food</code>. I can use that in e.g <code>Free</code> or <code>FreeApplicative</code>. I may want to retrieve all the GetStuff that appear in the structure. I can easily build <code>[Some GetStuff]</code>, but not a <code>Set (Some GetStuff)</code>, for lack of an Ord instance. </p>\n\n<p>I see that </p>\n\n<pre><code>data GetSomeStuff = RentSomeCar CarRental | BuySomeFood ErrandList\n  deriving (Eq, Ord)\n</code></pre>\n\n<p>is isomorphic to <code>Some GetStuff</code> (<code>a</code> is phantom in GetStuff), so I can get Eq, Ord, and possibly others by writing this isomorphism: </p>\n\n<pre><code>existentialToUntyped :: Some GetStuff -&gt; GetSomeStuff\nuntypedToExistential :: GetSomeStuff -&gt; Some GetStuff\n\nuntypedToExistential (RentSomeCar x) = Some $ RentACar x\nuntypedToExistential (BuySomeFood x) = Some $ BuyFood x\nexistentialToUntyped (Some (RentACar x)) = RentSomeCar x\nexistentialToUntyped (Some (BuyFood x)) = BuySomeFood x\n</code></pre>\n\n<p>but it's tedious for protocols much larger than GetStuff. Is there a better way, with or without GADT?</p>\n\n<p>Also, I intend to write code parametric in the \"protocol\" type (here GetStuff) at this point, where I would like a signature such as</p>\n\n<pre><code>queries :: SomeConstraint protocol =&gt; \n  FreeApplicative protocol \n  -&gt; Set (Some protocol)\n</code></pre>\n\n<p>I may have to do </p>\n\n<pre><code>myFunction :: Ord untyped =&gt; \n  Iso (Some protocol, untyped) \n  -&gt; FreeApplicative protocol\n  -&gt; Set untyped\n</code></pre>\n\n<p>Again, is there a better way?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 3, "creation_date": 1551765006, "post_id": 54996077, "comment_id": 96748704, "body": "What does &quot;unordered&quot; mean to you exactly?"}, {"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1551765125, "post_id": 54996077, "comment_id": 96748751, "body": "I know it&#39;s a good question. But there is <code>&lt;ul&gt;</code> in HTML. Basically it doesn&#39;t have the property of ordered, the most general meaning. When you have a group of students, there is no order to it, it is just a group. You can then order them by their name, or something, but by default you think of the list of students as unordered."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 2, "creation_date": 1551765185, "post_id": 54996077, "comment_id": 96748777, "body": "@LancePollard everything is ordered. When a collection is called &quot;unordered&quot; it really just means that the order is arbitrary -- it has no meaning"}, {"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "edited": false, "score": 0, "creation_date": 1551765229, "post_id": 54996077, "comment_id": 96748791, "body": "Wondering how you specify in Haskell that &quot;order is arbitrary&quot;."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 2, "creation_date": 1551765234, "post_id": 54996077, "comment_id": 96748796, "body": "The HTML <code>&lt;ul&gt;</code> simply doesn&#39;t display numbers on every line when rendered, but the elements do have order. For example, you can swap two elements, and it will have a visual effect. If you want an &quot;unordered collection&quot;, you have to specify precisely what it is."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1551765242, "post_id": 54996077, "comment_id": 96748802, "body": "Did you <a href=\"https://www.google.com/search?hl=en&amp;q=unordered%20collection%20haskell\" rel=\"nofollow noreferrer\">Google this</a> at all...?"}, {"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "edited": false, "score": 0, "creation_date": 1551765336, "post_id": 54996077, "comment_id": 96748835, "body": "Yes I have searched this extensively over the past few months here and there and haven&#39;t found anything on the topic."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1551765353, "post_id": 54996077, "comment_id": 96748839, "body": "@LancePollard generally it&#39;s a consequence of the underlying data structure. Unordered collections have no <i>inherent</i> benefit over ordered collections, so the only reason to use them is if you can exploit the arbitrary ordering to create useful behavior (usually for performance reasons). You can look at <a href=\"https://hackage.haskell.org/package/unordered-containers\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/unordered-containers</a>"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 3, "creation_date": 1551769588, "post_id": 54996077, "comment_id": 96750404, "body": "From <a href=\"https://www.google.com/search?hl=en&amp;q=unordered+collection+haskell\" rel=\"nofollow noreferrer\">googling <i>unordered collection haskell</i></a>, it also gave <a href=\"https://ocharles.org.uk/posts/2013-12-17-24-days-of-hackage-unordered-containers.html\" rel=\"nofollow noreferrer\">this introduction to <code>unordered-containers</code></a> by OCharles. You should have come to StackOverflow long ago, we just saved you months of searching!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551774955, "post_id": 54996077, "comment_id": 96752797, "body": "see <a href=\"https://stackoverflow.com/questions/54995025/dont-understand-whats-on-in-this-haskell-code#comment96749791_54995025\" title=\"dont understand whats on in this haskell code%23comment96749791_54995025\">stackoverflow.com/questions/54995025/&hellip;</a>"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1551778074, "post_id": 54996077, "comment_id": 96754508, "body": "You can define an abstract data type of unordered collections, and you can define an operation to add an element to the collection.  But you can\u2019t define any sensible operation to get an element out of the collection.  Any pure function that takes an element out of the collection will have to use some criterion to select this element, and that induces an implicit ordering."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1551775598, "post_id": 54997095, "comment_id": 96753116, "body": "Note that there is a minor difference: a <code>MultiSet&#39;</code> mapping an element to 0 would be different than one not mapping that element to anything, yet usually we want to consider them equal. One could define custom <code>Eq,Ord</code> instances to address this issue, using a <code>newtype</code>."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1551777323, "post_id": 54997095, "comment_id": 96754079, "body": "@chi You should indeed not map an element to 0. If you remove an element <code>x</code> from <code>MultiSet&#39;</code> and you end up with 0 of those elements than you should remove <code>x</code> from the list/set of keys. I expect the package MultiSet (which I mentioned as well in my answer) to take care of this all."}], "tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": true, "score": 5, "last_activity_date": 1551770775, "last_edit_date": 1551770775, "creation_date": 1551769268, "answer_id": 54997095, "question_id": 54996077, "link": "https://stackoverflow.com/questions/54996077/how-to-define-an-unordered-collection-in-haskell/54997095#54997095", "title": "How to define an unordered collection in Haskell", "body": "<p>I would define it this way</p>\n\n<pre><code>import qualified Data.Map.Lazy as Map\n\ntype MultiSet' a = Map.Map a Int \n</code></pre>\n\n<p>Just a mapping from a type <code>a</code> to an <code>Int</code>. In mathematics it would be something like <em>f</em> : <em>S</em> -> <strong>N</strong>. The elements you put into it must be ordable, that is because the underlying structure of the <code>Map</code> is defined by a binary tree. This shouldn't be a problem as you can forget about it when using the data structure. See the very extensive <a href=\"http://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Map-Lazy.html\" rel=\"nofollow noreferrer\">documentation of Data.Map</a> for functions to deal with our <code>MultiSet'</code>. </p>\n\n<p>Now there is already a definition together with implementation for this and it is called <a href=\"http://hackage.haskell.org/package/multiset-0.3.4.1/docs/Data-MultiSet.html\" rel=\"nofollow noreferrer\">MultiSet</a>. You can browse to its <a href=\"http://hackage.haskell.org/package/multiset-0.3.4.1/docs/src/Data.MultiSet.html\" rel=\"nofollow noreferrer\">source</a> code as well, there you see they defined it in an almost an identical way (they used the <em>strict</em> version of the map).    </p>\n\n<p>Alternatively you can use a hashmap, it will look like this:</p>\n\n<pre><code>import qualified Data.HashMap.Lazy as Map\n\ntype MultiSet'' a = Map.HashMap a Int \n</code></pre>\n\n<p>The elements you put into it do not need to be ordable, but hashable. </p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1551769332, "creation_date": 1551769332, "answer_id": 54997107, "question_id": 54996077, "link": "https://stackoverflow.com/questions/54996077/how-to-define-an-unordered-collection-in-haskell/54997107#54997107", "title": "How to define an unordered collection in Haskell", "body": "<p>If you just want a structure that has no reasonable order then why not compose a Map with a hash?</p>\n\n<pre><code>type MyBag a = Map (Int,a) Int\ninsert x mp = Data.Map.insertWith (+) 1 (hash x, x) mp\n</code></pre>\n\n<p>The above is a balanced binary tree with an order that depends on the hash of the value you have inserted.  The map itself is boring, along the lines of <code>data Map k a = Bin (Map k a) a (Map k a) | Nil</code>.</p>\n\n<p>This said, I think you underspecified what you are looking for and what you hope to learn.  Your searches have probably yielded hashtables and unordered-containers - why aren't those sufficiently informative?</p>\n"}], "owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 54997095, "answer_count": 2, "score": -4, "last_activity_date": 1551770775, "creation_date": 1551764302, "question_id": 54996077, "link": "https://stackoverflow.com/questions/54996077/how-to-define-an-unordered-collection-in-haskell", "title": "How to define an unordered collection in Haskell", "body": "<p>Wondering how you would define an unordered group/collection in Haskell, where by \"collection\" I mean it can have many copies of the same element, and the items are <em>unordered</em>. I know of the <code>List</code> data type in Haskell, but this is inherently ordered. I would like to see what the definition would look like for an <em>unordered</em> collection/group/list.</p>\n"}, {"tags": ["function", "haskell", "types"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1551757183, "post_id": 54995025, "comment_id": 96746725, "body": "Perhaps you are assuming too much because of the type name &quot;Bag&quot;.  Try rewriting it with <code>type Function a = a -&gt; Int</code> instead of <code>Bag</code>.  Then try to inline everything - wherever you currently see <code>Bag a</code> replace it with <code>a -&gt; Int</code>.  What do you think about the problem now?"}, {"owner": {"reputation": 143, "user_id": 11069078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aTxyj_fRGRQ/AAAAAAAAAAI/AAAAAAAAAGk/Zg2K1TWsFKw/photo.jpg?sz=128", "display_name": "David Wolak", "link": "https://stackoverflow.com/users/11069078/david-wolak"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1551758839, "post_id": 54995025, "comment_id": 96747057, "body": "Unfortunately, I still don&#39;t really get it and Im not really anymore cleared up on whats going on. Rewritting it as function instead of bag makes me more confused as to how to return a function object instead of a Int as that seems to be the only thing Ive managed to figure out -_-"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1551767859, "post_id": 54995025, "comment_id": 96749692, "body": "It may be useful to realise that <code>countB</code> can be rewritten as <code>countB b = \\e -&gt; b e</code>."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 3, "creation_date": 1551768165, "post_id": 54995025, "comment_id": 96749791, "body": "<code>addB bag x y = (if x == y then 1 else 0) + bag y</code>"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 11069078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aTxyj_fRGRQ/AAAAAAAAAAI/AAAAAAAAAGk/Zg2K1TWsFKw/photo.jpg?sz=128", "display_name": "David Wolak", "link": "https://stackoverflow.com/users/11069078/david-wolak"}, "edited": false, "score": 0, "creation_date": 1551767857, "post_id": 54995618, "comment_id": 96749690, "body": "You did it right, Ive been left to float with this class and its been killing me. This write up was very helpful thank you!"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 2, "last_activity_date": 1551761500, "creation_date": 1551761500, "answer_id": 54995618, "question_id": 54995025, "link": "https://stackoverflow.com/questions/54995025/dont-understand-whats-on-in-this-haskell-code/54995618#54995618", "title": "Dont understand whats on in this haskell code", "body": "<p><strong>Terms and Discussion</strong></p>\n\n<pre><code>type Bag a = a -&gt; Int\n</code></pre>\n\n<p>Here <code>Bag</code> is not an object.  It is just a type - an alias for <code>a -&gt; Int</code>.  If you have a value of type <code>a</code> it will compute and return a value of type <code>Int</code>.  That's it.  There is no Bag, no structure to which you can add things.  It would be better to not even call this a Bag.</p>\n\n<pre><code>emptyB :: Bag a\nemptyB = \\e -&gt; 0\n</code></pre>\n\n<p>A function from any type to the constant number zero.</p>\n\n<pre><code>countB :: Eq a =&gt; Bag a -&gt; a -&gt; Int\ncountB b e = b e\n</code></pre>\n\n<p>In short, this is just function application.   Apply the function named <code>b</code> to the input <code>e</code>.</p>\n\n<p><strong>Rewriting for fun and learning</strong></p>\n\n<p>I appreciate that you can use functions to imitate structures - it's a common programming language class assignment.  You can take a <code>Bag a</code> and another <code>Bag a</code> then union them, such as returning a new <code>countB</code> by adding the counts of the two individual bags - cool.</p>\n\n<p>... but this seems too much.  Before moving on with your assignment (did I guess that right?) you should probably become slightly more comfortable with the basics.</p>\n\n<p>It might be easier if you rewrite the functions without the type alias:</p>\n\n<pre><code>emptyB :: a -&gt; Int\nemptyB = \\e -&gt; 0\n-- or: emptyB e = 0\n-- or: emptyB _ = 0\n-- or: emptyB = const 0\n</code></pre>\n\n<p>Bag or no bag, it's just a function.</p>\n\n<pre><code>countB :: Eq a =&gt; (a -&gt; Int) -&gt; a -&gt; Int\ncountB b e = b e\n</code></pre>\n\n<p>A function that takes an <code>a</code> and produces an <code>Int</code> can... be given a value (the variable <code>e</code> is of type <code>a</code>) and produce an <code>Int</code>.</p>\n"}], "owner": {"reputation": 143, "user_id": 11069078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aTxyj_fRGRQ/AAAAAAAAAAI/AAAAAAAAAGk/Zg2K1TWsFKw/photo.jpg?sz=128", "display_name": "David Wolak", "link": "https://stackoverflow.com/users/11069078/david-wolak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 54995618, "answer_count": 1, "score": 3, "last_activity_date": 1551761500, "creation_date": 1551756801, "last_edit_date": 1551757062, "question_id": 54995025, "link": "https://stackoverflow.com/questions/54995025/dont-understand-whats-on-in-this-haskell-code", "title": "Dont understand whats on in this haskell code", "body": "<p>I have some haskell code Im trying to work my way thourgh but I dont have understand what is going in it. </p>\n\n<pre><code>type Bag a = a -&gt; Int\n\nemptyB :: Bag a\nemptyB = \\e -&gt; 0\n\ncountB :: Eq a =&gt; Bag a -&gt; a -&gt; Int\ncountB b e = b e\n</code></pre>\n\n<p>I understand that the Bag type is a function that takes in a generic object and returns a Int and countB is basically a wrapper for Bag that gets the number of generic objects in that Bag. But I dont really understand anything past that. How do I modify whats in the bag? Or the bag itself? From what I figure adding to the bag would be something like </p>\n\n<pre><code>addB :: Eq a =&gt; Bag a -&gt; a -&gt; Bag a\naddB bag num = bag (num+bag) \n</code></pre>\n\n<p>But this returns a int, when the add function requires a bag be returned. Can anyone explain to me how this works?</p>\n"}, {"tags": ["haskell", "tail-recursion", "static-assert"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 8, "creation_date": 1551746996, "post_id": 54993165, "comment_id": 96744563, "body": "Tail recursion doesn&#39;t have such big significance in Haskell due to lazy evaluation. In fact, in some circumstances tail-recursive functions are actually <i>worse</i> than non-tail recursive."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1551747597, "post_id": 54993165, "comment_id": 96744693, "body": "Tail recursion optimization happens automatically. It is pretty straightforward for the compiler to automatically detect that a function is tail recursive, under any circumstance I can think of. I don&#39;t think it is possible to write a tail recursive function that will not already be automatically recognized and optimized by GHC. I suspect the reason Scala has the annotation is that the tail recursion optimization can lose some call stack info when debugging (whether this is actually bad is a bit debatable, I&#39;d say). Also, what @FyodorSoikin said is important, with regard to lazy evaluation."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 8, "creation_date": 1551752537, "post_id": 54993165, "comment_id": 96745790, "body": "I think the point is not to ensure that the compiler realizes the function is tail-recursive, but to make sure the <i>programmer</i> realizes when they have accidentally written a non-tail-recursive function. So, not &quot;please optimize this&quot;, which is redundant, but &quot;please notify me if this cannot be optimized&quot;. Of course it is rarer to want tail-recursive functions in Haskell, but it is not unheard of, and it could be useful to confirm that you have written one."}, {"owner": {"reputation": 173, "user_id": 3465957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1922d8aadff440f49dcef90f5138c033?s=128&d=identicon&r=PG", "display_name": "Mysquff", "link": "https://stackoverflow.com/users/3465957/mysquff"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1551800865, "post_id": 54993165, "comment_id": 96768393, "body": "@amalloy - Yes, that&#39;s what I meant. Sorry if my post wasn&#39;t clear enough."}], "answers": [{"tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1603970858, "creation_date": 1603970858, "answer_id": 64590205, "question_id": 54993165, "link": "https://stackoverflow.com/questions/54993165/is-there-a-way-to-assert-that-a-function-is-recognized-as-tail-recursive-by-the/64590205#64590205", "title": "Is there a way to assert that a function is recognized as tail-recursive by the compiler?", "body": "<p>As for GHC 8.8.2 tail recursion cannot be forcefully asserted by any pragma or keyword.</p>\n"}], "owner": {"reputation": 173, "user_id": 3465957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1922d8aadff440f49dcef90f5138c033?s=128&d=identicon&r=PG", "display_name": "Mysquff", "link": "https://stackoverflow.com/users/3465957/mysquff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 3, "accepted_answer_id": 64590205, "answer_count": 1, "score": 11, "last_activity_date": 1603970858, "creation_date": 1551742004, "question_id": 54993165, "link": "https://stackoverflow.com/questions/54993165/is-there-a-way-to-assert-that-a-function-is-recognized-as-tail-recursive-by-the", "title": "Is there a way to assert that a function is recognized as tail-recursive by the compiler?", "body": "<p>Let's say I've written a function in Haskell and I want to assert that it is tail-recursive and it will be optimized by the compiler. Is there a way to do it?</p>\n\n<p>I know there's a way to do it in Scala with <a href=\"https://www.scala-lang.org/api/current/scala/annotation/tailrec.html\" rel=\"noreferrer\">@tailrec</a> annotation.</p>\n\n<p><a href=\"http://blog.richdougherty.com/2009/04/tail-calls-tailrec-and-trampolines.html\" rel=\"noreferrer\">Example:</a></p>\n\n<pre><code>import scala.annotation.tailrec\n\nclass Factorial2 {\n  def factorial(n: Int): Int = {\n    @tailrec def factorialAcc(acc: Int, n: Int): Int = {\n      if (n &lt;= 1) acc\n      else factorialAcc(n * acc, n - 1)\n    }\n    factorialAcc(1, n)\n  }\n}\n</code></pre>\n"}, {"tags": ["haskell", "fold", "foldleft"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1551754732, "post_id": 54991210, "comment_id": 96746229, "body": "If you want to see something fun, try your first example but with a list of strings instead of a list of numbers"}], "answers": [{"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 3, "last_activity_date": 1551732598, "creation_date": 1551732598, "answer_id": 54991316, "question_id": 54991210, "link": "https://stackoverflow.com/questions/54991210/haskell-foldl-and-foldl1-produce-no-instance-for-num-char-arising-from-the/54991316#54991316", "title": "Haskell foldl and foldl1 produce &quot;No instance for (Num [Char]) arising from the literal&quot;", "body": "<p>If you look at the type signature for <code>foldl1 :: Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a</code>, you'll see that the lambda has to return the same type as the one in the list. This is because that returned value is then used to compute the next step.</p>\n\n<p>This does not occur in <code>foldl</code> because the lambda can return any type as that value is only used as an accumulator. I don't have time to write a more clear answer but just google foldl1 to understand the difference</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1551737091, "last_edit_date": 1551737091, "creation_date": 1551732608, "answer_id": 54991320, "question_id": 54991210, "link": "https://stackoverflow.com/questions/54991210/haskell-foldl-and-foldl1-produce-no-instance-for-num-char-arising-from-the/54991320#54991320", "title": "Haskell foldl and foldl1 produce &quot;No instance for (Num [Char]) arising from the literal&quot;", "body": "<p>Look closely at the type:</p>\n\n<pre><code>foldl1 :: Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a\n</code></pre>\n\n<p>The values need to be converted to <code>[Char]</code> <em>before</em> the function is called, because the function expects its arguments' type and the return type to be the same. (And only the first use of the function gets two arguments of the same type.)</p>\n\n<p>To use <code>foldl1</code>, map <code>show</code> over the list first.</p>\n\n<pre><code>foldl1 (++) (map show [12, 23, 45, 66])\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 11150349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0j0pV.jpg?s=128&g=1", "display_name": "MaxSha", "link": "https://stackoverflow.com/users/11150349/maxsha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 54991320, "answer_count": 2, "score": 1, "last_activity_date": 1551737091, "creation_date": 1551732096, "last_edit_date": 1551733227, "question_id": 54991210, "link": "https://stackoverflow.com/questions/54991210/haskell-foldl-and-foldl1-produce-no-instance-for-num-char-arising-from-the", "title": "Haskell foldl and foldl1 produce &quot;No instance for (Num [Char]) arising from the literal&quot;", "body": "<p>I think these two fold functions are the same, but only the second one works. The first one produce <code>No instance for (Num [Char]) arising from the literal \u201812\u2019</code> error. Why does the first one produce this error?</p>\n\n<ol>\n<li><code>foldl1 (\\x y -&gt; (show x) ++ (show y)) [12,23,45,66]</code></li>\n<li><code>foldl (\\x y -&gt; x ++ (show y)) \"\" [12,23,45,66]</code></li>\n</ol>\n\n<p>Thank you</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551722583, "post_id": 54988839, "comment_id": 96735627, "body": "What <i>is</i> <code>leaf</code>? It&#39;s not part of the definition of <code>Tree</code>; I assume it&#39;s a helper function like <code>leaf x = Node x []</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1551723045, "post_id": 54988839, "comment_id": 96735828, "body": "FWIW, I would spell this function as <code>maxBranching (Node _ ts) = maximum (length ts:map maxBranching ts)</code>."}, {"owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "edited": false, "score": 0, "creation_date": 1551723642, "post_id": 54988839, "comment_id": 96736112, "body": "Yes you assumed right. it is defined as a smart constructor leaf :: a -&gt; Tree a leaf x = Node x []"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1551724303, "post_id": 54988839, "comment_id": 96736451, "body": "@Sniper Please include problem details in the question section, not the comment section."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1551736025, "last_edit_date": 1551736025, "creation_date": 1551728008, "answer_id": 54990330, "question_id": 54988839, "link": "https://stackoverflow.com/questions/54988839/finding-max-branching-in-a-given-tree-in-haskell/54990330#54990330", "title": "Finding max branching in a given tree in Haskell", "body": "<p>Simple answer to your question is, all types fit together perfectly. </p>\n\n<p>If <code>(x:xs) :: [Tree a]</code>, then <code>x :: Tree a</code> and <code>xs :: [Tree a]</code>, because <code>(:) :: a -&gt; [a] -&gt; [a]</code>, or here specifically, <code>(:) :: Tree a -&gt; [Tree a] -&gt; [Tree a]</code>:</p>\n\n<pre><code>(:) :: Tree a -&gt;       [Tree a]         -&gt;   [Tree a]\n(       x         :       xs       )    ::   [Tree a]\n----------------------------------\n        x :: Tree a       xs :: [Tree a]\n</code></pre>\n\n<p>And from the functions' signatures we have</p>\n\n<pre><code> maxBranching    :: Tree a -&gt; Int\n              x  :: Tree a\n---------------------------------\n(maxBranching x) ::           Int\n</code></pre>\n\n<p>and</p>\n\n<pre><code> maxBranchingOfSubtrees     :: [Tree a] -&gt; Int\n                        xs  :: [Tree a]\n---------------------------------------------\n(maxBranchingOfSubtrees xs) ::             Int\n</code></pre>\n\n<p>so then we indeed can have</p>\n\n<pre><code>max :: Int        -&gt; Int                         -&gt; Int\nmax (maxBranching x) (maxBranchingOfSubtrees xs) :: Int\n</code></pre>\n\n<p>So <code>max</code> is <em>not</em> \"comparing the first element with the rest of the list\". Instead, it compares <em>the result of calculating <code>maxBranching</code></em> on the first element, with <em>the result of calculating <code>maxBranchingOfSubtrees</code></em> on the rest of the list. </p>\n\n<p>And that last bit, how does it know how to do that, you ask? By just using the same <code>maxBranchingOfSubtrees</code> recipe. In other words, by <em>doing the same thing</em> -- but this time with a \"smaller\" thing than before. A list's tail is a <em>part</em> of the list. </p>\n\n<p>So eventually this <em>recursion</em> will run its course and we will have our answer -- if the list of trees is not infinite, that is. So this assumes that the branching factor isn't infinite.</p>\n\n<p>So this finds the maximum branching factor of a node's sub-trees, then compares it with the branching factor of this node, to produce the maximum value overall.</p>\n\n<hr>\n\n<p>Another view of it is that</p>\n\n<pre><code>    maxBranchingOfSubtrees [] = 0\n    maxBranchingOfSubtrees (x:xs) = max (maxBranching x) (maxBranchingOfSubtrees xs)\n                                  = (max . maxBranching) x (maxBranchingOfSubtrees xs)\n</code></pre>\n\n<p>fits the <code>foldr</code> pattern,</p>\n\n<pre><code>    maxBranchingOfSubtrees = foldr (max . maxBranching) 0\n</code></pre>\n\n<p>and this fits the mapping pattern,</p>\n\n<pre><code>    maxBranchingOfSubtrees = foldr max 0 . map maxBranching\n</code></pre>\n\n<p>and there's a built-in function for that,</p>\n\n<pre><code>    maxBranchingOfSubtrees = maximum . (0 :) . map maxBranching\n</code></pre>\n\n<p>and so substituting this into the main function we get</p>\n\n<pre><code>maxBranching :: Tree a -&gt; Int\nmaxBranching (Node _ ts) = max (length ts) (maxBranchingOfSubtrees ts)\n                         = max (length ts) (maximum (0 : map maxBranching ts))\n                         = maximum (length ts : map maxBranching ts)\n</code></pre>\n\n<p>which uses higher order functions to express the same algorithm, instead of the hand-rolled recursion <em>loop</em>.</p>\n"}], "owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551736362, "creation_date": 1551721811, "last_edit_date": 1551736362, "question_id": 54988839, "link": "https://stackoverflow.com/questions/54988839/finding-max-branching-in-a-given-tree-in-haskell", "title": "Finding max branching in a given tree in Haskell", "body": "<p>I am a beginner in Haskell. Here I am trying to understand a Haskell function which calculates the max degree of branching in a Tree. </p>\n\n<p>Here is the data type: </p>\n\n<pre><code>data Tree a = Node a [Tree a] deriving (Show)\n\nleaf :: a -&gt; Tree a\nleaf a = Node a []\n</code></pre>\n\n<p>Here is the implementation: </p>\n\n<pre><code>maxBranching :: Tree a -&gt; Int\nmaxBranching (Node _ ts) = let localBranching = length ts in\n                             max localBranching (maxBranchingOfSubtrees ts)\n\n  where maxBranchingOfSubtrees :: [Tree a] -&gt; Int\n        maxBranchingOfSubtrees [] = 0\n        maxBranchingOfSubtrees (x:xs) = max (maxBranching x) (maxBranchingOfSubtrees xs)\n</code></pre>\n\n<p>And here is the sample input: </p>\n\n<pre><code>Node 2 [leaf 7, Node 3 [leaf 0], Node 1 [leaf 3, leaf 2]]\n</code></pre>\n\n<p>I am not understanding this expression: </p>\n\n<pre><code>maxBranchingOfSubtrees (x:xs) = max (maxBranching x) (maxBranchingOfSubtrees xs)\n</code></pre>\n\n<p>How <em>is</em> <code>max</code> comparing the first element with the rest of the list, and where is it updating the max after each iteration? If I see when first element of the list as <code>Leaf 7</code> would be passed as <code>maxBranching x</code>, there is no such case for that, how it returns the length of the first element of the list and then how is  <code>maxBranchingOfSubtress</code> dealing with the rest of the list? Whereas, at first the <code>localBranching</code> contains the list <code>length = 4</code>? Any kind of detailed help would be appreciated. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551718252, "post_id": 54987826, "comment_id": 96733477, "body": "Try to use an if-then-else -- or even better a recursive function with a guard?"}, {"owner": {"reputation": 11, "user_id": 10514613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Tl6i0Q2SuPM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVc9o59GChK-9WPPZE1iJ4gpPxlFA/mo/photo.jpg?sz=128", "display_name": "Yogesh Patel", "link": "https://stackoverflow.com/users/10514613/yogesh-patel"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551718425, "post_id": 54987826, "comment_id": 96733570, "body": "@Lorenzo Thanks I&#39;m new to Haskell, but in any other programming language this would be simple, but in Haskell I don&#39;t know how to iterate through the list only one character at time."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1551718665, "post_id": 54987826, "comment_id": 96733710, "body": "Can you write a function <code>Char -&gt; [Char]</code> that turns any character <code>&#39;x&#39;</code> into a list <code>[&#39;x&#39;, &#39;x&#39;]</code>, but turns spaces into just <code>[&#39; &#39;]</code>?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1551718675, "post_id": 54987826, "comment_id": 96733716, "body": "In Haskell you don&#39;t (generally) iterate through something. Such tasks are often done with recursion instead - but more often with useful library functions. It can be quite a change of mindset, but in functional programming you don&#39;t think &quot;what steps do I need to take to solve this&quot;, you think &quot;what transformations do I need to do on the data (that is, which functions do I apply, and in what order)&quot;. In this case you&#39;re actually made a good start, I would suggest to look into the <code>words</code> function."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1551719043, "post_id": 54987826, "comment_id": 96733930, "body": "You <i>are</i> iterating through the list via <code>concatMap</code>.  Just change <code>replciate 2</code> to &quot;replicate 2 if it isn&#39;t a space, replicate 1 otherwise&quot;."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551719139, "post_id": 54987826, "comment_id": 96733980, "body": "Hint: <code>words &quot;Hello Word&quot; == [&quot;Hello&quot;, &quot;World&quot;]</code>. There is also <code>unwords</code>, which is close enough to an inverse of <code>words</code> for your purposes."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1551719195, "post_id": 54987826, "comment_id": 96734000, "body": "<code>words</code> will not help you solve this problem. Ignore comments that tell you to use it."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1551719819, "post_id": 54987826, "comment_id": 96734336, "body": "@melpomene I think that&#39;s too strong a statement. <code>words</code> and <code>unwords</code> is definitely the basis of <i>one</i> way to solve this - and the one I personally would most naturally think of. I see you are hinting towards another way to do it, and that&#39;s absolutely fine - it may be that your way feels natural to the OP. (Which on reflection it probably will, I admit.) I think this is a good way to show that there is usually more than one way to solve a problem, and I don&#39;t think it&#39;s helpful to claim that another solution is somehow invalid."}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 1, "creation_date": 1551724012, "post_id": 54987826, "comment_id": 96736286, "body": "<code>words</code> could be a solution, but only if collapsing whitespace is acceptable. If spaces need to be preserved as-is, <code>words</code> won&#39;t do."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1551724901, "post_id": 54987826, "comment_id": 96736743, "body": "@MichaelLitchard Erm? There&#39;s a perfectly good MCVE here: the code for <code>echo</code> is minimal, complete, and there is an input-output example with both the actual output and the desired output that makes the example verifiable."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1551725017, "post_id": 54987826, "comment_id": 96736799, "body": "good point but I cannot recind vote. it needs to be edited, then I can remove the downvote."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551726579, "post_id": 54987826, "comment_id": 96737555, "body": "@RobinZigmond According to the spec in OP&#39;s question, <code>&quot; x &quot;</code> needs to become <code>&quot; xx &quot;</code> (a four-character string). You cannot do that with <code>words</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551727467, "post_id": 54987826, "comment_id": 96738007, "body": "Oh I see, you are correct that if the first character is a space then this doesn&#39;t work. Thanks for catching this edge case :)"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1551741729, "post_id": 54987826, "comment_id": 96743440, "body": "I removed downvote"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1551725108, "creation_date": 1551725108, "answer_id": 54989610, "question_id": 54987826, "link": "https://stackoverflow.com/questions/54987826/haskell-echoing-all-characters-besides-spaces/54989610#54989610", "title": "Haskell - Echoing all characters besides spaces", "body": "<p>Well, so you've observed that <code>replicate 2</code> doesn't quite do what you want, because it duplicates spaces when you don't want it to. So let's write a new function that checks if it's a space before deciding what to do, hey? You can use pattern matching to check if your input <code>Char</code> is a space, like this:</p>\n\n<pre><code>notReplicate2 :: Char -&gt; [Char]\nnotReplicate2 ' ' = {- exercise -}\nnotReplicate2 anythingElse = {- exercise -}\n</code></pre>\n\n<p>Or, if you want to handle things like newlines, tabs, vertical tabs, etc. similarly to a single space character, you could put some meat on this skeleton instead:</p>\n\n<pre><code>import Data.Char\n\nnotReplicate2 :: Char -&gt; [Char]\nnotReplicate2 c | isSpace c = {- exercise -}\n                | otherwise = {- exercise -}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10514613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Tl6i0Q2SuPM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVc9o59GChK-9WPPZE1iJ4gpPxlFA/mo/photo.jpg?sz=128", "display_name": "Yogesh Patel", "link": "https://stackoverflow.com/users/10514613/yogesh-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551726210, "creation_date": 1551718052, "last_edit_date": 1551726210, "question_id": 54987826, "link": "https://stackoverflow.com/questions/54987826/haskell-echoing-all-characters-besides-spaces", "title": "Haskell - Echoing all characters besides spaces", "body": "<p>I am supposed to have an input of <code>[Char]</code> and output <code>[Char]</code> but from the input double all the characters twice besides the spaces.</p>\n\n<p>I can double each character including the spaces but can not figure out how to exclude the spaces.</p>\n\n<pre><code>echo :: [Char] -&gt; [Char]\necho x = concatMap (replicate 2) x\n</code></pre>\n\n<p>This will take <code>\"Hello World\"</code> and output <code>\"HHeelloo  WWoorrlldd\"</code> (2 spaces)</p>\n\n<p>but I want it to output <code>\"HHeelloo WWoorrlldd\"</code> (1 space)</p>\n\n<p>Any ideas would be helpful!</p>\n\n<p>Edit: Thanks for all the helpful ideas! I have been able to figure out how to properly implement this!</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1551708615, "post_id": 54982110, "comment_id": 96727643, "body": "The Reader monad is a very thin layer of syntactic sugar over function parameters. <code>runReader (... ask ...) x</code> is like <code>(\\env -&gt; ... env ...) x</code>."}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1551724568, "post_id": 54982110, "comment_id": 96736575, "body": "Here&#39;s some general reading on <code>Reader</code>: <a href=\"https://stackoverflow.com/questions/40066909/readert-static-environment\">one</a>, <a href=\"https://stackoverflow.com/questions/14178889/what-is-the-purpose-of-the-reader-monad\">two</a>. <a href=\"https://stackoverflow.com/questions/3451546/help-with-reader-monad\">This one</a> probably provides the clearest example, though."}, {"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "edited": false, "score": 0, "creation_date": 1551778661, "post_id": 54982110, "comment_id": 96754823, "body": "Thanks that hellped ,I sort of have a working example , but each of the functions need to be called using the runreader  ,passing the configuration object  ,iis that the right way to go about things ,or is there a more elegant solution available ?"}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1551810219, "post_id": 54982110, "comment_id": 96773430, "body": "You certainly can run every <code>Reader</code> action through <code>runReader</code>, and it&#39;s probably a reasonable thing to do if the calling function has no business being in <code>Reader</code> monad as well. On the other hand, you can combine individual <code>Reader</code>s into a single one, and run that. All subordinate readers will have access to the same environment as the top-level one. (btw, @mention me next time, please - I kinda forget about ongoing conversations sometimes)."}], "owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551795013, "creation_date": 1551698144, "last_edit_date": 1551795013, "question_id": 54982110, "link": "https://stackoverflow.com/questions/54982110/using-reader-monad-for-config-file", "title": "Using reader monad for config file", "body": "<p>I am trying to create a simple configuration file to read static data from a file .\nI used the examples from ConfigFile-1.1.4 to read the data from a file, although I didn't understand bits of the code I do have a it working.\nBut I need to thread this config file through out my application ,and I understand i need to use the readerT  monad for that ? </p>\n\n<p>The working part of my code to read from the file is below </p>\n\n<pre><code>getConfig = do\n  config &lt;- readConfig \"config.cfg\"\n  putStrLn $ \"The path value is: \" ++ (path config)\n  putStrLn $ \"The filename value is: \" ++ (fileName config)\n\n\n\nreadConfig :: String -&gt; IO ConfigInfo\nreadConfig f = do\n    rv &lt;-\n    runErrorT $\n     do\n      cp &lt;- join $ liftIO $ readfile emptyCP f\n      let x = cp\n      -- read out the attributes\n      pv &lt;- get x \"DEFAULT\" \"path\"\n      fv &lt;- get x \"DEFAULT\" \"filename\"\n      -- build the config value\n      return (ConfigInfo {path = pv, fileName = fv})\n    either (\\x -&gt; error (snd x)) (\\x -&gt; return x) rv\n</code></pre>\n\n<p>I have a function ,</p>\n\n<pre><code>get :: ID -&gt; Name -&gt; IO Keys\nget u n = do\n    p &lt;- readFile (\"getthisvaluefromconfigfile\" ++ \"getfromConfigfile\")\n    .\n    .\n    .\n    return (p, b)\n</code></pre>\n\n<p>From the examples I read I am able to understand that the ask function would return me the environment ,and then i can use the functions for the ConfigInfo to extract values .</p>\n\n<p>a)I am just not able to understand how do load the values into the environment in the getConfig function ?</p>\n\n<p>b)And how do I specify in the ask function (Get )which instance of the ConfigInfo to read from ?</p>\n\n<p>I did try to research I found some examples which use the reader monad ,but none of them show how to load the env .</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": true, "score": 2, "last_activity_date": 1551697057, "creation_date": 1551697057, "answer_id": 54981821, "question_id": 54981267, "link": "https://stackoverflow.com/questions/54981267/what-does-it-mean-convert-to-concrete-haskell/54981821#54981821", "title": "What does it mean convert to concrete Haskell?", "body": "<blockquote>\n  <p>The question is, do every expressions in Haskell convert to AST before compiling?</p>\n</blockquote>\n\n<p>Conversion to some form of AST or another is usually part of compilation, yes.</p>\n\n<blockquote>\n  <p>What does the author mean with the concrete Haskell?</p>\n</blockquote>\n\n<p>The concrete part refers to <code>1 + 2</code>, not the AST. </p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 54981821, "answer_count": 1, "score": -1, "last_activity_date": 1551697057, "creation_date": 1551695229, "question_id": 54981267, "link": "https://stackoverflow.com/questions/54981267/what-does-it-mean-convert-to-concrete-haskell", "title": "What does it mean convert to concrete Haskell?", "body": "<p>I am trying to understand the template haskell from page <a href=\"https://ocharles.org.uk/guest-posts/2014-12-22-template-haskell.html\" rel=\"nofollow noreferrer\">https://ocharles.org.uk/guest-posts/2014-12-22-template-haskell.html</a>.  </p>\n\n<p>We are going to take this example:</p>\n\n<pre><code>runQ [| 1 + 2 |]\nInfixE (Just (LitE (IntegerL 1))) (VarE GHC.Num.+) (Just (LitE (IntegerL 2)))   \n</code></pre>\n\n<p>As you can see, the expression is evaluated into AST.\nAnd with </p>\n\n<pre><code>$( return (InfixE (Just (LitE (IntegerL 1))) (VarE (mkName \"+\")) (Just (LitE (IntegerL 2)))))\n3\n</code></pre>\n\n<p>it evaluates the AST, right? </p>\n\n<p>The question is, do every expressions in Haskell convert to AST before compiling?  </p>\n\n<p>The author mentioned in the article: </p>\n\n<pre><code>Ta da, you converted concrete Haskell to AST and then evaluated it.  \n</code></pre>\n\n<p>in connection with code: </p>\n\n<pre><code>$( return (InfixE (Just (LitE (IntegerL 1))) (VarE (mkName \"+\")) (Just (LitE (IntegerL 2)))))\n3 \n</code></pre>\n\n<p>What does the author mean with the concrete Haskell? </p>\n"}, {"tags": ["dictionary", "haskell", "tree", "typeerror"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1551659126, "post_id": 54975115, "comment_id": 96709414, "body": "Your initial implementation should be modified to <code>mapTree f tree = transFunc tree</code>"}, {"owner": {"reputation": 167, "user_id": 7838597, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a1c0d8e22c9db4616d73ea8a41b6181c?s=128&d=identicon&r=PG&f=1", "display_name": "J.Ober", "link": "https://stackoverflow.com/users/7838597/j-ober"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1551659549, "post_id": 54975115, "comment_id": 96709496, "body": "It doesn&#39;t work besides not using foldTree :/"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1551660032, "post_id": 54975115, "comment_id": 96709579, "body": "I&#39;m not sure what kind of answers you&#39;re looking for. You&#39;ve already given the most reasonable implementation that uses <code>foldTree</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1551667668, "post_id": 54975115, "comment_id": 96710851, "body": "@4castle, perhaps the OP wants to understand what went wrong?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1551684657, "post_id": 54975115, "comment_id": 96715292, "body": "If you compare your 2 implementations, or just look at the type signature of <code>foldTree</code>, you&#39;ll see that your <code>transFunc</code> should have type signature <code>a -&gt; Tree b</code>. You should be able to figure that out from the error message."}], "answers": [{"tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": false, "score": 2, "last_activity_date": 1551685035, "creation_date": 1551685035, "answer_id": 54978576, "question_id": 54975115, "link": "https://stackoverflow.com/questions/54975115/haskell-maptree-implementation-using-foldtree/54978576#54978576", "title": "Haskell mapTree implementation using foldTree", "body": "<p>The second function is wrong because of its type: <code>Tree a -&gt; Tree b</code> while <code>foldTree</code> expects it to be <code>a -&gt; b</code> where <code>a</code> is taken from <code>Tree a</code>. <code>b</code> is required by <code>mapTree</code> to be <code>Tree b</code> therefore the third argument to <code>foldTree</code> should be of type <code>a -&gt; Tree b</code>.</p>\n\n<p>So the simplest fixed version of your <code>transFunc</code> is:</p>\n\n<pre><code>mapTree :: forall a b. (a -&gt; b) -&gt; Tree a -&gt; Tree b\nmapTree f tree = foldTree Node transFunc tree \n  where transFunc :: a -&gt; Tree b\n        transFunc x = Leaf (f x)\n</code></pre>\n\n<p>Note that you need to enable <code>ScopedTypeVariables</code> extension to compile it.</p>\n\n<p>And that version of <code>transFunc</code> is an equivalent of your working solution: <code>(Leaf . f)</code></p>\n"}], "owner": {"reputation": 167, "user_id": 7838597, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a1c0d8e22c9db4616d73ea8a41b6181c?s=128&d=identicon&r=PG&f=1", "display_name": "J.Ober", "link": "https://stackoverflow.com/users/7838597/j-ober"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551685035, "creation_date": 1551658322, "question_id": 54975115, "link": "https://stackoverflow.com/questions/54975115/haskell-maptree-implementation-using-foldtree", "title": "Haskell mapTree implementation using foldTree", "body": "<p>This code is from an assignment I already solved. Still I am trying to figure out if I could fix my initial attempt.</p>\n\n<p>So we got this tree structure and the foldTree function.</p>\n\n<pre><code>data Tree a = Leaf a\n | Node (Tree a) (Tree a)\n\nfoldTree :: (b -&gt; b -&gt; b) -&gt; (a -&gt; b) -&gt;  Tree a -&gt; b\nfoldTree op f (Leaf x)  = f x\nfoldTree op f (Node l r) = foldTree op f l `op` foldTree op f r\n</code></pre>\n\n<p>Now mapTree has to be implemented using foldTree.\nI got it done this way.</p>\n\n<pre><code> mapTree :: (a -&gt; b) -&gt; Tree a -&gt; Tree b\n mapTree' f tree = foldTree Node (Leaf . f) tree\n</code></pre>\n\n<p>What I initially came up with and still don't get to work is this:</p>\n\n<pre><code> mapTree :: (a -&gt; b) -&gt; Tree a -&gt; Tree b\n mapTree f tree = foldTree Node transFunc tree \n   where transFunc :: Tree a -&gt; Tree b\n         transFunc (Leaf x)    = Leaf (f x)\n         transFunc (Node l r)  = Node (transFunc l) (transFunc r)\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1551650924, "post_id": 54973356, "comment_id": 96707568, "body": "Um? List comprehension is recursion. (It&#39;s just syntactic sugar.) What&#39;s the big deal with avoiding &quot;explicit recursion&quot; vs implicit? (And as @Will&#39;s answer points out, your <code>unionB</code> is not a union: it produces a bag not a set, in general.)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 1, "creation_date": 1551682877, "post_id": 54973356, "comment_id": 96714627, "body": "@AntC the reason I mention <code>Bag</code> is the first version of the question mentioned <code>Bag</code>. I guess <code>B</code> in the functions&#39; names is for &quot;bag&quot; too, so it&#39;s OK."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1551684270, "post_id": 54973356, "comment_id": 96715149, "body": "Thanks @Will, I wasn&#39;t criticising your answer so much as pointing out that the q is dodgy. For example, neither <code>unionB</code> nor <code>intersectB</code> are commutative in general. Debate rages about what should be the intersection of two bags."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 1, "creation_date": 1551684432, "post_id": 54973356, "comment_id": 96715219, "body": "@AntC thanks; my OK was more about the question -- it&#39;s OK &quot;up to bag equality&quot; I guess (compare this with the usual &quot;up to isomorphism&quot; in math... ). :)"}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 3, "last_activity_date": 1551645625, "creation_date": 1551645625, "answer_id": 54973517, "question_id": 54973356, "link": "https://stackoverflow.com/questions/54973356/union-and-intersection-of-two-lists-without-explicit-recursion/54973517#54973517", "title": "Union and Intersection of Two Lists Without Explicit Recursion", "body": "<p>Your first function should be</p>\n\n<pre><code> unionB :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]                                     \n unionB xs ys = xs ++ [y | y &lt;- ys, not (elem y xs)]\n</code></pre>\n\n<p>And the second, of similar form,</p>\n\n<pre><code> intersectB :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]                                     \n intersectB xs ys = [y | y &lt;- ys, elem y xs]\n</code></pre>\n\n<p>This assumes that <code>Bag a</code> is the same as <code>[a]</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11034844"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 54973517, "answer_count": 1, "score": 2, "last_activity_date": 1551646710, "creation_date": 1551644474, "last_edit_date": 1551646710, "question_id": 54973356, "link": "https://stackoverflow.com/questions/54973356/union-and-intersection-of-two-lists-without-explicit-recursion", "title": "Union and Intersection of Two Lists Without Explicit Recursion", "body": "<p>I have two functions that are supposed to work on two lists.</p>\n\n<pre><code>unionB :: Eq a =&gt; [a] -&gt; [a] -&gt; [a] \n\nintersectB :: Eq a =&gt;  [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>For <code>unionB</code> I have the following code that will take the union of two lists that does this without using explicit recursion.</p>\n\n<pre><code> unionB :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\n unionB xs ys = [xs] ++ [[y] | y &lt;- ys]\n</code></pre>\n\n<p>For <code>intersectB</code> I have the following code that will take the intersection of two lists (take min of counts). The only issue is that I am doing this with explicit recursion. Code is below: </p>\n\n<pre><code>intersectB :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\nintersectB (x:xs) list\n     | x `elem` list = x : intersectB xs list\n     | otherwise = intersectB xs list\n</code></pre>\n\n<p>Is there any way to use the structure of my <code>intersectB</code> function, except without using explicit recursion? (i.e not mentioning <code>intersectB</code>  within its body?)</p>\n\n<p>From my understanding, <code>intersectB</code> should be the opposite of what <code>unionB</code> does. I am assuming that <code>intersectB</code> would look extremely similar to what <code>unionB</code> looks like.</p>\n\n<p>I can not use any imports. I understand that there is an import out there that does this already. </p>\n\n<p>Thank you. </p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 1, "creation_date": 1551641856, "post_id": 54972798, "comment_id": 96705041, "body": "Not really related to the question, but you might want to take a look at monad transformers, in particular <code>ExceptT</code>. It&#39;d cut down the staircase of <code>case</code>s significantly."}], "answers": [{"comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1551644237, "post_id": 54972950, "comment_id": 96705775, "body": "I <i>very</i> often do this as well."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1551642209, "creation_date": 1551642209, "answer_id": 54972950, "question_id": 54972798, "link": "https://stackoverflow.com/questions/54972798/inside-haskell-monads/54972950#54972950", "title": "Inside Haskell Monads", "body": "<p>You could use <code>LambdaCase</code> and be explicit with <code>&gt;&gt;=</code> instead of using <code>do</code> blocks. The result is not much shorter:</p>\n\n<pre><code>scanEmployee p &gt;&gt;= \\case\n    Left errorMsg -&gt; return (Left errorMsg)\n    Right e       -&gt; do ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 2, "last_activity_date": 1551695609, "last_edit_date": 1551695609, "creation_date": 1551642921, "answer_id": 54973073, "question_id": 54972798, "link": "https://stackoverflow.com/questions/54972798/inside-haskell-monads/54973073#54973073", "title": "Inside Haskell Monads", "body": "<p>You can simplify your code a bit with <code>mapM</code> and <code>sequence</code>:</p>\n\n<pre><code>mapM scanEmployee :: [Employee] -&gt; State (Int, Int) [Either String Employee')\n\nsequence :: [ Either String a ] -&gt; Either String [ a ]\n</code></pre>\n\n<p>(Note that these type signatures are simplifications and the actual types are more general. Specifically <code>mapM</code> and <code>sequence</code> work for any monad (not just <code>Either String</code>) and any traversable (not just <code>([])</code>))</p>\n\n<p>And write a simple solution:</p>\n\n<pre><code>scanTeam = fmap sequence . mapM scanEmployee\n</code></pre>\n"}], "owner": {"reputation": 3212, "user_id": 3357352, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/nfb7n.jpg?s=128&g=1", "display_name": "OrenIshShalom", "link": "https://stackoverflow.com/users/3357352/orenishshalom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 54973073, "answer_count": 2, "score": 0, "last_activity_date": 1551695609, "creation_date": 1551641177, "question_id": 54972798, "link": "https://stackoverflow.com/questions/54972798/inside-haskell-monads", "title": "Inside Haskell Monads", "body": "<p>I have the following code that compiles and runs fine. I tried to make it more compact by replacing <code>case newEmployee of</code> with <code>case scanEmployee p of</code>, but it didn't work. There's probably an easy way to remove <code>newEmployee</code> (and <code>newTeam</code>) from the code right?</p>\n\n<pre><code>module Main( main ) where\nimport Control.Monad.State\n\ndata Employee  = EmployeeSW  Int Int | EmployeeHW Int String deriving ( Show )\ndata Employee' = EmployeeSW'     Int | EmployeeHW'    String deriving ( Show )\n\nscanTeam :: [Employee] -&gt; State (Int,Int) (Either String [Employee'])\nscanTeam [    ] = return (Right [])\nscanTeam (p:ps) = do\n    newEmployee &lt;- scanEmployee p\n    case newEmployee of\n        Left errorMsg -&gt; return (Left errorMsg)\n        Right e -&gt; do\n            newTeam &lt;- scanTeam ps\n            case newTeam of\n                Right n -&gt; return (Right (e:n))\n                Left errorMsg -&gt; return (Left errorMsg)\n\nscanEmployee :: Employee -&gt; State (Int,Int) (Either String Employee')\n-- actual code for scanEmployee omitted ...\n</code></pre>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1551631358, "post_id": 54970779, "comment_id": 96701562, "body": "Try putting TemplateHaskell extension on to of your <code>Home.hs</code> file ?"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1551631453, "post_id": 54970779, "comment_id": 96701594, "body": "It that means, some libraries is missing?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1551631563, "post_id": 54970779, "comment_id": 96701635, "body": "No, that means putting this line on top of that file: <code>{-# LANGUAGE TemplateHaskell #-}</code>"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1551631614, "post_id": 54970779, "comment_id": 96701657, "body": "It means enabling a particular extension. More details here: <a href=\"https://wiki.haskell.org/Language_extensions\" rel=\"nofollow noreferrer\">wiki.haskell.org/Language_extensions</a>  I&#39;m not sure if the above fix will work, but that&#39;s worth a try as the error message seems related to that."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1551631677, "post_id": 54970779, "comment_id": 96701681, "body": "It is already included."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1551631729, "post_id": 54970779, "comment_id": 96701699, "body": "I updated my post."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1551631979, "post_id": 54970779, "comment_id": 96701786, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/189350/discussion-between-zero-coding-and-sibi\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 457, "user_id": 7169108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRp7Z.jpg?s=128&g=1", "display_name": "Sumanth Kumar Mora", "link": "https://stackoverflow.com/users/7169108/sumanth-kumar-mora"}, "is_accepted": true, "score": 3, "last_activity_date": 1551636481, "creation_date": 1551636481, "answer_id": 54972040, "question_id": 54970779, "link": "https://stackoverflow.com/questions/54970779/error-parse-error-on-input-when-change-the-scaffolding/54972040#54972040", "title": "Error parse error on input \u2018]\u2019 when change the scaffolding", "body": "<p>You can add <code>{-# LANGUAGE QuasiQuotes #-}</code> to your language extensions.</p>\n\n<p><code>getHomeR = defaultLayout [whamlet|Hello World!|]</code></p>\n\n<p>In the above statement, whamlet comes from quasi-quoter which converts Hamlet syntax into a Widget. So to enable <code>whamlet</code> you will have to add QuasiQuotes.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 54972040, "answer_count": 1, "score": -2, "last_activity_date": 1551636481, "creation_date": 1551628968, "last_edit_date": 1551631694, "question_id": 54970779, "link": "https://stackoverflow.com/questions/54970779/error-parse-error-on-input-when-change-the-scaffolding", "title": "Error parse error on input \u2018]\u2019 when change the scaffolding", "body": "<p>I've created a simple yesod from the scaffolding template and would like to change the content of the route <code>/</code>. </p>\n\n<p>The instance of the Yesod typeclass looks as the following:</p>\n\n<pre><code>instance Yesod App where\n    -- Controls the base of generated URLs. For more information on modifying,\n    -- see: https://github.com/yesodweb/yesod/wiki/Overriding-approot\n    approot :: Approot App\n    approot = ApprootRequest $ \\app req -&gt;\n        case appRoot $ appSettings app of\n            Nothing -&gt; getApprootText guessApproot app req\n            Just root -&gt; root\n\n    -- Store session data on the client in encrypted cookies,\n    -- default session idle timeout is 120 minutes\n    makeSessionBackend :: App -&gt; IO (Maybe SessionBackend)\n    makeSessionBackend _ = Just &lt;$&gt; defaultClientSessionBackend\n        120    -- timeout in minutes\n        \"config/client_session_key.aes\"\n\n    -- Yesod Middleware allows you to run code before and after each handler function.\n    -- The defaultYesodMiddleware adds the response header \"Vary: Accept, Accept-Language\" and performs authorization checks.\n    -- Some users may also want to add the defaultCsrfMiddleware, which:\n    --   a) Sets a cookie with a CSRF token in it.\n    --   b) Validates that incoming write requests include that token in either a header or POST parameter.\n    -- To add it, chain it together with the defaultMiddleware: yesodMiddleware = defaultYesodMiddleware . defaultCsrfMiddleware\n    -- For details, see the CSRF documentation in the Yesod.Core.Handler module of the yesod-core package.\n    yesodMiddleware :: ToTypedContent res =&gt; Handler res -&gt; Handler res\n    yesodMiddleware = defaultYesodMiddleware\n\n    isAuthorized\n        :: Route App  -- ^ The route the user is visiting.\n        -&gt; Bool       -- ^ Whether or not this is a \"write\" request.\n        -&gt; Handler AuthResult\n    -- Routes not requiring authenitcation.\n    isAuthorized FaviconR _ = return Authorized\n    isAuthorized RobotsR _ = return Authorized\n    -- Default to Authorized for now.\n    isAuthorized _ _ = return Authorized\n\n    -- This function creates static content files in the static folder\n    -- and names them based on a hash of their content. This allows\n    -- expiration dates to be set far in the future without worry of\n    -- users receiving stale content.\n    addStaticContent\n        :: Text  -- ^ The file extension\n        -&gt; Text -- ^ The MIME content type\n        -&gt; LByteString -- ^ The contents of the file\n        -&gt; Handler (Maybe (Either Text (Route App, [(Text, Text)])))\n    addStaticContent ext mime content = do\n        master &lt;- getYesod\n        let staticDir = appStaticDir $ appSettings master\n        addStaticContentExternal\n            minifym\n            genFileName\n            staticDir\n            (StaticR . flip StaticRoute [])\n            ext\n            mime\n            content\n      where\n        -- Generate a unique filename based on the content itself\n        genFileName lbs = \"autogen-\" ++ base64md5 lbs\n\n    -- What messages should be logged. The following includes all messages when\n    -- in development, and warnings and errors in production.\n    shouldLogIO :: App -&gt; LogSource -&gt; LogLevel -&gt; IO Bool\n    shouldLogIO app _source level =\n        return $\n        appShouldLogAll (appSettings app)\n            || level == LevelWarn\n            || level == LevelError\n\n    makeLogger :: App -&gt; IO Logger\n    makeLogger = return . appLogger  \n</code></pre>\n\n<p>I deleted the <code>defaultLayout</code> method from the <code>Yesod</code> instance above and the handler for root path looks as the following:  </p>\n\n<pre><code>{-# LANGUAGE NoImplicitPrelude #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE TypeFamilies #-}\nmodule Handler.Home where\n\nimport Import\nimport Yesod.Form.Bootstrap3 (BootstrapFormLayout (..), renderBootstrap3)\nimport Text.Julius (RawJS (..))\n\n\n-- This is a handler function for the GET request method on the HomeR\n-- resource pattern. All of your resource patterns are defined in\n-- config/routes\n--\n-- The majority of the code you will write in Yesod lives in these handler\n-- functions. You can spread them across multiple files if you are so\n-- inclined, or create a single monolithic file.\ngetHomeR :: Handler Html\ngetHomeR = defaultLayout [whamlet|&lt;h2&gt;Previously submitted files|]\n</code></pre>\n\n<p>When I try to build, it says: </p>\n\n<pre><code>/home/developer/haskell/yeplay/src/Handler/Home.hs:21:48: error: parse error on input \u2018]\u2019\n   |\n21 | getHomeR = defaultLayout [whamlet|Hello World!|]\n   |            \n</code></pre>\n\n<p>What am I doing wrong?  </p>\n"}, {"tags": ["haskell", "pattern-matching", "combinatorics", "do-notation"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551724282, "post_id": 54970093, "comment_id": 96736433, "body": "1. Why <code>True &lt;- return foo</code> instead of <code>guard foo</code>? 2. Why pass <code>a</code> around, when it never changes from its initial value of <code>1</code>? 3. Why <code>n &lt;- [1..b]; guard (l-1 &lt;= n)</code> instead of <code>n &lt;- [max 1 (l-1)..n]</code>, or even <code>n &lt;- [l-1 .. n]</code> if you aren&#39;t paranoid about such refactorings?"}, {"owner": {"reputation": 1672, "user_id": 11143763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWExJ.png?s=128&g=1", "display_name": "Zhiltsoff Igor", "link": "https://stackoverflow.com/users/11143763/zhiltsoff-igor"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551810709, "post_id": 54970093, "comment_id": 96773677, "body": "@DanielWagner I understand that the second snippet is written extremely poorly, it was the core that interested me. Yet, the mistake was tremendously awkward. Thanks for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 1672, "user_id": 11143763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWExJ.png?s=128&g=1", "display_name": "Zhiltsoff Igor", "link": "https://stackoverflow.com/users/11143763/zhiltsoff-igor"}, "edited": false, "score": 0, "creation_date": 1551633882, "post_id": 54970783, "comment_id": 96702442, "body": "Why, hello.   Sorry for the weird appearance of my code :&quot;).   The only difference in those two algorithms is that one changes both right and left boundaries, yet the second one changes the right boundary and filters unsuitable values of <code>n</code> via pattern-matching. You&#39;ve said that I cause extra recursive calls, but that doesn&#39;t seem right since we filter out the same values every time, but we use different tools for that. Thus, I guess, my code was too bad to see that, but it doesn&#39;t seem to be the case.  (I ran out of words, there&#39;s going to be the second half of this comment)."}, {"owner": {"reputation": 1672, "user_id": 11143763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWExJ.png?s=128&g=1", "display_name": "Zhiltsoff Igor", "link": "https://stackoverflow.com/users/11143763/zhiltsoff-igor"}, "edited": false, "score": 0, "creation_date": 1551633923, "post_id": 54970783, "comment_id": 96702458, "body": "(Part 2: sorry for that). &gt;Generating choices only to discard them can slow your program down.  Yes, that&#39;s what I attempted to express when I was talking about the redundant use of <code>enumFromTo</code> function, but I was just caught off guard by +65 seconds. It just feels that there&#39;s some other issue that I&#39;m not able to spot.   Huge thanks for your time!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1672, "user_id": 11143763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWExJ.png?s=128&g=1", "display_name": "Zhiltsoff Igor", "link": "https://stackoverflow.com/users/11143763/zhiltsoff-igor"}, "edited": false, "score": 0, "creation_date": 1551638818, "post_id": 54970783, "comment_id": 96704105, "body": "@ZhiltsoffIgor Perhaps you could try to find out how many values are actually &quot;discarded&quot;. If they are many, they can make the code much slower. E.g. <code>[1..100]</code> is much faster than <code>filter (&gt;0) [-1000000000..100]</code>"}, {"owner": {"reputation": 1672, "user_id": 11143763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWExJ.png?s=128&g=1", "display_name": "Zhiltsoff Igor", "link": "https://stackoverflow.com/users/11143763/zhiltsoff-igor"}, "edited": false, "score": 0, "creation_date": 1551810553, "post_id": 54970783, "comment_id": 96773603, "body": "Finding out the number of discarded values sounds like a nice exercise, yet not so simple, at least for me, since we can&#39;t really use both List and State Monad at the same time, obviously. There was a suggestion that there could be some strongarm method of counting via GHCi, but there\u015b still some research to be done.  Do you know any more elegant way, perhaps? Anyways, I believe, we got our answer from @DanielWagner. I don&#39;t know how <code>l</code> was mixed up with <code>l - 1</code>, but it, eventually, was. Thanks for your time!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1672, "user_id": 11143763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWExJ.png?s=128&g=1", "display_name": "Zhiltsoff Igor", "link": "https://stackoverflow.com/users/11143763/zhiltsoff-igor"}, "edited": false, "score": 0, "creation_date": 1551811135, "post_id": 54970783, "comment_id": 96773885, "body": "@ZhiltsoffIgor In this specific case, you could &quot;print&quot; <code>a</code> and <code>l-1</code> using <code>Debug.Trace.trace</code> to observe if they are very different. That might produce a lot of debug output, if there are many calls."}, {"owner": {"reputation": 1672, "user_id": 11143763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWExJ.png?s=128&g=1", "display_name": "Zhiltsoff Igor", "link": "https://stackoverflow.com/users/11143763/zhiltsoff-igor"}, "edited": false, "score": 0, "creation_date": 1551897502, "post_id": 54970783, "comment_id": 96812641, "body": "I believe, 23527350 values. Around 10^7; seems about right."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1551628974, "creation_date": 1551628974, "answer_id": 54970783, "question_id": 54970093, "link": "https://stackoverflow.com/questions/54970093/could-pattern-matching-in-do-notation-enumfromto-slow-down-a-haskell-code/54970783#54970783", "title": "Could pattern-matching in do-notation/enumFromTo slow down a Haskell code?", "body": "<p>The two functions seem to have a completely different implementation:</p>\n\n<pre><code>c m l = do\n      n   &lt;- [l..m]\n      res &lt;- c (n - 1) (l - 1)\n      return $ n:res\n</code></pre>\n\n<p>Here, at every recursive call, the parameter <code>l</code> gets decremented, while the parameter <code>m</code> becomes <code>n &lt;- [l--m]</code>.</p>\n\n<p>By comparison,</p>\n\n<pre><code>helper a b l = do\n    n    &lt;- [a..b]\n    True &lt;- return $ (l - 1 &lt;= n)\n    res  &lt;- helper a (n - 1) (l - 1)\n    return (n:res)\n</code></pre>\n\n<p>Here the interval is <code>[a..b]</code> instead of <code>[l..m]</code> (why do you use different names, by the way? It's harder to compare the two snippets in that way.) So, we consider how parameters <code>a</code> and <code>b</code> change. Parameter <code>a</code> is unchanged, while <code>b</code> becomes <code>n-1</code>.</p>\n\n<p>There's also a third argument <code>l</code> which was not present in the first snippet.</p>\n\n<p>I fail to see how this would be the same algorithm. It looks completely different to me. You probably are causing more recursive calls here, which slow things down. Pattern matching is a red herring -- I think it's not that that's slowing things down, at least not directly.</p>\n\n<p>Also, this part</p>\n\n<pre><code>    n    &lt;- [a..b]\n    True &lt;- return $ (l - 1 &lt;= n)\n</code></pre>\n\n<p>looks very suspicious. It should be something like</p>\n\n<pre><code>    n    &lt;- [max a (l-1) .. b]\n</code></pre>\n\n<p>since the above will count from <code>a</code> to <code>l-2</code> only to discard those choices in the next line. Generating choices only to discard them can slow your program down.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1551723971, "creation_date": 1551723971, "answer_id": 54989344, "question_id": 54970093, "link": "https://stackoverflow.com/questions/54970093/could-pattern-matching-in-do-notation-enumfromto-slow-down-a-haskell-code/54989344#54989344", "title": "Could pattern-matching in do-notation/enumFromTo slow down a Haskell code?", "body": "<p>Changing your <code>True &lt;- return $ (l - 1 &lt;= n)</code> to <code>True &lt;- return $ (l &lt;= n)</code>, to match what the first snippet does, equalizes the timings of the two for me (without changing the answer).</p>\n\n<p>Without this change, your second snippet wastes a lot of time trying to find decreasing sequences of length <code>l</code> among the numbers <code>[1..l-1]</code> (for many different values of <code>l</code>), a doomed task.</p>\n"}], "owner": {"reputation": 1672, "user_id": 11143763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWExJ.png?s=128&g=1", "display_name": "Zhiltsoff Igor", "link": "https://stackoverflow.com/users/11143763/zhiltsoff-igor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 54989344, "answer_count": 2, "score": 0, "last_activity_date": 1551899609, "creation_date": 1551624702, "last_edit_date": 1551899609, "question_id": 54970093, "link": "https://stackoverflow.com/questions/54970093/could-pattern-matching-in-do-notation-enumfromto-slow-down-a-haskell-code", "title": "Could pattern-matching in do-notation/enumFromTo slow down a Haskell code?", "body": "<p>I've been solving a pretty easy problem: generation of all decreasing sequences in length of <code>L</code>, consisting of natural numbers from <code>1</code> up to <code>M</code> in lexicographical order.\nYet, I ran into a <em>quite strange</em> issue. Take a look:</p>\n\n<pre><code>c :: (Ord a, Num a, Enum a) =&gt; a -&gt; a -&gt; [[a]]\nc m 1 = map return [1..m]\nc m l = do\n          n   &lt;- [l..m]\n          res &lt;- c (n - 1) (l - 1)\n          return $ n:res\n\nc' :: (Ord a, Num a, Enum a) =&gt; a -&gt; a -&gt; [[a]]\nc' m = helper 1 m where\n helper :: (Ord a, Num a, Enum a) =&gt; a -&gt; a -&gt; a -&gt; [[a]]\n helper a b 1 = map return [a..b]\n helper a b l = do\n                  n    &lt;- [a..b]\n                  True &lt;- return $ (l - 1 &lt;= n)\n                  res  &lt;- helper a (n - 1) (l - 1)\n                  return (n:res)\n</code></pre>\n\n<p>So, obviously, those 2 functions do absolutely the same thing (I checked them on a number of tests, they both give correct results on each), but if you try to evaluate <code>c 100 98</code> and <code>c' 100 98</code> in GHCi, you will see an enormous difference in time it takes:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HxIOz.jpg\" rel=\"nofollow noreferrer\">c 100 98: around 5 seconds</a>;</p>\n\n<p><a href=\"https://i.stack.imgur.com/VroXv.jpg\" rel=\"nofollow noreferrer\">c' 100 98: around 70 seconds</a>;</p>\n\n<p><a href=\"https://i.stack.imgur.com/gJqxt.jpg\" rel=\"nofollow noreferrer\">As I've mentioned, the result is the same</a>.</p>\n\n<p>So, I kind of feel uneasy about generating <code>[a..b]</code> every time, yet I did a small bit of asking around, and there was a suggestion that Haskell doesn't pattern-match right off the bat, but delays it due to lazy-evaluations, which causes a formidable amount of extra calls of <code>c'</code>. However, the second theory didn't quite hold: I set a breakpoint in my code, directly from the GHCi command prompt, to monitor the value of <code>n</code>, which showed that delayed pattern-matching wasn't the case.</p>\n\n<p>Could the problem be actually with the <code>enumFromTo</code> function, or is there any other reason? </p>\n"}, {"tags": ["haskell", "matrix"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8902801"}, "edited": false, "score": 0, "creation_date": 1551624210, "post_id": 54969868, "comment_id": 96699537, "body": "somehow im getting compiler error, did you test it?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1551624346, "post_id": 54969868, "comment_id": 96699572, "body": "@mWelt: I think you confuse your <code>Matrix</code> data type and the signature of your function."}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1551624521, "post_id": 54969868, "comment_id": 96699627, "body": "@mWelt, this is written for the underlying list type, and it shouldn&#39;t be hard to make this work for <code>Matrix</code>: some pattern matching should do the trick."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8902801"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1551624710, "post_id": 54969868, "comment_id": 96699693, "body": "you both are right, i saw where i failed. thanks @WillemVanOnsem exactly was my confusing point"}], "tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": false, "score": 1, "last_activity_date": 1551624899, "last_edit_date": 1551624899, "creation_date": 1551623401, "answer_id": 54969868, "question_id": 54969799, "link": "https://stackoverflow.com/questions/54969799/how-to-accessing-specific-matrix-element-or-with-specific-index-haskell/54969868#54969868", "title": "How to accessing specific matrix element or with specific index Haskell", "body": "<p>For each sublist, extract its <code>n</code>th element with the <code>!!</code> operator:</p>\n\n<pre><code>rowMatrix [] _ = []\nrowMatrix (row:others) n = (row !! n) : (rowMatrix others n)\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>rowMatrix [[1,2,3], [2,3,4]] 2\n[3,4]\n</code></pre>\n\n<p>You can also make this a bit crazier, but also more concise:</p>\n\n<pre><code>rowMatrix :: [[a]] -&gt; Int -&gt; [a]\nrowMatrix listOfLists n = listOfLists &gt;&gt;= ((:[]) . (!! n))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1551624258, "creation_date": 1551624258, "answer_id": 54970019, "question_id": 54969799, "link": "https://stackoverflow.com/questions/54969799/how-to-accessing-specific-matrix-element-or-with-specific-index-haskell/54970019#54970019", "title": "How to accessing specific matrix element or with specific index Haskell", "body": "<p>We can, for each row, obtain the <code>k</code>-th element, so we can perform a mapping, like:</p>\n\n<pre><code>romMatrix :: [[a]] -&gt; Int -&gt; [a]\nrowMatrix m k = map (!! k) m\n</code></pre>\n\n<p>Or for a <code>Matrix</code> type:</p>\n\n<pre><code>romMatrix :: Matrix a -&gt; Int -&gt; [a]\nrowMatrix (M m) k = map (!! k) m\n</code></pre>\n\n<p>So here we create a list of elements where each element is the <code>k</code>-th element of the corresponding sublist.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8902801"}, "edited": false, "score": 0, "creation_date": 1551638807, "post_id": 54971450, "comment_id": 96704101, "body": "Actually it works with my type too, input does not have to be Int, could be any list of a. but your solution is also cool."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551640667, "post_id": 54971450, "comment_id": 96704671, "body": "in that case, it should be <code>[[a]] -&gt; Int -&gt; [a]</code>."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1551640715, "last_edit_date": 1551640715, "creation_date": 1551633000, "answer_id": 54971450, "question_id": 54969799, "link": "https://stackoverflow.com/questions/54969799/how-to-accessing-specific-matrix-element-or-with-specific-index-haskell/54971450#54971450", "title": "How to accessing specific matrix element or with specific index Haskell", "body": "<p>Since rows are columns in the transposed matrix; to fit with your example; it is just</p>\n\n<pre><code>rowMatrix :: [[a]] -&gt; Int -&gt; [a]\nrowMatrix xs m = transpose xs !! (m-1)\n</code></pre>\n\n<p>I had to fix your type, too. Also note the off-by-1 issue.</p>\n\n<pre><code>&gt; rowMatrix [[1,2,3,4], [5,6,7,8], [9,10,11,12]]  3\n[3,7,11]\nit :: [Int]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8902801"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "accepted_answer_id": 54970019, "answer_count": 3, "score": 2, "last_activity_date": 1551640715, "creation_date": 1551622959, "question_id": 54969799, "link": "https://stackoverflow.com/questions/54969799/how-to-accessing-specific-matrix-element-or-with-specific-index-haskell", "title": "How to accessing specific matrix element or with specific index Haskell", "body": "<p>I'm trying to access specific element of matrix. For instance to get every second element of sublist and give as single list back.</p>\n\n<pre><code>data Matrix a = M [[a]]\nrowMatrix :: [[Int]] -&gt; Int -&gt; a\n</code></pre>\n\n<p>for ex  <code>rowMatrix [[1,2,3,4], [5,6,7,8],[9,10,11,12]]  3 ---&gt; [3,7,11]</code></p>\n"}, {"tags": ["performance", "haskell", "ghc", "type-families"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1551641832, "post_id": 54969045, "comment_id": 96705030, "body": "The original compile time is already awful. I would recommend opening a ticket on the GHC trac, especially since this is a pretty small self-contained example."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 1, "creation_date": 1551646771, "post_id": 54969045, "comment_id": 96706476, "body": "When you moved <code>fromPhase1ToPhase2</code> to top level, did you also put its signature at top level? With a big type level list like <code>Phase01</code>, type inference (without a signature) is much harder than type checking (with a signature, even partial)."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551647633, "post_id": 54969045, "comment_id": 96706692, "body": "@AntC Yes, the ~ 29 seconds are with the top-level signature."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1551651763, "post_id": 54969045, "comment_id": 96707814, "body": "Opened GHC ticket <a href=\"https://ghc.haskell.org/trac/ghc/ticket/16382\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/16382</a>"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1578332154, "post_id": 54969045, "comment_id": 105396341, "body": "It seems that the slowdown has to do with the example module&#39;s export list. If I write <code>module Main (main) where</code> instead of exporting everything, the slowdown disappears, even if the function <code>fromPhase1ToPhase2</code> is at top level. <a href=\"https://gitlab.haskell.org/ghc/ghc/issues/16382#note_244810\" rel=\"nofollow noreferrer\">gitlab.haskell.org/ghc/ghc/issues/16382#note_244810</a>"}], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1551624786, "creation_date": 1551617821, "last_edit_date": 1551624786, "question_id": 54969045, "link": "https://stackoverflow.com/questions/54969045/lifting-a-function-to-the-top-level-causes-compilation-time-to-triple", "title": "Lifting a function to the top level causes compilation time to triple", "body": "<p>I'm using GHC 8.4.2 on Windows. I have this program that depends on the library <a href=\"http://hackage.haskell.org/package/red-black-record\" rel=\"nofollow noreferrer\">red-black-record</a>, version <a href=\"http://hackage.haskell.org/package/red-black-record-2.0.2.2\" rel=\"nofollow noreferrer\">2.0.2.2</a>:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, TypeApplications #-}\nmodule Main where\n\nimport Data.RBR (FromList,Delete,Variant,I,injectI,winnowI,match)\n\nimport GHC.TypeLits\n\ntype Phase01 = FromList '[ \n      '(\"ctor1\",Int),   '(\"ctor2\",Bool),  '(\"ctor4\",Char),  '(\"ctor3\",Char),\n      '(\"ctor6\",Char),  '(\"ctor5\",Char),  '(\"ctor10\",Char), '(\"ctor11\",Char),\n      '(\"ctor13\",Char), '(\"ctor14\",Char), '(\"ctor39\",Char), '(\"ctor46\",Char),\n      '(\"ctor47\",Char), '(\"ctor44\",Char), '(\"ctor43\",Char), '(\"ctor7\",Char),\n      '(\"ctor9\",Char),  '(\"ctor20\",Char), '(\"ctor45\",Char), '(\"ctor21\",Char),\n      '(\"ctor48\",Char), '(\"ctor49\",Char), '(\"ctor50\",Char), '(\"ctor41\",Char),\n      '(\"ctor33\",Char), '(\"ctor32\",Char), '(\"ctor42\",Char), '(\"ctor22\",Char),\n      '(\"ctor23\",Char), '(\"ctor8\",Char),  '(\"ctor40\",Char), '(\"ctor29\",Char),\n      '(\"ctor24\",Char), '(\"ctor38\",Char), '(\"ctor25\",Char), '(\"ctor26\",Char),\n      '(\"ctor27\",Char), '(\"ctor28\",Char), '(\"ctor36\",Char), '(\"ctor52\",Char),\n      '(\"ctor51\",Char), '(\"ctor53\",Char), '(\"ctor12\",Char), '(\"ctor54\",Char),\n      '(\"ctor15\",Char), '(\"ctor31\",Char), '(\"ctor30\",Char), '(\"ctor34\",Char),\n      '(\"ctor35\",Char), '(\"ctor17\",Char), '(\"ctor16\",Char), '(\"ctor18\",Char),\n      '(\"ctor19\",Char), '(\"ctor37\",Char)\n      ]\n\ntype Phase02 = Delete \"ctor1\" Int Phase01\n\nmain :: IO ()\nmain = print (match @\"ctor17\" (fromPhase1ToPhase2 (injectI @\"ctor1\" 2)))\n    where\n    fromPhase1ToPhase2 :: Variant I Phase01 -&gt; Variant I Phase02\n    fromPhase1ToPhase2 v = case winnowI @\"ctor1\" @Int v of \n        Right z -&gt; injectI @\"ctor2\" False\n        Left l -&gt; l\n</code></pre>\n\n<p>(The library itself is not important, except as an example of code that makes heavy use of type families.)</p>\n\n<p>This code takes <strong>~ 9 seconds</strong> to compile on my machine. But when I try to move the <code>fromPhase1ToPhase2</code> function out of the <code>where</code> clause and make it a top-level function, compilation time spikes to <strong>~ 29 seconds</strong>!</p>\n\n<p>Is there a reason why lifting a function to the top level makes it compile slower?</p>\n\n<p><strong>Edit:</strong> as another data point, moving the function to the top-level but using <code>-XPartialTypeSignatures</code> like this:</p>\n\n<pre><code>{-# LANGUAGE PartialTypeSignatures #-}\n{-# OPTIONS_GHC -Wno-partial-type-signatures #-}\n\nfromPhase1ToPhase2 :: Variant I _ -&gt; Variant I _\nfromPhase1ToPhase2 v = case winnowI @\"ctor1\" @Int @Phase01 v of \n    Right z -&gt; injectI @\"ctor2\" False\n    Left l -&gt; l\n</code></pre>\n\n<p>keeps the original compilation time of <strong>~ 9 seconds</strong>.</p>\n"}, {"tags": ["haskell", "functional-programming", "guard-statement"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1551614912, "post_id": 54968570, "comment_id": 96697071, "body": "This is unclear. What do you mean by &quot;f 5 executing to 7 and then 8&quot;. <code>f</code> is a function, so if <code>f 5 = 7</code>, that can&#39;t also be <code>= 8</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9156598"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1551615159, "post_id": 54968570, "comment_id": 96697125, "body": "Just edited the post to make it clearer"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1551615944, "post_id": 54968570, "comment_id": 96697326, "body": "This makes no sense. You can&#39;t &quot;execute&quot; 7 or 8."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551619199, "post_id": 54968570, "comment_id": 96698188, "body": "There are no statements in Haskell. In general, executing both <code>g x</code> and <code>h x</code> without any notion of how to combine the results in some way makes no sense. If you are only executing <code>g</code> and <code>h</code> for their side effects, then there is probably a monad involved somehow."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1551628941, "post_id": 54968570, "comment_id": 96700855, "body": "Please try to give a function signature. That will help you + us."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1551617605, "last_edit_date": 1551617605, "creation_date": 1551617296, "answer_id": 54968969, "question_id": 54968570, "link": "https://stackoverflow.com/questions/54968570/execute-multiple-statements-based-on-boolean-conditions-in-haskell/54968969#54968969", "title": "Execute multiple statements based on boolean conditions in Haskell", "body": "<p>In pure functional programming, we do not execute statement as we do in imperative programming. there is no notion of \"do this, then do that\". Instead, we mainly write functions that take a few arguments as input, and return some output.</p>\n\n<p>What if we do want to interact with the world, instead of just computing a return value? Well, in this specific case, we resort to the IO monad. Note that this is not something that we do frequently -- we prefer to avoid the IO monad as much as possible, so to keep most of the computation pure.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>f :: Int -&gt; IO ()\nf x = do\n   putStrLn \"hello\"\n   if x &gt; 15\n   then putStrLn \"&gt; 15\"\n   else putStrLn \"not &gt; 15\"\n   if x &gt; 10\n   then putStrLn \"&gt; 10\"\n   else putStrLn \"not &gt; 10\"\n</code></pre>\n\n<p>If you are a beginner, I would recommend you learn the Haskell basics before using the IO monad. Using the IO monad everywhere would lead to very unidiomatic code.</p>\n\n<p>Most imperative programmers learning FP try to shoehorn their previous habits into FP languages -- it's very common. However, programming with side-effects and mutable variables does not cope well with FP. One gradually need to stop thinking in terms of effectful statements, and instead rewire one's brain so to think in terms of values and (often recursive) definitions.</p>\n\n<p>Note that FP is not special in this aspect. If one learned pure FP first, say in Haskell, and then approached any imperative programming language, they would probably ask thinks like \"how do I use a state monad?\". Even if you could use a state monad in -say- Java, that would be silly, since using mutable variables would be far more natural. Again, the programming is trying to shoehorn their previous methods into the new language/paradigm, ignoring the new features, and producing unidiomatic code.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 4, "last_activity_date": 1551617558, "creation_date": 1551617558, "answer_id": 54969001, "question_id": 54968570, "link": "https://stackoverflow.com/questions/54968570/execute-multiple-statements-based-on-boolean-conditions-in-haskell/54969001#54969001", "title": "Execute multiple statements based on boolean conditions in Haskell", "body": "<blockquote>\n  <p>\"for example f 5 executing g x and then also executing h x\"</p>\n</blockquote>\n\n<p>And returning what? We have to return some <em>value</em>, that's how Haskell's <em>e-valu-ation</em> goes.</p>\n\n<p>If you want both of the statements' values, you can combine them by putting them in a list:</p>\n\n<pre><code>f x = [ g x | x &lt; 10 ] ++ [ h x | x &lt; 15 ] ++ [ m x | True ]\n</code></pre>\n\n<p>This list will contain all the results for which the expression to the right of their <code>|</code> (list comprehension guards) evaluate to <code>True</code>. <code>++</code> adds two lists together into one. <code>True</code> trivially evaluates to <code>True</code> so can be omitted: <code>[ m x ]</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9156598"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 54968969, "answer_count": 2, "score": -1, "last_activity_date": 1551617605, "creation_date": 1551614468, "last_edit_date": 1551616852, "question_id": 54968570, "link": "https://stackoverflow.com/questions/54968570/execute-multiple-statements-based-on-boolean-conditions-in-haskell", "title": "Execute multiple statements based on boolean conditions in Haskell", "body": "<p>I am new to Haskell I am trying to execute multiple statements if the several boolean values are true. I tried it using guards but it only executes the first statement that is true and it stops. I want it to execute all of them that are true, for example f 5 executing g x and then also executing h x. I tried it using if statements but I couldn't.</p>\n\n<pre><code>f x\n\n  | x &lt; 10 = g x\n\n  | x &lt; 15 = h x\n\n  | otherwise = m x\n</code></pre>\n\n<p>This is just a simplification, I actually have a different program. The cases are different, I am just trying to have multiple if statements like in other programming languages. So in this example, if x &lt; 10 then do something, ALSO if x &lt; 15 also do this.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1551593212, "post_id": 54966004, "comment_id": 96692506, "body": "As it stands, your code does not compile since the class has no parameters."}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 7, "last_activity_date": 1551594162, "last_edit_date": 1551594162, "creation_date": 1551593683, "answer_id": 54966103, "question_id": 54966004, "link": "https://stackoverflow.com/questions/54966004/nested-ambiguously-typed-methods/54966103#54966103", "title": "Nested ambiguously typed methods", "body": "<p>Yes, you can do exactly this - <code>tag1 @a</code>, but you need to make two modifications: enable <code>ScopedTypeVariables</code> and add an explicit <code>forall</code>, like this:</p>\n\n<pre><code>tag2 :: forall a. T a =&gt; String \ntag2 = tag1 @a ++ \" suffix\"\n</code></pre>\n\n<p>The explicit <code>forall</code> is what creates a scope for the type variable <code>a</code>, making it accessible in the whole body of <code>tag2</code>. Without it (i.e. by the standard Haskell 2010 rules) the type variable is scoped only to the type signature and is inaccessible in the body.</p>\n\n<p>If you'd like to have <code>tag2</code> as a class method, rather than a standalone function, you can add a default implementation for it like this:</p>\n\n<pre><code>class T a where\n    tag1 :: String\n\n    tag2 :: String\n    tag2 = tag1 @a ++ \" suffix\"\n</code></pre>\n\n<p>In this case you don't need to provide an explicit <code>forall</code>. Instead, the scope of the type variable will be the whole class instance. But you still need <code>ScopedTypeVariables</code>, otherwise there will be no scope at all.</p>\n"}, {"comments": [{"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1551602409, "post_id": 54966126, "comment_id": 96694218, "body": "I did indeed make a mistake when typing it out. Both answers were great, but I will accept yours as I believe you answered first. I was not aware of the language flag"}], "tags": [], "owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "is_accepted": true, "score": 8, "last_activity_date": 1551593898, "creation_date": 1551593898, "answer_id": 54966126, "question_id": 54966004, "link": "https://stackoverflow.com/questions/54966004/nested-ambiguously-typed-methods/54966126#54966126", "title": "Nested ambiguously typed methods", "body": "<p>Your code currently does not compile since the type class has no type parameters, so I'm going to assume your code is actually (assuming <code>AllowAmbiguousTypes</code> is enabled)  </p>\n\n<pre><code>class T a where\n    tag1 :: String\n    tag2 :: String\n</code></pre>\n\n<p>Now you can provide a default implementation for <code>tag2</code>:</p>\n\n<pre><code>class T a where\n    tag1 :: String\n    tag2 :: String\n    tag2 = \"tag2\"\n</code></pre>\n\n<p>But this does not meet the requirement of adding the suffix to <code>tag1</code>.<br>\nWe could try this(assuming <code>TypeApplications</code> is enabled):</p>\n\n<pre><code>class T a where\n    tag1 :: String\n    tag2 :: String\n    tag2 = tag1 @a ++ \"suffix\"\n</code></pre>\n\n<p>Now this <em>won't</em> compile, and the compilation error will be  </p>\n\n<pre><code>error: Not in scope: type variable `a'\n</code></pre>\n\n<p>and rightfully so, the type <code>a</code> isn't defined anywhere. However, we want to refer to the <code>a</code> in the head of the class, for this we need the language extension <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#lexically-scoped-type-variables\" rel=\"noreferrer\"><code>ScopedTypeVariables</code></a>, and with that the code will compile and you'll get the results you expect (I suggest reading up the linked documentation)  </p>\n\n<p>Here's a full program that demonstrates the usage:</p>\n\n<pre><code>{-# LANGUAGE TypeApplications, AllowAmbiguousTypes, ScopedTypeVariables #-}\n\nclass T a where\n  tag1 :: String\n  tag2 :: String\n  tag2 = tag1 @a ++ \" suffix\"\n\ndata A = A\ndata B = B\n\ninstance T A where\n  tag1 = \"tagA\"\n\ninstance T B where\n  tag1 = \"tagB\"\n  tag2 = \"tagB overriden\"\n\nmain = do\n  putStrLn $ tag1 @A\n  putStrLn $ tag2 @A\n  putStrLn $ tag1 @B\n  putStrLn $ tag2 @B\n</code></pre>\n\n<p>And the output is:  </p>\n\n<pre><code>&gt; ./foo\ntagA\ntagA suffix\ntagB\ntagB overriden\n</code></pre>\n"}], "owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 54966126, "answer_count": 2, "score": 2, "last_activity_date": 1551594162, "creation_date": 1551592577, "question_id": 54966004, "link": "https://stackoverflow.com/questions/54966004/nested-ambiguously-typed-methods", "title": "Nested ambiguously typed methods", "body": "<p>Say I have a class</p>\n\n<pre><code>class T where\n    tag1 :: String\n    tag2 :: String\n</code></pre>\n\n<p>With ambiguous types enabled, I could specify each of them in an instance:</p>\n\n<pre><code>instance T A where\n    tag1 = \"tag1\"\n    tag2 = \"tag2\"\n</code></pre>\n\n<p>If I want to make <code>tag2</code> append something to <code>tag1</code>, I can define</p>\n\n<pre><code>instance T A where \n    tag1 = \"tag1\"\n    tag2 = tag1 @A ++ \" suffix\"\n</code></pre>\n\n<p>This works great, but if I want <code>tag2</code> to always append <code>suffix</code> to each <code>tag1</code>, I seem to have to specify the ambiguous call for each instance.</p>\n\n<p>I understand the need for this, as <code>tag1</code> from any instance would work for each call. However, is there any trick within haskell for me to specify it once only?</p>\n\n<p>Something like</p>\n\n<pre><code>tag2 :: T a =&gt; String\ntag2 = tag1 @a ++ \" suffix\"\n</code></pre>\n"}, {"tags": ["api", "haskell"], "comments": [{"owner": {"reputation": 725, "user_id": 5309823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y9956.png?s=128&g=1", "display_name": "cole", "link": "https://stackoverflow.com/users/5309823/cole"}, "edited": false, "score": 0, "creation_date": 1551579021, "post_id": 54964875, "comment_id": 96690557, "body": "Have you checked the documentation? <a href=\"https://hackage.haskell.org/package/quandl-api-0.2.1.0/docs/Data-Quandl.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/quandl-api-0.2.1.0/docs/&hellip;</a> The function you\u2019re using is the first one described."}, {"owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "reply_to_user": {"reputation": 725, "user_id": 5309823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y9956.png?s=128&g=1", "display_name": "cole", "link": "https://stackoverflow.com/users/5309823/cole"}, "edited": false, "score": 1, "creation_date": 1551579417, "post_id": 54964875, "comment_id": 96690610, "body": "Yes, I saw that.  I am so new to this that I don&#39;t know what to do with that information.  I&#39;m guessing that &quot;EOD&quot; is the incorrect &quot;source&quot; name, but I&#39;m not sure how to find the correct list of source names."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1551581009, "post_id": 54964875, "comment_id": 96690851, "body": "<a href=\"https://www.quandl.com/search\" rel=\"nofollow noreferrer\">quandl.com/search</a> is where you can search for a Quandl source/code"}, {"owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "edited": false, "score": 0, "creation_date": 1551581382, "post_id": 54964875, "comment_id": 96690894, "body": "Right, but for example I am testing it with this: <a href=\"https://www.quandl.com/data/EOD-End-of-Day-US-Stock-Prices/documentation\" rel=\"nofollow noreferrer\">quandl.com/data/EOD-End-of-Day-US-Stock-Prices/documentation</a> -- and I see that I could change the parameters to <code>EOD&#47;MSFT</code>, but I don&#39;t know what to replace <code>getTable</code> with."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1551635155, "post_id": 54964875, "comment_id": 96702879, "body": "So what is the actual <i>single</i> question you have?"}, {"owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "edited": false, "score": 0, "creation_date": 1551635250, "post_id": 54964875, "comment_id": 96702902, "body": "Assuming <code>getTable</code> is the command I want, I don&#39;t know how to identify the string that Quandl uses to identify the EOD source."}, {"owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "edited": false, "score": 0, "creation_date": 1551646609, "post_id": 54964875, "comment_id": 96706428, "body": "Even when I use the FRED/GDP example in the hackage docs, I get <code>Nothing</code> back."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1551735646, "post_id": 54964875, "comment_id": 96741323, "body": "You&#39;re not literally using <code>&quot;my_key&quot;</code>, are you? I suspect that supposed to be some sort of API key"}, {"owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "edited": false, "score": 0, "creation_date": 1551735699, "post_id": 54964875, "comment_id": 96741346, "body": "No, I wasn&#39;t.  It turned out that there was an issue with the Hackage version of the API.  I cloned from GitHub and it worked :)"}], "owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551577894, "creation_date": 1551577894, "question_id": 54964875, "link": "https://stackoverflow.com/questions/54964875/cant-understand-why-my-haskell-api-call-script-returns-nothing", "title": "Can&#39;t understand why my Haskell API call script returns &quot;Nothing&quot;", "body": "<p>I am super new to Haskell and trying to write an API integration worker that grabs data from Quandl.</p>\n\n<p>This is my main.hs file:</p>\n\n<pre><code>module Main where\n\nimport Data.Quandl\n\nmain = do\n    result &lt;- getTable \"EOD\" \"AAPL\" (Just \"my_key\")\n    print result\n</code></pre>\n\n<p>When I run it in ghci like this:</p>\n\n<pre><code>Prelude&gt; :l main\n[1 of 1] Compiling Main             ( main.hs, interpreted )\n*Main&gt; main\n</code></pre>\n\n<p>It seems to do something behind the schenes for a few seconds, then it returns this:</p>\n\n<pre><code>Nothing\n</code></pre>\n\n<p>Does anyone know why this might be?</p>\n"}, {"tags": ["haskell", "function-composition"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1551568629, "post_id": 54963972, "comment_id": 96688810, "body": "one is just the &quot;pointfree&quot; version of the other. Use the definition of composition: <code>(f . g) x = f (g x)</code> and look at what happens when you apply <code>g</code> to <code>s</code>."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1551576512, "post_id": 54963972, "comment_id": 96690116, "body": "I would write <code>isDigit . head</code> instead of <code>isDigit.head</code>."}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 3150464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6994392ca8aa3dc2bc3cfbf83e02044e?s=128&d=identicon&r=PG&f=1", "display_name": "klabe", "link": "https://stackoverflow.com/users/3150464/klabe"}, "edited": false, "score": 0, "creation_date": 1551582096, "post_id": 54964397, "comment_id": 96690999, "body": "Thank you for the explanation. I got confused by the precedence rules. I am sorry I can only accept one answer."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 2, "last_activity_date": 1551591270, "last_edit_date": 1551591270, "creation_date": 1551572412, "answer_id": 54964397, "question_id": 54963972, "link": "https://stackoverflow.com/questions/54963972/need-help-to-understand-how-this-function-composition-works/54964397#54964397", "title": "Need help to understand how this function composition works", "body": "<p>Function composition operator <code>.</code> is defined like this:</p>\n\n<pre><code>(.) f g = \\x -&gt; f (g x)\n</code></pre>\n\n<p>Or, the same thing in infix form:</p>\n\n<pre><code>f . g = \\x -&gt; f (g x)\n</code></pre>\n\n<p>In English this can be expressed like this: <em>composition of two functions <code>f</code> and <code>g</code> is another function that takes an argument <code>x</code>, passes it to function <code>g</code>, and then passes the return value of <code>g</code> to function <code>f</code></em></p>\n\n<p>If you look at your first snippet:</p>\n\n<pre><code>let f s = filter (isDigit.head) (groupBy (on (==) isDigit) s)\n</code></pre>\n\n<p>If your squint hard enough, you can see that it's a function that takes argument <code>s</code>, passes it to function <code>groupBy (on (==) isDigit)</code>, and then passes the return value to function <code>filter (isDigit.head)</code></p>\n\n<p>Which, according to my explanation above, can be expressed as a composition of two functions - <code>filter (isDigit.head)</code> and <code>groupBy (on (==) isDigit)</code>, which is what your second snippet is.</p>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 3150464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6994392ca8aa3dc2bc3cfbf83e02044e?s=128&d=identicon&r=PG&f=1", "display_name": "klabe", "link": "https://stackoverflow.com/users/3150464/klabe"}, "edited": false, "score": 0, "creation_date": 1551582049, "post_id": 54964499, "comment_id": 96690988, "body": "Thank you. I got confused by the precedence rules. I thought (isDigit.head) . groupBy (on (==) isDigit) was the predicate. Now I got it."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 355, "user_id": 3150464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6994392ca8aa3dc2bc3cfbf83e02044e?s=128&d=identicon&r=PG&f=1", "display_name": "klabe", "link": "https://stackoverflow.com/users/3150464/klabe"}, "edited": false, "score": 0, "creation_date": 1551592556, "post_id": 54964499, "comment_id": 96692418, "body": "@klabe That&#39;s correct. In general, function application binds tighter than any operator, so e.g. <code>f a ++ g b</code> is the same as <code>(f a) ++ (g b)</code>."}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 1, "last_activity_date": 1551573603, "creation_date": 1551573603, "answer_id": 54964499, "question_id": 54963972, "link": "https://stackoverflow.com/questions/54963972/need-help-to-understand-how-this-function-composition-works/54964499#54964499", "title": "Need help to understand how this function composition works", "body": "<p>Firstly, your code, for reference:</p>\n\n<pre><code>let f s = filter (isDigit.head)  (groupBy (on (==) isDigit) s)\nlet g   = filter (isDigit.head) . groupBy (on (==) isDigit)\n</code></pre>\n\n<p>(I've formatted it slightly to emphasize the similarities.)</p>\n\n<p>To help us a bit, let's now define some synonyms for the functions in your definitions:</p>\n\n<pre><code>let whereFirstIsDigit = filter (isDigit.head)\nlet groupByDigit      = groupBy (on (==) isDigit))\n</code></pre>\n\n<p>Now we can rewrite the original functions as follows:</p>\n\n<pre><code>let f s = whereFirstIsDigit  (groupByDigit s)\nlet g   = whereFirstIsDigit . groupByDigit\n</code></pre>\n\n<p>Now let's look at what's happening here. <code>f</code> takes <code>s</code>, feeds it to <code>groupByDigit</code>, and then feeds the result of that to <code>whereFirstIsDigit</code>. But the function composition of (say) <code>x . y</code> is defined to be the function which feeds its input to <code>y</code>, and then feeds that result to <code>x</code>! So the two functions are the same.</p>\n"}], "owner": {"reputation": 355, "user_id": 3150464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6994392ca8aa3dc2bc3cfbf83e02044e?s=128&d=identicon&r=PG&f=1", "display_name": "klabe", "link": "https://stackoverflow.com/users/3150464/klabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 54964499, "answer_count": 2, "score": 1, "last_activity_date": 1551591270, "creation_date": 1551568338, "question_id": 54963972, "link": "https://stackoverflow.com/questions/54963972/need-help-to-understand-how-this-function-composition-works", "title": "Need help to understand how this function composition works", "body": "<p>I can understand this line of code without problem</p>\n\n<pre><code>let f s = filter (isDigit.head) (groupBy (on (==) isDigit) s)\n</code></pre>\n\n<p>when I call <code>f \"123abc345\"</code>, it returns <code>[\"123\", \"345\"]</code></p>\n\n<p>But I am having a hard time understanding why the following line of code is the same</p>\n\n<pre><code>let g = filter (isDigit.head) . groupBy (on (==) isDigit)\n</code></pre>\n\n<p>How does this composition work? Thank you very much!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 269, "user_id": 4147767, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e20d2cd614df0b820c4b0389ed011783?s=128&d=identicon&r=PG&f=1", "display_name": "BabaSvoloch", "link": "https://stackoverflow.com/users/4147767/babasvoloch"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1551567500, "post_id": 54963847, "comment_id": 96688562, "body": "@Carcigenicate thank you for the edits, sorry about that"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1551567586, "post_id": 54963847, "comment_id": 96688586, "body": "Np. Just please make sure for future questions that you take care to format your code before posting. Questions are received better when they&#39;re readable. And what errors are you getting? Please edit them into the question."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1551568049, "post_id": 54963847, "comment_id": 96688701, "body": "I would make the tab a list of chords (a list of six element lists), and then <code>Data.List.transpose</code> at the end."}, {"owner": {"reputation": 269, "user_id": 4147767, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e20d2cd614df0b820c4b0389ed011783?s=128&d=identicon&r=PG&f=1", "display_name": "BabaSvoloch", "link": "https://stackoverflow.com/users/4147767/babasvoloch"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1551568176, "post_id": 54963847, "comment_id": 96688723, "body": "@luqui oh wow I didn&#39;t even know that existed. I looked it up and that sounds like exactly what I need. thank you so much"}], "owner": {"reputation": 269, "user_id": 4147767, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e20d2cd614df0b820c4b0389ed011783?s=128&d=identicon&r=PG&f=1", "display_name": "BabaSvoloch", "link": "https://stackoverflow.com/users/4147767/babasvoloch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551572364, "creation_date": 1551567273, "last_edit_date": 1551572364, "question_id": 54963847, "link": "https://stackoverflow.com/questions/54963847/updating-and-returning-a-list-of-strings", "title": "Updating and returning a list of Strings", "body": "<p>I'm trying to make a simple program in Haskell that generates guitar tabs from a user-inputted list of chords. I'm new to Haskell and am having a hard time figuring out some of the basics of lists of Strings.</p>\n\n<p>Tab are of the form:</p>\n\n<pre><code>--1----3--\n\n--1----5--\n\n--1----5--\n\n--3----5--\n\n--3----3--\n\n--1----3--\n</code></pre>\n\n<p>I start with a list of empty Strings that I declare and then add chords to one at a time, in the following form: </p>\n\n<pre><code>[[line1],\n\n [line2],\n\n [line3],\n\n [line4],\n\n [line5],\n\n [line6]]\n</code></pre>\n\n<p>and each time I add a new chord to the tab I'm building, I need to cons the appropriate String for that chord onto each of my six lines</p>\n\n<p>I'm trying to do something like this:</p>\n\n<pre><code>addG :: [String] -&gt; [String]\naddG (a:b:c:d:e:f) = [[a++gOne],[b++gTwo],[c++gThree],[d++gFour],[e++gFive],[f++gSix]]\n</code></pre>\n\n<p>where:</p>\n\n<pre><code>gOne :: String\ngOne = \"---3---\"\n\ngTwo :: String\ngTwo = \"---3---\"\n</code></pre>\n\n<p>etc</p>\n\n<p>With this particular syntax, I get the following error in ghci:</p>\n\n<pre><code>project.hs:40:24: error:\n    Couldn't match expected type 'Char' with actual type '[Char]'\n    In the expression: a ++ gOne\n    In the expression: [a ++ gOne]\n    In the expression: \n        [[a ++ gOne], [b ++ gTwo], [c ++ gThree], [d ++ gFour], ....]\n</code></pre>\n\n<p>I get the exact same error five more times for each of the other Strings b-f.</p>\n"}, {"tags": ["haskell", "integer", "typeerror"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551566078, "post_id": 54963552, "comment_id": 96688224, "body": "this is strange, because I get a similar error (but with <code>?</code> instead of <code>-</code>) when I copy-paste your definition, but typing it myself - character-by-character indentical, so it seems - it works fine. I can only assume that you too are copy-pasting and there&#39;s some kind of invisible control character there?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551566336, "post_id": 54963552, "comment_id": 96688283, "body": "just tried an online diff-checker, it IS highlighting a difference in the final part: <code>..(n\u22121)]]</code>. Still can&#39;t see what it is though. Either way, it seems that this isn&#39;t really a Haskell question at the end of the day."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 4, "creation_date": 1551566614, "post_id": 54963552, "comment_id": 96688351, "body": "found it, it seems your <code>-</code> is actually this: <a href=\"https://www.fileformat.info/info/unicode/char/2212/index.htm\" rel=\"nofollow noreferrer\">fileformat.info/info/unicode/char/2212/index.htm</a> - unicode U+2212, rather than the standard minus sign which is U+002D"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551581499, "post_id": 54963783, "comment_id": 96690915, "body": "But ... perhaps that <i>should</i> be interpreted as a minus sign. That would be a good GHC proposal, methinks."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551592839, "post_id": 54963783, "comment_id": 96692463, "body": "@dfeuer You can still do it using <code>(\u2212) = (-)</code> (the former is a minus, the latter is a hyphen). It works in GHCi, at least. But the benefit is debatable, in a monospace font."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551594949, "post_id": 54963783, "comment_id": 96692800, "body": "The question is whether it should be possible to use minus when declaring a <code>Num</code> instance, which would require a modification to the <code>UnicodeSyntax</code> language extension. There&#39;s no real benefit with a monospaced font, but proportional fonts work fine for Haskell if you format your code in certain ways."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551595226, "post_id": 54963783, "comment_id": 96692848, "body": "@dfeuer Yes, that makes more sense."}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 5, "last_activity_date": 1551566692, "creation_date": 1551566692, "answer_id": 54963783, "question_id": 54963552, "link": "https://stackoverflow.com/questions/54963552/haskell-list-comp-type-error-from-minus-in-defining-range/54963783#54963783", "title": "Haskell List Comp Type Error from Minus in defining range", "body": "<p>It's a simple typographical error. Your <code>\u2212</code> is not a hyphen (which Haskell expects) - it is a Unicode minus-sign character, which is different. Your source must have automatically converted the former to the latter. Just replace it with a hyphen (typed with your keyboard) and it'll work.</p>\n"}], "owner": {"reputation": 167, "user_id": 7838597, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a1c0d8e22c9db4616d73ea8a41b6181c?s=128&d=identicon&r=PG&f=1", "display_name": "J.Ober", "link": "https://stackoverflow.com/users/7838597/j-ober"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 54963783, "answer_count": 1, "score": 0, "last_activity_date": 1551566692, "creation_date": 1551564894, "question_id": 54963552, "link": "https://stackoverflow.com/questions/54963552/haskell-list-comp-type-error-from-minus-in-defining-range", "title": "Haskell List Comp Type Error from Minus in defining range", "body": "<p>Going through older exams, I copied this chunk of code and tried to get it to work.</p>\n\n<pre><code>rems :: Integer -&gt; [(Integer ,Integer )]\nrems n = [(i, n `mod` i) | i &lt;- [2 ..(n\u22121)]]\n</code></pre>\n\n<p>Now with the type declaration or without it I get the error:</p>\n\n<pre><code>Variable not in scope: (\u2212) :: Integer -&gt; Integer -&gt; Integer\nghc version 8.6.3\n</code></pre>\n\n<p>I was able to fix it by doing the calculation of n-1 in a where clause but don't really get why this is a fix. Of course I know what Integer is in Haskell.</p>\n\n<pre><code>rems n = [(i, n `mod` i) | i &lt;- [2 ..j] ]\n        where j =  n-1\n</code></pre>\n\n<p>Could somebody explain to me why this change of seemingly no effect does fix the error and are there other ways?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 2050162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da41badf1bf65b8e0290737c4d707dd4?s=128&d=identicon&r=PG", "display_name": "Boro Sitnikovski", "link": "https://stackoverflow.com/users/2050162/boro-sitnikovski"}, "is_accepted": false, "score": 5, "last_activity_date": 1551553223, "creation_date": 1551553223, "answer_id": 54961970, "question_id": 54961876, "link": "https://stackoverflow.com/questions/54961876/ambiguous-occurrence-error-when-try-to-define-instance-of-a-newtype/54961970#54961970", "title": "Ambiguous occurrence error when try to define instance of a newType", "body": "<p>That's an indentation error. The code should instead be:</p>\n\n<pre><code>newtype MyList a = MyList { getList :: [a] } deriving Show\n\ninstance Functor MyList where\n    fmap f x = MyList (fmap f (getList x))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551562105, "post_id": 54962235, "comment_id": 96687235, "body": "(and as always, the ever unpopular option of writing out in full the explicit separators <code>{ ; }</code> would have prevented this error...)"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 6, "last_activity_date": 1551560211, "last_edit_date": 1551560211, "creation_date": 1551554963, "answer_id": 54962235, "question_id": 54961876, "link": "https://stackoverflow.com/questions/54961876/ambiguous-occurrence-error-when-try-to-define-instance-of-a-newtype/54962235#54962235", "title": "Ambiguous occurrence error when try to define instance of a newType", "body": "<p>No, your instance does not \"supercede\" or otherwise affect the regular list instance. This is merely a syntax confusion.</p>\n\n<p>Haskell syntax is sensitive to indentation. In particular, class instance members should be indented further to the right relative to the word <code>instance</code>, like this:</p>\n\n<pre><code>instance Foo Bar where\n    foo = ...\n</code></pre>\n\n<p>In your case, however, the definition of <code>fmap</code> is not indented this way. The compiler takes this to mean that you're declaring an \"empty\" instance <code>Functor MyList</code> (where \"empty\" means \"without defining any methods\" - which is technically a legal thing to do), and then, after the instance, and separately from it, you define a function named <code>fmap</code>.</p>\n\n<p>Since a function with the same name is already defined in Prelude, the compiler doesn't know which one to pick when you're trying to call it - hence the error.</p>\n\n<p>To fix this, simply indent your <code>fmap</code> definition to the right, like this:</p>\n\n<pre><code>instance Functor MyList where\n    fmap f x = ...\n</code></pre>\n"}], "owner": {"reputation": 716, "user_id": 4118267, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xIgkR.jpg?s=128&g=1", "display_name": "oriaj", "link": "https://stackoverflow.com/users/4118267/oriaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 54962235, "answer_count": 2, "score": -1, "last_activity_date": 1551560211, "creation_date": 1551552687, "question_id": 54961876, "link": "https://stackoverflow.com/questions/54961876/ambiguous-occurrence-error-when-try-to-define-instance-of-a-newtype", "title": "Ambiguous occurrence error when try to define instance of a newType", "body": "<p>I have the following code</p>\n\n<pre><code>newtype MyList a = MyList { getList :: [a] } deriving Show\n\ninstance Functor MyList where\nfmap f x = MyList (fmap f (getList x))\n</code></pre>\n\n<p>And get the following error:</p>\n\n<blockquote>\n  <p>It could refer to either \u2018Prelude.fmap\u2019 imported from \u2018Prelude\u2019 at\n  compile.hs:1:1 (and originally defined in \u2018GHC.Base\u2019) or \u2018Main.fmap\u2019,\n  defined at compile.hs:6:1</p>\n</blockquote>\n\n<p>if I understand right. Is how if the new instance that I create for the new type affect the existing instance for the List [] type. But why it happens? I supposed that the objective of newtype was to create a different instance for the same type</p>\n"}, {"tags": ["haskell", "functional-programming", "applicative"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1551552333, "post_id": 54961639, "comment_id": 96684583, "body": "Sure.  But as always in Haskell, start with the types.  What&#39;s the type of every token there, made fully concrete, assuming <code>Integer</code> for the literals?"}, {"owner": {"reputation": 1053, "user_id": 8812845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/288204486548d8e74fba7430b043cf8f?s=128&d=identicon&r=PG", "display_name": "Allen Han", "link": "https://stackoverflow.com/users/8812845/allen-han"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1551554608, "post_id": 54961639, "comment_id": 96685193, "body": "(+) :: Integer -&gt; Integer -&gt; Integer, (+3) :: Integer -&gt; Integer, (*100) :: Integer -&gt; Integer"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1551558615, "post_id": 54961639, "comment_id": 96686303, "body": "@user6337 You didn&#39;t provide a type for <code>&lt;$&gt;</code> and <code>&lt;*&gt;</code>, which are the interesting ones."}], "answers": [{"tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": true, "score": 6, "last_activity_date": 1551553715, "last_edit_date": 1551553715, "creation_date": 1551552371, "answer_id": 54961829, "question_id": 54961639, "link": "https://stackoverflow.com/questions/54961639/applicative-functor-evaluation-is-not-clear-to-me/54961829#54961829", "title": "Applicative functor evaluation is not clear to me", "body": "<p>It is using the applicative instance for functions. Your code</p>\n\n<pre><code>(+) &lt;$&gt; (+3) &lt;*&gt; (*100) $ 5\n</code></pre>\n\n<p>is evaluated as</p>\n\n<pre>\n( <i>(\\a->b->a+b)</i> <b>&lt;$&gt;</b> <i>(\\c->c+3)</i> &lt;*&gt; <i>(\\d->d*100)</i> ) 5\n( (<b>\\x -></b> <i>(\\a->b->a+b)</i> <b>(</b><i>(\\c->c+3)</i> <b>x)</b>) &lt;*&gt; <i>(\\d->d*100)</i> ) 5\n( (\\x -> <i>(\\a->b->a+b)</i> (<b>x</b>+3)) &lt;*&gt; <i>(\\d->d*100)</i> ) 5\n( (\\x -> b -> (x+3)<b>+</b>b) &lt;*&gt; <i>(\\d->d*100)</i> ) 5\n( <i>(\\x->b->(x+3)+b)</i> <b>&lt;*&gt;</b> <i>(\\d->d*100)</i> ) 5\n(<b>\\y -> (</b><i>(\\x->b->(x+3)+b)</i> <b>y) (</b><i>(\\d->d*100)</i> <b>y)</b>) 5\n(\\y -> (b->(<b>y</b>+3)+b) (<b>y</b>*100)) 5\n(\\y -> (y+3)<b>+</b>(y*100)) 5\n(<b>5</b>+3)+(<b>5</b>*100)\n</pre>\n\n<p>where <code>&lt;$&gt;</code> is <code>fmap</code> or just function composition <code>.</code>, and <code>&lt;*&gt;</code> is <code>ap</code> if you know how it behaves on monads.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1551552913, "creation_date": 1551552913, "answer_id": 54961914, "question_id": 54961639, "link": "https://stackoverflow.com/questions/54961639/applicative-functor-evaluation-is-not-clear-to-me/54961914#54961914", "title": "Applicative functor evaluation is not clear to me", "body": "<p>Let us first take a look how <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-818\" rel=\"noreferrer\"><code>fmap</code></a> and <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-822\" rel=\"noreferrer\"><code>(&lt;*&gt;)</code></a> are defined for a function:</p>\n\n<blockquote>\n<pre><code>instance Functor ((-&gt;) r) where\n    fmap = (.)\n\ninstance Applicative ((-&gt;) a) where\n    pure = const\n    (&lt;*&gt;) f g x = f x (g x)\n    liftA2 q f g x = q (f x) (g x)\n</code></pre>\n</blockquote>\n\n<p>The expression we aim to evaluate is:</p>\n\n<pre><code> (+) &lt;$&gt; (+3) &lt;*&gt; (*100)  $ 5\n</code></pre>\n\n<p>or more verbose:</p>\n\n<pre><code>((+) &lt;$&gt; (+3)) &lt;*&gt; (*100) $ 5\n</code></pre>\n\n<p>If we thus evaluate <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Functor.html#v:-60--36--62-\" rel=\"noreferrer\"><strong><code>(&lt;$&gt;)</code></strong></a>, which is an infix synonym for <code>fmap</code>, we thus see that this is equal to:</p>\n\n<pre><code>(+) . (+3)\n</code></pre>\n\n<p>so that means our expression is equivalent to:</p>\n\n<pre><code>((+) . (+3)) &lt;*&gt; (*100) $ 5\n</code></pre>\n\n<p>Next we can apply the <em>sequential application</em>. Here <code>f</code> is thus equal to <code>(+) . (+3)</code> and <code>g</code> is <code>(*100)</code>. This thus means that we construct a function that looks like:</p>\n\n<pre><code>\\x -&gt; ((+) . (+3)) x ((*100) x)\n</code></pre>\n\n<p>We can now simplify this and rewrite this into:</p>\n\n<pre><code>\\x -&gt; ((+) (x+3)) ((*100) x)\n</code></pre>\n\n<p>and then rewrite it to:</p>\n\n<pre><code>\\x -&gt; (+) (x+3) ((*100) x)\n</code></pre>\n\n<p>We thus have constructed a function that looks like:</p>\n\n<pre><code>\\x -&gt; (x+3) + 100 * x\n</code></pre>\n\n<p>or simpler:</p>\n\n<pre><code>\\x -&gt; 101 * x + 3\n</code></pre>\n\n<p>If we then calculate:</p>\n\n<pre><code>(\\x -&gt; 101*x + 3) 5\n</code></pre>\n\n<p>then we of course obtain:</p>\n\n<pre><code>101 * 5 + 3\n</code></pre>\n\n<p>and thus:</p>\n\n<pre><code>505 + 3\n</code></pre>\n\n<p>which is the expected:</p>\n\n<pre><code>508\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551558115, "post_id": 54962496, "comment_id": 96686148, "body": "for me, it helps to &quot;see&quot; it when we write it as <code>(f &lt;*&gt; g) x = (f x) (g x)</code>. And I would think <code>liftA2</code> plenty idiomatic -- the original motivation being to write this in some sort of fancy parens, like <code>[( f g )] x = (f x) (g x)</code>. IIRC."}, {"owner": {"reputation": 1403, "user_id": 1748746, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/ZMrp9.png?s=128&g=1", "display_name": "Anthony Raimondo", "link": "https://stackoverflow.com/users/1748746/anthony-raimondo"}, "edited": false, "score": 0, "creation_date": 1551559454, "post_id": 54962496, "comment_id": 96686558, "body": "This should be the accepted answer, the others miss the point."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551561736, "post_id": 54962496, "comment_id": 96687137, "body": "@WillNess - perhaps you&#39;re right, I just remembering reading this in the Typeclassopedia: <a href=\"https://wiki.haskell.org/Typeclassopedia#Utility_functions_2\" rel=\"nofollow noreferrer\">wiki.haskell.org/Typeclassopedia#Utility_functions_2</a> (I see I slightly misremembered, it just says that using the other form is &quot;typically better style&quot;). (And yes, it mentions the &quot;square bracket&quot; notation there as well, just above.)"}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 7, "last_activity_date": 1551556892, "creation_date": 1551556892, "answer_id": 54962496, "question_id": 54961639, "link": "https://stackoverflow.com/questions/54961639/applicative-functor-evaluation-is-not-clear-to-me/54962496#54962496", "title": "Applicative functor evaluation is not clear to me", "body": "<p>The other two answers have given the detail of how this is calculated - but I thought I might chime in with a more \"intuitive\" answer to explain how, without going through a detailed calculation, one can \"see\" that the result must be 508.</p>\n\n<p>As you implied, every <code>Applicative</code> (in fact, even every <code>Functor</code>) can be viewed as a particular kind of \"context\" which holds values of a given type. As simple examples:</p>\n\n<ul>\n<li><code>Maybe a</code> is a context in which a value of type <code>a</code> might exist, but might not (usually the result of a computation which may fail for some reason)</li>\n<li><code>[a]</code> is a context which can hold zero or more values of type <code>a</code>, with no upper limit on the number - representing all possible outcomes of a particular computation</li>\n<li><code>IO a</code> is a context in which a value of type <code>a</code> is available as a result of interacting with \"the outside world\" in some way. (OK that one isn't so simple...)</li>\n</ul>\n\n<p>And, relevant to this example:</p>\n\n<ul>\n<li><code>r -&gt; a</code> is a context in which a value of type <code>a</code> is available, but its particular value is not yet known, because it depends on some (as yet unknown) value of type <code>r</code>.</li>\n</ul>\n\n<p>The <code>Applicative</code> methods can be very well understood on the basis of values in such contexts. <code>pure</code> embeds an \"ordinary value\" in a \"default context\" in which it behaves as closely as possible in that context to a \"context-free\" one. I won't go through this for each of the 4 examples above (most of them are very obvious), but I will note that for functions, <code>pure = const</code> - that is, a \"pure value\" <code>a</code> is represented by the function which always produces <code>a</code> no  matter what the source value.</p>\n\n<p>Rather than dwell on how <code>&lt;*&gt;</code> can best be described using the \"context\" metaphor though, I want to dwell on the particular expression:</p>\n\n<pre><code>f &lt;$&gt; a &lt;*&gt; b\n</code></pre>\n\n<p>where <code>f</code> is a function between 2 \"pure values\" and <code>a</code> and <code>b</code> are \"values in a context\". This expression in fact has a synonym as a function: <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#v:liftA2\" rel=\"noreferrer\">liftA2</a>. Although using the <code>liftA2</code> function is generally considered less idiomatic than the \"applicative style\" using <code>&lt;$&gt;</code> and <code>&lt;*&gt;</code>, the name emphasies that the idea is to \"lift\" a function on \"ordinary values\" to one on \"values in a context\". And when thought of like this, I think it is usually very intuitive what this does, given a particular \"context\" (ie. a particular <code>Applicative</code> instance).</p>\n\n<p>So the expression:</p>\n\n<pre><code>(+) &lt;$&gt; a &lt;*&gt; b\n</code></pre>\n\n<p>for values <code>a</code> and <code>b</code> of type say <code>f Int</code> for an Applicative <code>f</code>, behaves as follows for different instances <code>f</code>:</p>\n\n<ul>\n<li>if <code>f = Maybe</code>, then the result, if <code>a</code> and <code>b</code> are both <code>Just</code> values, is to add up the underlying values and wrap them in a <code>Just</code>. If either <code>a</code> or <code>b</code> is <code>Nothing</code>, then the whole expression is <code>Nothing</code>.</li>\n<li>if <code>f = []</code> (the list instance) then the above expression is a list containing all sums of the form <code>a' + b'</code> where <code>a'</code> is in <code>a</code> and <code>b'</code> is in <code>b</code>.</li>\n<li>if <code>f = IO</code>, then the above expression is an IO action that performs all the I/O effects of <code>a</code> followed by those of <code>b</code>, and results in the sum of the <code>Int</code>s produced by those two actions.</li>\n</ul>\n\n<p>So what, finally, does it do if <code>f</code> is the function instance? Since <code>a</code> and <code>b</code> are both functions describing how to get a given <code>Int</code> given an arbitrary (<code>Int</code>) input, it is natural that lifting the <code>(+)</code> function over them should be the function that, given an input, gets the result of both the <code>a</code> and <code>b</code> functions, and then adds the results.</p>\n\n<p>And that is, of course, what it does - and the explicit route by which it does that has been very ably mapped out by the other answers. But the reason why it works out like that - indeed, the very reason we have the instance that <code>f &lt;*&gt; g = \\x -&gt; f x (g x)</code>, which might otherwise seem rather arbitrary (although in actual fact it's one of the very few things, if not the only thing, that will type-check), is so that the instance matches the semantics of \"values which depend on some as-yet-unknown other value, according to the given function\". And in general, I would say it's often better to think \"at a high level\" like this than to be forced to go down to the low-level details of exactly how computations are performed. (Although I certainly don't want to downplay the importance of also being able to do the latter.)</p>\n\n<p>[Actually, from a philosophical point of view, it might be more accurate to say that the definition is as it is just because it's the \"natural\" definition that type-checks, and that it's just happy coincidence that the instance then takes on such a nice \"meaning\". Mathematics is of course full of just such happy \"coincidences\" which turn out to have very deep reasons behind them.]</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 4, "last_activity_date": 1551692125, "last_edit_date": 1551692125, "creation_date": 1551557962, "answer_id": 54962626, "question_id": 54961639, "link": "https://stackoverflow.com/questions/54961639/applicative-functor-evaluation-is-not-clear-to-me/54962626#54962626", "title": "Applicative functor evaluation is not clear to me", "body": "<p>For any applicative,</p>\n\n<pre><code>        a &lt;$&gt; b &lt;*&gt; c  =  liftA2 a b c\n</code></pre>\n\n<p>For functions,</p>\n\n<pre><code>    liftA2 a  b     c      x \n=          a (b x) (c x)          -- by definition;\n=       (a . b) x  (c x)\n=     ((a &lt;$&gt; b) &lt;*&gt; c)    x\n</code></pre>\n\n<p>Thus</p>\n\n<pre><code>        (+) &lt;$&gt; (+3) &lt;*&gt; (*100)  $  5\n=\n  liftA2 (+)   (+3)      (*100)     5\n=\n         (+)  ((+3) 5)  ((*100) 5)\n=\n              (5+3)  +  (5*100)\n</code></pre>\n\n<hr>\n\n<p><em>(the long version of this answer follows.)</em></p>\n\n<p>Pure math has no time. Pure Haskell has no time. Speaking in verbs (\"applicative functor <em>applies</em>\" etc.) can be confusing (\"<em>applies... when?</em>...\").</p>\n\n<p>Instead, <code>(&lt;*&gt;)</code> is a combinator which combines a \"computation\" (denoted by an applicative functor) carrying a function (<em>in some context</em>) and a \"computation\" of the same type, carrying a value (<em>in like context</em>), into one combined \"computation\" that carries out the application of that function to that value (<em>in such context</em>).</p>\n\n<p>\"Computation\" is used to contrast it with a pure Haskell \"calculations\". \"Computations\" might or might not be pure themselves, that's an orthogonal issue. But mainly what it means, is that \"computations\" embody <em>a generalized function call protocol</em>. They might \"do\" something in addition to / as part of / carrying out the application of a function to its argument. Or in types,</p>\n\n<pre><code>    ( $ ) ::   (a -&gt;   b)  -&gt;    a -&gt;   b\n    (&lt;$&gt;) ::   (a -&gt;   b)  -&gt;  f a -&gt; f b\n    (&lt;*&gt;) :: f (a -&gt;   b)  -&gt;  f a -&gt; f b\n    (=&lt;&lt;) ::   (a -&gt; f b)  -&gt;  f a -&gt; f b\n</code></pre>\n\n<p>With functions, the context is application (<em>another</em> one), and to recover the value -- be it a function or an argument -- the application to <em>a common argument</em> is performed.</p>\n\n<p>(bear with me, we're almost there). The pattern <code>a &lt;$&gt; b &lt;*&gt; c</code> is also expressible as <code>liftA2 a b c</code>. And so, the \"functions\" applicative functor \"computation\" type is defined by</p>\n\n<pre><code>   liftA2 h x y s  = let x' = x s            -- embellished application of h to x and y\n                         y' = y s in         -- in context of functions, or Reader\n                      h  x'    y'\n\n-- liftA2 h x y    = let x' = x              -- non-embellished application, or Identity\n--                       y' = y   in         \n--                    h  x'    y'\n\n-- liftA2 h x y s  = let (x',s')  = x s      -- embellished application of h to x and y\n--                       (y',s'') = y s' in  -- in context of\n--                   (h  x'    y', s'')      -- state-passing computations, or State\n\n-- liftA2 h x y    = let (x',w)  = x         -- embellished application of h to x and y\n--                       (y',w') = y  in     -- in context of\n--                   (h  x'    y', w++w')    -- logging computations, or Writer\n\n-- liftA2 h x y    = [h  x'    y' |          -- embellished application of h to x and y\n--                             x' &lt;- x,      -- in context of \n--                             y' &lt;- y ]     -- nondeterministic computations, or List\n\n--  ( and for Monads we define `liftBind h x k =` and replace `y` with `k x'`\n--      in the bodies of the above combinators; then liftA2 becomes liftBind: )\n--    liftA2   ::    (a -&gt; b -&gt; c) -&gt; f a -&gt;       f b  -&gt; f c\n--    liftBind ::    (a -&gt; b -&gt; c) -&gt; f a -&gt; (a -&gt; f b) -&gt; f c\n--    (&gt;&gt;=) = liftBind (\\a b -&gt; b) :: f a -&gt; (a -&gt; f b) -&gt; f b\n</code></pre>\n\n<p>Indeed,</p>\n\n<pre><code>&gt; :t let liftA2 h x y r = h (x r) (y r) in liftA2\n       :: (a -&gt; b -&gt; c)  -&gt; (t -&gt; a)  -&gt; (t -&gt; b)  -&gt; (t -&gt; c)\n\n&gt; :t liftA2   -- the built-in one\nliftA2 :: Applicative f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\n</code></pre>\n\n<p>i.e. the types match when we take <code>f a  ~  (t -&gt; a)  ~  (-&gt;) t a</code>,  i.e. <code>f  ~  (-&gt;) t</code>.</p>\n\n<p>And so, we're <em>already there</em>: </p>\n\n<pre><code>       (+) &lt;$&gt; (+3) &lt;*&gt; (*100)  $ 5\n=\nliftA2 (+)    (+3)      (*100)    5\n=\n       (+)   ((+3) 5)  ((*100) 5)\n=\n       (+)   (5+3)     (5*100)\n=\n             (5+3)  +  (5*100)\n</code></pre>\n\n<p>It's just how <code>liftA2</code> is defined for <em>this type</em>, <code>Applicative ((-&gt;) t) =&gt; ...</code>:</p>\n\n<pre><code>instance Applicative ((-&gt;) t) where\n    pure     x   t =    x\n    liftA2 h x y t = h (x t) (y t)\n</code></pre>\n\n<p>There's no need to define <code>(&lt;*&gt;)</code>. <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#v:liftA2\" rel=\"nofollow noreferrer\">The source code says</a>: </p>\n\n<blockquote>\n  <p><strong>Minimal complete definition</strong></p>\n\n<pre><code>pure, ((&lt;*&gt;) | liftA2)\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>So now you've been wanting to ask for a long time, <em>why</em> is it that <code>a &lt;$&gt; b &lt;*&gt; c</code> is equivalent to <code>liftA2 a b c</code>?</p>\n\n<p>The short answer is, it just is. One can be defined in terms of the other -- i.e. <code>(&lt;*&gt;)</code> can be defined via <code>liftA2</code>,</p>\n\n<pre><code>    g &lt;*&gt; x    = liftA2 id  g     x        -- i.e. (&lt;*&gt;) = liftA2 id = liftA2 ($)\n\n-- (g &lt;*&gt; x) t = liftA2 id  g     x t \n--               =      id (g t) (x t) \n--               =    (id . g) t (x t)     -- = (id &lt;$&gt; g &lt;*&gt; x) t\n--               =          g  t (x t)\n</code></pre>\n\n<p>(which is exactly as it is defined <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-822\" rel=\"nofollow noreferrer\">in the source</a>),</p>\n\n<p>and it is a law that every Applicative Functor must follow, that <code>h &lt;$&gt; g = pure h &lt;*&gt; g</code>.</p>\n\n<p>Lastly,</p>\n\n<pre><code>liftA2 h g x  ==  pure h &lt;*&gt; g &lt;*&gt; x\n--     h g x  ==      (h     g)    x\n</code></pre>\n\n<p>because <code>&lt;*&gt;</code> associates to the left: it is <code>infixl 4 &lt;*&gt;</code>.</p>\n"}], "owner": {"reputation": 1053, "user_id": 8812845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/288204486548d8e74fba7430b043cf8f?s=128&d=identicon&r=PG", "display_name": "Allen Han", "link": "https://stackoverflow.com/users/8812845/allen-han"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 1, "accepted_answer_id": 54961829, "answer_count": 4, "score": 3, "last_activity_date": 1551692125, "creation_date": 1551551159, "last_edit_date": 1551551522, "question_id": 54961639, "link": "https://stackoverflow.com/questions/54961639/applicative-functor-evaluation-is-not-clear-to-me", "title": "Applicative functor evaluation is not clear to me", "body": "<p>I am currently reading Learn You a Haskell for Great Good! and am stumbling on the explanation for the evaluation of a certain code block. I've read the explanations several times and am starting to doubt if even the author understands what this piece of code is doing.</p>\n\n<pre><code>ghci&gt; (+) &lt;$&gt; (+3) &lt;*&gt; (*100) $ 5\n508\n</code></pre>\n\n<p>An applicative functor applies a function in some context to a value in some context to get some result in some context. I have spent a few hours studying this code block and have come up with a few explanations for how this expression is evaluated, and none of them are satisfactory. I understand that (5+3)+(5*100) is 508, but the problem is getting to this expression. Does anyone have a clear explanation for this piece of code?</p>\n"}, {"tags": ["haskell", "code-coverage", "cabal", "cabal-new"], "answers": [{"tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": false, "score": 1, "last_activity_date": 1551680807, "creation_date": 1551680807, "answer_id": 54977681, "question_id": 54960594, "link": "https://stackoverflow.com/questions/54960594/how-can-i-generate-html-code-coverage-reports-with-new-cabal/54977681#54977681", "title": "How can I generate HTML code coverage reports with new cabal?", "body": "<p>It appears it's as easy as passing <code>--enable-coverage</code> to <code>cabal new-test</code>. I had previously been running tests with <code>cabal new-run test:test</code> to workaround some limitations of <code>new-test</code> (e.g. lacking streaming and colors), so the fix is to use <code>new-test</code> instead of <code>new-run</code>.</p>\n"}], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1551680807, "creation_date": 1551544269, "question_id": 54960594, "link": "https://stackoverflow.com/questions/54960594/how-can-i-generate-html-code-coverage-reports-with-new-cabal", "title": "How can I generate HTML code coverage reports with new cabal?", "body": "<p>Running <code>stack test --coverage</code> generates a nice HTML report showing what lines your test suite covers. How can I achieve the same thing using <code>cabal new-test</code>?</p>\n\n<p>I'm able to pass <code>--enable-coverage</code> to generate a <code>.tix</code> file but I'm not sure what to run on the <code>.tix</code> file to generate the HTML report. I'm pretty sure it involves <code>hpc</code> but I haven't been able to work out the right command.</p>\n\n<p>I have the standard Cabal configuration of my application being a library, with a test-suite for that library. </p>\n"}, {"tags": ["haskell", "syntax", "where", "let"], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 8, "last_activity_date": 1551537961, "creation_date": 1551537961, "answer_id": 54959713, "question_id": 54959598, "link": "https://stackoverflow.com/questions/54959598/where-with-lambda-in-haskell/54959713#54959713", "title": "Where with lambda in haskell", "body": "<p><code>let BINDINGS in EXPRESSION</code> is an expression and can be used anywhere an expression is allowed.</p>\n\n<p><code>where</code> only attaches to declarations, not expressions. <code>\\state -&gt; ...</code> is not a declaration, so you can't attach <code>where</code> to it. You can't attach it to an outer declaration either because then <code>state</code> won't be in scope.</p>\n\n<p>Possible solution:</p>\n\n<pre><code>instance Functor ST where\n    fmap g st = S f\n        where\n        f state = (g x, s')\n            where (x, s') = app st state\n</code></pre>\n\n<p>Instead of an anonymous function <code>\\state -&gt; ...</code> we have a local declaration <code>f state = ...</code>, to which we can attach a <code>where</code> clause that has access to <code>state</code>.</p>\n"}], "owner": {"reputation": 1205, "user_id": 3933052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8hg4k.jpg?s=128&g=1", "display_name": "godot", "link": "https://stackoverflow.com/users/3933052/godot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 54959713, "answer_count": 1, "score": 3, "last_activity_date": 1551539058, "creation_date": 1551537256, "last_edit_date": 1551539058, "question_id": 54959598, "link": "https://stackoverflow.com/questions/54959598/where-with-lambda-in-haskell", "title": "Where with lambda in haskell", "body": "<p>I am reading the 2nd edition of the (great) book from Graham Hutton <a href=\"http://www.cs.nott.ac.uk/~pszgmh/pih.html\" rel=\"nofollow noreferrer\">\"Progamming in Haskell\"</a> (Cambridge Press). </p>\n\n<p>Reading the State Monad section, I stumbled on a small task that I gave myself.</p>\n\n<p>How could you rewrite the following using <code>where</code> instead of <code>let</code>?</p>\n\n<pre><code>type State = Int\nnewtype ST a = S (State -&gt; (a, State))\n\ninstance Functor ST where\n    -- fmap :: (a -&gt; b) -&gt; ST a  -&gt; ST b\n    fmap g st = S (\\state -&gt; let (x, s') = app st state in (g x, s'))\n</code></pre>\n\n<p>I tried variations around this code but it doesn't work:</p>\n\n<pre><code>instance Functor ST where\n   -- fmap :: (a -&gt; b) -&gt; ST a  -&gt; ST b\n   fmap g st = S (\\state -&gt; (g x, newstate))\n              where (x, newstate) = app st state\n</code></pre>\n\n<p>I know it's not useful per se, but I would like to know if and how it is possible.</p>\n"}, {"tags": ["haskell", "unzip", "fold"], "comments": [{"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 2, "creation_date": 1551507006, "post_id": 54955660, "comment_id": 96673676, "body": "<code>!!</code> is for list indexing, it looks like you want to access tuple elements. You can use <code>fst</code> and <code>snd</code> functions to access the first and second elements of tuples."}, {"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 2, "creation_date": 1551507067, "post_id": 54955660, "comment_id": 96673684, "body": "N.B. Your <code>fold</code> works more like <code>foldr</code> than <code>foldl</code>. The former receives a <code>(a -&gt; b -&gt; b)</code> while the latter receives a <code>(b -&gt; a -&gt; b)</code>."}, {"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1551512830, "post_id": 54955660, "comment_id": 96674717, "body": "Not a pro haskellist but the error doesn&#39;t seem to match the result of running the unzip and fold."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1551511137, "post_id": 54955822, "comment_id": 96674405, "body": "<code>fst</code> and <code>snd</code> can be replaced with pattern matching, which ought to improve the strictness somewhat: <code>fold (\\ (x, y) (xs, ys) -&gt; (x : xs, y : ys)) ([], [])</code>. And if you prefer, <code>([], [])</code> is <code>mempty</code>."}, {"owner": {"reputation": 143, "user_id": 11069078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aTxyj_fRGRQ/AAAAAAAAAAI/AAAAAAAAAGk/Zg2K1TWsFKw/photo.jpg?sz=128", "display_name": "David Wolak", "link": "https://stackoverflow.com/users/11069078/david-wolak"}, "edited": false, "score": 0, "creation_date": 1551596429, "post_id": 54955822, "comment_id": 96693055, "body": "Thank you so much! Somehow I didnt realize that it wasnt a list but in fact a tuple -_-"}], "tags": [], "owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "is_accepted": true, "score": 4, "last_activity_date": 1551517735, "last_edit_date": 1551517735, "creation_date": 1551508000, "answer_id": 54955822, "question_id": 54955660, "link": "https://stackoverflow.com/questions/54955660/haskell-unzip-with-fold/54955822#54955822", "title": "Haskell Unzip With Fold", "body": "<p>There are several issues with your lambda function.</p>\n\n<p>Firstly, <code>fold</code> expects a <code>(a -&gt; b -&gt; b)</code>, so technically, a function with two arguments. Right now, your lambda only accepts 1 argument. Since your <code>fold</code> resembles <code>foldr</code> (folds from the right), the second argument should be the <em>accumulator</em> object, which collects the result from each fold.</p>\n\n<p>Secondly, you are working with tuples, not lists (as <a href=\"https://stackoverflow.com/questions/54955660/haskell-unzip-with-fold#comment96673676_54955660\">pdexter noted in a comment</a>). Thus, you should use the <code>fst</code> and <code>snd</code> functions.</p>\n\n<p>After some modifications to the lambda:</p>\n\n<pre><code>\\x acc -&gt; (fst x:fst acc, snd x:snd acc)\n</code></pre>\n\n<p>This will append the first element from each tuple to the first list of the accumulator. And the second element from each tuple to the second list of the accumulator. Some results:</p>\n\n<pre><code>unzip' :: [(a,b)] -&gt; ([a],[b])\nunzip' = fold (\\x acc -&gt; (fst x:fst acc, snd x:snd acc)) ([],[])\n\nunzip' [(1, 'a'), (2, 'b'), (3, 'c')]\n([1,2,3],\"abc\")\n</code></pre>\n\n<p>Following <a href=\"https://stackoverflow.com/questions/54955660/haskell-unzip-with-fold/54955822?noredirect=1#comment96674405_54955822\">Jon's comment</a>, you can also take advantage of pattern matching in the lambda, replacing <code>fst</code> and <code>snd</code>. This may increase the strictness of the function. You can also replace <code>([], [])</code> with <code>mempty</code>, a predefined empty tuple.</p>\n\n<pre><code>unzip' = fold (\\(x, y) (xs, ys) -&gt; (x:xs, y:ys)) mempty\n</code></pre>\n\n<p><sub>Tip: Before jumping into the <code>unzip</code> function, you could isolate and test out the lambda with your <code>fold</code> first.</sub></p>\n"}], "owner": {"reputation": 143, "user_id": 11069078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aTxyj_fRGRQ/AAAAAAAAAAI/AAAAAAAAAGk/Zg2K1TWsFKw/photo.jpg?sz=128", "display_name": "David Wolak", "link": "https://stackoverflow.com/users/11069078/david-wolak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 0, "accepted_answer_id": 54955822, "answer_count": 1, "score": 1, "last_activity_date": 1551517735, "creation_date": 1551506103, "last_edit_date": 1551512729, "question_id": 54955660, "link": "https://stackoverflow.com/questions/54955660/haskell-unzip-with-fold", "title": "Haskell Unzip With Fold", "body": "<p>I'm trying to figure out how to create a custom unzip function in Haskell using a custom version of fold (basically works as foldl) but I've become stuck. I can get it to </p>\n\n<pre><code>unzip' :: [(a,b)] -&gt; ([a],[b])\nunzip' = fold (\\x-&gt;([x!!0],[x!!1])) ([],[])\n</code></pre>\n\n<p>But that errors out with:</p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018[a]\u2019\n              with actual type \u2018(Integer, Integer)\u2019\n\u2022 In the first argument of \u2018tail\u2019, namely \u2018(1, 2)\u2019\n  In the expression: tail (1, 2)\n  In an equation for \u2018it\u2019: it = tail (1, 2)\n\u2022 Relevant bindings include\n    it :: [a] (bound at &lt;interactive&gt;:114:1)\n</code></pre>\n\n<p>From what I figure, <code>x</code> is <code>(1,2)</code> but I'm not sure how to further split it into 1 and 2. Here is the fold function that I am using:</p>\n\n<pre><code>fold :: (a -&gt; b -&gt; b) -&gt; b -&gt; ([a] -&gt; b)\nfold c n =\n  let f [] = n\n      f (x:xs) = x `c` (f xs)\n  in f\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 4, "last_activity_date": 1551504500, "creation_date": 1551504500, "answer_id": 54955531, "question_id": 54955440, "link": "https://stackoverflow.com/questions/54955440/manipulating-haskell-monad-state/54955531#54955531", "title": "Manipulating Haskell Monad State", "body": "<p>Since <code>State</code> is a monad, you can use <code>do</code> notation to define <code>State</code> computations.\n(<code>State</code>'s instance of <code>Monad</code> plumbs the state through, so the ending state of one statement in the <code>do</code> block becomes the starting state of the next.)</p>\n\n<p>So, in a <code>do</code> block, I'm going to:</p>\n\n<ol>\n<li>Process the first <code>Employee</code> in the list to get a new <code>Employee</code></li>\n<li>Process the rest of the list recursively</li>\n<li>Put the two results back together and use them as the return value for the <code>State</code>ful computation.</li>\n</ol>\n\n<pre class=\"lang-hs prettyprint-override\"><code>scanTeam :: [Employee] -&gt; State (Int,Int) [Employee']\nscanTeam [    ] = return []\nscanTeam (p:ps) = do\n    newP &lt;- scanEmployee p\n    newPs &lt;- scanTeam ps\n    return (newP:newPs)\n</code></pre>\n\n<p>It turns out that \"<code>map</code> in a monadic context\" is pretty useful in general, so it's present in the standard prelude as <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:mapM\" rel=\"nofollow noreferrer\"><code>mapM :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]</code></a> (aka <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:traverse\" rel=\"nofollow noreferrer\"><code>traverse :: (Traversable t, Applicative f) =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)</code></a>, if you're ready to go down the rabbit hole).</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>scanTeam = mapM scanEmployee\n</code></pre>\n"}], "owner": {"reputation": 3212, "user_id": 3357352, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/nfb7n.jpg?s=128&g=1", "display_name": "OrenIshShalom", "link": "https://stackoverflow.com/users/3357352/orenishshalom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 54955531, "answer_count": 1, "score": 1, "last_activity_date": 1551504500, "creation_date": 1551503511, "question_id": 54955440, "link": "https://stackoverflow.com/questions/54955440/manipulating-haskell-monad-state", "title": "Manipulating Haskell Monad State", "body": "<p>Somewhat similar to <a href=\"https://stackoverflow.com/questions/54603200/haskell-monad-state-example\">this question</a>, I'm trying to figure out\nhow to move around a Haskell Monad state.\nEach <code>Employee</code> in a team is replaced with a corresponding <code>Employee'</code>\nwhile maintaining some simple state. Here is the code:</p>\n\n<pre><code>module Main( main ) where\nimport Control.Monad.State\n\ndata Employee  = EmployeeSW  Int Int | EmployeeHW Int String deriving ( Show )\ndata Employee' = EmployeeSW'     Int | EmployeeHW'    String deriving ( Show )\n\nscanTeam :: [Employee] -&gt; State (Int,Int) [Employee']\nscanTeam [    ] = return []\nscanTeam (p:ps) = scanEmployee p -- : scanTeam ps ???\n\nscanEmployee :: Employee -&gt; State (Int,Int) Employee'\nscanEmployee (EmployeeSW id s) = do\n    (num,raise) &lt;- get\n    put (num+1,raise)\n    return (EmployeeSW' (s+raise))\nscanEmployee (EmployeeHW id s) = do\n    (num,raise) &lt;- get\n    put (num+1,raise)\n    return (EmployeeHW' (s++(show raise)))\n\nstartState = (0,3000)\n\nt = [(EmployeeHW 77 \"Hundred\"),(EmployeeSW 66 500),(EmployeeSW 32 200)]\n\nmain = print $ evalState (scanTeam t) startState\n</code></pre>\n\n<p>I want to eventually concatenate <code>scanEmployee p</code> with <code>scanTeam ps</code>,\nso I tried to extract the pieces of <code>scanEmployee p</code> and somehow glue\nthem together with <code>scanTeam ps</code>. So far I failed miserably.\nActually, I'm not even sure the state can be moved around between them (?).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551512581, "post_id": 54955216, "comment_id": 96674671, "body": "I see @dfeuer has answered your main question, but there is another issue here - it looks like you want your recursive function, when corrected, to return a <code>String</code> but its type signature, as well as your description, suggests you instead want an IO action. In the latter case you want to look at <code>print</code> rather than <code>show</code>. And while it&#39;s easy enough to do it with direct recursion, you can define it in one line using the <code>mapM_</code> function."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6383671, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nyqAAmyZ8CA/AAAAAAAAAAI/AAAAAAAAAA8/-isjgRpGsWc/photo.jpg?sz=128", "display_name": "\u674e\u704f\u6cfd", "link": "https://stackoverflow.com/users/6383671/%e6%9d%8e%e7%81%8f%e6%b3%bd"}, "edited": false, "score": 0, "creation_date": 1551650767, "post_id": 54955289, "comment_id": 96707524, "body": "what i dont want is the comma between elements in list, and i want this function word for all types. like we i do displayList [1,2,3], it shows like 1 2 3. my problem is that there are always some types that are nor an instance of show, just like int."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 19, "user_id": 6383671, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nyqAAmyZ8CA/AAAAAAAAAAI/AAAAAAAAAA8/-isjgRpGsWc/photo.jpg?sz=128", "display_name": "\u674e\u704f\u6cfd", "link": "https://stackoverflow.com/users/6383671/%e6%9d%8e%e7%81%8f%e6%b3%bd"}, "edited": false, "score": 0, "creation_date": 1551660553, "post_id": 54955289, "comment_id": 96709653, "body": "@\u674e\u704f\u6cfd, I don&#39;t understand what you mean. If the type isn&#39;t an instance of <code>Show</code>, you can&#39;t show it unless you have some other function on hand to do the showing. Can you give some examples of what you really want?"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 8, "last_activity_date": 1551555126, "last_edit_date": 1551555126, "creation_date": 1551501497, "answer_id": 54955289, "question_id": 54955216, "link": "https://stackoverflow.com/questions/54955216/how-to-apply-show-to-any-type-in-haskell/54955289#54955289", "title": "How to apply show to any type in haskell?", "body": "<p>You can indicate in your type signature that the type must be an instance of <code>Show</code>.</p>\n\n<pre><code>displayList :: Show a =&gt; [a] -&gt; IO ()\n</code></pre>\n\n<p>Your recursion looks a bit off though. I would start off with this skeleton:</p>\n\n<pre><code>displayList [] = _base\ndisplayList (x : xs) = _rec\n</code></pre>\n\n<p>You shouldn't need any guards, and you shouldn't need to use <code>null</code>.</p>\n\n<p>Note: showing lists certain ways requires two base cases:</p>\n\n<pre><code>displayList [] = _base0\ndisplayList [x] = _base1\ndisplayList (x : xs) = _rec\n</code></pre>\n\n<p>Based on your code so far, I don't <em>think</em> you need that here, but since you didn't show an example of what you want, it's hard to say for sure.</p>\n"}], "owner": {"reputation": 19, "user_id": 6383671, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nyqAAmyZ8CA/AAAAAAAAAAI/AAAAAAAAAA8/-isjgRpGsWc/photo.jpg?sz=128", "display_name": "\u674e\u704f\u6cfd", "link": "https://stackoverflow.com/users/6383671/%e6%9d%8e%e7%81%8f%e6%b3%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551555126, "creation_date": 1551500674, "last_edit_date": 1551500867, "question_id": 54955216, "link": "https://stackoverflow.com/questions/54955216/how-to-apply-show-to-any-type-in-haskell", "title": "How to apply show to any type in haskell?", "body": "<p>i am trying to write a function to print all elements of any type in a list (including my own data type), but i find that not all types are an instance of show.  is there anyway that can make haskell know that type a is/is not an instance of show? or i can simple turn every type into string.  here is my code.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>displayList :: [a] -&gt; IO()\ndisplayList (x : xs)\n    | not (null xs) = (show x) ++ displayList xs\n    | otherwise = show x ++ show xs\n</code></pre>\n"}, {"tags": ["haskell", "euterpea"], "answers": [{"tags": [], "owner": {"reputation": 1238, "user_id": 382936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tafhO.jpg?s=128&g=1", "display_name": "Seth Difley", "link": "https://stackoverflow.com/users/382936/seth-difley"}, "is_accepted": false, "score": 0, "last_activity_date": 1551487225, "last_edit_date": 1592644375, "creation_date": 1551487225, "answer_id": 54954124, "question_id": 54953647, "link": "https://stackoverflow.com/questions/54953647/haskell-euterpea-portmidi-warning-get-free-output-buffer-wait-timed-out-afte/54954124#54954124", "title": "Haskell: Euterpea PortMidi warning: get_free_output_buffer() wait timed out after 1000ms", "body": "<p>The PortMidi source code at <a href=\"https://github.com/PortMidi/PortMidi/blob/master/portmidi/pm_win/pmwinmm.c#L421:L462\" rel=\"nofollow noreferrer\">https://github.com/PortMidi/PortMidi/blob/master/portmidi/pm_win/pmwinmm.c#L421:L462</a> may point you toward a resolution.</p>\n<p>Based on the source code's comments, some possible causes of the warning may be that the call to PortMidi is not generating any messages, a hung MIDI driver, or insufficient memory. In any case, PortMidi's implementation continues to loop and generate the warning until there is a message in the buffer.</p>\n<p>It appears that PortMidi is no longer being developed or updated to support new OS APIs based on this comment <a href=\"https://github.com/PortMidi/PortMidi/issues/4#issuecomment-250340390\" rel=\"nofollow noreferrer\">https://github.com/PortMidi/PortMidi/issues/4#issuecomment-250340390</a>:</p>\n<blockquote>\n<p>I'm no longer developing this library</p>\n<p>It is sad that the original C library is no longer being developed either, and it is definitely growing outdated as OSes are gradually deprecating old APIs. I don't have pointers to any good quality alternatives at this moment.</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 10952735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86af5fab0d10a205e008a9b00088b9d6?s=128&d=identicon&r=PG&f=1", "display_name": "myself", "link": "https://stackoverflow.com/users/10952735/myself"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551487225, "creation_date": 1551482504, "last_edit_date": 1551483051, "question_id": 54953647, "link": "https://stackoverflow.com/questions/54953647/haskell-euterpea-portmidi-warning-get-free-output-buffer-wait-timed-out-afte", "title": "Haskell: Euterpea PortMidi warning: get_free_output_buffer() wait timed out after 1000ms", "body": "<p>Hi I tried to play a piano song with Euterpea, but after playing it for a few seconds it just gives me the error msg:</p>\n\n<pre><code>PortMidi warning: get_free_output_buffer() wait timed out after 1000ms. \n</code></pre>\n\n<p>repeatedly until I disrupt the program. I'm using Windows and according to the quick tutorial on their website I dont need to install any additional programs to work with the library. This piece of code is enough to get the error message:</p>\n\n<pre><code>let caChord = chord [c 3 qn, a 2 qn]\n    doubleCa = times 2 caChord\n    lowerHand = line [f 2 qn, doubleCa]\nin play $ chord [line [times 3 (line [e 5 en, f 5 en]),times 3 (line [d 5 en, f 5 en]),times 3 (line [c 5 en, f 5 en]),times 3 (line [bf 4 en, f 5 en])], times 4 lowerHand] \n</code></pre>\n\n<p>Seemingly, it should be pretty obvious of a problem considering that I haven't found any posts about it but faced this error without much trying around.</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 4, "creation_date": 1551476593, "post_id": 54952485, "comment_id": 96667974, "body": "Do you not have the <code>QuasiQuotes</code> language extension enabled? It looks like your quasiquote is being parsed as an operator section."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1551478870, "post_id": 54952485, "comment_id": 96668766, "body": "I believe this is the right way to do this (I&#39;m not sure though). However, I&#39;m not convinced that it&#39;s the best idea. What you&#39;ve done will overwrite the page <i>for every single handler</i>, making it impossible to display anything else. I would recommend leaving <code>defaultLayout</code> in place, and - depending on your exact needs - editing one or more of <code>templates&#47;default-layout-wrapper.hamlet</code>, <code>templates&#47;default-layout.hamlet</code> or <code>templates&#47;homepage.hamlet</code>."}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1551475327, "creation_date": 1551475327, "question_id": 54952485, "link": "https://stackoverflow.com/questions/54952485/how-deliver-an-empty-page", "title": "How deliver an empty page?", "body": "<p>I created a simple yesod application and would like to overwrite the default layout.  </p>\n\n<p>It can be overwrite in the Foundation.hs file on the Yesod instance as following: </p>\n\n<pre><code>instance Yesod App where\n    defaultLayout :: Widget -&gt; Handler Html\n    defaultLayout widget = ([whamlet|&lt;p&gt;This is my page. I hope you enjoyed it.&lt;/p&gt;|])\n        --do\n        -- master &lt;- getYesod\n        -- mmsg &lt;- getMessage\n\n        -- mcurrentRoute &lt;- getCurrentRoute\n\n        -- -- Get the breadcrumbs, as defined in the YesodBreadcrumbs instance.\n        -- (title, parents) &lt;- breadcrumbs\n\n        -- -- Define the menu items of the header.\n        -- let menuItems =\n        --         [ NavbarLeft $ MenuItem\n        --             { menuItemLabel = \"Home\"\n        --             , menuItemRoute = HomeR\n        --             , menuItemAccessCallback = True\n        --             }\n        --         ]\n\n        -- let navbarLeftMenuItems = [x | NavbarLeft x &lt;- menuItems]\n        -- let navbarRightMenuItems = [x | NavbarRight x &lt;- menuItems]\n\n        -- let navbarLeftFilteredMenuItems = [x | x &lt;- navbarLeftMenuItems, menuItemAccessCallback x]\n        -- let navbarRightFilteredMenuItems = [x | x &lt;- navbarRightMenuItems, menuItemAccessCallback x]\n\n        -- -- We break up the default layout into two components:\n        -- -- default-layout is the contents of the body tag, and\n        -- -- default-layout-wrapper is the entire page. Since the final\n        -- -- value passed to hamletToRepHtml cannot be a widget, this allows\n        -- -- you to use normal widget features in default-layout.\n\n        -- pc &lt;- widgetToPageContent $ do\n        --     addStylesheet $ StaticR css_bootstrap_css\n        --     $(widgetFile \"default-layout\")\n        -- withUrlRenderer $(hamletFile \"templates/default-layout-wrapper.hamlet\")  \n</code></pre>\n\n<p>As you can see, I tried to overwrite with a simple text output but it is not going to be compiled. The compiler complains: </p>\n\n<pre><code>    A section must be enclosed in parentheses\n      thus: (whamlet |&lt; p &gt; This is my page . I hope you enjoyed it .&lt;/ p\n             &gt;|)\n   |\n88 |     defaultLayout widget = [whamlet|&lt;p&gt;This is my page. I hope you enjoyed it.&lt;/p&gt;|]\n   |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^  \n</code></pre>\n\n<p>My goal is, to deliver an empty page. </p>\n\n<p>How to deliver a simple empty page?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 11, "last_activity_date": 1551474960, "creation_date": 1551474960, "answer_id": 54952430, "question_id": 54952352, "link": "https://stackoverflow.com/questions/54952352/how-to-understand-the-recursive-function-call-in-monadwriter-typeclass/54952430#54952430", "title": "How to understand the recursive function call in MonadWriter Typeclass", "body": "<p>Note the <a href=\"https://downloads.haskell.org/ghc/8.6.1/docs/html/users_guide/glasgow_exts.html#minimal-pragma\" rel=\"noreferrer\"><code>MINIMAL</code> annotation</a>:</p>\n\n<pre><code>{-# MINIMAL (writer | tell), listen, pass #-}\n</code></pre>\n\n<p>This tells GHC which class methods need to be implemented to make a complete instance. Normally, this set of methods is inferred by the compiler\u2014it\u2019s just the set of methods that don\u2019t have default implementations\u2014but in some situations, it\u2019s useful to specify it explicitly. This is one such situation.</p>\n\n<p>The <code>MINIMAL</code> annotation for <code>MonadWriter</code> says that <code>listen</code> and <code>pass</code> must always be implemented, and this makes sense, since those methods don\u2019t have any default implementations. It then goes on to say something more interesting: either <code>writer</code> <em>or</em> <code>tell</code> must be implemented, but not necessarily both.</p>\n\n<p>This works out, since if an instance supplies an implementation of <code>writer</code>, then the default implementation for <code>tell</code> will be used to implement it in terms of the provided <code>writer</code> implementation. Likewise, the inverse will be true if an instance supplies <code>tell</code> but not <code>writer</code>. The <code>MINIMAL</code> annotation protects an instance from supplying an implementation of <em>neither</em>, so no complete instance can ever have both default implementations in use at once.</p>\n"}], "owner": {"reputation": 639, "user_id": 10654293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N3y4b1ilweA/AAAAAAAAAAI/AAAAAAAAAAQ/nO5VTzQiUu0/photo.jpg?sz=128", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/10654293/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 54952430, "answer_count": 1, "score": 0, "last_activity_date": 1551474967, "creation_date": 1551474620, "last_edit_date": 1551474967, "question_id": 54952352, "link": "https://stackoverflow.com/questions/54952352/how-to-understand-the-recursive-function-call-in-monadwriter-typeclass", "title": "How to understand the recursive function call in MonadWriter Typeclass", "body": "<p>In the <code>mtl</code> library, I see the definition of <code>MonadWriter</code>:</p>\n\n<pre><code>class (Monoid w, Monad m) =&gt; MonadWriter w m | m -&gt; w where\n#if __GLASGOW_HASKELL__ &gt;= 707\n    {-# MINIMAL (writer | tell), listen, pass #-}\n#endif\n    -- | @'writer' (a,w)@ embeds a simple writer action.\n    writer :: (a,w) -&gt; m a\n    writer ~(a, w) = do\n      tell w\n      return a\n\n    -- | @'tell' w@ is an action that produces the output @w@.\n    tell   :: w -&gt; m ()\n    tell w = writer ((),w)\n</code></pre>\n\n<p>So <code>writer</code> and <code>tell</code> recursively calls each other. But I can't understand how that works. Is there a stop condition? Does this work because of the laziness of Haskell? Could anyone shine a light on it?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1551464499, "post_id": 54949898, "comment_id": 96663290, "body": "Looks like maybe you need <code>Data.Functor.Compose</code>, so you can use normal applicative syntax with a 2-layered functor."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551468680, "post_id": 54951034, "comment_id": 96665097, "body": "Could you expand on how the applicative laws allow you to float the <code>fmap (\\v -&gt; (v,20))</code> up to the &quot;top&quot;?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551469944, "post_id": 54951034, "comment_id": 96665605, "body": "@chepner <a href=\"https://gist.github.com/benjamin-hodgson/5b36259986055d32adea56d0a7fa688f\" rel=\"nofollow noreferrer\">it&#39;s a little tedious to do it by hand</a> but intuitively <code>fmap</code> doesn&#39;t perform any effects so you&#39;re free to move it around as you like"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551470647, "post_id": 54951034, "comment_id": 96665874, "body": "Thanks. Definitely not obvious :) I think it&#39;s worth adding as an appendix to the bottom of the answer."}, {"owner": {"reputation": 13920, "user_id": 371228, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a4028c5dd749d198d7a8f2601d4afe07?s=128&d=identicon&r=PG", "display_name": "bdesham", "link": "https://stackoverflow.com/users/371228/bdesham"}, "edited": false, "score": 0, "creation_date": 1554481569, "post_id": 54951034, "comment_id": 97782755, "body": "@BenjaminHodgson I\u2019ve taken this approach and written a blog post around it: <a href=\"https://esham.io/2019/03/parsing-json-with-more-context\" rel=\"nofollow noreferrer\">esham.io/2019/03/parsing-json-with-more-context</a> Thank you again for sharing this technique here!"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1554481639, "post_id": 54951034, "comment_id": 97782794, "body": "Happy to help! \u2764\ufe0f"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 4, "last_activity_date": 1551735334, "last_edit_date": 1551735334, "creation_date": 1551468036, "answer_id": 54951034, "question_id": 54949898, "link": "https://stackoverflow.com/questions/54949898/lifting-the-parser-of-a-large-record-type-into-a-functor/54951034#54951034", "title": "Lifting the parser of a large record type into a functor", "body": "<p>No need to lift through nested contexts here. The type <code>parseJSON :: Parser (Int -&gt; DataPoint)</code> is simply asking you to write a <code>Parser</code> which returns a function.</p>\n\n<p>Looking at your original code,</p>\n\n<pre><code>parseJSON = withObject \"DataPoint\" $ \\o -&gt; DataPoint\n    &lt;$&gt; o .: \"name\"\n    &lt;*&gt; fmap (\\v -&gt; (v, 20)) (o .: \"reading\")\n</code></pre>\n\n<p>I notice first of all that you're using a nested <code>fmap</code> underneath a <code>&lt;*&gt;</code> call. I'm going to reassociate this (the legality of this is <a href=\"https://gist.github.com/benjamin-hodgson/5b36259986055d32adea56d0a7fa688f\" rel=\"nofollow noreferrer\">a consequence of the applicative laws</a>) to simplify your code:</p>\n\n<pre><code>parseJSON = withObject \"DataPoint\" $ \\o -&gt;\n    (\\name reading -&gt; DataPoint name (reading, 20))\n    &lt;$&gt; o .: \"name\"\n    &lt;*&gt; o .: \"reading\"\n</code></pre>\n\n<p>This is easier to read overall, in my opinion. I'm just applying a two-argument function to two arguments in a context.</p>\n\n<p>Now hopefully you can see how to make this parser return an <code>Int -&gt; DataPoint</code> - just change the return type of the function you're mapping over the arguments.</p>\n\n<pre><code>parseJSON = withObject \"DataPoint\" $ \\o -&gt;\n    (\\name reading -&gt; \\x -&gt; DataPoint name (reading, x))\n    &lt;$&gt; o .: \"name\"\n    &lt;*&gt; o .: \"reading\"\n</code></pre>\n\n<p>As a syntactic nicety, Haskell allows you to flatten nested lambdas.</p>\n\n<pre><code>parseJSON = withObject \"DataPoint\" $ \\o -&gt;\n    (\\name reading x -&gt; DataPoint name (reading, x))\n    &lt;$&gt; o .: \"name\"\n    &lt;*&gt; o .: \"reading\"\n</code></pre>\n\n<p>And by the way, this is all equivalent to the noisier-but-perhaps-more-legible <code>do</code>-notation:</p>\n\n<pre><code>parseJSON = withObject \"DataPoint\" $ \\o -&gt; do\n    name &lt;- o .: \"name\"\n    reading &lt;- o .: \"reading\n    return $ \\x -&gt; DataPoint name (reading, x)\n</code></pre>\n\n<p>A quick test:</p>\n\n<pre><code>main = \n    let input = \"{\\\"name\\\": \\\"Greenland\\\", \\\"reading\\\": 54}\"\n        f = decode input :: Maybe (Int -&gt; DataPoint)\n    in print $ fmap ($ 7) f\n-- Just (DataPoint {placeName = \"Greenland\", readings = (7,54)})\n</code></pre>\n"}], "owner": {"reputation": 13920, "user_id": 371228, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a4028c5dd749d198d7a8f2601d4afe07?s=128&d=identicon&r=PG", "display_name": "bdesham", "link": "https://stackoverflow.com/users/371228/bdesham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 1, "accepted_answer_id": 54951034, "answer_count": 1, "score": 3, "last_activity_date": 1551735334, "creation_date": 1551462695, "question_id": 54949898, "link": "https://stackoverflow.com/questions/54949898/lifting-the-parser-of-a-large-record-type-into-a-functor", "title": "Lifting the parser of a large record type into a functor", "body": "<p>This is a follow-up question to <a href=\"https://stackoverflow.com/q/46820379/371228\">this question</a> about parsing JSON within a monadic context.</p>\n\n<p>Consider a simple record type and its <a href=\"https://hackage.haskell.org/package/aeson-1.4.2.0/docs/Data-Aeson.html#t:FromJSON\" rel=\"nofollow noreferrer\">Data.Aeson.FromJSON</a> instance. For the <code>(Int, Int)</code> field, I\u2019m reading one value from the JSON and setting the other to 20.</p>\n\n<pre><code>import Data.Aeson\n\ndata DataPoint = DataPoint { placeName :: String\n                           , readings :: (Int, Int)\n                           } deriving (Show)\n\ninstance FromJSON DataPoint where\n    parseJSON = withObject \"DataPoint\" $ \\o -&gt; DataPoint\n        &lt;$&gt; o .: \"name\"\n        &lt;*&gt; fmap (\\v -&gt; (v, 20)) (o .: \"reading\")\n</code></pre>\n\n<p>This works fine:</p>\n\n<pre><code>&gt; (decodeThrow \"{\\\"name\\\": \\\"Greenland\\\", \\\"reading\\\": 54}\") :: Maybe DataPoint\nJust (DataPoint {placeName = \"Greenland\", readings = (54,20)})\n</code></pre>\n\n<p>I'd like to replace that dummy 20 with a value that's provided separately. Following <a href=\"https://stackoverflow.com/a/46821125/371228\">Daniel Wagner\u2019s answer</a>, I can lift this into the <a href=\"https://hackernoon.com/the-reader-monad-part-1-1e4d947983a8\" rel=\"nofollow noreferrer\">reader monad</a>/<a href=\"https://blog.plover.com/prog/haskell/evaluation-functor.html\" rel=\"nofollow noreferrer\">environment functor</a> <code>(-&gt;) Int</code> like</p>\n\n<pre><code>import Control.Applicative (liftA2)\n\ninstance FromJSON (Int -&gt; DataPoint) where\n    parseJSON = withObject \"DataPoint\" $ \\o -&gt; liftA2 DataPoint\n        &lt;$&gt; fmap pure             (o .: \"name\")\n        &lt;*&gt; fmap (\\v c -&gt; (v, c)) (o .: \"reading\")\n</code></pre>\n\n<p>In GHCi,</p>\n\n<pre><code>&gt; let f = (decodeThrow \"{\\\"name\\\": \\\"Greenland\\\", \\\"reading\\\": 54}\") :: Maybe (Int -&gt; DataPoint)\n&gt; f &lt;*&gt; Just 7\nJust (DataPoint {placeName = \"Greenland\", readings = (54,7)})\n</code></pre>\n\n<p>In this case, <code>liftA2</code>, which has type</p>\n\n<pre><code>liftA2 :: Functor f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\n</code></pre>\n\n<p>is specialized to</p>\n\n<pre><code>liftA2 :: (Parser String -&gt; Parser (Int, Int) -&gt; Parser DataPoint)\n    -&gt; (Int -&gt; Parser String)\n    -&gt; (Int -&gt; Parser (Int, Int))\n    -&gt; (Int -&gt; Parser DataPoint)\n</code></pre>\n\n<p>Here\u2019s my problem. My real record has something like seven fields, so I would have to write a function like <code>liftA7</code> to be able to use this same approach with my real data. This is easy enough, but the fact that the standard library only provides <code>liftA</code>, <code>liftA2</code>, and <code>liftA3</code> makes me think that I should be using a different approach to lift my parser into the <code>(-&gt;) Int</code> functor. Is there a better approach? Or do I need to just write out <code>liftA7</code> and use that?</p>\n"}, {"tags": ["haskell", "io-monad"], "comments": [{"owner": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "edited": false, "score": 2, "creation_date": 1551449226, "post_id": 54946242, "comment_id": 96655397, "body": "The <code>do</code> block refers to <code>Maybe</code>, not to <code>IO</code> here. It looks like the entire thing should be <code>f par = return $ do ...</code>, or you could change the type to <code>f::String-&gt;Maybe Int</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551449276, "post_id": 54946242, "comment_id": 96655431, "body": "You&#39;re right, this will never work (it would if the return type was <code>Maybe Int</code> though). But I don&#39;t see that code snippet anywhere in the chapter you linked to. (I actually went through much of RWH not long ago - it&#39;s pretty out of date and a lot of the modules they use don&#39;t seem to exist any more with the same API - but I don&#39;t remember anything like this.)"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1551449511, "post_id": 54946242, "comment_id": 96655559, "body": "It is right before <code>The list Monad</code> subchapter."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551449559, "post_id": 54946242, "comment_id": 96655587, "body": "Nothing in your code suggests that <code>f</code> has to return an <code>IO</code> value."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1551449591, "post_id": 54946242, "comment_id": 96655610, "body": "Wait a second..i thought that when using <code>do</code> it is restricted only to the <code>IO</code> monad."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1551449698, "post_id": 54946242, "comment_id": 96655685, "body": "No, <code>do</code> works for <i>any</i> monad."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551449846, "post_id": 54946242, "comment_id": 96655772, "body": "All you really need here, though,  is <code>f :: String -&gt; Maybe Int</code> with <code>f par = lookup par amap &gt;&gt;= flip lookup bmap &gt;&gt;= flip lookup final</code>. IMO, that&#39;s clearer than using <code>do</code> notation, since it emphasizes the act of chaining several lookups together."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551449900, "post_id": 54946242, "comment_id": 96655801, "body": "@chepner - the type signature of <code>String-&gt;IO (Maybe Int)</code> is what &quot;suggests <code>f</code> has to return an <code>IO</code> value&quot;. If it had a type signature of <code>String-&gt;Maybe Int</code> it would be fine."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1551449957, "post_id": 54946242, "comment_id": 96655845, "body": "@RobinZigmond That&#39;s what I meant; the type signature is imposing an external constraint on the return type that isn&#39;t otherwise suggested by its argument or the lists it operates on."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551449990, "post_id": 54946242, "comment_id": 96655865, "body": "@BercoviciAdrian I just looked up that part of the chapter. Nowhere is the code you have put there listed. There are similar examples involving chaining <code>lookup</code> calls inside a <code>do</code> block, but nowhere is a type signature involving <code>IO</code> given for it. I think you are getting confused and putting things together that shouldn&#39;t be together."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551450233, "post_id": 54946242, "comment_id": 96655997, "body": "Even simpler (though requiring an import from <code>Control.Monad</code>): <code>f = let lookup&#39; = flip lookup in lookup&#39; amap &gt;=&gt; lookup&#39; bmap &gt;=&gt; lookup&#39; final</code>."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1551450559, "post_id": 54946242, "comment_id": 96656179, "body": "I am sorry for the confusion and the book example.I thought <code>do</code> can only be used in the <code>IO</code> monad hence i defined my method return type. as <code>IO( Maybe Int)</code>.Apologies"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551451624, "post_id": 54946242, "comment_id": 96656719, "body": "@BercoviciAdrian - no need to apologise, I&#39;m always happy to help and I&#39;m sure that applies to the others who&#39;ve commented as well. For what it&#39;s worth, I wouldn&#39;t recommend RWH as the sole resource for learning Haskell. The best &quot;book-style&quot; resources for beginners that I&#39;ve come across are <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">Learn You a Haskell</a> and the <a href=\"https://en.wikibooks.org/wiki/Haskell\" rel=\"nofollow noreferrer\">Haskell wikibook</a> (the more advanced chapters of that are very patchy but still full of good information, but the beginner-to-intermediate stuff is very good)."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1551452320, "post_id": 54946242, "comment_id": 96657102, "body": "Yes i have looked through <code>Learned you a haskell</code> but what i come to realise is that after i finish a chapter with <code>RWH</code> even though its harder , there&#39;s nothing left to learn on that chapter in other books / tutorials( + i am halfway though) .For me it looks as a hardcore-complete resource (deprecated in some parts)"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1551450992, "creation_date": 1551450992, "answer_id": 54946777, "question_id": 54946242, "link": "https://stackoverflow.com/questions/54946242/can-not-return-maybe-result-in-the-io-monad/54946777#54946777", "title": "Can not return maybe result in the IO Monad", "body": "<p>For the given type signature, you need to lift the value returned by the final call to <code>lookup</code> into an <code>IO</code> value.</p>\n\n<pre><code>f::String-&gt;IO (Maybe Int)\nf par = return $ do\n      a &lt;- lookup par amap\n      b &lt;- lookup a bmap\n      lookup b final\n</code></pre>\n\n<p>The <code>do</code> expression is syntactic sugar for uses of <code>&gt;&gt;=</code> that operate in the <code>Maybe</code> monad, not <code>IO</code>, in this case, but the <code>return</code> takes the resulting <code>Maybe Int</code> value and produces the required <code>IO (Maybe Int)</code> value. It could be desugared as</p>\n\n<pre><code>f par = return (lookup par amap &gt;&gt;= \\a -&gt; lookup a bmap &gt;&gt;= \\b -&gt; lookup b final)\n</code></pre>\n\n<p>However, aside from the type signature forcing you to use <code>return</code>, there is nothing else about <code>f</code> that <em>requires</em> it to return an <code>IO</code> value; neither its argument nor any of the three association lists involve <code>IO</code> in any way, so you could simply change the type signature to eliminate any reference to <code>IO</code> and operate purely in the <code>Maybe</code> monad.</p>\n\n<pre><code>f :: String -&gt; Maybe Int\nf par = do\n    a &lt;- lookup par amap\n    b &lt;- lookup a bmap\n    lookup b final\n</code></pre>\n\n<hr>\n\n<h2>An aside: getting rid of <code>do</code></h2>\n\n<p>Since you are chaining together various calls to <code>lookup</code>, it would be nice if you could feed each result to the next call in a point-free style. In order to do this, you need to reverse the order in which <code>lookup</code> accepts its arguments. This is trivial to do using <code>flip</code>: <code>flip lookup :: [(a,b)] -&gt; a -&gt; Maybe b</code>.</p>\n\n<pre><code>f :: String -&gt; Maybe Int\nf par = let lookup' = flip lookup\n        in lookup' amap par &gt;&gt;= lookup' bmap &gt;&gt;= lookup' final\n</code></pre>\n\n<p>Taking this a step further, you can remove the reference to <code>par</code> altogether by using the <code>&gt;=&gt;</code> operator imported from <code>Control.Monad</code>. Compare its type to that of <code>&gt;&gt;=</code>:</p>\n\n<pre><code>:t (&gt;&gt;=)\n(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n:t (&gt;=&gt;)\n(&gt;=&gt;) :: Monad m =&gt; (a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c\n</code></pre>\n\n<p>Instead of starting with <code>Maybe</code> value, you <em>compose</em> calls to <code>lookup'</code>, and give your starting string to the function.</p>\n\n<pre><code>f :: String -&gt; Maybe Int\nf = let lookup' = flip lookup\n     in lookup' amap &gt;=&gt; lookup' bmap &gt;=&gt; lookup' final\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 54946777, "answer_count": 1, "score": 2, "last_activity_date": 1551450992, "creation_date": 1551448971, "question_id": 54946242, "link": "https://stackoverflow.com/questions/54946242/can-not-return-maybe-result-in-the-io-monad", "title": "Can not return maybe result in the IO Monad", "body": "<p>I do not understand why this sample of code does not work and in <a href=\"http://book.realworldhaskell.org/read/monads.html\" rel=\"nofollow noreferrer\">RWH</a> book it works:</p>\n\n<pre><code>module Monads where \n    import Data.Maybe\n    import Control.Monad\n    amap=[(\"a\",1),(\"bb\",2)]\n    bmap=[(1,100),(2,200)]\n    final=[(100,1000),(200,2000)]\n\n    f::String-&gt;IO (Maybe Int)\n    f par=do\n          a&lt;-lookup par amap\n          b&lt;-lookup a bmap\n          lookup b final\n</code></pre>\n\n<p>It does not work and i do not understand how it could work since the last line returns a <code>Maybe something</code> and not a <code>IO something</code>.</p>\n\n<p>I have also tried changing the last line to :<br>\n<code>return (lookup b final)</code> <br>which to my reasoning should be perfect ( lookup returns a <code>Maybe Int</code> and then wrap it with <code>return</code>)</p>\n\n<p>I get the following error in when using <code>return</code></p>\n\n<pre><code>* Couldn't match type `Maybe' with `IO'\n      Expected type: IO Integer\n        Actual type: Maybe Integer\n    * In a stmt of a 'do' block: b &lt;- lookup a bmap\n      In the expression:\n        do a &lt;- lookup par amap\n           b &lt;- lookup a bmap\n           return (lookup b final)\n      In an equation for `f':\n          f par\n            = do a &lt;- lookup par amap\n                 b &lt;- lookup a bmap\n                 return (lookup b final)\n   |\n11 |           b&lt;-lookup a bmap\n   |              ^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1551402792, "post_id": 54935934, "comment_id": 96637296, "body": "You either have a typo, or there&#39;s more than one file and <code>Env</code> is not being exported. Can you give more details about how your program is organized?"}, {"owner": {"reputation": 941, "user_id": 1364783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4eda80ff284139c0614e80a943d9c307?s=128&d=identicon&r=PG", "display_name": "rausted", "link": "https://stackoverflow.com/users/1364783/rausted"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1551410149, "post_id": 54935934, "comment_id": 96638757, "body": "@Li-yaoXia compile and Env are imported from another module but I don\u2019t see how that would affect the result. You can change all types to Int to remove unknowns like Context Type and Expr but the error would be the same."}], "answers": [{"comments": [{"owner": {"reputation": 941, "user_id": 1364783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4eda80ff284139c0614e80a943d9c307?s=128&d=identicon&r=PG", "display_name": "rausted", "link": "https://stackoverflow.com/users/1364783/rausted"}, "edited": false, "score": 0, "creation_date": 1551413115, "post_id": 54937721, "comment_id": 96639298, "body": "I see, I forgot to deconstruct Env but I thought I didn\u2019t have to do it and it will be magically coerced because of newtype. Would it be better if I made Env a type alias for State (Context Type), since then I don\u2019t need to deconstruct Env. So use type instead of newtype."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 941, "user_id": 1364783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4eda80ff284139c0614e80a943d9c307?s=128&d=identicon&r=PG", "display_name": "rausted", "link": "https://stackoverflow.com/users/1364783/rausted"}, "edited": false, "score": 1, "creation_date": 1551415593, "post_id": 54937721, "comment_id": 96639840, "body": "You could do that too!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551446869, "post_id": 54937721, "comment_id": 96654067, "body": "Nothing gets magically co-erced. One the code is <i>compiled</i>, the distinction between <code>Env</code> and <code>State (Context Type)</code> is erased (which means, I think, there is no overhead in calling <code>runEnv</code>), but you still need to distinguish them in order for compilation to succeed."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 4, "last_activity_date": 1551412533, "creation_date": 1551412533, "answer_id": 54937721, "question_id": 54935934, "link": "https://stackoverflow.com/questions/54935934/call-into-newtype-constructor/54937721#54937721", "title": "Call into newtype constructor", "body": "<p>This error message means that the <strong>data</strong> constructor <code>Env</code> is not getting imported (as opposed to the <strong>type</strong> constructor <code>Env</code>). This has nothing to do with the difference between <code>data</code> and <code>newtype</code>.</p>\n\n<pre><code>data    Env = Env (...)   -- Same terminology\nnewtype Env = Env (...)   -- for both\n     -- ^     ^\n     -- |     data constructor\n     -- type constructor\n</code></pre>\n\n<p>Check your import statements (are they qualified? Do they use explicit import lists?), and your export lists. In particular, this is a common point of confusion:</p>\n\n<pre><code>-- data constructor hidden\nmodule Bar (Env, ...) where   -- only exports the type constructor\n\n-- data constructor exported\nmodule Bar (Env(Env), ...) where\n-- or --\nmodule Bar (Env(..), ...) where   -- these do export both the type and data constructor Env\n</code></pre>\n\n<p>Then, once <code>Env</code> is in scope, you will still get a type error, because <code>Env</code> has type <code>State (Context Type) a -&gt; Env a</code> but it is being applied to an <code>Expr</code> (assuming that's the type of <code>expr</code>). You need to deconstruct <code>Env</code> instead:</p>\n\n<pre><code>runEnv :: Env a -&gt; State (Context Type) a\nrunEnv (Env f) = f\n\n-- or, in the definition of Env\n\nnewtype Env a = Env { runEnv :: State (Context Type) a } deriving ...\n</code></pre>\n\n<p>So you can write</p>\n\n<pre><code>flip evalState ctx (runEnv (compile expr))\n</code></pre>\n\n<p>If you're defining <code>runEnv</code> explicitly as a function, you could also refactor <code>evalState</code> into it:</p>\n\n<pre><code>runEnv :: Context Type -&gt; Env a -&gt; a\nrunEnv ctx (Env f) = evalState f ctx\n\n---\n\nrunEnv ctx (compile expr) :: Expr\n</code></pre>\n"}], "owner": {"reputation": 941, "user_id": 1364783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4eda80ff284139c0614e80a943d9c307?s=128&d=identicon&r=PG", "display_name": "rausted", "link": "https://stackoverflow.com/users/1364783/rausted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 54937721, "answer_count": 1, "score": 0, "last_activity_date": 1551412533, "creation_date": 1551397052, "question_id": 54935934, "link": "https://stackoverflow.com/questions/54935934/call-into-newtype-constructor", "title": "Call into newtype constructor", "body": "<p>I have a newtype <code>Env</code> defined like this:</p>\n\n<pre><code>newtype Env a = Env (State (Context Type) a) deriving (Functor, Applicative, Monad, MonadState (Context Type))\n</code></pre>\n\n<p>I want it to be automatically coerced into places where <code>State (Context Type) is expected</code> with no runtime cost, but instead I get this error:</p>\n\n<pre><code>flip evalState ctx $ Env &lt;$&gt; compile expr \n</code></pre>\n\n<p>Assuming compile is of the correct type, \n<code>compile :: a -&gt; Env a</code></p>\n\n<p>This is the error:</p>\n\n<pre><code>Data constructor not in scope:\n      Env :: Env Expr -&gt; State (Context Type) c\n</code></pre>\n\n<p>Sure, data constructors are different than newtype constructors, but how can I make <code>evalState</code> accept the <code>Env a</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551391130, "post_id": 54934778, "comment_id": 96634210, "body": "Maybe, but it looks like this <code>foo</code> would still require a value of type <code>a</code>, no?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1551391536, "post_id": 54934778, "comment_id": 96634373, "body": "Your <code>foo</code> above does not have type <code>Foo a =&gt; a -&gt; [Char]</code> as you claim, it will have type <code>Foo a =&gt; [Char]</code> which is ambiguous. If you allow ambiguous types, you will be able to use <code>foo</code> through type applications."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1551395235, "post_id": 54934778, "comment_id": 96635597, "body": "Ryan Scott wrote a pretty nifty summary of the approaches you can take for solving this problem: <a href=\"http://ryanglscott.github.io/2019/02/06/proxy-arguments-in-class-methods/\" rel=\"nofollow noreferrer\">ryanglscott.github.io/2019/02/06/&hellip;</a>. Not only does it cover the existing answers, but it also talks about some of the tradeoffs."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1551397372, "post_id": 54935009, "comment_id": 96636146, "body": "There are two major irritations in practice: 1. You have to know the exact order of the (visible) kind and type arguments. 2. As far as I know, things still don&#39;t work in a higher-order context. You can write <code>foo :: (forall a. C a =&gt; proxy a -&gt; A) -&gt; B</code> or <code>foo :: (forall a. C a =&gt; Tagged a A) -&gt; B</code>, but not <code>foo :: (forall a. C a =&gt; A) -&gt; B</code>. So if you need to pass the method to a higher-rank HOF, you&#39;ll need some sort of adapter."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551402412, "post_id": 54935009, "comment_id": 96637221, "body": "Thanks, it sounds like (TypeApplications) will probably meet my needs for now, but @dfeuer is describing irritants that are worth knowing about. In that case, I could switch to one of the other options perhaps (including those mentioned in the blog post mentioned by @Alec) - will give it a try soon! <code>#Proxy</code> looks nice otherwise, though its interop with DerivingVia relies on an as yet unreleased GHC version (8.10.1)."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 5, "last_activity_date": 1551391575, "creation_date": 1551391575, "answer_id": 54935009, "question_id": 54934778, "link": "https://stackoverflow.com/questions/54934778/is-there-a-way-to-refer-directly-to-typeclass-instances-in-haskell/54935009#54935009", "title": "Is there a way to refer directly to typeclass instances in Haskell?", "body": "<p>The old way (which I still prefer) is to use a <em>proxy</em>.</p>\n\n<pre><code>import Data.Proxy\n\nclass Foo a where\n    foo :: Proxy a -&gt; String\n\ninstance Foo FancyPants where\n    foo _ = \"a fancypants instance\"\n\nfooString :: String\nfooString = foo (Proxy :: Proxy FancyPants)\n</code></pre>\n\n<p>So we didn't actually need a value of type <code>FancyPants</code> to use <code>foo</code>, all we needed is a value of <code>Proxy FancyPants</code> -- but you can create proxies of any type you want.   This can be done in a polymorphic context too; usually it requires the use of the <code>ScopedTypeVariables</code> extension.</p>\n\n<p>The new way is to use the <code>TypeApplications</code> and <code>AllowAmbiguousTypes</code> extension:</p>\n\n<pre><code>{-# LANGUAGE TypeApplications, AllowAmbiguousTypes #-}\n\nclass Foo a where\n    foo :: String\n\ninstance Foo FancyPants where\n    foo = \"a fancypants instance\"\n\nfooString :: String\nfooString = foo @FancyPants\n</code></pre>\n\n<p>Which looks nicer, but working with it in practice tends to be more irritating for a reason I can't quite put my finger on.</p>\n\n<p>Did that answer the question?</p>\n"}, {"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1551395294, "post_id": 54935023, "comment_id": 96635611, "body": "Or, you could have <code>class Foo a where { foo :: dummy a -&gt; String }</code>. Then people can use <code>foo (Dummy :: Dummy Bool)</code> as well as <code>foo (Proxy :: Proxy Bool)</code>."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1551401666, "post_id": 54935023, "comment_id": 96637058, "body": "as it happens I&#39;m using <code>DerivingVia</code> in my real case already, so it is looking like <code>TypeApplications</code> will win out - will test soon, thanks!"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 8, "last_activity_date": 1551391633, "creation_date": 1551391633, "answer_id": 54935023, "question_id": 54934778, "link": "https://stackoverflow.com/questions/54934778/is-there-a-way-to-refer-directly-to-typeclass-instances-in-haskell/54935023#54935023", "title": "Is there a way to refer directly to typeclass instances in Haskell?", "body": "<p>The \"old school\" way of doing it is providing a \"dummy\" parameter whose purpose is nothing but helping the compiler find the appropriate instance. In this world, your class would look something like:</p>\n\n<pre><code>data Dummy a = Dummy\n\nclass Foo a where\n    foo :: Dummy a -&gt; String\n\n-- usage:\nboolFoo = foo (Dummy :: Dummy Bool)\n</code></pre>\n\n<p>In fact, this trick was so ubiquitous that the <code>Dummy</code> type was semi-standardized as <a href=\"https://www.stackage.org/haddock/lts-13.9/base-4.12.0.0/Data-Proxy.html\" rel=\"noreferrer\"><code>Data.Proxy</code></a>.</p>\n\n<hr>\n\n<p>But in modern GHC there is a better way: <code>TypeApplications</code>. </p>\n\n<p>With this extension enabled, you can just straight up specify the type when calling the class method:</p>\n\n<pre><code>class Foo a where\n    foo :: String\n\nboolFoo = foo @Bool\n</code></pre>\n\n<p>(this doesn't only work for class methods; it will work with any generic function, but be careful with the order of type parameters!)</p>\n\n<p>You may also need to enable <code>AllowAmbiguousTypes</code> in order to declare such class. Though I'm not sure I remember this correctly, and I don't have a computer handy to check.</p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1551400063, "creation_date": 1551390356, "last_edit_date": 1551400063, "question_id": 54934778, "link": "https://stackoverflow.com/questions/54934778/is-there-a-way-to-refer-directly-to-typeclass-instances-in-haskell", "title": "Is there a way to refer directly to typeclass instances in Haskell?", "body": "<p>The benefit of this could be to store certain metadata about the type in a canonical location. Sometimes, it isn't convenient to have a value of the type before using some instance methods on it; For instance if I have:</p>\n\n<pre><code>class Foo a where\n  foo :: String\n  foo = \"Foo\"\n</code></pre>\n\n<p>This is not actually valid Haskell. Instead it seems I have to have something like:</p>\n\n<pre><code>class Foo a where\n  foo :: a -&gt; String\n  foo = const \"Foo\"\n</code></pre>\n\n<p>and now <code>foo</code> will actually have type <code>Foo a =&gt; a -&gt; String</code>, but I would actually like to be able to do something like having a <code>foo</code> with type <code>Instance Foo -&gt; String</code>. For this to be useful in some contexts, it might be also necessary to iterate over all (in-scope?) instances, or in other contexts, to be able to specifically materialize an instance for a given type.</p>\n\n<p>I guess the issue is that instances and typeclasses are not first-class entities in Haskell?</p>\n"}, {"tags": ["haskell", "testing", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1551388002, "post_id": 54933271, "comment_id": 96632966, "body": "I don&#39;t think there is an easy way to do it. I recommend you stick to the convention of keeping source and tests in separate directories. If you want to package together a small contained set of modules and tests, just make another library!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551418359, "post_id": 54933271, "comment_id": 96640544, "body": "Can you say why you want to mix the files in one directory? Perhaps we can suggest an alternative that addresses your concerns."}, {"owner": {"reputation": 1598, "user_id": 1509394, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9d888a2c6f57b1e63cbd2eea151c112b?s=128&d=identicon&r=PG", "display_name": "Martinsos", "link": "https://stackoverflow.com/users/1509394/martinsos"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551477182, "post_id": 54933271, "comment_id": 96668197, "body": "@DanielWagner Thanks for trying to find a solution! I have been lately working a lot in javascript and convention there is to keep test files next to the source files. I also worked before on project where those were split in different directory structures, so I can compare both. I liked better when they are next to source files because it is easier to find and open them -&gt; I don&#39;t need to navigate two parallel directory structures.. I am sure there are pros and cons, but I found this to be smth I like/prefer. But I would love to hear different opinions."}], "answers": [{"tags": [], "owner": {"reputation": 2540, "user_id": 1803897, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/921ed2f776bd064b49d8aadb378dd15a?s=128&d=identicon&r=PG", "display_name": "Roland Puntaier", "link": "https://stackoverflow.com/users/1803897/roland-puntaier"}, "is_accepted": false, "score": 1, "last_activity_date": 1592516800, "last_edit_date": 1592516800, "creation_date": 1592430228, "answer_id": 62438858, "question_id": 54933271, "link": "https://stackoverflow.com/questions/54933271/how-can-i-specify-source-files-for-cabal-stack-package-with-more-control-than-ju/62438858#62438858", "title": "How can I specify source files for Cabal/Stack package with more control than just hs-source-dirs/source-dirs?", "body": "<p>Separate <code>src</code> and <code>tests</code> dir is convention, but not a must.\n<code>hs-source-dirs</code> defaults to <code>.</code>.</p>\n\n<p>Cabal finds all source files by itself.\nOtherwise there is <code>extra-source-files</code>.</p>\n\n<p>Your choice is on the module level: <code>exposed-modules</code>, <code>other-modules</code>.\nYou can use them for libraries and executables.</p>\n\n<p>In your <code>.cabal</code> file:</p>\n\n<ul>\n<li>Use one <code>executable &lt;name&gt;</code> entry per executable.\n<code>main-is</code> is the file with <code>module Main where ...</code>.</li>\n<li>Use one <code>library &lt;name&gt;</code> per library.</li>\n<li><p>Use one <code>test-suite &lt;name&gt;</code> entry per test app.</p>\n\n<ul>\n<li><code>type</code> is required (e.g. <code>type: exitcode-stdio-1.0</code>).</li>\n<li><code>main-is</code> is the test file.</li>\n<li><code>ghc-options:         -main-is &lt;your.hs&gt;</code></li>\n<li>in the test files have also a</li>\n</ul>\n\n<pre><code>  main :: IO ()\n  main = hspec spec -- or: spec1 &gt;&gt; spec2\n</code></pre></li>\n</ul>\n\n<p>Cabal usage:</p>\n\n<pre><code>  cabal new-build\n  cabal new-test [&lt;which test&gt;]\n  cabal new-run &lt;file without path&gt;\n</code></pre>\n\n<p>Deep in <code>dist-newstyle</code> you will find</p>\n\n<ul>\n<li>the executables under an <code>x</code> directory</li>\n<li>the test executables under a <code>t</code> directory</li>\n<li>the library <code>.so</code> files under a <code>l</code> directory</li>\n</ul>\n\n<p>Links:</p>\n\n<ul>\n<li>(cabal documents) [<a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#autogenerated-modules-and-includes]\" rel=\"nofollow noreferrer\">https://www.haskell.org/cabal/users-guide/developing-packages.html#autogenerated-modules-and-includes]</a></li>\n<li>example projects:\n(hspec-example)[<a href=\"https://github.com/hspec/hspec-example/blob/master/strip.cabal]\" rel=\"nofollow noreferrer\">https://github.com/hspec/hspec-example/blob/master/strip.cabal]</a>\n(tasty-cabal-example-tests) [<a href=\"https://github.com/willprice/haskell-cabal-example-tests/blob/master/quickcheck-example.cabal]\" rel=\"nofollow noreferrer\">https://github.com/willprice/haskell-cabal-example-tests/blob/master/quickcheck-example.cabal]</a></li>\n<li>cabal sources: <code>*.cabal</code>, <code>cabal/Cabal/doc/buildinfo-fields-reference.rst</code></li>\n</ul>\n"}], "owner": {"reputation": 1598, "user_id": 1509394, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9d888a2c6f57b1e63cbd2eea151c112b?s=128&d=identicon&r=PG", "display_name": "Martinsos", "link": "https://stackoverflow.com/users/1509394/martinsos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592516800, "creation_date": 1551383642, "question_id": 54933271, "link": "https://stackoverflow.com/questions/54933271/how-can-i-specify-source-files-for-cabal-stack-package-with-more-control-than-ju", "title": "How can I specify source files for Cabal/Stack package with more control than just hs-source-dirs/source-dirs?", "body": "<p>I have a Haskell project that is built using Stack (therefore Cabal).\nRight now I have src/ directory and tests/ directory, however I would like to mix tests together with the source files, which means everything would go to src/ directory.</p>\n\n<p>For that, I would need to define my <code>tests</code> build-info source files to be files in src/ that have .test.hs extension.\nHowever, it seems that only choice for defining source files is <code>source-dirs</code> in stack or <code>hs-source-dirs</code> in cabal, meaning that I have to put <code>src</code> as <code>source-dirs</code>, which seems wrong because it is also capturing the normal source files then.</p>\n\n<p>This is what part of my package.yaml:</p>\n\n<pre><code>tests:\n  myapp-test:\n    main:                Main.hs\n    source-dirs:         test\n    ...\n</code></pre>\n\n<p>While I would like it to be smth like:</p>\n\n<pre><code>tests:\n  myapp-test:\n    main:                Main.hs\n    source-files:         src/**/*.test.hs\n    ...\n</code></pre>\n\n<p>Is there any option like that, like source-files, or any other way to do this? Thanks!</p>\n"}, {"tags": ["haskell", "binary"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1551382628, "post_id": 54933010, "comment_id": 96630448, "body": "Nice question! What did you try?"}, {"owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1551383080, "post_id": 54933010, "comment_id": 96630671, "body": "I just added the details. Please check!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551383185, "post_id": 54933010, "comment_id": 96630728, "body": "You are trying to apply <code>snd</code> to a value of type <code>Tree (a, Int)</code>, not <code>(a, Int)</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551383544, "post_id": 54933010, "comment_id": 96630903, "body": "In addition, you are only returning the numbered right subtree from <code>labelTree</code>."}, {"owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "edited": false, "score": 0, "creation_date": 1551383954, "post_id": 54933010, "comment_id": 96631106, "body": "I see, how can i achieve that? i am interested in the second value of the tuple? So that i can pass it to right sub tree.  Do i need to work on the helper function which only returns a tuple?"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1551383757, "creation_date": 1551383757, "answer_id": 54933298, "question_id": 54933010, "link": "https://stackoverflow.com/questions/54933010/number-all-occurring-leaves-in-a-tree-from-left-to-right-in-haskell/54933298#54933298", "title": "Number all occurring leaves in a tree from left to right in Haskell", "body": "<p>What you probably need here is some sort of <em>accumulator</em>: a variable that you pass through the recursive calls, and each time you increment each time you \"assign\" the next id.</p>\n\n<p>We thus define our function in terms of a helper function <code>go</code>. <code>go</code> will return a 2-tuple: the \"labeled\" tree, and the next id that we will \"dispatch\". This will later be used since we define a recursive call:</p>\n\n<pre><code>labelTree :: Tree a -&gt; Tree (a, Int)\nlabelTree = fst . go 0\n    where go ...</code></pre>\n\n<p>So <code>go</code> has type <code>Int -&gt; Tree a -&gt; (Int, Tree (a, Int))</code>. In case we see a <code>Leaf</code>, we thus \"dispatch\" that id, and then return that leaf, together with <code>n + 1</code> as second part of the tuple, like:</p>\n\n<pre><code>go (Leaf x) n = (Leaf (x, n), n+1)\n</code></pre>\n\n<p>for a node, we will first dispatch ids to the left subtree, and then take the second item of that tuple as a start to dispatch elements to the right subtree, like:</p>\n\n<pre><code>go (Node l r) n0 = (Node ll lr, n2)\n    where (ll, n1) = go l n0\n          (lr, n2) = go r n1\n</code></pre>\n\n<p>We thus first call <code>go l n0</code> to label the left subtree, and obtain a 2-tuple <code>(ll, n1)</code> that contains <code>ll</code> the labeled left subtree, and <code>n1</code> the new number to dispatch later. We make a call to <code>go r n1</code> so we dispatch numbers to the right subtree starting with <code>n1</code>. Our <code>go</code> funcion thus returns a new <code>Node</code> with the labeled subtrees, and the new number to dispatch. This is important for the caller of this function.</p>\n\n<p>So in full, we can label a tree with:</p>\n\n<pre><code>labelTree :: Tree a -&gt; Tree (a, Int)\nlabelTree = fst . go 0\n    where go (Leaf x) n = (Leaf (x, n), n+1)\n          go (Node l r) n0 = (Node ll lr, n2)\n              where (ll, n1) = go l n0\n                    (lr, n2) = go r n1</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1551390373, "last_edit_date": 1551390373, "creation_date": 1551385745, "answer_id": 54933741, "question_id": 54933010, "link": "https://stackoverflow.com/questions/54933010/number-all-occurring-leaves-in-a-tree-from-left-to-right-in-haskell/54933741#54933741", "title": "Number all occurring leaves in a tree from left to right in Haskell", "body": "<p>You can use the <code>State</code> monad to keep track of the number to add to a node.</p>\n\n<pre><code>labelTree :: Tree a -&gt; Tree (a, Int)\nlabelTree l = evalState (labelTree' l) 0\n    where labelTree' :: Tree a -&gt; State Int (Tree (a, Int))\n          labelTree' (Node l r) = Node &lt;$&gt; labelTree' l &lt;*&gt; labelTree' r\n          labelTree' (Leaf a) = do n &lt;- get\n                                   put $ n + 1\n                                   return $ Leaf (a, n)\n</code></pre>\n\n<p><code>labelTree'</code> builds up a stateful computation which will number the leaves along an in-order traversal. <code>evalState</code> then runs the computation with an initial state of 0, so that leaves are numbered starting at 0.</p>\n\n<p>The recursive case looks much like an ordinary tree function. Instead of simply applying <code>Node</code> to the results of each recursive call, you use the <code>Applicative</code> instance. </p>\n\n<p>The base case numbers each <code>Leaf</code> using the current state and updates the state for the next leaf.</p>\n\n<p>(Note that this is very similar to <a href=\"https://stackoverflow.com/a/54933298/1126841\">Willem Van Onsem's answer</a>. Given that <code>State s a</code> is effectively a wrapper around functions of type <code>s -&gt; (a, s)</code>, the type of <code>labelTree' :: Tree a -&gt; State Int (Tree (a, Int), Int)</code> can be coaxed into the same type as <code>go</code>:</p>\n\n<pre><code>labelTree' :: Tree a -&gt; State Int (Tree (a, Int)) \n            ~ Tree a -&gt; Int -&gt; (Tree (a, Int), Int)\ngo ::         Tree a -&gt; Int -&gt; (Tree (a, Int), Int)\n</code></pre>\n\n<p>)</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551415542, "post_id": 54933812, "comment_id": 96639826, "body": "This is the same as <code>Data.Traversable.mapAccumL</code>, except that your version is a bit stricter. I&#39;m not sure it&#39;s quite the right sort of stricter, though. Need to think that out. Regardless, I believe you should probably use <code>modify&#39;</code> rather than <code>modify</code>."}, {"owner": {"reputation": 3637, "user_id": 797637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1577f43a7c6eb01836e1758a2ba4df5?s=128&d=identicon&r=PG&f=1", "display_name": "firefrorefiddle", "link": "https://stackoverflow.com/users/797637/firefrorefiddle"}, "edited": false, "score": 2, "creation_date": 1551432777, "post_id": 54933812, "comment_id": 96646246, "body": "&quot;that it will still work if you change the structure of your tree&quot; --&gt; But then you depend on the right order of constructor arguments in the extended version of the tree."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3637, "user_id": 797637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1577f43a7c6eb01836e1758a2ba4df5?s=128&d=identicon&r=PG&f=1", "display_name": "firefrorefiddle", "link": "https://stackoverflow.com/users/797637/firefrorefiddle"}, "edited": false, "score": 0, "creation_date": 1551436307, "post_id": 54933812, "comment_id": 96648193, "body": "@firefrorefiddle: yes, although (a) you can implement <code>Traversable</code> yourself, so you &quot;decouple&quot; the way one &quot;traverses&quot; over the tree, from this labeling. If you change your mind and implement the traversing in the reverse way, then this <code>labelTree</code> will change as well, and (b) I think amalloy is talking about changes like <code>Leaf a | Node [Tree a]</code> so we can make it more &quot;robust&quot; to some changes."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551475363, "post_id": 54933812, "comment_id": 96667591, "body": "@dfeuer Indeed. I am really not at all familiar with the stuff in Data.Traversable. You make a good point about my faux strictness. I&#39;ve changed it to at least use <code>modify&#39;</code>."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 12, "last_activity_date": 1551475371, "last_edit_date": 1551475371, "creation_date": 1551386015, "answer_id": 54933812, "question_id": 54933010, "link": "https://stackoverflow.com/questions/54933010/number-all-occurring-leaves-in-a-tree-from-left-to-right-in-haskell/54933812#54933812", "title": "Number all occurring leaves in a tree from left to right in Haskell", "body": "<p>I have the same idea in mind as chepner: to use State. However, you don't have to write the recursion yourself because this is a simple traversal of the tree! Instead, derive Traversable and Foldable for your tree (good ideas anyway), and then lean on them to do the recursion for you:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n{-# LANGUAGE DeriveTraversable #-}\n\nimport qualified Control.Monad.Trans.State.Strict as S\ndata Tree a = Leaf a | Node (Tree a) (Tree a)\n            deriving (Show, Functor, Foldable, Traversable)\n\nlabelTree :: Tree a -&gt; Tree (a, Int)\nlabelTree t = S.evalState (traverse applyLabel t) 0\n  where applyLabel x = do\n          n &lt;- S.get\n          S.modify' succ\n          pure (x, n)\n\n*Main&gt; labelTree (Node (Node (Leaf 'a') (Leaf 'b')) (Leaf 'c'))\nNode (Node (Leaf ('a',0)) (Leaf ('b',1))) (Leaf ('c',2))\n</code></pre>\n\n<p>One nice feature of this implementation is that it will still work if you change the structure of your tree (e.g., to store data in the interior nodes). It is impossible to make mistakes like swapping the order of nodes, because you don't work at that level at all: Traversable handles it for you.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1551415182, "creation_date": 1551415182, "answer_id": 54938028, "question_id": 54933010, "link": "https://stackoverflow.com/questions/54933010/number-all-occurring-leaves-in-a-tree-from-left-to-right-in-haskell/54938028#54938028", "title": "Number all occurring leaves in a tree from left to right in Haskell", "body": "<p>Here's the quick and dirty version:</p>\n\n<pre><code>{-# language DeriveTraversable #-}\n\nimport Data.Traversable (mapAccumL)\n\ndata Tree a\n  = Leaf a\n  | Node (Tree a) (Tree a)\n  deriving (Functor, Foldable, Traversable)\n\nlabelTree :: Tree a -&gt; Tree (a, Int)\nlabelTree = snd .\n  mapAccumL (\\k a -&gt; (k+1, (a, k))) 1\n</code></pre>\n\n<p>Unfortunately, this is likely a bit too lazy to be very efficient in general. I'm still trying to work out how to hit the laziness sweet spot here.</p>\n"}], "owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 54933298, "answer_count": 4, "score": 6, "last_activity_date": 1551790076, "creation_date": 1551382531, "last_edit_date": 1551790076, "question_id": 54933010, "link": "https://stackoverflow.com/questions/54933010/number-all-occurring-leaves-in-a-tree-from-left-to-right-in-haskell", "title": "Number all occurring leaves in a tree from left to right in Haskell", "body": "<p>The function type would be Tree a -> Tree (a, Int). I want to carry the count through out the tree and number each occurring leaf accordingly. </p>\n\n<p>So far I have tried this: </p>\n\n<pre><code>labelTree :: Tree a -&gt; Tree (a, Int)\nlabelTree (Leaf a) = Leaf (a,1)\nlabelTree (tr)     = labelTree' (tr) 0\n\nlabelTree' :: Tree a -&gt; Int -&gt; (Tree (a,Int))\nlabelTree' (Leaf a) n   = Leaf (a,(n+1))\nlabelTree' (Node l r) n = (labelTree' (r) (snd (labelTree' (l) n)))\n</code></pre>\n\n<p>The problem is I am not sure why it is giving me the type error for this expression: <code>labelTree' (Node l r) n = (labelTree' (r) (snd (labelTree' (l) n)))</code> </p>\n\n<p>Please indicate where I went wrong! </p>\n"}, {"tags": ["haskell", "equation-solving", "sieve-of-atkin"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1551386340, "post_id": 54930821, "comment_id": 96632302, "body": "If you&#39;ve solved your question, do you think you could answer it yourself?"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1551388341, "last_edit_date": 1551388341, "creation_date": 1551387687, "answer_id": 54934198, "question_id": 54930821, "link": "https://stackoverflow.com/questions/54930821/haskell-how-to-find-the-number-of-integer-solutions-to-equation-for-use-in-siev/54934198#54934198", "title": "Haskell: How to find the number of integer solutions to equation for use in Sieve of Atkin?", "body": "<p>I'm going to start by reformatting your code a tad to make it more readable. Line breaks are helpful! Also, the order of operations can reduce the weight of parentheses. Side note:</p>\n\n<pre><code>f x | e1 &amp;&amp; e2 &amp;&amp; e3 = e4\n</code></pre>\n\n<p>can also be written</p>\n\n<pre><code>f x | e1\n    , e2\n    , e3\n    = e4\n</code></pre>\n\n<p>which may be easier on the eyes.</p>\n\n<pre><code>eq1 :: Integer -&gt; Integer\neq1 n = eq1_ n []\n\neq1_ :: Integer -&gt; [(Integer, Integer)] -&gt; Integer\neq1_ n list\n  | x &gt; 0 &amp;&amp;\n    y &gt; 0 &amp;&amp;\n    n == 4*x^2 + y^2 &amp;&amp;\n    notElem (x,y) list\n  = eq1_ n ([(x, y)] ++ list)\n  | otherwise\n  = toInteger (length list)\n  where\n    isqrt = floor . sqrt . fromIntegral\n    x = isqrt $ (n - y^2) `div` 4\n    y = isqrt $ n - 4*(x^2)\n</code></pre>\n\n<p>Now I can immediately see that the logic is wonky. Given <code>n</code>, you calculate <code>x</code> and <code>y</code>. Then you either stop or call the function recursively. On the recursive call, however, you're guaranteed to stop! So even if you were otherwise right, you'd definitely have a semantic problem, always returning 0 or 1.</p>\n\n<p>But as you've seen, that's not the only problem. You're also defining <code>x</code> in terms of <code>y</code> and <code>y</code> in terms of <code>x</code>. Now there are important situations where such mutual recursion is useful. But when the mutually recursive values are \"atomic\" things like integers, you're sure to get an infinite loop. Haskell won't solve the equations for you; that's your job!</p>\n\n<hr>\n\n<p>Here's my suggestion:</p>\n\n<p>Start with a brute force list comprehension solution:</p>\n\n<pre><code>sols n\n  = [(x,y)\n    |x &lt;- takeWhile (\\p -&gt; 4 * p^2 &lt; n) [1..]\n    ,y &lt;- takeWhile (\\q -&gt; f x y &lt;= n) [1..]\n    ,f x y = n]\n  where\n    f x y = 4*x^2+y^2\n</code></pre>\n\n<p>Next, you can use an approximate integer square root to narrow the search space for <code>y</code>:</p>\n\n<pre><code>sols n\n  = [(x,y)\n    |x &lt;- takeWhile (\\p -&gt; 4 * p^2 &lt; n) [1..]\n    ,y &lt;- takeWhile\n            (\\q -&gt; f x y &lt;= n)\n          [floor(sqrt(fromIntegral(n-4*x^2)))..]\n    ,f x y = n]\n  where\n    f x y = 4*x^2+y^2\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4306168, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PgHWVIrYxyI/AAAAAAAAAAI/AAAAAAAAACI/3wrSyGLUI5U/photo.jpg?sz=128", "display_name": "D&#39;Deletham i-Ra&#39;tleihfi", "link": "https://stackoverflow.com/users/4306168/ddeletham-i-ratleihfi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551390053, "creation_date": 1551373500, "last_edit_date": 1551390053, "question_id": 54930821, "link": "https://stackoverflow.com/questions/54930821/haskell-how-to-find-the-number-of-integer-solutions-to-equation-for-use-in-siev", "title": "Haskell: How to find the number of integer solutions to equation for use in Sieve of Atkin?", "body": "<p>I am  currently trying to implement the Sieve of Atkin in Haskell</p>\n\n<p>In step 3 on the <a href=\"https://en.wikipedia.org/wiki/Sieve_of_Atkin\" rel=\"nofollow noreferrer\">Wikipedia article on the Sieve of Atkin</a> I need to find the number of Integer solutions to multiple equations.</p>\n\n<p>However my solution to the first of these equations (4x\u00b2 + y\u00b2 = n, x > 0, y > 0\nwith n being a entry in a list of positive Integers) produces an infinite loop upon a query with any n.</p>\n\n<p>This is my code for this part of the problem so far:</p>\n\n<pre><code>eq1 :: Integer -&gt; Integer\neq1 n = eq1_ n []\neq1_ :: Integer -&gt; [(Integer, Integer)] -&gt; Integer\neq1_ n list     | (x &gt; 0) &amp;&amp; (y &gt; 0) &amp;&amp; (n == 4*(x^2) + (y^2)) &amp;&amp; (notElem ((x,y)) list) = eq1_ n ([(x, y)] ++ list)\n                | otherwise = toInteger (length list)\n                where\n                    x = floor (sqrt (fromIntegral ((n - y^2) `div` 4)))\n                    y = floor (sqrt (fromIntegral (n - 4*(x^2))))\n</code></pre>\n\n<p>It is loaded just fine by WinGHCi, but when I query e.g. <code>eq1 0</code> it just stays in an infinite loop and has to be interrupted before producing an answer. I suspect it goes in a loop between the two assignments of <code>x</code> and <code>y</code>.</p>\n\n<p>How can I prevent this? Is this even possible?</p>\n\n<p>Edit: Realised where the infinite loop must be.</p>\n"}, {"tags": ["haskell", "monads", "applicative", "maybe"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1551367484, "post_id": 54928844, "comment_id": 96622530, "body": "Please include the errors you got in the above."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551367510, "post_id": 54928844, "comment_id": 96622547, "body": "The issue is that, although <code>Maybe</code> and <code>[]</code> are both instances of Applicative, and so therefore is their composition (which is what you&#39;re using here), that instance isn&#39;t contained in the prelude. After googling, I see that this is defined in <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Functor-Compose.html#t:Compose\" rel=\"nofollow noreferrer\">Data.Functor.Compose</a> - if you import this module and the <code>Compose</code> type then you should be able to get this to work using <code>Compose [] Maybe</code>. (But I haven&#39;t tried, and aren&#39;t in a position to at the moment.)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551369106, "post_id": 54928844, "comment_id": 96623572, "body": "I think you mean <code>[(+ 3), ((-) 3), (* 3)]</code> for your list of functions."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 9, "last_activity_date": 1551392852, "last_edit_date": 1551392852, "creation_date": 1551369337, "answer_id": 54929617, "question_id": 54928844, "link": "https://stackoverflow.com/questions/54928844/understanding-how-haskell-applicative-functors-are-applied/54929617#54929617", "title": "Understanding how haskell applicative functors are applied", "body": "<p>You have two different <code>Applicative</code> instances. It is true that</p>\n\n<pre><code>Just (* 3) &lt;*&gt; Just 4 == Just 12\n</code></pre>\n\n<p>but the <code>[]</code> instance just tries to <em>apply</em> each \"function\" in the first list to each value in the second, so you end up trying to apply</p>\n\n<pre><code>(Just (* 3)) (Just 4)\n</code></pre>\n\n<p>which is an error.</p>\n\n<p>(More precisely, your list of <code>Just</code> values just has the wrong type to act as the first argument for <code>&lt;*&gt;</code>.)</p>\n\n<p>Instead, you need to need to map <code>&lt;*&gt;</code> over the first list.</p>\n\n<pre><code>&gt; (&lt;*&gt;) &lt;$&gt; [(Just (+3)),(Just ((-) 3)),(Just (*3))] &lt;*&gt; [Just 4]\n[Just 7,Just (-1),Just 12]\n</code></pre>\n\n<p>(Mapping a higher-order function over a list is how you usually get a list of wrapped functions in the first place. For example,</p>\n\n<pre><code>&gt; :t [(+3), ((-) 3), (* 3)]\n[(+3), ((-) 3), (* 3)] :: Num a =&gt; [a -&gt; a]\n&gt; :t Just &lt;$&gt; [(+3), ((-) 3), (* 3)]\nJust &lt;$&gt; [(+3), ((-) 3), (* 3)] :: Num a =&gt; [Maybe (a -&gt; a)]\n</code></pre>\n\n<p>)</p>\n\n<hr>\n\n<p><code>Data.Functor.Compose</code> mentioned in the comments is another option.</p>\n\n<pre><code>&gt; import Data.Functor.Compose\n&gt; :t Compose [(Just (+3)),(Just ((-) 3)),(Just (*3))]\nCompose [(Just (+3)),(Just ((-) 3)),(Just (*3))]\n  :: Num a =&gt; Compose [] Maybe (a -&gt; a)\n&gt; Compose [(Just (+3)),(Just ((-) 3)),(Just (*3))] &lt;*&gt; Compose [Just 4]\nCompose [Just 12,Just (-1),Just 12]\n&gt; getCompose &lt;$&gt; Compose [(Just (+3)),(Just ((-) 3)),(Just (*3))] &lt;*&gt; Compose [Just 4]\n[Just 12,Just (-1),Just 12]\n</code></pre>\n\n<p>The definition of <code>Compose</code> is very simple:</p>\n\n<pre><code>newtype Compose f g a = Compose { getCompose: f (g a) }\n</code></pre>\n\n<p>The magic is that as long as <code>f</code> and <code>g</code> are both (applicative) functors, then <code>Compose f g</code> is <em>also</em> a (applicative) functor.</p>\n\n<pre><code>instance (Functor f, Functor g) =&gt; Functor (Compose f g) where\n    fmap f (Compose x) = Compose (fmap (fmap f) x)\n\ninstance (Applicative f, Applicative g) =&gt; Applicative (Compose f g) where\n    pure x = Compose (pure (pure x))\n    Compose f &lt;*&gt; Compose x = Compose ((&lt;*&gt;) &lt;$&gt; f &lt;*&gt; x)\n</code></pre>\n\n<p>In the <code>Applicative</code> instance, you can see the same use of <code>(&lt;*&gt;) &lt;$&gt; ...</code> that I used above.</p>\n"}], "owner": {"reputation": 67, "user_id": 10697707, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hTPwdU02uBs/AAAAAAAAAAI/AAAAAAAAAJg/tkKYNoEUDwM/photo.jpg?sz=128", "display_name": "Sagarmatha", "link": "https://stackoverflow.com/users/10697707/sagarmatha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551392852, "creation_date": 1551366910, "last_edit_date": 1551376040, "question_id": 54928844, "link": "https://stackoverflow.com/questions/54928844/understanding-how-haskell-applicative-functors-are-applied", "title": "Understanding how haskell applicative functors are applied", "body": "<p>I just have a quick question about applicative functors to help me get a grasp on them. This is just stuff I am applying in ghci.</p>\n\n<pre><code>[(+3),((-) 3),(*3)] &lt;*&gt; [4]\n[7,-1,12]\n</code></pre>\n\n<p>This makes sense to me. Basic application. But when trying:</p>\n\n<pre><code>[(Just (+3)),(Just ((-) 3)),(Just (*3))] &lt;*&gt; [Just 4]\n</code></pre>\n\n<p>I am given a large amount of errors. I have somewhat of an understanding why; there are two data constructors (<code>[]</code> and <code>Maybe</code>) and the <code>&lt;*&gt;</code> function only \"peels back\" one of them. What I'd like to assist my understanding is what exactly haskell is trying to do step by step until it fails, and how you could get around it and have this successfully compute to:</p>\n\n<pre><code>[(Just 7),(Just -1),(Just 12)]\n</code></pre>\n"}, {"tags": ["haskell", "arrows"], "comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551366428, "post_id": 54928453, "comment_id": 96621857, "body": "I do not know, because the example is from <a href=\"https://stackoverflow.com/questions/4191424/what-are-arrows-and-how-can-i-use-them\" title=\"what are arrows and how can i use them\">stackoverflow.com/questions/4191424/&hellip;</a>"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551366479, "post_id": 54928453, "comment_id": 96621890, "body": "@RobinZigmond It exists the composition <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Category.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a>. How to override the default?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551366588, "post_id": 54928453, "comment_id": 96621964, "body": "OK, I stand corrected - thanks"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1551370023, "post_id": 54928453, "comment_id": 96624133, "body": "Use <code>Cat..</code> instead of <code>.</code>"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1551418527, "post_id": 54930035, "comment_id": 96640583, "body": "Neither of those extensions is needed."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1551370707, "creation_date": 1551370707, "answer_id": 54930035, "question_id": 54928453, "link": "https://stackoverflow.com/questions/54928453/couldnt-match-expected-type-a-int-with-actual-type-ioarrow-string-int/54930035#54930035", "title": "Couldn&#39;t match expected type \u2018a -&gt; Int\u2019 with actual type \u2018IOArrow String Int\u2019", "body": "<p>You want <code>(.) :: Category cat =&gt; cat b c -&gt; cat a b -&gt; cat a c</code> from <code>Control.Category</code>, but you end up using <code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)</code> from the <code>Prelude</code>.</p>\n\n<ul>\n<li>Enable <code>NoImplicitPrelude</code> then import the <code>Prelude</code> explicitly hiding <code>id</code> and <code>(.)</code></li>\n<li>Import <code>Control.Category</code> unqualified (or suffer <code>Cat..</code> everywhere)</li>\n</ul>\n\n<p>Bonus: <code>arr id</code> is just <code>id</code> from <code>Control.Catgory</code>.</p>\n\n<pre><code>{-# LANGUAGE Arrows, NoImplicitPrelude #-}\n\nmodule Main where\n\nimport Prelude hiding ((.), id)\nimport Control.Arrow\nimport Control.Monad\nimport Control.Category\nimport Data.List\nimport Data.Maybe\n\ndata IOArrow a b = IOArrow { runIOArrow :: a -&gt; IO b }\n\ninstance Category IOArrow where\n  id = IOArrow return\n  IOArrow f . IOArrow g = IOArrow $ f &lt;=&lt; g\n\ninstance Arrow IOArrow where\n  arr f = IOArrow $ return . f\n  first (IOArrow f) = IOArrow $ \\(a, c) -&gt; do\n    x &lt;- f a\n    return (x, c)\n\nfoo :: Int -&gt; String\nfoo = show\n\nbar :: String -&gt; IO Int\nbar = return . read\n\nmain :: IO ()\nmain = do\n  let f = arr (++\"!!\") . arr foo . IOArrow bar . id\n  result &lt;- runIOArrow f \"123\"\n  putStrLn result \n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 54930035, "answer_count": 1, "score": 4, "last_activity_date": 1559485275, "creation_date": 1551365774, "last_edit_date": 1559485275, "question_id": 54928453, "link": "https://stackoverflow.com/questions/54928453/couldnt-match-expected-type-a-int-with-actual-type-ioarrow-string-int", "title": "Couldn&#39;t match expected type \u2018a -&gt; Int\u2019 with actual type \u2018IOArrow String Int\u2019", "body": "<p>I am trying to understand the Arrow and create the following example: </p>\n\n<pre><code>{-# LANGUAGE Arrows #-}\n\n\nmodule Main where\n\nimport Control.Arrow\nimport Control.Monad\nimport qualified Control.Category as Cat\nimport Data.List\nimport Data.Maybe\n\ndata IOArrow a b = IOArrow { runIOArrow :: a -&gt; IO b }\n\ninstance Cat.Category IOArrow where\n  id = IOArrow return\n  IOArrow f . IOArrow g = IOArrow $ f &lt;=&lt; g\n\ninstance Arrow IOArrow where\n  arr f = IOArrow $ return . f\n  first (IOArrow f) = IOArrow $ \\(a, c) -&gt; do\n    x &lt;- f a\n    return (x, c)\n\nfoo :: Int -&gt; String\nfoo = show\n\nbar :: String -&gt; IO Int\nbar = return . read\n\nmain :: IO ()\nmain = do\n  let f = arr (++\"!!\") . arr foo . IOArrow bar . arr id\n  result &lt;- runIOArrow f \"123\"\n  putStrLn result \n</code></pre>\n\n<p>The compiler complains:</p>\n\n<pre><code>    \u2022 Couldn't match expected type \u2018a -&gt; Int\u2019\n                  with actual type \u2018IOArrow String Int\u2019\n    \u2022 Possible cause: \u2018IOArrow\u2019 is applied to too many arguments\n      In the first argument of \u2018(.)\u2019, namely \u2018IOArrow bar\u2019\n      In the second argument of \u2018(.)\u2019, namely \u2018IOArrow bar . arr id\u2019\n      In the second argument of \u2018(.)\u2019, namely\n        \u2018arr foo . IOArrow bar . arr id\u2019\n    \u2022 Relevant bindings include\n        f :: a -&gt; [Char] (bound at app/Main.hs:32:7)\n   |\n32 |   let f = arr (++\"!!\") . arr foo . IOArrow bar . arr id\n   |                                    ^^^^^^^^^^^\n\n\n    \u2022 Couldn't match expected type \u2018IOArrow [Char] String\u2019\n                  with actual type \u2018a0 -&gt; [Char]\u2019\n    \u2022 Probable cause: \u2018f\u2019 is applied to too few arguments\n      In the first argument of \u2018runIOArrow\u2019, namely \u2018f\u2019\n      In a stmt of a 'do' block: result &lt;- runIOArrow f \"123\"\n      In the expression:\n        do let f = arr (++ \"!!\") . arr foo . IOArrow bar . arr id\n           result &lt;- runIOArrow f \"123\"\n           putStrLn result\n   |\n33 |   result &lt;- runIOArrow f \"123\"\n   |                        ^  \n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 9, "last_activity_date": 1551363800, "creation_date": 1551363800, "answer_id": 54927840, "question_id": 54927696, "link": "https://stackoverflow.com/questions/54927696/they-are-simply-abstractions-of-functions/54927840#54927840", "title": "They are simply abstractions of functions", "body": "<p>That's not a formal definition, but hints to the fact that the notion of \"arrow\" is a generalization of the notion of \"function\". In other words, functions are a special case of arrows, but arrows can also be something else.</p>\n\n<p>An \"arrow\" is something that shares some features with regular functions, e.g. they have a domain type and a codomain type, they can be composed, there is an \"identity arrow\" from any type to itself, and so on.</p>\n\n<p>However, not all features of functions are shared by all the arrows. For instance, a function can always be applied to suitable arguments, while that might not be the case for an arrow.</p>\n\n<p>In technical lingo, one can therefore say that the notion of \"arrow\" is an abstraction, or generalization, of the notion of function.</p>\n\n<p>(Let me add that I somewhat disagree with the \"simply\" used in your quote. These abstract notions might be trivial after one learns them, but the learning process is not that simple.)</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 54927840, "answer_count": 1, "score": 1, "last_activity_date": 1551363800, "creation_date": 1551363302, "question_id": 54927696, "link": "https://stackoverflow.com/questions/54927696/they-are-simply-abstractions-of-functions", "title": "They are simply abstractions of functions", "body": "<p>I am reading the post from <a href=\"https://stackoverflow.com/questions/4191424/what-are-arrows-and-how-can-i-use-them\">What are arrows, and how can I use them?</a> and on the third answer, John Wiegley has mentioned the following:  </p>\n\n<blockquote>\n  <p>They are simply abstractions of functions. </p>\n</blockquote>\n\n<p>What does it mean?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551362723, "post_id": 54924462, "comment_id": 96619464, "body": "It&#39;s not a conversion operator; it&#39;s pure syntax."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1551357534, "post_id": 54925125, "comment_id": 96616417, "body": "Also note that it&#39;s <code>( `identifier` )</code> instead of <code>( `expression` )</code>. The latter could lead to some weird cases to parse, since the expression might involve backticks e.g. <code>( a `\\x y -&gt; x `max` y` b )</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1551380779, "post_id": 54925125, "comment_id": 96629651, "body": "@chi ...which is why I have sometimes wished there was a properly &quot;open- and close-paren&quot; version of them. Currently the character pairs backtick-open-paren and close-paren-backtick are invalid syntax, so you could make them valid without breaking backward compatibility, and it would sometimes be nice to be able to make an expression be infix briefly."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 10, "last_activity_date": 1551354739, "creation_date": 1551354739, "answer_id": 54925125, "question_id": 54924462, "link": "https://stackoverflow.com/questions/54924462/why-is-the-operator-function-conversion-not-reversible/54925125#54925125", "title": "Why is the operator / function conversion not reversible?", "body": "<p>Every time you write <code>(`max`)</code>, you could also write <code>max</code>. Every time you write <code>`(+)`</code> you could also write <code>+</code>. Making the syntax of operators or identifiers recursive adds complexity to the parser for no benefit.</p>\n\n<pre><code>op ::= opSymbol* | `identifier`\n</code></pre>\n"}], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 54925125, "answer_count": 1, "score": 3, "last_activity_date": 1551354739, "creation_date": 1551352610, "question_id": 54924462, "link": "https://stackoverflow.com/questions/54924462/why-is-the-operator-function-conversion-not-reversible", "title": "Why is the operator / function conversion not reversible?", "body": "<p>In Haskell every operator is considered to be syntactic sugar for a two-argument function (except unary minus, which is a lexical-level exception).</p>\n\n<p>I can convert an operator into a function by enclosing it in brackets, like this:</p>\n\n<pre><code>Prelude&gt; (+) 3 4\n7\n</code></pre>\n\n<p>Likewise I can make a two-argument function into an operator by enclosing it in back-ticks:</p>\n\n<pre><code>Prelude&gt; 3 `max` 4\n4\n</code></pre>\n\n<p>So why can't I do both?</p>\n\n<pre><code>Prelude&gt; (`max`) 3 4\n&lt;interactive&gt;:3:7: error: parse error on input \u2018)\u2019\n\nPrelude&gt; 3 `(+)` 4\n&lt;interactive&gt;:4:4: error: parse error on input \u2018(\u2019\n</code></pre>\n\n<p>The first is particularly egregious because the following does work:</p>\n\n<pre><code>Prelude&gt; (`max` 3) 4\n4\n</code></pre>\n"}, {"tags": ["haskell", "dynamic", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "edited": false, "score": 0, "creation_date": 1551365375, "post_id": 54922641, "comment_id": 96621187, "body": "The context is the <code>registry</code> library which is using <code>Dynamic</code> under the hood: <a href=\"http://github.com/etorreborre/registry\" rel=\"nofollow noreferrer\">github.com/etorreborre/registry</a>. It is possible to add monomorphic constructors to the Registry, for Hedgehog generators for example, but this means that I need one line for each <code>Gen (Maybe a)</code>  or <code>Gen [a]</code> that I want to include in the registry: <a href=\"https://github.com/etorreborre/registry/blob/e176f1337de9d17d16b83b35b973d94f965f408c/test/Test/Data/Registry/Internal/Gens.hs#L32\" rel=\"nofollow noreferrer\">github.com/etorreborre/registry/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 1, "last_activity_date": 1551347193, "creation_date": 1551347193, "answer_id": 54922641, "question_id": 54921200, "link": "https://stackoverflow.com/questions/54921200/how-to-apply-a-dynamic-polymorphic-function-to-a-dynamic-value/54922641#54922641", "title": "How to apply a dynamic polymorphic function to a dynamic value?", "body": "<p>As <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Dynamic.html\" rel=\"nofollow noreferrer\">the docs for <code>Data.Dynamic</code></a> says,</p>\n\n<blockquote>\n  <p>A <code>Dynamic</code> may only represent a monomorphic value; an attempt to create a value of type <code>Dynamic</code> from a polymorphically-typed expression will result in an ambiguity error (see <code>toDyn</code>).</p>\n</blockquote>\n\n<p>Perhaps you're looking for something like one of the following?</p>\n\n<pre><code>toDynJust :: Typeable a =&gt; a -&gt; Dynamic\ntoDynJust = toDyn . Just\n</code></pre>\n\n<p>or the built-in <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Dynamic.html#v:fromDynamic\" rel=\"nofollow noreferrer\"><code>fromDynamic :: Typeable a =&gt; Dynamic -&gt; Maybe a</code></a>?</p>\n\n<p>Perhaps if you revealed more of what you're trying to do, rather than how you're trying to do it, one could better tell if that is the right approach. :-)</p>\n"}], "owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551347193, "creation_date": 1551342130, "question_id": 54921200, "link": "https://stackoverflow.com/questions/54921200/how-to-apply-a-dynamic-polymorphic-function-to-a-dynamic-value", "title": "How to apply a dynamic polymorphic function to a dynamic value?", "body": "<p>I would like to create a dynamic value out of the <code>Just</code> function to be able to apply it to <code>toDyn (1 :: Int)</code>.</p>\n\n<p>My first difficulty is that I need to have a <code>Typeable</code> function. However this doesn't work:</p>\n\n<pre><code>createMaybe :: (Typeable a) =&gt; a -&gt; Maybe a\ncreateMaybe = Just\n\ntoDyn createMaybe\n</code></pre>\n\n<p>This fails to compile with <code>No instance for (Typeable a0) arising from a use of \u2018toDyn\u2019</code></p>\n\n<p>Is there a way to work around that?</p>\n"}, {"tags": ["haskell", "gadt"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1551337658, "post_id": 54919548, "comment_id": 96605578, "body": "The GADT form is valuable if you are doing tricky stuff with it -- your tricky stuff can be more deeply typechecked so you maybe have some hope of getting it right.  If you are not really manipulating it in any substantial way, I don&#39;t see much value in the GADT form."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1551352032, "post_id": 54919548, "comment_id": 96613200, "body": "Types can be looser (enforcing fewer static guarantees) or stricter (enforcing more static guarantees). Using stricter types makes harder to <i>construct</i> values (since one needs to convince the enforcing machinery), and easier to <i>use</i> values (since one can assume the guarantees). I.e. harder introduction, easier elimination. Instead, looser types have easier introduction and harder elimination (no guarantees on values). Above, you only consider the input/parsing parts, i.e. introduction, so it&#39;s going to be harder."}], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551438806, "post_id": 54927023, "comment_id": 96649601, "body": "&quot;The evaluation code itself is beautiful&quot; Yes (and thank you to goldfirere): there&#39;s both a fully-eval option and a step-by-step; they both go by unpeeling one layer from a term then re-wrapping with the GADT; so making sure eval is type-safe. So there&#39;s double/treble the mileage from the GADT. OTOH it is distasteful to have both <code>UExp</code> (not a GADT) and <code>Exp</code>. (Effectively pretty printing needs 3 times the code: one to translate from <code>UExp</code> to <code>pretty</code>; one to translate from <code>Exp</code> to <code>pretty</code>; and <code>pretty</code> itself with lots of instances.)"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551493339, "post_id": 54927023, "comment_id": 96671748, "body": "printing actually is a <i>bit</i> cleverer than that, but your point stands."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1551360954, "creation_date": 1551360954, "answer_id": 54927023, "question_id": 54919548, "link": "https://stackoverflow.com/questions/54919548/gadts-for-a-dsl-swings-and-roundabouts/54927023#54927023", "title": "GADTs for a DSL: swings and roundabouts?", "body": "<p>Note that GHCi does not use GADTs to represent expressions. Even GHC's internal core expression type <a href=\"https://hackage.haskell.org/package/ghc-8.6.1/docs/CoreSyn.html#t:Expr\" rel=\"noreferrer\"><code>Expr</code></a> is not a GADT.</p>\n\n<h1>DSLs</h1>\n\n<p>For the purpose of having a larger more fleshed out example of your <code>Term</code> type, consider <a href=\"https://github.com/goldfirere/glambda\" rel=\"noreferrer\"><code>glambda</code></a>. Its <a href=\"https://github.com/goldfirere/glambda/blob/40f0a1e1aa05c063f449b781f244b379f45f730b/src/Language/Glambda/Exp.hs#L45-L53\" rel=\"noreferrer\"><code>Exp</code></a> type even tracks variables at the type level.</p>\n\n<ul>\n<li><p>There is a second <code>UExp</code> data type which, as you observed yourself, is what gets actually parsed from the REPL. This type then gets typechecked into <code>Exp</code> and passed on to a continuation with: </p>\n\n<pre><code>check :: (MonadError Doc m, MonadReader Globals m)\n      =&gt; UExp -&gt; (forall t. STy t -&gt; Exp '[] t -&gt; m r)\n      -&gt; m r\n</code></pre></li>\n<li><p>Pretty-printing of <code>UExp</code> and <code>Exp</code> is hand-written, but at least <a href=\"https://github.com/goldfirere/glambda/blob/40f0a1e1aa05c063f449b781f244b379f45f730b/src/Language/Glambda/Pretty.hs\" rel=\"noreferrer\">uses the same code</a> (it does this via a <code>PrettyExp</code> class).</p></li>\n<li><p>The <a href=\"https://github.com/goldfirere/glambda/blob/40f0a1e1aa05c063f449b781f244b379f45f730b/src/Language/Glambda/Eval.hs#L57-L65\" rel=\"noreferrer\">evaluation code itself</a> is beautiful, but I doubt I need to sell you on that. :)</p></li>\n</ul>\n\n<h1>EDSLs</h1>\n\n<p>As I understand it, GADTs are splendid for EDSLs (embedded DSLs), since these are just portions of code in a large Haskell program. Yes, type errors can be complicated (and will come from GHC directly), but that's the price you pay for being able to maintain type-level invariants in your code. Consider, for instance, <code>hoopl</code>'s representation of basic blocks in a CFG:</p>\n\n<pre><code>data Block n e x where\n  BlockCO  :: n C O -&gt; Block n O O          -&gt; Block n C O\n  BlockCC  :: n C O -&gt; Block n O O -&gt; n O C -&gt; Block n C C\n  BlockOC  ::          Block n O O -&gt; n O C -&gt; Block n O C\n\n  BNil    :: Block n O O\n  BMiddle :: n O O                      -&gt; Block n O O\n  BCat    :: Block n O O -&gt; Block n O O -&gt; Block n O O\n  BSnoc   :: Block n O O -&gt; n O O       -&gt; Block n O O\n  BCons   :: n O O       -&gt; Block n O O -&gt; Block n O O\n</code></pre>\n\n<p>Sure, you open yourself up to nasty type errors, but you also have the ability to track fallthrough information at the type-level. This makes it much easier to think about dataflow problems. </p>\n\n<h1>So what...?</h1>\n\n<p>The point I'm trying to make is: <strong>if your GADT is being constructed from a <code>String</code> (or a custom REPL), you'll have a rough time performing the translation. That's unavoidable because what you are doing is essentially re-implementing a simple type-checker.</strong> Your best bet is to confront this head on (as <code>glambda</code> does) and distinguish the parsing from the type-checking.</p>\n\n<p>However, if you can afford to stay within the bounds of Haskell code, you can just hand parsing and typechecking to GHC. IMHO, EDSLs are way cooler and more practical that non-embedded DSLs.</p>\n"}], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 1, "accepted_answer_id": 54927023, "answer_count": 1, "score": 6, "last_activity_date": 1551441321, "creation_date": 1551334749, "last_edit_date": 1551441321, "question_id": 54919548, "link": "https://stackoverflow.com/questions/54919548/gadts-for-a-dsl-swings-and-roundabouts", "title": "GADTs for a DSL: swings and roundabouts?", "body": "<p>The typical examples for the benefits of a GADT are representing the syntax for a DSL; say <a href=\"https://en.wikibooks.org/wiki/Haskell/GADT\" rel=\"nofollow noreferrer\">here on the wiki</a> or <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/gadt-pldi.pdf\" rel=\"nofollow noreferrer\">the PLDI 2005 paper</a>.</p>\n\n<p>I can see that if you have a AST that's type-correct by construction, writing an <code>eval</code> function is easy.</p>\n\n<p>How to build the GADT handling into a REPL? Or more specifically into a Read-Parse-Typecheck-Eval-Print-Loop? I'm seeing that you just push the complexity from the <code>eval</code> step into earlier steps.</p>\n\n<p>Does GHCi use a GADT internally to represent expressions it's evaluating? (The expressions are a lot chunkier than a typical DSL.)</p>\n\n<ul>\n<li><p>For one thing, you can't <code>derive Show</code> for a GADT, so for the Print step you either hand-roll <code>Show</code> instances or something like this:</p>\n\n<pre><code>{-# LANGUAGE  GADTs, StandaloneDeriving  #-}\n\ndata Term a where\n  Lit :: Int -&gt; Term Int\n  Inc :: Term Int -&gt; Term Int\n  IsZ :: Term Int -&gt; Term Bool\n  If :: Term Bool -&gt; Term a -&gt; Term a -&gt; Term a\n  Pair :: (Show a, Show b) =&gt; Term a -&gt; Term b -&gt; Term (a,b)\n  Fst :: (Show b) =&gt; Term (a,b) -&gt; Term a\n  Snd :: (Show a) =&gt; Term (a,b) -&gt; Term b\n\nderiving instance (Show a) =&gt; Show (Term a)\n</code></pre>\n\n<p>(It seems to me those <code>Show</code> constraints tangled in the constructors are already failing to separate concerns.)</p></li>\n</ul>\n\n<p>I'm more thinking about the user-experience for somebody entering DSL expressions, rather than the programmer's convenience of the <code>eval</code> function. Either:</p>\n\n<ul>\n<li>The user enters expressions directly using the GADT constructors. It's easy to make a syntactically correct but ill-typed mistake (say a mis-placed parens). Then GHCi gives rather unfriendly rejection messages. Or</li>\n<li>The REPL takes the input as text and parses it. But for a GADT like that, getting a <code>Read</code> instance is real hard work. So perhaps</li>\n<li>The application has two data structures: one being type-mistake-tolerant; the other being the GADT; and the validate step constructs the GADT AST, if it can do so type-safely.</li>\n</ul>\n\n<p>At that last bullet, I seem to be back with 'smart constructors', that GADTs are supposed to improve on(?) What's more I've doubled the work somewhere.</p>\n\n<p>I don't have a 'better way' to approach it. I'm wondering how to approach DSL applications in practice. (For context: I'm thinking about a database query environment, where type inference has to look at the types of the fields in the database to validate what operations on them.)</p>\n\n<p><strong>Addit:</strong> after working through the answer from @Alec</p>\n\n<p>I see the code for pretty printing in <code>glambda</code> involves several layers of classes and instances. Something feels wrong here as opposed to what are the claimed advantages of a GADT for an AST. The idea of a (well-typed) AST is you can equally easily: eval it; or pretty-print it; or optimise it; or code-generate from it; etc.</p>\n\n<p><code>glambda</code>'s seems to be aimed at eval'ing (which is fair enough given the purpose of the exercise). I'm wondering ...</p>\n\n<ul>\n<li><p>Why the need to express the whole syntax for the (E)DSL in one datatype? (The wikibook example starts its straw man doing that <code>data Expr = ...</code>; and rapidly runs into type trouble. Well of course it does; that's never going to work; almost anything would work better than that; I feel cheated.)</p></li>\n<li><p>If we end up writing classes and instances anyway, why not make each syntax production a separate datatype: <code>data Lit = Lit Int</code> ... <code>data If b a1 a2 = If b a1 a2</code> ... Then a <code>class IsTerm a c  | a -&gt; c where ...</code> (i.e. a <code>FunDep</code> or maybe a Type Family whose instances tell us the Term's result-type.)</p></li>\n<li><p>Now the EDSL uses the same constructors (the user doesn't care they're from different datatypes); and they apply 'sloppy' type-checking. Pretty printing/error reporting also doesn't need tight typechecking. Eval does, and insists on the <code>IsTerm</code> instances all lining up.</p></li>\n</ul>\n\n<p>I didn't suggest this approach before, because it seemed to involve too much crufty code. But actually it's no worse than <code>glambda</code> -- that is, when you consider the whole functionality, not just the eval step.</p>\n\n<p>It seems to me a big advantage to express the syntax only once. Furthermore it seems more extensible: add a new datatype per syntax production, rather than breaking open an existing datatype. Oh, and because they're H98 datatypes (no existentials), <code>deriving</code> works fine.</p>\n"}]