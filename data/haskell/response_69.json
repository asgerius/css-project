[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1462409441, "post_id": 37039873, "comment_id": 61630681, "body": "Your best bet is probably to use GHC <code>RULES</code> pragmas to specialize too specific types. This is ... not a sure bet."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1462411517, "post_id": 37040323, "comment_id": 61631146, "body": "I still don&#39;t understand why <code>MonoFoldable</code> uses type families instead of MPTCs with fundeps, which strike me as a more natural fit to the particular problem."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 4, "last_activity_date": 1462408247, "last_edit_date": 1462408247, "creation_date": 1462407919, "answer_id": 37040323, "question_id": 37039873, "link": "https://stackoverflow.com/questions/37039873/can-i-specialize-a-foldable-instance-method-based-on-the-typeclass-of-a/37040323#37040323", "title": "Can I specialize a Foldable instance method based on the typeclass of a?", "body": "<p>No.  It's a long-standing wart that the standard type classes aren't compatible with types that require restricted parameters.</p>\n\n<p>Check out the <a href=\"https://www.stackage.org/lts-5.11/package/mono-traversable-0.10.1.1\" rel=\"nofollow\"><code>monotraversable</code> library</a>, though, and in particular its <a href=\"http://haddock.stackage.org/lts-5.11/mono-traversable-0.10.1.1/Data-MonoTraversable.html#t:MonoFoldableOrd\" rel=\"nofollow\"><code>MonofoldableOrd</code> class</a>, which might well be useful to you.  The <code>monotraversable</code> library is an alternative version of the <code>Foldable</code>/<code>Traversable</code> classes that has been written to work on containers with monomorphic element types (think <code>ByteString</code> or <code>Text</code>) or with class-restricted element types (think <code>Set</code>).</p>\n\n<p>The library is a heavy user of the <a href=\"https://ocharles.org.uk/blog/posts/2014-12-12-type-families.html\" rel=\"nofollow\"><code>TypeFamilies</code> extension</a>, so you may have to study that a bit\u2014although the library source code should provide plenty of examples of how to use the extension.</p>\n"}], "owner": {"reputation": 2704, "user_id": 2629787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HApc9.jpg?s=128&g=1", "display_name": "Koz Ross", "link": "https://stackoverflow.com/users/2629787/koz-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 37040323, "answer_count": 1, "score": 4, "last_activity_date": 1462408247, "creation_date": 1462404934, "question_id": 37039873, "link": "https://stackoverflow.com/questions/37039873/can-i-specialize-a-foldable-instance-method-based-on-the-typeclass-of-a", "title": "Can I specialize a Foldable instance method based on the typeclass of a?", "body": "<p>I have a <code>Foldable</code> container for <code>a</code>s. One of the methods provided by the <code>Foldable</code> typeclass in <code>BasicPrelude</code> is <code>elem :: (Eq a) =&gt; a -&gt; t a -&gt; Bool</code>. Now, for my container, I can implement <code>elem</code> more efficiently than the default provided that my <code>a</code> is an <code>Ord</code> instance, but only in that case.</p>\n\n<p>Now, I would like to have the more efficient <code>elem</code> available if possible, preferably with the same signature (i.e. 'transparently'). However, I can only see one way of doing this, which is to require an <code>(Ord a)</code> constraint on the <code>Foldable</code> instance for my container, which makes no sense in the general case. </p>\n\n<p>Is it possible for me to have a specialized <code>elem</code> only for cases where <code>a</code> is an <code>Ord</code>, and a general <code>elem</code> for others somehow? I don't mind use of GHC extensions if that's what it takes.</p>\n"}, {"tags": ["haskell", "monoids"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1462403501, "post_id": 37039444, "comment_id": 61629039, "body": "<code>Node [] []</code> isn&#39;t an empty tree, it&#39;s a single node with no children."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1462403720, "post_id": 37039444, "comment_id": 61629110, "body": "You need to clarify what tree type this is you&#39;re talking about."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1462418028, "post_id": 37039444, "comment_id": 61632667, "body": "This monoid is also available in <a href=\"http://hackage.haskell.org/package/monoid-extras-0.4.0.4/docs/Data-Monoid-Inf.html\" rel=\"nofollow noreferrer\">monoid-extras</a>. A slight warning if you implement <code>Min</code> yourself instead of using this package: <code>mappend (Min x) (Min y) = Min (min x y)</code> is not quite right!"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6173582, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-b0bH3dMEiKY/AAAAAAAAAAI/AAAAAAAAAF8/zMBgeDq2Nmg/photo.jpg?sz=128", "display_name": "alejandro Guevara", "link": "https://stackoverflow.com/users/6173582/alejandro-guevara"}, "edited": false, "score": 0, "creation_date": 1462404877, "post_id": 37039718, "comment_id": 61629469, "body": "but shouldn&#39;t apply same as lists withou elements?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 17, "user_id": 6173582, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-b0bH3dMEiKY/AAAAAAAAAAI/AAAAAAAAAF8/zMBgeDq2Nmg/photo.jpg?sz=128", "display_name": "alejandro Guevara", "link": "https://stackoverflow.com/users/6173582/alejandro-guevara"}, "edited": false, "score": 0, "creation_date": 1462405034, "post_id": 37039718, "comment_id": 61629520, "body": "That isn&#39;t a tree without elements.  That&#39;s a tree with one element, and the element is <code>[]</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1462415826, "post_id": 37039718, "comment_id": 61632181, "body": "I don&#39;t think you will have a constraint (and also <code>a =&gt; Tree [a]</code> would be invalid because <code>a</code> cannot be a constraint in this context, even if <code>ConstraintKinds</code> are enabled)"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1462441525, "post_id": 37039718, "comment_id": 61642638, "body": "@DavidYoung: Notice there&#39;s no class there.  That&#39;s just a tired brain thinking <code>forall a.</code> and writing <code>a =&gt;</code> instead."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 4, "last_activity_date": 1462404000, "creation_date": 1462404000, "answer_id": 37039718, "question_id": 37039444, "link": "https://stackoverflow.com/questions/37039444/monoid-on-any-foldable/37039718#37039718", "title": "Monoid on any Foldable", "body": "<p>The <code>Tree</code> type in <code>Data.Tree</code> does not support empty trees.  Ask GHCI what the type of <code>Node [] []</code> is and you'll find out something like this:</p>\n\n<pre><code>Node [] [] :: a =&gt; Tree [a]\n</code></pre>\n\n<p>Your monoid works fine.</p>\n"}], "owner": {"reputation": 17, "user_id": 6173582, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-b0bH3dMEiKY/AAAAAAAAAAI/AAAAAAAAAF8/zMBgeDq2Nmg/photo.jpg?sz=128", "display_name": "alejandro Guevara", "link": "https://stackoverflow.com/users/6173582/alejandro-guevara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 37039718, "answer_count": 1, "score": 0, "last_activity_date": 1462404243, "creation_date": 1462402476, "last_edit_date": 1462404243, "question_id": 37039444, "link": "https://stackoverflow.com/questions/37039444/monoid-on-any-foldable", "title": "Monoid on any Foldable", "body": "<p>I'm trying to make an instance of a Monoid on haskell, a monoid that can be applicable on any Foldable strutucture that contains comparables elements and returns the maximun value stored.</p>\n\n<p>So far i have this</p>\n\n<pre><code>import Data.List\nimport Data.Functor\nimport Data.Monoid\nimport Data.Foldable\nimport Data.Tree\n\nnewtype Max a = Max { getMax :: Maybe a}\n   deriving (Eq, Ord, Show, Read)\n\ninstance Ord a =&gt; Monoid (Max a) where\n   mempty = Max Nothing\n   mappend (Max x) (Max y) = Max (max x y)\n</code></pre>\n\n<p>It works prefectly on list but have some issue with Trees. When i use it on void list it returns</p>\n\n<pre><code>ghci&gt; foldMap (Max . Just) []\nMax {getMax = Nothing}\n</code></pre>\n\n<p>And that's what i want, but when i use it on Trees with no elements</p>\n\n<pre><code>ghci&gt; foldMap (Max . Just) (Node [] [])\nMax {getMax = Just []}\n</code></pre>\n\n<p>But i want to it returns Nothing instead Just []. It doesn't opperate with Nodes with no childrens but it works with valued ones</p>\n\n<pre><code>ghci&gt; foldMap (Max . Just) (Node 22 [Node 7 [Node 42 []], Node 18 [] ])\nMax {getMax = Just 42}\n</code></pre>\n\n<p>Any suggestion?</p>\n\n<p>PD: I'm using ghci 7.10</p>\n"}, {"tags": ["haskell", "typeclass", "functor"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1462402757, "post_id": 37039042, "comment_id": 61628836, "body": "This looks likely to be related to the <code>Distributive</code> and <code>Representable</code> classes in some fashion."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1462412604, "post_id": 37039042, "comment_id": 61631412, "body": "The type of the function and the law you have given it are very strong - a <code>Tag f</code> may only contain precisely one value of type <code>a</code>. <code>reorder</code> really isn&#39;t doing anything here - all instances of <code>Tag</code> are isomorphic to <code>(X, a)</code> for some <code>X</code>, so its type is pretty much <code>(x, (y, a)) -&gt; (y, (x, a))</code>."}, {"owner": {"reputation": 436, "user_id": 1152427, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f58ad5b5fc9bee2e9a0837afb1cb5da8?s=128&d=identicon&r=PG", "display_name": "Pan Hania", "link": "https://stackoverflow.com/users/1152427/pan-hania"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1462461536, "post_id": 37039042, "comment_id": 61655546, "body": "@user2407038: Now that you have said that it looks obvious. I guess I just tried too hard..."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 0, "last_activity_date": 1581479826, "creation_date": 1581479826, "answer_id": 60180893, "question_id": 37039042, "link": "https://stackoverflow.com/questions/37039042/what-is-the-name-of-this-functor-ish-tag-like-typeclass/60180893#60180893", "title": "What is the name of this functor-ish tag-like typeclass?", "body": "<p><a href=\"https://stackoverflow.com/questions/37039042/what-is-the-name-of-this-functor-ish-tag-like-typeclass#comment61631412_37039042\">user2407038's comment</a> does get to the heart of it, in that the notion you are ultimately looking to express boils down to functors that are isomorphic to some pair functor -- after all, a pair is a value with something else attached. From this vantage point, there are a few possibly interesting extra things to be noted.</p>\n\n<p>For the sake of convenience, I will assume your <code>Tag</code>s are <code>Functor</code>s (the relevant condition you mention holds by parametricity), and simplify the types by replacing <code>forall b. b -&gt; f b</code> with the isomorphic <code>f ()</code>. We might then have:</p>\n\n<pre><code>separate :: Tag f =&gt; f a -&gt; (f (), a)\n</code></pre>\n\n<p>With the law:</p>\n\n<pre><code>slot . separate = id\n</code></pre>\n\n<p>Where the left inverse is:</p>\n\n<pre><code>slot :: Functor f =&gt; (f (), a) -&gt; f a\nslot (sh, a) = fmap (const a) sh\n</code></pre>\n\n<p>By adding the requirement that <code>slot</code> should be surjective (which is entirely sensible as far as your use case is concerned), <code>slot</code> is upgraded to a full inverse, thus giving us an isomorphism between <code>f a</code> and <code>(f (), a)</code>.</p>\n\n<p>These functions exist in at least one place in the ecosystem: <a href=\"http://hackage.haskell.org/package/adjunctions-4.4/docs/Data-Functor-Adjunction.html#v:splitL\" rel=\"nofollow noreferrer\">the <em>adjunctions</em> package</a>:</p>\n\n<pre><code>splitL :: Adjunction f u =&gt; f a -&gt; (a, f ())\nunsplitL :: Functor f =&gt; a -&gt; f () -&gt; f a\n</code></pre>\n\n<p>Hask/Hask left adjoints are isomorphic to pair functors, dually to how Hask/Hask right adjoints are <a href=\"http://hackage.haskell.org/package/adjunctions-4.4/docs/Data-Functor-Rep.html#t:Representable\" rel=\"nofollow noreferrer\"><code>Representable</code></a>, that is, isomorphic to function functors. <a href=\"https://stackoverflow.com/questions/37039042/what-is-the-name-of-this-functor-ish-tag-like-typeclass#comment61628836_37039042\">dfeuer's suspicion</a> is, in a way, justified, though <em>adjunctions</em> doesn't give us left adjoint counterparts to <code>Distributive</code> or <code>Representable</code>. Here is a sketch of them, with made up names:</p>\n\n<pre><code>class Traversable t =&gt; Lone t where\n    codistribute :: Functor f =&gt; t (f a) -&gt; f (t a)\n    surround :: Functor f =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\n\nclass Lone f =&gt; Detachable f where\n    type Corep f\n    cotabulate :: (Corep f, a) -&gt; f a\n    coindex :: f a -&gt; (Corep f, a)\n</code></pre>\n\n<p>A few remarks on the <code>Traversable</code> connection:</p>\n\n<ul>\n<li><p><code>codistribute</code> and <code>surround</code> are just <code>sequenceA</code> and <code>traverse</code>, respectively, except with the <code>Applicative</code> constraint relaxed to <code>Functor</code> (if there is always exactly one value, <code>Applicative</code> is unnecessary).</p></li>\n<li><p>By the same token, <code>cotabulate</code> and <code>coindex</code> (or <code>slot</code> and <code>separate</code>, or <code>unsplitL</code> and <code>splitL</code>) can be seen as a manifestation of <a href=\"https://stackoverflow.com/a/21083521/2751851\">the shape-and-contents decomposition of traversable functors</a> (in which we need no list/vector for the contents because, again, there is always exactly one value).</p></li>\n<li><p>Various instances for pairs could conceivably be translated through <code>Detachable</code>. For <code>Comonad</code>, not even that is needed, as <code>Lone</code> suffices (see also <a href=\"http://hackage.haskell.org/package/adjunctions-4.4/docs/Data-Functor-Adjunction.html#v:extractL\" rel=\"nofollow noreferrer\"><code>extractL</code> and <code>duplicateL</code></a> from <em>adjunctions</em>).</p></li>\n<li><p><code>surround</code> is a van Laarhoven lens (a <code>Lens (t a) (t b) a b</code>, in <em>lens</em> parlance), just like <code>traverse</code> is a van Laarhoven traversal (<code>Traversal (t a) (t b) a b</code>).</p></li>\n</ul>\n\n<p>Last, but not least, <code>codistribute</code> is a generalisation of your <code>reorder</code>.</p>\n"}], "owner": {"reputation": 436, "user_id": 1152427, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f58ad5b5fc9bee2e9a0837afb1cb5da8?s=128&d=identicon&r=PG", "display_name": "Pan Hania", "link": "https://stackoverflow.com/users/1152427/pan-hania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1581479826, "creation_date": 1462400399, "question_id": 37039042, "link": "https://stackoverflow.com/questions/37039042/what-is-the-name-of-this-functor-ish-tag-like-typeclass", "title": "What is the name of this functor-ish tag-like typeclass?", "body": "<p>I have noticed that I have a lot of functions that add some sort of tags to my values. As an example, consider these two datatypes:</p>\n\n<pre><code>data Named a = Named String a                                                   \ndata Colored a = White a | Black a\n</code></pre>\n\n<p>and some functions that use them:</p>\n\n<pre><code>name :: Foo -&gt; Named Foo\ncolor :: Named Foo -&gt; Colored (Named Foo)\n</code></pre>\n\n<p>At some point I started to have functions with many nested \"tags\" like that so I wondered if I can generalize this to make it somewhat more manageable. All that would probably nicely work with PureScript's row polymorphism but we are talking about Haskell here. Anyway, here is what I came up with:</p>\n\n<pre><code>class Tag f where                                                  \n    separate :: f a -&gt; (forall b. b -&gt; f b, a)\n</code></pre>\n\n<p>The law would be something like:</p>\n\n<pre><code>fx = let (f, x) = separate fx in f x\n</code></pre>\n\n<p>or a version that does not typecheck but is more elegant:</p>\n\n<pre><code>uncurry ($) . separate = id\n</code></pre>\n\n<p><code>Tag</code> could be also made a subclass of <code>Functor</code> provided that</p>\n\n<pre><code>fmap g fx = let (f, x) = separate fx in f (g x)\n</code></pre>\n\n<p>Instances for example datatypes are as follows:</p>\n\n<pre><code>instance Tag Named where\n    separate (Named name x) = (Named name, x)\n\ninstance Tag Colored where\n    separate (White x) = (White, x)\n    separate (Black x) = (Black, x)\n</code></pre>\n\n<p>... and some other general instances:</p>\n\n<pre><code>instance Tag Identity where\n    separate (Identity x) = (Identity, x)\n\ninstance (Tag f, Tag g) =&gt; Tag (Compose f g) where\n    separate (Compose fgx) =\n        let (f, gx) = separate fgx in\n        let (g, x) = separate gx in\n        (Compose . f . g, x)\n</code></pre>\n\n<p>What makes this whole typeclass actually useful is this function:</p>\n\n<pre><code>reorder :: (Tag f, Tag g) =&gt; f (g a) -&gt; g (f a)\nreorder fgx =\n    let (f, gx) = separate fgx in\n    let (g, x) = separate gx in\n    g (f x)\n</code></pre>\n\n<p>It looks like some obvious idiom so it has to be already known by the community. Google is not very helpful when you do not know a name of a thing you are searching for and Hoogle responded with no results.</p>\n\n<p>So here I am, looking for a name and maybe even some libraries to see what else I can do with that thing.</p>\n"}, {"tags": ["haskell", "types", "functor", "lifting"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1462422835, "post_id": 37038991, "comment_id": 61633805, "body": "One idea is to make <code>Matrix</code> something like a <a href=\"https://hackage.haskell.org/package/dlist-0.7.1.2/docs/Data-DList.html\" rel=\"nofollow noreferrer\">difference list</a>; instead of it being a nested list, it&#39;s a function that takes a nested list and a list and returns another list. That is, you could think of <code>M [[2,3],[5,7]]</code> as a partially applied function rather than just a wrapped nested list. <code>mv</code> would then be more of a smart constructor."}, {"owner": {"reputation": 1282, "user_id": 807631, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3120b244b19cab8e1c52845139b3fc23?s=128&d=identicon&r=PG&f=1", "display_name": "Misguided", "link": "https://stackoverflow.com/users/807631/misguided"}, "edited": false, "score": 0, "creation_date": 1462427950, "post_id": 37038991, "comment_id": 61635560, "body": "Notice that if you define <code>m = mv $ M [[2,3], [5,7]]</code> then you get that m [1, 0] gets your desired effect. This is just a play on currying: a partial evaluation of your mv function."}, {"owner": {"reputation": 669, "user_id": 5025261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/163727f297f2568604d1b626d3631716?s=128&d=identicon&r=PG&f=1", "display_name": "MASL", "link": "https://stackoverflow.com/users/5025261/masl"}, "edited": false, "score": 0, "creation_date": 1462503313, "post_id": 37038991, "comment_id": 61673322, "body": "Seeing this just now. Yes, I&#39;ve been playing with currying so far as you mention. The problem comes when I then try to calculate the gradient/jacobian of an expresion with respect to the matrix values. It ran into new compilation erros when I tried that. For instance, let say you have a simklple, multilayer feedforward neural network. introducing <code>mv</code>  runs into problems with automatic differentiation. Not sure if I should detail this case in my original question too. It might provide other useful answers too..."}, {"owner": {"reputation": 669, "user_id": 5025261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/163727f297f2568604d1b626d3631716?s=128&d=identicon&r=PG&f=1", "display_name": "MASL", "link": "https://stackoverflow.com/users/5025261/masl"}, "reply_to_user": {"reputation": 1282, "user_id": 807631, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3120b244b19cab8e1c52845139b3fc23?s=128&d=identicon&r=PG&f=1", "display_name": "Misguided", "link": "https://stackoverflow.com/users/807631/misguided"}, "edited": false, "score": 0, "creation_date": 1462562390, "post_id": 37038991, "comment_id": 61704565, "body": "@Juli&#225;n, thanks for your comments. I realize now I may not be asking the right question for the problem I have. I will thus likely delete this question and post another, more focused one."}, {"owner": {"reputation": 669, "user_id": 5025261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/163727f297f2568604d1b626d3631716?s=128&d=identicon&r=PG&f=1", "display_name": "MASL", "link": "https://stackoverflow.com/users/5025261/masl"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1462562440, "post_id": 37038991, "comment_id": 61704587, "body": "@chepner, thanks for your comments. I don&#39;t quite get how to use a Difference list, but I think I first need to rethink my own question. See my previous comment."}, {"owner": {"reputation": 1282, "user_id": 807631, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3120b244b19cab8e1c52845139b3fc23?s=128&d=identicon&r=PG&f=1", "display_name": "Misguided", "link": "https://stackoverflow.com/users/807631/misguided"}, "edited": false, "score": 0, "creation_date": 1462589783, "post_id": 37038991, "comment_id": 61712486, "body": "@MASL: please post the code, I don&#39;t mind looking at it, but I can&#39;t answer on nothing"}, {"owner": {"reputation": 669, "user_id": 5025261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/163727f297f2568604d1b626d3631716?s=128&d=identicon&r=PG&f=1", "display_name": "MASL", "link": "https://stackoverflow.com/users/5025261/masl"}, "reply_to_user": {"reputation": 1282, "user_id": 807631, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3120b244b19cab8e1c52845139b3fc23?s=128&d=identicon&r=PG&f=1", "display_name": "Misguided", "link": "https://stackoverflow.com/users/807631/misguided"}, "edited": false, "score": 0, "creation_date": 1462625936, "post_id": 37038991, "comment_id": 61721544, "body": "@Juli&#225;n Thanks. I posted a new, more specific question here <a href=\"https://stackoverflow.com/questions/37088840/automatic-differentiation-ad-with-respect-to-list-of-matrices-in-haskell\" title=\"automatic differentiation ad with respect to list of matrices in haskell\">stackoverflow.com/questions/37088840/&hellip;</a>"}], "owner": {"reputation": 669, "user_id": 5025261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/163727f297f2568604d1b626d3631716?s=128&d=identicon&r=PG&f=1", "display_name": "MASL", "link": "https://stackoverflow.com/users/5025261/masl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462547187, "creation_date": 1462400112, "last_edit_date": 1462547187, "question_id": 37038991, "link": "https://stackoverflow.com/questions/37038991/haskell-lifting-a-data-type-to-a-function", "title": "Haskell : &quot;lifting&quot; a data type to a function", "body": "<p>Somehow, I'm still trying to build an intuition on what can I express in Haskell and what not.</p>\n\n<p>I have my own (simple) matrix type and I'm wondering if it would be possible to somehow \"lift\" it to a function so as to make sense of the usual math notation for a matrix applied on a vector.</p>\n\n<p>Let me explain this question in more detail.</p>\n\n<pre><code>data Matrix a = M [[a]] deriving (Show,...)\n\ndot u v = foldr (+) 0 $ zipWith (*) u v\n\nmv :: Num a =&gt; Matrix a -&gt; [a] -&gt; [a]\nmv (M []) _ = []\nmv _ [] = []\nmv (M m) v = dot (head m) v : mv (M (tail m)) v\n</code></pre>\n\n<p>Clearly, the function <code>mv</code> implements the action of a matrix <code>M m</code> on a \"vector\" of type <code>[a]</code>.</p>\n\n<p>But, is there a way to implement the same action with a syntax like <code>(M' m) v</code> such that </p>\n\n<pre><code>(M' m) v = mv (M m ) v ?\n</code></pre>\n\n<p>It should then allow to write something like </p>\n\n<pre><code>m = M' [[2,3],[5,7]]\nv = m [1,0] -- v == [2,5]\n</code></pre>\n\n<p>I suspect the matrix data type I defined isn't enough to do such a lifting. Somehow I think I'm trying to find a functor from a self-defined matrix type to some <code>hom([a],[a])</code>, i.e., the set of morphisms  in category of vector spaces <code>Vec</code>, but my data type lacks the necessary structure. </p>\n\n<p>Is there a fundamental reason why it might not be possible to do such \"lifting\"? </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1462399203, "creation_date": 1462399203, "answer_id": 37038823, "question_id": 37038454, "link": "https://stackoverflow.com/questions/37038454/bool-class-like-num/37038823#37038823", "title": "Bool class - like Num?", "body": "<p>The standard semantics of <code>if</code>/<code>then</code>/<code>else</code> are specific to <code>Bool</code>. With GHC, it is possible to change the standard semantics using the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/syntax-extns.html#rebindable-syntax\"><code>RebindableSyntax</code></a> extension. Quoting from the docs:</p>\n\n<blockquote>\n  <p>...the <code>-XRebindableSyntax</code> flag causes the following pieces of built-in syntax to refer to whatever is in scope, not the <code>Prelude</code> versions:</p>\n  \n  <ul>\n  <li>Conditionals (e.g. <code>if e1 then e2 else e3</code>) means <code>ifThenElse e1 e2 e3</code>. However <code>case</code> expressions are unaffected.</li>\n  </ul>\n</blockquote>\n\n<p>This is my technical answer to the question as asked.</p>\n\n<p>However, my opinionated answer is that you should not do that. Instead, write a predicate of type <code>MyType -&gt; Bool</code>; then use <code>if predicate myValue then ... else ...</code>. This explicit way is in my opinion more clear and idiomatic; and as a side benefit is more flexible as well because you can have many different predicates of that type, rather than elevating any single one to special status.</p>\n"}, {"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 1, "last_activity_date": 1462399642, "creation_date": 1462399642, "answer_id": 37038907, "question_id": 37038454, "link": "https://stackoverflow.com/questions/37038454/bool-class-like-num/37038907#37038907", "title": "Bool class - like Num?", "body": "<p>You could probably do it with <code>-XRebindableSyntax</code> (although you should listen to Daniel Wagner and not do this):</p>\n\n<pre><code>{-# LANGUAGE RebindableSyntax #-}\nmodule Test where\n\nimport qualified Prelude as P\n\n\nclass Decidable b where\n    toBool :: b -&gt; P.Bool\n\ninstance Decidable P.Bool where\n    toBool = P.id\n\nifThenElse :: Decidable b =&gt; b -&gt; a -&gt; a -&gt; a\nifThenElse b ifTrue ifFalse = case toBool b of\n    P.True -&gt; ifTrue\n    P.False -&gt; ifFalse\n\ndata Test = A | B deriving (P.Eq, P.Show)\n\ninstance Decidable Test where\n    toBool A = P.True\n    toBool B = P.False\n</code></pre>\n\n<p>Then in GHCi:</p>\n\n<pre><code>&gt; :l decidable.hs\n&gt; :set -XRebindableSyntax\n&gt; P.putStrLn (if A then \"it worked!\" else \"it failed!\")\nit worked!\n</code></pre>\n\n<p>Again, don't do this!  Just go with a simple function, it'll save a lot of headache down the line and won't confuse anyone else reading your code who doesn't realize you've changed how the syntax of the language works.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 37038823, "answer_count": 2, "score": 4, "last_activity_date": 1462399642, "creation_date": 1462397688, "last_edit_date": 1462398362, "question_id": 37038454, "link": "https://stackoverflow.com/questions/37038454/bool-class-like-num", "title": "Bool class - like Num?", "body": "<p>I have my own type:  </p>\n\n<pre><code>data MyType = ...\n</code></pre>\n\n<p>Now, I would like to use value of this type in <code>if</code>. Is it possible to implement it ? Of course, at this moment I get error:  </p>\n\n<pre><code> Couldn't match expected type \u2018Bool\u2019 with actual type \u2018MyType\u2019\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "fixpoint-combinators"], "comments": [{"owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "edited": false, "score": 0, "creation_date": 1462396344, "post_id": 37037933, "comment_id": 61626277, "body": "Have you read <a href=\"http://stackoverflow.com/questions/8099349/fixed-point-combinator-in-haskell\">this question</a>"}, {"owner": {"reputation": 1205, "user_id": 3933052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8hg4k.jpg?s=128&g=1", "display_name": "godot", "link": "https://stackoverflow.com/users/3933052/godot"}, "reply_to_user": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "edited": false, "score": 0, "creation_date": 1462396682, "post_id": 37037933, "comment_id": 61626436, "body": "Thanks Guvante, I have seen it but from what I understood of it, it is not exactly what I asked... What I would like is an analytical answer or a point to a general method to solve that kind of problem..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462399392, "post_id": 37037933, "comment_id": 61627696, "body": "<code>fix f</code> is not <code>f</code>. It&#39;s <code>f (fix f)</code>."}, {"owner": {"reputation": 1205, "user_id": 3933052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8hg4k.jpg?s=128&g=1", "display_name": "godot", "link": "https://stackoverflow.com/users/3933052/godot"}, "edited": false, "score": 0, "creation_date": 1462401002, "post_id": 37037933, "comment_id": 61628265, "body": "you are right sorry, a typo when I sent the question. I corrected..."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 6, "last_activity_date": 1462399711, "creation_date": 1462399711, "answer_id": 37038918, "question_id": 37037933, "link": "https://stackoverflow.com/questions/37037933/guessing-the-type-of-fixed-point-combinator/37038918#37038918", "title": "Guessing the type of fixed-point combinator", "body": "<p>Start from the definition</p>\n\n<pre><code>fix f = f (fix f)\n</code></pre>\n\n<p>Since it takes an argument, <code>fix</code> must have a type that looks like</p>\n\n<pre><code>fix :: x -&gt; y\n</code></pre>\n\n<p>It applies its argument to something, so in fact</p>\n\n<pre><code>fix :: (p -&gt; q) -&gt; r\n</code></pre>\n\n<p>It actually applies its argument to <code>fix f</code>, so</p>\n\n<pre><code>fix :: (r -&gt; q) -&gt; r\n</code></pre>\n\n<p>The final result is actually the result of this application, so</p>\n\n<pre><code>fix :: (r -&gt; r) -&gt; r\n</code></pre>\n"}], "owner": {"reputation": 1205, "user_id": 3933052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8hg4k.jpg?s=128&g=1", "display_name": "godot", "link": "https://stackoverflow.com/users/3933052/godot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 37038918, "answer_count": 1, "score": 1, "last_activity_date": 1562457516, "creation_date": 1462395661, "last_edit_date": 1562457516, "question_id": 37037933, "link": "https://stackoverflow.com/questions/37037933/guessing-the-type-of-fixed-point-combinator", "title": "Guessing the type of fixed-point combinator", "body": "<p>My question is related to \"fixed point combinator\". According to <a href=\"https://en.wikipedia.org/wiki/Fixed-point_combinator#Lazy_functional_implementation\" rel=\"nofollow noreferrer\">this Wikipedia page section</a> a function <code>fix</code> such that</p>\n\n<pre><code>fix f = f (fix f)\n</code></pre>\n\n<p>is of type (or at least can be of type)</p>\n\n<pre><code>(a -&gt; a) -&gt; a\n</code></pre>\n\n<p>Can someone explain me why?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1462394302, "post_id": 37037446, "comment_id": 61625265, "body": "based on the example <code>lines</code> and <code>words</code> should help you (you&#39;ll probably want <code>read</code>  to get numbers as well)"}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1462394383, "creation_date": 1462394383, "answer_id": 37037591, "question_id": 37037446, "link": "https://stackoverflow.com/questions/37037446/can-someone-show-me-how-to-populate-a-list-of-lists-in-haskell-from-a-textfile-o/37037591#37037591", "title": "Can someone show me how to populate a list of lists in haskell from a textfile or a csv file?", "body": "<pre><code>Prelude&gt; mdata &lt;- readFile(\"matrix.data\")\nPrelude&gt; (map (map read . words) . lines) mdata :: [[Int]]\n[[1,2,3],[4,5,6],[7,8,9]]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6292703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7633ec7ce1bd35c6abd92a20b9e6f003?s=128&d=identicon&r=PG&f=1", "display_name": "s.philip", "link": "https://stackoverflow.com/users/6292703/s-philip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462394383, "creation_date": 1462393801, "last_edit_date": 1462394102, "question_id": 37037446, "link": "https://stackoverflow.com/questions/37037446/can-someone-show-me-how-to-populate-a-list-of-lists-in-haskell-from-a-textfile-o", "title": "Can someone show me how to populate a list of lists in haskell from a textfile or a csv file?", "body": "<p>I am new to haskell and am performing matrix multiplication.\nI want to populate a list of list from a text file and a csv file in haskell.\nSo for example my text file or csv contains     </p>\n\n<blockquote>\n  <p>1 2 3 </p>\n  \n  <p>4 5 6</p>\n  \n  <p>7 8 9</p>\n</blockquote>\n\n<p>please ignore the blank lines between rows in text file.</p>\n\n<p>I want my lists of list to be <code>matrix=[[1,2,3],[4,5,6],[7,8,9]]</code></p>\n\n<p>help would be much appreciated!!!</p>\n"}, {"tags": ["haskell", "whitespace", "guard", "pattern-guards"], "comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1462392972, "post_id": 37037126, "comment_id": 61624563, "body": "Any reason why put type signature and function definition into the do block?"}, {"owner": {"reputation": 161, "user_id": 3220921, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7Ke9w.gif?s=128&g=1", "display_name": "ThePhillipParadox", "link": "https://stackoverflow.com/users/3220921/thephillipparadox"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1462472553, "post_id": 37037126, "comment_id": 61662260, "body": "I didn&#39;t know what I was doing."}], "answers": [{"comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 1, "creation_date": 1462393164, "post_id": 37037209, "comment_id": 61624664, "body": "the <code>do</code>s aren&#39;t a problem I would say, you can nest them. But if you want to bind a variable within a do block you need to use <code>let</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1462393396, "post_id": 37037209, "comment_id": 61624801, "body": "Sure, but they&#39;re still bad and weird."}, {"owner": {"reputation": 161, "user_id": 3220921, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7Ke9w.gif?s=128&g=1", "display_name": "ThePhillipParadox", "link": "https://stackoverflow.com/users/3220921/thephillipparadox"}, "edited": false, "score": 0, "creation_date": 1462471151, "post_id": 37037209, "comment_id": 61661428, "body": "I moved <code>fib :: (Integral a) =&gt; Int -&gt; Int</code> to outside &quot;main,&quot; but I&#39;m getting the same error."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 3, "last_activity_date": 1462392898, "creation_date": 1462392898, "answer_id": 37037209, "question_id": 37037126, "link": "https://stackoverflow.com/questions/37037126/haskell-says-my-guard-has-a-parse-error/37037209#37037209", "title": "Haskell Says My Guard Has A Parse Error", "body": "<p>You should define <code>fib</code> outside of <code>main</code>, not inside it. And then you should remove at least one of the <code>do</code>s from <code>main</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": false, "score": 3, "last_activity_date": 1462534348, "creation_date": 1462534348, "answer_id": 37071326, "question_id": 37037126, "link": "https://stackoverflow.com/questions/37037126/haskell-says-my-guard-has-a-parse-error/37071326#37071326", "title": "Haskell Says My Guard Has A Parse Error", "body": "<p>The problem is that you are trying to define the function within <code>do</code> block without actually using any construct for defining things (like <code>let</code>).</p>\n\n<p>Try defining the function outside the block:</p>\n\n<pre><code>fib :: (Integral a) =&gt; Int -&gt; Int\nfib x | x == 0 = 0\n      | x == 1 = 1\n      | x &gt;= 2 = fib (x - 2) + fib (x - 1)\n\nmain = print (fib 5)\n</code></pre>\n\n<p>If you insist on defining the function locally (inside the expression that is formed by statements of the <code>do</code> block):</p>\n\n<pre><code>main = do\n    let\n        fib :: (Integral a) =&gt; Int -&gt; Int\n        fib x | x == 0 = 0\n              | x == 1 = 1\n              | x &gt;= 2 = fib (x - 2) + fib (x - 1)\n    print (fib 5)\n</code></pre>\n\n<p>Notice how <code>let</code> is used to bind a new variable <code>fib</code> to the function you want.</p>\n"}, {"tags": [], "owner": {"reputation": 9272, "user_id": 241544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d27ca4e9a9a41ec8732046e6a272f091?s=128&d=identicon&r=PG", "display_name": "Matthew Walton", "link": "https://stackoverflow.com/users/241544/matthew-walton"}, "is_accepted": true, "score": 1, "last_activity_date": 1462537053, "creation_date": 1462537053, "answer_id": 37072242, "question_id": 37037126, "link": "https://stackoverflow.com/questions/37037126/haskell-says-my-guard-has-a-parse-error/37072242#37072242", "title": "Haskell Says My Guard Has A Parse Error", "body": "<p>You can also define <code>fib</code> locally to <code>main</code> outside of the <code>do</code> block. Do bear in mind that <code>do</code> is syntactic sugar for the use of various monadic binding functions, and so the syntax accepted within it is not quite the same as that accepted outside it. And, in fact, your <code>main</code> doesn't even require the <code>do</code> block because you just call <code>print</code> rather than chaining any <code>IO</code> actions together.</p>\n\n<pre><code>main = let\n         fib x | x == 0 = 0\n               | x == 1 = 1\n               | x &gt;= 2 = fib (x - 2) + fib (x + 1)\n       in\n         print (fib 5)\n</code></pre>\n\n<p>Or you could use <code>where</code>:</p>\n\n<pre><code>main = print (fib 5)\n       where\n         fib x | x == 0 = 0\n               | x == 1 = 1\n               | x &gt;= 2 = fib (x - 2) + fib (x + 1)\n</code></pre>\n\n<p>They're the same, the question is just where the local binding actually goes. <code>let</code>..<code>in</code> gives you a new block where the new bindings are in scope, while <code>where</code> makes its bindings available in the scope of the function it's attached to.</p>\n\n<p>If, as seems eventually likely, you do want a <code>do</code> block as well so you can do multiple <code>IO</code> actions, you can just put that in place of the call to <code>print</code>, like so:</p>\n\n<pre><code>main = let\n         fib x | x == 0 = 0\n               | x == 1 = 1\n               | x &gt;= 2 = fib (x - 2) + fib (x + 1)\n       in\n         do print (fib 5)\n            print (fib 6)\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 3220921, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7Ke9w.gif?s=128&g=1", "display_name": "ThePhillipParadox", "link": "https://stackoverflow.com/users/3220921/thephillipparadox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 37072242, "answer_count": 3, "score": 0, "last_activity_date": 1462537053, "creation_date": 1462392664, "last_edit_date": 1462472799, "question_id": 37037126, "link": "https://stackoverflow.com/questions/37037126/haskell-says-my-guard-has-a-parse-error", "title": "Haskell Says My Guard Has A Parse Error", "body": "<p>So I've been playing with Haskell the past couple of days, and I decided I'd make a basic definition of the Fibonacci sequence. So I wrote this code:</p>\n\n<pre><code>main = do\n    fib :: (Integral a) =&gt; Int -&gt; Int\n    fib x\n        | x == 0 = 0\n        | x == 1 = 1\n        | x &gt;= 2 = fib (x - 2) + fib (x - 1)\n    do { print (fib 5) }\n</code></pre>\n\n<p>And I get an error message saying:</p>\n\n<pre><code>4:17: parse error on input `|'\n</code></pre>\n\n<p>I suspected tab errors, so I tried every whitespace fix I could find, but I just can't find what's wrong!</p>\n\n<p>EDIT: So I did what people suggested, and I have this code now:</p>\n\n<pre><code>fib :: (Integral a) =&gt; Int -&gt; Int\nmain = do\n    fib x\n        | x == 0 = 0\n        | x == 1 = 1\n        | x &gt;= 2 = fib (x - 2) + fib (x - 1)\n    print (fib 5)\n</code></pre>\n\n<p>And I'm getting the same error.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 2, "creation_date": 1462395144, "post_id": 37036938, "comment_id": 61625673, "body": "So, if I understand it right, the code actually works correcctly? And what you want is suggestions to improve it? Then it is more appropriate for our sister site <a href=\"https://codereview.stackexchange.com\">Code Review</a>. But, don&#39;t cross-post - if it should be on Code Review, flag your own post for moderator attention and ask for migration."}], "answers": [{"tags": [], "owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "is_accepted": true, "score": 1, "last_activity_date": 1462395977, "creation_date": 1462395977, "answer_id": 37038003, "question_id": 37036938, "link": "https://stackoverflow.com/questions/37036938/haskell-print-numbers-from-a-list-with-text/37038003#37038003", "title": "haskell - print numbers from a list with text", "body": "<blockquote>\n  <p>The part where I wrote <code>colors &lt;- forM [1,3..n]</code>, the colors dont mean anything, it is just for the program to function.</p>\n</blockquote>\n\n<p>But that does mean something, it means roughly \"foreach value from 1 to n counting by 2 (3-1) do this monadic action\".</p>\n\n<p>The obvious change would be to calculate 1 and 3 or 2 and 4 and use them in a single monadic event but fundamentally you aren't doing incorrect work there.</p>\n"}], "owner": {"reputation": 33, "user_id": 6292552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1989be8c26c3e84a70b5a97e916625c6?s=128&d=identicon&r=PG&f=1", "display_name": "claudia", "link": "https://stackoverflow.com/users/6292552/claudia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 37038003, "answer_count": 1, "score": 1, "last_activity_date": 1462395977, "creation_date": 1462391917, "last_edit_date": 1462395325, "question_id": 37036938, "link": "https://stackoverflow.com/questions/37036938/haskell-print-numbers-from-a-list-with-text", "title": "haskell - print numbers from a list with text", "body": "<p>I was trying to write a function that receives a number, and prints this text, for example, <code>elephants 5</code> prints the following:</p>\n\n<pre><code>If 2 elephants bother a lot of people, 3 elephants bother a lot more!\nIf 3 elephants bother a lot of people, 4 elephants bother a lot more!\nIf 4 elephants bother a lot of people, 5 elephants bother a lot more!\n</code></pre>\n\n<p>It starts by 1 or 2, and ends at the number that I gave.\nI have done this:</p>\n\n<pre><code>module Main where\nimport Control.Monad  \n\nelephants n = \n    if ( n`mod`2 ==0 ) then do   \n    colors &lt;- forM [1,3..n] (\\a -&gt; do  \n        putStrLn $ \"If \" ++ show a++ \" elephants bother a lot of people,\\n\"++ show (a+1)++ \" elephants bother a lot more!\" \n\n        )  \n    putStr \"\" \n    else do\n    colors &lt;- forM [2,4..(n-1)] (\\a -&gt; do  \n        putStrLn $ \"If \" ++ show a++ \" elephants bother a lot of people,\\n\"++ show (a+1)++ \" elephants bother a lot more!\" \n\n        )  \n    putStr\"\" \n</code></pre>\n\n<p>It prints the following:</p>\n\n<pre><code>&gt; elephants 5\nIf 2 elephants bother a lot of people,\n3 elephants bother a lot more!\nIf 4 elephants bother a lot of people,\n5 elephants bother a lot more!\n</code></pre>\n\n<p>The part where I wrote <code>colors &lt;- forM [1,3..n]</code>, the colors dont mean anything, it is just for the program to function. I know that this probably isn't the right way to do this; how could it be improved?</p>\n"}, {"tags": ["haskell", "fixpoint-combinators"], "comments": [{"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1487399983, "post_id": 37036618, "comment_id": 71778354, "body": "c.f. <a href=\"http://stackoverflow.com/q/4787421/356440\">stackoverflow.com/q/4787421/356440</a>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1563168949, "post_id": 37036618, "comment_id": 100595994, "body": "Formally, <code>fix</code> returns the least defined fixed point of a function. <code>50</code> is a fixed point, but so is <code>undefined</code>: <code>modifyValue undefined</code> yields <code>undefined</code>. And since <code>undefined</code> is less defined than <code>50</code>, that&#39;s what is returned. <code>fix</code> is only useful on functions that don&#39;t have <code>undefined</code> as a fixed point."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1462391609, "last_edit_date": 1462391609, "creation_date": 1462391227, "answer_id": 37036715, "question_id": 37036618, "link": "https://stackoverflow.com/questions/37036618/fix-point-function-does-not-find-my-fix-point/37036715#37036715", "title": "Fix point function does not find my fix point", "body": "<p>well <code>fix</code> is defined something like this:</p>\n\n<pre><code>fix f = let x = f x in x\n</code></pre>\n\n<p>so so it's good to generate recursion for lazy data-structures </p>\n\n<pre><code>fix (1:) == 1:1:1:1:....\n</code></pre>\n\n<p>which works fine as list are lazy (so <code>take 10 $ fix (1:)</code> is perfectly fine)</p>\n\n<p>It's not so good for pulling out a strict value from a recursive function like yours.</p>\n\n<p>Because as soon as you want to print/evaluate it you need to come up with a value and this will end in an infinite-loop.</p>\n\n<p>You would probably need something like</p>\n\n<pre><code>fixEq f x = let x' = f x in if x' == x then x else fixEq f x'\n</code></pre>\n"}], "owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 37036715, "answer_count": 1, "score": 0, "last_activity_date": 1563167634, "creation_date": 1462390864, "last_edit_date": 1563167634, "question_id": 37036618, "link": "https://stackoverflow.com/questions/37036618/fix-point-function-does-not-find-my-fix-point", "title": "Fix point function does not find my fix point", "body": "<p>So as to understand the <code>fix</code> function, from <code>Control.Monad.State</code>, <code>fix :: (a -&gt; a) -&gt; a</code>, I have this little code in <code>modifyValue</code>, that increments an integer until 49, then the function always returns 50.</p>\n\n<pre><code>import Control.Monad.State\ntype StateVal = Int\n\nmodifyValue :: StateVal -&gt; StateVal\nmodifyValue v | v &lt; 50 = v + 1\nmodifyValue v = 50\n\nsimpleStateStep :: State StateVal ()\nsimpleStateStep = do\n        s &lt;- get\n        put $ modifyValue s\n\nmain = do\n    putStrLn $ show $ fix modifyValue\n</code></pre>\n\n<p>However when I launch this code, instead of finding the fix point at 50, where the sequence converge to 50... it claims <code>*** Exception: &lt;&lt;loop&gt;&gt;\n</code></p>\n\n<p>It is clear that I mistake something since I do not provide an initial state to start the sequence, for example with 1, that would generate <code>[2,3,4,..,49,50,50,50,50....]</code></p>\n\n<p>Am I using the fix function inappropriately ?\nIs there something to do so as it can find the fix point 50 ?</p>\n"}, {"tags": ["haskell", "happy"], "answers": [{"comments": [{"owner": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "edited": false, "score": 0, "creation_date": 1462395632, "post_id": 37037737, "comment_id": 61625936, "body": "I think I&#39;ve understood what you&#39;re saying. Maybe I can overcome this issue in a different way, I mean, I&#39;ve used <code>Maybe Procedure</code> because I wanted to test if the procedure had something inside the body or not. Going further with the implementation though, inside a procedure body can be declared variables other than simply other procedures so I&#39;m thinking of replacing <code>{ Nothing }</code> with <code>{ [] }</code> and <code>{ Just $1 }</code> with <code>{ $1 }</code>, so that inside <code>DeclarationSequence</code> I can return a list that could contain procedures or variables. The problem could be: how can I store two types in the same list?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "edited": false, "score": 0, "creation_date": 1462396191, "post_id": 37037737, "comment_id": 61626213, "body": "You can&#39;t store two different types in the same list. Whereas this is not exactly true, when you start thinking like that it usually means you are heading down the wrong track. Btw - if you&#39;ve found any of what I&#39;ve written helpful, upvoting is appropriate and appreciated."}, {"owner": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "edited": false, "score": 0, "creation_date": 1462400833, "post_id": 37037737, "comment_id": 61628213, "body": "I&#39;ve changed my data structure to not use <code>Maybe Procedure</code> anymore and that I won&#39;t need a list of two types anymore. I&#39;ve updated my questione since I stille get some errors due to type mismatch. I&#39;ve kept track of the production types, but it didn&#39;t help too much."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "edited": false, "score": 0, "creation_date": 1462405091, "post_id": 37037737, "comment_id": 61629540, "body": "With your updated parser I&#39;m getting the error <code>unknown identifier &#39;KW_VAR&#39;</code> plus some others when running happy."}, {"owner": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "edited": false, "score": 0, "creation_date": 1462422679, "post_id": 37037737, "comment_id": 61633764, "body": "Yes sorry, I&#39;ve now updated the parser and added the updated lexer too"}, {"owner": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "edited": false, "score": 0, "creation_date": 1462480345, "post_id": 37037737, "comment_id": 61666538, "body": "I was finally able to solve the problem and I continued with the implementation of this &#39;compiler&#39;. I&#39;m now struggling to send custom errors while parsing and I&#39;ve posted a question <a href=\"http://stackoverflow.com/q/37059704/3365063\">here</a>  Thank you very much for all the help you gave me!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1462394933, "creation_date": 1462394933, "answer_id": 37037737, "question_id": 37036069, "link": "https://stackoverflow.com/questions/37036069/haskell-happy-parser-error-mismatching-types-and-infinite-type/37037737#37037737", "title": "Haskell Happy parser error mismatching types and infinite type", "body": "<p>Keeping track of the types of each production with comments will help you track down type errors.</p>\n\n<p>Here the types each production should have:</p>\n\n<pre><code>Production                            Type\n--------------                        ---------\nProcedureHeading                      Procedure\nProcedureDeclaration                  Procedure\nProcedureDeclarationList              [ Procedure ]\nDeclarationSequence                   [ Procedure ]\nProcedureBody                         Maybe Procedure\n</code></pre>\n\n<p>Now check each of your production rules to see if they have the correct type.</p>\n\n<ol>\n<li><p><code>ProcedureHeading</code> returns <code>defaultProcedure</code> with a changed name, so that's ok.</p></li>\n<li><p><code>ProcedureDeclaration</code> returns the result of a call to <code>addProcedureToProcedure</code>, so that checks out. Note that the second argument to the <code>addProcedureToProcedure</code> call is <code>$3</code> which refers to the result of a <code>ProcedureBody</code> production, so that means the return type of that production must be a <code>Maybe Procedure</code>.</p></li>\n<li><p><code>ProcedureDeclarationList</code> has problems. The production rules should read:</p>\n\n<pre><code>ProcedureDeclarationList\n  : ProcedureDeclaration                              { [ $1 ] }\n  | ProcedureDeclaration ';' ProcedureDeclarationList { $1 : $3 }\n</code></pre></li>\n</ol>\n\n<p><code>[$1]</code> makes a list out of a single Procedure, and <code>$1:$3</code> prepends a single Procedure to a list of Procedures.</p>\n\n<ol start=\"4\">\n<li><p><code>DeclarationSequence</code> is simply a <code>ProcedureDeclarationList</code>, so that checks out.</p></li>\n<li><p>As noted in step 2, <code>ProcedureBody</code> has to be a <code>Maybe Procedure</code>. The rule for <code>KW_END</code> is fine, but the second rule needs some work:</p>\n\n<pre><code>ProcedureBody\n    | KW_END                     { Nothing }\n    | DeclarationSequence KW_END { ??? }\n</code></pre></li>\n</ol>\n\n<p>From a <code>DeclarationSequence</code> (which is a <code>[Procedure]</code>) we have to produce a <code>Maybe Procedure</code>. This is where your problem is. <code>Just $1</code> has type <code>Maybe [Procedure]</code>, so that isn't going to work here.</p>\n"}], "owner": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 37037737, "answer_count": 1, "score": 0, "last_activity_date": 1462422647, "creation_date": 1462388997, "last_edit_date": 1462422647, "question_id": 37036069, "link": "https://stackoverflow.com/questions/37036069/haskell-happy-parser-error-mismatching-types-and-infinite-type", "title": "Haskell Happy parser error mismatching types and infinite type", "body": "<p>Writing a Oberon-like language parser, I'm having troubles compiling the parser after I've updated it to be able to define more procedures on the same level, and not only nested one inside the other.</p>\n\n<p>This is my lexer:</p>\n\n<pre><code>{\nmodule Lexer where\n}\n\n%wrapper \"basic\"\n\n$alpha      = [a-zA-Z]\n$digit      = [0-9]\n$validChar  = [^\\\"]\n\ntokens :-\n\n  $white+                             ;\n  \"PROCEDURE\"                 { \\s -&gt; KW_TokenProcedure }\n  \"END\"                       { \\s -&gt; KW_TokenEnd }\n  \";\"                         { \\s -&gt; KW_TokenSemiColon }\n  $alpha [$alpha $digit \\_]*  { \\s -&gt; TokenVariableIdentifier s }\n\n{\n\n-- The token type:\ndata Token =\n  KW_TokenProcedure               |\n  KW_TokenEnd                     |\n  KW_TokenSemiColon               |\n  TokenVariableIdentifier String  |\n    deriving (Eq,Show)\n}\n</code></pre>\n\n<p>This is my parser:</p>\n\n<pre><code>{\nmodule Main where\nimport Lexer\nimport Tools\n}\n\n%name myParse\n%tokentype { Token }\n%error { parseError }\n\n%token\n  KW_PROCEDURE          { KW_TokenProcedure }\n  KW_END                { KW_TokenEnd }\n  ';'                   { KW_TokenSemiColon }\n  identifier            { TokenVariableIdentifier $$ }\n\n%%\n\nProcedureDeclarationList  :   ProcedureDeclaration                              { $1 }\n                          |   ProcedureDeclaration ';' ProcedureDeclarationList { $3 : $1 }\n\nProcedureDeclaration  : ProcedureHeading ';' ProcedureBody identifier   {\n                                                                          do\n                                                                            let newProc = $1  -- Crea la nuova procedura\n                                                                            let procBody = $3\n                                                                            addProcedureToProcedure newProc procBody\n                                                                        }\n\nProcedureHeading        :   KW_PROCEDURE identifier { defaultProcedure { procedureName = $2 } }\n\nProcedureBody           : KW_END                                    { Nothing }\n                        | DeclarationSequence KW_END                { Just $1 }\n\nDeclarationSequence     :    ProcedureDeclarationList                 { $1 }\n\n{\nparseError :: [Token] -&gt; a\nparseError _ = error \"Parse error\"\n\nmain = do\n  inStr &lt;- getContents\n  let result = oLikeParse (alexScanTokens inStr)\n  putStrLn (\"result: \" ++ show(result))\n}\n</code></pre>\n\n<p>And this is the module where the types and some utility functions are defined:</p>\n\n<pre><code>module Tools where\n\ndata Procedure = Procedure {    procedureName :: String,\n                                procedureProcedures :: [Procedure] } deriving (Show)\n\ndefaultProcedure = Procedure {  procedureName = \"\",\n                                procedureProcedures = [] }\n\naddProcedureToProcedure :: Procedure -&gt; Maybe Procedure -&gt; Procedure\naddProcedureToProcedure procDest Nothing            = Procedure {   procedureName = (procedureName procDest),\n                                                                    procedureProcedures = (procedureProcedures procDest) }\naddProcedureToProcedure procDest (Just procToAdd)   = Procedure {   procedureName = (procedureName procDest),\n                                                                    procedureProcedures = (procedureProcedures procDest) ++ [procToAdd] }\n</code></pre>\n\n<p>The errors the compiler is giving me are these two:</p>\n\n<ul>\n<li><code>Couldn't match type \u2018[Procedure]\u2019 with \u2018Procedure\u2019</code></li>\n<li><code>Occurs check: cannot construct the infinite type: t4 ~ [t4]</code></li>\n</ul>\n\n<p>I've isolated the problem and I know for sure that if I remove the second case of my <code>ProcedureDeclarationList</code> everything compiles fine, but I can't recognize more procedures on the same level.</p>\n\n<hr>\n\n<p>UPDATE</p>\n\n<p>I've changed the my data structure so that I'm not using <code>Maybe Procedure</code> anymore and I won't need a list of two types, but I still have a problem with mismatching types.</p>\n\n<p>This is my updated parser:</p>\n\n<pre><code>{\nmodule Main where\nimport Lexer\nimport Tools\n}\n\n%name myParse\n%tokentype { Token }\n%error { parseError }\n\n%token\n  KW_INTEGER            { KW_TokenInteger }\n  KW_REAL               { KW_TokenReal }\n  KW_BOOLEAN            { KW_TokenBoolean }\n  KW_CHAR               { KW_TokenChar }\n  KW_PROCEDURE          { KW_TokenProcedure }\n  KW_END                { KW_TokenEnd }\n  KW_VAR                { KW_TokenVar }\n  ';'                   { KW_TokenSemiColon }\n  ','                   { KW_TokenComa }\n  ':'                   { KW_TokenColon }\n  identifier            { TokenVariableIdentifier $$ }\n\n%%\n\nProcedureDeclarationList  :   ProcedureDeclaration                              { [$1] }\n                          |   ProcedureDeclaration ';' ProcedureDeclarationList { $1:$3 }\n\nProcedureDeclaration  : ProcedureHeading ';' ProcedureBody identifier { defaultDeclaration { declarationType = DT_Procedure, procedureDeclared = (addBodyToProcedure $1 $3)} }\n\nIdentifiersList     :   identifier                      { [$1] }\n                    |   identifier ',' IdentifiersList  { $1:$3 }\n\nVariableDeclaration : IdentifiersList ':' type          { createVariablesDefinitionsOfType $1 $3 }\n\nProcedureHeading    : KW_PROCEDURE identifier { defaultProcedure { procedureName = $2 } }\n\nProcedureBody     : KW_END                                      { [] }\n                  | DeclarationSequence KW_END                  { $1 }\n\nDeclarationSequence   : KW_VAR VariableDeclarationList ';'      { $2 }\n                      | ProcedureDeclarationList                { $1 }\n\nVariableDeclarationList : VariableDeclaration                             { [$1] }\n                        | VariableDeclaration ';' VariableDeclarationList { $1:$3 }\n\ntype        :   KW_INTEGER    { Integer }\n            |   KW_REAL       { Float }\n            |   KW_BOOLEAN    { Boolean }\n            |   KW_CHAR       { Char }\n\n{\nparseError :: [Token] -&gt; a\nparseError _ = error \"Parse error\"\n\nmain = do\n  inStr &lt;- getContents\n  let result = oLikeParse (alexScanTokens inStr)\n  putStrLn (\"result: \" ++ show(result))\n}\n</code></pre>\n\n<p>This is my updated lexer:</p>\n\n<pre><code>{\nmodule Lexer where\n}\n\n%wrapper \"basic\"\n\n$alpha      = [a-zA-Z]\n$digit      = [0-9]\n$validChar  = [^\\\"]\n\ntokens :-\n\n  $white+                             ;\n  \"INTEGER\"                   { \\s -&gt; KW_TokenInteger }\n  \"REAL\"                      { \\s -&gt; KW_TokenReal }\n  \"BOOLEAN\"                   { \\s -&gt; KW_TokenBoolean }\n  \"CHAR\"                      { \\s -&gt; KW_TokenChar }\n  \"PROCEDURE\"                 { \\s -&gt; KW_TokenProcedure }\n  \"END\"                       { \\s -&gt; KW_TokenEnd }\n  \"VAR\"                       { \\s -&gt; KW_TokenVar }\n  \";\"                         { \\s -&gt; KW_TokenSemiColon }\n  \",\"                         { \\s -&gt; KW_TokenComa }\n  \":\"                         { \\s -&gt; KW_TokenColon }\n  $alpha [$alpha $digit \\_]*  { \\s -&gt; TokenVariableIdentifier s }\n\n{\n\n-- The token type:\ndata Token =\n  KW_TokenInteger                 |\n  KW_TokenReal                    |\n  KW_TokenBoolean                 |\n  KW_TokenChar                    |\n  KW_TokenVar                     |\n  KW_TokenProcedure               |\n  KW_TokenEnd                     |\n  KW_TokenSemiColon               |\n  KW_TokenComa                    |\n  KW_TokenColon                   |\n  TokenVariableIdentifier String  |\n    deriving (Eq,Show)\n}\n</code></pre>\n\n<p>And this is my updated tools module:</p>\n\n<pre><code>module Tools where\n\ndata AttributeType  = String\n                    | Float\n                    | Char\n                    | Integer\n                    | Boolean\n                    deriving (Show, Eq)\n\ndata Attribute = Attribute {    attributeName :: String,\n                                attributeType :: AttributeType,\n                                stringValue :: String,\n                                floatValue :: Float,\n                                integerValue :: Integer,\n                                charValue :: Char,\n                                booleanValue :: Bool } deriving (Show)\n\ndata Procedure = Procedure {    procedureName :: String,\n                                attributes :: [Attribute],\n                                procedureProcedures :: [Procedure] } deriving (Show)\n\ndata DeclarationType    = DT_Variable\n                        | DT_Constant\n                        | DT_Procedure\n                        deriving (Show, Eq)\n\ndata Declaration = Declaration {    declarationType     :: DeclarationType,\n                                    attributeDeclared   :: Attribute,\n                                    procedureDeclared   :: Procedure } deriving (Show)\n\ndefaultAttribute = Attribute {  attributeName = \"\",\n                                attributeType = Integer,\n                                stringValue = \"\",\n                                floatValue = 0.0,\n                                integerValue = 0,\n                                charValue = ' ',\n                                booleanValue = False }\n\ndefaultProcedure = Procedure {  procedureName = \"\",\n                                attributes = [],\n                                procedureProcedures = [] }\n\ndefaultDeclaration = Declaration {  declarationType = DT_Variable,\n                                    attributeDeclared = defaultAttribute,\n                                    procedureDeclared = defaultProcedure }\n\naddAttributeToProcedure :: Procedure -&gt; Attribute -&gt; Procedure\naddAttributeToProcedure proc att = Procedure {  procedureName = (procedureName proc),\n                                                attributes = (attributes proc) ++ [att],\n                                                procedureProcedures = (procedureProcedures proc) }\n\naddProcedureToProcedure :: Procedure -&gt; Procedure -&gt; Procedure\naddProcedureToProcedure procDest procToAdd  = Procedure {   procedureName = (procedureName procDest),\n                                                            attributes = (attributes procDest),\n                                                            procedureProcedures = (procedureProcedures procDest) ++ [procToAdd] }\n\naddBodyToProcedure :: Procedure -&gt; [Declaration] -&gt; Procedure\naddBodyToProcedure procDest []          =   procDest\naddBodyToProcedure procDest declList    = do \n                                            let decl = head declList\n                                            let declType = declarationType decl\n\n                                            if declType == DT_Variable || declType == DT_Constant then \n                                                addBodyToProcedure (addAttributeToProcedure procDest (attributeDeclared decl)) (tail declList)\n                                            else\n                                                addBodyToProcedure (addProcedureToProcedure procDest (procedureDeclared decl)) (tail declList)\n\ncreateVariablesDefinitionsOfType :: [String] -&gt; AttributeType -&gt; [Declaration]\ncreateVariablesDefinitionsOfType namesList t = map (\\x -&gt; defaultDeclaration { declarationType = DT_Variable, attributeDeclared = (defaultAttribute {attributeName = x, attributeType = t})} ) namesList\n</code></pre>\n\n<p>This is the schema of the production types:</p>\n\n<pre><code>PRODUCTION                  TYPE\n---------------             ---------------\nProcedureDeclarationList    [Declaration]\nProcedureDeclaration        Declaration\nIdentifiersList             [String]\nVariableDeclaration         [Declaration]\nProcedureHeading            Procedure\nProcedureBody               [Declaration]\nDeclarationSequence         [Declaration]\nVariableDeclarationList     [Declaration]\ntype                        AttributeType\n</code></pre>\n\n<p>This are the only 3 errors I get now:</p>\n\n<ul>\n<li><code>Couldn't match type \u2018[Declaration]\u2019 with \u2018Declaration\u2019</code> x2</li>\n<li><code>Couldn't match type \u2018Declaration\u2019 with \u2018[Declaration]\u2019</code></li>\n</ul>\n"}, {"tags": ["parsing", "haskell", "expression-trees", "parsec", "parser-combinators"], "answers": [{"comments": [{"owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "edited": false, "score": 0, "creation_date": 1462894758, "post_id": 37036494, "comment_id": 61824553, "body": "Sorry, only got to trying this out now. I can&#39;t get it to work unfortunately, still says <code>parse programInSlashes &quot;&quot; &quot;&#47; 1+2*3&#47;4 &#47;&quot; Left (line 1, column 10): unexpected &#39;4&#39; expecting end of &quot;&#47;&quot;</code>"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1462390463, "creation_date": 1462390463, "answer_id": 37036494, "question_id": 37035912, "link": "https://stackoverflow.com/questions/37035912/parsec-parsing-expression-between-slashes/37036494#37036494", "title": "Parsec: Parsing expression between slashes", "body": "<p>I think you can use <a href=\"https://hackage.haskell.org/package/parsec-3.1.9/docs/Text-Parsec-Expr.html\" rel=\"nofollow\"><code>Text.Parsec.Expr</code></a> to parse the interior expression; then you can embed backtracking for the <code>/</code> case, for example:</p>\n\n<pre><code>Infix (try $ do { reserved \"/\"; notFollowedBy eof; return div }) AssocLeft\n</code></pre>\n\n<p>You can also parse the exterior language and the interior expression in separate passes. I\u2019ve done this in a compiler for a language with custom operators: first parse the program without touching infix expressions, then run another pass to parse infix expressions according to the operators in scope.</p>\n"}], "owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462390463, "creation_date": 1462388550, "question_id": 37035912, "link": "https://stackoverflow.com/questions/37035912/parsec-parsing-expression-between-slashes", "title": "Parsec: Parsing expression between slashes", "body": "<p>I'm trying to parse simple expressions between slashes. Example: <code>/ 1+2*3 /</code> should evaluate to <code>7</code>.</p>\n\n<p>I was trying this</p>\n\n<pre><code>module Test where\n\nimport Text.Parsec\nimport Text.Parsec.Language (emptyDef)\nimport Text.Parsec.Combinator (between)\nimport Text.Parsec.String (Parser)\n\nimport qualified Text.Parsec.Expr as Ex\nimport qualified Text.Parsec.Token as Tok\n\nlexer :: Tok.TokenParser ()\nlexer = Tok.makeTokenParser style\n  where\n    ops = [\"+\",\"*\",\"-\",\"/\",\";\"]\n    names = [\"def\",\"extern\"]\n    style = emptyDef {\n               Tok.commentLine = \"#\"\n             , Tok.reservedOpNames = ops\n             , Tok.reservedNames = names\n             }\n\ninteger :: Parser Int\ninteger = fromIntegral &lt;$&gt; Tok.integer lexer\n\nparens :: Parser a -&gt; Parser a\nparens = Tok.parens lexer\n\nbraces :: Parser a -&gt; Parser a\nbraces = Tok.braces lexer\n\nslashes :: Parser a -&gt; Parser a\nslashes = between (reserved \"/\") (reserved \"/\")\n\nreserved :: String -&gt; Parser ()\nreserved = Tok.reserved lexer\n\nreservedOp :: String -&gt; Parser ()\nreservedOp = Tok.reservedOp lexer\n\nbinary s f assoc = Ex.Infix (reservedOp s &gt;&gt; return f) assoc\ntable = [[binary \"*\" (*) Ex.AssocLeft,\n          binary \"/\" div Ex.AssocLeft]\n        ,[binary \"+\" (+) Ex.AssocLeft,\n          binary \"-\" (-) Ex.AssocLeft]]\n\nfactor :: Parser Int\nfactor = try integer\n      &lt;|&gt; parens expr\n\nexpr :: Parser Int\nexpr = Ex.buildExpressionParser table factor\n\nprogramInSlashes :: Parser Int\nprogramInSlashes = slashes expr\n\nprogramInBraces :: Parser Int\nprogramInBraces = braces expr\n</code></pre>\n\n<p>which works okay for <code>programInBraces</code>:</p>\n\n<pre><code>*Test&gt; parse programInBraces \"\" \"{ 1+2*3/4 }\"\nRight 2\n</code></pre>\n\n<p>however, <code>programInSlashes</code> does fail:</p>\n\n<pre><code>*Test&gt; parse programInSlashes \"\" \"/ 1+2*3/4 /\"\nLeft (line 1, column 12):\nunexpected end of input\nexpecting end of \"/\", integer or \"(\"\n</code></pre>\n\n<p>Clearly the problem is that <code>/</code> is both an operator and the delimiter for the program itself. But as the language isn't ambiguous we should be able to parse that, no?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 3, "last_activity_date": 1462388777, "last_edit_date": 1495542232, "creation_date": 1462388777, "answer_id": 37035999, "question_id": 37035832, "link": "https://stackoverflow.com/questions/37035832/haskell-data-declarations/37035999#37035999", "title": "Haskell Data Declarations", "body": "<p>Behind the scenes, GHCi is trying to call <code>print (square 5)</code>. Unfortunately this requires <code>Shape</code> to implement something called the <code>Show</code> typeclass. You can make the error go away by adding <code>deriving Show</code> to the end of the <code>data Shape = Circle Float | Rect Float Float deriving Show</code>.</p>\n\n<p>There's a <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">great section on the <code>Show</code> typeclass in <em>Learn You a Haskell</em></a> and <a href=\"https://stackoverflow.com/questions/3864647/how-does-deriving-work-in-haskell\">a great answer on deriving in Stack Overflow</a>.</p>\n"}], "owner": {"reputation": 39, "user_id": 6048440, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/43b99784b7b48ffbb5159451ac9c5f78?s=128&d=identicon&r=PG&f=1", "display_name": "mk4280", "link": "https://stackoverflow.com/users/6048440/mk4280"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462389305, "creation_date": 1462388303, "last_edit_date": 1462389305, "question_id": 37035832, "link": "https://stackoverflow.com/questions/37035832/haskell-data-declarations", "title": "Haskell Data Declarations", "body": "<p>Codes below are from <em>Programming in Haskell</em> by Hutton (p.101).</p>\n\n<pre><code>data Shape = Circle Float | Rect Float Float\n\nsquare :: Float -&gt; Shape\nsquare n = Rect n n\n\narea : Shape -&gt; Float\narea(Rect x y) = x * y\n</code></pre>\n\n<p>In ghci, if I type area(Rect 3 5), I get 15.\nBut if I type square 5(thinking that I would get Rect 5 5 as a result), I get an error message:<br>\n\"No instance for (Show Shape) arising from a use of \u2018print\u2019\nIn a stmt of an interactive GHCi command: print it\".</p>\n\n<p>Why is that?</p>\n"}, {"tags": ["haskell", "types", "type-synonyms"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1462388511, "post_id": 37035738, "comment_id": 61622124, "body": "It can make type signatures shorter!!! And you don&#39;t need to specify that it is one; it just is!! But if you like, you can write <code>cb :: ExecCallback</code>. I wouldn&#39;t particularly recommend it though; writing it out makes it clearer. And you don&#39;t need so many question marks!"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462390497, "post_id": 37036335, "comment_id": 61623181, "body": "Another good example is <code>lens</code>, which has super-gnarly type synonyms. One of the simplest is <code>type Lens s t a b = forall f . Functor f =&gt; (a -&gt; f b) -&gt; s -&gt; f t</code>."}, {"owner": {"reputation": 729, "user_id": 2181977, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0b84fe9137990458c9a91dcadd10579c?s=128&d=identicon&r=PG", "display_name": "Fredrik Karlsson", "link": "https://stackoverflow.com/users/2181977/fredrik-karlsson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462392716, "post_id": 37036335, "comment_id": 61624410, "body": "@dfeuer ok, I am sure there are odd type synonyms out there, but I am happy to have learned how to sole this simple case :-) Anyway, thanks!"}], "tags": [], "owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "is_accepted": true, "score": 2, "last_activity_date": 1462389894, "creation_date": 1462389894, "answer_id": 37036335, "question_id": 37035738, "link": "https://stackoverflow.com/questions/37035738/function-with-type-synonym/37036335#37036335", "title": "Function with type synonym", "body": "<p>In Haskell, with <code>type</code> you define a <em>type synonym</em>. In your example that means that <code>ExecCallback</code> is just an alias for the type <code>ColumnCount -&gt; [Text]-&gt; [Maybe Text] -&gt; IO ()</code>, they are interchangeable.</p>\n\n<p>You could change the following lines</p>\n\n<pre><code>cb :: ColumnCount -&gt; [Text] -&gt; [Maybe Text] -&gt; IO ()\ncb  n cnl ct = do print $ cnl !! 1\n                  return ()\n</code></pre>\n\n<p>to </p>\n\n<pre><code>cb :: ExecCallback\ncb  n cnl ct = do print $ cnl !! 1\n                  return ()\n</code></pre>\n\n<p>and everything would still work as is. It can make your code shorter and more readable.</p>\n\n<p>One other good example is</p>\n\n<pre><code>type String = [Char]\n</code></pre>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#t:String\" rel=\"nofollow\">in <code>Prelude</code></a>. I bet you normally use <code>String</code> instead of <code>[Char]</code> in most cases. But you're absolutely free to use either.</p>\n\n<p>Another (completely unrelated) example is the <a href=\"https://hackage.haskell.org/package/conduit-1.2.6.4\" rel=\"nofollow\"><code>conduit</code></a> package where some <a href=\"https://hackage.haskell.org/package/conduit-1.2.6.4/docs/src/Data-Conduit-Internal-Conduit.html#Sink\" rel=\"nofollow\">type synonyms</a> make a major difference:</p>\n\n<pre><code>type Sink i = ConduitM i Void\ntype Consumer i m r = forall o. ConduitM i o m r\n</code></pre>\n\n<p>For something that's a sink for values of any type <code>i</code>, <code>Sink i</code> seems way more readable than <code>ConduitM i Void</code>. Same for <code>Consumer</code>.</p>\n"}], "owner": {"reputation": 729, "user_id": 2181977, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0b84fe9137990458c9a91dcadd10579c?s=128&d=identicon&r=PG", "display_name": "Fredrik Karlsson", "link": "https://stackoverflow.com/users/2181977/fredrik-karlsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 0, "accepted_answer_id": 37036335, "answer_count": 1, "score": 0, "last_activity_date": 1462389894, "creation_date": 1462387981, "question_id": 37035738, "link": "https://stackoverflow.com/questions/37035738/function-with-type-synonym", "title": "Function with type synonym", "body": "<p>Sorry for asking as potentially silly question, but returning to Haskell to do some conversion from one database package to a different one, I find myself a bit puzzled about how to do this properly.</p>\n\n<p>In the <code>Database.SQLite3</code> module, there is an <code>execWithCallback</code> with type</p>\n\n<pre><code>execWithCallback :: Database -&gt; Text -&gt; ExecCallback -&gt; IO ()\n</code></pre>\n\n<p>Now, the callback is defined as </p>\n\n<pre><code>type ExecCallback = ColumnCount -&gt; [Text]-&gt; [Maybe Text] -&gt; IO ()\n</code></pre>\n\n<p>that is, a function with type <code>ExecCallback</code>\nMy silly test code compiles and runs correctly:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Database.SQLite3\nimport Data.Text\n\ncb :: ColumnCount -&gt; [Text] -&gt; [Maybe Text] -&gt; IO ()\ncb  n cnl ct = do print $ cnl !! 1\n                  return ()\n\nmain = do\n  dh &lt;- open \"fileinfo.sqlite\"\n  execWithCallback dh \"select * from files;\" cb\n  close dh\n</code></pre>\n\n<p>but then, what is the point of the type??? And, how do I specify that <code>cb</code> is an <code>ExecCallback</code>??</p>\n"}, {"tags": ["haskell", "bit-manipulation", "ghc"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1462390665, "post_id": 37035643, "comment_id": 61623278, "body": "Maybe there&#39;s something here which can help: <a href=\"https://en.wikipedia.org/wiki/Find_first_set\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Find_first_set</a>"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 2, "creation_date": 1462391752, "post_id": 37035643, "comment_id": 61623897, "body": "Well I don&#39;t really know haskell, but there is <code>x &gt;&gt; ctz(x) = x &#47; (x &amp; -x)</code> (iff <code>x != 0</code>). Then kick out one more bit. (there is a related one to the left but it&#39;s &quot;less cute&quot;)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1462392110, "post_id": 37035643, "comment_id": 61624080, "body": "@harold, what&#39;s the one to the left look like?"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1462392255, "post_id": 37035643, "comment_id": 61624158, "body": "Longer so I guess I&#39;ll write up an answer"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462392681, "post_id": 37035643, "comment_id": 61624395, "body": "@chi, those look like they could be some good options."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462393346, "post_id": 37035643, "comment_id": 61624771, "body": "@dfeuer <code>ctz(x) = countTrailingZeros x</code>, so that&#39;s an equivalent option"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462395541, "post_id": 37035643, "comment_id": 61625894, "body": "@chi, the implementation using <code>popCount</code> could be just the ticket for <code>4.5 &lt;= base &lt; 4.8</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462433871, "post_id": 37035643, "comment_id": 61638409, "body": "@dfeuer I wonder how hard it would be to add a custom near-assembly (llvm?) implementation of <code>countTrailingZeros</code> for those versions. One could just use the FFI and code everything in C, but that might be slow, and surely it won&#39;t be inlined."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462468125, "post_id": 37035643, "comment_id": 61659599, "body": "@chi, I don&#39;t know assembly, sadly, and don&#39;t really know how to learn it. The FFI overhead would almost certainly blow away any performance benefit."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462393802, "post_id": 37037382, "comment_id": 61625018, "body": "Ah, the only reason I was interested in going left was because I thought maybe it could avoid the division. Oh well. While this is pretty cool, I don&#39;t think it could actually help me--implementing arbitrary division of a two-word representation of a double word doesn&#39;t seem likely to be remotely pleasant or efficient!"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462394442, "post_id": 37037382, "comment_id": 61625324, "body": "Yes that would hurt. By the way, there is also a shortcut to &quot;right-justify&quot; by doing almost a count-trailing-zeros but instead of counting them only do the justification (which one of the ctz algorithms naturally produces anyway, but then ignores)"}], "tags": [], "owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "is_accepted": false, "score": 2, "last_activity_date": 1462394108, "last_edit_date": 1462394108, "creation_date": 1462393592, "answer_id": 37037382, "question_id": 37035643, "link": "https://stackoverflow.com/questions/37035643/how-can-i-shift-all-the-zeros-off/37037382#37037382", "title": "How can I shift all the zeros off?", "body": "<p>To the left is more annoying. Not actually tested:</p>\n\n<pre><code>m = x\nm |= m &gt;&gt; 1\nm |= m &gt;&gt; 2\nm |= m &gt;&gt; 4\nm |= m &gt;&gt; 8\nm |= m &gt;&gt; 16\nx = x * (0x80000000 / (m &gt;&gt; 1))\n</code></pre>\n\n<p>This moves the highest set bit to the top by first computing the highest power of two present in the number, and then multiplying by the amount necessary to turn that into the highest possible power of two. It doesn't like it when the top bit is already set (it would divide by 0) and it needs the number of bits to be known. So it's probably better to just count the leading zeros instead of this, or maybe there's something better but I don't know of it.</p>\n\n<p>The version to the right (for completeness?) is nicer, just</p>\n\n<pre><code>x / (x &amp; -x)\n</code></pre>\n\n<p>Where <code>x &amp; -x</code> is a relatively well-known trick to isolate the lowest set bit.</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1462394108, "creation_date": 1462387623, "last_edit_date": 1592644375, "question_id": 37035643, "link": "https://stackoverflow.com/questions/37035643/how-can-i-shift-all-the-zeros-off", "title": "How can I shift all the zeros off?", "body": "<p>This is a follow-up to <a href=\"https://stackoverflow.com/questions/36971976/whats-the-best-way-to-represent-a-short-bit-string\">my last question</a>. I managed to implement a pretty fast &quot;bit queue builder&quot; as</p>\n<pre><code>data BitQueueB = BQB !Word !Word\n</code></pre>\n<p>by pushing elements in from the left (starting with a guard bit), then when I'm done &quot;building&quot; the queue, counting the trailing zeros and shifting them off, installing a new guard bit on the left.</p>\n<p>However, this solution doesn't really do anything for GHC &lt; 7.10, since that's when <code>countTrailingZeros</code> was introduced. I also can't help wondering if there's some more magical way to accomplish this shift, or is leftward counterpart.</p>\n<h3>The point</h3>\n<p>I have a two-word representation of a double word, guaranteed to have at least one bit set. I'm looking for the fastest way to shift the double word to either the left <em>or</em> the right until the first set bit is shifted off, without using either <code>countLeadingZeros</code> or <code>countTrailingZeros</code>.</p>\n<h3>One thought</h3>\n<p>My poor intuition in these matters suggests that if there <em>could</em> be some way to use multiplication if I switch to shifting left, but maybe that's just wishful thinking.</p>\n"}, {"tags": ["haskell", "ghc", "uninstallation", "osx-elcapitan", "haskell-platform"], "comments": [{"owner": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "edited": false, "score": 0, "creation_date": 1462385198, "post_id": 37034915, "comment_id": 61620059, "body": "I think this is some sort of bug. I installed GHC on a fresh machine and it gave me the same message."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1462385618, "post_id": 37034915, "comment_id": 61620338, "body": "I would suggest you install <i>stack</i> instead"}, {"owner": {"reputation": 159, "user_id": 5220885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3L9Dk.jpg?s=128&g=1", "display_name": "n00b", "link": "https://stackoverflow.com/users/5220885/n00b"}, "reply_to_user": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "edited": false, "score": 0, "creation_date": 1462385748, "post_id": 37034915, "comment_id": 61620432, "body": "Why are they down-voting my question is it bad? @Mika&#39;il Thanks"}, {"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 0, "creation_date": 1462386603, "post_id": 37034915, "comment_id": 61620942, "body": "@user32073 this question is off-topic on StackOverflow. It may be more appropriate on <a href=\"https://superuser.com\">superuser.com</a>. I am voting to migrate it there."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462387527, "post_id": 37034915, "comment_id": 61621532, "body": "I think it&#39;s borderline (maybe the hardest task in Haskell is setting it up) - but it&#39;s really only one vote - no big deal"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 12, "last_activity_date": 1463204835, "creation_date": 1463204835, "answer_id": 37223112, "question_id": 37034915, "link": "https://stackoverflow.com/questions/37034915/how-do-i-uninstall-older-versions-of-ghc/37223112#37223112", "title": "How do I uninstall older versions of GHC?", "body": "<p>You can uninstall prior platforms by running</p>\n\n<p><code>uninstall-hs</code> from the command line.</p>\n\n<p>You'll get an output like:</p>\n\n<pre><code>-- Versions found on this system\n7.10.3\n-- To remove a version and all earlier: uninstall-hs thru VERSION\n-- To remove only a single version:     uninstall-hs only VERSION\n</code></pre>\n\n<p>And you can proceed from there...</p>\n"}], "owner": {"reputation": 159, "user_id": 5220885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3L9Dk.jpg?s=128&g=1", "display_name": "n00b", "link": "https://stackoverflow.com/users/5220885/n00b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5774, "favorite_count": 2, "accepted_answer_id": 37223112, "answer_count": 1, "score": 8, "last_activity_date": 1546119614, "creation_date": 1462385093, "last_edit_date": 1546119614, "question_id": 37034915, "link": "https://stackoverflow.com/questions/37034915/how-do-i-uninstall-older-versions-of-ghc", "title": "How do I uninstall older versions of GHC?", "body": "<p>I installed Haskell Platform 7.10.3 on my mac and when it finished it said that it had detected older versions of GHC and to uninstall them, but how do I do that?</p>\n\n<p>I'm using a macbook air with OS X 10.11.3.</p>\n"}, {"tags": ["haskell", "types", "dependent-type", "hlist"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1462385133, "post_id": 37034545, "comment_id": 61620023, "body": "<code>data Stream a = IO (a, Stream a)</code> is strange, since you&#39;re using <code>IO</code> as constructor. Is that intended, or did you mean <code>data Stream a = Stream (IO (a, Stream a))</code>?"}, {"owner": {"reputation": 653, "user_id": 2236092, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e95a9d73105658172c8932d5a920751?s=128&d=identicon&r=PG", "display_name": "schernichkin", "link": "https://stackoverflow.com/users/2236092/schernichkin"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462389823, "post_id": 37034545, "comment_id": 61622858, "body": "Sorry <code>data Stream a = Stream (IO (a, Stream a))</code> of course."}], "answers": [{"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1462404085, "post_id": 37035021, "comment_id": 61629222, "body": "You can define <code>data PeriodicHStream as where (:::) :: a -&gt; PeriodicHStream (Append a as) -&gt; PeriodicHStream (a &#39;: as)</code> to fix the issue with the reversed order of values. It also fixes the &quot;green slime&quot; problem: &quot;<a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/Pivotal.pdf\" rel=\"nofollow noreferrer\">The presence of \u2018green slime\u2019 \u2014 defined functions in the return types of constructors \u2014 is a danger sign</a>&quot;."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1462408229, "post_id": 37035021, "comment_id": 61630355, "body": "@user3237465 Oh, of course! It was right under my nose. I think I&#39;d convinced myself that I wouldn&#39;t be able to call the constructor because GHC wouldn&#39;t want to unify <code>Append a as</code> with an arbitrary list. (In practice it works because you already know what <code>as</code> is, so all the type checker has to do is compute.) I&#39;ve updated the answer."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1462408494, "last_edit_date": 1462408494, "creation_date": 1462385455, "answer_id": 37035021, "question_id": 37034545, "link": "https://stackoverflow.com/questions/37034545/infinite-finally-periodic-hlist-in-haskell/37035021#37035021", "title": "Infinite (finally-periodic) HList in Haskell", "body": "<p>Make <code>HList</code>s infinite and periodic with this One Cool Trick!</p>\n\n<p>When you add an element to your periodic heterogeneous stream, don't extend the list of types by which it's indexed. Rotate it.</p>\n\n<pre><code>type family Append x xs where\n    Append x '[] = '[x]\n    Append x (y ': xs) = y ': Append x xs\n\ninfixr 5 :::\ndata HStream as where\n    (:::) :: { headHS :: a, tailHS :: HStream (Append a as) } -&gt; HStream (a ': as)\n\nmyHStream :: HStream '[Char, Bool, Int]\nmyHStream = 'c' ::: True ::: 3 ::: 'x' ::: False ::: -5 ::: myHStream\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 653, "user_id": 2236092, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e95a9d73105658172c8932d5a920751?s=128&d=identicon&r=PG", "display_name": "schernichkin", "link": "https://stackoverflow.com/users/2236092/schernichkin"}, "edited": false, "score": 0, "creation_date": 1462465508, "post_id": 37040780, "comment_id": 61658079, "body": "Looks interesting, could you please provide more complete examples and references to indexing schemas you mentioned?"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1462411417, "creation_date": 1462411417, "answer_id": 37040780, "question_id": 37034545, "link": "https://stackoverflow.com/questions/37034545/infinite-finally-periodic-hlist-in-haskell/37040780#37040780", "title": "Infinite (finally-periodic) HList in Haskell", "body": "<p>One general option is to switch from an <code>HList</code>, which encodes the types of all the elements, to a type-aligned list (or, more generally, a type-aligned sequence), which only ensures transitions along valid paths.</p>\n\n<pre><code>data TAList c x z where\n  Nil :: TAList c x x\n  Cons :: c x y -&gt; TAList c y z -&gt; TAList c x z\n</code></pre>\n\n<p>So you could encode your transitions, with some care, using a possibility-large GADT for <code>c</code> and an appropriate kind of your choice for <code>x</code> and <code>z</code>. Infinite type-aligned lists are no problem, because they're polymorphic in their final type argument.</p>\n\n<p>You could probably use a McBride-style indexing scheme instead of an Atkey one to get more flexibility, at the cost of more complexity.</p>\n"}], "owner": {"reputation": 653, "user_id": 2236092, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e95a9d73105658172c8932d5a920751?s=128&d=identicon&r=PG", "display_name": "schernichkin", "link": "https://stackoverflow.com/users/2236092/schernichkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 37035021, "answer_count": 2, "score": 2, "last_activity_date": 1462411417, "creation_date": 1462383686, "last_edit_date": 1462408251, "question_id": 37034545, "link": "https://stackoverflow.com/questions/37034545/infinite-finally-periodic-hlist-in-haskell", "title": "Infinite (finally-periodic) HList in Haskell", "body": "<p>let's say I have an infinite sequence of actions, each of which returns the result of a certain type. Something like:</p>\n\n<pre><code>newtype Stream a = Stream (IO (a, Stream a))\n</code></pre>\n\n<p>But with <code>a</code> varying over time. I want to strongly type this sequence. It's obviously does not make sence for arbitrary infinite type sequence and naive approach such that:</p>\n\n<pre><code>data HStream :: [u] -&gt; * where Cons :: Proxy x -&gt; HStream xs -&gt; HStream (x ': xs)\n\ninfiniteInt = Cons (Proxy :: Proxy Int) infiniteInt\n</code></pre>\n\n<p>will lead to an infinite type, which is not supported by Haskell's type system. But I don't see nothing wrong with a finally-periodic HLists (i.e. such what type sequence will repeat itself from some point: <code>[Bool, Int, Int, Sting, Int, Sting, Int, Sting ... ]</code>). And I also think that if we have some strongly normalizing way to describe infinite type or some way to provide an evidence of infinite type equality which can be checked in finite number of steps, it should be possible to typecheck program with such infinite types.</p>\n\n<p>Does anyone have any idea how such types can be represented and used in Haskell? Let's start from infinite finally-periodic hlist for now, but I will also appreciate if someone has an idea how it can be generalized for wider class of infinite tupes and where generalization limits lays.</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1462380883, "post_id": 37033685, "comment_id": 61617559, "body": "This is the <code>WriterT Any Maybe</code> monad, where we interpret <code>Definitely a</code> as <code>Just (False, a)</code>, <code>Perhaps a</code> as <code>Just (True, a)</code>, and <code>Nope</code> as <code>Nothing</code> (with appropriate newtype wrapping all around)."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1462380922, "post_id": 37033685, "comment_id": 61617588, "body": "or just my take on <i>probably</i> ;)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1462381003, "last_edit_date": 1462381003, "creation_date": 1462380592, "answer_id": 37033685, "question_id": 37033545, "link": "https://stackoverflow.com/questions/37033545/instance-of-monad-for-multiple-data-constructors/37033685#37033685", "title": "Instance of Monad for Multiple Data Constructors", "body": "<p>you have to pick one - based on the naming I would suggest</p>\n\n<pre><code>return value = Definitely value\n</code></pre>\n\n<p>remember that <code>return a &gt;&gt;= f</code> must be <code>f a</code></p>\n\n<p><strong>bind</strong> should probably be</p>\n\n<pre><code>(Definitely a) &gt;&gt;= f = f a\n(Perhaps a)    &gt;&gt;= f = case f a of\n                          Definitely b -&gt; Perhaps b\n                          Perhaps b    -&gt; Perhaps b\n                          Nope         -&gt; Nope\nNope           &gt;&gt;= _ = Nope\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "is_accepted": false, "score": 1, "last_activity_date": 1462404890, "last_edit_date": 1495541273, "creation_date": 1462402746, "answer_id": 37039485, "question_id": 37033545, "link": "https://stackoverflow.com/questions/37033545/instance-of-monad-for-multiple-data-constructors/37039485#37039485", "title": "Instance of Monad for Multiple Data Constructors", "body": "<p>Carsten's answer is quite correct, of course, but it is, in my experience, often <a href=\"https://stackoverflow.com/questions/3382210/monad-join-function\">more intuitive</a>  to specify a monad by defining the <code>join</code> function (especially in this case, where any child will understand that if Mum says that we will <em>perhaps definitely</em> have ice cream tomorrow that means that we will <em>perhaps</em> have ice cream..)</p>\n\n<pre><code>join :: Certainty (Certainty a) -&gt; Certainty a\n\njoin Nope                        = Nope\njoin (Perhaps Nope)              = Nope\njoin (Perhaps (Perhaps x))       = Perhaps x \njoin (Perhaps (Definitely x))    = Perhaps x\njoin (Definitely Nope)           = Nope\njoin (Definitely (Perhaps x))    = Perhaps x\njoin (Definitely (Definitely x)) = Definitely x\n</code></pre>\n\n<p>Of course, <code>&gt;&gt;=</code> can be defined in terms of <code>join</code> and <code>fmap</code> (which is trivial for <code>Certainty</code>, and can be automatically found by <code>ghc</code> with <code>-XDeriveFunctor</code>) by</p>\n\n<pre><code>x &gt;&gt;= f = join (fmap f x)\n</code></pre>\n\n<p>which makes my definition equivalent to Carsten's</p>\n\n<p>Moreover, by looking at the last three lines of the definition of <code>join</code> we see that for all <code>x :: Certainty a</code> we have <code>join (Definitely x) = x</code> which suggests that</p>\n\n<pre><code> return x = Definitely x\n</code></pre>\n"}], "owner": {"reputation": 1343, "user_id": 4480394, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-QwHzVkP4n0Y/AAAAAAAAAAI/AAAAAAAAAGo/xwQ_WdtwEjQ/photo.jpg?sz=128", "display_name": "Mona the Monad", "link": "https://stackoverflow.com/users/4480394/mona-the-monad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 37033685, "answer_count": 2, "score": 3, "last_activity_date": 1462404890, "creation_date": 1462380157, "question_id": 37033545, "link": "https://stackoverflow.com/questions/37033545/instance-of-monad-for-multiple-data-constructors", "title": "Instance of Monad for Multiple Data Constructors", "body": "<p>I've started Haskell not too long ago, and am now teaching myself about monads, so I've come up with a dumb example for myself here to assist me in understanding an aspect of monads.</p>\n\n<p>Given a type <code>Certainty</code> defined as</p>\n\n<pre><code>data Certainty a = Definitely a | Perhaps a | Nope\n</code></pre>\n\n<p>and an instance of <code>Monad</code> for said type</p>\n\n<pre><code>instance Monad Certainty where\n  return = ...\n</code></pre>\n\n<p>how would the method <code>return</code> be defined for Certainty and each of its data constructors?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1462378099, "post_id": 37031924, "comment_id": 61615851, "body": "<code>a -&gt; b</code> doesn&#39;t mean the two types <i>must</i> be different, just that they <i>can</i> be different."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 5, "last_activity_date": 1462375467, "creation_date": 1462375467, "answer_id": 37031998, "question_id": 37031924, "link": "https://stackoverflow.com/questions/37031924/haskell-map-function-type-in-detail/37031998#37031998", "title": "Haskell Map Function type in detail", "body": "<p>function return can be any other type, for example length on Strings.  The notation </p>\n\n<pre><code>(a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>(a -&gt; b) -&gt; ([a] -&gt; [b])\n</code></pre>\n\n<p>in general</p>\n\n<pre><code>a -&gt; b -&gt; c -&gt; d\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>a -&gt; (b -&gt; (c -&gt; d))\n</code></pre>\n\n<p>your function <code>(+1)</code> happens to be <code>Num a =&gt; a -&gt; a</code> a special case.</p>\n"}, {"tags": [], "owner": {"reputation": 1713, "user_id": 1121552, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/tX32x.png?s=128&g=1", "display_name": "jonaprieto", "link": "https://stackoverflow.com/users/1121552/jonaprieto"}, "is_accepted": false, "score": 0, "last_activity_date": 1462431781, "creation_date": 1462431781, "answer_id": 37044475, "question_id": 37031924, "link": "https://stackoverflow.com/questions/37031924/haskell-map-function-type-in-detail/37044475#37044475", "title": "Haskell Map Function type in detail", "body": "<p>Hint:\nYou should be aware that the type of the function follows  the currying laws, so is right associative. This is why we avoid or remove the parenthesis in the type.</p>\n\n<p>On the other hand you use different letters in the type of the function ([a],[b]) to refer that you are going to use a different type for input or output, where exactly they appear.</p>\n"}], "owner": {"reputation": 39, "user_id": 6048440, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/43b99784b7b48ffbb5159451ac9c5f78?s=128&d=identicon&r=PG&f=1", "display_name": "mk4280", "link": "https://stackoverflow.com/users/6048440/mk4280"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462431781, "creation_date": 1462375273, "question_id": 37031924, "link": "https://stackoverflow.com/questions/37031924/haskell-map-function-type-in-detail", "title": "Haskell Map Function type in detail", "body": "<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap f xs = [f x | x &lt;- xs]\n</code></pre>\n\n<p>This definition is from Programming in Haskell by Hutton (p.62).</p>\n\n<p>Looking at its type, I understand how the function takes first argument that is a function and second argument that is a list.</p>\n\n<p>But does the type above become <code>(a -&gt; b) -&gt; ([a] -&gt; [b])?</code> so map takes function and returns a function that takes <code>[a]</code> and returns <code>[f x|x &lt;- xs]?</code></p>\n\n<p>And Why is it <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code> instead of <code>(a -&gt; a) -&gt; [a] -&gt; [a] ?</code></p>\n\n<p>For example, the book uses <code>map(+1)[1,3,5,7]</code></p>\n\n<p>Can someone please explain this function in detail?</p>\n"}, {"tags": ["list", "haskell", "functional-programming", "fold"], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1462375884, "creation_date": 1462375884, "answer_id": 37032159, "question_id": 37031849, "link": "https://stackoverflow.com/questions/37031849/code-meaning-in-haskell-99-problems/37032159#37032159", "title": "Code meaning in Haskell 99 problems", "body": "<p>The list argument is <code>replicate (n - 1) tail</code>, which is a list that contains the function <code>tail</code> <code>(n-1)</code> times. So we have <code>($)</code> as the function, <code>xs</code> as the initial element and <code>[tail, tail, ..., tail]</code> as the list. So the result of the fold is <code>tail $ tail $ ... $ tail $ xs</code>.</p>\n"}], "owner": {"reputation": 172, "user_id": 4932965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30dd676072dec501db6881c9dd4ac970?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Meriniuc", "link": "https://stackoverflow.com/users/4932965/razvan-meriniuc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 37032159, "answer_count": 1, "score": 1, "last_activity_date": 1462375884, "creation_date": 1462375053, "question_id": 37031849, "link": "https://stackoverflow.com/questions/37031849/code-meaning-in-haskell-99-problems", "title": "Code meaning in Haskell 99 problems", "body": "<p>I have been working on the 99 Haskell problems challenge and one of the solutions of problem no. 3 - Get the k-th element of a list, counting from 1, not 0 - is:</p>\n\n<pre><code>elementAt''' xs n = head $ foldr ($) xs $ replicate (n - 1) tail\n</code></pre>\n\n<p>I understand that, given a list, we could perform (n - 1) <code>tail</code> operations and the first element of the final list is the one we are looking for. As it is written, the <code>foldr</code>'s accumulator's initial value is the given list, but I fail to identify the second argument, which should be a list, right?</p>\n\n<p>I would appreciate if you explained the first steps <code>foldr</code> makes.</p>\n"}, {"tags": ["parsing", "haskell", "happy"], "answers": [{"tags": [], "owner": {"reputation": 653, "user_id": 2236092, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e95a9d73105658172c8932d5a920751?s=128&d=identicon&r=PG", "display_name": "schernichkin", "link": "https://stackoverflow.com/users/2236092/schernichkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1462697660, "last_edit_date": 1462697660, "creation_date": 1462375321, "answer_id": 37031940, "question_id": 37031046, "link": "https://stackoverflow.com/questions/37031046/haskell-happy-parser-not-going-further/37031940#37031940", "title": "Haskell Happy parser not going further", "body": "<p>It seems okay your expression has been parsed just fine. Check the return type of <code>myParse</code>, I guess it will be <code>IO ()</code>, and the actual action will be <code>putStrLn(\"D\")</code> - is what your wrote in <code>ProcedureDeclaration</code>. Next, your put call to <code>myParse</code> in the do block, it will be interpreted as <code>print .. &gt;&gt; myParse (..) &gt;&gt; putStrLn ..</code> or just linking monadic actions. <code>myParse</code> will return an action which will print \"D\" so the output is exactly what one would expect.</p>\n\n<p>You have other actions defined in <code>ProcedureBody</code> and <code>DeclarationSequence</code>. But you never use these actions in any way, it's like you will write:</p>\n\n<pre><code>    do\n      let a = putStrLn \"E\"\n      putStrLn(\"C\")\n</code></pre>\n\n<p>Which will output \"C\", <code>a</code> is not used by any means. Same with your parser. If you want to invoke these actions, try to write <code>$1 &gt;&gt; putStrLn(\"C\") &gt;&gt; $2</code> in <code>ProcedureDeclaration</code> associated code.</p>\n"}, {"comments": [{"owner": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "edited": false, "score": 0, "creation_date": 1462387277, "post_id": 37032773, "comment_id": 61621369, "body": "I was able to make the parser working but then, adding the possibility to define multiple procedures at the same level, I get an error compiling. I&#39;ve updated the question to show this problem."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "edited": false, "score": 0, "creation_date": 1462387591, "post_id": 37032773, "comment_id": 61621567, "body": "It&#39;s really a completely different question now. Please open up a new SO question for it."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "edited": false, "score": 0, "creation_date": 1462387735, "post_id": 37032773, "comment_id": 61621659, "body": "Also, when you create the new question, please include a compilable example. We&#39;re going to need to know the definitions of the functions like <code>defaultProcedure</code> and <code>addProcedureToProcedure</code>, etc."}, {"owner": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "edited": false, "score": 0, "creation_date": 1462387907, "post_id": 37032773, "comment_id": 61621760, "body": "Ok, so now I&#39;ll open a new question putting all the info needed. Thank you for your help."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1462377630, "creation_date": 1462377630, "answer_id": 37032773, "question_id": 37031046, "link": "https://stackoverflow.com/questions/37031046/haskell-happy-parser-not-going-further/37032773#37032773", "title": "Haskell Happy parser not going further", "body": "<p>There are two things to note here.</p>\n\n<ol>\n<li>happy uses the first production rule as the top-level production for <code>myParse</code>.</li>\n</ol>\n\n<p>Your first production rule is <code>ProcedureDeclaration</code>, so that's all it's going to try to parse. You probably want to make <code>DeclarationSequence</code> the first rule.</p>\n\n<ol start=\"2\">\n<li><p>The return type of your productions are IO-actions, and in Haskell IO-actions are values. They are not \"executed\" until they become part of <code>main</code>. That means you need to write your productions like this:</p>\n\n<pre><code>DeclarationSequence : ProcedureDeclaration\n    { do $1; putStrLn(\"G\") }\nProcedureDeclaration : ProcedureHeading ';' ProcedureBody identifier\n    { do $1; $3; putStrLn(\"C\") }\n</code></pre></li>\n</ol>\n\n<p>That is, the return value of the <code>DeclarationSequence</code> rule is the IO-action returned by <code>ProcedureDeclaration</code> followed by <code>putStrLn \"G\"</code>.</p>\n\n<p>And the return value of the <code>ProducedureDeclaration</code> rule is the action returned by <code>ProcudureHeading</code> followed by the action returned by <code>ProcedureBody</code> followed by <code>putStrLn \"C\"</code>.</p>\n\n<p>You could also write the RHS of the rules using the <code>&gt;&gt;</code> operator:</p>\n\n<pre><code>{ $1 &gt;&gt; putStrLn \"G\" }\n{ $1 &gt;&gt; $3 &gt;&gt; putStrLn \"C\" }\n</code></pre>\n\n<p>Note that you have to decide the order in which to sequence the actions - i.e. pre-/post-/in- order.</p>\n\n<p>Working example: <a href=\"http://lpaste.net/162432\" rel=\"nofollow\">http://lpaste.net/162432</a></p>\n"}], "owner": {"reputation": 935, "user_id": 3365063, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f85ec976ad1f53d8d6e885a174d9e335?s=128&d=identicon&r=PG&f=1", "display_name": "zeb", "link": "https://stackoverflow.com/users/3365063/zeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462697660, "creation_date": 1462372936, "last_edit_date": 1462381632, "question_id": 37031046, "link": "https://stackoverflow.com/questions/37031046/haskell-happy-parser-not-going-further", "title": "Haskell Happy parser not going further", "body": "<p>I'm implementing a parser for a language similar to Oberon.\nI've successfully written the lexer using Alex since I can see that the list of tokens returned by the lexer is correct.</p>\n\n<p>When I give the tokens list to the parser, it stops at the first token.</p>\n\n<p>This is my parser:</p>\n\n<pre><code>...\n\n%name myParse\n%error { parseError }\n\n%token\n    KW_PROCEDURE        { KW_TokenProcedure }\n    KW_END              { KW_TokenEnd }\n    ';'                 { KW_TokenSemiColon }\n    identifier          { TokenVariableIdentifier $$ }\n\n%%\n\nProcedureDeclaration    :   ProcedureHeading ';' ProcedureBody identifier     { putStrLn(\"C\") }\n\nProcedureHeading        :   KW_PROCEDURE identifier { putStrLn(\"D\") }\n\nProcedureBody           :   KW_END                      { putStrLn(\"E\") }   \n                        | DeclarationSequence KW_END    { putStrLn(\"F\") }\n\nDeclarationSequence     :   ProcedureDeclaration        { putStrLn(\"G\") }\n\n{\nparseError :: [Token] -&gt; a\nparseError _ = error \"Parse error\"\n\nmain = do\n  inStr &lt;- getContents\n  print (alexScanTokens inStr)\n  myParse (alexScanTokens inStr)\n  putStrLn(\"DONE\")\n}\n</code></pre>\n\n<p>This is the test code I give to the parser:</p>\n\n<pre><code>PROCEDURE proc;\nEND proc\n</code></pre>\n\n<p>This is the token list returned by the lexer:</p>\n\n<pre><code>[KW_TokenProcedure,TokenVariableIdentifier \"proc\",KW_TokenSemiColon,KW_TokenEnd,TokenVariableIdentifier \"proc\"]\n</code></pre>\n\n<p>The parser does't give any error, but it sticks to my ProcedureDeclaration rule, printing only C.</p>\n\n<p>This is what the output looks like:</p>\n\n<pre><code>C\nDONE\n</code></pre>\n\n<p>Any idea why?</p>\n\n<hr>\n\n<p>UPDATE:</p>\n\n<p>I've made a first step forward and I was able to parse the test input given before. Now I changed my parser to recognize the declaration of multiple procedures on the same level. To do this, this is how my new parse looks like:</p>\n\n<pre><code>...\n\n%name myParse\n%error { parseError }\n\n%token\n    KW_PROCEDURE        { KW_TokenProcedure }\n    KW_END              { KW_TokenEnd }\n    ';'                 { KW_TokenSemiColon }\n    identifier          { TokenVariableIdentifier $$ }\n\n%%\n\nProcedureDeclarationList    :   ProcedureDeclaration                                { $1 }\n                            |   ProcedureDeclaration ';' ProcedureDeclarationList   { $3:[$1] }\n\nProcedureDeclaration        :   ProcedureHeading ';' ProcedureBody identifier       { addProcedureToProcedure $1 $3 }\n\nProcedureHeading            :   KW_PROCEDURE identifier                             { defaultProcedure { procedureName = $2 } }\n\nProcedureBody               :   KW_END                                              { Nothing }\n                            |   DeclarationSequence KW_END                          { Just $1 }\n\nDeclarationSequence         :    ProcedureDeclarationList                           { $1 }\n\n{\nparseError :: [Token] -&gt; a\nparseError _ = error \"Parse error\"\n\nmain = do\n  inStr &lt;- getContents\n  let result = myParse (alexScanTokens inStr)\n  putStrLn (\"result: \" ++ show(result))\n}\n</code></pre>\n\n<p>The thing is, it fails to compile giving me this error:</p>\n\n<pre><code>Occurs check: cannot construct the infinite type: t5 ~ [t5]\n    Expected type: HappyAbsSyn t5 t5 t6 t7 t8 t9\n                   -&gt; HappyAbsSyn t5 t5 t6 t7 t8 t9\n                   -&gt; HappyAbsSyn t5 t5 t6 t7 t8 t9\n                   -&gt; HappyAbsSyn t5 t5 t6 t7 t8 t9\n      Actual type: HappyAbsSyn t5 t5 t6 t7 t8 t9\n                   -&gt; HappyAbsSyn t5 t5 t6 t7 t8 t9\n                   -&gt; HappyAbsSyn t5 t5 t6 t7 t8 t9\n                   -&gt; HappyAbsSyn [t5] t5 t6 t7 t8 t9\n    ...\n</code></pre>\n\n<p>I know for sure that it's caused by the second element of my <code>ProcedureDeclarationsList</code> rule, but I don't understand why.</p>\n"}, {"tags": ["list", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1462372678, "creation_date": 1462372678, "answer_id": 37030955, "question_id": 37030827, "link": "https://stackoverflow.com/questions/37030827/substitution-of-union-in-haskell/37030955#37030955", "title": "substitution of union in haskell", "body": "<p>Looks like a h/w problem.  So here is a hint:</p>\n\n<p>assuming unique entries in the lists, take one list as the base, iterate over the other list and check whether each element exists in the base list if not add to the base.</p>\n"}], "owner": {"reputation": 41, "user_id": 6283871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0227809b1e66485e670320b3cfc5acaf?s=128&d=identicon&r=PG&f=1", "display_name": "newinHaskell", "link": "https://stackoverflow.com/users/6283871/newinhaskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462372678, "creation_date": 1462372340, "question_id": 37030827, "link": "https://stackoverflow.com/questions/37030827/substitution-of-union-in-haskell", "title": "substitution of union in haskell", "body": "<p>I'm looking for a way to alter <code>union</code> in Haskell. The thing is I want to union two list of strings, but we are not allowed to use Import Data.List to use union. </p>\n\n<p>What other way can we use to union two lists? </p>\n\n<pre><code>a `union` b\n</code></pre>\n\n<p>Thank you!  </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1462345990, "post_id": 37020164, "comment_id": 61592557, "body": "it&#39;s probably because the authors did not care about performance but about the modules here(?) ..."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1462346101, "post_id": 37020164, "comment_id": 61592633, "body": "Some more details about the difference between the various folds: <a href=\"https://wiki.haskell.org/Foldr_Foldl_Foldl\" rel=\"nofollow noreferrer\">wiki.haskell.org/Foldr_Foldl_Foldl</a>&#39;"}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1462350529, "post_id": 37020164, "comment_id": 61595352, "body": "@ErikR. Thanks, I&#39;ve read the wiki, and AFAIU, <code>foldl</code> is almost never used."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1462353712, "post_id": 37020164, "comment_id": 61597452, "body": "<code>foldl</code> is indeed rarely used, since it has an inherent low performance on long lists. In the LYAH example, I don&#39;t like the <code>if</code> part. I&#39;d use <code>(take len x == sub) || acc</code>. When folding left, I would also flip that to <code>acc || ...</code> to speed up a little (when folding right instead this would speed everything down). Further, there&#39;s <code>isPrefixOf</code> which could have been used or reimplementedas an exercise here ..."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462354272, "post_id": 37020164, "comment_id": 61597868, "body": "@chi there are sadly no exercises in LYAH (last I checked)"}], "answers": [{"comments": [{"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1462358082, "post_id": 37025079, "comment_id": 61600553, "body": "Thanks, in &quot; so foldl should be used.&quot;, did you mean <code>foldr</code>?"}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 4, "last_activity_date": 1462360460, "last_edit_date": 1462360460, "creation_date": 1462357681, "answer_id": 37025079, "question_id": 37020164, "link": "https://stackoverflow.com/questions/37020164/using-foldr-for-search-instead-of-foldl-in-haskell/37025079#37025079", "title": "Using foldr for search instead of foldl in haskell", "body": "<blockquote>\n  <p>Am I missing something or is it better to use foldr in this case?</p>\n</blockquote>\n\n<p>No, you are not missing anything, and your analysis is right; <code>foldl</code> is not the right tool here, and even <code>foldl'</code> is dubious; the task at hand inherently benefits from laziness, so <code>foldr</code> should be used.</p>\n"}], "owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 37025079, "answer_count": 1, "score": 1, "last_activity_date": 1462360460, "creation_date": 1462343674, "last_edit_date": 1462355665, "question_id": 37020164, "link": "https://stackoverflow.com/questions/37020164/using-foldr-for-search-instead-of-foldl-in-haskell", "title": "Using foldr for search instead of foldl in haskell", "body": "<p>So I'm reading <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow\">\"<em>Learn You A Haskell</em>\"</a> and in the <a href=\"http://learnyouahaskell.com/modules#data-list\" rel=\"nofollow\">chapter about modules</a>, there's a definition of a function named search, which checks whether a list contains a sub-list.</p>\n\n<pre><code>my_search :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\nmy_search sub l = \n  let \n    len = length sub\n    eqTest = (\\acc x -&gt; if take len x == sub then True else acc) \n  in foldl eqTest False $ tails l\n</code></pre>\n\n<p>Now, I wonder why not use <code>foldl'</code> which was mentioned earlier in this chapter, and runs faster:</p>\n\n<pre><code>my_search' :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\nmy_search' sub l = \n  let \n    len = length sub\n    eqTest = (\\acc x -&gt; if take len x == sub then True else acc) \n  in foldl' eqTest False $ tails l\n\n\n*Main&gt; my_search [10^6,10^6+1] [1..10^7]\nTrue\n(7.76 secs, 3,197,168,792 bytes)\n\n*Main&gt; my_search' [10^6,10^6+1] [1..10^7]\nTrue\n(4.53 secs, 2,964,986,352 bytes)\n</code></pre>\n\n<p>Better yet, with a small adjustment, we can use <code>foldr</code> which can also handle infinite lists by short-circuiting.</p>\n\n<pre><code>my_searchr :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\nmy_searchr sub l = \n  let \n    len = length sub\n    eqTest = (\\x acc -&gt; if take len x == sub then True else acc) \n  in foldr eqTest False $ tails l\n</code></pre>\n\n<p>Looking at the <a href=\"https://hackage.haskell.org/package/base-4.7.0.0/docs/src/Data-List.html#%5C\" rel=\"nofollow\">definition</a> of <code>isInfixOf</code>, I see it's implemented with <code>any</code>, which uses <code>foldr</code>.</p>\n\n<p>Am I missing something or is it better to use <code>foldr</code> in this case?</p>\n"}, {"tags": ["haskell", "boolean"], "comments": [{"owner": {"reputation": 3137, "user_id": 1862339, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e1fdbdf79034c63bd0fb1b51e48695f?s=128&d=identicon&r=PG", "display_name": "stholzm", "link": "https://stackoverflow.com/users/1862339/stholzm"}, "edited": false, "score": 0, "creation_date": 1462343870, "post_id": 37019716, "comment_id": 61591371, "body": "It is quite unclear if you just want to convert Bool to String (as the title suggests), or have problems with <code>printf</code>, or the list of strings. Please clarify your question."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6283871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0227809b1e66485e670320b3cfc5acaf?s=128&d=identicon&r=PG&f=1", "display_name": "newinHaskell", "link": "https://stackoverflow.com/users/6283871/newinhaskell"}, "edited": false, "score": 0, "creation_date": 1462344182, "post_id": 37019779, "comment_id": 61591543, "body": "It&#39;s a list to store the outputs. Thanks for the answer!"}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 6, "last_activity_date": 1462342216, "creation_date": 1462342216, "answer_id": 37019779, "question_id": 37019716, "link": "https://stackoverflow.com/questions/37019716/how-do-we-convert-boolean-to-string-in-haskell/37019779#37019779", "title": "How do we convert boolean to string in Haskell", "body": "<p>You can write a function which turns a single <code>Bool</code> into a single <code>String</code>:</p>\n\n<pre><code>boolToString :: T -&gt; String\nboolToString True = \"TRUE\"\nboolToString False = \"FALSE\"\n</code></pre>\n\n<p>but it's not clear from your question what the other parts of the <code>[String]</code> should be.</p>\n"}, {"tags": [], "owner": {"reputation": 3137, "user_id": 1862339, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e1fdbdf79034c63bd0fb1b51e48695f?s=128&d=identicon&r=PG", "display_name": "stholzm", "link": "https://stackoverflow.com/users/1862339/stholzm"}, "is_accepted": false, "score": 7, "last_activity_date": 1462343702, "creation_date": 1462343702, "answer_id": 37020170, "question_id": 37019716, "link": "https://stackoverflow.com/questions/37019716/how-do-we-convert-boolean-to-string-in-haskell/37020170#37020170", "title": "How do we convert boolean to string in Haskell", "body": "<p>How about a plain if expression?</p>\n\n<pre><code>if condition then \"TRUE\" else \"FALSE\"\n</code></pre>\n\n<p>Alternatively, if you do not care about the upper case, you could just use <code>show</code> on a boolean.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1462362169, "creation_date": 1462362169, "answer_id": 37026801, "question_id": 37019716, "link": "https://stackoverflow.com/questions/37019716/how-do-we-convert-boolean-to-string-in-haskell/37026801#37026801", "title": "How do we convert boolean to string in Haskell", "body": "<p>You can define a function based on the <code>show</code> function that is defined for <code>Bool</code>:</p>\n\n<pre><code>import Data.Char(toUpper)\n\nshowBool :: Bool -&gt; String\nshowBool = map toUpper . show\n</code></pre>\n\n<p>Since <code>show</code> returns <code>True</code> or <code>False</code>, by using the <code>map toUpper</code> function, you put all in uppercase.</p>\n"}, {"comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1462380156, "post_id": 37027477, "comment_id": 61617101, "body": "You can turn a <code>Bool</code> into a list of <code>String</code>s. Not only that, but there are an infinite number of ways to turn a <code>Bool</code> into a list of <code>String</code>s (even if we only count lists that only consist of the strings <code>&quot;TRUE&quot;</code> and &quot;<code>FALSE&quot;</code>)!"}, {"owner": {"reputation": 68, "user_id": 5853799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/V3Agb.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/5853799/ash"}, "edited": false, "score": 0, "creation_date": 1462380678, "post_id": 37027477, "comment_id": 61617447, "body": "You can just change the <code>&quot;True&quot;</code> into <code>[&quot;True&quot;]</code> for example."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1462385903, "post_id": 37027477, "comment_id": 61620513, "body": "@Ash: ok, no problem with this <code>T</code>. +1 btw."}], "tags": [], "owner": {"reputation": 68, "user_id": 5853799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/V3Agb.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/5853799/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1462380768, "last_edit_date": 1462380768, "creation_date": 1462363978, "answer_id": 37027477, "question_id": 37019716, "link": "https://stackoverflow.com/questions/37019716/how-do-we-convert-boolean-to-string-in-haskell/37027477#37027477", "title": "How do we convert boolean to string in Haskell", "body": "<p>You can't turn a <code>Bool</code> into a <code>[String]</code>, just into a <code>String</code>.</p>\n\n<p>You should do something like:</p>\n\n<pre><code>toString :: T -&gt; String {-  T = Bool (It was a type defined by him-}\ntoString x = if x then \"True\" else \"False\"\n</code></pre>\n\n<p>If you really want the result to be <code>[String]</code> you can just do:</p>\n\n<pre><code>toString :: T -&gt; [String] \ntoString x = if x then [\"True\"] else [\"False\"]\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6283871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0227809b1e66485e670320b3cfc5acaf?s=128&d=identicon&r=PG&f=1", "display_name": "newinHaskell", "link": "https://stackoverflow.com/users/6283871/newinhaskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6370, "favorite_count": 1, "accepted_answer_id": 37019779, "answer_count": 4, "score": 2, "last_activity_date": 1462380768, "creation_date": 1462342001, "last_edit_date": 1462342234, "question_id": 37019716, "link": "https://stackoverflow.com/questions/37019716/how-do-we-convert-boolean-to-string-in-haskell", "title": "How do we convert boolean to string in Haskell", "body": "<p>I'm a beginner in Haskell. I was trying to add a string into a list, and this string should contains either <code>\"TRUE\"</code> or <code>\"FALSE\"</code> depending on the conditions. </p>\n\n<pre><code>type Output = [String]\ntype T = Bool \n\nf :: T -&gt; [String]\n</code></pre>\n\n<p>I was trying to use <code>printf</code> here, but I don't know the symbol for bool type(like <code>%d</code> for int) . Is there any good ways to do this? Thanks! </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 218, "user_id": 6269144, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d5aeb7e381785857d13cda22d2e8bfcb?s=128&d=identicon&r=PG&f=1", "display_name": "user6269144", "link": "https://stackoverflow.com/users/6269144/user6269144"}, "is_accepted": true, "score": 3, "last_activity_date": 1462367483, "last_edit_date": 1462367483, "creation_date": 1462334532, "answer_id": 37018205, "question_id": 37018160, "link": "https://stackoverflow.com/questions/37018160/haskell-greatest-common-divisor-error/37018205#37018205", "title": "Haskell greatest common divisor error?", "body": "<p>You are almost right! You mised up a call to <code>myGCD</code>. The correct code should read:</p>\n\n<pre>\nmyGCD :: Integer -> Integer -> Integer\nmyGCD a b\n      | b == 0     = abs a\n      | otherwise  = myGCD b (<b>a</b> `mod` <b>b</b>)\n</pre>\n\n<p>Reversing the order of <code>a</code> and <code>b</code> in that last line will give you some funky results!</p>\n"}], "owner": {"reputation": 44, "user_id": 6275743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b34be60efc4a688dd18461b353ef61dc?s=128&d=identicon&r=PG&f=1", "display_name": "user335129", "link": "https://stackoverflow.com/users/6275743/user335129"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 37018205, "answer_count": 1, "score": 1, "last_activity_date": 1462367483, "creation_date": 1462334332, "question_id": 37018160, "link": "https://stackoverflow.com/questions/37018160/haskell-greatest-common-divisor-error", "title": "Haskell greatest common divisor error?", "body": "<p>I want to compute the greatest common divisor of two positive integer numbers in Haskell:</p>\n\n<pre><code>myGCD :: Integer -&gt; Integer -&gt; Integer\nmyGCD a b\n      | b == 0     = abs a\n      | otherwise  = myGCD b (b `mod` a)\n</code></pre>\n\n<p>This should be a fairly simple algorithm. However, I find that I am getting some very strange results. I just can't seem to find an error in the above logic. Anything obvious stand out that would affect computing the greatest common divisor of <code>a</code> and <code>b</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1462333563, "post_id": 37017974, "comment_id": 61587654, "body": "Can you give an example of how this function is not working as expected?"}], "answers": [{"tags": [], "owner": {"reputation": 44, "user_id": 6275743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b34be60efc4a688dd18461b353ef61dc?s=128&d=identicon&r=PG&f=1", "display_name": "user335129", "link": "https://stackoverflow.com/users/6275743/user335129"}, "is_accepted": false, "score": 3, "last_activity_date": 1462337857, "last_edit_date": 1462337857, "creation_date": 1462335443, "answer_id": 37018368, "question_id": 37017974, "link": "https://stackoverflow.com/questions/37017974/finding-list-of-prime-numbers/37018368#37018368", "title": "Finding list of prime numbers", "body": "<p>The correct solution is:</p>\n\n<pre><code>primesR :: Integral a =&gt; a -&gt; a -&gt; [a]\nprimesR a b | even a = filter isPrime [a+1,a+3..b]\n            | True   = filter isPrime [a,a+2..b]\n</code></pre>\n\n<p>You mistakenly had <code>even a = filter isPrime [a+1,a+3..b-1]</code>. That is incorrect. You need to iterate all the way to the end of the list.</p>\n"}], "owner": {"reputation": 218, "user_id": 6269144, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d5aeb7e381785857d13cda22d2e8bfcb?s=128&d=identicon&r=PG&f=1", "display_name": "user6269144", "link": "https://stackoverflow.com/users/6269144/user6269144"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1462337857, "creation_date": 1462333100, "question_id": 37017974, "link": "https://stackoverflow.com/questions/37017974/finding-list-of-prime-numbers", "title": "Finding list of prime numbers", "body": "<p>I want to find a list of prime numbers, given a range of integers -- compute all primes in said range:</p>\n\n<pre><code>primesR :: Integral a =&gt; a -&gt; a -&gt; [a]\nprimesR a b | even a = filter isPrime [a+1,a+3..b-1]\n            | True   = filter isPrime [a,a+2..b]\n</code></pre>\n\n<p>It seems intuitive to filter out through the odd part of the list and then the remainder but I am not getting a correct result..How could I change this code to run properly?</p>\n"}, {"tags": ["haskell", "primes", "goldbach-conjecture"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 2, "creation_date": 1462333365, "post_id": 37017892, "comment_id": 61587618, "body": "What&#39;s the definition of <code>primesR</code>? Give an example of an input value (and the output) which are not what you expect. Note that <code>x+y</code> will always equal <code>n-1</code>."}, {"owner": {"reputation": 44, "user_id": 6275743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b34be60efc4a688dd18461b353ef61dc?s=128&d=identicon&r=PG&f=1", "display_name": "user335129", "link": "https://stackoverflow.com/users/6275743/user335129"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1462333782, "post_id": 37017892, "comment_id": 61587701, "body": "@ErikR oops sorry left that definition out. I have edited the question!"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462334410, "post_id": 37017892, "comment_id": 61587858, "body": "I think it&#39;s just the definition of <code>y</code> - isn&#39;t this supposed to be <code>let y = n-x</code> (IMO you want <code>x+y = n</code>)?  - seems ok for me as <code>goldbach 16 = (3,13)</code> for example (yes I saw that ErikR basically has the same remark - but it seems as OP has not connected the dots or we both are wrong)"}, {"owner": {"reputation": 44, "user_id": 6275743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b34be60efc4a688dd18461b353ef61dc?s=128&d=identicon&r=PG&f=1", "display_name": "user335129", "link": "https://stackoverflow.com/users/6275743/user335129"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462334601, "post_id": 37017892, "comment_id": 61587911, "body": "@Carsten you are right! I corrected the code and it worked great! Silly mistake ;)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1462334649, "post_id": 37017892, "comment_id": 61587926, "body": "well then either you or @ErikR should probably give an answer or you should close the question (it&#39;s just a slight mistake really)"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1462336336, "creation_date": 1462336336, "answer_id": 37018534, "question_id": 37017892, "link": "https://stackoverflow.com/questions/37017892/implement-goldbachs-conjecture-in-haskell/37018534#37018534", "title": "Implement Goldbach&#39;s conjecture in Haskell", "body": "<p>turns out the problem is a small <em>logical</em> mistake:</p>\n\n<pre><code>goldbach n = head [(x,y) | x &lt;- primesR 2 (n-1),\n                           let y = n-x, isPrime y]\n</code></pre>\n\n<p>as <code>n</code> is supposed to be <code>x+y</code> it should be <code>let y=n-x</code> instead</p>\n"}], "owner": {"reputation": 44, "user_id": 6275743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b34be60efc4a688dd18461b353ef61dc?s=128&d=identicon&r=PG&f=1", "display_name": "user335129", "link": "https://stackoverflow.com/users/6275743/user335129"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 1, "accepted_answer_id": 37018534, "answer_count": 1, "score": 0, "last_activity_date": 1487368396, "creation_date": 1462332662, "last_edit_date": 1487368396, "question_id": 37017892, "link": "https://stackoverflow.com/questions/37017892/implement-goldbachs-conjecture-in-haskell", "title": "Implement Goldbach&#39;s conjecture in Haskell", "body": "<p>So Goldbach's conjecture says that every positive even number greater than 2 is the sum of two prime numbers. I am trying to write a Haskell program that will, given a positive even integer, find those 2 prime numbers:</p>\n\n<pre><code>goldbach n = head [(x,y) | x &lt;- primesR 2 (n-1),\n                           let y = n-x-1, isPrime y]\n</code></pre>\n\n<p>Where <code>primesR</code> is given below as (returns primes in range):</p>\n\n<pre><code>primesR :: Integral a =&gt; a -&gt; a -&gt; [a]\nprimesR a b = takeWhile (&lt;= b) $ dropWhile (&lt; a) $ sieve [2..]\n  where sieve (n:ns) = n:sieve [ m | m &lt;- ns, m `mod` n /= 0 ]\n</code></pre>\n\n<p>However, this doesn't consistently give me the correct prime numbers. I think my indexing is off but I'm not sure how/where?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 2, "creation_date": 1462332379, "post_id": 37017779, "comment_id": 61587367, "body": "Shouldn&#39;t <code>p^c</code> really be <code>p^(c-1)</code>? For a prime <code>p</code>, <code>totient p == p-1</code>."}, {"owner": {"reputation": 218, "user_id": 6269144, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d5aeb7e381785857d13cda22d2e8bfcb?s=128&d=identicon&r=PG&f=1", "display_name": "user6269144", "link": "https://stackoverflow.com/users/6269144/user6269144"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1462332765, "post_id": 37017779, "comment_id": 61587450, "body": "@ErikR oh I see. I will try that!"}], "owner": {"reputation": 218, "user_id": 6269144, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d5aeb7e381785857d13cda22d2e8bfcb?s=128&d=identicon&r=PG&f=1", "display_name": "user6269144", "link": "https://stackoverflow.com/users/6269144/user6269144"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462340431, "creation_date": 1462331860, "last_edit_date": 1462340431, "question_id": 37017779, "link": "https://stackoverflow.com/questions/37017779/haskell-eulers-totient-error", "title": "Haskell Euler&#39;s totient error?", "body": "<p>I am trying to use Haskell to compute Euler's totient function:</p>\n\n<pre><code>totient m = product [(p - 1) * p ^ (c) | (p, c) &lt;- prime_factors_mult m]\n</code></pre>\n\n<p>However, this does not at all compute the coprime factors less than m. Is there an error in my logic somewhere? I think that <code>(p-1)</code> is the correct number but it is not giving me the results I need..</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 4, "last_activity_date": 1462331431, "creation_date": 1462331431, "answer_id": 37017732, "question_id": 37017633, "link": "https://stackoverflow.com/questions/37017633/haskell-coprime-negative-integers/37017732#37017732", "title": "Haskell coprime negative integers?", "body": "<p>It is not the Haskell compiler that calculates this. It is the <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:gcd\" rel=\"nofollow\"><code>gcd</code> function</a> from the standard library. The <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/src/GHC.Real.html#gcd\" rel=\"nofollow\">source code of the standard library</a>:</p>\n\n<pre><code>gcd             :: (Integral a) =&gt; a -&gt; a -&gt; a\n{-# NOINLINE [1] gcd #-}\ngcd x y         =  gcd' (abs x) (abs y)\n                   where gcd' a 0  =  a\n                         gcd' a b  =  gcd' b (a `rem` b)\n</code></pre>\n\n<p>shows that it first takes the absolute value of the two arguments before calculating the greatest common denominator.</p>\n"}], "owner": {"reputation": 44, "user_id": 6275743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b34be60efc4a688dd18461b353ef61dc?s=128&d=identicon&r=PG&f=1", "display_name": "user335129", "link": "https://stackoverflow.com/users/6275743/user335129"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 1, "accepted_answer_id": 37017732, "answer_count": 1, "score": 0, "last_activity_date": 1462331669, "creation_date": 1462330712, "last_edit_date": 1462331669, "question_id": 37017633, "link": "https://stackoverflow.com/questions/37017633/haskell-coprime-negative-integers", "title": "Haskell coprime negative integers?", "body": "<pre><code>coprime a b = gcd a b == 1\n</code></pre>\n\n<p>This should theoretically compute whether two integers are coprime but I am wondering what exactly happens in the Haskell 'compiler' if I were to run, say, <code>coprime -3 4</code>. If this were <code>coprime 3 4</code> the program would run fine and return <code>True</code>. How does the Haskell compiler deal with negative numbers in this case?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 1, "creation_date": 1462330622, "post_id": 37017507, "comment_id": 61586988, "body": "I ran this and got <code>[4,2,1,5,6,3]</code>."}, {"owner": {"reputation": 2405, "user_id": 346912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c0946fdf28e7126132cdbe315055bd?s=128&d=identicon&r=PG", "display_name": "Scott Newson", "link": "https://stackoverflow.com/users/346912/scott-newson"}, "edited": false, "score": 2, "creation_date": 1462330812, "post_id": 37017507, "comment_id": 61587023, "body": "Why the &#39;2&#39; in &#39;randomRIO (0, length xs - 2)&#39;?"}, {"owner": {"reputation": 260, "user_id": 6269250, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49affeb2471ac18a4650bbe6ee6c1e5b?s=128&d=identicon&r=PG&f=1", "display_name": "ABlueCrayon", "link": "https://stackoverflow.com/users/6269250/abluecrayon"}, "reply_to_user": {"reputation": 2405, "user_id": 346912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c0946fdf28e7126132cdbe315055bd?s=128&d=identicon&r=PG", "display_name": "Scott Newson", "link": "https://stackoverflow.com/users/346912/scott-newson"}, "edited": false, "score": 0, "creation_date": 1462331978, "post_id": 37017507, "comment_id": 61587276, "body": "@ScottNewson isn&#39;t that the best way to ensure we randomize the list?"}, {"owner": {"reputation": 2405, "user_id": 346912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c0946fdf28e7126132cdbe315055bd?s=128&d=identicon&r=PG", "display_name": "Scott Newson", "link": "https://stackoverflow.com/users/346912/scott-newson"}, "edited": false, "score": 0, "creation_date": 1462333348, "post_id": 37017507, "comment_id": 61587613, "body": "Like Chris, I do get results that look randomized - using Glasgow Haskell Compilation System, version 7.10.3"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1462334466, "post_id": 37017507, "comment_id": 61587873, "body": "@user327088 it&#39;s the best way to ensure that we never choose whichever the last permutation happens to be."}], "answers": [{"comments": [{"owner": {"reputation": 2405, "user_id": 346912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c0946fdf28e7126132cdbe315055bd?s=128&d=identicon&r=PG", "display_name": "Scott Newson", "link": "https://stackoverflow.com/users/346912/scott-newson"}, "edited": false, "score": 0, "creation_date": 1462334982, "post_id": 37018008, "comment_id": 61588011, "body": "Still not sure why you are getting the pattern you observe (odd index elements always in the same spot), as both Chris and I are not getting that behavior."}], "tags": [], "owner": {"reputation": 2405, "user_id": 346912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c0946fdf28e7126132cdbe315055bd?s=128&d=identicon&r=PG", "display_name": "Scott Newson", "link": "https://stackoverflow.com/users/346912/scott-newson"}, "is_accepted": true, "score": 2, "last_activity_date": 1462334486, "last_edit_date": 1462334486, "creation_date": 1462333281, "answer_id": 37018008, "question_id": 37017507, "link": "https://stackoverflow.com/questions/37017507/randomize-a-haskell-list/37018008#37018008", "title": "Randomize a Haskell list", "body": "<p>Try running this code:</p>\n\n<pre><code>import System.Random (getStdGen, randomRIO)\nimport Data.List (permutations)\n\nrndElem :: [a] -&gt; IO Int\nrndElem xs = do\n  index &lt;- randomRIO (0, length xs - 7)\n  return index\n</code></pre>\n\n<p>and then change the 7 to a 6 to a 5 and so on.</p>\n\n<p>Hopefully this explains my question about the '2', and maybe that will help you figure out what the code is doing.</p>\n"}, {"tags": [], "owner": {"reputation": 11471, "user_id": 25427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/099d66a10b0770e6aef499c89e25845e?s=128&d=identicon&r=PG", "display_name": "Alex Gyoshev", "link": "https://stackoverflow.com/users/25427/alex-gyoshev"}, "is_accepted": false, "score": 0, "last_activity_date": 1519854615, "creation_date": 1519854615, "answer_id": 49039179, "question_id": 37017507, "link": "https://stackoverflow.com/questions/37017507/randomize-a-haskell-list/49039179#49039179", "title": "Randomize a Haskell list", "body": "<p>A pretty nice algorithm for randomizing finite lists is the <a href=\"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\" rel=\"nofollow noreferrer\">Fisher-Yates shuffle, aka Knuth shuffle</a>. Here's the <a href=\"https://rosettacode.org/wiki/Knuth_shuffle#Haskell\" rel=\"nofollow noreferrer\">Haskell version</a> from Rosetta Code:</p>\n\n<pre><code>import System.Random\nimport Data.List\nimport Control.Monad\n\nmkRands = mapM (randomRIO.(,)0 ). enumFromTo 1. pred\n\nreplaceAt :: Int -&gt; a -&gt; [a] -&gt; [a]\nreplaceAt i c l = let (a,b) = splitAt i l in a++c:(drop 1 b)\n\nswapElems :: (Int, Int) -&gt; [a] -&gt; [a]\nswapElems (i,j) xs | i==j = xs\n                   | otherwise = replaceAt j (xs!!i) $ replaceAt i (xs!!j) xs\n\nknuthShuffle :: [a] -&gt; IO [a]\nknuthShuffle xs =\n  liftM (foldr swapElems xs. zip [1..]) (mkRands (length xs))\n</code></pre>\n"}], "owner": {"reputation": 260, "user_id": 6269250, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49affeb2471ac18a4650bbe6ee6c1e5b?s=128&d=identicon&r=PG&f=1", "display_name": "ABlueCrayon", "link": "https://stackoverflow.com/users/6269250/abluecrayon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 1, "accepted_answer_id": 37018008, "answer_count": 2, "score": 0, "last_activity_date": 1519854615, "creation_date": 1462329606, "question_id": 37017507, "link": "https://stackoverflow.com/questions/37017507/randomize-a-haskell-list", "title": "Randomize a Haskell list", "body": "<p>I want to write a Haskell program that will \"ramdomize\" the elements in a list:</p>\n\n<pre><code>import System.Random (getStdGen, randomRIO)\nimport Data.List (permutations)\n\nrndElem :: [a] -&gt; IO a\nrndElem xs = do\n  index &lt;- randomRIO (0, length xs - 2)\n  return $ xs !! index\n\nrndPermutation :: [a] -&gt; IO [a]\nrndPermutation xs = rndElem . permutations $ xs\n</code></pre>\n\n<p>However, running this does not seem to completely randomize the list. It only randomizes every other element, for some reason, e.g. <code>[1,2,3,4,5,6]</code> --> <code>[5,2,1,4,3,6]</code>. Every run of this algorithm keeps the odd index (2, 4, 6) elements in the same spot..Is there any logic mistakes in the indexing of the above algorithm?</p>\n"}, {"tags": ["haskell", "primes"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1462327378, "post_id": 37017147, "comment_id": 61586237, "body": "Why are you checking that <code>n-1</code> is not a multiple of any possible prime? Don&#39;t you want to use <code>n</code> instead?"}, {"owner": {"reputation": 260, "user_id": 6269250, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49affeb2471ac18a4650bbe6ee6c1e5b?s=128&d=identicon&r=PG&f=1", "display_name": "ABlueCrayon", "link": "https://stackoverflow.com/users/6269250/abluecrayon"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1462327438, "post_id": 37017147, "comment_id": 61586245, "body": "@ErikR oops! you&#39;re right, good catch. That fixed it!"}], "owner": {"reputation": 260, "user_id": 6269250, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49affeb2471ac18a4650bbe6ee6c1e5b?s=128&d=identicon&r=PG&f=1", "display_name": "ABlueCrayon", "link": "https://stackoverflow.com/users/6269250/abluecrayon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462326875, "creation_date": 1462326875, "question_id": 37017147, "link": "https://stackoverflow.com/questions/37017147/compute-prime-in-haskell", "title": "Compute prime in haskell", "body": "<p>I wish to compute whether a given integer is prime in Haskell:</p>\n\n<pre><code>--primes\nisPrime :: (Integral a) =&gt; a -&gt; Bool\nisPrime n | n &lt; 4 = n &gt; 1\nisPrime n = all ((/=0).mod (n-1)) $ 2:3:[x + i | x &lt;- [6,12..s], i &lt;- [-1,1]]\n            where s = floor $ sqrt $ fromIntegral n\n</code></pre>\n\n<p>However, running this on the input <code>131</code> gives <code>False</code>. I think the error lies in modular arithmetic but I'm not sure. Is there anything wrong with the modular statement in my program?</p>\n"}, {"tags": ["haskell", "data-kinds", "servant"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1462340540, "post_id": 37016836, "comment_id": 61589848, "body": "Do a bit of programming in a dependently-typed language like Agda or Idris, and that will give you a solid toolset for doing type-level programming like here. Much better than just reading about <code>Nat</code> and <code>Nat</code>-indexed <code>Vect</code>."}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 3, "last_activity_date": 1462340474, "creation_date": 1462340474, "answer_id": 37019349, "question_id": 37016836, "link": "https://stackoverflow.com/questions/37016836/deciphering-datakind-type-promotion-in-servant-library/37019349#37019349", "title": "Deciphering DataKind type promotion in Servant library", "body": "<p>With <code>DataKinds</code> turned on, you get new types that are automatically created based on regular data type definitions:</p>\n\n<ul>\n<li>If you have <code>data A = B T | C U</code>, you now get a new kind <code>A</code> and new types <code>'B :: T -&gt; A</code> and <code>'C :: U -&gt; A</code>, where <code>T</code> and <code>U</code> are the new kinds of the similarly lifted <code>T</code> and <code>U</code> types</li>\n<li>If there is no ambiguity, you can write <code>B</code> for <code>'B</code> etc.</li>\n<li>Type-level strings all share the same kind <code>Symbol</code>, so you have e.g. <code>\"foo\" :: Symbol</code> and <code>\"bar\" :: Symbol</code> as valid types.</li>\n</ul>\n\n<p>In your example, <code>\"users\"</code> and <code>\"sortby\"</code> are both types at kind <code>Symbol</code>, <code>JSON</code> is an (old-fashioned) type at kind <code>*</code> (defined <a href=\"https://hackage.haskell.org/package/servant-0.7/docs/Servant-API-ContentTypes.html#t:JSON\" rel=\"nofollow\">here</a>), and <code>'[JSON]</code> is a type at kind <code>[*]</code>, i.e. it is a singleton type-level list (it is equivalent to <code>JSON ': '[]</code> the same way <code>[x]</code> is equivalent to <code>x:[]</code> in general). </p>\n\n<p>The <code>[User]</code> type is a regular type at kind <code>*</code>; it is simply the type of lists of <code>User</code>s. It is not a singleton type-level list.</p>\n"}, {"comments": [{"owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 1, "creation_date": 1462347401, "post_id": 37020799, "comment_id": 61593333, "body": "Great answer! This can be complemented with <a href=\"http://www.well-typed.com/blog/2015/11/implementing-a-minimal-version-of-haskell-servant/\" rel=\"nofollow noreferrer\">implementing a minimal version of haskell servant</a> and <a href=\"http://www.arow.info/blog/posts/2015-07-10-servant-intro.html\" rel=\"nofollow noreferrer\">Servant, Type Families, and Type-level Everything</a>."}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 14, "last_activity_date": 1462346608, "last_edit_date": 1462346608, "creation_date": 1462345817, "answer_id": 37020799, "question_id": 37016836, "link": "https://stackoverflow.com/questions/37016836/deciphering-datakind-type-promotion-in-servant-library/37020799#37020799", "title": "Deciphering DataKind type promotion in Servant library", "body": "<h2>Let's build a Servant</h2>\n\n<h3>Goals</h3>\n\n<p>Our goals will be Servant's goals:</p>\n\n<ul>\n<li>Specify our REST API as a single type <code>API</code></li>\n<li>Implement the service as one single side-effectful (read: monadic)\nfunction</li>\n<li>Use real types to model resources, only serializing to a lesser type\nat the very end e.g. JSON or Bytestring</li>\n<li>Obey the common WAI (Web Application Interface) interface that most\nHaskell HTTP frameworks use</li>\n</ul>\n\n<h3>Crossing the threshold</h3>\n\n<p>Our initial service will simply be a <code>/</code> that returns a list of\n<code>User</code>s in JSON.</p>\n\n<pre><code>-- Since we do not support HTTP verbs yet we will go with a Be\ndata User = ...\ndata Be a\ntype API = Be [User]\n</code></pre>\n\n<p>Though we have yet to write a single line of value-level code, we have\nalready sufficiently represented our REST service \u2013 we have simply\ncheated and done it at the type level. This feels exciting to us and,\nfor the first time in a long time, we are hopeful about web\nprogramming again.</p>\n\n<p>We will need a way to convert this to a WAI <code>type Application =\nRequest -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived</code>.\nThere is not enough room to describe how WAI works. The basics: we are\ngiven a request object and a way to construct response objects, and we\nare expected to return a response object. There are lots of ways of\ndoing this, but a simple choice is this.</p>\n\n<pre><code>imp :: IO [User]\nimp =\n  return [ User { hopes = [\"ketchup\", \"eggs\"], fears = [\"xenophobia\", \"reactionaries\"] }\n         , User { hopes = [\"oldies\", \"punk\"], fears = [\"half-tries\", \"equivocation\"] }\n         ]\n\nserve :: ToJSON a =&gt; Be a -&gt; IO a -&gt; Application\nserve _ contentIO = \\request respond -&gt; do\n  content &lt;- contentIO\n  respond (responseLBS status200 [] (encode content))\n\nmain :: IO ()\nmain = run 2016 (serve undefined imp)\n</code></pre>\n\n<p>And this actually works. We can run this and curl it and get the\nexpected response back.</p>\n\n<pre><code>% curl 'http://localhost:2016/'\n[{\"fears\":[\"xenophobia\",\"reactionaries\"],\"hopes\":[\"ketchup\",\"eggs\"]},{\"fears\":[\"half-tries\",\"equivocation\"],\"hopes\":[\"oldies\",\"punk\"]}]%\n</code></pre>\n\n<p>Notice that we never constructed a value of type <code>Be a</code>. We used\n<code>undefined</code>. The function itself ignores the parameter altogether.\nThere actually is no way of constructing a value of type <code>Be a</code> since\nwe never defined any data constructors.</p>\n\n<p>Why even have <code>Be a</code> parameter? The poor simple truth is that we need\nthat <code>a</code> variable. It tells us what our content type will be, and it\nlets us set up that sweet Aeson constraint.</p>\n\n<p>Code: <a href=\"https://gist.github.com/hlian/c90b9b7bf845255292fb65d41f43ad21\">0Main.hs</a>.</p>\n\n<h2>:&lt;|>s in the road</h2>\n\n<p>Now we challenge ourselves to devise a routing system, where we can\nhave separate resources at separate places in the fake URL folder\nhierachy. Our goal will be to support this type of service:</p>\n\n<pre><code>type API =\n       \"users\" :&gt; Be [User]\n  :&lt;|&gt; \"temperature\" :&gt; Int\n</code></pre>\n\n<p>To do this, we will first need to turn on the <code>TypeOperators</code> and the\n<code>DataKinds</code> extensions. As detailed in @Cactus's answer, data kinds\nallows us to store data at the type level and GHC comes built-in with\ntype-level string literals. (Which is great since defining strings at\ntype level is not my idea of fun.)</p>\n\n<p>(We will also need <code>PolyKinds</code> so GHC can kind-infer this type. Yes we\nare deep in the heart of extensions jungle now.)</p>\n\n<p>Then, we need to conjure clever definitions for <code>:&gt;</code> (the subdirectory\noperator) and <code>:&lt;|&gt;</code> (the disjunction operator).</p>\n\n<pre><code>data path :&gt; rest\ndata left :&lt;|&gt; right =\n  left :&lt;|&gt; right\n\ninfixr 9 :&gt;\ninfixr 8 :&lt;|&gt;\n</code></pre>\n\n<p>Did I say clever? I meant dead simple. Notice that we have given\n<code>:&lt;|&gt;</code> a type constructor. This is because we will glue our monadic\nfunctions together to implement a disjunction and ... oh it's just\neasier to given an example.</p>\n\n<pre><code>imp :: IO [User] :&lt;|&gt; IO Int\nimp =\n  users :&lt;|&gt; temperature\n  where\n    users =\n      return [ User [\"ketchup\", \"eggs\"] [\"xenophobia\", \"reactionaries\"]\n             , User [\"oldies\", \"punk\"] [\"half-tries\", \"equivocation\"]\n             ]\n    temperature =\n      return 72\n</code></pre>\n\n<p>Now let us turn our attention to the special problem of <code>serve</code>. No\nlonger can we write a function <code>serve</code> that relies on the API being a\n<code>Be a</code>. Now that we have a little DSL at the type level for RESTful\nservices, it would be nice if we could somehow pattern match on the\ntypes and implement a different <code>serve</code> for <code>Be a</code>, <code>path :&gt; rest</code>,\nand <code>left :&lt;|&gt; right</code>. And there is!</p>\n\n<pre><code>class ToApplication api where\n  type Content api\n  serve :: api -&gt; Content api -&gt; Application\n\ninstance ToJSON a =&gt; ToApplication (Be a) where\n  type Content (Be a) = IO a\n  serve _ contentM = \\request respond -&gt; do\n    content &lt;- contentM\n    respond . responseLBS status200 [] . encode $ content\n</code></pre>\n\n<p>Note the usage of associated data types here (which in turn require us\nto turn on either <code>TypeFamilies</code> or <code>GADTs</code>). Though a <code>Be a</code> endpoint\nhas an implementation with type <code>IO a</code>, this will not be sufficient to\nimplement disjunction. As underpaid and lazy functional programmers we\nwill simply throw another layer of abstraction and define a type-level\nfunction called <code>Content</code> that takes a type <code>api</code> and returns a type\n<code>Content api</code>.</p>\n\n<pre><code>instance Exception RoutingFailure where\n\ndata RoutingFailure =\n  RoutingFailure\n  deriving (Show)\n\ninstance (KnownSymbol path, ToApplication rest) =&gt; ToApplication (path :&gt; rest) where\n  type Content (path :&gt; rest) = Content rest\n  serve _ contentM = \\request respond -&gt; do\n    case pathInfo request of\n      (first:pathInfoTail)\n        | view unpacked first == symbolVal (Proxy :: Proxy path) -&gt; do\n            let subrequest = request { pathInfo = pathInfoTail }\n            serve (undefined :: rest) contentM subrequest respond\n      _ -&gt;\n        throwM RoutingFailure\n</code></pre>\n\n<p>We can break down the lines of code here:</p>\n\n<ul>\n<li><p>We guarantee a <code>ToApplication</code> instance for <code>path :&gt; rest</code> if the\ncompiler can guarantee that <code>path</code> is a type-level symbol (meaning\nit can [among other things] be mapped down to a <code>String</code> with\n<code>symbolVal</code>) <em>and</em> that <code>ToApplication rest</code> exists.</p></li>\n<li><p>When the request arrives, we pattern match on <code>pathInfos</code> to to\ndetermine success. On failure, we will do the lazy thing and throw\nan unchecked exception in <code>IO</code>.</p></li>\n<li><p>On success, we will <em>recurse at the type level</em> (cue laser noises\nand fog machine) with <code>serve (undefined :: rest)</code>. Note that <code>rest</code>\nis a \"smaller\" type than <code>path :&gt; rest</code>, much like how when you\npattern match on a data constructor you end up with a \"smaller\"\nvalue.</p></li>\n<li><p>Before recursing we whittle down the HTTP request with a convenient\nrecord update.</p></li>\n</ul>\n\n<p>Note that:</p>\n\n<ul>\n<li><p><code>type Content</code> function maps <code>path :&gt; rest</code> to <code>Content rest</code>.\nAnother form of recursion at the type level! Also note that this\nimplies that an extra path in the route does not change the type of\nthe resource. This matches our intuition.</p></li>\n<li><p>Throwing an exception in IO is not Great Library Design\u2122, but I will\nleave it up to you to fix that problem. (Hint:\n<code>ExceptT</code>/<code>throwError</code>.)</p></li>\n<li><p>Hopefully we are slowly motivating the usage of <code>DataKinds</code> here\nwith string symbols. Being able to represent strings at the type\nlevel has enabled us to use types to pattern match routing at the\ntype level.</p></li>\n<li><p>I use lenses to pack and unpack. It is just faster for me to hack up\nthese SO answers with lenses, but of course you could just use\n<code>pack</code> from the <code>Data.Text</code> library.</p></li>\n</ul>\n\n<p>All right. One more instance. Breathe. Take a break.</p>\n\n<pre><code>instance (ToApplication left, ToApplication right) =&gt; ToApplication (left :&lt;|&gt; right) where\n  type Content (left :&lt;|&gt; right) = Content left :&lt;|&gt; Content right\n  serve _ (leftM :&lt;|&gt; rightM) = \\request respond -&gt; do\n    let handler (_ :: RoutingFailure) =\n          serve (undefined :: right) rightM request respond\n    catch (serve (undefined :: left) leftM request respond) handler\n</code></pre>\n\n<p>In this instance we</p>\n\n<ul>\n<li><p>Guarantee <code>ToApplication (left :&lt;|&gt; right)</code> if the compiler can\nguarantee blah blah blah you get it.</p></li>\n<li><p>Introduce another entry in the <code>type Content</code> function. Here is the\nline of code that lets us build up to a type of <code>IO [User] :&lt;|&gt; IO\nInt</code> and have the compiler successfully break it up in the course of\ninstance resolution.</p></li>\n<li><p>Catch the exception we threw above! When an exception happens on the\nleft, we go to the right. Again, this is not Great Library Design\u2122.</p></li>\n</ul>\n\n<p>Run <a href=\"https://gist.github.com/hlian/c90b9b7bf845255292fb65d41f43ad21\">1Main.hs</a> and you should be able to <code>curl</code> like this.</p>\n\n<pre><code>% curl 'http://localhost:2016/users'\n[{\"fears\":[\"xenophobia\",\"reactionaries\"],\"hopes\":[\"ketchup\",\"eggs\"]},{\"fears\":[\"half-tries\",\"equivocation\"],\"hopes\":[\"oldies\",\"punk\"]}]%\n\n% curl 'http://localhost:2016/temperature'\n72%\n</code></pre>\n\n<h2>Give and take</h2>\n\n<p>Now let us demo a usage for type-level lists, another feature of\n<code>DataKinds</code>. We will augment our <code>data Be</code> to store a list of types\nthat the endpoint can give out.</p>\n\n<pre><code>data Be (gives :: [*]) a\n\ndata English\ndata Haskell\ndata JSON\n\n-- | The type of our RESTful service\ntype API =\n       \"users\" :&gt; Be [JSON, Haskell] [User]\n  :&lt;|&gt; \"temperature\" :&gt; Be [JSON, English] Int\n</code></pre>\n\n<p>Let us also define a typeclass that matches the list of what types an\nendpoint can give with the list of MIME types that the HTTP request\ncan accept. We will use <code>Maybe</code> to denote failure here. Again, not\nGreat Library Design\u2122.</p>\n\n<pre><code>class ToBody (gives :: [*]) a where\n  toBody :: Proxy gives -&gt; [ByteString] -&gt; a -&gt; Maybe ByteString\n\nclass Give give a where\n  give :: Proxy give -&gt; [ByteString] -&gt; a -&gt; Maybe ByteString\n</code></pre>\n\n<p>Why two separate typeclasses? Well, we need one for the kind <code>[*]</code>,\nwhich is the kind for a list of types, and one for the kind <code>*</code>, which\nis the kind of just a single type. Just like you cannot define a\nfunction that takes for an argument something that is both a list and\na non-list (as it will not type-check), we cannot define a typeclass\nthat takes for an argument something that is both a type-level list\nand a type-level non-list (as it will not kind-check). If only we had\nkindclasses...</p>\n\n<p>Let's see this typeclass in action:</p>\n\n<pre><code>instance (ToBody gives a) =&gt; ToApplication (Be gives a) where\n  type Content (Be gives a) = IO a\n  serve _ contentM = \\request respond -&gt; do\n    content &lt;- contentM\n    let accepts = [value | (\"accept\", value) &lt;- requestHeaders request]\n    case toBody (Proxy :: Proxy gives) accepts content of\n      Just bytes -&gt;\n        respond (responseLBS status200 [] (view lazy bytes))\n      Nothing -&gt;\n        respond (responseLBS status406 [] \"bad accept header\")\n</code></pre>\n\n<p>Very nice. We use <code>toBody</code> as a way of abstracting out the computation\nof converting the value of type <code>a</code> into the underlying bytes that WAI\nwants. On failure we will simply error out with 406, one of the more\nesoteric (and therefore more fun to use) status codes.</p>\n\n<p>But wait, why use type-level lists in the first place at all? Because\nas we did before we are going to pattern-match on its two\nconstructors: nil and cons.</p>\n\n<pre><code>instance ToBody '[] a where\n  toBody Proxy _ _ = Nothing\n\ninstance (Give first a, ToBody rest a) =&gt; ToBody (first ': rest) a where\n  toBody Proxy accepted value =\n    give (Proxy :: Proxy first) accepted value\n      &lt;|&gt; toBody (Proxy :: Proxy rest) accepted value\n</code></pre>\n\n<p>Hopefully this sort of makes sense. Failure occurs when the list runs\nempty before we find a match; <code>&lt;|&gt;</code> guarantees we will short-circuit\non success; <code>toBody (Proxy :: Proxy rest)</code> is the recursive case.</p>\n\n<p>We will need some fun <code>Give</code> instances to play with.</p>\n\n<pre><code>instance ToJSON a =&gt; Give JSON a where\n  give Proxy accepted value =\n    if elem \"application/json\" accepted then\n      Just (view strict (encode value))\n    else\n      Nothing\n\ninstance (a ~ Int) =&gt; Give English a where\n  give Proxy accepted value =\n    if elem \"text/english\" accepted then\n      Just (toEnglish value)\n    else\n      Nothing\n    where\n      toEnglish 0 = \"zero\"\n      toEnglish 1 = \"one\"\n      toEnglish 2 = \"two\"\n      toEnglish 72 = \"seventy two\"\n      toEnglish _ = \"lots\"\n\ninstance Show a =&gt; Give Haskell a where\n  give Proxy accepted value =\n    if elem \"text/haskell\" accepted then\n      Just (view (packed . re utf8) (show value))\n    else\n      Nothing\n</code></pre>\n\n<p>Run the server again and you should be able to <code>curl</code> like this:</p>\n\n<pre><code>% curl -i 'http://localhost:2016/users' -H 'Accept: application/json'\nHTTP/1.1 200 OK\nTransfer-Encoding: chunked\nDate: Wed, 04 May 2016 06:56:10 GMT\nServer: Warp/3.2.2\n\n[{\"fears\":[\"xenophobia\",\"reactionaries\"],\"hopes\":[\"ketchup\",\"eggs\"]},{\"fears\":[\"half-tries\",\"equivocation\"],\"hopes\":[\"oldies\",\"punk\"]}]%\n\n% curl -i 'http://localhost:2016/users' -H 'Accept: text/plain'\nHTTP/1.1 406 Not Acceptable\nTransfer-Encoding: chunked\nDate: Wed, 04 May 2016 06:56:11 GMT\nServer: Warp/3.2.2\n\nbad accept header%\n\n% curl -i 'http://localhost:2016/users' -H 'Accept: text/haskell'\nHTTP/1.1 200 OK\nTransfer-Encoding: chunked\nDate: Wed, 04 May 2016 06:56:14 GMT\nServer: Warp/3.2.2\n\n[User {hopes = [\"ketchup\",\"eggs\"], fears = [\"xenophobia\",\"reactionaries\"]},User {hopes = [\"oldies\",\"punk\"], fears = [\"half-tries\",\"equivocation\"]}]%\n\n% curl -i 'http://localhost:2016/temperature' -H 'Accept: application/json'\nHTTP/1.1 200 OK\nTransfer-Encoding: chunked\nDate: Wed, 04 May 2016 06:56:26 GMT\nServer: Warp/3.2.2\n\n72%\n\n% curl -i 'http://localhost:2016/temperature' -H 'Accept: text/plain'\nHTTP/1.1 406 Not Acceptable\nTransfer-Encoding: chunked\nDate: Wed, 04 May 2016 06:56:29 GMT\nServer: Warp/3.2.2\n\nbad accept header%\n\n% curl -i 'http://localhost:2016/temperature' -H 'Accept: text/english'\nHTTP/1.1 200 OK\nTransfer-Encoding: chunked\nDate: Wed, 04 May 2016 06:56:31 GMT\nServer: Warp/3.2.2\n\nseventy two%\n</code></pre>\n\n<p>Hooray!</p>\n\n<p>Note that we have stop using <code>undefined :: t</code> and switched to <code>Proxy\n:: Proxy t</code>. Both are hacks. Calling functions in Haskell lets us\nspecify values for value parameters but not types for type parameters.\nA sad asymmetry. Both <code>undefined</code> and <code>Proxy</code> are ways of encoding\ntype parameters at the value level. <code>Proxy</code> is able to do it with no\nruntime cost <em>and</em> the <code>t</code> in <code>Proxy t</code> is poly-kinded. (<code>undefined</code>\nhas type <code>*</code> so <code>undefined :: rest</code> would not even kind-check here.)</p>\n\n<h3>Remaining work</h3>\n\n<p>How can we get all the way to a full Servant competitor?</p>\n\n<ul>\n<li><p>We need to break <code>Be</code> up into <code>Get, Post, Put, Delete</code>. Note that\nsome of these verbs also now take <em>in</em> data in the form of a request\nbody. Modeling content types and request bodies at the type level\nrequires similar type-level machinery.</p></li>\n<li><p>What if the user wants to model her functions as something besides\n<code>IO</code>, such as a stack of monad transformers?</p></li>\n<li><p><a href=\"https://github.com/haskell-servant/servant/blob/a551eb6/servant-server/src/Servant/Server/Internal/RoutingApplication.hs#L41\">A more precise, yet more complicated, routing algorithm.</a></p></li>\n<li><p>Hey, now that we have a type for our API, would it be possible to\ngenerate a <em>client</em> of the service? Something that makes HTTP\nrequests to a service obeying the API description rather than\ncreating the HTTP service itself?</p></li>\n<li><p>Documentation. Making sure everybody understands what all these\ntype-level hijinks are. ;)</p></li>\n</ul>\n\n<h2>That tick mark</h2>\n\n<blockquote>\n  <p>I am also unclear what the tick mark (') means in front of '[JSON].</p>\n</blockquote>\n\n<p>The answer is obscure and stuck in <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/promotion.html\">GHC's manual in section 7.9</a>.</p>\n\n<blockquote>\n  <p>Since constructors and types share the same namespace, with promotion you can get ambiguous type names. In these cases, if you want to refer to the promoted constructor, you should prefix its name with a quote.</p>\n  \n  <p>With -XDataKinds, Haskell's list and tuple types are natively promoted to kinds, and enjoy the same convenient syntax at the type level, albeit prefixed with a quote. For type-level lists of two or more elements, such as the signature of foo2 above, the quote may be omitted because the meaning is unambiguous. But for lists of one or zero elements (as in foo0 and foo1), the quote is required, because the types [] and [Int] have existing meanings in Haskell.</p>\n</blockquote>\n\n<p>This, how verbose all the code we had to write above was, and much else besides is due to how type-level programming is still a second-class citizen in Haskell unlike in dependently-typed languages (Agda, Idris, Coq). The syntax is weird, the extensions are many, the documentation is sparse, the errors are nonsense, but boy oh boy type-level programming is fun.</p>\n"}], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 2, "accepted_answer_id": 37019349, "answer_count": 2, "score": 7, "last_activity_date": 1462347601, "creation_date": 1462324319, "last_edit_date": 1462347601, "question_id": 37016836, "link": "https://stackoverflow.com/questions/37016836/deciphering-datakind-type-promotion-in-servant-library", "title": "Deciphering DataKind type promotion in Servant library", "body": "<p>I am trying to gork the <a href=\"http://haskell-servant.readthedocs.io/en/stable/index.html\" rel=\"noreferrer\">tutorial</a> for the <a href=\"https://hackage.haskell.org/package/servant-0.7\" rel=\"noreferrer\">servant</a> library, a type-level web DSL. The library makes extensive use of the <a href=\"https://downloads.haskell.org/~ghc/7.6.2/docs/html/users_guide/promotion.html\" rel=\"noreferrer\"><code>DataKind</code></a> language extension.</p>\n\n<p>Early in that that tutorial we find the following line which defines a web service end point:</p>\n\n<pre><code>type UserAPI = \"users\" :&gt; QueryParam \"sortby\" SortBy :&gt; Get '[JSON] [User]\n</code></pre>\n\n<p>I don't understand what it means to have string and arrays in a type signature.  I am also unclear what the tick mark (<code>'</code>) means in front of <code>'[JSON]</code>.</p>\n\n<p>So my questions boil down to what is the type/kind of the string and arrays, and how is this <a href=\"http://haskell-servant.readthedocs.io/en/stable/tutorial/Server.html\" rel=\"noreferrer\">later</a> interpreted when it is turned into a WAI end point?</p>\n\n<hr>\n\n<p>As a side note, the consistent use of <code>Nat</code> and <code>Vect</code> when describing <code>DataKinds</code> leave us with a frustratingly limited set of examples to look at when trying to understand this stuff. I think I've read through that example at least a dozen times at different places and I still don't feel like I understand what is going on. </p>\n"}, {"tags": ["haskell", "functional-programming", "demorgans-law", "curry-howard"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 1, "creation_date": 1462323275, "post_id": 37016673, "comment_id": 61585292, "body": "I&#39;d tend to suspect that you&#39;re applying the isomorphism incorrectly."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 1, "creation_date": 1462323681, "post_id": 37016673, "comment_id": 61585389, "body": "I don&#39;t think I&#39;m applying the isomorphism incorrectly. Could you elaborate?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1462352774, "post_id": 37016673, "comment_id": 61596775, "body": "Note that these formulas are purely propositional (no quantifiers around). Since propositional intuitionistic logic is decidable, you can solve these problems using a theorem prover (e.g. Djinn). If the prover fails, then it surely is a non intuitionistic tautology."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1462403510, "post_id": 37016673, "comment_id": 61629041, "body": "Think about what this &quot;law&quot; could possibly mean, computationally. It says, &quot;whenever a conjunction is false, you can <i>find out</i> which conjunct is false&quot;. E.g., we know <code>(a, a -&gt; c) -&gt; c</code>, so de Morgan tells us we can decide any proposition <code>a</code>, solve the Halting Problem, you name it. Even if Haskell&#39;s polymorphism were not parametric, that would be a rather big ask. But with parametric polymorphism, this &quot;law&quot; has to decide an arbitrary proposition without knowing what the proposition is."}], "answers": [{"comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 1, "creation_date": 1462335839, "post_id": 37017811, "comment_id": 61588240, "body": "The only problem is that you can&#39;t construct a proof for the law of the excluded middle. You can only construct a proof for the law of the excluded middle not being false. I guess this can&#39;t be done in constructive type theory."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1462352596, "post_id": 37017811, "comment_id": 61596638, "body": "It&#39;s nice to discover that there&#39;s a wikibook article about myself. And on top of that, it&#39;s about one of the coolest topics I&#39;ve ever found! ;-P"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 5, "last_activity_date": 1466503297, "last_edit_date": 1466503297, "creation_date": 1462332100, "answer_id": 37017811, "question_id": 37016673, "link": "https://stackoverflow.com/questions/37016673/de-morgans-laws-in-haskell-via-the-curry-howard-correspondence/37017811#37017811", "title": "De Morgan&#39;s Laws in Haskell via the Curry-Howard Correspondence", "body": "<p>One thing that stands out to me is that you don't seem to be using the definition or any property of negation anywhere.</p>\n\n<p>After reading the <a href=\"https://en.wikibooks.org/wiki/Haskell/The_Curry%E2%80%93Howard_isomorphism#Negation\" rel=\"nofollow\">Haskell Wikibooks article on the CHI</a> here is a proof assuming that you have a law of the excluded middle as a theorem:</p>\n\n<pre><code>exc_middle :: Either a (a -&gt; Void)\n</code></pre>\n\n<p>and the proof of the <code>notAandB</code> de Morgan law would go like:</p>\n\n<pre><code>notAandB' :: Either a (a -&gt; Void) -&gt; ((a,b) -&gt; Void) -&gt; Either (a -&gt; Void) (b -&gt; Void)\nnotAandB' (Right notA) _ = Left notA\nnotAandB' (Left a)     f = Right (\\b -&gt; f (a,b))\n\nnotAandB = notAandB' exc_middle\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 6, "last_activity_date": 1462339160, "last_edit_date": 1492085955, "creation_date": 1462332111, "answer_id": 37017815, "question_id": 37016673, "link": "https://stackoverflow.com/questions/37016673/de-morgans-laws-in-haskell-via-the-curry-howard-correspondence/37017815#37017815", "title": "De Morgan&#39;s Laws in Haskell via the Curry-Howard Correspondence", "body": "<p>The fourth law is <a href=\"https://math.stackexchange.com/a/120209/4712\">not intuitionistic</a>. You'll need the axiom of excluded middle:</p>\n\n<pre><code>lem :: Either a (a -&gt; c)\n</code></pre>\n\n<p>or Pierce's law:</p>\n\n<pre><code>pierce :: ((a -&gt; c) -&gt; c) -&gt; a\n</code></pre>\n\n<p>to prove it.</p>\n"}], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 2, "accepted_answer_id": 37017811, "answer_count": 2, "score": 2, "last_activity_date": 1466503297, "creation_date": 1462322879, "last_edit_date": 1462330126, "question_id": 37016673, "link": "https://stackoverflow.com/questions/37016673/de-morgans-laws-in-haskell-via-the-curry-howard-correspondence", "title": "De Morgan&#39;s Laws in Haskell via the Curry-Howard Correspondence", "body": "<p>I implemented three of the four De Morgan's Laws in Haskell:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>notAandNotB :: (a -&gt; c, b -&gt; c) -&gt; Either a b -&gt; c\nnotAandNotB (f, g) (Left x)  = f x\nnotAandNotB (f, g) (Right y) = g y\n\nnotAorB :: (Either a b -&gt; c) -&gt; (a -&gt; c, b -&gt; c)\nnotAorB f = (f . Left, f . Right)\n\nnotAorNotB :: Either (a -&gt; c) (b -&gt; c) -&gt; (a, b) -&gt; c\nnotAorNotB (Left f)  (x, y) = f x\nnotAorNotB (Right g) (x, y) = g y\n</code></pre>\n\n<p>However, I don't suppose that it's possible to implement the last law (which has two inhabitants):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>notAandBLeft  :: ((a, b) -&gt; c) -&gt; Either (a -&gt; c) (b -&gt; c)\nnotAandBLeft  f = Left  (\\a -&gt; f (a, ?))\n\nnotAandBRight :: ((a, b) -&gt; c) -&gt; Either (a -&gt; c) (b -&gt; c)\nnotAandBRight f = Right (\\b -&gt; f (?, b))\n</code></pre>\n\n<p>The way I see it, there are two possible solutions:</p>\n\n<ol>\n<li>Use <code>undefined</code> in place of <code>?</code>. This is not a good solution because it's cheating.</li>\n<li><p>Either use monomorphic types or bounded polymorphic types to encode a default value.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>notAandBLeft  :: Monoid b =&gt; ((a, b) -&gt; c) -&gt; Either (a -&gt; c) (b -&gt; c)\nnotAandBLeft  f = Left  (\\a -&gt; f (a, mempty))\n\nnotAandBRight :: Monoid a =&gt; ((a, b) -&gt; c) -&gt; Either (a -&gt; c) (b -&gt; c)\nnotAandBRight f = Right (\\b -&gt; f (mempty, b))\n</code></pre>\n\n<p>This is not a good solution because it's a weaker law than De Morgan's law.</p></li>\n</ol>\n\n<p>We know that De Morgan's laws are correct but am I correct in assuming that the last law can't be encoded in Haskell? What does this say about the Curry-Howard Isomorphism? It's not really an isomorphism if every proof can't be converted into an equivalent computer program, right?</p>\n"}, {"tags": ["javascript", "python", "haskell", "compilation", "executable"], "comments": [{"owner": {"reputation": 137853, "user_id": 615754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SiiYj.jpg?s=128&g=1", "display_name": "nnnnnn", "link": "https://stackoverflow.com/users/615754/nnnnnn"}, "edited": false, "score": 3, "creation_date": 1462316704, "post_id": 37015789, "comment_id": 61583635, "body": "How do you compile a Javascript file into an executable?"}, {"owner": {"reputation": 574451, "user_id": 816620, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Xu7hp.jpg?s=128&g=1", "display_name": "jfriend00", "link": "https://stackoverflow.com/users/816620/jfriend00"}, "edited": false, "score": 3, "creation_date": 1462318071, "post_id": 37015789, "comment_id": 61584003, "body": "Good luck with that.  Probably easier to rewrite them to be in one language."}, {"owner": {"reputation": 149, "user_id": 3700129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb3981ed6b4802d918f1cad66c16a7c?s=128&d=identicon&r=PG&f=1", "display_name": "user3700129", "link": "https://stackoverflow.com/users/3700129/user3700129"}, "reply_to_user": {"reputation": 137853, "user_id": 615754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SiiYj.jpg?s=128&g=1", "display_name": "nnnnnn", "link": "https://stackoverflow.com/users/615754/nnnnnn"}, "edited": false, "score": 0, "creation_date": 1462319631, "post_id": 37015789, "comment_id": 61584441, "body": "@nnnnnn <a href=\"http://enclosejs.com/\" rel=\"nofollow noreferrer\">enclosejs.com</a> enclosejs is a javascript compiler"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1462320792, "post_id": 37015789, "comment_id": 61584724, "body": "What does &quot;calls&quot; mean here exactly?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462352317, "post_id": 37015789, "comment_id": 61596469, "body": "Maybe you can use the Haskell FFI to provide access (import/export) of C-level bindings. If your compiler can produce object files with C-level bindings, you can use a linker to link them together (and link the Haskell/js runtime too). You will probably need to write export/import code in both languages. Overall, it looks quite tricky -- a lot of work, with no real guarantee on the result."}], "owner": {"reputation": 149, "user_id": 3700129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb3981ed6b4802d918f1cad66c16a7c?s=128&d=identicon&r=PG&f=1", "display_name": "user3700129", "link": "https://stackoverflow.com/users/3700129/user3700129"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462316482, "creation_date": 1462316482, "question_id": 37015789, "link": "https://stackoverflow.com/questions/37015789/if-there-is-multiple-file-written-in-different-languages-how-to-compile-into-on", "title": "If there is multiple file written in different languages, how to compile into one file?", "body": "<p>I have a Haskell program that calls another javascript file and another python file. I can compile each one of them into an executable. But I am interested in compiling all of them into one file. Is it possible? </p>\n"}, {"tags": ["variables", "haskell", "indexing", "linear-equation"], "comments": [{"owner": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462325080, "post_id": 37015327, "comment_id": 61585731, "body": "Are you looking for this <code>[(x,y,z,n) |n&lt;-[0..12], x&lt;-[0..3], y&lt;-[0..3], z&lt;-[0..3], x+4*y+9*z==n ]</code> or <code>[(x,y,z,n) |n&lt;-[0..12], x&lt;-[0..n], y&lt;-[0..n], z&lt;-[0..n], x+4*y+9*z==n ]</code> ?"}, {"owner": {"reputation": 3, "user_id": 4813229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c4d8d336fe1b6462c007bf878030c7?s=128&d=identicon&r=PG", "display_name": "Miguel Rom&#225;n", "link": "https://stackoverflow.com/users/4813229/miguel-rom%c3%a1n"}, "reply_to_user": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462329725, "post_id": 37015327, "comment_id": 61586775, "body": "I need more variables. The amount of variables is the same as the cardinality of the set A.  If the set A is let say A =[ 1, 2, 3 ,4 ,6]. Then the equation is a+ 2b + 9c+ 16d+ 36e = n."}, {"owner": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462336599, "post_id": 37015327, "comment_id": 61588496, "body": "How much further you need the cardinality go?"}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1462334972, "creation_date": 1462334972, "answer_id": 37018275, "question_id": 37015327, "link": "https://stackoverflow.com/questions/37015327/solving-and-producing-and-equation-with-variables-indexed-by-a-given-set-haskel/37018275#37018275", "title": "Solving and producing and equation with variables indexed by a given set (Haskell)", "body": "<p>Some hints:</p>\n\n<p>Ultimately you want to write a function with this signature:</p>\n\n<pre><code>solutions :: Int -&gt; [Int] -&gt; [ [Int] ]\n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>solutions 4 [1,2]  == [ [4,0], [0,1] ]\n  -- two solutions: 4 = 4*1^2 + 0*2^2,  4 = 0*1^2 + 1*2^2\n\nsolutions 22 [2,3]  == [ [1,2] ]\n  -- just one solution: 22 = 1*2^2 + 2*3^2\n\nsolutions 10 [2,3]  == [ ]\n  -- no solutions\n</code></pre>\n\n<p>Step 2. Define <code>solutions</code> recursively based on the structure of the list:</p>\n\n<pre><code>solutions x [a] = ...\n  -- This will either be [] or a single element list\n\nsolutions x (a:as) = ...\n  -- Hint: you will use `solutions ... as` here\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462337215, "post_id": 37018414, "comment_id": 61588720, "body": "The cardinality of set A doesn&#39;t change at all, and even &#39;n&#39; is fixed."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462339155, "post_id": 37018414, "comment_id": 61589332, "body": "@nobody you should read the question: &quot;My problem is if n is not fixed and also the set A are not fixed.&quot;"}, {"owner": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462339278, "post_id": 37018414, "comment_id": 61589380, "body": "I mean your solution&#39;s set A and &#39;n&#39; do not change."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462339388, "post_id": 37018414, "comment_id": 61589437, "body": "sorry I have no clue what you are talking about - the two examples use different <code>n</code> and different <code>A</code>s"}, {"owner": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462339785, "post_id": 37018414, "comment_id": 61589577, "body": "The author needs the set A to be a set of base variable that could be change by square, if I didn&#39;t get his idea wrong."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462340004, "post_id": 37018414, "comment_id": 61589654, "body": "again - for <code>n=12</code> and <code>A=[1,2,3]</code> which is one of OPs example above produces the same result as the given comprehension <code>[(x,y,z) | x&lt;-[0..12], y&lt;-[0..12], z&lt;-[0..12], x+4*y+9*z==12]</code> - and I&#39;m sorry but I really don&#39;t understand what &quot;change by square&quot; is supposed to be here"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462340159, "post_id": 37018414, "comment_id": 61589717, "body": "his idea was pretty clear - solve &quot;n = Sum d_i^2 x_i&quot; for given <code>d_i</code>s and <code>n</code> for <code>x_i</code> and above will do exactly this - the resulting lists will be the <code>x_i</code> - you can test it : <code>2^2 * 3 + 3^2 * 1 + 4^2 * 1 + 6^2 * 0 =  37</code> which is a solution for <code>n=37</code> and <code>A = [2,3,4,6]</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462340251, "post_id": 37018414, "comment_id": 61589746, "body": "aside from him mistaking 2^2=2 instead of 4 that is exactly what I am doing here - the <i>cardinality</i> of the resulting lists will be the same as of <code>A</code> (where cardinality is just list-length)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1462340467, "post_id": 37018414, "comment_id": 61589825, "body": "the only difference here is that here the produced solutions are represented by lists instead of tuples - which should be expected as the length depend on the length of the input and you would need heavy hitters (dependent types) to get tuples with the right length out of this"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1462336690, "last_edit_date": 1462336690, "creation_date": 1462335743, "answer_id": 37018414, "question_id": 37015327, "link": "https://stackoverflow.com/questions/37015327/solving-and-producing-and-equation-with-variables-indexed-by-a-given-set-haskel/37018414#37018414", "title": "Solving and producing and equation with variables indexed by a given set (Haskell)", "body": "<p>Instead of a list-comprehension you can use a recursive call with <code>do</code>-notation for the list-monad.</p>\n\n<p>It's a bit more tricky as you have to handle the edge-cases correctly and I allowed myself to optimize a bit:</p>\n\n<pre><code>solve :: Integer -&gt; [Integer] -&gt; [[Integer]]\nsolve 0 ds = [replicate (length ds) 0]\nsolve _ [] = []\nsolve n (d:ds) = do\n  let maxN = floor $ fromIntegral n / fromIntegral (d^2)\n  x &lt;- [0..maxN]\n  xs &lt;- solve (n - x * d^2) ds\n  return (x:xs)\n</code></pre>\n\n<p>it works like this:</p>\n\n<ul>\n<li>It's keeping track of the remaining sum in the first argument</li>\n<li>when there this sum is <code>0</code> where are obviously done and only have to return 0's (first case) - it will return a list of 0s with the same length as the <code>ds</code></li>\n<li>if the remaining sum is not <code>0</code> but there are no <code>d</code>'s left we are in trouble as there are no solutions (second case) - note that no solutions is just the empty list</li>\n<li>in every other case we have a non-zero <code>n</code> (remaining sum) and some <code>ds</code> left (third case):\n\n<ul>\n<li>now look for the maximum number that you can pick for <code>x</code> (<code>maxN</code>) remember that <code>x * d^2</code> should be <code>&lt;= n</code> so the upper limit is <code>n / d^2</code> but we are only interested in integers (so it's <code>floor</code>)</li>\n<li>try all from <code>x</code> from <code>0</code> to <code>maxN</code></li>\n<li>look for all solutions of the remaining sum when using this <code>x</code> with the remaining <code>ds</code> and pick one of those <code>xs</code></li>\n<li>combine <code>x</code> with <code>xs</code> to give a solution to the current subproblem</li>\n</ul></li>\n</ul>\n\n<p>The list-monad's bind will handle the rest for you ;)</p>\n\n<h3>examples</h3>\n\n<pre><code>\u03bb&gt; solve 12 [1,2,3]\n[[0,3,0],[3,0,1],[4,2,0],[8,1,0],[12,0,0]]\n\n\u03bb&gt; solve 37 [2,3,4,6]\n[[3,1,1,0],[7,1,0,0]]\n</code></pre>\n\n<h3>remark</h3>\n\n<p>this will fail when dealing with negative numbers - if you need those you gonna have to introduce some more cases - I'm sure you figure them out (it's really more math than Haskell at this point)</p>\n"}], "owner": {"reputation": 3, "user_id": 4813229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c4d8d336fe1b6462c007bf878030c7?s=128&d=identicon&r=PG", "display_name": "Miguel Rom&#225;n", "link": "https://stackoverflow.com/users/4813229/miguel-rom%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 1, "accepted_answer_id": 37018414, "answer_count": 2, "score": 0, "last_activity_date": 1462336690, "creation_date": 1462313767, "last_edit_date": 1462313999, "question_id": 37015327, "link": "https://stackoverflow.com/questions/37015327/solving-and-producing-and-equation-with-variables-indexed-by-a-given-set-haskel", "title": "Solving and producing and equation with variables indexed by a given set (Haskell)", "body": "<p>I want to solve the following problem in Haskell:</p>\n\n<p>Let n be a natural number and let <code>A = [d_1 , ..., d_r]</code> be a set of positive numbers.</p>\n\n<p>I want to find all the positive solutions of the following equation:</p>\n\n<p><code>n = Sum d_i^2 x_i</code>.</p>\n\n<p>For example if <code>n= 12</code> and the set <code>A= [1,2,3]</code>. I would like to solve the following equation over the natural numbers:</p>\n\n<pre><code>x+4y+9z=12.\n</code></pre>\n\n<p>It's enough to use the following code:</p>\n\n<pre><code>[(x,y,z) | x&lt;-[0..12], y&lt;-[0..12], z&lt;-[0..12], x+4*y+9*z==12]\n</code></pre>\n\n<p>My problem is if n is not fixed and also the set A are not fixed. I don't know how to \"produce\" a certain amount of variables indexed by the set A.</p>\n"}, {"tags": ["list", "haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1462312317, "post_id": 37014707, "comment_id": 61582150, "body": "Your second clause directly adresses that case. Just, it quite evidently doesn&#39;t adress it according to your specification! \u2014 Note that lists with a fixed number of elements are generally nicer constructed / deconstructed with list syntax instead of <code>:</code>, i.e. write <code>[x\u2081]</code> instead of <code>x\u2081:[]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 0, "creation_date": 1462313010, "post_id": 37015067, "comment_id": 61582416, "body": "Sorry, my english is not very good, sometimes my questions become to cryptic :) How exactly does the two patterns g2 [] (y:ys) = [] g2 (x1:xs) [] = [] solve the problem?"}, {"owner": {"reputation": 4990, "user_id": 384309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7bd479977c0b02d7a46e72d46eab0054?s=128&d=identicon&r=PG", "display_name": "Alistra", "link": "https://stackoverflow.com/users/384309/alistra"}, "reply_to_user": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 2, "creation_date": 1462313457, "post_id": 37015067, "comment_id": 61582593, "body": "I just added them to cover all cases possible, so you don&#39;t get a runtime error that your function isn&#39;t defined for such arguments. It will just return <code>[]</code> then"}, {"owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 0, "creation_date": 1462313928, "post_id": 37015067, "comment_id": 61582791, "body": "Okey i understand and is pattern matching useful if you want to create large functions? (question from a haskell beginner, sorry)"}, {"owner": {"reputation": 4990, "user_id": 384309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7bd479977c0b02d7a46e72d46eab0054?s=128&d=identicon&r=PG", "display_name": "Alistra", "link": "https://stackoverflow.com/users/384309/alistra"}, "reply_to_user": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 0, "creation_date": 1462314337, "post_id": 37015067, "comment_id": 61582934, "body": "You generally want to keep functions small, this amount of pattern matching is kind of a lot and you can easily get lost and forget about a case"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 1, "creation_date": 1462351731, "post_id": 37015067, "comment_id": 61596107, "body": "@MartinM If you enable warnings (with the <code>-Wall</code> flag) the compiler will warn about potentially non-exhaustive patterns, helping you to define a function in all cases."}], "tags": [], "owner": {"reputation": 4990, "user_id": 384309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7bd479977c0b02d7a46e72d46eab0054?s=128&d=identicon&r=PG", "display_name": "Alistra", "link": "https://stackoverflow.com/users/384309/alistra"}, "is_accepted": true, "score": 3, "last_activity_date": 1462312600, "creation_date": 1462312600, "answer_id": 37015067, "question_id": 37014707, "link": "https://stackoverflow.com/questions/37014707/haskell-two-elements-from-one-list-followed-by-one-element-other-list-pattern/37015067#37015067", "title": "Haskell, two elements from one list followed by one element other list? (pattern matching)", "body": "<p>As confusing as your question is, this is the answer:</p>\n\n<pre><code>g2 (x1:x2:xs) (y:ys) = x1:x2:y:(g2 xs ys)\ng2 (x1:[]) (y:ys) = x1:y:[]\ng2 [] [] = []\n-- Added missing patterns, don't know what the function is supposed to do here\ng2 [] (y:ys) = []\ng2 (x1:xs) [] = []\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1105, "favorite_count": 0, "accepted_answer_id": 37015067, "answer_count": 1, "score": 0, "last_activity_date": 1462312600, "creation_date": 1462311032, "question_id": 37014707, "link": "https://stackoverflow.com/questions/37014707/haskell-two-elements-from-one-list-followed-by-one-element-other-list-pattern", "title": "Haskell, two elements from one list followed by one element other list? (pattern matching)", "body": "<p>i have a function that will take two elements from one list and one element from the second list, but there is a problem, if the given list has only one element:</p>\n\n<p>example:</p>\n\n<pre><code>*Main&gt; g2 [1] [5..10]\n[1]\n</code></pre>\n\n<p>I want to have a output like this:</p>\n\n<pre><code>*Main&gt; g2 [1] [5..10]\n[1,5]\n</code></pre>\n\n<p>It works for list with more than 1 element:</p>\n\n<pre><code>*Main&gt; g2 [1..5] [8..10]\n[1,2,8,3,4,9,5]\n*Main&gt; g2 [1,2,3,4] [6,7,8,9]\n[1,2,6,3,4,7]\n</code></pre>\n\n<p>My Code:</p>\n\n<pre><code>g2 (x1:x2:xs) (y:ys) = x1:x2:y:(g2 xs ys)\ng2 (x1:[]) y = x1:[]\ng2 [] ys = []\n</code></pre>\n\n<p>I think i forgot a pattern.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462313156, "post_id": 37014568, "comment_id": 61582464, "body": "Are you sure it&#39;s  <code>stdin</code> and not <code>stdout</code>? Also see the <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/System-IO.html#v:hSetBuffering\" rel=\"nofollow noreferrer\">documentation</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3629, "user_id": 808237, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e0eac050c6be0999da0c97c4aec4554e?s=128&d=identicon&r=PG", "display_name": "Tair", "link": "https://stackoverflow.com/users/808237/tair"}, "is_accepted": false, "score": 2, "last_activity_date": 1462314569, "last_edit_date": 1495540364, "creation_date": 1462314569, "answer_id": 37015467, "question_id": 37014568, "link": "https://stackoverflow.com/questions/37014568/what-does-hsetbuffering-stdin-linebuffering-means-in-haskell/37015467#37015467", "title": "What does hSetBuffering stdin LineBuffering means in Haskell?", "body": "<p>The <code>LineBuffering</code> mode for <code>stdin</code> will prevent the application from processing the input until <code>end-of-line</code> character is encountered. Basically, it means, your app won't see the characters until you hit <code>Return</code>. Usually, this is the default mode for Terminal input. The other two are <code>NoBuffering</code> and <code>BlockBuffering</code>.</p>\n\n<p>See this answer for more details: <a href=\"https://stackoverflow.com/questions/19520885/haskell-default-io-buffering\">Haskell default io buffering</a></p>\n\n<p>Why do we need buffering? Buffering enables for more efficiently processing data. Instead of feeding the input one byte at a time, it is more efficient to do that in blocks. For Terminal input, the most natural size is one line at a time, because this is how usually an interactive command line application work: consume a line, process it, and present some response.</p>\n\n<p>Some useful info here: <a href=\"http://wcipeg.com/wiki/I/O_buffering\" rel=\"nofollow noreferrer\">http://wcipeg.com/wiki/I/O_buffering</a></p>\n\n<p>Here is more involved explanation: <a href=\"https://www.quora.com/In-C-what-does-buffering-I-O-or-buffered-I-O-mean\" rel=\"nofollow noreferrer\">https://www.quora.com/In-C-what-does-buffering-I-O-or-buffered-I-O-mean</a></p>\n"}], "owner": {"reputation": 11, "user_id": 4464900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d1a916df3c5ee2d707bd4919810582b?s=128&d=identicon&r=PG", "display_name": "user4464900", "link": "https://stackoverflow.com/users/4464900/user4464900"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462314569, "creation_date": 1462310484, "last_edit_date": 1462313003, "question_id": 37014568, "link": "https://stackoverflow.com/questions/37014568/what-does-hsetbuffering-stdin-linebuffering-means-in-haskell", "title": "What does hSetBuffering stdin LineBuffering means in Haskell?", "body": "<p>I am learning Haskell and I would like to know what does <code>hSetBuffering stdin LineBuffering</code> mean and if there are other commands of this style in Haskell.</p>\n"}, {"tags": ["haskell", "racket", "lambda-calculus"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1462310586, "post_id": 37014293, "comment_id": 61581350, "body": "Where did you get stuck when you tried to do it in Haskell?"}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "edited": false, "score": 0, "creation_date": 1462310728, "post_id": 37014293, "comment_id": 61581407, "body": "I think you mean &quot;sugared \u03bb-calculus&quot;. What did you try? It is straightforward to convert your grammar into a Haskell datatype (<code>LambdaExpr = Variable | Lambda Variable LambdaExpr | Application LambdaExpr LambdaExpr</code> etc.). Where exactly is your problem?"}, {"owner": {"reputation": 35, "user_id": 3815240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a94f6a460792e45d66f07e8cc233e0c?s=128&d=identicon&r=PG&f=1", "display_name": "Extraloob", "link": "https://stackoverflow.com/users/3815240/extraloob"}, "edited": false, "score": 0, "creation_date": 1462310811, "post_id": 37014293, "comment_id": 61581451, "body": "Firstly Im new in Haskell, I don&#39;t know most of things. First how can I define data or lambda ? Also I really don&#39;t know how to put this in Haskell"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3815240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a94f6a460792e45d66f07e8cc233e0c?s=128&d=identicon&r=PG&f=1", "display_name": "Extraloob", "link": "https://stackoverflow.com/users/3815240/extraloob"}, "edited": false, "score": 0, "creation_date": 1462969771, "post_id": 37022642, "comment_id": 61860672, "body": "i didn&#39;t run this in haskell how can i run it?"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1462351442, "creation_date": 1462351442, "answer_id": 37022642, "question_id": 37014293, "link": "https://stackoverflow.com/questions/37014293/how-to-represent-sugared-%ce%bb-terms-in-haskell/37022642#37022642", "title": "How to represent sugared \u03bb-terms in Haskell?", "body": "<p>This is long, so I'll just begin it. Also, I'm pretty sure there are lambda interpreters in Haskell already written somewhere in the 'net.</p>\n\n<pre><code>(define-type \u03bb-calc\n  (\u03bb-sym (v : symbol))\n  (\u03bb-app (l : \u03bb-calc)(r : \u03bb-calc))\n  (\u03bb-def (v : symbol)(expr : \u03bb-calc))\n  )\n</code></pre>\n\n<p>In Haskell, you can define a corresponding algebraic data type</p>\n\n<pre><code>type Symbol = String\ndata Lcalc\n   = Lsym Symbol\n   | Lapp Lcalc Lcalc\n   | Ldef Symbol Lcalc\n   deriving (Show)  -- and possibly Eq, Ord\n</code></pre>\n\n<p>For the tests</p>\n\n<pre><code>;; Tests;;\n(\u03bb-sym 'x)\n(\u03bb-app (\u03bb-sym 'x)(\u03bb-sym 'y))\n(\u03bb-def 'v (\u03bb-app (\u03bb-sym 'x)(\u03bb-sym 'y)))\n</code></pre>\n\n<p>we can use</p>\n\n<pre><code>test1, test2, test3 :: Lcalc\ntest1 = Lsym \"x\"\ntest2 = Lapp (Lsym \"x\") (Lsym \"y\")\ntest3 = Ldef \"v\" (Lapp (Lsym \"x\") (Lsym \"y\"))\n</code></pre>\n\n<p>To manipulate lambda terms, you need pattern matching. E.g.</p>\n\n<pre><code>-- free variables\nfree :: Lcalc -&gt; [Symbol]\nfree (Lsym x) = [x]\nfree (Lapp s t) = nub (free s ++ free t)   -- we remove duplicates here\nfree (Ldef x t) = delete x (free t)\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3815240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a94f6a460792e45d66f07e8cc233e0c?s=128&d=identicon&r=PG&f=1", "display_name": "Extraloob", "link": "https://stackoverflow.com/users/3815240/extraloob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1462393545, "creation_date": 1462309358, "last_edit_date": 1462393545, "question_id": 37014293, "link": "https://stackoverflow.com/questions/37014293/how-to-represent-sugared-%ce%bb-terms-in-haskell", "title": "How to represent sugared \u03bb-terms in Haskell?", "body": "<p>Set up data definitions for the sugared \u03bb-calculus, with this grammar.</p>\n\n<pre><code>\u039b \u2192 v\n\u039b \u2192 ( \u03bb v \u039b )\n\u039b \u2192 ( \u039b \u039b )\n\u039b \u2192 (L \u039b)\nL \u2192 (LET (LL) \u039b)\nLL \u2192 (v \u039b)\n</code></pre>\n\n<p>Here is what they wanted me to do. So I did this for DrRacket. How can I do this for Haskell? </p>\n\n<p>Here is my code in DrRacket:</p>\n\n<pre><code>;; \u03bb-expression grammar\n;; \u03bb-calc -&gt; v\n;; \u03bb-calc -&gt; (\u03bb-calc \u03bb-calc)\n;; \u03bb-calc -&gt; (\u03bb v \u03bb-calc)\n\n(define-type \u03bb-calc\n  (\u03bb-sym (v : symbol))\n  (\u03bb-app (l : \u03bb-calc)(r : \u03bb-calc))\n  (\u03bb-def (v : symbol)(expr : \u03bb-calc))\n  )\n\n\n;; Tests;;\n(\u03bb-sym 'x)\n(\u03bb-app (\u03bb-sym 'x)(\u03bb-sym 'y))\n(\u03bb-def 'v (\u03bb-app (\u03bb-sym 'x)(\u03bb-sym 'y)))\n\n\n;; parse : s-expression -&gt; \u03bb\n;; Examples\n;; 'x -&gt; (\u03bb-sym 'x)\n;; '(x y) -&gt; (\u03bb-app (\u03bb-sym 'x) (\u03bb-sym 'y))\n;; '(\u03bb x y) -&gt; (\u03bb-def 'x (\u03bb-sym 'y))\n;; '((\u03bb x y) (x y)) -&gt; (\u03bb-app (\u03bb-def 'x (\u03bb-sym 'y)) (\u03bb-app (\u03bb-sym 'x) (\u03bb-sym 'y)))\n;; Template\n;; (define (parse [expr : s-expression]) : \u03bb\n;;   (cond\n;;     [(s-exp-symbol? expr) (\u03bb-var (... expr))]\n;;     [(s-exp-list? expr)\n;;      (let ([sl (...expr)])\n;;        (cond\n;;          [(&gt; (length sl) 2)  (... ) (parse ...))]\n;;          [else  (parse ...)) (parse ...)))])\n;;        )]\n;;     [else (error 'parse ...)]))\n\n\n(define (parse (ex : s-expression)) : \u03bb-calc\n  (cond\n    [(s-exp-symbol? ex)(\u03bb-sym (s-exp-&gt;symbol ex))]\n    [(s-exp-list? ex)\n     (let ([ex-list (s-exp-&gt;list ex)])\n       (cond\n         [(= 2 (length ex-list)) (\u03bb-app (parse (first ex-list))(parse (second ex-list)))]\n         [(= 3 (length ex-list)) (if (and (symbol=? '\u03bb (s-exp-&gt;symbol (first ex-list))) (s-exp-symbol? (second ex-list)))\n                                 (\u03bb-def (s-exp-&gt;symbol(second ex-list))\n                                 (parse (third ex-list)))\n              (error 'parse \"Wrong lambda calc\")\n              )]\n         [else (error 'parse \"List length is unexpectedly big\")]\n         ))]\n    [else (error 'parse \"This is not lambda\")]\n    ))\n\n;; Examples\n;; (\u03bb-sym 'x) -&gt; 'x\n;; (\u03bb-app (\u03bb-def 'x) (\u03bb-sym 'y)) -&gt; '(x y)\n;; Template\n;;(define (unparse (le : \u03bb-calc)) : s-expression\n;;  (type-case \u03bb-calc le\n;;    (\u03bb-sym (v) (v)) \n;;    (\u03bb-app (l r)(... (unparse l)(unparse r))))\n;;    (\u03bb-def (v expr)(...\n;;                   v)(unparse expr))))\n\n(define (unparse (le : \u03bb-calc)) : s-expression\n  (type-case \u03bb-calc le\n    (\u03bb-sym (v) (symbol-&gt;s-exp v)) \n    (\u03bb-app (l r)(list-&gt;s-exp (list (unparse l)(unparse r))))\n    (\u03bb-def (v expr)(list-&gt;s-exp \n                 (list (symbol-&gt;s-exp '\u03bb)(symbol-&gt;s-exp v)(unparse expr))))\n    ))\n\n\n;;  \u03bb-calc  symbol  \u03bb-calc -&gt; \u03bb-calc\n;;Template\n;;(define (substituter [what : \u03bb-calc] [for : symbol] [in : \u03bb-calc]) : \u03bb-calc \n;;  (type-case \u03bb-calc in\n;;    (\u03bb-sym (v) (if (symbol=? ...) \n;;                 what\n;;                   in))\n;;  (\u03bb-app (l r) (\u03bb-app (....) (.....)))\n;;    (\u03bb-def (v expr)(\u03bb-def v (substituter what for expr))))\n\n(define (substituter [what : \u03bb-calc] [for : symbol] [in : \u03bb-calc]) : \u03bb-calc \n  (type-case \u03bb-calc in\n    (\u03bb-sym (v) (if (symbol=? v for) \n                   what\n                   in))\n    (\u03bb-app (l r) (\u03bb-app (substituter what for l)\n                        (substituter what for r)))\n    (\u03bb-def (v expr)(\u03bb-def v (substituter what for expr)))\n    )\n  )\n\n\n;; beta-transformer : ((\u03bb x M) N) --&gt; [M:x=N]\n;;;; (\u03bbx x) y -&gt; (y)\n;; ( ((\u03bbx x) (\u03bby y)) ((\u03bbx x) (y y)) ) -&gt; ( (\u03bby y) ((\u03bbx x) (y y)) )\n;; Template\n;;(define (beta-transformer (le : \u03bb-calc)) : \u03bb-calc;;\n;;(type-case \u03bb-calc le\n;;    (\u03bb-sym (v) ) \n;;    (\u03bb-app (l r) (if (\u03bb-def? l) (...))\n;;                     (\u03bb-app (beta-transformer l) (beta-transformer r))))\n;;    (\u03bb-def (v expr) (\u03bb-def ....)))))\n\n(define (beta-transformer (le : \u03bb-calc)) : \u03bb-calc\n  (type-case \u03bb-calc le\n    (\u03bb-sym (v) le) \n    (\u03bb-app (l r) (if (\u03bb-def? l)\n                     (substituter r (\u03bb-def-v l) (\u03bb-def-expr l))\n                     (\u03bb-app (beta-transformer l) (beta-transformer r))))\n    (\u03bb-def (v expr) (\u03bb-def v (beta-transformer expr)))))\n\n\n\n\n\n;; A set represented as a list.\n;; union : (listof symbol) (listof symbol) -&gt; (listof symbol)\n;; finding the union of two sets.\n(define (union (s1 : (listof symbol)) (s2 : (listof symbol))) : (listof symbol)\n  (foldr (lambda (x y)\n           (if (member x y)\n               y\n               (cons x y))) \n         empty\n         (append s1 s2)))\n\n\n;; set-difference : (listof symbol) (listof symbol) -&gt; (listof symbol)\n;; To find the set difference of two sets.\n(define (set-difference (s1 : (listof symbol))  (s2 : (listof symbol))) : (listof symbol)\n  (filter (lambda (x)\n            (not (member x s2)))\n          s1))\n\n;; Tests:\n(test (union empty empty) empty)\n(test (union empty (list 'x)) (list 'x))\n(test (union (list 'x)(list 'x 'y)) (list 'x 'y))\n\n(test (parse (symbol-&gt;s-exp 'y))(\u03bb-sym 'y))\n(test (parse '(\u03bb x x))(\u03bb-def 'x (\u03bb-sym 'x)))\n(test (parse '((\u03bb x x) y))(\u03bb-app (\u03bb-def 'x (\u03bb-sym 'x)) (\u03bb-sym 'y)))\n\n(test (unparse (\u03bb-sym 'y))(symbol-&gt;s-exp 'y))\n(test (unparse (\u03bb-def 'x (\u03bb-sym 'x))) '(\u03bb x x))\n(test (unparse (\u03bb-app (\u03bb-def 'x (\u03bb-sym 'x)) (\u03bb-sym 'y)))\n      '((\u03bb x x) y))\n\n(test (beta-transformer (parse '((\u03bb x x) a)))\n      (parse (symbol-&gt;s-exp 'a)))\n\n(test (beta-transformer (parse '((\u03bb x y) a)))\n      (parse (symbol-&gt;s-exp 'y)))\n\n(test (beta-transformer (parse '((\u03bb x (a b)) k)))\n      (parse '(a b)))\n\n(test (beta-transformer (parse '((\u03bb x (\u03bb x y)) k)))\n      (parse '(\u03bb x y)))\n\n(test (beta-transformer (parse '((\u03bb x (\u03bb y x)) k)))\n      (parse '(\u03bb y k)))\n\n(test (beta-transformer (parse '((\u03bb x (\u03bb y (x y))) k)))\n      (parse '(\u03bb y (k y))))\n\n\n\n    ;; Redex, lambda calculus leftmost inner form\n    ;; Template\n    ;; (define (leftReduction x) : s-exp\n    ;;  (type-case \u03bb-calc \n    ;;    [\u03bb-sym (v) (v)]\n    ;;    [\u03bb-def (v expr) (unparse)]\n    ;;    [\u03bb-app (l r) (unparse )]))\n    ;;(test (leftReduction (\u03bb-def (\u03bb-sym 'a) (\u03bb-(\u03bb-def 'x (\u03bb-sym 'x))) '(\u03bb x x)) 'b) )\n    ;(test (leftReduction (\u03bb-sym  '3)) '3)\n\n    (define (leftReduction la) : s-expression\n      (type-case \u03bb-calc la\n        [\u03bb-sym (v) (symbol-&gt;s-exp v)]\n        [\u03bb-def (v expr) (unparse la)]\n        [\u03bb-app (l r) (unparse l)]))\n</code></pre>\n"}, {"tags": ["list", "haskell", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 0, "creation_date": 1462308397, "post_id": 37013894, "comment_id": 61580284, "body": "It worked, but why do you use g4(y:xs) and not g4(xs)?"}, {"owner": {"reputation": 423, "user_id": 1229280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01b4f6ea28fee3277969f0d099b07b7d?s=128&d=identicon&r=PG", "display_name": "alykhank", "link": "https://stackoverflow.com/users/1229280/alykhank"}, "reply_to_user": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 1, "creation_date": 1462308642, "post_id": 37013894, "comment_id": 61580420, "body": "Taking your example <code>[1,2,3,4]</code>, the flow looks like this: <code>g4 (1:2:[3,4]) = 1+2 : g4 (2:[3,4])</code>, <code>g4 (2:3:[4]) = 2+3 : g4 (3:[4])</code>, <code>g4 (3:4:[]) = 3+4 : g4 (4:[])</code>, <code>g4 [4] = []</code>. Combining those all together you get <code>[1+2, 2+3, 3+4]</code>."}, {"owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 0, "creation_date": 1462308771, "post_id": 37013894, "comment_id": 61580486, "body": "Ah now i understand! Thats for the detailed answer!"}], "tags": [], "owner": {"reputation": 423, "user_id": 1229280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01b4f6ea28fee3277969f0d099b07b7d?s=128&d=identicon&r=PG", "display_name": "alykhank", "link": "https://stackoverflow.com/users/1229280/alykhank"}, "is_accepted": true, "score": 3, "last_activity_date": 1462307774, "creation_date": 1462307774, "answer_id": 37013894, "question_id": 37013732, "link": "https://stackoverflow.com/questions/37013732/haskell-sum-up-two-elements-of-a-list-with-pattern-matching/37013894#37013894", "title": "Haskell, sum up two elements of a list with pattern matching?", "body": "<p>You can call <code>g4</code> on the combination of <code>(y:xs)</code> for your recursive component:</p>\n\n<pre><code>g4 [] = []\ng4 [x] = []\ng4 (x:y:xs) = x+y : g4 (y:xs)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1462309585, "last_edit_date": 1462309585, "creation_date": 1462308997, "answer_id": 37014213, "question_id": 37013732, "link": "https://stackoverflow.com/questions/37013732/haskell-sum-up-two-elements-of-a-list-with-pattern-matching/37014213#37014213", "title": "Haskell, sum up two elements of a list with pattern matching?", "body": "<p>You can just zip the list with a \"shifted\" version of itself.</p>\n\n<pre><code>g4 xs = zipWith (+) xs (tail xs)\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 37013894, "answer_count": 2, "score": 1, "last_activity_date": 1462309585, "creation_date": 1462307159, "question_id": 37013732, "link": "https://stackoverflow.com/questions/37013732/haskell-sum-up-two-elements-of-a-list-with-pattern-matching", "title": "Haskell, sum up two elements of a list with pattern matching?", "body": "<p>i am learning the pattern syntax in Haskell and now i have a problem with my small function.</p>\n\n<p>I want to add two elements of a list like in the example:</p>\n\n<pre><code>input 1: [1,2,3,4,5],  output2: [3,5,7,9]\n\ninput 2: [1,2,3,4,5,6],  ouput 2: [3,5,7,11]\n</code></pre>\n\n<p>My Code(i tried to make a pattern for two elements but it says that the patterns are overlapping):</p>\n\n<pre><code>g4 [] = []\ng4 [x] = [] \n-- g4 (x:y:xs) = x+y: g4 xs\ng4 (x:y:z:xs) = x+y:y+z: g4 (xs)\n</code></pre>\n\n<p>It should look like this, but i dont know how to create the pattern for 2 elements:</p>\n\n<pre><code>g1 [1,2,3,4,5]\n = 1+2 : 2+3 : g1 [3,4,5]\n          = 3+4 : 4+5 : g1 [5]\n               = []\n\n\ng1 [1,2,3,4,5,6]\n = 1+2 : 2+3 : g1 [3,4,5,6]\n          = 3+4 : 4+5 : g1 [5,6]  \n                = 5+6\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>*Main&gt; g4 [1,2,3]\n[3,5] -- worked\n*Main&gt; g4 [1,2,3,4]\n[3,5,4] -- did not work\n*Main&gt; g4 [1,2,3,4,5]\n*** Exception: Test.hs:(127,1)-(130,32): Non-exhaustive patterns in function g4 -- didnt work\n\n[3,5*Main&gt; g4 [1,2,3,4,5,6]\n[3,5,9,11] -- worked\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1462303791, "post_id": 37012770, "comment_id": 61577674, "body": "You need to add a case for one-element lists which you will hit if the list contains an odd number of elements."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1462303891, "post_id": 37012770, "comment_id": 61577741, "body": "What should be done for a list containing a single element?"}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 0, "creation_date": 1462304482, "post_id": 37012918, "comment_id": 61578079, "body": "Ahh now i understand! I didnt know how Haskell is using the function to solve the problem... I thank you!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1462304144, "creation_date": 1462304144, "answer_id": 37012918, "question_id": 37012770, "link": "https://stackoverflow.com/questions/37012770/haskell-reverse-two-elements-in-list/37012918#37012918", "title": "Haskell, reverse two elements in list?", "body": "<p>The problem is that when you apply this, for instance on the list <code>[1,2,3,4,5]</code>. It runs as follows:</p>\n\n<pre><code>g1 [1,2,3,4,5]\n= 1 : 2 : g1 [3,4,5]\n          = 4 : 3 : g1 [5]\n</code></pre>\n\n<p>and there is no pattern defined for the list contain <strong>one single element</strong> (here <code>[5]</code>). Based on your first example nothing should be done in such case except <em>emitting</em> the element. So you have to add the case:</p>\n\n<pre><code>g1 [x] = [x]\n</code></pre>\n\n<p>Or the entire function definition:</p>\n\n<pre>\ng1 [] = []\n<b>g1 [x] = [x]</b>\ng1 (x:y:xs) = y: x: g1 xs\n</pre>\n"}], "owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 37012918, "answer_count": 1, "score": 0, "last_activity_date": 1462306518, "creation_date": 1462303665, "last_edit_date": 1462306518, "question_id": 37012770, "link": "https://stackoverflow.com/questions/37012770/haskell-reverse-two-elements-in-list", "title": "Haskell, reverse two elements in list?", "body": "<p>i want to take a list and always reverse two elements.\nExample:</p>\n\n<p>input 1: <code>[1,2,3,4,5]</code>, output 1: <code>[2,1,4,3,5]</code></p>\n\n<p>input 2: <code>[1,2,3,4,5,6]</code> output 2: <code>[2,1,4,3,6,5]</code></p>\n\n<p>I tried it with pattern matching:</p>\n\n<pre><code>g1 [] = []\ng1 (x:y:xs) = y: x: g1 xs\n</code></pre>\n\n<p>But it says:</p>\n\n<pre><code>*Main&gt; g1 [1,2,3]\n*** Exception: test.hs:(13,1)-(14,27): Non-exhaustive patterns in function g1\ng1\n</code></pre>\n\n<p>Has anybody an idea to solve this problem?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "edited": false, "score": 0, "creation_date": 1462309777, "post_id": 37014122, "comment_id": 61580959, "body": "damn, I tried to use <code>sequenceA</code> before but didn&#39;t find an elegant solution as yours :) Thanks!"}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 2, "last_activity_date": 1462308632, "creation_date": 1462308632, "answer_id": 37014122, "question_id": 37012716, "link": "https://stackoverflow.com/questions/37012716/map-function-on-a-list-of-entities-in-handler/37014122#37014122", "title": "Map function on a list of entities in handler", "body": "<p>Take advantage of the <code>Traversable</code> instance.</p>\n\n<pre><code>getEventsR :: Handler Value\ngetEventsR = do\n    events &lt;- runDB $ selectList [] [] :: Handler [Entity Event]\n    maybeValues &lt;- sequenceA [addMetaData eid event | Entity eid event &lt;- events]\n    return ...\n</code></pre>\n\n<p>Either</p>\n\n<ul>\n<li><code>sequenceA :: (Traversable t, Applicative app) =&gt; t (app a) -&gt; app (t a)</code></li>\n<li><code>sequence :: (Traversable t, Monad m) =&gt; t (m a) -&gt; m (t a)</code></li>\n</ul>\n\n<p>should be of use here. (In this example <code>t ~ []</code> and <code>app ~ HandlerT App IO</code>.)</p>\n\n\n"}], "owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 37014122, "answer_count": 1, "score": 1, "last_activity_date": 1462308632, "creation_date": 1462303460, "last_edit_date": 1495535292, "question_id": 37012716, "link": "https://stackoverflow.com/questions/37012716/map-function-on-a-list-of-entities-in-handler", "title": "Map function on a list of entities in handler", "body": "<p>I have a <a href=\"https://stackoverflow.com/a/34909930/750039\">function</a> that adds some data to a Json of an <code>Entity</code> before serving it.</p>\n\n<p>Now I would like to apply the same function to a list of entities I got while doing:</p>\n\n<pre><code>getEventsR :: Handler Value\ngetEventsR = do\n    events &lt;- runDB $ selectList [] [] :: Handler [Entity Event]\n    return $ object [\"data\" .= events]\n</code></pre>\n\n<p>How can I apply a function with such signature to <code>events</code>:</p>\n\n<pre><code>addMetaData :: EventId\n            -&gt; Event\n            -&gt; HandlerT App IO (Maybe Value)\naddMetaData eid event = do\n</code></pre>\n"}, {"tags": ["haskell", "switch-statement", "pattern-matching", "elm"], "comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 4, "creation_date": 1462327350, "post_id": 37012586, "comment_id": 61586233, "body": "I&#39;m curious. What kind of optimization is the Elm compiler performing that it takes hours to compile a case expression? Your case expression doesn&#39;t seem too big (at least not big enough for a computer). This means that the Elm compiler has a really really really really really really really really really really really really really really really really really really really really really really really really really really really really really really really really bad optimization algorithm. For example, imagine how long it would take for it to compile a case expression with all the 721 pok&#233;mon."}, {"owner": {"reputation": 6320, "user_id": 2294657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcNNI.png?s=128&g=1", "display_name": "halfzebra", "link": "https://stackoverflow.com/users/2294657/halfzebra"}, "edited": false, "score": 5, "creation_date": 1462350302, "post_id": 37012586, "comment_id": 61595212, "body": "I guess the answer lies <a href=\"https://github.com/elm-lang/elm-compiler/blob/master/src/Optimize/Case.hs\" rel=\"nofollow noreferrer\">here</a>, maybe you should try adding <code>haskell</code> tag and see if haskell people can reveal something to us."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 6320, "user_id": 2294657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcNNI.png?s=128&g=1", "display_name": "halfzebra", "link": "https://stackoverflow.com/users/2294657/halfzebra"}, "edited": false, "score": 0, "creation_date": 1462915958, "post_id": 37012586, "comment_id": 61836693, "body": "@halfzebra, I have no idea what that code is doing, but I&#39;m deeply suspicious of any code that uses <code>Data.Map</code> with <code>Int</code> keys. <code>Data.IntMap</code> is usually far faster for that."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1462916370, "post_id": 37012586, "comment_id": 61836857, "body": "In particular, I&#39;d expect <code>unionWith</code>, which is used heavily in that code, to be much faster with a PATRICIA tree than a balanced binary search tree."}, {"owner": {"reputation": 6320, "user_id": 2294657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcNNI.png?s=128&g=1", "display_name": "halfzebra", "link": "https://stackoverflow.com/users/2294657/halfzebra"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462963790, "post_id": 37012586, "comment_id": 61856280, "body": "@dfeuer if you feel that you&#39;re on to something, then you&#39;re more than welcome to post the answer."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 5, "creation_date": 1463205761, "post_id": 37012586, "comment_id": 61976562, "body": "I think you should ask a new question in a better venue on fixing the case stuff, and answer your own by just explaining that case stuff is known slow. As to why, the relevant code looks to be here: <a href=\"https://github.com/elm-lang/elm-compiler/blob/master/src/Optimize/\" rel=\"nofollow noreferrer\">github.com/elm-lang/elm-compiler/blob/master/src/Optimize</a>  The cited Scott &amp; Ramsey paper describes how the &quot;small branching factor&quot; heuristic is disastrously slow. In the above code that heuristic is used as a tiebreaker when small defaults ties. So, I bet in your bad examples, small default ties a lot and we hit the horrible case. My take: Elm shouldn&#39;t use SBF as a factor, full stop."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 24, "creation_date": 1495941568, "post_id": 37012586, "comment_id": 75457404, "body": "Can you please self-answer this question so it doesn&#39;t appear on the unanswered list any more?"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1505165672, "post_id": 37012586, "comment_id": 79291823, "body": "there are some ways of implement the same behaviour, just reimplement it in some other way while this is being fixed"}, {"owner": {"reputation": 1221, "user_id": 1079267, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/753b0c4548a388dd01fd38b50c9db270?s=128&d=identicon&r=PG", "display_name": "Worthy7", "link": "https://stackoverflow.com/users/1079267/worthy7"}, "edited": false, "score": 6, "creation_date": 1510709241, "post_id": 37012586, "comment_id": 81547391, "body": "Did it ever actually finish compiling?"}, {"owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "edited": false, "score": 0, "creation_date": 1510798947, "post_id": 37012586, "comment_id": 81592136, "body": "I never did get it to finish, but I worked around it by using Ints instead."}], "answers": [{"tags": [], "owner": {"reputation": 4103, "user_id": 1052931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e6c10cbc976c5ecdf108dedf516864?s=128&d=identicon&r=PG", "display_name": "Philip Whitehouse", "link": "https://stackoverflow.com/users/1052931/philip-whitehouse"}, "is_accepted": false, "score": 3, "last_activity_date": 1514909293, "creation_date": 1514909293, "answer_id": 48064176, "question_id": 37012586, "link": "https://stackoverflow.com/questions/37012586/elm-compiler-running-forever-computer-just-getting-hot/48064176#48064176", "title": "Elm Compiler running forever, computer just getting hot", "body": "<p><strong>Large case expressions</strong> will cause the optimizer to take a long time, as of 0.16. Here's the <a href=\"https://groups.google.com/forum/#!topic/elm-discuss/2ySK77lKYss\" rel=\"nofollow noreferrer\">discussion on Elm-Discuss</a> bringing up the issue, and a <a href=\"https://gist.github.com/athanclark/0e29485cb245ff07a97730cfef365d10\" rel=\"nofollow noreferrer\">gist of the nasty case match</a>.</p>\n"}], "owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3348, "favorite_count": 8, "protected_date": 1505670346, "answer_count": 1, "score": 100, "last_activity_date": 1514909293, "creation_date": 1462302989, "last_edit_date": 1488071083, "question_id": 37012586, "link": "https://stackoverflow.com/questions/37012586/elm-compiler-running-forever-computer-just-getting-hot", "title": "Elm Compiler running forever, computer just getting hot", "body": "<p>I'm not sure what's causing this issue, but in a project, I'm building, the compiler is taking hours just to compile a module. The total size of my codebase is 352KB, but none of the modules are over 10KB large. I am using a Native port, but it's very trivial; I'm just fetching <code>Date.now()</code> with it.</p>\n\n<p>Is there anything well-known that would cause the elm compiler to take forever to compile? I don't have many dependencies, but I'm using Html a lot. I would really appreciate any hints as to what would cause this.</p>\n\n<h1>Edit</h1>\n\n<p>So it turns out <strong>large case expressions</strong> will cause the optimizer to take a long time, as of 0.16. Here's the <a href=\"https://groups.google.com/forum/#!topic/elm-discuss/2ySK77lKYss\" rel=\"noreferrer\">discussion on Elm-Discuss</a> bringing up the issue, and a <a href=\"https://gist.github.com/athanclark/0e29485cb245ff07a97730cfef365d10\" rel=\"noreferrer\">gist of the nasty case match</a>.</p>\n\n<p>I guess to be verbose and to keep a carrot out there, why would elm's compiler take this route for case-matching? What's the underlying machinery going on here? Why would the compiler take longer than an hour for optimizing 60+ pattern matches on a case statement?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1462301496, "post_id": 37011859, "comment_id": 61576350, "body": "This typeclass + instance makes me cringe. Are you sure you are expressing the right thing here?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3499547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c187cd9246d33c2e5f94550264fb57c5?s=128&d=identicon&r=PG", "display_name": "Niki", "link": "https://stackoverflow.com/users/3499547/niki"}, "edited": false, "score": 0, "creation_date": 1462301780, "post_id": 37012081, "comment_id": 61576510, "body": "Thanks Daniel! I can leave the <code>Bool</code> as is! The following is enough!        <code>instance (a~b) =&gt; Foo a (Bool -&gt; b) where foo x _ = x</code>"}, {"owner": {"reputation": 11, "user_id": 3499547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c187cd9246d33c2e5f94550264fb57c5?s=128&d=identicon&r=PG", "display_name": "Niki", "link": "https://stackoverflow.com/users/3499547/niki"}, "edited": false, "score": 0, "creation_date": 1463506956, "post_id": 37012081, "comment_id": 62091091, "body": "I am trying to understand why this trick works:  Is it that since the instance is so general, first the instance is &quot;accepted&quot; by type checker and <i>then</i> the constraint <code>a~b</code> is checked? In my initial example, what prevents <code>r</code> to be instantiated to <code>Int</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11, "user_id": 3499547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c187cd9246d33c2e5f94550264fb57c5?s=128&d=identicon&r=PG", "display_name": "Niki", "link": "https://stackoverflow.com/users/3499547/niki"}, "edited": false, "score": 0, "creation_date": 1463516220, "post_id": 37012081, "comment_id": 62095897, "body": "@Niki Correct: instance contexts (things to the left of <code>=&gt;</code>) are ignored while choosing an instance. In your example, nothing prevents <code>r</code> from being instantiated to <code>Int</code> -- but nothing forces it, either; since somebody could potentially come along later and define an instance for e.g. <code>instance Foo Int (Bool -&gt; ())</code>, it is not clear that the existing instance is the right one to choose. Even though it&#39;s the only one that matches given the current modules being compiled, the open world assumption means that further compilation units could be added later."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1462301216, "last_edit_date": 1495541684, "creation_date": 1462301216, "answer_id": 37012081, "question_id": 37011859, "link": "https://stackoverflow.com/questions/37011859/choose-default-instance-under-ambiguous-types/37012081#37012081", "title": "Choose default instance under ambiguous types", "body": "<p>The standard trick is to make your instance more polymorphic, thus:</p>\n\n<pre><code>instance (a ~ b, bool ~ Bool) =&gt; Foo a (bool -&gt; b) where\n    foo x _ = x\n</code></pre>\n\n<p>This precludes you from writing other function instances, but makes it clear what types to use when a function instance is wanted. You will need to turn on the <code>TypeFamilies</code> extension to do this. In your specific case you may be able to get away with just <code>instance a ~ b =&gt; Foo a (Bool -&gt; b)</code>, which would allow further function instances with other argument types, at the cost of more frequent ambiguity errors.</p>\n\n<p>See <a href=\"https://stackoverflow.com/a/23913744/791604\">a previous answer of mine</a> for some more explanation of this trick.</p>\n"}], "owner": {"reputation": 11, "user_id": 3499547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c187cd9246d33c2e5f94550264fb57c5?s=128&d=identicon&r=PG", "display_name": "Niki", "link": "https://stackoverflow.com/users/3499547/niki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462301216, "creation_date": 1462300564, "last_edit_date": 1462300803, "question_id": 37011859, "link": "https://stackoverflow.com/questions/37011859/choose-default-instance-under-ambiguous-types", "title": "Choose default instance under ambiguous types", "body": "<p>Is there a Haskell language extension for the type class method to \"use the only potential instance available\"? </p>\n\n<p>I want to compile the following</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleInstances     #-}\n\nclass Foo a r where\n foo :: a -&gt; r \n\n\ninstance Foo a (Bool -&gt; a) where\n  foo x _ = x \n\n-- This compiles \n-- bar :: Int -&gt; Bool\n\n-- This does not  \nbar :: a -&gt; Bool  \nbar _ = True \n\n\nuse :: Bool \nuse = bar $ foo _5 True\n  where\n    _5 :: Int \n    _5 = 5 \n</code></pre>\n\n<p>Now I get the following error:</p>\n\n<pre><code>     No instance for (Foo Int (Bool -&gt; r0))\n  (maybe you haven't applied enough arguments to a function?)\n  arising from a use of \u2018foo\u2019\nThe type variable \u2018r0\u2019 is ambiguous\nNote: there is a potential instance available:\n  instance Foo a (Bool -&gt; a) -- Defined at tests/pos/Fixme.hs:9:10\n</code></pre>\n\n<p>But since there is only one potential instance available, is there a way to force ghc to use that instance? Or is there a way to declare some instance as a default instance when types are ambiguous?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1462296901, "post_id": 37010432, "comment_id": 61573535, "body": "I guess it has to do with <code>f</code> appearing after the \\ if I&#39;m not mistaken, lambda arguments are still monomorphic unless you state otherwise."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 1, "creation_date": 1462298763, "post_id": 37010432, "comment_id": 61574618, "body": "Just a heads up: Rank2Types is an obsolete extension, aliased to RankNTypes. (And RankNTypes just allows you to write <code>forall</code>s. No higher-rank type inference in GHC, as Ingo&#39;s answer details.)"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6286860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b18ae35b6ecb320eb0ff770be29818b?s=128&d=identicon&r=PG&f=1", "display_name": "SimonJ", "link": "https://stackoverflow.com/users/6286860/simonj"}, "edited": false, "score": 0, "creation_date": 1462347121, "post_id": 37010921, "comment_id": 61593170, "body": "Thanks for the fast answer! This explains it. So matching on &#40;Test f) -&gt; is the first case you mention, right?"}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 4, "last_activity_date": 1462297501, "creation_date": 1462297501, "answer_id": 37010921, "question_id": 37010432, "link": "https://stackoverflow.com/questions/37010432/polymorphic-functions-in-record-types-haskell/37010921#37010921", "title": "Polymorphic functions in Record Types Haskell", "body": "<p>Last time I checked, GHC could not infer higher rank types. Thus, when you have</p>\n\n<pre><code>\\f -&gt;  ... f x .... f y\n</code></pre>\n\n<p>the <code>f</code> can never be polymorphic.</p>\n\n<p>There are only two places where the type of some variable is so obvious that type inference recognizes the higher rank type: in patterns that declare higher rank fields and in the LHS  of annotated functions.</p>\n\n<p>It also should work to give the type explicitly, like in</p>\n\n<pre><code>\\(f :: forall a.a -&gt; a) -&gt; .... f x ... f y\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6286860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b18ae35b6ecb320eb0ff770be29818b?s=128&d=identicon&r=PG&f=1", "display_name": "SimonJ", "link": "https://stackoverflow.com/users/6286860/simonj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 37010921, "answer_count": 1, "score": 3, "last_activity_date": 1462297501, "creation_date": 1462295913, "question_id": 37010432, "link": "https://stackoverflow.com/questions/37010432/polymorphic-functions-in-record-types-haskell", "title": "Polymorphic functions in Record Types Haskell", "body": "<p>i've stumbled upon a behaviour I can't explain in Haskell. I'm trying to store a polymorphic function in a Record Type, which I want to use in a ReaderT Monad. When I get my function with <code>asks</code>, the compiler doesn't recognize it as polymorphic and seems to fix the type on the first occurance of the function. I created a minimal example of this in ghci:</p>\n\n<pre><code>{-# LANGUAGE Rank2Types             #-}\n\ndata Test = Test {f :: (forall a. a -&gt; a)}\n\nrunReaderT (asks f \n            &gt;&gt;= \\f -&gt; (liftIO . putStrLn $ show (f 2 :: Int)) \n                   &gt;&gt; (liftIO . putStrLn $ show (f \"hello\"))\n           ) (Test id)\n</code></pre>\n\n<p>When trying to run this, I get:</p>\n\n<pre><code>Couldn't match expected type \u2018Int\u2019 with actual type \u2018[Char]\u2019\nIn the first argument of \u2018f\u2019, namely \u2018\"hello\"\u2019\nIn the first argument of \u2018show\u2019, namely \u2018(f \"hello\")\u2019\nIn the second argument of \u2018($)\u2019, namely \u2018show (f \"hello\")\u2019\n</code></pre>\n\n<p>However, following code works:</p>\n\n<pre><code>runReaderT (ask \n            &gt;&gt;= \\(Test f) -&gt; (liftIO . putStrLn $ show (f 2 :: Int))     \n                          &gt;&gt; (liftIO . putStrLn $ show (f \"hello\"))\n           ) (Test id)\n</code></pre>\n\n<p>So is it something special with <code>asks</code>? I'm grateful for any advice on this.</p>\n"}, {"tags": ["string", "haskell", "floating-point"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462291195, "post_id": 37008910, "comment_id": 61570207, "body": "well <code>show 2.1</code> should yield <code>&quot;2.1&quot;</code> - so I guess it&#39;s not exactly <code>2.1</code>?"}, {"owner": {"reputation": 164, "user_id": 2295391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/be35f59bec82281d2df7c60526b65a0a?s=128&d=identicon&r=PG", "display_name": "Totoro", "link": "https://stackoverflow.com/users/2295391/totoro"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462291328, "post_id": 37008910, "comment_id": 61570288, "body": "Yes, but show 2.0 don&#39;t yield &quot;2&quot;, but &quot;2.0&quot;. And that&#39;s not the behavior I want"}], "answers": [{"comments": [{"owner": {"reputation": 164, "user_id": 2295391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/be35f59bec82281d2df7c60526b65a0a?s=128&d=identicon&r=PG", "display_name": "Totoro", "link": "https://stackoverflow.com/users/2295391/totoro"}, "edited": false, "score": 0, "creation_date": 1462294030, "post_id": 37009314, "comment_id": 61571846, "body": "This solves partially the problem, but is still too complex to obtain what I need. However thanks :)"}], "tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 4, "last_activity_date": 1462292390, "creation_date": 1462292390, "answer_id": 37009314, "question_id": 37008910, "link": "https://stackoverflow.com/questions/37008910/easy-way-to-show-a-floating-point-integer-without-decimal-positions-in-haskell/37009314#37009314", "title": "Easy way to show a floating point integer without decimal positions in Haskell?", "body": "<p>Printing floating-point numbers is <a href=\"http://dl.acm.org/citation.cfm?id=93559&amp;dl=ACM&amp;coll=DL&amp;CFID=610197641&amp;CFTOKEN=10140114\" rel=\"nofollow\">surprisingly hard task</a>. The only implementation in <code>base</code> package I'm aware about is <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Numeric.html#v:floatToDigits\" rel=\"nofollow\">floatToDigits</a>, though it returns digits instead of strings:</p>\n\n<pre><code>Prelude Numeric&gt; floatToDigits 10 2.0\n([2],1)\nPrelude Numeric&gt; floatToDigits 10 2.1\n([2,1],1)\n</code></pre>\n\n<p>(The second component of the result is exponent.)</p>\n"}], "owner": {"reputation": 164, "user_id": 2295391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/be35f59bec82281d2df7c60526b65a0a?s=128&d=identicon&r=PG", "display_name": "Totoro", "link": "https://stackoverflow.com/users/2295391/totoro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 37009314, "answer_count": 1, "score": 1, "last_activity_date": 1462292390, "creation_date": 1462291068, "last_edit_date": 1462291273, "question_id": 37008910, "link": "https://stackoverflow.com/questions/37008910/easy-way-to-show-a-floating-point-integer-without-decimal-positions-in-haskell", "title": "Easy way to show a floating point integer without decimal positions in Haskell?", "body": "<p>Let's suppose we have 2 numbers, 2.0 and 2.1. There is an easy way to show or convert them respectively to \"2\" and \"2.1\"?</p>\n\n<p>Sure I can do, for example, showFFloat (Just 0) 2 \"\", or showFFloat Nothing 2 \"\", but I use different arguments for each parameter, so the solution don't work for both numbers.</p>\n\n<p>I can, for example, strip \".0\", if present, from the end of the string after I showed 2.0 and 2.1, and that works, but it isn't exactly simple. And many other solutions solve the problem, but I can't think about a simple one.</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "operator-precedence"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1462291013, "post_id": 37007545, "comment_id": 61570098, "body": "Don&#39;t forget that an optimizing compiler can choose any order of evaluation for an associative operator such as <code>*</code>. Further <code>f 1 * f 2 * f 3</code> might perform all the three calls to <code>f</code> first (in any order) and then perform the multiplications (in any order), or mix both somehow: precedence is unrelated to the evaluation order of the arguments. (Albeit of course data causality must be respected)"}], "answers": [{"comments": [{"owner": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "edited": false, "score": 0, "creation_date": 1462288109, "post_id": 37007805, "comment_id": 61568075, "body": "Ah brilliant. Thank you. I was specifically looking up how Haskell evaluates and didn&#39;t come across an example that explained this."}], "tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": true, "score": 3, "last_activity_date": 1462288717, "last_edit_date": 1462288717, "creation_date": 1462288027, "answer_id": 37007805, "question_id": 37007545, "link": "https://stackoverflow.com/questions/37007545/what-order-would-haskell-evaluate-2-operands-of-the-same-precedence/37007805#37007805", "title": "What order would Haskell evaluate 2 operands of the same precedence?", "body": "<p>You can ask for an operator's <em>infixity</em> using ghci:</p>\n\n<pre><code>&gt;&gt;&gt; :info (*)\nclass Num a where\n  ...\n  (*) :: a -&gt; a -&gt; a\n  ...\n        -- Defined in `GHC.Num'\ninfixl 7 *\n</code></pre>\n\n<p>Or you can <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:-42-\" rel=\"nofollow\">look it up on Hackage</a>. A good way to search Hackage is with <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow\">Hoogle</a> or <a href=\"http://hayoo.fh-wedel.de/\" rel=\"nofollow\">Hayoo</a>.</p>\n\n<p>Because <code>*</code> has infixity <code>infixl 7</code> this means it is <em>left-associative</em> and has precedence <em>7</em>. Therefore, <code>a * b * c</code> is <code>(a * b) * c</code>.</p>\n\n<p>A more interesting example is an operator that does not have the mathematical property of associativity such as <code>-</code> (not to be confused with infixity, which it does have). The infixity is <code>infixl 6</code> and therefore <code>a - b - c</code> is <code>(a - b) - c</code>.</p>\n\n<p>An example of a right-associative operator is <code>:</code>:</p>\n\n<pre><code>&gt;&gt;&gt; :info (:)\ndata [] a = ... | a : [a]       -- Defined in `GHC.Types'\ninfixr 5 :\n</code></pre>\n\n<p>So <code>a : b : c</code> is <code>a : (b : c)</code>. Note that if it was left-associative then <code>a : b : c</code> would (probably) be a type error!</p>\n"}], "owner": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "closed_date": 1462321342, "accepted_answer_id": 37007805, "answer_count": 1, "score": 0, "last_activity_date": 1462288717, "creation_date": 1462287349, "question_id": 37007545, "link": "https://stackoverflow.com/questions/37007545/what-order-would-haskell-evaluate-2-operands-of-the-same-precedence", "closed_reason": "Duplicate", "title": "What order would Haskell evaluate 2 operands of the same precedence?", "body": "<p>For a function that uses the same operand, e.g. <code>+</code> or <code>*</code> more than once, how will it evaluate it?</p>\n\n<p>For example, in the following code:</p>\n\n<pre><code>prodOfThree :: Int -&gt; Int -&gt; Int\nprodOfThree a b c = a*b*c\n</code></pre>\n\n<p>How would the following be evaluated?</p>\n\n<pre><code>prodOfThree (2+3) 4 2\n</code></pre>\n\n<p>This is as far as I've got:</p>\n\n<pre><code>=&gt; (2 + 3) * 4 * 2\n=&gt; 5 * 4 * 2\n</code></pre>\n\n<p>And then I am unsure of whether it would multiply <code>5*4</code> first, <code>4*2</code> first or <code>5*4*2</code> all at once.</p>\n"}, {"tags": ["database", "haskell", "monad-transformers", "haskell-persistent"], "answers": [{"comments": [{"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1462366606, "post_id": 37013740, "comment_id": 61606820, "body": "Wow, that&#39;s amazing. To fix this issue I&#39;ve written my own class that&#39;s almost exactly the <code>PersistBackend</code> in groundhog. You just saved me the trouble of answering my own question. Accepted!"}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 3, "last_activity_date": 1462307198, "creation_date": 1462307198, "answer_id": 37013740, "question_id": 37007430, "link": "https://stackoverflow.com/questions/37007430/dealing-with-database-access-in-transformer-stacks/37013740#37013740", "title": "Dealing with database access in transformer stacks", "body": "<h2>groundhog</h2>\n\n<p>I recommend using the <a href=\"https://github.com/lykahb/groundhog/blob/master/groundhog/Database/Groundhog/Core.hs\" rel=\"nofollow\">latest groundhog</a> from their <code>master</code> branch. Even though the change I'm about to describe appears to have been implemented in Sept. 2015, no release has made it to Hackage. But the authors seemed to have tackled this very problem.</p>\n\n<p>On tip, <code>PersistBackend</code> is now a much simpler class to implement, much reduced from the dozens-of-methods-long behemoth it once was:</p>\n\n<pre><code>class (Monad m, Applicative m, Functor m, MonadIO m, ConnectionManager (Conn m), PersistBackendConn (Conn m)) =&gt; PersistBackend m where\n  type Conn m\n  getConnection :: m (Conn m)\n\ninstance (Monad m, Applicative m, Functor m, MonadIO m, PersistBackendConn conn) =&gt; PersistBackend (ReaderT conn m) where\n  type Conn (ReaderT conn m) = conn\n  getConnection = ask\n</code></pre>\n\n<p>They wrote an instance for <code>ReaderT conn m</code> (<code>DbPersist</code> has been deprecated and aliased to <code>ReaderT conn</code>), and you could as easily write one for <code>Tr (ReaderT conn)</code> if you choose to go the route of putting <code>ReaderT</code> inside rather than outside. It's not quite an <code>mtl</code> monad transformer since you would have to instance <code>Tr m</code> instead of <code>Tr</code>, but this and the associated data type trick they're using should allow you to use a custom monad stack without too much fuss.</p>\n\n<p>Either option you choose will probably require some lifting. In my personal opinion I would stick <code>ReaderT conn</code> on the very outside of the stack. That way, the <code>mtl</code> helpers can still lift through most of your stack and you can glue on an additional lift to take it home. And, if you were to stick with the version on Hackage, this seems to be the only reasonable option since otherwise you would have the (old) monolithic <code>PersistBackend</code> class.</p>\n\n<h2>persistent</h2>\n\n<p>Persistent is a little more straightforward: as long as the monad transformer stack contains <code>ReaderT SqlBackend</code> and terminates in <code>IO</code>, you can lift a call to <code>runSqlPool :: MonadBaseControlIO m =&gt; ReaderT SqlBackend m a -&gt; Pool SqlBackend -&gt; m a</code>. All Persistent operations are defined to return something of type <code>ReaderT backend m a</code>, so the design sort of just works out.</p>\n"}], "owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 1, "accepted_answer_id": 37013740, "answer_count": 1, "score": 3, "last_activity_date": 1462382681, "creation_date": 1462286998, "last_edit_date": 1462382681, "question_id": 37007430, "link": "https://stackoverflow.com/questions/37007430/dealing-with-database-access-in-transformer-stacks", "title": "Dealing with database access in transformer stacks", "body": "<p>This question is about <code>groundhog</code> or <code>persistent</code>, because I believe both share the same problem.</p>\n\n<p>Say I have a transformer <code>Tr m a</code> that provides some functionality <code>f :: Int -&gt; Tr m ()</code>. This functionality requires database access. There are a few options I can use here, and none are satisfactory.</p>\n\n<p>I could put a <code>DbPersist</code> transformer somewhere inside of <code>Tr</code>. Actually, I'd need to put it at the top because there are no <code>PersistBackend</code> instances for standard transformers AND I'd still need to write an instance for my <code>Tr</code> newtype. This already sucks because the class is far from minimal. I could also lift every db action I do.</p>\n\n<p>The other option is changing the signature of <code>f</code> to <code>PersistBackend m =&gt; Int -&gt; Tr m ()</code>. This would again either require a <code>PersistBackend</code> instance on my <code>Tr</code> newtype, or lifting.</p>\n\n<p>Now here's the real issue. How do I run <code>Tr</code> inside of a context that already has a <code>PersistBackend</code> constraint? There's no way to share it with <code>Tr</code>. </p>\n\n<p>I can either do the first option and run the actual <code>DbPersist</code> transformer inside of <code>Tr</code> with some new connection pool (as far as I can tell there's no way to get the pool from the <code>PersistBackend</code> context I'm already in), or I can do the second option and have the run function be <code>runTr :: PersistBackend m =&gt; Tr m a -&gt; m a</code>. The second option would actually be completely fine, but the problem here is that the <code>DbPersist</code>, that will eventually have to be somewhere in the stack, is now under the <code>Tr</code> transformer and there are no <code>PersistBackend</code> instances for the standard transformers of which <code>Tr</code> is made of.</p>\n\n<p>What's the correct approach here? At the moment is seems that the best option is to go with a sepatare <code>ReaderT</code> somewhere in the stack that provides me with the connection pool on request and then do <code>runDbConn</code> with that pool everywhere where I want to access the DB. Seeing how <code>DbPersist</code> basically already is just a <code>ReaderT</code> I don't see the sense in having to do that.</p>\n"}, {"tags": ["haskell", "gtk"], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 3340662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b132df42139258c13dafb8515dc21f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3340662", "link": "https://stackoverflow.com/users/3340662/user3340662"}, "is_accepted": false, "score": 1, "last_activity_date": 1462351513, "creation_date": 1462351513, "answer_id": 37022676, "question_id": 37006640, "link": "https://stackoverflow.com/questions/37006640/gtk-3-10-ignores-gtk-box-set-child-packing/37022676#37022676", "title": "Gtk 3.10 ignores gtk_box_set_child_packing", "body": "<p>Never mind, my Haskell code was calling gtk_hbox_new, which is clearly stated to be deprecated in the docs. I switched to gtk_box_new and now the child widgets are correctly laid out with both Gtk versions.</p>\n"}], "owner": {"reputation": 191, "user_id": 3340662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b132df42139258c13dafb8515dc21f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3340662", "link": "https://stackoverflow.com/users/3340662/user3340662"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462351513, "creation_date": 1462284778, "question_id": 37006640, "link": "https://stackoverflow.com/questions/37006640/gtk-3-10-ignores-gtk-box-set-child-packing", "title": "Gtk 3.10 ignores gtk_box_set_child_packing", "body": "<p>As written in the title, I have trouble specifying child packing properties inside an hbox/vbox with Gtk 3.10 (on Ubuntu 14.04), where the same code works with Gtk 3.20 (on Archlinux). The minimal code to reproduce the bug is the following (pardon my Haskell) :</p>\n\n<pre><code>import Graphics.Widget -- my graphics library, which uses the FFI to import Gtk functions\n\nmain = runApplication $ do\n  a &lt;- (subwidget.text) \"aaa\"; b &lt;- (subwidget.text) \"bbb\"\n  setDynamic a (packing.expands) Fitting\n  c &lt;- box2 Horizontal a b\n  window \"Main window\" c &lt;| do visible =- True\n</code></pre>\n\n<p>This code compiles and runs with the two Gtk versions, but the Gtk 3.10 version seems to ignore the second line and shows both child widgets expanding equally into the hbox. The Gtk 3.20 version does what is expected and shows the first widget packed to the left and the second one taking the remaining space. Other than that, no error is being reported from either Gtk version.</p>\n\n<p>Can you help me understand what changed ? I've read the docs, and I haven't found a reasonable explanation for this behaviour.</p>\n"}, {"tags": ["haskell", "number-formatting"], "comments": [{"owner": {"reputation": 84157, "user_id": 238978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a633afaf19e6d4bb53ee50b62e3b5397?s=128&d=identicon&r=PG", "display_name": "Emil Vikstr&#246;m", "link": "https://stackoverflow.com/users/238978/emil-vikstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1462284229, "post_id": 37006362, "comment_id": 61565192, "body": "3.0e-2 is equivalent to 0.03. They are the same number. Are you talking about PRINTING these numbers or something else entirely?"}, {"owner": {"reputation": 343, "user_id": 1395518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d1b90f84ba434d5f6b4e67f2d557c1d?s=128&d=identicon&r=PG", "display_name": "Ian Stewart", "link": "https://stackoverflow.com/users/1395518/ian-stewart"}, "reply_to_user": {"reputation": 84157, "user_id": 238978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a633afaf19e6d4bb53ee50b62e3b5397?s=128&d=identicon&r=PG", "display_name": "Emil Vikstr&#246;m", "link": "https://stackoverflow.com/users/238978/emil-vikstr%c3%b6m"}, "edited": false, "score": 1, "creation_date": 1462284522, "post_id": 37006362, "comment_id": 61565413, "body": "I know 3.0e-2 is equivalent to 0.03, I need the more usual form for printing. (Whenever I ask a question I get marked down, have I upset someone?)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462284571, "post_id": 37006362, "comment_id": 61565454, "body": "That&#39;s a formatting issue (and handled by <code>Text.Printf.printf</code>). Concerning your question&#39;s score: the title and the contents don&#39;t match at all. A better title would be &quot;how to show decimals with a certain format&quot; or &quot;how to avoid scientific notation in decimal output&quot;."}, {"owner": {"reputation": 343, "user_id": 1395518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d1b90f84ba434d5f6b4e67f2d557c1d?s=128&d=identicon&r=PG", "display_name": "Ian Stewart", "link": "https://stackoverflow.com/users/1395518/ian-stewart"}, "edited": false, "score": 0, "creation_date": 1462284861, "post_id": 37006362, "comment_id": 61565645, "body": "Thanks Zeta, I have now changed it."}, {"owner": {"reputation": 343, "user_id": 1395518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d1b90f84ba434d5f6b4e67f2d557c1d?s=128&d=identicon&r=PG", "display_name": "Ian Stewart", "link": "https://stackoverflow.com/users/1395518/ian-stewart"}, "edited": false, "score": 0, "creation_date": 1462285209, "post_id": 37006362, "comment_id": 61565896, "body": "&quot;because 3 divided by a power of 10 can&#39;t be represented &quot; But 3 / 10 produces 0.3."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 1, "creation_date": 1462285235, "post_id": 37006362, "comment_id": 61565914, "body": "@JulesMazur: Err, <code>0.0625</code> can be represented accurately (it&#39;s 2^{-4}), but still gets shown as <code>6.25e-2</code>. It&#39;s just that the <code>Show</code> instance for <code>Double</code> will switch to scientific mode whenever the first digit after the separator is zero."}, {"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462285303, "post_id": 37006362, "comment_id": 61565956, "body": "@Zeta My mistake, then."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1462285618, "post_id": 37006362, "comment_id": 61566168, "body": "@IanStewart: It doesn&#39;t. Try <code>(3 &#47; 10) * 100000000000000000000000</code> and be amazed."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 12, "last_activity_date": 1462286074, "creation_date": 1462286074, "answer_id": 37007092, "question_id": 37006362, "link": "https://stackoverflow.com/questions/37006362/how-to-get-a-decimal-string-from-a-double-instead-of-scientific-notation-in-hask/37007092#37007092", "title": "How to get a decimal string from a Double instead of scientific notation in Haskell?", "body": "<p><code>0.03</code> and <code>3.0e-2</code> are the same number. Internally, GHC uses <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Numeric.html#v:showFloat\" rel=\"noreferrer\"><code>showFloat</code></a> to print it, which will result in the scientific notation whenever the absolute value is outside the range 0.1 and 9,999,999.</p>\n\n<p>Therfore, you have to print the values yourself, for example with <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Text-Printf.html#v:printf\" rel=\"noreferrer\"><code>printf</code></a> from <code>Text.Printf</code> or <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Numeric.html#v:showFFloat\" rel=\"noreferrer\"><code>showFFloat</code></a> from <code>Numeric</code>:</p>\n\n<pre><code>import Numeric\n\nshowFullPrecision :: Double -&gt; String\nshowFullPrecision x = showFFloat Nothing x \"\"\n\nmain = putStrLn (showFullPrecision 0.03)\n</code></pre>\n\n<p>Depending on your desired output, you need to write some more functions.</p>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462298559, "post_id": 37009015, "comment_id": 61574511, "body": "Why <code>take (length (xs))</code>? This will drop the last element."}, {"owner": {"reputation": 343, "user_id": 1395518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d1b90f84ba434d5f6b4e67f2d557c1d?s=128&d=identicon&r=PG", "display_name": "Ian Stewart", "link": "https://stackoverflow.com/users/1395518/ian-stewart"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462301801, "post_id": 37009015, "comment_id": 61576524, "body": "Hi Zeta, the music I am working on at the moment has 4 sections starting at  0.00 - 1.12 - 2.38 - 3.40 and ending at 5.28 (minutes.seconds) which produces [&quot;1.12&quot;,&quot;1.26&quot;,&quot;1.02&quot;,&quot;1.48&quot;]. There are 5 elements necessary in the function for the 4 sections."}], "tags": [], "owner": {"reputation": 343, "user_id": 1395518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d1b90f84ba434d5f6b4e67f2d557c1d?s=128&d=identicon&r=PG", "display_name": "Ian Stewart", "link": "https://stackoverflow.com/users/1395518/ian-stewart"}, "is_accepted": false, "score": 0, "last_activity_date": 1462291388, "creation_date": 1462291388, "answer_id": 37009015, "question_id": 37006362, "link": "https://stackoverflow.com/questions/37006362/how-to-get-a-decimal-string-from-a-double-instead-of-scientific-notation-in-hask/37009015#37009015", "title": "How to get a decimal string from a Double instead of scientific notation in Haskell?", "body": "<p>Many thanks for all your comments, now I understand the problem I don't mind using workarounds. The code was to find the lengths of sections of music based on the time each section begins - in the form of 1.28 for 1 minute 28 seconds. Now the result is a list with the timings as strings but that is not a problem. For anyone who is interested, here is the function with the workaround:</p>\n\n<pre><code>subtractMinutes :: RealFrac a =&gt; [a] -&gt; [[Char]]\nsubtractMinutes (x:xs) = take (length (xs)) (zz : subtractMinutes xs)\n    where ya = (head(xs) - x) * 100\n          ys = truncate (head(xs)) - truncate(x)\n          yz = ya - (fromIntegral(ys) * 40)\n          yx = round(yz)\n          za = div yx 60\n          zs = mod yx 60\n          zz = show(za) ++ \".\" ++ zx\n          zx = if zs &lt; 10 then \"0\" ++ show(zs) else show(zs)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1578963980, "post_id": 59726060, "comment_id": 105602727, "body": "That&#39;s just using a different, generally impractical,  numeric type with a different <code>Show</code> instance."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1578980513, "post_id": 59726060, "comment_id": 105605877, "body": "but it solves e.g. <a href=\"https://stackoverflow.com/questions/59664682/weird-behavior-of-(%5E)-in-haskell\">this problem</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1579151274, "post_id": 59726060, "comment_id": 105671401, "body": "@WillNess, yes, but that&#39;s a thoroughly unrelated problem!"}, {"owner": {"reputation": 2331, "user_id": 981979, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/bnTXQ.png?s=128&g=1", "display_name": "Golden Thumb", "link": "https://stackoverflow.com/users/981979/golden-thumb"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1579262863, "post_id": 59726060, "comment_id": 105716848, "body": "@dfeuer the original question has no constraints other than &quot;to avoid scientific notation in decimal output&quot;"}], "tags": [], "owner": {"reputation": 2331, "user_id": 981979, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/bnTXQ.png?s=128&g=1", "display_name": "Golden Thumb", "link": "https://stackoverflow.com/users/981979/golden-thumb"}, "is_accepted": false, "score": 1, "last_activity_date": 1578961920, "creation_date": 1578961920, "answer_id": 59726060, "question_id": 37006362, "link": "https://stackoverflow.com/questions/37006362/how-to-get-a-decimal-string-from-a-double-instead-of-scientific-notation-in-hask/59726060#59726060", "title": "How to get a decimal string from a Double instead of scientific notation in Haskell?", "body": "<p>What works for me is:\ncabal install numbers and then in GHCi</p>\n\n<pre><code>\u03bb: import Data.Number.CReal\n\u03bb: map (/(100 :: CReal)) [29,3,12]\n[0.29,0.03,0.12]\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 1395518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d1b90f84ba434d5f6b4e67f2d557c1d?s=128&d=identicon&r=PG", "display_name": "Ian Stewart", "link": "https://stackoverflow.com/users/1395518/ian-stewart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1966, "favorite_count": 0, "answer_count": 3, "score": 9, "last_activity_date": 1601205812, "creation_date": 1462284029, "last_edit_date": 1601205812, "question_id": 37006362, "link": "https://stackoverflow.com/questions/37006362/how-to-get-a-decimal-string-from-a-double-instead-of-scientific-notation-in-hask", "title": "How to get a decimal string from a Double instead of scientific notation in Haskell?", "body": "<p>I need to divide a list of numbers by 100 to be printed, for example:</p>\n\n<pre><code>map (/100) [29, 3, 12]\n</code></pre>\n\n<p>produces: </p>\n\n<pre><code>[0.29,3.0e-2,0.12]\n</code></pre>\n\n<p>however I need:</p>\n\n<pre><code>[0.29,0.03,0.12]\n</code></pre>\n\n<p>How do I do this in Haskell? Any ideas really appreciated. </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 3, "last_activity_date": 1462274256, "creation_date": 1462274256, "answer_id": 37002652, "question_id": 37002552, "link": "https://stackoverflow.com/questions/37002552/reverse-a-list-in-haskell-3/37002652#37002652", "title": "Reverse a list in haskell 3", "body": "<p>what about this:</p>\n\n<pre><code>interweave :: [a] -&gt; [a]\ninterweave zs = f zs (reverse zs)\n    where f xs ys = concat $ zipWith (\\ x y -&gt; [x,y]) xs ys\n</code></pre>\n\n<p>example</p>\n\n<pre><code>\u03bb&gt; interweave [1..10]\n[1,10,2,9,3,8,4,7,5,6,6,5,7,4,8,3,9,2,10,1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1462274271, "creation_date": 1462274271, "answer_id": 37002655, "question_id": 37002552, "link": "https://stackoverflow.com/questions/37002552/reverse-a-list-in-haskell-3/37002655#37002655", "title": "Reverse a list in haskell 3", "body": "<p>Since this looks like homework, I'll provide a hint.</p>\n\n<p>You need both the original list and the reversed list. Try something like</p>\n\n<pre><code>foo :: [a] -&gt; [a]\nfoo xs = bar xs (reverse xs)\n\nbar :: [a] -&gt; [a] -&gt; [a]\n...\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6221346, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2f23a6abb15d5c6fae71b2df7357307?s=128&d=identicon&r=PG&f=1", "display_name": "Begovic", "link": "https://stackoverflow.com/users/6221346/begovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462292232, "creation_date": 1462273951, "last_edit_date": 1462274390, "question_id": 37002552, "link": "https://stackoverflow.com/questions/37002552/reverse-a-list-in-haskell-3", "title": "Reverse a list in haskell 3", "body": "<h3>example</h3>\n\n<ul>\n<li>Input: <code>[1..10]</code></li>\n<li>Output: <code>[1,10,2,9,3,8,4,7,5,6,6,5,7,4,8,3,9,2,10,1]</code></li>\n</ul>\n\n<p>I tried this</p>\n\n<pre><code>fon(x:y:xs) =reverse (x:xs)\nfun (x:y:xs) = x : (fon xs)\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "compiler-errors"], "comments": [{"owner": {"reputation": 765, "user_id": 3316409, "user_type": "registered", "profile_image": "https://graph.facebook.com/719585406/picture?type=large", "display_name": "dvaergiller", "link": "https://stackoverflow.com/users/3316409/dvaergiller"}, "edited": false, "score": 0, "creation_date": 1462271671, "post_id": 37000675, "comment_id": 61556352, "body": "One problem: you are doing <code>(n-1)</code> where <code>n</code>is a list. You can not perform integer operations on a list."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1462283720, "post_id": 37000675, "comment_id": 61564769, "body": "Why should <code>longListe</code> raise an error instead of returning 0 for an empty list?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6285102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c946576c3ec74327857449f8f74657e?s=128&d=identicon&r=PG&f=1", "display_name": "posh", "link": "https://stackoverflow.com/users/6285102/posh"}, "edited": false, "score": 0, "creation_date": 1462269743, "post_id": 37000827, "comment_id": 61555045, "body": "4-1-a.hs:3:16:     Couldn&#39;t match expected type \u2018Int\u2019 with actual type \u2018[Char]\u2019     In the expression: &quot;Empty liste&quot;     In an equation for \u2018longListe\u2019: longListe [] = &quot;Empty liste&quot;  4-1-a.hs:6:8:     No instance for (Show ([a0] -&gt; Int))       (maybe you haven&#39;t applied enough arguments to a function?)       arising from a use of \u2018print\u2019     In the expression: print     In the expression: print $ longListe     In an equation for \u2018main\u2019: main = print $ longListe Failed, modules loaded: none."}, {"owner": {"reputation": 816, "user_id": 4153209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14bd54eebccc6829e45b653c41b217bd?s=128&d=identicon&r=PG", "display_name": "Thomas Francois", "link": "https://stackoverflow.com/users/4153209/thomas-francois"}, "reply_to_user": {"reputation": 11, "user_id": 6285102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c946576c3ec74327857449f8f74657e?s=128&d=identicon&r=PG&f=1", "display_name": "posh", "link": "https://stackoverflow.com/users/6285102/posh"}, "edited": false, "score": 1, "creation_date": 1462270010, "post_id": 37000827, "comment_id": 61555247, "body": "@posh I assume you removed <code>error</code> in <code>longListe [] = error &quot;Empty liste&quot;</code>. You now have a discrepancy between your return types. Sometimes you return a number, sometime a string (<code>[Char]</code> is equivalent to <code>String</code>). You need to make sure that the values you return are always of the same type."}], "tags": [], "owner": {"reputation": 816, "user_id": 4153209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14bd54eebccc6829e45b653c41b217bd?s=128&d=identicon&r=PG", "display_name": "Thomas Francois", "link": "https://stackoverflow.com/users/4153209/thomas-francois"}, "is_accepted": false, "score": 5, "last_activity_date": 1462270157, "last_edit_date": 1462270157, "creation_date": 1462268805, "answer_id": 37000827, "question_id": 37000675, "link": "https://stackoverflow.com/questions/37000675/how-can-i-be-better-my-code-to-find-out-the-length-of-a-list/37000827#37000827", "title": "How can I be better my code to find out the length of a list?", "body": "<p>The problem lies in the type definition of your function: <code>longListe :: [a] -&gt; a</code>.</p>\n\n<p>It works fine if you call <code>longListe</code> on a list of number. For example, if you call <code>longListe [1,2,3]</code>, the typing will be <code>[Int] -&gt; Int</code>.</p>\n\n<p>However, if you try to get the length of a list of strings, this type becomes <code>[String] -&gt; String</code>. This is <strong>not</strong> what you want, since you want to return a number.</p>\n\n<p>The errors you get indicate that:</p>\n\n<blockquote>\n  <p>No instance for (Num a) arising from the literal \u20181\u2019</p>\n</blockquote>\n\n<p>Since you return a number and do numeric operations with you input, the compiler expects <code>a</code> to be a number hence the error mentioning <code>(Num a)</code>.</p>\n\n<p>If you change the definition to <code>longListe :: [a] -&gt; Int</code>, it should work better (actually it still won't work but for a different reason, but I'll let you try to resolve this yourself since this is the best way to learn).</p>\n\n<p>Also, is there any reason why the empty list should error instead of returning 0?</p>\n"}], "owner": {"reputation": 11, "user_id": 6285102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c946576c3ec74327857449f8f74657e?s=128&d=identicon&r=PG&f=1", "display_name": "posh", "link": "https://stackoverflow.com/users/6285102/posh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462270157, "creation_date": 1462268410, "last_edit_date": 1462269459, "question_id": 37000675, "link": "https://stackoverflow.com/questions/37000675/how-can-i-be-better-my-code-to-find-out-the-length-of-a-list", "title": "How can I be better my code to find out the length of a list?", "body": "<p>I'm doing a code to find out the length of a list, using recursion, but there is a lot of error. I'm a very beginner and I can't very well Haskell.\nHere is the code:</p>\n\n<pre><code>longListe :: [a] -&gt; a\n\nlongListe [] = error \"Empty liste\"\nlongListe [x]= 1\nlongListe n = 1 + longListe (n-1)\nmain = print $ longListe\n</code></pre>\n\n<p>and the errors:</p>\n\n<pre><code> No instance for (Num a) arising from the literal \u20181\u2019\n    Possible fix:\n      add (Num a) to the context of\n        the type signature for longListe :: [a] -&gt; a\n    In the expression: 1\n    In an equation for \u2018longListe\u2019: longListe [x] = 1\n\n4-1-a.hs:6:31:\n    No instance for (Num [a]) arising from a use of \u2018-\u2019\n    In the first argument of \u2018longListe\u2019, namely \u2018(n - 1)\u2019\n    In the second argument of \u2018(+)\u2019, namely \u2018longListe (n - 1)\u2019\n    In the expression: 1 + longListe (n - 1)\n\n4-1-a.hs:7:8:\n    No instance for (Show ([a0] -&gt; a0))\n      (maybe you haven't applied enough arguments to a function?)\n      arising from a use of \u2018print\u2019\n    In the expression: print\n    In the expression: print $ longListe\n    In an equation for \u2018main\u2019: main = print $ longListe\n</code></pre>\n\n<p>can somebody please help me. Thanks </p>\n"}, {"tags": ["haskell", "xmonad"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462274673, "post_id": 37000117, "comment_id": 61558205, "body": "Perhaps, safe coercions: <a href=\"https://wiki.haskell.org/GHC/Coercible\" rel=\"nofollow noreferrer\">wiki.haskell.org/GHC/Coercible</a>"}, {"owner": {"reputation": 196, "user_id": 2051477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdb3f0199a25ddd0e7d1a03822ebb9f6?s=128&d=identicon&r=PG", "display_name": "madidier", "link": "https://stackoverflow.com/users/2051477/madidier"}, "edited": false, "score": 0, "creation_date": 1462281571, "post_id": 37000117, "comment_id": 61562965, "body": "Is the newtype really necessary ? I don&#39;t immediately see why something like <code>type ((f :: (* -&gt; *) -&gt; * -&gt; *) :. (g :: (* -&gt; *) -&gt; * -&gt; *)) l a = f (g l) a</code> wouldn&#39;t work. You wouldn&#39;t need to use <code>Compose</code> then."}, {"owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462295065, "post_id": 37000117, "comment_id": 61572518, "body": "@chi, I tried that. GHC gets confused by types pretty fast, so it requires explicit type annotations, which kinda defeats the purpose."}, {"owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "reply_to_user": {"reputation": 196, "user_id": 2051477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdb3f0199a25ddd0e7d1a03822ebb9f6?s=128&d=identicon&r=PG", "display_name": "madidier", "link": "https://stackoverflow.com/users/2051477/madidier"}, "edited": false, "score": 0, "creation_date": 1462296060, "post_id": 37000117, "comment_id": 61573079, "body": "@lbm, newtype <i>is</i> necessary. Type aliases don&#39;t allow partial application. Take a look at <code>modifyLayout</code> signature. How would I express <code>CC m Window</code> in that case? <code>m</code> is <code>( * -&gt; *) -&gt; * -&gt; *</code>, not <code>* -&gt; *</code> and definitely not <code>*</code>."}, {"owner": {"reputation": 196, "user_id": 2051477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdb3f0199a25ddd0e7d1a03822ebb9f6?s=128&d=identicon&r=PG", "display_name": "madidier", "link": "https://stackoverflow.com/users/2051477/madidier"}, "edited": false, "score": 0, "creation_date": 1462349699, "post_id": 37000117, "comment_id": 61594785, "body": "It seems the alternative would be to use the <code>LiberalTypeSynonyms</code> language extension. It seems to work from my quick experimentations in ghci."}, {"owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "edited": false, "score": 0, "creation_date": 1462351170, "post_id": 37000117, "comment_id": 61595767, "body": "@lbm, with <code>LiberalTypeSynonyms</code>, GHC doesn&#39;t get the idea that <code>m</code> can be arbitrarily nested, so it ends up complaining that it &#39;couldn&#39;t match <code>l</code> with <code>m1 l</code> expected by the context <code>LayoutClass l Window =&gt; l Window -&gt; m l Window</code>&#39;. Which is reasonable, since type is actually <code>LayoutClass l Window =&gt; l Window -&gt; m (m1 l) Window</code>. And it&#39;s exactly the same as <i>without</i> this whole dance around the idea of type composition."}, {"owner": {"reputation": 196, "user_id": 2051477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdb3f0199a25ddd0e7d1a03822ebb9f6?s=128&d=identicon&r=PG", "display_name": "madidier", "link": "https://stackoverflow.com/users/2051477/madidier"}, "edited": false, "score": 0, "creation_date": 1462354623, "post_id": 37000117, "comment_id": 61598132, "body": "What about wrapping your final type transformation chain in a dummy <code>newtype</code> ? For instance <code>newtype CompositionWrapper (f :: (* -&gt; *) -&gt; * -&gt; *) l a = CW (f l a)</code>. I don&#39;t have a fully functional Haskell development environment at the moment, so I can&#39;t test it myself."}, {"owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "reply_to_user": {"reputation": 196, "user_id": 2051477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdb3f0199a25ddd0e7d1a03822ebb9f6?s=128&d=identicon&r=PG", "display_name": "madidier", "link": "https://stackoverflow.com/users/2051477/madidier"}, "edited": false, "score": 0, "creation_date": 1462360499, "post_id": 37000117, "comment_id": 61602324, "body": "@madidier, one can&#39;t even construct <code>CompositionWrapper (M1 :. M2) l a</code> if <code>(:.)</code> is a type synonym, even with <code>LiberalTypeSynonyms</code> (you&#39;ll immediately see why if you try to resolve synonyms yourself). If <code>(:.)</code> is a newtype, <code>CompositionWrapper</code> is entirely pointless."}], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "is_accepted": true, "score": 2, "last_activity_date": 1462486596, "creation_date": 1462486596, "answer_id": 37061192, "question_id": 37000117, "link": "https://stackoverflow.com/questions/37000117/is-there-a-way-to-easily-encapsulate-stack-of-types-f1-f2-f3-fn-t-a/37061192#37061192", "title": "Is there a way to easily encapsulate stack of types &#39;(f1 (f2 (f3 .... fn t))) a&#39; as &#39;F t a&#39;?", "body": "<p>Thanks to Adam Vogt (@aavogt), I was able to finally reach a satisfying conclusion.</p>\n\n<p>I was on the right track with instances of <code>S</code> class. It turns out, reversing instance dependency allows typechecker to infer other instances. However, <code>IncoherentInstances</code> extension is required for recursion termination (i.e. base case).</p>\n\n<p>Here's the code:</p>\n\n<pre><code>instance {-# INCOHERENT #-} S l (m l) m where\n  sq = id\ninstance S l ((f :. g) l') t =&gt; S l (f (g l')) t where\n  sq = squash . (Compose .)\n</code></pre>\n"}], "owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 1, "accepted_answer_id": 37061192, "answer_count": 1, "score": 7, "last_activity_date": 1462486596, "creation_date": 1462266797, "last_edit_date": 1462404398, "question_id": 37000117, "link": "https://stackoverflow.com/questions/37000117/is-there-a-way-to-easily-encapsulate-stack-of-types-f1-f2-f3-fn-t-a", "title": "Is there a way to easily encapsulate stack of types &#39;(f1 (f2 (f3 .... fn t))) a&#39; as &#39;F t a&#39;?", "body": "<p>I've been banging my head against the wall for a while now. I have a bunch of types, which represent transformations over a base type (more specifically, layout modifiers in XMonad).</p>\n\n<p>Long story short, those types all have kind <code>(* -&gt; *) -&gt; * -&gt; *</code>.</p>\n\n<p>What I want to do, for reasons I don't really want to discuss here, is take a stack of these transformations, and represent those as a single transformation over base type (of kind <code>* -&gt; *</code>).</p>\n\n<p>My first idea was to define a type composition operator</p>\n\n<pre><code>newtype ((f :: (* -&gt; *) -&gt; * -&gt; *) :. (g :: (* -&gt; *) -&gt; * -&gt; *)) l a \n        = Compose (f (g l) a)\n</code></pre>\n\n<p>And it works, for the most part. But, given a value, say <code>v :: f1 (f2 (f3 (... (fn l))) a</code>, I have to apply <code>Compose</code> <code>n-1</code> times to it to get <code>v' :: (f1 :. f2 :. ... :. fn) l a</code>, which is not very pretty and kind of annoying.</p>\n\n<p>So, question is, is there a way to automagically apply <code>Compose</code> until I get what I want?</p>\n\n<p>F.ex., now I do something like this:</p>\n\n<pre><code>modifyLayout $ Compose . Compose . Compose . Mirror . avoidStruts .  minimize . smartBorders \n</code></pre>\n\n<p>What I want to do:</p>\n\n<pre><code>modifyLayout' $ Mirror . avoidStruts . minimize . smartBorders\n    where modifyLayout' = modifyLayout . magicCompose\n</code></pre>\n\n<p>A related question: maybe there is a better way to express the same concept?</p>\n\n<p>For reference, <code>modifyLayout</code> is</p>\n\n<pre><code>modifyLayout :: (CC m Window)\n          =&gt; (forall l. (LayoutClass l Window) =&gt; l Window -&gt; m l Window)\n          -&gt; ConfigMonad\n</code></pre>\n\n<p><strong>Clarification (EDIT):</strong></p>\n\n<p>The whole idea behind using type composition is this.</p>\n\n<p>Consider two layout modifiers, </p>\n\n<pre><code>m1 :: LayoutClass l a =&gt; l a -&gt; M1 l a\n</code></pre>\n\n<p>and</p>\n\n<pre><code>m2 :: LayoutClass l a =&gt; l a -&gt; M2 l a\n</code></pre>\n\n<p>If I compose these two, I get</p>\n\n<pre><code>m1m2 :: (LayoutClass l a, LayoutClass (M2 l) a) =&gt; l a -&gt; M1 (M2 l) a\nm1m2 = m1 . m2\n</code></pre>\n\n<p>We can assume there is an <code>instance LayoutClass l a =&gt; LayoutClass (M2 l) a</code>. While at it, also assume there are instances for <code>CC M1 Window</code> and <code>CC M2 Window</code>.</p>\n\n<p>If I now try to feed this into <code>modifyLayout</code> defined above:</p>\n\n<pre><code>modifyLayout m1m2\n</code></pre>\n\n<p>GHC immediately gets confused by nested types and complains:</p>\n\n<pre><code>Couldn't match type \u2018l\u2019 with \u2018M2 l\u2019\n  \u2018l\u2019 is a rigid type variable bound by\n      a type expected by the context:\n        LayoutClass l Window =&gt; l Window -&gt; M1 l Window\nExpected type: l Window -&gt; M1 l Window\n  Actual type: l Window -&gt; M1 (M2 l) Window\n</code></pre>\n\n<p>Using type composition, I can rectify that, since GHC matches <code>M1 :. M2</code> with <code>m</code> in <code>modifyLayout</code> signature, and avoids whole nesting confusion. Type synonyms obviously won't have this property.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>After some poking, I found a partial solution (not sure why I didn't think of it sooner, but oh well)</p>\n\n<p>It's possible to define a typeclass like this</p>\n\n<pre><code>class S l f t | f l -&gt; t where\n  sq :: (l a -&gt; f a) -&gt; (l a -&gt; t l a)\n</code></pre>\n\n<p>Functional dependency ensures that compiler will be able to select instance by itself.</p>\n\n<p>Then, it becomes possible to write instances like this</p>\n\n<pre><code>instance S l (m1 l) m1 where\n  sq = id\ninstance S l (m1 (m2 l)) (m1 :. m2) where\n  sq = sq . (Compose .)\ninstance S l (m1 (m2 (x l))) ((m1 :. m2) :. x) where\n  sq = sq . (Compose .)\ninstance S l (m1 (m2 (m3 (x l)))) (((m1 :. m2) :. m3) :. x) where\n  sq = sq . (Compose .)\n-- etc\n</code></pre>\n\n<p>This partially answers my question: <code>sq</code> encapsulates a transformation stack, provided there's an instance defined for a given level of nesting.</p>\n\n<p>However, these instances seem to beg for recursive instance definition. As of yet, I wasn't able to figure out how exactly that would look. So, any insight is welcome.</p>\n"}, {"tags": ["haskell", "compiler-errors"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462262496, "post_id": 36998591, "comment_id": 61550656, "body": "The output indentation looks fine to me: every recursive call is more indented."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1462263933, "last_edit_date": 1462263933, "creation_date": 1462262001, "answer_id": 36998591, "question_id": 36998516, "link": "https://stackoverflow.com/questions/36998516/what-does-it-mean-not-in-scope-trace-and-how-can-i-resolve-this/36998591#36998591", "title": "What does it mean &quot;Not in scope: \u2018trace&quot; and how can i resolve this?", "body": "<p>The error is telling you that Haskell cannot find the function <code>trace</code> - the problem is, that it's not in the prelude but in the <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Debug-Trace.html#v:trace\" rel=\"nofollow\"><code>Debug.Trace</code></a> module so you have to import this.</p>\n\n<p>The easiest way to do this would be to add</p>\n\n<pre><code>import Debug.Trace \n</code></pre>\n\n<p>below your <code>module</code> definition (if you have one - if not just at the top of the file but blow <code>{-# LANGUAGE ... #-}</code> pragmas (if there are any)</p>\n\n<p>This will import <em>everything</em> from <code>Debug.Trace</code> which I personally don't like (it's hard to find out where a function is defined this way) - that's why I usually prefer to import only the needed functions and definitions (so I can tell where they are coming from) like this:</p>\n\n<pre><code>import Debug.Trace (trace)\n</code></pre>\n\n<p>So a solution to your problem could look like this:</p>\n\n<pre><code>module MyFibModule where\n\nimport Debug.Trace (trace)\n\n-- fib3.hs\nfib   :: Integer -&gt; Integer -&gt; Integer\nfib d n |  trace (shift d ++ \"Call: fib \" ++ show n)\n                     False = 0\nfib _ 0 = 0\nfib _ 1 = 1\nfib d n = fib (d+1) (n-1)\n          + fib (d+1) (n-2)\n\nshift :: Integer -&gt; String\nshift 0 = \"\"\nshift n =  \"   \" ++ shift (n-1)\n\n...\n</code></pre>\n\n<p><strong>voila</strong>:</p>\n\n<pre><code>\u03bb&gt; fib 1 4\n   Call: fib 4\n      Call: fib 2\n         Call: fib 0\n         Call: fib 1\n      Call: fib 3\n         Call: fib 1\n         Call: fib 2\n            Call: fib 0\n            Call: fib 1\n3\n</code></pre>\n\n<hr>\n\n<p>The rest is <strong>off topic</strong> but it might be interesting to you:</p>\n\n<h3>slight rewrite</h3>\n\n<p>I would rewrite this into:</p>\n\n<pre><code>fib   :: Integer -&gt; Integer -&gt; Integer\nfib d 0 = traceIt d 0 $ 0\nfib d 1 = traceIt d 1 $ 1\nfib d n = traceIt d n $ fib (d+1) (n-1) + fib (d+1) (n-2)\n\ntraceIt :: Integer -&gt; Integer -&gt; a -&gt; a\ntraceIt d n = trace (shift d ++ \"Call: fib \" ++ show n)\n\nshift :: Integer -&gt; String\nshift 0 = \"\"\nshift n =  \"   \" ++ shift (n-1)\n</code></pre>\n\n<p>the <strong>guard</strong>-<em>trick</em> there seems to be too much <em>magic</em> IMO (I obviously totally missed the point at first :( ... so you decide: am I to stupid or is the code to arcane to read?)</p>\n\n<h2>don't want to repeat it so much</h2>\n\n<p>In case you don't like that you have to prepend the <code>traceIt d n</code> everywhere (which is nasty yes) you can make <em>fix</em> the recursion with the <code>trace</code>:</p>\n\n<pre><code>fib :: Integer -&gt; Integer\nfib = fib' 0\n\nfib' :: Integer -&gt; Integer -&gt; Integer\nfib' d n = traceIt d n $ fibF (fib' (d+1)) n\n\nfibF :: (Integer -&gt; Integer) -&gt; Integer -&gt; Integer\nfibF _ 0 = 0\nfibF _ 1 = 1\nfibF f n = f (n-1) + f (n-2)\n\ntraceIt :: Integer -&gt; Integer -&gt; a -&gt; a\ntraceIt d n = trace (shift d ++ \"Call: fib \" ++ show n)\n</code></pre>\n\n<h3>example</h3>\n\n<pre><code>\u03bb&gt; fib 4\nCall: fib 4\n   Call: fib 2\n      Call: fib 0\n      Call: fib 1\n   Call: fib 3\n      Call: fib 1\n      Call: fib 2\n         Call: fib 0\n         Call: fib 1\n3\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6255643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0133b22f4ee94a74a7b33257245b7f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ballenavoladora", "link": "https://stackoverflow.com/users/6255643/ballenavoladora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 36998591, "answer_count": 1, "score": 2, "last_activity_date": 1462263933, "creation_date": 1462261743, "question_id": 36998516, "link": "https://stackoverflow.com/questions/36998516/what-does-it-mean-not-in-scope-trace-and-how-can-i-resolve-this", "title": "What does it mean &quot;Not in scope: \u2018trace&quot; and how can i resolve this?", "body": "<p>I'm trying to run a program but i get always this in the terminal fib3.hs:3:12: Not in scope: \u2018trace\u2019 and i don't know what does it mean or how can i resolve this. I'm a ver beginner and haskell...\nmy code</p>\n\n<pre><code>-- fib3.hs\nfib   :: Integer -&gt; Integer -&gt; Integer\nfib d n |  trace (shift d ++ \"Call: fib \" ++ show n)\n                     False = 0\nfib _ 0 = 0\nfib _ 1 = 1\nfib d n = fib (d+1) (n-1)\n          + fib (d+1) (n-2)\n\nshift :: Integer -&gt; String\nshift 0 = \"\"\nshift n =  \"   \" ++ shift (n-1)\n</code></pre>\n"}, {"tags": ["haskell", "nested", "pattern-matching", "bind"], "answers": [{"comments": [{"owner": {"reputation": 1080, "user_id": 1486537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83d1cb88be0e5b1f0da11c38b1f9260a?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/1486537/austin"}, "edited": false, "score": 0, "creation_date": 1462336939, "post_id": 36997327, "comment_id": 61588612, "body": "that totally worked, now like you mentioned I&#39;m trying to convert <code>parseBody</code> to use MaybeT, which I&#39;m also having trouble with. I feel like I&#39;m close, but still can&#39;t get types to match up right  <a href=\"https://gist.github.com/feighter09/be2afa1fb6cb810f9e1c24d79882caf8\" rel=\"nofollow noreferrer\">gist.github.com/feighter09/be2afa1fb6cb810f9e1c24d79882caf8</a>"}, {"owner": {"reputation": 587, "user_id": 1015602, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ea1629e2c2d1d82ab8c3645d82ecc60d?s=128&d=identicon&r=PG", "display_name": "Free_D", "link": "https://stackoverflow.com/users/1015602/free-d"}, "reply_to_user": {"reputation": 1080, "user_id": 1486537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83d1cb88be0e5b1f0da11c38b1f9260a?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/1486537/austin"}, "edited": false, "score": 0, "creation_date": 1462340559, "post_id": 36997327, "comment_id": 61589856, "body": "Why did you change <code>ServerPart</code> to <code>ServerPartT IO</code>?"}, {"owner": {"reputation": 1080, "user_id": 1486537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83d1cb88be0e5b1f0da11c38b1f9260a?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/1486537/austin"}, "edited": false, "score": 0, "creation_date": 1462372641, "post_id": 36997327, "comment_id": 61611859, "body": "<code>ServerPart</code> is an alias for <code>ServerPartT IO</code>, and when I had it as <code>parseBody :: FromJSON a =&gt; MaybeT ServerPart a</code>, I was getting the error: <code>Type synonym \u2018ServerPart\u2019 should have 1 argument, but has been given none</code> <a href=\"https://hackage.haskell.org/package/happstack-server-7.4.6.1/docs/Happstack-Server-Internal-Monads.html#t:ServerPart\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/happstack-server-7.4.6.1/docs/&hellip;</a>"}, {"owner": {"reputation": 1080, "user_id": 1486537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83d1cb88be0e5b1f0da11c38b1f9260a?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/1486537/austin"}, "edited": false, "score": 0, "creation_date": 1462417451, "post_id": 36997327, "comment_id": 61632547, "body": "Figured it out. Got <code>parseBody</code> and <code>saveUser</code> converted to using <code>MaybeT</code> and this works beautifully. Still curious why you think the original version would be better, this exhibits the Railway Oriented Programming I was hoping to achieve"}, {"owner": {"reputation": 587, "user_id": 1015602, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ea1629e2c2d1d82ab8c3645d82ecc60d?s=128&d=identicon&r=PG", "display_name": "Free_D", "link": "https://stackoverflow.com/users/1015602/free-d"}, "reply_to_user": {"reputation": 1080, "user_id": 1486537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83d1cb88be0e5b1f0da11c38b1f9260a?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/1486537/austin"}, "edited": false, "score": 0, "creation_date": 1462417656, "post_id": 36997327, "comment_id": 61632595, "body": "It did end up being more graceful than I expected. But you do lose the differentiation of your error messages."}, {"owner": {"reputation": 1080, "user_id": 1486537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83d1cb88be0e5b1f0da11c38b1f9260a?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/1486537/austin"}, "edited": false, "score": 0, "creation_date": 1462419143, "post_id": 36997327, "comment_id": 61632901, "body": "In this case yes, but I really should be using something like <code>Either User ErrorType</code>, to propogate errors, which would solve that too"}], "tags": [], "owner": {"reputation": 587, "user_id": 1015602, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ea1629e2c2d1d82ab8c3645d82ecc60d?s=128&d=identicon&r=PG", "display_name": "Free_D", "link": "https://stackoverflow.com/users/1015602/free-d"}, "is_accepted": true, "score": 3, "last_activity_date": 1462341218, "last_edit_date": 1462341218, "creation_date": 1462257515, "answer_id": 36997327, "question_id": 36995800, "link": "https://stackoverflow.com/questions/36995800/haskell-bind-with-multiple-monads/36997327#36997327", "title": "Haskell bind with multiple monads", "body": "<p>While I would argue that the original way you have it written is the most readable approach, taking this as an exercise, the MaybeT monad transformer is what you are looking for.</p>\n\n<p>The problem you are running into is that your are trying to jump between the ServerPart monad and the Maybe monad.  This is why you can't directly bind parseBody and saveUser.  Monad transformers allow you to combine monads to avoid this problem.</p>\n\n<pre><code>import Control.Monad.Trans.Maybe\n\npostUser :: ServerPart Response\npostUser = do\n  -- parseBody :: MaybeT ServerPart User\n  -- saveUser :: User -&gt; MaybeT ServerPart (Key User)\n  user &lt;- runMaybeT $ parseBody &gt;&gt;= saveUser\n  case user of\n    Just _ -&gt; successResponse\n    Nothing -&gt; errorResponse \"Error saving user\"\n</code></pre>\n\n<p>You will need to refactor your parseBody and saveUser functions to use the MaybeT monad.  Since I can't see these functions, I can't help you there, but it can usually be done easily using <code>lift</code> from Control.Applicative.</p>\n\n<p>Useful links on monad transformers: </p>\n\n<p><a href=\"https://en.wikibooks.org/wiki/Haskell/Monad_transformers\" rel=\"nofollow\">https://en.wikibooks.org/wiki/Haskell/Monad_transformers</a>\n<a href=\"https://www.schoolofhaskell.com/user/commercial/content/monad-transformers\" rel=\"nofollow\">https://www.schoolofhaskell.com/user/commercial/content/monad-transformers</a></p>\n\n<p>EDIT: MaybeT for parseBody</p>\n\n<pre><code>parseBody :: FromJSON a =&gt; MaybeT ServerPart a\nparseBody = MaybeT $ fmap A.decode getBody\n</code></pre>\n\n<p>And just as a general tip: <code>bar &gt;&gt;= (return . f)</code> is equivalent to <code>fmap f bar</code>.  The latter being cleaner and more general since it does not require the monad instance.</p>\n"}], "owner": {"reputation": 1080, "user_id": 1486537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83d1cb88be0e5b1f0da11c38b1f9260a?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/1486537/austin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 1, "accepted_answer_id": 36997327, "answer_count": 1, "score": 0, "last_activity_date": 1462341218, "creation_date": 1462250918, "last_edit_date": 1462253970, "question_id": 36995800, "link": "https://stackoverflow.com/questions/36995800/haskell-bind-with-multiple-monads", "title": "Haskell bind with multiple monads", "body": "<p>Right now my code looks like this:</p>\n\n<pre><code>postUser :: ServerPart Response\npostUser = do\n  -- parseBody :: ServerPart (Maybe User)\n  parsedUser &lt;- parseBody\n  case parsedUser of\n    Just user -&gt; do\n      -- saveUser :: User -&gt; ServerPart (Maybe (Key User))\n      savedUser &lt;- saveUser user\n      case savedUser of\n        Just user -&gt; successResponse\n        Nothing   -&gt; errorResponse \"user already exists\"\n    Nothing   -&gt; errorResponse \"couldn't parse user\"\n</code></pre>\n\n<p>Which works, but I know there's a way to avoid the nested pattern matching. I thought this was what bind would do for me, so I tried</p>\n\n<pre><code>parseUser :: ServerPart (Maybe User)\naddUser :: User -&gt; ServerPart (Maybe ())\ncase parseUser &gt;&gt;= saveUser of\n  Just _  -&gt; success\n  Nothing -&gt; error\n</code></pre>\n\n<p>and</p>\n\n<pre><code>savedUser &lt;- (parseUser &gt;&gt;= saveUser)\ncase savedUser of\n  Just _  -&gt; success\n  Nothing -&gt; error\n</code></pre>\n\n<p>But I get the following error: </p>\n\n<pre><code>Couldn't match type \u2018Maybe a0\u2019 with \u2018User\u2019\n    Expected type: Maybe a0 -&gt; ServerPartT IO (Maybe (Key User))\n      Actual type: User -&gt; ServerPart (Maybe (Key User))\n    In the second argument of \u2018(&gt;&gt;=)\u2019, namely \u2018saveUser\u2019\n    In the expression: parseBody &gt;&gt;= saveUser\n</code></pre>\n\n<p>which I take to mean <code>&gt;&gt;=</code> is applying <code>saveUser</code> to the <code>Maybe User</code> instead of the <code>User</code> that I need it to, and I'm not sure how to finagle the types to match.\nHow can I rewrite this to avoid the nested pattern matching?</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 0, "creation_date": 1462241477, "post_id": 36994442, "comment_id": 61542894, "body": "Thank you. Could you provide some code for this if it isn&#39;t too much trouble?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 7, "creation_date": 1462241678, "post_id": 36994442, "comment_id": 61542943, "body": "I won&#39;t do that. If you don&#39;t know how to write quickcheck tests at all, have a read through something like <a href=\"https://www.schoolofhaskell.com/user/pbv/an-introduction-to-quickcheck-testing\" rel=\"nofollow noreferrer\">schoolofhaskell.com/user/pbv/&hellip;</a>, and then ask another question about quickcheck in general if you still don&#39;t understand it."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 10, "last_activity_date": 1519152960, "last_edit_date": 1519152960, "creation_date": 1462241143, "answer_id": 36994442, "question_id": 36994342, "link": "https://stackoverflow.com/questions/36994342/generate-test-cases-for-levenshtein-distance-implementation-with-quickcheck/36994442#36994442", "title": "Generate test cases for levenshtein distance implementation with quickCheck", "body": "<p>Getting \"non-reducible\" right sounds pretty hard. I would try to find a larger number of less complicated invariants. Here are some ideas:</p>\n\n<ol>\n<li>The edit distance between any string and itself is 0.</li>\n<li>No two strings have a negative edit distance. </li>\n<li>For an arbitrary string <code>x</code>, if you apply exactly one change to it, producing <code>y</code>, the edit distance between <code>x</code> and <code>y</code> should be 1.</li>\n<li>Given two strings <code>x</code> and <code>y</code>, compute the distance <code>d</code> between them. Then, change <code>y</code>, yielding <code>y'</code>, and compute its distance from <code>x</code>: it should differ from <code>d</code> by at most 1.</li>\n<li>After applying <code>n</code> edits to a string <code>x</code>, the distance between the edited string and <code>x</code> should be at most <code>n</code>. Note that case (1) is a special case of this, where n=0, so you could omit that one for concision if you like. Or, keep it around, since case (1) may generate simpler counterexamples.</li>\n<li>The function should be symmetric: the edit distance from <code>x</code> to <code>y</code> should be the same as from <code>y</code> to <code>x</code>.</li>\n</ol>\n\n<p>If you have another, known-good implementation of the algorithm to test against, you could compare to that, and assert that you always get the same answer as it does.</p>\n\n<p>The above were all just things that appealed to me without any research. You could do more: for example, encode the <a href=\"https://en.wikipedia.org/wiki/Levenshtein_distance#Upper_and_lower_bounds\" rel=\"nofollow noreferrer\">lower and upper bounds as defined by wikipedia</a>.</p>\n"}], "owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1421, "favorite_count": 0, "accepted_answer_id": 36994442, "answer_count": 1, "score": 3, "last_activity_date": 1519152960, "creation_date": 1462240258, "question_id": 36994342, "link": "https://stackoverflow.com/questions/36994342/generate-test-cases-for-levenshtein-distance-implementation-with-quickcheck", "title": "Generate test cases for levenshtein distance implementation with quickCheck", "body": "<p>As part of me learning about <code>quickCheck</code> I want to build a test generator for a levenshtein edit distance implementation. The obvious approach I think is to start with two equal strings and a random non-reducable series of insert/delete/traspose actions, apply that to one of the strings and assert that the levenshtein distance is the length of the random series.</p>\n\n<p>I am quite stuck with this can someone help?</p>\n"}, {"tags": ["haskell", "import", "ghc", "ghci"], "comments": [{"owner": {"reputation": 129, "user_id": 5198356, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ba4271f1b82eccb039694cb6e83beac2?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfe Macfarlane", "link": "https://stackoverflow.com/users/5198356/wolfe-macfarlane"}, "edited": false, "score": 0, "creation_date": 1462238471, "post_id": 36994085, "comment_id": 61542198, "body": "I had a similar problem once. If you load the modules on startup (<code>ghci A.hs B.hs</code>) does it give an error?"}, {"owner": {"reputation": 755, "user_id": 5323311, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh5.googleusercontent.com/-v8SDvlJNQBU/AAAAAAAAAAI/AAAAAAAAAD4/IT0tDo9PwT4/photo.jpg?sz=128", "display_name": "Tshimanga", "link": "https://stackoverflow.com/users/5323311/tshimanga"}, "reply_to_user": {"reputation": 129, "user_id": 5198356, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ba4271f1b82eccb039694cb6e83beac2?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfe Macfarlane", "link": "https://stackoverflow.com/users/5198356/wolfe-macfarlane"}, "edited": false, "score": 0, "creation_date": 1462239429, "post_id": 36994085, "comment_id": 61542430, "body": "Hmm, so I tried it and it works with some caveats. If I start up ghci in the order you suggested then ghci makes the claim that both modules"}, {"owner": {"reputation": 755, "user_id": 5323311, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh5.googleusercontent.com/-v8SDvlJNQBU/AAAAAAAAAAI/AAAAAAAAAD4/IT0tDo9PwT4/photo.jpg?sz=128", "display_name": "Tshimanga", "link": "https://stackoverflow.com/users/5323311/tshimanga"}, "reply_to_user": {"reputation": 129, "user_id": 5198356, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ba4271f1b82eccb039694cb6e83beac2?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfe Macfarlane", "link": "https://stackoverflow.com/users/5198356/wolfe-macfarlane"}, "edited": false, "score": 0, "creation_date": 1462239885, "post_id": 36994085, "comment_id": 61542529, "body": "Hmm, it works with some caveats:  If I start up <code>ghci A.hs B.hs</code> then ghci makes the claim that both modules have been loaded, but then when I actually start trying to interact with the contents only functions and types from A.hs are accessible. I get a not-in-scope error for anything in B.hs.  If I exchange the arguments (start up instead as <code>ghci B.hs A.hs</code>) I can play with the contents of both. This peculiarity is interesting in it&#39;s own right.  Still, the question of understanding why the original approach fails still stands; but, this work-around is appreciated. Thank you @WolfeMacfarlane"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1462240489, "post_id": 36994085, "comment_id": 61542672, "body": "@Tshimanga After running <code>ghci A.hs B.hs</code>, you should be able to switch which module is &quot;visible&quot; using <code>:m</code>, as in <code>:m *A</code> or <code>:m *B</code>."}], "answers": [{"comments": [{"owner": {"reputation": 755, "user_id": 5323311, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh5.googleusercontent.com/-v8SDvlJNQBU/AAAAAAAAAAI/AAAAAAAAAD4/IT0tDo9PwT4/photo.jpg?sz=128", "display_name": "Tshimanga", "link": "https://stackoverflow.com/users/5323311/tshimanga"}, "edited": false, "score": 0, "creation_date": 1462240849, "post_id": 36994345, "comment_id": 61542748, "body": "Ah, I see. That definitely makes sense. Thanks Daniel"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1462240273, "creation_date": 1462240273, "answer_id": 36994345, "question_id": 36994085, "link": "https://stackoverflow.com/questions/36994085/loading-haskell-modules-that-have-dependencies/36994345#36994345", "title": "Loading Haskell Modules that have dependencies", "body": "<p>By default, <code>ghci</code> searches only in the current directory for imported modules. To start with, the current directory is the one used to launch <code>ghci</code>; but it can be changed from within <code>ghci</code> with the <code>:cd</code> command. Thus, you could</p>\n\n<pre><code>&gt; :cd C:\\...path...\\folder\n&gt; :l B.hs\n</code></pre>\n\n<p>and this should find both <code>B.hs</code> and <code>A.hs</code> in what is now the current directory. Alternately (and especially if you have modules in multiple directories) you can launch ghci with the <code>-i</code> command line option to add directories to its module search path. For example, in your command prompt you might</p>\n\n<pre><code>% ghci -iC:\\...path...\\folder\n&gt; :l B.hs\n</code></pre>\n\n<p>which will instruct <code>ghci</code> to include <code>C:\\...path...\\folder</code> in its search path, and therefore find <code>B.hs</code> and <code>A.hs</code> there even if it is not the current directory.</p>\n"}], "owner": {"reputation": 755, "user_id": 5323311, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh5.googleusercontent.com/-v8SDvlJNQBU/AAAAAAAAAAI/AAAAAAAAAD4/IT0tDo9PwT4/photo.jpg?sz=128", "display_name": "Tshimanga", "link": "https://stackoverflow.com/users/5323311/tshimanga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 36994345, "answer_count": 1, "score": 3, "last_activity_date": 1462240273, "creation_date": 1462238155, "question_id": 36994085, "link": "https://stackoverflow.com/questions/36994085/loading-haskell-modules-that-have-dependencies", "title": "Loading Haskell Modules that have dependencies", "body": "<p>I'm unsure what my issue is here. I have a trio of modules A.hs, B.hs, and C.hs. All are located at <code>C:\\..path...\\folder</code> and modules B and C both import from A.</p>\n\n<p>That is, both modules B and C contain the line <code>import A</code></p>\n\n<p>I can <code>:l C:\\..path..\\folder\\A.hs</code> in gchi and play with its contents; however, ghci gives the following error when I try to <code>:l C:\\..path..\\folder\\B.hs</code> or <code>:l C:\\..path..\\folder\\C.hs</code></p>\n\n<pre><code>    Could not find module `A'\n    Use -v to see a list of the files searched for.\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Which I find odd because I had no trouble compiling B.hs to B.exe and running the executable. How can I compile and run a module that I can't load into ghci? Or, why would an import succeed at compile time but fail in loading; especially when that very module being imported is itself load-able?</p>\n"}, {"tags": ["haskell", "vector", "pattern-synonyms"], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1462267334, "post_id": 36994084, "comment_id": 61553440, "body": "I am trying to run functions which <code>f :: Vector a -&gt; a</code> on a vector, but I want to move across the vector and recalculate (while keeping the other values) as each new item is added. ie on <code>[1,2,3,4,5,6,7,8,10]</code>, i want to <code>[f [1], f [1,2], f [1,2,3]..]</code> and so on."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1462269202, "post_id": 36994084, "comment_id": 61554706, "body": "@matthias that&#39;s a <a href=\"https://hackage.haskell.org/package/vector-0.11.0.0/candidate/docs/Data-Vector.html#g:34\" rel=\"nofollow noreferrer\">scan</a>"}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1462270984, "post_id": 36994084, "comment_id": 61555894, "body": "@rampion sorry, I am bit confused. Isn&#39;t a scan a cumulative function that passes a result on to the next iteration? How would I write a scan function for what I have above? I appreciate your help."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1462306691, "post_id": 36994084, "comment_id": 61579362, "body": "It depends on the definition of <code>f</code>. If there exists <code>g</code> s.t. <code>f [a_0...a_i] = g (f [a_0...a_{i-1}]) a_i</code> forall <code>i</code> and <code>b</code> s.t. <code>f [] = b</code>, then <code>scanl g b [a_0 .. a_n]</code> will yield <code>[ f [], f [a_0], f [a_0,a_1], f [a_0, a_1, a_2] ..., f [a_0, a_1, ... a_n ] ]</code>.  Such implementations are often more efficient, as they only need to do <code>O(n)</code> work, rather than <code>O(n^2)</code>."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1462306855, "post_id": 36994084, "comment_id": 61579440, "body": "If not, then what you need is a version of <code>inits</code> for Data.Vector, which wouldn&#39;t be too hard to implement using <a href=\"https://hackage.haskell.org/package/vector-0.11.0.0/candidate/docs/Data-Vector.html#v:init\" rel=\"nofollow noreferrer\"><code>init</code></a>.  <code>inits [ a_0, a_1 ... a_n ] = [ [], [a_0], [a_0, a_1], [a_0, a_1, a_2], ..., [a_0, a_1, ..., a_n] ]</code>, so you could do <code>fmap f . inits</code>."}], "tags": [], "owner": {"reputation": 129, "user_id": 5198356, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ba4271f1b82eccb039694cb6e83beac2?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfe Macfarlane", "link": "https://stackoverflow.com/users/5198356/wolfe-macfarlane"}, "is_accepted": false, "score": 1, "last_activity_date": 1462238155, "creation_date": 1462238155, "answer_id": 36994084, "question_id": 36993937, "link": "https://stackoverflow.com/questions/36993937/haskell-pattern-matching-on-vectors/36994084#36994084", "title": "Haskell pattern matching on vectors", "body": "<p>Vectors aren't intended for that kind of pattern matching--they were created to give Haskell O(1) lists, or lists that can be accessed from any point efficiently.</p>\n\n<p>The closest thing to what you wrote would be something like this:</p>\n\n<pre><code>f v = V.head v\n</code></pre>\n\n<p>Or, if recursion is what you are looking for, the <code>tail</code> function will get the rest of the list.</p>\n\n<p>But if you are trying to do something that moves along a list like that, there are Vector equivalents of functions such as <code>foldl</code>, <code>find</code>, <code>map</code>, and the like. It depends on what you intend to do.</p>\n"}, {"comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 2, "creation_date": 1462239743, "post_id": 36994197, "comment_id": 61542502, "body": "Or you can use a pattern synonym: <code>pattern x ::: xs &lt;- (uncons -&gt; Just (x, xs))</code>"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1462255836, "post_id": 36994197, "comment_id": 61547118, "body": "Is view pattern still needed no we have guard pattern ?"}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1462267066, "post_id": 36994197, "comment_id": 61553273, "body": "I am using functions from the <code>Statistics</code> library, which work on <code>Vectors</code>. So I apparently would have to <code>toList</code> to work over my list then <code>fromList</code> to use the functions? which seems to defeat the point?"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1462268832, "post_id": 36994197, "comment_id": 61554446, "body": "matthias: it depends. Do you want to convert a vector to another vector of the same length? Use <code>fmap</code>.  A single value? Use <code>fold</code>.  A selection of the elements? Use <code>filter</code>. With both lists and vectors, specialized higher-order functions exist to make various tasks both more efficient and easier for others to read."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 9, "last_activity_date": 1462239502, "last_edit_date": 1462239502, "creation_date": 1462239192, "answer_id": 36994197, "question_id": 36993937, "link": "https://stackoverflow.com/questions/36993937/haskell-pattern-matching-on-vectors/36994197#36994197", "title": "Haskell pattern matching on vectors", "body": "<p><code>-XViewPatterns</code> <em>can</em> let you do this:</p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\nmodule VecViewPats where\n\nimport Data.Vector (Vector)\nimport qualified Data.Vector as V\n\nuncons :: Vector a -&gt; Maybe (a, Vector a)\nuncons v = if V.null v\n  then Nothing\n  else Just (V.unsafeHead v, V.unsafeTail v)\n\nvsum :: Num a =&gt; Vector a -&gt; a\nvsum (uncons -&gt; Just (a,av)) = a + vsum av\nvsum (uncons -&gt; Nothing) = 0\n</code></pre>\n\n<p>Or <code>-XLambdaCase</code> </p>\n\n<pre><code>import Control.Category ((&gt;&gt;&gt;))\n-- ...\nvsum :: Num a =&gt; Vector a -&gt; a\nvsum = uncons &gt;&gt;&gt; \\case\n  Just (a,av) -&gt; a + vsum av\n  Nothing     -&gt; 0\n</code></pre>\n\n<p>But honestly, that's seems like a bit of a code smell as you're using one data structure (<code>Vector</code>) as another (<code>[]</code>) which suggests that maybe your choice of data structure is off.</p>\n\n<p>If you really just want to treat it like a list for the purposes of some algorithm, why not use <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Foldable.html#v:toList\"><code>toList</code></a>?</p>\n"}, {"tags": [], "owner": {"reputation": 321, "user_id": 5390900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9da89cedd78fa0c6eb56ee0e94a1f4c2?s=128&d=identicon&r=PG&f=1", "display_name": "L.-T. Chen", "link": "https://stackoverflow.com/users/5390900/l-t-chen"}, "is_accepted": false, "score": 5, "last_activity_date": 1545159268, "last_edit_date": 1545159268, "creation_date": 1545084138, "answer_id": 53823612, "question_id": 36993937, "link": "https://stackoverflow.com/questions/36993937/haskell-pattern-matching-on-vectors/53823612#53823612", "title": "Haskell pattern matching on vectors", "body": "<p>@Cactus has pointed out <code>-XPatternSynonym</code> (introduced in 7.8) combined with <code>-XViewPattern</code> can be used to pattern match on vectors. I am here to extend his comment a bit further. </p>\n\n<pre><code>pattern Empty &lt;- (V.null -&gt; True) \n</code></pre>\n\n<p>The above defines a pattern synonym <code>Empty</code> for the empty vector. The <code>Empty</code> pattern matches against an empty vector using view pattern (<code>V.null -&gt; True</code>). However, it cannot be used as an expression elsewhere, i.e. a <em>uni</em>-directional synonym, since the system doesn't really know what <code>Empty</code> is as a Vector (we only know that <code>null v</code> is <code>True</code> but there could be other vectors giving <code>True</code> as well). </p>\n\n<p>To remedy this, a <code>where</code> clause can be added specifying that Empty actually is a empty vector, i.e. a <em>bi</em>-directional synonym, as well as a type signature:</p>\n\n<pre><code>pattern Empty :: Vector a\npattern Empty &lt;- (V.null -&gt; True) where Empty = V.empty \n</code></pre>\n\n<p>This pattern synonym can be used to define <code>uncons</code> without an if expression:</p>\n\n<pre><code>uncons :: Vector a -&gt; Maybe (a, Vector a)\nuncons Empty = Nothing\nuncons v     = Just (unsafeHead v, unsafeTail v)\n</code></pre>\n\n<p>We use <code>uncons</code> to define uni-directional synonym. Note I don't make it bi-directional since <code>cons</code> is costly for vector:</p>\n\n<pre><code>pattern (:&lt;|)  :: a -&gt; Vector a -&gt; Vector a\npattern x :&lt;| xs &lt;- (uncons -&gt; Just (x, xs))\n</code></pre>\n\n<p>Anyway, we are finally able to pattern match on vectors just like lists:</p>\n\n<pre><code>vsum :: Num a =&gt; Vector a -&gt; a \nvsum Empty = 0\nvsum (x :&lt;| xs) = x + vsum xs\n</code></pre>\n\n<p>A complete code is <a href=\"https://gist.github.com/L-TChen/4c0dc8d270d2b14ee23b392717c91a38\" rel=\"noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1331, "favorite_count": 0, "accepted_answer_id": 36994197, "answer_count": 3, "score": 5, "last_activity_date": 1545159268, "creation_date": 1462236866, "last_edit_date": 1462239661, "question_id": 36993937, "link": "https://stackoverflow.com/questions/36993937/haskell-pattern-matching-on-vectors", "title": "Haskell pattern matching on vectors", "body": "<p>Is it possible to use list style pattern matching on vectors?</p>\n\n<p>ie</p>\n\n<pre><code>import qualified Data.Vector as V\n\nf :: V.Vector a -&gt; a\nf (x:xs) = x \n</code></pre>\n\n<p>gives an error</p>\n"}, {"tags": ["haskell", "pattern-matching", "typechecking", "applicative", "gadt"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1462242869, "post_id": 36993819, "comment_id": 61543242, "body": "How about something like <a href=\"http://stackoverflow.com/a/27838550/477476\">this</a>? See <a href=\"https://gergo.erdi.hu/blog/2015-02-05-typed_embedding_of_stlc_into_haskell/\" rel=\"nofollow noreferrer\">gergo.erdi.hu/blog/&hellip;</a> for an extended explanation."}], "answers": [{"comments": [{"owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "edited": false, "score": 0, "creation_date": 1462246424, "post_id": 36994684, "comment_id": 61544099, "body": "Thanks, you&#39;re right! I thought that was the first thing I tried (causing the &quot;my brain exploded&quot; error), but must have accidentally changed something else at the same time. Guess the whole question was a little pointless.  What do you mean by lose all information though? You can get the values back, and types aren&#39;t needed anymore because the GADT gaurantees they line up.  EDIT: Oh, the reason it&#39;s not over <code>Int</code>s is the language also involves set operations and I&#39;m using <code>+</code> for unions."}, {"owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "edited": false, "score": 0, "creation_date": 1462260486, "post_id": 36994684, "comment_id": 61549577, "body": "Oh nevermind I think I get it. Value-level type tags are needed to know how you can combine the GADTs later when you have more than one. The answer <a href=\"https://stackoverflow.com/questions/30564967/converting-an-untyped-ast-for-a-simple-typed-language-into-a-gadt\">here</a> seems like it would work, but you&#39;re right it&#39;s a little convoluted."}], "tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 0, "last_activity_date": 1462243047, "creation_date": 1462243047, "answer_id": 36994684, "question_id": 36993819, "link": "https://stackoverflow.com/questions/36993819/in-haskell-how-to-parse-an-untyped-ast-to-a-typed-one-based-on-a-gadt/36994684#36994684", "title": "In Haskell, how to parse an untyped AST to a typed one based on a GADT?", "body": "<p>Your exact question is easily answerable with the following solution:</p>\n\n<pre><code>check (UAdd (UNum a) (UNum b)) = Right $ TypedExpr $ TAdd (TNum a) (TNum b)\n</code></pre>\n\n<p>However there's quite a few indications of a design maze there.</p>\n\n<p>Do you realize that once you put something into <code>TypedExpr</code> you lose all the information about the <code>a</code> type? This renders your <code>check</code> function quite pointless.</p>\n\n<p>I understand that you do so because it's the only way you can unify the types of your GADT, and otherwise you can't implement the <code>check</code> function. But actually it just proves that you're modeling things wrong and that GADT might be inappropriate for your use case.</p>\n\n<p>I don't understand why the <code>UAdd</code> constructor is over <code>Untyped</code> values, instead of <code>Int</code>, and I don't understand what made you go with this multi-stage AST strategy.</p>\n\n<p>I could go on, but I'll break here and just recommend you to redesign your model.</p>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 2, "last_activity_date": 1462264129, "last_edit_date": 1495540976, "creation_date": 1462243432, "answer_id": 36994735, "question_id": 36993819, "link": "https://stackoverflow.com/questions/36993819/in-haskell-how-to-parse-an-untyped-ast-to-a-typed-one-based-on-a-gadt/36994735#36994735", "title": "In Haskell, how to parse an untyped AST to a typed one based on a GADT?", "body": "<p>My recommendation would be to use a \"plain\" representation of your universe of types (with an interpretation type function), and then store a <code>Sing</code>leton reification of your existential type in <code>TypedExpr</code>, i.e. something like</p>\n\n<pre><code>{-# LANGUAGE DataKinds, KindSignatures, TypeFamilies #-}\n\ndata Type = TInt | TString\n\ntype family InterpT (a :: Type) where\n  InterpT TInt = Int\n  InterpT TString = String\n\n-- plus the usual singletons stuff\n-- ...\n\n-- and finally\ndata Typed (a :: Type) where ...\n\ndata TypedExpr where\n  TypedExpr :: Sing a -&gt; Typed a -&gt; TypedExpr\n</code></pre>\n\n<p>This way, you can do something like</p>\n\n<pre><code>check (UAdd e1 e2) = do\n  TypedExpr t1 e1' &lt;- check e1\n  TypedExpr t2 e2' &lt;- check e2\n  case testEquality t1 t2 of\n    Just Refl -&gt; ... use e1' and e2' here, you know they have the same Type\n    Nothing -&gt; Left ...\n</code></pre>\n\n<p>Find a fully fleshed-out example <a href=\"https://stackoverflow.com/a/27838550/477476\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "edited": false, "score": 0, "creation_date": 1462291542, "post_id": 36998944, "comment_id": 61570406, "body": "What do you think of <a href=\"http://stackoverflow.com/a/30565412/429898\">this</a>? It adds a separate <code>Type</code> tag to the <code>TypedExpr</code>s (which it calls <code>ETerm</code>s), then checks the tag rather than the constructor used. It seems you only have to define a <code>Type</code> for each possible <i>return</i> type in the DSL that way. For example <code>Add</code> and <code>TNum</code> could both be tagged with <code>Type ReturnsNum</code> (should have picked different names). It still explodes with the number of basic types, but I could probably keep that to just numbers, strings, booleans, and sets of those."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "edited": false, "score": 0, "creation_date": 1462293452, "post_id": 36998944, "comment_id": 61571483, "body": "@Jeff I like that approach."}, {"owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "edited": false, "score": 0, "creation_date": 1462301625, "post_id": 36998944, "comment_id": 61576428, "body": "Thanks, this helped a lot!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": -1, "last_activity_date": 1462264072, "last_edit_date": 1462264072, "creation_date": 1462263240, "answer_id": 36998944, "question_id": 36993819, "link": "https://stackoverflow.com/questions/36993819/in-haskell-how-to-parse-an-untyped-ast-to-a-typed-one-based-on-a-gadt/36998944#36998944", "title": "In Haskell, how to parse an untyped AST to a typed one based on a GADT?", "body": "<p>Technically it <em>is</em> doable, but it's quite inconvenient: you have to \"dig\" until the GADT constructor is found.</p>\n\n<pre><code>check :: Untyped -&gt; Either String TypedExpr\ncheck (UNum n) = return $ TypedExpr $ TNum n\ncheck (UStr s) = return $ TypedExpr $ TStr s\ncheck (UAdd t1 t2) = do\n    t1 &lt;- check t1\n    t2 &lt;- check t2\n    case (t1, t2) of\n      (TypedExpr (TNum x)     , TypedExpr (TNum y))\n         -&gt; return $ TypedExpr $ TAdd (TNum x    ) (TNum y)\n      (TypedExpr (TAdd x1 x2) , TypedExpr (TNum y))\n         -&gt; return $ TypedExpr $ TAdd (TAdd x1 x2) (TNum y)\n      (TypedExpr (TNum x)     , TypedExpr (TAdd y1 y2))\n         -&gt; return $ TypedExpr $ TAdd (TNum x    ) (TAdd y1 y2)\n      (TypedExpr (TAdd x1 x2) , TypedExpr (TAdd y1 y2))\n         -&gt; return $ TypedExpr $ TAdd (TAdd x1 x2) (TAdd y1 y2)\n      _ -&gt; Left \"type error\"\n</code></pre>\n\n<p>I would look for alternatives. The above approach suffers from combinatorial explosion when the number of constructors is large.</p>\n"}], "owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 36998944, "answer_count": 3, "score": 2, "last_activity_date": 1462296472, "creation_date": 1462236081, "last_edit_date": 1495541904, "question_id": 36993819, "link": "https://stackoverflow.com/questions/36993819/in-haskell-how-to-parse-an-untyped-ast-to-a-typed-one-based-on-a-gadt", "title": "In Haskell, how to parse an untyped AST to a typed one based on a GADT?", "body": "<p>I'm writing a domain-specific language in Haskell, and have settled on\na design with two ASTs: an initial untyped one that represents syntax and\na final typed one that represents everything. I'm writing the final one as\na GADT to get better typechecking.</p>\n\n<p>I think it's <em>almost</em> working, but I'm having trouble writing a function that\nconverts initial -> final (checks the types, plus some other things not shown,\nlike all references correspond to a variable).</p>\n\n<p>Here's a simplified example:</p>\n\n<pre><code>{-# LANGUAGE GADTs, StandaloneDeriving #-}\n\nmodule Main where\n\n-- untyped initial AST\n\ndata Untyped\n  = UNum Int\n  | UStr String\n  | UAdd Untyped Untyped\n  deriving (Show, Eq)\n\n-- typed final AST\n\ndata Typed a where\n  TNum :: Int    -&gt; Typed Int\n  TStr :: String -&gt; Typed String\n  TAdd :: Typed Int -&gt; Typed Int -&gt; Typed Int\n\nderiving instance Eq   (Typed a)\nderiving instance Show (Typed a)\n\n-- wrapper that allows working with a `Typed a` for any `a`\ndata TypedExpr where\n  TypedExpr :: Typed a -&gt; TypedExpr\n</code></pre>\n\n<p>And this is my attempt at the <code>check</code> function. The base cases are simple:</p>\n\n<pre><code>check :: Untyped -&gt; Either String TypedExpr\ncheck (UNum n) = Right $ TypedExpr $ TNum n\ncheck (UStr s) = Right $ TypedExpr $ TStr s\n-- check (Uadd e1 e2) = ???\n</code></pre>\n\n<p>But how do I add <code>Add</code>? It can recursively evaluate the sub-expressions to\nvalues of type <code>Either String (TypedExpr (Typed a))</code>, but I haven't managed to\nunwrap those, check that the types line up (both <code>a</code>s should be <code>Int</code>s), and\nre-wrap afterward. I planned to do it all with big pattern matches, but GHC\ndoesn't approve:</p>\n\n<pre><code>My brain just exploded\n  I can't handle pattern bindings for existential or GADT data constructors.\n  Instead, use a case-expression, or do-notation, to unpack the constructor.\n</code></pre>\n\n<p>That's explained <a href=\"https://stackoverflow.com/questions/23531566/odd-ghc-error-message-my-brain-just-exploded\">here</a>, but I didn't understand the explanation. It seems\nI don't want pattern matching.</p>\n\n<p>Update: I must have messed something else up without noticing. Pattern matching works, as shown by Nikita.</p>\n\n<p>So I fiddled around trying to force things into\nthe right shape, but haven't gotten anything substantial yet. If these were\njust <code>Either String SomeValue</code> I would want to use applicatives, right? Is it\npossible to add another level of unwrapping + type checking to them? I suspect <a href=\"https://stackoverflow.com/a/30565412/429898\">this answer</a> is close to what I want since the question is very similar, but again I don't understand it. <a href=\"https://stackoverflow.com/questions/12944498/how-to-parse-string-into-gadt\">This</a> may also be related.</p>\n\n<p>Update: <a href=\"https://stackoverflow.com/a/30565412/429898\">That first answer</a> is just what I wanted after all. But I couldn't see how until chi wrote the intermediate version below without the extra <code>Type</code> type. Here's a working solution. The trick was to tag <code>TypedExpr</code>s with a new type representing just the <em>return</em> type (<code>a</code>) of a <code>Typed a</code>:</p>\n\n<pre><code>data Returns a where\n  RNum :: Returns Int\n  RStr :: Returns String\n\n-- extend TypedExpr to include the return type\ndata TypedExpr2 where\n  TypedExpr2 :: Returns a -&gt; Typed a -&gt; TypedExpr2\n</code></pre>\n\n<p>That way <code>check</code> doesn't have to know whether each subexpression is a raw\n<code>TNum</code> or a function (like <code>Add</code>) that returns a <code>TNum</code>:</p>\n\n<pre><code>check :: Untyped -&gt; Either String TypedExpr2\ncheck (UNum n) = Right $ TypedExpr2 RNum (TNum n)\ncheck (UStr s) = Right $ TypedExpr2 RStr (TStr s)\ncheck (UAdd u1 u2) = do\n  -- typecheck subexpressions, then unwrap by pattern matching\n  TypedExpr2 r1 t1 &lt;- check u1\n  TypedExpr2 r2 t2 &lt;- check u2\n  -- check the tags to find out their return types\n  case (r1, r2) of\n    -- if correct, create an overall expression tagged with its return type\n    (RNum, RNum) -&gt; return $ TypedExpr2 RNum $ TAdd t1 t2\n    _ -&gt; Left \"type error\"\n</code></pre>\n\n<p>GHC is smart enough to know that the two <code>a</code>s in any <code>TypedExpr2</code> must match,\nso it catches you if you attempt to use the wrong overall return type at the\nend. Wonderful!</p>\n"}, {"tags": ["haskell", "riak"], "answers": [{"tags": [], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "is_accepted": true, "score": 1, "last_activity_date": 1462371099, "last_edit_date": 1462371099, "creation_date": 1462288881, "answer_id": 37008128, "question_id": 36993458, "link": "https://stackoverflow.com/questions/36993458/crdt-ops-for-map-in-haskell-riak-client/37008128#37008128", "title": "CRDT ops for Map in Haskell Riak client", "body": "<p>I figured out how to do this. <code>xpath</code> in <code>Map</code> seems to be a recursive selector to access fields deeply buried in another map within map. So, for top-level field within a map, <code>xpath</code> will be just that fieldname. Thus, the solution becomes:</p>\n\n<pre><code>-- get the connection to 127.0.0.1:8087\nconn &lt;- connect defaultClient \n\n-- xpath here is just \"username\" fieldname - we use RegisterSet operation\n-- Alternatively, for xpath value, you can do: (\"username\" :| []), especially, if\n-- passing it as argument in a function\nlet op = \"username\" `mapUpdate` RegisterSet \"test\" \n\n\n-- send off the above operation to create/update the map\nsendModify conn \"mapbucket\" \"uinfo\" \"test1\" [op] \n</code></pre>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 37008128, "answer_count": 1, "score": 1, "last_activity_date": 1462371099, "creation_date": 1462233460, "question_id": 36993458, "link": "https://stackoverflow.com/questions/36993458/crdt-ops-for-map-in-haskell-riak-client", "title": "CRDT ops for Map in Haskell Riak client", "body": "<p>How would one create a simple <code>Riak CRDT Map</code> containing a <code>Register</code> name <code>username</code> and value <code>test</code>? I am looking at this <a href=\"http://haddock.stackage.org/nightly-2016-05-02/riak-1.0.0.1/Network-Riak-CRDT.html\" rel=\"nofollow\">documentation here</a> but don't understand how <code>XPath</code> and name of the register in a map are connected. </p>\n\n<p>Here is what I will like to do: create/update a <code>Map</code> with <code>Register</code> name <code>username</code> and value <code>test</code> (under bucket type <code>mapbucket</code>, bucket <code>uinfo</code>, key <code>test1</code>). Here is how Erlang client will do that (not tested - modified copy-paste from another code I wrote):</p>\n\n<pre><code>  Map = riakc_map:new(),\n  Map1 = riakc_map:update({&lt;&lt;\"username\"&gt;&gt;, register},\n                         fun(R) -&gt; riakc_register:set(&lt;&lt;\"test\"&gt;&gt;, R) end,\n                         Map),\n  {ok, Pid} = riakc_pb_socket:start_link(\"127.0.0.1\", 8087),\n  riakc_pb_socket:update_type(Pid,{&lt;&lt;\"mapbucket\"&gt;&gt;,&lt;&lt;\"uinfo\"&gt;&gt;},\"test1\",riakc_map:to_op(Map1))\n</code></pre>\n\n<p>I searched github code repository, but couldn't find any example of doing it in Haskell Riak client. I will very much appreciate it if any one with familiarity with Haskell Riak client, and <code>CRDT</code> ops could provide pointers on how to do something like above.</p>\n"}, {"tags": ["haskell", "haskell-snap-framework", "httpexception"], "answers": [{"tags": [], "owner": {"reputation": 255, "user_id": 681337, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/be5e0ffb42be5e3337208ae8c9679bb4?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/681337/neil"}, "is_accepted": true, "score": 0, "last_activity_date": 1462248707, "creation_date": 1462248707, "answer_id": 36995469, "question_id": 36993372, "link": "https://stackoverflow.com/questions/36993372/catch-httpexception-within-snap-handler/36995469#36995469", "title": "Catch HTTPException within Snap Handler", "body": "<p>Problem solved, I used <code>try</code> from MonadCatchIO-transformers and that worked.</p>\n"}], "owner": {"reputation": 255, "user_id": 681337, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/be5e0ffb42be5e3337208ae8c9679bb4?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/681337/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 36995469, "answer_count": 1, "score": 1, "last_activity_date": 1462252035, "creation_date": 1462232846, "last_edit_date": 1462252035, "question_id": 36993372, "link": "https://stackoverflow.com/questions/36993372/catch-httpexception-within-snap-handler", "title": "Catch HTTPException within Snap Handler", "body": "<p>Within one of my snap handlers I am calling an external resource over HTTP using http-client, which can throw an <code>HttpException</code>. In the simplest case, I just want to catch the error and write to std out while I debug; however, I am having a tough time getting the types lined up.</p>\n\n<pre><code>assignCategories' :: String -&gt; [String] -&gt; Handler App (AuthManager App) String\nassignCategories' l_id cats  = do\n            let baseAttribs = M.fromList [(\"id\",l_id)]                                                            \n            let saveQuery = WMSaveObject {baseAttributesSO= baseAttribs ,relatedSO=relatedObjects}\n\n            -- this is the function that can throw an HTTPException            \n            -- runWMSave :: WMQueryObj -&gt; Handler App (AuthManager App) String\n\n            saveresponse &lt;- try $ H.runWMSave saveQuery\n            return $ case saveresponse of\n                Left  e -&gt; show (e :: HttpException)\n                Right r -&gt; r\n</code></pre>\n\n<p>I've played around with the types, but am generally getting errors like below... is there a best practice for calling HTTP within a handler and catching exceptions? </p>\n\n<p>I'm using Control.Monad.Catch. I tried using Control.Exception's <code>try</code>, but had even more difficulties getting types lined up.</p>\n\n<pre><code>   No instance for (Control.Monad.Catch.MonadCatch\n                       (Handler App (AuthManager App)))\n      arising from a use of \u2018try\u2019\n    In the expression: try\n    In a stmt of a 'do' block:\n      saveresponse &lt;- try $ H.runWMSave saveQuery\n    In the expression:\n      do { liftIO $ putStrLn l_id;\n           let baseAttribs = M.fromList ...;\n           let relatedObjects = concatMap makeRelatedRow cats;\n           let saveQuery = ...;\n           .... }\n</code></pre>\n\n<p>Thanks,\nNeil</p>\n"}, {"tags": ["haskell", "quickcheck", "hspec"], "comments": [{"owner": {"reputation": 7136, "user_id": 1467115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81bee3c36aa1c59317d525baabecec11?s=128&d=identicon&r=PG", "display_name": "Jan Gerlinger", "link": "https://stackoverflow.com/users/1467115/jan-gerlinger"}, "edited": false, "score": 1, "creation_date": 1462272903, "post_id": 36992969, "comment_id": 61557103, "body": "Could you wrap <code>Int</code> in a <code>newtype</code> and provide a <code>Bounded</code> instance with your custom bounds? Then you could probably use QuickCheck&#39;s <a href=\"http://haddock.stackage.org/lts-5.15/QuickCheck-2.8.1/Test-QuickCheck-Arbitrary.html#g:2\" rel=\"nofollow noreferrer\"><code>arbitraryBoundedIntegral :: (Bounded a, Integral a) =&gt; Gen a</code></a>."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "reply_to_user": {"reputation": 7136, "user_id": 1467115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81bee3c36aa1c59317d525baabecec11?s=128&d=identicon&r=PG", "display_name": "Jan Gerlinger", "link": "https://stackoverflow.com/users/1467115/jan-gerlinger"}, "edited": false, "score": 0, "creation_date": 1462293117, "post_id": 36992969, "comment_id": 61571295, "body": "I&#39;ll give that a try."}], "answers": [{"tags": [], "owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "is_accepted": true, "score": 1, "last_activity_date": 1462377466, "last_edit_date": 1462377466, "creation_date": 1462339312, "answer_id": 37019094, "question_id": 36992969, "link": "https://stackoverflow.com/questions/36992969/controlling-how-test-data-is-generated-in-quickcheck-2/37019094#37019094", "title": "Controlling how test data is generated in QuickCheck 2", "body": "<p>while finding out about the <code>Bounded</code> typeclass was useful for another project, I have agreed with opinions from the Haskell Cafe <sup> 1 </sup> mailing list Int in a <code>newtype</code> is heavy-handed and so have decided to solve the problem in the following way.</p>\n\n<pre><code>qcheck :: Spec\nqcheck = do\n  describe \"QuickCheck testing fizbuzz\"     $\n    modifyMaxSuccess (const 1000)           $\n    prop  \"Lowerbound: 0 Upperbound: 10000\" $\n    forAll (choose (1, 10000)) modfiz\n\n  describe \"QuickCheck test fibonacci generator\" $\n    modifyMaxSuccess (const 1000)                $\n    prop \"Lowerbound: 0 Upperbound: 10000\"       $\n    forAll (choose (1, 10000)) testfib\n</code></pre>\n\n<p><sup> 1 </sup> <a href=\"https://groups.google.com/forum/#!topic/haskell-cafe/y81Q5fXil34\" rel=\"nofollow\">https://groups.google.com/forum/#!topic/haskell-cafe/y81Q5fXil34</a></p>\n"}], "owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 37019094, "answer_count": 1, "score": 2, "last_activity_date": 1462377466, "creation_date": 1462230129, "last_edit_date": 1495540363, "question_id": 36992969, "link": "https://stackoverflow.com/questions/36992969/controlling-how-test-data-is-generated-in-quickcheck-2", "title": "Controlling how test data is generated in QuickCheck 2", "body": "<p>I have a problem similar to this question <a href=\"https://stackoverflow.com/questions/9977734/controlling-how-test-data-is-generated-in-quickcheck\">Controlling how test data is generated in QuickCheck</a>. Below I will articulate my specifics, the code I am using, and the particular question I have.</p>\n\n<p>I have written a fizz-buzz program that uses a Fibonacci sequence as input.\nI would like to test two things. (1) Does my program emit the correct string given an Int that meets a particular condition. (2) Is my Fibonacci generator generating Fibonacci numbers?</p>\n\n<p>The problem I am having is similar to the link above. The range of <code>Int</code>s is too large. How do I constrain my tests to say, the first 1000 Fibonacci numbers?</p>\n\n<p>Here is code that I think is both adequate and minimal. Please let me know if I need to elaborate.</p>\n\n<pre><code>import           Data.Numbers.Primes (isPrime)\nimport           Test.Hspec  (Spec,hspec,describe,it,shouldBe)\nimport           Test.Hspec.QuickCheck (prop)\n\nqcheck :: Spec\nqcheck = do\n  describe \"QuickCheck test fiz\" $\n    prop \"QuickCheck test\" $ modfiz\n\n  describe \"QuickCheck test fib\" $\n    prop \"QuickCheck test fib\" $ testfib\n\nmodfiz int\n  | int &lt;= 0                                 = True  -- code smell, should never generate number less than or equal to zero.\n  | int == 3                                 = test3\n  | int == 5                                 = test5\n  | int `mod` 15 == 0                        = testMod35\n  | int `mod` 3 == 0                         = testMod3\n  | int `mod` 5 == 0                         = testMod5\n  | isPrime int == True                      = testPrime\n  | otherwise                                = testRest\n      where\n        test3     =\n          Right \"Buzz BuzzFizz\"     == fizzbuzz 3\n        test5     =\n          Right \"Fizz BuzzFizz\"     == fizzbuzz 5\n        testMod3  =\n          Right \"Buzz \"             == fizzbuzz int\n        testMod5  =\n          Right \"Fizz \"             == fizzbuzz int\n        testMod35 =\n          Right \"Buzz Fizz \"        == fizzbuzz int\n        testPrime =\n          Right \"BuzzFizz\"          == fizzbuzz int\n        testRest  =\n          Right (show int)          == fizzbuzz int\n\ntestfib :: Integer -&gt; Bool\ntestfib n =\n  case (fibb n) of\n    Left _ -&gt; False\n    Right n' -&gt; isFib n'\n</code></pre>\n\n<p><code>fibb</code> takes an <code>Int</code> and finds that nth Fibonacci. So <code>fibb 6</code> would return <code>Right 8</code>. The <code>Left</code> value is not relevant to this problem.</p>\n\n<p>What I noticed was the answer suggested that one should write a <code>newtype</code>, wrapping a <code>[Int]</code> and making a new <code>Arbitrary</code> instance. However, I also noticed that the answer is from 2012, and <code>QuickCheck 2</code> has an <code>Args</code> <code>datatype</code> that appears to be able to do what I need. So, can I create a new <code>Args</code> to limit the range of tests, (just want the first 1000 Fibonacci numbers), and also to limit the number of tests run? If not is the solution from the above link the approach I would have to take?</p>\n\n<p><a href=\"https://github.com/mlitchard/swiftfizz\" rel=\"nofollow noreferrer\">the entire project here</a></p>\n"}, {"tags": ["haskell", "functional-programming", "type-inference", "static-typing"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1462225874, "post_id": 36992158, "comment_id": 61538706, "body": "Look up the monomorphism restriction."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1462227028, "post_id": 36992158, "comment_id": 61539088, "body": "The dreaded monomorphism restriction: <a href=\"http://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\" title=\"what is the monomorphism restriction\">stackoverflow.com/questions/32496864/&hellip;</a>"}], "owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1462227079, "answer_count": 0, "score": 0, "last_activity_date": 1462225457, "creation_date": 1462225457, "question_id": 36992158, "link": "https://stackoverflow.com/questions/36992158/haskell-newbie-gotcha-why-does-this-%ce%b7-reduction-change-type-inference", "closed_reason": "Duplicate", "title": "Haskell newbie gotcha: why does this \u03b7-reduction change type inference?", "body": "<p>Learning Haskell right now and stumbled upon this oddity. Consider:</p>\n\n<pre><code>main = do\n    print $ mysquare 2\n    print $ mysquare 2.0\n</code></pre>\n\n<p>Output with</p>\n\n<pre><code>-- style A:\nmysquare x = x * x\n</code></pre>\n\n<p>is <strong>4</strong> and <strong>4.0</strong>. Likewise, output with</p>\n\n<pre><code>-- style B:\nmysquare x = x ^ 2\n</code></pre>\n\n<p>is <strong>4</strong> and <strong>4.0</strong>. But output with</p>\n\n<pre><code>-- style C:\nmysquare = (^2)\n</code></pre>\n\n<p>is <strong>4.0</strong> and <strong>4.0</strong>.</p>\n\n<p>I wouldn't have expected from my beginner understanding so far that \u03b7-reducing style B into style C would silently change the Int into a Fractional. Why does that occur?</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 3, "creation_date": 1462214899, "post_id": 36989449, "comment_id": 61533202, "body": "Huh. Could you explain <i>why</i> I need that here? The docs just seem to imply that type variables are not brought in scope unless you use <code>forall</code>; is that correct?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1462219223, "post_id": 36989449, "comment_id": 61535548, "body": "@AlexisKing Correct. The default is to preserve the without-extensions behaviour, so that old code (without explicit foralls) will not suddenly stop working because an extension was turned on."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1462235179, "post_id": 36989449, "comment_id": 61541393, "body": "@chi is correct. The result is that this is very much a &quot;gotcha&quot; situation\u2014the behavior that @AlexisKing expects is the way it ideally should work. (Actually, given how often I have to turn it on, I&#39;d say that <code>ScopedTypeVariables</code> should have been the default, not an extension!)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1462260315, "post_id": 36989449, "comment_id": 61549477, "body": "@LuisCasillas I totally agree. The original Haskell definition got this wrong IMHO, and now changing the default could break old code. (Albeit I do wonder how much code would be broken... It would not be the first time GHC breaks retro-compatibility for the greater good)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462300067, "post_id": 36989449, "comment_id": 61575414, "body": "I&#39;ve seen code break when <code>ScopedTypeVariables</code> is turned on because it also brings variables in instance heads into scope in their bodies. Personally, I&#39;d still like to see it in the standard, and I know that at least one member of the new language committee agrees."}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 7, "last_activity_date": 1470984662, "last_edit_date": 1470984662, "creation_date": 1462214789, "answer_id": 36989449, "question_id": 36989329, "link": "https://stackoverflow.com/questions/36989329/why-does-this-function-that-uses-a-scoped-type-variable-in-a-where-clause-not-ty/36989449#36989449", "title": "Why does this function that uses a scoped type variable in a where clause not typecheck?", "body": "<p>You need an <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#lexically-scoped-type-variables\" rel=\"nofollow\">explicit forall</a>:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nimport Control.Monad.Trans.Except\nimport Data.Functor.Identity\n\nf :: forall a. ExceptT String Identity a -&gt; Maybe a\nf m = Nothing\n  where x :: Identity (Either String a)\n        x = runExceptT m\n</code></pre>\n\n<h2><em>but why</em></h2>\n\n<p>That is a great question. This appears to be a rule of <code>ScopedTypeVariables</code>. We know in GHC Haskell that all top-level variables are implicitly <code>forall</code>'d, as documented <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#decl-type-sigs\" rel=\"nofollow\">here</a>. One would suspect that the GHC devs added this behavior for backwards compatibility: without this rule, a file without the extension turned on could stop type-checking once the extension was turned on. We can easily imagine a scenario where helper functions declared in the <code>where</code> block to inadvertently reuse the common type variable names <code>a, b, c, t</code>, so on. It would be great if someone could find the exact spot in the GHC source code where this distinction between explicit and implicit <code>forall</code>'d variables arose.</p>\n\n<h2><em>update</em></h2>\n\n<p>Here we go (although this is all guesswork from the comments and grepping):</p>\n\n<ul>\n<li><p>While type-checking user signatures, the function <code>tcUserTypeSig</code> invokes <code>findScopedTyVars</code>. <a href=\"https://github.com/ghc/ghc/blob/ef44606/compiler/typecheck/TcBinds.hs#L1786\" rel=\"nofollow\">TcBinds.hs:ef44606:L1786</a></p></li>\n<li><p><code>findScopedTyVars</code> in <code>TcRnTypes</code> filters for <code>forall</code>s by calling <code>tcSplitForAllTys</code>. <a href=\"https://github.com/ghc/ghc/blob/ef44606692e731c9be45df5ee6819e0912f37a58/compiler/typecheck/TcRnTypes.hs#L1221\" rel=\"nofollow\">TcRnTypes.hs:ef44606:L1221</a></p></li>\n<li><p>Which is a wrapper around <code>splitForAllTys</code>, which folds over a type's subtypes to build up a list of type variables introduced by <code>forall</code>s. <a href=\"https://github.com/ghc/ghc/blob/ef44606692e731c9be45df5ee6819e0912f37a58/compiler/types/Type.hs#L1361\" rel=\"nofollow\">Types/Type.hs:ef44606:L1361</a></p></li>\n</ul>\n\n\n"}], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 1, "accepted_answer_id": 36989449, "answer_count": 1, "score": 7, "last_activity_date": 1470984662, "creation_date": 1462214373, "question_id": 36989329, "link": "https://stackoverflow.com/questions/36989329/why-does-this-function-that-uses-a-scoped-type-variable-in-a-where-clause-not-ty", "title": "Why does this function that uses a scoped type variable in a where clause not typecheck?", "body": "<p>I have a function that has a value defined in a <code>where</code> clause, and I want to give it an explicit type annotation. The annotation needs to use a type variable from the top-level function, so it was my understanding that I needed to use <code>ScopedTypeVariables</code>. Here is a minimal reduction of the problem:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nimport Control.Monad.Trans.Except\nimport Data.Functor.Identity\n\nf :: ExceptT String Identity a -&gt; Maybe a\nf m = Nothing\n  where x :: Identity (Either String a)\n        x = runExceptT m\n</code></pre>\n\n<p>This code does <em>not</em> typecheck. It fails with the following error message:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Couldn't match type \u2018a\u2019 with \u2018a1\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n      the type signature for f :: ExceptT String Identity a -&gt; Maybe a\n      at src/Lib.hs:20:6\n  \u2018a1\u2019 is a rigid type variable bound by\n       the type signature for x :: Identity (Either String a1)\n       at src/Lib.hs:22:14\nExpected type: ExceptT String Identity a1\n  Actual type: ExceptT String Identity a\nRelevant bindings include\n  x :: Identity (Either String a1) (bound at src/Lib.hs:23:9)\n  m :: ExceptT String Identity a (bound at src/Lib.hs:21:3)\n  f :: ExceptT String Identity a -&gt; Maybe a\n    (bound at src/Lib.hs:21:1)\nIn the first argument of \u2018runExceptT\u2019, namely \u2018m\u2019\nIn the expression: runExceptT m\n</code></pre>\n\n<p>Why does this fail? I do not understand why this would cause problems\u2014it seems like a textbook use of scoped type variables. For reference, I am using GHC 7.10.3.</p>\n"}, {"tags": ["list", "haskell", "swap"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1462207223, "post_id": 36987343, "comment_id": 61529150, "body": "maybe you want to use <code>map swap</code> instead of just <code>swap</code> for your list of lists"}, {"owner": {"reputation": 91, "user_id": 5612864, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd89ca99dd06f72379d1b1ae7240e4ec?s=128&d=identicon&r=PG&f=1", "display_name": "PythonUserNew", "link": "https://stackoverflow.com/users/5612864/pythonusernew"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462208132, "post_id": 36987343, "comment_id": 61529642, "body": "oh my, thanks. Didn&#39;t expect it to be that simple :)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1462214275, "post_id": 36987343, "comment_id": 61532867, "body": "What do you mean with <i>turns around</i>. Your <code>swap</code> function only swaps <code>head</code> and <code>last</code> of the list."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 1, "last_activity_date": 1462214485, "last_edit_date": 1462214485, "creation_date": 1462211854, "answer_id": 36988639, "question_id": 36987343, "link": "https://stackoverflow.com/questions/36987343/haskell-swap-nested-list/36988639#36988639", "title": "Haskell swap nested list", "body": "<p><code>swap</code> takes a list of things, and exchanges its first element for its last. Since there is nothing in there about looking <em>inside</em> of those elements at all, it definitely will not modify any of the elements inside of a list.</p>\n\n<p>But if you have a list of things, and you want to perform some modification of each item in the list, there is a function for that already: <code>map</code>. And the modification you want to perform is <code>swap</code>, so let's see how the types line up.</p>\n\n<pre><code>     map :: (  a -&gt;   b) -&gt;   [a] -&gt;   [b]\n    swap ::  [a] -&gt; [a]\nmap swap ::                 [[a]] -&gt; [[a]]\n</code></pre>\n\n<p>So <code>map swap</code> takes a list of lists, and swaps each of those sublists, without changing the order of the \"larger\" list at all.</p>\n"}], "owner": {"reputation": 91, "user_id": 5612864, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd89ca99dd06f72379d1b1ae7240e4ec?s=128&d=identicon&r=PG&f=1", "display_name": "PythonUserNew", "link": "https://stackoverflow.com/users/5612864/pythonusernew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462214485, "creation_date": 1462207121, "last_edit_date": 1462213829, "question_id": 36987343, "link": "https://stackoverflow.com/questions/36987343/haskell-swap-nested-list", "title": "Haskell swap nested list", "body": "<p>I have this function:</p>\n\n<pre><code>swap [] = []\nswap [a] = [a] \nswap a = last a : (init . tail $ a) ++ [head a] \n</code></pre>\n\n<p>If I use this on a list with lists, it just turns each list around, and not the elements in each list. What am I missing here?</p>\n"}, {"tags": ["haskell", "types", "composition"], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 4338219, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wx0C79DukHg/AAAAAAAAAAI/AAAAAAAAAT4/a96VO7CSDsE/photo.jpg?sz=128", "display_name": "Stephen Pascoe", "link": "https://stackoverflow.com/users/4338219/stephen-pascoe"}, "edited": false, "score": 0, "creation_date": 1462212525, "post_id": 36987734, "comment_id": 61531979, "body": "Excellent, thanks! or <code>fmap Compose $ (traverse . traverse) f1 fga</code>, which I find shows the double traversal more clearly."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "reply_to_user": {"reputation": 405, "user_id": 4338219, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wx0C79DukHg/AAAAAAAAAAI/AAAAAAAAAT4/a96VO7CSDsE/photo.jpg?sz=128", "display_name": "Stephen Pascoe", "link": "https://stackoverflow.com/users/4338219/stephen-pascoe"}, "edited": false, "score": 1, "creation_date": 1462249849, "post_id": 36987734, "comment_id": 61544937, "body": "Yes! Being able to write this as a composition of <code>traverse . traverse</code> is one of the inspirations for the design of the <code>lens</code> package."}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 12, "last_activity_date": 1462208487, "creation_date": 1462208487, "answer_id": 36987734, "question_id": 36986859, "link": "https://stackoverflow.com/questions/36986859/traversable-instance-for-general-type-composition/36987734#36987734", "title": "Traversable instance for general type composition", "body": "<h2>H O L E S</h2>\n\n<p>This is another great question that can be solved with holey expressions.</p>\n\n<p>First, let's assume we have Foldable instances all defined already.</p>\n\n<pre><code>\u03bb&gt; instance (Foldable f, Foldable g) =&gt; Foldable (Compose f g) where\n     foldr = undefined\n</code></pre>\n\n<p>Next, instance Traversable. Pattern match on the <code>Compose</code> argument because you know you will have to, but otherwise leave everything in a hole.</p>\n\n<pre><code>\u03bb&gt; instance (Traversable t, Traversable u) =&gt; Traversable (Compose t u) where\n     traverse a2fb (Compose tua) = _ tua\n</code></pre>\n\n<p>GHC will helpfully spit out an error\u2013</p>\n\n<pre><code>&lt;interactive&gt;:...:...\n  Found hole \u2018_\u2019 with type: f (Compose t u b)\n</code></pre>\n\n<p>\u2013in addition to the types of all variables in scope.</p>\n\n<pre><code>Relevant bindings include\n  tua :: t (u a) (bound at ...)\n  a2fb :: a -&gt; f b (bound at ...)\n  traverse :: (a -&gt; f b) -&gt; Compose t u a -&gt; f (Compose t u b)\n    (bound at ...)\n</code></pre>\n\n<p>(I have chosen the type and value names so that everything lines up neat. Pay no attention to the man behind the curtain.) Now then the question of the hour: how to conjure a value of <code>f (Compose t u b)</code> given everything else. We know</p>\n\n<ul>\n<li><p>The only way to construct <code>Compose t u b</code> is by creating a value <code>t (u b)</code>.</p></li>\n<li><p>There is no way to produce a value of <code>f anything</code> except by (1) <code>pure</code> and (2) <code>fmap</code>, and intuitively we know we cannot use <code>pure</code> because we are trying to collect the 'side effects' of <code>a2fb :: a -&gt; f b</code> here.</p></li>\n</ul>\n\n<p>This leads us to our next stab at the solution.</p>\n\n<pre><code>\u03bb&gt; instance (Traversable t, Traversable u) =&gt; Traversable (Compose t u) where\n     traverse a2fb (Compose tua) =\n       fmap Compose (_ tua)\n\n&lt;interactive&gt;:...\n  Found hole \u2018_\u2019 with type: t (u a) -&gt; f (t (u b))\n</code></pre>\n\n<p>At last we have a <code>t</code>. We know <code>t</code> is Traversable so let's try traversing it.</p>\n\n<pre><code>\u03bb&gt; instance (Traversable t, Traversable u) =&gt; Traversable (Compose t u) where\n     traverse a2fb (Compose tua) =\n       fmap Compose ((\\tua -&gt; traverse _ tua) tua)\n\n&lt;interactive&gt;:56:138:\n  Found hole \u2018_\u2019 with type: u a -&gt; f (u b)\n</code></pre>\n\n<p>Same deal. We know <code>u</code> is Traversable so let's try traversing it.</p>\n\n<pre><code>\u03bb&gt; instance (Traversable t, Traversable u) =&gt; Traversable (Compose t u) where\n     traverse a2fb (Compose tua) =\n       fmap Compose ((\\tua -&gt; traverse (\\ua -&gt; traverse _ ua) tua) tua)\n\n&lt;interactive&gt;:57:155:\n  Found hole \u2018_\u2019 with type: a -&gt; f b\n</code></pre>\n\n<p>A goldilocks hole for our <code>a2fb</code>.</p>\n\n<pre><code>\u03bb&gt; instance (Traversable t, Traversable u) =&gt; Traversable (Compose t u) where\n     traverse a2fb (Compose tua) =\n       fmap Compose ((\\tua -&gt; traverse (\\ua -&gt; traverse a2fb ua) tua) tua)\n</code></pre>\n\n<p>Eta-reduce to excise the lambdas, and you end up with <a href=\"https://hackage.haskell.org/package/transformers-0.5.1.0/docs/src/Data-Functor-Compose.html\">the solution</a>.</p>\n\n<pre><code>\u03bb&gt; instance (Traversable t, Traversable u) =&gt; Traversable (Compose t u) where\n     traverse a2fb (Compose tua) =\n       fmap Compose (traverse (traverse a2fb) tua)\n</code></pre>\n"}], "owner": {"reputation": 405, "user_id": 4338219, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wx0C79DukHg/AAAAAAAAAAI/AAAAAAAAAT4/a96VO7CSDsE/photo.jpg?sz=128", "display_name": "Stephen Pascoe", "link": "https://stackoverflow.com/users/4338219/stephen-pascoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 1, "accepted_answer_id": 36987734, "answer_count": 1, "score": 5, "last_activity_date": 1462208487, "creation_date": 1462205442, "question_id": 36986859, "link": "https://stackoverflow.com/questions/36986859/traversable-instance-for-general-type-composition", "title": "Traversable instance for general type composition", "body": "<p>I am completely stuck on this is an exercise from the excellent <a href=\"http://haskellbook.com\" rel=\"noreferrer\">Haskell Programming</a> book.</p>\n\n<p>Given the following newtype for type composition and instances of Functor and Applicative, write an instance of <code>Traversable (Compose f g)</code>. </p>\n\n<pre><code>newtype Compose f g a =\n  Compose { getCompose :: f (g a) }\n  deriving (Eq, Show)\n\ninstance (Functor f, Functor g) =&gt; Functor (Compose f g) where\n  fmap f (Compose fga) = Compose $ (fmap . fmap) f fga\n\ninstance (Applicative f, Applicative g) =&gt; Applicative (Compose f g) where\n  pure = Compose &lt;$&gt; pure . pure\n  Compose f &lt;*&gt; Compose x =\n    Compose $ ((&lt;*&gt;) &lt;$&gt; f) &lt;*&gt; x\n</code></pre>\n\n<p>My proposed solution looks like it should work, based on the type of <code>traverse.traverse</code> but ghci complains.  I have a vague feeling it is something to do with re-wrapping in the <code>Compose</code> constructor:</p>\n\n<pre><code>instance (Traversable f, Traversable g) =&gt; Traversable (Compose f g) where\n  traverse f1 (Compose fga) = (traverse.traverse) f1 fga\n</code></pre>\n\n<p>gives the type error:</p>\n\n<pre><code>composing_types.hs:69:31:\n    Couldn't match type \u2018b\u2019 with \u2018g b\u2019\n      \u2018b\u2019 is a rigid type variable bound by\n          the type signature for\n            traverse :: Applicative f1 =&gt;\n                        (a -&gt; f1 b) -&gt; Compose f g a -&gt; f1 (Compose f g b)\n          at composing_types.hs:69:3\n    Expected type: f1 (Compose f g b)\n      Actual type: f1 (Compose f g (g b))\n    Relevant bindings include\n      fga :: f (g a) (bound at composing_types.hs:69:24)\n      f1 :: a -&gt; f1 b (bound at composing_types.hs:69:12)\n      traverse :: (a -&gt; f1 b) -&gt; Compose f g a -&gt; f1 (Compose f g b)\n        (bound at composing_types.hs:69:3)\n    In the expression: (traverse . traverse) f1 fga\n    In an equation for \u2018traverse\u2019:\n        traverse f1 (Compose fga) = (traverse . traverse) f1 fga\n\ncomposing_types.hs:69:54:\n    Couldn't match type \u2018f\u2019 with \u2018Compose f g\u2019\n      \u2018f\u2019 is a rigid type variable bound by\n          the instance declaration at composing_types.hs:68:10\n    Expected type: Compose f g (g a)\n      Actual type: f (g a)\n    Relevant bindings include\n      fga :: f (g a) (bound at composing_types.hs:69:24)\n      traverse :: (a -&gt; f1 b) -&gt; Compose f g a -&gt; f1 (Compose f g b)\n        (bound at composing_types.hs:69:3)\n    In the second argument of \u2018traverse . traverse\u2019, namely \u2018fga\u2019\n    In the expression: (traverse . traverse) f1 fga\n</code></pre>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1462202120, "post_id": 36984404, "comment_id": 61526107, "body": "You could dump the core after simplification in both the interpreted and compiled to check for differences there. That being said, without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, it&#39;s going to be hard to reproduce the behaviour and actually answer the question."}], "owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1462197863, "creation_date": 1462197863, "question_id": 36984404, "link": "https://stackoverflow.com/questions/36984404/is-there-a-link-between-ffi-and-timing", "title": "Is there a link between FFI and timing?", "body": "<p><strong>tl;dr</strong>: I have an error in my test-suite that stops being an error when interpreted or slowed down.</p>\n\n<p>So I have a bunch of functions that rely on <code>Numeric.GSL.Fitting</code> to do the heavy lifting and a <em>test-suite</em> exercising those functions.</p>\n\n<p>I barely managed to stay sane when I tried to fix a failing test-case that failed but I couldn't find a fault in my code.</p>\n\n<p>Taking the failing cases from <code>QuickCheck</code> and inspecting the results showed differences, but that is expected for noisy fitting. </p>\n\n<p>At one point I just tried to run one test-case in <em>ghci</em> and found that, to my astonishment, all 100 iterations passed. Stumped, I did the same thing for other tests that failed and found that all of them passed fine when interpreted.</p>\n\n<p>With that knowledge I removed anything I could think of that is different in the compiled code (ie <code>-O0</code>, removed <code>fast-math</code>) but to no avail.</p>\n\n<p>The second thing I noticed is that the test actually passes when I <code>traceShowId</code> the result from the fitting in each iterations.</p>\n\n<p>This all seems to hint at a problem that vanishes when it is running with a different timing (ghci being slower, tracing slowing it down). The FFI calls in <code>Numeric.GSL.Fitting</code> are <code>safe</code>, so that shouldn't be a problem.</p>\n\n<p>Your guess is as good as mine ... but does anyone have an idea what could be the cause here?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462184318, "post_id": 36979508, "comment_id": 61515132, "body": "Everything looks fine... try <code>cat baby.hs</code> (or <code>more baby.hs</code> on Win) from the shell to double check the content is the intended one."}, {"owner": {"reputation": 1, "user_id": 6280620, "user_type": "registered", "profile_image": "https://graph.facebook.com/818454581619009/picture?type=large", "display_name": "Mayank Gupta", "link": "https://stackoverflow.com/users/6280620/mayank-gupta"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462184950, "post_id": 36979508, "comment_id": 61515521, "body": "It shows this-                                                                                         Mayanks-MBP:Documents mayank$ cat baby.hs {\\rtf1\\ansi\\ansicpg1252\\cocoartf1404\\cocoasubrtf460 {\\fonttbl\\f0\\fswiss\\fcharset0 Helvetica;} {\\colortbl;\\red255\\green255\\blue255;} \\paperw11900\\paperh16840\\margl1440\\margr1440\\vieww10800\\view&zwnj;&#8203;h8400\\viewkind0 \\pard\\tx566\\tx1133\\tx1700\\tx2267\\tx2834\\tx3401\\tx3968\\tx4535&zwnj;&#8203;\\tx5102\\tx5669\\tx623&zwnj;&#8203;6\\tx6803\\pardirnatur&zwnj;&#8203;al\\partightenfactor0  \\f0\\fs24 \\cf0 doubleMe x = x + x}Mayanks-MBP:Documents mayank$"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1462185136, "post_id": 36979508, "comment_id": 61515629, "body": "You used some word processor to produce the .hs file. You can&#39;t use that, you need a plain text editor. (It might be possible to coerce a word processor into producing a plain text file, but for programming a good text editor is more approriate.)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1462186974, "post_id": 36979508, "comment_id": 61516730, "body": "Always <a href=\"https://stackoverflow.com/posts/36979508/edit\">edit</a> additional information in the question, @MayankGupta. That way, users don&#39;t have to scan all comments. Also, comments don&#39;t have a edit history, and can be deleted at (almost) any time."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462192090, "post_id": 36979508, "comment_id": 61519765, "body": "the usual workaround is to look for &quot;save as&quot; and then select &quot;.txt&quot; but replace the extension"}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462192209, "post_id": 36980854, "comment_id": 61519846, "body": "BTW: I think Atom is a good choice for beginners nowadays - it seems to have a good Haskell experience - personally I would use emacs ;) - of course <i>TextEdit</i> <b>is</b> capable of saving plain text files - you just have to tell it to ;)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462192260, "post_id": 36980854, "comment_id": 61519872, "body": "see here <a href=\"https://apple.stackexchange.com/questions/17433/can-textedit-save-as-plain-text\" title=\"can textedit save as plain text\">apple.stackexchange.com/questions/17433/&hellip;</a>"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 6, "last_activity_date": 1462186840, "creation_date": 1462186840, "answer_id": 36980854, "question_id": 36979508, "link": "https://stackoverflow.com/questions/36979508/haskell-function-not-loading/36980854#36980854", "title": "Haskell Function not loading", "body": "<p>You're using a word processor (WordPad, Microsoft Word, etc.), which saves your file in RTF format. However, Haskell source code must be in a plain text format.  I'm not familiar with Mac OS X, but there is probably a <code>vi</code>, <code>nano</code> or another console editor on your system already. Note that you should get a proper editor rather soon.</p>\n"}], "owner": {"reputation": 1, "user_id": 6280620, "user_type": "registered", "profile_image": "https://graph.facebook.com/818454581619009/picture?type=large", "display_name": "Mayank Gupta", "link": "https://stackoverflow.com/users/6280620/mayank-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "closed_date": 1462863166, "answer_count": 1, "score": 0, "last_activity_date": 1462187034, "creation_date": 1462182569, "last_edit_date": 1462187034, "question_id": 36979508, "link": "https://stackoverflow.com/questions/36979508/haskell-function-not-loading", "closed_reason": "Not suitable for this site", "title": "Haskell Function not loading", "body": "<p>I have started haskell two day ago using learn you a haskell, but struck in the second chapter.</p>\n\n<p>I saved a function as <code>baby.hs</code>(no <code>.txt</code>, I checked in info) and according to the book, the function I wrote is <code>doubleMe x = x + x</code>. I saved it in documents folder. (also i navigated to that place using ls and cd).</p>\n\n<p>Then I typed the command <code>ghci&gt;:l baby</code> , there is an error which says..</p>\n\n<pre><code>[1 of 1] Compiling Main             ( baby.hs, interpreted )  \nbaby.hs:1:7: parse error on input \u2018\\\u2019 Failed, modules loaded: none.\n</code></pre>\n\n<p>Forget to mention, I have macbook with os x el capitan. If I use <code>cat baby.hs</code>, I get the following:</p>\n\n<pre>\nMayanks-MBP:Documents mayank$ cat baby.hs\n{\\rtf1\\ansi\\ansicpg1252\\cocoartf1404\\cocoasubrtf460 {\\fonttbl\\f0\\fswiss\\fcharset0 Helvetica;} {\\colortbl;\\red255\\green255\\blue255;} \\paperw11900\\paperh16840\\margl1440\\margr1440\\vieww10800\\viewh8400\\viewkind0 \\pard\\tx566\\tx1133\\tx1700\\tx2267\\tx2834\\tx3401\\tx3968\\tx4535\\tx5102\\tx5669\\tx623\u200c\u200b6\\tx6803\\pardirnatural\\partightenfactor0 \\f0\\fs24 \\cf0 doubleMe x = x + x}\nMayanks-MBP:Documents mayank$\n</pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 816, "user_id": 4153209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14bd54eebccc6829e45b653c41b217bd?s=128&d=identicon&r=PG", "display_name": "Thomas Francois", "link": "https://stackoverflow.com/users/4153209/thomas-francois"}, "edited": false, "score": 0, "creation_date": 1462181278, "post_id": 36979040, "comment_id": 61513263, "body": "When you write <code>Tree happytree</code>, do you mean <code>happytree :: Tree</code> and on a separate line <code>happytree = ...</code>?"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1462181345, "post_id": 36979040, "comment_id": 61513303, "body": "Why are you using type constructor <code>Tree</code> on the LHS of the definition of <code>happytree</code>? Instead of <code>Tree happytree =  Node ...</code>, you probably mean <code>happytree :: Tree; happytree = Node ...</code>."}, {"owner": {"reputation": 489, "user_id": 3726947, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/57129ec6e8cbb9d33c9da31208654b4a?s=128&d=identicon&r=PG&f=1", "display_name": "user3726947", "link": "https://stackoverflow.com/users/3726947/user3726947"}, "edited": false, "score": 0, "creation_date": 1462181406, "post_id": 36979040, "comment_id": 61513343, "body": "yes thank you! I was so sure that I always declared my variables this way^^ I edited the question."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1462181848, "post_id": 36979040, "comment_id": 61513603, "body": "<i>One</i> question per post, and <i>do not significantly change</i> your question. Otherwise answers will get out of sync (see the start of Sebastian&#39;s answer, and mine). By the way, if you have working code, and you want to know how to write it better or whether it&#39;s good/bad practice, head over to <a href=\"https://codereview.stackexchange.com\">Code Review</a>."}, {"owner": {"reputation": 489, "user_id": 3726947, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/57129ec6e8cbb9d33c9da31208654b4a?s=128&d=identicon&r=PG&f=1", "display_name": "user3726947", "link": "https://stackoverflow.com/users/3726947/user3726947"}, "edited": false, "score": 0, "creation_date": 1462182127, "post_id": 36979040, "comment_id": 61513761, "body": "ok ill change it back and thanks for the link."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1462181997, "post_id": 36979187, "comment_id": 61513686, "body": "You can even make <code>contains</code> easier, since <code>any</code> returns <code>False</code> on an empty list."}, {"owner": {"reputation": 489, "user_id": 3726947, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/57129ec6e8cbb9d33c9da31208654b4a?s=128&d=identicon&r=PG&f=1", "display_name": "user3726947", "link": "https://stackoverflow.com/users/3726947/user3726947"}, "edited": false, "score": 0, "creation_date": 1462200255, "post_id": 36979187, "comment_id": 61524943, "body": "Is this faster then the original algorithm? Because it seems to me that any is doing more or less the same as my contains1 function."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1462202184, "post_id": 36979187, "comment_id": 61526144, "body": "It&#39;s doing exactly the same thing as the <code>contains1</code> function, it just replaces the explicit recursion with the higher-order function <code>any</code>. Unless your tree has special properties such as keys being ordered, there&#39;s no way of making it faster than this brute-force approach."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462221279, "post_id": 36979187, "comment_id": 61536604, "body": "@SebastianRedl I wouldn&#39;t call that brute force. It&#39;s just a linear search."}], "tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": true, "score": 6, "last_activity_date": 1462181505, "creation_date": 1462181505, "answer_id": 36979187, "question_id": 36979040, "link": "https://stackoverflow.com/questions/36979040/function-that-checks-if-number-is-in-tree/36979187#36979187", "title": "function that checks if number is in tree", "body": "<p>You get the error from the declaration <code>Tree happytree = ...</code>. It seems a C-style habit snuck into your code and you tried to declare the constant with a type in the wrong way.</p>\n\n<p>It's just <code>happytree = ...</code> and the compiler deduces the type. If you want to specify it explicitly, you do it like with the functions and write <code>happytree :: Tree</code> on a separate line.</p>\n\n<p>As for getting rid of <code>contains1</code>, it's testing whether <strong>any</strong> of the trees in the list contains the value, so you can get rid of it this way:</p>\n\n<pre><code>contains :: Tree -&gt; Int -&gt; Bool\ncontains (Node x []) y = x==y\ncontains (Node x as) y = x==y || any (`contains` y) as\n</code></pre>\n\n<p>I'm using section syntax here for the partially applied <code>contains</code>; you could instead write a lambda <code>\\a -&gt; contains a y</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 6, "last_activity_date": 1462187089, "last_edit_date": 1462187089, "creation_date": 1462181791, "answer_id": 36979261, "question_id": 36979040, "link": "https://stackoverflow.com/questions/36979040/function-that-checks-if-number-is-in-tree/36979261#36979261", "title": "function that checks if number is in tree", "body": "<p>While Sebastian's answer tells you the problem (type declarations belong in their own lines), note that the error message stems from the following:</p>\n\n<pre><code>data Id Int = Id Int\n\nId x = Id 5\n</code></pre>\n\n<p>This is perfectly valid, since you're binding with a pattern <code>Id x</code>. It's similar to</p>\n\n<pre><code>(x:_) = [5..]\n</code></pre>\n\n<p>However, in order to do this, you need a <em>data constructor</em>, e.g. something that can create a value, like <code>Node</code>, whereas <code>Tree</code> is a <em>type constructor</em>, it creates (or in this case <em>is</em>) types. That's why you end up with that rather cryptic error message:</p>\n\n<blockquote>\n<pre><code>Not in scope: data constructor \u2018Tree\u2019\nPerhaps you meant \u2018True\u2019 (imported from Prelude)\n</code></pre>\n</blockquote>\n\n<p>Either way, you can fix this by removing <code>Tree</code> from <code>Tree happytree</code>.</p>\n\n<hr>\n\n<p>For your other question, use <code>any</code>:</p>\n\n<pre><code>contains :: Tree -&gt; Int -&gt; Bool\ncontains (Node x as) y = x == y || any (`contains` y) as\n</code></pre>\n\n<p>Note that <code>elem</code>-like functions (on lists <code>elem :: Eq a =&gt; a -&gt; [a] -&gt; Bool</code>) usually take the predicate first and the container last, which makes the application of <code>contains</code> easier:</p>\n\n<pre><code>contains :: Int -&gt; Tree -&gt; Bool\ncontains y (Node x as) = x == y || any (contains y) as\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 3726947, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/57129ec6e8cbb9d33c9da31208654b4a?s=128&d=identicon&r=PG&f=1", "display_name": "user3726947", "link": "https://stackoverflow.com/users/3726947/user3726947"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 1, "accepted_answer_id": 36979187, "answer_count": 2, "score": -2, "last_activity_date": 1462187089, "creation_date": 1462180883, "last_edit_date": 1462182242, "question_id": 36979040, "link": "https://stackoverflow.com/questions/36979040/function-that-checks-if-number-is-in-tree", "title": "function that checks if number is in tree", "body": "<p>Im trying to write a little program that can check whether a given number appears in a Tree. This is my code:</p>\n\n<pre><code>import Prelude\n\ndata Tree = Node Int [Tree]\n\nTree happytree = Node 5 [Node 1 [Node 6 []],Node 8 [],Node 2 [Node 1 [],Node 4 []]]\n\ncontains1 :: [Tree] -&gt; Int -&gt; Bool\ncontains1 [] x = False\ncontains1 (a:as) x = contains a x || contains1 as x\n\ncontains :: Tree -&gt; Int -&gt; Bool\ncontains (Node x []) y = x==y\ncontains (Node x as) y = x==y || contains1 as y\n</code></pre>\n\n<p>Im getting the error message </p>\n\n<pre><code>Not in scope: data constructor \u2018Tree\u2019\nPerhaps you meant \u2018True\u2019 (imported from Prelude)\n</code></pre>\n\n<p>What is this supposed to mean?\nI was wondering if somebody could give me an advice how to write my contains function without writing the help function contains1.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["haskell", "cyclic-dependency"], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1462182170, "post_id": 36979171, "comment_id": 61513790, "body": "I would rather heavily recommend avoiding the <code>{-# SOURCE #-}</code> / .hs-boot mechanism, unless it&#39;s really necessary."}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1462182832, "post_id": 36979171, "comment_id": 61514183, "body": "@leftroundabout: Yes, I find it fiddly and uncomfortable, but are there any arguments against it othter than the ones mentioned in the <a href=\"https://wiki.haskell.org/Mutually_recursive_modules\" rel=\"nofollow noreferrer\">wiki</a>, which are (imho) not so relevant for small projects?"}], "tags": [], "owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "is_accepted": true, "score": 8, "last_activity_date": 1470968451, "last_edit_date": 1470968451, "creation_date": 1462181420, "answer_id": 36979171, "question_id": 36978780, "link": "https://stackoverflow.com/questions/36978780/haskell-resolving-cyclical-module-dependency/36979171#36979171", "title": "Haskell - resolving cyclical module dependency", "body": "<p>Your solution (adding type parameters) is not a bad one. Your types become more general (you could use <code>Card OtherGame</code> if you need it), but if you dislike the extra parameters you could either: </p>\n\n<ul>\n<li>write a module <code>CardGame</code> that contains (just) your mutually recursive datatypes, and import this module in the other ones, or</li>\n<li>in <code>ghc</code>, use <code>{-# SOURCE #-}</code> pragmas to <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/separate_compilation.html#mutual-recursion\" rel=\"nofollow\">break the circular dependency</a></li>\n</ul>\n\n<p>This last solution requires the writing of a <code>Card.hs-boot</code> file with a subset of the type declarations in <code>Card.hs</code>.  </p>\n"}], "owner": {"reputation": 105, "user_id": 6280084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b862bc2dc3e5138f5125e96db61fa6dd?s=128&d=identicon&r=PG&f=1", "display_name": "SolventGren", "link": "https://stackoverflow.com/users/6280084/solventgren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1324, "favorite_count": 1, "accepted_answer_id": 36979171, "answer_count": 1, "score": 10, "last_activity_date": 1470968451, "creation_date": 1462180049, "last_edit_date": 1462274379, "question_id": 36978780, "link": "https://stackoverflow.com/questions/36978780/haskell-resolving-cyclical-module-dependency", "title": "Haskell - resolving cyclical module dependency", "body": "<p>Let's say I write the following code:</p>\n\n<p>a game module</p>\n\n<pre><code>module Game where \nimport Player\nimport Card \ndata Game = Game {p1 :: Player,\n                  p2 :: Player,\n                  isP1sTurn :: Bool\n                  turnsLeft :: Int\n                 }\n</code></pre>\n\n<p>a player module</p>\n\n<pre><code>module Player where\nimport Card\ndata Player = Player {score :: Int,\n                      hand :: [Card],\n                      deck :: [Card]\n                     }\n</code></pre>\n\n<p>and a card module</p>\n\n<pre><code>module Card where\ndata Card = Card {name :: String, scoreValue :: Int}\n</code></pre>\n\n<p>I then write some code to implement logic where players take turns drawing and playing cards from their hand to add bonuses to their score's until the game runs out of turns.</p>\n\n<p>However, I realize upon completion of this code that the game module I've written is boring!</p>\n\n<p>I want to refactor the card game so when you play a card, rather than just adding a score, instead the card arbitrarily transforms the game.</p>\n\n<p>So, I change the <code>Card</code> module to the following</p>\n\n<pre><code>module Card where\nimport Game\ndata Card = Card {name :: String, \n                  onPlayFunction :: (Game -&gt; Game)            \n                  scoreValue :: Int}\n</code></pre>\n\n<p>which of course makes the module imports form a cycle.</p>\n\n<p>How do I resolve this problem?</p>\n\n<p>Trivial Solution:</p>\n\n<p>Move all the files to the same module. This solves the problem nicely, but reduces modularity; I can't later reuse the same card module for another game. </p>\n\n<p>Module maintaining solution:</p>\n\n<p>Add a type parameter to <code>Card</code>:</p>\n\n<pre><code>module Card where\ndata Card a = {name :: String, onPlayFunc :: (a -&gt; a), scoreValue :: Int}\n</code></pre>\n\n<p>Add another parameter to <code>Player</code>:</p>\n\n<pre><code>module Player where\ndata Player a {score :: Int, hand :: [card a], deck :: [card a]}\n</code></pre>\n\n<p>With one final modification to <code>Game</code>:</p>\n\n<pre><code>module Game where\ndata Game = Game {p1 :: Player Game,\n                  p2 :: Player Game,\n                 }\n</code></pre>\n\n<p>This keeps modularity, but requires me to add parameters to my data types. If the data structures were any more deeply nested I could have to add -a lot- of parameters to my data, and if I had to use this method for multiple solutions, I could end up with an unwieldy number of type modifiers.</p>\n\n<p>So, are there any other useful solutions to resolving this refactor, or are these the only two options?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1462178230, "post_id": 36978054, "comment_id": 61511631, "body": "Because <code>b</code> in the signature means <i>to any type you like</i>."}, {"owner": {"reputation": 14562, "user_id": 71116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e3643cd0195fab5a3bfa310b5ea27e7?s=128&d=identicon&r=PG", "display_name": "Michael Steele", "link": "https://stackoverflow.com/users/71116/michael-steele"}, "edited": false, "score": 1, "creation_date": 1462206567, "post_id": 36978054, "comment_id": 61528789, "body": "You&#39;re question about the type of <code>(*)</code> is correct. Regarding <code>foo</code>, what type variables end up being will be dictated by the caller.  This concept took a while to sink in for me. Barring type class constraints and advanced extensions, you can&#39;t write <code>foo</code> in such a way that constrains what <code>b</code> is. <code>\\y -&gt; y + 3</code> is of type <code>Num a =&gt; a -&gt; a</code>, and you can&#39;t hide that behind type variable <code>b</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1350, "user_id": 1284735, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/655c83a20a81887db3d21c3faf98b3a8?s=128&d=identicon&r=PG&f=1", "display_name": "petabyte", "link": "https://stackoverflow.com/users/1284735/petabyte"}, "edited": false, "score": 0, "creation_date": 1462183193, "post_id": 36978444, "comment_id": 61514427, "body": "@Zeta ty for the answer, I think I get it now. Just one last question. Since <code>b</code> can be anything in <code>foo</code>, even if we got rid of <code>+ 3</code>, it wouldn&#39;t work because <code>(\\y -&gt; y)</code> can&#39;t match for e.x. a String type. Also doesn&#39;t work because the type declaration says only takes 1 argument, but I&#39;m taking in 2 arguments?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1350, "user_id": 1284735, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/655c83a20a81887db3d21c3faf98b3a8?s=128&d=identicon&r=PG&f=1", "display_name": "petabyte", "link": "https://stackoverflow.com/users/1284735/petabyte"}, "edited": false, "score": 1, "creation_date": 1462183643, "post_id": 36978444, "comment_id": 61514717, "body": "@Jae: That&#39;s correct. <code>\\y -&gt; y</code> (also called <code>id</code>) has type <code>k -&gt; k</code>, which restricts <code>b</code>."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 5, "last_activity_date": 1462178812, "creation_date": 1462178812, "answer_id": 36978444, "question_id": 36978054, "link": "https://stackoverflow.com/questions/36978054/comparing-fmap-type-declaration-to-how-its-used/36978444#36978444", "title": "Comparing fmap type declaration to how it&#39;s used", "body": "<p>There's an implicit <a href=\"https://www.schoolofhaskell.com/school/to-infinity-and-beyond/pick-of-the-week/guide-to-ghc-extensions/explicit-forall\"><code>forall</code></a> in your signature:</p>\n\n<pre><code>foo :: forall a b. a -&gt; b\n</code></pre>\n\n<p>This means that your function must work for <strong><em>any</em></strong> <code>a</code> and <code>b</code>. Let's have a look at your function:</p>\n\n<pre><code>foo x = (\\y -&gt; y + 3)\n</code></pre>\n\n<p>Since <code>x</code> isn't restricted on the right hand side of <code>=</code>, it fulfils the requirements: it can be of any type. However, your right hand side has the following type:</p>\n\n<pre><code>ghci&gt; :t (\\y -&gt; y + 3)\nNum k =&gt; k -&gt; k\n</code></pre>\n\n<p>Remember that your original function said that the choice of <code>b</code> can be arbitrary. However, your function's body restricts the return type to <code>b ~ Num k =&gt; k -&gt; k</code>. You would have to use</p>\n\n<pre><code>foo :: Num b =&gt; a -&gt; b -&gt; b\n</code></pre>\n\n<p>By the way, foo's type already shows that you will not use the first argument, because there's no way to combine two values of different types in a general way. Indeed, one can proof that <code>foo</code> is <code>const bar</code> for some <code>bar :: Num b =&gt; b -&gt; b</code>.</p>\n\n<h3>Exercises</h3>\n\n<ul>\n<li>Try to think of a function with type <code>forall a b. a -&gt; b</code>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1462178926, "creation_date": 1462178926, "answer_id": 36978474, "question_id": 36978054, "link": "https://stackoverflow.com/questions/36978054/comparing-fmap-type-declaration-to-how-its-used/36978474#36978474", "title": "Comparing fmap type declaration to how it&#39;s used", "body": "<p>In your initial example, <code>a</code> is constrained to be an instance of <code>Num</code> because of the <code>5</code> and the <code>(*)</code>.</p>\n\n<pre><code>:type 5\n   5 :: Num a =&gt; a\n\n:type (*)\n   (*) :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>You are correct that the <code>(a-&gt;a)</code> gets unified with the <code>b</code> in the type of <code>fmap</code>.</p>\n\n<pre><code>:type (\\y -&gt; y + 3)\n    (\\y -&gt; y + 3) :: Num a =&gt; a -&gt; a\n</code></pre>\n\n<p>Hence:</p>\n\n<pre><code>:type foo\n   foo :: Num a =&gt; t -&gt; a -&gt; a\n</code></pre>\n\n<p>As Willem Van Onsem says, <code>b</code> means \"any type you like\", not \"any type that fits the invisible constraints I haven't mentioned\".</p>\n"}], "owner": {"reputation": 1350, "user_id": 1284735, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/655c83a20a81887db3d21c3faf98b3a8?s=128&d=identicon&r=PG&f=1", "display_name": "petabyte", "link": "https://stackoverflow.com/users/1284735/petabyte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 1, "accepted_answer_id": 36978444, "answer_count": 2, "score": 2, "last_activity_date": 1462178926, "creation_date": 1462177354, "question_id": 36978054, "link": "https://stackoverflow.com/questions/36978054/comparing-fmap-type-declaration-to-how-its-used", "title": "Comparing fmap type declaration to how it&#39;s used", "body": "<p>I ran <code>:t fmap (*) (Just 5)</code> and got</p>\n\n<pre><code>fmap (*) (Just 5) :: Num a =&gt; Maybe (a -&gt; a)\n</code></pre>\n\n<p>Type declaration of fmap says</p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>So am I right in thinking that <code>(*)</code> is being treated as <code>(a -&gt; (a -&gt; a))</code> and corresponds to <code>(a -&gt; b)</code> part of the fmap type declaration? If the <code>(a -&gt; a)</code> part corresponds to <code>b</code>, why can't I do the following? And let the <code>b</code> represent the lambda function?</p>\n\n<pre><code>foo :: a -&gt; b\nfoo x = (\\y -&gt; y + 3)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1462170945, "post_id": 36976003, "comment_id": 61507888, "body": "You write two functions. After all, any usage of the function would lead to the same problem. There is no extension at the moment that provides this kind of behaviour. Also, I can see how this get ambiguous very fast: <code>foo :: a -&gt; a -&gt; Bool</code> vs <code>foo :: Eq a =&gt; a -&gt; a -&gt; Bool</code> vs <code>foo :: Enum a =&gt; a -&gt; a -&gt; a</code>. Which one should get used for <code>foo 1 (2 :: Int)</code>?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462171026, "post_id": 36976003, "comment_id": 61507937, "body": "are you talking about <i>overloading</i> of function names here?"}, {"owner": {"reputation": 3307, "user_id": 358242, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dfc8e7dc00d92d43d9a64c5b70839015?s=128&d=identicon&r=PG", "display_name": "RnMss", "link": "https://stackoverflow.com/users/358242/rnmss"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462171977, "post_id": 36976003, "comment_id": 61508331, "body": "@Zeta  I would expect it select the implementations according to the order. (Like how pattern matching works)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462172452, "post_id": 36976003, "comment_id": 61508555, "body": "Pattern matching is a <i>local property</i>, but function names bind on a larger scope. The order of functions would then be part of the export, which needs a complete overhaul of the current import/export system. Have a look at function overloading in other languages, e.g. C++, where ambiguity simply leads to compilation aborts."}, {"owner": {"reputation": 3307, "user_id": 358242, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dfc8e7dc00d92d43d9a64c5b70839015?s=128&d=identicon&r=PG", "display_name": "RnMss", "link": "https://stackoverflow.com/users/358242/rnmss"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462195443, "post_id": 36976003, "comment_id": 61521930, "body": "@Zeta So yes, what I was trying to do is to find if there is any extension to do it locally."}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462173198, "post_id": 36976752, "comment_id": 61508976, "body": "where is the <code>instance</code> for <code>Wrapper</code> without <code>Eq</code>? (Hint: it will probably be a duplicate)"}, {"owner": {"reputation": 273, "user_id": 5374074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24e06dbaa357b25b6d0946f988dc223d?s=128&d=identicon&r=PG&f=1", "display_name": "denormal", "link": "https://stackoverflow.com/users/5374074/denormal"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462173866, "post_id": 36976752, "comment_id": 61509348, "body": "@Carsten Apparently this is possible: <a href=\"https://wiki.haskell.org/GHC/AdvancedOverlap\" rel=\"nofollow noreferrer\">wiki.haskell.org/GHC/AdvancedOverlap</a> but I don&#39;t really understand it."}, {"owner": {"reputation": 273, "user_id": 5374074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24e06dbaa357b25b6d0946f988dc223d?s=128&d=identicon&r=PG&f=1", "display_name": "denormal", "link": "https://stackoverflow.com/users/5374074/denormal"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462174006, "post_id": 36976752, "comment_id": 61509434, "body": "Wait, this is exactly what the OP is asking. :-)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462174860, "post_id": 36976752, "comment_id": 61509917, "body": "well yes and no - I think the article describes some of the problems - anyway it might get into an answer if you rewrite it to: a) work b) solves OPs problem (ATM you only linked the article and copy&amp;pasted the introduction from there)"}, {"owner": {"reputation": 273, "user_id": 5374074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24e06dbaa357b25b6d0946f988dc223d?s=128&d=identicon&r=PG&f=1", "display_name": "denormal", "link": "https://stackoverflow.com/users/5374074/denormal"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462175153, "post_id": 36976752, "comment_id": 61510069, "body": "Will do, as soon as I find time. But there is sample code at the end and obviously it is solving the same problem. I acknowledge that it&#39;s just lucky Googling on my part, if you want and I am allowed to, I can convert this to a comment."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462178962, "post_id": 36976752, "comment_id": 61511957, "body": "well personally I don&#39;t care too much (for me it&#39;s a comment but I won&#39;t downvote or flag because of it)"}], "tags": [], "owner": {"reputation": 273, "user_id": 5374074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24e06dbaa357b25b6d0946f988dc223d?s=128&d=identicon&r=PG&f=1", "display_name": "denormal", "link": "https://stackoverflow.com/users/5374074/denormal"}, "is_accepted": false, "score": 1, "last_activity_date": 1471510038, "last_edit_date": 1471510038, "creation_date": 1462172695, "answer_id": 36976752, "question_id": 36976003, "link": "https://stackoverflow.com/questions/36976003/haskell-specialize-a-function-for-certain-types/36976752#36976752", "title": "haskell: specialize a function for certain type(s)", "body": "<p>So, how about this:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses, KindSignatures, FunctionalDependencies, UndecidableInstances, TypeFamilies, ScopedTypeVariables #-}\n\nimport Data.IORef\n\ndata HTrue\ndata HFalse\n\nclass SomeWrite a where\n  someWrite :: IORef a -&gt; a -&gt; IO ()\n\nclass SomeWrite' f a where\n  someWrite' :: f -&gt; IORef a -&gt; a -&gt; IO ()\n\ninstance (Pred f a, SomeWrite' f a) =&gt; SomeWrite a where\n  someWrite = someWrite' (undefined::f)\n\nclass Pred f a | a -&gt; f where {}\n\ninstance (f ~ HTrue) =&gt; Pred f a\ninstance Pred HFalse Bool\ninstance Pred HFalse String\n-- Add the rest here\n\ninstance SomeWrite' HTrue a where\n  someWrite' _ = writeIORef\n\ninstance Eq a =&gt; SomeWrite' HFalse a where\n  someWrite' _ ref value =\n    do\n      oldValue &lt;- readIORef ref\n      if oldValue == value\n      then putStrLn \"Did not write\"\n      else writeIORef ref value\n</code></pre>\n\n<p><a href=\"https://wiki.haskell.org/GHC/AdvancedOverlap\" rel=\"nofollow\">https://wiki.haskell.org/GHC/AdvancedOverlap</a> describes the way to do this.</p>\n"}], "owner": {"reputation": 3307, "user_id": 358242, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dfc8e7dc00d92d43d9a64c5b70839015?s=128&d=identicon&r=PG", "display_name": "RnMss", "link": "https://stackoverflow.com/users/358242/rnmss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1471510038, "creation_date": 1462169625, "question_id": 36976003, "link": "https://stackoverflow.com/questions/36976003/haskell-specialize-a-function-for-certain-types", "title": "haskell: specialize a function for certain type(s)", "body": "<p>Say, just an example, I want to implement something like:</p>\n\n<pre><code>someWrite ::         IORef a -&gt; a -&gt; IO ()\nsomeWrite = writeIORef\n\nsomeWrite :: Eq a =&gt; IORef a -&gt; a -&gt; IO ()\nsomeWrite ref value = do\n    oldValue &lt;- readIORef ref\n    if oldValue == value\n        then putStrLn \"Did not write\"\n        else writeIORef ref value\n</code></pre>\n\n<p>Obviously the code is illegal. How can something like this be done?</p>\n"}, {"tags": ["haskell", "erd", "cabal-install"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462141639, "post_id": 36972157, "comment_id": 61500960, "body": "what version of ghc/cabal are you using - and what version of erd do you want to install, also show the output of <code>ghc-pkg list</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462141800, "post_id": 36972157, "comment_id": 61500993, "body": "I strongly advise you to using <a href=\"http://haskellstack.org\" rel=\"nofollow noreferrer\"><code>stack</code></a> or <a href=\"http://coldwa.st/e/blog/2013-08-20-Cabal-sandbox.html\" rel=\"nofollow noreferrer\"><code>cabal sandboxes</code></a> this makes stuff like this not go away but happen a <b>lot</b> easier"}, {"owner": {"reputation": 714, "user_id": 764027, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/59a8a02800e8f76b343468591c12d647?s=128&d=identicon&r=PG", "display_name": "Russ Petersen", "link": "https://stackoverflow.com/users/764027/russ-petersen"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462145655, "post_id": 36972157, "comment_id": 61501861, "body": "@epsilonhalbe: I&#39;m using cabal version: &#39;cabal-install version 1.22.6.0 using version 1.22.5.0 of the Cabal library&#39;. I&#39;m new to Hacksell and Cabal, I&#39;m not sure what <i>stack</i> and <i>sandboxes</i> are."}], "answers": [{"comments": [{"owner": {"reputation": 714, "user_id": 764027, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/59a8a02800e8f76b343468591c12d647?s=128&d=identicon&r=PG", "display_name": "Russ Petersen", "link": "https://stackoverflow.com/users/764027/russ-petersen"}, "edited": false, "score": 0, "creation_date": 1462146669, "post_id": 36972780, "comment_id": 61502079, "body": "I did a <code>cabal get erd</code> and some files were updated. I&#39;m not sure where to adjust the cabal file to <code>base == 4.8.*</code>. I did find an erd.cabal file but I didn&#39;t see a <code>base ==</code> in there anywhere. Once I adjust the erd.cabal file then what do I need to do?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 714, "user_id": 764027, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/59a8a02800e8f76b343468591c12d647?s=128&d=identicon&r=PG", "display_name": "Russ Petersen", "link": "https://stackoverflow.com/users/764027/russ-petersen"}, "edited": false, "score": 0, "creation_date": 1462147390, "post_id": 36972780, "comment_id": 61502232, "body": "Then you did not look well enough - 6th line from the bottom under &#39;build-depends&#39;"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1462142222, "creation_date": 1462142222, "answer_id": 36972780, "question_id": 36972157, "link": "https://stackoverflow.com/questions/36972157/how-to-install-erd-with-cabal-install-without-could-not-resolve-dependencies-err/36972780#36972780", "title": "How to install erd with cabal install without Could not resolve dependencies error?", "body": "<p>This is most probably because <code>erd</code> is a really old package and in the package description it says</p>\n\n<pre><code>Properties\nVersion  0.1.3.0\nChange log  None available\nDependencies    base (==4.7.*)\n              , bytestring (==0.10.*)\n              , containers (==0.5.*)\n              , graphviz (==2999.*)\n              , parsec (==3.1.*)\n              , text (==1.*) [details]\n</code></pre>\n\n<p>If you use the latest compiler ghc-7.10 or even ghc-8.0 - the current version of <code>base</code> is packaged up with it - which is of today (2016-05-02) <code>base-4.8</code> which is incompatible with your project.</p>\n\n<p>So best switch to an older compiler version (ghc-7.8) or try to download the package with <code>cabal get erd</code> and adjust the cabal file to <code>base == 4.8.*</code> and give it a try.</p>\n"}, {"comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1462220634, "post_id": 36972827, "comment_id": 61536273, "body": "FYI, stack unpack will download and unpack a tarball"}, {"owner": {"reputation": 1382, "user_id": 1228288, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8c4cf1236bc1f645a72a834af68857c2?s=128&d=identicon&r=PG", "display_name": "me--", "link": "https://stackoverflow.com/users/1228288/me"}, "edited": false, "score": 0, "creation_date": 1535949972, "post_id": 36972827, "comment_id": 91236342, "body": "Waited about 10 mins while this was executing, only to get an error: <code>Unable to start C:\\Users\\ME\\AppData\\Local\\Programs\\stack\\x86_64-windows\\ghc-&zwnj;&#8203;7.8.4\\mingw\\bin&#47;real&zwnj;&#8203;gcc.exe (error code: 2)</code>"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1462142667, "creation_date": 1462142667, "answer_id": 36972827, "question_id": 36972157, "link": "https://stackoverflow.com/questions/36972157/how-to-install-erd-with-cabal-install-without-could-not-resolve-dependencies-err/36972827#36972827", "title": "How to install erd with cabal install without Could not resolve dependencies error?", "body": "<p>Since <code>erd</code> is an executable, I would just install it using <code>stack</code>:</p>\n\n<p>Instructions for installing <code>stack</code> may be found here:</p>\n\n<p><a href=\"https://github.com/commercialhaskell/stack/blob/master/doc/install_and_upgrade.md\" rel=\"nofollow\">https://github.com/commercialhaskell/stack/blob/master/doc/install_and_upgrade.md</a></p>\n\n<p>The run these commands in the shell:</p>\n\n<pre><code>cabal get erd-0.1.3.0\ncd erd-0.1.3.0\nstack init --resolver lts-2.22\nstack build\n</code></pre>\n\n<p>The last command report something like:</p>\n\n<pre><code>Installing executable(s) in\n{some directory}/erd-0.1.3.0/.stack-work/install/x86_64-osx/lts-2.17/7.8.4/bin\n</code></pre>\n\n<p>We are using lts-2.22 since erd-1.3.0 requires base-4.7.</p>\n"}, {"tags": [], "owner": {"reputation": 594, "user_id": 4757074, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh5.googleusercontent.com/-l90tke9BB5Q/AAAAAAAAAAI/AAAAAAAAAD0/blQKp_CFPMU/photo.jpg?sz=128", "display_name": "mikeLundquist", "link": "https://stackoverflow.com/users/4757074/mikelundquist"}, "is_accepted": false, "score": 0, "last_activity_date": 1548765460, "creation_date": 1548765460, "answer_id": 54421259, "question_id": 36972157, "link": "https://stackoverflow.com/questions/36972157/how-to-install-erd-with-cabal-install-without-could-not-resolve-dependencies-err/54421259#54421259", "title": "How to install erd with cabal install without Could not resolve dependencies error?", "body": "<p>This worked for me <code>cabal install --allow-newer base erd</code></p>\n"}], "owner": {"reputation": 714, "user_id": 764027, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/59a8a02800e8f76b343468591c12d647?s=128&d=identicon&r=PG", "display_name": "Russ Petersen", "link": "https://stackoverflow.com/users/764027/russ-petersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1548765460, "creation_date": 1462137963, "question_id": 36972157, "link": "https://stackoverflow.com/questions/36972157/how-to-install-erd-with-cabal-install-without-could-not-resolve-dependencies-err", "title": "How to install erd with cabal install without Could not resolve dependencies error?", "body": "<p>I'm trying to install <strong>erd</strong> so I can produce some database table entity relationship diagrams using <strong>erd</strong> and <strong>graphviz</strong>. </p>\n\n<p>I have been doing all of the following installs in a Git-Bash command line prompt on a Windows 64 PC.</p>\n\n<p>First I installed Haskell (with cabal included) from <a href=\"https://www.haskell.org/platform/\" rel=\"nofollow\">enter link description here</a>, then I did a </p>\n\n<pre><code>cabal update\n</code></pre>\n\n<p>before attempting the actual install of <strong>erd</strong> with these results</p>\n\n<pre><code>$ cabal install erd\nResolving dependencies...\ncabal.exe: Could not resolve dependencies:\ntrying: erd-0.1.3.0 (user goal)\nnext goal: base (dependency of erd-0.1.3.0)\nrejecting: base-4.8.2.0/installed-140... (conflict: erd =&gt; base==4.7.*)\nrejecting: base-4.8.2.0, 4.8.1.0, 4.8.0.0, 4.7.0.2, 4.7.0.1, 4.7.0.0, 4.6.0.1,\n4.6.0.0, 4.5.1.0, 4.5.0.0, 4.4.1.0, 4.4.0.0, 4.3.1.0, 4.3.0.0, 4.2.0.2,\n4.2.0.1, 4.2.0.0, 4.1.0.0, 4.0.0.0, 3.0.3.2, 3.0.3.1 (global constraint\nrequires installed instance)\nDependency tree exhaustively searched.\n</code></pre>\n\n<p>I saw where a reset sometimes helps</p>\n\n<pre><code>rm -rf ~/.ghc ~/.cabal\n</code></pre>\n\n<p>But in my case it didn't change the results, I still see \"Could not resolve dependencies\"</p>\n"}, {"tags": ["haskell", "dictionary", "bit-manipulation", "haskell-lens"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1462137397, "post_id": 36971976, "comment_id": 61499687, "body": "Make your <code>Word128</code> into a <a href=\"https://en.wikipedia.org/wiki/Circular_buffer\" rel=\"nofollow noreferrer\">ring buffer</a>, perhaps? Just store the index of the head and tail of your queue."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1462137696, "post_id": 36971976, "comment_id": 61499803, "body": "@DanielWagner, that&#39;s an option. It takes an extra word for the index, but it&#39;s nicer. A ring buffer or any other full queue is a bit more than I need, since I do all my snoccing before I start unconsing."}, {"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 1, "creation_date": 1462142551, "post_id": 36971976, "comment_id": 61501199, "body": "@dfeuer how about store the length of the string in the extra 8 bits? You can read this length before snoc/uncons and write it after."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 0, "creation_date": 1462145873, "post_id": 36971976, "comment_id": 61501908, "body": "@erisco, that won&#39;t actually help. Using a separate word would be better, because unpacking and repacking that byte will use it anyway."}, {"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 2, "creation_date": 1462150596, "post_id": 36971976, "comment_id": 61502902, "body": "@dfeuer maybe it is unpacked and stored in a register rather than in cache or main memory though, which would be a win (a smaller memory footprint lets you fit more into your cache lines, if the data is contiguous). If performance is that critical then it might be worth finding out."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 1, "creation_date": 1462151379, "post_id": 36971976, "comment_id": 61503066, "body": "@erisco, good point. Performance is mission critical. Whether the mission is critical is an entirely different question. ;-)"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1462166476, "post_id": 36971976, "comment_id": 61506178, "body": "I&#39;m fairly confident <code>countLeadingZeros</code> will be the fastest, just make sure to use <code>unsafeShift</code> and avoid <code>testBit</code> and <code>setBit</code> (instead reimplement using unsafe shifts)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1462216694, "post_id": 36971976, "comment_id": 61534095, "body": "@Andr&#225;sKov&#225;cs, may I ask why you expect that? I ask because it&#39;s only available in GHC &gt;= 7.10."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1462257412, "post_id": 36971976, "comment_id": 61547925, "body": "@dfeuer I backtrack on my comment, because chi&#39;s solution seems about as fast as <code>clz</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1462257590, "post_id": 36971976, "comment_id": 61548016, "body": "@Andr&#225;sKov&#225;cs, my tests suggest <code>ctz</code> is faster for <code>uncons</code> with two words, but of course it&#39;s also possible my code is at fault. Dealing with two words is painful. I&#39;m not sure if there&#39;s a good way to deal with carries."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462226350, "post_id": 36972463, "comment_id": 61538881, "body": "This works, indeed, and is rather elegant in its own way. Unfortunately, it seems that unconsing is rather slow, at least with the implementations I&#39;ve come up with for double words for the relevant operations. I guess I&#39;ll try one of the indexing ideas next...."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1463073638, "post_id": 36972463, "comment_id": 61919569, "body": "I found <a href=\"http://www.catonmat.net/blog/low-level-bit-hacks-you-absolutely-must-know/\" rel=\"nofollow noreferrer\">elsewhere online</a> that you can go straight to <code>z = xs .&amp;. (- xs)</code>. Per Edward Kmett&#39;s advice, I decided to try using this 1-word variant with a <code>Map</code> size check to fall back. Unfortunately, it seems that the trouble of doing the size check is enough, or nearly enough, to negate the time saved by using a one-word queue. So I think I&#39;m going to stick with the two-word <code>countTrailingZeros</code> one for <code>Data.Map</code>. Thanks again for your help."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1462198260, "last_edit_date": 1462198260, "creation_date": 1462140070, "answer_id": 36972463, "question_id": 36971976, "link": "https://stackoverflow.com/questions/36971976/whats-the-best-way-to-represent-a-short-bit-string/36972463#36972463", "title": "What&#39;s the best way to represent a short bit string?", "body": "<p>I am not sure if this qualifies. I fear that I'm re-implementing <code>countLeadingZeros</code> in some form...</p>\n\n<p>Anyway, the idea is to snoc bits from the left, shifting right. Then, we can \"count\" the trailing zeros of <code>x</code> using <code>x-1</code> and a XOR. The result of the \"count\" is a mask \"00..01..11\" which, roughly, is a unary representation of the trailing zeros. We do not convert this unary to binary since we have no need to: with some bit-level work, we can uncons.</p>\n\n<p>Untested and unproven code follows.</p>\n\n<pre><code>import Data.Word\nimport Data.Bits\nimport Text.Printf\n\ntype T = Word64     -- can be adapted to any WordN\n\n-- for pretty printing\npr :: T -&gt; String\npr x = printf \"%064b\\n\" x\n\nempty :: T\nempty = shiftL 1 63\n\nsnoc :: T -&gt; T -&gt; T\nsnoc x xs = shiftR xs 1 .|. (shiftL x 63)\n\n-- returns (head, tail)\n-- head is not normalized (0 or 1), only (0 or /=0)\nuncons :: T -&gt; (T, T)\nuncons xs = \n   let -- example\n       -- 0101001100000000000   xs  \n       y = (xs `xor` (xs - 1))\n       -- 0000000111111111111   y\n       z = shiftR y 1 + 1\n       -- 0000000100000000000   z\n       z' = shiftL z 1\n       -- 0000001000000000000   z'\n   in (xs .&amp;. z' , (xs .&amp;. complement z) .|. z' )\n</code></pre>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "accepted_answer_id": 36972463, "answer_count": 1, "score": 6, "last_activity_date": 1462198260, "creation_date": 1462136939, "last_edit_date": 1592644375, "question_id": 36971976, "link": "https://stackoverflow.com/questions/36971976/whats-the-best-way-to-represent-a-short-bit-string", "title": "What&#39;s the best way to represent a short bit string?", "body": "<p>I want to represent a string of up to around 120 bits, and speed is critical. I need to be able to build a bitstring by repeated <code>snoc</code> operations, and then to consume it with repeated <code>uncons</code> operations. One idea is to steal the implementation of <code>Word128</code> from <code>data-dword</code> and use something like this to build:</p>\n<pre><code>empty = 1\nsnoc xs x = (xs `shiftL` 1) .|. x\n</code></pre>\n<p>But the unconsing seems to get a bit ugly, having to first <code>countLeadingZeros</code> and shift left to eliminate them before being able to read off the elements by shifting and masking the high bits.</p>\n<p>Is there some more pleasant way that's at least as fast, or some faster way that's not too much more unpleasant?</p>\n<hr />\n<h3>Context</h3>\n<p>Phil Ruffwind has proposed a version of <code>lens</code>'s <code>at</code> for <code>Data.Map</code>, but all implementations thus far are substantially slower than the naive implementation <code>lens</code> currently uses when key comparison is cheap. If I could produce a very cheap representation of the path to an entry while looking it up, and then consume it very efficiently with a specialized version of <code>insert</code> or <code>delete</code>, then maybe I could make this worthwhile.</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462198241, "post_id": 36971617, "comment_id": 61523698, "body": "well you could move the <code>instance</code> to a place where you have access to both parts"}, {"owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462212463, "post_id": 36971617, "comment_id": 61531944, "body": "When I tried to move it to <code>Event.hs</code> I got an <code>orphan instance</code> warning - so I guess that would be wrong?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1462212636, "post_id": 36971617, "comment_id": 61532029, "body": "IMO you can ignore this in this special case (the alternative would be to wrap your entity into another type and append the <code>self</code>part there - then you could move this together with it&#39;s instance up) (sometimes this is called <i>ViewModel</i> or <i>DataTransferObject</i> - obviously this is OO talk) - thinking about it this could be the better approach as you could unwrap <code>Event</code> from it&#39;s <code>Entity</code> at the same time"}, {"owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462213824, "post_id": 36971617, "comment_id": 61532614, "body": "Do you mean create something like <code>data EventEntity = Event Entity</code>?"}, {"owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462214977, "post_id": 36971617, "comment_id": 61533249, "body": "Hmm, seems I have a bigger problem, as I can&#39;t seem to <code>render &lt;- getUrlRender</code> from inside toJSON - as the <code>do</code> statement changes the return value. oh, the life of a newbie! ;)  -- I&#39;ll edit my original issue to reflect this problem"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462215505, "post_id": 36971617, "comment_id": 61533490, "body": "I was actually wondering about this - if I remember correctly you get <code>getUrlRender</code> from the <code>Yesod</code> typeclass so you are out of luck here anyway - so go <code>data MyDto = MyDto Event Url</code> load your data in this from a yesod-handler (there <code>getUrlRender</code> should be available) and make <code>MyDto</code> an instance of <code>ToJSON</code>)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462215592, "post_id": 36971617, "comment_id": 61533530, "body": "alternatively you can just produce <code>JSON</code> on the go (by using <code>toJSON</code> on the parts but now using any wrapper at all) if you like"}, {"owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462281825, "post_id": 36971617, "comment_id": 61563176, "body": "Yes, I think my only option is to add those Yesod-aware parts from within the handler itself. Thanks!"}], "owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462215303, "creation_date": 1462134760, "last_edit_date": 1462215303, "question_id": 36971617, "link": "https://stackoverflow.com/questions/36971617/how-to-avoid-circular-import-when-defining-own-tojson", "title": "How to avoid circular import when defining own ToJSon", "body": "<p>I'd like to add a <code>self</code> link to my json export, so I have in <code>Model.hs</code>:</p>\n\n<pre><code>instance ToJSON (Entity Event) where\n    toJSON (Entity eid e) = object\n        [ -- , \"href\" .= render EventR eid ]\n</code></pre>\n\n<p>However I can't seem to do <code>\"href\" .= render EventR eid</code>, because if I try to <code>Import Handler.Event</code> I get a circular dependency error</p>\n\n<p><em>Edit 1:</em></p>\n\n<p>Seems I have another problem, as trying to get the <code>render</code> causes an error (as it changes the return value). Is there a way to escape from that?</p>\n\n<pre><code>instance ToJSON (Entity Event) where\n    toJSON (Entity eid e) = do\n      render &lt;- getUrlRender\n      return $ object\n          [ \"href\" .= render EventR eid ]\n</code></pre>\n"}, {"tags": ["haskell", "type-synonyms"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1462135200, "post_id": 36971533, "comment_id": 61498952, "body": "Unrelated to your question, but I would advise not to call a construct like that <i>dual</i>. The word is quite universally used in <a href=\"https://en.wikipedia.org/wiki/Dual_object\" rel=\"nofollow noreferrer\">the category theory sense</a> in Haskell. (Though thinking about it, we already have similar name clashes, e.g. <a href=\"http://hackage.haskell.org/package/base/docs/Data-List.html#v:map\" rel=\"nofollow noreferrer\">map</a> vs <a href=\"http://hackage.haskell.org/package/containers/docs/Data-Map-Lazy.html#t:Map\" rel=\"nofollow noreferrer\">Map</a>, and it seems no big problem.)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1462135835, "post_id": 36971533, "comment_id": 61499146, "body": "As for the question, I don&#39;t think there is a good solution. <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/data-type-extensions.html#type-synonyms\" rel=\"nofollow noreferrer\">GHC <i>can</i> in fact</a> apply type synonyms partially under certain circumstances, but in this case that won&#39;t work because <code>(,)</code> works fundamentally as a type-function of two <i>unrelated</i> arguments. You <i>must</i> introduce an actual variable like <code>x</code> to couple them. A <code>newtype</code> or rather <code>data</code> will be the way to go. Or just use <a href=\"http://hackage.haskell.org/package/transformers-0.4.2.0/docs/Data-Functor-Product.html\" rel=\"nofollow noreferrer\"><code>Product</code></a>."}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1462146421, "post_id": 36971533, "comment_id": 61502024, "body": "@leftaroundabout yes, I was aware of the clash, and that isn&#39;t the name that I&#39;m using in my program. I just couldn&#39;t come up with a better one for the question at the time of writing."}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1462149658, "post_id": 36971533, "comment_id": 61502732, "body": "@leftaroundabout If you move your comment into a question, I will accept it."}], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1462146441, "creation_date": 1462134287, "last_edit_date": 1495540361, "question_id": 36971533, "link": "https://stackoverflow.com/questions/36971533/instancing-tuples", "title": "Instancing tuples", "body": "<p>I have a class, <code>C</code>, of <code>* -&gt; *</code> types.</p>\n\n<pre><code>class C f where\n  foo :: f a -&gt; a -&gt; a\n</code></pre>\n\n<p>I also have two types, <code>A</code> and <code>B</code>, which are instances of <code>C</code></p>\n\n<pre><code>instance C A where\n  foo a x = ...\n\ninstance C B where\n  foo b x = ...\n</code></pre>\n\n<p>For various reasons, I also want the type <code>D</code>, defined as follows, to be an instance of <code>C</code>.</p>\n\n<pre><code>type D x = (A x, B x)\n</code></pre>\n\n<p>According to the answer to <a href=\"https://stackoverflow.com/questions/9289893/declaring-instances-of-parameterized-type-synonyms\">this question</a>, type synonyms can't be partially applied, and to define the instance as I would like, I either need to define it in steps (preferable) or define <code>D</code> as a newtype (less preferable). It seems to me like there should be some way to accomplish the former, but I haven't been able to figure one out so far. Any help is appreciated.</p>\n"}, {"tags": ["haskell", "pattern-matching", "bind", "monads"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462131081, "post_id": 36970817, "comment_id": 61497535, "body": "Well, if I translate it correctly, it means that, apparently, one can pattern-match in reverse, defining parts of a pattern out of variables that, well are of the same pattern, so I could apparently write: <code>let (a,_) = (1,2); (_,b) = (3,4) in (a,b) == (1,4)</code>. This ability to define values by successive &quot;partial&quot; pattern-matching, taking bits from other variables, is something i merely ignored. I knew of it without <code>_</code>, basically, except of course when defining functions, but implicitly it&#39;s completely different here, don&#39;t you think?"}, {"owner": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462131628, "post_id": 36970817, "comment_id": 61497741, "body": "By the way, you wrote <code>pFst (Pair _ y) = y</code> but were victim of the copy-paste hex, as it should have been <code>pSnd</code>. And thanks, of course. I tried to edit my previous comment but it got refused."}, {"owner": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462131751, "post_id": 36970817, "comment_id": 61497782, "body": "I&#39;m sorta new at SOverflow, do I have to do something special now it got resolved?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462132312, "post_id": 36970817, "comment_id": 61497966, "body": "Comments aren&#39;t really meant to be persistent, editable entities. Just delete a comment if it&#39;s not correct anymore."}, {"owner": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462132604, "post_id": 36970817, "comment_id": 61498040, "body": "No I meant to edit to add what I wrote in the second comment. Your footnote example is intriguing, must I understand that <code>1 + 2</code> is treated as a non-evaluated Integral (because of laziness), and since it&#39;s pattern-matched to be the &quot;singleton&quot; 4, then it&#39;s &quot;blindly&quot; evaluated as such? and recognized after the <code>in</code> of the <code>let in</code> probably because of the strategy of graph reduction of Haskell?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462132823, "post_id": 36970817, "comment_id": 61498130, "body": "<code>let 1+2=4 in 1+2</code> defines a <i>new local infix function <code>+</code></i> (shadowing <code>Prelude.+</code>) which is only defined for the particular arguments <code>1</code> and <code>2</code>. Then evaluating this function as <code>1+2</code> happens to work, whereas <code>1+3</code> will give an error. You can shadow any value in Haskell (like <code>x</code> or <code>(+)</code>), but not constructors."}, {"owner": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462134876, "post_id": 36970817, "comment_id": 61498837, "body": "I see, of course it was the function <code>(+)</code> that was defined! ^^ Yeah, well it&#39;d be hard with constructors. Though, beyond the scope of one file, the statement <code>import ... hiding</code> I suppose could be said to allow some pseudo-shadowing of constructors, don&#39;t you think? (I insist on the <b>pseudo</b>) Thanks again!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462134995, "post_id": 36970817, "comment_id": 61498871, "body": "Yes, but it always requires a <code>data</code> or <code>newtype</code> keyword to define a new constructor (shadowing or otherwise)."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1462132323, "last_edit_date": 1462132323, "creation_date": 1462130033, "answer_id": 36970817, "question_id": 36970746, "link": "https://stackoverflow.com/questions/36970746/haskell-monad-definition-of-bind-and-weird-pattern-matching-on-an-output-valu/36970817#36970817", "title": "haskell, monad, definition of bind, and weird pattern matching on an output value?", "body": "<p>There is no &ldquo;particular syntax&rdquo; here, just a normal pattern matching. The code is equivalent to</p>\n\n<pre><code>pFst, pSnd :: Pair a -&gt; a\npFst (Pair x _) = x\npSnd (Pair _ y) = y\n\ninstance Monad Pair where\n  return x = P x x\n  P a b &gt;&gt;= f = P x y\n     where x = pFst $ f a\n           y = pSnd $ f b\n</code></pre>\n\n<p>If you inline <code>pFst</code> and <code>pSnd</code>, you see that this leads straight to the original definition.</p>\n\n<p>If you're not convinced, consider that (non-recursive) <code>where</code> bindings can be replaced with lambda abstractions:</p>\n\n<pre><code>  P a b &gt;&gt;= f = (\\(Pair x _) (Pair _ y) -&gt; P x y)\n                  (f a)      (f b)\n</code></pre>\n\n<p>Evidently, that lambda could just as well be written as a named local function:</p>\n\n<pre><code>  P a b &gt;&gt;= f = pFstAndPSnd (f a) (f b)\n   where pFstAndPSnd (Pair x _) (Pair _ y) = P x y\n</code></pre>\n\n<hr>\n\n<p>Perhaps it would have been less confusing if you had seen the code as it would look for ordinary tuples:</p>\n\n<pre><code>(&gt;&gt;=) :: (c,c) -&gt; (c -&gt; (d,d)) -&gt; (d,d)\n(a,b) &gt;&gt;= f = (x,y)\n  where (x,_) = f a\n        (_,y) = f b\n</code></pre>\n\n<p>This is <em>obviously</em><sup>&dagger;</sup> not redefining the <code>(,)</code> constructor in any way, just using it to pattern-match on tuple results of a function.</p>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>Well, ok, perhaps it's not <em>that</em> obvious, seeing as you can also do stuff like <code>let 1+2=4 in 1+2</code>, and get <code>4</code> as the result.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462132301, "post_id": 36970820, "comment_id": 61497958, "body": "It wasn&#39;t exactly this part that which I didn&#39;t understand, but the part that you ellipse-d, aka the part where <code>P x y</code> is defined through  &quot;reversed&quot; pattern-matching. I mean that of course in my terminology; aka the one that is supposed to fill the left side by taking things from the right side like a mirror (like in do-notation Monad &quot;decapsulation&quot;, vaguely speaking), instead of defining the right side in terms of the left side of the <code>=</code> sign, as for function definitions, and <code>case of</code> pattern-matching, in which case of course it&#39;s an <code>-&gt;</code> instead of an <code>=</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462133593, "post_id": 36970820, "comment_id": 61498385, "body": "it&#39;s not <i>defined</i> - it&#39;s just what <i>pattern-matching</i> is - while defining the function <code>(&gt;&gt;=)</code> you pattern-match the first argument to <code>P a b</code> and since <code>Pair</code>only has this one constructor this will catch everything (so no need to have another one) - you should have seen this from the way you work with lists in function (where you have usually one pattern/case <code>f [] = ...</code> and one <code>f (x:xs) = ...</code> - again one for each constructor of a list"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462133642, "post_id": 36970820, "comment_id": 61498404, "body": "of course you can do this with a <code>case ... of</code> construct too - but it reads much nicer this way don&#39;t you agree?"}, {"owner": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462134423, "post_id": 36970820, "comment_id": 61498660, "body": "you&#39;re somewhat deaf, but I&#39;ll repeat again: I got <b>no</b> problem with <code>P a b</code>. I had a problem with the pattern-matching-based definitions of <code>x</code> and <code>y</code>, well, with the global area after the <code>=</code> of the bind method definition, not before. I&#39;m well aware of function definition pattern matching. Do you really believe that after several weeks of learning, anyone could miss that essential point in haskell? As you said, I (anyone) <b>should</b> already have understood what you try repetitively to make me understand, and in fact, well I <b>have</b> indeed."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462134782, "post_id": 36970820, "comment_id": 61498799, "body": "@trigone Hey, polite! This is your question we&#39;re answering."}, {"owner": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 0, "creation_date": 1462135294, "post_id": 36970820, "comment_id": 61498981, "body": "hindsight is 20/20, and I agree, I shouldn&#39;t have reacted as such, I&#39;m sorry. It&#39;s just I had the feeling Carsten hadn&#39;t really read much either of my question nor of my first answer-comment. still doesn&#39;t excuse my behavior. do I remove my abrasive comment to replace it with a nicer one?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "edited": false, "score": 1, "creation_date": 1462137218, "post_id": 36970820, "comment_id": 61499623, "body": "@trigone no worries, I don&#39;t suppose Carsten is too offended and you won&#39;t be expelled for one impolite comment. More as general advice for the future: if you find something off the point on StackOverflow, just ignore it \u2013 the poster may be targeting an aspect of the question that you never intended, but this can still be useful for <i>other</i> users who find the post in the future and were in fact looking for that other aspect."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462161839, "post_id": 36970820, "comment_id": 61505044, "body": "well as soon as I&#39;m offended by the internet or this site I&#39;ll just stop using it - btw @trigone I read and tried to understand your questions but your <i>terminology</i> just does not make any sense to me (reversed pattern-matching for example - isn&#39;t this just construction?) so please don&#39;t be offended as well when I tell you to please grab yourself some book or tutorial and start with the very basics (that might go for manners as well)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1462130043, "creation_date": 1462130043, "answer_id": 36970820, "question_id": 36970746, "link": "https://stackoverflow.com/questions/36970746/haskell-monad-definition-of-bind-and-weird-pattern-matching-on-an-output-valu/36970820#36970820", "title": "haskell, monad, definition of bind, and weird pattern matching on an output value?", "body": "<p>well <code>P</code> is indeed the constructor for the <code>Pair</code> so <code>a</code> and <code>b</code> will be the first and second element of this (a bit strange) <em>pair</em> (if you say <code>x = P 1 2</code> an do <code>x &gt;&gt;= f</code> then here <code>a = 1</code> and <code>b = 2</code> - it's exactly <em>pattern-matching</em></p>\n\n<p>My guess is that you have trouble with the definition of the function. If it helps you could write it as:</p>\n\n<pre><code>(&gt;&gt;=) (P a b) f = P x y\n    where ...\n</code></pre>\n\n<p>too</p>\n\n<p>see: just as you can us the operator between arguments so can you define it there</p>\n"}], "owner": {"reputation": 13, "user_id": 6278152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hKJF.jpg?s=128&g=1", "display_name": "icelake", "link": "https://stackoverflow.com/users/6278152/icelake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 36970817, "answer_count": 2, "score": 1, "last_activity_date": 1462140391, "creation_date": 1462129494, "last_edit_date": 1495542704, "question_id": 36970746, "link": "https://stackoverflow.com/questions/36970746/haskell-monad-definition-of-bind-and-weird-pattern-matching-on-an-output-valu", "title": "haskell, monad, definition of bind, and weird pattern matching on an output value?", "body": "<p>Below is some code coming from the answer to <a href=\"https://stackoverflow.com/questions/13034229/concrete-example-showing-that-monads-are-not-closed-under-composition-with-proo?lq=1\">another stack overflow question</a>. It's been several weeks i've started studying Haskell, and i had yet to encounter this particular syntax, and i can't find anywhere an explanation, not even a definition for it.\nSo, the code:</p>\n\n<pre><code>data Pair a = P a a\n\ninstance Functor Pair where\n  fmap f (P x y) = P (f x) (f y)\n\ninstance Monad Pair where\n  return x = P x x\n  P a b &gt;&gt;= f = P x y\n     where P x _ = f a\n           P _ y = f b\n</code></pre>\n\n<p>I spent the last half-hour trying to understand the meaning of it, or if something i already knew explained the definition of this bind (>>=) method. GHCI loaded it without fretting (well it demanded an Applicative instance but other than that), so it must be very much allowed, even if i have yet to understand the beginning of it.</p>\n\n<p>What is the meaning of what looks like a definition by pattern-matching of an already defined data constructor? What are x and y, where do they come from?</p>\n\n<p>Thanks to anyone who answers to that. And if anyone has a good idea for a good, specific title to this question -- given I really don't understand the very syntaxic meaning, I have trouble finding one.</p>\n\n<hr>\n\n<p>@leftaroundabout gave me the information I needed, which was that that bit of code</p>\n\n<pre><code>P x y\n  where P x _ = f a\n        P _ y = f b\n</code></pre>\n\n<p>was a form of pattern-matching of the \"value-unboxing\" type, instead of the <code>case of</code>-like choice-oriented one. I was baffled by the presence of the <code>_</code> pattern, and thus I didn't see the above two pattern-matchings as they were, that is, as the definitions of <code>x</code> then <code>y</code>, because it was done in a way I had never witnessed before.</p>\n\n<p>I knew we could write something like that:</p>\n\n<pre><code>f :: foo -&gt; (Int, Int)\n...\ni = let (a,b) = f x\n    in a + b\n</code></pre>\n\n<p>but I didn't know we could use, in these cases of \"value-unboxing\" (here <code>a</code> and <code>b</code> for example, or <code>x</code> and <code>y</code> in the code that bugged me), the full extent of the possibilities in pattern-matching, that is, at least, definitions using <code>_</code> to isolate the parts we don't want, the values we don't want to bind to any \"label\".</p>\n\n<p>In short I didn't know that in the above example, this equation</p>\n\n<pre><code>P x _ = f a\n</code></pre>\n\n<p>was actually the definition of <code>x</code> through pattern-matching on the result of <code>(f a)</code>, thus that it was strictly equivalent in effect to</p>\n\n<pre><code>x = g (f a)\n  where g (P t _) = t\n</code></pre>\n\n<p>I was stuck at thinking it was the definition of the already-defined data constructor <code>P</code>.</p>\n"}, {"tags": ["scala", "haskell", "f#", "functional-programming", "purely-functional"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1462122462, "post_id": 36969344, "comment_id": 61494505, "body": "well I think it&#39;s not so simple (although I would say yes) - for example: everything has sideeffects in the computer (it makes the CPU warmer) and some would consider it ok if a function in say F# mutates internal state if it&#39;s not passed outside ..."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1462122695, "post_id": 36969344, "comment_id": 61494597, "body": "maybe see <a href=\"https://en.wikipedia.org/wiki/Pure_function\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Pure_function</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1462126296, "post_id": 36969344, "comment_id": 61495881, "body": "I don&#39;t think &quot;pure&quot; has a precise, widely-accepted definition. However &quot;referential transparency&quot; does, so you may enjoy that concept more."}, {"owner": {"reputation": 4592, "user_id": 2821954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KAcfF.png?s=128&g=1", "display_name": "Andrew T.", "link": "https://stackoverflow.com/users/2821954/andrew-t"}, "edited": false, "score": 4, "creation_date": 1462158593, "post_id": 36969344, "comment_id": 61504437, "body": "Is this related to <a href=\"http://programmers.stackexchange.com/questions/317245/what-do-you-call-a-function-thats-pure-meaning-the-same-input-will-always-retu\">Pure function HNQ question on Programmers.SE</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 5, "creation_date": 1462125125, "post_id": 36969568, "comment_id": 61495480, "body": "Two easy-to-understand examples of input impurities are: 1: Creating a new GUID/UUDI. 2: Reading the current time. Both functions take <code>unit</code>/<code>()</code> as input, and return different values every time they are called."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1462125346, "post_id": 36969568, "comment_id": 61495563, "body": "As far as I understand Haskell, impurity can only happen within the <code>IO</code> context. Sure, <code>IO</code> is part of a monad, but all other monads in Haskell (that I know of), e.g. <i>List</i>, <i>Maybe</i>, <i>Either</i>, <i>Reader</i>, <i>State</i>, <i>Writer</i>, etcetera, are pure."}, {"owner": {"reputation": 15429, "user_id": 308668, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1760ce981f53c8ccc1ef62493d3805cc?s=128&d=identicon&r=PG&f=1", "display_name": "mike3996", "link": "https://stackoverflow.com/users/308668/mike3996"}, "edited": false, "score": 0, "creation_date": 1462190020, "post_id": 36969568, "comment_id": 61518445, "body": "An example: <code>R: () -&gt; Float</code> that produces a random float using a PRNG. It needs to store the seed somehow. If R stores the seed to a global variable somewhere, it&#39;s very much changing the environment and thus has a big side effect. On the other hand, if R stores the seed to a static function-local place that no one can access, its side effects are very local, to the point I&#39;d say it&#39;s neither pure (referentially transparent) or side effecting much."}, {"owner": {"reputation": 21876, "user_id": 1678362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ba023d18099cde022b9e4394d5714c0?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/1678362/aaron"}, "edited": false, "score": 0, "creation_date": 1462197743, "post_id": 36969568, "comment_id": 61523374, "body": "I&#39;ve recently read an SO answer on about the same topic that distinguished purity/impurity and referential transparency/opacity : if the function depended on the environment, it was impure, else it was pure. If the function produced side effects, it was referentially opaque, else it was referentially transparent. So I think what you&#39;re calling output impurity might be this notion of referential transparency."}], "tags": [], "owner": {"reputation": 224912, "user_id": 33518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d06834fe3fb105f62b2186aba4a430d5?s=128&d=identicon&r=PG", "display_name": "Tomas Petricek", "link": "https://stackoverflow.com/users/33518/tomas-petricek"}, "is_accepted": false, "score": 59, "last_activity_date": 1462123197, "creation_date": 1462123197, "answer_id": 36969568, "question_id": 36969344, "link": "https://stackoverflow.com/questions/36969344/are-side-effects-everything-that-cannot-be-found-in-a-pure-function/36969568#36969568", "title": "Are side effects everything that cannot be found in a pure function?", "body": "<p>This very much depends on the definitions that you choose. It is definitely fair to say that a function is <em>pure</em> or <em>impure</em>. A pure function always returns the same result and does not modify the environment. An impure function can return different results when it is executed repeatedly (which can be caused by doing something to the environment).</p>\n\n<p>Are all impurities side-effects? I would not say so - a function can depend on something in the environment in which it executes. This could be reading some configuration, GPS location or reading data from the internet. These are not really \"side-effects\" because it does not <em>do anything to the world</em>.</p>\n\n<p>I think there are two different kinds of impurities:</p>\n\n<ul>\n<li><p><strong>Output impurity</strong> is when a function does something to the world. In Haskell, this is modelled using monads - an impure function <code>a -&gt; b</code> is actually a function <code>a -&gt; M b</code> where <code>M</code> captures the other things that it does to the world.</p></li>\n<li><p><strong>Input impurity</strong> is when a function requires something from the environment. An impure function <code>a -&gt; b</code> can be modelled as a function <code>C a -&gt; b</code> where the type <code>C</code> captures other things from the environment that the function may access.</p></li>\n</ul>\n\n<p>Monads and output impurities are certainly better known, but I think input impurities are equally important. I wrote <a href=\"http://tomasp.net/coeffects/\">my PhD thesis about input impurities</a> which I call <em>coeffects</em>, so I this might be a biased answer though.</p>\n"}, {"comments": [{"owner": {"reputation": 156828, "user_id": 497418, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/248d820c4cc1b6eb7924c658c45443b5?s=128&d=identicon&r=PG", "display_name": "zzzzBov", "link": "https://stackoverflow.com/users/497418/zzzzbov"}, "edited": false, "score": 0, "creation_date": 1462197954, "post_id": 36969624, "comment_id": 61523510, "body": "I&#39;ve updated some of your formatting and grammar. I hope it still reads as you intended."}], "tags": [], "owner": {"reputation": 740, "user_id": 2335364, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/FNVVM.png?s=128&g=1", "display_name": "artemonster", "link": "https://stackoverflow.com/users/2335364/artemonster"}, "is_accepted": false, "score": 11, "last_activity_date": 1462197901, "last_edit_date": 1462197901, "creation_date": 1462123483, "answer_id": 36969624, "question_id": 36969344, "link": "https://stackoverflow.com/questions/36969344/are-side-effects-everything-that-cannot-be-found-in-a-pure-function/36969624#36969624", "title": "Are side effects everything that cannot be found in a pure function?", "body": "<p>For a function to be pure it must:</p>\n\n<ol>\n<li>not be affected by side-effects (i.e. always return same value for same arguments)</li>\n<li>not cause side-effects</li>\n</ol>\n\n<p>But, you see, this <em>defines</em> functional purity <em>with</em> the property or absence of side-effects. You are trying to apply backwards logic to deduct the definition of side-effects using pure functions, which logically should work, but practically the definition of a side-effect has nothing to do with functional purity.</p>\n"}, {"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": false, "score": 5, "last_activity_date": 1462138848, "last_edit_date": 1462138848, "creation_date": 1462134022, "answer_id": 36971495, "question_id": 36969344, "link": "https://stackoverflow.com/questions/36969344/are-side-effects-everything-that-cannot-be-found-in-a-pure-function/36971495#36971495", "title": "Are side effects everything that cannot be found in a pure function?", "body": "<p>A way to define purity of a function <code>f</code> is <code>\u2200x\u2200y x = y \u21d2 f x = f y</code>, i.e. given the same argument the function returns the same result, or it preserves equality. </p>\n\n<p>This isn't what people usually mean when they talk about \"pure functions\"; they usually mean \"pure\" as \"does not have side effects\". I haven't figured out how to qualify a \"side effect\" (comments welcome!) so I don't have anything to say about it.</p>\n\n<p>Nonetheless, I'll explore this concept of purity because it might offer some related insight. I'm no expert here; this is mostly me just rambling. I do however hope it sparks some insightful (and corrective!) comments.</p>\n\n<p>To understand purity we have to know what equality we are talking about. What does <code>x = y</code> mean, and what does <code>f x = f y</code> mean?</p>\n\n<p>One choice is the Haskell semantic equality. That is, equality of the semantics Haskell assigns to its terms. As far as I know there are no official denotational semantics for Haskell, but <a href=\"https://en.wikibooks.org/wiki/Haskell/Denotational_semantics\" rel=\"noreferrer\"><em>Wikibooks Haskell Denotational Semantics</em></a> offers a reasonable standard that I think the community more or less agrees to ad-hoc. When Haskell says its functions are pure this is the equality it refers to.</p>\n\n<p>Another choice is a user-defined equality (i.e. <code>(==)</code>) by deriving the <code>Eq</code> class. This is relevant when using denotational design \u2014 that is, we are assigning our own semantics to terms. With this choice we can accidentally write functions which are impure; Haskell is not concerned with our semantics.</p>\n\n<p>I will refer to the Haskell semantic equality as <code>=</code> and the user-defined equality as <code>==</code>. Also I assume that <code>==</code> is an equality relation \u2014 this does not hold for some instances of <code>==</code> such as for <code>Float</code>.</p>\n\n<p>When I use <code>x == y</code> as a proposition what I really mean is <code>x == y = True \u2228 x == y = \u22a5</code>, because <code>x == y :: Bool</code> and <code>\u22a5 :: Bool</code>. In other words, when I say <code>x == y</code> is true, I mean that if it computes to something other than \u22a5 then it computes to True.</p>\n\n<p>If <code>x</code> and <code>y</code> are equal according to Haskell's semantics then they are equal according to any other semantic we may choose.</p>\n\n<p>Proof: if <code>x = y</code> then <code>x == y \u2261 x == x</code> and <code>x == x</code> is true because <code>==</code> is pure (according to <code>=</code>) and reflexive.</p>\n\n<p>Similarly we can prove <code>\u2200f\u2200x\u2200y x = y \u21d2 f x == f y</code>. If <code>x = y</code> then <code>f x = f y</code> (because <code>f</code> is pure), therefore <code>f x == f y \u2261 f x == f x</code> and <code>f x == f x</code> is true because <code>==</code> is pure and reflexive.</p>\n\n<p>Here is a silly example of how we can break purity for a user-defined equality.</p>\n\n<pre><code>data Pair a = Pair a a\n\ninstance (Eq a) =&gt; Eq (Pair a) where\n  Pair x _ == Pair y _ = x == y\n\nswap :: Pair a -&gt; Pair a\nswap (Pair x y) = Pair y x\n</code></pre>\n\n<p>Now we have:</p>\n\n<pre><code>Pair 0 1 == Pair 0 2\n</code></pre>\n\n<p>But:</p>\n\n<pre><code>swap (Pair 0 1) /= swap (Pair 0 2)\n</code></pre>\n\n<blockquote>\n  <p><strong>Note:</strong> <code>\u00ac(Pair 0 1 = Pair 0 2)</code> so we were not guaranteed that our definition of <code>(==)</code> would be okay.</p>\n</blockquote>\n\n<p>A more compelling example is to consider <code>Data.Set</code>. If <code>x, y, z :: Set A</code> then you would hope this holds, for example:</p>\n\n<pre><code>x == y \u21d2 (Set.union z) x == (Set.union z) y\n</code></pre>\n\n<p>Especially when <code>Set.fromList [1,2,3]</code> and <code>Set.fromList [3,2,1]</code> denote the same set but probably have different (hidden) representations (not equivalent by Haskell's semantics). That is to say we want to be sure that <code>\u2200z Set.union z</code> is pure according to <code>(==)</code> for <code>Set</code>.</p>\n\n<p>Here is a type I have played with:</p>\n\n<pre><code>newtype Spry a = Spry [a]\n\ninstance (Eq a) =&gt; Eq (Spry a) where\n  Spry xs == Spry ys = fmap head (group xs) == fmap head (group ys)\n</code></pre>\n\n<p>A <code>Spry</code> is a list which has non-equal adjacent elements. Examples:</p>\n\n<pre><code>Spry [] == Spry []\nSpry [1,1] == Spry [1]\nSpry [1,2,2,2,1,1,2] == Spry [1,2,1,2]\n</code></pre>\n\n<p>Given this, what is a pure implementation (according to <code>==</code> for Spry) for <code>flatten :: Spry (Spry a) -&gt; Spry a</code> such that if <code>x</code> is an element of a sub-spry it is also an element of the flattened spry (i.e. something like <code>\u2200x\u2200xs\u2200i x \u2208 xs[i] \u21d2 x \u2208 flatten xs</code>)? Exercise for the reader.</p>\n\n<p>It is also worth noting that the functions we've been talking about are across the same domain, so they have type <code>A \u2192 A</code>. That is except for when we proved <code>\u2200f\u2200x\u2200y x = y \u21d2 f x == f y</code> which crosses from Haskell's semantic domain to our own. This might be a homomorphism of some sorts\u2026 maybe a category theorist could weigh in here (and please do!).</p>\n"}, {"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 6, "last_activity_date": 1462175725, "last_edit_date": 1462175725, "creation_date": 1462165749, "answer_id": 36975333, "question_id": 36969344, "link": "https://stackoverflow.com/questions/36969344/are-side-effects-everything-that-cannot-be-found-in-a-pure-function/36975333#36975333", "title": "Are side effects everything that cannot be found in a pure function?", "body": "<p>I don't see problems with the definition of a pure function: a pure function is a function. I.e. it has a domain, a codomain and maps the elements of the former to the elements of the latter. It's defined on all inputs. It doesn't do anything to the environment, because \"the environment\" at this point doesn't exist: there are no machines that can execute (for some definition of \"execute\") a given function. There is just a total mapping from something to something.</p>\n\n<p>Then some capitalist decides to invade the world of well-defined functions and enslave such pure creatures, but their fair essence can't survive in our cruel reality, functions become dirty and start to make the CPU warmer.</p>\n\n<p>So it's the environment is responsible for making the CPU warmer and it makes perfect sense to talk about purity before its owner was abused and executed. In the same way referential transparency is a property of a language \u2014 it doesn't hold in the environment in general, because there can be a bug in the compiler or a meteorite can fall upon your head and your program will stop producing the same result.</p>\n\n<p>But there are other creatures: the dark inhabitants of the underworld. They look like functions, but they are aware of the environment and can interact with it: read variables, send messages and launch missiles. We call these fallen relatives of functions \"impure\" or \"effectful\" and avoid as much as possible, because their nature is so dark that it's impossible to reason about them.</p>\n\n<p>So there is clearly a big difference between those functions which can interact with the outside and those which doesn't. However the definition of \"outside\" can vary too. The <code>State</code> monad is modeled using only pure tools, but we think about <code>f : Int -&gt; State Int Int</code> as about effectful computation. Moreover, <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/TotallyFree.pdf\" rel=\"nofollow\">non-termination</a> and exceptions (<code>error \"...\"</code>) are effects, but haskellers usually don't consider them so.</p>\n\n<p>Summarizing, a pure function is a well-defined mathematical concept, but we usually consider functions in programming languages and what is pure there depends on your point of view, so it doesn't make much sense to talk about dichotomies when involved concepts are not well-defined.</p>\n"}, {"tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": false, "score": 1, "last_activity_date": 1462201436, "creation_date": 1462201436, "answer_id": 36985613, "question_id": 36969344, "link": "https://stackoverflow.com/questions/36969344/are-side-effects-everything-that-cannot-be-found-in-a-pure-function/36985613#36985613", "title": "Are side effects everything that cannot be found in a pure function?", "body": "<p>Side effects are part of the definition of the language.  In the expression</p>\n\n<pre><code>f e\n</code></pre>\n\n<p>the <em>side effects</em> of <code>e</code> are all the parts of <code>e</code>'s behavior that are 'moved out' and become part of the behavior of the application expression, rather than being passed into <code>f</code> as part of the <em>value</em> of <code>e</code>.</p>\n\n<p>For a concrete example, consider this program:</p>\n\n<pre><code>f x = x; x\nf (print 3)\n</code></pre>\n\n<p>where conceptually the syntax <code>x; x</code> means 'run x, then run it again and return the result'.</p>\n\n<p>In a language where <code>print</code> writes to stdout as a side effect, this writes</p>\n\n<pre><code>3\n</code></pre>\n\n<p>because the output is part of the semantics of the application expression.</p>\n\n<p>In a language where the output of <code>print</code> is not a side effect, this writes</p>\n\n<pre><code>3\n3\n</code></pre>\n\n<p>because the output is part of the semantics of the <code>x</code> variable inside the definition of <code>f</code>.</p>\n"}], "owner": {"reputation": 15873, "user_id": 139667, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e083e1865879535bb75306472b4ba5d0?s=128&d=identicon&r=PG&f=1", "display_name": "Trident D&#39;Gao", "link": "https://stackoverflow.com/users/139667/trident-dgao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2630, "favorite_count": 4, "answer_count": 5, "score": 28, "last_activity_date": 1477675628, "creation_date": 1462121993, "last_edit_date": 1477675628, "question_id": 36969344, "link": "https://stackoverflow.com/questions/36969344/are-side-effects-everything-that-cannot-be-found-in-a-pure-function", "title": "Are side effects everything that cannot be found in a pure function?", "body": "<p>Is it safe to say that the following dichotomy holds:</p>\n\n<p>Each given function is</p>\n\n<ul>\n<li>either pure</li>\n<li>or has side effects</li>\n</ul>\n\n<p>If so, side effects (of a function) are anything that can't be found in a pure function.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1462114495, "post_id": 36967977, "comment_id": 61491637, "body": "<code>foldr</code> <b>is</b> in many ways <i>the</i> function around <i>lists</i> - why you would use this over <code>sum</code> and <code>product</code>? Well because you can use it to define those functions (but you are right - you would not - you would use those for readability)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 7, "creation_date": 1462114546, "post_id": 36967977, "comment_id": 61491654, "body": "aside from this there are <i>many</i> questions just like this - for example: <a href=\"https://stackoverflow.com/questions/1757740/how-foldr-works\">stackoverflow.com/questions/1757740/how-foldr-works</a> (possible duplicate)"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 1, "creation_date": 1462115561, "post_id": 36967977, "comment_id": 61492014, "body": "You wouldn&#39;t use <code>foldr</code> for summation anyway, you&#39;d use <a href=\"https://wiki.haskell.org/Foldr_Foldl_Foldl&#39;\" rel=\"nofollow noreferrer\"><code>foldl&#39;</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 2, "last_activity_date": 1462115729, "creation_date": 1462115729, "answer_id": 36968250, "question_id": 36967977, "link": "https://stackoverflow.com/questions/36967977/what-does-foldr-do-in-haskell/36968250#36968250", "title": "What does foldr do in Haskell?", "body": "<p><code>sum</code> and <code>product</code> are themselves defined using <code>fold</code> (<code>foldl</code>, not <code>foldr</code>, but let's set aside that distinction for now), so in a sense you <em>are</em> using fold when using those functions. Likewise <code>or</code>, <code>and</code>, <code>concat</code> and many more are all defined using folds as well. So that's already one reason for folds to exist: many of the standard functions can be defined using them instead of having redundant code.</p>\n\n<p>So when would you use folds directly? When doing something that there isn't already a specific function for, i.e. when you want to combine the elements of the list using something other than <code>+</code> or <code>*</code> (or <code>||</code>, <code>&amp;&amp;</code> or <code>++</code>).</p>\n\n<p>Say you have a list of single-digit numbers and you want to \"concatenate\" them into one number:</p>\n\n<pre><code>concatDigits = foldl (\\acc d -&gt; d + acc * 10) 0\n</code></pre>\n\n<p>Now <code>concatDigits [1,2,3]</code> gives you <code>123</code>.</p>\n\n<p>Or you've defined some datastructure and you want to convert lists to it:</p>\n\n<pre><code>fromList = foldr insert empty`\n</code></pre>\n\n<p>In fact that's how <code>fromList</code> is commonly defined for many data structures.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462152030, "post_id": 36972409, "comment_id": 61503191, "body": "We build sets with <code>foldl&#39;</code>, generally, but <code>foldl&#39;</code> is defined using <code>foldr</code>."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 0, "last_activity_date": 1462141497, "last_edit_date": 1462141497, "creation_date": 1462139676, "answer_id": 36972409, "question_id": 36967977, "link": "https://stackoverflow.com/questions/36967977/what-does-foldr-do-in-haskell/36972409#36972409", "title": "What does foldr do in Haskell?", "body": "<p>The <a href=\"https://en.wikipedia.org/wiki/Fold_%28higher-order_function%29\" rel=\"nofollow noreferrer\">Wikipedia entry</a> has a good illustration of what <code>foldr</code> does to a list and how it differs from <code>foldl</code>.</p>\n\n<p>The list <code>[1,2,3]</code> is generated by the cons operator <code>(:)</code> and the empty list <code>[]</code> by this expression tree:</p>\n\n<pre><code>    :\n   / \\\n  1   :\n     / \\\n    2   :\n       / \\\n      3   []\n</code></pre>\n\n<p><code>foldr f z</code> replaces the cons operator nodes with <code>f</code> and the empty list with <code>z</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WJ4I2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WJ4I2.png\" alt=\"enter image description here\"></a></p>\n\n<p>By contrast, <code>foldl f z</code> reorients the expression tree and repositions the zero element at the opposite end of the computation:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wtHfy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wtHfy.png\" alt=\"enter image description here\"></a> </p>\n\n<p>Some observations:</p>\n\n<ol>\n<li><p>Note that <code>foldr (:) []</code> leaves a list unchanged:</p>\n\n<pre><code>foldr (:) [] [1..10] == [1..10]\n</code></pre></li>\n</ol>\n\n<p>This makes sense since we are simply replacing the cons operator with itself and the empty list with the empty list and thus not changing anything.</p>\n\n<ol start=\"2\">\n<li><p>If we replace the empty list with some other list we should be able to append two lists, e.g.:</p>\n\n<pre><code>foldr (:) [9,8,7] [1,2,3] == [1,2,3,9,8,7]\n</code></pre></li>\n<li><p>The cons operator may be thought of a way to add an element to a list:</p>\n\n<pre><code>(:) :: a -&gt; [a] -&gt; [a]\n</code></pre></li>\n</ol>\n\n<p>If we define <code>f</code> as:</p>\n\n<pre><code>    f :: Int -&gt; [Int] -&gt; [Int]\n    f a as = [0] ++ [a] ++ as\n</code></pre>\n\n<p>then <code>foldr f []</code> will prepend a 0 before each element of the input list:</p>\n\n<pre><code>    foldr f [] [1,2,3] == [0,1,0,2,0,3]\n</code></pre>\n\n<ol start=\"4\">\n<li><p><code>Data.Set</code> has a function <code>insert</code> whose signature is structually similar to that of <code>(:)</code>:</p>\n\n<pre><code>insert :: Ord a =&gt; a -&gt; Set a -&gt; Set a\n</code></pre></li>\n</ol>\n\n<p>Indeed, we can convert a list to a Set using <code>foldr</code></p>\n\n<pre><code>    import qualified Data.Set as S\n\n    foldr S.insert S.empty [1,2,3]\n</code></pre>\n\n<p>Note how the empty list is replaced with the empty set - <code>S.empty</code>.\nThis is the idiomatic approach to building up data structures one element at a time - e.g. hash maps, tries, trees, etc.</p>\n"}], "owner": {"reputation": 285, "user_id": 5661795, "user_type": "registered", "accept_rate": 21, "profile_image": "https://graph.facebook.com/10206951151289259/picture?type=large", "display_name": "HJGBAUM", "link": "https://stackoverflow.com/users/5661795/hjgbaum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1500, "favorite_count": 0, "closed_date": 1462217826, "answer_count": 2, "score": 0, "last_activity_date": 1462141497, "creation_date": 1462114252, "question_id": 36967977, "link": "https://stackoverflow.com/questions/36967977/what-does-foldr-do-in-haskell", "closed_reason": "Duplicate", "title": "What does foldr do in Haskell?", "body": "<p>So I came across the foldr function in Haskell which from what I pick up, you can use to calculate the product and sum of a list:</p>\n\n<pre><code>foldr f x xs\n\nfoldr (*) 1 [1..5] = 120\nfoldr (+) 0 [1..5] = 15\n</code></pre>\n\n<p>And adding numbers onto the x part would like, add on to the overall sum or multiply onto the final product</p>\n\n<p>What does foldr actually do and why would anyone use it instead of the built in functions 'sum' or 'product' etc?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1462113040, "post_id": 36967680, "comment_id": 61491134, "body": "well I guess your first task is to re-implement <code>replicate</code> ;)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1462113076, "post_id": 36967680, "comment_id": 61491143, "body": "btw: <code>[a] ++ as == a:as</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1462126303, "post_id": 36967680, "comment_id": 61495885, "body": "are you allowed to use list comprehensions?"}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1462125943, "last_edit_date": 1462125943, "creation_date": 1462113469, "answer_id": 36967843, "question_id": 36967680, "link": "https://stackoverflow.com/questions/36967680/how-do-i-put-a-element-n-times-in-a-list-without-using-the-replicate-or-repeat-f/36967843#36967843", "title": "How do I put a element n times in a list without using the replicate or repeat function?", "body": "<p>As this is a homework/learning exercise - just want to give some hints</p>\n\n<p>Split the task in two parts a function</p>\n\n<ul>\n<li><p><code>myReplicate :: Int -&gt; a -&gt; [a]</code> which replicates a single element as many times as the <code>Int</code> tells it to.</p>\n\n<pre><code>myReplicate n x | n &gt; 0 = ...\n                | n == 0 = ...\n                | n &lt; 0 = error \"Error myReplicate: no negative arguments allowed\"\n</code></pre></li>\n<li><p>a second function <code>myMap :: (a -&gt; b) -&gt; [a] -&gt; [b]</code> that applies a function to every element of a given list.</p>\n\n<pre><code>myMap :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmyMap f [] = []\nmyMap f (x:xs) = ...\n</code></pre></li>\n</ul>\n\n<p>then <code>rep = myMap (\\x -&gt; myReplicate x x)</code></p>\n"}, {"tags": [], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "is_accepted": true, "score": 1, "last_activity_date": 1462139200, "creation_date": 1462139200, "answer_id": 36972347, "question_id": 36967680, "link": "https://stackoverflow.com/questions/36967680/how-do-i-put-a-element-n-times-in-a-list-without-using-the-replicate-or-repeat-f/36972347#36972347", "title": "How do I put a element n times in a list without using the replicate or repeat function?", "body": "<p>Here a solution without <code>repeat</code> or <code>replicate</code>:</p>\n\n<pre><code>rep = map (\\ n -&gt; foldr (const (n :)) [] [1..n])\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6278003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e54c5ecc563d72b234712db54bb64e?s=128&d=identicon&r=PG&f=1", "display_name": "Bilow", "link": "https://stackoverflow.com/users/6278003/bilow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1866, "favorite_count": 0, "accepted_answer_id": 36972347, "answer_count": 2, "score": 2, "last_activity_date": 1462139200, "creation_date": 1462112527, "last_edit_date": 1462114700, "question_id": 36967680, "link": "https://stackoverflow.com/questions/36967680/how-do-i-put-a-element-n-times-in-a-list-without-using-the-replicate-or-repeat-f", "title": "How do I put a element n times in a list without using the replicate or repeat function?", "body": "<p>I have a function rep which requires a list with <code>int</code>s. My task now is to put each of these numbers in separate lists with n times the number. For example \n<code>[1,3,5]</code> to <code>[[1],[3,3,3],[5,5,5,5,5]]</code> So far I can put each int in a separate list but I don't really now how to put them n times in the list without using replicate or repeat.</p>\n\n<p>This is the code I have so far:</p>\n\n<pre><code>rep [] = []\nrep (x1:xs) = [[x1]] ++ (rep xs)\n</code></pre>\n"}, {"tags": ["haskell", "lambda", "fold", "reduction"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1462125275, "post_id": 36967622, "comment_id": 61495538, "body": "stick with Haskell&#39;s syntax (equations, <code>[...]</code>, ...) when you&#39;re working it out; it&#39;s the clearest. then when you&#39;re done, translate the results back to whatever crazy mix of notations is expected of you."}], "answers": [{"comments": [{"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 0, "creation_date": 1462121368, "post_id": 36967659, "comment_id": 61494118, "body": "<code>(toggle &#47;&#47;)</code> is valid syntax \u2014 it is like <code>(1 +)</code> \u2014 but it is a type error, so I think you&#39;re probably correct that <code>(toggle (&#47;&#47;))</code> was meant."}, {"owner": {"reputation": 315, "user_id": 4840044, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7906f7258ec035ac362ccbeb86bf2a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/4840044/justin"}, "edited": false, "score": 0, "creation_date": 1462122033, "post_id": 36967659, "comment_id": 61494355, "body": "How are you getting: <b>foldl (toggle //) nil (\u201cfoo\u201d \u201cbar\u201d \u201cbaz\u201d) { 1b } = foldl (toggle //) ((toggle //) nil &quot;foo&quot;) (\u201cbar\u201d \u201cbaz\u201d)</b>? I don&#39;t see how you get that from 1b."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462122593, "post_id": 36967659, "comment_id": 61494552, "body": "do you see it if I say you that <code>(cons &quot;foo&quot; (&quot;bar&quot; &quot;baz&quot;)) = (&quot;foo&quot; &quot;bar&quot; &quot;baz&quot;)</code> (modulo syntax - as I said it&#39;s not Haskell - but <code>cons</code> in LISP is <code>(:)</code> in Haskell and if you say <code>a:b:c:[] = [a,b,c] = (a b c) = (cons a (b c))</code> then it should hold"}, {"owner": {"reputation": 315, "user_id": 4840044, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7906f7258ec035ac362ccbeb86bf2a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/4840044/justin"}, "edited": false, "score": 0, "creation_date": 1462132038, "post_id": 36967659, "comment_id": 61497874, "body": "@Carsten Ok. I&#39;m confused how the toggle actually works then. For <b>foldl (toggle //) ((toggle //) ((toggle //) nil &quot;foo&quot;) &quot;bar&quot;) (&quot;baz&quot;)</b>, what does toggle actually do? I thought it switched the position of the next to elements to the right. After one step would it be: <b>foldl (toggle //) (toggle //) (&quot;foo&quot; nil) &quot;bar&quot;) (&quot;baz&quot;)</b>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462133154, "post_id": 36967659, "comment_id": 61498244, "body": "no think of it as having one argument - a function - here <code>(&#47;&#47;)</code> - it will take this and return a new function which will just use the one given but <i>flip</i> the arguments - so if you do <code>(toggle (&#47;&#47;)) a b</code> it will be the same as <code>(&#47;&#47;) b a</code> which is <code>b &#47;&#47; a</code> or <code>b ++ a</code> in Haskell"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462133278, "post_id": 36967659, "comment_id": 61498283, "body": "but IMO the exercise is given in a horrible fashion as you are expected to understand and mix the syntax of various languages - so no surprise you&#39;ve got issues with this"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462133375, "post_id": 36967659, "comment_id": 61498314, "body": "in Haskell you would (as the other answer implies) <code>flip :: (a -&gt; b -&gt; c) -&gt; (b -&gt; a -&gt; c)</code>  with <code>flip f a b = f b a</code> which you could write as <code>flip f = \\ a b -&gt; f b a</code> to make it more obvious"}, {"owner": {"reputation": 315, "user_id": 4840044, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7906f7258ec035ac362ccbeb86bf2a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/4840044/justin"}, "edited": false, "score": 0, "creation_date": 1462148628, "post_id": 36967659, "comment_id": 61502525, "body": "@Carsten That makes sense. I seem to understand the basics, but you are right, this is a poorly formatted question. I don&#39;t think I will understand it enough to answer the question successfully, although I appreciate your help."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1462112748, "last_edit_date": 1462112748, "creation_date": 1462112367, "answer_id": 36967659, "question_id": 36967622, "link": "https://stackoverflow.com/questions/36967622/haskell-foldr-reduction/36967659#36967659", "title": "Haskell foldr reduction", "body": "<p>start with </p>\n\n<pre><code>foldl (toggle //) nil (\u201cfoo\u201d \u201cbar\u201d \u201cbaz\u201d)\n{ 1b }\n= foldl (toggle //) ((toggle //) nil \"foo\") (\u201cbar\u201d \u201cbaz\u201d)\n</code></pre>\n\n<p>...</p>\n\n<h2>remarks/questions:</h2>\n\n<ul>\n<li><code>(\"foo\" \"bar\" \"baz\")</code> is not Haskell for lists! (what are the strange <code>\"</code>?)</li>\n<li><code>(toggle //)</code> is not Haskell syntax for operators either (it's <code>(toggle (//))</code>)</li>\n<li>what strategy are you supposed to use? Depending on it you have to continue with the <code>(toggle //) nil \"foo\")</code> or the <code>foldl</code></li>\n</ul>\n\n<p>the <code>toggle</code> would be</p>\n\n<pre><code>(toggle //) nil \"foo\"\n{ 5 }\n= (//) \"foo\" nil\n{ 4 }\n\"foo\"\n</code></pre>\n\n<p>the other would be the same again:</p>\n\n<pre><code>foldl (toggle //) ((toggle //) nil \"foo\") (\u201cbar\u201d \u201cbaz\u201d)\n{ 1b }\n= foldl (toggle //) ((toggle //) ((toggle //) nil \"foo\") \"bar\") (\"baz\")\n</code></pre>\n\n<p>I'm sure you can work out the rest (it's really just putting the right thing into the right <em>spot</em> )</p>\n"}, {"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": false, "score": 2, "last_activity_date": 1462124840, "creation_date": 1462124840, "answer_id": 36969877, "question_id": 36967622, "link": "https://stackoverflow.com/questions/36967622/haskell-foldr-reduction/36969877#36969877", "title": "Haskell foldr reduction", "body": "<p>The first thing I would do is replace all the alien syntax and names with Haskell syntax and names.</p>\n\n<pre><code>toggle              \u21d2 flip\nnil                 \u21d2 []\n(\u201cfoo\u201d \u201cbar\u201d \u201cbaz\u201d) \u21d2 [\"foo\", \"bar\", \"baz\"]\n(//)                \u21d2 (++)\n</code></pre>\n\n<p>Giving:</p>\n\n<pre><code>foldl (toggle (//)) nil (\u201cfoo\u201d \u201cbar\u201d \u201cbaz\u201d)\n\u21d2 foldl (flip (++)) [] [\"foo\", \"bar\", \"baz\"]\n</code></pre>\n\n<blockquote>\n  <p><strong>Note:</strong> I am correcting <code>(toggle //)</code> to <code>(toggle (//))</code> because I think the latter is what was intended. The former is a type error.</p>\n</blockquote>\n\n<p>Now you just expand the definition of <code>foldl</code>. Again I would replace the alien syntax and names with Haskell syntax and names.</p>\n\n<pre><code>foldl f x NIL = x\nfoldl f x (cons a list) = foldl f (f x a) list\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code>foldl f a [] = a\nfoldl f a (x:xs) = foldl f (f a x) xs\n</code></pre>\n\n<p>Now you apply <code>foldl</code> to its arguments. There are are a couple things you can do. One thing is to rewrite <code>foldl</code> so it is an expression.</p>\n\n<pre><code>foldl =\n  \\f -&gt; \\a -&gt; \\xxs -&gt;\n    case xxs of\n      []   -&gt; a\n      x:xs -&gt; foldl f (f a x) xs\n</code></pre>\n\n<p>Or on one line as:</p>\n\n<pre><code>foldl = \\f -&gt; \\a -&gt; \\xxs -&gt; case xxs of [] -&gt; a; x:xs -&gt; foldl f (f a x) xs\n</code></pre>\n\n<p>You can also desugar the list <code>[\"foo\", \"bar\", \"baz\"]</code> to <code>\"foo\":\"bar\":\"baz\":[]</code>, which makes pattern matching more obvious.</p>\n\n<p>Now expand <code>foldl</code> and apply:</p>\n\n<pre><code>foldl (flip (++)) [] (\"foo\":\"bar\":\"baz\":[])\n\u21d2 (\\f -&gt; \\a -&gt; \\xxs -&gt; case xxs of [] -&gt; a; x:xs -&gt; foldl f (f a x) xs) (flip (++)) [] (\"foo\":\"bar\":\"baz\":[])\n\u21d2 (\\a -&gt; \\xxs -&gt; case xxs of [] -&gt; a; x:xs -&gt; foldl (flip (++)) ((flip (++)) a x) xs) [] (\"foo\":\"bar\":\"baz\":[])\n\u21d2 (\\xxs -&gt; case xxs of [] -&gt; []; x:xs -&gt; foldl (flip (++)) ((flip (++)) [] x) xs) (\"foo\":\"bar\":\"baz\":[])\n\u21d2 case \"foo\":\"bar\":\"baz\":[] of [] -&gt; []; x:xs -&gt; foldl (flip (++)) ((flip (++)) [] x) xs\n</code></pre>\n\n<p>Simplify the case expression:</p>\n\n<pre><code>case (\"foo\":\"bar\":\"baz\":[]) of [] -&gt; []; x:xs -&gt; foldl (flip (++)) ((flip (++)) [] x) xs\n\u21d2 foldl (flip (++)) ((flip (++)) [] \"foo\") (\"bar\":\"baz\":[])\n</code></pre>\n\n<p>You can finish the normalisation in the same manner.</p>\n\n<p>Once you understand that a function definition such as <code>foldl</code> is really just sugar on a case expression you can take a shortcut.</p>\n\n<blockquote>\n  <p><strong>Note:</strong> There are other rich syntaxes such as guards and do-notation. When you want to evaluate them it will help to know the underlying expression.</p>\n</blockquote>\n\n<p>Starting from:</p>\n\n<pre><code>foldl (flip (++)) [] (\"foo\":\"bar\":\"baz\":[])\n</code></pre>\n\n<p>We can look at this definition of <code>foldl</code>:</p>\n\n<pre><code>foldl f a [] = a\nfoldl f a (x:xs) = foldl f (f a x) xs\n</code></pre>\n\n<p>And immediately choose either the <code>a</code> definition or the <code>foldl f (f a x) xs</code> definition based which case matches. In this case it is the latter. Having chosen the correct definition we substitute all the parameters for arguments and quickly arrive at the same expression as before:</p>\n\n<pre><code>foldl (flip (++)) ((flip (++)) [] \"foo\") (\"bar\":\"baz\":[])\n</code></pre>\n\n<p>You can see that my general approach has been to simplify the syntax. That is, simpler to manipulate rather than simpler to read or write, which usually means reducing to fewer primitives. We managed with just using <code>case</code>, abstraction (i.e. <code>\\x -&gt; m</code>), and application (i.e. <code>f x</code>, substituting parameters for arguments). This is a good approach if the rules of how to use the richer syntax (or in the case of this problem, invented syntax) are not clear.</p>\n"}], "owner": {"reputation": 315, "user_id": 4840044, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7906f7258ec035ac362ccbeb86bf2a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/4840044/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462124840, "creation_date": 1462112085, "question_id": 36967622, "link": "https://stackoverflow.com/questions/36967622/haskell-foldr-reduction", "title": "Haskell foldr reduction", "body": "<p>I am still very new to Haskell and I am trying to solve a problem. I have attempted something but I am very sure it is wrong.</p>\n\n<p><strong>The Problem:</strong></p>\n\n<pre><code>foldr : f x NIL = x\nfoldr : f x (cons a list) = f a (foldr f x list)\n</code></pre>\n\n<p>Let\u2019s have some fun and combine the features of a number of different languages.</p>\n\n<p>(1) Borrowing from the course notes and Haskell, let\u2019s define a function foldl,</p>\n\n<p>(a) <code>foldl f x NIL = x</code></p>\n\n<p>(b) <code>foldl f x (cons a list) = foldl f (f x a) list</code></p>\n\n<p>(2) Borrowing from Python, we can treat a string as a sequence (i.e. a list) of characters,</p>\n\n<pre><code>\u201cbar\u201d \u2261 (\u2018b\u2019 \u2018a\u2019 \u2018r\u2019) \u2261 [\u2018b\u2019, \u2018a\u2019, \u2018r\u2019]\n</code></pre>\n\n<p>(3) Borrowing from Lisp, we can use cons cells to represent or create lists,</p>\n\n<pre><code>(\u2018b\u2019 \u2018a\u2019 \u2018r\u2019) \u2261 (cons \u2018b\u2019 (cons \u2018a\u2019 (cons \u2018r\u2019 nil)))\n</code></pre>\n\n<p>(4) Borrowing from Fortran, we can define a string concatenation function, //,</p>\n\n<pre><code>\u2018concate\u2019//\u2019nation\u2019 \u21d2\u2018concatenation\u2019\n</code></pre>\n\n<p>(5) Borrowing from Scheme, define a toggle function, </p>\n\n<pre><code>f x y = f y x,\n(define toggle (lambda (f x y)  (f y x)))\n</code></pre>\n\n<p>That is, the toggle function switches its arguments, in Lambda Calculus, it\u2019s,</p>\n\n<pre><code>|_f. |_x. |_y. f y x\n</code></pre>\n\n<p>Thus, for example,</p>\n\n<pre><code>(f \u2018back\u2019 \u2018drop\u2019) \u21d2(f \u2018drop\u2019 back\u2019)\n</code></pre>\n\n<p><strong>In this question, please trace the execution/reduction of the following function:</strong></p>\n\n<pre><code>foldl (toggle //) nil (\u201cfoo\u201d \u201cbar\u201d \u201cbaz\u201d)\n</code></pre>\n\n<p><strong>Below is a Hint I am Given:</strong></p>\n\n<pre><code>    foldl (toggle //) nil (\u201cfoo\u201d \u201cbar\u201d \u201cbaz\u201d)\n</code></pre>\n\n<p>Step1: Start with (1b), left side, <code>foldl f x (cons a list)</code></p>\n\n<pre><code>        with f = (toggle //), x = nil, and list = (\u201cfoo\u201d \u201cbar\u201d \u201cbaz\u201d)\n</code></pre>\n\n<p>Step2: Use (3) to recursively expand the list</p>\n\n<p>Step3: Use (1b), right-side, foldl f (f x a) list</p>\n\n<pre><code>        to recursively apply f, (toggle //), to the expanded list\n</code></pre>\n\n<p>Step4: Use (5) to apply the toggle functions in the list expression.</p>\n\n<p>Step5: Use (4), //, to reduce the expression</p>\n\n<p><strong>What I Got:</strong></p>\n\n<pre><code>foldl (toggle //) nil (\u201cfoo\u201d \u201cbar\u201d \u201cbaz\u201d)\nfoldl f x (cons a list) \u2013 via (1b)\nfoldl f x(a list)  \u2013 via (3)\nfoldl f (f x a) list \u2013 via (1b)\nfoldl (toggle //) (toggle // x a) list \u2013 via(5)\nfoldl x // // a list \u2013 via (4)\nfoldl nil a (\u201cfoo\u201d \u201cbar\u201d \u201cbaz\u201d)\n</code></pre>\n\n<p>I know that can't be right but I feel like I am somewhere near. If I could get some guidance I feel I could become unstuck and have a successful understanding.</p>\n"}, {"tags": ["haskell", "guard"], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1462107729, "post_id": 36966916, "comment_id": 61489543, "body": "@J.doe: did you intended your code probably as in the edit? Otherwise there is probably an element in the code you forgot to mention."}, {"owner": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "edited": false, "score": 0, "creation_date": 1462107865, "post_id": 36966916, "comment_id": 61489578, "body": "The problem is ,which could not be seen from my example code (since it was edited), that emacs is not indenting the guards(and I can&#39;t even tabulate ), in facts my guards are aligned with: rovarsprak - is this why I am getting a parse error ? and not &quot;cocboba&quot; @Willem Van Onsem"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462107871, "post_id": 36966916, "comment_id": 61489581, "body": "The &quot;final optimization&quot; will do precisely nothing. GHC <i>always</i> rearranges patterns to match the order in which the constructors are <i>defined</i>. Yes, this is sometimes unfortunate, but it is the way it is at present."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462107969, "post_id": 36966916, "comment_id": 61489619, "body": "@dfeuer: Who says one uses ghc? I can build my own unintelligent Haskell compiler. As always you can rely on the compiler to see optimizations, but it is always better to perform some optimizations yourself (although premature optimization is the root of some evil ;)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462108103, "post_id": 36966916, "comment_id": 61489664, "body": "When performing micro-optimizations like re-ordering patterns, one must <i>always</i> target a specific implementation and family of hardware architectures. Otherwise, one is wasting one&#39;s time for sure!"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462108263, "post_id": 36966916, "comment_id": 61489719, "body": "@dfeuer: well evidently you have to make some assumptions on how the compiler <i>will</i> behave. For instance for Prolog it will conceptually enumerate over the declarations in the order of definition. That does not mean the SWI-Prolog system will do this of course. Where do you read in this question the OP wants a GHC specific answer?"}, {"owner": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "edited": false, "score": 1, "creation_date": 1462108468, "post_id": 36966916, "comment_id": 61489799, "body": "ok it was just some minor mistake with emacs. Anyhow thanks, I am just learning haskell from start so I will read your other suggestion more closely"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1462108544, "last_edit_date": 1462108544, "creation_date": 1462107410, "answer_id": 36966916, "question_id": 36966791, "link": "https://stackoverflow.com/questions/36966791/wrong-in-my-guard-expression/36966916#36966916", "title": "Wrong in my guard expression?", "body": "<p>I think your old code was not properly indented. If I run the <code>ghc</code> compiler on:</p>\n\n<pre><code>rovarSprak :: [Char] -&gt; [Char] -&gt; [Char]\nrovarSprak [] res = res\nrovarSprak (c:restOfStr) res\n| (checkCons c) == True  =  rovarSprak restOfStr (c:'o':c:res)\n| otherwise = rovarSprak restOfStr (c:res)\n</code></pre>\n\n<p>it gives an error:</p>\n\n<pre><code>strep.hs:8:1: parse error on input \u2018|\u2019\n</code></pre>\n\n<p>rewriting this to:</p>\n\n<pre><code>rovarSprak :: [Char] -&gt; [Char] -&gt; [Char]\nrovarSprak [] res = res\nrovarSprak (c:restOfStr) res\n    | (checkCons c) == True  =  rovarSprak restOfStr (c:'o':c:res)\n    | otherwise = rovarSprak restOfStr (c:res)\n</code></pre>\n\n<p>solves the compile error.</p>\n\n<p>Furthermore If  try to reproduce it, the result is:</p>\n\n<pre><code>\"cocboba\"\n</code></pre>\n\n<p>The guards are working fine, the only problem with your code is that in the recursive call:</p>\n\n<pre><code>rovarSprak restOfStr (c:'o':c:res)\n--                   ^push in front\n</code></pre>\n\n<p>you push the result in front of the new list whereas you probably want it to be at the tail.</p>\n\n<p>You can solve this by not working with an <em>accumulator</em>, but emitting elements straight away. For example:</p>\n\n<pre>\nrovarSprak :: [Char] -> [Char]\nrovarSprak [] = []\nrovarSprak (c:restOfStr)\n    | <s>(</s>checkCons c<s>) == True</s> =  <b>c : 'o' : c :</b> (rovarSprak restOfStr)\n    | otherwise = <b>c :</b> rovarSprak restOfStr\n</pre>\n\n<p>(emission in boldface and stroke redundant code elements). This also allows lazy list generation: perhaps you are only interested in the first three elements of the output, or perhaps the input is an infinite list.</p>\n\n<p>A final optimization I propose is to swap the two lines of <code>rovarSprak</code>:</p>\n\n<pre>\nrovarSprak :: [Char] -> [Char]\nrovarSprak (c:restOfStr)\n    | checkCons c =  <b>c : 'o' : c :</b> (rovarSprak restOfStr)\n    | otherwise = <b>c :</b> rovarSprak restOfStr\nrovarSprak [] = []\n</pre>\n\n<p>this is because it is more likely you will have a match on the first line: for a list with length <em>N</em> there will be <em>N</em> calls on the first pattern and <em>one</em> on the second pattern. </p>\n"}], "owner": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 36966916, "answer_count": 1, "score": 1, "last_activity_date": 1462108544, "creation_date": 1462106664, "last_edit_date": 1462107011, "question_id": 36966791, "link": "https://stackoverflow.com/questions/36966791/wrong-in-my-guard-expression", "title": "Wrong in my guard expression?", "body": "<p>I am writing a small program which \"builds up\" a string from another string (which is the \"input string\"(parameter)). However I am getting a parse error(on input '='). I suspect I am doing something wrong with my guard expression ?</p>\n\n<pre><code>checkCons :: Char -&gt; Bool \ncheckCons x = notElem x ['a','e','i','o','u','y'] \n\n\nrovarSprak :: [Char] -&gt; [Char] -&gt; [Char]\nrovarSprak [] res = res\nrovarSprak (c:restOfStr) res\n    | (checkCons c) == True  =  rovarSprak restOfStr (c:'o':c:res)\n    | otherwise = rovarSprak restOfStr (c:res)\n</code></pre>\n\n<p>If I make the call: <code>rovarSprak \"abc\" []</code> . I expect <code>\"abobcoc\"</code>.</p>\n\n<p>Observe that the <code>checkCons</code> function is working as desired.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 3, "last_activity_date": 1462105671, "last_edit_date": 1462105671, "creation_date": 1462104827, "answer_id": 36966511, "question_id": 36966495, "link": "https://stackoverflow.com/questions/36966495/type-and-definition-in-haskell/36966511#36966511", "title": "Type and Definition in Haskell", "body": "<p>please consider reading a basic haskell tutorial - like <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow\">learnyouahaskell.com</a>.</p>\n\n<p>Types are written with captial cases and the <code>==</code> operator is not assignment but tests for equality</p>\n\n<pre><code>xor :: Bool -&gt; Bool -&gt; Bool\nxor True True = False\nxor True False = True\nxor False True = True\nxor False False = False\n</code></pre>\n\n<p>also note that this can be simplified to</p>\n\n<pre><code>xor x y = x /= y\n</code></pre>\n\n<p>after all it is just checking wether the two values you pass in are not the same.</p>\n\n<p>or even more</p>\n\n<pre><code>xor = (/=)\n</code></pre>\n\n<p>this style is called point-free, which means if the type signature is clear no parameters are needed (sometimes parameters are referred to as points, for historical/mathematical reasons).</p>\n\n<p>By the way if you wonder what <code>TemplateHaskell</code> is - it is a compiler extension of GHC, which allows you to write code that at compile time creates haskell code - which then is type-checked and compiled again - I think about it as type-safe meta-programming.</p>\n"}], "owner": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462105671, "creation_date": 1462104688, "last_edit_date": 1462105622, "question_id": 36966495, "link": "https://stackoverflow.com/questions/36966495/type-and-definition-in-haskell", "title": "Type and Definition in Haskell", "body": "<p><img src=\"https://i.stack.imgur.com/sIylU.png\" alt=\"Question\"></p>\n\n<p>Above is a question I am having problems with. It asks me to give a type and define a non infix function.</p>\n\n<p>So my approach was to use pattern matching.</p>\n\n<p>The idea was to take two booleans, then go through patterns</p>\n\n<pre><code> xor :: bool -&gt; bool -&gt; bool\n xor True True == False\n xor True False == True\n xor False True == True\n xor False False == False\n</code></pre>\n\n<p>I am getting a compile error. </p>\n\n<pre><code>Parse error: naked expression at top level\nPerhaps you intended to use TemplateHaskell\n</code></pre>\n\n<p>Can someone tell me what I am doing wrong here and how I can fix it? </p>\n\n<p>Thanks alot.</p>\n"}, {"tags": ["class", "haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1462193098, "post_id": 36966206, "comment_id": 61520418, "body": "&quot;Is there another way to do this?&quot; Turn your <code>Parser</code> class into a record. Or just give the expression <code>recursiveParsers parser</code> a type annotation."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 3957908, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/36371f287fd7e5a45cb8e82f60dc2aba?s=128&d=identicon&r=PG&f=1", "display_name": "Jordy Brinks", "link": "https://stackoverflow.com/users/3957908/jordy-brinks"}, "edited": false, "score": 0, "creation_date": 1462104770, "post_id": 36966447, "comment_id": 61488614, "body": "What I&#39;m trying to do? People can write their own instances. It&#39;s a module. IE if I want an IntParser I could write the functions so that it accepts and strings with only numbers. if I wanted some kind of Parser that Accepts String of <code>&quot;(&quot;IntParser&quot;,&quot;IntParser&quot;)&quot;</code> it could say it accepted String that look like that, It would define isRecursive as True, and recursiveParsers would be [[IntParser],[IntParser]].  These instance implementations are given in another file, possibly by someone else.  what I want: ParseTree accepts some kind of thing that has those functions. Class seems the best"}, {"owner": {"reputation": 75, "user_id": 3957908, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/36371f287fd7e5a45cb8e82f60dc2aba?s=128&d=identicon&r=PG&f=1", "display_name": "Jordy Brinks", "link": "https://stackoverflow.com/users/3957908/jordy-brinks"}, "edited": false, "score": 0, "creation_date": 1462106075, "post_id": 36966447, "comment_id": 61488994, "body": "Sorry, second comment. I do see how it looks weird. Basically something that is a Parser would mostly be a Datatype having exactly one constructor with no variables or types. it would simply implement parser providing the functions. data IntParser = IntParser ... instance Parser IntParser where ... bla bla"}, {"owner": {"reputation": 3516, "user_id": 1057102, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9f1412fdce8dc8873cf8b5590501faf7?s=128&d=identicon&r=PG&f=1", "display_name": "sleblanc", "link": "https://stackoverflow.com/users/1057102/sleblanc"}, "edited": false, "score": 0, "creation_date": 1556232564, "post_id": 36966447, "comment_id": 98378350, "body": "&quot;People can write their own instances.&quot; Instead, write a function <code>parse</code> that accepts a <code>Parser a</code> record. <code>data Parser a = Parser { isRecursive :: Bool, parse :: String -&gt; a, \u2026}</code>. A typeclass is absolutely not what you should be using here."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1462104340, "creation_date": 1462104340, "answer_id": 36966447, "question_id": 36966206, "link": "https://stackoverflow.com/questions/36966206/ambiguous-type-class-returning-itself-in-function/36966447#36966447", "title": "Ambiguous type class returning itself in function?", "body": "<p>As far as I can see, you are trying to use Haskell type classes as if they were OOP classes. They are not.</p>\n\n<p>Roughly put, a type class is a collection of types. Its closest OOP analogous is a Java-style interface (not a class). As with Java interfaces, type classes have little use on their own unless there are some implementations (<code>instance</code>s) for them elsewhere (in Java, we want some classes to implement the interfaces).</p>\n\n<p>Note the plural \"implementations\". Most often, we use type classes only if we can think of several ways to satisfy their interface. The type class <code>Num</code> is inhabited by <code>Int, Integer, Float, Double, ...</code>; the class <code>Show</code> by <code>String, Char, Bool, Int, ...</code>.</p>\n\n<p>If we only have one sensible implementation, there's no need to use a type class.</p>\n\n<p>In your specific example: what would you expect the implementations (plural) of your type class?</p>\n\n<p>Also, I believe you misunderstand the type of the method</p>\n\n<pre><code>recursiveParsers:: Parser p =&gt; pars -&gt; [[p]]\n</code></pre>\n\n<p>Outside the type class, this method is accessible with signature</p>\n\n<pre><code>recursiveParsers:: (Parser p1, Parser p2) =&gt; p1 -&gt; [[p2]]\n</code></pre>\n\n<p>which looks wrong to me: the above means that the caller of that method can change any parser <code>p1</code> into a list of parsers <code>[[p2]]</code> where <em>both</em> <code>p1</code> and <code>p2</code> are chosen by the caller. In particular, it does <em>not</em> mean that it returns a list-of-lists of \"some parser\".</p>\n\n<p>Any call to such method will need to specify, in its context, what <code>p2</code> is chosen to be.</p>\n\n<p>This technical fact aside, I think the whole approach should be redesigned. </p>\n"}], "owner": {"reputation": 75, "user_id": 3957908, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/36371f287fd7e5a45cb8e82f60dc2aba?s=128&d=identicon&r=PG&f=1", "display_name": "Jordy Brinks", "link": "https://stackoverflow.com/users/3957908/jordy-brinks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462106555, "creation_date": 1462102604, "last_edit_date": 1462106555, "question_id": 36966206, "link": "https://stackoverflow.com/questions/36966206/ambiguous-type-class-returning-itself-in-function", "title": "Ambiguous type class returning itself in function?", "body": "<p>I was making a  String Parser, while the way I did this is not optimal, as it goes over the String multiple times etc. I have encountered something I believe is weird, in Haskell.</p>\n\n<pre><code> type LeftoverString = String\ntype Match = String\n\nclass Parser pars where\n    findMatch::pars -&gt; String -&gt; (Match,LeftoverString)\n    tokenName::pars -&gt; String\n    isRecursive::pars -&gt; Bool\n    recursiveParsers:: Parser p =&gt; pars -&gt; [[p]]\n    recursiveFromMatch:: pars -&gt; String -&gt; String\n    isRecursive x = False\n    recursiveParsers x = []\n    recursiveFromMatch x y = y\n\ntype TokenName = String\ndata ParseTree = TokenLeaf Match TokenName | TokenNode TokenName [ParseTree] deriving Show\n\nfindFirstMatch::Parser a =&gt; [a] -&gt; String -&gt;(a,Match,LeftoverString)\nfindFirstMatch [] _                             = error \"could not match String\"\nfindFirstMatch (x:xs) str   | match /= \"\"       = (x,match,leftovers)\n                            | otherwise         = findFirstMatch xs str\n                                where\n                                    (match,leftovers) = findMatch x str\n\ngenerateTree::Parser a =&gt; a -&gt; String -&gt; ParseTree\ngenerateTree pars str = head $ generateTree' [[pars]] str\n\ntest::Parser a =&gt; a -&gt; [[a]]\ntest x = recursiveParsers x\n\ngenerateTree'::Parser a =&gt; [[a]] -&gt; String -&gt; [ParseTree]\ngenerateTree'  []    _                          = []\ngenerateTree' (x:xs) str | isRecursive parser   = recTok:parseTreeRest\n                         | otherwise            = leafTok:parseTreeRest\n                    where \n                        (parser,match,leftovers)=findFirstMatch x str\n                        tok = tokenName parser\n                        parseTreeRest = (generateTree' xs leftovers)\n                        recTok = TokenNode tok $ generateTree' (test parser) (recursiveFromMatch parser match)\n                        leafTok = TokenLeaf match tok\n</code></pre>\n\n<p>As one can see, <code>recursiveParsers</code> in Parser returns a list of list of Parser instances</p>\n\n<p>In the code you see this:</p>\n\n<pre><code>test::Parser a =&gt; a -&gt; [[a]]\ntest x = recursiveParsers x\n</code></pre>\n\n<p>This is used in the where of <code>generateTree'</code> in recTok\nAs one can see, test (basically) is a synonym for recursiveParsers x</p>\n\n<p>however - in the where, if I replace:</p>\n\n<pre><code>recTok = TokenNode tok $ generateTree' (test parser) (recursiveFromMatch parser match)\n</code></pre>\n\n<p>with </p>\n\n<pre><code>recTok = TokenNode tok $ generateTree' (recursiveParsers parser) (recursiveFromMatch parser match)\n</code></pre>\n\n<p>the compiler generates an error of ambiguous types.</p>\n\n<p>The error is:</p>\n\n<pre><code>StringParser.hs:42:50:\n    Could not deduce (Parser a0) arising from a use of generateTree'\n    from the context (Parser a)\n      bound by the type signature for\n                 generateTree' :: Parser a =&gt; [[a]] -&gt; String -&gt; [ParseTree]\n      at StringParser.hs:34:16-57\n    The type variable `a0' is ambiguous\n    In the second argument of `($)', namely\n      `generateTree'\n         (recursiveParsers parser) (recursiveFromMatch parser match)'\n    In the expression:\n      TokenNode tok\n      $ generateTree'\n          (recursiveParsers parser) (recursiveFromMatch parser match)\n    In an equation for `recTok':\n        recTok\n          = TokenNode tok\n            $ generateTree'\n                (recursiveParsers parser) (recursiveFromMatch parser match)\n</code></pre>\n\n<p>Why does the compiler require a synonym for the function recursiveParsers for it to work?</p>\n\n<p>Second question, I believe I am totally doing this wrong with trying to use Class to force a parser to have certain functions? Is there another way to do this?</p>\n"}, {"tags": ["haskell", "functional-programming", "currying"], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 4932965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30dd676072dec501db6881c9dd4ac970?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Meriniuc", "link": "https://stackoverflow.com/users/4932965/razvan-meriniuc"}, "edited": false, "score": 0, "creation_date": 1462139321, "post_id": 36966027, "comment_id": 61500258, "body": "Are you sure? According to Wikipedia, &quot;currying is the technique of translating the evaluation of a function that takes multiple arguments (or a tuple of arguments) into evaluating a sequence of functions, each with a single argument&quot;, and according to (<a href=\"https://wiki.haskell.org/Partial_application\" rel=\"nofollow noreferrer\">wiki.haskell.org/Partial_application</a>), partial function application is when I create a function, for example <code>func = replicate 3</code>, which only gives <code>replicate</code> a single argument. Calling <code>func var</code> will replicate var three times."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 172, "user_id": 4932965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30dd676072dec501db6881c9dd4ac970?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Meriniuc", "link": "https://stackoverflow.com/users/4932965/razvan-meriniuc"}, "edited": false, "score": 0, "creation_date": 1462139580, "post_id": 36966027, "comment_id": 61500353, "body": "@RazvanMeriniuc what part of my answer do you disagree on - based on the wikipedia article you are quoting?"}, {"owner": {"reputation": 172, "user_id": 4932965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30dd676072dec501db6881c9dd4ac970?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Meriniuc", "link": "https://stackoverflow.com/users/4932965/razvan-meriniuc"}, "edited": false, "score": 0, "creation_date": 1462139920, "post_id": 36966027, "comment_id": 61500480, "body": "Currying does not only translate tuples, but also multiple arguments. Your second example is also currying and partial function application appears in the context I&#39;ve presented before."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 172, "user_id": 4932965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30dd676072dec501db6881c9dd4ac970?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Meriniuc", "link": "https://stackoverflow.com/users/4932965/razvan-meriniuc"}, "edited": false, "score": 0, "creation_date": 1462140156, "post_id": 36966027, "comment_id": 61500561, "body": "no in haskell the only way to have multiple arguments is having tuples, all functions with more than one argument is technically a function returning a function."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 5, "last_activity_date": 1462101427, "creation_date": 1462101427, "answer_id": 36966027, "question_id": 36965962, "link": "https://stackoverflow.com/questions/36965962/haskell-currying/36966027#36966027", "title": "Haskell Currying", "body": "<p>I think you are mixing up two different things</p>\n\n<ul>\n<li>currying</li>\n<li>partial function application</li>\n</ul>\n\n<p>the first one is</p>\n\n<pre><code>                      ------currying-----&gt; \n       f :: (a,b) -&gt; c                      f' :: a -&gt; b -&gt; c\n                      &lt;----uncurrying-----\n</code></pre>\n\n<p>transforming a function that takes a <strong>tuple</strong> of arguments which means one argument of two things combined - into a function that takes one argument and produces a function!</p>\n\n<p>If you are familiar with linear algebra this is very much alike viewing a bi-linear function as a linear function that produces another linear function.</p>\n\n<p>Whereas partial function application is just a consequence of explicit parenthization.</p>\n\n<pre><code>f :: a -&gt; b -&gt; c\n</code></pre>\n\n<p>is really</p>\n\n<pre><code>f :: a -&gt; (b -&gt; c)\n</code></pre>\n\n<p>at least in the haskell way of defining functions.</p>\n"}, {"comments": [{"owner": {"reputation": 172, "user_id": 4932965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30dd676072dec501db6881c9dd4ac970?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Meriniuc", "link": "https://stackoverflow.com/users/4932965/razvan-meriniuc"}, "edited": false, "score": 0, "creation_date": 1462139058, "post_id": 36966123, "comment_id": 61500166, "body": "Could you please explain what <code>\\x -&gt; x : replicate&#39; 2 x</code> means? Also, does the compiler treat <code>myFunc</code> as I guessed?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 172, "user_id": 4932965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30dd676072dec501db6881c9dd4ac970?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Meriniuc", "link": "https://stackoverflow.com/users/4932965/razvan-meriniuc"}, "edited": false, "score": 1, "creation_date": 1462139239, "post_id": 36966123, "comment_id": 61500226, "body": "Um, you do know how lambda functions work, right? Otherwise, this would be a good time to read up on them, they&#39;re hugely important."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1462102085, "creation_date": 1462102085, "answer_id": 36966123, "question_id": 36965962, "link": "https://stackoverflow.com/questions/36965962/haskell-currying/36966123#36966123", "title": "Haskell Currying", "body": "<p>This is <code>replicate'</code> defined in explicitly curried form:</p>\n\n<pre><code>replicate' :: (Integral i, Ord i) =&gt; i -&gt; (a -&gt; [a])\nreplicate' n\n   | n &lt;= 0     = const []\n   | otherwise  = \\x -&gt; x : replicate' (n - 1) x\n</code></pre>\n\n<p>So then, <code>replicate' 3</code> evaluates to the expression</p>\n\n<pre><code>    if 3 &lt;= 0 then const []\n              else \\x -&gt; x : replicate' 2 x\n</code></pre>\n\n<p>which is just</p>\n\n<pre><code>  \\x -&gt; x : replicate' 2 x\n</code></pre>\n\n<p>If it's only defined with &ldquo;implicit currying&rdquo;, then the compiler may or may not pull out the <code>n &lt;= 0</code> condition out of the <code>x</code> binding, so in fact you may merely end up with</p>\n\n<pre><code>    \\x -&gt; if 3 &lt;= 0 then const []\n                    else \\x -&gt; x : replicate' 2 x\n</code></pre>\n"}], "owner": {"reputation": 172, "user_id": 4932965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30dd676072dec501db6881c9dd4ac970?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Meriniuc", "link": "https://stackoverflow.com/users/4932965/razvan-meriniuc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 36966123, "answer_count": 2, "score": 0, "last_activity_date": 1462102085, "creation_date": 1462100940, "question_id": 36965962, "link": "https://stackoverflow.com/questions/36965962/haskell-currying", "title": "Haskell Currying", "body": "<p>For the past two hours I have been reading about currying in Haskell and all the resources present how the functions with multiple parameters actually return other functions, but not how their definitions looks like, so this is what the question is about.</p>\n\n<p>Let us define the function:</p>\n\n<pre><code>myFunc :: (Num a) =&gt; a -&gt; a -&gt; a\nmyFunc x y = x * 2 + x * y\n</code></pre>\n\n<p><code>:t (myFunc 2)</code> prints <code>Num a =&gt; a -&gt; a</code>, i.e. a function that takes a number and also outputs a number. However, what does the definition of the function returned by <code>(myFunc 2)</code> look like? Does the compiler substitute <code>x</code> in the definition and the new function becomes something like <code>myFunc' y = 2 * 2 + 2 * y</code>?</p>\n\n<p>How does recursion handle currying? If I define the function</p>\n\n<pre><code>replicate' :: (Integral i, Ord i) =&gt; i -&gt; a -&gt; [a]\nreplicate' n x\n    | n &lt;= 0    = []\n    | otherwise = x : replicate' (n - 1) x\n</code></pre>\n\n<p>, what is the function returned by <code>(replicate' 3)</code> in the context <code>(replicate 3) 'a'</code>?</p>\n"}, {"tags": ["haskell", "main", "ghc", "tail-recursion", "criterion"], "comments": [{"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "edited": false, "score": 0, "creation_date": 1462099426, "post_id": 36965630, "comment_id": 61487121, "body": "Criterion is installed"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462100351, "post_id": 36965630, "comment_id": 61487366, "body": "how did you install it (as you can see GHCi don&#39;t think it is)"}, {"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462100520, "post_id": 36965630, "comment_id": 61487422, "body": "Mauritiuss-MacBook-Pro:~ Mauritius$ cabal install -j criterion Resolving dependencies... All the requested packages are already installed: criterion-1.1.1.0 Use --reinstall if you want to reinstall anyway. Mauritiuss-MacBook-Pro:~ Mauritius$"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462100791, "post_id": 36965630, "comment_id": 61487489, "body": "are you using <code>cabal sandboxes</code> or <code>stack</code> then you need to adapt the ghci call to <code>cabal repl</code> or <code>stack ghci</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462100859, "post_id": 36965630, "comment_id": 61487510, "body": "if you are using outdated versions of ghc/cabal you might find <a href=\"https://stackoverflow.com/questions/17014270/how-can-i-use-ghci-with-the-new-cabal-1-17-sandboxes\" title=\"how can i use ghci with the new cabal 1 17 sandboxes\">stackoverflow.com/questions/17014270/&hellip;</a> interesting"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462100978, "post_id": 36965630, "comment_id": 61487545, "body": "also note running criterion in ghci is a bad idea - usually when you are doing profiling you are compiling with optimizations!"}], "owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519818976, "creation_date": 1462098777, "question_id": 36965630, "link": "https://stackoverflow.com/questions/36965630/criterion-fails-when-running-in-ghci", "title": "Criterion fails when running in ghci", "body": "<p>I want to track the difference of time for termination of the following to versions calculating the length of a list. I have got one recursive and one tail recursive. Somehow i have got a problem when running in ghci (See below)</p>\n\n<pre><code>-- 4-1 a) Laenge einer Liste --\nimport Criterion.Main\n\nmain :: IO ()\nmain = defaultMain [\n  bgroup \"myList\" [ bench \"1\" $ whnf myList [1]\n                 , bench \"2\" $ whnf myList [1,2]\n                 , bench \"3\" $ whnf myList [1,2,3]\n                 , bench \"4\" $ whnf myList [1,2,3,4]\n                 , bench \"10\" $ whnf myList [1,2,3,4,5,6,7,8,9,10]\n                 , bench \"20\" $ whnf myList [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]\n                ]\n  bgroup \"myListner\" [ bench \"1\" $ whnf myListner [1]\n                  , bench \"2\" $ whnf myLister [1,2]\n                  , bench \"3\" $ whnf myListner [1,2,3]\n                  , bench \"4\" $ whnf myListner [1,2,3,4]\n                  , bench \"10\" $ whnf myListner [1,2,3,4,5,6,7,8,9,10]\n                  , bench \"20\" $ whnf myListner [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]\n                  ]\n]\n\n\n--endrekursiv\nmyList:: [a]-&gt;Integer\nmyList []=0\nmyList (x:xs)= myHelpList 1 xs \n where\n  myHelpList:: Integer-&gt; [a]-&gt;Integer\n  myHelpList acc [] = acc\n  myHelpList acc (x:xs) = myHelpList (acc+1) xs\n\n--nicht endrekursiv\nmyListner::[a]-&gt;Integer\nmyListner []=0\nmyListner (x:xs)= 1+ myList xs\n</code></pre>\n\n<p>Ghci returns:</p>\n\n<pre><code>laenge.hs:3:8:\nCould not find module \u2018Criterion.Main\u2019\nUse -v to see a list of the files searched for.\n\nFailed, modules loaded: none.\nPrelude&gt;\n</code></pre>\n\n<p>Can anyone help me with that? </p>\n"}, {"tags": ["haskell", "frp", "elerea"], "answers": [{"comments": [{"owner": {"reputation": 306, "user_id": 3422954, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0217f8d6ff8f32575cb17ef35f0fd829?s=128&d=identicon&r=PG&f=1", "display_name": "Higemaru", "link": "https://stackoverflow.com/users/3422954/higemaru"}, "edited": false, "score": 0, "creation_date": 1462102989, "post_id": 36966169, "comment_id": 61488137, "body": "Thanks! As you said, I already had the answer to some of my questions. I completely missed the transfer function, probably because the example given isn&#39;t quite as simple as the other ones. Stateful&#39;s example seems much more appropriate to be an example for transfer. On closer inspection I guess transfer can do a lot more than just be the stateful-variant I was looking for."}, {"owner": {"reputation": 306, "user_id": 3422954, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0217f8d6ff8f32575cb17ef35f0fd829?s=128&d=identicon&r=PG&f=1", "display_name": "Higemaru", "link": "https://stackoverflow.com/users/3422954/higemaru"}, "edited": false, "score": 0, "creation_date": 1462105350, "post_id": 36966169, "comment_id": 61488778, "body": "I just ran your code and got <code>Prelude.undefined</code>. It works using <code>(pure undefined)</code> like in my edit of the question."}, {"owner": {"reputation": 750, "user_id": 2350060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cf94c7218b74a36b40b1241e5c6649f?s=128&d=identicon&r=PG", "display_name": "Alexander Batischev", "link": "https://stackoverflow.com/users/2350060/alexander-batischev"}, "reply_to_user": {"reputation": 306, "user_id": 3422954, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0217f8d6ff8f32575cb17ef35f0fd829?s=128&d=identicon&r=PG&f=1", "display_name": "Higemaru", "link": "https://stackoverflow.com/users/3422954/higemaru"}, "edited": false, "score": 0, "creation_date": 1462106708, "post_id": 36966169, "comment_id": 61489190, "body": "Ah, right; it doesn&#39;t work with <code>undefined</code> because somewhere in the guts of the library, it expects to see a <code>Signal</code> value and sees <code>undefined</code>; while <code>pure undefined</code> works because it&#39;s an <code>undefined</code> packed into a <code>Signal</code>. Library needs the container, but never looks at the packed value. I&#39;ll update my post. Thanks, and sorry for the confusion!"}], "tags": [], "owner": {"reputation": 750, "user_id": 2350060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cf94c7218b74a36b40b1241e5c6649f?s=128&d=identicon&r=PG", "display_name": "Alexander Batischev", "link": "https://stackoverflow.com/users/2350060/alexander-batischev"}, "is_accepted": true, "score": 1, "last_activity_date": 1462106783, "last_edit_date": 1462106783, "creation_date": 1462102328, "answer_id": 36966169, "question_id": 36965530, "link": "https://stackoverflow.com/questions/36965530/in-elerea-why-doesnt-stateful-return-the-state-after-the-last-state-transforma/36966169#36966169", "title": "In Elerea, why doesn&#39;t stateful return the state after the last state transformation?", "body": "<blockquote>\n  <p>Probably because it gives the initial value first, then the result of the first invocation of (:) second, etc. So if we push in six characters (including '~') we get out \"\" after five characters have been prepended. The string \"~hello\" is actually in there, but on sampling the signal we get the old state (right before it is discarded).</p>\n</blockquote>\n\n<p>That's exactly how <code>stateful</code> works. Quoting <a href=\"https://hackage.haskell.org/package/elerea-2.8.0/docs/FRP-Elerea-Param.html#v:stateful\" rel=\"nofollow\">the documentation</a>:</p>\n\n<blockquote>\n  <p>The initial state is the first output, and every following output is calculated from the previous one and the value of the global parameter</p>\n</blockquote>\n\n<p>That answers the first of your questions.</p>\n\n<p>As for the second, yes, an alternative function could return the new state immediately. In fact, there's <a href=\"https://hackage.haskell.org/package/elerea-2.8.0/docs/FRP-Elerea-Param.html#v:transfer\" rel=\"nofollow\">such a function already</a>, called <code>transfer</code>:</p>\n\n<blockquote>\n  <p>The current input affects the current output, i.e. the initial state given in the first argument is considered to appear before the first output, and can never be observed.</p>\n</blockquote>\n\n<p>(It also carries state, which you in your examples should just ignore.)</p>\n\n<p>With this function, the \"hello\" example can be rewritten like this:</p>\n\n<pre><code>do\n  smp &lt;- start (transfer\n                 \"\"\n                 (\\character _ state -&gt; character:state)\n                 (pure undefined))\n  res &lt;- forM \"olleh\" smp\n  print res\n</code></pre>\n"}], "owner": {"reputation": 306, "user_id": 3422954, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0217f8d6ff8f32575cb17ef35f0fd829?s=128&d=identicon&r=PG&f=1", "display_name": "Higemaru", "link": "https://stackoverflow.com/users/3422954/higemaru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 36966169, "answer_count": 1, "score": 1, "last_activity_date": 1462106783, "creation_date": 1462098138, "last_edit_date": 1462104688, "question_id": 36965530, "link": "https://stackoverflow.com/questions/36965530/in-elerea-why-doesnt-stateful-return-the-state-after-the-last-state-transforma", "title": "In Elerea, why doesn&#39;t stateful return the state after the last state transformation?", "body": "<p>Let's take a look at an example given in the \n<a href=\"https://hackage.haskell.org/package/elerea-2.8.0/docs/FRP-Elerea-Param.html#g:4\" rel=\"nofollow\">hackage documentation for stateful</a></p>\n\n<pre><code>do\n  smp &lt;- start (stateful \"\" (:))\n  res &lt;- forM \"olleh~\" smp\n  print res\n</code></pre>\n\n<p>the output is:</p>\n\n<pre><code>[\"\",\"o\",\"lo\",\"llo\",\"ello\",\"hello\"]\n</code></pre>\n\n<p>What it does is push one character after the next into the signal network, first 'o', then 'l', 'l' again, and so on.\nThe state transformation function given to stateful (<code>(:)</code>, aka <code>cons</code>)  takes an element and a list of elements and returns the list with the single element prepended. (In Haskell a <code>String</code> is a list of <code>Char</code>s)</p>\n\n<p>What happens is this</p>\n\n<pre><code>(:) 'o' \"\" -- gives \"o\", then\n(:) 'l' \"o\" -- gives \"lo\", etc\n</code></pre>\n\n<p>This is all quite straightforward, but did you notice there is a '~' at the end of the input string? So why does it not give</p>\n\n<pre><code>[\"\",\"o\",\"lo\",\"llo\",\"ello\",\"hello\", \"~hello\"]\n                                    ^^^^^^\n</code></pre>\n\n<p>?</p>\n\n<p>Probably because it gives the initial value first, then the result of the first invocation of <code>(:)</code> <strong>second</strong>, etc. So if we push in six characters (including '~') we get out \"\" after <strong>five</strong> characters have been prepended. The string <code>\"~hello\"</code> is actually in there, but on sampling the signal we get the <em>old</em> state (right before it is discarded).</p>\n\n<p>I expected the following two (contrived) examples to produce the same output, but they do not:</p>\n\n<pre><code>-- 1\ndo\n  smp &lt;- start $ do\n    n &lt;- input\n    return (n*2)\n  res &lt;- forM [1,2,3] smp\n  print res -- prints [2,4,6]\n\n-- 2\ndo\n  smp &lt;- start $ stateful 0 (\\n _  -&gt; n*2) -- ignore state\n  res &lt;- forM [1,2,3] smp\n  print res -- prints [0,2,4]\n\n-- edit: 3\n-- to make the trio complete, you can use transfer to do the same\n-- thing as 1 above\n-- there is of course no reason to actually do it this way\ndo\n  smp &lt;- start $ transfer undefined (\\n _ _ -&gt; n*2) (pure undefined)\n  res &lt;- forM [1,2,3] smp\n  print res\n</code></pre>\n\n<p>So my questions are:</p>\n\n<ul>\n<li>Why does it do that? Is it important enough we get the initial value that we just have to accept this delay?</li>\n<li>Could an alternative function return the next value as soon as it is available? (In other words, could this alternative function return \"hello\" right after the 'h' was sent in, so the '~' could be removed?) The resulting signal would then never produce the initial value.</li>\n</ul>\n\n<p>edit:\nAfter Alexander pointed me to <a href=\"https://hackage.haskell.org/package/elerea-2.8.0/docs/FRP-Elerea-Param.html#g:4\" rel=\"nofollow\">transfer</a> I came up with this:</p>\n\n<pre><code>do\n  smp &lt;- start (stateful' \"\" (:))\n  res &lt;- forM \"olleh\" smp -- no '~'!\n  print res -- prints [\"o\",\"lo\",\"llo\",\"ello\",\"hello\"]\n\nstateful' :: a -&gt; (p -&gt; a -&gt; a) -&gt; SignalGen p (Signal a)\nstateful' s f = transfer s (\\p _ a -&gt; f p a) (pure undefined)\n</code></pre>\n\n<p>stateful' seems to be very roughly 25% slower than stateful on my machine.</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 4544980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3M9RDpxI6CU/AAAAAAAAAAI/AAAAAAAAA80/GXolD5hEwIo/photo.jpg?sz=128", "display_name": "Syed Fahad Khalid", "link": "https://stackoverflow.com/users/4544980/syed-fahad-khalid"}, "edited": false, "score": 0, "creation_date": 1462099855, "post_id": 36965536, "comment_id": 61487230, "body": "Thank you so much, It worked and full-filled my need :)"}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "reply_to_user": {"reputation": 47, "user_id": 4544980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3M9RDpxI6CU/AAAAAAAAAAI/AAAAAAAAA80/GXolD5hEwIo/photo.jpg?sz=128", "display_name": "Syed Fahad Khalid", "link": "https://stackoverflow.com/users/4544980/syed-fahad-khalid"}, "edited": false, "score": 0, "creation_date": 1462112074, "post_id": 36965536, "comment_id": 61490812, "body": "Glad to hear it, please mark the asnwer as an accepted solution if it solved your problem :)"}, {"owner": {"reputation": 47, "user_id": 4544980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3M9RDpxI6CU/AAAAAAAAAAI/AAAAAAAAA80/GXolD5hEwIo/photo.jpg?sz=128", "display_name": "Syed Fahad Khalid", "link": "https://stackoverflow.com/users/4544980/syed-fahad-khalid"}, "edited": false, "score": 0, "creation_date": 1462112751, "post_id": 36965536, "comment_id": 61491036, "body": "it says can not find module &#39;Value&#39;   Both the files are in same folder on my desktop. Is there any other place that i have to put them"}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "reply_to_user": {"reputation": 47, "user_id": 4544980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3M9RDpxI6CU/AAAAAAAAAAI/AAAAAAAAA80/GXolD5hEwIo/photo.jpg?sz=128", "display_name": "Syed Fahad Khalid", "link": "https://stackoverflow.com/users/4544980/syed-fahad-khalid"}, "edited": false, "score": 0, "creation_date": 1462113319, "post_id": 36965536, "comment_id": 61491226, "body": "are you trying to compile the modules or load them in Prelude? what exact command are you typing and what is the exace error message?"}, {"owner": {"reputation": 47, "user_id": 4544980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3M9RDpxI6CU/AAAAAAAAAAI/AAAAAAAAA80/GXolD5hEwIo/photo.jpg?sz=128", "display_name": "Syed Fahad Khalid", "link": "https://stackoverflow.com/users/4544980/syed-fahad-khalid"}, "edited": false, "score": 0, "creation_date": 1462113539, "post_id": 36965536, "comment_id": 61491301, "body": "What i am trying to do is if i run Addition.hs and type addition on GHCI command line it simply returns the answer"}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "reply_to_user": {"reputation": 47, "user_id": 4544980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3M9RDpxI6CU/AAAAAAAAAAI/AAAAAAAAA80/GXolD5hEwIo/photo.jpg?sz=128", "display_name": "Syed Fahad Khalid", "link": "https://stackoverflow.com/users/4544980/syed-fahad-khalid"}, "edited": false, "score": 0, "creation_date": 1462113704, "post_id": 36965536, "comment_id": 61491353, "body": "Is this not what you wanted? You defined <code>addition</code> as an <code>Int</code>, did you mean for it to be a function?"}, {"owner": {"reputation": 47, "user_id": 4544980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3M9RDpxI6CU/AAAAAAAAAAI/AAAAAAAAA80/GXolD5hEwIo/photo.jpg?sz=128", "display_name": "Syed Fahad Khalid", "link": "https://stackoverflow.com/users/4544980/syed-fahad-khalid"}, "edited": false, "score": 0, "creation_date": 1462113870, "post_id": 36965536, "comment_id": 61491408, "body": "This is what i wanted but I don&#39;t know how can i use module in function ?  I want a function to use a module"}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "reply_to_user": {"reputation": 47, "user_id": 4544980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3M9RDpxI6CU/AAAAAAAAAAI/AAAAAAAAA80/GXolD5hEwIo/photo.jpg?sz=128", "display_name": "Syed Fahad Khalid", "link": "https://stackoverflow.com/users/4544980/syed-fahad-khalid"}, "edited": false, "score": 0, "creation_date": 1462114120, "post_id": 36965536, "comment_id": 61491494, "body": "modules exist in a larger scope. modules conatin functions. functions in a given module can reference functions and values in other moduels referenced by that module. you can&#39;t reference a module in a local function scope though."}], "tags": [], "owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "is_accepted": true, "score": 2, "last_activity_date": 1462098166, "creation_date": 1462098166, "answer_id": 36965536, "question_id": 36965483, "link": "https://stackoverflow.com/questions/36965483/does-any-one-no-how-to-get-value-from-one-haskell-program-to-another/36965536#36965536", "title": "Does any one no how to get value from one haskell program to another", "body": "<p>You can reference members of other modules if you import that module, and the module exports the member:</p>\n\n<p>Value.hs</p>\n\n<pre><code>module Value ( value ) where\n\nvalue :: Int\nvalue = 20\n</code></pre>\n\n<p>Addition.hs</p>\n\n<pre><code>module Addition ( addition ) where\n\nimport Value\n\naddition :: Int\naddition = value + 10\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4544980, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3M9RDpxI6CU/AAAAAAAAAAI/AAAAAAAAA80/GXolD5hEwIo/photo.jpg?sz=128", "display_name": "Syed Fahad Khalid", "link": "https://stackoverflow.com/users/4544980/syed-fahad-khalid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 36965536, "answer_count": 1, "score": 0, "last_activity_date": 1462279268, "creation_date": 1462097760, "last_edit_date": 1462187059, "question_id": 36965483, "link": "https://stackoverflow.com/questions/36965483/does-any-one-no-how-to-get-value-from-one-haskell-program-to-another", "title": "Does any one no how to get value from one haskell program to another", "body": "<p>I am a newbie to function programming. How can I pass a value from one Haskell program to another? Suppose we have </p>\n\n<ul>\n<li><p>in a file called <code>Addition.hs</code>:</p>\n\n<pre><code>Addition::Int\nAddition = value+10\n</code></pre></li>\n<li><p>in a file called <code>Value.hs</code>:</p>\n\n<pre><code>value::Int\nvalue=20\n</code></pre></li>\n</ul>\n\n<p>With PHP, for example, if include a  file in another, I can access its classes. Is it possible in Haskell? That would make my program clearer.</p>\n"}, {"tags": ["haskell", "integer"], "answers": [{"comments": [{"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "edited": false, "score": 0, "creation_date": 1462102771, "post_id": 36965885, "comment_id": 61488073, "body": "Again thank you very much for the detailed explanation! At some point you will have to set up a tip jar because you seem to be answering all my haskell questions=)"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 3, "last_activity_date": 1462100488, "creation_date": 1462100488, "answer_id": 36965885, "question_id": 36965275, "link": "https://stackoverflow.com/questions/36965275/why-is-this-snippet-valid-with-an-explicit-value-but-invalid-as-a-function/36965885#36965885", "title": "why is this snippet valid with an explicit value, but invalid as a function?", "body": "<pre><code>[k|k&lt;-[1...floor(sqrt 10)],rem 10 k&lt;1]\n</code></pre>\n\n<p>this works because the first <code>10</code> is not the same as the latter one - to see this, we need the type signature of your functions:</p>\n\n<pre><code>sqrt :: Floating a =&gt; a -&gt; a\nrem :: Integral a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>so the first one means that it works for stuff that have a floating point representation - a.k.a. <code>Float</code>, <code>Double</code> ..., and the second one works for <code>Int</code>, <code>Integer</code> (bigint), <code>Word8</code> (unsigned 8bit integers)...</p>\n\n<p>so for the <code>10</code> in <code>sqrt 10</code> the compiler says - ahh this is a floating point number, null problemo, and for the <code>10</code> in <code>rem 10 k</code>, ahh this is an integer like number, null problemo as well.</p>\n\n<p>But when you bundle them up in a function - you are saying <code>n</code> has to be a floating point <strong>and</strong> an integral number, the compiler knows no such thing and - complains.</p>\n\n<p>So what do we do to fix that (and a side note ranges in haskell are indicated by <code>..</code> not <code>...</code>!). So let us start by taking a concrete solution and generalize it.</p>\n\n<pre><code>f :: Int -&gt; [Int]\nf n = [k|k &lt;- [1..n'],rem n k &lt; 1]\n    where n' = floor $ sqrt $ fromIntegral n\n</code></pre>\n\n<p>the neccessary part was converting the <code>Int</code> to a floating point number. But if you are putting that in a library all your users need to stick with using <code>Int</code> which is okay, but far from ideal - so how do we generalize (as promised)? We use GHCi to do that for us, using a lazy language we ourselves tend to be lazy as well.</p>\n\n<p>We start by commenting out the type-signature</p>\n\n<pre><code>-- f :: Int -&gt; [Int]\nf n = [k|k &lt;- [1..n'],rem n k &lt; 1]\n    where n' = floor $ sqrt $ fromIntegral n\n\n\n$&gt; ghci MyLib.hs\n....\nMyLib &gt; :type f\nf :: Integral a =&gt; a -&gt; [a]\n</code></pre>\n\n<p>then we can take this and put it into the library and if someone worked with <code>Word8</code> or <code>Integer</code> that would work as well.</p>\n\n<p>Another solution would be to use <code>rem (floor n) k &lt; 1</code> and have</p>\n\n<pre><code> f :: Floating a, Integral b =&gt; a -&gt; [b]\n</code></pre>\n\n<p>as the type, but that would be kind of awkward.</p>\n"}], "owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 36965885, "answer_count": 1, "score": 0, "last_activity_date": 1462100488, "creation_date": 1462096181, "question_id": 36965275, "link": "https://stackoverflow.com/questions/36965275/why-is-this-snippet-valid-with-an-explicit-value-but-invalid-as-a-function", "title": "why is this snippet valid with an explicit value, but invalid as a function?", "body": "<p>I'm trying to work a problem where I need to calculate the \"small\" divisors of an integer. I'm just bruteforcing through all numbers up to the square root of the given number, so to get the divisors of 10 I'd write:</p>\n\n<pre><code>[k|k&lt;-[1...floor(sqrt 10)],rem 10 k&lt;1]\n</code></pre>\n\n<p>This seems to work well. But as soon as I plug this in a function </p>\n\n<pre><code>f n=[k|k&lt;-[1...floor(sqrt n)],rem n k&lt;1]\n</code></pre>\n\n<p>And actually <em>call</em> this function, I do get an error</p>\n\n<pre><code>f 10\n\nNo instance for (Floating t0) arising from a use of `it'\nThe type variable `t0' is ambiguous\nNote: there are several potential instances:\n  instance Floating Double -- Defined in `GHC.Float'\n  instance Floating Float -- Defined in `GHC.Float'\nIn the first argument of `print', namely `it'\nIn a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>As far as I undrestand the actual <em>print</em> function that prints the result to the console is causing trouble, but I cannot find out what is wrong. It says the <code>type</code> is ambiguous, but the function can clearly only return a list of integers. Then again I checked the type, and it the (inferred) type of <code>f</code> is </p>\n\n<pre><code>f :: (Floating t, Integral t, RealFrac t) =&gt; t -&gt; [t]\n</code></pre>\n\n<p>I can understand that <code>f</code>should be able to accept any real numerical value, but can anyone explain why the <em>return</em> type should be anything else than <code>Integral</code> or <code>int</code>?</p>\n"}, {"tags": ["haskell", "list-comprehension"], "answers": [{"comments": [{"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "edited": false, "score": 0, "creation_date": 1462095210, "post_id": 36965140, "comment_id": 61486094, "body": "Thank you for you answer and providing alternatives!"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 2, "creation_date": 1462095488, "post_id": 36965140, "comment_id": 61486167, "body": "Another one is <code>[1, 3 .. 10] &gt;&gt;= (\\x -&gt; [x, x + 1])</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1462199540, "post_id": 36965140, "comment_id": 61524478, "body": "... or equivalently <code>do</code> <code>x &lt;- [1, 3 .. 10]</code> <code>[x, x+1]</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1462202850, "last_edit_date": 1462202850, "creation_date": 1462095142, "answer_id": 36965140, "question_id": 36964978, "link": "https://stackoverflow.com/questions/36964978/is-adding-multiple-elements-in-a-list-comprehension-possible/36965140#36965140", "title": "Is adding multiple elements in a list comprehension possible?", "body": "<p>There are some alternatives, none of which is significantly better than what you propose.</p>\n\n<pre><code>concat [ [k, k+1] | k &lt;- [1, 3 .. 10] ]\njoin   [ [k, k+1] | k &lt;- [1, 3 .. 10] ]\n[ x | k &lt;- [1, 3 .. 10], x &lt;- [k,k+1] ]\n[1, 3 .. 10] &gt;&gt;= (\\x -&gt; [x, x + 1])\ndo x &lt;- [1, 3 .. 10] ; [x, x+1]\n</code></pre>\n\n<p>Note that <code>foldl1 (++)</code>, as in your solution, will abort the program with a runtime error if it finds an empty lists-of-lists. The above alternatives have no such problem.</p>\n"}], "owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1478, "favorite_count": 1, "accepted_answer_id": 36965140, "answer_count": 1, "score": 6, "last_activity_date": 1462202850, "creation_date": 1462093910, "last_edit_date": 1462187212, "question_id": 36964978, "link": "https://stackoverflow.com/questions/36964978/is-adding-multiple-elements-in-a-list-comprehension-possible", "title": "Is adding multiple elements in a list comprehension possible?", "body": "<p>I'm wondering whether it's possible to add multiple elements to a list within a list comprehension.</p>\n\n<p>For instance, if I want a list consisting of the numbers 1 to 10, I can write:</p>\n\n<pre><code>[k | k &lt;- [1..10]]\n</code></pre>\n\n<p>However, is there also a way to do this by always adding <code>k</code> <em>and</em> <code>k+1</code> in the same step, and just take only the odd numbers <code>k</code>? Following code is invalid but perhaps explains better what I'm trying to do:</p>\n\n<pre><code>[k, k+1 | k &lt;- [1, 3..10]]\n</code></pre>\n\n<p>Currently, the closest thing to this (that I am aware of) is the following:</p>\n\n<pre><code>foldl1 (++) [[k, k + 1] | k &lt;- [1, 3..10]]\n</code></pre>\n"}, {"tags": ["haskell", "type-families"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1462092832, "post_id": 36964664, "comment_id": 61485472, "body": "The problem is that <code>Ord</code> is a class and <code>Num</code> is a class too. So <code>Ord Num</code> is a malformed constraint. It should be something like <code>Ord type</code> and <code>Num type</code> if you want to constrain <code>type</code> with both <code>Ord</code> and <code>Num</code>."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1462132885, "post_id": 36964664, "comment_id": 61498155, "body": "@Bakuriu I get what you are saying, and I didn&#39;t expect <code>Ord Num</code> to work as is, but I tried variations of that like <code>(Ord a, Num a) =&gt; a</code> and couldn&#39;t get any of them working, I am gonna try some more stuff today and see if I can find a working one."}], "answers": [{"comments": [{"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1462306660, "post_id": 36982913, "comment_id": 61579339, "body": "I tried copying what you wrote but I ended up needing to turn on a LOT of extensions: <code>{-# LANGUAGE ConstraintKinds, FlexibleContexts, MultiParamTypeClasses, PolyKinds, TypeFamilies, TypeOperators, UndecidableInstances #-}</code> and even then it still told me <code>No instance for ((&amp;) Ord Num b0) arising from a use of \u2018fmap&#39;\u2019 In the expression: fmap&#39; (+ 1)</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1462372960, "post_id": 36982913, "comment_id": 61612105, "body": "@semicolon I accidentally a line. Should be fixed now."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1462390632, "post_id": 36982913, "comment_id": 61623253, "body": "I am now getting <code>Illegal instance declaration for \u2018(&amp;) f g x\u2019 (All instance types must be of the form (T a1 ... an) where a1 ... an are *distinct type variables*, and each type variable appears at most once</code>"}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 2, "last_activity_date": 1462410606, "last_edit_date": 1462410606, "creation_date": 1462193460, "answer_id": 36982913, "question_id": 36964664, "link": "https://stackoverflow.com/questions/36964664/haskell-combine-multiple-typeclass-constraints/36982913#36982913", "title": "Haskell combine multiple typeclass constraints", "body": "<p>You will need to define a typeclass (since typeclasses can be partially applied ) which reduces to the constraint you want through a superclass: </p>\n\n<pre><code>{-# LANGUAGE \n    PolyKinds, UndecidableInstances, TypeOperators\n  , MultiParamTypeClasses, ConstraintKinds, TypeFamilies\n  , FlexibleContexts, FlexibleInstances \n#-}\n\nclass (f x, g x) =&gt; (&amp;) f g (x :: k)\ninstance (f x, g x) =&gt; (&amp;) f g x\n</code></pre>\n\n<p>Clearly <code>(f &amp; g) x</code> holds iff <code>f x</code> and <code>g x</code> hold. The definition of <code>FConstraint'</code> should be obvious now:</p>\n\n<pre><code>class Functor' ... \n\ninstance Functor' Set.Set where\n    type FConstraint Set.Set = Ord &amp; Num\n    fmap' f = Set.map ( (+1) . f )  -- (+1) to actually use the Num constraint\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "is_accepted": true, "score": 0, "last_activity_date": 1462403258, "last_edit_date": 1462403258, "creation_date": 1462402751, "answer_id": 37039487, "question_id": 36964664, "link": "https://stackoverflow.com/questions/36964664/haskell-combine-multiple-typeclass-constraints/37039487#37039487", "title": "Haskell combine multiple typeclass constraints", "body": "<p>Looks like the only change I needed to make was not partially apply <code>FConstraint</code>:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nimport GHC.Prim\nimport qualified Data.Set as Set\n\nclass Functor' f where\n    type FConstraint f a :: Constraint\n    fmap' :: (FConstraint f a, FConstraint f b) =&gt; (a -&gt; b) -&gt; f a -&gt; f b \n\ninstance Functor' Set.Set where\n    type FConstraint Set.Set a = (Ord a, Num a)\n    fmap' f = Set.map ((+ 1) . f)\n\nfoo = fmap (+ 1) $ Set.fromList [1, 2, 3]\n</code></pre>\n\n<p>Unfortunately this does not allow me to use a concrete type as far as I can tell, but I suppose that wouldn't even match with Functor on a kind level anyway (<code>Functor</code> has kind <code>* -&gt; *</code> but a list of concrete values such as <code>String</code> has kind <code>*</code>).</p>\n"}], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "accepted_answer_id": 37039487, "answer_count": 2, "score": 2, "last_activity_date": 1462410606, "creation_date": 1462091422, "question_id": 36964664, "link": "https://stackoverflow.com/questions/36964664/haskell-combine-multiple-typeclass-constraints", "title": "Haskell combine multiple typeclass constraints", "body": "<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nimport GHC.Prim\nimport qualified Data.Set as Set\n\nclass Functor' f where\n    type FConstraint f :: * -&gt; Constraint\n    fmap' :: (FConstraint f a, FConstraint f b) =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n\ninstance Functor' Set.Set where\n    type FConstraint Set.Set = Ord Num  --error here, won't let me put Num\n    fmap' = Set.map\n</code></pre>\n\n<p>I was wondering how I could make the above work. Now I know I could manually require two typeclasses, but I was hoping to be able to combine any arbitrary amount of them.</p>\n\n<p>Now I know requiring <code>Num</code> does not make sense in this case, but this is purely an example.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5603548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89f0468fe75d5d1b5d5d122626d227d3?s=128&d=identicon&r=PG&f=1", "display_name": "newinjava", "link": "https://stackoverflow.com/users/5603548/newinjava"}, "edited": false, "score": 0, "creation_date": 1462088821, "post_id": 36964305, "comment_id": 61484635, "body": "Thank you @Carsten ! I understand this now. Thanks for the help"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 27, "user_id": 5603548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89f0468fe75d5d1b5d5d122626d227d3?s=128&d=identicon&r=PG&f=1", "display_name": "newinjava", "link": "https://stackoverflow.com/users/5603548/newinjava"}, "edited": false, "score": 0, "creation_date": 1462088899, "post_id": 36964305, "comment_id": 61484658, "body": "no problem - if you feel that this answers your question you can opt to mark it as one so others see that this question is finished"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 1, "last_activity_date": 1462088846, "last_edit_date": 1462088846, "creation_date": 1462088634, "answer_id": 36964305, "question_id": 36964277, "link": "https://stackoverflow.com/questions/36964277/a-function-update-which-let-s-i-v-returns-sv-i-in-haskell/36964305#36964305", "title": "A function &quot;update&quot; which let s i v returns s[v |-&gt; i] in Haskell", "body": "<p>you have to return a function representing your new state (the state seems to be a function from <code>Var -&gt; Z</code>:</p>\n\n<pre><code>update :: State -&gt; Z -&gt; Var -&gt; State\nupdate oldState i v = newState\n    where newState v'\n             | v == v' = i\n             | otherwise = oldState v\n</code></pre>\n\n<hr>\n\n<p>let's see the main issues with your version:</p>\n\n<ul>\n<li><code>v i</code> would indicate that you want to evaluate <code>v</code> at <code>i</code> - but <code>v</code> is a <code>Var ~ String</code> so you get the compiler error (saying that <code>Var</code> has no arguments)</li>\n<li>you don't even use <code>s</code> this should indicate that you either really don't need it or you forgot to use it ;)</li>\n</ul>\n"}], "owner": {"reputation": 27, "user_id": 5603548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89f0468fe75d5d1b5d5d122626d227d3?s=128&d=identicon&r=PG&f=1", "display_name": "newinjava", "link": "https://stackoverflow.com/users/5603548/newinjava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 36964305, "answer_count": 1, "score": 0, "last_activity_date": 1462089099, "creation_date": 1462088431, "last_edit_date": 1462089099, "question_id": 36964277, "link": "https://stackoverflow.com/questions/36964277/a-function-update-which-let-s-i-v-returns-sv-i-in-haskell", "title": "A function &quot;update&quot; which let s i v returns s[v |-&gt; i] in Haskell", "body": "<p>I'm a beginner in Haskell, and this is a simple question in haskell. </p>\n\n<p>I'm just trying to write a function update with the following signature such that \n<code>update s i v</code> returns the state update <code>s[v |-&gt; i]</code>. i.e. state obtained from <code>s</code> by updating the value of <code>v</code> to <code>i</code>. </p>\n\n<p>My code here is : </p>\n\n<pre><code>type Num = Integer\ntype Var = String\ntype Z = Integer\ntype T = Bool\ntype State = Var -&gt; Z\n</code></pre>\n\n<p>And what I'm trying to write is a function </p>\n\n<pre><code>update :: State -&gt; Z -&gt; Var -&gt; State\nupdate s i v =  v i\n</code></pre>\n\n<p>But when I compile this, ghci gives that </p>\n\n<pre><code>couldn't match expected type 'Z -&gt; State' with actual type '[Char]'. The function 'v' is applied to one argument, but its type 'Var' has none\n</code></pre>\n\n<p>What confuses me is that I don't want a <code>Z -&gt; State</code> here. Could anyone give me any hints? I'm sorry if I did not make this question clear. I started learning Haskell yesterday :O</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 597, "user_id": 2157021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5f361d3bd72832787dc2b79ce78de71?s=128&d=identicon&r=PG", "display_name": "amar47shah", "link": "https://stackoverflow.com/users/2157021/amar47shah"}, "edited": false, "score": 2, "creation_date": 1462077604, "post_id": 36962520, "comment_id": 61482728, "body": "Regarding the type signature, consider that <code>[a] -&gt; [a]</code> includes <code>[Int] -&gt; [Int]</code>. Would it make sense to ever do <code>transposeString [1,2,3]</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462089578, "post_id": 36963317, "comment_id": 61484781, "body": "Another interesting case is <code>transposeString [&quot;hello&quot;, &quot;mars&quot;]</code>, which in a few steps involves <code>[&quot;o&quot;, &quot;&quot;]</code>."}, {"owner": {"reputation": 343, "user_id": 5443008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/knp4Q.jpg?s=128&g=1", "display_name": "K.Boyette", "link": "https://stackoverflow.com/users/5443008/k-boyette"}, "edited": false, "score": 0, "creation_date": 1462135466, "post_id": 36963317, "comment_id": 61499035, "body": "It&#39;s an infinite recursion of empty lists.  I&#39;m working on that as well! haha. It&#39;s one small function in a bigger program.  Chi&#39;s point is exactly what I&#39;m working on now because I have the situation [&quot;ABCD&quot;, &quot;EFGH&quot;, &quot;IJKL&quot; ...&quot;YZ&quot;] where there are 4 characters in each string but the last.  It throws an exception due to, I&#39;m assuming, lazy evaluation."}, {"owner": {"reputation": 343, "user_id": 5443008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/knp4Q.jpg?s=128&g=1", "display_name": "K.Boyette", "link": "https://stackoverflow.com/users/5443008/k-boyette"}, "edited": false, "score": 0, "creation_date": 1462135783, "post_id": 36963317, "comment_id": 61499126, "body": "Sample Output for kicks: [],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],&zwnj;&#8203;[],[],[],[],[],[],[]&zwnj;&#8203;,[],[],[],[],[],[],[&zwnj;&#8203;],[],[],[],[],[],[],&zwnj;&#8203;[],[],[],[],[],[],[]&zwnj;&#8203;,[],[],[],[],[],[],[&zwnj;&#8203;],[],[],[],[],[],[],&zwnj;&#8203;[],[],[],[],[],[],[]&zwnj;&#8203;,[],[],[],[],[],[],[&zwnj;&#8203;],[],[],[],[],[],[]^&zwnj;&#8203;Z,[] [1]+  Stopped                 ghci"}], "tags": [], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "is_accepted": false, "score": 2, "last_activity_date": 1462079747, "creation_date": 1462079747, "answer_id": 36963317, "question_id": 36962520, "link": "https://stackoverflow.com/questions/36962520/haskell-transposition-on-a-list-of-strings/36963317#36963317", "title": "Haskell: Transposition on a list of strings", "body": "<p>One point of note. Your type signature for <code>tranposeString</code> allows to accept a flat list as an argument. Tranposing a <code>[String]</code> works because <code>[String]</code>s are really just <code>[[Char]]</code>s, but what happens when you try to call <code>transposeString</code> on an <code>[Int]</code>? After all, the type signature allows for it.</p>\n\n<p>On a side note, I ask you, given your current function, what would happen if your called <code>transposeString []</code>?</p>\n"}, {"comments": [{"owner": {"reputation": 343, "user_id": 5443008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/knp4Q.jpg?s=128&g=1", "display_name": "K.Boyette", "link": "https://stackoverflow.com/users/5443008/k-boyette"}, "edited": false, "score": 0, "creation_date": 1462135681, "post_id": 36964318, "comment_id": 61499094, "body": "Thank you! This works!  I&#39;m still unable to get it to work for my particular situation (comments in a post below), but this answers my question."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1462088699, "creation_date": 1462088699, "answer_id": 36964318, "question_id": 36962520, "link": "https://stackoverflow.com/questions/36962520/haskell-transposition-on-a-list-of-strings/36964318#36964318", "title": "Haskell: Transposition on a list of strings", "body": "<p>Mind that you do not have to provide a type signature: the Haskell compiler can derive one. If you put your implementation in a file:</p>\n\n<pre><code>transposeString ([]:_) = []\ntransposeString x = (map head x) : transposeString (map tail x)\n</code></pre>\n\n<p>and query the type with <code>:t</code> in <code>ghci</code>, it returns:</p>\n\n<pre><code>*Main&gt; :t transposeString \ntransposeString :: [[b]] -&gt; [[b]]\n</code></pre>\n\n<p>This makes perfect sense:</p>\n\n<ol>\n<li>you transpose a matrix, which is a list of lists. <code>[[b]]</code> is a list of lists of <code>b</code> elements; and</li>\n<li>you can derive it from the implementation yourself: <code>map head x</code> means that <em>elements</em> of <code>x</code> must be a list (<code>[b]</code>) since we perform a mapping, we have to nest the list one additional level so <code>[[b]]</code>. The same for <code>tail</code>.</li>\n</ol>\n\n<p>As far as I know, your implementation is correctly. You can specialize it by saying that <code>[b] ~ String</code>, thus adding a type signature for <code>String</code>s:</p>\n\n<pre><code>transposeString :: [String] -&gt; [String]\ntransposeString ([]:_) = []\ntransposeString x = (map head x) : transposeString (map tail x)\n</code></pre>\n\n<p>which again makes sense because <code>String ~ [Char]</code> thus <code>b ~ Char</code>. But there is not much point in specializing a functions type: you better always use the most generic type signature. In this case <code>[[b]] -&gt; [[b]]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2171, "user_id": 6180987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eAIPQ.jpg?s=128&g=1", "display_name": "Sergey Luchko", "link": "https://stackoverflow.com/users/6180987/sergey-luchko"}, "is_accepted": false, "score": 0, "last_activity_date": 1585809659, "last_edit_date": 1585809659, "creation_date": 1574159122, "answer_id": 58931776, "question_id": 36962520, "link": "https://stackoverflow.com/questions/36962520/haskell-transposition-on-a-list-of-strings/58931776#58931776", "title": "Haskell: Transposition on a list of strings", "body": "<p>Do remember <code>String</code> is <code>[Char]</code></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\"abc\" == 'a' : 'b' : 'c' : []\n</code></pre>\n\n<p>From here you can use traversable nature of lists:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>transpose :: [[a]] -&gt; [[a]]\ntranspose mat = getZipList $ sequenceA $ map ZipList mat\n\ntest' = transpose [[1,2,3],[4,5,6],[7,8,9]] -- == [[1,4,7],[2,5,8],[3,6,9]]\ntest'' = transpose [\"abc\", \"deg\", \"klm\"] -- == [\"adk\",\"bel\",\"cgm\"]\n</code></pre>\n\n<p>You can also check default implementation of <code>transponse</code> in haskell doc\n<a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/Data.OldList.html#transpose\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/base-4.12.0.0/docs/src/Data.OldList.html#transpose</a></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>transpose               :: [[a]] -&gt; [[a]]\ntranspose []             = []\ntranspose ([]   : xss)   = transpose xss\ntranspose ((x:xs) : xss) = (x : [h | (h:_) &lt;- xss]) : transpose (xs : [ t | (_:t) &lt;- xss])\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 5443008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/knp4Q.jpg?s=128&g=1", "display_name": "K.Boyette", "link": "https://stackoverflow.com/users/5443008/k-boyette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 0, "accepted_answer_id": 36964318, "answer_count": 3, "score": 2, "last_activity_date": 1585809659, "creation_date": 1462070831, "question_id": 36962520, "link": "https://stackoverflow.com/questions/36962520/haskell-transposition-on-a-list-of-strings", "title": "Haskell: Transposition on a list of strings", "body": "<p>New to Haskell and the language has been fun so far.  I am hoping for a good hint rather than an answer as I am enjoying the mind-altering that is Haskell.  </p>\n\n<p><strong>Question:</strong> I have a list of strings and I would like to transpose them.  </p>\n\n<pre><code>let x = [\"hello\", \"world\"]\n</code></pre>\n\n<p>would become </p>\n\n<pre><code>[\"hw\", \"eo\", \"lr\", \"ll\", \"od\"]\n</code></pre>\n\n<p>What I have so far is this: </p>\n\n<pre><code>   transposeString :: [a] -&gt; [a]\n   transposeString ([]:_) = []\n   transposeString x = (map head x) : transposeString (map tail x)\n</code></pre>\n\n<p>I definitely know there is something wrong with the type signature.  My rational is that </p>\n\n<pre><code>Let y = [\"wow\", \"top\"]\nmap head y \n</code></pre>\n\n<p>returns \"wt\" so recursing this on the rest of the list would work?  </p>\n\n<p>Thank you in advance for any hints. </p>\n"}, {"tags": ["haskell", "if-statement", "conditional-statements"], "comments": [{"owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "edited": false, "score": 3, "creation_date": 1462068966, "post_id": 36962221, "comment_id": 61481456, "body": "Whoever told you nested <code>if</code>s are not possible in Haskell told you wrong. Constructs like this are perfectly possible: <code>if a then if b then A else if c then B else C else D</code>. Only this is often seen as kinda &#39;unhaskelly&#39;. What is your main concern, readability, maintainability or efficiency?"}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "edited": false, "score": 0, "creation_date": 1462070135, "post_id": 36962221, "comment_id": 61481658, "body": "@AndreyChernyakhovskiy ultimately its efficiency but without sacrificing too much of the other two. What I have written above does not seem very efficient and also, since I am learning, I would like to have my code be as &quot;haskelly&quot; as possible :P"}, {"owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "edited": false, "score": 0, "creation_date": 1462071087, "post_id": 36962221, "comment_id": 61481792, "body": "Efficiency may only be measured by benchmarking. As to &quot;haskelliness&quot;, following some common set of patterns is not a dogma. It&#39;s, after all, your own judgment. If you think that your program reads most clearly when laid out as a tree of <code>if</code>s, it&#39;s best to do so."}, {"owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "edited": false, "score": 0, "creation_date": 1462071345, "post_id": 36962221, "comment_id": 61481835, "body": "A possible &quot;haskelly&quot; way to do that is like this: <code>f = let f&#39; True True True _ _ _ = 1; f&#39; True True _ True _ _ = 2; f&#39; True True _ _ True _ = 3; f&#39; True _ _ _ True True = 4; f&#39; _ _ _ _ _ _ = 5 in f&#39; a b c d e g</code>"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1462182185, "post_id": 36962221, "comment_id": 61513796, "body": "Unless <code>a</code>, <code>b</code>, <code>c</code>, etc. are expressions which are expensive to compute (in which case you should use a <code>let</code> binding to ensure sharing), repeating the same guards will probably be a better solution: readability is quite a lot more valuable than hypothetical anecdotal performance gains."}], "answers": [{"tags": [], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "is_accepted": false, "score": 1, "last_activity_date": 1462076035, "creation_date": 1462076035, "answer_id": 36962970, "question_id": 36962221, "link": "https://stackoverflow.com/questions/36962221/haskell-and-multiple-conditions/36962970#36962970", "title": "Haskell and multiple conditions", "body": "<p>I'd use a <code>case</code>:</p>\n\n<pre><code>f x y z =\n  case (a, b, c, d, e, f, g) of\n    (True, True, True, _, _, _, _) -&gt; 1\n    (True, True, _, True, _, _, _) -&gt; 2\n    (True, True, _, _, True, _, _) -&gt; 3\n    (True, _, _, _, True, _, True) -&gt; 4\n  where\n    a = ...\n    b = ...\n    c = ...\n</code></pre>\n\n<p>Because these cases are not exclusive, you'd need to make sure the order and/or the coverage is such that you get your expected answers.</p>\n"}, {"tags": [], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "is_accepted": false, "score": 2, "last_activity_date": 1462121294, "last_edit_date": 1462121294, "creation_date": 1462080771, "answer_id": 36963415, "question_id": 36962221, "link": "https://stackoverflow.com/questions/36962221/haskell-and-multiple-conditions/36963415#36963415", "title": "Haskell and multiple conditions", "body": "<p>The problem with if statements in this case isn't that they can't be nested, its that they always have to have an <code>else</code> component, which makes them very unwieldy in this case, because you have to include the fallback case in every statement. Your example in if statements would look something like this.</p>\n\n<pre><code>f = if a then \n     if b then \n      if c then 1\n       else if d then 2\n        else if c\n          then 3\n          else 5\n     else 5\n    else if g then \n     if e\n      then 4\n      else 5\n     else 5\n</code></pre>\n\n<p>As for your other options, that depends exactly on the situation. If <code>a</code>,<code>b</code>,etc. are arguments to <code>f</code>, then you can pattern match on the function.</p>\n\n<pre><code>f True True True False False False False = 1\nf True True False True False False False = 2\nf True True False False True False False = 3\nf True False False False True False True = 4\nf _    _    _     _     _    _     _     = 5\n</code></pre>\n\n<p>However, if the variables are global, or defined in a <code>where</code> clause, you would need to use a <code>case</code> statement.</p>\n\n<pre><code>f =\n  case (a, b, c, d, e, f, g) of\n    (True, True, True, _, _, _, _) -&gt; 1\n    (True, True, _, True, _, _, _) -&gt; 2\n    (True, True, _, _, True, _, _) -&gt; 3\n    (True, _, _, _, True, _, True) -&gt; 4\n    _                              -&gt; 5\n</code></pre>\n\n<p>Realistically, though, as long as your variable names aren't too ridiculously long, your solution is probably the best mix of readability and conciseness. As for efficiency, boolean operations are so cheap, unless this function is included in some tight loop in a very intensive algorithm, I doubt you will be able to see any difference in speed between these options.</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1672, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462121294, "creation_date": 1462067685, "question_id": 36962221, "link": "https://stackoverflow.com/questions/36962221/haskell-and-multiple-conditions", "title": "Haskell and multiple conditions", "body": "<p>If I have multiple conditions that are only slightly different, what is the best way to write a function (considering and inability to nest guards) of the form:</p>\n\n<pre><code>f | a &amp;&amp; b &amp;&amp; c  = 1\n  | a &amp;&amp; b &amp;&amp; d  = 2\n  | a &amp;&amp; b &amp;&amp; e  = 3\n  | a &amp;&amp; g &amp;&amp; e  = 4\n</code></pre>\n\n<p>etc</p>\n\n<p>Imagine there are more a lot more conditions. Ideally I would like to write a nested if that would check for a then b  then something else, but I have been told that this not possible in Haskell.</p>\n\n<p>Also, in the example. If the first line returns falls, are the conditions a and b checked again if they not defined in a where clause?</p>\n"}, {"tags": ["haskell", "yesod", "persistent"], "answers": [{"tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": true, "score": 4, "last_activity_date": 1462053449, "creation_date": 1462053449, "answer_id": 36960708, "question_id": 36960551, "link": "https://stackoverflow.com/questions/36960551/yesod-persistent-how-to-compare-day-to-utctime-how-to-convert-them/36960708#36960708", "title": "Yesod Persistent - How to compare Day to UTCTime? (How to convert them?)", "body": "<p>A <code>UTCTime</code> is composed of a <code>Day</code> (<code>utctDay</code>) and the number of seconds since midnight (<code>utctDayTime</code>). Here's a GHCi session showing how to access the day:</p>\n\n<pre><code>ghci &gt; import Data.Time\nghci &gt; time &lt;- getCurrentTime\nghci &gt; :t time\ntime :: UTCTime\nghci &gt; utctDay time\n2016-04-30\nghci &gt; :t utctDay time\nutctDay time :: Day\n</code></pre>\n\n<p>Once you have access to the <code>Day</code>, you can use standard comparison functions (<code>&gt;</code>, <code>&gt;=</code> <code>==</code>, <code>&lt;</code> and <code>&lt;=</code>):</p>\n\n<pre><code>ghci &gt; t1 &lt;- getCurrentTime\nghci &gt; t2 &lt;- getCurrentTime\nghci &gt; t1\n2016-04-30 21:59:06.808488 UTC\nghci &gt; t2\n2016-04-30 21:59:11.920389 UTC\nghci &gt; (utctDay t1) &gt;= (utctDay t2)\nTrue\n</code></pre>\n\n<p>You might also want to check out <a href=\"http://haddock.stackage.org/lts-5.14/time-1.5.0.1/Data-Time-Clock.html#t:UTCTime\" rel=\"nofollow\">the Haddocks for <code>UTCTime</code></a>.</p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 36960708, "answer_count": 1, "score": 3, "last_activity_date": 1462053449, "creation_date": 1462052409, "last_edit_date": 1462053418, "question_id": 36960551, "link": "https://stackoverflow.com/questions/36960551/yesod-persistent-how-to-compare-day-to-utctime-how-to-convert-them", "title": "Yesod Persistent - How to compare Day to UTCTime? (How to convert them?)", "body": "<p>I have a value of type <code>UTCTime</code> representing the current time, and other value of type <code>Day</code> which I would like to know if is greater or equal than the current time.</p>\n"}, {"tags": ["haskell", "primes"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1462052639, "post_id": 36960534, "comment_id": 61478410, "body": "What you describe is basically the <a href=\"https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes\" rel=\"nofollow noreferrer\"><i>Sieve of Eratosthenes</i></a>."}, {"owner": {"reputation": 622, "user_id": 5121373, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/682a61eacb08098831bb8a0e1bdbd9b0?s=128&d=identicon&r=PG&f=1", "display_name": "Tu\u1ea5n Ph\u1ea1m", "link": "https://stackoverflow.com/users/5121373/tu%e1%ba%a5n-ph%e1%ba%a1m"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1462052974, "post_id": 36960534, "comment_id": 61478493, "body": "yeah i know, i could do it with java but still having problems in haskell :)"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1462064417, "post_id": 36960534, "comment_id": 61480634, "body": "Also note that there is i a full page at the haskell wiki dedicated to that problem - <a href=\"https://wiki.haskell.org/Prime_numbers\" rel=\"nofollow noreferrer\">wiki.haskell.org/Prime_numbers</a> there is a lot you can learn from reading now and re-reading it with more knowledge/experience"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1589357757, "post_id": 36960534, "comment_id": 109258304, "body": "what you describe is <code>primes = map head . takeWhile (not . null) $ scanl (\\\\) [2..10] [[p, p+p..] | p &lt;- primes] where (\\\\) = Data.List.Ordered.minus</code> (adapted from <a href=\"https://wiki.haskell.org/Prime_numbers#Definition\" rel=\"nofollow noreferrer\">here</a>). but also <code>nubBy (((&gt; 1) .) . gcd) [2..10]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 622, "user_id": 5121373, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/682a61eacb08098831bb8a0e1bdbd9b0?s=128&d=identicon&r=PG&f=1", "display_name": "Tu\u1ea5n Ph\u1ea1m", "link": "https://stackoverflow.com/users/5121373/tu%e1%ba%a5n-ph%e1%ba%a1m"}, "edited": false, "score": 1, "creation_date": 1462053451, "post_id": 36960661, "comment_id": 61478608, "body": "Many thanks ! i will have to study your answers, though, because some are really new for me. Theoretically i don&#39;t know about &quot;otherwise&quot;, &quot;any&quot; and guards yet, but i guess this is some kind of excercise that requires some digging. Thanks again !"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 622, "user_id": 5121373, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/682a61eacb08098831bb8a0e1bdbd9b0?s=128&d=identicon&r=PG&f=1", "display_name": "Tu\u1ea5n Ph\u1ea1m", "link": "https://stackoverflow.com/users/5121373/tu%e1%ba%a5n-ph%e1%ba%a1m"}, "edited": false, "score": 1, "creation_date": 1462053611, "post_id": 36960661, "comment_id": 61478644, "body": "<code>otherwise</code> is basically an alias for <code>True</code> (but is more popular for guards). <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:any\" rel=\"nofollow noreferrer\"><code>any</code></a> iterates through a list until it finds an element that satisfies a given condition."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1462053671, "last_edit_date": 1462053671, "creation_date": 1462053098, "answer_id": 36960661, "question_id": 36960534, "link": "https://stackoverflow.com/questions/36960534/iterating-through-a-list-to-detect-prime-numbers/36960661#36960661", "title": "Iterating through a list to detect prime numbers", "body": "<p>Instead of using a <code>map</code> (I don't think that's possible without doing some pre-processing), you can roll your own function:</p>\n\n<pre><code>sieveWith _  [] = []\nsieveWith ss (x:xs) | any ((==) 0 . mod x) ss = sieveWith ss xs\n                    | otherwise = x : (sieveWith (x:ss) xs)\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>sieve = sieveWith []\n</code></pre>\n\n<p>Now if you call <code>sieve</code>:</p>\n\n<pre><code>*Main&gt; sieve [2,3,4,5,6,7,8,9,10]\n[2,3,5,7]\n</code></pre>\n\n<p>The function works with a variable (the first one) that is passed through the function calls and each time a value is <em>picked</em>, added to the list. A value is picked if <em>no</em> modulo operation on the variable list yields a zero (second guard). In case <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:any\" rel=\"nofollow\"><code>any</code></a> of the <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:mod\" rel=\"nofollow\"><code>mod</code></a>ulo's yields zero, the value is simply omitted.</p>\n"}], "owner": {"reputation": 622, "user_id": 5121373, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/682a61eacb08098831bb8a0e1bdbd9b0?s=128&d=identicon&r=PG&f=1", "display_name": "Tu\u1ea5n Ph\u1ea1m", "link": "https://stackoverflow.com/users/5121373/tu%e1%ba%a5n-ph%e1%ba%a1m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 36960661, "answer_count": 1, "score": 2, "last_activity_date": 1462053671, "creation_date": 1462052255, "last_edit_date": 1462053137, "question_id": 36960534, "link": "https://stackoverflow.com/questions/36960534/iterating-through-a-list-to-detect-prime-numbers", "title": "Iterating through a list to detect prime numbers", "body": "<p>i was given a homework in Haskell in which i should program a module, which helps detect prime numbers from a list, say :</p>\n\n<pre><code>[2,3,4,5,6,7,8,9,10]\n</code></pre>\n\n<p>For the homework, I should iterate through every elements of this list, and eliminate all of it's multiples. Example, I go at number 2, I should eliminate 4,6,8,10. Then go to number 3 and delete 6 and 9, and so on until the end, return the list with prime numbers only.</p>\n\n<p>I have an idea of using function <code>map</code>, but I'm stuck at this place (I'm pretty new to Haskell, though)</p>\n\n<p>Yes, it is my homework, but no, i don't <em>have</em> to do it, it's just practicing. So I'm thankful for any help.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1462048658, "creation_date": 1462048658, "answer_id": 36959994, "question_id": 36959896, "link": "https://stackoverflow.com/questions/36959896/typeclass-declaration-type-mismatch/36959994#36959994", "title": "Typeclass declaration type mismatch", "body": "<p><code>Char</code> here is not the type <code>Char</code>; it is a new data constructor named <code>Char</code>. If you want <code>Cell</code> to be <code>Solid</code>, <code>Blank</code>, or a value of type <code>Char</code>, you need</p>\n\n<pre><code>data Cell = Solid | Blank | Char Char\n\ninstance Show Cel where\n    show Solid = \"X\"\n    show Blank = \"_\"\n    show (Char c) = [c]\n</code></pre>\n\n<p>Some examples:</p>\n\n<pre><code>&gt; show Solid\n\"X\"\n&gt; show Blank\n\"_\"\n&gt; show (Char '4')\n\"4\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6581, "user_id": 461202, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f780ff5bfdfea60bdc260664f00b574?s=128&d=identicon&r=PG", "display_name": "zegkljan", "link": "https://stackoverflow.com/users/461202/zegkljan"}, "is_accepted": false, "score": 0, "last_activity_date": 1462048689, "creation_date": 1462048689, "answer_id": 36960000, "question_id": 36959896, "link": "https://stackoverflow.com/questions/36959896/typeclass-declaration-type-mismatch/36960000#36960000", "title": "Typeclass declaration type mismatch", "body": "<p>Look at the definition of the typeclass <code>Show</code>, mainly at the <code>show</code> function:</p>\n\n<pre><code>class Show a where\n    show      :: a   -&gt; String\n</code></pre>\n\n<p>Now, does your instance for your <code>Cell</code> type satisfy it? The first case, <code>show Solid = \"X\"</code> does - <code>Solid</code> is <code>Cell</code> and <code>\"X\"</code> is a String. The same goes for the second case. But what is the third case? You defined it as <code>show a = [a]</code> so the type signature is <code>Cell -&gt; [Cell]</code> and <code>[Cell]</code> is not a <code>String</code>. Therefore you get a type mismatch.</p>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 3, "last_activity_date": 1462048700, "creation_date": 1462048700, "answer_id": 36960002, "question_id": 36959896, "link": "https://stackoverflow.com/questions/36959896/typeclass-declaration-type-mismatch/36960002#36960002", "title": "Typeclass declaration type mismatch", "body": "<p>You can't make sure that <code>a</code> is a value of type <code>Char</code> because that simply can't be the case. <code>a</code> will always be a value of type <code>Cell</code>, specifically it will be the value <code>Char</code> (which has no relation to the type <code>Char</code>).</p>\n\n<p>What you seem to want is to have <code>Cell</code>'s third constructor contain a value of type <code>Char</code>. To do that your constructor needs a parameter:</p>\n\n<pre><code>data Cell = Solid | Blank | CharCell Char\n\ninstance Show (Cell) where\n    show Solid = \"X\"\n    show Blank  = \"_\"\n    show (CharCell a) = [a]\n</code></pre>\n\n<p>The <code>CharCell a</code> case matches if the constructor <code>CharCell</code> has been used and <code>a</code> will be the value used as <code>CharCell</code>'s parameter (and thus have type <code>Char</code> as that is <code>CharCell</code>'s parameter type).</p>\n"}, {"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": true, "score": 2, "last_activity_date": 1462048901, "creation_date": 1462048901, "answer_id": 36960033, "question_id": 36959896, "link": "https://stackoverflow.com/questions/36959896/typeclass-declaration-type-mismatch/36960033#36960033", "title": "Typeclass declaration type mismatch", "body": "<pre><code>data Cell = Solid | Blank | Char\n</code></pre>\n\n<p>This is a <a href=\"https://en.wikipedia.org/wiki/Tagged_union\" rel=\"nofollow\">tagged union</a>, which means <code>Solid</code>, <code>Blank</code>, and <code>Char</code> are constructor names, not types. For example, <code>Char :: Cell</code>.</p>\n\n<p>I suspect what you meant was something such as this:</p>\n\n<pre><code>data CellType = CellConstructor Char\n\ninstance Show CellType where\n  show (CellConstructor c) = [c]\n</code></pre>\n\n<p>Examples:</p>\n\n<ul>\n<li><code>CellConstructor 'X' :: CellType</code></li>\n<li><code>CellConstructor '_' :: CellType</code></li>\n<li><code>CellConstructor 'a' :: CellType</code></li>\n</ul>\n\n<p>It is customary to give the type and constructor the same name if there is only one constructor.</p>\n\n<pre><code>data Cell = Cell Char\n</code></pre>\n\n<p>If there is only one constructor with only one field then it is customary to use a newtype.</p>\n\n<pre><code>newtype Cell = Cell Char \n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4103174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/852b7dc92795bbacb8be616b7875f1d1?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Riddle", "link": "https://stackoverflow.com/users/4103174/sean-riddle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 36960033, "answer_count": 4, "score": 2, "last_activity_date": 1462048901, "creation_date": 1462048070, "last_edit_date": 1462048256, "question_id": 36959896, "link": "https://stackoverflow.com/questions/36959896/typeclass-declaration-type-mismatch", "title": "Typeclass declaration type mismatch", "body": "<p>I am trying to make my <code>Cell</code> type a member of the <code>Show</code> typeclass. The <code>show a</code> line is problematic. How do I make sure that the <code>a</code> is a <code>Char</code> in that show case? I was hoping the ordering of the statements would just let fallthrough handle it, but that doesn't do it.</p>\n\n<pre><code>data Cell = Solid | Blank | Char\n\ninstance Show (Cell) where\n    show Solid = \"X\"\n    show Blank  = \"_\";\n    show a = [a]\n\nmain = print $ show Solid\n</code></pre>\n"}, {"tags": ["list", "haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6276089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880fcb65e93b783a0cedf1947628d31a?s=128&d=identicon&r=PG&f=1", "display_name": "HaskellDevNoob", "link": "https://stackoverflow.com/users/6276089/haskelldevnoob"}, "edited": false, "score": 0, "creation_date": 1462049722, "post_id": 36959939, "comment_id": 61477717, "body": "Thank you, that was very helpful!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1462048338, "creation_date": 1462048338, "answer_id": 36959939, "question_id": 36959704, "link": "https://stackoverflow.com/questions/36959704/length-of-the-longest-subsequence-in-a-list-of-integers/36959939#36959939", "title": "Length of the longest subsequence in a list of integers", "body": "<p>You can solve this using a technique called <em>accumulators</em>: you call a function together with certain values that are modified along the run. The base-case then returns the result of a function calculated with these <em>accumulators</em>.</p>\n\n<p>For this specific problem we introduce two accumulators: <code>curi</code> and <code>maxi</code>. <code>curi</code> stores the length of the current sequence, and <code>maxi</code> contains the thus far seen maximum incrementing sequence.</p>\n\n<p>The base case is when we reach the end of the list in which case we return the <code>maxi</code>:</p>\n\n<pre><code>maxincsub [] curi maxi = maxi\n</code></pre>\n\n<p>Another base case is when we encounter the very last element. In that case we return the maximum of <code>maxi</code> and <code>curi</code>:</p>\n\n<pre><code>maxincsub [_] curi maxi = max curi maxi\n</code></pre>\n\n<p>The inductive case is when we see two elements in the list: we determine whether <code>a1</code> is an increment of <code>a2</code>. If so, we increment <code>curi</code>. If not, we set <code>curi</code> back to <code>1</code>, but first set <code>maxi</code> to the maximum of <code>maxi</code> this far and <code>curi</code>:</p>\n\n<pre><code>maxincsub (a0:a1:as) curi maxi | a0+1 == a1 = maxincsub (a1:as) (curi+1) maxi\n                               | otherwise = maxincsub (a1:as) 1 (max curi maxi)\n</code></pre>\n\n<p>or putting it all together:</p>\n\n<pre><code>maxincsub [] curi maxi = maxi\nmaxincsub [_] curi maxi = max curi maxi\nmaxincsub (a0:a1:as) curi maxi | a0+1 == a1 = maxincsub (a1:as) (curi+1) maxi\n                               | otherwise = maxincsub (a1:as) 1 (max curi maxi)\n</code></pre>\n\n<p>Finally we need to bind your function <code>incsubseq</code> with our <code>maxincsub</code> by setting initial values for <code>curi</code> and <code>maxi</code>:</p>\n\n<pre><code>incsubseq :: [Int] -&gt; Int\nincsubseq xs = maxincsub xs 1 0\n</code></pre>\n\n<p>Tetsting this with your given input gives:</p>\n\n<pre><code>*Main&gt; incsubseq []\n0\n*Main&gt; incsubseq [5]\n1\n*Main&gt; incsubseq [1,2,3,4,5,6]\n6\n*Main&gt; incsubseq [1,2,3,5,6]\n3\n*Main&gt; incsubseq [5,6,1,2,3]\n3\n*Main&gt; incsubseq [5,6,1,4,3]\n2\n*Main&gt; incsubseq [6,5,4,3,2,1]\n1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6276089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880fcb65e93b783a0cedf1947628d31a?s=128&d=identicon&r=PG&f=1", "display_name": "HaskellDevNoob", "link": "https://stackoverflow.com/users/6276089/haskelldevnoob"}, "edited": false, "score": 0, "creation_date": 1462049748, "post_id": 36960034, "comment_id": 61477723, "body": "Thank you as well!"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 4, "last_activity_date": 1462064825, "last_edit_date": 1462064825, "creation_date": 1462048902, "answer_id": 36960034, "question_id": 36959704, "link": "https://stackoverflow.com/questions/36959704/length-of-the-longest-subsequence-in-a-list-of-integers/36960034#36960034", "title": "Length of the longest subsequence in a list of integers", "body": "<p>You are solving too many problems at the same time - I would try to break the problem down in more understandable steps</p>\n\n<ol>\n<li>create all sequences in the list</li>\n<li>create a new list with their <code>length</code>s using <code>map</code></li>\n<li>find the <code>maximum</code> of the lengths</li>\n</ol>\n\n<p>Now the first part would be easy if your sequences were \"all the same things\" then <code>group</code> from <code>Data.List</code> would be sufficient, but here this is not the case, and unfortunately <code>groupBy (\\x y -&gt; x + 1 == y)</code> which would be exactly what you are looking for - does not work (for technical reasons I do not want to expand).</p>\n\n<p>So first of all you need to implement your own <code>groupBy'</code> function or \"cheat\" and look <a href=\"https://wiki.haskell.org/List_function_suggestions#Generalize_groupBy_and_friends\" rel=\"nofollow\">here</a> where I got</p>\n\n<blockquote class=\"spoiler\">\n  <p><pre><code>\ngroupBy :: (a -> a -> Bool) -> [a] -> [[a]]\ngroupBy rel []          =  []\ngroupBy rel (x:xs)      =  (x:ys) : groupBy rel zs\n   where (ys,zs) = groupByAux x xs\n         groupByAux x0 (x:xs) | rel x0 x = (x:ys, zs)\n           where (ys,zs) = groupByAux x xs\n         groupByAux y xs = ([], xs)</code></pre></p>\n</blockquote>\n\n<p>then you can simply <code>groupBy (\\x y -&gt; x + 1 == y) [1,2,100,101,102]</code></p>\n\n<p>Then the next steps should be manageable.</p>\n\n<p>Note: if you want the longest sequence you can make a shortcut and use <code>maximumBy (compare `on` length)</code>.</p>\n\n<p>Full solution:</p>\n\n<blockquote class=\"spoiler\">\n  <p><pre><code>import Data.Function (on)\nimport Data.List (maximum)\n\nlongestLength :: [Int] -> Int\nlongestLength xx = maximum $ map length $ groupBy' (\\x y -> x + 1 == y) xx\n\ngroupBy = ... -- see above\n</code></pre></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6070464, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fz59LtYRRq0/AAAAAAAAAAI/AAAAAAAAArI/y2xOfIW7WYI/photo.jpg?sz=128", "display_name": "bbyalcinkaya", "link": "https://stackoverflow.com/users/6070464/bbyalcinkaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1462061434, "creation_date": 1462061434, "answer_id": 36961607, "question_id": 36959704, "link": "https://stackoverflow.com/questions/36959704/length-of-the-longest-subsequence-in-a-list-of-integers/36961607#36961607", "title": "Length of the longest subsequence in a list of integers", "body": "<p>You can use folding functions for this kind of recursive functions. </p>\n\n<p>This might not be idiomatic but here is my version using foldl.  </p>\n\n<pre><code>incsubseq [] = 0\nincsubseq (x:xs) = (\\(a,_,_)-&gt;a) $ foldl update (1,1,x) xs\n    where\n        update (maxn,n,h) x\n            | h+1 /= x      = (maxn, 1, x)\n            | n+1 &gt; maxn    = (n+1, n+1, x)\n            | otherwise     = (maxn, n+1, x)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6276089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880fcb65e93b783a0cedf1947628d31a?s=128&d=identicon&r=PG&f=1", "display_name": "HaskellDevNoob", "link": "https://stackoverflow.com/users/6276089/haskelldevnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 816, "favorite_count": 0, "accepted_answer_id": 36959939, "answer_count": 3, "score": 2, "last_activity_date": 1462064825, "creation_date": 1462046985, "last_edit_date": 1462048529, "question_id": 36959704, "link": "https://stackoverflow.com/questions/36959704/length-of-the-longest-subsequence-in-a-list-of-integers", "title": "Length of the longest subsequence in a list of integers", "body": "<p>I want to get good at functional programming so I set myself some tasks.</p>\n\n<p>I want to determine the <strong>length</strong> of the longest subsequence in a list of integers, where the <strong>next element</strong> is <strong>incremented by 1</strong>.</p>\n\n<p>So the result should be </p>\n\n<pre><code>incsubseq [] ~?= 0,\nincsubseq [5] ~?= 1,\nincsubseq [1,2,3,5,6] ~?= 3,\nincsubseq [5,6,1,2,3] ~?= 3,\nincsubseq [5,6,1,4,3] ~?= 2,\nincsubseq [6,5,4,3,2,1] ~?= 1]\n</code></pre>\n\n<p>My try was this:</p>\n\n<pre><code>incsubseq :: [Int] -&gt; Int\nincsubseq [] = 0\nincsubseq [_] = 1\nincsubseq (a:b)\n          | a == ((head b)-1) = 1 + (incsubseq b)\n          | a /= ((head b)-1) = (incsubseq b)\n</code></pre>\n\n<p>But of course this only works for lists that don't have a longer subsequence e.g. [<strong>1,2,3</strong>,42] = <strong>3</strong>, but not for lists like [1,2,<strong>100,101,102</strong>] which should  be 3 but is <strong>NOT</strong> (It's 2)!</p>\n\n<p>I would really, really appreciate your help since this problem drives me crazy, coming from OO- Programming.</p>\n"}, {"tags": ["regex", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 4145326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c09bf45733fd2465f3c6173a03e930?s=128&d=identicon&r=PG", "display_name": "Kiraa", "link": "https://stackoverflow.com/users/4145326/kiraa"}, "edited": false, "score": 0, "creation_date": 1462048673, "post_id": 36959976, "comment_id": 61477437, "body": "Thank you, this works as expected. Is there a library that supports <code>\\w</code>?"}, {"owner": {"reputation": 10272, "user_id": 1996394, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bb7cf5d8bf03c5335a0ece8f6673541d?s=128&d=identicon&r=PG", "display_name": "rock321987", "link": "https://stackoverflow.com/users/1996394/rock321987"}, "reply_to_user": {"reputation": 363, "user_id": 4145326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c09bf45733fd2465f3c6173a03e930?s=128&d=identicon&r=PG", "display_name": "Kiraa", "link": "https://stackoverflow.com/users/4145326/kiraa"}, "edited": false, "score": 0, "creation_date": 1462159353, "post_id": 36959976, "comment_id": 61504558, "body": "@Kiraa well I am not right one to answer this because I know nothing about haskell.. I answered it just for sake of regex.."}], "tags": [], "owner": {"reputation": 10272, "user_id": 1996394, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bb7cf5d8bf03c5335a0ece8f6673541d?s=128&d=identicon&r=PG", "display_name": "rock321987", "link": "https://stackoverflow.com/users/1996394/rock321987"}, "is_accepted": true, "score": 3, "last_activity_date": 1462049873, "last_edit_date": 1462049873, "creation_date": 1462048544, "answer_id": 36959976, "question_id": 36959605, "link": "https://stackoverflow.com/questions/36959605/haskell-regex-behaves-unexpectedly/36959976#36959976", "title": "Haskell regex behaves unexpectedly", "body": "<p>I am not sure but <code>\\w</code> seems to be not supported by tdfa. When I used <code>[A-Za-z0-9]</code>, the output is correct</p>\n\n<pre><code>Prelude RX&gt; \"google.com\" RX.=~ \"[A-Za-z0-9]+\\\\.[A-Za-z0-9]+$\" :: Bool\nTrue\n</code></pre>\n\n<p><code>\\\\w</code> is treated as character <code>w</code> literally <code>\\\\d</code> is treated as character <code>d</code> literally.   </p>\n\n<p>Following are notations that can be used for this package (typical DFA engine behavior. <em>NOTE</em> :- This engine is also DFA based)</p>\n\n<pre><code>[[:digit:]] - Digits ([0-9])\n[[:alpha:]] - Alphabets ([A-Za-z])\n[[:alnum:]] - Alphanumeric ([A-Za-z0-9])\n</code></pre>\n\n<p>So, you can also use</p>\n\n<pre><code>Prelude RX&gt; \"www.www\" RX.=~ \"[[:alnum:]]+\\\\.[[:alnum:]]+$\" :: Bool\nTrue\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6167, "user_id": 244811, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xVPtR.jpg?s=128&g=1", "display_name": "Scott Weaver", "link": "https://stackoverflow.com/users/244811/scott-weaver"}, "is_accepted": false, "score": 3, "last_activity_date": 1462059334, "last_edit_date": 1462059334, "creation_date": 1462050198, "answer_id": 36960229, "question_id": 36959605, "link": "https://stackoverflow.com/questions/36959605/haskell-regex-behaves-unexpectedly/36960229#36960229", "title": "Haskell regex behaves unexpectedly", "body": "<p>I believe that package uses POSIX Extended Regular expressions. Which means, like rock321987 observes, that <code>\\w</code> or <code>\\d</code> sequences used in perl/pcre <a href=\"http://www.regular-expressions.info/posix.html\" rel=\"nofollow\">are not supported</a>, and functionality relative to today's powerful regex engines is very limited.</p>\n\n<p>Posix ERE does provide some <a href=\"http://www.regular-expressions.info/posixbrackets.html\" rel=\"nofollow\">built-in, weird looking character classes</a>, like <code>[:alnum:]</code> which is equivalent to <code>[A-Za-z0-9]</code>.</p>\n\n<p>It's hard to find truly concise information, but to sum up the information presented <a href=\"http://www.regular-expressions.info/\" rel=\"nofollow\">here</a>, this is what you get with POSIX ERE:</p>\n\n<ul>\n<li>character classes, more or less, using <code>[]</code> brackets including the 12 built-ins like <code>[:alnum:]</code> (alphanumerics) and <code>[:alpha:]</code> (alphabet letters)</li>\n<li>dot <code>.</code> - matches anything</li>\n<li>start and end of string anchors <code>^</code> and <code>$</code></li>\n<li>star <code>*</code> - repeat preceding zero or more times </li>\n<li>The quantifiers <code>?</code>, <code>+</code>, <code>{n}</code>, <code>{n,m}</code> and<code>{n,}</code> - repeat the\npreceding token zero or once, once or more, n times, between n and m\ntimes, and n or more times, respectively</li>\n<li>alternation with the pipe <code>|</code></li>\n</ul>\n\n<p>...and that's basically it.</p>\n"}], "owner": {"reputation": 363, "user_id": 4145326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c09bf45733fd2465f3c6173a03e930?s=128&d=identicon&r=PG", "display_name": "Kiraa", "link": "https://stackoverflow.com/users/4145326/kiraa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 36959976, "answer_count": 2, "score": 1, "last_activity_date": 1462059334, "creation_date": 1462046447, "question_id": 36959605, "link": "https://stackoverflow.com/questions/36959605/haskell-regex-behaves-unexpectedly", "title": "Haskell regex behaves unexpectedly", "body": "<p>At first I should say that my regex knowlege is <a href=\"https://regex101.com\" rel=\"nofollow\">https://regex101.com</a> - compilant. I don't know if I'm getting wrong the haskell part or the regex part:</p>\n\n<p>I'm trying to use regex to match out domain of a website (stackoverflow.com out of meta.stackoverflow.com). For demo, I'm using simple regex \"[\\w]+.[\\w]+$\" which behaves correctly at <a href=\"https://regex101.com\" rel=\"nofollow\">https://regex101.com</a>. However, in haskell:</p>\n\n<pre><code>\u03bb&gt; import qualified Text.Regex.TDFA as RX\n\u03bb&gt; \"google.com\" RX.=~ \"[\\\\w]+\\\\.[\\\\w]+$\" :: String\n\"\"\n\u03bb&gt; \"google.com\" RX.=~ \"[\\\\w]+\\\\.[\\\\w]+$\" :: Bool\nFalse\n</code></pre>\n\n<p>What is causing this behavior and how can I fix it?</p>\n\n<p>GHCI version is 7.10.3,\nregex-tdfa version is 1.2.1</p>\n"}, {"tags": ["json", "haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462039601, "post_id": 36958287, "comment_id": 61474409, "body": "Aside from your problem I would advise you to use <code>Maybe Int</code> as a result type and not use the magic value <code>-1</code> for &quot;not-found&quot;. Also <code>JObject (Map String JValue</code> would be a better choice instead, you get the whole bunch of <code>Map</code> functions! And at last your function is partial you need to take account of <code>JValue</code>s other than <code>JObject</code>, the easiest solution would be using <code>getPosition _ x _ = error $ &quot;Error: expected JObject in getPosition but got: &quot; ++ show x</code> which is still a partial function but the error message is better."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1462040115, "post_id": 36958287, "comment_id": 61474597, "body": "Even if a valid position must be a positive integer, it&#39;s better to be explicit about whether you found the string or not by returning a <code>Maybe Int</code> instead of an <code>Int</code>, in which case you return <code>Nothing</code> if the string is not found, and <code>Just x</code> if it is found at position <code>x</code>."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462065127, "post_id": 36958287, "comment_id": 61480738, "body": "Btw. unless you are doing this for learning purposes, use <a href=\"https://hackage.haskell.org/package/aeson\" rel=\"nofollow noreferrer\"><code>aeson</code></a> instead of writing your own JSON-library"}], "answers": [{"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 3, "last_activity_date": 1462039536, "last_edit_date": 1462039536, "creation_date": 1462039220, "answer_id": 36958339, "question_id": 36958287, "link": "https://stackoverflow.com/questions/36958287/haskell-couldnt-match-expected-type-jvalue-with-actual-type-string-jvalu/36958339#36958339", "title": "Haskell - Couldn&#39;t match expected type \u2018JValue\u2019 with actual type \u2018[(String,JValue)]\u2019", "body": "<p>In the 2nd argument of the last clause, you pattern match against a list <code>(x:xs)</code>, but there must be a <code>JValue</code>.</p>\n\n<p>When you want to find the index in a list, use <code>findIndex</code> from <code>Data.List</code></p>\n\n<pre><code>getPosition word (JObject tuples) =\n       findIndex (\\(name,_) -&gt; name == word) tuples\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6275771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa82486eaf40114bedc0e8ba482e1f2?s=128&d=identicon&r=PG&f=1", "display_name": "GiaccomoU", "link": "https://stackoverflow.com/users/6275771/giaccomou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 36958339, "answer_count": 1, "score": 0, "last_activity_date": 1462045475, "creation_date": 1462038912, "last_edit_date": 1462045475, "question_id": 36958287, "link": "https://stackoverflow.com/questions/36958287/haskell-couldnt-match-expected-type-jvalue-with-actual-type-string-jvalu", "title": "Haskell - Couldn&#39;t match expected type \u2018JValue\u2019 with actual type \u2018[(String,JValue)]\u2019", "body": "<p>I'm new to Haskell and I have a problem with <code>JValue</code>, I previously defined it as:</p>\n\n<pre><code>data JValue = \n    JString String\n    | JNumber Double\n    | JBool Bool\n    | JNull \n    | JObject [(String, JValue)]\n    | JArray [JValue]\n</code></pre>\n\n<p>And I'm trying to make a function </p>\n\n<pre><code>getPosition :: String -&gt; JValue -&gt; Int -&gt; Int\ngetPosition _ (JObject []) _ = -1\ngetPosition word (JObject [(name,_)]) index\n    | stringsAreEqual word name = index\n    | otherwise = -1\ngetPosition word (x:xs) index = getPosition word xs (index+1)\n</code></pre>\n\n<p>that is intended to find the index of a tuple in a <code>JObject</code> that has the same string as the one in the arguments. I'm getting this error:</p>\n\n<pre><code>Couldn't match expected type \u2018with actual type \u2018[(String, JValue)]\u2019\n</code></pre>\n\n<p>What am I doing wrong? I may be complicating myself too much. Thanks</p>\n"}, {"tags": ["python", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 1022, "user_id": 5105207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd8f2464a13b90c1abf929d3e8624ad7?s=128&d=identicon&r=PG", "display_name": "Page David", "link": "https://stackoverflow.com/users/5105207/page-david"}, "edited": false, "score": 0, "creation_date": 1462026528, "post_id": 36955944, "comment_id": 61469775, "body": "That is very clear, but I can not understand how the <b>iteration</b> performed in this code. Could you make an explain?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1022, "user_id": 5105207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd8f2464a13b90c1abf929d3e8624ad7?s=128&d=identicon&r=PG", "display_name": "Page David", "link": "https://stackoverflow.com/users/5105207/page-david"}, "edited": false, "score": 0, "creation_date": 1462026635, "post_id": 36955944, "comment_id": 61469798, "body": "@DavidPage: In python you can use the <code>yield</code> keyword to describe a generator. Python sees this as a <i>continuation</i>: if you ask for the first element it will process until it hits the first <code>yield</code> statement, and then suspend execution of the method. If you later ask the next element, it will again process and suspend after it has yielded the second element, and so on."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1462026049, "last_edit_date": 1495540361, "creation_date": 1462025729, "answer_id": 36955944, "question_id": 36955891, "link": "https://stackoverflow.com/questions/36955891/convert-a-haskell-code-to-python-or-pseudocode/36955944#36955944", "title": "Convert a Haskell code to Python or pseudocode", "body": "<p><code>lfts</code> is indeed a (lazy) generator which is more or less equivalent to:</p>\n\n<pre><code>def lfts () :\n    k = 1\n    while True :\n        yield (k,4*k+2,0,2*k+1)\n        k += 1\n</code></pre>\n\n<p>This is because <code>[1..]</code> is an infinite list of incrementing integers starting from <code>1</code>. Now <code>k &lt;- [1..]</code> means that <code>k</code> each time picks the next value in the list, and you <code>yield</code> the thing at the left of the list comprehension.</p>\n\n<p>It is thus a generator that will generate an <em>infinite</em> list, therefore you cannot simply call <code>list()</code> or <code>len()</code> onto it.</p>\n\n<hr>\n\n<p>You can also use <a href=\"http://docs.python.org/library/itertools.html#itertools.count\" rel=\"nofollow noreferrer\"><code>count</code></a> from <code>itertools</code> to produce a oneliner:</p>\n\n<pre><code>((k,4*k+2,0,2*k+1) for k in itertools.count(1))\n</code></pre>\n\n<p>You can then take for instance the first five elements using <a href=\"https://stackoverflow.com/a/5234170/67579\"><code>itertools.islice</code></a>:</p>\n\n<pre><code>&gt;&gt;&gt; list(itertools.islice(((k,4*k+2,0,2*k+1) for k in itertools.count(1)), 0, 5))\n[(1, 6, 0, 3), (2, 10, 0, 5), (3, 14, 0, 7), (4, 18, 0, 9), (5, 22, 0, 11)]\n</code></pre>\n\n<p>Since the generator can generate elements until the end of times, you can easily take an arbitrary amount of elements (above five, but twenty is evidently an option as well).</p>\n"}, {"tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 5, "last_activity_date": 1462027007, "last_edit_date": 1462027007, "creation_date": 1462026650, "answer_id": 36956116, "question_id": 36955891, "link": "https://stackoverflow.com/questions/36955891/convert-a-haskell-code-to-python-or-pseudocode/36956116#36956116", "title": "Convert a Haskell code to Python or pseudocode", "body": "<p>First of all the <code>lfts</code> is an infinite list. You can write very similar code using <a href=\"https://docs.python.org/3.5/library/itertools.html#itertools.count\" rel=\"noreferrer\"><code>itertools.count</code></a>:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from itertools import count\n\n# count(1) is \"equivalent2 to [1..]\nlfts = ((k, 4*k+2, 0, 2*k+1) for k in count(1))\n</code></pre>\n\n<p>Now the important thing of the code is the call to <code>stream</code> which is a function that \"performs the loop\". That function is defined in the article as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; stream :: (b-&gt;c) -&gt; (b-&gt;c-&gt;Bool) -&gt; (b-&gt;c-&gt;b) -&gt; (b-&gt;a-&gt;b) -&gt;\n&gt;           b -&gt; [a] -&gt; [c]\n&gt; stream next safe prod cons z (x:xs)\n&gt;   = if   safe z y\n&gt;     then y : stream next safe prod cons (prod z y) (x:xs)\n&gt;     else stream next safe prod cons (cons z x) xs\n&gt;       where y = next z\n</code></pre>\n\n<p>The idea of <code>stream</code> is that:</p>\n\n<ul>\n<li>The last argument (<code>x:xs</code>) is an (infinite) input list (of type <code>[a]</code>)</li>\n<li>The one-to-last argument (<code>z</code>) is some form of <em>state</em> (of type <code>b</code>)</li>\n<li><p>The other four arguments are functions that manipulate inputs and state:</p>\n\n<ul>\n<li>The <code>next</code> function takes a state and produces an output (<code>y</code>).</li>\n<li>The <code>safe</code> function checks whether <code>y</code> should be added in the output or not</li>\n<li>The <code>prod</code> function produces the new state</li>\n<li>The <code>cons</code> function is called when the <code>y</code> value is <em>not</em> added to the output and is used to produce the new state from the input value <code>x</code>.</li>\n</ul></li>\n</ul>\n\n<p>You can reproduce such a function as:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import itertools as it\n\ndef stream(nxt, safe, prod, cons, state, inputs):\n    x = next(inputs)   # obtain x\n    # xs = inputs\n    y = nxt(state)\n    if safe(state, y):\n        yield y\n        inputs = it.chain([x], inputs)   # put x back in the input\n        yield from stream(nxt, safe, prod, cons, prod(state, y), inputs)\n    else:\n        yield from stream(nxt, safe, prod, cons, cons(state, x), inputs)\n</code></pre>\n\n<p>So basically what this does is that it yields some values starting from a certain state. When it reaches a certain condition it consume an input value to produce a new state and yield more values, when it stops again it will use an other input value to produce a new state again etc. Ad infinitum.</p>\n\n<p>Note that the above implementation will have really bad performance. It's better to avoid recursion in python so I'd use:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def stream(nxt, safe, prod, cons, state, inputs):\n    while True:\n        x = next(inputs)   # obtain x\n        # xs = inputs\n        y = nxt(state)\n        if safe(state, y):\n            yield y\n            inputs = it.chain([x], inputs)   # put x back in the input\n            state = prod(state, y)\n        else:\n            state = cons(state, x)\n</code></pre>\n"}], "owner": {"reputation": 1022, "user_id": 5105207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd8f2464a13b90c1abf929d3e8624ad7?s=128&d=identicon&r=PG", "display_name": "Page David", "link": "https://stackoverflow.com/users/5105207/page-david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1236, "favorite_count": 1, "accepted_answer_id": 36956116, "answer_count": 2, "score": 6, "last_activity_date": 1462027068, "creation_date": 1462025321, "last_edit_date": 1462027068, "question_id": 36955891, "link": "https://stackoverflow.com/questions/36955891/convert-a-haskell-code-to-python-or-pseudocode", "title": "Convert a Haskell code to Python or pseudocode", "body": "<p>I am working on <a href=\"https://www.cs.ox.ac.uk/jeremy.gibbons/publications/spigot.pdf\" rel=\"nofollow\">an algorithm</a>. But I am not very clear on the haskell code provide by the author, so I need you guys' help.\nThe codes can split into two parts, I think.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; type LFT = (Integer, Integer, Integer, Integer)\n&gt;\n&gt; extr :: LFT -&gt; Integer -&gt; Rational\n&gt; extr (q,r,s,t) x = ((fromInteger q) * x + (fromInteger r)) / ((fromInteger s) * x + (fromInteger t))\n&gt;\n&gt; unit :: LFT\n&gt; unit = (1,0,0,1)\n&gt;\n&gt; comp :: LFT -&gt; LFT -&gt; LFT\n&gt; comp (q,r,s,t) (u,v,w,x) = (q*u+r*w,q*v+r*x,s*u+t*w,s*v+t*x)\n</code></pre>\n\n<p>Here, very clearly, a type called LFT (may be a tuple in Python) and three function called <code>extr unit comp</code> be defined.However, the next part puzzled me a lot:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; pi = stream next safe prod cons init lfts where\n&gt;   init = unit\n&gt;   lfts = [(k, 4*k+2, 0, 2*k+1) | k&lt;-[1..]]\n&gt;   next z = floor (extr z 3)\n&gt;   safe z n = (n == floor (extr z 4))\n&gt;   prod z n = comp (10, -10*n, 0, 1) z\n&gt;   cons z z\u2019 = comp z z\u2019\n</code></pre>\n\n<p>I believe <code>lfts</code> is a generator but I am failed to understand how the loop performed in this code and I do not know much about the Haskell. Can you help me convert this one to Python or a pseudocode?</p>\n"}]