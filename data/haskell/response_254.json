[{"tags": ["haskell", "typeclass", "dependent-type", "type-families", "type-level-computation"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1574303636, "post_id": 58964935, "comment_id": 104187655, "body": "Side note: The syntax <code>*</code> is deprecated. <code>import Data.Kind</code> and use <code>Type</code> instead."}, {"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1574306477, "post_id": 58964935, "comment_id": 104188287, "body": "@HTNW Thanks!  I usually do, I just wanted minimal dependencies for my example.  I&#39;ve changed it though since it is clearer."}], "answers": [{"tags": [], "owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "is_accepted": false, "score": 2, "last_activity_date": 1574350989, "last_edit_date": 1574350989, "creation_date": 1574317234, "answer_id": 58968451, "question_id": 58964935, "link": "https://stackoverflow.com/questions/58964935/how-can-i-combine-this-closed-type-family-with-a-dependent-type-class/58968451#58968451", "title": "How can I combine this closed type family with a dependent type class", "body": "<h2>What do we want?</h2>\n\n<p>In order to solve this we can first break down what it is that we want.</p>\n\n<p>We want the \"falling through\" of behavior of a closed type family (so that functions and non-functions will match different instances) but we also want to construct data like a type class (so we can get <code>refunct</code>).</p>\n\n<p>That is we want a type class with the logic of a close type family.  So in order to do that we can just separate the two parts and implement them separately; the logic as a closed type family and the rest as a type class.</p>\n\n<p>Now to do that we take our type family and we add another paramenter</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class\n  Foo\n    (bar :: Type)\n    (baz :: Type)\n    (bax :: Type)\n</code></pre>\n\n<p>becomes</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class\n  Foo'\n    (flag :: Flag)\n    (bar :: Type)\n    (baz :: Type)\n    (bax :: Type)\n</code></pre>\n\n<p>This parameter will act as a flag to tell us which instance to use.  Since it is of kind <code>Flag</code> we need to make that datatype.  It should have a constructor for every instance (we can be a little loose with this in some cases but in general you would want one to one)</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Flag = Instance1 | Instance2 | Instance3 ...\n</code></pre>\n\n<p><sup>(In the case of my issue since there are only two instances we use <code>Bool</code>)</sup></p>\n\n<p>Now we build a closed type family which calculates which instance to match.  It should take the relevant arguments from the parameters of <code>Foo</code> and produce a <code>Flag</code>  </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type family\n  FooInstance\n    (bar :: Type)\n    (baz :: Type)\n    (bax :: Type)\n      :: Flag\n  where\n    FooInstance ... = Instance1\n    FooInstance ... = Instance2\n    FooInstance ... = Instance3\n    ...\n</code></pre>\n\n<p><sup>In the case of the question at hand we call this <code>IsAtomic</code> since that name is descriptive as to what it does.</sup></p>\n\n<p>Now we modify our instances to match the correct <code>Flag</code>s.  This is pretty simple we just add the instance flag to the declaration:</p>\n\n<pre><code>instance\n  ( Foo newBar newBaz newBax\n  ...\n  )\n    =&gt; Foo' 'Instance3 foo bar baz bax\n  where\n    ...\n</code></pre>\n\n<p>Importantly we do <em>not</em> change recursive calls to <code>Foo</code> to calls to <code>Foo'</code>. We are about to build <code>Foo</code> as a wrapper around <code>Foo'</code> that manages our closed type family (<code>FooInstance</code> in this case) so we want to call the <code>Foo</code> to avoid envoking the same logic every time.</p>\n\n<p>That is built like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class\n  Foo\n    (bar :: Type)\n    (baz :: Type)\n    (bax :: Type)\n  where\n    ...\ninstance\n  ( Foo' (FooInstance bar baz bax) bar baz bax\n  )\n    =&gt; Foo bar baz bax\n  where\n    ...\n</code></pre>\n\n<p>If we want to be extra safe we can add a line to each <code>Foo'</code> instance to check that it is being called correctly:</p>\n\n<pre><code>instance\n  ( Foo newBar newBaz newBax\n  , FooInstance bar baz baz ~ 'Instance3\n  ...\n  )\n    =&gt; Foo' 'Instance3 bar baz bax\n  where\n    ...\n</code></pre>\n\n<h2>My solution</h2>\n\n<p>So now we use this strategy on the specific question at hand.\nHere is the code in full.  The relevant class is <code>SeparateArgs</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type family\n  IsAtomic\n    ( a :: Type )\n      :: Bool\n  where\n    IsAtomic (a -&gt; b) = 'False\n    IsAtomic a = 'True\n\nclass\n  SeparateArgs\n    (args :: [Type])\n    (goal :: Type)\n    (newSig :: Type)\n  | args goal -&gt; newSig\n  , newSig -&gt; args goal\n  where\n    refunct :: (HList args -&gt; goal) -&gt; newSig\n\ninstance\n  ( IsAtomic newSig ~ isAtomic -- For (possible? compilation time) speedup\n  , SeparateArgs' isAtomic args goal newSig\n  )\n    =&gt; SeparateArgs args goal newSig\n  where\n    refunct = refunct' @isAtomic\n\nclass\n  SeparateArgs'\n    (isAtomic :: Bool)\n    (args :: [Type])\n    (goal :: Type)\n    (newSig :: Type)\n  | args goal -&gt; newSig isAtomic\n  , newSig isAtomic -&gt; args goal\n  where\n    refunct' :: (HList args -&gt; goal) -&gt; newSig\ninstance\n  ( IsAtomic goal ~ 'True -- Only exists to ensure we are not invoking this in an illegal manner\n  )\n    =&gt; SeparateArgs' 'True '[] goal goal\n  where\n    refunct' makeA = makeA HNil\ninstance\n  ( IsAtomic (headArg -&gt; c) ~ 'False -- Only exists to ensure we are not invoking this in an illegal manner\n  , SeparateArgs tailArgs goal c\n  )\n    =&gt; SeparateArgs' 'False (headArg ': tailArgs) goal (headArg -&gt; c)\n  where\n    refunct' hFunct x = refunct $ hFunct . (x :&gt;)\n</code></pre>\n"}], "owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "answer_count": 1, "score": 7, "last_activity_date": 1574350989, "creation_date": 1574292271, "last_edit_date": 1574307708, "question_id": 58964935, "link": "https://stackoverflow.com/questions/58964935/how-can-i-combine-this-closed-type-family-with-a-dependent-type-class", "title": "How can I combine this closed type family with a dependent type class", "body": "<h2>My issue</h2>\n\n<p>I have the following type family that splits arguments off of a function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type family\n  SeparateArgs\n    ( a :: Type )\n      :: ( Type, [Type] )\n  where\n    SeparateArgs (a -&gt; b) =\n      SndCons2 a (SeparateArgs b)\n    SeparateArgs a =\n      '(a, '[])\n</code></pre>\n\n<p>I also have this typeclass to do the reverse:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Refunct args goal newSig | args goal -&gt; newSig where\n  refunct :: (HList args -&gt; goal) -&gt; newSig\ninstance Refunct '[] goal goal where\n  refunct makeA = makeA HNil\ninstance\n  ( Refunct tailArgs goal c\n  )\n    =&gt; Refunct (headArg ': tailArgs) goal (headArg -&gt; c)\n  where\n    refunct hFunct x = refunct $ hFunct . (x :&gt;)\n</code></pre>\n\n<p>Now pretty much every time I use these two, I use them together like the following:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance\n  ( SeparateArgs a ~ '(goal, args)\n  , Refunct goal args a\n  , ...\n  )\n    =&gt; ...\n</code></pre>\n\n<p>This is so I can break off the arguments, do some processing to create a function of the type <code>HList args -&gt; goal</code> and then turn it back into a regular function.</p>\n\n<p>This works but it is pretty frustrating since I know that <code>Separate a ~ '(goal, args) =&gt; Refunct args goal a</code>, meaning that only one of these statements is needed.  However the compiler can't tell that so I need to inform it.</p>\n\n<p>It is of course not critical, since my code currently works, but I would like to roll it into one  statement.  Ideally by adding a second functional dependency to <code>Refunct</code> like so:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class\n  ( SeparateArgs newSig ~ '(goal, args)\n  )\n    =&gt; Refunct args goal newSig\n  | args goal -&gt; newSig\n  , newSig -&gt; args goal\n  where\n    refunct :: (HList args -&gt; goal) -&gt; newSig\n</code></pre>\n\n<p>(Of course this does not work on it's own)</p>\n\n<p>Is there a way to reduce the two (the type family <code>SeparateArgs</code> and the type class <code>Refunct</code>) into a single constraint?  I am still willing to define additional constructs I would just like to have non-redundant constraints in the result.  I will still need the <code>refunct</code> function.</p>\n\n<p>If it is needed here is my implementation of <code>HList</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data HList (a :: [ Type ]) where\n  HNil :: HList '[]\n  (:&gt;) :: a -&gt; HList b -&gt; HList (a ': b)\n\nhHead :: HList (a ': b) -&gt; a\nhHead (a :&gt; _) = a\n\nhTail :: HList (a ': b) -&gt; HList b\nhTail (_ :&gt; b) = b\n</code></pre>\n\n<h2>What I have tried</h2>\n\n<p>After discussing this elsewhere it was suggested I try:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type family\n  IsAtomic\n    ( a :: Type )\n      :: Bool\n  where\n    IsAtomic (a -&gt; b) = 'False\n    IsAtomic a = 'True\n\nclass\n  Refunct args goal newSig\n  | args goal -&gt; newSig\n  , newSig -&gt; args goal\n  where\n    refunct :: (HList args -&gt; goal) -&gt; newSig\ninstance\n  ( IsAtomic goal ~ 'True\n  )\n    =&gt;  Refunct '[] goal goal\n  where\n  refunct makeA = makeA HNil\ninstance\n  ( Refunct tailArgs goal c\n  , IsAtomic (headArg -&gt; c) ~ 'False\n  )\n    =&gt; Refunct (headArg ': tailArgs) goal (headArg -&gt; c)\n  where\n    refunct hFunct x = refunct $ hFunct . (x :&gt;)\n</code></pre>\n\n<p>Here we add an additional constrain that the first instance only works if <code>IsAtomic goal ~ 'True</code> and the second only if <code>IsAtomic goal ~ 'False</code> where <code>IsAtomic</code> is a type family I've defined which is <code>'False</code> on functions and <code>'True</code> on everything else.</p>\n\n<p>Here the compiler seems to be unable to confirm that the two instances do not violate the functional dependency.  The exact error is:</p>\n\n<pre><code>    Functional dependencies conflict between instance declarations:\n      instance (IsAtomic goal ~ 'True) =&gt; Refunct '[] goal goal\n      instance (Refunct tailArgs goal c, IsAtomic goal ~ 'False) =&gt;\n               Refunct (headArg : tailArgs) goal (headArg -&gt; c)\n    |\nXXX |   ( IsAtomic goal ~ 'True\n    |   ^^^^^^^^^^^^^^^^^^^^^^^...\n</code></pre>\n\n<p>(ok it's not exact since I have removed all identifying info).</p>\n\n<p>My intuition here is that it is not aware that <code>IsAtomic goal ~ 'True</code> and <code>IsAtomic goal ~ 'False</code> cannot both be true at the same time.  This is reasonable since without inspection, we cannot know <code>IsAtomic</code> is not <code>forall a. a</code> which does satisfy both constraints.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1574287452, "post_id": 58963745, "comment_id": 104183238, "body": "Are you planning on having lists with more than three <code>(Rotor, Int)</code> pairs? If not, there&#39;s nothing to gain by using recursion (which is what you would use to process lists of arbitrary length)."}, {"owner": {"reputation": 47, "user_id": 12209662, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa9GXoGKFuZNsdDoUpFdfzSQtMrrRNv7J4MiJ9=k-s128", "display_name": "G TTT", "link": "https://stackoverflow.com/users/12209662/g-ttt"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574287995, "post_id": 58963745, "comment_id": 104183456, "body": "@chepner yeah, just three pairs"}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "edited": false, "score": 0, "creation_date": 1574288766, "post_id": 58963745, "comment_id": 104183732, "body": "You are doing different things to each tuple so it does not really make sense to use recursion. If you were applying the same operations to each tuple then it would be useful."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1574290947, "post_id": 58963745, "comment_id": 104184508, "body": "You should use a type that represents exactly 3 such pairs, then; e.g. <code>data Foo = Foo (Rotor, Int) (Rotor, Int) (Rotor, Int)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574287608, "post_id": 58964053, "comment_id": 104183304, "body": "This is not quite equivalent (though it&#39;s not clear if the OP is <i>looking</i> for something equivalent). This will update, say, <code>(b, 23)</code> to <code>(b, 24)</code> even if <code>a != 25</code>."}, {"owner": {"reputation": 362, "user_id": 4762234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880403468672301/picture?type=large", "display_name": "Yogendra", "link": "https://stackoverflow.com/users/4762234/yogendra"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574287924, "post_id": 58964053, "comment_id": 104183435, "body": "@chepner if <code>a != 25</code>, <code>(a,x+1)</code> is appended to rest of list without any recursive call hence <code>(b,23)</code> won&#39;t be updated to <code>(b,24)</code>. I tested it in ghci and it works as expected"}, {"owner": {"reputation": 362, "user_id": 4762234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880403468672301/picture?type=large", "display_name": "Yogendra", "link": "https://stackoverflow.com/users/4762234/yogendra"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574291132, "post_id": 58964053, "comment_id": 104184591, "body": "Sorry, yes.I  Corrected it. I used different name in ghci and made mistake while copying."}, {"owner": {"reputation": 47, "user_id": 12209662, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa9GXoGKFuZNsdDoUpFdfzSQtMrrRNv7J4MiJ9=k-s128", "display_name": "G TTT", "link": "https://stackoverflow.com/users/12209662/g-ttt"}, "edited": false, "score": 0, "creation_date": 1574558993, "post_id": 58964053, "comment_id": 104275223, "body": "this nested rucursion really enlighten me! Thanks a lot"}], "tags": [], "owner": {"reputation": 362, "user_id": 4762234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880403468672301/picture?type=large", "display_name": "Yogendra", "link": "https://stackoverflow.com/users/4762234/yogendra"}, "is_accepted": true, "score": 3, "last_activity_date": 1574291089, "last_edit_date": 1574291089, "creation_date": 1574287290, "answer_id": 58964053, "question_id": 58963745, "link": "https://stackoverflow.com/questions/58963745/recursion-over-tuples-list-in-haskell/58964053#58964053", "title": "recursion over tuples list in haskell", "body": "<p>I think this should work</p>\n\n<pre><code>updateOs2 [] = []\nupdateOs2 ((a,x):xs)\n    | x == 25 = (a,0): (updateOs2 xs)\n    | otherwise =  (a,x+1):xs\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 12209662, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa9GXoGKFuZNsdDoUpFdfzSQtMrrRNv7J4MiJ9=k-s128", "display_name": "G TTT", "link": "https://stackoverflow.com/users/12209662/g-ttt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 58964053, "answer_count": 1, "score": 2, "last_activity_date": 1574291089, "creation_date": 1574285751, "last_edit_date": 1574286513, "question_id": 58963745, "link": "https://stackoverflow.com/questions/58963745/recursion-over-tuples-list-in-haskell", "title": "recursion over tuples list in haskell", "body": "<p>Is there a recursion way to do somethings like below?</p>\n\n<pre><code>    updateOs2 :: [(Rotor, Int)] -&gt; [(Rotor, Int)]\n    updateOs2 [(a,x),(b,y),(c,z)]\n        | x == 25 &amp;&amp; y == 25 &amp;&amp; z == 25 = [(a,0),(b,0),(c,0)]\n        | x == 25 &amp;&amp; y == 25            = [(a,0),(b,0),(c,z+1)]\n        | x == 25                       = [(a,0),(b,y+1),(c,z)]\n        | otherwise                     = [(a,x+1),(b,y),(c,z)]\n</code></pre>\n\n<p>I have tried to do recursion, but quite confused. Because once the last element <code>z</code> is passed the list comes to empty, can not go back to <code>x</code> anymore.</p>\n"}, {"tags": ["list", "haskell", "shuffle", "algebraic-data-types", "custom-data-type"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574286257, "post_id": 58963701, "comment_id": 104182747, "body": "Show us what you have tried, and where you got stuck."}, {"owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574287796, "post_id": 58963701, "comment_id": 104183382, "body": "@MichaelLitchard done, hope it&#39;s more useful :D"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 2, "creation_date": 1574288425, "post_id": 58963701, "comment_id": 104183606, "body": "I would remove <code>Numeric Integer</code> from <code>Rank</code> and make a sum type starting with Ace | Two | Three .. King. Then derive Enum. Then all you need to do is shuffle a list made of the enumerated values, starting with the lowerbound and ending with the upper bound. That shuffled list of values will tell you how to order a deck."}, {"owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574288734, "post_id": 58963701, "comment_id": 104183719, "body": "@MichaelLitchard I can&#39;t change the classes, I&#39;ve written MANY other functions (not included because they weren&#39;t relevant for the question) for them, which are all based on this class setup."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 2, "creation_date": 1574290997, "post_id": 58963701, "comment_id": 104184531, "body": "You don&#39;t have any classes. You have some types, and some functions."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1574291118, "post_id": 58963701, "comment_id": 104184584, "body": "You could make a list [1 .. 52], shuffle it, and then map each number to a card."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 1, "creation_date": 1574291462, "post_id": 58963701, "comment_id": 104184723, "body": "Not clear whether this is really what you would like to do, but the problem of randomly shuffling a list (of length 52) has been discussed for example in <a href=\"https://stackoverflow.com/questions/33723097/random-numbers-in-haskell-and-shuffling-a-list\">SO question 33723097</a>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1574318985, "post_id": 58963701, "comment_id": 104191802, "body": "what you call classes are known as algebraic data types in Haskell. They are comparable to C&#39;s unions of structs, with each union <a href=\"https://en.wikipedia.org/wiki/Tagged_union\" rel=\"nofollow noreferrer\">tagged</a> by a unique identifier."}], "owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574328047, "creation_date": 1574285503, "last_edit_date": 1574318843, "question_id": 58963701, "link": "https://stackoverflow.com/questions/58963701/how-can-i-shuffle-custom-list-like-data-in-haskell", "title": "How can I shuffle custom list-like data in Haskell?", "body": "<p>I am attempting to rearrange the order of a deck (or <code>Hand</code> of cards). Essentially to shuffle the hand. Namely, I want to shuffle the <code>fullDeck</code> into a random order. However, as I'm still kind of new to Haskell, I would appreciate any sort of assistance, here's the code, and classes etc:</p>\n\n<pre><code>data Hand = Empty | Add Card Hand\n            deriving (Eq, Show)\n\ndata Card = Card Rank Suit\n      deriving (Eq, Show)\n\ndata Rank = Numeric Integer | Jack | Queen | King | Ace\n            deriving (Eq, Show)\n\ndata Suit = Hearts | Spades | Diamonds | Clubs\n            deriving (Eq, Show)\n\n-- Here is how the deck is being made, constructed.\n\nfullDeck :: Hand\nfullDeck = createHandFromList (suitedCardList Clubs ++\n                suitedCardList Diamonds ++\n                suitedCardList Hearts ++\n                suitedCardList Spades) Empty\n\nsuitedCardList :: Suit -&gt; [Card]\nsuitedCardList s = [Card r s | r &lt;- [Numeric 2, Numeric 3, Numeric 4,\n                                     Numeric 5, Numeric 6, Numeric 7,\n                                     Numeric 8, Numeric 9, Numeric 10,\n                                     Jack, Queen, King, Ace]]\n\ncreateHandFromList :: [Card] -&gt; Hand -&gt; Hand\ncreateHandFromList [] h     = h\ncreateHandFromList (c:cs) h = Add c (createHandFromList cs h)\n\ndraw :: Hand -&gt; Hand -&gt; (Hand, Hand)\ndraw Empty h       = error \"draw: The deck is empty.\"\ndraw (Add c h1) h2 = (h1, Add c h2)\n\nshuffleDeck :: StdGen -&gt; Hand -&gt; Hand\nshuffleDeck g Empty = Empty\nshuffleDeck g h     = undefined\n</code></pre>\n\n<p>So I'm very curious as to how I should code <code>shuffleDeck</code> so that it shuffles it, I think an important note that Deck or Hand can be used interchangeably as a Deck is a collection of cards, just like a hand.</p>\n\n<p>So far I've tried implementing a number of helper functions, but I'm not sure if this is heading in the right or wrong direction...</p>\n\n<pre><code>takeNthCard :: Hand -&gt; Integer -&gt; (Card, Hand)\ntakeNthCard h 0 = (nthCard, Add nthCard h) --Move nth card to hand\ntakeNthCard h n = n - 1 --(and move along list of cards)\n</code></pre>\n\n<p>Many thanks in advance for any advice given!</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574289042, "post_id": 58964178, "comment_id": 104183822, "body": "I spotted the <code>mappend</code> but I&#39;m not satisfied with this explanation - because if that forced <code>t a</code> to be a <code>Monoid</code> (it may well do, I don&#39;t know the types involved here and haven&#39;t tried to work it out) I would expect the compiler to complain about the use of <code>mappend</code> in a function whose type signature only specifies <code>SemiGroup</code> - not to (it would seem) accept that definition and instead only complain when the function is evaluated."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 5, "creation_date": 1574290103, "post_id": 58964178, "comment_id": 104184180, "body": "@RobinZigmond But it does not only specify <code>Semigroup</code>, because of the partial specification (the <code>_</code> in the context) which tells the compiler &quot;put here whatever constraint is needed to make this compile&quot;, i.e. a monoid constraint. At least, that&#39;s how I interpret the code."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1574293090, "post_id": 58964178, "comment_id": 104185184, "body": "Ah, thanks @chi, I confess I&#39;ve never come across such a &quot;hole&quot; in a constraint and didn&#39;t know what it meant. And I really don&#39;t see the use, as it seems its only effect here was to cause a type error to be raised at a location other than the &quot;true&quot; one."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574299305, "post_id": 58964178, "comment_id": 104186620, "body": "@RobinZigmond Just getting back to the computer and going over all this, but to see the original context of the odd type signature, see <a href=\"https://stackoverflow.com/questions/58889734/given-a-record-of-functions-and-a-record-of-data-of-the-types-acted-on-by-the-f/58890226#58890226\" title=\"given a record of functions and a record of data of the types acted on by the f\">stackoverflow.com/questions/58889734/&hellip;</a> and <a href=\"https://stackoverflow.com/a/58938566/3096687\">stackoverflow.com/a/58938566/3096687</a>"}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1574300042, "post_id": 58964178, "comment_id": 104186785, "body": "I can&#39;t believe I didn&#39;t notice <code>mappend</code> was not part of SemiGroup! To be fair I was spoiled by PureScript: <a href=\"https://pursuit.purescript.org/packages/purescript-prelude/4.1.1/docs/Data.Semigroup#v:append\" rel=\"nofollow noreferrer\">pursuit.purescript.org/packages/purescript-prelude/4.1.1/doc&zwnj;&#8203;s/&hellip;</a>; removing the hole and adding <code>Applicative t</code> and <code>Foldable t</code> works"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1574339181, "post_id": 58964178, "comment_id": 104203066, "body": "@RobinZigmond The purposes for holes in type signatures is the same as for holes in expressions; it\u2018s for development when you\u2018re not quite sure what goes where but you know <i>part</i> of what you want, so you specify the bits you know and let the compiler figure out the rest (and then you can ask the compiler what it thinks the type signature should be given your partial constraint)."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1574341679, "post_id": 58964178, "comment_id": 104204469, "body": "@Cubic thanks for explaining, I understand why that&#39;s useful for expressions, but for a type signature I would expect that if you simply leave off a constraint then GHC will tell you straight away what constraints are needed. Whereas from what the OP described it seems that the &quot;hole&quot; makes GHC silently add the necessary constraint, which as we&#39;ve seen can merely lead to a type error elsewhere that&#39;s harder to trace."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1574344200, "post_id": 58964178, "comment_id": 104206050, "body": "@RobinZigmond If you just leave off a constraint, yes. But you can also leave off parts of a complicated constraint, which isn&#39;t quite as accessible."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 6, "last_activity_date": 1574287915, "creation_date": 1574287915, "answer_id": 58964178, "question_id": 58963601, "link": "https://stackoverflow.com/questions/58963601/why-is-a-monoidal-constraint-implied-by-this-function-even-though-only-semigrou/58964178#58964178", "title": "Why is a monoidal constraint implied by this function, even though only SemiGroup is listed as a constraint?", "body": "<p>Even though <code>&lt;&gt;</code> and <code>mappend</code> do the same thing, you can only use the latter if you have a <code>Monoid</code> constraint, so one got added to your <code>_</code> in the type signature. To fix it, use <code>foldr (&lt;&gt;)</code> instead of <code>foldr mappend</code>.</p>\n\n<p>And you don't need the hole in the type signature. You can write out what goes in it and it'll still work: <code>Applicative t</code> and <code>Foldable t</code>.</p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 58964178, "answer_count": 1, "score": 6, "last_activity_date": 1574287915, "creation_date": 1574285057, "question_id": 58963601, "link": "https://stackoverflow.com/questions/58963601/why-is-a-monoidal-constraint-implied-by-this-function-even-though-only-semigrou", "title": "Why is a monoidal constraint implied by this function, even though only SemiGroup is listed as a constraint?", "body": "<p>In the following stack script, I can't apply my <code>strangeHeadMay</code> function to a <code>NonEmpty</code> list, but it works fine on a regular list.</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack script --nix --resolver lts-13.6 -}\n\n{-# LANGUAGE ScopedTypeVariables  #-}\n{-# LANGUAGE PartialTypeSignatures #-}\n{-# OPTIONS_GHC -Wno-partial-type-signatures #-} -- hide some scary types\n\nimport           Control.Arrow                    ((&amp;&amp;&amp;))\nimport           Control.Monad                    (join)\nimport           Data.Foldable                    (toList)\nimport           Data.Function                    ((&amp;))\nimport           Data.Functor                     ((&lt;&amp;&gt;))\nimport           Data.List.NonEmpty               (NonEmpty(..))\nimport qualified Data.List.NonEmpty               as LNE\nimport           Data.Maybe                       (catMaybes)\nimport           Data.Tuple.Sequence              (sequenceT)\n\n\nstrangeHeadMay :: forall a t. (Semigroup (t a), _) =&gt; t a -&gt; Maybe a\nstrangeHeadMay xs =\n  let xsWrapped :: t (t a) = pure &lt;$&gt; xs -- &lt;- Contrived example\n      -- This is the functionality I actually need:\n      xsMay :: Maybe (t a) = xsWrapped &amp; (headMay &amp;&amp;&amp; tailMay) &amp; sequenceT\n         &lt;&amp;&gt; (\\(h, t) -&gt; foldr mappend h t)\n   in do\n    xs' &lt;- xsMay\n    xs' &amp; toList &amp; headMay\n\nmain :: IO ()\nmain = do\n  let nexs :: NonEmpty (Maybe Double) = Nothing :| [Just (2.0)]\n  let xs = LNE.toList nexs\n  let xsHead = strangeHeadMay xs\n  let nexsHead = strangeHeadMay nexs\n  pure ()\n\n\nheadMay :: Foldable f =&gt; f a -&gt; Maybe a\nheadMay = foldr (const . Just) Nothing\n\ntailMay :: Foldable f =&gt; f a -&gt; Maybe (f a)\ntailMay = foldr (seq . Just) Nothing\n</code></pre>\n\n<p>The error is </p>\n\n<pre><code>/home/brandon/workspace/foldNEmaybes.hs:34:18: error:\n    \u2022 No instance for (Monoid (NonEmpty (Maybe Double)))\n        arising from a use of \u2018strangeHeadMay\u2019\n    \u2022 In the expression: strangeHeadMay nexs\n      In an equation for \u2018nexsHead\u2019: nexsHead = strangeHeadMay nexs\n      In the expression:\n        do let nexs :: NonEmpty (Maybe Double) = Nothing :| ...\n           let xs = LNE.toList nexs\n           let xsHead = strangeHeadMay xs\n           let nexsHead = strangeHeadMay nexs\n           ....\n   |\n34 |   let nexsHead = strangeHeadMay nexs\n   |                  ^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Also, I must admit I'm not totally clear on why I need the partially typed signature, but changing <code>(Semigroup (t a), _)</code> to <code>(Semigroup (t a))</code> makes bad things happen.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1574279569, "post_id": 58962303, "comment_id": 104179813, "body": "Duplicate of: <a href=\"https://stackoverflow.com/questions/58952901/how-to-get-the-list-of-indexes-matching-a-predicate\" title=\"how to get the list of indexes matching a predicate\">stackoverflow.com/questions/58952901/&hellip;</a>"}, {"owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1574279603, "post_id": 58962303, "comment_id": 104179832, "body": "Sorry, didn&#39;t find that one!"}, {"owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1574279675, "post_id": 58962303, "comment_id": 104179863, "body": "I might be able to solve this myself with the hints in the comments there"}, {"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "edited": false, "score": 1, "creation_date": 1574280262, "post_id": 58962303, "comment_id": 104180137, "body": "Not so much a &quot;hint&quot; from the comments on that question, but using <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:findIndices\" rel=\"nofollow noreferrer\"><code>findIndicies</code></a>: <code>findIndices even [2,2,3,5,4,6]</code> does exactly what you require."}, {"owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "edited": false, "score": 0, "creation_date": 1574280355, "post_id": 58962303, "comment_id": 104180198, "body": "I managad to create the indexed list, but now I don&#39;t know how to continue"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574357470, "post_id": 58962303, "comment_id": 104214105, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/5726445/how-would-you-define-map-and-filter-using-foldr-in-haskell\">How would you define map and filter using foldr in Haskell?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 2, "last_activity_date": 1574280850, "creation_date": 1574280850, "answer_id": 58962618, "question_id": 58962303, "link": "https://stackoverflow.com/questions/58962303/how-to-filter-indexes-in-a-list/58962618#58962618", "title": "How to filter indexes in a list?", "body": "<p>In your code,</p>\n\n<pre><code>index x = [ n | n &lt;- [ zip x [1..] ] ]\n</code></pre>\n\n<p>the <code>[ n | n &lt;- [ e ]]</code> is  equivalent to <code>[ n | let n=e ]</code> is equivalent to <code>let n = e in [n]</code> or just <code>[e]</code>, i.e. <code>[zip x [1..]]</code>. It's not what you want. </p>\n\n<p>The</p>\n\n<pre><code>index x = [ n | n &lt;- ( zip x [1..] ) ]\n</code></pre>\n\n<p>on the other hand, is different. The parens are used for grouping, and as such are superfluous and can be omitted here. The code then is equivalent to <code>[ n | n &lt;- e ]</code> which is equivalent to just <code>e</code> i.e.  <code>zip x [1..]</code>, which is a step closer. </p>\n\n<p>You just need to deconstruct the <code>n</code>, which is a pair of an element and an index (constructed by <code>zip</code>), and include an index if the element is even, in the output list.</p>\n\n<p>We deconstruct values by pattern matching.</p>\n\n<p>A pair pattern is written <code>(a,b)</code>, or <code>(e,i)</code>, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 938, "user_id": 3894179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c6b1c2c08d1075995cb780ee8a2e36e?s=128&d=identicon&r=PG", "display_name": "Andra", "link": "https://stackoverflow.com/users/3894179/andra"}, "is_accepted": false, "score": 0, "last_activity_date": 1574354962, "creation_date": 1574354962, "answer_id": 58979876, "question_id": 58962303, "link": "https://stackoverflow.com/questions/58962303/how-to-filter-indexes-in-a-list/58979876#58979876", "title": "How to filter indexes in a list?", "body": "<p>First, you can give the index of a list using <code>zip</code>. From the list with index, we can <code>filter</code> the list that has a even value. After that we can extract the value.</p>\n\n<pre><code>-- Will be (Value, Index) tuple\nwithIndex :: [Int] -&gt; [(Int, Int)]\nwithIndex x = zip x [1..]\n\nmain =\n    print (\n        map snd (\n            filter\n                (even . fst)\n                (withIndex [2, 2, 3, 5, 4, 6])\n        )\n    )\n</code></pre>\n\n<p><a href=\"https://ideone.com/GDmW6j\" rel=\"nofollow noreferrer\">https://ideone.com/GDmW6j</a></p>\n"}], "owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 58962618, "answer_count": 2, "score": 0, "last_activity_date": 1574354962, "creation_date": 1574279485, "last_edit_date": 1574280324, "question_id": 58962303, "link": "https://stackoverflow.com/questions/58962303/how-to-filter-indexes-in-a-list", "title": "How to filter indexes in a list?", "body": "<p>For example, if I have a list of </p>\n\n<blockquote>\n  <p>[2,2,3,5,4,6]</p>\n</blockquote>\n\n<p>and I filter for even numbers, I want to output the indexes of those numbers: </p>\n\n<blockquote>\n  <p>[1,2,5,6]</p>\n</blockquote>\n\n<p>I know about the <code>filter</code> function which return the elements. How can I get their indexes instead?\nI have defined the fuction index which return the elements with their indexes as tuplets. Any hints how should I continue?</p>\n\n<pre><code>index x = [ n | n &lt;- [ zip x [1..]]]\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "ghc-api"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574280003, "post_id": 58961307, "comment_id": 104180024, "body": "I imagine you want to retrieve the <code>DynFlags</code> in effect. Unfortunately, I can&#39;t help you actually do that."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574280293, "post_id": 58961307, "comment_id": 104180157, "body": "You could try getting the <code>ms_hspp_opts</code> from a <code>ModSummary</code>. I&#39;m not sure if those would be the right options, but they might be!"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1574312480, "post_id": 58961307, "comment_id": 104189720, "body": "I believe those two pragmas, at least, are required to be at the very top of the file. I&#39;d just parse them myself. If you want <code>{-# OVERLAPPABLE #-}</code> and stuff that would be a different story..."}, {"owner": {"reputation": 2501, "user_id": 598892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a22954b638ce69b9994c9e3623953a5?s=128&d=identicon&r=PG", "display_name": "Chris Smith", "link": "https://stackoverflow.com/users/598892/chris-smith"}, "edited": false, "score": 0, "creation_date": 1574395889, "post_id": 58961307, "comment_id": 104226692, "body": "Thanks!  I spent quite a few hours tonight trying to make ghc-exactprint work, but wasn&#39;t able.  I threw something together in the spirit of luqui&#39;s comment, and I think it&#39;ll be good enough."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574396313, "post_id": 58961307, "comment_id": 104226765, "body": "@luqui, what if there&#39;s CPP around language options? Or if they&#39;re <code>#include</code>d? Or if they come in from Cabal? This sounds a bit fishy."}], "owner": {"reputation": 2501, "user_id": 598892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a22954b638ce69b9994c9e3623953a5?s=128&d=identicon&r=PG", "display_name": "Chris Smith", "link": "https://stackoverflow.com/users/598892/chris-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 6, "last_activity_date": 1574283165, "creation_date": 1574275405, "last_edit_date": 1574283165, "question_id": 58961307, "link": "https://stackoverflow.com/questions/58961307/how-do-i-write-code-to-modify-the-ast-of-a-haskell-source-file-without-losing-th", "title": "How do I write code to modify the AST of a Haskell source file without losing the pragmas?", "body": "<p>I need to make some changes to an existing Haskell source file, and write out the modified source code.  I'd like to use the GHC API for this, so that the result is consistent with current Haskell.  My current approach, which is <a href=\"https://github.com/google/codeworld/blob/2eb7642a5663f39f114707e6abaa6b07b7dd8c39/codeworld-compiler/src/CodeWorld/Compile/Framework.hs#L287\" rel=\"nofollow noreferrer\">here</a>, is something like:</p>\n\n<pre><code>mod &lt;- parseTheSource  -- omitted, but I'm sure this works\nprintForUser dynFlags outHandle neverQualify $ ppr (transform mod)\n</code></pre>\n\n<p>This works... almost!  It strips out LANGUAGE and OPTIONS_GHC pragmas, so that sometimes files that compiled earlier will fail after the round trip.</p>\n\n<p>Is there a better way to do this?</p>\n\n<p>I noticed that <code>ghc-exactprint</code> looks very relevant, but I can't figure out how to make it work nicely.  It looks like it's tied to a GHC session, which is likely to initialize <code>DynFlags</code> from the command line, and a lot of other junk that I don't want.  If that's the right direction, I could use some help distilling what to do, and especially using my own <code>DynFlags</code> that I can already construct and not leaking GHC command line processing and such into the code.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 739, "user_id": 2359990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f7130d72f637bce50544029ccd6998a?s=128&d=identicon&r=PG", "display_name": "Max Maier", "link": "https://stackoverflow.com/users/2359990/max-maier"}, "edited": false, "score": 0, "creation_date": 1574320265, "post_id": 58964030, "comment_id": 104192343, "body": "You are right, that is why it is <code>forall</code> quantified. Any idea how annotation is supposed to be used? I&#39;m kind of lost here."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 739, "user_id": 2359990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f7130d72f637bce50544029ccd6998a?s=128&d=identicon&r=PG", "display_name": "Max Maier", "link": "https://stackoverflow.com/users/2359990/max-maier"}, "edited": false, "score": 1, "creation_date": 1574361348, "post_id": 58964030, "comment_id": 104215923, "body": "@MaxMaier Create a method with some other name, and use it in place of <code>pretty</code>."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1574287140, "creation_date": 1574287140, "answer_id": 58964030, "question_id": 58960669, "link": "https://stackoverflow.com/questions/58960669/using-annotations-and-pretty-printer/58964030#58964030", "title": "Using Annotations and Pretty Printer", "body": "<p>The <code>Pretty</code> typeclass requires things that can work with any type of annotation. In your case, they only work with your type <code>Ann</code>. Such a method would have to be its own thing, as it's not valid for <code>pretty</code>.</p>\n"}], "owner": {"reputation": 739, "user_id": 2359990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f7130d72f637bce50544029ccd6998a?s=128&d=identicon&r=PG", "display_name": "Max Maier", "link": "https://stackoverflow.com/users/2359990/max-maier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1574287140, "creation_date": 1574272787, "question_id": 58960669, "link": "https://stackoverflow.com/questions/58960669/using-annotations-and-pretty-printer", "title": "Using Annotations and Pretty Printer", "body": "<p>I'm using the pretty printer <a href=\"http://hackage.haskell.org/package/prettyprinter-1.5.1/docs/Data-Text-Prettyprint-Doc.html\" rel=\"nofollow noreferrer\">Data.Text.Prettyprint.Doc</a>. Now I want to style my output differently and thought that the idea of semantic annotations fits well here. Consider the following example</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.Text.Prettyprint.Doc\n\ndata Foo = X | Y\ndata Ann = AnnX | AnnY\n\ninstance Pretty Foo where\n  pretty X = \"[\" &lt;+&gt; (annotate AnnX \"X was here\") &lt;+&gt; \"]\"\n  pretty Y = \"nothing\"\n</code></pre>\n\n<p>This fails with an error like</p>\n\n<pre><code>/Example.hs:14:14: error:\n    \u2022 Couldn't match type \u2018ann\u2019 with \u2018Ann\u2019\n      \u2018ann\u2019 is a rigid type variable bound by\n        the type signature for:\n          pretty :: forall ann. Foo -&gt; Doc ann\n        at /Example.hs:14:3-8\n      Expected type: Doc ann\n        Actual type: Doc Ann\n    \u2022 In the expression: \"[\" &lt;+&gt; (annotate AnnX \"X was here\") &lt;+&gt; \"]\"\n      In an equation for \u2018pretty\u2019:\n          pretty X = \"[\" &lt;+&gt; (annotate AnnX \"X was here\") &lt;+&gt; \"]\"\n      In the instance declaration for \u2018Pretty Foo\u2019\n    \u2022 Relevant bindings include\n        pretty :: Foo -&gt; Doc ann\n          (bound at /Example.hs:14:3)\n   |\n14 |   pretty X = \"[\" &lt;+&gt; (annotate AnnX \"X was here\") &lt;+&gt; \"]\"\n   |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>which I barely understand. My intention was to annotate a document and later on I wanted to come up with different drivers for an annotation. For example, I wanted to have a driver which maps the document <code>X was here</code> to <code>&lt;strong&gt;X was here&lt;/strong&gt;</code>  and another driver to <code>&lt;i&gt;X was here&lt;/i&gt;</code>. Maybe I understood the whole annotation part wrongly. Can someone enlighten me or provide me a link to an example?</p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574255096, "post_id": 58952155, "comment_id": 104165766, "body": "In the past, many programs failed when passed a path containing a space. Nowadays, this is less common, and those programs which still fail are generally regarded as buggy and fixed. The usual suspects are shell scripts, but even there it&#39;s often a matter of using <code>command &quot;$X&quot;</code> instead of <code>command $X</code>. Newly made scripts are generally written so to avoid this pitfall."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1574246147, "last_edit_date": 1574246147, "creation_date": 1574245816, "answer_id": 58952155, "question_id": 58952109, "link": "https://stackoverflow.com/questions/58952109/how-to-load-a-module-that-contains-whitespace-in-ghci/58952155#58952155", "title": "how to load a module that contains whitespace in ghci", "body": "<p>You can wrap it in quotes (<code>\"</code>), like:</p>\n\n<pre><code>Prelude&gt; :l <b>\"foo bar.hs\"</b></code></pre>\n\n<p>You will need to escape the backslashes, so:</p>\n\n<pre><code>Prelude&gt; :l <b>\"</b>C:<b>\\\\</b>Users<b>\\\\</b>ymelk<b>\\\\</b>OneDrive<b>\\\\</b>Desktop<b>\\\\</b>Computer Science<b>\\\\</b>Works<b>\\\\</b>Assignments<b>\\\\</b>Functional Programming with Haskell<b>\\\\</b>ex1<b>\"</b></code></pre>\n\n<p>That being said, filenames with spaces are often not a good idea, especially since a shell often sees spaces as an argument separator.</p>\n"}], "owner": {"reputation": 163, "user_id": 12313191, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDelPS5VpuVOfMYXPwWBTLBvilRRWDWFzYm4WiPJA=k-s128", "display_name": "Yoni Melki", "link": "https://stackoverflow.com/users/12313191/yoni-melki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1574246147, "creation_date": 1574245695, "question_id": 58952109, "link": "https://stackoverflow.com/questions/58952109/how-to-load-a-module-that-contains-whitespace-in-ghci", "title": "how to load a module that contains whitespace in ghci", "body": "<p>I want to load the module <code>C:\\Users\\ymelk\\OneDrive\\Desktop\\Computer Science\\Works\\Assignments\\Functional Programming with Haskell\\ex1</code> straight from GHCi but when i put</p>\n\n<pre><code>:l C:\\Users\\ymelk\\OneDrive\\Desktop\\Computer Science\\Works\\Assignments\\Functional Programming with Haskell\\ex1 \n</code></pre>\n\n<p>ghci says <code>target C:\\Users\\ymelk\\OneDrive\\Desktop\\Computer' is not a module name or a source file</code></p>\n\n<p>I suppose that this is because I have whitespaces.\none of the solution is to write the name of my documents like camelCase norm but this is too long (many documents)</p>\n\n<p>Is there a way to load a module including whitespaces ?</p>\n"}, {"tags": ["function", "haskell", "list-comprehension", "haskell-platform"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1574243904, "post_id": 58951449, "comment_id": 104159161, "body": "What exactly is your question here? It will be much easier to help you with this problem if you have a specific question we can answer. <b>EDIT:</b> Actually, never mind. I somehow managed to miss the part where you said that you\u2019re trying to make a full deck of cards."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1574243915, "post_id": 58951449, "comment_id": 104159169, "body": "Hint: take a look at <code>foldr</code>: <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:foldr\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1574244012, "post_id": 58951449, "comment_id": 104159211, "body": "Also, by the way, your <code>suitedCardList</code> function can be more easily written as <code>[Card v s | v &lt;- [Numeric 1, Numeric 2, Numeric 3, Numeric 4, Numeric 5, Numeric 6, Numeric 7, Numeric 8, Numeric 9, Numeric 10, Jack, Queen King, Ace]]</code>. It also seems a bit odd to me that you list both <code>Numeric 1</code> and <code>Ace</code> as ranks."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1574244287, "post_id": 58951449, "comment_id": 104159386, "body": "@Alex After looking at your code I do actually see a small problem with your <code>fullDeck</code> function: <code>createHandFromList</code> requires two parameters, but you\u2019ve only supplied one parameter to it. Could this be the cause of your problem?"}, {"owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1574244501, "post_id": 58951449, "comment_id": 104159518, "body": "@bradrn I don&#39;t think it is, although it is needed to be changed (which I have done on my actual code file now), it still errors on the <code>createHandFromList</code> function."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1574244636, "post_id": 58951449, "comment_id": 104159619, "body": "@Alex Can you tell us what the error is then? That will make the problem a lot easier to solve."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1574244860, "post_id": 58951449, "comment_id": 104159749, "body": "Thanks @Alex! That tells me exactly what the error is: in <code>createHandFromList</code>, your <code>[c:cs]</code> should actually be <code>(c:cs)</code>."}, {"owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1574245106, "post_id": 58951449, "comment_id": 104159912, "body": "@bradrn unfortunately, this solution still causes errors, just of a different kind, I&#39;ll update the question, so everyone sees the result, but still thanks, it&#39;s a step forward!"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1574245275, "post_id": 58951449, "comment_id": 104160002, "body": "@Alex I think the problem now is that <code>createHandFromList</code> is returning a list of <code>Hand</code>s, but its type signature states that it returns a single <code>Hand</code> value. I suggest that you implement this function with recursion rather than a list comprehension."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 3, "creation_date": 1574245334, "post_id": 58951449, "comment_id": 104160045, "body": "to answer your Q&#39;s title, not body, you do it with <code>deriving Enum</code> and then use <code>fromEnum</code> and <code>toEnum</code>."}, {"owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1574245871, "post_id": 58951449, "comment_id": 104160395, "body": "@bradrn how would I do that, I was thinking something like <code>createHandFromList (c:cs) h = Add c h + createHandFromList (cs) h</code> but I have no idea how to get haskell to do something after the other thing, I know it&#39;s not add, but for sake of understanding my logic, I left it in."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1574246625, "post_id": 58951449, "comment_id": 104160874, "body": "@Alex That\u2019s almost correct. I believe the correct implementation is <code>createHandFromList (c:cs) h = Add c (createHandFromList cs h)</code>; that is, add card <code>c</code> to the <code>Hand</code> created from adding <code>cs</code> to <code>h</code>. But you\u2019ll also need a base case for <code>createHandFromList [] h</code>."}, {"owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1574247059, "post_id": 58951449, "comment_id": 104161133, "body": "@bradrn perfect! thank you very much, if you wanted to post that as the answer I&#39;d be more than happy to upvote it again and mark as right."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1574247749, "post_id": 58951449, "comment_id": 104161545, "body": "@WillNess I don&#39;t think he can auto derive <code>Enum</code> instances by <code>deriving</code> for the <code>Card</code> and <code>Hand</code> types.. also possibly <code>Rank</code> since they have one or more non-nullary data constructors. (constructors with fields). Can this be done..?"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1574255027, "post_id": 58951449, "comment_id": 104165730, "body": "FWIW, here&#39;s one way to create a full deck of cards: <a href=\"https://blog.ploeh.dk/2018/10/08/full-deck\" rel=\"nofollow noreferrer\">blog.ploeh.dk/2018/10/08/full-deck</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1574259301, "post_id": 58951449, "comment_id": 104168361, "body": "Rolled back edit because it eliminated the problem with <code>[c:cs]</code> without updating the error. There are multiple problems with the code; don&#39;t edit the question as they are pointed out in the comments. Close the question, or (since no answer has yet been posted), simplify it to focus on a problem that <i>still exists</i>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1574263378, "post_id": 58951449, "comment_id": 104171051, "body": "@Redu in the <i>title</i> it says &quot;a list of <i>enums</i>&quot;..."}, {"owner": {"reputation": 700, "user_id": 5499914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fz53h.png?s=128&g=1", "display_name": "Khuldraeseth na&#39;Barya", "link": "https://stackoverflow.com/users/5499914/khuldraeseth-nabarya"}, "edited": false, "score": 2, "creation_date": 1574264085, "post_id": 58951449, "comment_id": 104171503, "body": "This problem could be simplified away. Look at the declaration of lists: <code>data [] a = [] | a : [a]</code>. Get a concrete type out of this: <code>[Card] = [] | Card : [Card]</code>. Look familiar? Your <code>Hand</code> type is nothing more than a list of <code>Card</code>s."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1574286963, "post_id": 58951449, "comment_id": 104183055, "body": "@Alex I\u2019d be happy to post that as an answer! (But you don\u2019t need to upvote it: acceptance gives me reputation anyway.)"}], "answers": [{"tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 2, "last_activity_date": 1574288070, "creation_date": 1574288070, "answer_id": 58964207, "question_id": 58951449, "link": "https://stackoverflow.com/questions/58951449/how-to-transform-a-list-of-enums-to-another-type-of-enum-in-haskell/58964207#58964207", "title": "How to transform a list of enums to another type of enum in Haskell?", "body": "<p>There are multiple problems with this code. Firstly, you have used <code>[c:cs]</code> as a pattern in the definition of <code>createHandFromList</code>. However, this is a syntax error: in pattern matching, the syntax is <code>(c:cs)</code>. This gives the following code:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>createHandFromList :: [Card] -&gt; Hand -&gt; Hand\ncreateHandFromList (c:cs) h = [Add card h | card &lt;- c]\n</code></pre>\n\n<p>But there is still another problem with this code. You return a list of <code>Hand</code>s, but the type signature says that you must return a single <code>Hand</code>! Clearly this is wrong. To figure out what to do instead, let\u2019s take a step back and work through exactly what <code>createHandFromList</code> should do:</p>\n\n<ul>\n<li>Starting with the hand it is given, add one card to that hand</li>\n<li>Add another card to the hand just created</li>\n<li>Add another card to the hand just created</li>\n<li>\u2026</li>\n<li>Repeat until no cards are left.</li>\n</ul>\n\n<p>This can be done most easily with recursion:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>createHandFromList :: [Card] -&gt; Hand -&gt; Hand\n-- Add card \u2018c\u2019 to the result of (createHandFromList cs h)\ncreateHandFromList (c:cs) h = Add c (createHandFromList cs h)\n-- Return hand \u2018h\u2019 if there are no more cards left to add\ncreateHandFromList [] h = h\n</code></pre>\n\n<hr>\n\n<p>There is a small simplification I want to address as well. (Credit goes to @Khuldraeseth na'Barya, who wrote this in the comments.) Let\u2019s look at the possible values of <code>Hand</code>:</p>\n\n<ul>\n<li><code>Empty</code></li>\n<li><code>Add card1 Empty</code></li>\n<li><code>Add card2 (Add card1 Empty)</code></li>\n<li><code>Add card3 (Add card2 (Add card1 Empty))</code></li>\n<li>etc.</li>\n</ul>\n\n<p>This looks exactly like a list of <code>Card</code>s! And it turns out that the types <code>Hand</code> and <code>[Card]</code> are isomorphic. In pseudo-Haskell:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Hand   = Empty | Add Card Hand\ndata [Card] = []    | :   Card [Card]\n</code></pre>\n\n<p>So, if you represent <code>Hand</code> as something like <code>newtype Hand = Hand { getCards :: [Card] }</code>, then you should be able to replace the recursion by a list comprehension. This is left as an exercise for the reader.</p>\n"}], "owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 58964207, "answer_count": 1, "score": 1, "last_activity_date": 1574288070, "creation_date": 1574243816, "last_edit_date": 1574259222, "question_id": 58951449, "link": "https://stackoverflow.com/questions/58951449/how-to-transform-a-list-of-enums-to-another-type-of-enum-in-haskell", "title": "How to transform a list of enums to another type of enum in Haskell?", "body": "<p>I'm trying to write a function that creates a full deck of cards (52 with no Jokers). I'm still new to this, I'm thinking that some sort of list comprehension is what I need to do, but I don't know quite how to write it (see <code>createHandFromList</code> function). I'm also guessing it needs to be recursive so that it will keep going. Anyway, here's what my code looks like so far, any help and advice is, as always, much appreciated.</p>\n\n<pre><code>data Card = Card Rank Suit\n      deriving (Eq, Show)\n\ndata Rank = Numeric Integer | Jack | Queen | King | Ace\n            deriving (Eq, Show)\n\ndata Suit = Hearts | Spades | Diamonds | Clubs\n            deriving (Eq, Show)\n\ndata Hand = Empty | Add Card Hand\n            deriving (Eq, Show)\n\nfullDeck :: Hand\nfullDeck = createHandFromList (suitedCardList Clubs ++\n                suitedCardList Diamonds ++\n                suitedCardList Hearts ++\n                suitedCardList Spades)\n\nsuitedCardList :: Suit -&gt; [Card]\nsuitedCardList s = [Card (Numeric 2) s, Card (Numeric 3) s,\n                    Card (Numeric 4) s, Card (Numeric 5) s,\n                    Card (Numeric 6) s, Card (Numeric 7) s,\n                    Card (Numeric 8) s, Card (Numeric 8) s,\n                    Card (Numeric 10) s, Card Jack s,\n                    Card Queen s, Card King s, Card Ace s]\n\ncreateHandFromList :: [Card] -&gt; Hand -&gt; Hand\ncreateHandFromList [c:cs] h = [Add card h | card &lt;- c]\n</code></pre>\n\n<p>Currently, the code returns this as an error:</p>\n\n<pre><code>BlackJack.hs:107:21: error:\n    \u2022 Couldn't match expected type \u2018Card\u2019 with actual type \u2018[[Card]]\u2019\n    \u2022 In the pattern: c : cs\n      In the pattern: [c : cs]\n      In an equation for \u2018createHandFromList\u2019:\n          createHandFromList [c : cs] h = [Add card h | card &lt;- c]\n    |\n107 | createHandFromList [c:cs] h = [Add card h | card &lt;- c]     |                     ^^^^\n\nBlackJack.hs:107:31: error:\n    \u2022 Couldn't match expected type \u2018Hand\u2019 with actual type \u2018[Hand]\u2019\n    \u2022 In the expression: [Add card h | card &lt;- c]\n      In an equation for \u2018createHandFromList\u2019:\n          createHandFromList [c : cs] h = [Add card h | card &lt;- c]\n    |\n107 | createHandFromList [c:cs] h = [Add card h | card &lt;- c]     | \n</code></pre>\n"}, {"tags": ["haskell", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1574264168, "post_id": 58948248, "comment_id": 104171550, "body": "The install was performed correctly. It is broken to install Haskell packages into a global database. Unfortunately, <code>cabal v1-install</code> does just that, which is why <code>cabal info</code> checks whether packages are in that database. <code>cabal v2-install</code> does not install packages into the global database, so it isn&#39;t broken. You should (as far as possible) <i>never</i> install anything into the global database, except for the packages that ship with GHC, and so <code>cabal info</code> should <i>always</i> say &quot;Not installed.&quot; This question is really &quot;how do I point this Emacs extension to a <code>new-install</code>ed package?&quot;"}, {"owner": {"reputation": 847, "user_id": 157251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e238c7e5ef9cea787f00d937aadeb6ed?s=128&d=identicon&r=PG", "display_name": "yaxu", "link": "https://stackoverflow.com/users/157251/yaxu"}, "edited": false, "score": 2, "creation_date": 1574266729, "post_id": 58948248, "comment_id": 104173135, "body": "It&#39;s not &#39;broken&#39; to install packages into a global database, if you only want to install and use a single package (or set of interoperating packages). Also, unless you specify otherwise, <code>v2-install</code> does install packages to a global (aka default) database, doesn&#39;t it?"}, {"owner": {"reputation": 4183, "user_id": 124179, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/977471a7792cba5ccfbd569f77d805b8?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/124179/justin"}, "edited": false, "score": 0, "creation_date": 1574266994, "post_id": 58948248, "comment_id": 104173292, "body": "Anyone with a view as to which of types 1-4 here is the &quot;correct&quot; one ? All very confusing :-/ <a href=\"https://www.reddit.com/r/haskell/comments/a7wfkd/using_ghcup_to_setup_haskell_and_installing_cabal/\" rel=\"nofollow noreferrer\">reddit.com/r/haskell/comments/a7wfkd/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4183, "user_id": 124179, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/977471a7792cba5ccfbd569f77d805b8?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/124179/justin"}, "is_accepted": true, "score": 0, "last_activity_date": 1574356980, "creation_date": 1574356980, "answer_id": 58980493, "question_id": 58948248, "link": "https://stackoverflow.com/questions/58948248/haskell-cabal-only-partially-installing-package/58980493#58980493", "title": "Haskell `cabal` only &quot;partially&quot; installing package", "body": "<p>Closing this as the procedure outlined above is in fact \"working\", it's just that the <code>cabal</code> community seems to be moving from an \"old-style\" installation process to a \"new-style\", and that the difference isn't always clear to the newcomer. Also that certain parts of certain packages (notably <code>tidal.el</code> in the <code>Tidal</code> package) haven't yet been updated to reflect the changes in <code>cabal</code> installation procedures. Thanks!</p>\n"}], "owner": {"reputation": 4183, "user_id": 124179, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/977471a7792cba5ccfbd569f77d805b8?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/124179/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 58980493, "answer_count": 1, "score": 4, "last_activity_date": 1574356980, "creation_date": 1574232205, "question_id": 58948248, "link": "https://stackoverflow.com/questions/58948248/haskell-cabal-only-partially-installing-package", "title": "Haskell `cabal` only &quot;partially&quot; installing package", "body": "<p>Having problems installing a Haskell package called <code>Tidal</code>, using <code>cabal</code> on Ubuntu <code>18:04</code>.</p>\n\n<p><a href=\"https://tidalcycles.org/index.php/Userbase\" rel=\"nofollow noreferrer\">https://tidalcycles.org/index.php/Userbase</a></p>\n\n<p>I'm not a Haskell expert and have borked this stuff a couple of times before, so am trying as fresh an install as possible, using this -</p>\n\n<p><a href=\"https://www.haskell.org/ghcup/\" rel=\"nofollow noreferrer\">https://www.haskell.org/ghcup/</a></p>\n\n<p>I clean out as much of the Haskell- related stuff as I can -</p>\n\n<pre><code>justin@justin-XPS-13-9360:~$ rm -rf ~/.cabal/\njustin@justin-XPS-13-9360:~$ rm -rf ~/.ghc\njustin@justin-XPS-13-9360:~$ rm -rf ~/.ghcup\n</code></pre>\n\n<p>And also any Ubuntu legacy Haskell -</p>\n\n<pre><code>justin@justin-XPS-13-9360:~$ sudo apt-get remove ghc\n</code></pre>\n\n<p>So that -</p>\n\n<pre><code>justin@justin-XPS-13-9360:~$ ghci\nbash: /home/justin/.ghcup/bin/ghci: No such file or directory\n</code></pre>\n\n<p>OK let's go -</p>\n\n<pre><code>curl https://get-ghcup.haskell.org -sSf | sh\n</code></pre>\n\n<p>Which gives me -</p>\n\n<pre><code>{...}\nDone installing, run \"ghci-8.6.5\" or set up your current GHC via: ghcup set 8.6.5\nSetting GHC to 8.6.5\nDone\nSetting GHC to 8.6.5\nDone\n{...}\nSuccessfully installed cabal-install into\n  /home/justin/.ghcup/bin\nDetected \"/home/justin/.bashrc\" on your system...\nIf you want ghcup to automatically fix your \"/home/justin/.bashrc\" to include the required PATH variable\nanswer with YES, otherwise with NO and press ENTER.\n\nYES\nOK! /home/justin/.bashrc has been modified. Restart your terminal for the changes to take effect,\nor type \"source /home/justin/.ghcup/env\" to apply them in your current terminal session.\n</code></pre>\n\n<p>Let's set the <code>PATH</code> and test -</p>\n\n<pre><code>justin@justin-XPS-13-9360:~$ source /home/justin/.ghcup/env\njustin@justin-XPS-13-9360:~$ ghci\nGHCi, version 8.6.5: http://www.haskell.org/ghc/  :? for help\nPrelude&gt;\n</code></pre>\n\n<p>So far so good. Now following this -</p>\n\n<p><a href=\"https://tidalcycles.org/index.php/Troubleshooting_a_Tidal_install\" rel=\"nofollow noreferrer\">https://tidalcycles.org/index.php/Troubleshooting_a_Tidal_install</a></p>\n\n<p>I try the following -</p>\n\n<pre><code>justin@justin-XPS-13-9360:~$ cabal update\nDownloading the latest package list from hackage.haskell.org\nTo revert to previous state run:\n    cabal v2-update 'hackage.haskell.org,2019-11-20T01:17:49Z'\n</code></pre>\n\n<p>and then -</p>\n\n<pre><code>justin@justin-XPS-13-9360:~$ cabal new-install tidal --lib\n{...}\nStarting     tidal-1.4.4 (lib)\nBuilding     tidal-1.4.4 (lib)\nInstalling   tidal-1.4.4 (lib)\nCompleted    tidal-1.4.4 (lib)\n</code></pre>\n\n<p>Still looks OK, but this is where the problems start -</p>\n\n<pre><code>justin@justin-XPS-13-9360:~$ cabal info tidal\n* tidal            (library)\n    Synopsis:      Pattern language for improvised music\n    Versions available: 0.8.2, 0.9.9, 0.9.10, 1.2.1, 1.3.0, 1.4.1, 1.4.2, 1.4.3,\n                        1.4.4 (and 99 others)\n    Versions installed: [ Not installed ]\n</code></pre>\n\n<p>Hmm - <code>Not installed</code> ?? And -</p>\n\n<pre><code>justin@justin-XPS-13-9360:~$ ghc-pkg latest tidal\nghc-pkg: cannot find package tidal\n</code></pre>\n\n<p>Doh. However, if I look in <code>~/.cabal</code> I can see that <em>some stuff</em> has been installed - </p>\n\n<pre><code>justin@justin-XPS-13-9360:~$ ls -l /home/justin/.cabal/store/ghc-8.6.5/\ntotal 100\n{...}\ndrwxr-xr-x 4 justin justin 4096 Nov 20 06:00 tidal-1.4.4-898a4af91fab9d9d757e1a84104bbd7ca568a77d48b4679a3f4addb65912423a\n{...}\n</code></pre>\n\n<p>and I can even check that the library installed in <code>~/.cabal/store</code> works properly -</p>\n\n<pre><code>justin@justin-XPS-13-9360:~$ ghci\nGHCi, version 8.6.5: http://www.haskell.org/ghc/  :? for help\nLoaded package environment from /home/justin/.ghc/x86_64-linux-8.6.5/environments/default\nPrelude&gt; :script /home/justin/.cabal/store/ghc-8.6.5/tidal-1.4.4-898a4af91fab9d9d757e1a84104bbd7ca568a77d48b4679a3f4addb65912423a/share/BootTidal.hs\nListening for controls on 127.0.0.1:6010\ntidal&gt; :t d1\nd1 :: Pattern ControlMap -&gt; IO ()\ntidal&gt; \n</code></pre>\n\n<p>However I want to use <code>Tidal</code> with its emacs extension -</p>\n\n<p><a href=\"https://github.com/tidalcycles/Tidal/blob/master/tidal.el\" rel=\"nofollow noreferrer\">https://github.com/tidalcycles/Tidal/blob/master/tidal.el</a></p>\n\n<p>which looks up the package as follows and would require <code>cabal info tidal</code> to return a correctly installed version -</p>\n\n<pre><code> '((\"path\" . \"ghc-pkg describe $(ghc-pkg latest tidal) | grep data-dir | cut -f2 -d' '\")\n</code></pre>\n\n<p>Essentially the emacs extension wants the package to live here (which would make <code>cabal info tidal</code> work)</p>\n\n<pre><code>/home/justin/.cabal/share/x86_64-linux-ghc-8.6.5/tidal-1.4.4/BootTidal.hs\n</code></pre>\n\n<p>But <code>cabal</code> only seems to \"partially\" install the package here -</p>\n\n<pre><code>/home/justin/.cabal/store/ghc-8.6.5/tidal-1.4.4-898a4af91fab9d9d757e1a84104bbd7ca568a77d48b4679a3f4addb65912423a/share/BootTidal.hs\n</code></pre>\n\n<p>Now I could probably hack the emacs extension to point to <code>~/.cabal/store</code> rather than <code>~/.cabal/share</code>, but I would prefer this to work properly and <code>cabal info tidal</code> to return the correct version.</p>\n\n<p>Can anyone enlighten me about why <code>cabal</code> is not pushing files to <code>~/.cabal/share</code> ?</p>\n\n<p>TIA.</p>\n"}, {"tags": ["haskell", "monads", "ghc", "type-systems"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1574261310, "post_id": 58947160, "comment_id": 104169649, "body": "A fun exercise when presented with these questions is to try and write them use a definition without the dep."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1574280135, "post_id": 58947160, "comment_id": 104180091, "body": "It&#39;s not needed for defining <code>MonadReader</code>; it&#39;s needed for conveniently <i>using</i> <code>MonadReader</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1574252555, "last_edit_date": 1574252555, "creation_date": 1574239531, "answer_id": 58950080, "question_id": 58947160, "link": "https://stackoverflow.com/questions/58947160/why-is-functionaldependency-needed-for-defining-monadreader/58950080#58950080", "title": "Why is FunctionalDependency needed for defining MonadReader?", "body": "<p>It is needed to make type inference work in a way which is more convenient to the user.</p>\n\n<p>For example, without the fundep this would not compile:</p>\n\n<pre><code>action :: ReaderT Int IO ()\naction = do\n  x &lt;- ask\n  liftIO $ print x\n</code></pre>\n\n<p>To make the above compile we would need to write   </p>\n\n<pre><code>action :: ReadertT Int IO ()\naction = do\n  x &lt;- ask :: ReadertT Int IO Int\n  liftIO $ print x\n</code></pre>\n\n<p>This is because, without the fundep, the compiler can not infer that <code>x</code> is an <code>Int</code>. After all a monad <code>ReadertT Int IO</code> might have multiple instances</p>\n\n<pre><code>instance MonadReader Int (ReaderT Int IO) where\n   ask = ReaderT (\\i -&gt; return i)\ninstance MonadReader Bool (ReaderT Int IO) where\n   ask = ReaderT (\\i -&gt; return (i != 0))\ninstance MonadReader String (ReaderT Int IO) where\n   ask = ReaderT (\\i -&gt; return (show i))\n-- etc.\n</code></pre>\n\n<p>so the programmer must provide some annotation which forces <code>x :: Int</code>, or the code is ambiguous.</p>\n"}, {"tags": [], "owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "is_accepted": false, "score": 2, "last_activity_date": 1574352157, "last_edit_date": 1574352157, "creation_date": 1574242477, "answer_id": 58951011, "question_id": 58947160, "link": "https://stackoverflow.com/questions/58947160/why-is-functionaldependency-needed-for-defining-monadreader/58951011#58951011", "title": "Why is FunctionalDependency needed for defining MonadReader?", "body": "<p>I think the source of confusion is that in the definition of </p>\n\n<pre><code>class Monad m =&gt; MonadReader r m | m -&gt; r where\n  {- ... -}\n</code></pre>\n\n<p>It is implicitly asumed that <code>m</code> contains <code>r</code> itself (for common instances). Let me use a lighter definiton of <code>Reader</code> as </p>\n\n<pre><code>newtype Reader r a = Reader {runReader :: r -&gt; a}\n</code></pre>\n\n<p>When the <code>r</code> parameter is chosen you can easely define a monad instance for <code>Reader r</code>. That means that in the type class definition <code>m</code> should be substitute for <code>Reader r</code>. So take a look at how the expresion ends up being:</p>\n\n<pre><code>instance MonadReader r (Reader r) where -- hey!! r is duplicated now\n  {- ... -}                             -- The functional dependecy becomes Reader r -&gt; r which makes sense\n</code></pre>\n\n<p>But why do we need this?. Look at the definition of <code>ask</code> within the <code>MonadReader</code> class.</p>\n\n<pre><code>class Monad m =&gt; MonadReader r m | m -&gt; r where\n  ask :: m r -- r and m are polymorphic here\n  {- ... -}\n</code></pre>\n\n<p>Without the fun-dep nothing could stop me for defining <code>ask</code> in a way to return a different type as the state. Even more, I could define many instances of monad reader for my type. As an example, this would be valid definitions without func-dep</p>\n\n<pre><code>instance MonadReader Bool (Reader r) where\n--                   ^^^^         ^\n--                   |            |- This is state type in the user defined newtype \n--                   |- this is the state type in the type class definition\n  ask :: Reader r Bool\n  ask = Reader (\\_ -&gt; True) -- the function that returns True constantly\n  {- ... -}                             \n</code></pre>\n\n<pre><code>instance MonadReader String (Reader r) where\n--                   ^^^^^^         ^\n--                   |              |- This is read-state type in the user defined newtype \n--                   |- this is the read-state type in the type class definition\n  ask :: Reader r String\n  ask = Reader (\\_ -&gt; \"ThisIsBroken\") -- the function that returns \"ThisIsBroken\" constantly\n  {- ... -}                             \n</code></pre>\n\n<p>So if I had a value <code>val :: ReaderT Int IO Double</code> what would be the result of <code>ask</code>. We'd need to specify a type signature as below</p>\n\n<pre><code>val :: Reader Int Double\nval = do\n  r &lt;- ask :: Reader Int String\n  liftIO $ putStrLn r   -- Just imagine you can use liftIO\n  return 1.0\n\n&gt; val `runReader` 1\n\"ThisIsBroken\"\n1.0\n\nval :: Reader Int Double\nval = do\n  r &lt;- ask :: Reader Int Bool\n  liftIO $ print r   -- Just imagine you can use liftIO\n  return 1.0\n\n&gt; val `runReader` 1\nTrue\n1.0\n</code></pre>\n\n<p>Aside from being senseless, it is unconvinient to be specifiying the type over and over.</p>\n\n<p>As a conclusion using the actual definition of <code>ReaderT</code>. When you have something like <code>val :: ReaderT String IO Int</code> the functional dependency says <em>Such a type might have only one single instance of <code>MonadReader</code> typeclass</em> which is defined to be the one that uses <code>String</code> as <code>r</code></p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1574278799, "creation_date": 1574278799, "answer_id": 58962132, "question_id": 58947160, "link": "https://stackoverflow.com/questions/58947160/why-is-functionaldependency-needed-for-defining-monadreader/58962132#58962132", "title": "Why is FunctionalDependency needed for defining MonadReader?", "body": "<p>This is not really an answer, but it's much too long for a comment. You are correct that it's possible to define the <code>MonadReader</code> class without a fundep. In particular, the type signature of each method determines every class parameter. It would be quite possible to define a finer hierarchy.</p>\n\n<pre><code>class MonadReaderA r m where\n  askA :: m r\n  askA = readerA id\n\n  readerA :: (r -&gt; a) -&gt; m a\n  readerA f = f &lt;$&gt; askA\n\n-- This effect is somewhat different in\n-- character and requires special lifting.\nclass MonadReaderA r m =&gt; MonadReaderB r m where\n  localB :: (r -&gt; r) -&gt; m a -&gt; m a\n\nclass MonadReaderB r m\n  =&gt; MonadReader r m | m -&gt; r\n\nask :: MonadReader r m =&gt; m r\nask = askA\n\nreader\n  :: MonadReader r m\n  =&gt; (r -&gt; a) -&gt; m a\nreader = readerA\n\nlocal\n  :: MonadReader r m\n  =&gt; (r -&gt; r) -&gt; m a -&gt; m a\nlocal = localB\n</code></pre>\n\n<p>The main problem with this approach is that users have to write a bunch of instances.</p>\n"}], "owner": {"reputation": 9554, "user_id": 4794308, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a25aee790dd8743107c266f2c3d8850c?s=128&d=identicon&r=PG&f=1", "display_name": "Lifu Huang", "link": "https://stackoverflow.com/users/4794308/lifu-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 58950080, "answer_count": 3, "score": 8, "last_activity_date": 1574541736, "creation_date": 1574226899, "last_edit_date": 1574541736, "question_id": 58947160, "link": "https://stackoverflow.com/questions/58947160/why-is-functionaldependency-needed-for-defining-monadreader", "title": "Why is FunctionalDependency needed for defining MonadReader?", "body": "<p>I just managed to understand the definition of the class <code>MonadReader</code></p>\n\n<pre><code>class Monad m =&gt; MonadReader r m | m -&gt; r where\n...\n</code></pre>\n\n<p>After reading the document of Functional Dependency in Haskell, now I can understand that <code>| m -&gt; r</code> specifies that type variable <code>r</code> is uniquely decided by <code>m</code>. I think this requirement is reasonable based on the few typical instances of MonadReader I have seen so far (e.g. <code>Reader</code>), but it seems to me that we can still define instances like <code>Reader</code> even without this functional dependency clause.</p>\n\n<p>My question is why we need functional dependency in the definition of MonadReader? Is this functionally necessary for defining MonadReader in a sense that MonadReader cannot be properly defined without it, or it is merely a restriction to limit the ways how MonadReader can be used so that the instances of MonadReader will all behave in a certain expected way?</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 1, "last_activity_date": 1574325713, "creation_date": 1574325713, "answer_id": 58970565, "question_id": 58946088, "link": "https://stackoverflow.com/questions/58946088/trouble-cabal-installing-http-conduit/58970565#58970565", "title": "Trouble cabal installing http-conduit", "body": "<p>It looks like you have a dependency conflict, one package requires a different version than the package you are trying to install. This can be very difficult to solve for new users.</p>\n\n<p>If you are new to Haskell and want to start using dependencies from <a href=\"https://hackage.haskell.org/\" rel=\"nofollow noreferrer\">Hackage</a>, the centralized package archive for Haskell, I recommend using stack (<a href=\"https://docs.haskellstack.org/en/stable/install_and_upgrade/\" rel=\"nofollow noreferrer\">install instructions</a> and <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">basic workflow</a>. <code>stack</code> is a tool built on top of <code>cabal</code> that includes a curated list of package versions that are compatible. It should make it easier for you to get started.</p>\n"}], "owner": {"reputation": 3991, "user_id": 6378530, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5325e39f6f9f2d12029b11d4f8e56a69?s=128&d=identicon&r=PG&f=1", "display_name": "doctopus", "link": "https://stackoverflow.com/users/6378530/doctopus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574325713, "creation_date": 1574219760, "question_id": 58946088, "link": "https://stackoverflow.com/questions/58946088/trouble-cabal-installing-http-conduit", "title": "Trouble cabal installing http-conduit", "body": "<p>When I run <code>cabal install http-conduit</code>, I get the following:</p>\n\n<pre><code>Resolving dependencies...\ncabal: Could not resolve dependencies:\n[__0] trying: base-4.12.0.0/installed-4.1... (user goal)\n[__1] trying: ghc-8.6.5/installed-8.6... (user goal)\n[__2] next goal: process (user goal)\n[__2] rejecting: process-1.6.7.0 (constraint from user target requires\n==1.6.6.0)\n[__2] rejecting: process-1.6.6.0 (conflict: ghc =&gt;\nprocess==1.6.5.0/installed-1.6...)\n[__2] rejecting: process-1.6.5.1, process-1.6.5.0/installed-1.6...,\nprocess-1.6.5.0, process-1.6.4.0, process-1.6.3.0, process-1.6.2.0,\nprocess-1.6.1.0, process-1.6.0.0, process-1.5.0.0, process-1.4.3.0,\nprocess-1.4.2.0, process-1.4.1.0, process-1.4.0.0, process-1.3.0.0,\nprocess-1.2.3.0, process-1.2.2.0, process-1.2.1.0, process-1.2.0.0,\nprocess-1.1.0.2, process-1.1.0.1, process-1.1.0.0, process-1.0.1.5,\nprocess-1.0.1.4, process-1.0.1.3, process-1.0.1.2, process-1.0.1.1,\nprocess-1.0.0.0 (constraint from user target requires ==1.6.6.0)\n[__2] fail (backjumping, conflict set: ghc, process)\nAfter searching the rest of the dependency tree exhaustively, these were the\ngoals I've had most trouble fulfilling: process, base, ghc\n</code></pre>\n\n<p>I'm running cabal v3.0.0.0 and ghc v8.6.5</p>\n\n<p>I'm quite new to the Haskell ecosystem, so any help I could get would be greatly appreciated. Thanks!</p>\n"}, {"tags": ["haskell", "servant"], "answers": [{"comments": [{"owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "edited": false, "score": 0, "creation_date": 1574212834, "post_id": 58945222, "comment_id": 104148805, "body": "Are you sure this works for Server as well ? I tried using :&lt;|&gt; there instead of + in my example and I get a type error."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "edited": false, "score": 0, "creation_date": 1574212943, "post_id": 58945222, "comment_id": 104148832, "body": "ah, on closer inspection of your example, you have the <code>clientAPI</code> and <code>serverAPI</code> in the wrong order. They must be in the same order in your server declaration as in your type-level API declaration."}, {"owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "edited": false, "score": 0, "creation_date": 1574244054, "post_id": 58945222, "comment_id": 104159240, "body": "Makes sense, thanks - I&#39;ll give it a go after work, at home :)."}, {"owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "edited": false, "score": 0, "creation_date": 1574294713, "post_id": 58945222, "comment_id": 104185526, "body": "OK, it works. Thank you.  And sorry - turned out to be such an easy thing. I&#39;m relatively new to Haskell, almost every solution to common problems I find keep on turning my brain inside out and I assumed this problem is non-trivial as well."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "edited": false, "score": 0, "creation_date": 1574294895, "post_id": 58945222, "comment_id": 104185573, "body": "No need to apologise at all, I&#39;m also relatively new to Haskell (at least for &quot;real&quot; use rather than basic exercises) and can totally sympathise with that point of view!"}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 3, "last_activity_date": 1574213055, "last_edit_date": 1574213055, "creation_date": 1574212521, "answer_id": 58945222, "question_id": 58945153, "link": "https://stackoverflow.com/questions/58945153/combine-two-servant-servers/58945222#58945222", "title": "Combine two Servant Servers", "body": "<p>Yes, the <code>(:&lt;|&gt;)</code> combinator that you use to combine your different API routes at the type level also works at the value level for combining handlers.</p>\n\n<p>See the <a href=\"https://hackage.haskell.org/package/servant-0.16.2/docs/Servant-API.html#v::-60--124--62-\" rel=\"nofollow noreferrer\">Hackage docs</a> and <a href=\"https://haskell-servant.readthedocs.io/en/stable/tutorial/Server.html#more-endpoints\" rel=\"nofollow noreferrer\">Servant tutorial</a></p>\n\n<p>So simply replace the <code>+</code> in your <code>api</code> with <code>&lt;|&gt;</code> and you should be good to go.</p>\n\n<p>EDIT: Except that order matters. The handlers in the value representing your server must be in the same order as the different routes in the type-level API declaration. So it should work if you define <code>api = serverAPI &lt;|&gt; clientAPI</code>.</p>\n"}], "owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 58945222, "answer_count": 1, "score": 1, "last_activity_date": 1574213055, "creation_date": 1574212001, "question_id": 58945153, "link": "https://stackoverflow.com/questions/58945153/combine-two-servant-servers", "title": "Combine two Servant Servers", "body": "<p>According to Servant's manual <a href=\"https://haskell-servant.readthedocs.io/en/master/tutorial/Server.html\" rel=\"nofollow noreferrer\">https://haskell-servant.readthedocs.io/en/master/tutorial/Server.html</a> a very simple Server can be created that way:</p>\n\n<pre><code>type UserAPI1 = \"users\" :&gt; Get '[JSON] [User]\n\nserver1 :: Server UserAPI1\nserver1 = return users1\n\nuserAPI :: Proxy UserAPI1\nuserAPI = Proxy\n</code></pre>\n\n<p>I noticed, that I it doable to keep API parts separated and combine them together later on, e.g.</p>\n\n<pre><code>type ClientAPI = \n    \"users\" :&gt; Get '[HTML] (Html ()) \n\ntype ServerAPI = \n    \"users\" :&gt; Get '[JSON] [User] \n-- works fine\ntype API = (\"api\" :&gt; ServerAPI) :&lt;|&gt; ClientAPI\n</code></pre>\n\n<p>Can I do the same with Server values ? I can't find an easy way to join two \"servers\" together:</p>\n\n<pre><code>clientAPI :: Server ClientAPI\nclientAPI = usersView \n\nserverAPI :: Server ServerAPI\nserverAPI = fetchUsers\n\napi :: Server API\n-- doesn't work - is there a way to combine two servers together ?\napi = clientAPI + serverAPI\n</code></pre>\n"}, {"tags": ["unit-testing", "haskell", "hspec"], "answers": [{"comments": [{"owner": {"reputation": 1290, "user_id": 3088888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b7e0846120d52a1322e4b9ad743bb8?s=128&d=identicon&r=PG&f=1", "display_name": "mjarosie", "link": "https://stackoverflow.com/users/3088888/mjarosie"}, "edited": false, "score": 0, "creation_date": 1574295582, "post_id": 58945497, "comment_id": 104185747, "body": "I just double-checked - when instead of running <code>stack build --test</code> I put <code>src&#47;Lib.hs</code> file and <code>test&#47;Spec.hs</code> file in the top directory and following the Hspec tutorial I invoke <code>stack exec -- runhaskell Spec.hs</code> WITH the module definition (uncommented) it doesn&#39;t throw an error. Now it&#39;s even more confusing : P"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 1290, "user_id": 3088888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b7e0846120d52a1322e4b9ad743bb8?s=128&d=identicon&r=PG&f=1", "display_name": "mjarosie", "link": "https://stackoverflow.com/users/3088888/mjarosie"}, "edited": false, "score": 0, "creation_date": 1574309949, "post_id": 58945497, "comment_id": 104189118, "body": "That IS very confusing."}, {"owner": {"reputation": 1290, "user_id": 3088888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b7e0846120d52a1322e4b9ad743bb8?s=128&d=identicon&r=PG&f=1", "display_name": "mjarosie", "link": "https://stackoverflow.com/users/3088888/mjarosie"}, "edited": false, "score": 0, "creation_date": 1574334322, "post_id": 58945497, "comment_id": 104200333, "body": "Is that possible that <code>runhaskell</code> (which as far as I understand is an alias of <code>runghc</code> and is a way to run Haskell programs without compiling them) extracts whatever the module is called and somehow overwrites the <code>main-is</code> option with it?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 1290, "user_id": 3088888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b7e0846120d52a1322e4b9ad743bb8?s=128&d=identicon&r=PG&f=1", "display_name": "mjarosie", "link": "https://stackoverflow.com/users/3088888/mjarosie"}, "edited": false, "score": 0, "creation_date": 1574339335, "post_id": 58945497, "comment_id": 104203167, "body": "Yes definitely."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1574214819, "last_edit_date": 1592644375, "creation_date": 1574214819, "answer_id": 58945497, "question_id": 58944736, "link": "https://stackoverflow.com/questions/58944736/hspec-defined-tests-invoked-with-stack-throw-an-error-when-test-file-is-defined/58945497#58945497", "title": "hspec defined tests invoked with stack throw an error when test file is defined as a module", "body": "<p>It's part of Haskell the language.</p>\n<blockquote>\n<p>A Haskell program is a collection of modules, one of which, by convention, must be called <code>Main</code> and must export the value <code>main</code>.</p>\n<p>An abbreviated form of module, consisting only of the module body, is permitted. If this is used, the header is assumed to be <code>module Main(main) where</code>.</p>\n<hr />\n<p>The Haskell 2010 report, section 5 (Modules) <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch5.html#x11-980005\" rel=\"nofollow noreferrer\">https://www.haskell.org/onlinereport/haskell2010/haskellch5.html#x11-980005</a></p>\n</blockquote>\n<hr />\n<p>See also the cabal documentation, about the configuration that <code>package.yaml</code> is a proxy for, the field containing the test/executable file:</p>\n<blockquote>\n<p><code>main-is</code>: (...)  while the name of the file may vary, the module itself must be named Main.</p>\n<hr />\n<p><a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#pkg-field-executable-main-is\" rel=\"nofollow noreferrer\">https://www.haskell.org/cabal/users-guide/developing-packages.html#pkg-field-executable-main-is</a></p>\n</blockquote>\n<hr />\n<p>GHC has an option <code>-main-is MyModule.mymain</code> to override this behavior (<a href=\"https://downloads.haskell.org/%7Eghc/latest/docs/html/users_guide/phases.html#ghc-flag--main-is%20%E2%9F%A8thing%E2%9F%A9\" rel=\"nofollow noreferrer\">documented in the GHC user guide</a>).</p>\n"}], "owner": {"reputation": 1290, "user_id": 3088888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b7e0846120d52a1322e4b9ad743bb8?s=128&d=identicon&r=PG&f=1", "display_name": "mjarosie", "link": "https://stackoverflow.com/users/3088888/mjarosie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 1, "accepted_answer_id": 58945497, "answer_count": 1, "score": 3, "last_activity_date": 1574214819, "creation_date": 1574208444, "question_id": 58944736, "link": "https://stackoverflow.com/questions/58944736/hspec-defined-tests-invoked-with-stack-throw-an-error-when-test-file-is-defined", "title": "hspec defined tests invoked with stack throw an error when test file is defined as a module", "body": "<p>I'm trying to get my head around the reason why the test file containing unit-tests which is defined as a module fails when run with <code>stack build --test</code>.</p>\n\n<p>Say having a simple test module defined from scratch with:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>stack new test-module\ncd test-module\n\nvim package.yaml # remove \"executables\" section, add \"hspec\" as tests dependency\n</code></pre>\n\n<p>Following \"<a href=\"https://hspec.github.io/getting-started.html\" rel=\"nofollow noreferrer\">getting started</a>\" instructions from Hspec documentation I've modified files such as:</p>\n\n<h3>Step 1: Describe your desired behavior</h3>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- file test/Spec.hs\n\nmodule LibSpec where\n\nimport Test.Hspec\nimport Lib\n\nmain :: IO ()\nmain = hspec $ do\n    describe \"divides\" $ do\n        it \"returns True when the first number divides the second\" $\n           2 `divides` 4 `shouldBe` True\n</code></pre>\n\n<h3>Step 2: Write some code</h3>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- file src/Lib.hs\n\nmodule Lib (divides) where\n\ndivides :: Integer -&gt; Integer -&gt; Bool\ndivides d n = rem n d == 0\n</code></pre>\n\n<p>Running <code>stack build --test</code> throws the following error:</p>\n\n<pre><code>&lt;no location info&gt;: error:\n    output was redirected with -o, but no output will be generated\nbecause there is no Main module.\n</code></pre>\n\n<p>When I comment out the \"module definition\" line from the <code>test/Spec.hs</code> file the build succeeds and the unit-test passes:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- file test/Spec.hs\n\n-- Notice the next line is commented out:\n-- module LibSpec where\n\nimport Test.Hspec\nimport Lib\n\nmain :: IO ()\nmain = hspec $ do\n    describe \"divides\" $ do\n        it \"returns True when the first number divides the second\" $\n           2 `divides` 4 `shouldBe` True\n</code></pre>\n\n<p>Is that Hspec related or Stack related? Or maybe am I missing something obvious?</p>\n"}, {"tags": ["haskell", "types", "typeclass", "type-constraints"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1574204886, "post_id": 58944199, "comment_id": 104146886, "body": "Put type signatures on all your variables. The error messages will become much more helpful."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1574244736, "post_id": 58944199, "comment_id": 104159667, "body": "it&#39;s better if there is just one, focused question per question."}, {"owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1574272855, "post_id": 58944199, "comment_id": 104176552, "body": "@WillNess, are you referring to me asking side question in the comments?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1574280148, "post_id": 58944199, "comment_id": 104180097, "body": "I&#39;m referring to the question itself. when a question is focused on one specific thing it is much easier to write - and then read and interpret - an answer. it is OK to post multiple different questions about the same piece of code."}], "answers": [{"comments": [{"owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1574236214, "post_id": 58945074, "comment_id": 104155086, "body": "Concerning your suggestion on reading comments, the last error is <code>No instance for (Floating Integer) arising from a use of \u2018sqrt\u2019</code>; what does this mean? That the interpreter expected <code>x</code> to be both <code>Floating</code> and <code>Integer</code>?"}, {"owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1574236352, "post_id": 58945074, "comment_id": 104155143, "body": "Also, what makes the code compile if the lambda does not use both <code>x</code> and <code>e</code> in my attempt? I&#39;m thinking to something possibly nonsensical like <code>(\\e -&gt; e &gt; 0)</code>. Why with such a lamda the error is not triggered?"}, {"owner": {"reputation": 716, "user_id": 4803382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1xwqI.jpg?s=128&g=1", "display_name": "dccsillag", "link": "https://stackoverflow.com/users/4803382/dccsillag"}, "reply_to_user": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1574236826, "post_id": 58945074, "comment_id": 104155363, "body": "@EnricoMariaDeAngelis <code>No instance for (Floating Integer) [...]</code> means that the <i>type</i> <code>Integer</code> isn&#39;t in the <i>typeclass</i> <code>Floating</code>. It uses this notation because instance declarations in Haskell follow the syntax <code>instance TypeClass Type</code>."}, {"owner": {"reputation": 716, "user_id": 4803382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1xwqI.jpg?s=128&g=1", "display_name": "dccsillag", "link": "https://stackoverflow.com/users/4803382/dccsillag"}, "reply_to_user": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1574236987, "post_id": 58945074, "comment_id": 104155435, "body": "@EnricoMariaDeAngelis As for your second question, the problem arises when using both because (in your code) <code>x</code> is a <code>Floating</code> type and <code>e</code> is an <code>Integral</code> type. If you look for the type of <code>mod</code>, you&#39;ll see that both of its operands must be of the same type, which is not happening (<code>Floating</code> and <code>Integral</code> are meant to be exclusive, as far as I know)"}], "tags": [], "owner": {"reputation": 716, "user_id": 4803382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1xwqI.jpg?s=128&g=1", "display_name": "dccsillag", "link": "https://stackoverflow.com/users/4803382/dccsillag"}, "is_accepted": true, "score": 2, "last_activity_date": 1574211350, "creation_date": 1574211350, "answer_id": 58945074, "question_id": 58944199, "link": "https://stackoverflow.com/questions/58944199/understanding-type-related-haskell-errors-when-using-sqrt/58945074#58945074", "title": "Understanding type-related Haskell errors when using sqrt", "body": "<p>There are a few places where you seem to be a little confused in whether you are using an <code>Integral</code> type or a <code>RealFrac</code> one. A good technique to make sure you don't confuse yourself is to use type annotations.</p>\n\n<p>To start off, what is the input and output of the function you are creating, <code>largestprime</code>? IMO, it should be integral types on both ends, since it doesn't make sense to talk about prime factors if you have non-integers.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>largestprime :: Integral a =&gt; a -&gt; a\n</code></pre>\n\n<p>So, then we want to find the square root of the input. Unfortunately, <code>sqrt</code> doesn't belong to <code>Integral</code>, but to <code>Floating</code> (just run <code>:i sqrt</code> in GHCi). What we can do instead is use the <code>fromIntegral</code> function, which has the following type signature:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>fromIntegral :: (Integral a, Num b) =&gt; a -&gt; b\n</code></pre>\n\n<p>So in order to find the square root of our integer, we have to use <code>sqrt . fromIntegral</code>. To check if the number is a square, we can do</p>\n\n<pre><code>isSquare = let y = fromIntegral x in sqrt y == fromIntegral (floor $ sqrt y)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>isSquare = let y = fromIntegral x in ceiling (sqrt y) == floor (sqrt y)\n</code></pre>\n\n<p>So far, we've got the \"is a perfect square\" case figured out and working. Next up is the rest.</p>\n\n<p>The list of candidates for us to check for divisibility is <code>[i, i-2 ..]</code> for <code>i</code> being as you've defined. So, following your code, we first filter for those that divide <code>x</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>filter (\\n -&gt; x `mod` n == 0) [i, i-2, ..]\n</code></pre>\n\n<p>We want the first number that matches our criteria (that is, wasn't filtered). So, just as you did, we take the <code>head</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>head $ filter (\\n -&gt; x `mod` n == 0) [i, i-2, ..]\n</code></pre>\n\n<p>The whole function is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>largestprime :: Integral a =&gt; a -&gt; a\nlargestprime x  | isSquare  = root\n                | otherwise = head $ filter (\\n -&gt; x `mod` n == 0) [i, i-2 ..]\n    where   isSquare = let y = fromIntegral x in ceiling (sqrt y) == floor (sqrt y)\n            root     = floor $ sqrt $ fromIntegral x\n            i        = if odd root then root else root - 1\n</code></pre>\n\n<p>And now we've got a function that compiles successfully. I didn't really cover this in this answer, but a tip to solving GHC errors is to go from the bottom &mdash; always fix the last error first. In your case, you would've seen right off that <code>sqrt x</code> complains that <code>x</code> isn't a <code>Floating</code> type.</p>\n\n<p>I just think it's also worth quickly mentioning that your algorithm does not do what you think it does. Sure, it will return one of its factors, but it's not necessarily prime (<code>largestprime 36</code> gives <code>6</code>, which isn't prime).</p>\n"}, {"comments": [{"owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1574278144, "post_id": 58950495, "comment_id": 104179102, "body": "What specific &quot;incarnation&quot; of the script are you referring to in your first chunk of code?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1574280213, "post_id": 58950495, "comment_id": 104180122, "body": "I have no chunks of code in my answer. I loaded your definition of <code>largestprime x ... = ...</code> (the only one there is in your question), and then issued a <code>:t</code> command at GHCi&#39;s prompt, then copy-pasted the command and the response."}, {"owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1574282665, "post_id": 58950495, "comment_id": 104181218, "body": "But that gives an error which ends with <code>Failed, no modules loaded</code>, how could you then run <code>:t largestprimve</code> successfully? (I&#39;m sorry, by <i>chunck of code</i> I meant <i>chunk of code-formatted text</i>.)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1574283250, "post_id": 58950495, "comment_id": 104181499, "body": "<a href=\"https://repl.it/repls/DearestLeftQueryplan\" rel=\"nofollow noreferrer\">here</a> I had to make one small change to make it compile, changing <code>fromInteger</code> to <code>fromIntegral</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1574283841, "post_id": 58950495, "comment_id": 104181757, "body": "<a href=\"https://repl.it/repls/GeneralLoathsomeLint\" rel=\"nofollow noreferrer\">another</a> way to make it work without any changes to the code, is with the NoMonomorphismRestriction pragma (this means you have the Monomorphism Restriction enabled on your installation; the pragma removes the restriction) . then <code>:t largestprime</code> shows that same type, even in the repl.it window."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1574245572, "last_edit_date": 1574245572, "creation_date": 1574240894, "answer_id": 58950495, "question_id": 58944199, "link": "https://stackoverflow.com/questions/58944199/understanding-type-related-haskell-errors-when-using-sqrt/58950495#58950495", "title": "Understanding type-related Haskell errors when using sqrt", "body": "<p>Having defined your function, check its type right away:</p>\n\n<pre><code>&gt; :t largestprime\nlargestprime :: (RealFrac c, Integral c, Floating c) =&gt; c -&gt; c\n</code></pre>\n\n<p>Here's the problem right there: its type demands an input value's type to be an <code>Integral</code> and also a <code>Floating</code> and <code>RealFrac</code> type at the same time.</p>\n\n<p>Why? Because the same <code>x</code> is used as input to <code>mod</code> and <code>sqrt</code> (and, inside <code>intsqrt</code>, to <code>floor</code>):</p>\n\n<pre><code>&gt; :t mod\nmod   ::  Integral a              =&gt; a -&gt; a -&gt; a\n\n&gt; :t sqrt\nsqrt  ::  Floating a              =&gt; a -&gt; a\n\n&gt; :t floor\nfloor :: (RealFrac a, Integral b) =&gt;      a -&gt; b\n\n&gt; :t floor . sqrt\nfloor . sqrt :: (RealFrac a, \n          Integral b, Floating a) =&gt; a -&gt;      b\n</code></pre>\n\n<p>Why did it compile? Because theoretically you could define - in some other module - a type which is an instance of all the typeclasses in the constraint, and use this function with it.</p>\n\n<p>The errors <code>No instance for (RealFrac Integer)</code> and <code>No instance for (Floating Integer)</code> just mean that you haven't done so (your <code>Integral</code> has defaulted to <code>Integer</code>).</p>\n"}], "owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 58945074, "answer_count": 2, "score": 2, "last_activity_date": 1574245572, "creation_date": 1574204659, "last_edit_date": 1574244417, "question_id": 58944199, "link": "https://stackoverflow.com/questions/58944199/understanding-type-related-haskell-errors-when-using-sqrt", "title": "Understanding type-related Haskell errors when using sqrt", "body": "<p>I've been reading <a href=\"http://learnyouahaskell.com\" rel=\"nofollow noreferrer\">Learn You a Haskell</a> for a few days (chaps 1-6) and there are several things, even in the land of newbies, which are not clear to me.</p>\n\n<p>For instance, I've been trying to implement a script to solve <a href=\"https://projecteuler.net/problem=3\" rel=\"nofollow noreferrer\">this classic problem</a> of finding the largest prime factor of an integer.</p>\n\n<p>I'm pretty sure my approach,</p>\n\n<ul>\n<li>check if the number is a square and return its square root if so,</li>\n<li>otherwise search for divisors downward from its square root, scanning only odd numbers,</li>\n</ul>\n\n<p><s>is probably not the right one,</s> <strong>is plainly wrong</strong>, as pointed out in the answer and the comments (I hope I would have realized this myself, if I had been able to write a compilable code), but at least it's being a chance to practice Haskell's syntax and not only.</p>\n\n<p>The only commented line is the one with which I'm having issue. What is \"strange\" to me, is that the errors are about the two lines just after that, whereas everything works fine if I change the lamda to something which does not use both <code>x</code> and <code>e</code> (except that the result is wrong, clearly).</p>\n\n<pre><code>largestprime x\n  | isSquare = srx\n  | otherwise = head $ filter (\\e -&gt; x `mod` e == 0) lst --Lambda\n    where intsqrt = floor . sqrt\n          isSquare = sqrt x == fromInteger(intsqrt x)\n          srx = intsqrt x\n          lst = [i,i-2..]\n            where i = if odd srx then srx else srx - 1\n</code></pre>\n\n<p>My understanding is that something is wrong with the types that are deduced for <code>e</code> and <code>x</code>, however the error is not very helpful, given my current level:</p>\n\n<pre><code>Main.hs:59:21: error:\n    \u2022 No instance for (RealFrac Integer) arising from a use of \u2018floor\u2019\n    \u2022 In the first argument of \u2018(.)\u2019, namely \u2018floor\u2019\n      In the expression: floor . sqrt\n      In an equation for \u2018intsqrt\u2019: intsqrt = floor . sqrt\n   |\n59 |     where intsqrt = floor . sqrt\n   |                     ^^^^^\n\nMain.hs:59:29: error:\n    \u2022 No instance for (Floating Integer) arising from a use of \u2018sqrt\u2019\n    \u2022 In the second argument of \u2018(.)\u2019, namely \u2018sqrt\u2019\n      In the expression: floor . sqrt\n      In an equation for \u2018intsqrt\u2019: intsqrt = floor . sqrt\n   |\n59 |     where intsqrt = floor . sqrt\n   |                             ^^^^\n\nMain.hs:60:22: error:\n    \u2022 No instance for (Floating Integer) arising from a use of \u2018sqrt\u2019\n    \u2022 In the first argument of \u2018(==)\u2019, namely \u2018sqrt x\u2019\n      In the expression: sqrt x == fromInteger (intsqrt x)\n      In an equation for \u2018isSquare\u2019:\n          isSquare = sqrt x == fromInteger (intsqrt x)\n   |\n60 |           isSquare = sqrt x == fromInteger(intsqrt x)\n   |                      ^^^^^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>Concerning <code>e</code>, it is an element of <code>lst</code>, which is a list whose elements are of the same type as <code>srx</code>, which is the type in output from <code>floor</code>, which based on <code>:t floor</code> seems to be <code>Integral</code>. So maybe I just have to define the type of <code>largestprime</code> appropriately?</p>\n\n<p>I've seen some questions exist already on the topic, like <a href=\"https://stackoverflow.com/a/1304521/5825294\">this one</a> or <a href=\"https://stackoverflow.com/questions/18547341/haskell-sqrt-type-error\">this one</a>. However I'm a bit confused at the moment.</p>\n\n<p>Besides receiving help so that I can solve the problem, it'd be also nice to receive some advices on how to read those errors, which at the moment are close to arabic for me.</p>\n"}, {"tags": ["function", "haskell", "visual-studio-code", "first-class-functions"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1574201094, "post_id": 58943483, "comment_id": 104145574, "body": "What are you actually trying to do? The fundamental problem is that <code>twice ++ &quot;H&quot;</code> is trying to append a string to a function, which doesn&#39;t really make any sense at all. I suspect you might have meant <code>twice (++ &quot;H&quot;)</code> which is applying the function <code>twice</code> to a function. That would &quot;work&quot; in that it would compile, but then you would have a <code>main</code> of type <code>IO (String -&gt; String)</code> which doesn&#39;t really make much sense either. (It would certainly have no observable effect when ran.) Do you want to just define a function <code>g = twice (++ &quot;H&quot;)</code> and play around with it? If so, just do that."}, {"owner": {"reputation": 364, "user_id": 7076615, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Ws6O9.jpg?s=128&g=1", "display_name": "StudySmarterNotHarder", "link": "https://stackoverflow.com/users/7076615/studysmarternotharder"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574201432, "post_id": 58943483, "comment_id": 104145728, "body": "@RobinZigmond the general problem is.  I&#39;m looking at examples from: <a href=\"http://learnyouahaskell.com/higher-order-functions\" rel=\"nofollow noreferrer\">learnyouahaskell.com/higher-order-functions</a> and they&#39;re not working at least not as explicitly written."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1574203811, "post_id": 58943483, "comment_id": 104146547, "body": "Thank you for the link (I have been through LYAH several times, although not for a while - it was my entry point into Haskell - and I dind&#39;t recognise this example). It looks like you&#39;re trying to experiment with the function called <code>applyTwice</code> in that chapter. Yet your attempt looks nothing like the examples in the book, so I advise you to look closer at those (for one thing, in those examples there is no <code>main</code> in sight - as far as I remember most examples in LYAH are designed to be ran in GHCi after loading the appropriate function definitions from a file)."}], "answers": [{"tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 4, "last_activity_date": 1574202261, "creation_date": 1574202261, "answer_id": 58943769, "question_id": 58943483, "link": "https://stackoverflow.com/questions/58943483/type-mismatch-on-basic-apply-twice-hello-world-in-haskell/58943769#58943769", "title": "Type mismatch on basic &quot;apply twice&quot; hello world in Haskell", "body": "<p>As RobinZigmond mentions in the comments, you can\u2019t write <code>twice ++ \"H\"</code>. This means, \u2018take the function <code>twice</code>, and append the string <code>\"H\"</code> to it\u2019. This is clearly impossible, since <code>++</code> can only append strings and lists together. I suspect that what you meant was <code>twice (++ \"H\")</code>. This takes the function <code>(++ \"H\")</code>, which appends <code>\"H\"</code> to the end of its argument, and runs it twice.</p>\n\n<p>But even if you do this, there is still a problem. Take a look at the program which is created if you do this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>twice :: (a -&gt; a) -&gt; a -&gt; a\ntwice f = f . f\n\nmain = do\n   return (twice (++ \"H\"))\n</code></pre>\n\n<p>Even though this program compiles, it doesn\u2019t do anything! You have set <code>twice (++ \"H\"))</code> as the return value of <code>main</code>, but the return value of <code>main</code> is always ignored. In order to produce output, you need to use <code>putStrLn</code> instead of <code>return</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>twice :: (a -&gt; a) -&gt; a -&gt; a\ntwice f = f . f\n\nmain = do\n   putStrLn (twice (++ \"H\"))\n</code></pre>\n\n<p>But this program doesn\u2019t work either! <code>twice (++ \"H\")</code> is a function, which cannot be printed. This function must be applied to a value in order to produce a result:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>twice :: (a -&gt; a) -&gt; a -&gt; a\ntwice f = f . f\n\nmain = do\n   putStrLn (twice (++ \"H\") \"Starting value\")\n</code></pre>\n\n<p>This program should finally work, giving an output of <code>Starting valueHH</code> when it is run.</p>\n"}], "owner": {"reputation": 364, "user_id": 7076615, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Ws6O9.jpg?s=128&g=1", "display_name": "StudySmarterNotHarder", "link": "https://stackoverflow.com/users/7076615/studysmarternotharder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 58943769, "answer_count": 1, "score": 0, "last_activity_date": 1574202261, "creation_date": 1574200890, "question_id": 58943483, "link": "https://stackoverflow.com/questions/58943483/type-mismatch-on-basic-apply-twice-hello-world-in-haskell", "title": "Type mismatch on basic &quot;apply twice&quot; hello world in Haskell", "body": "<p>The minimal code:</p>\n\n<pre><code>twice :: (a -&gt; a) -&gt; a -&gt; a\ntwice f = f . f\n\nmain = do\n   return twice ++ \"H\"\n</code></pre>\n\n<p>The errors generated:</p>\n\n<pre><code>stack runhaskell \"c:\\Users\\FruitfulApproach\\Desktop\\Haskell\\test.hs\"\n\nC:\\Users\\FruitfulApproach\\Desktop\\Haskell\\test.hs:5:1: error:\n    * Couldn't match expected type `IO t0'\n                  with actual type `[(a0 -&gt; a0) -&gt; a0 -&gt; a0]'\n    * In the expression: main\n      When checking the type of the IO action `main'\n  |\n5 | main = do\n  | ^\n\nC:\\Users\\FruitfulApproach\\Desktop\\Haskell\\test.hs:6:20: error:\n    * Couldn't match type `Char' with `(a -&gt; a) -&gt; a -&gt; a'\n      Expected type: [(a -&gt; a) -&gt; a -&gt; a]\n        Actual type: [Char]\n    * In the second argument of `(++)', namely `\"H\"'\n      In a stmt of a 'do' block: return twice ++ \"H\"\n      In the expression: do return twice ++ \"H\"\n    * Relevant bindings include\n        main :: [(a -&gt; a) -&gt; a -&gt; a]\n          (bound at C:\\Users\\FruitfulApproach\\Desktop\\Haskell\\test.hs:5:1)\n  |\n6 |    return twice ++ \"H\"\n  |                    ^^^\n</code></pre>\n\n<p>How would I logically fix this issue myself?  Clearly it's something I'm doing wrong.  Am I missing a preamble that every example should have?</p>\n"}, {"tags": ["haskell", "generics"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1574227312, "post_id": 58942012, "comment_id": 104151925, "body": "The problem here is that sub-types of a given constructor are not guaranteed to also have instances of <code>HasDatatypeInfo</code>, so you can&#39;t necessarily traverse them in the same way. You can get access to the sub-types themselves via the <code>xs</code> list in <code>ConstructorInfo xs</code>, and you can use <code>para_SList</code> to fold over them, but you can&#39;t query whether each type has a <code>HasDatatypeInfo</code> instance as you do that. This is a pretty standard problem when trying to do dependent type-ish things in Haskell. There is no real RTTI. It may sometimes almost look like there is, but it&#39;s all smoke and mirrors."}, {"owner": {"reputation": 1518, "user_id": 439034, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/25bcd10eae437d11365ec0fb5483d354?s=128&d=identicon&r=PG", "display_name": "worldsayshi", "link": "https://stackoverflow.com/users/439034/worldsayshi"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1574355167, "post_id": 58942012, "comment_id": 104212892, "body": "Hmm, all the necessary type information should be available at compile time right? I&#39;m thinking I should be able to constrain with All or All2 constraints to <code>HasDatatypeInfo</code> types."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1574360102, "post_id": 58942012, "comment_id": 104215314, "body": "<code>ConstructorInfo</code> is at the term level, that&#39;s where types stop flowing. You can&#39;t require that the types wrapped inside <code>ConstructorInfo</code> have any constraints which are not already part of <code>ConstructorInfo</code> definition. And <code>HasDatatypeInfo</code> cannot be part of it, because then it would be impossible to construct <code>ConstructorInfo</code> for constructors that wrap any <code>HasDatatypeInfo</code>-lacking types."}, {"owner": {"reputation": 1518, "user_id": 439034, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/25bcd10eae437d11365ec0fb5483d354?s=128&d=identicon&r=PG", "display_name": "worldsayshi", "link": "https://stackoverflow.com/users/439034/worldsayshi"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1574363676, "post_id": 58942012, "comment_id": 104216977, "body": "I&#39;m puzzled by how <code>HasDatatypeInfo</code> is different to classes like <code>Show</code> in this regard. Deriving <code>Show</code> only works when all nested types are also in <code>Show</code>. Can I somehow make a class <code>HasDatatypeInfo2</code> that enforce my instances to implement <code>HasDatatypeInfo</code> &quot;all the way down&quot;?"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1574366379, "post_id": 58942012, "comment_id": 104218238, "body": "There&#39;s a lot here. First, the difference is that the compiler can automatically generate (i.e &quot;derive&quot;) instances of <code>Show</code> for you. If you ask the compiler to do so, it will indeed require that all included types already have a <code>Show</code> instance. But only immediately included ones, <i>not</i> all the way down. If, on the other hand, you don&#39;t ask the compiler to derive <code>Show</code> instances for you, but implement them manually instead, then there is no requirement of &quot;all the way down&quot;. The class itself does not have this requirement, only the compiler&#39;s derivation mechanism."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1574366507, "post_id": 58942012, "comment_id": 104218278, "body": "But the answer to your second question is yes: you can certainly set up a system of classes that will require recursion all the way down. But those will not be the same as <code>generics-sop</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1518, "user_id": 439034, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/25bcd10eae437d11365ec0fb5483d354?s=128&d=identicon&r=PG", "display_name": "worldsayshi", "link": "https://stackoverflow.com/users/439034/worldsayshi"}, "edited": false, "score": 0, "creation_date": 1574514551, "post_id": 58982807, "comment_id": 104264297, "body": "Awesome write up and response! Now I need unknown time to absorb this. :)"}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 3, "last_activity_date": 1574366162, "creation_date": 1574366162, "answer_id": 58982807, "question_id": 58942012, "link": "https://stackoverflow.com/questions/58942012/extract-nested-type-information-from-constructorinfo-of-generics-sop/58982807#58982807", "title": "Extract nested type information from ConstructorInfo of generics-sop", "body": "<p>A variant of the non-recursive function is required to define the recursive version, so let's start with that:</p>\n\n<pre><code>conNames_NP :: (Generic a, HasDatatypeInfo a) =&gt; Proxy a -&gt; NP (K Text) (Code a)\nconNames_NP p =\n  map_NP\n    (K . pack . constructorName)\n    (constructorInfo (datatypeInfo p))\n</code></pre>\n\n<p>It's mostly what you wrote, but the case distinction is not needed, because <code>constructorName</code> is provided by the library.</p>\n\n<p>Now let's define the recursive tree-based version, which will in general return an infinite tree. Also, in your example, datatype names suddenly appear in the tree structure. The semantics of that is unclear to me, so I'll produce a tree with only constructor names.</p>\n\n<pre><code>data Tree = Tree Text [Tree]\n</code></pre>\n\n<p>You need an additional class for all datatypes supporting this operation. This is because, as already brought up in the comments, you cannot (or better, don't want to) assume that every type recursively is an instance of <code>Generic</code> and <code>HasDatatypeInfo</code>. Primitive types such as <code>Char</code> or <code>Text</code> are not instances of these classes, yet they will probably occur in your datatypes somewhere.</p>\n\n<p>So we define</p>\n\n<pre><code>class ConNamesRecursive a where\n  conNamesRecursive :: Proxy a -&gt; [Tree]\n  default conNamesRecursive ::\n    (Generic a, HasDatatypeInfo a, All2 ConNamesRecursive (Code a))\n    =&gt; Proxy a -&gt; [Tree]\n  conNamesRecursive = gconNamesRecursive\n</code></pre>\n\n<p>The proxy is a matter of taste, as I'll be using type applications in the code below. I like to have proxies around as a reminder that a type argument will be needed.</p>\n\n<p>The definition of <code>gconNamesRecursive</code> is only tricky because constructor names are not intrinsically tied to the type they are a constructor from, so we have to somehow pass the type info correctly. I do this by introducing a number of helper functions:</p>\n\n<pre><code>gconNamesRecursive ::\n  forall a . (Generic a, HasDatatypeInfo a, All2 ConNamesRecursive (Code a))\n  =&gt; Proxy a -&gt; [Tree]\ngconNamesRecursive p =\n  collapse_NP (cmap_NP (Proxy @(All ConNamesRecursive)) go (conNames_NP p))\n  where\n    go :: forall xs . All ConNamesRecursive xs =&gt; K Text xs -&gt; K Tree xs\n    go = mapKK (\\ cn -&gt; Tree cn (concat (collapse_NP (conNamesRecursive_NP @xs))))\n</code></pre>\n\n<p>The generic definition starts from <code>conNames_NP</code> which is an n-ary product containing each constructor name for the top-level type, i.e., a <code>NP (K Text) (Code a)</code>. If we map over this (using <code>cmap_NP</code>), we have to say what to do with the code corresponding to each constructor. This is handled by <code>go</code>. That function turns the name into the root of a <code>Tree</code>, and the children are given by calling <code>conNamesRecursive_NP</code>, which is defined as follows:</p>\n\n<pre><code>conNamesRecursive_NP :: forall xs . All ConNamesRecursive xs =&gt; NP (K [Tree]) xs\nconNamesRecursive_NP =\n  cpure_NP (Proxy @ConNamesRecursive) go\n  where\n    go :: forall a . ConNamesRecursive a =&gt; K [Tree] a\n    go = K (conNamesRecursive (Proxy @a))\n</code></pre>\n\n<p>This is a function just calling <code>conNamesRecursive</code> again per component of the constructor. Because this function is a member of the type class, we have to require in the beginning that all components occurring in the code of the original datatype are themselves members of this class.</p>\n\n<p>Before we can use this on concrete example types, we have to make them (and all types that occur somewhere inside) an instance of <code>ConNamesRecursive</code>.</p>\n\n<p>We can do this by just using <code>DeriveAnyClass</code>:</p>\n\n<pre><code>data SimpleTree =\n    Nil\n  | Node Text SimpleTree SimpleTree\n  deriving (Show, GHC.Generic, Generic, HasDatatypeInfo, ConNamesRecursive)\n\ndata Exp =\n    Union SimpleTree\n  | Intersection SimpleTree\n  deriving (Show, GHC.Generic, Generic, HasDatatypeInfo, ConNamesRecursive)\n</code></pre>\n\n<p>Note that I changed <code>String</code> to <code>Text</code> in <code>Node</code> so that I don't have to decide what to do with lists of characters, but can just treat <code>Text</code> as an abstract type. Abstract types can be made members of the <code>ConNamesRecursive</code> class producing an empty list of trees.</p>\n\n<pre><code>instance ConNamesRecursive Text where\n  conNamesRecursive _ = []\n</code></pre>\n\n<p>Finally, in order to make this a bit easier to visualise, I implemented a (naive) <code>unDup</code> function on trees that stops if a constructor occurs underneath itself:</p>\n\n<pre><code>unDup :: [Tree] -&gt; [Tree]\nunDup = go Set.empty\n  where\n    go :: Set.Set Text -&gt; [Tree] -&gt; [Tree]\n    go seen ts =\n      map\n        (\\ (Tree cn children) -&gt;\n          Tree cn (if cn `Set.member` seen then [] else go (Set.insert cn seen) children)\n        )\n        ts\n</code></pre>\n\n<p>Now we can test:</p>\n\n<pre><code>GHCi&gt; unDup $ conNamesRecursive (Proxy @Exp)\n[Tree \"Union\"\n  [Tree \"Nil\" []\n  ,Tree \"Node\"\n    [Tree \"Nil\" []\n    ,Tree \"Node\" []\n    ,Tree \"Nil\" []\n    ,Tree \"Node\" []\n    ]\n  ]\n  ,Tree \"Intersection\"\n    [Tree \"Nil\" []\n    ,Tree \"Node\"\n      [Tree \"Nil\" []\n      ,Tree \"Node\" []\n      ,Tree \"Nil\" []\n      ,Tree \"Node\" []\n    ]\n  ]\n]\n</code></pre>\n\n<p>(Layout added for readability.)</p>\n\n<p>Of course, all sorts of variations are possible to implement here.</p>\n\n<p>As I said before, this function is somewhat trickier to define than most generic functions, because we're neither consuming a value of the type we analyze nor are we producing a value of the type we analyze, but we're producing a value of a constant type <code>[Tree]</code>, so there's little type information for GHC to go on, which means more type parameters / helper functions with type signatures than usual.</p>\n\n<p>I hope this nevertheless gives you an idea.</p>\n"}], "owner": {"reputation": 1518, "user_id": 439034, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/25bcd10eae437d11365ec0fb5483d354?s=128&d=identicon&r=PG", "display_name": "worldsayshi", "link": "https://stackoverflow.com/users/439034/worldsayshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 58982807, "answer_count": 1, "score": 4, "last_activity_date": 1574408570, "creation_date": 1574193880, "last_edit_date": 1574408570, "question_id": 58942012, "link": "https://stackoverflow.com/questions/58942012/extract-nested-type-information-from-constructorinfo-of-generics-sop", "title": "Extract nested type information from ConstructorInfo of generics-sop", "body": "<p>I'm trying to learn the Haskell package <a href=\"http://hackage.haskell.org/package/generics-sop-0.5.0.0\" rel=\"nofollow noreferrer\">generics-sop</a> and in particular I'm using the helper method <code>constructorInfo</code> to get process-able information about a data type.</p>\n\n<p>As an exercise I'm trying to extract information from the ConstructorInfo type into a more understandable type:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module SOPExperiment where\n\nimport qualified GHC.Generics as GHC\nimport Generics.SOP\nimport Data.Text (Text, pack)\n\ndata SimpleTree = Nil\n  | Node String SimpleTree SimpleTree\n  deriving (Show, GHC.Generic)\n\ninstance Generic SimpleTree\ninstance HasDatatypeInfo SimpleTree\n\ndata Exp = Union SimpleTree\n  | Intersection SimpleTree\n  deriving (Show, GHC.Generic)\n\ninstance Generic Exp\ninstance HasDatatypeInfo Exp\n\n</code></pre>\n\n<p>I've been able to piece together this partial solution <code>consNames</code>, that lists constructors of <code>Exp</code>:</p>\n\n<pre><code>-- This will give [\"Union\",\"Intersection\"]\nexpConsNames = consNames (Proxy :: Proxy Exp)\n\n-- And this [\"Nil\",\"Node\"]\ntreeConsNames = consNames (Proxy :: Proxy SimpleTree)\n\nconsNames :: HasDatatypeInfo a =&gt; Proxy a -&gt; [Text]\nconsNames p = hcollapse $ hliftA constructorNames cI :: [Text]\n  where\n  dI = datatypeInfo p\n  cI = constructorInfo dI\n  constructorNames :: ConstructorInfo xs -&gt; K Text xs\n  constructorNames cInfo =\n      let cName = case cInfo of\n              Constructor n -&gt; n\n              Infix n _ _   -&gt; n\n              Record n _    -&gt; n\n      in K . pack $ cName\n\n</code></pre>\n\n<ol>\n<li><strong>But how to return a list that includes nested constructor names?</strong></li>\n</ol>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- Should return [\"Union\",\"Intersection\", \"Nil\", \"Node\"]\nnestedExpConsNames = undefined\n\n</code></pre>\n\n<ol start=\"2\">\n<li><strong>Or slightly better, return a tree data type that represent how constructors are nested in the type?</strong></li>\n</ol>\n\n<pre><code>data Tree = Tree String [Tree] deriving Show\nexpDataStructure :: Tree\nexpDataStructure = undefined\n\n{- Result should be something akin to (infinite tree): \nexpDataStructure' = Tree \"Exp\" [\n  Tree \"Union\" [\n    Tree \"SimpleTree\" [Tree \"Nil\" [], Tree \"Node\" [Tree \"SimpleTree\" [...]]],\n    Tree \"SimpleTree\" [Tree \"Nil\" [], Tree \"Node\" [Tree \"SimpleTree\" [...]]]\n  ],\n  Tree \"Intersection\" [\n    Tree \"SimpleTree\" [Tree \"Nil\" [], Tree \"Node\" [Tree \"SimpleTree\" [...]]],\n    Tree \"SimpleTree\" [Tree \"Nil\" [], Tree \"Node\" [Tree \"SimpleTree\" [...]]]\n  ]]\n  -}\n</code></pre>\n\n<p>Used GHC Extensions are: OverloadedStrings, ScopedTypeVariables, TypeFamilies, RankNTypes, TypeOperators, ConstraintKinds, MultiParamTypeClasses, TypeSynonymInstances, FlexibleInstances, FlexibleContexts, DefaultSignatures, DataKinds, DeriveGeneric, ExtendedDefaultRules</p>\n\n<p>(All extensions might not be needed)</p>\n"}, {"tags": ["haskell", "visual-studio-code", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 364, "user_id": 7076615, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Ws6O9.jpg?s=128&g=1", "display_name": "StudySmarterNotHarder", "link": "https://stackoverflow.com/users/7076615/studysmarternotharder"}, "edited": false, "score": 0, "creation_date": 1574191811, "post_id": 58941444, "comment_id": 104141478, "body": "Yes, that was it!  Works perfectly now :)  This would have taken all day to solve, lol."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1574193206, "post_id": 58941444, "comment_id": 104142087, "body": "The problem was that the <code>let</code>, as indented, wasn&#39;t part of the <code>do</code> block, but came after. The following <code>putStrLn</code> was then in a position where the <code>in</code> keyword was expected."}], "tags": [], "owner": {"reputation": 1780, "user_id": 5886238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6-9qKyv9RFM/AAAAAAAAAAI/AAAAAAAAAeY/hvJfgvauxDk/photo.jpg?sz=128", "display_name": "Andrew Ray", "link": "https://stackoverflow.com/users/5886238/andrew-ray"}, "is_accepted": true, "score": 5, "last_activity_date": 1574191309, "creation_date": 1574191309, "answer_id": 58941444, "question_id": 58941354, "link": "https://stackoverflow.com/questions/58941354/basic-error-with-putstrln-in-haskell-vscode-extension-haskelly/58941444#58941444", "title": "Basic error with `putStrLn` in Haskell. VScode extension Haskelly", "body": "<p>I believe your code is insufficiently indented. Try this:</p>\n\n<pre><code>main = do line &lt;- getLine\n          let line' = reverse line\n          putStrLn $ \"You said \" ++ line' ++ \" backwards!\"\n          putStrLn $ \"Yes, you really said \" ++ line ++ \" backwards!\"\n</code></pre>\n\n<p>Specifically, your lines following the <code>do</code> should be indented just as much as the thing that comes after it, namely <code>line &lt;- getLine</code>.</p>\n"}], "owner": {"reputation": 364, "user_id": 7076615, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Ws6O9.jpg?s=128&g=1", "display_name": "StudySmarterNotHarder", "link": "https://stackoverflow.com/users/7076615/studysmarternotharder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1574203809, "accepted_answer_id": 58941444, "answer_count": 1, "score": 0, "last_activity_date": 1574191309, "creation_date": 1574190928, "question_id": 58941354, "link": "https://stackoverflow.com/questions/58941354/basic-error-with-putstrln-in-haskell-vscode-extension-haskelly", "closed_reason": "Duplicate", "title": "Basic error with `putStrLn` in Haskell. VScode extension Haskelly", "body": "<pre><code>main = do line &lt;- getLine\n        let line' = reverse line\n        putStrLn $ \"You said \" ++ line' ++ \" backwards!\"\n        putStrLn $ \"Yes, you really said \" ++ line ++ \" backwards!\"\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>$ stack runhaskell \"c:\\Users\\FruitfulApproach\\Desktop\\Haskell\\test.hs\"\n\nC:\\Users\\FruitfulApproach\\Desktop\\Haskell\\test.hs:4:5: error:\n    parse error on input `putStrLn'\n  |\n4 |     putStrLn $ \"You said \" ++ line' ++ \" backwards!\"\n  |     ^^^^^^^^\n</code></pre>\n\n<p>I've also tried it with a single tab on the indented lines.</p>\n\n<p>Here's my tabs -> spaces setting:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4UsLs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4UsLs.png\" alt=\"tabs to spaces setting screenshot\"></a></p>\n\n<p>I've also tried restarting VSCode.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell", "enums", "haskell-platform"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574185241, "post_id": 58939892, "comment_id": 104138281, "body": "What have you tried? Where did you get stuck?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1574185982, "post_id": 58939892, "comment_id": 104138654, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/58938019/how-to-merge-two-hands-of-cards-together-in-haskell\">How to merge two hands of cards together in Haskell?</a>"}, {"owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574186048, "post_id": 58939892, "comment_id": 104138686, "body": "@JosephSible sorry, that was actually a previous question I asked, similar, but not the same."}, {"owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1574186086, "post_id": 58939892, "comment_id": 104138703, "body": "@MichaelLitchard updated"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574186182, "post_id": 58939892, "comment_id": 104138752, "body": "@Alex when I posted that, it was an exact duplicate. Now you&#39;ve edited it into something entirely different."}, {"owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574186236, "post_id": 58939892, "comment_id": 104138782, "body": "@JosephSible yeah my apologies, I forgot to update it, but thank you for your prudence"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574186323, "post_id": 58939892, "comment_id": 104138824, "body": "@JosephSible I can vouch that this is the question Alex meant to ask, since I&#39;m the one who told him to post a new question."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1574186733, "post_id": 58939892, "comment_id": 104139003, "body": "Why exactly you make a <code>Hand</code> a recursive type instead of a <code>List</code> i.e. <code>type Hand = [Card]</code> or another similar predefined type like Sequence or Array? Now you have to think for all kinds of functions and class instances of it..? How about folding a <code>Hand</code>..?"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 5, "last_activity_date": 1574186631, "creation_date": 1574186631, "answer_id": 58940258, "question_id": 58939892, "link": "https://stackoverflow.com/questions/58939892/how-can-i-fuse-two-enums-of-the-same-type-in-haskell/58940258#58940258", "title": "How can I fuse two enums of the same type in Haskell?", "body": "<p>You need to pattern match on one of the non-empty hands so that you can access the cards in it.</p>\n\n<pre><code>(&lt;+) :: Hand -&gt; Hand -&gt; Hand\nEmpty &lt;+ h = h\nh &lt;+ Empty = h\n(Add c rest1) &lt;+ h = Add c (rest1 &lt;+ h)\n</code></pre>\n\n<p>Strictly speaking,  you don't need <code>h &lt;+ Empty = h</code>, since the third rule can rebuild the hand once you reach <code>Empty &lt;+ h</code>. But the second rule saves some computation.</p>\n\n<p>You can't use <code>++</code> et al. because none of them are defined for <code>Hand</code>. However, as was pointed out in a comment on your previous question, all <code>Hand</code> does is re-implement the built-in list type. You can take advantage of that by defining a new type.</p>\n\n<pre><code>newtype Hand = Hand [Card]\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>(&lt;+) :: Hand -&gt; Hand -&gt; Hand\n(Hand h1) &lt;+ (Hand h2) = Hand (h1 ++ h2)\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 58940258, "answer_count": 1, "score": -3, "last_activity_date": 1574186631, "creation_date": 1574185142, "last_edit_date": 1574185984, "question_id": 58939892, "link": "https://stackoverflow.com/questions/58939892/how-can-i-fuse-two-enums-of-the-same-type-in-haskell", "title": "How can I fuse two enums of the same type in Haskell?", "body": "<p>I'm still very new to Haskell, and I'm curious as to how I would merge two <code>Hand</code>'s together, so that, the first hand is placed on top of the second hand. I want it to be an infix operator, namely (&lt;+). Here's some code to  assist you. Essentially, what I'm saying is that I need help to \"append\" the two hands in some way.</p>\n\n<pre><code>data Rank = Numeric Integer | Jack | Queen | King | Ace\n            deriving (Eq, Show)\n\ndata Suit = Hearts | Spades | Diamonds | Clubs\n            deriving (Eq, Show)\n\ndata Card = Card Rank Suit\n            deriving (Eq, Show)\n\ndata Hand = Empty | Add Card Hand\n            deriving (Eq, Show)\n\n(&lt;+) :: Hand -&gt; Hand -&gt; Hand\n(&lt;+) Empty Empty = Empty\n(&lt;+) h Empty     = h\n(&lt;+) Empty h     = h\n(&lt;+) h1 h2       = h1 ++ h2\n</code></pre>\n\n<p>So far I've tried <code>merge</code>, <code>append</code>, <code>mappend</code>, and <code>++</code> as seen above.</p>\n"}, {"tags": ["haskell", "syntax", "enums", "operators", "definition"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1574178845, "post_id": 58938019, "comment_id": 104134597, "body": "Hint: what should happen for two <code>Empty</code>s, for an <code>Empty</code> and an <code>Add x y</code>, with an <code>Add x y</code> and an <code>Empty</code>, and with <code>Add x y</code> and <code>Add z t</code>?"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1574179094, "post_id": 58938019, "comment_id": 104134741, "body": "<code>Hand</code> is a list equivalent and you&#39;re trying to define append...."}, {"owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1574179310, "post_id": 58938019, "comment_id": 104134864, "body": "@karakfa yes, that is correct"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1574179648, "post_id": 58938019, "comment_id": 104135071, "body": "@Alex: I don&#39;t see why you do not use <code>type Hand = [Card]</code>. Then you do not need to implement an append function in the first place."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1574180511, "post_id": 58938019, "comment_id": 104135582, "body": "as a suggestion aside from the question. Derive your types so you can print them in the console <code>data YourTypeName = Constructor1 | Constructor2 |.... deriving(Eq, Show)</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574181367, "post_id": 58938019, "comment_id": 104136185, "body": "Don&#39;t edit a question that has already been answered."}, {"owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574181466, "post_id": 58938019, "comment_id": 104136247, "body": "@chepner my apologies, but the answer didn&#39;t answer the question due to my lack of clarity in the question given."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1574181712, "post_id": 58938019, "comment_id": 104136412, "body": "Then ask a new question. You specifically asked about the type-signature error, which my answer addressed. How to then define <code>(&lt;+)</code> is a separate question."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1574180713, "last_edit_date": 1574180713, "creation_date": 1574179793, "answer_id": 58938362, "question_id": 58938019, "link": "https://stackoverflow.com/questions/58938019/how-to-merge-two-hands-of-cards-together-in-haskell/58938362#58938362", "title": "How to merge two hands of cards together in Haskell?", "body": "<p>The definition should either be</p>\n\n<pre><code>h1 &lt;+ h2 = undefined\n</code></pre>\n\n<p>or</p>\n\n<pre><code>(&lt;+) h1 h2 = undefined\n</code></pre>\n\n<p>You are currently trying to use a function name as an infix operator.</p>\n"}], "owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 58938362, "answer_count": 1, "score": 0, "last_activity_date": 1574181383, "creation_date": 1574178777, "last_edit_date": 1574181383, "question_id": 58938019, "link": "https://stackoverflow.com/questions/58938019/how-to-merge-two-hands-of-cards-together-in-haskell", "title": "How to merge two hands of cards together in Haskell?", "body": "<p>I'm still very new to Haskell, and I'm curious as to how I would merge two <code>Hand</code>'s together, so that, the first hand is placed on top of the second hand. I want it to be an infix operator, namely (&lt;+). Here's some code to  assist you. I keep getting an error saying \"The type signature for \u2018&lt;+\u2019 lacks an accompanying binding\".</p>\n\n<pre><code>data Rank = Numeric Integer | Jack | Queen | King | Ace\n\ndata Suit = Hearts | Spades | Diamonds | Clubs\n\ndata Card = Card Rank Suit\n\ndata Hand = Empty | Add Card Hand\n\n(&lt;+) :: Hand -&gt; Hand -&gt; Hand\nh1 (&lt;+) h2 = undefined\n</code></pre>\n\n<p>Many thanks in advance for any advice given.</p>\n"}, {"tags": ["haskell", "binary-search-tree", "guard-statement"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1574177439, "creation_date": 1574177439, "answer_id": 58937558, "question_id": 58937399, "link": "https://stackoverflow.com/questions/58937399/haskell-compilation-error-guard-type-mismatching/58937558#58937558", "title": "Haskell Compilation Error - Guard Type mismatching", "body": "<p>You are comparing <code>valueX</code> and <code>valueRoot</code>, of type <code>b</code>. The error message says that doing so requires a constraint <code>Ord b</code>, but you only have a constraint <code>Ord a</code>. </p>\n\n<p>Perhaps you meant to compare <code>labelX</code> and <code>labelRoot</code> (which have type <code>a</code>) instead?</p>\n"}], "owner": {"reputation": 113, "user_id": 6745543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a1719a4ba042564ca877ce3cc68fdf2?s=128&d=identicon&r=PG", "display_name": "Eoin Dowling", "link": "https://stackoverflow.com/users/6745543/eoin-dowling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 58937558, "answer_count": 1, "score": 0, "last_activity_date": 1574177439, "creation_date": 1574176958, "question_id": 58937399, "link": "https://stackoverflow.com/questions/58937399/haskell-compilation-error-guard-type-mismatching", "title": "Haskell Compilation Error - Guard Type mismatching", "body": "<p>I've been stuck at this particular stage working on a problem I've been given, and my experience with haskell is still at a beginner level.</p>\n\n<p>In trying to create a function to create a insert a Node (consisting of a String \"Key\" and a Value) into a Binary Search Tree, I attempted an approach using guard brackets. I seem to be misunderstanding how to do something here, and the error I am receiving doesn't make sense to me.</p>\n\n<pre><code>\nmodule Ex03 where                                                                                                                                                                                                  \nimport Data.List ((\\\\))                                                                                                                                                                                            \n\n-- Datatypes -------------------------------------------------------------------                                                                                                                                   \n\n-- do not change anything in this section !                                                                                                                                                                        \n\n-- Binary Tree                                                                                                                                                                                                     \ndata BT a b                                                                                                                                                                                                        \n  = Leaf                                                                                                                                                                                                           \n  | Branch (BT a b) a b (BT a b)                                                                                                                                                                                   \n  deriving (Eq, Show)                                                                                                                                                                                              \n\n-- association list                                                                                                                                                                                                \ntype Assoc a b = [(a,b)]                                                                                                                                                                                           \n\n-- lookup binary (search) tree                                                                                                                                                                                     \nlkpBST :: Ord a1 =&gt; BT a1 a -&gt; a1 -&gt; Maybe a                                                                                                                                                                       \nlkpBST Leaf _  =  Nothing                                                                                                                                                                                          \nlkpBST (Branch left k d right) k'                                                                                                                                                                                  \n | k &lt; k'     =  lkpBST left k'                                                                                                                                                                                    \n | k &gt; k'     =  lkpBST right k'                                                                                                                                                                                   \n | otherwise  =  Just d                                                                                                                                                                                            \n\n-- Coding Part 1 (13 Marks)                                                                                                                                                                                        \n\n-- insert into binary (search) tree                                                                                                                                                                                \ninsBST :: Ord a =&gt; a -&gt; b -&gt; BT a b -&gt; BT a b                                                                                                                                                                      \ninsBST labelX valueX Leaf = Branch Leaf labelX valueX Leaf                                                                                                                                                         \n{-                                                                                                                                                                                                                 \n  insBST a 1 Branch Leaf b 1 Leaf                                                                                                                                                                                  \n@?= Branch Branch Leaf a 1 Leaf  b 2 Leaf                                                                                                                                                                          \n-}                                                                                                                                                                                                                 \ninsBST labelX valueX (Branch left labelRoot valueRoot right)                                                                                                                                                       \n    | valueX &lt; valueRoot = (Branch (insBST labelX valueX left) labelRoot valueRoot right)                                                                                                                          \n    | valueX &gt; valueRoot = (Branch left labelRoot valueRoot (insBST labelX valueX right))                                                                                                                          \n    | otherwise = Branch left labelX valueX right                                                                                                                                                                  \n\n-- Coding Part 2 (6 Marks)                                                                                                                                                                                         \n\n-- convert an association list to a binary search tree                                                                                                                                                             \nassoc2bst :: Ord a =&gt; Assoc a b -&gt; BT a b                                                                                                                                                                          \nassoc2bst _ = error \"assoc2bst not yet implemented\"                                                                                                                                                                \n\n-- Coding Part 3 (6 Marks)                                                                                                                                                                                         \n\n-- convert a binary search tree into an (ordered) association list                                                                                                                                                 \nbst2assoc :: Ord c =&gt;  BT c e -&gt; Assoc c e                                                                                                                                                                         \nbst2assoc _ = error \"bst2assoc not yet   \n\n\n\n</code></pre>\n\n<p>The error I am receiving is the following</p>\n\n<pre><code>Hours of hacking await!\nIf I break, you can:\n  1. Restart:           M-x haskell-process-restart\n  2. Configure logging: C-h v haskell-process-log (useful for debugging)\n  3. General config:    M-x customize-mode\n  4. Hide these tips:   C-h v haskell-process-show-debug-tips\nsrc/Ex03.hs:35:14: Could not deduce (Ord b) arising from a use of \u2018&lt;\u2019 \u2026\n    from the context (Ord a)\n      bound by the type signature for\n                 insBST :: Ord a =&gt; a -&gt; b -&gt; BT a b -&gt; BT a b\n      at /Users/eoindowling/college/3year2/michaelmas/CS3016-_Introduction_to_Functional_Programming/CSU34016-1920/Exercise03/src/Ex03.hs:28:11-45\n    Possible fix:\n      add (Ord b) to the context of\n        the type signature for\n          insBST :: Ord a =&gt; a -&gt; b -&gt; BT a b -&gt; BT a b\n    In the expression: valueX &lt; valueRoot\n    In a stmt of a pattern guard for\n                   an equation for \u2018insBST\u2019:\n      valueX &lt; valueRoot\n    In an equation for \u2018insBST\u2019:\n        insBST labelX valueX (Branch left labelRoot valueRoot right)\n          | valueX &lt; valueRoot\n          = (Branch (insBST labelX valueX left) labelRoot valueRoot right)\n          | valueX &gt; valueRoot\n          = (Branch left labelRoot valueRoot (insBST labelX valueX right))\n          | otherwise = Branch left labelX valueX right\nCompilation failed.\n</code></pre>\n\n<p>What is wrong with my guard statements here? I've seen similiar approaches and I don't understand what I am doing wrong.</p>\n"}, {"tags": ["list", "haskell", "dynamic"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1574174663, "post_id": 58936399, "comment_id": 104131879, "body": "THe list is (to the best of my knowledge) never constructed. This is a good example of how <i>list fusion</i> could boost efficiency."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1574177022, "post_id": 58936399, "comment_id": 104133414, "body": "@WillemVanOnsem Indeed it is never constructed. From haskell report <code>7.14.4</code> which defines list fusion,  list comprehension are a <i>good producer</i> and <code>and</code> function is a <i>good consumer</i>. :)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1574190158, "post_id": 58936399, "comment_id": 104140743, "body": "List fusion is an advanced optimization which avoid allocating the list entirely. You do not have to understand when that triggers to reason about the code you wrote. What you need to understand is that <code>and</code> will only demand a list until the first <code>False</code>, and no more. Further, the list cells created in such way can be garbage collected after they have been inspected. Hence, even without list fusion, a good GC system should run your code in O(1) memory."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574192489, "post_id": 58936399, "comment_id": 104141777, "body": "I don&#39;t fully understand you guys (pretty new to computer), but it sounds remarkable! I will get back to this issue later as it seems very advance. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 1, "creation_date": 1574192708, "post_id": 58939732, "comment_id": 104141889, "body": "Maybe I haven&#39;t been clear enough. I understand that the whole list is not constructed, but as <code>and</code> reads in a sequence of <code>True</code>, does it create a stack? I should have asked this question in a simpler way: how many layers of stack does <code>and</code> creates when <code>and [True, True, True, True, True]</code> is executed? Is it 2? or 5?"}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574192947, "post_id": 58939732, "comment_id": 104141996, "body": "If I&#39;d write a naive version of <code>and</code> (again, I don&#39;t really know how powerful <code>and</code> is written), and let&#39;s call it <code>naiveAnd</code>, then it would look something like <code>... naiveAnd (x:xs) = x &amp;&amp; naiveAnd xs</code>. This is not good, since it is going to call 5 layers in my example above. Whereas a better way is so that as the function reads in the first <code>True</code>, it knows immediately that it can <b>safely forget this information</b> and keep proceeding."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574221463, "post_id": 58939732, "comment_id": 104150541, "body": "Thanks for your update! I hope someone knows the answer to that."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1574241033, "post_id": 58939732, "comment_id": 104157446, "body": "Tail recursion isn&#39;t always necessary for good performance in a lazy language. Indeed the most common trick you use to rewrite code to be tail recursive (introducing extra accumulator parameters) is frequently <i>harmful</i> to performance in Haskell."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1574266504, "post_id": 58939732, "comment_id": 104173016, "body": "Haskell is <i>lazy</i>. tail recursion will always consume the whole input list, will never cut the evaluation short (unless with exceptions or non-local exit etc). when the combining function is short-circuiting, i.e. lazy in its second argument, the non-tail, aka <i>&quot;guarded&quot;</i> recursion is the way to go, in foldr as well. <code>&amp;&amp;</code> is one such combining function. <code>+</code> isn&#39;t."}], "tags": [], "owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "is_accepted": false, "score": 2, "last_activity_date": 1574195798, "last_edit_date": 1574195798, "creation_date": 1574184548, "answer_id": 58939732, "question_id": 58936399, "link": "https://stackoverflow.com/questions/58936399/dynamical-functions-on-comprehensive-lists-haskell/58939732#58939732", "title": "Dynamical functions on comprehensive lists (Haskell)", "body": "<p>To sum up the effective answers in comments:</p>\n\n<ul>\n<li>The comprehension never produces the entire list, it likely produces the head of the list and a thunk to produce the next element when it would be accessed.</li>\n<li>The <code>and</code> function never consumes the whole list, it only consumes the head element and calls itself recursively for the tail.</li>\n</ul>\n\n<p>This way, there's no need to ever produce more than the head of the list for the whole computation.</p>\n\n<p>This is how you can work with <em>infinite</em> lists: <code>take 5 [0 ..]</code> never produces the entire list for obvious reasons.</p>\n\n<p>Regarding the performance of <code>and</code>.</p>\n\n<p>In GHC standard library, <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.List.html#and\" rel=\"nofollow noreferrer\">it is defined</a> either via <code>foldr</code> or via <code>x &amp;&amp; all xs</code>. </p>\n\n<p>The latter is not tail-recursive. The former uses <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#foldr\" rel=\"nofollow noreferrer\"><code>foldr</code> implementation from List</a> which is also not tail-recursive.</p>\n\n<p>This puzzles me: either would produce a stack as large as the input, if interpreted naively; I would expect an accumulator parameter implementation, strict (<code>!</code>) by the accumulator.</p>\n\n<p>Maybe GHC knows how to effectively compile such non entirely tail-recursive constructs to effective loops, <em>I don't know.</em></p>\n"}], "owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1574195798, "creation_date": 1574174044, "question_id": 58936399, "link": "https://stackoverflow.com/questions/58936399/dynamical-functions-on-comprehensive-lists-haskell", "title": "Dynamical functions on comprehensive lists (Haskell)", "body": "<p>I will demonstrate my question with a simple example: (non-optimal) prime number distinguisher.</p>\n\n<pre><code>isPrime :: Int -&gt; Bool\nisPrime n\n    | n &lt; 2     = False\n    | otherwise = ( and [ n `mod` d /= 0 | d &lt;- [2 .. (n-1)] ] )\n</code></pre>\n\n<p>Notice that <code>and</code> outputs <code>True</code> if and only if every value in the comprehensive list is <code>True</code>. </p>\n\n<p>Suppose now I throw in a query <code>&gt; isPrime someVeryLargePrime</code>. Then the function <code>and</code> will receive a huge list, each of whose entries being <code>True</code>.</p>\n\n<h3>Question</h3>\n\n<p>I understand since Haskell is lazy the function <code>and</code> might be smart enough to output false once it detects any <code>False</code> in the list. </p>\n\n<ol>\n<li><p>However, while the list contains lots of <code>True</code>, is it smart enough to compress the list <strong>while it is reading the list</strong>? For example, while the first two entries are True, then release the memory by contracting both <code>True</code> values to one <code>True</code> value, and so on.</p></li>\n<li><p>If not, how does one write a function that deals with a comprehensive list <strong>dynamically</strong>?</p></li>\n</ol>\n"}, {"tags": ["haskell", "yesod", "haskell-warp", "wai"], "comments": [{"owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "edited": false, "score": 2, "creation_date": 1574157094, "post_id": 58930882, "comment_id": 104121702, "body": "Doesn&#39;t seem like it <a href=\"https://github.com/yesodweb/wai/issues/734#issuecomment-486552123\" rel=\"nofollow noreferrer\">github.com/yesodweb/wai/issues/734#issuecomment-486552123</a>"}], "owner": {"reputation": 572, "user_id": 1911889, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9d4e9f32328a5f2431aaa747e4ba958d?s=128&d=identicon&r=PG", "display_name": "tselvan", "link": "https://stackoverflow.com/users/1911889/tselvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1574156488, "creation_date": 1574156488, "question_id": 58930882, "link": "https://stackoverflow.com/questions/58930882/anyway-to-change-the-default-keep-alive-close-in-warp", "title": "Anyway to change the default keep-alive close in warp?", "body": "<p>It seems like a keep-alive connection is closed in 60s. Is it possible to configure this in warp?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1116, "user_id": 3103271, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/327a4e9fd339d47885623a2628021613?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3103271/charlie"}, "edited": false, "score": 1, "creation_date": 1574157137, "post_id": 58929295, "comment_id": 104121724, "body": "This hint &quot;instance (Eq n, Eq l) =&gt; Eq (Tree n l)&quot; helped a lot. As I understand it, that&#39;s the way how you ensure, that == is defined on n and l."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1116, "user_id": 3103271, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/327a4e9fd339d47885623a2628021613?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3103271/charlie"}, "edited": false, "score": 0, "creation_date": 1574157167, "post_id": 58929295, "comment_id": 104121742, "body": "@Charlie: exactly, you say that there should be equality relations for the types of <code>n</code> and <code>l</code> in order to define one on <code>Tree n l</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1574150956, "creation_date": 1574150956, "answer_id": 58929295, "question_id": 58929087, "link": "https://stackoverflow.com/questions/58929087/the-type-tree-should-be-an-instance-of-the-typeclass-eq/58929295#58929295", "title": "The type Tree should be an instance of the typeclass Eq", "body": "<p>There are two problems here:</p>\n\n<ol>\n<li>you did not specify to what type class you made <code>Tree n l</code> an instance; and</li>\n<li>in order to check that with the given definition, both <code>n</code> and <code>l</code> need to be types that are instances of the <code>Eq</code> typeclass.</li>\n</ol>\n\n<p>So you can implement this with:</p>\n\n<pre><code>instance <b>(Eq n, Eq l)</b> =&gt; <b>Eq</b> (Tree n l) where\n  (Node a b c) == (Node d e f) = a == d\n  (Leaf a) == (Leaf b) = a == b</code></pre>\n\n<p>Note that now it will compile but there is still a problem: it will raise an error if you check if a <code>Node &hellip; &hellip; &hellip;</code> is equal to a <code>Leaf &hellip;</code> and vice versa. You can add an extra rule for that:</p>\n\n<pre><code>instance (Eq n, Eq l) =&gt; Eq (Tree n l) where\n  (Node a b c) == (Node d e f) = a == d\n  (Leaf a) == (Leaf b) = a == b\n  <b>_ == _ = False</b></code></pre>\n\n<p>Here you will however consider two <code>Node &hellip; &hellip; &hellip;</code> the same, from the moment they wrap the same value. So you do not look to the subtrees. In order to fix this, you need to perform recursion. I leave that as an exericse.</p>\n"}, {"comments": [{"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1574156069, "post_id": 58929859, "comment_id": 104121117, "body": "I think Willem&#39;s answer did better by leaving this as a hint."}, {"owner": {"reputation": 1116, "user_id": 3103271, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/327a4e9fd339d47885623a2628021613?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3103271/charlie"}, "edited": false, "score": 0, "creation_date": 1574157184, "post_id": 58929859, "comment_id": 104121749, "body": "For the recursion you can use this line: (Node a b c) == (Node d e f) = a == d &amp;&amp; b == e &amp;&amp; c == f"}], "tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": false, "score": 4, "last_activity_date": 1574153200, "creation_date": 1574153200, "answer_id": 58929859, "question_id": 58929087, "link": "https://stackoverflow.com/questions/58929087/the-type-tree-should-be-an-instance-of-the-typeclass-eq/58929859#58929859", "title": "The type Tree should be an instance of the typeclass Eq", "body": "<p>I am not sure that you want exactly that implementation of equality check for your tree.</p>\n\n<p>Let</p>\n\n<pre><code>a = Node 2 (Leaf 1) (Leaf 2)\nb = Node 2 (Leaf 100) (Leaf 200)\n</code></pre>\n\n<p>For such two trees you will get <code>a == b</code> as <code>True</code> because your comparison of <code>Node</code>s compares only the values in that nodes, but the subtrees are ignored. You can even define that portion of your check like this</p>\n\n<pre><code>(Node a _ _) == (Node d _ _) = a == d\n</code></pre>\n\n<p>to show that you ignore subtrees.</p>\n\n<p>Maybe this is a desired behavior, but in my opinion, more correct equality check should look like this:</p>\n\n<pre><code>(Node x lx rx) == (Node y ly ry) = x == y &amp;&amp; lx == ly &amp;&amp; rx == ry\n</code></pre>\n\n<p>That will not only check the nodes' values, but also recursively check the subtrees, so <code>a == b</code> now will give you <code>False</code>, because they're, indeed, different.</p>\n"}], "owner": {"reputation": 1116, "user_id": 3103271, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/327a4e9fd339d47885623a2628021613?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3103271/charlie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 58929295, "answer_count": 2, "score": 3, "last_activity_date": 1574153200, "creation_date": 1574150162, "last_edit_date": 1574151015, "question_id": 58929087, "link": "https://stackoverflow.com/questions/58929087/the-type-tree-should-be-an-instance-of-the-typeclass-eq", "title": "The type Tree should be an instance of the typeclass Eq", "body": "<p>I have the following data structure and want it to be an instance of the typeclass Eq.</p>\n\n<pre><code>data Tree n l\n  = Node n (Tree n l) (Tree n l)\n  | Leaf l\n</code></pre>\n\n<p>I tried to do it the following way</p>\n\n<pre><code>instance Eq =&gt; (Tree n l) where\n  (Node a b c) == (Node d e f) = a == d\n  (Leaf a) == (Leaf b) = a == b\n</code></pre>\n\n<p>But there is an error message</p>\n\n<blockquote>\n  <p>\u2018==\u2019 is not a (visible) method of class \u2018Tree\u2019</p>\n</blockquote>\n"}, {"tags": ["haskell", "types", "infinite", "cartesian-product"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574123615, "post_id": 58924871, "comment_id": 104111304, "body": "The second of your links seems to be exactly this - except it uses lists instead of tuples as the input type, which neatly avoids exactly the problem you&#39;ve encountered. You can&#39;t use a tuple to represent a sequence with an unknown number of elements."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574124153, "post_id": 58924871, "comment_id": 104111412, "body": "@RobinZigmond I don&#39;t quite get it.. doesn&#39;t the type <code>[[a]]</code> mean it&#39;s a list of list of elements of the <b>same type</b>?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574124623, "post_id": 58924871, "comment_id": 104111498, "body": "oh yes, that&#39;s a good point, I somehow overlooked that tuples would allow you to use different types."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574124728, "post_id": 58924871, "comment_id": 104111519, "body": "@amalloy suggests that this cannot be done! I would definitely like to see a proof for that statement for Haskell and even some higher theoretical languages."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1574126196, "post_id": 58924871, "comment_id": 104111841, "body": "It can be done if you know what types are used and accept you will have to wrap them in a new <code>data</code> for your output."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574126618, "post_id": 58924871, "comment_id": 104111944, "body": "That&#39;s something what I&#39;m avoiding.. :("}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574124607, "post_id": 58925065, "comment_id": 104111496, "body": "Oh no!! Does that suggest we need higher language? Or it&#39;s a proven fact that we cannot ever reach the &quot;highest&quot;? Sorry if this question is a bit vague."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574124660, "post_id": 58925065, "comment_id": 104111507, "body": "Also, is there any proof for the fact that you suggested? If there is any argument, I&#39;d love to hear! Even if it&#39;s for other general theoretical languages."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574124912, "post_id": 58925065, "comment_id": 104111568, "body": "Also, if this is true (that there exists no such language), then things get very interesting. For mathematicians, taking the cartesian products of different types is easier than breathing. What makes the difference between theoretical languages and their imaginations?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574124954, "post_id": 58925065, "comment_id": 104111576, "body": "I mean, of course it can be done in other languages with different type systems. It&#39;s fairly easy in Lisp or Python, for example. Clojure&#39;s type system doesn&#39;t distinguish between lists and tuples, and also doesn&#39;t insist on homogenous lists, so even if Clojure were statically typed you could implement this with a signature like <code>[[Object]] -&gt; [[Object]]</code>."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574126674, "post_id": 58925065, "comment_id": 104111954, "body": "Very sad.. is there a proof for that it&#39;s not possible to achieve this within haskell?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 3, "creation_date": 1574135611, "post_id": 58925065, "comment_id": 104113704, "body": "@Student, I disagree with the others; I believe this is possible, but it will take quite a bit of custom type-level machinery to even represent the type of this function. I am thinking something like <code>cartesianProd :: Tuple (Map [] ts) -&gt; [Tuple ts]</code>. Lovely as this is, this kind of thing often ends up being kind of a pain. I will write up an answer later if I remember (feel free to remind if its been a while by @&#39;ing me)"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574141766, "post_id": 58925065, "comment_id": 104115186, "body": "@luqui What package is that Tuple constructor from? I can&#39;t make much sense of it, and as you can imagine a search for &quot;tuple&quot; returns a lot of unrelated stuff."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574143468, "post_id": 58925065, "comment_id": 104115730, "body": "@amalloy, I made it up, but it&#39;s <code>HList</code> (I wasn&#39;t 100% sure that&#39;s what HList meant).  See <a href=\"https://stackoverflow.com/a/58927394/33796\">my answer</a>."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 5, "last_activity_date": 1574124881, "last_edit_date": 1574124881, "creation_date": 1574124390, "answer_id": 58925065, "question_id": 58924871, "link": "https://stackoverflow.com/questions/58924871/cartesian-product-of-arbitrarily-many-lists-of-different-types/58925065#58925065", "title": "Cartesian product of arbitrarily many lists of different types", "body": "<p>This cannot be done, for exactly the reason you end with: tuples of different sizes are unrelated types, and you cannot generalize over them. For the same reason, Haskell has no generic <code>zipWithN</code> for zipping together N lists of different types. You have to either accept a <code>[[a]]</code> as input (requiring all inputs to be the same type), or else specialize to particular tuple sizes (<code>cart2</code>, <code>cart3</code>, <code>cart4</code>, etc).</p>\n\n<p>I suppose I should state for completeness that in principle I think you could rewrite this as a variadic function in the same way that <code>Text.Printf</code> works - instead of a tuple of size N, accept N separate arguments. But even then I'm not sure how you could get it to return input shaped like <code>(x, y, z)</code> instead of <code>(x, (y, z))</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1574158458, "post_id": 58927394, "comment_id": 104122458, "body": "Injectivity annotations are borderline useless in current GHC. What they do is allowing some types that would be regarded as ambiguous. What they do not is what everyone would expect, namely making <code>x ~ y</code> to be deduced from <code>F x ~ F y</code>, provided <code>F</code> has been annotated as injective. I have no idea why this is the case."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574169852, "post_id": 58927394, "comment_id": 104129013, "body": "Thank you for such thorough answer.. I will need some time to digest."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574187664, "post_id": 58927394, "comment_id": 104139487, "body": "@Student, feel free to ask any questions you have"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1574198420, "post_id": 58927394, "comment_id": 104144367, "body": "And see also <a href=\"http://hackage.haskell.org/package/universe-base-1.1.1/docs/Data-Universe-Helpers.html#v:-60--43--42--43--62-\" rel=\"nofollow noreferrer\"><code>(&lt;+*+&gt;)</code></a> for a drop-in replacement to <code>(&lt;*&gt;)</code> that handles infinite lists correctly."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 7, "last_activity_date": 1574145053, "last_edit_date": 1574145053, "creation_date": 1574142322, "answer_id": 58927394, "question_id": 58924871, "link": "https://stackoverflow.com/questions/58924871/cartesian-product-of-arbitrarily-many-lists-of-different-types/58927394#58927394", "title": "Cartesian product of arbitrarily many lists of different types", "body": "<p><em>If you are curious how to manipulate type-level data structures to solve the problem as stated, read on.  If you have a practical problem to solve, skip all this nonsense and skip to the <strong>In Reality</strong> section.</em></p>\n\n<p>This can be done.  It takes a bit of type-level machinery to get us off the ground.  Ideally I would like the following signature:</p>\n\n<pre><code>cartesianProduct :: Tuple (Map [] ts) -&gt; [Tuple ts]\n</code></pre>\n\n<p>Here <code>ts</code> is a type-level list of types, and <code>Map</code> is a type-level version of <code>map</code> on lists.  <code>Tuple</code> takes a list of types and gives a type which is equivalent to a tuple of those types.  Let's say <code>[Int, Char]</code> for example, then this signature would reduce to:</p>\n\n<pre><code>cartesianProduct :: Tuple [ [Int], [Char] ] -&gt; [Tuple [Int, Char]]\n          -- morally, at least, equivalent to\n                 :: ([Int], [Char]) -&gt; [(Int, Char)]\n</code></pre>\n\n<p>Which hopefully you can see matches our intention.  So let's get going:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, DataKinds, TypeOperators, GADTs #-}\n\ntype family Map f xs where\n    Map f '[] = '[]\n    Map f (x ': xs) = f x ': Map f xs\n\ndata Tuple ts where\n    Nil :: Tuple '[]\n    Cons :: t -&gt; Tuple ts -&gt; Tuple (t ': ts)\n</code></pre>\n\n<p>This is using a number of advanced features.  Type families, data kinds, and GADTs are the key words.</p>\n\n<p>Ideally this should be enough:</p>\n\n<pre><code>cartesianProduct :: Tuple (Map [] ts) -&gt; [Tuple ts]\ncartesianProduct Nil = [Nil]\ncartesianProduct (Cons xs xss) = [ Cons x ys | x &lt;- xs, ys &lt;- xss ]\n</code></pre>\n\n<p>Sadly, GHC can't figure it out</p>\n\n<pre><code>\u2022 Could not deduce: ts ~ (t0 : ts0)\n  from the context: Map [] ts ~ (t : ts1)\n</code></pre>\n\n<p>It doesn't know that <code>Map</code> is injective<sup>1</sup> (even though it obviously is), so it can't figure out what <code>ts</code> should be when the input type is <code>Tuple (Map [] ts)</code> and the pattern is <code>Nil</code>.  The technique here is to use a <em>singleton</em>, which is a type that helps the typechecker out of these situations.</p>\n\n<pre><code>data ListS ts where\n    NilS :: ListS '[]\n    ConsS :: ListS (t ': ts)\n</code></pre>\n\n<p>Notice that for a given list of types <code>ts</code>, there is only one possible <code>ListS</code> that could inhabit <code>ListS ts</code> (thus \"singleton\").  If we add this singleton as a parameter to our function, then the typechecker knows that, if the pattern is <code>NilS</code> then <code>ts</code> must be <code>[]</code> (and similarly for cons):</p>\n\n<pre><code>cartesianProduct :: ListS ts -&gt; Tuple (Map [] ts) -&gt; [Tuple ts]\ncartesianProduct NilS Nil = [Nil]\ncartesianProduct (ConsS s) (Cons xs xss) = [ Cons x ys | x &lt;- xs, ys &lt;- xss ]\n</code></pre>\n\n<p>Which passes the typechecker.  Using it requires a bit of work:</p>\n\n<pre><code>example :: [Tuple '[Int, Char]]\nexample = cartesianProduct (ConsS (ConsS NilS)) (Cons [1,2] (Cons ['a','b'] Nil))\n\nunTuple2 :: Tuple '[a,b] -&gt; (a,b)\nunTuple2 (Cons x (Cons y Nil)) = (x,y)\n\nghci&gt; map unTuple2 example\n[(1,'a'),(1,'b'),(2,'a'),(2,'b')]\n</code></pre>\n\n<p>It is a shame that we have to manually convert into a real tuple to see it working.  But deriving a <code>Show</code> instance for <code>Tuple</code> is going to be another big hassle.</p>\n\n<h2>In Reality</h2>\n\n<p>However, the fact that we have to use <code>unTuple*</code> at the end of this madness, which knows precisely how many types we have, should be a hint that we should be able to do without, with a bit of a reframing of our problem.  And indeed there is such a reframing, and that is the good ol' list applicative.</p>\n\n<pre><code>ghci&gt; (,) &lt;$&gt; [1,2] &lt;*&gt; ['a','b']\n[(1,'a'),(1,'b'),(2,'a'),(2,'b')]\nghci&gt; (,,) &lt;$&gt; [1,2] &lt;*&gt; ['a','b'] &lt;*&gt; [True, False]\n[(1,'a',True),(1,'a',False),(1,'b',True),(1,'b',False),(2,'a',True) (2,'a',False),(2,'b',True),(2,'b',False)]\n</code></pre>\n\n<p>Applicative notation works on arbitrarily many lists, as long as you can simultaneously provide an n-ary function to combine the elements (here the tupling functions <code>(,)</code> and <code>(,,)</code> play that role, but it could be any function, e.g. <code>(\\x y -&gt; x + 2*y) &lt;$&gt; [1,2] &lt;*&gt; [3,4]</code>).  And in practice, this is almost certainly the way a problem requiring n-ary heterogenous cartesian products would be solved.  The type-level fanciness discussed in this answer is seldom required and often just makes things unnecessarily complicated.</p>\n\n<hr>\n\n<p><sup>1</sup>I attempted a new injectivity annotation to fix this</p>\n\n<pre><code>type family Map f xs = r | r -&gt; xs where\n    Map f '[] = '[]\n    Map f (x ': xs) = f x ': Map f xs\n</code></pre>\n\n<p>But it was no help.  Seems like it should have worked. </p>\n"}], "owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1574151050, "creation_date": 1574122859, "last_edit_date": 1574151050, "question_id": 58924871, "link": "https://stackoverflow.com/questions/58924871/cartesian-product-of-arbitrarily-many-lists-of-different-types", "title": "Cartesian product of arbitrarily many lists of different types", "body": "<p>Several similar questions have been asked and answered. One can find instances, for example: </p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/4119730/cartesian-product-of-2-lists-in-haskell\">Cartesian product of 2 lists in Haskell</a></li>\n<li><a href=\"https://stackoverflow.com/questions/32476077/cartesian-product-over-a-list-of-lists-in-haskell?rq=1\">Cartesian product over a list of lists in Haskell</a> </li>\n<li><a href=\"https://stackoverflow.com/questions/2419370/how-can-i-compute-a-cartesian-product-iteratively?rq=1\">How can I compute a Cartesian product iteratively?</a></li>\n</ol>\n\n<p>However, neither of what I have found answered my question completely.</p>\n\n<h3>Question</h3>\n\n<p>In Haskell, is it possible and how to define a function <code>cartesianProduct</code> that takes <strong>arbitrarily (finitely) many</strong> lists <strong>of different types</strong> and outputs their cartesian product on the nose?</p>\n\n<h3>Background</h3>\n\n<p>For example, in the links above one can find a <code>cartesianProd_2</code> that intakes two list of different types elegantly:</p>\n\n<pre><code>cartesianProd_2 :: [a] -&gt; [b] -&gt; [(a,b)]\ncartesianProd_2 list_A list_B = [(x,y) | x&lt;-list_A, y&lt;-list_B]\n</code></pre>\n\n<p>One can easily generalizes this to <code>cartesianProd_n</code>, for some fixed integer n.</p>\n\n<p>However, I hope I can define one that does</p>\n\n<pre><code>cartesianProd (list_1,list_2) == (cartesianProd_2 list_1 list_2)\ncartesianProd (list_1,list_2,list_3) == (cartesianProd_3 list_1 list_2 list_3)\n\n-- and so on .. notice that list_i is a list of elements of type i.\n</code></pre>\n\n<p>One <em>immediate obstacle</em> I encountered is that I don't even know what <strong>type</strong> of <code>cartesianProd</code> is! Its domain is a tuple of (lists of different types)! What should I do then?</p>\n\n<h2>Edit</h2>\n\n<p>If it is not possible in Haskell, please include a (pointer to a) proof.</p>\n"}, {"tags": ["haskell", "operation"], "comments": [{"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 4, "creation_date": 1574122085, "post_id": 58924711, "comment_id": 104110966, "body": "The last two concerning lists are special syntactical constructs rather than operators. i.e. they are built into the compiler. If the reason you want the source code is just so you know what they are defined to do, you can find a specification for them in the Haskell report."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574122813, "post_id": 58924711, "comment_id": 104111149, "body": "There are a couple papers about techniques for compiling list comprehensions for Haskell."}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574122960, "post_id": 58924711, "comment_id": 104111180, "body": "That is very interesting! I did not expect they are different than usual operators! What are the main difference between them and operators like <code>(+)</code>? Is it simply because that <code>[..]</code> has two components?"}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "reply_to_user": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 0, "creation_date": 1574123032, "post_id": 58924711, "comment_id": 104111192, "body": "I am very new to Haskell. @Potato44, would you mind pointing out where I can get that Haskell report? And are there even &quot;higher operators&quot; than <code>[..], [..|..]</code>?"}, {"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574123067, "post_id": 58924711, "comment_id": 104111202, "body": "@dfeuer it is very good to know! I would very much like to hear about more. Any pointers or instances of such paper will be highly appreciated.. thank you!"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1574123719, "post_id": 58924711, "comment_id": 104111329, "body": "@Student the Haskell Report is <a href=\"https://www.haskell.org/onlinereport/haskell2010/\" rel=\"nofollow noreferrer\">here</a>. Warning: it&#39;s written very formally, definitely not light reading! The section on lists is <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-340003.7\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1574194584, "post_id": 58924711, "comment_id": 104142688, "body": "The paper &quot;A short cut to deforestation&quot; by Gill et al explains one of the ways GHC does it (when optimization is enabled). That paper also points to ones by Wadler and by Augustsson (whom I hope will chime in with extra info). One or both of those describe the way GHC does it when optimizations are disabled."}], "answers": [{"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": true, "score": 2, "last_activity_date": 1574161713, "creation_date": 1574161713, "answer_id": 58932657, "question_id": 58924711, "link": "https://stackoverflow.com/questions/58924711/source-code-of-haskells-built-in-operations/58932657#58932657", "title": "Source code of Haskell&#39;s built-in operations", "body": "<p>Here are the Haskell 98 report sections on <a href=\"https://www.haskell.org/onlinereport/exps.html#sect3.7\" rel=\"nofollow noreferrer\">lists</a>, <a href=\"https://www.haskell.org/onlinereport/exps.html#sect3.10\" rel=\"nofollow noreferrer\">arithmetic sequences</a> and <a href=\"https://www.haskell.org/onlinereport/exps.html#sect3.11\" rel=\"nofollow noreferrer\">list comprehensions</a>. As for the actual implementation in the source code, I suggest downloading the repository and using grep to search around.</p>\n\n<h2>Links</h2>\n\n<ul>\n<li><a href=\"https://www.haskell.org/onlinereport/\" rel=\"nofollow noreferrer\">Haskell 98 report</a></li>\n<li><a href=\"https://www.haskell.org/definition/haskell2010.pdf\" rel=\"nofollow noreferrer\">Haskell 2010 report</a></li>\n<li><a href=\"https://gitlab.haskell.org/ghc/ghc\" rel=\"nofollow noreferrer\">GHC source code</a></li>\n<li><a href=\"https://gitlab.haskell.org/ghc/ghc/wikis/home\" rel=\"nofollow noreferrer\">GHC source code wiki</a></li>\n</ul>\n"}], "owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 58932657, "answer_count": 1, "score": 5, "last_activity_date": 1574161713, "creation_date": 1574121647, "last_edit_date": 1574151314, "question_id": 58924711, "link": "https://stackoverflow.com/questions/58924711/source-code-of-haskells-built-in-operations", "title": "Source code of Haskell&#39;s built-in operations", "body": "<p>This question is related to <a href=\"https://stackoverflow.com/questions/42394951/how-to-read-the-implementation-code-source-code-for-inbuilt-functions-in-haskell\">this overflow post</a>. The chosen answer there tells us that we can look up the source codes for built in functions on hackage site, for example <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/src/Data.Tuple.html#curry\" rel=\"nofollow noreferrer\">curry</a>.</p>\n\n<p>What I'd like to ask for, however, is the location of the source codes of built in operations, including <code>(+), (-), (*), (/=), ([...]), ([..|...])</code>. The last two being \"list constructor\" and \"list comprehensor\" (I'm not sure if these are their standard name..).</p>\n\n<p>The source codes of basic arithmetic operations like addition or multiplications are easier to find. However, for <code>([...]), ([..|...])</code> I simply have no clue where and how I can find them. Please point them out if you happen to know.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1574120395, "post_id": 58924523, "comment_id": 104110540, "body": "No there is no empty character. Are you sure you do not want to return a <code>String</code>?"}, {"owner": {"reputation": 53, "user_id": 6454340, "user_type": "registered", "profile_image": "https://graph.facebook.com/912944272172762/picture?type=large", "display_name": "Emi Buliga", "link": "https://stackoverflow.com/users/6454340/emi-buliga"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1574120663, "post_id": 58924523, "comment_id": 104110601, "body": "I am sure. I have to return the encoded character."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574172858, "post_id": 58924523, "comment_id": 104130778, "body": "Consider building a lookup table; then <code>reverseEncode</code> is just an application of <code>lookup</code> to that table."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6454340, "user_type": "registered", "profile_image": "https://graph.facebook.com/912944272172762/picture?type=large", "display_name": "Emi Buliga", "link": "https://stackoverflow.com/users/6454340/emi-buliga"}, "edited": false, "score": 0, "creation_date": 1574120957, "post_id": 58924575, "comment_id": 104110677, "body": "Okay, so... The result of this function is used as input to another function. When running the code with your suggested version for reverseEncode, I get an error from the function calling this function, namely &quot; Couldn&#39;t match expected type \u2018Char\u2019 with actual type \u2018Maybe Char\u2019 &quot;. So basically I have to change the types in every function that calls this function?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 53, "user_id": 6454340, "user_type": "registered", "profile_image": "https://graph.facebook.com/912944272172762/picture?type=large", "display_name": "Emi Buliga", "link": "https://stackoverflow.com/users/6454340/emi-buliga"}, "edited": false, "score": 3, "creation_date": 1574121039, "post_id": 58924575, "comment_id": 104110700, "body": "@EmiBuliga: if you use this approach, yes. The <code>Maybe</code> type is an instance of <code>Monad</code>, so you can use <code>&gt;&gt;=</code> to make &quot;chaining&quot; operations more convenient, etc. But that might be a bit &quot;too advanced&quot; for now."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1574121419, "post_id": 58924575, "comment_id": 104110791, "body": "Of course there&#39;s also <code>(error &quot;This was proven to never happen&quot;) :: Char</code> :-)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1574121665, "post_id": 58924575, "comment_id": 104110862, "body": "@Bergi since the OP said they were getting a &quot;non-exhaustive patterns&quot; error before putting that line in, I would say it&#39;s in fact been proved to happen."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574121755, "post_id": 58924575, "comment_id": 104110886, "body": "@RobinZigmond Oh, right, he said &quot;exception&quot;. I thought it was linter/compiler warning\u2026"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1574120683, "creation_date": 1574120683, "answer_id": 58924575, "question_id": 58924523, "link": "https://stackoverflow.com/questions/58924523/is-there-an-empty-character-in-haskell/58924575#58924575", "title": "Is there an empty character in Haskell?", "body": "<p>There is no empty character. You could however use a character like <a href=\"https://en.wikipedia.org/wiki/Null_character\" rel=\"noreferrer\">the <em>Nul character</em> [wiki]</a>. For example with:</p>\n\n<pre><code>reverseEncode :: Char -&gt; String -&gt; Int -&gt; Char\nreverseEncode _ [] _ = <b>'\\00'</b>\nreverseEncode c (x:xs) offset\n    | alphaPos c == sm `mod` 26 = chr ((sm + 65) `mod` 26)\n    | otherwise = reverseEncode c xs offset\n    where sm = alphaPos x + offset</code></pre>\n\n<p>But a more <em>Haskellish</em> approach would be to change the return type. For example by using a <code>Maybe Char</code> instead. This is often used for \"computations that can fail\". So we could do this with:</p>\n\n<pre><code>reverseEncode :: Char -&gt; String -&gt; Int -&gt; <b>Maybe</b> Char\nreverseEncode _ [] _ = <b>Nothing</b>\nreverseEncode c (x:xs) offset\n    | alphaPos c == sm `mod` 26 = <b>Just (</b>chr ((sm + 65) `mod` 26)<b>)</b>\n    | otherwise = reverseEncode c xs offset\n    where sm = alphaPos x + offset</code></pre>\n\n<p>Here the <code>Nothing</code> thus means we reached the end of the list without meeting the condition, and <code>Just x</code> means that the computation resulted in an answer <code>x</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 6454340, "user_type": "registered", "profile_image": "https://graph.facebook.com/912944272172762/picture?type=large", "display_name": "Emi Buliga", "link": "https://stackoverflow.com/users/6454340/emi-buliga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "accepted_answer_id": 58924575, "answer_count": 1, "score": 5, "last_activity_date": 1616068276, "creation_date": 1574120291, "last_edit_date": 1616068276, "question_id": 58924523, "link": "https://stackoverflow.com/questions/58924523/is-there-an-empty-character-in-haskell", "title": "Is there an empty character in Haskell?", "body": "<p>This is my code:</p>\n\n<pre><code>reverseEncode :: Char -&gt; String -&gt; Int -&gt; Char\nreverseEncode _ [] _ = ?\nreverseEncode c (x:xs) offset\n | alphaPos c == (alphaPos x + offset) `mod` 26 = chr (((alphaPos x + offset) + 65) `mod` 26)\n | otherwise = reverseEncode c xs offset\n</code></pre>\n\n<p>It's just a small method used in a virtual Enigma Machine. After writing the function without the second line and testing it, I got this exception:</p>\n\n<pre><code>Non-exhaustive patterns in function reverseEncode\n</code></pre>\n\n<p>I then realised I didn't tell the function when to stop recursing. This is how that second line of code was born. Obviously, I could just check the length of the string at each step, but it doesn't look as elegant.</p>\n\n<p>Is there anything in Haskell I can put instead of '?' ? If not, is there anything I can define? Or is this something that could be done in a better way?</p>\n\n<p>EDIT: I've actually tried the version with checking the length of the string, and I get the same exception. So how do I make it work?</p>\n"}, {"tags": ["haskell", "classy-prelude"], "answers": [{"comments": [{"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1574125259, "post_id": 58924101, "comment_id": 104111639, "body": "I had just gone to the haddocks and saw a non-linked foldr, which I assumed it meant the &quot;standard&quot; one was used, but I now realize it could potentially mean a re-export from anywhere: <a href=\"https://hackage.haskell.org/package/classy-prelude-1.5.0/docs/doc-index-F.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/classy-prelude-1.5.0/docs/&hellip;</a> Is there a way to chase through the haddocks to find this on hackage or did you have to go to the sources?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1574127498, "post_id": 58924101, "comment_id": 104112120, "body": "I chased through the haddocks, but my starting point was that this was the only possible explanation for your error message. A more efficient way for you, since you are already in the right environment, would be to use ghci, <code>:t foldr</code>, <code>:info foldr</code>."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1574171120, "post_id": 58924101, "comment_id": 104129769, "body": "ordinarily yes, but looks like I was hit by this: <a href=\"https://gitlab.haskell.org/ghc/ghc/issues/10920\" rel=\"nofollow noreferrer\">gitlab.haskell.org/ghc/ghc/issues/10920</a> when running <code>stack --nix ghci</code>"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 1, "creation_date": 1574173484, "post_id": 58924101, "comment_id": 104131197, "body": "Oh, that&#39;s nasty. In any case, haddock has some room for improvement here. Here&#39;s the relevant issue: <a href=\"https://github.com/haskell/haddock/issues/682\" rel=\"nofollow noreferrer\">github.com/haskell/haddock/issues/682</a>"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1574117864, "last_edit_date": 1574117864, "creation_date": 1574117560, "answer_id": 58924101, "question_id": 58923576, "link": "https://stackoverflow.com/questions/58923576/why-does-element-show-up-in-a-type-error-using-foldable-not-monofoldable-in-cl/58924101#58924101", "title": "Why does Element show up in a type error using Foldable (not MonoFoldable) in ClassyPrelude?", "body": "<p>classy-prelude exports a <code>MonoFoldable</code> version of <code>foldr</code>, through the reexport of <code>Data.MonoTraversable.Unprefixed</code>:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/mono-traversable-1.0.9.0/docs/Data-MonoTraversable-Unprefixed.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/mono-traversable-1.0.9.0/docs/Data-MonoTraversable-Unprefixed.html</a></p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 58924101, "answer_count": 1, "score": 0, "last_activity_date": 1574117864, "creation_date": 1574114551, "question_id": 58923576, "link": "https://stackoverflow.com/questions/58923576/why-does-element-show-up-in-a-type-error-using-foldable-not-monofoldable-in-cl", "title": "Why does Element show up in a type error using Foldable (not MonoFoldable) in ClassyPrelude?", "body": "<p>I have the following custom prelude:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE RankNTypes #-}\n\n\nmodule Prelude (\n  module ClassyPrelude\n, module Numeric.Units.Dimensional.Prelude\n, headMay\n, sec\n) where\n\nimport ClassyPrelude hiding\n    ( (+), (-), (*), (/), (^), (**)\n    , abs, signum, negate, recip, pi, exp, log, logBase, sqrt\n    , sin, cos, tan, asin, acos, atan, atan2\n    , sinh, cosh, tanh, asinh, acosh, atanh\n    , sum, product, minimum, maximum\n    ) -- Hide definitions overridden by 'Numeric.Dimensional'.\n\nimport Numeric.Units.Dimensional.Prelude hiding (\n    (++)\n  , all,and, any, break, concat, concatMap, drop, dropWhile, elem, filter, foldMap, foldr\n  , getChar, getContents, getLine, head, init, interact, lookup, map, mapM_, notElem, null, or, print, putChar\n  , putStr, putStrLn, readFile, replicate, sequence_, splitAt, undefined, writeFile\n  , last, length, lines, reverse, second, span, tail, take, takeWhile, unlines, unwords\n  , unzip, unzip3, words, zip, zip3, zipWith, zipWith3\n  ) -- hide other conflicts specific to classy prelude\n\nimport qualified Numeric.Units.Dimensional.Prelude as NUDP\n\nheadMay :: Foldable f =&gt; f a -&gt; Maybe a\nheadMay = foldr (const . Just) Nothing\n\nsec :: Num a =&gt; Unit Metric DTime a\nsec = NUDP.second\n</code></pre>\n\n<p>The relevant bit here is just (I think) Classy Prelude and the definition of <code>headMay</code>:</p>\n\n<pre><code>headMay :: Foldable f =&gt; f a -&gt; Maybe a\nheadMay = foldr (const . Just) Nothing\n</code></pre>\n\n<p>The error I get when trying to compile this is:</p>\n\n<pre><code>/prelude/Prelude.hs:32:18: error:\n    \u2022 Couldn't match type \u2018a\u2019 with \u2018Element (f a)\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n        the type signature for:\n          Prelude.headMay :: forall (f :: * -&gt; *) a.\n                             Foldable f =&gt;\n                             f a -&gt; Maybe a\n        at prelude/Prelude.hs:31:1-39\n      Expected type: Element (f a) -&gt; Maybe a -&gt; Maybe a\n        Actual type: a -&gt; Maybe a -&gt; Maybe a\n    \u2022 In the first argument of \u2018foldr\u2019, namely \u2018(const . Just)\u2019\n      In the expression: foldr (const . Just) Nothing\n      In an equation for \u2018Prelude.headMay\u2019:\n          Prelude.headMay = foldr (const . Just) Nothing\n    \u2022 Relevant bindings include\n        headMay :: f a -&gt; Maybe a (bound at prelude/Prelude.hs:32:1)\n   |\n32 | headMay = foldr (const . Just) Nothing\n   |                  ^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1280, "user_id": 156548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87294c02389a9ee0089a4eeed923b588?s=128&d=identicon&r=PG", "display_name": "thsutton", "link": "https://stackoverflow.com/users/156548/thsutton"}, "edited": false, "score": 2, "creation_date": 1574154074, "post_id": 58922522, "comment_id": 104120072, "body": "If the OP really does want some <code>IO</code> in there, there&#39;s a wrapper around <code>uname(3)</code> available on Hackage: <a href=\"http://hackage.haskell.org/package/bindings-uname\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/bindings-uname</a>"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 29, "last_activity_date": 1574109841, "last_edit_date": 1574109841, "creation_date": 1574109388, "answer_id": 58922522, "question_id": 58922435, "link": "https://stackoverflow.com/questions/58922435/why-is-accessing-system-info-not-considered-an-io-operation-in-haskell/58922522#58922522", "title": "Why is accessing System.Info not considered an IO operation in Haskell?", "body": "<p>You aren't getting that information at <em>runtime</em>. They are hardcoded in the compiler as installed on your system.</p>\n\n<p>This is most obvious if you look at the definition for <code>compilerName</code> as found in <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/System.Info.html\" rel=\"noreferrer\">http://hackage.haskell.org/package/base-4.12.0.0/docs/src/System.Info.html</a>.</p>\n\n<pre><code>compilerName :: String\ncompilerName = \"ghc\"\n</code></pre>\n\n<p>but even something like <code>os</code></p>\n\n<pre><code>os :: String\nos = HOST_OS\n</code></pre>\n\n<p>is defined in terms of an otherwise undefined name <code>HOST_OS</code> (a value starting with an uppercase letter??) which suggests that is just a placeholder which gets replaced during installation.</p>\n\n<p>Someone can also correct me (please!), but the <code>{-# LANGUAGE CPP #-}</code> pragma at the top of that file suggests that <code>HOST_OS</code> and the like are replaced by appropriate strings by the C preprocessor before compilation.</p>\n"}, {"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 19, "last_activity_date": 1574110818, "last_edit_date": 1574110818, "creation_date": 1574109797, "answer_id": 58922616, "question_id": 58922435, "link": "https://stackoverflow.com/questions/58922435/why-is-accessing-system-info-not-considered-an-io-operation-in-haskell/58922616#58922616", "title": "Why is accessing System.Info not considered an IO operation in Haskell?", "body": "<p>The question is a good one. The answer, such as it is, is that those values are static per program compilation. They are essentially compiled into the program, and never change after that.  As such, nothing (in the assumptions GHC uses) breaks if you treat them as constants. And it's more convenient to use a simple constant than an IO action.</p>\n\n<p>But that's all sort of legacy reasoning. Haskell is an old language. (No really, it's older than Java by several years.) A lot of libraries have been built with reasoning that is no longer considered best practices. These are examples of that. A modern library exposing them would probably make them IO actions even though the results don't change after compilation. It's more useful to put things that aren't constants at the source level behind IO actions, though there are still some notable exceptions, like <code>Int</code> changing size between 32- and 64-bit platforms.</p>\n\n<p>In any case... I'd say your expectations are solid, and those types are the results of historical oddities.</p>\n"}, {"comments": [{"owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "edited": false, "score": 3, "creation_date": 1574152357, "post_id": 58929464, "comment_id": 104119208, "body": "It is not true for haskell. Here any computations are unordered and their result can be cached. Functions are pure, so if a function accepts no args, than it is much like a constant. Functions of one arg look like just hashmaps or dictionaries, which compute the value based on the key. You cannot use external environment, do syscalls in such functions, you cannot even get a random number or current date. But if you actually want to use that &quot;sequencing&quot;, or environment, then you need to use <code>IO</code> monad to emulate the state, emulate the sequence of operations"}, {"owner": {"reputation": 2565, "user_id": 1108505, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a7e091fdb18efecace362189bc5f0bf5?s=128&d=identicon&r=PG", "display_name": "Tanner Swett", "link": "https://stackoverflow.com/users/1108505/tanner-swett"}, "edited": false, "score": 0, "creation_date": 1574163295, "post_id": 58929464, "comment_id": 104125323, "body": "&quot;You cannot use external environment, do syscalls in such functions&quot; \u2013 Sure you can, especially if &quot;you&quot; are the Haskell compiler! It would be very easy for a Haskell implementation to implement <code>os :: String</code> so that it does a system call when it&#39;s evaluated."}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 2, "creation_date": 1574178235, "post_id": 58929464, "comment_id": 104134213, "body": "I don&#39;t think you understand the significance of the IO monad in Haskell."}, {"owner": {"reputation": 2627, "user_id": 1715960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOtHU.png?s=128&g=1", "display_name": "andy256", "link": "https://stackoverflow.com/users/1715960/andy256"}, "reply_to_user": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1574243257, "post_id": 58929464, "comment_id": 104158770, "body": "@Sneftel You are, of course, correct. I chose to answer because after 48 years of programming in every paradigm, and writing the odd compiler, the initial answers didn&#39;t match the documentation, and they still don&#39;t. It clearly says that <code>os</code> and <code>arch</code> are obtained at runtime."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1574355596, "post_id": 58929464, "comment_id": 104213130, "body": "The documentation is a bit misleading. The values are hardcoded into the GHC compiler. After 48 years you surely know that the actual code always trumps documentation."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1574450760, "post_id": 58929464, "comment_id": 104251377, "body": "@andy256 You&#39;re absolutely right that the documentation is bad (indeed, that&#39;s part of why Francisco asked this question in the first place), and your confusion is understandable. The thing about Haskell is that if those <code>String</code> values could vary at runtime, that would be an egregious bug \u2013 variables aren&#39;t allowed to change. This is the significance of the <code>IO</code> type constructor \u2013 it represents a computation that is allowed to access the &quot;outside world&quot;, and so one whose <i>result</i> can change.  Making a system call is a good example of an <code>IO</code> action. \u2026 [1/2]"}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1574451208, "post_id": 58929464, "comment_id": 104251584, "body": "@andy256 \u2026 (Another <code>IO</code> action could be &quot;updating a global counter&quot;.)  So when we see a <code>String</code>, we know that it can&#39;t be doing any communication with the OS under the hood. This is why, perhaps surprisingly if you&#39;re not used to Haskell, it <i>wouldn&#39;t</i> be easy to implement <code>os :: String</code> to do a system call \u2013 any such value is unimplementable in basic Haskell, would violate every programmer&#39;s expectation of how programs work, and potentially even trip up the compiler and optimizer (not a theoretical concern \u2013 there are Stack Overflow answers where people run into analogous problems). [2/2]"}], "tags": [], "owner": {"reputation": 2627, "user_id": 1715960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOtHU.png?s=128&g=1", "display_name": "andy256", "link": "https://stackoverflow.com/users/1715960/andy256"}, "is_accepted": false, "score": -9, "last_activity_date": 1574484769, "last_edit_date": 1574484769, "creation_date": 1574151671, "answer_id": 58929464, "question_id": 58922435, "link": "https://stackoverflow.com/questions/58922435/why-is-accessing-system-info-not-considered-an-io-operation-in-haskell/58929464#58929464", "title": "Why is accessing System.Info not considered an IO operation in Haskell?", "body": "<p>EDIT: Thanks to @interjay and @Antal Spector-Zabusky for explaining why this answer is being downvoted. They wrote</p>\n\n<blockquote>\n  <p>The documentation is a bit misleading. The values are hardcoded into\n  the GHC compiler. After 48 years you surely know that the actual code\n  always trumps documentation. \u2013 interjay yesterday @andy256 You're\n  absolutely right that the documentation is bad (indeed, that's part of\n  why Francisco asked this question in the first place), and your\n  confusion is understandable. The thing about Haskell is that if those\n  String values could vary at runtime, that would be an egregious bug \u2013\n  variables aren't allowed to change. This is the significance of the IO\n  type constructor \u2013 it represents a computation that is allowed to\n  access the \"outside world\", and so one whose result can change. Making\n  a system call is a good example of an IO action. \u2026 [1/2] \u2013 Antal\n  Spector-Zabusky 9 hours ago @andy256 \u2026 (Another IO action could be\n  \"updating a global counter\".) So when we see a String, we know that it\n  can't be doing any communication with the OS under the hood. This is\n  why, perhaps surprisingly if you're not used to Haskell, it wouldn't\n  be easy to implement os :: String to do a system call \u2013 any such value\n  is unimplementable in basic Haskell, would violate every programmer's\n  expectation of how programs work, and potentially even trip up the\n  compiler and optimizer (not a theoretical concern \u2013 there are Stack\n  Overflow answers where people run into analogous problems). [2/2] \u2013\n  Antal Spector-Zabusky</p>\n</blockquote>\n\n<p>It currently has two delete votes. I will let that process take it's course, but suggest it actually has some value. On a side note, their explanations show that the question was weak, and so are the answers, since a Haskell newbie could easily follow the reasoning that I did.</p>\n\n<p>Original answer:</p>\n\n<p>I am not a Haskell programmer, but the two answers already given do not match the documentation that the OP linked.</p>\n\n<p>My interpretation of the documentation follows.</p>\n\n<p><code>os :: String</code> - This gives you \"The operating system on which the program is running.\"</p>\n\n<p>I expect that this will issue a system call to obtain the information. Because the system the program is compiled on may be different to the one it runs on it cannot be a value inserted by the compiler. If the code is being interpreted then the interpreter can provide the result, which must be obtained via a system call.</p>\n\n<p><code>arch :: String</code> - This gives you \"The machine architecture on which the program is running.\"</p>\n\n<p>Again, I expect that this will issue a system call to obtain the information. Because the system the program is compiled on may be different to the one it runs on it cannot be a value inserted by the compiler.</p>\n\n<p><code>compilerName :: String</code> - This gives you \"The Haskell implementation with which the program was compiled or is being interpreted.\"</p>\n\n<p>This value is certainly inserted by the compiler / interpreter.</p>\n\n<p><code>compilerVersion :: String</code> - This gives you \"The version of <code>compilerName</code> with which the program was compiled or is being interpreted.\"</p>\n\n<p>This value is certainly inserted by the compiler / interpreter.</p>\n\n<p>While you may consider the first two call to be obtaining input, the result comes from values held by the Operating System. I/O generally refers to secondary storage access.</p>\n"}], "owner": {"reputation": 1334, "user_id": 1447456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/606d9f69e64fa4eddea4bada8802f7f2?s=128&d=identicon&r=PG", "display_name": "Francisco Albert", "link": "https://stackoverflow.com/users/1447456/francisco-albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1871, "favorite_count": 0, "accepted_answer_id": 58922522, "answer_count": 3, "score": 25, "last_activity_date": 1574484769, "creation_date": 1574108960, "last_edit_date": 1574120978, "question_id": 58922435, "link": "https://stackoverflow.com/questions/58922435/why-is-accessing-system-info-not-considered-an-io-operation-in-haskell", "title": "Why is accessing System.Info not considered an IO operation in Haskell?", "body": "<p>In the module <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/System-Info.html\" rel=\"noreferrer\"><code>System.Info</code></a> I see these functions:</p>\n\n<pre><code>os :: String\narch :: String\ncompilerName :: String\ncompilerVersion :: Version\n</code></pre>\n\n<p>Why is there no <code>IO</code> there? They are accessing the system... Am I wrong?\nMy expectation was something like:</p>\n\n<pre><code>os :: IO String\narch :: IO String\ncompilerName :: IO String\ncompilerVersion :: IO Version\n</code></pre>\n\n<p>Use case:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>      print os            -- \"darwin\"\n      print arch          -- \"x86_64\"\n      print compilerName  -- \"ghc\"\n</code></pre>\n"}, {"tags": ["algorithm", "haskell", "binary-search-tree"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 6, "creation_date": 1574107014, "post_id": 58921963, "comment_id": 104105283, "body": "You used <code>t1</code>, not <code>t2</code>, as the last argument to <code>bstHelper</code> in the second recursive call."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1574107182, "post_id": 58921963, "comment_id": 104105346, "body": "Enable warnings, it will report the unused <code>t2</code>. Strongly recommended."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1574109135, "post_id": 58921963, "comment_id": 104106296, "body": "It might help to compile with <code>-Wall</code>. The GHC compiler can check a certain number of things, and often can warn you about &quot;strange&quot; elements in your code."}], "answers": [{"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 0, "last_activity_date": 1574159394, "creation_date": 1574159394, "answer_id": 58931892, "question_id": 58921963, "link": "https://stackoverflow.com/questions/58921963/how-do-you-debug-a-bst-verification-algorithm-in-haskell/58931892#58931892", "title": "How do you debug a BST verification algorithm in Haskell?", "body": "<p>The solution to fixing your code is in the comments below your question, use <code>t2</code> in the last part: <code>(bstHelper max x t2)</code>. If you compile with <code>-Wall</code> it would probably tell you that you have an unused parameter <code>t2</code>. If you name a value in Haskell and do not use it, the compiler will complain. If you want to name a value and not use it, then you should prefix the name with <code>_</code>.</p>\n\n<p>Finally, a few tips for how to approach debugging in Haskell. If it is compiling and there are non warnings, load it into GHCi and <code>bstHelper</code> on a few examples to see if it works as you expect. Then the next step is to setup tests, take a look at these libraries: <code>hspec</code> a testing library (with just this you can do unit testing), <code>QuickCheck</code> helps you generate arbitrary (fuzzed) data to test the properties of a program (property testing).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1574159394, "creation_date": 1574106861, "question_id": 58921963, "link": "https://stackoverflow.com/questions/58921963/how-do-you-debug-a-bst-verification-algorithm-in-haskell", "title": "How do you debug a BST verification algorithm in Haskell?", "body": "<p>I'm trying to write a verification algorithm that a tree satisfies the BST property, and am asking about a bug in my code.</p>\n\n<pre><code>data Tree x = Leaf x | Node x (Tree x) (Tree x)\n  deriving (Show)\n\nwindow :: Int -&gt; Int -&gt; Int -&gt; Bool\nwindow min max x = min &lt;= x &amp;&amp; x &lt;= max \n\nbstHelper :: Int -&gt; Int -&gt; Tree Int -&gt; Bool\nbstHelper min max (Leaf x) = window min max x\nbstHelper min max (Node x t1 t2) = (window min max x) &amp;&amp; (bstHelper min x t1) &amp;&amp; (bstHelper x max t1)\n\nx1 = bstHelper 3 6 (Node 5 (Leaf 3) (Leaf 6))\nx2 = (window 3 6 5) &amp;&amp; (bstHelper 3 5 (Leaf 3)) &amp;&amp; (bstHelper 5 6 (Leaf 6)) \n\nwrong = x1 == x2\n</code></pre>\n\n<p>Why is wrong false?<br>\nHow would you personally debug this?</p>\n"}, {"tags": ["haskell", "generics"], "answers": [{"comments": [{"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1574110616, "post_id": 58922607, "comment_id": 104106967, "body": "I think that is getting me much of the way there, thanks. Currently dealing with the issue of finding a more generic alternative to <code>mconcat</code> ... which may require a change to the overall type signature."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1574115050, "post_id": 58922607, "comment_id": 104108746, "body": "In my defense, I had linked a post on SO which includes the relevant imports, will get those added in later"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 1, "creation_date": 1574115402, "post_id": 58922607, "comment_id": 104108882, "body": "Yes, I looked at the linked post. It does list imports, but not packages (and also, not <code>SummaryFun</code>). And even if it did, I&#39;d have to set up a new project with those packages just to reproduce the problem. This is too much effort, most people don&#39;t have the time."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 3, "last_activity_date": 1574110274, "last_edit_date": 1574110274, "creation_date": 1574109752, "answer_id": 58922607, "question_id": 58921905, "link": "https://stackoverflow.com/questions/58921905/how-to-fix-type-errors-including-cant-quantify-over-traversable-when-generi/58922607#58922607", "title": "How to fix type errors, including &quot;Can&#39;t quantify over Traversable&quot;, when generifying this SOP function?", "body": "<p>I can't be sure this will fix everything, because it's very hard to reproduce your problem: it requires a lot of packages and imports that I just don't have the time to set up (<em>hint: in the future, try to reduce your problems to minimal reproducible examples before posting</em>). But I'm going to post this anyway, because I can see at least one problem, and it seems to be related to the error message.</p>\n\n<hr>\n\n<p>The problem is that <code>t</code> on the first line is not the same as <code>t</code> on the third line, and they are both different from the <code>t</code> on the fifth line. And so on, for all type signatures involving <code>t</code>.</p>\n\n<p>By default, in Haskell2010 every type variable's scope is only the type signature in which it's introduced. If you use the same letter in another type signature, it will signify a completely separate type, despite looking identical to the human eye.</p>\n\n<p>To specify that you actually mean <code>t</code> to be the same everywhere, you have to use <code>forall</code> in the top type signature:</p>\n\n<pre><code>applyRecFun :: forall t. (Traversable t, _) =&gt; Record (SummaryFun t) _ -&gt; t r -&gt; r\n</code></pre>\n\n<p>Enabled by the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#extension-ScopedTypeVariables\" rel=\"nofollow noreferrer\"><code>ScopedTypeVariables</code> extension</a>, the <code>forall</code> keyword creates an <em>explicit scope</em> for the type variable <code>t</code>. Scopes come in different flavors, but when opened in a function's type signature, the scope's extent is the whole body of that function.</p>\n\n<p>I'm not sure this will solve everything for you, but at least you should be getting different errors now.</p>\n"}, {"tags": [], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "is_accepted": false, "score": 0, "last_activity_date": 1574180385, "creation_date": 1574180385, "answer_id": 58938566, "question_id": 58921905, "link": "https://stackoverflow.com/questions/58921905/how-to-fix-type-errors-including-cant-quantify-over-traversable-when-generi/58938566#58938566", "title": "How to fix type errors, including &quot;Can&#39;t quantify over Traversable&quot;, when generifying this SOP function?", "body": "<p>Building on Fyodor's answer, I have a compiling (but as yet untested) code. I had to change a few assumptions in the type signature, such as returning the result wrapped in <code>Maybe</code>, and assuming the <code>Traversable</code> also forms a <code>Semigroup</code>. I'll revise the wording of the question and this answer once I've had a chance to properly test and construct a self-contained example as suggested by Fyodor:</p>\n\n<pre><code>newtype SummaryFun t a = SummaryFun (t a -&gt; a)\n\napplyRecFun :: forall r t. (Traversable t, Semigroup (t r), _) =&gt;\n  Record (SummaryFun t) _ -&gt; t r -&gt; Maybe r\napplyRecFun func recs =\n  let recsNP :: t (NP I _) -- a traversable of n-ary products. I is an identity functor\n      recsNP = toNP . toRecord &lt;$&gt; recs\n      listrecsNP :: t (NP t _) -- turn every component into a singleton traversable\n      listrecsNP = liftA_NP (\\(I x) -&gt; pure x) &lt;$&gt; recsNP\n      listrecNPmay :: Maybe (NP t _) -- a single n-ary product where each component is a traversable\n      listrecNPmay = listrecsNP &amp; (headMay &amp;&amp;&amp; tailMay) &amp; sequenceT\n        &lt;&amp;&gt; (\\(h, t) -&gt; foldr mappend h t)\n      funcNP :: NP (SummaryFun t) _ -- turn the function record into a n-ary prod\n      funcNP = toNP func\n      toRec_NP_I :: NP t _ -&gt; NP I _ -- apply the functions to each list component\n      toRec_NP_I = liftA2_NP (\\(SummaryFun f) vs -&gt; I (f vs)) funcNP\n   in do\n    listrecNP &lt;- listrecNPmay\n    let resultRec_NP_I = toRec_NP_I listrecNP\n    pure $ fromRecord . fromNP $ resultRec_NP_I -- go back to the nominal record Rec\n</code></pre>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574180557, "creation_date": 1574106624, "last_edit_date": 1574180557, "question_id": 58921905, "link": "https://stackoverflow.com/questions/58921905/how-to-fix-type-errors-including-cant-quantify-over-traversable-when-generi", "title": "How to fix type errors, including &quot;Can&#39;t quantify over Traversable&quot;, when generifying this SOP function?", "body": "<p>I'll just say I'm not even sure if this is possible; it is by far the most generic thing I've tried doing in Haskell. I'm trying to make a more generic version of the <code>applyFunc</code> found in <a href=\"https://stackoverflow.com/a/58890226/3096687\">https://stackoverflow.com/a/58890226/3096687</a>:</p>\n\n<pre><code>newtype SummaryFun t a = SummaryFun (t a -&gt; a)\n\napplyRecFun :: (Traversable t, _) =&gt; Record (SummaryFun t) _ -&gt; t r -&gt; r\napplyRecFun func recs =\n  let recs_NP :: t (NP I _) -- a list of n-ary products. I is an identity functor\n      recs_NP = toNP . toRecord &lt;$&gt; recs\n      listrecs_NP :: t (NP t _) -- turn every component into a singleton list\n      listrecs_NP = liftA_NP (\\(I x) -&gt; pure x) &lt;$&gt; recs_NP\n      listrec_NP :: NP t _ -- a single n-ary product where each component is a list\n      listrec_NP = mconcat listrecs_NP\n      func_NP :: NP (SummaryFun t) _ -- turn the function record into a n-ary prod\n      func_NP = toNP func\n      resultRec_NP_I :: NP I _ -- apply the functions to each list component\n      resultRec_NP_I = liftA2_NP (\\(SummaryFun f) vs -&gt; I (f vs)) func_NP listrec_NP\n   in fromRecord . fromNP $ resultRec_NP_I -- go back to the nominal record Rec\n</code></pre>\n\n<p>The first issue being run into is:</p>\n\n<pre><code>\u2022 Can't quantify over \u2018t\u2019                  \n    bound by the partial type signature: recs_NP :: t (NP I _)\n</code></pre>\n\n<p>And similar errors occur elsewhere.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 243, "user_id": 13679816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b02acae66c6a347786eb93e8cbead85?s=128&d=identicon&r=PG", "display_name": "atravers", "link": "https://stackoverflow.com/users/13679816/atravers"}, "edited": false, "score": 0, "creation_date": 1605592210, "post_id": 58919993, "comment_id": 114690318, "body": "Related: <a href=\"https://stackoverflow.com/questions/41522491/is-there-a-way-to-place-some-impure-code-inside-pure-functions\" title=\"is there a way to place some impure code inside pure functions\">stackoverflow.com/questions/41522491/&hellip;</a> ."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "edited": false, "score": 0, "creation_date": 1574098676, "post_id": 58920088, "comment_id": 104101488, "body": "How would you use <code>IO</code> and return an <code>Int</code> at the same time? Not for debugging"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "edited": false, "score": 1, "creation_date": 1574099083, "post_id": 58920088, "comment_id": 104101679, "body": "You mean, have a function with type <code>Int -&gt; IO Int</code>?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "edited": false, "score": 1, "creation_date": 1574101037, "post_id": 58920088, "comment_id": 104102550, "body": "@w1220 you can&#39;t. Once you&#39;ve got an <code>IO</code> value, you can&#39;t get back to a non-<code>IO</code> one. This is by design - any <code>IO</code> effects make a function/value impure, and this needs to be reflected in the type signature. If you described your actual problem, we might be able to help you figure out how to do it in Haskell."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1574103104, "post_id": 58920088, "comment_id": 104103453, "body": "@RobinZigmond I had the same thought &quot;this is a FAQ&quot;, but apparently the OP has no issues with the <code>IO</code> part in <code>IO ()</code>, but dislikes the <code>()</code> part since they want to return a <code>Int</code>. So, <code>IO Int</code> is the answer."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1574164016, "post_id": 58920088, "comment_id": 104125732, "body": "Note to future readers wondering <i>why</i> <code>trace</code> is &quot;for debugging purposes only&quot; and why you shouldn&#39;t use it in your program: you&#39;ll change a different part of your program and suddenly you&#39;ll find that your <code>trace</code> is printing several times or not at all."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 7, "last_activity_date": 1574100029, "last_edit_date": 1574100029, "creation_date": 1574098428, "answer_id": 58920088, "question_id": 58919993, "link": "https://stackoverflow.com/questions/58919993/output-in-middle-of-function/58920088#58920088", "title": "Output in middle of function", "body": "<p>For <em>debugging purposes only</em>, you can use the the <code>trace</code> function. If you really want to produce output, use <code>IO</code>.</p>\n\n<pre><code>import Debug.Trace\n\nf :: Int -&gt; Int\nf n = trace (show n) (n + 1)\n</code></pre>\n\n<p><code>trace</code> is essentially an impure function that writes its argument to standard error and returns the identity function.</p>\n\n<p>To do this properly, using <code>IO</code>, change the type to <code>Int -&gt; IO Int</code>.</p>\n\n<pre><code>f :: Int -&gt; IO Int\nf n = do\n    print n\n    return (n + 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 893, "user_id": 6248287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPegr.jpg?s=128&g=1", "display_name": "\u019b\u019b\u019b", "link": "https://stackoverflow.com/users/6248287/%c6%9b%c6%9b%c6%9b"}, "is_accepted": true, "score": 8, "last_activity_date": 1574099253, "creation_date": 1574099253, "answer_id": 58920270, "question_id": 58919993, "link": "https://stackoverflow.com/questions/58919993/output-in-middle-of-function/58920270#58920270", "title": "Output in middle of function", "body": "<p><code>f</code> consumes an Int; it produces an IO action</p>\n\n<pre><code>f n = print n &gt;&gt; return ( n + 1) :: IO Int \n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 58920270, "answer_count": 2, "score": 0, "last_activity_date": 1574100029, "creation_date": 1574098040, "question_id": 58919993, "link": "https://stackoverflow.com/questions/58919993/output-in-middle-of-function", "title": "Output in middle of function", "body": "<p>How can you output something in the middle of a function but still return something other than IO ()?</p>\n\n<pre><code>f :: Int -&gt; Int\nf n = do\n    print n\n    n + 1\n</code></pre>\n\n<p>thanks</p>\n"}, {"tags": ["arrays", "haskell"], "comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 2, "creation_date": 1574093706, "post_id": 58917739, "comment_id": 104098855, "body": "The expression <code>fastFibo(a i)</code> doesn&#39;t mean what you think it does. Use <code>(fastFibo a i)</code> instead."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574103208, "post_id": 58917739, "comment_id": 104103502, "body": "Suggestion: don&#39;t use <code>do</code> unless you are working in a monad. In the code above, you are not. Further, adding a type signatures to <code>fibos</code> would help GHC produce better type error messages."}], "answers": [{"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 2, "last_activity_date": 1574094705, "last_edit_date": 1574094705, "creation_date": 1574093982, "answer_id": 58918858, "question_id": 58917739, "link": "https://stackoverflow.com/questions/58917739/creating-an-array-with-a-function-using-index-and-array/58918858#58918858", "title": "Creating an array with a function using index and array?", "body": "<p>Using a less fast algorithm that still operates on an array, you could do:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Array\n\nfib :: Int -&gt; Int\nfib n = arr ! n\n  where\n    arr :: Array Int Int\n    arr = listArray (1, n) $\n      0 : 1 : [ (arr ! (i-1)) + (arr ! (i-2)) | i &lt;- [3..n] ]\n</code></pre>\n\n<p>If you were to transform this to use your faster algorithm, it'd be something like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Array\n\nfib :: Int -&gt; Int\nfib n = arr ! n\n  where\n    arr :: Array Int Int\n    arr = listArray (1, n) $\n      0 : 1 : 1 : map fib' [4..n]\n\n    fib' :: Int -&gt; Int\n    fib' k\n      | even k    = ...\n      | otherwise = ...\n</code></pre>\n\n<p>I figured <code>listArray</code> was sufficient here. It's pretty close to <code>array</code> which you use.</p>\n\n<p>See the documentation on <a href=\"https://hackage.haskell.org/package/array/docs/Data-Array.html#g:2\" rel=\"nofollow noreferrer\">array construction</a> for the difference.</p>\n"}], "owner": {"reputation": 33, "user_id": 12161526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760c4f348c3263926f9210cda16813ad?s=128&d=identicon&r=PG&f=1", "display_name": "Xychic", "link": "https://stackoverflow.com/users/12161526/xychic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 58918858, "answer_count": 1, "score": 3, "last_activity_date": 1574094705, "creation_date": 1574090364, "question_id": 58917739, "link": "https://stackoverflow.com/questions/58917739/creating-an-array-with-a-function-using-index-and-array", "title": "Creating an array with a function using index and array?", "body": "<p>I am wanting to create an array of the Fibonacci numbers using haskell, but using a this more efficient algorithm</p>\n\n<pre><code>F(2K) = F(K)[2F(K-1)-F(K)]\nF(2K+1) = F(K+1)^2 + F(K)^2\n</code></pre>\n\n<p>I know the function works and I can pass through the index or the array but not both and I can't figure out why</p>\n\n<pre><code>fastFibo :: Array Int Int -&gt; Int -&gt; Int\nfastFibo a 0 = 0\nfastFibo a 1 = 1\nfastFibo a 2 = 1\nfastFibo a x = do\n    if ((mod x 2) == 0) \n        then do\n            let y = div x 2\n            (a!y) * (2 * (a!(y+1)) - (a!y))\n        else do\n            let y = div (x-1) 2\n            (a!y)^2 + (a!(y+1))^2\n\nfibos n = a where a = array (0,n) ([(0, 0), (1, 1), (2,1)] ++ [(i, fastFibo(a i)) | i &lt;- [2..n]])\n</code></pre>\n\n<p>The error I get is </p>\n\n<pre><code>    \u2022 Couldn't match expected type \u2018i1 -&gt; Array Int Int\u2019\n                  with actual type \u2018Array i1 (Int -&gt; Int)\u2019\n    \u2022 Possible cause: \u2018array\u2019 is applied to too many arguments\n      In the expression:\n        array\n          (0, n)\n          ([(0, 0), (1, 1), (2, 1)] ++ [(i, fastFibo (a i)) | i &lt;- [2 .. n]])\n      In an equation for \u2018a\u2019:\n          a = array\n                (0, n)\n                ([(0, 0), (1, 1), (2, 1)] ++ [(i, fastFibo (a i)) | i &lt;- [2 .. n]])\n      In an equation for \u2018fibos\u2019:\n          fibos n\n            = a\n            where\n                a = array\n                      (0, n) ([(0, 0), ....] ++ [(i, fastFibo (a i)) | i &lt;- [2 .. n]])\n    \u2022 Relevant bindings include\n        a :: i1 -&gt; Array Int Int\n          (bound at /mnt/data/Documents/Programming/Haskell/Arrays/Arrays.hs:20:19)\n   |\n20 | fibos n = a where a = array (0,n) ([(0, 0), (1, 1), (2,1)] ++ [(i, fastFibo(a i)) | i &lt;- [2..n]])\n   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "interactive"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 7, "creation_date": 1574086767, "post_id": 58916610, "comment_id": 104094729, "body": "Use <code>:{</code> and <code>:}</code> around a multi-line statement. Right now the interpreter things you <i>defined</i> a new function that happens to have the same name as the one in the previous line."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1574088300, "post_id": 58916610, "comment_id": 104095699, "body": "It&#39;s simpler if you write your code in a file and load it in GHCi. GHCi is not very convenient to use for multi-line definitions like the one above, requiring one to enter multi-line mode with <code>:{</code> or to write everything in one line e.g. <code>qsort [] = [] ; qsort (x:xs) = ...</code>. Using a file also makes it much easier to tinker around: we can experiment, make a small change, experiment again, make another change, and so on. Reloading is only a &quot;save&quot; &amp; <code>:r</code> away."}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 0, "creation_date": 1574093411, "post_id": 58917382, "comment_id": 104098692, "body": "Bummer.. that means I have to either open two windows, or jump back and forth from ghci to vim.. :("}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "reply_to_user": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "edited": false, "score": 1, "creation_date": 1574107169, "post_id": 58917382, "comment_id": 104105344, "body": "@Student if you are using mac or linux there is a great tool called tmux. Install it then open a terminal, type <code>tmux</code>, then split it into two windows. You can have ghci and vim in each window and see both at the same time. <a href=\"https://www.ocf.berkeley.edu/~ckuehl/tmux/\" rel=\"nofollow noreferrer\">ocf.berkeley.edu/~ckuehl/tmux</a>"}], "tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": true, "score": 5, "last_activity_date": 1574089634, "last_edit_date": 1574089634, "creation_date": 1574089168, "answer_id": 58917382, "question_id": 58916610, "link": "https://stackoverflow.com/questions/58916610/should-i-avoid-using-interactive-mode/58917382#58917382", "title": "Should I avoid using interactive mode?", "body": "<p>It's generally easier to define a multi-line function in a file and then load <code>:l &lt;module&gt;</code> or reload <code>:r</code>, but I do sometimes declare a multi-line function directly in GHCi starting with <code>:{</code> and <code>:}</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>:{\nquicksort (firstx:xs) = quicksort[x|x&lt;-xs, x&lt;firstx] ++ [firstx] ++ quicksort[x|x&lt;-xs, not(x&lt;firstx)]\nquicksort [] = []\n:}\n</code></pre>\n\n<p><code>:h</code> is useful if you forget any commands while in GHCi.</p>\n\n<p>Edit: forget to address the second part of your question.</p>\n\n<blockquote>\n  <p>Is it a rule of thumb that one should avoid using interactive mode?</p>\n</blockquote>\n\n<p>Interactive mode is a great tool and I miss it in other ecosystems like ReasonML that do not have one. There is no reason to avoid it. Just remember to copy your code over if you come up with some that you want to keep.</p>\n"}], "owner": {"reputation": 404, "user_id": 11392504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b00e9f81811e12413804ac19b4965869?s=128&d=identicon&r=PG&f=1", "display_name": "Student", "link": "https://stackoverflow.com/users/11392504/student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 58917382, "answer_count": 1, "score": 2, "last_activity_date": 1574089634, "creation_date": 1574086693, "question_id": 58916610, "link": "https://stackoverflow.com/questions/58916610/should-i-avoid-using-interactive-mode", "title": "Should I avoid using interactive mode?", "body": "<p>Haskell newbie here. I use <code>ghci</code> to implement a baby <code>quicksort</code> algorithm [1] as follows:</p>\n\n<pre><code>Prelude&gt; quicksort (firstx:xs) = quicksort[x|x&lt;-xs, x&lt;firstx] ++ [firstx] ++ quicksort[x|x&lt;-xs, not(x&lt;firstx)]\nPrelude&gt; quicksort [] = []\n</code></pre>\n\n<p>The command <code>quicksort [1,2,3]</code> then gives an error: </p>\n\n<blockquote>\n  <p>*** Exception: :8:1-17: Non-exhaustive patterns in function quicksort</p>\n</blockquote>\n\n<p>However, typing the exact same thing in an <code>quicksort.hs</code> file and running <code>$ ghci quicksort.hs</code> do not yield such an error.</p>\n\n<h3>Question</h3>\n\n<p>What makes the difference? Is it a rule of thumb that one should avoid using interactive mode?</p>\n\nReference\n\n<p>[1] Rex Page. Two Dozen Short Lessons in Haskell</p>\n"}, {"tags": ["haskell", "postgresql-simple"], "owner": {"reputation": 608, "user_id": 4417894, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/b167616728ad1b28658665b14863fc99?s=128&d=identicon&r=PG&f=1", "display_name": "emg184", "link": "https://stackoverflow.com/users/4417894/emg184"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574082474, "creation_date": 1574082474, "question_id": 58915290, "link": "https://stackoverflow.com/questions/58915290/how-to-dynamically-assemble-sql-queries-with-haskell-based-on-route-parameters", "title": "How to Dynamically assemble SQL queries with haskell based on route parameters", "body": "<p>I've got a scotty web app that I am trying to implement a dynamic search interface over and keep hitting a wall on how I should implement it. The Basic premise is the following:</p>\n\n<p>Given a list of URL parameters: <code>let params = [Param]</code></p>\n\n<p>where param: <code>type Param = (Text, Text)</code></p>\n\n<p>I would like to be able to </p>\n\n<p>Lets say I have a table in my database where:</p>\n\n<pre><code>Users\n| user_id | username | email | first_name | last_name | created_at |\n|---------|----------|-------|------------|-----------|------------|\n|   Int   |  Text    | Text  |  Text      | Text      | timestamp  |\n</code></pre>\n\n<p>My base SQL query might look like this:</p>\n\n<pre><code>baseQuery :: Query\nbaseQuery :: [sql| SELECT user_id, username, email, first_name, last_name, created_at FROM users |]\n</code></pre>\n\n<p>In the case of receiving url parameters I would want to be able to apply them to the WHERE clause, ORDER BY clause, etc.</p>\n\n<p>What would be the best strategy to transform the following url:</p>\n\n<pre><code>arbitraryhost:/users?order_by_max=user_id&amp;first_name=emg184&amp;last_name=stackoverflow&amp;limit=20\n\n</code></pre>\n\n<p>which would result in the following parameters list:</p>\n\n<p><code>let params = [(\"order_by_max\",\"user_id\"), (\"first_name\",\"emg184\"), (\"last_name\",\"stackoverflow\"), (\"limit\", \"20\")]</code></p>\n\n<p>How would i generate the follwing query:</p>\n\n<pre><code>\"SELECT user_id, username, email, first_name, last_name, created_at \nFROM users\nWHERE first_name = ? AND last_name = ?\nORDER BY user_id\nLIMIT ?\"\n\n(\"emg184\", \"stackoverflow\", 20)\n</code></pre>\n\n<p>(I really like the way that the query builder knexjs works which allows for ad hoc fragments of queries to be generated and applied as a higher order function to some base query <a href=\"http://knexjs.org/\" rel=\"nofollow noreferrer\">http://knexjs.org/</a>)</p>\n\n<p>Im wondering what a strategy or implementation of this might be as I have not been successful in building anything that I find to be very fitting for this.</p>\n"}, {"tags": ["haskell", "haskell-stack", "nix"], "comments": [{"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1574083770, "post_id": 58914475, "comment_id": 104092958, "body": "Nothing to your question, but wouldn&#39;t it be more comfortable to run <code>stack build</code>, <code>stack exec</code> inside of <code>nix-shell</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": false, "score": 0, "last_activity_date": 1574278154, "creation_date": 1574278154, "answer_id": 58961967, "question_id": 58914475, "link": "https://stackoverflow.com/questions/58914475/how-to-add-a-nix-project-as-dependency-in-a-haskell-stacknix-project/58961967#58961967", "title": "How to add a Nix project as dependency in a Haskell Stack+Nix project", "body": "<p>To enter a shell with the executables in the PATH: <code>nix shell</code> (by default it references <code>shell.nix</code>).</p>\n\n<p>To add <code>tezos-baking-platform</code> as a dependency I think you just add it in <code>buildInputs</code>. If this is from a <code>channel</code> named <code>tezos</code> you will have to import this:</p>\n\n<pre><code>tezos = import &lt;tezos&gt; {};\n\n...\n\ntezos.tezos-baking-platform\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 4939115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhXgf.png?s=128&g=1", "display_name": "eatt1029", "link": "https://stackoverflow.com/users/4939115/eatt1029"}, "is_accepted": true, "score": 2, "last_activity_date": 1574788285, "creation_date": 1574788285, "answer_id": 59056122, "question_id": 58914475, "link": "https://stackoverflow.com/questions/58914475/how-to-add-a-nix-project-as-dependency-in-a-haskell-stacknix-project/59056122#59056122", "title": "How to add a Nix project as dependency in a Haskell Stack+Nix project", "body": "<p>I figured out a working (but maybe not perfect) solution.</p>\n\n<p>Because the <em>tezos-baking-platform</em> is not providing nix derivation, so the simplest way is to put the entire repository into the working repository and <code>import</code> its nix file. This will make <code>tezos.babylonnet.kit</code> available in nix so we can set it as a dependency directly.</p>\n\n<pre><code>{ghc}:\nwith (import &lt;nixpkgs&gt; {});\nwith import ./tezos-baking-platform/default.nix {};\nhaskell.lib.buildStackProject {\n  inherit ghc;\n  name = \"qq\";\n  buildInputs = [ tezos.babylonnet.kit ];\n}\n\n</code></pre>\n\n<p>PS. Ideally, if the tezos-baking-platform provided a nix derivation, then we can do something like </p>\n\n<pre><code>{ghc}:\nwith (import &lt;nixpkgs&gt; {});\n\nstdenv.mkDerivation {\n  name = \"tezos-baking-platform\";\n  version = \"0.0.0\";\n  src = fetchurl {\n    url    = \"https://gitlab.com/obsidian.systems/tezos-baking-platform/\";\n    rev    = \"2f37c78a4b0ac26ee5e428711ab3c7ebeb9869fb\";\n    sha256 = \"0h71ivsva7hfqy0zy1pbx68a4i8lbqln3k9zkw0j2rgain39844r\";\n  };\n}\n\nhaskell.lib.buildStackProject {\n  inherit ghc;\n  name = \"myproject\";\n  buildInputs = [ tezos-baking-platform ];\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4939115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhXgf.png?s=128&g=1", "display_name": "eatt1029", "link": "https://stackoverflow.com/users/4939115/eatt1029"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "accepted_answer_id": 59056122, "answer_count": 2, "score": 4, "last_activity_date": 1574788285, "creation_date": 1574079712, "last_edit_date": 1574082504, "question_id": 58914475, "link": "https://stackoverflow.com/questions/58914475/how-to-add-a-nix-project-as-dependency-in-a-haskell-stacknix-project", "title": "How to add a Nix project as dependency in a Haskell Stack+Nix project", "body": "<p>I'm trying to write a haskell project using <em>stack</em> + <em>nix</em>. My current <em>stack.yaml</em> and <em>shell.nix</em> are as follows:</p>\n\n<pre><code>resolver: lts-14.6\npackages:\n- .\nnix:\n  enable: true\n  pure: true\n  shell-file: shell.nix\n</code></pre>\n\n<pre><code>{ghc}:\nwith (import &lt;nixpkgs&gt; {});\n\nhaskell.lib.buildStackProject {\n  inherit ghc;\n  name = \"myproject\";\n  buildInputs = [ pkg-config libmysqlclient postgresql_10 pcre libsodium secp256k1 zlib ];\n  PGPASSWORD = builtins.getEnv \"PGPASSWORD\";\n}\n</code></pre>\n\n<p>Now, in my haskell project, I want to execute <em>tezos-client</em> and other tools provided by <a href=\"https://gitlab.com/yunyan9chs/tezos-baking-platform/blob/9chs-tezos-only/\" rel=\"nofollow noreferrer\">tezos-baking-platform</a>. I can build it by running</p>\n\n<blockquote>\n  <p>nix-build -A tezos.babylonnet.kit</p>\n</blockquote>\n\n<p>The problem is, after building, I can find all the executable files in, for example, <code>/nix/store/bgqva3wgi3knivdk9pf7gdd0384hj2qf-tezos-0.0.0/bin/</code>. But they are not exposed to nix-env and I can't find any symlink for tezos in <code>~/.nix-profile/bin/</code>.</p>\n\n<p>So, (1) how can I fix this? and (2) how can I set that <em>tezos-baking-platform</em> as a dependency of my haskell project? (i.e. through stack to ask nix for building tezos for me right before build my haskell project)</p>\n"}, {"tags": ["string", "haskell", "constructor", "type-conversion", "show"], "comments": [{"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1574071693, "post_id": 58912089, "comment_id": 104086253, "body": "Is <code>rank</code> supposed to be the same as <code>displayRank</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1574071746, "post_id": 58912089, "comment_id": 104086284, "body": "@mkriger1: I guess <code>rank</code> is a &quot;getter&quot; of the <code>Card</code> type, but since we do not see the data definitions, we can not know for sure."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1574074831, "post_id": 58912089, "comment_id": 104088092, "body": "<code>displayRank (Numeric a) = show a</code>. But it is recommended to write a <code>Show</code> instance for your type."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1574075688, "creation_date": 1574075688, "answer_id": 58913322, "question_id": 58912089, "link": "https://stackoverflow.com/questions/58912089/how-to-convert-from-a-constructor-to-a-string-in-haskell/58913322#58913322", "title": "How to convert from a constructor to a string in Haskell?", "body": "<p>What you accomplish with <code>show (rank c)</code>,</p>\n\n<pre><code>rank ::        Card -&gt; Rank\nshow ::                Rank -&gt; String\n</code></pre>\n\n<p>you can accomplish with <code>displayRank (rank c)</code></p>\n\n<pre><code>rank ::        Card -&gt; Rank\ndisplayRank ::         Rank -&gt; String\n</code></pre>\n\n<p>(speaking of types). </p>\n"}, {"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 4, "last_activity_date": 1574166204, "last_edit_date": 1574166204, "creation_date": 1574080673, "answer_id": 58914754, "question_id": 58912089, "link": "https://stackoverflow.com/questions/58912089/how-to-convert-from-a-constructor-to-a-string-in-haskell/58914754#58914754", "title": "How to convert from a constructor to a string in Haskell?", "body": "<blockquote>\n  <p>I would prefer to do this without a helper function because it seems really messy</p>\n</blockquote>\n\n<p>Assuming you have something like the following types,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Card = Card { cardRank :: Rank, cardSuit :: Suit }\n  deriving (Eq, Show)\n\ndata Rank = Numeric Int | Jack | Queen | King | Ace\n  deriving (Eq, Show)\n\ndata Suit = Diamonds | Clubs | Hearts | Spades\n  deriving (Eq, Show)\n</code></pre>\n\n<p>then it would make sense to write helper functions</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>displayRank :: Rank -&gt; String\ndisplayRank (Numeric n) = show n\ndisplayRank otherRank = show otherRank\n\ndisplaySuit :: Suit -&gt; String\ndisplaySuit = show\n\ndisplayCard :: Card -&gt; String\ndisplayCard (Card rank suit) = ...\n</code></pre>\n\n<p>but you could also combine them:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>displayCard :: Card -&gt; String\ndisplayCard (Card (Numeric n) suit) = ...\ndisplayCard (Card otherRank suit) = ...\n</code></pre>\n\n<p>Having properly designed helper functions is not messy. On the contrary.</p>\n"}], "owner": {"reputation": 197, "user_id": 11094853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26974b35c81e0675ca4416101ebf045?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11094853/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 58914754, "answer_count": 2, "score": 0, "last_activity_date": 1574166204, "creation_date": 1574071584, "question_id": 58912089, "link": "https://stackoverflow.com/questions/58912089/how-to-convert-from-a-constructor-to-a-string-in-haskell", "title": "How to convert from a constructor to a string in Haskell?", "body": "<p>I am trying to output a hand of cards in string format, but I can't drop the word \"Numeric\" from the rank of the card, I would prefer to do this without a helper function because it seems really messy, any recommendations to do this without a helper function. Also, when I'm using the <code>display</code> function, I'm using <code>putStr (display x)</code> in the Prelude. Here's the code so far for it:</p>\n\n<pre><code>displayCard :: Card -&gt; String\ndisplayCard c = show (rank c) ++ \" of \" ++ show (suit c) ++ \"\\n\"\n\ndisplay :: Hand -&gt; String\ndisplay Empty = \"\\n\"\ndisplay (Add c h) = displayCard c\n                    ++ display h\n\ndisplayRank :: Rank -&gt; String\ndisplayRank (Numeric 2) = \"2\"\ndisplayRank (Numeric 3) = \"3\"\ndisplayRank (Numeric 4) = \"4\"\ndisplayRank (Numeric 5) = \"5\"\ndisplayRank (Numeric 6) = \"6\"\ndisplayRank (Numeric 7) = \"7\"\ndisplayRank (Numeric 8) = \"8\"\ndisplayRank (Numeric 9) = \"9\"\ndisplayRank (Numeric 10) = \"10\"\ndisplayRank Jack = \"Jack\"\ndisplayRank Queen = \"Queen\"\ndisplayRank King = \"King\"\ndisplayRank Ace = \"Ace\"\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "cabal"], "comments": [{"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1574084452, "post_id": 58911691, "comment_id": 104093391, "body": "take a look <a href=\"https://svejcar.dev/posts/2019/09/23/haskell-on-raspberry-pi-4/\" rel=\"nofollow noreferrer\">here</a> if <code>stack</code>-based approach would be an option."}, {"owner": {"reputation": 23, "user_id": 11201655, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M3IZci_O62I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rds5y20oaJ8QkP7Gv4NwKFZMDVqMw/mo/photo.jpg?sz=128", "display_name": "Hans Zimmer", "link": "https://stackoverflow.com/users/11201655/hans-zimmer"}, "reply_to_user": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1574090828, "post_id": 58911691, "comment_id": 104097170, "body": "Thanks @palik. I have no experience with this stuff. I just have to port an existing game which was started by &quot;runhaskell srcipt.hs&quot;. I can&#39;t figure out how to do this after configuration of the stack like described in your link. Thanks"}], "owner": {"reputation": 23, "user_id": 11201655, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M3IZci_O62I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rds5y20oaJ8QkP7Gv4NwKFZMDVqMw/mo/photo.jpg?sz=128", "display_name": "Hans Zimmer", "link": "https://stackoverflow.com/users/11201655/hans-zimmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574070133, "creation_date": 1574070133, "question_id": 58911691, "link": "https://stackoverflow.com/questions/58911691/ghc-cabal-on-raspberry-pi-4-with-debian-buster", "title": "GHC &amp; Cabal on Raspberry Pi 4 with Debian Buster", "body": "<p>Is there already a way to install GHC &amp; Cabal on a Raspberry Pi with Debian Buster?\n<a href=\"https://downloads.haskell.org/~debian/\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~debian/</a></p>\n\n<p>I need to port an already existing code to the new Raspberry Pi 4.</p>\n\n<p>Thanks and best regards,\nManuel</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 7, "creation_date": 1574038257, "post_id": 58906666, "comment_id": 104076026, "body": "Short answer: you don&#39;t. You just build an even bigger <code>IO</code> action that computes the result. You never actually &quot;get out&quot; a <code>UUID</code> from a <code>IO UUID</code>. See this question:  <a href=\"https://stackoverflow.com/questions/11467066/how-to-get-normal-value-from-io-action-in-haskell\">How to get normal value from IO action in Haskell</a>"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574045275, "post_id": 58906666, "comment_id": 104077298, "body": "Do you understand (1) what referential transparency means, (2) that Haskell is a referentially transparent language, and (3) that what you&#39;re asking for would violate referential transparency?"}, {"owner": {"reputation": 387, "user_id": 5377722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MHeNHEtZhiI/AAAAAAAAAAI/AAAAAAAAAFo/racMaZDaQHE/photo.jpg?sz=128", "display_name": "Sergii Sopin", "link": "https://stackoverflow.com/users/5377722/sergii-sopin"}, "edited": false, "score": 0, "creation_date": 1574045778, "post_id": 58906666, "comment_id": 104077374, "body": "Yes, I understand. By the way, I also asked if there are other ways to do what I need to do, which is create a data type that contains a unique identifier and create an instance of Eq for this data type based on this identifier."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1574053058, "post_id": 58906666, "comment_id": 104078830, "body": "By the way, for the <code>instance Eq</code> part, if you define only <code>==</code>, a default definition of <code>&#47;=</code> will be used that matches what you&#39;ve written, so you can leave it out."}, {"owner": {"reputation": 243, "user_id": 13679816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b02acae66c6a347786eb93e8cbead85?s=128&d=identicon&r=PG", "display_name": "atravers", "link": "https://stackoverflow.com/users/13679816/atravers"}, "edited": false, "score": 0, "creation_date": 1600658474, "post_id": 58906666, "comment_id": 113146278, "body": "This may also be of interest: <a href=\"https://stackoverflow.com/questions/6311512/creating-unique-labels-in-haskell/63406066\" title=\"creating unique labels in haskell\">stackoverflow.com/questions/6311512/&hellip;</a> ."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 5, "last_activity_date": 1574082801, "last_edit_date": 1574082801, "creation_date": 1574052664, "answer_id": 58908135, "question_id": 58906666, "link": "https://stackoverflow.com/questions/58906666/haskell-uuid-generation/58908135#58908135", "title": "Haskell UUID generation", "body": "<p>If you're looking at the functions in the <code>uuid</code> package, then <code>UUID</code> has a <code>Random</code> instance.  This means that it's possible to generate a sequence of random UUIDs in pure code using standard functions from <code>System.Random</code> using a seed:</p>\n\n<pre><code>import System.Random\nimport Data.UUID\n\nsomeUUIDs :: [UUID]\nsomeUUIDs =\n  let seed = 123\n      g0 = mkStdGen seed -- RNG from seed\n      (u1, g1) = random g0\n      (u2, g2) = random g1\n      (u3, g3) = random g2\n  in [u1,u2,u3]\n</code></pre>\n\n<p>Note that <code>someUUIDs</code> creates the same three \"unique\" UUIDs every time it's called because the seed is hard-coded.</p>\n\n<p>As with all pure Haskell code, unless you cheat (using unsafe functions), you can't expect to generate a sequence of actually unique UUIDs without explicitly passing some state (in this case, a <code>StdGen</code> RNG) between calls to <code>random</code>.</p>\n\n<p>The usual solution to avoid the ugly boilerplate of passing the generator around is to run at least part of your code within a monad that can maintain the needed state.  Some people like to use the <code>MonadRandom</code> package, though you can also use the regular <code>State</code> monad with a <code>StdGen</code> somewhere in the state.  The main advantages of <code>MonadRandom</code> over <code>State</code> is that you get some dedicated syntax (<code>getRandom</code>) and can create a monad stack that includes both <code>RandomT</code> and <code>StateT</code> so you can separate your RNG state from the rest of your application state.</p>\n\n<p>Using <code>MonadRandom</code>, you might write an application like:</p>\n\n<pre><code>import Control.Monad.Random.Strict\nimport System.Random\nimport Data.UUID\n\n-- monad for the application\ntype M = Rand StdGen\n\n-- get a generator and run the application in \"M\"\nmain :: IO ()\nmain = do\n  g &lt;- getStdGen  -- get a timestamp-seeded generator\n  let log = evalRand app g  -- run the (pure) application in the monad\n  putStr log\n\n-- the \"pure\" application, running in monad \"M\"\napp :: M String\napp = do\n  foo &lt;- myType \"foo\"\n  bar &lt;- myType \"bar\"\n  -- do some processing\n  return $ unlines [\"Results:\", show foo, show bar]\n\ntype AnotherType = String\ndata MyType = MyType {\n   uuid :: UUID,\n   elements :: AnotherType\n} deriving (Show)\n\n-- smart constructor for MyType with unique UUID\nmyType :: AnotherType -&gt; M MyType\nmyType x = MyType &lt;$&gt; getRandom &lt;*&gt; pure x\n</code></pre>\n\n<p>Note that substantial parts of the application will need to be written in monadic syntax and run in the application <code>M</code> monad.  This isn't a big restriction -- most non-trivial applications are going to be written in <em>some</em> monad.</p>\n"}], "owner": {"reputation": 387, "user_id": 5377722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MHeNHEtZhiI/AAAAAAAAAAI/AAAAAAAAAFo/racMaZDaQHE/photo.jpg?sz=128", "display_name": "Sergii Sopin", "link": "https://stackoverflow.com/users/5377722/sergii-sopin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 1, "accepted_answer_id": 58908135, "answer_count": 1, "score": 4, "last_activity_date": 1574283328, "creation_date": 1574037997, "last_edit_date": 1574283328, "question_id": 58906666, "link": "https://stackoverflow.com/questions/58906666/haskell-uuid-generation", "title": "Haskell UUID generation", "body": "<p>I am new to Haskell and need help. I am trying to build a new data type that has to be somehow unique, so I decided to use UUID as a unique identifier:</p>\n\n<pre><code>data MyType = MyType {\n   uuid :: UUID,\n   elements :: AnotherType\n}\n</code></pre>\n\n<p>in this way, I can do following:</p>\n\n<pre><code>instance Eq MyType where\n    x == y = uuid x == uuid y\n    x /= y = not (x == y)\n</code></pre>\n\n<p>The problem is that all known (to me) UUID generators produce IO UUID, but I need to use it in a pure code as mentioned above. Could you please suggest if there is any way to extract UUID out of IO UUID, or maybe be there is a better way to do what I need in Haskell? Thanks.</p>\n\n<hr>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Thanks for all the great suggestions and the code example. From what is posted here I can say you cannot break a <a href=\"https://stackoverflow.com/questions/11467066/how-to-get-normal-value-from-io-action-in-haskell\">referential transparency</a>, but there are smart ways how to solve the problem without breaking it and, probably the most optimal one, is listed in the answer below. </p>\n\n<p>There is also one alternative approach that I was able to explore myself based on provided recommendations with the usage of State Monad:</p>\n\n<pre><code>type M = State StdGen\ntype AnotherType = String\n\ndata MyType = MyType {\n    uuid :: UUID,\n    elements :: AnotherType\n} deriving (Show)\n\nmytype :: AnotherType -&gt; M MyType\nmytype x = do\n    gen &lt;- get\n    let (val, gen') = random gen\n    put gen'\n    return $ MyType val x\n\nmain :: IO ()\nmain = do\n    state &lt;- getStdGen\n    let (result, newState) = runState (mytype \"Foo\") state\n    putStrLn $ show result\n    let (result', newState') = runState (mytype \"Bar\") newState\n    setStdGen newState'\n    putStrLn $ show result'\n</code></pre>\n\n<p>Not sure if it is the most elegant implementation, but it works.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 5, "creation_date": 1574040138, "post_id": 58906601, "comment_id": 104076399, "body": "Incidentally most decks of cards don&#39;t typically have a card ranked One <i>and</i> an Ace."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1574069904, "post_id": 58906601, "comment_id": 104085241, "body": "Basically thiis should be a Kind type like <code>II | III | IV | V | VI | VII | VIII | IX | X | J | Q | K | A</code> and then a Suit type like <code>D | C | S | H</code> so a Card type could be <code>Card Kind Suit</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "is_accepted": false, "score": 9, "last_activity_date": 1574037794, "creation_date": 1574037794, "answer_id": 58906648, "question_id": 58906601, "link": "https://stackoverflow.com/questions/58906601/haskell-exception-prelude-enum-toenum-bad-argument/58906648#58906648", "title": "Haskell Exception: Prelude.Enum.().toEnum: bad argument", "body": "<p>The type of <code>toEnum</code> is</p>\n\n<pre><code>toEnum :: Enum a =&gt; Int -&gt; a\n</code></pre>\n\n<p>There is no context for GHCi to figure out which <code>Enum</code> instance you want in <code>toEnum 3</code>, so <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#type-defaulting-in-ghci\" rel=\"noreferrer\">by default</a> it supplies the type <code>()</code>. That type has only one value, <code>()</code>, so anything but <code>0</code> will be invalid.</p>\n\n<p>Here are some examples of calling <code>toEnum</code> in GHCi:</p>\n\n<pre><code>\u03bb&gt; toEnum 0\n()\n\u03bb&gt; toEnum 1 :: Bool\nTrue\n\u03bb&gt; toEnum 3 :: Card\nFour\n</code></pre>\n\n<p>You can also use <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#extension-TypeApplications\" rel=\"noreferrer\">type applications</a>:</p>\n\n<pre><code>\u03bb&gt; :set -XTypeApplications\n\u03bb&gt; toEnum @Bool 1\nTrue\n\u03bb&gt; toEnum @Card 3\nFour\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 8818088, "user_type": "registered", "profile_image": "https://graph.facebook.com/2105675369709928/picture?type=large", "display_name": "Augusto Peres", "link": "https://stackoverflow.com/users/8818088/augusto-peres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1574039953, "creation_date": 1574037284, "last_edit_date": 1574039953, "question_id": 58906601, "link": "https://stackoverflow.com/questions/58906601/haskell-exception-prelude-enum-toenum-bad-argument", "title": "Haskell Exception: Prelude.Enum.().toEnum: bad argument", "body": "<p>I have the following code</p>\n\n<pre><code>import Data.List\n\ndata Card = One\n          | Two\n          | Three\n          | Four\n          | Five\n          | Six\n          | Seven\n          | Eight\n          | Nine\n          | Ten\n          | J\n          | Q\n          | K\n          | A\n          deriving (Show, Eq, Ord, Enum)\n\ndata Hand = Hand Card Card Card Card Card deriving(Show)\n\nlargestCard :: Hand -&gt; Card\nlargestCard (Hand a b c d e) = One\n</code></pre>\n\n<p>However when I try to use <code>toEnum 3</code> in GHCi I get <code>Exception: Prelude.Enum.().toEnum: bad argument</code>.  How can this be fixed?</p>\n\n<p>The last function is just a dummy function. Right now it does nothing.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 475, "user_id": 3993379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1027ad3128505e2ef6222c4e306e73?s=128&d=identicon&r=PG&f=1", "display_name": "FrownyFrog", "link": "https://stackoverflow.com/users/3993379/frownyfrog"}, "edited": false, "score": 0, "creation_date": 1574031359, "post_id": 58905982, "comment_id": 104074734, "body": "Try with (Just val)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 5, "creation_date": 1574031362, "post_id": 58905982, "comment_id": 104074735, "body": "The body of a let (in do) must be indented father than the variable you are defining.  So indent your cases father than <code>res</code>"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574034524, "post_id": 58906028, "comment_id": 104075315, "body": "(Technically, on the same level it would be a part of <code>let</code>, not of <code>do</code> or <code>case</code>.)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1574083250, "last_edit_date": 1574083250, "creation_date": 1574031646, "answer_id": 58906028, "question_id": 58905982, "link": "https://stackoverflow.com/questions/58905982/having-parse-error-on-input-in-a-case-of/58906028#58906028", "title": "Having &quot;parse error on input \u2018-&gt;\u2019&quot; in a case of", "body": "<p>The indentation level of the cases should be at least one space more than the start of the variable name of the let statement, like:</p>\n\n<pre><code>let res = case b of\n     Just val -&gt; \"There is a value, and it is a value\"\n     Nothing  -&gt; \"There is nothing!\"\n</code></pre>\n\n<p>If you write it on the same level as where <code>res</code> starts, it is parsed as if it is part of the <code>let</code> block, and not of the <code>case</code> in the <code>let</code> block.\nSimilarly, if you write it less indented than <code>res</code>, it is parsed as if it is part of the <code>do</code> block, and not of the <code>case</code>.</p>\n"}], "owner": {"reputation": 1334, "user_id": 1447456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/606d9f69e64fa4eddea4bada8802f7f2?s=128&d=identicon&r=PG", "display_name": "Francisco Albert", "link": "https://stackoverflow.com/users/1447456/francisco-albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 58906028, "answer_count": 1, "score": 4, "last_activity_date": 1574083250, "creation_date": 1574031166, "question_id": 58905982, "link": "https://stackoverflow.com/questions/58905982/having-parse-error-on-input-in-a-case-of", "title": "Having &quot;parse error on input \u2018-&gt;\u2019&quot; in a case of", "body": "<p>I'm having a weird error in this simple haskell code. \nI confirm I'm using spaces everywhere and I don't see any problem with indentation.</p>\n\n<p>Am I missing something to have this syntax error?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>    it \"I can play with Maybe a bit\" $ do\n      let b = Just \"whatever\"\n\n      let res = case b of\n        Just val -&gt; \"There is a value, and it is a value\" --parse error on input \u2018-&gt;\u2019\n        Nothing  -&gt; \"There is nothing!\"\n\n      res `shouldBe` \"There is a value, and it is a value\"\n</code></pre>\n"}, {"tags": ["haskell", "reactive-programming"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1574033225, "post_id": 58905765, "comment_id": 104075062, "body": "If you are asking about the semantic domain in which <code>Behavior a = T -&gt; a</code>, it might be an informative exercise to try to define an isomorphism between <code>Behavior (a,b)</code> and <code>(Behavior a, Behavior b)</code>"}, {"owner": {"reputation": 2047, "user_id": 1942289, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ckjmp.jpg?s=128&g=1", "display_name": "Abhiroop Sarkar", "link": "https://stackoverflow.com/users/1942289/abhiroop-sarkar"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1574036181, "post_id": 58905765, "comment_id": 104075622, "body": "We can have <code>zip :: (Behaviour a, Behaviour b) -&gt; Behaviour (a,b)</code> and <code>unzip :: Behaviour (a, b) -&gt; (Behaviour a, Behaviour b)</code> s.t <code>zip . unzip = id</code>, however while this works for defining the semantics I wonder in practise while working with arrowized FRP how would a user actually talk about <code>(Behaviour a, Behaviour b)</code> as these types are not exposed in the first place."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1574049364, "post_id": 58905765, "comment_id": 104078108, "body": "Right, you don&#39;t -- you talk about <code>SF (a,b) c</code> instead. Because this isomorphism exists, there is not loss of expressivity."}], "owner": {"reputation": 2047, "user_id": 1942289, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ckjmp.jpg?s=128&g=1", "display_name": "Abhiroop Sarkar", "link": "https://stackoverflow.com/users/1942289/abhiroop-sarkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1574068753, "creation_date": 1574029282, "last_edit_date": 1574068753, "question_id": 58905765, "link": "https://stackoverflow.com/questions/58905765/tuple-of-stream-vs-stream-of-tuples-in-arrowized-frp", "title": "Tuple of stream vs stream of tuples in arrowized FRP", "body": "<p>Most reactive programming seem to revolve around the concept of a Behaviour or a signal which is defined as:</p>\n\n<pre><code>Behaviour a = T -&gt; a\n</code></pre>\n\n<p>In arrowized FRP this abstraction is hidden behind a Signal Function of type</p>\n\n<pre><code>SF a b = Behaviour a -&gt; Behaviour b\n</code></pre>\n\n<p>My question is regarding the type <code>SF a b</code>.</p>\n\n<p>Imagine I have a type <code>SF (a,b) c</code> this would represent a signal function which accepts a tuple <code>(a,b)</code> as input and returns the type <code>c</code> as output. Which implies a stream of tuples. But how then do we distinguish this type with tuple of stream? Imagine having something like</p>\n\n<pre><code>(Behaviour a, Behaviour b) -&gt; Behaviour c\n</code></pre>\n\n<p>this is not equivalent to <code>SF (a,b) c</code>, then what combinators do we have in  arrowized FRP to represent tuple of streams and their associated operations?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1574021029, "post_id": 58904639, "comment_id": 104072020, "body": "We need more.  How are you defining and loading this function? How are you calling this function?  When I save it as a file, load it with GHCi 8.6.4, and call it as <code>nest (+1) 3 2</code> it terminates with <code>5</code>."}, {"owner": {"reputation": 2577, "user_id": 6263317, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Imx4J.jpg?s=128&g=1", "display_name": "Jon Deaton", "link": "https://stackoverflow.com/users/6263317/jon-deaton"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1574021079, "post_id": 58904639, "comment_id": 104072033, "body": "Oh interesting. I was pasting into GHCI and calling it just like you with <code>nest (+1) 3 2</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1201, "user_id": 7506861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa43944dd74a96c82dfd990626da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7506861/emily"}, "is_accepted": true, "score": 12, "last_activity_date": 1574021352, "creation_date": 1574021352, "answer_id": 58904722, "question_id": 58904639, "link": "https://stackoverflow.com/questions/58904639/why-doesnt-this-function-terminate-in-haskell/58904722#58904722", "title": "Why doesn&#39;t this function terminate in Haskell?", "body": "<p>By typing the function on two separate REPL lines, you are essentially redefining it the second time around, omitting the base case.</p>\n\n<p>The correct way to enter this function into the REPL is:</p>\n\n<pre><code>nest f 0 = id; nest f n = f . nest f (n - 1)\n</code></pre>\n\n<p>Alternatively, you can enter multiline mode with the <code>:{</code> command, and leave it using <code>:}</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 6, "last_activity_date": 1574021373, "creation_date": 1574021373, "answer_id": 58904728, "question_id": 58904639, "link": "https://stackoverflow.com/questions/58904639/why-doesnt-this-function-terminate-in-haskell/58904728#58904728", "title": "Why doesn&#39;t this function terminate in Haskell?", "body": "<p>When you pasted it into GHCi what you did was define one function of <code>nest f 0 = id</code>.  Then you said \"ignore that function, I'm replacing it with a new function of the same name where the whole definition is <code>nest f n = f . nest f (n - 1)</code>.</p>\n"}], "owner": {"reputation": 2577, "user_id": 6263317, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Imx4J.jpg?s=128&g=1", "display_name": "Jon Deaton", "link": "https://stackoverflow.com/users/6263317/jon-deaton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 58904722, "answer_count": 2, "score": 8, "last_activity_date": 1574021373, "creation_date": 1574020856, "last_edit_date": 1574021134, "question_id": 58904639, "link": "https://stackoverflow.com/questions/58904639/why-doesnt-this-function-terminate-in-haskell", "title": "Why doesn&#39;t this function terminate in Haskell?", "body": "<p>I am confused why my function <code>nest</code> which composes <code>f</code> with itself <code>n</code> times</p>\n\n<pre><code>nest f 0 = id\nnest f n = f . nest f (n - 1)\n</code></pre>\n\n<p>never terminates. I would have thought that it would \"pattern match\" on the case when <code>n</code> becomes zero. I am defining it by typing these two lines into GHCI and calling with <code>nest (+ 1) 2 3</code> for instance.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1574018321, "post_id": 58904167, "comment_id": 104071266, "body": "What do you think the function does if the first input is a non-empty list and the second is empty?"}, {"owner": {"reputation": 21, "user_id": 12387909, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDOshrd3_HuvHAOpniQk7YN28AzWo-VK6hiMcIrfg=k-s128", "display_name": "Jakub Kop\u010dansk&#253;", "link": "https://stackoverflow.com/users/12387909/jakub-kop%c4%8dansk%c3%bd"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1574018584, "post_id": 58904167, "comment_id": 104071347, "body": "@RobinZigmond How could I not see it... Thanks mate"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574020422, "post_id": 58904167, "comment_id": 104071877, "body": "Keep warnings enabled: GHC can report the cases which are not handled. It&#39;s very convenient to have the compiler warn us with something like <code>missing pattern (_:_) []</code>."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12387909, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDOshrd3_HuvHAOpniQk7YN28AzWo-VK6hiMcIrfg=k-s128", "display_name": "Jakub Kop\u010dansk&#253;", "link": "https://stackoverflow.com/users/12387909/jakub-kop%c4%8dansk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1574091094, "post_id": 58908357, "comment_id": 104097324, "body": "Thanks for your answer. That <code>-Wall</code> thing really helped me :)"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1574120377, "last_edit_date": 1574120377, "creation_date": 1574054301, "answer_id": 58908357, "question_id": 58904167, "link": "https://stackoverflow.com/questions/58904167/non-exhaustive-patterns-in-function-ships/58908357#58908357", "title": "Non-exhaustive patterns in function ships", "body": "<p>As @chi has mentioned, turning on the <code>-Wall</code> option when compiling can be very useful for catching these problems at compile time instead of run time.  You can either include <code>-Wall</code> in the GHC command line, or you can add the pragma:</p>\n\n<pre><code>{-# OPTIONS_GHC -Wall #-}\n</code></pre>\n\n<p>at the top of your source code to turn it on.</p>\n\n<p>And, as @RobinZigmond has pointed out, your <code>ships</code> function handles the case where both functions are empty lists <em>and</em> the case where the second function is non-empty list, but unless you're positive that <code>ships</code> can never be called as <code>ships nonEmptyList []</code>, you've missed a case!</p>\n\n<pre><code>ships :: Result -&gt; [(Int, Int)] -&gt; Result\nships [] [] = []\nships _  [] = ?????  -- what happens here?\nships arena ((x,y):xs) = ships (findStr arena x y) xs\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12387909, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDOshrd3_HuvHAOpniQk7YN28AzWo-VK6hiMcIrfg=k-s128", "display_name": "Jakub Kop\u010dansk&#253;", "link": "https://stackoverflow.com/users/12387909/jakub-kop%c4%8dansk%c3%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 58908357, "answer_count": 1, "score": 0, "last_activity_date": 1574120377, "creation_date": 1574017822, "last_edit_date": 1574065612, "question_id": 58904167, "link": "https://stackoverflow.com/questions/58904167/non-exhaustive-patterns-in-function-ships", "title": "Non-exhaustive patterns in function ships", "body": "<p>I got this exception, anyone know how to get rid of it?\n`</p>\n\n<blockquote>\n  <p>*** Exception: hw.hs:(33,1)-(35,53): Non-exhaustive patterns in function ships`</p>\n</blockquote>\n\n<p>All functions are working fine except for function <code>ships</code>.\nIts probably something with the list of Tuples, but I can't figure it out. Here is the code:</p>\n\n<pre><code>replace :: Char -&gt; Char\nreplace c   | c == ' ' = '.'\n            | c == '.' = '.'\n            | otherwise = 'x';\n\nfindChar :: String -&gt; Int -&gt; String\nfindChar [] y = []\nfindChar (s:ss) y | y==0 = replace s : findChar ss (y-1)\n                | otherwise = ' ' : findChar ss (y-1)\n\nfindStr :: Result -&gt; Int -&gt; Int -&gt; Result\nfindStr [] x y = []\nfindStr (a:as) x y | x == 0 =  findChar a y : findStr as (x-1) y\n                    | otherwise = findChar a (-1) : findStr as (x-1) y\n\nships :: Result -&gt; [(Int, Int)] -&gt; Result\nships [] [] = []\nships arena ((x,y):xs) = ships (findStr arena x y) xs\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 5, "last_activity_date": 1574016545, "creation_date": 1574016545, "answer_id": 58903984, "question_id": 58903929, "link": "https://stackoverflow.com/questions/58903929/how-to-use-map-for-multiple-conditions/58903984#58903984", "title": "How to use map for multiple conditions", "body": "<p><code>map</code> itself can only apply the same function to each element of the list, but the <em>function</em> can decide how to operate on each element.</p>\n\n<p>For example, if we write a function to double all odd numbers and add 100 to all even numbers:</p>\n\n<pre><code>myFunc x | odd x     = 2 * x\n         | otherwise = 100 + x\n</code></pre>\n\n<p>we can apply that function using <code>map</code>:</p>\n\n<pre><code>&gt; map myFunc [1..4]\n[2,102,6,104]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "is_accepted": false, "score": 2, "last_activity_date": 1574034980, "last_edit_date": 1574034980, "creation_date": 1574018382, "answer_id": 58904280, "question_id": 58903929, "link": "https://stackoverflow.com/questions/58903929/how-to-use-map-for-multiple-conditions/58904280#58904280", "title": "How to use map for multiple conditions", "body": "<p>The following is a bit ugly, but works:</p>\n\n<pre><code>map (\\x -&gt; if x &lt; 0 then x+1 else x*2) [1,-2,3,-4,0]\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12360866, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDqwbnjf_9Y68tKBYzLEzJo55lLcCZi5l7FawWE=k-s128", "display_name": "MarkoL", "link": "https://stackoverflow.com/users/12360866/markol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 58903984, "answer_count": 2, "score": 3, "last_activity_date": 1575051314, "creation_date": 1574016255, "last_edit_date": 1575051314, "question_id": 58903929, "link": "https://stackoverflow.com/questions/58903929/how-to-use-map-for-multiple-conditions", "title": "How to use map for multiple conditions", "body": "<p>is it possible to use <code>map</code> with multiply condition. For example a <code>list [1,-2,3,-4]</code>\nit should <code>+1</code> for all <code>&lt;0</code> and <code>*2</code> for <code>&gt;0</code>? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1574011384, "post_id": 58903018, "comment_id": 104069168, "body": "What is your question?"}], "answers": [{"comments": [{"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1574041063, "post_id": 58903731, "comment_id": 104076563, "body": "<a href=\"https://codereview.stackexchange.com/questions/58954/getting-the-index-x-y-of-a-char-in-a-2d-list-in-haskell\" title=\"getting the index x y of a char in a 2d list in haskell\">codereview.stackexchange.com/questions/58954/&hellip;</a>"}], "tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": false, "score": 2, "last_activity_date": 1574015025, "creation_date": 1574015025, "answer_id": 58903731, "question_id": 58903018, "link": "https://stackoverflow.com/questions/58903018/battleships-game-haskell/58903731#58903731", "title": "battleships game - Haskell", "body": "<p>You need to transform the input grid into the output grid by mapping a function over each cell of the grid.  The mapping function is going to need the coordinates of the cell and the content of the cell.  The coordinates are needed to see if the other player fired at that location, and the contents are needed in order to know whether anything was hit.</p>\n\n<p>Mapping can be done with <code>map</code>.  Since the grid is 2d, you will need to map over the rows, and for each row, map over the columns of that row.</p>\n\n<p>The coordinates of the row or column can be attached prior to mapping by <code>zip</code>ping with an infinite <code>..</code> range so that you get a pair of a coordinate in that dimension and a value in that dimension.</p>\n\n<p>I.e.</p>\n\n<pre><code>zip [0..] xs\n</code></pre>\n\n<p>Labels each element of <code>xs</code> with a zero-based index.</p>\n\n<p>You can test if a coordinate is a member of the shot list with <code>elem</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 12387524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90289387c74ae8a8a53df52256e71f3?s=128&d=identicon&r=PG&f=1", "display_name": "olko91", "link": "https://stackoverflow.com/users/12387524/olko91"}, "delete_vote_count": 2, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 1, "closed_date": 1574027267, "answer_count": 1, "score": -9, "last_activity_date": 1574015025, "creation_date": 1574010735, "last_edit_date": 1574014450, "question_id": 58903018, "link": "https://stackoverflow.com/questions/58903018/battleships-game-haskell", "closed_reason": "Needs more focus", "title": "battleships game - Haskell", "body": "<p>I am a Haskell beginner, and I have problem with my homework.\nAssignment of this homework is down below. I really need help.</p>\n\n<p>I must implement the function ships which has 2 arguments. First argument is a list of strings representing play field of one player row by row from top to bottom ('o' - square containing a ship, ' ' - empty square). Second list contains coordinates of squares attacked by second player. Print actual state of a play in the way where every row and column will be labelled by its number or letter, 'o' will be square with ship not attacked yet, 'x' square with ship already attacked, '.' already attacked empty square, ' ' empty square not attacked yet. You can consider that the size of play-field is 10x10. </p>\n\n<pre><code>type Result = [String]\nships :: Result -&gt; [(Char, Int)] -&gt; Result\nsampleInput = [\"  o    o  \",\n           \"      ooo \",\n           \"   oo     \",\n           \"          \",\n           \"     o    \",\n           \"     o    \",\n           \"     o    \",\n           \"          \",\n           \"          \",\n           \"  oooo    \"]\n</code></pre>\n\n<p>and this should be an input and output</p>\n\n<pre><code>Prelude&gt;pp(ships sampleInput [('a',1),('d',1),('d',2),('c',1),('b',1),('e',1),('f',1),('g',1),('c',7),('c',10)])\n             10  x    o\n             9      ooo\n             8   oo\n             7  .\n             6     o\n             5     o\n             4     o\n             3\n             2   .\n             1..xxxx.\n              abcdefghij\n</code></pre>\n\n<p>can someone help me, how the code should look like?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 1, "creation_date": 1574013530, "post_id": 58902867, "comment_id": 104069783, "body": "It&#39;s generally considered bad form to abuse <code>Show</code> instances like this because <code>Show</code> is supposed to produce a string representation of a data structure that&#39;s as close as possible to the way you&#39;d write the data structure manually in Haskell source code.  Or was this a homework problem where you <i>had</i> to use a <code>Show</code> instance?"}, {"owner": {"reputation": 57, "user_id": 12387341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70aedd9870121ce97e4c01971ec649b0?s=128&d=identicon&r=PG&f=1", "display_name": "maf", "link": "https://stackoverflow.com/users/12387341/maf"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1574014293, "post_id": 58902867, "comment_id": 104070001, "body": "@K.A.Buhr it&#39;s a homework problem where i have to use that!"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 12387341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70aedd9870121ce97e4c01971ec649b0?s=128&d=identicon&r=PG&f=1", "display_name": "maf", "link": "https://stackoverflow.com/users/12387341/maf"}, "edited": false, "score": 0, "creation_date": 1574017559, "post_id": 58903946, "comment_id": 104071026, "body": "Thank you so much, you unblocked me from moving forward in this work! I can&#39;t thank enough! And you are right about the name being better as a <code>String</code> than as a <code>Float</code>, but this was just an example i came up with since what i <i>needed</i> to know was how to present the list like that. Thank you!"}, {"owner": {"reputation": 716, "user_id": 4803382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1xwqI.jpg?s=128&g=1", "display_name": "dccsillag", "link": "https://stackoverflow.com/users/4803382/dccsillag"}, "reply_to_user": {"reputation": 57, "user_id": 12387341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70aedd9870121ce97e4c01971ec649b0?s=128&d=identicon&r=PG&f=1", "display_name": "maf", "link": "https://stackoverflow.com/users/12387341/maf"}, "edited": false, "score": 0, "creation_date": 1574017959, "post_id": 58903946, "comment_id": 104071157, "body": "@stanloona Glad to have been of help."}], "tags": [], "owner": {"reputation": 716, "user_id": 4803382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1xwqI.jpg?s=128&g=1", "display_name": "dccsillag", "link": "https://stackoverflow.com/users/4803382/dccsillag"}, "is_accepted": true, "score": 0, "last_activity_date": 1574016358, "creation_date": 1574016358, "answer_id": 58903946, "question_id": 58902867, "link": "https://stackoverflow.com/questions/58902867/new-instance-declaration-for-show-with-a-list/58903946#58903946", "title": "New instance declaration for Show with a list", "body": "<p>From what I understand, you've already got the part to the left of the colon; all you need is the part to the right.</p>\n\n<p>As you've noted, <code>show</code> doesn't do what you want \u2014 that means you've got to do this string manipulation bit yourself.</p>\n\n<p>This particular task (intercalating strings in a list with something) can easily be one using <code>intercalate</code> from <code>Data.List</code> (documented <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:intercalate\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<pre><code>import Data.List (intercalate)\n</code></pre>\n\n<p>Then, your instance declaration for <code>ShoppingList</code> (note the capital S) would be as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Show ShoppingList where\n    show (ShoppingList n l) = show n ++ \": \" ++ intercalate \" -&gt; \" (map show l)\n</code></pre>\n\n<p>As a side note, it's counter-intuitive (at least for me) that <code>name</code> would be a <code>Float</code> and not a <code>String</code> (or similar). You should probably consider changing that.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 12085352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc1087bfeb0328ee1b214d733274165?s=128&d=identicon&r=PG&f=1", "display_name": "marowl", "link": "https://stackoverflow.com/users/12085352/marowl"}, "is_accepted": false, "score": 0, "last_activity_date": 1574078290, "last_edit_date": 1574078290, "creation_date": 1574034306, "answer_id": 58906317, "question_id": 58902867, "link": "https://stackoverflow.com/questions/58902867/new-instance-declaration-for-show-with-a-list/58906317#58906317", "title": "New instance declaration for Show with a list", "body": "<p>Don't forget to capitalize the initial letters of the type and value constructors ;)</p>\n\n<pre><code>import Data.List\n\ndata ShoppingList = ShoppingList { name :: String\n                                 , items :: [Item]}\n\ndata Item = Food String Float | Clothes String\n\ninstance Show Item where\n  show (Food a _) = a\n  show (Clothes _) = \"CLOTHES\"\n\ninstance Show ShoppingList where\n  show a = let listName = name a\n               listItems = intercalate \" -&gt; \" (map show $ items a)\n               in listName ++ \": \" ++ listItems\n\n-- use \"show yourShoppingListName\" to let the magic happen^^\"\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 12387341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70aedd9870121ce97e4c01971ec649b0?s=128&d=identicon&r=PG&f=1", "display_name": "maf", "link": "https://stackoverflow.com/users/12387341/maf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 58903946, "answer_count": 2, "score": 2, "last_activity_date": 1574078290, "creation_date": 1574009680, "last_edit_date": 1574017788, "question_id": 58902867, "link": "https://stackoverflow.com/questions/58902867/new-instance-declaration-for-show-with-a-list", "title": "New instance declaration for Show with a list", "body": "<p>I'm fairly new to haskell and i have the task of defining a new instance declaration for Show for the data types i defined but i'm struggling. I've been searching through the already answered questions in here but i'm not getting anywhere and it's been so frustrating that i created an account just to get this over with.</p>\n\n<p>Imagine i have declared two new data types like this,</p>\n\n<pre><code>data shoppingList = shoppingList { name :: String\n                                 , items :: [Item]}\ndata Item = Food String Float | Clothes String\n</code></pre>\n\n<p>I need to make an instance declaration of Show so that any shoppingList will look something like <code>name: dog_food -&gt; CLOTHES -&gt; many_apples -&gt; CLOTHES</code>, depending on wether it's Food or Clothes. This means, if it's Food, it prints the name that was given to the food, if it's Clothes, it just prints \"CLOTHES\" every time.</p>\n\n<p>The best i managed to do is,</p>\n\n<pre><code>instance Show shoppingList where\n  show (shoppingList n l) = show n ++ \": \" ++ show l\n\ninstance Show Item where\n  show (Food n _) = show n\n  show (Clothes_) = \"CLOTHES\"\n</code></pre>\n\n<p>However, this isn't the final result i'm looking for since it's printing something like <code>\"list1\": [\"dog_food\",CLOTHES,\"many_apples\",CLOTHES]</code> and this is not what i need.</p>\n\n<p>The example might look a bit stupid but it shows my big question. Can somebody help me with this?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1574013221, "post_id": 58902839, "comment_id": 104069689, "body": "Also, note that for the version using the shorthand <code>intFrom</code>, for obscure reasons you&#39;ll need to either turn on the <code>{-# LANGUAGE NoMonomorphismRestriction #-}</code> pragma or give <code>intFrom</code> an explicit type signature (e.g., <code>intFrom :: (Functor f, Integral a) =&gt; f a -&gt; f Integer</code>)."}, {"owner": {"reputation": 143, "user_id": 3150185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/961dcbc8977f01e5490173f4f4a27d05?s=128&d=identicon&r=PG&f=1", "display_name": "CodeWash", "link": "https://stackoverflow.com/users/3150185/codewash"}, "edited": false, "score": 0, "creation_date": 1574014169, "post_id": 58902839, "comment_id": 104069964, "body": "Thanks! I went with your first suggestion. It&#39;s much easier to read than what I had when laid out over multiple lines with comments on each line."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1574014346, "post_id": 58902839, "comment_id": 104070017, "body": "@K.A.Buhr Thanks, I completely forgot about that. Not putting <code>intFrom</code> in a top-level declaration should work as well, right?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1574016854, "post_id": 58902839, "comment_id": 104070802, "body": "@Bergi, that would have the same problem, as I think you discovered.  But an even nicer solution is probably to write <code>where intFrom x = toInteger &lt;$&gt; x</code>.  Giving <code>intFrom</code> an explicit argument changes the typing rules slightly, so the monomorphism restriction no longer applies."}], "tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": true, "score": 4, "last_activity_date": 1574017054, "last_edit_date": 1574017054, "creation_date": 1574009550, "answer_id": 58902839, "question_id": 58902786, "link": "https://stackoverflow.com/questions/58902786/neater-binary-file-processing-in-haskell/58902839#58902839", "title": "Neater binary file processing in Haskell", "body": "<p>I would write</p>\n\n<pre><code>getThing :: Get Thing\ngetThing = Thing &lt;$&gt; intFrom getWord8 &lt;*&gt; intFrom getWord16 &lt;*&gt; intFrom getWord32\n  where\n    where intFrom x = toInteger &lt;$&gt; x\n</code></pre>\n\n<p>The magic you are looking for is known as <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#v:sequence\" rel=\"nofollow noreferrer\"><code>sequence</code></a>, but you can't put <code>IO Word8</code>, <code>IO Word16</code> and <code>IO Word32</code> in the same list:</p>\n\n<pre><code>getThing :: Get Thing\ngetThing = do\n  [laaa, lbbb, lccc] &lt;- sequence [toInteger &lt;$&gt; getword8, toInteger &lt;$&gt; getword16, toInteger &lt;$&gt; getWord32]\n  return $ Thing laaa lbbb lccc\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 3150185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/961dcbc8977f01e5490173f4f4a27d05?s=128&d=identicon&r=PG&f=1", "display_name": "CodeWash", "link": "https://stackoverflow.com/users/3150185/codewash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 58902839, "answer_count": 1, "score": 2, "last_activity_date": 1574017054, "creation_date": 1574009220, "last_edit_date": 1574012651, "question_id": 58902786, "link": "https://stackoverflow.com/questions/58902786/neater-binary-file-processing-in-haskell", "title": "Neater binary file processing in Haskell", "body": "<p>This is a general question inspired by a particular piece of code I wrote that I'm not happy with. I'm using Data.Binary.Get to grab some data from a binary file. Some of the code looks a bit like this</p>\n\n<pre><code>import Data.Binary.Get\n\ndata Thing = Thing\n  {\n    aaa :: Integer,\n    bbb :: Integer,\n    ccc :: Integer\n  } deriving (Show)\n\ngetThing :: Get Thing\ngetThing = do\n  laaa &lt;- getWord8 &gt;&gt;= \\x -&gt; return (toInteger x)\n  lbbb &lt;- getWord16host &gt;&gt;= \\x -&gt; return (toInteger x)\n  lccc &lt;- getWord32host &gt;&gt;= \\x -&gt; return (toInteger x)\n  return $ Thing laaa lbbb lccc\n\n</code></pre>\n\n<p>The \"getThing\" function is really long. I am hoping there is a nice way to do something like the following pseudocode or maybe something even more concise.</p>\n\n<pre><code>[laaa, lbbb, lccc] &lt;- MAGIC [getword8, getword16, getWord32] &gt;&gt;= \\x -&gt; return (toInteger x)\n</code></pre>\n\n<p>What have you got?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1574007651, "creation_date": 1574007651, "answer_id": 58902553, "question_id": 58902510, "link": "https://stackoverflow.com/questions/58902510/how-to-use-map-with-more-than-one-operator/58902553#58902553", "title": "How to use Map with more than one operator", "body": "<p>I think it is easy to first introduce a lambda expression here:</p>\n\n<pre><code>map (<b>\\x -&gt; (x*2)+3</b>) [1,2,3,4]</code></pre>\n\n<p>This will do exactly what you want. You can perform \"<em>function composition</em>\" with the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:.\" rel=\"nofollow noreferrer\"><strong><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code></strong> function</a>, and thus write this as:</p>\n\n<pre><code>map (<b>(+3) . (*2)</b>) [1,2,3,4]</code></pre>\n\n<p>Here you thus can see it as a \"chain\" of functions, where we pass the input to the rightmost function (here <code>(*2)</code>), and then the result is passed to the leftmost function (here <code>(+3)</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 12364427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0bd3b5f8129f4d2c127ada661b50fd?s=128&d=identicon&r=PG&f=1", "display_name": "Kenneth", "link": "https://stackoverflow.com/users/12364427/kenneth"}, "edited": false, "score": 0, "creation_date": 1574014728, "post_id": 58902563, "comment_id": 104070163, "body": "Thanks that helped me much, know im trying to apply map ((+3) . (*2)) for all odd numbers and map ((+3) to all even.  I tried it with cases but it does only check if the first number is odd or even. Here my Code <code>oddandeven :: Int -&gt; [Int] oddandeven =  \\t -&gt; case t of     x       | odd x -&gt; x:map ((+1).(*3)) (oddandeven x)       | otherwise -&gt; x:map(</code>div` 2) (oddandeven x)`"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 23, "user_id": 12364427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0bd3b5f8129f4d2c127ada661b50fd?s=128&d=identicon&r=PG&f=1", "display_name": "Kenneth", "link": "https://stackoverflow.com/users/12364427/kenneth"}, "edited": false, "score": 0, "creation_date": 1574017762, "post_id": 58902563, "comment_id": 104071106, "body": "Then you&#39;ll have to define a function of type <code>Int -&gt; Int</code> that does the check on odd or even and does the appropriate thing - then <code>map</code> it over the list."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 5, "last_activity_date": 1574007711, "creation_date": 1574007711, "answer_id": 58902563, "question_id": 58902510, "link": "https://stackoverflow.com/questions/58902510/how-to-use-map-with-more-than-one-operator/58902563#58902563", "title": "How to use Map with more than one operator", "body": "<p>You <code>map</code> a single function. But that function can do whatever you want. Your example can be given as an anonymous function for example:</p>\n\n<pre><code>map (\\n -&gt; n * 2 + 3) [1,2,3,4]\n</code></pre>\n\n<p>But you can also use function composition, which is likely more readable for a case like this where your function is a case of \"do one thing, then the other\":</p>\n\n<pre><code>map ((+3) . (*2)) [1,2,3,4]\n</code></pre>\n\n<p>This in turn is equal (by the so-called \"functor laws\") to</p>\n\n<pre><code>map (+3) . map (*2) $ [1,2,3,4]\n</code></pre>\n\n<p>Which I personally find a little more readable.</p>\n"}], "owner": {"reputation": 23, "user_id": 12364427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0bd3b5f8129f4d2c127ada661b50fd?s=128&d=identicon&r=PG&f=1", "display_name": "Kenneth", "link": "https://stackoverflow.com/users/12364427/kenneth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 58902563, "answer_count": 2, "score": 0, "last_activity_date": 1574011578, "creation_date": 1574007423, "last_edit_date": 1574007710, "question_id": 58902510, "link": "https://stackoverflow.com/questions/58902510/how-to-use-map-with-more-than-one-operator", "title": "How to use Map with more than one operator", "body": "<p>is it possible to use <code>map</code> with 2 operators in it like <code>map ((*2)+3) [1,2,3,4]</code>? If is yes how? i want to make a function that <code>apply (x*2)+3</code> on a list.</p>\n"}, {"tags": ["list", "haskell", "element"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1574004934, "post_id": 58901624, "comment_id": 104067314, "body": "What do you want <code>elemIndex &#39;x&#39; &quot;&quot;</code> to return?"}], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 33, "user_id": 12367462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9vojK.jpg?s=128&g=1", "display_name": "Jevs", "link": "https://stackoverflow.com/users/12367462/jevs"}, "edited": false, "score": 1, "creation_date": 1574002265, "post_id": 58901653, "comment_id": 104066639, "body": "@Jevs: By using <code>head</code>, it will return an error in case there is no match found."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1574002025, "creation_date": 1574002025, "answer_id": 58901653, "question_id": 58901624, "link": "https://stackoverflow.com/questions/58901624/haskell-how-to-get-index-of-elem-in-list/58901653#58901653", "title": "Haskell - How to get index of elem in list?", "body": "<p>You can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Maybe.html#v:fromMaybe\" rel=\"nofollow noreferrer\"><strong><code>fromMaybe :: a -&gt; Maybe a -&gt; a</code></strong></a> to unwrap the value from a <code>Just</code>, and furtermore add a default value in case it is a <code>Nothing</code>.</p>\n\n<p>So you can implement a function:</p>\n\n<pre><code>import Data.Maybe(<b>fromMaybe</b>)\n\nelemIndex' :: Eq a =&gt; a -&gt; [a] -&gt; Int\nelemIndex' x = <b>fromMaybe (-1)</b> . elemIndex x</code></pre>\n\n<p>Here it will thus return <code>-1</code> in case the element can not be found. For example:</p>\n\n<pre><code>Prelude Data.Maybe Data.List&gt; elemIndex' 'f' \"BarFoof\"\n6\nPrelude Data.Maybe Data.List&gt; elemIndex' 'q' \"BarFoof\"\n-1\n</code></pre>\n\n<p>That being said, in Haskell a <code>Maybe</code> is often used to denote a computation that might \"fail\", such that if you post-process the result, you will take the <code>Nothing</code> (element not found in the list) into account as well.</p>\n"}, {"tags": [], "owner": {"reputation": 1780, "user_id": 5886238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6-9qKyv9RFM/AAAAAAAAAAI/AAAAAAAAAeY/hvJfgvauxDk/photo.jpg?sz=128", "display_name": "Andrew Ray", "link": "https://stackoverflow.com/users/5886238/andrew-ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1574087076, "creation_date": 1574087076, "answer_id": 58916719, "question_id": 58901624, "link": "https://stackoverflow.com/questions/58901624/haskell-how-to-get-index-of-elem-in-list/58916719#58916719", "title": "Haskell - How to get index of elem in list?", "body": "<p>As Willem Van Onsem says, you can use <code>fromMaybe</code>. However, there are other options which may be better suited to your particular use case. (It's not clear from your code what your use case is, though, so I'm just going to list some options.)</p>\n\n<p>If you <strong>know for certain</strong> that the value you're looking for is going to be somewhere in the list, usually because you've just pulled it out of the same list using some sort of fold, you can use <code>fromJust</code>. <code>fromJust</code> is similar to <code>fromMaybe</code>, except it doesn't take the additional first argument as a fallback value and instead will throw an error if the value isn't in the list. People will argue about whether or not you should use functions that can throw an error (these functions are called \"partial,\" because they only handle part of their input domain) because they can really cause headaches down the line when assumptions turn out to be wrong, but <strong>in carefully controlled circumstances</strong> they can be useful.</p>\n\n<pre><code>fromJust (Just 10)\n&gt; 10\n\nfromJust Nothing\n&gt; *** Exception: Maybe.fromJust: Nothing\n</code></pre>\n\n<p>Depending on the semantics of your program, it may also be more idiomatic to change your function signature to return a <code>Maybe whatever</code> instead of a <code>whatever</code>. In this case, you should look into using things like <code>fmap</code>, <code>&gt;&gt;=</code>, and <code>&lt;$&gt;</code> to pass your value around without ever needing to unwrap it. I can't tell you if this is the right approach for your program in particular without seeing more of your code, but for most use cases, <code>fromMaybe</code> is not the right approach.</p>\n\n<pre><code>fmap (+ 5) (Just 10)\n&gt; Just 15\n\nfmap (+ 5) Nothing\n&gt; Nothing\n\nJust 10 &lt;$&gt; (+ 5)\n&gt; Just 15\n\nNothing &lt;$&gt; (+ 5)\n&gt; Nothing\n\nJust 10 &gt;&gt;= (\\x -&gt; if even x then Just $ x `div` 2 else Nothing)\n&gt; Just 5\n\nJust 5  &gt;&gt;= (\\x -&gt; if even x then Just $ x `div` 2 else Nothing)\n&gt; Nothing\n\nNothing &gt;&gt;= (\\x -&gt; if even x then Just $ x `div` 2 else Nothing)\n&gt; Nothing\n</code></pre>\n\n<p>Using a value like <code>-1</code> to indicate failure means that the rest of your program needs to know that <code>-1</code> indicates a failure state. These sorts of failure values usually need to be handled separately from normal return values, which is exactly the use case that the <code>Maybe</code> type is designed to make more elegant. The quick test for whether you should be unwrapping a <code>Maybe</code> is to look and see if there is anywhere in your program where you are pattern matching (or using guards or <code>if</code> or <code>case</code>, etc.) to try to catch this <code>-1</code> somewhere else to trigger specialized behavior. If you are, then you shouldn't be unwrapping <code>Maybe</code> (here).</p>\n"}], "owner": {"reputation": 33, "user_id": 12367462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9vojK.jpg?s=128&g=1", "display_name": "Jevs", "link": "https://stackoverflow.com/users/12367462/jevs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 58901653, "answer_count": 2, "score": 2, "last_activity_date": 1574087076, "creation_date": 1574001841, "question_id": 58901624, "link": "https://stackoverflow.com/questions/58901624/haskell-how-to-get-index-of-elem-in-list", "title": "Haskell - How to get index of elem in list?", "body": "<p>I want to get an index of elem in list? Not Maybe Int, only int.</p>\n\n<pre><code>&gt;elemIndex 'f' \"BarFoof\"\n&gt;Just 6\n</code></pre>\n\n<p>But need 6</p>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1573997482, "post_id": 58899689, "comment_id": 104065404, "body": "As you iterate through the list of prices, also store the additional money needed to buy one more of that tier than can be afforded. Take the min of that list and add it to the original budget."}], "answers": [{"tags": [], "owner": {"reputation": 362, "user_id": 4762234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880403468672301/picture?type=large", "display_name": "Yogendra", "link": "https://stackoverflow.com/users/4762234/yogendra"}, "is_accepted": false, "score": 0, "last_activity_date": 1574067888, "creation_date": 1574067888, "answer_id": 58911046, "question_id": 58899689, "link": "https://stackoverflow.com/questions/58899689/algorithm-to-find-the-next-value-that-results-in-a-different-decomposition-as/58911046#58911046", "title": "Algorithm to find the next value that results in a different &quot;decomposition&quot; (as per another function)", "body": "<p>If your function is monotonic, you can use <a href=\"https://www.topcoder.com/community/competitive-programming/tutorials/binary-search\" rel=\"nofollow noreferrer\">binary search</a> to improve the efficiency. Take an interval <code>[l,r]</code> where <code>l</code> is the input and <code>r</code> is a big enough number which you know would have different output than <code>l</code> with given function. Keep shrinking the range until it's length is greater than 2 while maintaining invariant such that <code>l</code> always gives same output as input and <code>r</code> gives different output than <code>l</code>. </p>\n\n<p>Here's pseudocode : </p>\n\n<pre><code>search f l r\n    | r - l == 1 = r\n    | f l == f mid = search f mid r\n    | otherwise = search f l mid\n        where mid = (l+r)/2\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12386145, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LQbVn.png?s=128&g=1", "display_name": "LittleLily", "link": "https://stackoverflow.com/users/12386145/littlelily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574067888, "creation_date": 1573987519, "last_edit_date": 1573989068, "question_id": 58899689, "link": "https://stackoverflow.com/questions/58899689/algorithm-to-find-the-next-value-that-results-in-a-different-decomposition-as", "title": "Algorithm to find the next value that results in a different &quot;decomposition&quot; (as per another function)", "body": "<p>I am trying to code an algorithm that will take an input value (an integer), and give me the next value that would result in a different decomposition/output from a different function. My current solution just uses that other function and checks each successive integer against it until the output changes, which I am trying to avoid as it is quite slow, and I am sure there is an efficient solution that incorporates some knowledge about the function to avoid having to try a bunch of inputs.</p>\n\n<p>The function I have compares the input integer against a constant list/array of integers. These values in the list represent the cost of different \"tiers\" of an item and are arranged in ascending order. For the purpose of the solution it should be assumed that there is no relation between these values other than that they are strictly ascending, e.g. <code>[23, 105, 1042, 30054, ...]</code>. The input integer is treated as a currency and is decomposed into a list of item tiers that can be bought using that amount of the currency, starting with the highest tiers that can be afforded first. As an example, given the list of tier costs <code>[5, 20, 100, 500, 2000]</code> and the input value 5316, the output would be the list <code>[5, 5, 4, 4, 3, 3, 3, 1, 1, 1]</code> (this output is in the form of the \"tier number\" (basically the position of the element in the tier cost list), but the form it ends up in isn't really important for the purpose of the algorithm I'm trying to develop anyway (it could output <code>[2000, 2000, 500, 500, 100, 100, 100, 5, 5, 5]</code> or have the list in a different order and that wouldn't change how the algorithm would function).</p>\n\n<p>So given that that's the function I'm working with, I'm trying to find an efficient way to calculate the next integer that would give a different output if run through that function. Using the example above (an input of 5316 and above tier cost list), the algorithm should return 5320, since that value would be the first to output <code>[5, 5, 4, 4, 3, 3, 3, 2]</code> from the above function, and no integers between 5316-5319 would output anything different from 5316.</p>\n\n<p>If a code example would help, here is my current implementation of the above function for generating the list of tiers that can currently be afforded using Haskell:</p>\n\n<pre><code>powerFlowerCosts = [1940320,8108896,30577504,101946208,320015200,978185056,2956657504,8896037728,26718141280,80188414816,240603198304,721851511648,2165600414560,6496851086176,19490607063904]\n\nemcToPowerFlowers :: Integer -&gt; [Int]\nemcToPowerFlowers curEMC = foldPFCs (reverse $ takeWhile (&lt;= curEMC) powerFlowerCosts) curEMC\n    where\n        foldPFCs :: [Integer] -&gt; Integer -&gt; [Int]\n        foldPFCs (pfc:pfcs) curEMC = foldPFCs pfcs (curEMC `rem` pfc)\n          ++ replicate (fromInteger (curEMC `div` pfc)) (length pfcs + 1)\n        foldPFCs [] _ = []\n</code></pre>\n\n<p>It first takes the list of tiers up to the last one that can be afforded, reverses the list, and then takes items off the list one at a time, adding that tier to the output however many times that tier can be afforded.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1573941624, "post_id": 58895474, "comment_id": 104055884, "body": "FWIW, <code>Data.List</code> contains <code>partition</code>, which will give you <code>([a], [a])</code>. Couldn&#39;t you use that twice to produce a <code>([a], ([a], [a]))</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573942053, "post_id": 58895474, "comment_id": 104055962, "body": "I am not sure if you need to use these functions. You can use explicit recursion here."}, {"owner": {"reputation": 313, "user_id": 9326367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20dd93a32b0bb11bd3d4326c2a18f908?s=128&d=identicon&r=PG&f=1", "display_name": "FunnyBuzer", "link": "https://stackoverflow.com/users/9326367/funnybuzer"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1573976346, "post_id": 58895474, "comment_id": 104061061, "body": "@MarkSeemann I&#39;m doing some practice to learn the Haskell syntax. So I&#39;d better not use functions already implemented."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 9326367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20dd93a32b0bb11bd3d4326c2a18f908?s=128&d=identicon&r=PG&f=1", "display_name": "FunnyBuzer", "link": "https://stackoverflow.com/users/9326367/funnybuzer"}, "edited": false, "score": 0, "creation_date": 1573976894, "post_id": 58896086, "comment_id": 104061161, "body": "Great answer! Thanks for your explanations"}], "tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": true, "score": 4, "last_activity_date": 1573946005, "creation_date": 1573946005, "answer_id": 58896086, "question_id": 58895474, "link": "https://stackoverflow.com/questions/58895474/function-to-partition-a-list-based-on-conditions-haskell/58896086#58896086", "title": "Function to partition a list based on conditions - Haskell", "body": "<p>One high-level way to think about \"creating\" a value of a type like <code>(a,b,c)</code> is by thinking of the ways you have to \"construct\" it, like a constructor.  In this case, <code>(a,b,c)</code> has one constructor, <code>(_,_,_)</code>.  So you need to think of the things to put in the first slot, the things to put in the second slot, and the things to put in the third slot ... and you're done.</p>\n\n<p>So let's outline our function like that:</p>\n\n<pre><code>partition3 :: (a -&gt; Int) -&gt; [a] -&gt; ([a], [a], [a])\npartition3 f xs = (_, _, _)\n</code></pre>\n\n<p>We know that our final answer is of the form <code>(_,_,_)</code>, where the \"blanks\" contain each item we want to put in our tuple.  Let's give each blank a useful name.</p>\n\n<pre><code>partition3 :: (a -&gt; Int) -&gt; [a] -&gt; ([a], [a], [a])\npartition3 f xs = (equalsOne, equalsTwo, theRest)\n  where\n    equalsOne = ???\n    equalsTwo = ???\n    theRest   = ???\n</code></pre>\n\n<p>Now you just need <code>equalsOne</code> to be the items in <code>xs</code> that match the property you want, etc.  The property for <code>equalsOne</code> is \"a value <code>x</code> matches if, when you apply <code>f</code> to it, it gives <code>1</code>\".  So let's write that using <code>filterAny</code>:</p>\n\n<pre><code>partition3 :: (a -&gt; Int) -&gt; [a] -&gt; ([a], [a], [a])\npartition3 f xs = (equalsOne, equalsTwo, theRest)\n  where\n    equalsOne = filterAny [\\x -&gt; f x == 1] xs\n    equalsTwo = ???\n    theRest   = ???\n</code></pre>\n\n<p>Here we filter <code>xs</code> for any items where, if you apply <code>f</code> to it, gives <code>1</code>.</p>\n\n<p>Can you think of ways to implement <code>equalsTwo</code> and <code>theRest</code>, along the same lines?</p>\n"}], "owner": {"reputation": 313, "user_id": 9326367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20dd93a32b0bb11bd3d4326c2a18f908?s=128&d=identicon&r=PG&f=1", "display_name": "FunnyBuzer", "link": "https://stackoverflow.com/users/9326367/funnybuzer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 58896086, "answer_count": 1, "score": 4, "last_activity_date": 1573946005, "creation_date": 1573940574, "question_id": 58895474, "link": "https://stackoverflow.com/questions/58895474/function-to-partition-a-list-based-on-conditions-haskell", "title": "Function to partition a list based on conditions - Haskell", "body": "<p>I'm learning Haskell and one of the exercises I'm doing is to create a function that partitions a list into three lists based on the return value of the function, so that the first sublist is obtained for the function value equal to 1, the second sublist for the function value being 2, and the third one having everything else.</p>\n\n<p>The function declaration read</p>\n\n<pre><code>partition3 :: (a -&gt; Int) -&gt; [a] -&gt; ([a], [a], [a])\npartition3 _ [] = []\n</code></pre>\n\n<p>As a primer example, consider</p>\n\n<pre><code>partition3 (\\x -&gt; mod x 5) [1..10] = ([1,6], [2,7], [3,4,5,8,9,10])\n</code></pre>\n\n<p>Now, I have already coded the functions <code>filterAny</code>, <code>isSuitable</code>, <code>removeIf</code>, <code>isNotSuitable</code>. The full code is below:</p>\n\n<pre><code>filterAny :: [a -&gt; Bool] -&gt; [a] -&gt; [a]\nfilterAny _ [] = []\nfilterAny ps (x:xs)\n  | isSuitable ps x = x : filterAny ps xs\n  | otherwise = filterAny ps xs\n\nisSuitable :: [a -&gt; Bool] -&gt; a -&gt; Bool\nisSuitable [] _ = False\nisSuitable (p:ps) v\n  | p v       = True\n  | otherwise = isSuitable ps v\n\nremoveIf :: [a -&gt; Bool] -&gt; [a] -&gt; [a]\nremoveIf _ [] = []\nremoveIf ps (x:xs)\n  | isNotSuitable ps x = x : removeIf ps xs\n  | otherwise = removeIf ps xs\n\nisNotSuitable :: [a -&gt; Bool] -&gt; a -&gt; Bool\nisNotSuitable [] _ = True\nisNotSuitable (p:ps) v\n  | p v       = False\n  | otherwise = isNotSuitable ps v\n</code></pre>\n\n<p>Using those functions we can obtained the wanted output for <code>partition3</code>:</p>\n\n<pre><code>filterAny [(\\x -&gt; mod x 5 == 1)] [1..10] = [1,6]\nfilterAny [(\\x -&gt; mod x 5 == 2)] [1..10] = [2,7]\nremoveIf [even, (\\x -&gt; x &gt; 5)] [1..10] = [3,4,5,8,9,10]\n</code></pre>\n\n<p>Unfortunately, I still haven't figured out how to write this function to output <code>([1,6], [2,7], [3,4,5,8,9,10])</code></p>\n"}, {"tags": ["haskell", "indentation"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1573927199, "post_id": 58893633, "comment_id": 104052234, "body": "The type should be <code>Either String Double</code>, not with a pipe in between."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573927382, "post_id": 58893663, "comment_id": 104052290, "body": "Interestingly, what does the parser make of the <code>|</code>, since it isn&#39;t that character itself causing the problem?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1573927775, "post_id": 58893663, "comment_id": 104052396, "body": "@chepner: I&#39;m not sure either. It might have something to do with the <i>functional dependencies</i>, since that is part of the &quot;signature&quot; of a class with functional dependencies. But that is just a guess."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573931878, "post_id": 58893663, "comment_id": 104053539, "body": "Yeah, the same grammar rule might apply to type definitions and type annotations, even though <code>|</code> doesn&#39;t have any meaning (that I&#39;m aware of) in an annotation."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1573939644, "post_id": 58893663, "comment_id": 104055453, "body": "@chepner My guess is that it looks like a variant of <code>x | condition1 = value1 | condition2 = value2</code> except we have a type signature on <code>x</code>, e.g. <code>(x :: Int) | condition = ...</code>. The OP indentation would add a semicolon in the wrong place as in <code>(x :: Int) | condition ; x = ...</code>"}, {"owner": {"reputation": 41, "user_id": 12383901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71221b863bbb22b852366a479e9dcdb5?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/12383901/tom"}, "edited": false, "score": 0, "creation_date": 1573988707, "post_id": 58893663, "comment_id": 104063348, "body": "Thanks Willem, Now it has compiled... :-]"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1573939525, "last_edit_date": 1573939525, "creation_date": 1573927316, "answer_id": 58893663, "question_id": 58893633, "link": "https://stackoverflow.com/questions/58893633/haskell-indentation-issue/58893663#58893663", "title": "Haskell Indentation issue", "body": "<p>The problem is not with the indentation. It is with the type signature. You used a pipe character (<code>|</code>) in the signature for <code>Either</code>. You should remove that. Furthermore you misspelled <s><code>Doubble</code></s>. While a double with double <em>b</em> is nice, it is unfortunately not the name of a <code>Double</code>:</p>\n\n<pre><code>safeSqrt :: Either String <b>Double</b> -&gt; <b>Either String Double</b>\nsafeSqrt sx =\n     case sx of\n         Left str -&gt; Left str\n         Right x -&gt; if x &lt; 0\n             then Left &quot;Error&quot;\n             else Right $ sqrt x</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 12383901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71221b863bbb22b852366a479e9dcdb5?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/12383901/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1573939525, "creation_date": 1573927077, "last_edit_date": 1573927475, "question_id": 58893633, "link": "https://stackoverflow.com/questions/58893633/haskell-indentation-issue", "title": "Haskell Indentation issue", "body": "<p>I am using Visual Studio Code as the text editor of chice \nand the following Haskell code does not compile. Apperently due to indentation or missing parentheses mistake. Since there are no parenthesies I wonder where the problem is</p>\n\n<pre><code>safeSqrt :: Either String Doubble -&gt; Either String | Doubble\nsafeSqrt sx =\n     case sx of\n         Left str -&gt; Left str\n         Right x -&gt; if x &lt; 0\n             then Left \"Error\"\n             else Right $ sqrt x\n</code></pre>\n\n<p>The GHCi throws the following error message:</p>\n\n<pre><code>Main.hs:51:1: error:\n    parse error (possibly incorrect indentation or mismatched brackets)\n   |\n51 | safeSqrt sx =    \n   | ^\n</code></pre>\n\n<p>Can enybody help</p>\n\n<p>Thanks</p>\n\n<p>Tom</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1573928217, "post_id": 58893502, "comment_id": 104052531, "body": "Why are you assuming that you enter the Map inside Right? On what is that assumption based?"}, {"owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1573928424, "post_id": 58893502, "comment_id": 104052590, "body": "My thought was that that was where the non-error outputs live.  I know it&#39;s wrong, it was just my best guess on how to proceed."}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1573930119, "post_id": 58893502, "comment_id": 104053035, "body": "what does col1 col2 etc refer to? They are not defined?"}, {"owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "edited": false, "score": 0, "creation_date": 1573931924, "post_id": 58893502, "comment_id": 104053551, "body": "They are both <code>Int</code>s"}], "answers": [{"tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": true, "score": 1, "last_activity_date": 1573950711, "last_edit_date": 1573950711, "creation_date": 1573949385, "answer_id": 58896392, "question_id": 58893502, "link": "https://stackoverflow.com/questions/58893502/lookup-values-inside-a-cassava-ingested-csv/58896392#58896392", "title": "Lookup values inside a Cassava-ingested CSV", "body": "<p>Yes, it is probably a good idea to use Data.Map to find values in <em>col10</em> using values in <em>col3</em> as keys.</p>\n\n<p>As we have little data about col3, col10 and the exact data type you are using, I will resort to adapting the <a href=\"http://hackage.haskell.org/package/cassava\" rel=\"nofollow noreferrer\"><em>decodebyName</em> example in the Cassava documentation</a> to the idea of generating a map object. The example is based on a very simple {name, salary} type of record.</p>\n\n<p>The two branches of the <em>case of</em> construct have to return a common type, in our case a Data.Map object instead of an <code>IO ()</code> action. Fortunately, the <code>error</code> function is flexible enough that it can pretend to be of the appropriate type.</p>\n\n<p>This would give this sort of code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Applicative\nimport qualified Data.ByteString.Lazy as BL\nimport Data.Csv\nimport qualified Data.Vector as  V\nimport qualified Data.Map    as  M\nimport Control.Monad  (forM_)\n\n\ndata Person = Person\n    { name   :: !String\n    , salary :: !Int\n    } deriving (Show, Ord, Eq)  -- need that for Map objects\n\ninstance FromNamedRecord Person where\n    parseNamedRecord r = Person &lt;$&gt; r .: \"name\" &lt;*&gt; r .: \"salary\"\n\n\n-- build a map object:\nmakeMap :: V.Vector Name -&gt; V.Vector Person -&gt; M.Map String Int\nmakeMap hdr pvec =\n    -- with name and salary playing the role of col3 and col10:\n    let pls = V.toList pvec  -- get a list\n        zls = zip  (map name pls)  (map salary pls)\n    in  M.fromList zls\n\n\nshowRecord :: String -&gt; Int -&gt; String\nshowRecord  name salary  =  name ++ \" earns \" ++ (show salary) ++ \" dollars\"\n\n\nmain :: IO ()\nmain = do\n    csvData &lt;- BL.readFile \"salaries.csv\"\n    let ma = case decodeByName csvData of\n               Left errMsg       -&gt; error $ \"decodeByName failed: \" ++ errMsg\n               Right (hdr, pvec) -&gt; makeMap hdr pvec\n    -- print out the Map object:\n    putStrLn  $  \"Contents of map object:\"\n    putStrLn  $  show ma\n    putStrLn  $  \"\"\n    forM_  (M.toList ma)  (\\(n,s) -&gt; putStrLn $ showRecord n s) \n    let  sal1 = M.lookup  \"John Doe\"  ma\n    putStrLn  $  \"sal1 = \" ++ (show sal1) \n    --\n</code></pre>\n\n<ul>\n<li><strong>Execution:</strong></li>\n</ul>\n\n<pre><code>Contents of map object:\nfromList [(\"Jane Doe\",60000),(\"John Doe\",50000)]\n\nJane Doe earns 60000 dollars\nJohn Doe earns 50000 dollars\nsal1 = Just 50000\n</code></pre>\n\n<p>Note that I have to use plain lists extensively, as for some reason there is no direct route from vectors to maps, something discussed already in this <a href=\"https://stackoverflow.com/questions/41960585/how-to-create-map-from-vector\">SO question</a>.</p>\n"}], "owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 58896392, "answer_count": 1, "score": -2, "last_activity_date": 1573950711, "creation_date": 1573926305, "last_edit_date": 1573926816, "question_id": 58893502, "link": "https://stackoverflow.com/questions/58893502/lookup-values-inside-a-cassava-ingested-csv", "title": "Lookup values inside a Cassava-ingested CSV", "body": "<p>I successfully read in a CSV using Cassava (<a href=\"http://hackage.haskell.org/package/cassava\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/cassava</a>) with this:</p>\n\n<pre><code>getData = do\n  csvData &lt;- BL.readFile \"data.csv\"\n  case decodeByName csvData of\n    Left err -&gt; putStrLn err\n    Right (_, v) -&gt; V.forM_ v $ \\ p -&gt;\n      putStrLn $ col1 p ++ \",\" ++ col2 p ++ \",\" ++ (show $ col3 p) ++ \",\" ++ (show $ col4 p) ++ \",\" ++ (show $ col5 p) ++ \",\" ++ col6 p ++ \",\" ++ (show $ col7 p) ++ \",\" ++ (show $ col8 p) ++ \",\" ++ (show $ col9 p) ++ \",\" ++ (show $ col10 p)\n</code></pre>\n\n<p>What I actually need to do is use the values in <code>col3</code> as keys to find values in <code>col10</code>.</p>\n\n<p>Someone suggested that I use <code>Map</code> from Data.Map (<a href=\"https://hackage.haskell.org/package/containers-0.4.0.0/docs/Data-Map.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/containers-0.4.0.0/docs/Data-Map.html</a>) for this, but I'm not sure how to approach this.  </p>\n\n<p>Everything I have tried so far has not worked.  I assume you enter the <code>Map</code> inside the <code>Right</code> case, along the lines of:</p>\n\n<pre><code>    Right (_, v) -&gt; Map (V.forM_ v) ???\n</code></pre>\n\n<p>But I am stuck on how to proceed.  Would appreciate any suggestions.  Ideally, I would want to modify <code>getData</code> so that it is <code>getData keyToFetch = ...</code> -- and that <code>keyToFetch</code> would be used in the <code>Map</code>.</p>\n"}, {"tags": ["haskell", "profiling", "nix"], "answers": [{"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": false, "score": 2, "last_activity_date": 1598688980, "last_edit_date": 1598688980, "creation_date": 1573916628, "answer_id": 58892035, "question_id": 58891928, "link": "https://stackoverflow.com/questions/58891928/how-can-i-enable-haskell-profiling-when-using-nixs-callcabal2nix/58892035#58892035", "title": "How can I enable Haskell profiling when using Nix&#39;s callCabal2nix", "body": "<p>This can be doing using <code>callCabal2nixWithOptions</code>:</p>\n<pre><code>...\n(myHaskellPackages.callCabal2nixWithOptions &quot;moscoviumorange&quot; (./.) &quot;--enable-profiling&quot; {})\n</code></pre>\n<hr />\n<p>How I figured it out:</p>\n<p>Using the nix repl I found the path to the function via:</p>\n<pre><code>nix-repl&gt; pkgs.haskell.packages.ghc865.callCabal2nix  \n\u00ablambda @ /nix/store/54fafxcq7b6ac2hvs8qzp2bgqzgpiiga-nixos-19.09.1019.c5aabb0d603/nixos/pkgs/development/haskell-modules/make-package-set.nix:213:21\u00bb\n</code></pre>\n<p>I then checkout the the nixpkgs repo (making sure it's on the same commit as the one I reference in default.nix) and navigated to that file+line, which I found:</p>\n<pre><code>    # Creates a Haskell package from a source package by calling cabal2nix on the source.\n    callCabal2nixWithOptions = name: src: extraCabal2nixOptions: args:\n      let\n        filter = path: type:\n                   pkgs.lib.hasSuffix &quot;${name}.cabal&quot; path ||\n                   baseNameOf path == &quot;package.yaml&quot;;\n        expr = self.haskellSrc2nix {\n          inherit name extraCabal2nixOptions;\n          src = if pkgs.lib.canCleanSource src\n                  then pkgs.lib.cleanSourceWith { inherit src filter; }\n                else src;\n        };\n      in overrideCabal (callPackageKeepDeriver expr args) (orig: {\n           inherit src;\n         });\n\n    callCabal2nix = name: src: args: self.callCabal2nixWithOptions name src &quot;&quot; args;\n</code></pre>\n<p>Further narrowing down to <code>haskellSrc2nix</code>:</p>\n<pre><code>  haskellSrc2nix = { name, src, sha256 ? null, extraCabal2nixOptions ? &quot;&quot; }:\n    let\n      sha256Arg = if sha256 == null then &quot;--sha256=&quot; else ''--sha256=&quot;${sha256}&quot;'';\n    in pkgs.buildPackages.stdenv.mkDerivation {\n      name = &quot;cabal2nix-${name}&quot;;\n      nativeBuildInputs = [ pkgs.buildPackages.cabal2nix ];\n      preferLocalBuild = true;\n      allowSubstitutes = false;\n      phases = [&quot;installPhase&quot;];\n      LANG = &quot;en_US.UTF-8&quot;;\n      LOCALE_ARCHIVE = pkgs.lib.optionalString (buildPlatform.libc == &quot;glibc&quot;) &quot;${buildPackages.glibcLocales}/lib/locale/locale-archive&quot;;\n      installPhase = ''\n        export HOME=&quot;$TMP&quot;\n        mkdir -p &quot;$out&quot;\n        cabal2nix --compiler=${self.ghc.haskellCompilerName} --system=${hostPlatform.config} ${sha256Arg} &quot;${src}&quot; ${extraCabal2nixOptions} &gt; &quot;$out/default.nix&quot;\n      '';\n  };\n</code></pre>\n<p>Aha! Doing a google for cabal2nix profiling - it seems to support an option with a command line argument.</p>\n<p><a href=\"https://github.com/NixOS/cabal2nix/blob/650d5300c6bb5632bbab6fcb2d939fb476e469c5/src/Cabal2nix.hs#L92\" rel=\"nofollow noreferrer\">https://github.com/NixOS/cabal2nix/blob/650d5300c6bb5632bbab6fcb2d939fb476e469c5/src/Cabal2nix.hs#L92</a></p>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1598688980, "creation_date": 1573916035, "last_edit_date": 1573928657, "question_id": 58891928, "link": "https://stackoverflow.com/questions/58891928/how-can-i-enable-haskell-profiling-when-using-nixs-callcabal2nix", "title": "How can I enable Haskell profiling when using Nix&#39;s callCabal2nix", "body": "<p>Currenty my default.nix looks like:</p>\n\n<pre><code>{\n  sources ? import ./nix/sources.nix\n, compiler ? \"ghc865\" } :\nlet\n  niv = import sources.nixpkgs {\n    overlays = [\n      (_ : _ : { niv = import sources.niv {}; })\n    ] ;\n    config = {};\n  };\n  pkgs = niv.pkgs;\n  myHaskellPackages = pkgs.haskell.packages.${compiler}.override {\n    overrides = self: super: {\n      mkDerivation = args: super.mkDerivation (args // {\n        enableLibraryProfiling = true;\n      });\n    };\n  };\nin\n(myHaskellPackages.callCabal2nix \"moscoviumorange\" (./.) {})\n</code></pre>\n\n<p>I'd like to enable Haskell profiling for my application and it's dependencies. For my application I can handle this with hpack with:</p>\n\n<pre><code>executables:\n  moscoviumorange-p:\n    ghc-options: -main-is Main -prof -fprof-auto\n    source-dirs: src\n    main: Main.hs\n</code></pre>\n\n<p>How do I do the same for the dependent libraries? </p>\n"}, {"tags": ["haskell", "traversal", "functor"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1573915169, "post_id": 58891771, "comment_id": 104048939, "body": "How would you turn a list into a tree? Both are traversables. Even if a tree is traversable left-to-right, knowing its traversal does not allow to reconstruct the tree in a unique way. We could generate &quot;a tree&quot; but that would require a pretty much arbitrary choice. Classes like foldable/traversable inherently describe ways to <i>consume</i> containers, rather than <i>producing</i> them. Perhaps you want another class."}, {"owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1573915240, "post_id": 58891771, "comment_id": 104048963, "body": "@chi Yes it might not be the right class, then i would be looking for the most general one for that purpose."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573915348, "post_id": 58891771, "comment_id": 104048994, "body": "Assuming such a class existed, would it support only list-like containers? Can you imagine any other container that can be creates from a list in a meaningful way?"}, {"owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573915547, "post_id": 58891771, "comment_id": 104049057, "body": "Perhaps, I would want to convert a list to a vector, but somehow I don&#39;t want to write specific code to convert a list to a vector. I would like to find what is the most factored, most general most beautiful way to convert between two list-like things."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573916314, "post_id": 58891771, "comment_id": 104049293, "body": "Not possible in general. Consider <code>x :: NonEmpty Void</code> <code>x = gmap id []</code>."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1573917615, "post_id": 58891771, "comment_id": 104049631, "body": "I&#39;m not sure, but doesn&#39;t this look like the composition of <code>fmap</code> and a natural transformation between functors..?"}, {"owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1573917718, "post_id": 58891771, "comment_id": 104049658, "body": "@MarkSeemann Yeah I thought of natural transformations, somehow what I want is mapping a functor to another functor.. but I&#39;m not really an expert with Haskell.."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1573918026, "post_id": 58891771, "comment_id": 104049739, "body": "<code>Yeah I thought of natural transformations, somehow what I want is mapping a functor to another functor..</code> - while I&#39;m not very familiar with natural transformations in Haskell, in mathematics that (&quot;a mapping from a functor to another functor&quot;) is <i>precisely</i> what a natural transformation is."}, {"owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573918292, "post_id": 58891771, "comment_id": 104049815, "body": "@RobinZigmond Yes like you, I was referring to the mathematical meaning. I do not know how to express natural transformations in Haskell either, but I think that is what I&#39;m trying to do here. I see there are some libraries, I might check them out later. I think JosephSible&#39;s counter example shows that I need additional requirements that might be formalized by those natural transformations things."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573922621, "post_id": 58891771, "comment_id": 104051077, "body": "I think what you are looking for is the (horizontal?) composition of two natural isomorphisms. That is, something is &quot;list-like&quot; if there is a natural isomorphism between that thing and <code>[]</code>. If <code>a ~&gt; []</code> and <code>b ~&gt; []</code> are both isomorphisms, then it is trivial to define <code>a ~&gt; b</code> and <code>b ~&gt; a</code> by going through <code>[]</code> in either direction. (Where <code>type f ~&gt; g = forall x. f x -&gt; g x</code> is a natural transformation.)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573922814, "post_id": 58891771, "comment_id": 104051136, "body": "(The isomorphism is important, because while you can define both <code>[] ~&gt; Maybe</code> and <code>Maybe ~&gt; []</code>, it&#39;s not an isomorphism because going from a list to a <code>Maybe</code> will lose all but one element of the original list, so you can&#39;t get the original list back given only its <code>Maybe</code> counterpart.)"}], "answers": [{"comments": [{"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1573933914, "post_id": 58892386, "comment_id": 104054020, "body": "I didn&#39;t downvote, but it appears that the asker is looking for a general version that works for <i>all</i> f and g, instead of specific f and g (like safeHead)"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": -1, "last_activity_date": 1573918816, "creation_date": 1573918816, "answer_id": 58892386, "question_id": 58891771, "link": "https://stackoverflow.com/questions/58891771/in-haskell-how-to-fmap-between-distinct-traversables/58892386#58892386", "title": "In Haskell, how to fmap between distinct Traversables?", "body": "<p>I think that you can do this with <code>fmap</code> and a natural transformation. Here's an example using the <a href=\"http://hackage.haskell.org/package/natural-transformation\" rel=\"nofollow noreferrer\">natural-transformations</a> package, just to demonstrate the idea.</p>\n\n<p>The first natural transformation that comes into my mind is <code>safeHead</code>:</p>\n\n<pre><code>safeHead :: [a] -&gt; Maybe a\nsafeHead [] = Nothing\nsafeHead (x:_) = Just x\n</code></pre>\n\n<p>Running GHCi with the <code>natural-transformations</code> package:</p>\n\n<pre><code>Prelude Control.Natural&gt; t = wrapNT safeHead\nPrelude Control.Natural&gt; t # [1..3]\nJust 1\nPrelude Control.Natural&gt; t # []\nNothing\nPrelude Control.Natural&gt; fmap show (t # [1..3])\nJust \"1\"\nPrelude Control.Natural&gt; fmap show (t # [])\nNothing\n</code></pre>\n\n<p>So, for a natural transformation <code>t</code>, would something like <code>fmap f . (t #)</code> do what you want?</p>\n\n<p>(Here, I'm imagining that <code>f</code> is a normal function <code>a -&gt; b</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 4, "last_activity_date": 1573930503, "creation_date": 1573930503, "answer_id": 58894120, "question_id": 58891771, "link": "https://stackoverflow.com/questions/58891771/in-haskell-how-to-fmap-between-distinct-traversables/58894120#58894120", "title": "In Haskell, how to fmap between distinct Traversables?", "body": "<p>You can create your own type class, and a way to go from one functor to another, this is one example of one way to convert list to Tree, but you can use whatever you consider correct to fit your problem.</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nclass (Functor f, Functor g) =&gt; GFunctor f g where\n  toG :: f a -&gt; g a\n  gmap :: (a -&gt; b) -&gt; (f a) -&gt; (g b)\n  gmap fn functor = toG $ fmap fn functor\n\ndata Tree a = Leaf | Node (Tree a) a (Tree a) deriving Show\n\ninstance Functor Tree where\n  fmap f Leaf = Leaf\n  fmap f (Node t1 x t2) = Node (fmap f t1) (f x) (fmap f t2)\n\ninstance GFunctor [] Tree  where\n  toG [] = Leaf \n  toG [x] = Node Leaf x Leaf\n  toG (x:xs) = Node (toG $ (takeHalf xs)) x ((toG $ dropHald xs))\n\ntakeHalf xs = take ((length xs) `div` 2) xs\ndropHald xs = drop ((length xs) `div` 2) xs\n\nres :: Tree Int\nres = gmap (+1) [1,2,3,4,5]\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>   res\n=&gt; Node (Node Leaf 3 (Node Leaf 4 Leaf)) 2 (Node Leaf 5 (Node Leaf 6 Leaf))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1573981367, "post_id": 58894703, "comment_id": 104061945, "body": "Nice answer. I think the signature for <code>replace</code> is not quite general enough: <code>replace :: (...) =&gt; f a -&gt; g b -&gt; g a</code>.  Or <code>g ()</code> if we really want to make it clear that we are just using its shape."}, {"owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "edited": false, "score": 0, "creation_date": 1573997351, "post_id": 58894703, "comment_id": 104065373, "body": "@Justin No I&#39;m not trying to achieve something specific. I feel my question is drifting away from what I really wanted to know. Perhaps Traversable is not the good fit here, i dont want ppl to focus on it then. There are different kinds of lists, for example vectors, arrays, lists. Im wondering what is the common denominator to these structures. What do they have in common that make them &quot;list-like&quot; ?? Is there a Haskell type that expresses this?, if so could this general &quot;list-like&quot; type be used to convert between different &quot;list-like&quot; types?"}, {"owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "edited": false, "score": 0, "creation_date": 1573997779, "post_id": 58894703, "comment_id": 104065485, "body": "I should repost a question. I think there are probably no list-like types anyway.. its too specific to be part of base. Anyway using this replace function seems good enough"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "reply_to_user": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "edited": false, "score": 1, "creation_date": 1574062889, "post_id": 58894703, "comment_id": 104082084, "body": "@J.M. If you&#39;re looking for what units vectors, arrays, lists, etc., then <code>IsList</code> might be a start.  But a more principled approach might be the <i>mono-traversable</i> library, which has typeclasses for various types of &quot;containers&quot; of varying degrees of specificity/functionality."}], "tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": true, "score": 5, "last_activity_date": 1574062839, "last_edit_date": 1574062839, "creation_date": 1573934676, "answer_id": 58894703, "question_id": 58891771, "link": "https://stackoverflow.com/questions/58891771/in-haskell-how-to-fmap-between-distinct-traversables/58894703#58894703", "title": "In Haskell, how to fmap between distinct Traversables?", "body": "<p>One trick we often use in Haskell to show that things are not possible is trying to produce \"false\" with it -- aka, produce a value of type</p>\n\n<pre><code>data Void\n</code></pre>\n\n<p>the type with no constructors.  If it is possible, using your type signature, to produce a value of type <code>Void</code>, then your type signature is not possible to be implemented.  This is also known as \"reducto ad absurdum\", or \"disproof by contradiction\".  If your type signature would allow us to produce a value of type <code>Void</code>...then \"obviously\" your type signature is bunk and cannot be implemented.</p>\n\n<p>In this case we are \"returning\" a <code>Traversable</code> instance, so let's use a <code>Traversable</code> like <code>(,) Void</code>:</p>\n\n<pre><code>instance Traversable ((,) w) where\n    traverse f (x, y) = (x,) &lt;$&gt; f y\n</code></pre>\n\n<p>Now let's use <code>f</code> as any old functor.  It could be anything...let's use <code>Maybe</code> because it seems like everyone already understands it.</p>\n\n<p>Then, you could write:</p>\n\n<pre><code>gmap :: (a -&gt; b) -&gt; Maybe a -&gt; (Void, b)\n</code></pre>\n\n<p>Oh no, that can't be right ... it looks like using gmap you can create a <code>Void</code> just by passing in any old thing:</p>\n\n<pre><code>gmap :: (() -&gt; ()) -&gt; Maybe () -&gt; (Void, ())\n</code></pre>\n\n<p>So now my strategy for creating <code>Void</code>:</p>\n\n<pre><code>bad :: Void\nbad = fst (gmap id Nothing)\n</code></pre>\n\n<p>Because <code>Void</code> has no constructors, a value of type <code>bad :: Void</code> shoudn't exist (disregarding something like an infinite loop or partial function).  So, if the mere existence if <code>gmap</code> can allow us to create a value of type <code>Void</code>...it must mean that <code>gmap</code> cannot exist in the form you gave.</p>\n\n<hr>\n\n<p>For your more general problem, the \"why\" in how <code>Traversable</code> works is that it can only ever <em>modify</em> structures.  It cannot <em>create</em> them.  Here, you want to create a value of <code>g b</code>, but <code>Traversable</code> cannot \"create\" it, it can only \"transform\" it.  Your misunderstanding might be coming from you thinking that <code>Traversable</code> is a \"list-like\" typeclass: it's not, quite.  Using <code>[]</code> as a archetype might be leading you astray.</p>\n\n<p>My \"typical\" <code>Traversable</code> to imagine properties of the typeclass for is <code>Map k</code>, from <em>containers</em>'s <code>Data.Map</code>: a <code>Map</code> isn't a, but rather values associated with keys.  Any operations on it would have to be able to respect this association property...and not treat it as a big list with no extra structure.</p>\n\n<p>So what <em>would</em> be possible is something like:</p>\n\n<pre><code>replace :: (Foldable f, Traversable g) =&gt; f a -&gt; g b -&gt; g a\n</code></pre>\n\n<p>Where all of the values of the <code>g b</code> are replaced by all the values of the <code>f a</code>.  This one is actually sort of fun to write, if you are looking for an exercise.  Basically, <code>replace</code> would <em>keep</em> the same <strong>structure</strong> that the <code>g a</code> had, but just <em>replace</em> the <strong>values</strong>.  So you can \"create\" a <code>g a</code> from an <code>f a</code> as long as you had an \"example <code>g b</code>\", so to speak.  If you used something like:</p>\n\n<pre><code>replace :: [a] -&gt; Map k b -&gt; Map k a\n</code></pre>\n\n<p>then <code>replace</code> would replace all the values in the second map with the items in the list, replacing them at the proper key values.</p>\n\n<p>Then you can write:</p>\n\n<pre><code>gmap :: (Traversable a, Traversable g) =&gt; (a -&gt; b) -&gt; f a -&gt; g c -&gt; g b\n</code></pre>\n\n<p>Where you take an \"example\" <code>g a</code> of the structure you want to copy.</p>\n\n<p>The closest thing to being able to \"construct\" a structure in Haskell's common typeclasses is <code>IsList</code>, from <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/GHC-Exts.html#t:IsList\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/base-4.12.0.0/docs/GHC-Exts.html#t:IsList</a></p>\n\n<p>This typeclass gives you two functions, <code>fromList</code> and <code>toList</code>, so you could write:</p>\n\n<pre><code>throughIsList :: (IsList l, IsList m, Item l ~ Item m) =&gt; l -&gt; m\nthroughIsList = fromList . toList\n</code></pre>\n\n<p>And making it work over <code>Functor</code>s:</p>\n\n<pre><code>gmap :: (IsList (f a), IsList (g b), Item (f a) ~ a, Item (g b) ~ b) =&gt; (a -&gt; b) -&gt; f a -&gt; g b\ngmap f = fromList . map f . toList\n</code></pre>\n\n<p>The problem is now that most <code>Functor</code>s are not instances of <code>IsList</code>...and many of the actual instances aren't total.  So it's not quite usable for most <code>Functor</code>s.</p>\n\n<hr>\n\n<p>So in the end I don't think there is any satisfying answer.  If something you were doing relies on the fact that there is a good answer (other than an answer of \"no\")...maybe can I ask what your \"final goal\" is?  What are you planning on using this type for?</p>\n\n<p>(For example, in 90% of situations where people ask questions like \"is there a way I can convert monads\" or something like that, usually they <em>don't</em> want to do something in <em>general</em>, but rather they had <em>specific</em> types they had in mind.)</p>\n"}], "owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 58894703, "answer_count": 3, "score": 7, "last_activity_date": 1574062839, "creation_date": 1573914857, "last_edit_date": 1573915833, "question_id": 58891771, "link": "https://stackoverflow.com/questions/58891771/in-haskell-how-to-fmap-between-distinct-traversables", "title": "In Haskell, how to fmap between distinct Traversables?", "body": "<p>As we know, <code>fmap</code>'s signature is <code>(a -&gt; b) -&gt; f a -&gt; f b</code> where <code>f</code> is a <code>Functor</code>.</p>\n\n<p>It seems natural that to be as general as possible, and factor code better, one might want to map a \"list of things\" to another possibly distinct \"list of things\". Intuitively I do not see why it should not be possible, or not desirable.</p>\n\n<p>What I'm looking for is a function <code>gmap</code> with same behavior as <code>fmap</code> but with that signature <code>gmap :: (a -&gt; b) -&gt; (f a) -&gt; (g b)</code> where I'm allowing arrival and departure containers to differ.</p>\n\n<p>I am not sure if this would make sense in the very general case where <code>f</code> and <code>g</code> are <code>Functors</code>, however the idea of a \"list of things\" sounds more essentially captured by the <code>Traversable</code> class, assuming I'm mostly interested in iterating over data.</p>\n\n<p>So perhaps the signature should be <code>gmap :: (Traversable f, Traversable g) =&gt; (a -&gt; b) -&gt; (f a) -&gt; (g b)</code>.</p>\n\n<p>Even if <code>g</code> is of different nature as <code>f</code>, it's still something one can traverse from left to right, so it still feels like one should be able to map the k-th visited element of <code>f</code> to the k-th visited element of <code>g</code>.</p>\n\n<p>Assuming my thinking didn't go wrong,  is there such a function in Haskell? </p>\n\n<p>Essentially, my question, is how would you convert from one list-like thing to another in Haskell, in the most factored and elegant way?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1573912935, "creation_date": 1573912935, "answer_id": 58891489, "question_id": 58891464, "link": "https://stackoverflow.com/questions/58891464/function-that-removes-the-first-letter-of-a-word-and-attaches-it-at-the-end-has/58891489#58891489", "title": "Function that removes the first letter of a word and attaches it at the end (Haskell)", "body": "<p>There are two problems here. First of all, the signature of <code>mangle</code> should be <code>mangle :: [a] -&gt; [a]</code>. Indeed, it takes as parameter a <code>[a]</code>, a list of <code>a</code>s, and it returns a list of <code>a</code>s.</p>\n\n<p>Another problem is that <code>head :: [a] -&gt; a</code> returns a single element. So you can not use <code>(++) :: [a] -&gt; [a] -&gt; [a]</code> since that expects two lists with the same type of items.</p>\n\n<p>You thus need to wrap the <code>head x</code> in a singleton list:</p>\n\n<pre><code>mangle :: [a] -&gt; <b>[a]</b>\nmangle x = tail x ++ <b>[</b>head x<b>]</b></code></pre>\n\n<p>There is still another problem: <code>head</code> and <code>tail</code> can not work with empty lists. You thus probably should write a base-case for an empty list as well.</p>\n\n<p>We can make the function more elegant by performing pattern matching instead of using <code>head</code> and <code>tail</code>, like:</p>\n\n<pre><code>mangle :: [a] -&gt; [a]\nmangle [] = &hellip;\nmangle <b>(x:xs)</b> = <b>xs</b> ++ [<b>x</b>]</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11523348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d78a074b6cf25143a7410ed6c3b55c72?s=128&d=identicon&r=PG&f=1", "display_name": "LK4", "link": "https://stackoverflow.com/users/11523348/lk4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 58891489, "answer_count": 1, "score": 1, "last_activity_date": 1573913015, "creation_date": 1573912704, "last_edit_date": 1573913015, "question_id": 58891464, "link": "https://stackoverflow.com/questions/58891464/function-that-removes-the-first-letter-of-a-word-and-attaches-it-at-the-end-has", "title": "Function that removes the first letter of a word and attaches it at the end (Haskell)", "body": "<p>I am stuck with the following question:\n<strong>Write a function <code>mangle :: String -&gt; String</code> which removes the first letter of a word and attaches it at the end.</strong></p>\n\n<p>What I have so far:</p>\n\n<pre><code>mangle :: [a] -&gt; [a] -&gt; [a]       (I suspect that this is possibly wrong)\nmangle x\n  = a ++ b\n  where\n    a = tail x\n    b = head x\n</code></pre>\n\n<p>Can anyone help me and tell/explain what I should put on the top?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "ghc", "language-extension"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573914116, "post_id": 58890798, "comment_id": 104048662, "body": "I&#39;d be surprised if such a thing were introduced. <code>String</code> isn&#39;t a &quot;primitive&quot; type in Haskell, so it makes sense that it shouldn&#39;t really be privileged with its own syntax that other containers-of-<code>Char</code>s don&#39;t have access to."}], "answers": [{"tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 5, "last_activity_date": 1573908444, "creation_date": 1573908444, "answer_id": 58890897, "question_id": 58890798, "link": "https://stackoverflow.com/questions/58890798/is-there-a-ghc-extension-for-enabling-overloaded-character-literals/58890897#58890897", "title": "Is there a GHC extension for enabling overloaded character literals?", "body": "<p>No.</p>\n\n<p>Let me answer that with some exploration of the GHC source code:</p>\n\n<p>This is the code in the renamer where <code>OverloadedString</code> take effect:</p>\n\n<pre><code>rnExpr (HsLit x lit@(HsString src s))\n  = do { opt_OverloadedStrings &lt;- xoptM LangExt.OverloadedStrings\n       ; if opt_OverloadedStrings then\n            rnExpr (HsOverLit x (mkHsIsString src s))\n         else do {\n            ; rnLit lit\n            ; return (HsLit x (convertLit lit), emptyFVs) } }\n\nrnExpr (HsLit x lit)\n  = do { rnLit lit\n       ; return (HsLit x(convertLit lit), emptyFVs) }\n\nrnExpr (HsOverLit x lit)\n  = do { ((lit', mb_neg), fvs) &lt;- rnOverLit lit -- See Note [Negative zero]\n       ; case mb_neg of\n              Nothing -&gt; return (HsOverLit x lit', fvs)\n              Just neg -&gt; return (HsApp x (noLoc neg) (noLoc (HsOverLit x lit'))\n                                 , fvs ) }\n</code></pre>\n\n<p>(<a href=\"https://github.com/ghc/ghc/blob/c2991f16cb6f5b4e7cff46a394dda4247d973f44/compiler/rename/RnExpr.hs#L152\" rel=\"noreferrer\">https://github.com/ghc/ghc/blob/c2991f16cb6f5b4e7cff46a394dda4247d973f44/compiler/rename/RnExpr.hs#L152</a>)</p>\n\n<p>You see that there is special handling for strings, but not for other forms of literals. The last clause is for literals that are overloaded according to the original Haskell standard, as we can see in these lines from the parser:</p>\n\n<pre><code>        | literal                       { ECP $ mkHsLitPV $! $1 }\n-- This will enable overloaded strings permanently.  Normally the renamer turns HsString\n-- into HsOverLit when -foverloaded-strings is on.\n--      | STRING    { sL (getLoc $1) (HsOverLit $! mkHsIsString (getSTRINGs $1)\n--                                       (getSTRING $1) noExt) }\n        | INTEGER   { ECP $ mkHsOverLitPV (sL1 $1 $ mkHsIntegral   (getINTEGER  $1)) }\n        | RATIONAL  { ECP $ mkHsOverLitPV (sL1 $1 $ mkHsFractional (getRATIONAL $1)) }\n</code></pre>\n\n<p>(<a href=\"https://github.com/ghc/ghc/blob/c2991f16cb6f5b4e7cff46a394dda4247d973f44/compiler/parser/Parser.y#L2793\" rel=\"noreferrer\">https://github.com/ghc/ghc/blob/c2991f16cb6f5b4e7cff46a394dda4247d973f44/compiler/parser/Parser.y#L2793</a>)</p>\n\n<p>\u2026</p>\n\n<pre><code>literal :: { Located (HsLit GhcPs) }\n        : CHAR              { sL1 $1 $ HsChar       (getCHARs $1) $ getCHAR $1 }\n        | STRING            { sL1 $1 $ HsString     (getSTRINGs $1)\n                                                    $ getSTRING $1 }\n        | PRIMINTEGER       { sL1 $1 $ HsIntPrim    (getPRIMINTEGERs $1)\n                                                    $ getPRIMINTEGER $1 }\n        | PRIMWORD          { sL1 $1 $ HsWordPrim   (getPRIMWORDs $1)\n                                                    $ getPRIMWORD $1 }\n        | PRIMCHAR          { sL1 $1 $ HsCharPrim   (getPRIMCHARs $1)\n                                                    $ getPRIMCHAR $1 }\n        | PRIMSTRING        { sL1 $1 $ HsStringPrim (getPRIMSTRINGs $1)\n                                                    $ getPRIMSTRING $1 }\n        | PRIMFLOAT         { sL1 $1 $ HsFloatPrim  noExt $ getPRIMFLOAT $1 }\n        | PRIMDOUBLE        { sL1 $1 $ HsDoublePrim noExt $ getPRIMDOUBLE $1 }\n</code></pre>\n\n<p>(<a href=\"https://github.com/ghc/ghc/blob/c2991f16cb6f5b4e7cff46a394dda4247d973f44/compiler/parser/Parser.y#L3708\" rel=\"noreferrer\">https://github.com/ghc/ghc/blob/c2991f16cb6f5b4e7cff46a394dda4247d973f44/compiler/parser/Parser.y#L3708</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 7, "last_activity_date": 1573908951, "creation_date": 1573908951, "answer_id": 58890970, "question_id": 58890798, "link": "https://stackoverflow.com/questions/58890798/is-there-a-ghc-extension-for-enabling-overloaded-character-literals/58890970#58890970", "title": "Is there a GHC extension for enabling overloaded character literals?", "body": "<p>Not as of GHC 8.8, but you can use the <a href=\"https://downloads.haskell.org/ghc/latest/docs/html/users_guide/glasgow_exts.html#extension-QuasiQuotes\" rel=\"noreferrer\"><code>QuasiQuotes</code></a> extension to get pretty far. Here is an example of a quasiquote which only accepts an ascii character and converts it to its byte representation.</p>\n\n<pre><code>import Language.Haskell.TH\nimport Language.Haskell.TH.Quote\nimport Language.Haskell.TH.Syntax\n\nimport Data.Word (Word8)\nimport Data.Char (isAscii)\n\nasciiByte :: QuasiQuoter\nasciiByte = QuasiQuoter\n  { quoteExp = \\str -&gt; case str of\n                         [c] | isAscii c -&gt; lift (fromIntegral (fromEnum c) :: Word8)\n                         _ -&gt; fail (\"asciiByte: expects a single ascii character, got \" ++ str) \n  , quotePat = \\_ -&gt; fail \"asciiByte: only available for expressions\"\n  , quoteType = \\_ -&gt; fail \"asciiByte: only available for expressions\"\n  , quoteDec = \\_ -&gt; fail \"asciiByte: only available for expressions\"\n  }\n</code></pre>\n\n<p>Then, you can use it as:</p>\n\n<pre><code>ghci&gt; [asciiByte|a|]\n97\nghci&gt; [asciiByte|\u00e9|]\n\n&lt;interactive&gt;:75:12: error:\n    \u2022 asciiByte: expects a single ascii character, got \u00e9\n    \u2022 In the quasi-quotation: [asciiByte|\u00e9|]\nghci&gt; [asciiByte|abc|]\n\n&lt;interactive&gt;:76:12: error:\n    \u2022 asciiByte: expects a single ascii character, got abc\n    \u2022 In the quasi-quotation: [asciiByte|abc|]\n\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6201321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c242917680bffd3a50af4ae0f1b6c1d?s=128&d=identicon&r=PG", "display_name": "jbweston", "link": "https://stackoverflow.com/users/6201321/jbweston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 58890970, "answer_count": 2, "score": 6, "last_activity_date": 1573908951, "creation_date": 1573907782, "question_id": 58890798, "link": "https://stackoverflow.com/questions/58890798/is-there-a-ghc-extension-for-enabling-overloaded-character-literals", "title": "Is there a GHC extension for enabling overloaded character literals?", "body": "<p>I am aware that there is a GHC extension, <code>OverloadedStrings</code>, which allows <strong>string literals</strong> (delimited by <code>\"</code>) to become polymorphic, similar to the built-in behavior for number literals.</p>\n\n<p>My question is: is there a GHC extension that allows <strong>single character literals</strong> (delimited by <code>'</code>) to become polymorphic in an analogous way?</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack", "ghci"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1573909378, "post_id": 58890632, "comment_id": 104047599, "body": "You can use <code>:set</code> command from within GHCI to run GHC flags. You may do like <code>:set --package matrix</code> and then <code>:r</code>. Check <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#the-set-and-seti-commands\" rel=\"nofollow noreferrer\">GHCI Options</a> and <a href=\"https://downloads.haskell.org/~ghc/7.0.3/docs/html/users_guide/flag-reference.html\" rel=\"nofollow noreferrer\">Flags Reference -&gt; 4.19.11 Packages</a>"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1573989569, "post_id": 58890632, "comment_id": 104063535, "body": "Also <a href=\"https://github.com/ndmitchell/ghcid\" rel=\"nofollow noreferrer\">ghcid</a> is a very nice tool for Haskell development.There are many options that would allow you to reload or restart GHCI automatically when any file/directory gets updated. (<code>--reload</code> and <code>--restart</code> switches) <a href=\"https://binarin.ru/post/auto-reload-threepenny-gui/\" rel=\"nofollow noreferrer\">Here is a good example</a> and <a href=\"https://www.parsonsmatt.org/2018/05/19/ghcid_for_the_win.html\" rel=\"nofollow noreferrer\">a blog post on ghcid</a>"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1583634851, "creation_date": 1573906595, "last_edit_date": 1583634851, "question_id": 58890632, "link": "https://stackoverflow.com/questions/58890632/reload-cabal-file-from-stack-ghci", "title": "Reload cabal file from stack ghci?", "body": "<p>If I modify my cabal file to add a module, <code>:reload</code> doesn't pick that up. Is there a way to <code>:reload</code> as if I ran <code>stack ghci</code> anew without having to exit ghci?</p>\n"}, {"tags": ["haskell", "haskell-stack", "template-haskell", "haskell-platform", "haskell-pipes"], "comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1573903013, "post_id": 58890107, "comment_id": 104046075, "body": "<a href=\"https://www.haskell.org/hugs/pages/libraries/base/System-Time.html\" rel=\"nofollow noreferrer\">Tried this?</a>"}, {"owner": {"reputation": 1201, "user_id": 7506861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa43944dd74a96c82dfd990626da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7506861/emily"}, "edited": false, "score": 2, "creation_date": 1573903075, "post_id": 58890107, "comment_id": 104046095, "body": "IIRC <code>System.Time</code> has been deprecated and superseded by the <code>time</code> package."}], "answers": [{"tags": [], "owner": {"reputation": 1201, "user_id": 7506861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa43944dd74a96c82dfd990626da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7506861/emily"}, "is_accepted": true, "score": 5, "last_activity_date": 1573903033, "creation_date": 1573903033, "answer_id": 58890125, "question_id": 58890107, "link": "https://stackoverflow.com/questions/58890107/what-is-the-way-to-get-system-time-in-haskell/58890125#58890125", "title": "what is the way to get system time in Haskell?", "body": "<p>You can use <a href=\"http://hackage.haskell.org/package/time-1.9.3/docs/Data-Time-Clock.html#v:getCurrentTime\" rel=\"noreferrer\">getCurrentTime</a> from <code>Data.Time.Clock</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 881, "user_id": 4980575, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e9b6ebddd1297e28ad1f59bcd7d1e87d?s=128&d=identicon&r=PG&f=1", "display_name": "Madhuchhanda Mandal", "link": "https://stackoverflow.com/users/4980575/madhuchhanda-mandal"}, "is_accepted": false, "score": 0, "last_activity_date": 1573903074, "creation_date": 1573903074, "answer_id": 58890132, "question_id": 58890107, "link": "https://stackoverflow.com/questions/58890107/what-is-the-way-to-get-system-time-in-haskell/58890132#58890132", "title": "what is the way to get system time in Haskell?", "body": "<p><a href=\"http://hackage.haskell.org/package/old-time-1.1.0.3/docs/System-Time.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/old-time-1.1.0.3/docs/System-Time.html</a></p>\n\n<p>Go through the above Doc. </p>\n\n<blockquote>\n  <p>System.Time provides functionality for clock times, including timezone information (i.e, the functionality of \"time.h\", adapted to the Haskell environment). It follows RFC 1129 in its use of Coordinated Universal Time (UTC).</p>\n</blockquote>\n"}], "owner": {"reputation": 117, "user_id": 11391270, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4SN0mtjVEJA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reU0-sgPqFCXVTgkK-IJatRZWdXYw/mo/photo.jpg?sz=128", "display_name": "arjun a", "link": "https://stackoverflow.com/users/11391270/arjun-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 58890125, "answer_count": 2, "score": -3, "last_activity_date": 1573903074, "creation_date": 1573902851, "question_id": 58890107, "link": "https://stackoverflow.com/questions/58890107/what-is-the-way-to-get-system-time-in-haskell", "title": "what is the way to get system time in Haskell?", "body": "<p>i want to use system time in my code for having the record of time when the data is captured from the user interface.<strong>how to get system time using Haskell</strong>.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1573922794, "post_id": 58890226, "comment_id": 104051129, "body": "Type-level red-black records ... pretty wild (i see you are the author!). I&#39;m going to chip away at this over the weekend, but one question: it looks like <code>NP</code> constraints the traversable to be a List, which might add to the inefficiencies if the input traversable was originally something other than a List, and this appears to be the case whether or not red-black-record is used, right?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1573924040, "post_id": 58890226, "comment_id": 104051427, "body": "<code>NP</code> (and <code>Record</code>) let you choose the type constructor in which to wrap every component. <code>NP I</code>, <code>NP Maybe</code>, <code>NP (Either String)</code>.... I used <code>[]</code> but one could choose something more suitable. Also, the key function here is <code>liftA2_NP</code> from sop-core, which performs &quot;componentwise function application&quot; <a href=\"http://hackage.haskell.org/package/sop-core-0.5.0.0/docs/Data-SOP-NP.html#v:liftA2_NP\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/sop-core-0.5.0.0/docs/&hellip;</a> Something like it will likely exist in Higgledy as well, but I&#39;m not familiar with that library."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1574106654, "post_id": 58890226, "comment_id": 104105139, "body": "I&#39;m trying to go with this approach; to address the generic issues I&#39;m having I asked <a href=\"https://stackoverflow.com/questions/58921905/how-to-fix-type-errors-including-cant-quantify-over-traversable-when-generi\" title=\"how to fix type errors including cant quantify over traversable when generi\">stackoverflow.com/questions/58921905/&hellip;</a>"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 5, "last_activity_date": 1573907601, "last_edit_date": 1573907601, "creation_date": 1573903622, "answer_id": 58890226, "question_id": 58889734, "link": "https://stackoverflow.com/questions/58889734/given-a-record-of-functions-and-a-record-of-data-of-the-types-acted-on-by-the-f/58890226#58890226", "title": "Given a record of functions, and a record of data of the types acted on by the functions, how to generically apply the function record?", "body": "<blockquote>\n  <p>Now RecSummaryFuns a should have the same \"field names\" (constructor\n  arguments) as a</p>\n</blockquote>\n\n<p>This answer uses <a href=\"http://hackage.haskell.org/package/red-black-record\" rel=\"nofollow noreferrer\">red-black-record</a> to construct \"generalized records\" that have the same field names as the original <code>Foo</code> record. First we must auto-derive some <a href=\"http://hackage.haskell.org/package/red-black-record-2.1.0.2/docs/Data-RBR.html#g:8\" rel=\"nofollow noreferrer\">supporting typeclasses</a>:</p>\n\n<pre><code>{-# LANGUAGE AllowAmbiguousTypes #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE DeriveAnyClass #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE PartialTypeSignatures #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeApplications #-}\n{-# OPTIONS_GHC -Wno-partial-type-signatures #-} -- hide some scary types\n\nimport Data.RBR (FromRecord (..), Record, ToRecord (..), fromNP, insert, toNP, unit)\nimport Data.SOP (I (I), NP) -- from sop-core\nimport Data.SOP.NP (liftA2_NP, liftA_NP) --   useful functions for n-ary products\nimport GHC.Generics\n\ndata Foo\n  = Foo\n      { v1 :: Int,\n        v2 :: Double\n      }\n  deriving (Show, Generic, FromRecord, ToRecord)\n</code></pre>\n\n<p>Now we can define a value of our generalized record, whose fields will hold functions. Sadly, we can't employ the usual record syntax:</p>\n\n<pre><code>newtype Func a = Func ([a] -&gt; a) -- helper newtype encapsulating the function\n\ntype FooFunc = Record Func (RecordCode Foo) -- wrap every field in Func\n\nexampleFunc :: FooFunc\nexampleFunc =\n      insert @\"v1\" (Func head) -- field names give with TypeApplications\n    . insert @\"v2\" (Func last) -- same order as in the original record\n    $ unit -- unit is the empty record\n</code></pre>\n\n<p>The next step is defining this <em>generic</em> apply function with the help of the <a href=\"http://hackage.haskell.org/package/sop-core-0.5.0.0/docs/Data-SOP-NP.html#t:NP\" rel=\"nofollow noreferrer\">n-ary product</a> datatype provided by <a href=\"http://hackage.haskell.org/package/sop-core\" rel=\"nofollow noreferrer\">sop-core</a>:</p>\n\n<pre><code>applyFunc ::  _ =&gt; Record Func _ -&gt; [r] -&gt; r\napplyFunc func foos =\n  let foos_NP :: [NP I _] -- a list of n-ary products. I is an identity functor\n      foos_NP = toNP . toRecord &lt;$&gt; foos\n      listfoos_NP :: [NP [] _] -- turn every component into a singleton list\n      listfoos_NP = liftA_NP (\\(I x) -&gt; [x]) &lt;$&gt; foos_NP\n      listfoo_NP :: NP [] _ -- a single n-ary product where each component is a list\n      listfoo_NP = mconcat listfoos_NP\n      func_NP :: NP Func _ -- turn the function record into a n-ary prod\n      func_NP = toNP func\n      resultFoo_NP_I :: NP I _ -- apply the functions to each list component\n      resultFoo_NP_I = liftA2_NP (\\(Func f) vs -&gt; I (f vs)) func_NP listfoo_NP\n   in fromRecord . fromNP $ resultFoo_NP_I -- go back to the nominal record Foo\n</code></pre>\n\n<p>Putting it all together:</p>\n\n<pre><code>main :: IO ()\nmain =\n  print $\n    applyFunc exampleFunc [Foo 0 0.0, Foo 1 1.0]\n-- result: Foo {v1 = 0, v2 = 1.0}\n</code></pre>\n\n<p>Possible disadvantages of this solution are longer compilation times, and also the fact that turning the list-of-<code>Foo</code>s into a <code>Foo</code>-with-list-fields inside <code>applyFunc</code> might be inefficient for long lists.</p>\n\n<p>We could ditch <a href=\"http://hackage.haskell.org/package/red-black-record\" rel=\"nofollow noreferrer\">red-black-record</a>\u2014we are only using it to preserve field names in the generalized records\u2014and rely on <a href=\"http://hackage.haskell.org/package/sop-core\" rel=\"nofollow noreferrer\">sop-core</a> / <a href=\"https://hackage.haskell.org/package/generics-sop\" rel=\"nofollow noreferrer\">generics-sop</a> directly; in that case field names would be handled differently\u2014or we could simply rely on positional matching.</p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 2, "answer_count": 1, "score": 6, "last_activity_date": 1573927884, "creation_date": 1573900021, "last_edit_date": 1573927884, "question_id": 58889734, "link": "https://stackoverflow.com/questions/58889734/given-a-record-of-functions-and-a-record-of-data-of-the-types-acted-on-by-the-f", "title": "Given a record of functions, and a record of data of the types acted on by the functions, how to generically apply the function record?", "body": "<p>The title is slightly inaccurate as my particular case is a bit more involved: rather than the functions in the first record acting directly on values in the second record, they act on a list (or other traversable) of the values. The result of an application for a particular field returns a value of the same type as was in the field, we can assume, if that buys us anything.</p>\n\n<p>An example would be something like:</p>\n\n<pre><code>data Foo = Foo {\n  v1 :: Int\n, v2 :: Double\n}\n\ndata FooFuns = FooFuns {\n  v1 :: [Int] -&gt; Int\n, v2 :: [Double] -&gt; Double\n}\n</code></pre>\n\n<p>So the goal now is to automatically construct e.g. </p>\n\n<pre><code>result = Foo {\n  v1 = (v1 FooFuns) (v1 &lt;$&gt; listOfFoos)\n, v2 = (v2 FooFuns) (v2 &lt;$&gt; listOfFoos)\n}\n</code></pre>\n\n<p>Currently I'm wrapping up the function on a list of values as a <code>newtype</code> (so it can be used by <a href=\"http://hackage.haskell.org/package/higgledy\" rel=\"nofollow noreferrer\">Higgledy</a>'s <code>HKD</code>) and a GADT for the Traversable constraint, but this latter part may be unnecessary, or perhaps better modeled as a typeclass:</p>\n\n<pre><code>data TraversableFun a t where\n  TraversableFun :: Traversable t =&gt; (t a -&gt; a) -&gt; TraversableFun t a\nnewtype ListFun a = ListFun {unTravFun :: TraversableFun [] a}\n\ntype RecSummaryFuns a = HKD a ListFun\n</code></pre>\n\n<p>Now <code>RecSummaryFuns a</code> should have the same \"field names\" (constructor arguments) as <code>a</code>. Ideally there would be a way to easily apply <code>sFuns</code> to <code>recs</code> below to get a single record out.</p>\n\n<pre><code>applyStatFuns :: Traversable t =&gt; RecSummaryFuns r -&gt; t r -&gt; r\napplyStatFuns sFuns recs = ???\n</code></pre>\n\n<p>I'm also curious if this is the best way to model the situation: basically I'm applying summary statistics to values held in records, but I need a way to encapsulate those summary statistics for each type of record.</p>\n"}, {"tags": ["algorithm", "haskell", "data-structures"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1573886138, "post_id": 58888145, "comment_id": 104042618, "body": "Okasaki is the most famous resource on this topic at least, and from the little I&#39;ve read of it it seems deserving -- very clear and insightful."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1573886363, "post_id": 58888145, "comment_id": 104042645, "body": "Although many of the data structures in your list are quite trivial, if you just go read the source.  For the nontrivial ones, the standard documentation will usually have a link or reference to the paper that it is based on."}], "owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 755, "favorite_count": 0, "closed_date": 1573896132, "answer_count": 0, "score": 2, "last_activity_date": 1573885164, "creation_date": 1573885164, "question_id": 58888145, "link": "https://stackoverflow.com/questions/58888145/any-good-resources-on-data-structures-and-algorithms-in-haskell", "closed_reason": "Not suitable for this site", "title": "Any good resources on Data Structures and Algorithms in Haskell?", "body": "<p>Is there any one book or blog which can cover the data structures and Algorithms in Haskell with example like</p>\n\n<pre><code>------- Data Structures -------\nData.Array \nData.Bits \nData.Either \nData.Graph \nData.Graph.Inductive \nData.HashTable \nData.IntMap \nData.IntSet \nData.IORef \nData.Ix \nData.Lists \nData.Map \nData.Maybe \nData.Monoid \nData.PackedString \nData.Queue \nData.Ratio \nData.Set \nData.STRef \nData.Tree \nData.Tuple\nData.Typeable\nData.Unique\nData.Word\n-- How to generate Co-Data Structures?\n</code></pre>\n\n<pre><code>------- Algorithms -------\nRecursive.\nDynamic programming.\nBacktracking.\nDivide and conquer.\nGreedy algorithm.\nProbabilistic algorithm.\nRandomized algorithm.\n</code></pre>\n\n<p>Below are the few good resources I found on Google.</p>\n\n<p><strong>Containers</strong> - <a href=\"https://buildmedia.readthedocs.org/media/pdf/haskell-containers/latest/haskell-containers.pdf\" rel=\"nofollow noreferrer\">https://buildmedia.readthedocs.org/media/pdf/haskell-containers/latest/haskell-containers.pdf</a>.</p>\n\n<p><strong>Elementary Data Structures</strong> - <a href=\"http://static.latexstudio.net/wp-content/uploads/2017/06/elementary-algorithms.pdf\" rel=\"nofollow noreferrer\">http://static.latexstudio.net/wp-content/uploads/2017/06/elementary-algorithms.pdf</a></p>\n\n<p><strong>Chris Okasaki Purely Functional Data structures</strong> - <a href=\"https://doc.lagout.org/programmation/Functional%20Programming/Chris_Okasaki-Purely_Functional_Data_Structures-Cambridge_University_Press%281998%29.pdf\" rel=\"nofollow noreferrer\">https://doc.lagout.org/programmation/Functional%20Programming/Chris_Okasaki-Purely_Functional_Data_Structures-Cambridge_University_Press%281998%29.pdf</a></p>\n"}, {"tags": ["haskell", "matrix"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1573867122, "post_id": 58886388, "comment_id": 104040311, "body": "So what&#39;s your question? Is your code not working? If so, how? Are you getting any errors? Are you getting incorrect results? Something else?"}, {"owner": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1573867252, "post_id": 58886388, "comment_id": 104040330, "body": "Yes, if you run the code and update some coordinates, and then input others x y to update, you&#39;ll see that the previous update was lost. That&#39;s my problem, how to make the update permanent in the matrix"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "edited": false, "score": 0, "creation_date": 1573912469, "post_id": 58887348, "comment_id": 104048297, "body": "Thanks for the replay! I&#39;tried to pass the table to the function, but I don&#39;t if I&#39;m doing some stupid procedure or it really does not work that way. I create a type called   type Table = Matrix  then   inputCoordinadas :: Tabuleiro -&gt; Tabuleiro   But seems not to work"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 1, "last_activity_date": 1573875624, "creation_date": 1573875624, "answer_id": 58887348, "question_id": 58886388, "link": "https://stackoverflow.com/questions/58886388/how-to-use-the-setelem-in-haskell-to-update-the-matrix/58887348#58887348", "title": "How to use the setElem in Haskell to update the Matrix", "body": "<p>Haskell does not have mutable variables.  The simplest (least abstract) way to do this is to add a parameter to your function:</p>\n\n<pre><code>inputCoordinadas tab = do\n    ....\n    let newTab = setElem \"X\" (x,y) tab\n    inputCoordinadas newTab\n</code></pre>\n\n<p>So each time the function is called, it is called with the \"current\" table. When it calls itself, it passes an updated table.</p>\n\n<p>There are fancier ways to do this but this solution is also fine and relatively common even among those who know the fancy ways.</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "edited": false, "score": 0, "creation_date": 1573912835, "post_id": 58890271, "comment_id": 104048394, "body": "That&#39;s exactly what I wan to do. Sorry for the mistakes in the code, but I&#39;m really new with Haskell, and I&#39;m trying to get the functional paradigm thing, but I&#39;ve been in languages such C/C++ for the past years. This a project I have to delivery to university tomorrow, at least this part I think was fixed. Then I need to go with random numbers in that matrix. The final project will be a minesweeper game, a simple one. Thank you very much for the feedback!"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "edited": false, "score": 1, "creation_date": 1573915027, "post_id": 58890271, "comment_id": 104048901, "body": "For the next phase you need the <code>randomRIO</code> function like <code>randomRIO (1,n)</code> to place a mine randomly. To obtain random coordinates for <code>m</code> mines you may do like <code>zipWith (,) &lt;$&gt; (replicateM m $ randomRIO (1,n)) &lt;*&gt; (replicateM m $ randomRIO (1,n))</code> whereas <code>n</code> is the size of the board."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1573928073, "post_id": 58890271, "comment_id": 104052491, "body": "@Redu&#39;s solution might be a bit much to understand for a newbie -- there are a couple different concepts introduced at one.  But you can do it one by one like they said with <code>x &lt;- randomRIO (1,n)</code>. The tricky bit is that this is an IO action-- you use it like <code>getLine</code> rather than like <code>read</code>."}, {"owner": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "edited": false, "score": 0, "creation_date": 1573937791, "post_id": 58890271, "comment_id": 104055006, "body": "What I thought due to the time I have, is to generate 40 coordinates (40 mines) and put them into some list, and then check in it if the user input matches the coordinates of having a bomb. But now, when I put a bomb in x y I have to put a value that shows that near that coordinates have a bomb or more. If I have a bomb placed in (2,2) and the user input is 2,1, I have to show that there is a bomb  right near or a blank space, just like the minesweeper. If you can help with some advice, I&#39;d be very grateful."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "edited": false, "score": 1, "creation_date": 1573941248, "post_id": 58890271, "comment_id": 104055804, "body": "@Talles Silva It&#39;s already late here so i can only afford a hint before i sleep. By now you should know how to fill your table-game with 40 mines at random coordinates and also how you can update it with a new mine coordinate coming from the user. The beauty of immutability of the Matrix type (table-game) means that you can check the two game-tables (the one with the 40 random mines and the one obtained by user update) by the equality operator <code>(==)</code>. If they are equal then you can make sure that the player has hit a mine. If the user marks a mine-free cell you just carry on for another guess."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "edited": false, "score": 1, "creation_date": 1573941748, "post_id": 58890271, "comment_id": 104055909, "body": "@Talles Silva and yes.. i know you have to update the free-cell to <code>show</code> the number of neighboring mines but then nobody stops you from writing a function to traverse the neighbors and count the mines to be displayed. I thrust you can do it."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "edited": false, "score": 1, "creation_date": 1573942298, "post_id": 58890271, "comment_id": 104056001, "body": "@Talles Silva Keep in mind that <code>zipWith (,) &lt;$&gt; (replicateM m $ randomRIO (1,n)) &lt;*&gt; (replicateM m $ randomRIO (1,n))</code> will give you <code>m</code> many random mines but it doesn&#39;t guarantee that they won&#39;t overlap. So you will possibly end up with less than <code>m</code> mines in your table-game. This is not related with Haskell but the nature of randomness. To eliminate this fact is possible in many ways but should be just fine as it is, for starters at least."}, {"owner": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "edited": false, "score": 0, "creation_date": 1573947927, "post_id": 58890271, "comment_id": 104057135, "body": "First I generate a list for the x-axis and then for the y-axis. Then I combine then in a list of ([a,b]). I&#39;m trying to use the zipWith like you have recommended, because it sounds much better then the three functions above. But I just can&#39;t do this: let temp_list = zipWith (,) &lt;$&gt; (replicateM 40 $ randomRIO (1,20)) &lt;*&gt; (replicateM 40 $ randomRIO (1,20)), because an error arrises and I&#39;m trying to figure it out why. e M the number of mines)."}, {"owner": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "edited": false, "score": 0, "creation_date": 1573947930, "post_id": 58890271, "comment_id": 104057137, "body": "But the finally question, and I apprecitate very much for you have spent you time helping me, but how to use this coordinates in the matrix? I mean, I could use the setElem to place the bombs, but even I get the random coordinates for the zipWith, it&#39;s a list and I have to extract the pair (x,y) to pass it in the setElem in a recursive way (lik"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "edited": false, "score": 0, "creation_date": 1575217423, "post_id": 58890271, "comment_id": 104483233, "body": "@Talles Silva Fill your board with <code>m</code> <b>unique</b> mines as follows. <code>(,) &lt;$&gt; [1..n] &lt;*&gt; [1..n]</code>. This code will give you a list of all coordinates on your board like <code>[(1,1),(1,2)..(1,n),(2,1),(2,2)..(2,n)..(n,1),(n,2)..(n,n)]</code>. Now all coordinates are unique but they are useless since they are in order. Now <a href=\"https://codereview.stackexchange.com/q/232894/105433\">shuffle</a> this list and <code>take m</code> many coordinates from the list. <code>\\n m -&gt; take m . shuffle $ ((,) &lt;$&gt; [1..n] &lt;*&gt; [1..n])</code>. Now you have your perfecty random <code>m</code> many bomb coordinates. Use above code to insert the bombs in your board."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": true, "score": 1, "last_activity_date": 1573913916, "last_edit_date": 1573913916, "creation_date": 1573903945, "answer_id": 58890271, "question_id": 58886388, "link": "https://stackoverflow.com/questions/58886388/how-to-use-the-setelem-in-haskell-to-update-the-matrix/58890271#58890271", "title": "How to use the setElem in Haskell to update the Matrix", "body": "<p>Haskell uses pure functions. Pure functions can not modify anything out of their context and prevent side effects. What you are trying is a sin in Haskell. Setting a global variable and trying to mutate it is a no no.</p>\n\n<p>You are basically expected to structure your code such that the <code>inputCoordenadas</code> function takes a table-game (<code>tg</code> in my code below), prints it, modifies it and returns a new table-game. With minimal change your code should be like</p>\n\n<pre><code>import Data.Matrix\nimport System.Random\nimport System.IO \nimport Data.Array\n\ninputCoordenadas tg = do\n    print tg\n    putStrLn \"Digite -1 -1 para encerrar: \"\n    putStrLn \"Digite a coordenada X: \"\n    coord_x &lt;- getLine\n    putStrLn \"Digite a coordenada Y: \"\n    coord_y &lt;- getLine\n    let x = (read coord_x :: Int)\n    let y = (read coord_y :: Int)\n    if(coord_x == \"-1\"  &amp;&amp; coord_y==\"-1\") then putStrLn \"Encerrando o jogo...\"\n                                          else inputCoordenadas $ setElem \"X\" (x,y) tg\n\nmain = do\n    putStrLn \"Iniciar jogo|1 - Encerrar jogo|0: \"\n    buffer &lt;- getLine\n    let n = (read buffer :: Int)\n    if n==0 then  putStrLn \"Encerrando o jogo\"\n            else  inputCoordenadas $ matrix n n (\\(i,j) -&gt; \"#\")\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5647449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FH7Xqjv132s/AAAAAAAAAAI/AAAAAAAABUY/boNLpBftdeA/photo.jpg?sz=128", "display_name": "Talles Silva", "link": "https://stackoverflow.com/users/5647449/talles-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 58890271, "answer_count": 2, "score": 2, "last_activity_date": 1573913916, "creation_date": 1573864186, "question_id": 58886388, "link": "https://stackoverflow.com/questions/58886388/how-to-use-the-setelem-in-haskell-to-update-the-matrix", "title": "How to use the setElem in Haskell to update the Matrix", "body": "<p>I'm trying to use the function setElem in Haskell to update the Matrix, but seems the new value does not stay in the matrix. Is there a way to use this function to go around this problem?</p>\n\n<p>I'm new with Haskell and what I need is to set a new value in the matrix and then show the matrix updated.</p>\n\n<p>setElem :: a -> (Int, Int) -> Matrix a -> Matrix a</p>\n\n<p>My code:</p>\n\n<pre><code>import Data.Matrix\nimport System.Random\nimport System.IO \nimport Data.Array\n\n\n\ntable_game = matrix 20 20 $ \\(i,j)-&gt; \"#\"\n\n\ninputCoordenadas = do       \n            putStrLn \"Digite -1 -1 para encerrar: \"\n            putStrLn \"Digite a coordenada X: \"\n            coord_x &lt;- getLine\n            putStrLn \"Digite a coordenada Y: \"\n            coord_y &lt;- getLine\n            let x = (read coord_x :: Int)\n            let y = (read coord_y :: Int)\n            if(coord_x == \"-1\"  &amp;&amp; coord_y==\"-1\") then do \n                putStrLn (\"Encerrando o jogo...\")\n                return ()\n            else do \n                print $ setElem \"X\" (2,2) table_game\n                print table_game\n                inputCoordenadas\n\n\nmain = do   \n    putStrLn \"Iniciar jogo|1 - Encerrar jogo|0: \"\n    buffer &lt;- getLine\n    let n = (read buffer :: Int)    \n\n\nif n==0 then do \n        putStrLn \"Encerrando o jogo\"\n        return ()\n else do\n    print table_game\n    inputCoordenadas\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1573862661, "creation_date": 1573862661, "answer_id": 58886224, "question_id": 58886200, "link": "https://stackoverflow.com/questions/58886200/how-can-i-make-a-type-that-can-be-either-a-string-or-an-integer/58886224#58886224", "title": "How can I make a type that can be either a String or an Integer?", "body": "<p>Sum types must be <em>tagged</em> unions. In Haskell, the tags are simultaneously <em>data constructors</em>.</p>\n\n<pre><code>data PostfixToken = Operator String | Operand Integer\n\nfoo :: Bool -&gt; PostfixToken\nfoo x = Operand 3\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 3051324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2993bd7408c1ecd07b65fea2069f82b6?s=128&d=identicon&r=PG&f=1", "display_name": "echelon315", "link": "https://stackoverflow.com/users/3051324/echelon315"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1573863050, "accepted_answer_id": 58886224, "answer_count": 1, "score": 0, "last_activity_date": 1573863041, "creation_date": 1573862318, "last_edit_date": 1573863041, "question_id": 58886200, "link": "https://stackoverflow.com/questions/58886200/how-can-i-make-a-type-that-can-be-either-a-string-or-an-integer", "closed_reason": "Duplicate", "title": "How can I make a type that can be either a String or an Integer?", "body": "<p>I'm trying to make a type that can represent either an operator (\"+\", \"-\", \"*\", ...) or operand (1, 2, 3, 4 ...) for a postfix expression calculator.</p>\n\n<p>I tried writing:</p>\n\n<pre><code>data PostfixToken = String | Integer\n</code></pre>\n\n<p>But then say I have a dummy function like this:</p>\n\n<pre><code>foo :: Bool -&gt; PostfixToken\nfoo x = 3 :: Integer\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>Couldn't match type \u2018Integer\u2019 with \u2018PostfixToken\u2019\n</code></pre>\n\n<p>Why can't it match Integer with PostfixToken, though I explicitly defined the type as such? What would be the proper way of doing this?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1573862584, "creation_date": 1573862584, "answer_id": 58886219, "question_id": 58886199, "link": "https://stackoverflow.com/questions/58886199/haskell-generating-a-list-of-tuples-0-x-0-y/58886219#58886219", "title": "Haskell: Generating a list of tuples (0..x, 0..y)", "body": "<p>A list is an instance of <code>Applicative</code>, and the sequential application acts as taking each function in the left list, each item in the right list, and yield the function applied to that item. We can generate such list with:</p>\n\n<pre><code>(,) <b>&lt;$&gt;</b> [0 .. 2] <b>&lt;*&gt;</b> [ 0 .. 2 ]</code></pre>\n\n<p>or with <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#v:liftA2\" rel=\"noreferrer\"><strong><code>liftA2 :: Applicative f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c</code></strong></a>:</p>\n\n<pre><code>import Control.Applicative(<b>liftA2</b>)\n\nresult = <b>liftA2</b> (,) [0 .. 2] [0 .. 2]</code></pre>\n\n<p>or we can make use of <em>list comprehension</em>:</p>\n\n<pre><code>result = [ (x, y) | x &lt;- [0 .. 2], y &lt;- [0 .. 2] ]</code></pre>\n"}, {"tags": [], "owner": {"reputation": 665, "user_id": 10610632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb8dce0aefdec2cde25c0a79c32739?s=128&d=identicon&r=PG&f=1", "display_name": "RoyM", "link": "https://stackoverflow.com/users/10610632/roym"}, "is_accepted": false, "score": 3, "last_activity_date": 1573863030, "creation_date": 1573863030, "answer_id": 58886260, "question_id": 58886199, "link": "https://stackoverflow.com/questions/58886199/haskell-generating-a-list-of-tuples-0-x-0-y/58886260#58886260", "title": "Haskell: Generating a list of tuples (0..x, 0..y)", "body": "<pre><code>foo a b = [(x, y) | x &lt;- [0..a], y &lt;- [0..b]]\n\nPrelude&gt; foo 2 2\n</code></pre>\n\n<blockquote>\n  <p>Out: [(0,0),(0,1),(0,2),(1,0),(1,1),(1,2),(2,0),(2,1),(2,2)]</p>\n</blockquote>\n"}], "owner": {"reputation": 27, "user_id": 10669031, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CCU1-MGYJfY/AAAAAAAAAAI/AAAAAAAAABM/OS_hVj8bt3M/photo.jpg?sz=128", "display_name": "Melon_ The_Great", "link": "https://stackoverflow.com/users/10669031/melon-the-great"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1573863030, "creation_date": 1573862317, "question_id": 58886199, "link": "https://stackoverflow.com/questions/58886199/haskell-generating-a-list-of-tuples-0-x-0-y", "title": "Haskell: Generating a list of tuples (0..x, 0..y)", "body": "<p>I'm trying to generate a list containing <code>[(0,0),..,(x-1,y-1)]</code> only given x and y.</p>\n\n<p>The tuples are used to represent cells in a field of size (x,y).\ne.g. (3,3) must return a list <code>[(0,0),(0,1),(0,2),(1,0),(1,1),(1,2),(2,0),(2,1),(2,2)]</code></p>\n\n<p>I tried <code>[(0,0)...(3,3)]</code> because I really don't know how to do this in Haskell.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1573860891, "post_id": 58886002, "comment_id": 104039103, "body": "Why not make it a list <code>Author [Book] Birth</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573862804, "post_id": 58886123, "comment_id": 104039563, "body": "But this (the nested pattern matching) does get pretty unwieldy as you add more levels of nesting, which is one of the main reasons <a href=\"https://github.com/ekmett/lens/wiki/Overview\" rel=\"nofollow noreferrer\">Lens</a> exists."}, {"owner": {"reputation": 47, "user_id": 12209662, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa9GXoGKFuZNsdDoUpFdfzSQtMrrRNv7J4MiJ9=k-s128", "display_name": "G TTT", "link": "https://stackoverflow.com/users/12209662/g-ttt"}, "edited": false, "score": 0, "creation_date": 1574167991, "post_id": 58886123, "comment_id": 104127978, "body": "Thank you so much for replying. Basically authors have three book exactly saying in  the assignment. I was also wondering if there is a way to iterate over a single tuple with 3 elements?"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 3, "last_activity_date": 1573861631, "creation_date": 1573861631, "answer_id": 58886123, "question_id": 58886002, "link": "https://stackoverflow.com/questions/58886002/iterating-over-a-custom-type-and-access-the-property-inside-in-haskell/58886123#58886123", "title": "Iterating over a custom type and access the property inside in haskell", "body": "<p>Q1: You can get all three books at the same time by pattern matching, and then return them as a list:</p>\n\n<pre><code>books :: Author -&gt; [Book]\nbooks (Author a b c _) = [a, b, c]\n</code></pre>\n\n<p>But are you sure you want to define your <code>Author</code> like that? What if an author has two books or four? Such author wouldn't fit your definition, would it?</p>\n\n<p>As @WillemVanOnsem pointed out in the comments, a more robust definition would be to make <code>Author</code> contain a list of <code>Book</code> instead of three books separately:</p>\n\n<pre><code>data Author = Author [Book] Birth\n</code></pre>\n\n<hr>\n\n<p>Q2: You can compose the two functions you have:</p>\n\n<pre><code>authorBDay :: Author -&gt; Int\nauthorBDay = bDay . birth\n</code></pre>\n\n<p>Or, alternatively, you can pattern match directly:</p>\n\n<pre><code>authorBDay :: Author -&gt; Int\nauthorBDay (Author _ _ _ (_,_,d)) = d\n</code></pre>\n\n<p>Patterns can be nested. That's their primary point.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 12209662, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa9GXoGKFuZNsdDoUpFdfzSQtMrrRNv7J4MiJ9=k-s128", "display_name": "G TTT", "link": "https://stackoverflow.com/users/12209662/g-ttt"}, "edited": false, "score": 0, "creation_date": 1574167895, "post_id": 58886135, "comment_id": 104127923, "body": "Thank you so much for replying. The answer is really clear. I am also wondering if there is a way to do recursion in a single tupe with 3 elements, since I can only find questions about recursion on a list of tuples."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 47, "user_id": 12209662, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa9GXoGKFuZNsdDoUpFdfzSQtMrrRNv7J4MiJ9=k-s128", "display_name": "G TTT", "link": "https://stackoverflow.com/users/12209662/g-ttt"}, "edited": false, "score": 0, "creation_date": 1574168103, "post_id": 58886135, "comment_id": 104128047, "body": "@GTTT: yes, by making use of the <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\"><code>lens</code> library</a> for example. But it is a bit &quot;overwhelming&quot;, with something like <code>toListOf each</code>."}, {"owner": {"reputation": 47, "user_id": 12209662, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa9GXoGKFuZNsdDoUpFdfzSQtMrrRNv7J4MiJ9=k-s128", "display_name": "G TTT", "link": "https://stackoverflow.com/users/12209662/g-ttt"}, "edited": false, "score": 0, "creation_date": 1574168386, "post_id": 58886135, "comment_id": 104128193, "body": "That\u2019s fine, I\u2019ll check both documents. Thanks a lot."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1573861711, "creation_date": 1573861711, "answer_id": 58886135, "question_id": 58886002, "link": "https://stackoverflow.com/questions/58886002/iterating-over-a-custom-type-and-access-the-property-inside-in-haskell/58886135#58886135", "title": "Iterating over a custom type and access the property inside in haskell", "body": "<blockquote>\n  <p>I was thinking that (<strong>Q1</strong>) if there is a way to iterate over the property inside <code>Author</code> (&hellip;)</p>\n</blockquote>\n\n<p>Although you can do that with <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Data.html\" rel=\"nofollow noreferrer\"><strong><code>Data</code></strong></a>, it here looks a bit overkill. You can here simply match the tree books, and return these in a list:</p>\n\n<pre><code>BookA :: Author -&gt; <b>[</b>Book<b>]</b>\nBookA (Author bkA bkB bkC _) = <b>[</b>bkA, bkB, bkC<b>]</b></code></pre>\n\n<p>Here it makes more sense however to define a <em>list</em> of <code>Book</code>s for an <code>Author</code>, since now you basically say that each <code>Author</code> has written <em>exactly</em> three books. By making a list, an <code>Author</code> can have written, zero, one, or more books:</p>\n\n<pre><code>data Author = Author <b>[Book]</b> Birth</code></pre>\n\n<p>You can even use records syntax, and let Haskell write the getters for you:</p>\n\n<pre><code>data Author = Author <b>{</b> booksA :: [Book]<b>,</b> birth :: Birth <b>}</b></code></pre>\n\n<blockquote>\n  <p>Also, (<strong>Q2</strong>) how can I get the BirthDay in a single function insdead of these  (&hellip;)</p>\n</blockquote>\n\n<p>You can use nested patterns, like:</p>\n\n<pre><code>bday :: Author -&gt; Birth\nbdayA (Author _ _ _ <b>(_, _, bd)</b>) = bd</code></pre>\n\n<p>But often in Haskell one makes small <em>reusable</em> functions that can be combined. If you thus define <code>birth</code> and <code>bDay</code>, like you did, you can define the birthday of an <code>Author</code> with:</p>\n\n<pre><code>birth :: Author -&gt; Birth\nbirth (Author _ _ _ birth) = birth\n\nbDay :: Birth -&gt; Int\nbDay (_,_,bDay) = bDay\n\nbDayA :: Author -&gt; Int\nbDayA = <b>bDay . birth</b></code></pre>\n"}], "owner": {"reputation": 47, "user_id": 12209662, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa9GXoGKFuZNsdDoUpFdfzSQtMrrRNv7J4MiJ9=k-s128", "display_name": "G TTT", "link": "https://stackoverflow.com/users/12209662/g-ttt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 58886135, "answer_count": 2, "score": 1, "last_activity_date": 1573861711, "creation_date": 1573860611, "question_id": 58886002, "link": "https://stackoverflow.com/questions/58886002/iterating-over-a-custom-type-and-access-the-property-inside-in-haskell", "title": "Iterating over a custom type and access the property inside in haskell", "body": "<p>I have custom type below:</p>\n\n<pre><code>-- (Int,Int,Int) = (Year, Month, Day)\ntype Birth = (Int, Int, Int)\ntype Book = String\ndata Author = Author Book Book Book Birth\n</code></pre>\n\n<p>I was thinking that <strong>(Q1)</strong> if there is a way to iterate over the property inside Author, which means a function \n<code>fun</code> applied to a <code>Author</code> type will return <code>Book</code> values separately. I have thought using </p>\n\n<pre><code>BookA :: Author -&gt; Book\nBookA (Author bkA _ _ _) = bkA\n</code></pre>\n\n<p>or <code>case...of</code>statement to get all three books separately, but it is too redundant. Is there a way iterately or recursively?</p>\n\n<p>Also, <strong>(Q2)</strong> how can I get the BirthDay in a single function insdead of these:</p>\n\n<pre><code>birth :: Author -&gt; Birth\nbirth (Author _ _ _ birth) = birth\n\nbDay :: Birth -&gt; Int\nbDay (_,_,bDay) = bDay\n</code></pre>\n\n<p>Thank you guys so much.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573859355, "post_id": 58885829, "comment_id": 104038747, "body": "Just like the data types and functions, a type constructor has one parameter."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573859692, "post_id": 58885829, "comment_id": 104038835, "body": "Is there a type-level version of <code>curry</code>/<code>uncurry</code>, then? Oh, and <code>flip</code>"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 1, "last_activity_date": 1573863793, "creation_date": 1573863793, "answer_id": 58886360, "question_id": 58885829, "link": "https://stackoverflow.com/questions/58885829/given-an-n-arg-type-constructor-what-are-some-ways-to-reduce-the-number-of-argu/58886360#58886360", "title": "Given an n-arg type constructor, what are some ways to reduce the number of arguments?", "body": "<p>Things don't always translate directly. In particular, you have to decide what you want to be first-class and what can be second-class.</p>\n\n<pre><code>-- You can do this, but it must always\n-- be fully applied.\ntype FlipF f a b = f b a\n\n-- This is more exciting, as it can\n-- be partially applied.\nnewtype Flip f a b = Flip {unFlip :: f b a}\n</code></pre>\n\n<p>Now</p>\n\n<pre><code>Either a b = FlipF Either b a\nEither a b ~= Flip Either b a\n</code></pre>\n\n<p>Currying you have multiple options too.</p>\n\n<pre><code>type CurryF f a b = f '(a, b)\nnewtype Curry f a b = Curry {unCurry :: f '(a, b)}\n</code></pre>\n\n<p>Uncurrying is a bit trickier.</p>\n\n<pre><code>type family UncurryF f ab where\n  UncurryF f '(a, b) = f a b\n\ndata Uncurry1 f ab where\n  Uncurry1 :: f a b -&gt; f '(a, b)\n\nnewtype Uncurry2 f ab = Uncurry2\n  {reCurry2 :: f (Fst ab) (Snd ab)}\n\ntype family Fst ab where\n  Fst '(a, _) = a\ntype family Snd ab where\n  Snd '(_, b) = b\n</code></pre>\n\n<p>Which uncurry you need will be somewhat application dependent.</p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 58886360, "answer_count": 1, "score": 0, "last_activity_date": 1573863793, "creation_date": 1573859292, "question_id": 58885829, "link": "https://stackoverflow.com/questions/58885829/given-an-n-arg-type-constructor-what-are-some-ways-to-reduce-the-number-of-argu", "title": "Given an n-arg type constructor, what are some ways to reduce the number of arguments?", "body": "<p>For instance, for <code>Either</code>, there are two arguments <code>L</code> and <code>R</code>.</p>\n\n<p>What would be several ways of constructing both of the single-parameter type constructors from Either: <code>Either L</code> and (pseudo code) <code>Either _ R</code>?</p>\n\n<p>One way, I suppose, is to declare a type alias:</p>\n\n<pre><code>type EitherL L = Either L R -- for some fixed R\n</code></pre>\n\n<p>But are there ways to do this inline without needing to construct type aliases?</p>\n"}, {"tags": ["haskell", "monads", "functor"], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 0, "last_activity_date": 1573861052, "creation_date": 1573861052, "answer_id": 58886060, "question_id": 58885484, "link": "https://stackoverflow.com/questions/58885484/in-haskell-how-to-bind-one-list-like-monad-to-another-list-like-monad/58886060#58886060", "title": "In Haskell, how to bind one list-like monad to another list-like monad", "body": "<p>If you want to be very general about the monad in which your nodes and edges are stored, you can't really do anything. Two monads in general <a href=\"https://stackoverflow.com/a/7042674/625403\">do not compose</a> with each other: what should the return type be if nodes are \"stored\" as <code>IO String</code> and edges as <code>String -&gt; Maybe String</code>?</p>\n\n<p>I would suggest doing a lot less of this work at the type level. There is little need for type classes: instead, define a concrete type that contains the functions that you need, and a single typeclass for converting to that canonical type. Then the various implementations of your graph type can simply create a \"canonical view\" of their graph, representing it in the type that you use to implement generic algorithms. This way, you have only one canonical representation to perform these algorithms on, despite having many representations for the graphs themselves.</p>\n\n<p>The graph type can be as simple as</p>\n\n<pre><code>data Graph v e = Graph { nodes :: [v]\n                       , edges :: v -&gt; [e]\n                       }\n\nclass AsGraph t v e where\n  asGraph :: t v e -&gt; Graph v e\n</code></pre>\n\n<p>and you can implement <code>allEdges</code> generically in terms of that quite easily. If you have a graph with vector edges, it can be converted to this generic graph type in order to participate in generic operations like <code>allEdges</code>:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n\nimport Data.Foldable (toList)\n\ndata Graph v e = Graph { nodes :: [v]\n                       , edges :: v -&gt; [e]\n                       }\n\nclass AsGraph t v e where\n  asGraph :: t v e -&gt; Graph v e\n\ndata VectorEdges v e = VectorEdges { vs :: [v]\n                                   , es :: v -&gt; Vector e\n                                   }\n\ninstance AsGraph VectorEdges v e where\n  asGraph g = Graph (vs g) (toList . es g)\n\nallEdges :: AsGraph t v e =&gt; t v e -&gt; [e]\nallEdges g = let g' = asGraph g\n  in nodes g' &gt;&gt;= edges g'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "is_accepted": true, "score": 0, "last_activity_date": 1574023634, "creation_date": 1574023634, "answer_id": 58905056, "question_id": 58885484, "link": "https://stackoverflow.com/questions/58885484/in-haskell-how-to-bind-one-list-like-monad-to-another-list-like-monad/58905056#58905056", "title": "In Haskell, how to bind one list-like monad to another list-like monad", "body": "<p>There does not seem to be something standard in Haskell to achieve my purpose, so I ended up adding a class specific for list conversion leaving me room to implement it for what I believe should be convertable lists.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Convert_List list1 list2 element where\n    convert_list :: list1 element -&gt; list2 element\n</code></pre>\n\n<p>Then I am free to implement it on my own.</p>\n\n<p>The advantage of having such a class is that you can then write the graph operation like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class List_Nodes graph list vertex where\n    list_nodes :: graph -&gt; list vertex\nclass List_Edges_From graph vertex list edge where\n    list_edges_from :: graph -&gt; vertex -&gt; list edge\n\nclass List_Edges graph vertex list edge where\n    list_edges :: graph -&gt; list edge\ninstance (\n    Monad list,\n    List_Nodes graph l1 vertex,\n    List_Edges_From graph vertex l2 edge,\n    Convert_List l1 list vertex,\n    Convert_List l2 list edge \n    ) =&gt; List_Edges graph vertex list edge where\n    list_edges graph = \n        convert_list (list_nodes graph :: l1 vertex) &gt;&gt;= \\u -&gt; \n            convert_list (list_edges_from graph u :: l2 edge)\n</code></pre>\n\n<p>Here you see that I implement <code>list_edge</code> in an very general way making few assumptions, i'm not even assuming the return list has to be the same as the graph internal representation.</p>\n\n<p>This is also why I splitted each operation in its own class. Although this may seem counterintuitive at first I believe that there is more potential for factorization as shown here. If I had only one class containing the 3 operations, I could not implement only <code>list_edges</code> without enforcing constraints on the other operations as well.\nIt's only my opinion, but I believe more and more this sort of approach for code design has more potential for factoring.</p>\n"}], "owner": {"reputation": 743, "user_id": 7058336, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ab015fdc364a6f1fc3c17e888495568?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/7058336/jam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 58905056, "answer_count": 2, "score": 2, "last_activity_date": 1574023634, "creation_date": 1573856837, "last_edit_date": 1573857283, "question_id": 58885484, "link": "https://stackoverflow.com/questions/58885484/in-haskell-how-to-bind-one-list-like-monad-to-another-list-like-monad", "title": "In Haskell, how to bind one list-like monad to another list-like monad", "body": "<p>Say you want to implement very general operations on a directed graph making as few assumptions about the structure as possible.</p>\n\n<p>It is impossible to make absolutely no assumptions, so I am still assuming that I will represent my graph as some sort of adjacency list, but the spirit is to try to be as opaque as possible about the nature of manipulated things.</p>\n\n<p>Assume you have the two following operations: one operation to list all nodes in a graph, and one operation to list all outgoing edges from some vertex.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class List_Nodes graph list vertex where\n    list_nodes :: graph -&gt; list vertex\nclass List_Edges_From graph vertex list edge where\n    list_edges_from :: graph -&gt; vertex -&gt; list edge\n</code></pre>\n\n<p>Then, just for the fun of it I decided I might want want to iterate over all edges</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class List_Edges graph vertex list edge where\n    list_edges :: graph -&gt; list edge\n</code></pre>\n\n<p>No matter what the concrete implementation of a graph will be, I believe I can express very generally that listing edges can be understood as listing nodes, and listing edges from each of them.\nSo I decided to write an instance as general as possible like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance (\n    Monad node_list,\n    Monad edge_list,\n    List_Nodes graph node_list vertex,\n    List_Edges_From graph vertex edge_list edge\n    ) =&gt; List_Edges graph vertex edge_list edge where\n    list_edges graph = (list_nodes graph :: node_list vertex) &gt;&gt;= list_edges_from graph\n-- I added  :: node_list vertex  to help GHC infer the type.\n</code></pre>\n\n<p>However, this code does not work as is. This code works only with an additional instance requirement that <code>edge_list ~ node_list,</code>. That's because binding happens only in one monad, the returned one: <code>edge_list</code>.</p>\n\n<p>But to be as general as possible I do not want to assume that the way I store nodes, is necessarily the same way I store outgoing edges in a node. For example one might want to use a list to store nodes, and a vector to store edges out of a node.</p>\n\n<p><strong>Question:</strong>\n<strong>How can I express the monadic bind  <code>list_nodes graph &gt;&gt;= list_edges_from graph</code> between two possibly different list like containers?</strong></p>\n\n<p>More generally, how can I say convert a list to a vector without being specific about them? I am only assuming they are \"list-like\" whatever that means. Somehow these list like things are themselves functors, so I'm looking to convert some functor into some other functor. Am I looking for natural transformations of category theory? How can I do this in Haskell?</p>\n\n<p>Language extensions used and imports used:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE AllowAmbiguousTypes #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE ScopedTypeVariables #-}\nmodule Lib () where\nimport Prelude\nimport Control.Monad\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 5, "creation_date": 1573855693, "post_id": 58885302, "comment_id": 104037769, "body": "I&#39;m not totally clear what you&#39;re trying to do, but the error seems clear enough: your constructor needs to return something of the form <code>TraversableFun t a</code> for two concrete types <code>t</code> and <code>a</code>. Perhaps you mean it to return a <code>TraversableFun (t a -&gt; a) a</code> (or, I would have thought, just a <code>TraversableFun t a</code>. I&#39;m not sure what you gain in that case by using GADTs though)."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 2, "creation_date": 1573856533, "post_id": 58885302, "comment_id": 104037961, "body": "@RobertZigmond By using a GADT one would gain the <code>Traversable t</code> constraint"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1573856980, "post_id": 58885302, "comment_id": 104038089, "body": "@FyodorSoikin - thanks, I&#39;d missed that important point"}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573858885, "post_id": 58885302, "comment_id": 104038620, "body": "@RobinZigmond, yes, I needed to return a <code>TraversableFun t a</code>. No more programming for me today."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 1, "last_activity_date": 1574057372, "creation_date": 1574057372, "answer_id": 58908842, "question_id": 58885302, "link": "https://stackoverflow.com/questions/58885302/how-to-create-a-data-or-preferabbly-newtype-wrapper-for-a-constrained-function/58908842#58908842", "title": "How to create a data (or preferabbly newtype) wrapper for a constrained function?", "body": "<p>As @RobinZigmond pointed out in the comments, you've defined <code>TraversableFun</code> as a type constructor with two parameters.  So, <code>TraversableFun (t a -&gt; a)</code> doesn't have enough parameters to be a proper type that you can use as a result type for the <code>TraversableFun</code> constructor.  It's as if you've written <code>myFunction :: Int -&gt; Either String</code> -- there's no such type as <code>Either String</code>, so it can't be a return type of a function.</p>\n\n<p>If <code>TraversableFun</code> is just supposed to be a wrapper around <code>t a -&gt; a</code>, then you probably just want <code>Traversable t a</code>.  The idea is that the constructor <code>TraverableFun</code> takes a function of type <code>t a -&gt; a</code> and returns a wrapped value of the type <code>TraversableFun t a</code>.  So, quite literally:</p>\n\n<pre><code>TraversableFun :: Traversable t =&gt; (t a -&gt; a) -&gt; TraversableFun t a\n</code></pre>\n\n<p>However, there's probably no advantage to writing this as a GADT versus just using a newtype:</p>\n\n<pre><code>newtype TraverableFun t a = TraversableFun (t a -&gt; a)\n</code></pre>\n\n<p>which is literally the same as the GADT:</p>\n\n<pre><code>newtype TraversableFun t a where\n  TraversableFun :: (t a -&gt; a) -&gt; TraversableFun t a\n</code></pre>\n\n<p>While this newtype doesn't enforce a <code>Traversable t</code> constraint, it's generally agreed that functions should enforce constraints, not data types.  (If your GADT had multiple constructors with different constraints enforced by different constructors, then that would potentially be a different.)</p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58908842, "answer_count": 1, "score": 1, "last_activity_date": 1574057372, "creation_date": 1573855495, "question_id": 58885302, "link": "https://stackoverflow.com/questions/58885302/how-to-create-a-data-or-preferabbly-newtype-wrapper-for-a-constrained-function", "title": "How to create a data (or preferabbly newtype) wrapper for a constrained function?", "body": "<p>I'd like to create a type that holds a particular class of functions. Hopefully this is the right way to go about it (maybe <code>newtype</code> would be better? but I'm using GADTs):</p>\n\n<pre><code>data TraversableFun t a where\n  TraversableFun :: Traversable t =&gt; (t a -&gt; a) -&gt; TraversableFun (t a -&gt; a)\n</code></pre>\n\n<p>This results in the error:</p>\n\n<pre><code>    \u2022 Expecting one more argument to \u2018TraversableFun (t a -&gt; a)\u2019\n      Expected a type, but \u2018TraversableFun (t a -&gt; a)\u2019 has kind \u2018k0 -&gt; *\u2019\n    \u2022 In the type \u2018TraversableFun (t a -&gt; a)\u2019\n      In the definition of data constructor \u2018TraversableFun\u2019\n      In the data declaration for \u2018TraversableFun\u2019\n   |\n55 |   TraversableFun :: Traversable t =&gt; (t a -&gt; a) -&gt; TraversableFun (t a -&gt; a)\n   |                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I'm pretty sure I'm doing something similar here, maybe I should just sleep on it, but it's 5 PM on a Friday.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 488, "user_id": 3265362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXfiq.jpg?s=128&g=1", "display_name": "nader.h", "link": "https://stackoverflow.com/users/3265362/nader-h"}, "edited": false, "score": 1, "creation_date": 1573834399, "post_id": 58880839, "comment_id": 104028867, "body": "i think that you cannot constraint <code>Int a</code> as <code>Int</code> has kind <code>*</code>"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 4, "creation_date": 1573834444, "post_id": 58880839, "comment_id": 104028891, "body": "The error message is correct. To define a value like that in a <code>do</code> block, you need to use <code>let</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1573834480, "post_id": 58880839, "comment_id": 104028917, "body": "The <code>Int</code> typeclass does not exist (well at least not in the <code>base</code>). Furthermore in the <code>do</code> you can not define functions like that. You then would need a <code>let</code>."}, {"owner": {"reputation": 1334, "user_id": 1447456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/606d9f69e64fa4eddea4bada8802f7f2?s=128&d=identicon&r=PG", "display_name": "Francisco Albert", "link": "https://stackoverflow.com/users/1447456/francisco-albert"}, "edited": false, "score": 0, "creation_date": 1573834562, "post_id": 58880839, "comment_id": 104028954, "body": "Oh god, in just 3 lines I see I have multiple bad things..thanks guys, I will focus on all those feedbacks"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1573835979, "creation_date": 1573835979, "answer_id": 58881279, "question_id": 58880839, "link": "https://stackoverflow.com/questions/58880839/haskell-why-is-failing-with-equals-symbols/58881279#58881279", "title": "Haskell: why is failing with equals symbols?", "body": "<p>To define a function with a signature in a <code>do</code>-block, you need to put <em>both</em> its signature and its definition inside the same <code>let</code>. Indentation matters. For instance,</p>\n\n<pre><code>example = do\n   something1\n   something2\n   let mysum :: Num a =&gt; a -&gt; a\n       mysum x = x + 1  -- same indentation as \"mysum\" above\n   something3  -- we can use mysum here\n   something4\n</code></pre>\n\n<p>Concretely:</p>\n\n<pre><code>describe \"functions\" $ do\n    it \"can create a function\" $ do\n       let mysum :: Num a =&gt; a -&gt; a\n           mysum x = x + 1\n       mysum 5 `shouldBe` (6 :: Int)\n</code></pre>\n\n<p>The above declares a polymorphic <code>mysum</code>, as you tried to do. If we instead define a more basic <code>mysum :: Int -&gt; Int</code>, we do not need to specify that <code>6</code> is an <code>Int</code> in the very last line, since that's already deduced.</p>\n"}], "owner": {"reputation": 1334, "user_id": 1447456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/606d9f69e64fa4eddea4bada8802f7f2?s=128&d=identicon&r=PG", "display_name": "Francisco Albert", "link": "https://stackoverflow.com/users/1447456/francisco-albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 58881279, "answer_count": 1, "score": 2, "last_activity_date": 1573835979, "creation_date": 1573834279, "last_edit_date": 1573835946, "question_id": 58880839, "link": "https://stackoverflow.com/questions/58880839/haskell-why-is-failing-with-equals-symbols", "title": "Haskell: why is failing with equals symbols?", "body": "<p>I'm having an issue that is frustrating me a bit. I have the next really simple code:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>describe \"functions\" $ do\n    it \"can create a function\" $ do\n       mysum :: a -&gt; a\n       let mysum x = x + 1\n\n       mysum 5\n</code></pre>\n\n<p>But is not compiling, the error I'm having is:</p>\n\n<pre><code>    error: Variable not in scope: mysum :: a -&gt; a\n   |        \n15 |        mysum ::  a -&gt; a\n\n\n</code></pre>\n\n<p>From the books I'm reading seems everything fine to me, and in internet seems that shouldn't fail my code, am I missing something?</p>\n\n<p>Also I tried more alternatives:</p>\n\n<pre><code>       let b = mysum :: a -&gt; a\n       let b x = x + 1\n\n       b 5\n</code></pre>\n\n<p>And </p>\n\n<pre><code>       let b = a -&gt; a\n       let b x = x + 1\n\n       b 5\n</code></pre>\n\n<p>But in all of them I have errors</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1573833514, "post_id": 58880459, "comment_id": 104028340, "body": "Don&#39;t worry about doing anything fancy at first; try implementing the naive solution first: write one function to find the largest <code>Double</code> value among all the tuples, then write another function that collects all the tuples containing that value. Once you&#39;ve done that, you may find it easier to write a function that can collect the necessary list of tuples in one pass."}], "answers": [{"tags": [], "owner": {"reputation": 188, "user_id": 6663599, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/48hZz.jpg?s=128&g=1", "display_name": "Jude Molloy", "link": "https://stackoverflow.com/users/6663599/jude-molloy"}, "is_accepted": false, "score": 1, "last_activity_date": 1573845430, "last_edit_date": 1573845430, "creation_date": 1573841955, "answer_id": 58882641, "question_id": 58880459, "link": "https://stackoverflow.com/questions/58880459/comparing-list-of-tuples/58882641#58882641", "title": "Comparing list of tuples", "body": "<p>You must first sort the list by the value for each tuple. This value can be accessed using the <code>snd</code> function</p>\n\n<p>Use the sortBy function which can be imported from <code>Data.List</code> and the comparing function which can be imported from <code>Data.Ord</code> to sort the list by the value for each tuple.</p>\n\n<p>The following code will work.</p>\n\n<pre><code>import Data.List\nimport Data.Ord\n\nfindMax :: Eq a1 =&gt; Ord a1 =&gt; [(a0, a1)]  -&gt; [(a0, a1)] \nfindMax list = [x | x &lt;- sorted, (snd x) == (snd (head sorted))]\n    where sorted = reverse $ sortBy (comparing snd) list\n</code></pre>\n\n<p>Running this code in GHCI we get the desired result.</p>\n\n<pre><code>*Main&gt; let test = [(\"Example1\", 10.0), (\"Example2\", 20.0), (\"Example3\", 30.0), (\"Example4\", 15.0), (\"Example5\", 30.0)]\n*Main&gt; findMax test\n[(\"Example5\",30.0),(\"Example3\",30.0)]\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 12379345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6e59356fbc90c386550e0b8e4b4a08?s=128&d=identicon&r=PG&f=1", "display_name": "Wornz94", "link": "https://stackoverflow.com/users/12379345/wornz94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573845430, "creation_date": 1573832905, "question_id": 58880459, "link": "https://stackoverflow.com/questions/58880459/comparing-list-of-tuples", "title": "Comparing list of tuples", "body": "<p>I started to learn Haskell 2 weeks ago, so this question might be easy solved - It would be great if someone could explain me even simple steps.</p>\n\n<p>I need tuples to be compared for their second component:</p>\n\n<pre><code>[(String, Double)] -&gt; [(String, Double)]\n</code></pre>\n\n<p>So I want to get a list with highest Double value:</p>\n\n<pre><code>[(\"Example1\", 10.0), (\"Example2\", 20.0), (\"Example3\", 30.0), (\"Example4\", 15.0), (\"Example5\", 30.0\")]\n</code></pre>\n\n<p>As the snd of Example3 and Example 5 have the highest component (measured at Double component) I get this solution:</p>\n\n<pre><code>[(\"Example3\", 30.0), \"Example5, 30.0)]\n</code></pre>\n\n<p>Thanks, Wornz</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573831802, "post_id": 58879743, "comment_id": 104027290, "body": "I guess it&#39;s prodding you to write <code>instance (Typeable crypto, ToCBOR (Hash crypto SIPData)) =&gt;ToCBOR (SIP crypto)</code> instead. Under such context, you get <code>ToCBOR (SipHash crypto)</code> for free from the second instance."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573832447, "post_id": 58879743, "comment_id": 104027679, "body": "Indeed. So that&#39;s what I ended up doing. And I used <code>ConstraintKinds</code> to avoid repeating the constraints: <code>type SIPHasCBORRep t = (Typeable t, ToCBOR (Hash t SIPData))</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1780, "user_id": 5886238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6-9qKyv9RFM/AAAAAAAAAAI/AAAAAAAAAeY/hvJfgvauxDk/photo.jpg?sz=128", "display_name": "Andrew Ray", "link": "https://stackoverflow.com/users/5886238/andrew-ray"}, "is_accepted": false, "score": 3, "last_activity_date": 1573848560, "creation_date": 1573848560, "answer_id": 58884003, "question_id": 58879743, "link": "https://stackoverflow.com/questions/58879743/why-do-i-get-a-constraint-matches-instance-declaration-error/58884003#58884003", "title": "Why do I get a &quot;constraint matches instance declaration&quot; error?", "body": "<p>Essentially, Haskell is telling you that, as written, these instances will make certain kinds of type inference that you might normally expect to work impossible. The <code>MonoLocalBinds</code> language extension changes the way that the type system deals with these scenarios, so enabling it will allow your instances to function as written, but may change the semantics of your code.</p>\n\n<p>Haskell normally uses the most general (most polymorphic) interpretation of a variable bound by <code>let</code> or <code>where</code>, but if you allow these sorts of instances, there may be multiple different, yet equally general, interpretations. <code>MonoLocalBinds</code> will cause the parser to use a less general interpretation, instead of grinding to a halt or making an arbitrary decision. There's an <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/jfp-outsidein.pdf\" rel=\"nofollow noreferrer\">80-page paper from Vytiniotis, et al</a> that explains this issue more fully, though admittedly, I don't have time to sit down and read it.</p>\n\n<p>As @chi points out, GHC is letting you know that you can avoid this problem altogether (in this case) by replacing your first instance with:</p>\n\n<pre><code>instance (Typeable crypto, ToCBOR (Hash crypto SIPData)) =&gt; ToCBOR (SIP crypto)\n</code></pre>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1579860992, "creation_date": 1573830421, "last_edit_date": 1579860992, "question_id": 58879743, "link": "https://stackoverflow.com/questions/58879743/why-do-i-get-a-constraint-matches-instance-declaration-error", "title": "Why do I get a &quot;constraint matches instance declaration&quot; error?", "body": "<p>I have the following instances:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance (Typeable crypto, ToCBOR (SIPHash crypto)) =&gt; ToCBOR (SIP crypto) where\n  -- ...\n\ninstance (Typeable crypto, ToCBOR (Hash crypto SIPData)) =&gt;ToCBOR (SIPHash crypto) where\n  -- ...\n\n</code></pre>\n\n<p>Which give rise to the following error:</p>\n\n<pre><code>\u2022 The constraint \u2018ToCBOR (SIPHash crypto)\u2019\n    matches an instance declaration\n  instance (Typeable crypto, ToCBOR (Hash crypto SIPData)) =&gt;\n           ToCBOR (SIPHash crypto)\n    -- Defined at src/Cardano/Ledger/Spec/STS/Update/Data.hs:383:10\n  This makes type inference for inner bindings fragile; \n    either use MonoLocalBinds, or simplify it using the instance \n\u2022 In the context: (Typeable crypto, ToCBOR (SIPHash crypto))\n  While checking an instance declaration\n  In the instance declaration for \u2018ToCBOR (SIP crypto)\u2019\n</code></pre>\n\n<p>Why do I get this error, and what is this \"match\" the compiler error is referring to? (as far as I can see the constraints are different). </p>\n\n<p>PS: I also tried removing the <code>Typeable crypto</code> constraint without any luck, I guess this is due to the compiler not looking at the LHS of the instance declaration.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1573828273, "creation_date": 1573828273, "answer_id": 58879106, "question_id": 58879008, "link": "https://stackoverflow.com/questions/58879008/haskell-pascals-triangle/58879106#58879106", "title": "Haskell Pascal&#39;s triangle", "body": "<p>As the exception says, <code>pascal (n-1)</code> does not make much sense, since that is a function <code>Int -&gt; Int</code>, so you can not add <code>pascal (n-1) (k-1)</code> and <code>pascal (n-1)</code> together.</p>\n\n<p>You thus need to pass an extra parameter. For example:</p>\n\n<pre><code>pascal :: Int -&gt; Int -&gt; Int\npascal _ 0 = 1\npascal n k\n      | k == n = 1\n      | k &gt; n = 0\n      | otherwise = pascal (n-1) (k-1) + <b>pascal (n-1) k</b></code></pre>\n\n<p>Note that the condition <code>n == n</code> is always true, you probably want to say <code>n == k</code>?</p>\n"}], "owner": {"reputation": 21, "user_id": 12378942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2fdcb31304c39d0893ad99cc2ed528?s=128&d=identicon&r=PG&f=1", "display_name": "devFox", "link": "https://stackoverflow.com/users/12378942/devfox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 58879106, "answer_count": 1, "score": 1, "last_activity_date": 1573836095, "creation_date": 1573827950, "last_edit_date": 1573836095, "question_id": 58879008, "link": "https://stackoverflow.com/questions/58879008/haskell-pascals-triangle", "title": "Haskell Pascal&#39;s triangle", "body": "<p>I have to create a recursive function that takes in two numbers (n and k) and gives back their binomial coefficient. </p>\n\n<p>I have to use pascal :: Int -> Int -> Int</p>\n\n<p>I honestly don't understand where it went wrong, thanks for the help!</p>\n\n<pre><code>pascal :: Int -&gt; Int -&gt; Int\npascal n k\n      | k == 0 = 1\n      | n == n = 1\n      | k &gt; n  = 0\n      | otherwise = pascal(n-1)(k-1) + pascal(n-1) + k\n</code></pre>\n\n<p>The following error is:</p>\n\n<pre><code>main.hs:7:40: error:\n    \u2022 Couldn't match expected type \u2018Int\u2019 with actual type \u2018Int -&gt; Int\u2019\n    \u2022 Probable cause: \u2018pascal\u2019 is applied to too few arguments\n      In the second argument of \u2018(+)\u2019, namely \u2018pascal (n - 1)\u2019\n      In the first argument of \u2018(+)\u2019, namely\n        \u2018pascal (n - 1) (k - 1) + pascal (n - 1)\u2019\n      In the expression: pascal (n - 1) (k - 1) + pascal (n - 1) + k\n  |\n7 |       | otherwise = pascal(n-1)(k-1) + pascal(n-1) + k\n  |                                        ^^^^^^^^^^^\n&lt;interactive&gt;:3:1: error:\n    \u2022 Variable not in scope: main\n    \u2022 Perhaps you meant \u2018min\u2019 (imported from Prelude)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 285, "user_id": 3653363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a8838771b657f70001cb3ba9a586fd?s=128&d=identicon&r=PG&f=1", "display_name": "Gabscap", "link": "https://stackoverflow.com/users/3653363/gabscap"}, "is_accepted": true, "score": 3, "last_activity_date": 1573814018, "creation_date": 1573814018, "answer_id": 58875147, "question_id": 58874738, "link": "https://stackoverflow.com/questions/58874738/how-to-pass-an-argument-to-an-as-pattern-in-haskell/58875147#58875147", "title": "How to pass an argument to an as pattern in haskell", "body": "<p>Your function already has an argument <code>as</code>. Just use it in your function like</p>\n\n<pre><code>    calcDivisors :: [Int] -&gt; [Int]\n    calcDivisors as = filter alldiv as\n        ...\n</code></pre>\n\n<p>and call it with <code>calcDivisors [1..7]</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 12377835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b2536fbe0d522511aaf440ea2c8299?s=128&d=identicon&r=PG&f=1", "display_name": "AnaCifuentes", "link": "https://stackoverflow.com/users/12377835/anacifuentes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 58875147, "answer_count": 1, "score": 1, "last_activity_date": 1573814018, "creation_date": 1573812698, "question_id": 58874738, "link": "https://stackoverflow.com/questions/58874738/how-to-pass-an-argument-to-an-as-pattern-in-haskell", "title": "How to pass an argument to an as pattern in haskell", "body": "<p>I have the following function:</p>\n\n<pre><code>    calcDivisors :: [Int] -&gt; [Int]\n    calcDivisors as = filter alldiv [1..7]\n        where alldiv b = all ((==) 0 . mod b) as \n</code></pre>\n\n<p>Instead of calling <code>[1..7]</code> I want to call a variable list inside that function. I do not understand where to add my list parameter. </p>\n\n<p>Doing it like</p>\n\n<pre><code>calcDivisors list as = ...\n</code></pre>\n\n<p>does not work</p>\n"}, {"tags": ["haskell", "higher-order-functions"], "comments": [{"owner": {"reputation": 1201, "user_id": 7506861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa43944dd74a96c82dfd990626da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7506861/emily"}, "edited": false, "score": 2, "creation_date": 1573797470, "post_id": 58871054, "comment_id": 104010471, "body": "I assume using other functions that are implemented with recursion is allowed? Otherwise this would not be possible. Bear in mind that you have <code>map</code>/<code>foldr</code>/<code>foldl</code> available."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1573797514, "post_id": 58871054, "comment_id": 104010482, "body": "In particular, <code>map</code> should be incredibly useful here. <code>map function list</code> gives the result of applying <code>function</code> to each element of <code>list</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1573799412, "post_id": 58871054, "comment_id": 104011141, "body": "Probably <code>zipWith</code> too."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1573803396, "post_id": 58871054, "comment_id": 104012591, "body": "Isn\u2019t there a <code>zipWith3</code>?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1573810190, "post_id": 58871054, "comment_id": 104015632, "body": "@Elmex80s Yes, but I&#39;m not so sure it&#39;s useful here? We seem to have two lists of the same length (values per student), and another list of a different length (values per problem)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573826700, "post_id": 58871054, "comment_id": 104024466, "body": "Taking a step back: why are the names and grades separate in the first place? Where are they coming from?"}], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1573810665, "creation_date": 1573810665, "answer_id": 58874118, "question_id": 58871054, "link": "https://stackoverflow.com/questions/58871054/zip-and-calculate/58874118#58874118", "title": "Zip and calculate", "body": "<p>If you are prohibited to use recursion, that means that you should use some standard functions like <code>foldl</code>, <code>foldr</code>, <code>map</code>, <code>zip</code> and so on.</p>\n\n<p>As you have <code>averageGrade</code> function to process grades of a student, then you can process a list of such with <code>map</code> like this:</p>\n\n<pre><code>map (averageGrade weights) grades\n</code></pre>\n\n<p>It will apply <code>averageGrade weights</code> function on each element of list one by one, and return you a list of results, namely, the list of average grades for every student.</p>\n\n<p>So now, when you processed the data of all students, all you need is just pair each student name with appropriate average grade. You can use <code>zip</code> function for that:</p>\n\n<pre><code>allStudents :: [String] -&gt; [[Int]] -&gt; [Float] -&gt; [(String, Float)]\nallStudents names grades weights = zip names $ map (averageGrade weights) grades\n</code></pre>\n\n<p>You can test it here: <a href=\"https://repl.it/@Yuri12358/so-zip\" rel=\"nofollow noreferrer\">https://repl.it/@Yuri12358/so-zip</a></p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1573836533, "last_edit_date": 1573836533, "creation_date": 1573811467, "answer_id": 58874378, "question_id": 58871054, "link": "https://stackoverflow.com/questions/58871054/zip-and-calculate/58874378#58874378", "title": "Zip and calculate", "body": "<p>So you want</p>\n\n<pre><code>allStudents  :: [String] -&gt; [[Int]] -&gt; [Float]            -&gt; [(String, Float)]\n</code></pre>\n\n<p>which is not all that different from</p>\n\n<pre><code>allStudents2 :: [String] -&gt; [Float] -&gt; [[Int]]            -&gt; [(String, Float)]\n</code></pre>\n\n<p>and you have</p>\n\n<pre><code>averageGrade ::             [Float] -&gt;  [Int]  -&gt;  Float\n</code></pre>\n\n<p>such that</p>\n\n<pre><code>averageGrade (weights ::    [Float]) :: [Int]  -&gt;  Float\n</code></pre>\n\n<p>and since</p>\n\n<pre><code>map (foo ::                               a    -&gt;   b      ) \n                           ::          [  a  ] -&gt; [ b   ]\n</code></pre>\n\n<p>we have</p>\n\n<pre><code>map (averageGrade weights) ::          [[Int]] -&gt; [Float]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>map (averageGrade weights) (grades :: [[Int]]) :: [Float]\n</code></pre>\n\n<p>and <a href=\"https://hoogle.haskell.org/?hoogle=%5Bc%5D%20-%3E%20%5Bb%5D%20-%3E%20%5B%20%28c%2Cb%29%20%5D&amp;scope=set%3Astackage\" rel=\"nofollow noreferrer\">the one last missing piece to the puzzle</a> is</p>\n\n<pre><code>_ ::            [ c    ]  -&gt;                      [ b   ] -&gt; [( c    , b    )]\n</code></pre>\n\n<p>such that</p>\n\n<pre><code>_ (names ::     [String]) ::                      [ b   ] -&gt; [(String, b    )]\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 12368087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495ef9d8d155a88bb4ec150f7a17fb42?s=128&d=identicon&r=PG&f=1", "display_name": "Sorun", "link": "https://stackoverflow.com/users/12368087/sorun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 58874118, "answer_count": 2, "score": -1, "last_activity_date": 1573837184, "creation_date": 1573796997, "last_edit_date": 1573837184, "question_id": 58871054, "link": "https://stackoverflow.com/questions/58871054/zip-and-calculate", "title": "Zip and calculate", "body": "<p>I am looking for a solution without the use of recursion. I have 3 datas such as:</p>\n\n<pre><code>names = [\"Alice\", \"Bob\", \"Charlie\", \"David\"]\n\n-- their grades:\ngrades :: [[Int]]\ngrades = [[3, 2], [4, 6], [2, 3], [1, 4]]\n\n-- And the weights for a total note\nweights :: [Float]\nweights = [0.75, 0.25]\n</code></pre>\n\n<p>This should be understood as follows:</p>\n\n<pre><code>Alice's grades:   3 and 2 -- The grade 3 weighted with 75% and the grade 2 with 25%\nBob's grades:     4 and 6 -- The grade 4 weighted with 75% and the grade 6 with 25%\nCharlie's grades: 2 and 3 -- The grade 2 weighted with 75% and the grade 3 with 25%\nDavid's grades:   1 and 4 -- The grade 1 weighted with 75% and the grade 4 with 25%\n</code></pre>\n\n<p>I wrote a function which calculates the <code>averageGrade</code> for one student:</p>\n\n<pre><code>averageGrade :: [Float] -&gt; [Int] -&gt; Float\n</code></pre>\n\n<p>I have to accomplish a function according to this type:</p>\n\n<pre><code>allStudents :: [String] -&gt; [[Int]] -&gt; [Float] -&gt; [(String, Float)]\n</code></pre>\n\n<p>This function should give tuples of each person with their average grade such as:</p>\n\n<pre><code>[(\"Alice\", 2.75), (\"Bob\", 4.5), etc....]\n</code></pre>\n\n<p>The calculation is made by <code>averageGrade (weights) ([Specific Grades])</code>, e.g.</p>\n\n<pre><code>averageGrade (weights) ([3,2])\n</code></pre>\n\n<p>if I want to calculate it for Alice.</p>\n\n<p>How can I iterate over a list without going through it via <code>head</code> and <code>tail</code> (because recursion is not allowed)?</p>\n"}, {"tags": ["haskell", "functor", "state-monad"], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1573792719, "creation_date": 1573792719, "answer_id": 58870417, "question_id": 58870394, "link": "https://stackoverflow.com/questions/58870394/alternative-way-to-express-statet-functor-instance-definition/58870417#58870417", "title": "Alternative way to express StateT Functor instance definition", "body": "<p>Take advantage of the <code>Bifunctor</code> instance of tuples. Use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Bifunctor.html#v:first\" rel=\"nofollow noreferrer\"><code>Data.Bifunctor.first</code></a> instead of <code>fmapSwapTwice</code>.</p>\n"}], "owner": {"reputation": 20427, "user_id": 2570261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e71068b09fc539447a0cee3e99fc419d?s=128&d=identicon&r=PG&f=1", "display_name": "Haleemur Ali", "link": "https://stackoverflow.com/users/2570261/haleemur-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 58870417, "answer_count": 1, "score": 1, "last_activity_date": 1573792719, "creation_date": 1573792504, "question_id": 58870394, "link": "https://stackoverflow.com/questions/58870394/alternative-way-to-express-statet-functor-instance-definition", "title": "Alternative way to express StateT Functor instance definition", "body": "<p>I'm implemented the <code>Functor</code> instance for <code>StateT</code> in the following manner</p>\n\n<pre><code>import Data.Tuple (swap)\n\nnewtype StateT s m a =\n    StateT { runStateT :: s -&gt; m (a, s) }\n\ninstance Functor m =&gt; Functor (StateT s m) where\n    fmap f (StateT g) = StateT $ \\s -&gt; fmap (fmapSwapTwice f) (g s)\n        where fmapSwapTwice f tup = swap $ f &lt;$&gt; swap tup\n</code></pre>\n\n<p>But I'm not <em>wholly</em> satisfied with my solution, because it requires me to import <code>swap</code> from <code>Data.Tuple</code> and <code>fmap</code> it over the tuple twice in order to apply <code>f</code> to the first element. </p>\n\n<p>To me this seems like a common enough pattern that would have its own abstraction or perhaps there is an alternative way to express the <code>Functor</code> instance that I can't think of which doesn't require <code>swap</code> at all</p>\n"}, {"tags": ["haskell", "hxt"], "answers": [{"tags": [], "owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "is_accepted": false, "score": 0, "last_activity_date": 1577059731, "creation_date": 1577059731, "answer_id": 59449008, "question_id": 58869919, "link": "https://stackoverflow.com/questions/58869919/in-hxt-haskell-how-can-i-put-arrow-results-into-a-custom-data-structure/59449008#59449008", "title": "In HXT (Haskell), how can I put arrow results into a custom data structure?", "body": "<p>Given that you say that each paragraph is a string, I assume you've made a mistake in your code and instead want to declare</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Para = Para String\n</code></pre>\n\n<p>In order to eventually get your data into your structure, you're probably going to want to use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Arrow.html#v:-62--62--94-\" rel=\"nofollow noreferrer\"><code>&gt;&gt;^</code></a>, which lets you post-compose the constructor.</p>\n\n<h2>Collating paragraphs</h2>\n\n<p>For each chapter, a paragraph node will have one text child, so it's possible to turn each <code>&lt;p&gt;...&lt;/p&gt;</code> into a <code>Para</code> using</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>css \"p\" &gt;&gt;&gt; getChildren &gt;&gt;&gt; getText &gt;&gt;^ Para\n</code></pre>\n\n<p>which selects <code>&lt;p&gt;</code> nodes, pulls out their child text node, and turns it into a Para.</p>\n\n<h2>Collating chapters</h2>\n\n<p>Applying the above arrow directly to <code>chapsRaw</code> would collect the paragraphs for all chapters, rather than one per chapter.</p>\n\n<p>There may be a more idiomatic way, but a simple way to instead do this per chapter is with <a href=\"https://hackage.haskell.org/package/hxt-9.3.1.18/docs/Control-Arrow-ArrowList.html#v:listA\" rel=\"nofollow noreferrer\"><code>listA</code></a>, which collects the results of a list arrow.</p>\n\n<h2>The whole thing</h2>\n\n<pre class=\"lang-hs prettyprint-override\"><code>runX $ chapsRaw &gt;&gt;&gt; listA (css \"p\" &gt;&gt;&gt; getChildren &gt;&gt;&gt; getText &gt;&gt;^ Para) &gt;&gt;^ Chapter\n</code></pre>\n"}], "owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577059731, "creation_date": 1573788556, "question_id": 58869919, "link": "https://stackoverflow.com/questions/58869919/in-hxt-haskell-how-can-i-put-arrow-results-into-a-custom-data-structure", "title": "In HXT (Haskell), how can I put arrow results into a custom data structure?", "body": "<p>I'm trying to find a way to parse HTML and get it into a custom data structure. For example, I have a really short \"novel\" that looks like this in HTML: </p>\n\n<p>Test.html: </p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;A Test&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div&gt;\n            &lt;a name=\"#linkH2CH002\"/&gt;\n            &lt;p&gt;Contents of chapter 2, para 1&lt;/p&gt;\n            &lt;p&gt;Contents of chapter 2, para 2&lt;/p&gt;\n            &lt;p&gt;Contents of chapter 2, para 3&lt;/p&gt;\n            &lt;p&gt;Contents of chapter 2, para 4&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;a name=\"#linkH2CH003\"/&gt;\n            &lt;p&gt;Contents of chapter 3, para 1&lt;/p&gt;\n            &lt;p&gt;Contents of chapter 3, para 2&lt;/p&gt;\n            &lt;p&gt;Contents of chapter 3, para 3&lt;/p&gt;\n            &lt;p&gt;Contents of chapter 3, para 4&lt;/p&gt;\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>And I want to make this into something like: </p>\n\n<pre><code>Novel [ Chapter [Para, Para] , Chapter [Para, Para] ]\n</code></pre>\n\n<p>In other words, a novel has one or more chapters, and each chapter has one or more paragraphs, and each paragraph is a string. </p>\n\n<p>Here's what I have so far: </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module Main where\n\nimport Text.XML.HXT.Core\nimport Text.HandsomeSoup\n\n\ndata Novel =  Novel { title :: String,\n                      chaps :: [Chapter] }\n\ndata Chapter = Chapter [Para]\n\ndata Para = Para [String]\n\nmain :: IO ()\nmain = do\n  contents &lt;- readFile \"src/test.html\"\n  let doc = parseHtml contents\n  -- Get all divs that have the child &lt;a name=\"\"&gt;\n  let chapsRaw = doc &gt;&gt;&gt; css \"div\" &gt;&gt;&gt; (ifA (css \"a\" &gt;&gt;&gt; hasAttr \"name\")(this)(none))\n  chaps &lt;- runX chapsRaw\n  names &lt;- runX $ chapsRaw &gt;&gt;&gt; css \"a\" ! \"name\"\n  print $ names\n  print chaps\n  -- Now to make Chapter [Para] for each chapter. \n  -- Something like this?\n  -- Chapter $ [(runX chapsRaw &gt;&gt;&gt; css \"p\" &gt;&gt;&gt; Para)]\n</code></pre>\n\n<p>So far so good, but I'm stuck and getting this data into my custom data structure. </p>\n\n<p>I kind of understand that an arrow will run on everything all at once, but I'm not sure how to cram all this data into my custom data structure, since arrows are still a little mysterious to me. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1573755694, "post_id": 58863407, "comment_id": 103997563, "body": "(1) pattern matching could help you here (2) yes"}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 2, "creation_date": 1573759231, "post_id": 58863407, "comment_id": 103999182, "body": "In fact you want to take the first element of each sublist, so I suppose you could rephrase the subject of your question accordingly. Your problem can probably be solved by combining the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:map\" rel=\"nofollow noreferrer\">map</a> and <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html\" rel=\"nofollow noreferrer\">head</a> library functions. Please remember that <a href=\"https://hoogle.haskell.org/\" rel=\"nofollow noreferrer\">Hoogle</a> is your friend in this endeavour."}, {"owner": {"reputation": 2771, "user_id": 5963279, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/10207102799463401/picture?type=large", "display_name": "Thomas Cook", "link": "https://stackoverflow.com/users/5963279/thomas-cook"}, "edited": false, "score": 0, "creation_date": 1573759454, "post_id": 58863407, "comment_id": 103999294, "body": "I produced an answer to the question:  &quot;How can i remove every 2nd value in a list?&quot;"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573760886, "post_id": 58863407, "comment_id": 103999907, "body": "This is a perfect example of an <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">XY problem</a>. You are assuming the first step should be to use <code>concat</code>, then got stuck there. But if what you want is <code>[1,2,3]</code> from <code>[[1,0],[2,0],[3,0]]</code>, then skip <code>concat</code> and use <code>map head</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 2771, "user_id": 5963279, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/10207102799463401/picture?type=large", "display_name": "Thomas Cook", "link": "https://stackoverflow.com/users/5963279/thomas-cook"}, "is_accepted": false, "score": -3, "last_activity_date": 1573759377, "creation_date": 1573759377, "answer_id": 58864333, "question_id": 58863407, "link": "https://stackoverflow.com/questions/58863407/getting-the-2nd-element-of-a-list/58864333#58864333", "title": "Getting the 2nd element of a list", "body": "<p>This function will give you all but the 2nd element of a list:</p>\n\n<pre><code>allBut2nd :: [a] -&gt; [a]\nallBut2nd [] = []\nallBut2nd list = head list : tail (tail list)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 1, "last_activity_date": 1573760663, "creation_date": 1573760663, "answer_id": 58864649, "question_id": 58863407, "link": "https://stackoverflow.com/questions/58863407/getting-the-2nd-element-of-a-list/58864649#58864649", "title": "Getting the 2nd element of a list", "body": "<p>The thinking goes like this: first, an empty list with every second value removed would be an empty list. Let's write that down:</p>\n\n<pre><code>withoutEverySecondValue [] = []\n</code></pre>\n\n<p>Now, if a list that consists of two values <code>x</code> and <code>y</code>, and then some tail <code>xs</code>, then to remove every second value from such list would mean (1) ignore <code>y</code>, (2) remove every second value from the tail <code>xs</code>, and (3) prepend <code>x</code> to the result of that. Let's write that down:</p>\n\n<pre><code>withoutEverySecondValue (x:y:xs) = x : withoutEverySecondValue xs\n</code></pre>\n\n<p>And that's it! Just add a type signature, and you're done!</p>\n\n<pre><code>withoutEverySecondValue :: [a] -&gt; [a]\nwithoutEverySecondValue [] = []\nwithoutEverySecondValue (x:y:xs) = x : withoutEverySecondValue xs\n</code></pre>\n\n<p>There's one thing missing here though: what if a list is not empty, but also doesn't have two elements <code>x</code> and <code>y</code>? What should the result be then? I'll leave determining and writing that down as an exercise.</p>\n"}], "owner": {"reputation": 9, "user_id": 12374472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b22e9c054400dd8565d3697bff25acb?s=128&d=identicon&r=PG&f=1", "display_name": "Amijo", "link": "https://stackoverflow.com/users/12374472/amijo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 58864649, "answer_count": 2, "score": -2, "last_activity_date": 1573760663, "creation_date": 1573755444, "question_id": 58863407, "link": "https://stackoverflow.com/questions/58863407/getting-the-2nd-element-of-a-list", "title": "Getting the 2nd element of a list", "body": "<p>I have a function with this type:</p>\n\n<pre><code>calculator :: [Float] -&gt; [Int] -&gt; Float\n</code></pre>\n\n<p>and I need:</p>\n\n<pre><code>Helper :: [String] -&gt; [[Int]] -&gt; [Float] -&gt; [(String, Float)]\n</code></pre>\n\n<p>Following problem is given:</p>\n\n<p>I just want to take every 2nd element of the <code>[[Int]]</code></p>\n\n<p>e.g.: I have an given Int [[1,0], [2,0], [3,0]].</p>\n\n<p>I want to  get the first element of each list in a list to put it into my calculator.</p>\n\n<p>My idea was to concat the list of [Int].</p>\n\n<p>e.g.:</p>\n\n<p>[[1,0], [2,0], [3,0]]. </p>\n\n<pre><code>concat [[1,0], [2,0], [3,0]] =&gt; [1,0,2,0,3,0]\n</code></pre>\n\n<p>I want this without the \"0\" values, due this is an indice which i dont need.</p>\n\n<p>How can i remove every 2nd value in a list?</p>\n\n<p><strong>Is that possible with a higher order function?</strong></p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573745273, "post_id": 58859767, "comment_id": 103991525, "body": "This is not the issue, but let me comment on your <code>replace1</code>. It crashes on <code>[]</code>, to start. It also crashes on <code>[x]</code>, since it tries to access the second element with <code>(x:xs)!!1</code>. It calls <code>replace</code> to replace the second element. Perhaps you could handle the cases <code>[]</code> and <code>[x]</code> separately, and then let <code>replace1 (x0:x1:xs) = x0:x1+1:xs</code>. That looks much simpler to me, if you want to increment the second element."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573746325, "post_id": 58859767, "comment_id": 103992198, "body": "&quot;a number already in the list + 1&quot;. <i>Which</i> number? What should the result for <code>sample</code> be?"}, {"owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573746429, "post_id": 58859767, "comment_id": 103992268, "body": "I know, however after I get this working, I will also want to use it to increment 7th,8th and 9th element. This will be a bit complicated that way."}, {"owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573746573, "post_id": 58859767, "comment_id": 103992367, "body": "@chepner the number in the next position"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573746612, "post_id": 58859767, "comment_id": 103992384, "body": "So <code>[10 0 5]</code> should produce <code>[10 6 5]</code>? Or are you just incrementing the next value to get <code>[10 1 5]</code>?"}, {"owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573747064, "post_id": 58859767, "comment_id": 103992698, "body": "@chepner to get <code>[10 1 5]</code>"}, {"owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573747233, "post_id": 58859767, "comment_id": 103992778, "body": "Question is solved."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1573745425, "creation_date": 1573745425, "answer_id": 58860395, "question_id": 58859767, "link": "https://stackoverflow.com/questions/58859767/replacing-certain-elements-in-a-list/58860395#58860395", "title": "Replacing certain elements in a list", "body": "<p>Here is the issue:</p>\n\n<pre><code>zstoints1 (x:xs)    |x&lt;=10 = x: zstoints1 xs\n                   --^^^^^--\n</code></pre>\n\n<p>This should only trigger when <code>x &lt; 10</code>, since you want to call <code>replace1</code> on <code>10</code>, instead.</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1573751399, "creation_date": 1573751399, "answer_id": 58862300, "question_id": 58859767, "link": "https://stackoverflow.com/questions/58859767/replacing-certain-elements-in-a-list/58862300#58862300", "title": "Replacing certain elements in a list", "body": "<p>This seems to be a perfect opportunity to use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:scanl1\" rel=\"nofollow noreferrer\"><code>scanl1</code></a> which lives in the Data.List package and available in Prelude by default.</p>\n\n<pre><code>doit :: [Int] -&gt; [Int]\ndoit = scanl1 (\\p c -&gt; if p &gt;= 10 then 1 else c)\n\n*Main&gt; doit [-20,0,0,10,0,10,-20,-20,0,10,0,0,0,-20]\n[-20,0,0,10,1,10,1,-20,0,10,1,0,0,-20]\n*Main&gt; doit [10,0,0,0,10,0,0,0,0,0,0,0,0]\n[10,1,0,0,10,1,0,0,0,0,0,0,0]\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 58860395, "answer_count": 2, "score": 2, "last_activity_date": 1573752107, "creation_date": 1573743576, "last_edit_date": 1573752107, "question_id": 58859767, "link": "https://stackoverflow.com/questions/58859767/replacing-certain-elements-in-a-list", "title": "Replacing certain elements in a list", "body": "<p>I am trying to write code that will take a list and give me a list where an element after an element bigger or equal to 10 is replaced with a number I choose. In this case it is a number already in list +1 ([10,(0+1),0,0...]. \nThat means, that after running function on sample two, the output will be [10,1,0,0,10,0,0,0,0,0,0,0,0]</p>\n\n<p>However, I need to write a function <code>zstoints1</code> that will run the <code>replace1</code> function through the whole list and got a bit tangled up in syntax and instead of returning [10,1,0,0,10,1,0,0,0,0,0,0,0] it returns [10,0,0,0,10,0,0,0,0,0,0,0,0].</p>\n\n<pre><code>sample :: [Int]\nsample= [-20,0,0,10,0,10,-20,-20,0,10,0,0,0,-20]\n\nsample2 :: [Int]\nsample2= [10,0,0,0,10,0,0,0,0,0,0,0,0]\n\nreplace::[Int]-&gt;Int-&gt;Int-&gt;[Int]\nreplace [] _ _ = []\nreplace (x:xs) i n   | i == 0 = n:xs\n                    | otherwise = x:replace xs (i-1) n \n\nreplace1 :: [Int]-&gt;[Int]\nreplace1 (x:xs) = replace (x:xs) 1 ((x:xs)!!1 + 1)\n\nzstoints1 :: [Int]-&gt;[Int]\nzstoints1 [] = []\nzstoints1 (x:xs)    |x&lt;=10 = x: zstoints1 xs\n                    |x&gt;=10 = x: zstoints1 (tail(replace1 (x:xs)))\n</code></pre>\n\n<p>Where did I make a mistake and what could be a correct way to write it?</p>\n\n<p>PS: I wrote replace functions in a complicated way because I plan to use them further in my code.</p>\n"}, {"tags": ["haskell", "haskell-pipes"], "answers": [{"comments": [{"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1573820733, "post_id": 58860286, "comment_id": 104021385, "body": "Yeah I need a solution with <code>pipeline :: Pipe Input Integer (StateT AnotherState IO) ()</code> actually..."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1573745116, "creation_date": 1573745116, "answer_id": 58860286, "question_id": 58859184, "link": "https://stackoverflow.com/questions/58859184/pipes-haskell-lib-piping-pipes-with-different-state-monad/58860286#58860286", "title": "Pipes (Haskell lib) - piping pipes with different state monad", "body": "<p>The problem is that you call <code>evalStateP</code> too early, discarding state you want to preserve across calls to <code>accumulate</code>. Try something like this:</p>\n\n<pre><code>pipeline :: Pipe Input Integer IO ()\npipeline = evalStateP 0 $ for cat $ \\case\n  A x -&gt; yield x &gt;-&gt; accumulate\n  B x -&gt; yield x\n  C x -&gt; yield x\n\naccumulate :: Pipe Integer Integer (StateT Integer IO) ()\naccumulate = for cat $ \\x -&gt; do\n        modify (+x)\n        r &lt;- get\n        yield r\n</code></pre>\n\n<p>Note that <code>Proxy</code> has a <code>MonadState</code> instance, so you don't need to lift state operations manually if you use <code>mtl</code>.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1573820880, "creation_date": 1573741935, "last_edit_date": 1573820880, "question_id": 58859184, "link": "https://stackoverflow.com/questions/58859184/pipes-haskell-lib-piping-pipes-with-different-state-monad", "title": "Pipes (Haskell lib) - piping pipes with different state monad", "body": "<p>My goal is to have the last value produced equal to 80 (40 + 40) (see code below)...</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Pipes\nimport Pipes.Prelude\nimport Pipes.Lift\nimport Control.Monad.State.Strict\n\ndata Input = A Integer | B Integer | C Integer\n\nmain :: IO ()\nmain = runEffect $ each [A 10,B 2,C 3,A 40,A 40] &gt;-&gt; pipeline &gt;-&gt; print\n\n\npipeline :: Pipe Input Integer IO ()\npipeline = for cat $ \\case\n  A x -&gt; yield x &gt;-&gt; accumulate\n  B x -&gt; yield x\n  C x -&gt; yield x\n\naccumulate :: Pipe Integer Integer IO ()\naccumulate = evalStateP 0 accumulate'\n\n\naccumulate' :: Pipe Integer Integer (StateT Integer IO) ()\naccumulate' = go\n  where\n    go = do\n        x &lt;- await\n        lift $ modify (+x)\n        r &lt;- lift get\n        yield r\n        go\n\n</code></pre>\n\n<p>With this example Input <code>A</code>s are not accumulated...<code>yield x &gt;-&gt; accumulate</code> on Input A does do what I'm expected, the stream is a new one each time...</p>\n\n<p>Piping pipes with different state monad sequentially works well but here somehow I want to nest them in the case pattern (like a substream somehow)... </p>\n"}, {"tags": ["haskell", "shake-build-system"], "answers": [{"tags": [], "owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "is_accepted": true, "score": 0, "last_activity_date": 1576316176, "creation_date": 1576316176, "answer_id": 59333901, "question_id": 58857361, "link": "https://stackoverflow.com/questions/58857361/actionfinally-not-running-cmd-invoked-inside-handler/59333901#59333901", "title": "actionFinally not running cmd invoked inside handler", "body": "<p>This sample of code looks correct, and testing variations of it in isolation does indeed work. A bug has been raised to figure out the precise reason it doesn't work in your case at <a href=\"https://github.com/ndmitchell/shake/issues/731\" rel=\"nofollow noreferrer\">https://github.com/ndmitchell/shake/issues/731</a>. </p>\n"}], "owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 59333901, "answer_count": 1, "score": 1, "last_activity_date": 1576316176, "creation_date": 1573736333, "question_id": 58857361, "link": "https://stackoverflow.com/questions/58857361/actionfinally-not-running-cmd-invoked-inside-handler", "title": "actionFinally not running cmd invoked inside handler", "body": "<p>I have the following code fragment:</p>\n\n<pre><code>withContainer :: String -&gt; (String -&gt; Action a) -&gt; Action a\n  cid &lt;= cmd \"docker\" [ \"run\" , \"--rm\", \"-d\", my_image ]\n  ... \n  actionFinally (action containerName) $ do\n    cmd_ \"docker\" [ \"rm\", \"-f\", filter (/= '\\n') cid ]\n</code></pre>\n\n<p>which supposedly kill containers whether or not the action succeeds. However I noticed containers are still left up and running when the action fails, which is annoying. What am I doing wrong?</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1573758788, "post_id": 58855451, "comment_id": 103998980, "body": "Checkout <code>stack sdist --pvp-bounds</code>: <a href=\"https://www.fpcomplete.com/blog/2015/09/stack-pvp\" rel=\"nofollow noreferrer\">fpcomplete.com/blog/2015/09/stack-pvp</a>"}, {"owner": {"reputation": 767, "user_id": 841729, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fb0153b7c04243e7fe2d1ec64f5daa91?s=128&d=identicon&r=PG", "display_name": "Small Hadron Collider", "link": "https://stackoverflow.com/users/841729/small-hadron-collider"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1573764138, "post_id": 58855451, "comment_id": 104001764, "body": "Hadn&#39;t thought of creating a tarball then extracting it to get the cabal file. That could work. My build script needs rewriting properly in any case. Not a perfect solution, but can probably get it to work."}], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 0, "last_activity_date": 1573731164, "creation_date": 1573731164, "answer_id": 58855823, "question_id": 58855451, "link": "https://stackoverflow.com/questions/58855451/generating-cabal-file-dependency-versions/58855823#58855823", "title": "Generating .cabal file dependency versions", "body": "<p>In FreeBSD Ports (which is alike Homebrew, AFAIK) we force <code>cabal</code> to use fixed versions of dependencies by fetching and unpacking them in the package directory and then calling <code>cabal new-build</code>. It also uses <code>hpack</code> to generate .cabal file from <code>package.yaml</code>. However, the dependencies list is generated manually by tweaking versions until the package builds successfully.</p>\n"}], "owner": {"reputation": 767, "user_id": 841729, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fb0153b7c04243e7fe2d1ec64f5daa91?s=128&d=identicon&r=PG", "display_name": "Small Hadron Collider", "link": "https://stackoverflow.com/users/841729/small-hadron-collider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1573758897, "creation_date": 1573729935, "last_edit_date": 1573758897, "question_id": 58855451, "link": "https://stackoverflow.com/questions/58855451/generating-cabal-file-dependency-versions", "title": "Generating .cabal file dependency versions", "body": "<p>I use Stack to build on my local machine, but Homebrew uses Cabal. This means that sometimes a build will work fine for me, but then not work in Homebrew. This seems to be because Cabal uses the <em>latest</em> packages, whereas Stack uses the ones from the resolver.</p>\n\n<p>Is there a way to generate the package versions in the <code>.cabal</code> file automatically based on the current resolver? (I'm using a <code>package.yaml</code> file)</p>\n"}, {"tags": ["haskell", "ghci", "zipwith"], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1573726362, "post_id": 58853252, "comment_id": 103980432, "body": "I think it&#39;s worth adding the reason why the <code>sum(zipWith (*) [0.75, 0.25] [6, 4])</code> worked in GHCi - namely that the integer literals <code>6</code> and <code>4</code> are polymorphic, and GHC is interpreting them as <code>Float</code>s (or probably <code>Double</code>s, not sure of the default) so the expression typechecks. The problem comes from the type signature, which means you&#39;re trying to give two different types to <code>(*)</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1573723301, "creation_date": 1573723301, "answer_id": 58853252, "question_id": 58853038, "link": "https://stackoverflow.com/questions/58853038/haskell-zipwith/58853252#58853252", "title": "Haskell zipWith", "body": "<p>You can't <code>*</code> two numbers having a different type, like <code>Float</code> and <code>Int</code>. You need to explicitly convert one of them so that they have the same type (<code>Float</code>, in your case).</p>\n\n<pre><code>averageGrade :: [Float] -&gt; [Int] -&gt; Float\naverageGrade a b\n            | a == [] = 0\n            | b == [] = 0\n            | otherwise = sum (zipWith (\\ x y -&gt; x * fromIntegral y) a b)\n</code></pre>\n\n<p>Note that you do not really need to check the <code>==[]</code> cases, since <code>zipWith</code> returns <code>[]</code> is those cases, and <code>sum [] == 0</code>.</p>\n\n<pre><code>averageGrade :: [Float] -&gt; [Int] -&gt; Float\naverageGrade a b = sum (zipWith (\\ x y -&gt; x * fromIntegral y) a b)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573726151, "post_id": 58853326, "comment_id": 103980321, "body": "Even if the empty list check was necessary, you still don&#39;t need an <code>Eq</code> constraint. There are better ways to check if a list is empty, like the <code>null</code> function or direct pattern matching."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573728010, "post_id": 58853326, "comment_id": 103981414, "body": "@Robin Zigmond Yes right. My intention was to fix OP&#39;s snippet through the type signature."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 2, "last_activity_date": 1573724304, "last_edit_date": 1573724304, "creation_date": 1573723499, "answer_id": 58853326, "question_id": 58853038, "link": "https://stackoverflow.com/questions/58853038/haskell-zipwith/58853326#58853326", "title": "Haskell zipWith", "body": "<p>You can <code>(*)</code> different types given that those are members of <code>Num</code> type class. You may add <code>Num</code> and <code>Eq</code> constraints to the type signature such as;</p>\n\n<pre><code>averageGrade :: (Num a, Eq a) =&gt; [a] -&gt; [a] -&gt; a\naverageGrade a b | a == [] = 0\n                 | b == [] = 0\n                 | otherwise = sum $ zipWith (*) a b\n\n*Main&gt; averageGrade [0.75 , 0.25] [6, 4]\n5.5\n</code></pre>\n\n<p>However as @chi mentions you don't really need the checks for empty lists hence we don't really need the <code>Eq</code> constraint in the type signature. The following should be sufficient.</p>\n\n<pre><code>averageGrade :: Num a =&gt; [a] -&gt; [a] -&gt; a\naverageGrade a b = sum $ zipWith (*) a b\n\n*Main&gt; averageGrade [0.75 , 0.25] [6, 4]\n5.5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2771, "user_id": 5963279, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/10207102799463401/picture?type=large", "display_name": "Thomas Cook", "link": "https://stackoverflow.com/users/5963279/thomas-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1573728358, "creation_date": 1573728358, "answer_id": 58854932, "question_id": 58853038, "link": "https://stackoverflow.com/questions/58853038/haskell-zipwith/58854932#58854932", "title": "Haskell zipWith", "body": "<p>Alternative implementation:</p>\n\n<pre><code>averageGrade :: [Float] -&gt; [Float] -&gt; Float\naverageGrade [] _ = 0\naverageGrade _ [] = 0\naverageGrade (x:xs) (y:ys) = x * y + (averageGrade xs ys)\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>averageGrade [1.0, 2.0] [2.0, 2.0]\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 12368087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495ef9d8d155a88bb4ec150f7a17fb42?s=128&d=identicon&r=PG&f=1", "display_name": "Sorun", "link": "https://stackoverflow.com/users/12368087/sorun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 1, "accepted_answer_id": 58853252, "answer_count": 3, "score": 6, "last_activity_date": 1573728358, "creation_date": 1573722630, "question_id": 58853038, "link": "https://stackoverflow.com/questions/58853038/haskell-zipwith", "title": "Haskell zipWith", "body": "<p>I want to sum a zipped list.</p>\n\n<pre><code>averageGrade :: [Float] -&gt; [Int] -&gt; Float\naverageGrade [0.75 , 0.25] [6, 4] , result: 0,75*6 + 0.25*4 = 5.5 \n</code></pre>\n\n<p>when I go to ghci and do the following:</p>\n\n<pre><code>sum(zipWith (*) [0.75, 0.25] [6, 4])\n</code></pre>\n\n<p>I get excactly what i want to.</p>\n\n<p>But in code I'm getting an error, and I don't know why.</p>\n\n<pre><code>    averageGrade :: [Float] -&gt; [Int] -&gt; Float\n    averageGrade a b\n                | a == [] = 0\n                | b == [] = 0\n                | otherwise = (sum(zipWith (*) a b))\n</code></pre>\n\n<p>If I want to compile this I'm getting the following failure:</p>\n\n<pre><code>Couldn't match type \u2018Int\u2019 with \u2018Float\u2019\nExpected type: [Float]\n  Actual type: [Int]\nIn the third argument of \u2018zipWith\u2019, namely \u2018b\u2019\nIn the first argument of \u2018sum\u2019, namely \u2018(zipWith (*) a b)\u2019\nFailed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["haskell", "monads", "category-theory"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1573723133, "post_id": 58852614, "comment_id": 103978527, "body": "Yes, along with the functor laws."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 6, "creation_date": 1573726545, "post_id": 58852614, "comment_id": 103980514, "body": "Haskell might not &quot;enforce&quot; them - that is, the compiler won&#39;t reject otherwise correct definitions that violate them - but that&#39;s only because it would be impossible to check this in an automated way for every instance. It&#39;s still understood that any actual instances <i>should</i> satisfy the laws, or things will go wrong pretty quickly."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1573760236, "post_id": 58852614, "comment_id": 103999633, "body": "@RobinZigmond, not impossible -- we just need some dependent types and verification machinery.  Heh, <i>&quot;just&quot;</i>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1573760708, "post_id": 58852614, "comment_id": 103999829, "body": "@luqui I could be wrong but it seems to me there are actually deep theoretical reasons why this is impossible. You don&#39;t know what instances might be provided, and some instances might make one or both sides of a to-be-proved equality not terminate. By the impossibility of solving the Halting Problem, no algorithm can determine even that."}, {"owner": {"reputation": 4743, "user_id": 1697709, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ce4707be88278549d13843ce0d95fdd9?s=128&d=identicon&r=PG", "display_name": "Gergely", "link": "https://stackoverflow.com/users/1697709/gergely"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573760780, "post_id": 58852614, "comment_id": 103999868, "body": "@chi what are those functor laws? Could you pass a link?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1573764241, "post_id": 58852614, "comment_id": 104001808, "body": "@Gergely did you try googling? You can find the functor laws in lots of places, here is one chosen more or less at random: <a href=\"https://wiki.haskell.org/Functor#Functor_Laws\" rel=\"nofollow noreferrer\">wiki.haskell.org/Functor#Functor_Laws</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1573776593, "post_id": 58852614, "comment_id": 104006029, "body": "@RobinZigmond I guess I was referring to an agda-style &quot;proofs must be provided when instantiating&quot; approach"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1573777639, "post_id": 58852614, "comment_id": 104006266, "body": "@luqui - thanks for the reply, I confess I&#39;m not familiar with Agda, or any dependently-typed language (I browsed through the docs for Idris a few months back, and confess a lot of it went over my head). I guess asking the programmer to provide a proof is fine, if the language provides a way to do that, but it&#39;s rather different from what I was talking about: taking any user-defined instance and being able to decide if it satisfies the laws or not. That&#39;s what I am claiming is impossible in general. (I&#39;d be happy to be proved wrong though.)"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1573739222, "creation_date": 1573739222, "answer_id": 58858278, "question_id": 58852614, "link": "https://stackoverflow.com/questions/58852614/what-are-the-identities-categorical-monads-enforce-that-haskell-monads-dont/58858278#58858278", "title": "What are the identities categorical monads enforce that Haskell monads don&#39;t?", "body": "<p>Constrasting with the accepted answer to the linked question, consider this instance.</p>\n\n<pre><code>newtype List a = List [a] deriving (Functor, Applicative)\n\ninstance Monad List where\n    return _ = List []\n    m &gt;&gt;= f = List []\n</code></pre>\n\n<p>A compiler will accept this definition, but it does not obey the monad laws. Specifically, try to confirm that </p>\n\n<pre><code>m &gt;&gt;= return == m\n</code></pre>\n\n<p>for both <code>[]</code> and <code>List</code>:</p>\n\n<pre><code>-- Correct\nPrelude&gt; [1,2,3] &gt;&gt;= return\n[1,2,3]\n\n-- Not correct, should be List [1,2,3]\nPrelude&gt; List [1,2,3] &gt;&gt;= return\nList []\n</code></pre>\n"}], "owner": {"reputation": 4743, "user_id": 1697709, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ce4707be88278549d13843ce0d95fdd9?s=128&d=identicon&r=PG", "display_name": "Gergely", "link": "https://stackoverflow.com/users/1697709/gergely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 58858278, "answer_count": 1, "score": 4, "last_activity_date": 1573739222, "creation_date": 1573721100, "question_id": 58852614, "link": "https://stackoverflow.com/questions/58852614/what-are-the-identities-categorical-monads-enforce-that-haskell-monads-dont", "title": "What are the identities categorical monads enforce that Haskell monads don&#39;t?", "body": "<p><a href=\"http://blog.sigfpe.com/2006/08/you-could-have-invented-monads-and.html\" rel=\"nofollow noreferrer\">http://blog.sigfpe.com/2006/08/you-could-have-invented-monads-and.html</a></p>\n\n<p>writes:</p>\n\n<blockquote>\n  <p>If you hadn't guessed, this is about monads as they appear in pure functional programming languages like Haskell. They are closely related to the monads of category theory, but are not exactly the same because Haskell doesn't enforce the identities satisfied by categorical monads.</p>\n</blockquote>\n\n<p>Are these the identities that the above text is talking about?</p>\n\n<p><a href=\"https://stackoverflow.com/questions/37124471/are-monad-laws-enforced-in-haskell\">Are monad laws enforced in Haskell?</a></p>\n\n<pre><code>return a &gt;&gt;= k  =  k a\nm &gt;&gt;= return  =  m\nm &gt;&gt;= (\\x -&gt; k x &gt;&gt;= h)  =  (m &gt;&gt;= k) &gt;&gt;= h\n</code></pre>\n"}, {"tags": ["haskell", "foldleft"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 5, "creation_date": 1573720332, "post_id": 58852201, "comment_id": 103977045, "body": "Well you&#39;re entirely ignoring <code>x</code> and <code>0+a</code> is the same as <code>a</code>, so you can see there&#39;s definitely no summation going on here. Try changing your lambda to something that adds two tuples."}, {"owner": {"reputation": 131, "user_id": 10709678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd5e4701f662b32082bebba0472c2b7?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10709678/kevin"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1573720684, "post_id": 58852201, "comment_id": 103977227, "body": "Oh I see, so it should be something like this? <code>sumPoint xs = foldl (\\(a,b) (x,y)-&gt; (x+a,y+b)) (0.0,0.0) xs</code> but I&#39;m getting a strange error, it expects  <code>[(Float, Float)]</code>  actual type  <code>[Point]</code>  but Point is a (Float,Float)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1573722044, "post_id": 58852201, "comment_id": 103977906, "body": "@Kevin Close. Try <code>(\\(a,b) (Point x y)-&gt; (x+a,y+b)) </code> since the second argument is a point, not a pair."}, {"owner": {"reputation": 131, "user_id": 10709678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd5e4701f662b32082bebba0472c2b7?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10709678/kevin"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573722402, "post_id": 58852201, "comment_id": 103978105, "body": "@chi Thanks for the tip it works out, I thought since point is defined as a pair the pattern should match."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573722689, "post_id": 58852201, "comment_id": 103978272, "body": "Haskell uses nominal typing (like most programming languages), where even if two types are defined in the same way but have a different name they are considered distinct types. Here, <code>Point</code> and <code>(Float,Float)</code> are structurally identical, but have a different name, so there is no automatic conversion."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 10709678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd5e4701f662b32082bebba0472c2b7?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10709678/kevin"}, "is_accepted": false, "score": 2, "last_activity_date": 1573722414, "creation_date": 1573722414, "answer_id": 58852973, "question_id": 58852201, "link": "https://stackoverflow.com/questions/58852201/foldl-with-lambda-expresion/58852973#58852973", "title": "Foldl with lambda expresion", "body": "<p>I changed it to </p>\n\n<pre><code>sumPoint xs = foldl (\\(a,b) (Point x y)-&gt; (x+a,y+b)) (0.0,0.0) xs\n</code></pre>\n\n<p>The problem was I was ignoring the x and at 0+a is nothing happening.</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 3, "last_activity_date": 1573722725, "creation_date": 1573722725, "answer_id": 58853062, "question_id": 58852201, "link": "https://stackoverflow.com/questions/58852201/foldl-with-lambda-expresion/58853062#58853062", "title": "Foldl with lambda expresion", "body": "<p>To be a little structural you better define operations among <code>Point</code> type values and then convert the <code>Point</code> type to Tuple wherever needed. Otherwise you may directly use Tuple and discard the <code>Point</code> type.</p>\n\n<pre><code>data Point = Point {x,y :: Float} deriving Show\n\ntoTuple :: Point -&gt; (Float, Float)\ntoTuple p = (x p, y p)\n\naddPts :: Point -&gt; Point -&gt; Point\naddPts p q = Point (x p + x q) (y p + y q)\n\nsumPts :: [Point] -&gt; Point\nsumPts = foldl addPts (Point 0 0)\n</code></pre>\n\n<p>So what you need is <code>toTuple . sumPts</code> function.</p>\n\n<pre><code>*Main&gt; :t toTuple . sumPts\ntoTuple . sumPts :: [Point] -&gt; (Float, Float)\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 10709678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd5e4701f662b32082bebba0472c2b7?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10709678/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1573722725, "creation_date": 1573719607, "question_id": 58852201, "link": "https://stackoverflow.com/questions/58852201/foldl-with-lambda-expresion", "title": "Foldl with lambda expresion", "body": "<p>Hi I'm trying to sum a list of tuples into a tuple with the foldl function,\nI tryed it with using as parameter a lambda expresion but it's giving out a wrong value \nhere the code:</p>\n\n<pre><code>data Point = Point {x,y :: Float}\nsumPoint :: [Point] -&gt; (Float,Float)\nsumPoint xs = foldl (\\(a,b) x-&gt; (0+a,0+b)) (0.0,0.0) xs\n</code></pre>\n\n<p>It should come out <code>sumPoint [Point 2 4, Point 1 2, Point (-1) (-2)] = (2.0,4.0)</code>\nBut im getting <code>(0.0,0.0)</code>\nHow is this making any sense?</p>\n"}, {"tags": ["haskell", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "edited": false, "score": 0, "creation_date": 1573719431, "post_id": 58852012, "comment_id": 103976620, "body": "Oh, fab.  Thank you @bradrn!  That&#39;ll be just what I need."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "edited": false, "score": 0, "creation_date": 1573719583, "post_id": 58852012, "comment_id": 103976685, "body": "You\u2019re welcome @user3416536! I\u2019ve used this library before \u2014 it is indeed very useful for when you need it!"}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 2, "last_activity_date": 1573718720, "creation_date": 1573718720, "answer_id": 58852012, "question_id": 58851785, "link": "https://stackoverflow.com/questions/58851785/haskell-bounded-datatypes-constructed-from-value-bounds/58852012#58852012", "title": "Haskell Bounded DataTypes, constructed from value-bounds", "body": "<p>It is possible to design such a type; indeed, it has already been done! The <a href=\"https://hackage.haskell.org/package/finite-typelits\" rel=\"nofollow noreferrer\"><code>finite-typelits</code></a> library defines a type <code>Finite n</code>, which can only be inhabited by the values from <code>0</code> to <code>n-1</code>. For instance, <code>Finite 5</code> is inhabited by the numbers 0\u20134, but does not permit any other value. This functionality relies on the <code>DataKinds</code> extension, which allows the use of integers (amongst other things) at the type level. Take a look at the <a href=\"https://hackage.haskell.org/package/finite-typelits-0.1.4.2/docs/src/Data.Finite.Internal.html\" rel=\"nofollow noreferrer\">source code</a> of the library if you\u2019re interested in seeing how this works; the most important part is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- | Finite number type. @'Finite' n@ is inhabited by exactly @n@ values. Invariants:\n--\n-- prop&gt; getFinite x &lt; natVal x\n-- prop&gt; getFinite x &gt;= 0\nnewtype Finite (n :: Nat) = Finite Integer\n                          deriving (Eq, Ord, Generic)\n\n-- | Convert an 'Integer' into a 'Finite', throwing an error if the input is out of bounds.\nfinite :: KnownNat n =&gt; Integer -&gt; Finite n\nfinite x = result\n    where\n        result = if x &lt; natVal result &amp;&amp; x &gt;= 0\n            then Finite x\n            else error $ \"finite: Integer \" ++ show x ++ \" is not representable in Finite \" ++ show (natVal result)\n\n-- | Convert a 'Finite' into the corresponding 'Integer'.\ngetFinite :: Finite n -&gt; Integer\ngetFinite (Finite x) = x\n</code></pre>\n"}], "owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 58852012, "answer_count": 1, "score": 1, "last_activity_date": 1573718720, "creation_date": 1573717821, "question_id": 58851785, "link": "https://stackoverflow.com/questions/58851785/haskell-bounded-datatypes-constructed-from-value-bounds", "title": "Haskell Bounded DataTypes, constructed from value-bounds", "body": "<p>I have the following type in Haskell, to represent values between 0&amp;23.  There's more for handling the arithmetic; elided here for space.</p>\n\n<pre><code>newtype N24 = N_24 Word16\n  deriving (Enum, Eq, Integral, NFData, Ord, Real, Show)\n\ntoN24 \u2237 (Integral \u03b1, Num \u03b1) \u21d2 \u03b1 \u2192 N24\ntoN24 n@(toInteger \u2192 n') | n' &lt; toInteger (minBound @N24) = throw Underflow\n                         | n' &gt; toInteger (maxBound @N24) = throw Overflow\n                         | otherwise                     = N_24 (fromIntegral n)\n\ninstance Bounded N24 where\n  minBound = N_24 0\n  maxBound = N_24 23\n</code></pre>\n\n<p>Now, I want to build a similar type for N60.  And another for N12.</p>\n\n<p>My question is, can I design a higher-order type(?), e.g., 'BoundedN' such that I could declare </p>\n\n<p>n60 :: BoundedN 60\n  n12 :: BoundedN 12</p>\n\n<p>that implemented the above, but without having to copy-and-paste the entire definition.  I've tried to use Reflection, but honestly, I'm not understanding it and just bouncing on the keys trying to find stuff that works isn't getting me anywhere.  I could do it with TemplateHaskell, but I consider that a last resort (at best, it will be relatively hard to read, I fear).</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1573722893, "post_id": 58851339, "comment_id": 103978382, "body": "@WillNess yes, see the link in the upd vesion of answer, it produces the desired output"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1573755334, "post_id": 58851339, "comment_id": 103997396, "body": "For your <code>let skipZeros = ... in ...</code>, I would prefer <code>case dropWhile (==0) list of [] -&gt; 0; x:_ -&gt; x</code>. See also <a href=\"https://www.vex.net/~trebla/haskell/crossroad.xhtml\" rel=\"nofollow noreferrer\">A Crossroad at a Branch</a> for more about why."}], "tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1573808254, "last_edit_date": 1573808254, "creation_date": 1573715902, "answer_id": 58851339, "question_id": 58850992, "link": "https://stackoverflow.com/questions/58850992/merge-multiple-lists/58851339#58851339", "title": "Merge multiple lists", "body": "<p>You can use <code>transpose</code> (you may need <code>Data.List</code>) to swap lines and columns of your table to simplify the processing.</p>\n\n<p>Example:</p>\n\n<pre><code>[[0, 1, 0, 2, 3],\n [0, 0, 2, 0, 3]]\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>[[0, 0],\n [1, 0],\n [0, 2],\n [2, 0],\n [3, 3]]\n</code></pre>\n\n<p>Now you have a list of old columns, so you can process them one by one. For example, you could write such a function:</p>\n\n<pre><code>merge list = case dropWhile (== 0) of [] -&gt; 0\n                                      (x:_) -&gt; x\n</code></pre>\n\n<p>Here we drop all leading zeros from the list, and look if the remaining list has some value, then we take it, otherwise we get 0 as a result.</p>\n\n<p>Now we can use this function to process the transposed table like this:</p>\n\n<pre><code>mergeLists lists = map merge (transpose lists)\n</code></pre>\n\n<p>Now, we can get rid of parentheses:</p>\n\n<pre><code>mergeLists lists = map merge $ transpose lists\n</code></pre>\n\n<p>Or even get rid of argument (use composition):</p>\n\n<pre><code>mergeLists = map merge . transpose\n</code></pre>\n\n<p>Here we say, that merging lists is 1) transposing the table and 2) processing each column with <code>merge</code>. Each of these three versions is equivalent, so you can use any of them.</p>\n\n<p>Some further reading on composition: <a href=\"http://learnyouahaskell.com/higher-order-functions#composition\" rel=\"nofollow noreferrer\">http://learnyouahaskell.com/higher-order-functions#composition</a></p>\n\n<p>You can see how it works here: <a href=\"https://repl.it/repls/ReasonablePerfectOptimization\" rel=\"nofollow noreferrer\">https://repl.it/repls/ReasonablePerfectOptimization</a></p>\n\n<p>EDIT: fixed <code>merge</code> to use pattern matching</p>\n"}], "owner": {"reputation": 29, "user_id": 8233950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a27898e9ea62674c864d8d23f940cb?s=128&d=identicon&r=PG&f=1", "display_name": "lb098", "link": "https://stackoverflow.com/users/8233950/lb098"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 58851339, "answer_count": 1, "score": 0, "last_activity_date": 1573808254, "creation_date": 1573714351, "last_edit_date": 1573741271, "question_id": 58850992, "link": "https://stackoverflow.com/questions/58850992/merge-multiple-lists", "title": "Merge multiple lists", "body": "<p>Is there a way, in haskell to merge multiple lists to one list?\ne.g.:</p>\n\n<p>Input: </p>\n\n<pre><code>[\n[0,2,0,4,0,6,0,1,0,3,0,0,0,0,0],\n[0,0,3,0,0,6,0,0,2,0,0,0,0,0,1],\n[0,0,0,4,0,0,0,1,0,0,0,0,0,0,0],\n[0,0,0,0,0,0,0,0,0,3,0,0,0,0,1]\n] \n</code></pre>\n\n<p>Expected Output:\n<code>[0,2,3,4,0,6,0,1,2,3,0,0,0,0,1]</code></p>\n"}, {"tags": ["haskell", "types", "monads", "io-monad", "do-notation"], "answers": [{"comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 2, "creation_date": 1573716103, "post_id": 58850837, "comment_id": 103975232, "body": "To add to @Yuri&#39;s answer, <code>x &lt;- foo</code> gets translated to <code>foo &gt;&gt;= \\x -&gt; ...</code>. As simple as that."}, {"owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1573716330, "post_id": 58850837, "comment_id": 103975325, "body": "@arrowd, I thought that that&#39;s too into monads, so I told it is just a syntax sugar, and the second link explains the desugaring to <code>&gt;&gt;=</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1573719978, "post_id": 58850837, "comment_id": 103976867, "body": "@arrowd &quot;... and <code>(&gt;&gt;=)</code> does in fact have a type, which is ...&quot; etc."}], "tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": true, "score": 6, "last_activity_date": 1573713704, "creation_date": 1573713704, "answer_id": 58850837, "question_id": 58850631, "link": "https://stackoverflow.com/questions/58850631/what-is-the-type-of-in-haskell/58850837#58850837", "title": "What is the type of &lt;- in Haskell?", "body": "<p>Unfortunately, it is not a regular function, but a language construct. You can use it only in <code>do</code> blocks to \"extract\" value from some context, such as <code>IO</code>.</p>\n\n<p><code>do</code> blocks and <code>&lt;-</code> is just a syntax sugar for such things called <code>Monad</code>s (and <code>IO</code> is one of them).</p>\n\n<p>There are some other examples of such contexts, which you can use with <code>do</code> and <code>&lt;-</code>, such as lists, optional, or nullable, values (such as <code>Maybe Int</code>), stateful computations and so on.</p>\n\n<p>Some links:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/44965/what-is-a-monad\">What is a monad?</a></li>\n<li><a href=\"http://learnyouahaskell.com/a-fistful-of-monads#do-notation\" rel=\"noreferrer\">http://learnyouahaskell.com/a-fistful-of-monads#do-notation</a> (you need to understand functors and monads here)</li>\n</ul>\n"}], "owner": {"reputation": 4743, "user_id": 1697709, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ce4707be88278549d13843ce0d95fdd9?s=128&d=identicon&r=PG", "display_name": "Gergely", "link": "https://stackoverflow.com/users/1697709/gergely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 58850837, "answer_count": 1, "score": 2, "last_activity_date": 1573719887, "creation_date": 1573712787, "last_edit_date": 1573719887, "question_id": 58850631, "link": "https://stackoverflow.com/questions/58850631/what-is-the-type-of-in-haskell", "title": "What is the type of &lt;- in Haskell?", "body": "<p>I have a working program </p>\n\n<pre><code>main = do\n\n  inpStr &lt;- getLine\n  putStrLn ( \"Hello \" ++ inpStr )\n</code></pre>\n\n<p>where </p>\n\n<pre><code>putStrLn :: String -&gt; IO ()\n</code></pre>\n\n<p>and</p>\n\n<pre><code>getLine :: IO String  \n</code></pre>\n\n<p>From this can I conclude that the type of <code>&lt;-</code> is</p>\n\n<pre><code>IO a -&gt; a\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["haskell", "ghc", "haskell-stack", "haskell-ide-engine"], "comments": [{"owner": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 0, "creation_date": 1573718589, "post_id": 58849093, "comment_id": 103976266, "body": "AFAIK unfortunately there is no special direct support for scripts in hie, but it could be a improvement so consider open an issue in the project: <a href=\"https://github.com/haskell/haskell-ide-engine/issues/new\" rel=\"nofollow noreferrer\">github.com/haskell/haskell-ide-engine/issues/new</a>"}, {"owner": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 0, "creation_date": 1573718745, "post_id": 58849093, "comment_id": 103976316, "body": "hie itself uses a <a href=\"https://github.com/haskell/haskell-ide-engine/blob/master/install.hs\" rel=\"nofollow noreferrer\">script with another configuration</a>, the code executed by the script is in its own <a href=\"https://github.com/haskell/haskell-ide-engine/tree/master/install\" rel=\"nofollow noreferrer\">folder</a> and hie is able to handle it if you open the &#236;nstall` folder in your editor"}, {"owner": {"reputation": 1047, "user_id": 1146183, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d5152bd68f7c09d1c3172874b3ce2150?s=128&d=identicon&r=PG", "display_name": "Marcus Buffett", "link": "https://stackoverflow.com/users/1146183/marcus-buffett"}, "reply_to_user": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 0, "creation_date": 1575837813, "post_id": 58849093, "comment_id": 104690782, "body": "<a href=\"https://github.com/haskell/haskell-ide-engine/issues/1453\" rel=\"nofollow noreferrer\">github.com/haskell/haskell-ide-engine/issues/1453</a>"}, {"owner": {"reputation": 833, "user_id": 1007926, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc0133e5980f0289b82d223562ec0a49?s=128&d=identicon&r=PG", "display_name": "Peter Becich", "link": "https://stackoverflow.com/users/1007926/peter-becich"}, "edited": false, "score": 0, "creation_date": 1589854978, "post_id": 58849093, "comment_id": 109452126, "body": "Have you tried a <code>hie.yaml</code> file? <a href=\"https://github.com/mpickering/hie-bios/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/mpickering/hie-bios/blob/master/README.md</a> This file can be generated with: <a href=\"https://github.com/Avi-D-coder/implicit-hie\" rel=\"nofollow noreferrer\">github.com/Avi-D-coder/implicit-hie</a>"}], "owner": {"reputation": 1047, "user_id": 1146183, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d5152bd68f7c09d1c3172874b3ce2150?s=128&d=identicon&r=PG", "display_name": "Marcus Buffett", "link": "https://stackoverflow.com/users/1146183/marcus-buffett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1573718173, "creation_date": 1573703333, "last_edit_date": 1573718173, "question_id": 58849093, "link": "https://stackoverflow.com/questions/58849093/how-to-get-hie-to-detect-packages-installed-via-stack-for-scripts", "title": "How to get HIE to detect packages installed via stack for scripts", "body": "<p>I'm just getting started with learning how to use haskell for scripting, and I've got something like this:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-14.13 script\n{-# LANGUAGE OverloadedStrings #-}\nimport Turtle\n\nmain :: IO ()\nmain = echo \"hello\"\n</code></pre>\n\n<p>When I run this with <code>stack script.hs</code>, it auto-magically installs turtle and prints \"hello\". However, my editor gives me this error on the import line:</p>\n\n<pre><code>[ghcmod] [E] Could not find module \u2018Turtle\u2019\n</code></pre>\n\n<p>This makes some sense to me because the hie-wrapper I installed (from source, if it matters), isn't aware of where stack has installed the turtle package.</p>\n\n<p>The way I have my HIE hooked up is like so, using coc.nvim:</p>\n\n<pre><code>  \"languageserver\": {\n        \"haskell\": {\n            \"command\": \"hie-wrapper\",\n            \"rootPatterns\": [\n                \".stack.yaml\",\n                \"cabal.config\",\n                \"package.yaml\"\n            ],\n            \"filetypes\": [\n                \"hs\",\n                \"lhs\",\n                \"haskell\"\n            ],\n            \"initializationOptions\": {\n                \"languageServerHaskell\": {\n                }\n            },\n        }\n  },\n</code></pre>\n\n<p>Are there some flags or something I can pass to hie-wrapper to get it to play nicely with Haskell scripts, ie. detect packages? Would greatly appreciate any answer that makes it a bit more clear how this stuff fits together, ghc/hie/hie-wrapper/stack/cabal are a big black box to me currently, making this hard to debug.</p>\n"}, {"tags": ["haskell", "higher-order-functions"], "answers": [{"tags": [], "owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "is_accepted": true, "score": 0, "last_activity_date": 1573703825, "creation_date": 1573703825, "answer_id": 58849163, "question_id": 58848946, "link": "https://stackoverflow.com/questions/58848946/haskell-concat-filter-according-specific-rules/58849163#58849163", "title": "Haskell concat / filter according specific rules", "body": "<p>I'm supposing the <code>concat</code> and <code>filter</code> functions should be avoided. Why would we need to implement <code>concat</code> and <code>filter</code> if they're already available? So try implementing them from scratch.</p>\n\n<p>We can use <a href=\"https://wiki.haskell.org/Fold\" rel=\"nofollow noreferrer\"><em>folding</em></a> instead of recursion and list comprehensions. The below solutions use the function <code>foldr</code>.</p>\n\n<pre><code>foldr :: Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\n</code></pre>\n\n<pre><code>concat' :: [[a]] -&gt; [a]\nconcat' = foldr (++) []\n\nfilter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' p = foldr (\\x acc -&gt; if p x then x:acc else acc) [] \n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>main = do\n  print $ concat' [\"A\", \"B\", \"CAB\"]    -- \"ABCAB\"\n  print $ filter' (\\x -&gt; x `mod` 2 == 0) [1..9]  -- [2, 4, 6, 8]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": -1, "last_activity_date": 1573707686, "last_edit_date": 1573707686, "creation_date": 1573705321, "answer_id": 58849337, "question_id": 58848946, "link": "https://stackoverflow.com/questions/58848946/haskell-concat-filter-according-specific-rules/58849337#58849337", "title": "Haskell concat / filter according specific rules", "body": "<p>You may do as follows;</p>\n\n<pre><code>concat' :: Monad m =&gt; m (m b) -&gt; m b\nconcat' = (id =&lt;&lt;)\n\nfilter' p = ((\\x-&gt; if p x then [x] else []) =&lt;&lt;)\n</code></pre>\n\n<p><code>=&lt;&lt;</code> is just flipped version of the monadic bind operator <code>&gt;&gt;=</code>.</p>\n\n<pre><code>filter' (&lt; 10) [1,2,3,10,11,12]\n[1,2,3]\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 12368087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495ef9d8d155a88bb4ec150f7a17fb42?s=128&d=identicon&r=PG&f=1", "display_name": "Sorun", "link": "https://stackoverflow.com/users/12368087/sorun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 58849163, "answer_count": 2, "score": 1, "last_activity_date": 1573707686, "creation_date": 1573702182, "last_edit_date": 1573703247, "question_id": 58848946, "link": "https://stackoverflow.com/questions/58848946/haskell-concat-filter-according-specific-rules", "title": "Haskell concat / filter according specific rules", "body": "<p>According to following rules, I tried to solve the following problem:</p>\n\n<ol>\n<li>No definition of recursion</li>\n<li>No List of Comprehension</li>\n<li>Only Prelude-Module is allowed.</li>\n</ol>\n\n<p>Now I have to implement higher-order for <strong>concat</strong> and <strong>filter</strong>.</p>\n\n<p>Im at this point:</p>\n\n<pre><code>concat' :: [[a]] -&gt; [a]\nconcat' a = (concat a)\n\nfilter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' p [] = []\nfilter' p (x:xs) \n            | p x = x : filter p xs\n            | otherwise = filter p xs\n</code></pre>\n\n<p>The concat function is working (nothing special so far) -> Is that a defined recursion? I mean I use the predefined concat from standard-prelude but myself I don't define it - or am I wrong?</p>\n\n<p>For the filter, the function I've looked up the definition of standard prelude but that's either not working and it contains a definition of recursion.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "edited": false, "score": 0, "creation_date": 1573813883, "post_id": 58848618, "comment_id": 104017860, "body": "sorry, but you have 2 answers there (one is mine), will you accept any of them?"}], "answers": [{"tags": [], "owner": {"reputation": 13216, "user_id": 334220, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9327a38f87c7890273f055743821591f?s=128&d=identicon&r=PG", "display_name": "Mau", "link": "https://stackoverflow.com/users/334220/mau"}, "is_accepted": true, "score": 1, "last_activity_date": 1573704053, "creation_date": 1573704053, "answer_id": 58849193, "question_id": 58848618, "link": "https://stackoverflow.com/questions/58848618/trying-to-build-a-lexical-analysis-program-in-haskell/58849193#58849193", "title": "trying to build a lexical analysis program in Haskell", "body": "<p>If i interpret your idea correctly, this could be a possible solution:</p>\n\n<pre><code>resNames = [\"function\",\"while\",\"for\",\"const\",\"let\",\"this\",\"true\",\"false\",\";\",\"=\", \"()\", \"var\"]\n\n-- Determine whether an element is in a list\nfindVal :: String-&gt;[String]-&gt;Bool\nfindVal _ [] = False\nfindVal x (namesH:namesT) =\n  if x == namesH\n  then True\n  else (findVal x namesT) \n\n-- Loop over input list and for each element, if not in reserved list, add to accumulator\nfilterResNamesAcc :: [String]-&gt;[String]-&gt;[String]-&gt;[String]\nfilterResNamesAcc _ [] acc = acc\nfilterResNamesAcc [] _ acc = acc\nfilterResNamesAcc (inH:inT) names acc =\n  if (findVal inH names)\n  then (filterResNamesAcc inT names acc)\n  else (filterResNamesAcc inT names (inH:acc))\n\n-- Invoke filterResNamesAcc with empty accumulator\nfilterResNames :: [String]-&gt;[String]-&gt;[String]\nfilterResNames inL names = reverse (filterResNamesAcc inL names [])\n\nmain = do\n   print (filterResNames [\"hello\", \"for\", \"the\", \"world\"] resNames)\n</code></pre>\n\n<p>What we use here is a typical accumulator pattern used in functional languages. The \"problem\" with <code>filterResNamesAcc</code> is that using <code>:</code> to prepend to the accumulator causes the result to be reversed, hence the call to <code>reverse</code>.</p>\n\n<p>Left 'to the reader':</p>\n\n<ol>\n<li>Implementing your own reverse or figuring out a more complex folding pattern that doesn't need it.</li>\n<li>Changing the signature of <code>filterResNames</code> to take a single string and do the tokenization.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1573712837, "creation_date": 1573712837, "answer_id": 58850641, "question_id": 58848618, "link": "https://stackoverflow.com/questions/58848618/trying-to-build-a-lexical-analysis-program-in-haskell/58850641#58850641", "title": "trying to build a lexical analysis program in Haskell", "body": "<p>It's better to learn the standard library by implementing it by hands, so you:</p>\n\n<ol>\n<li>Get your hands dirty while implementing it, and get some practice</li>\n<li>Learn all those useful tools from standard library, which you could use out-of-the-box when got familiar enough with them</li>\n</ol>\n\n<p>So, you need to \"filter\" some list on some condition, and that's the famous <code>filter</code> standard function:</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter _ [] = []\nfilter cond (x : xs) = let tail = filter cond xs\n                       in if cond x\n                          then x:tail\n                          else tail\n</code></pre>\n\n<p>Here we leave only such <code>x</code>'s, that have <code>cond x</code> equal <code>True</code>. For example, <code>filter even [1..10] == [2,4,6,8,10]</code>.</p>\n\n<p>We'll use it to filter out only reserved words. Now we need to construct the condition. So we need to check whether a word in in the reserved list. And that's standard <code>elem</code> function:</p>\n\n<pre><code>elem :: (Eq a) =&gt; a -&gt; [a] -&gt; Bool\nelem _ [] = False\nelem x (y:ys) = x == y || elem x ys\n</code></pre>\n\n<p>Here we need such called <a href=\"http://learnyouahaskell.com/types-and-typeclasses#typeclasses-101\" rel=\"nofollow noreferrer\">type constraint</a> that says \"you can use this only with types that support <code>==</code> check\". <code>String</code> is the case, so you can use it like this:</p>\n\n<pre><code>elem \"if\" [\"for\", \"if\", \"else\", \"function\"] == True\n</code></pre>\n\n<p>And now we are ready to get the result with our tools:</p>\n\n<pre><code>filterResNames :: [String] -&gt; [String] -&gt; [String]\nfilterResNames toCheck resNames = filter (`elem` resNames) toCheck\n</code></pre>\n\n<p>Here we use some tricks:</p>\n\n<ol>\n<li><p>Every function of 2 arguments may be used as an operator like <code>+</code> or <code>==</code> if you surround it's name with ` (backticks) symbols:\n<code>elem x lst</code> is equivalent to <code>x `elem` lst</code></p></li>\n<li><p>If you take the expression of form <code>x someOperator y</code>, enclose it in the parentheses <code>(x someOperator y)</code> and omit one of the operands <code>(someOperator y)</code>, then you'll automatically get a function, that takes this \"omitted\" operand and \"pastes\" it into the expression. Some examples:</p>\n\n<ul>\n<li><code>(+1)</code> - take a value and increase it by 1</li>\n<li><code>(== x)</code> - take a value and check if it's equal to <code>x</code></li>\n<li><code>(2 ^)</code> - given some <code>n</code> get the <code>n</code>th power of 2</li>\n<li><code>(`elem` someList)</code> - take a value and check if it's contained in <code>someList</code></li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 93, "user_id": 3002565, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6e1482fb70ade96419707c7690ae3dea?s=128&d=identicon&r=PG&f=1", "display_name": "MV_81", "link": "https://stackoverflow.com/users/3002565/mv-81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 58849193, "answer_count": 2, "score": 2, "last_activity_date": 1573712837, "creation_date": 1573699431, "question_id": 58848618, "link": "https://stackoverflow.com/questions/58848618/trying-to-build-a-lexical-analysis-program-in-haskell", "title": "trying to build a lexical analysis program in Haskell", "body": "<p>I'm starting this project and made very little progress. I'm just starting with haskell so I would like to use only functions implemented by me so that I put my brain into action.</p>\n\n<p>I want to take two lists of strings, one that represents code and the other has reserved names for a given language. I would like to be able to filter said words from the first list.</p>\n\n<pre><code>\nresNames = [\"function\",\"while\",\"for\",\"const\",\"let\",\"this\",\"true\",\"false\",\";\",\"=\", \"()\", \"var\"]\n\nfindVal :: [String]-&gt;String-&gt;[String]\nfindVal z \" \" = z\nfindVal [] value = []\nfindVal (x:y) value = if x == value then findVal y value\n                      else x:(findVal y value) \n\nfilterResNames :: [String]-&gt;[String]-&gt;[String]\nfilterResNames z [] = z\nfilterResNames [] z = []\nfilterResNames (x:y) (u:v) = if x== u then findVal (x:y) (u) else x:(filterResNames y (u:v))```\n\nThis obviously doesn't work because the program stops as soon as it finds a match...\n</code></pre>\n"}, {"tags": ["haskell", "haskell-wai", "hspec", "haskell-spock"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1573716395, "post_id": 58847595, "comment_id": 103975345, "body": "I think, you did right, only got confused with types. What&#39;s <code>st</code> in your case? Does <code>stuff</code> really accept that?"}, {"owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1574112213, "post_id": 58847595, "comment_id": 104107645, "body": "@arrowd Yeah, confused with types is exactly my problem, I guess. The <code>st</code> in my question is just the wording from the Hspec-Wai documentation; it&#39;s not really clear to me what it is, or should be, for it to work. <code>stuff</code> is a getter on my state type (my state is basically <code>type MyState = MyState { stuff :: Maybe Text }</code>, so <i>if</i> I manage to tell the test what my state type is correctly, then it should work.  Once I have this working, I&#39;m also going to want to modify my state to be a <code>TVar MyState</code>, so that might complicate things I guess... :/"}], "answers": [{"comments": [{"owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 0, "creation_date": 1574278762, "post_id": 58926896, "comment_id": 104179395, "body": "Note that in my original snippet I do have <code>with app</code>, but not at the top-level of the stack. If I have to move it there, how do I control the initial state of the app?"}, {"owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 0, "creation_date": 1574371705, "post_id": 58926896, "comment_id": 104220585, "body": "I re-worded the question and provided a shorter code sample of what I&#39;m trying to do; would you mind taking another look?"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 0, "creation_date": 1574393891, "post_id": 58926896, "comment_id": 104226226, "body": "<a href=\"https://hackage.haskell.org/package/stm-2.5.0.0/docs/Control-Concurrent-STM-TVar.html#v:readTVarIO\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/stm-2.5.0.0/docs/&hellip;</a> this?"}, {"owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 0, "creation_date": 1574416837, "post_id": 58926896, "comment_id": 104234399, "body": "Unfortunately that doesn&#39;t compile; it gives me a type mismatch, expecting a <code>WaiSession a b</code> (don&#39;t remeber the exact types of <code>a</code> and <code>b</code> now, but can check when I get home) but getting an <code>IO Text</code>"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 0, "creation_date": 1574419992, "post_id": 58926896, "comment_id": 104236102, "body": "<code>WaiSession</code> is an instance of <code>MonadIO</code>, so you can use <code>liftIO</code> to turn <code>IO</code> into <code>WaiSession</code>."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 0, "last_activity_date": 1574139307, "creation_date": 1574139307, "answer_id": 58926896, "question_id": 58847595, "link": "https://stackoverflow.com/questions/58847595/testing-the-state-updates-of-a-wai-application/58926896#58926896", "title": "Testing the state updates of a wai application", "body": "<p>I think the problem is that you forgot to wrap whole your <code>spec</code> into <code>with app</code>, like it is done in <code>hspec-wai</code>s README:</p>\n\n<pre><code>spec :: Spec\nspec = with app $ do\n  describe \"GET /\" $ do\n    it \"responds with 200\" $ do\n      get \"/\" `shouldRespondWith` 200\n</code></pre>\n"}], "owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574371670, "creation_date": 1573690923, "last_edit_date": 1574371670, "question_id": 58847595, "link": "https://stackoverflow.com/questions/58847595/testing-the-state-updates-of-a-wai-application", "title": "Testing the state updates of a wai application", "body": "<p>I have an application written on top of <a href=\"http://hackage.haskell.org/package/wai\" rel=\"nofollow noreferrer\">Wai</a>, configured to have some custom state and be testable with <a href=\"http://hackage.haskell.org/package/hspec-wai-0.10.1/docs/Test-Hspec-Wai.html\" rel=\"nofollow noreferrer\">Test.Hspec.Wai</a>.</p>\n\n<p>I can test request/response interactions, but I haven't been able to figure out how to test for state changes; specifically, if my application state is a <code>TVar Text</code>, how do I get the value out of it inside the test, in order to verify its value?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- app :: TVar Text -&gt; IO Application\n-- is defined in my application library\n\nwrapp :: Text -&gt; IO (TVar Text, Application)\nwrapp s = do\n  s' &lt;- newTVarIO s\n  a &lt;- app s'\n  return (s', a)\n\nspec :: Spec\nspec = withState (wrapp \"hello\") $ do\n  describe \"x\" $ it \"x\" $ do\n      st &lt;- getState -- st is TVar Text.\n      s &lt;- undefined -- WHAT DO I PUT HERE TO GET THE STATE OUT OF TVar?\n      get \"/\" `shouldRespondWith` \"\\\"hello, world!\\\"\"\n      s `shouldBe` \"hello\"\n</code></pre>\n\n<hr>\n\n<p><sup>*) Note that the <code>getState</code> method I'm talking about here is not exported in the latest LTS at the time of writing; add hspec-wai-0.10.1 to <code>extra-deps</code> to get a version that has all the features mentioned here.</sup></p>\n"}]