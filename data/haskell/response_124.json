[{"tags": ["templates", "haskell", "pandoc", "hakyll"], "answers": [{"tags": [], "owner": {"reputation": 7230, "user_id": 788337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wiVpx.png?s=128&g=1", "display_name": "jmite", "link": "https://stackoverflow.com/users/788337/jmite"}, "is_accepted": false, "score": 1, "last_activity_date": 1495766805, "creation_date": 1495766805, "answer_id": 44192802, "question_id": 44169773, "link": "https://stackoverflow.com/questions/44169773/how-do-i-concat-pages/44192802#44192802", "title": "How do I concat pages?", "body": "<p>After some searching, it looks like the solution has two parts:</p>\n\n<ul>\n<li>Use <code>saveSnapshot</code> to record the results of <code>pandocBiblioCompiler</code> for each page</li>\n<li>Use <code>makeItem =&lt;&lt; applyTemplateList template context =&lt;&lt; loadAllSnapshots \"pubs/*\" \"biblio\"</code> to load the snapshots, concatenate them, and turn them into an <code>Item</code></li>\n</ul>\n"}], "owner": {"reputation": 7230, "user_id": 788337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wiVpx.png?s=128&g=1", "display_name": "jmite", "link": "https://stackoverflow.com/users/788337/jmite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496559715, "creation_date": 1495666700, "last_edit_date": 1496559715, "question_id": 44169773, "link": "https://stackoverflow.com/questions/44169773/how-do-i-concat-pages", "title": "How do I concat pages?", "body": "<p>I'm trying to automatically generate a bibliography in Hakyll. I'm using the <code>nocite</code> pandoc feature to generate a list of all publications in a .bib file. But, I'd like to have different sections (i.e. peer reviewed, theses, posters, etc.)</p>\n\n<p>My idea on how to do this was to have a template like the following:</p>\n\n<pre><code>---\ntitle: $title$\n---\n**Section: $title**\n---\nnocite: |\n  @*\n---\n</code></pre>\n\n<p>Then, I'd do the following:</p>\n\n<ul>\n<li>Use <code>pandocBiblioCompiler</code> to generate the page with the bibliography for each .bib file, applying the above template</li>\n<li>Concatenate them into one page</li>\n<li>Apply my main template (sidebar, navigation, etc.) to get the final page.</li>\n</ul>\n\n<p>Is this possible? How do I concatenate multiple pages into one page in my <code>site.hs</code>?</p>\n"}, {"tags": ["haskell", "combinations", "fold"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1495667089, "post_id": 44169741, "comment_id": 75355415, "body": "Did you intentionally leave out <code>[5,2]</code> because you want only contiguous sublists?"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1495667206, "post_id": 44169741, "comment_id": 75355451, "body": "No no @Alec, I forget it, thank you, I updated the q"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1495667366, "post_id": 44169741, "comment_id": 75355494, "body": "An equivalent without <code>foldr</code> is <code>sublistas = filterM (const [True, False])</code>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1495667524, "post_id": 44169741, "comment_id": 75355531, "body": "<code>sublists = foldr (\\x l -&gt; l ++ map (x:) l) [[]]</code>"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1495667562, "post_id": 44169741, "comment_id": 75355544, "body": "O.O holly... @4castle, how that can even be posible? haha, wow! did you thinked it?"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1495667719, "post_id": 44169741, "comment_id": 75355593, "body": "For funzies, the contiguous sublists would be <code>sublistas xs = tails xs &gt;&gt;= tail . inits</code>"}], "answers": [{"comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1495667883, "post_id": 44169900, "comment_id": 75355646, "body": "That works just perfect, do you mind to explain to me, why did you put rs ++ map ... why is that? how it works?"}, {"owner": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "edited": false, "score": 0, "creation_date": 1495714250, "post_id": 44169900, "comment_id": 75374446, "body": "<code>foldr</code> just traverses the list, accumulating partial result. With your example - <code>sublistas [5,1,2] = f 5 (f 1 ( f 2 ([[]])))</code>. Consider last step - <code>f 5 [[],[2],[1],[1,2]]</code> In the final result we want to see two type of sublists - whose, that have <code>5</code>, it&#39;s <code>map (x:) rs</code>, and whose do not, it&#39;s just <code>rs</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1495668263, "last_edit_date": 1495668263, "creation_date": 1495667577, "answer_id": 44169900, "question_id": 44169741, "link": "https://stackoverflow.com/questions/44169741/haskell-sublist-with-foldr/44169900#44169900", "title": "Haskell sublist with foldr", "body": "<p>You can use:</p>\n\n<pre><code>foldr (\\x rs -&gt; <b>rs</b> ++ map (x:) rs) [[]]</code></pre>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; foldr (\\x rs -&gt; rs ++ map (x:) rs) [[]] [5,1,2]\n[[],[2],[1],[1,2],[5],[5,2],[5,1],[5,1,2]]\n</code></pre>\n\n<p>The proposed <code>foldr</code> thus works as follows: we start with a <code>[[]]</code>. Now for an element <code>x</code>, we generate the concatenation, of all lists already generated (in the first step <code>[]</code>, and these lists prepended with the element, so <code>[2]</code>).</p>\n\n<p>So after a first step, we obtain <code>[[],[2]]</code>. Next we fold again and now we generate <code>[[],[2],[1],[1,2]]</code>. Finally we also work with <code>5</code>, resulting in <code>[[],[2],[1],[1,2],[5],[5,2],[5,1],[5,1,2]]</code>.</p>\n\n<p>The above explanation has to be seen in a lazy manner: <code>rs</code> is not necessary calculated (first), unless that is necessary.</p>\n\n<hr>\n\n<p>Your lambda expression <code>\\x rs -&gt; [x] ++ map (x:) rs</code> is incorrect for two reasons:</p>\n\n<ul>\n<li><code>[x]</code> is a list containing a <strong>item</strong> of the list you provide, not a list of lists of items you provide, so a type error; and</li>\n<li>you should not add an <code>[x]</code> to the result anyway: you pass all elements that are already generated, together with all the elements you prepend with <code>x</code>.</li>\n</ul>\n"}], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 1, "accepted_answer_id": 44169900, "answer_count": 1, "score": 1, "last_activity_date": 1495668310, "creation_date": 1495666483, "last_edit_date": 1495668310, "question_id": 44169741, "link": "https://stackoverflow.com/questions/44169741/haskell-sublist-with-foldr", "title": "Haskell sublist with foldr", "body": "<p>I'm trying to make a function in haskell but my goal is doing it by using foldr over list, this is an example:</p>\n\n<pre><code>sublistas [5,1,2] \n [[],[2],[1],[1,2],[5],[5,2],[5,1],[5,1,2]]\n</code></pre>\n\n<p>efficiency is not an issue. What I try so far gives to me the error:</p>\n\n<blockquote>\n  <p>cannot construct the infinite type .....</p>\n</blockquote>\n\n<pre><code>sublistas = foldr (\\x rs -&gt; [x] ++ map (x:) rs) [[]]\n</code></pre>\n\n<p>I tried a long time, maybe someone could give me some ideas here?</p>\n"}, {"tags": ["haskell", "dependent-type", "type-constraints", "gadt", "type-families"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1495658693, "post_id": 44167823, "comment_id": 75352313, "body": "Forget the kind/type problem, why is the second argument of your <i>constructor</i> a <i>type</i>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1495658966, "post_id": 44167823, "comment_id": 75352426, "body": "The code here is so thoroughly off, and also so thoroughly reduced, that it&#39;s pretty much impossible to tell what you&#39;re trying to accomplish. Could you please give some more context explaining what you&#39;re trying to do, what you want the types to mean, how you intend to use them, etc.?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1495659414, "post_id": 44167823, "comment_id": 75352645, "body": "If you want your code to typecheck, just remove the first <code>&#39;Resource</code>: <code>Has :: Concept a -&gt; Construct (Concept a) (&#39;Resource b)</code>. But I would guess that you want <i>both</i> your fields to be promoted to types; in which case, you want something like <code>Has :: Construct (x :: Concept a) (&#39;Resource b)</code>; in this case, you probably also want to declare the <i>kind</i> of your type: <code>data Construct (a :: Concept ak) (b :: Concept bk) where Has :: Construct a (&#39;Resource b)</code>"}, {"owner": {"reputation": 1665, "user_id": 13187, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/661601c21bb8217a580abffcb9864e7b?s=128&d=identicon&r=PG", "display_name": "kaychaks", "link": "https://stackoverflow.com/users/13187/kaychaks"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1495712829, "post_id": 44167823, "comment_id": 75373454, "body": "@user2407038: I&#39;ve updated the post based on your suggestions but have some more questions that I&#39;ve also added to the post."}, {"owner": {"reputation": 1665, "user_id": 13187, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/661601c21bb8217a580abffcb9864e7b?s=128&d=identicon&r=PG", "display_name": "kaychaks", "link": "https://stackoverflow.com/users/13187/kaychaks"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1495712928, "post_id": 44167823, "comment_id": 75373522, "body": "@dfeuer apologise for the vagueness earlier, I&#39;ve edited the post with more information &amp; have tried to clarify my intent. Hope it helps now"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495714512, "post_id": 44167823, "comment_id": 75374593, "body": "I&#39;m fairly certain you need a type family <code>Has :: Concept -&gt; Constraint</code>. Since the <code>Has</code> relation has no semantic, you need to create meaning yourself."}], "answers": [{"tags": [], "owner": {"reputation": 1665, "user_id": 13187, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/661601c21bb8217a580abffcb9864e7b?s=128&d=identicon&r=PG", "display_name": "kaychaks", "link": "https://stackoverflow.com/users/13187/kaychaks"}, "is_accepted": false, "score": 3, "last_activity_date": 1495762450, "creation_date": 1495762450, "answer_id": 44192248, "question_id": 44167823, "link": "https://stackoverflow.com/questions/44167823/constraining-types-in-gadt-constructor/44192248#44192248", "title": "Constraining types in GADT constructor", "body": "<p>Thanks to Cale at #haskel-beginners for suggesting this solution by introducing a phantom type and tagging the same in the <code>Concept</code> GADT</p>\n\n<pre><code>{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE GADTs #-}\n\ndata ConceptType = EntityT | RoleT | RelationT | ResourceT | SubT ConceptType\n\ndata Concept (t :: ConceptType) a where\n  Entity :: a -&gt; Concept EntityT a\n  Role :: a -&gt; Concept RoleT a\n  Relation :: a -&gt; Concept RelationT a\n  Resource :: a -&gt; Concept ResourceT a\n  Sub :: Concept t a -&gt; Concept (SubT t) a\n\ndata Construct t a b where\n  Has :: Concept t a -&gt; Concept ResourceT b -&gt; Construct t a b\n</code></pre>\n"}], "owner": {"reputation": 1665, "user_id": 13187, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/661601c21bb8217a580abffcb9864e7b?s=128&d=identicon&r=PG", "display_name": "kaychaks", "link": "https://stackoverflow.com/users/13187/kaychaks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1495762450, "creation_date": 1495657380, "last_edit_date": 1495712092, "question_id": 44167823, "link": "https://stackoverflow.com/questions/44167823/constraining-types-in-gadt-constructor", "title": "Constraining types in GADT constructor", "body": "<p>I've a simple ADT</p>\n\n<pre><code>data Concept a = Entity  a |  Role a | Relation a | Resource a | Sub (Concept a)\n</code></pre>\n\n<p>Now I want to create a GADT using this ADT that will constrain the type signature of it's constructors. This code won't work but I want to do something like this:</p>\n\n<pre><code>data Construct a b where\n      Has :: Concept a -&gt; 'Resource b -&gt; Construct (Concept a) ('Resource b)\n</code></pre>\n\n<p>I.e. <code>Has</code> constructor for <code>Construct</code> can have first type param as a <code>Concept</code> of any form but the second type param should be a <code>Resource</code> constructor (promoted to be a type). This signature is failing as am using kind in place of type. But I want to realise something like this and am failing to wrap my head around how to do the same.</p>\n\n<p>I'm importing <code>{-# LANGUAGE GADTs, TypeInType #-}</code>.</p>\n\n<p>Edit:</p>\n\n<p>Based on one comment, if I do this</p>\n\n<pre><code> data Construct (a :: Concept ak) (b :: Concept bk)  where\n  Has :: Construct a ('Resource b)\n</code></pre>\n\n<p>Then it's is type-checking. But now how can I extract values when pattern matching on <code>Has</code></p>\n\n<pre><code>f :: Construct a b -&gt; T.Text\nf Has = ???\n</code></pre>\n\n<p>My requirement is I want to constrain types for <code>Has a b</code> constructor so that it can only allow <code>a :: Concept ak</code> (i.e. any Concept) and <code>(b ~ 'Resource *) =&gt; (b :: Concept bk)</code>[1] (i.e. only Resource type of Concept) e.g.</p>\n\n<pre><code>-- Concept values\nperson = Entity \"person\"\nname = Resource \"name\"\nrole = Role \"father\"\n\n-- I want this to be valid\npersonHasName = Has person name\n\n-- And this to be invalid\npersonHasRole = Has person role\n</code></pre>\n\n<p>[1] - After some reading of Constraints in Kinds, Type Families &amp; Singleton Types, I guess it's possible to realise this kind of constraint via these principles. But I am completely at loss to make it work</p>\n"}, {"tags": ["haskell", "types", "maybe"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 7996595, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/227275469df68e9e9218670936651c6a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Mayer", "link": "https://stackoverflow.com/users/7996595/r-mayer"}, "edited": false, "score": 0, "creation_date": 1495658199, "post_id": 44167758, "comment_id": 75352093, "body": "To be honest, I don&#39;t understand that code. how do i need to modify my function (showGrandmother) that it works?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 79, "user_id": 7996595, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/227275469df68e9e9218670936651c6a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Mayer", "link": "https://stackoverflow.com/users/7996595/r-mayer"}, "edited": false, "score": 1, "creation_date": 1495659639, "post_id": 44167758, "comment_id": 75352772, "body": "@R.Mayer Please try to convert &quot;I don&#39;t understand that code&quot; into a question that can be answered. (What is difficult for you to understand? Where are you getting stuck in reading the code?) As for &quot;how do I need to modify my function&quot;, well, let&#39;s just say the answer to that will follow <i>incredibly</i> quickly on understanding the answer written here."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1495670151, "post_id": 44167758, "comment_id": 75356216, "body": "additional note for naming convention.  your method is not a <code>show</code> method.  The return value is not <code>String</code> representation but the actual <code>Person</code> value, so naming it as <code>showX</code> is misleading..."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 4, "last_activity_date": 1543510229, "last_edit_date": 1543510229, "creation_date": 1495657162, "answer_id": 44167758, "question_id": 44167571, "link": "https://stackoverflow.com/questions/44167571/datatype-person-mother-from-mother-grandmother/44167758#44167758", "title": "Datatype Person mother from mother (grandmother)", "body": "<p>first, your data definition is missing the base case.  Assuming this represents <a href=\"https://en.wikipedia.org/wiki/Matrilineality\" rel=\"nofollow noreferrer\">matrilineality</a>, I would start with <code>Eve</code> as the base case</p>\n\n<pre><code>data Person = Eve | Person String Person deriving (Show)\n</code></pre>\n\n<p>defining <code>mother</code> function</p>\n\n<pre><code>mother Eve = Nothing\nmother (Person _ m) = Just m\n</code></pre>\n\n<p>now grandmother is applying this twice</p>\n\n<pre><code>grandmother = \\x -&gt; mother x &gt;&gt;= mother\n</code></pre>\n\n<p>With Control.Monad Kleiski operators, this can be written much nicely</p>\n\n<pre><code>grandmother = mother &gt;=&gt; mother\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "is_accepted": false, "score": 2, "last_activity_date": 1495714834, "last_edit_date": 1495714834, "creation_date": 1495695902, "answer_id": 44174331, "question_id": 44167571, "link": "https://stackoverflow.com/questions/44167571/datatype-person-mother-from-mother-grandmother/44174331#44174331", "title": "Datatype Person mother from mother (grandmother)", "body": "<p>With pattern matching, you aren't limited to one level of constructors, you can nest them to go further \"in\":</p>\n\n<pre><code>showGrandmother :: Person -&gt; Maybe Person\nshowGrandmother (Person _ (Person _ grandmother)) = Just grandmother\n</code></pre>\n\n<hr>\n\n<p>As a sidenote, I'm not a Haskell expert, but it seems like the data type is a bit circular for what is meant to be a model of a family tree. You can't actually create a person without it referencing another person. Maybe something better would be...</p>\n\n<pre><code>data Person = Person String (Maybe Person)\n</code></pre>\n\n<p>... in which case, finding the grandmother can be done as...</p>\n\n<pre><code>showGrandmother :: Person -&gt; Maybe Person\nshowGrandmother (Person _ Just (Person _ (Just grandmother)))) = Just grandmother\nshowGrandmother _                                              = Nothing\n</code></pre>\n\n<p>... making sure to handle the base case when someone doesn't have a grandmother. Your original type didn't need to handle this case because everyone must have a grandmother according to it.</p>\n\n<hr>\n\n<p>And taking inspiration from the <a href=\"https://stackoverflow.com/a/44167758/1319998\">@Karafka's answer</a>, it's possible to factor out finding the mother of a person...</p>\n\n<pre><code>showMother :: Person -&gt; Maybe Person\nshowMother (Person _ (Just mother)) = Just mother\nshowMother _                        = Nothing\n</code></pre>\n\n<p>... and using the fact that <code>Maybe</code> is a monad, can use it as below.</p>\n\n<pre><code>showGrandmother :: Person -&gt; Maybe Person\nshowGrandmother x = showMother x &gt;&gt;= showMother\n</code></pre>\n\n<p>I suspect understanding the above monadic code would be out of scope for this particular question.</p>\n"}], "owner": {"reputation": 79, "user_id": 7996595, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/227275469df68e9e9218670936651c6a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Mayer", "link": "https://stackoverflow.com/users/7996595/r-mayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 44167758, "answer_count": 2, "score": 0, "last_activity_date": 1543510229, "creation_date": 1495656418, "last_edit_date": 1495659093, "question_id": 44167571, "link": "https://stackoverflow.com/questions/44167571/datatype-person-mother-from-mother-grandmother", "title": "Datatype Person mother from mother (grandmother)", "body": "<p>Imagine I've got a datatype <code>Person</code>.</p>\n\n<pre><code>data Person = Person String Person\n</code></pre>\n\n<p>The 2. Person should be the mother.</p>\n\n<pre><code>showGrandmother :: Person -&gt; Maybe Person\nshowGrandmother (Person _ mother) = Just mother\n</code></pre>\n\n<p>Will only show the mother from person x.\nHow can I show the grandmother?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1495655136, "post_id": 44166940, "comment_id": 75350633, "body": "I&#39;m trying to understand why this question is tagged &quot;monads&quot; - What specifically are you asking about monads?"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8061440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc74d7907da751af5a276a621ad42c52?s=128&d=identicon&r=PG&f=1", "display_name": "Erich Melvin", "link": "https://stackoverflow.com/users/8061440/erich-melvin"}, "edited": false, "score": 0, "creation_date": 1495655943, "post_id": 44167140, "comment_id": 75350994, "body": "I wrote my parser for this, and worked it! Thanks, I understood the process, haskell makes it seem easy this kind of operation hahahahahaha"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 1, "last_activity_date": 1495654758, "creation_date": 1495654758, "answer_id": 44167140, "question_id": 44166940, "link": "https://stackoverflow.com/questions/44166940/use-only-integers-of-a-file-with-text/44167140#44167140", "title": "Use only Integers of a file with text", "body": "<p>Well this might be kind of a cheat, but the contents of that file is a valid Haskell expression so you could use <code>Read</code> to do it:</p>\n\n<pre><code>import System.IO (readFile)\n\ndata Word = Word (Integer,Integer)\n    deriving (Read)\n\nmain = do\n    contents &lt;- readFile \"path/to/file\" -- or wherever your file is\n    let Word (x,y) = read contents\n    print $ broke x\n</code></pre>\n\n<p>The reason this works is that <code>deriving (Read)</code> automatically writes a parser for you, so you get the function <code>read :: String -&gt; Word</code> for free.  So this technique is only going to work for files whose contents look like Haskell -- otherwise you will need to write your own <a href=\"https://two-wrongs.com/parser-combinators-parsing-for-haskell-beginners\" rel=\"nofollow noreferrer\">parser</a>.</p>\n"}], "owner": {"reputation": 7, "user_id": 8061440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc74d7907da751af5a276a621ad42c52?s=128&d=identicon&r=PG&f=1", "display_name": "Erich Melvin", "link": "https://stackoverflow.com/users/8061440/erich-melvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 44167140, "answer_count": 1, "score": 0, "last_activity_date": 1495657359, "creation_date": 1495653905, "last_edit_date": 1495657359, "question_id": 44166940, "link": "https://stackoverflow.com/questions/44166940/use-only-integers-of-a-file-with-text", "title": "Use only Integers of a file with text", "body": "<p>My function works ok. But I want to use this function with a file's text. The text file has a word before an integer list. How can I do this?</p>\n\n<p>This is the function:</p>\n\n<pre><code>broke :: Integer -&gt; Integer\nbroke n = pollard 1 2 n 2 2\n</code></pre>\n\n<p>The contents of the file is:</p>\n\n<pre><code>Word (11,12)\n</code></pre>\n\n<p>I want to apply the function <code>broke</code> to the first number.</p>\n"}, {"tags": ["haskell", "gtk3"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 3801711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/YwxQm.jpg?s=128&g=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/3801711/arthur"}, "edited": false, "score": 0, "creation_date": 1495702564, "post_id": 44168318, "comment_id": 75367284, "body": "Oh that&#39;s great! Thanks a lot!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1495659428, "creation_date": 1495659428, "answer_id": 44168318, "question_id": 44164600, "link": "https://stackoverflow.com/questions/44164600/is-it-possible-to-compare-two-gobjects-with-haskell-gi-and-find-out-if-theyre-t/44168318#44168318", "title": "Is it possible to compare two gobjects with haskell-gi and find out if they&#39;re the same?", "body": "<p>Disclaimer: although I am a Haskell expert, I know little about haskell-gi specifically. That said...</p>\n\n<p>Looking at the documentation, we have:</p>\n\n<pre><code>newtype Widget = Widget (ManagedPtr Widget)\ndata ManagedPtr a = ManagedPtr {\n    managedForeignPtr :: ForeignPtr a\n  , managedPtrIsOwned :: IORef Bool\n  }\n</code></pre>\n\n<p>All the appropriate constructors are exported, and both <code>ForeignPtr</code> and <code>IORef</code> offer <code>Eq</code> instances. So it should be trivial to write our own <code>Eq</code> instance -- so trivial that the compiler itself should be able to do it.</p>\n\n<pre><code>{-# LANGUAGE StandaloneDeriving #-}\n\nderiving instance Eq (ManagedPtr a)\nderiving instance Eq Widget\n</code></pre>\n\n<p>Whether this has the right semantics is not 100% clear to me; it's possible that you would want to ignore the ownership for the purposes of your equality tests, in which case you might want to write</p>\n\n<pre><code>instance Eq (ManagedPtr a) where\n    (==) ManagedPtr { managedForeignPtr = p  }\n         ManagedPtr { managedForeignPtr = p' }\n         = p == p'\n</code></pre>\n\n<p>or similar instead.</p>\n"}], "owner": {"reputation": 123, "user_id": 3801711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/YwxQm.jpg?s=128&g=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/3801711/arthur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 44168318, "answer_count": 1, "score": 2, "last_activity_date": 1495659428, "creation_date": 1495645395, "question_id": 44164600, "link": "https://stackoverflow.com/questions/44164600/is-it-possible-to-compare-two-gobjects-with-haskell-gi-and-find-out-if-theyre-t", "title": "Is it possible to compare two gobjects with haskell-gi and find out if they&#39;re the same?", "body": "<p>With Gtk2Hs I used to be able to compare gtk objects with <code>==</code> to find out whether or not they were the same. For example:</p>\n\n<pre><code>boxIsFromState :: VBox -&gt; State -&gt; Bool\nboxIsFromState widget state = _widget state == widget\n</code></pre>\n\n<p>Where <code>State</code> is a self-defined data type container another VBox.</p>\n\n<p>I noticed <code>haskell-gi</code>'s widgets don't derive from <code>Eq</code>. Is there another way to compare objects, then?</p>\n"}, {"tags": ["haskell", "functional-programming", "tail-recursion", "insertion-sort"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1495639080, "post_id": 44162415, "comment_id": 75341435, "body": "This doesn&#39;t use tail recursion. The <code>otherwise</code> clause of <code>insert</code> is <code>y : insert ys</code> (more clearly written as <code>(:) y (insert ys)</code>) the call to <code>insert</code> appears as an argument to <code>(:)</code>, not in tail position"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1495639301, "post_id": 44162415, "comment_id": 75341593, "body": "Can you explain what you mean by &quot;First order programming&quot;? Is that just anything that doesn&#39;t take a function as an argument."}, {"owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495639322, "post_id": 44162415, "comment_id": 75341611, "body": "@Lazersmoke yes, exactly."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495639480, "post_id": 44162415, "comment_id": 75341720, "body": "I don&#39;t think you have any functions as arguments, so isn&#39;t it already using &quot;first order programming&quot;?"}, {"owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495639809, "post_id": 44162415, "comment_id": 75341991, "body": "@Lazersmoke doesn&#39;t this chunk of code <code>insert ( isort xs )</code> uses <code>isort</code> as an argument?"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495639950, "post_id": 44162415, "comment_id": 75342097, "body": "No, it uses <code>isort xs :: [a]</code> (where a is a rigid tyvar bound by the enclosing <code>isort</code>)"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495640227, "post_id": 44162415, "comment_id": 75342319, "body": "A good approach to making recursive functions tail-recursive is to build the return value as an extra, accumulating parameter.  Here, that might be the initial segment of the list preceding the inserted value.  The final step would then have as its three parameters the start of the list, the value to insert, and the rest of the list."}], "answers": [{"tags": [], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "is_accepted": true, "score": 1, "last_activity_date": 1495661700, "creation_date": 1495661700, "answer_id": 44168849, "question_id": 44162415, "link": "https://stackoverflow.com/questions/44162415/insertion-sort-using-tail-recursion-first-order-function/44168849#44168849", "title": "Insertion sort using tail recursion &amp; first order function", "body": "<p>This is the simple version, not using tail recursion nor HOF</p>\n\n<pre><code>sort :: Ord a =&gt; [a] -&gt; [a]\nsort   []   = []\nsort  [x]   = [x]\nsort (x:xs) = insert x (sort xs)\n\ninsert :: Ord a =&gt; a -&gt; [a] -&gt; [a]\ninsert x [] = [x]\ninsert x (y:ys) | x &lt; y     = x:y:ys\n                | otherwise = y:insert x ys\n</code></pre>\n\n<p>You can add an  accumulator, that allows us to rewrite the sort using tail recursion:</p>\n\n<pre><code>sort' :: Ord a =&gt; [a] -&gt; [a]\nsort' xs = sortAcc xs []\n\nsortAcc :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nsortAcc   []   acc = acc\nsortAcc (x:xs) acc = sortAcc xs (insert x acc)\n</code></pre>\n\n<p><code>insert</code> is pretty nicely defined the way it is; but just for the purpose\nof using higher order functions, we can define it like:</p>\n\n<pre><code>insert' :: Ord a =&gt; a -&gt; [a] -&gt; [a]\ninsert' x xs = menores ++ x:mayores\n  where (menores,mayores) = span (&lt;x) xs\n</code></pre>\n\n<p>where the section <code>(&lt;x)</code> is a function of type <code>Ord a =&gt; a -&gt; Bool</code> passed to <code>span</code>.</p>\n"}], "owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 1, "accepted_answer_id": 44168849, "answer_count": 1, "score": 2, "last_activity_date": 1495661700, "creation_date": 1495638822, "last_edit_date": 1495640596, "question_id": 44162415, "link": "https://stackoverflow.com/questions/44162415/insertion-sort-using-tail-recursion-first-order-function", "title": "Insertion sort using tail recursion &amp; first order function", "body": "<p>I'd like to design an algorithm in Haskell using <strong>tail recursion</strong> and <strong>first order programming</strong> for <em>insertion sort</em> </p>\n\n<p>I've came up with this solution </p>\n\n<pre><code>isort :: Ord a =&gt; [a] -&gt; [a]\nisort [] = []\nisort [x] = [x]\nisort ( x:xs ) = insert ( isort xs )\n    where insert [] = [x]\n          insert ( y:ys )\n            | x &lt; y = x : y : ys\n            | otherwise = y : insert ys\n</code></pre>\n\n<p>But I'm not sure if it uses first order and tail recursion. </p>\n\n<p>Can someone come up with an alternative solution using </p>\n\n<ul>\n<li>tail recursion</li>\n<li>first order programming</li>\n</ul>\n\n<p>Thanks, </p>\n"}, {"tags": ["scala", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1495638136, "post_id": 44162093, "comment_id": 75340695, "body": "There&#39;s no such thing as &quot;an algebra&quot;. <code>Algebra</code> is an area of mathematics. An <code>API</code> is something programmers can use. An <code>algebra API</code> is some code that programmers can use to do mathematical things."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1495638371, "post_id": 44162093, "comment_id": 75340879, "body": "No, has nothing to do with math algebra, but it calls as algebra."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 5, "creation_date": 1495640175, "post_id": 44162093, "comment_id": 75342278, "body": "Yes, there is such a thing as an algebra. <a href=\"https://en.m.wikipedia.org/wiki/Associative_algebra\" rel=\"nofollow noreferrer\">Here</a> is an example. I don&#39;t think it&#39;s relevant to the question, but then I don&#39;t understand the question."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1495641120, "post_id": 44162093, "comment_id": 75342989, "body": "How <i>exactly</i> do you encounter this concept? Be more specific."}, {"owner": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "edited": false, "score": 2, "creation_date": 1495646408, "post_id": 44162093, "comment_id": 75346153, "body": "@zero_coding it actually does have quite a bit to do with math algebra, that&#39;s why it&#39;s called an algebra."}], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1495638573, "post_id": 44162255, "comment_id": 75341050, "body": "Not at all. The approach of design an api and following law, etc?"}], "tags": [], "owner": {"reputation": 15549, "user_id": 1876739, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QOK17.jpg?s=128&g=1", "display_name": "Ram&#243;n J Romero y Vigil", "link": "https://stackoverflow.com/users/1876739/ram%c3%b3n-j-romero-y-vigil"}, "is_accepted": true, "score": 6, "last_activity_date": 1542282797, "last_edit_date": 1542282797, "creation_date": 1495638366, "answer_id": 44162255, "question_id": 44162093, "link": "https://stackoverflow.com/questions/44162093/describe-what-is-an-algebra/44162255#44162255", "title": "Describe what is an algebra?", "body": "<p>I think what you are referring to is <a href=\"https://en.wikipedia.org/wiki/Algebraic_data_type\" rel=\"nofollow noreferrer\">algebraic data types</a>.</p>\n\n<p><strong>Product Type</strong></p>\n\n<p>A common class of ADT is the product type.  As an example, a \"user\" can be described as a combination of \"name\", \"email address\", and \"age\":</p>\n\n<pre><code>case class User(name : String, email : String, age : Int)\n</code></pre>\n\n<p>This is called a \"product\" type because we can count the number of possible distinct Users using multiplication:</p>\n\n<blockquote>\n  <p>distinct user count = (distinct name count) x (distinct email count) x (distinct age count)</p>\n</blockquote>\n\n<p><strong>Sum Type</strong></p>\n\n<p>The other common ADT class is the sum type.  As an example, a user can either be a common user or an adminstrator:</p>\n\n<pre><code>sealed trait User\n\ncase class CommonUser(name : String) extends User\n\ncase class AdminUser(name : String, powers : Set[AdminPowers]) extends User\n</code></pre>\n\n<p>This is called a \"sum\" type because we can count the number of possible distinct Users using addition:</p>\n\n<blockquote>\n  <p>distinct user count = (distinct common user count) + (distinct admin user count)</p>\n</blockquote>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "closed_date": 1495646626, "accepted_answer_id": 44162255, "answer_count": 1, "score": -8, "last_activity_date": 1542282797, "creation_date": 1495637991, "last_edit_date": 1495638322, "question_id": 44162093, "link": "https://stackoverflow.com/questions/44162093/describe-what-is-an-algebra", "closed_reason": "Needs details or clarity", "title": "Describe what is an algebra?", "body": "<p>In the functional programming world, when I want to design an API, i will encounter the word algebra api. \nCould someone please describe, what an algebra is in FP in context of designing API.</p>\n\n<p>Which components build an algebra api? Laws, operations, etc..?</p>\n\n<p>There is a word primitive, what is a primitive exactly? Please with show me an example. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1495635451, "post_id": 44159807, "comment_id": 75338395, "body": "It should be possible, but it will be awkward and require that the <code>FromJSON</code> instance reflect <code>xs</code> down to the value level in order to verify that the parsed number is an element of <code>xs</code>. Doing that will require being able to express that every element of <code>xs</code> has a <code>KnownNat</code> constraint, which can be done, but will be... awkward."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495639886, "post_id": 44159807, "comment_id": 75342051, "body": "This might be impossible because you are trying to make a value with a type that depends on what is in the JSON. In theory, using an existential to say that it is <i>some</i> number rather than any specific number should sidestep the issue, but I think you will still have to provide a witness, which would require dependent types."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495640476, "post_id": 44159807, "comment_id": 75342503, "body": "@Lazersmoke <code>SomeEnum</code> is the existential needed. And <code>GHC.TypeLits</code> has the necessary machinery to create a witness at runtime, suitable for stuffing into the existential."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495640489, "post_id": 44159807, "comment_id": 75342513, "body": "@Lazersmoke is thinking along the right lines. It&#39;s not impossible but it won&#39;t be pretty, especially not with the <code>TypeLits</code>/<code>Proxy</code> setup you have at the moment. You&#39;ll need to use a singleton to prove that the <code>n</code> fits the bound and then existentially quantify it. I will note that your <code>SomeEnum</code> is basically <a href=\"https://stackoverflow.com/questions/44021114/what-is-the-preferred-alternative-to-fin-from-idris-in-haskell/44030376#44030376\"><code>Fin</code></a>, modulo some sort of mapping from the <code>Fin</code> values to the <code>Nat</code>s in your type level list"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1495641081, "post_id": 44159807, "comment_id": 75342961, "body": "Oh, I missed the problem.. The <i>other</i> constraint needs a witness, too. Ok, allowing a runtime witness for that constraint is possible, but it will involve an <code>unsafeCoerce</code>. So.. Maybe not worth it. You&#39;d have to implement very carefully to preserve type safety."}], "answers": [{"tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 2, "last_activity_date": 1495653922, "last_edit_date": 1495653922, "creation_date": 1495653548, "answer_id": 44166848, "question_id": 44159807, "link": "https://stackoverflow.com/questions/44159807/is-it-possible-to-declare-fromjson-instance-for-my-weird-enum-like-type/44166848#44166848", "title": "Is it possible to declare FromJSON instance for my weird enum-like type?", "body": "<p>It's easier to look at your problem without the distraction of JSON.</p>\n\n<p>The real problem is can you define a function</p>\n\n<pre><code>toSomeEnum :: Integer -&gt; SomeEnum xs\n</code></pre>\n\n<p>Since <code>SomeEnum []</code> is isomorphic to <code>Void</code>, and <code>-1</code> is not convertable to\n<code>SomeEnum xs</code> for any <code>xs</code>, obviously not. We need the ability to fail:</p>\n\n<pre><code>toSomeEnum :: Integer -&gt; Maybe (SomeEnum xs)\n</code></pre>\n\n<p>And to do anything beyond <code>const Nothing</code> we'll need the ability to compare the\nelements of <code>xs</code> to the runtime input:</p>\n\n<pre><code>toSomeEnum' :: forall xs. ToSomeEnum xs =&gt; Integer -&gt; Maybe (SomeEnum xs)\ntoSomeEnum' n = do\n  SomeNat proxy_n &lt;- someNatVal n\n  toSomeEnum proxy_n\n\nclass ToSomeEnum (xs :: [Nat]) where\n  toSomeEnum :: forall (n :: Nat). KnownNat n =&gt; Proxy n -&gt; Maybe (SomeEnum xs)\n\ninstance ToSomeEnum '[] where\n  toSomeEnum = const Nothing\n\ninstance (KnownNat x, ToSomeEnum xs) =&gt; ToSomeEnum (x ': xs) where\n  toSomeEnum proxy_n = case sameNat proxy_n (Proxy @x) of \n    Just Refl -&gt; Just (SomeEnum proxy_n) -- [1]\n    Nothing -&gt; case toSomeEnum proxy_n :: Maybe (SomeEnum xs) of\n      Nothing -&gt; Nothing\n      Just (SomeEnum proxy_n') -&gt; Just (SomeEnum proxy_n') -- [2]\n</code></pre>\n\n<p>This didn't <em>quite</em> work as GHC complained</p>\n\n<pre><code>\u2022 Could not deduce: Or 'True (IsOneOf n xs) ~ 'True\n    arising from a use of \u2018SomeEnum\u2019\n  from the context: x ~ n\n    bound by a pattern with constructor:\n               Refl :: forall k (a :: k). a :~: a,\n             in a case alternative\n    at [1]\n...\n\u2022 Could not deduce: Or (GHC.TypeLits.EqNat n1 x) 'True ~ 'True\n    arising from a use of \u2018SomeEnum\u2019\n  from the context: (KnownNat n1, Member n1 xs)\n    bound by a pattern with constructor:\n               SomeEnum :: forall (xs :: [Nat]) (n :: Nat).\n                           (KnownNat n, Member n xs) =&gt;\n                           Proxy n -&gt; SomeEnum xs,\n             in a case alternative\n    at [2]\n</code></pre>\n\n<p>Which can be fixed by using a lazier definition of <code>Or</code>:</p>\n\n<pre><code>type family Or (a :: Bool) (b :: Bool) :: Bool where\n  Or 'True _ = 'True\n  Or _ 'True = 'True\n  Or _ _ = 'False\n</code></pre>\n\n<p>No <code>unsafeCoerce</code> or type witnesses required.  Your calling code simply has to\nknow what it expects <code>xs</code> to be.</p>\n\n<pre><code>\u03bb case (toSomeEnum' 1 :: Maybe (SomeEnum '[1,2,3])) of { Just _ -&gt; \"ok\" ; Nothing -&gt; \"nope\" }\n\"ok\"\n\u03bb case (toSomeEnum' 4 :: Maybe (SomeEnum '[1,2,3])) of { Just _ -&gt; \"ok\" ; Nothing -&gt; \"nope\" }\n\"nope\"\n</code></pre>\n"}], "owner": {"reputation": 815, "user_id": 245743, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11a87619d08da72466e99e16453ea318?s=128&d=identicon&r=PG", "display_name": "ppb", "link": "https://stackoverflow.com/users/245743/ppb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 2, "accepted_answer_id": 44166848, "answer_count": 1, "score": 3, "last_activity_date": 1495653922, "creation_date": 1495632504, "question_id": 44159807, "link": "https://stackoverflow.com/questions/44159807/is-it-possible-to-declare-fromjson-instance-for-my-weird-enum-like-type", "title": "Is it possible to declare FromJSON instance for my weird enum-like type?", "body": "<p>I'm trying to define a type that can be restricted to a subset of <code>Nat</code>'s. While I realise a simple solution would be to use a regular ADT I'm still curious if such type could be defined with an accompanying <code>FromJSON</code> instance. Here's what I have so far:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE UndecidableInstances #-}\n\nmodule Test where\n\nimport Control.Monad\nimport Data.Aeson\nimport Data.Kind (Constraint)\nimport Data.Proxy\nimport Data.Type.Equality\nimport GHC.TypeLits\nimport Prelude\n\n\ntype family Or (a :: Bool) (b :: Bool) :: Bool where\n  Or 'False 'False = 'False\n  Or 'True 'False = 'True\n  Or 'False 'True = 'True\n  Or 'True 'True = 'True\n\ntype family IsOneOf (n :: Nat) (xs :: [Nat]) :: Bool where\n  IsOneOf n '[] = 'False\n  IsOneOf n (x ': xs) = Or (n == x) (IsOneOf n xs)\n\ntype family Member n xs :: Constraint where\n  Member n xs = 'True ~ IsOneOf n xs\n\ndata SomeEnum (xs :: [Nat]) where\n        SomeEnum :: (KnownNat n, Member n xs) =&gt; Proxy n -&gt; SomeEnum xs\n</code></pre>\n\n<p>This can be then used as follows:</p>\n\n<pre><code>\u03bb&gt; SomeEnum (Proxy :: Proxy 1) :: SomeEnum [1,2]\n</code></pre>\n\n<p>I was able to define a <code>ToJSON</code> instance:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance ToJSON (SomeEnum xs) where\n  toJSON (SomeEnum n) = Number (fromIntegral . natVal $ n)\n</code></pre>\n\n<p>However it doesn't seem declaring a <code>FromJSON</code> instance is possible as I can't figure out how to convince the compiler that whatever number I might get out of a JSON document is indeed a member of the set of accepted values of <code>SomeEnum</code>.</p>\n\n<p>My question then is - is it possible to declare that instance at all with the current formulation of the data type? Could perhaps the type itself be adjusted somehow to allow for such instance while preserving the behaviour of being restricted to specific set of <code>Nat</code>s?</p>\n\n<p>I'm not very familiar with Haskell's type level features so perhaps what I'm asking doesn't make sense in its current form. I would appreciate any comments.</p>\n"}, {"tags": ["haskell", "monads", "typeclass", "alternative-functor", "foldable"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1495624888, "post_id": 44156863, "comment_id": 75330057, "body": "It&#39;s not because it does not <i>break</i> any laws, that it is <i>desired</i>. I think one usually do not want automatic Monad derivation, since one can decide to implement a monad another way."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1495627456, "post_id": 44156863, "comment_id": 75331960, "body": "For example if you have a type class that supports an associative array (dictionary), you could define it as some kind of state monad. But perhaps you want some kind of associative array not to work as state monad at all, but as an (emulated) processor."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1495632717, "last_edit_date": 1495632717, "creation_date": 1495625749, "answer_id": 44157254, "question_id": 44156863, "link": "https://stackoverflow.com/questions/44156863/could-it-be-that-alternative-f-foldable-f-monad-f/44157254#44157254", "title": "Could it be that (Alternative f, Foldable f) =&gt; Monad f?", "body": "<p>This should be a counterexample to the right identity monad law.</p>\n\n<p>Below, we exploit the functor product <code>Maybe :*: Maybe</code> from <code>GHC.Generics</code>, but it could be inlined, if wished. This is also an applicative, alternative, foldable, and monad. I trust the libraries on these instances to be law-abiding.</p>\n\n<p>We then compare the proposed <code>instance Monad</code> (the one in the question) to the standard library one. We find that the right identity law is not satisfied for the proposed instance, while it appears to hold (at least in my very limited tests) in the library instance.</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, GeneralizedNewtypeDeriving, TypeOperators #-}\n{-# OPTIONS -Wall #-}\n\nmodule NotAMonad where\n\nimport Control.Applicative\nimport GHC.Generics ((:*:)(..))\n\n-- A basic wrapper to avoid overlapping instances, and to be able to\n-- define a custom monad instance.\nnewtype Wrap m a = Wrap { unWrap :: m a }\n    deriving (Functor, Applicative, Alternative, Foldable, Show)\n\n-- The proposed instance\ninstance (Applicative f, Alternative f, Foldable f) =&gt; Monad (Wrap f) where \n  (&gt;&gt;=) = flip $ \\f -&gt; foldr (&lt;|&gt;) empty . fmap f\n\n-- This is Applicative, Alternative, and Foldable\ntype T = Maybe :*: Maybe\n\n-- A basic test\ntest :: Wrap T Int\ntest = Wrap (Just 3 :*: Just 4) &gt;&gt;= return\n-- result:\n-- Wrap {unWrap = Just 3 :*: Just 3}\n</code></pre>\n\n<p>The <code>4</code> is now replaced by <code>3</code>. I have not tried to explain why, though.\nI guess it is caused by <code>Just 3 &lt;|&gt; Just 4 = Just 3</code>.</p>\n\n<p>Using the library monad instance, instead, everything looks fine:</p>\n\n<pre><code>&gt; (Just 3 :*: Just 4) &gt;&gt;= return\nJust 3 :*: Just 4\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495631847, "post_id": 44158952, "comment_id": 75335381, "body": "I wonder if a foldable monoid is essentially a list, up to iso. I can&#39;t see problems in the default definition, but maybe it would only apply to <code>[]</code> and little else (?)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1495636663, "post_id": 44158952, "comment_id": 75339403, "body": "@chi, that&#39;s not <i>too</i> far off, but it&#39;s not enough. Think about the definition of a free monoid. <code>foldMap</code> gets you one bit, but you also need <code>singleton</code>, with <code>foldMap f (singleton x) = f x</code>. And of course you need <code>foldMap f (x &lt;&gt; y) = foldMap f x &lt;&gt; foldMap f y</code>. Of course, at that point you should surely toss in <code>Traversable</code> because you can do so for fdree."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495809481, "post_id": 44158952, "comment_id": 75421100, "body": "@chi <code>Last</code> and <code>First</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 6, "last_activity_date": 1495630292, "creation_date": 1495630292, "answer_id": 44158952, "question_id": 44156863, "link": "https://stackoverflow.com/questions/44156863/could-it-be-that-alternative-f-foldable-f-monad-f/44158952#44158952", "title": "Could it be that (Alternative f, Foldable f) =&gt; Monad f?", "body": "<p><code>Alternative</code> is a bit of a hacky beast. It's essentially the class of <em>monoid constructors</em>: type constructors <code>T</code> such that for any contained type <code>X</code>, <code>T X</code> is a monoid. This doesn't really have a lot to do with functors...monads, and is considerably less mathematically deep. (So, only for mathematical elegance, it would be a bit bad to set <code>Monad</code> underneath <code>Alternative</code>.)</p>\n\n<p>Let's write that instance in terms of <code>Monoid</code> for clarity (this won't actually compile):</p>\n\n<pre><code>instance (Foldable f, (\u2200 x . Monoid (f x))) =&gt; Monad f where\n  (&gt;&gt;=) = flip $ \\f -&gt; foldr mappend empty . fmap f\n        \u2261 flip $ \\f -&gt; fold . fmap f\n        \u2261 flip foldMap\n</code></pre>\n\n<p>or indeed</p>\n\n<pre><code>  (=&lt;&lt;) = foldMap\n</code></pre>\n\n<p>so, this is definitely not something unknown.</p>\n\n<p>To check the laws, we best look at the Kleisli formulation:</p>\n\n<pre><code>  (f &lt;=&lt; g) x = f =&lt;&lt; g x\n              \u2261 foldMap f $ g x\n</code></pre>\n\n<p>i.e.</p>\n\n<pre><code>  f &lt;=&lt; g = foldMap f . g\n</code></pre>\n\n<p>Then the monad laws are</p>\n\n<ul>\n<li><p>Left identity</p>\n\n<pre><code>f &lt;=&lt; pure \u2261 foldMap f . pure =! f\n</code></pre></li>\n<li><p>Right identity</p>\n\n<pre><code>pure &lt;=&lt; f \u2261 foldMap pure . f =! f\n</code></pre></li>\n<li><p>Associativity</p>\n\n<pre><code>(f &lt;=&lt; g) &lt;=&lt; h \u2261 foldMap (foldMap f . g) . h\n                =! foldMap f . foldMap g . h\n                \u2261 foldMap f . (foldMap g . h) \u2261 f &lt;=&lt; (g &lt;=&lt; h)\n</code></pre></li>\n</ul>\n\n<p>So in brief, we need</p>\n\n<ul>\n<li><code>foldMap f . pure =! f =! foldMap pure . f</code> \u2200 <code>f</code></li>\n<li><code>foldMap (foldMap f . g) =! foldMap f . foldMap g</code> \u2200 <code>f</code>,<code>g</code></li>\n</ul>\n\n<p>That certainly looks not unreasonable, but I don't see whence you could rigorously conclude it for arbitrary <code>Foldable</code>+<code>Alternative</code> instances.</p>\n\n<p>Really, the big problem I see with this instance is that it's not nearly general enough. Most monads are neither <code>Foldable</code> nor <code>Alternative</code>. If there was a cover-all definition like the one you propose, it would require <code>OverlappingInstances</code> to define any instance of your own, and those are generally considered something you shouldn't use without good reason.</p>\n\n<p>I do wonder however if there would be any problems with the following <em>default definition</em> for the bind method:</p>\n\n<pre><code>{-# LANGUAGE DefaultSignatures #-}\nclass Applicative f =&gt; Monad f where\n  return :: a -&gt; m a\n  return = pure\n  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n  default (&gt;&gt;=) :: (Foldable m, Monoid m b)\n          =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n  (&gt;&gt;=) = flip foldMap\n</code></pre>\n\n<p>That would at least allow defining e.g. the list instance simply as</p>\n\n<pre><code>instance Monad []\n</code></pre>\n\n<p>without needing to write out the methods at all since sure enough, <code>foldMap \u2261 concatMap \u2261 (=&lt;&lt;)</code>.</p>\n"}], "owner": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 44157254, "answer_count": 2, "score": 8, "last_activity_date": 1614386340, "creation_date": 1495624768, "last_edit_date": 1614386340, "question_id": 44156863, "link": "https://stackoverflow.com/questions/44156863/could-it-be-that-alternative-f-foldable-f-monad-f", "title": "Could it be that (Alternative f, Foldable f) =&gt; Monad f?", "body": "<p>The following typechecks:</p>\n\n<pre><code>instance (Applicative f, Alternative f, Foldable f) =&gt; Monad f where \n  (&gt;&gt;=) = flip $ \\f -&gt; foldr (&lt;|&gt;) empty . fmap f\n  -- Or equivalently\n  a &gt;&gt;= b = getAlt . foldMap Alt . fmap b $ a\n</code></pre>\n\n<p>Is this actually a valid <code>Monad</code> instance? If yes, why is it not used? If no, does it break any laws or such? I have not proved that the laws hold, but I couldn't find a counterexample either.</p>\n"}, {"tags": ["haskell", "erlang"], "comments": [{"owner": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 0, "creation_date": 1495621890, "post_id": 44155749, "comment_id": 75328068, "body": "What doesn&#39;t work? does it throw an error or give the wrong result for some input or something else?"}, {"owner": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 0, "creation_date": 1495621977, "post_id": 44155749, "comment_id": 75328133, "body": "Also your first clause is different, it should be <code>comb(0) -&gt; [[]]</code> to match the Haskell code."}, {"owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "reply_to_user": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 0, "creation_date": 1495622748, "post_id": 44155749, "comment_id": 75328662, "body": "@Dogbert I update the question with Error"}, {"owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "reply_to_user": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 0, "creation_date": 1495622927, "post_id": 44155749, "comment_id": 75328766, "body": "@Dogbert get same error for [[]]"}], "answers": [{"tags": [], "owner": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "is_accepted": true, "score": 3, "last_activity_date": 1495623249, "creation_date": 1495623249, "answer_id": 44156297, "question_id": 44155749, "link": "https://stackoverflow.com/questions/44155749/combinatorics-in-erlang/44156297#44156297", "title": "Combinatorics in Erlang", "body": "<p>You have multiple errors in the translation:</p>\n\n<ol>\n<li><p>The first clause should be <code>comb(0) -&gt; [[]];</code></p></li>\n<li><p>You've done <code>R = comb(...)</code> instead of <code>R &lt;- comb(...)</code> in the list comprehension.</p></li>\n</ol>\n\n<p>With these changes, the code works:</p>\n\n<pre><code>-module(combinatorics).\n-export([comb/1]).\ncomb(0) -&gt; [[]];\ncomb(N) -&gt;\n    [[X|R] || X &lt;- lists:seq(1,N), R &lt;- comb(N-X)].\n</code></pre>\n\n\n\n<pre><code>1&gt; c(combinatorics).\n{ok,combinatorics}\n2&gt; combinatorics:comb(1).\n[[1]]\n3&gt; combinatorics:comb(2).\n[[1,1],[2]]\n4&gt; combinatorics:comb(3).\n[[1,1,1],[1,2],[2,1],[3]]\n5&gt; combinatorics:comb(4).\n[[1,1,1,1],[1,1,2],[1,2,1],[1,3],[2,1,1],[2,2],[3,1],[4]]\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4881278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1ceGz.jpg?s=128&g=1", "display_name": "Geo-7", "link": "https://stackoverflow.com/users/4881278/geo-7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 44156297, "answer_count": 1, "score": 0, "last_activity_date": 1495623249, "creation_date": 1495621709, "last_edit_date": 1495622709, "question_id": 44155749, "link": "https://stackoverflow.com/questions/44155749/combinatorics-in-erlang", "title": "Combinatorics in Erlang", "body": "<p>I want to find combinatorics of integer in Erlang, equivalent of this Haskell code:</p>\n\n<pre><code>composition 0 = [[]]\ncomposition n = [x:rest | x &lt;- [1..n], rest &lt;- composition (n-x)]\n</code></pre>\n\n<p>so far I tried this which It doesn't work:</p>\n\n<pre><code>-module(combinatorics).\n-export([comb/1]).\ncomb([]) -&gt; []; \ncomb(N) -&gt;\n        [[X|R] || X &lt;- lists:seq(1,N),R=comb(N-X)].\n</code></pre>\n\n<p>The code return This error:</p>\n\n<pre><code>43&gt; combinatorics:comb(2).\n     ** exception error: no case clause matching []\n             in function  combinatorics:'-comb/1-lc$^0/1-0-'/2 (combinatorics.erl, line 5)\n             in call from combinatorics:'-comb/1-lc$^0/1-0-'/2 (combinatorics.erl, line 5)\n</code></pre>\n"}, {"tags": ["haskell", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 5293973, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f1eaae0559197cfe5639f6a3879d6d27?s=128&d=identicon&r=PG&f=1", "display_name": "Atir", "link": "https://stackoverflow.com/users/5293973/atir"}, "edited": false, "score": 0, "creation_date": 1495622958, "post_id": 44155668, "comment_id": 75328790, "body": "Thanks. Help a lot!"}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 3, "last_activity_date": 1495621497, "creation_date": 1495621497, "answer_id": 44155668, "question_id": 44155488, "link": "https://stackoverflow.com/questions/44155488/writing-the-exists-function-correctly-in-a-recursive-way/44155668#44155668", "title": "Writing the exists function correctly in a recursive way", "body": "<p>Just checking the function over the value on the ward:</p>\n\n<pre><code>exists' :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\nexists' _ [] = False\nexists' f (x:xs)\n   | f x       = True\n   | otherwise = exists' f xs\n</code></pre>\n\n<p><code>f</code> is of type <code>(a -&gt; bool)</code>, <code>x</code> is of type <code>a</code> ergo <code>f a</code> will return a bool, if it evaluates to True you just \"return\" True too, otherwise you make the recursive call as you were doing.  </p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1495626811, "last_edit_date": 1495626811, "creation_date": 1495625767, "answer_id": 44157264, "question_id": 44155488, "link": "https://stackoverflow.com/questions/44155488/writing-the-exists-function-correctly-in-a-recursive-way/44157264#44157264", "title": "Writing the exists function correctly in a recursive way", "body": "<p>As <a href=\"https://stackoverflow.com/a/44155668/67579\">@DanielSanchez</a> said in his answer, the problem is that you write <code>p == x</code> instead of <code>p x</code> so instead of calling the predicate on the head of the list, you check if the predicate is <em>equal</em> to the head of the list. As a result, <code>x</code> should also be of type <code>a -&gt; Bool</code> (or <code>p</code> of type <code>a</code>) and the type of <code>p</code> and <code>x</code> should by an instance of the <code>Eq</code> class.</p>\n\n<p>You can make the code a bit more elegant like:</p>\n\n<pre><code>exists' :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\nexists' _ [] = False\nexists' p (x:xs) = <b>p x ||</b> exists' p xs</code></pre>\n\n<p>Since now it reads <em>syntactically</em>: <em>there exists an element in a list that satisfies the given predicate given the list is not empty and the predicate is true for the head of the list, <strong>or</strong> such element exists in the remainder of the list</em>\".</p>\n\n<p>Finally we can also avoid passing the predicate in the recursive calls, by using a <code>where</code> clause, like:</p>\n\n<pre><code>exists' :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\nexists' <b>p = helper</b>\n    where helper [] = False\n          helper (x:xs) = p x || helper xs</code></pre>\n\n<p>Note that you do not have to write <code>exists'</code> yourself. There is the <code>any :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool</code> function that is semantically equivalent.</p>\n"}], "owner": {"reputation": 151, "user_id": 5293973, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f1eaae0559197cfe5639f6a3879d6d27?s=128&d=identicon&r=PG&f=1", "display_name": "Atir", "link": "https://stackoverflow.com/users/5293973/atir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1495655140, "creation_date": 1495621012, "last_edit_date": 1495655140, "question_id": 44155488, "link": "https://stackoverflow.com/questions/44155488/writing-the-exists-function-correctly-in-a-recursive-way", "title": "Writing the exists function correctly in a recursive way", "body": "<p>How to fix this <code>exists'</code> function so that it works as required?</p>\n\n<p>Tests whether any element of a list satisfies a given condition.</p>\n\n<pre><code>exists' :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\n\nexists' p [] = False\nexists' p (x:xs)\n   | p == x = True\n   | otherwise = exists' p xs\n</code></pre>\n"}, {"tags": ["haskell", "concurrency", "stream", "conduit", "haskell-pipes"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1495584555, "post_id": 44145974, "comment_id": 75311367, "body": "How much control do you want over the total number of outstanding high-latency requests? Probably it&#39;s easy to implement <code>Stream (Of a) IO () -&gt; Stream (Of (Async a)) IO ()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1495639933, "post_id": 44147146, "comment_id": 75342087, "body": "Thanks, it does look like pipes-concurrency is made for this sort of task. This isn&#39;t the type I was hoping for though"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 7, "last_activity_date": 1495586802, "last_edit_date": 1495586802, "creation_date": 1495586448, "answer_id": 44147146, "question_id": 44145974, "link": "https://stackoverflow.com/questions/44145974/idiomatic-prefetching-in-a-streaming-library/44147146#44147146", "title": "Idiomatic prefetching in a streaming library", "body": "<p>This solution uses <em>pipes</em> but it could be easily adapted to use <em>streaming</em>. To be precise, it requires the <em>pipes</em>, <em>pipes-concurrency</em> and <em>async</em> packages.</p>\n\n<p>It doesn't work in a \"direct\" style. Instead of simply transforming the <code>Producer</code>, it also takes a \"folding function\" that consumes a <code>Producer</code>. This continuation-passing style is necessary for setting up and tearing down the concurrency mechanism.</p>\n\n<pre><code>import Pipes\nimport Pipes.Concurrent (spawn',bounded,fromInput,toOutput,atomically)\nimport Control.Concurrent.Async (Concurrently(..))\nimport Control.Exception (finally)\n\nprefetching :: Int -&gt; Producer a IO () -&gt; (Producer a IO () -&gt; IO r) -&gt; IO r\nprefetching bufsize source foldfunc = do\n    (outbox,inbox,seal) &lt;- spawn' (bounded bufsize)\n    let cutcord effect = effect `finally` atomically seal\n    runConcurrently $\n        Concurrently (cutcord (runEffect (source &gt;-&gt; toOutput outbox)))\n        *&gt;\n        Concurrently (cutcord (foldfunc (fromInput inbox)))\n</code></pre>\n\n<p>The output of the original producer is redirected to a bounded queue. At the same time, we apply the producer-folding function to a producer that reads from the queue.</p>\n\n<p>Whenever each of the concurrent actions completes, we take care to promptly close the channel to avoid leaving the other side hanging.</p>\n"}], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 1, "accepted_answer_id": 44147146, "answer_count": 1, "score": 3, "last_activity_date": 1495586802, "creation_date": 1495578012, "question_id": 44145974, "link": "https://stackoverflow.com/questions/44145974/idiomatic-prefetching-in-a-streaming-library", "title": "Idiomatic prefetching in a streaming library", "body": "<p>I'm working with the <a href=\"https://hackage.haskell.org/package/streaming\" rel=\"nofollow noreferrer\">streaming</a> library but would accept an answer using pipes or conduit. </p>\n\n<p>Say I have </p>\n\n<pre><code>import Streaming (Stream, Of)\nimport qualified Streaming.Prelude as S\n\nstreamChunks :: Int -&gt; Stream (Of Thing) IO ()\nstreamChunks lastID = do\n  flip fix 0 $ \\go thingID -&gt;\n    unless (thingID &gt; lastID) $ do\n      thing &lt;- highLatencyGet thingID\n      S.yield thing\n      go (thingID+1)\n</code></pre>\n\n<p>To reduce latency I'd like to fork <code>highLatencyGet</code> to retrieve the next <code>Thing</code> in parallel with processing the previous <code>Thing</code> in the consumer.</p>\n\n<p>Obviously I could transform my function above creating a new <code>MVar</code> and forking the next batch before calling <code>yield</code>, etc. </p>\n\n<p>But I want to know if there is an idiomatic (composable) way to do this, such that it could be packaged in a library and could be used on arbitrary IO <code>Stream</code>s. Ideally we could configure the prefetch value as well, like:</p>\n\n<pre><code>prefetching :: Int -&gt; Stream (Of a) IO () -&gt; Stream (Of a) IO ()\n</code></pre>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495574275, "post_id": 44145138, "comment_id": 75308031, "body": "That\u2019s just not going to work, unless you mean for <code>entferne</code> to call <code>error</code> and crash the program. There\u2019s no way for it to return an error, unless you change it to <code>NBaum -&gt; Maybe NBaum</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1495574300, "creation_date": 1495574300, "answer_id": 44145214, "question_id": 44145138, "link": "https://stackoverflow.com/questions/44145138/removing-ith-nodes-from-a-general-tree-in-haskell/44145214#44145214", "title": "Removing i:th nodes from a general tree in Haskell", "body": "<p>The line</p>\n\n<pre><code>entferne (NBlatt i) int | i == int\n</code></pre>\n\n<p>lacks a returned value for that case. It should be</p>\n\n<pre><code>entferne (NBlatt i) int | i == int = &lt;some value here&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 0, "last_activity_date": 1495574351, "creation_date": 1495574351, "answer_id": 44145225, "question_id": 44145138, "link": "https://stackoverflow.com/questions/44145138/removing-ith-nodes-from-a-general-tree-in-haskell/44145225#44145225", "title": "Removing i:th nodes from a general tree in Haskell", "body": "<p>One problem is that the line</p>\n\n<pre><code>entferne (NBlatt i) int | i == int\n</code></pre>\n\n<p>is a pattern guard.  It needs to be followed with <code>=</code> and then an expression to compute that case.</p>\n"}], "owner": {"reputation": 1, "user_id": 8052881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11f603742baa3094d0d856502ce118c?s=128&d=identicon&r=PG&f=1", "display_name": "jane_doe", "link": "https://stackoverflow.com/users/8052881/jane-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495574351, "creation_date": 1495573983, "question_id": 44145138, "link": "https://stackoverflow.com/questions/44145138/removing-ith-nodes-from-a-general-tree-in-haskell", "title": "Removing i:th nodes from a general tree in Haskell", "body": "<p>I want to delete n:th leaves of a general tree and when there is no more leave on the tree, get an error. \nI have this code: </p>\n\n<pre><code>entferne :: NBaum a -&gt; NBaum a\nentferne (NBlatt i) int | i == int\n                            | otherwise = NBlatt i\nentferne (BKnoten left right) int = BKnoten (entferne left \nint) (entferne right int)\n</code></pre>\n\n<p>But i get this error: </p>\n\n<pre><code>parse error on input `|` \n</code></pre>\n\n<p>I checked the shift did all the spaces with space and still get it. </p>\n"}, {"tags": ["javascript", "haskell", "functional-programming", "traversable"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1495571395, "post_id": 44144327, "comment_id": 75306568, "body": "I think you mixed up the two types. (Though I guess both <code>Ident</code> and <code>Array</code> are Traversables as well as Applicative Functors), usually <code>Array</code> is the traversed one and <code>Ident</code> is the Applicative. So <code>(a -&gt; Ident b) -&gt; [a] -&gt; Ident [b]</code> is more common"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495571605, "post_id": 44144327, "comment_id": 75306677, "body": "Since <code>Ident(x)</code> is <code>f =&gt; f(x)</code>, I&#39;d say this is the <code>Cont r</code> continuation functor (and monad) rather than the identity functor (and monad). Am I wrong on this?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1495571636, "post_id": 44144327, "comment_id": 75306702, "body": "<code>tx(x =&gt; ft(x))</code> is much too specific, only for <code>Ident</code>. Try implementing it for generic traversables and applicatives"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1495571716, "post_id": 44144327, "comment_id": 75306738, "body": "It looks to me (my JS is very flaky) to be the right sort of thing. But it&#39;s a very peculiar special case. You can implement traversability of <code>Ident</code> (which packs up exactly one value) using only functoriality of &quot;lists&quot;. If you traverse a structure which can store zero or more than one value, you will need the full applicative apparatus."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1495572774, "post_id": 44144327, "comment_id": 75307289, "body": "@pigworker, Bergi: So I guess I am not completely on the wrong track, but my example is too specific to be meaningful. I&#39;m going to implement it for other types and derive a more generic solution. Thank you!"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1495574248, "post_id": 44144327, "comment_id": 75308009, "body": "You can also try to use an <code>Ident</code> type that is not (directly) church-encoded, where unwrapping is too easy to confuse with standard function application. Make <code>Ident</code> produce actual objects with <code>ap</code>, <code>of</code> and <code>map</code> methods, and then use those in your implementation of <code>traverse</code> instead of peeking into the internal representation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1495575926, "post_id": 44144327, "comment_id": 75308775, "body": "@Bergi I guess you mean <code>tx(x =&gt; ft(x))</code>. I&#39;ll think about it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495615159, "post_id": 44144327, "comment_id": 75323277, "body": "@chi Yes, it is continuation passing. I tried to implement <code>newtype IdentityFn x = IdFn { runIdFn ::  forall z. (x -&gt; z) -&gt; z }</code>. The trick here seems to be the explicit <code>forall z</code>, which introduces a fresh type variable that doesn&#39;t appear in the body of the expression. That is the part I don&#39;t fully understand. But I guess I don&#39;t have to, because Javascript doesn&#39;t have any type checking."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1495618925, "post_id": 44144327, "comment_id": 75325934, "body": "@Bergi Ha, I&#39;ve just read &quot;<i>Church encoding is just a hack for those, who don&#39;t have adequate mechanism for defining data types, because primitive recursion is too weak.</i>&quot;. Maybe you&#39;re right and I should just dump my approach."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495625145, "post_id": 44144327, "comment_id": 75330250, "body": "@ftor I see. Indeed <code>forall z. (x -&gt; z) -&gt; z</code> is isomorphic to <code>x</code> (by Yoneda). I still wonder why the CPS style was needed, but it is a nice exercise anyway."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495627779, "post_id": 44144327, "comment_id": 75332201, "body": "@chi There is a trend in functional JS to use the <code>Identity</code> functor to allow pure functions to be chained like methods (<code>Ident(5).map(sqr).map(inc)...</code>. So you end up mapping the whole world. There are several other issues with the Javascript&#39;s limited prototype system and <code>this</code>, when it comes to functional programming. Hence, I try to avoid it altogether. Church/Scott encoding seems to be a promising approach for an untyped language."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495629723, "post_id": 44144327, "comment_id": 75333685, "body": "@ftor Ah, that makes sense, since it explains why <code>Ident = x =&gt; x</code> would fail. I&#39;d probably be tempted by more OOP approaches like <code>Ident = x =&gt; { unIdent : x }</code>, or whatever JS requires to attach methods. Maybe a constructor function? Anyway, thanks for the clarification."}], "owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1495570907, "creation_date": 1495570907, "question_id": 44144327, "link": "https://stackoverflow.com/questions/44144327/where-is-the-applicative-in-my-javascript-traverse-implementation", "title": "Where is the applicative in my Javascript traverse implementation?", "body": "<p>I've tried to understand Haskell's <code>traverse</code> function and to implement it in Javascript, but I'm stuck. When I look at its type <code>(Functor t, Foldable t, Applicative f) =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)</code>, I understandd that I need <code>&lt;$&gt;</code> (<code>map</code> in JS), <code>&lt;*&gt;</code> (<code>ap</code> in JS) and <code>fold</code> in order to implement it.</p>\n\n<p>I came up with the following code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>// Church encoded Identity newtype\r\n\r\nconst Ident = x =&gt; f =&gt; f(x);\r\n\r\nconst traverse = map =&gt; ft =&gt; tx =&gt; map(y =&gt; Ident(y)) (tx(x =&gt; ft(x)));\r\n\r\n// list functor\r\n\r\nmap = f =&gt; xs =&gt; xs.map(f);\r\n\r\n// helper\r\n\r\nI = x =&gt; x;\r\n\r\n// data\r\n\r\nidA = Ident(1);\r\nidB = Ident(null);\r\n\r\n// and run\r\n\r\nconst r1 = traverse(map) (x =&gt; x === null ? [] : [x]) (idA); // [Ident(1)]\r\nconst r2 = traverse(map) (x =&gt; x === null ? [] : [x]) (idB); // []\r\n\r\nconsole.log(r1 [0] (I)); // 1\r\nconsole.log(r2); // []</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Since I used <code>Ident</code> and <code>Array</code> the type simplifies to <code>(a -&gt; [b]) -&gt; Ident a -&gt; [Ident b]</code>. <code>traverse</code> runs the effect when it rebuilds the data structure. If I am not mistaken one can observe the non-deterministic effect of the list functor in my example.</p>\n\n<p>But where is the applicative? And why does the traversable have to be a functor? Is it just a coincidence that I didn't need them for my sketch?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1495570172, "post_id": 44143471, "comment_id": 75305927, "body": "You can check this with <code>:type</code> in ghci. Is the purpose of the exercise to work it out for yourself?"}, {"owner": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495570988, "post_id": 44143471, "comment_id": 75306373, "body": "yes, I should do it myself to learn how it works."}], "answers": [{"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495577094, "post_id": 44144343, "comment_id": 75309260, "body": "Example: <code>((foldr const) . (curry fst)) 0 [ceiling, floor, round] 0.1</code>"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495577728, "post_id": 44144343, "comment_id": 75309470, "body": "Another example: <code>((foldr const) . (curry fst)) undefined [ceiling, undefined] 0.9</code>"}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 4, "last_activity_date": 1495570998, "creation_date": 1495570998, "answer_id": 44144343, "question_id": 44143471, "link": "https://stackoverflow.com/questions/44143471/calculating-type-of-polymorphism-haskell/44144343#44144343", "title": "Calculating type of polymorphism haskell", "body": "<p>The first result is correct.</p>\n\n<p>The calculation for the second result is correct until you make the substitution in the last step. Easily missed. You had (using <code>=</code>, rather than <code>-&gt;</code>, as the latter constructs function types and thus might cause confusion)</p>\n\n<pre><code>f = h, g = i, i = h\n</code></pre>\n\n<p>so substituting in <code>g -&gt; [f] -&gt; g</code> gives</p>\n\n<pre><code>h -&gt; [h] -&gt; h\n</code></pre>\n\n<p>not <code>i -&gt; [h] -&gt; i</code>, because although <code>g = i</code>, it's also the case that <code>i = h</code>, so together, <code>g = h</code>. That is, you need <em>either</em> to normalise your substitution (applying each new solution to instantiate the old substitution as well as extend it, giving <code>f = h, g = h, i = h</code>), <em>or</em> to apply your substitution carefully one step at a time:</p>\n\n<pre><code>g -&gt; [f] -&gt; g\n  -- f = h\ng -&gt; [h] -&gt; g\n  -- g = i\ni -&gt; [h] -&gt; i\n  -- i = h\nh -&gt; [h] -&gt; h\n</code></pre>\n\n<p>Now, for the final step of the calculation, you have all the pieces, but you have missed the way <code>.</code> is an infix operator. Its first argument is <code>foldr const</code> which must have type <code>j -&gt; k</code>. Its second argument is <code>curry fst</code> which must have type <code>l -&gt; j</code>. The whole thing has type <code>l -&gt; k</code>. So, the equations you must solve are</p>\n\n<pre><code>j -&gt; k  =  h -&gt; [h] -&gt; h   -- from the first argument\nl -&gt; j  =  d -&gt; e -&gt; d     -- from the second argument\n</code></pre>\n\n<p>Now, <code>-&gt;</code> associates to the right, so the first gives</p>\n\n<pre><code>j = h\nk = [h] -&gt; h\n</code></pre>\n\n<p>and the second gives</p>\n\n<pre><code>l = d\nj = e -&gt; d\n</code></pre>\n\n<p>Combining the two gives</p>\n\n<pre><code>h = e -&gt; d\n</code></pre>\n\n<p>so we end up with (normalised)</p>\n\n<pre><code>h = e -&gt; d\nj = e -&gt; d\nk = [e -&gt; d] -&gt; e -&gt; d\nl = d\n</code></pre>\n\n<p>and instantiating <code>l -&gt; k</code> gives the type</p>\n\n<pre><code>d -&gt; [e -&gt; d] -&gt; e -&gt; d\n</code></pre>\n\n<p>The function takes a default <code>d</code>, then a list of functions, then an input <code>e</code>: if the list of functions is empty, you get the default as the result; if the list is nonempty, you get the result of applying the first function to the input.</p>\n"}], "owner": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 44144343, "answer_count": 1, "score": 3, "last_activity_date": 1495578065, "creation_date": 1495567672, "last_edit_date": 1495578065, "question_id": 44143471, "link": "https://stackoverflow.com/questions/44143471/calculating-type-of-polymorphism-haskell", "title": "Calculating type of polymorphism haskell", "body": "<p>I need to calculate types of following expressions: </p>\n\n<ul>\n<li>curry fst </li>\n<li>foldr const</li>\n<li>(foldr const) . (curry fst) </li>\n</ul>\n\n<p>First I have: </p>\n\n<pre><code>curry :: ((a, b) -&gt; c) -&gt; a -&gt; b -&gt; c\nfst :: (d, e) -&gt; d \n\n{}                      |   (a,b)-&gt; c = (d,e) -&gt; d \n{}                      |   (a,b) = (d,e) , c = d\nc -&gt; d                  |   (a,b) = (d,e)\nc -&gt; d , a -&gt;d          |   b = e\nc -&gt; d , a -&gt;d, b -&gt; e  |   {}\n</code></pre>\n\n<p>then replace the result in a -> b -> c and you get d -> e -> d </p>\n\n<p>Now similar to this I do:</p>\n\n<pre><code>foldr :: (f -&gt; g -&gt; g) -&gt; g -&gt; [f] -&gt; g\nconst :: h -&gt; i -&gt; h\n\n\n\n{}                      |    (f -&gt; g -&gt; g) =  h -&gt; i -&gt; h \n{}                      |    f = h , g = i, g = h\nf -&gt; h                  |    g = i, g = h\nf -&gt; h, g -&gt; i          |    i = h\nf -&gt; h, g -&gt; i  i-&gt;h    |    {}\n</code></pre>\n\n<p>then replace the result in g -> [f] -> g and you get i -> [h] -> i </p>\n\n<p>Next, i  have to do \n<code>(foldr const) . (curry fst)</code> but i am not sure if these results are correct. I tried anyway but got stuck. So:</p>\n\n<pre><code>(foldr const) :: i -&gt; [h] -&gt; i and (curry fst) :: d -&gt; e -&gt; d\n(.) :: (j -&gt; k) -&gt; (l -&gt; j) -&gt; l -&gt; k\n</code></pre>\n\n<p>then i start with: </p>\n\n<p><code>d = (j -&gt; k) -&gt; (l -&gt; j) -&gt; l -&gt; k, e =  d -&gt; e -&gt; d</code></p>\n\n<pre><code>e = (j -&gt; k) -&gt; (l -&gt; j) -&gt; l -&gt; k -&gt; e -&gt; (j -&gt; k) -&gt; (l -&gt; j) -&gt; l -&gt; k\n</code></pre>\n\n<p>but it feels wrong and i cannot continue... \nAre my first two results correct? \nIf they are, how should i solve the last one? </p>\n"}, {"tags": ["haskell", "monads", "reader-monad"], "comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495565180, "post_id": 44142605, "comment_id": 75303431, "body": "You must map the function over <code>ask</code>: <code>a &lt;- (*2) &lt;$&gt; ask</code>"}, {"owner": {"reputation": 5861, "user_id": 3042117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ec10c58136fc12bf83fe45001d672?s=128&d=identicon&r=PG", "display_name": "Iter Ator", "link": "https://stackoverflow.com/users/3042117/iter-ator"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495565307, "post_id": 44142605, "comment_id": 75303490, "body": "Thank you, but how it it possible to call <code>addStuff</code> with an environment? With this code, I het an error: <code>addStuff 10</code>"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495565731, "post_id": 44142605, "comment_id": 75303720, "body": "It depends on your library. You need a function isomorphic to <code>Reader a b -&gt; a -&gt; b</code>. It&#39;s usually called <code>runReader</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5861, "user_id": 3042117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ec10c58136fc12bf83fe45001d672?s=128&d=identicon&r=PG", "display_name": "Iter Ator", "link": "https://stackoverflow.com/users/3042117/iter-ator"}, "edited": false, "score": 0, "creation_date": 1495566155, "post_id": 44142950, "comment_id": 75303941, "body": "Is it possible even better? :O"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 5861, "user_id": 3042117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ec10c58136fc12bf83fe45001d672?s=128&d=identicon&r=PG", "display_name": "Iter Ator", "link": "https://stackoverflow.com/users/3042117/iter-ator"}, "edited": false, "score": 1, "creation_date": 1495566464, "post_id": 44142950, "comment_id": 75304099, "body": "Don&#39;t worry too much about &quot;clever&quot; code, or shortcuts, for now. If you are  learning, it&#39;s more important if you understand the basics, e.g. how it works underneath. It&#39;s fine if for a while you will use the two isomorphisms a lot, even if it is not a good style for actual production code."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1495566587, "post_id": 44142950, "comment_id": 75304158, "body": "<code>addStuff = liftA2 (+) (* 2) (+ 10)</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1495566641, "post_id": 44142950, "comment_id": 75304182, "body": "@amalloy But that does not use &quot;the&quot; reader monad, but &quot;the other&quot; reader monad <code>(-&gt;) r</code> :-P It can be quite confusing to discover that we have two (isomorphic) reader monads in Haskell :)"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1495566691, "post_id": 44142950, "comment_id": 75304209, "body": "Well okay, if you prefer to use the <code>asks</code> wrapper you can still do the same thing: <code>liftA2 (+) (asks (* 2)) (asks (+ 10))</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1495566828, "post_id": 44142950, "comment_id": 75304279, "body": "@amalloy I was just mentioning it since the &quot;other&quot; version will likely cause several type errors when mixed with previous code using &quot;the&quot; reader monad. In many cases, I actually like the more direct <code>(-&gt;) r</code> variant."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1495566258, "last_edit_date": 1495566258, "creation_date": 1495565785, "answer_id": 44142950, "question_id": 44142605, "link": "https://stackoverflow.com/questions/44142605/how-to-use-the-reader-monad-with-int-int/44142950#44142950", "title": "How to use the Reader Monad with (Int -&gt; Int)?", "body": "<p>You can convert functions to readers and back with these two isomorphisms:</p>\n\n<pre><code>reader :: (r -&gt; a) -&gt; Reader r a\nrunReader :: Reader r a -&gt; r -&gt; a\n</code></pre>\n\n<p>E.g.</p>\n\n<pre><code>addStuff :: Reader Int Int\naddStuff = do  \n    a &lt;- reader (*2)  \n    b &lt;- reader (+10)\n    return (a+b)\n</code></pre>\n\n<p>and then you can test your code with <code>runReader addStuff 5</code>.</p>\n\n<p>This is OK for learning purposes. For more serious code, you shouldn't use the isomorphisms that much, but instead rely on <code>ask</code> or <code>asks</code>. E.g.</p>\n\n<pre><code>addStuff :: Reader Int Int\naddStuff = do  \n    x &lt;- ask   -- fetch the implicit Int value\n    let a = (*2) x\n        b = (+10) x\n    return (a+b)\n</code></pre>\n\n<p>or, better</p>\n\n<pre><code>addStuff :: Reader Int Int\naddStuff = do  \n    a &lt;- asks (*2) -- fetch the implicit Int value, and apply the function\n    b &lt;- asks (+10)\n    return (a+b)\n</code></pre>\n\n<p>or, even better, using applicative style:</p>\n\n<pre><code>addStuff :: Reader Int Int\naddStuff = (+) &lt;$&gt; asks (*2) &lt;*&gt; asks (+10)\n</code></pre>\n\n<p>The whole point of the reader abstraction is not to think about the underlying function. You can just pretend to have access to a read-only variable, which is accessible through the <code>ask</code> primitive.</p>\n\n<p>Usually, only at the very last step you use <code>runReader</code> to actually use your monadic reader action.</p>\n"}], "owner": {"reputation": 5861, "user_id": 3042117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ec10c58136fc12bf83fe45001d672?s=128&d=identicon&r=PG", "display_name": "Iter Ator", "link": "https://stackoverflow.com/users/3042117/iter-ator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "accepted_answer_id": 44142950, "answer_count": 1, "score": 1, "last_activity_date": 1495566258, "creation_date": 1495564658, "question_id": 44142605, "link": "https://stackoverflow.com/questions/44142605/how-to-use-the-reader-monad-with-int-int", "title": "How to use the Reader Monad with (Int -&gt; Int)?", "body": "<p>I would like to learn, how to use the Reader Monad. Unfortunately only a small amount of example code is available</p>\n\n<p>I would like to create a Reader, where the environment and the retrived values are <code>Int</code>. I defined the type like this:</p>\n\n<pre><code>type IntRead = Reader Int Int\n</code></pre>\n\n<p>The code I tried is this:</p>\n\n<pre><code>addStuff :: Reader Int Int\naddStuff = do  \n    a &lt;- (*2)  \n    b &lt;- (+10)\n    return (a+b)  \n</code></pre>\n\n<p>I get an error, because <code>ReaderT</code> is expected. How to create a function like <code>addStuff</code> using the Reader Monad? Where should I provide the environment to this function?</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 5, "creation_date": 1495554288, "post_id": 44139345, "comment_id": 75297204, "body": "What should <code>entferneBlaetter (NBlatt 1)</code> evaluate to?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1495554519, "post_id": 44139345, "comment_id": 75297359, "body": "What if you give the method an <code>NBlatt</code> as intial value? You cannot remove a leaf from a leaf..."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1495554742, "post_id": 44139345, "comment_id": 75297516, "body": "Furthermore the code is not <i>per se</i> wrong as a start, It only depends on what you will do with <code>entferneBlaetter_help</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1495556249, "post_id": 44139345, "comment_id": 75298470, "body": "how many  <code>a</code> values can your tree hold? Can it hold  one <code>a</code> value? (In how many ways?) Is a leaf a tree? (it is, according to the data definition). If you remove the leaf from a 1-element leaf tree, shouldn&#39;t the result hold zero <code>a</code> values? Can your tree hold zero <code>a</code> values? Is there a difference between <code>Nblatt 7</code> and <code>NKnoten 7 []</code>? Do you really need <code>Nblatt a</code> at all?"}, {"owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "edited": false, "score": 0, "creation_date": 1495566405, "post_id": 44139345, "comment_id": 75304075, "body": "Would be good to define specifically what you mean by &quot;leaf&quot;, as <code>NBlatt &quot;test&quot;</code> and <code>NKoten &quot;test&quot; []</code> both don&#39;t &quot;recurse&quot; and hold other nodes. Are they both to be deleted?"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1495554371, "creation_date": 1495554371, "answer_id": 44139497, "question_id": 44139345, "link": "https://stackoverflow.com/questions/44139345/delete-all-leaves-in-a-tree-in-haskell/44139497#44139497", "title": "Delete all leaves in a tree in Haskell", "body": "<p>Here's a hint.</p>\n\n<p>When dealing with <code>NKnoten a b</code>, we want to:</p>\n\n<ul>\n<li>scan all the trees in the <code>b</code> list:\n\n<ul>\n<li>if we find a leaf tree, we remove it from the list</li>\n<li>if we find a node tree, we recursively remove the leaves from the subtrees of that node, and keep the result in the list.</li>\n</ul></li>\n</ul>\n\n<p>A basic approach could be to write your <code>entferneBlaetter_help</code> recursively.</p>\n\n<p>By the way, I think this exercise would best be realized using <code>entferneBlaetter :: NBaum a -&gt; Maybe (NBaum a)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 0, "last_activity_date": 1495562115, "last_edit_date": 1495562115, "creation_date": 1495561778, "answer_id": 44141764, "question_id": 44139345, "link": "https://stackoverflow.com/questions/44139345/delete-all-leaves-in-a-tree-in-haskell/44141764#44141764", "title": "Delete all leaves in a tree in Haskell", "body": "<p>Some hints, apologies if you\u2019ve gotten this far already:</p>\n\n<p>Since, in Haskell, your trees are immutable, removing something from one means constructing a new tree without it.  Hence the type <code>entferneBlaetter :: NBaum a -&gt; NBaum a</code>.</p>\n\n<p>All your leaves appear to be either <code>NBlatt a</code> nodes, or possibly <code>NKnoten a []</code> nodes if that\u2019s allowed.  But observe that, once you descend to a <code>NKnoten</code> node, it\u2019s too late; there\u2019s nothing you can return to construct a tree without one.</p>\n\n<p>But you always scan the parent branch first, and the parent of a leaf node is always a <code>NKnoten</code>.  So you might try to <code>filter</code> the list of daughter nodes.  This might, however, leave you with a bare branch, <code>NKnoten a []</code>.  So, if you\u2019re allowed to change the type signature of entferneBlaetter, you could pass a <code>Maybe NBaum</code> up to the caller, and it could then check whether all the daughter nodes evaluated to <code>Nothing</code>, then pass back either the pruned branch or replace <code>NKnoten a []</code> with <code>NBlatt a</code>.</p>\n\n<p>As a bonus, if your tree consists of a single leaf node, you would then be able to prune it to <code>Nothing</code>.  But if your interface is fixed, you can still define a helper function <code>entferneBlaetter' :: NBaum -&gt; Maybe NBaum</code>.</p>\n\n<p>Alternatively, you could make a second transformation pass that replaces all instances of <code>NKnoten a []</code> with <code>NBlatt a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "is_accepted": false, "score": 0, "last_activity_date": 1495576879, "last_edit_date": 1495576879, "creation_date": 1495575817, "answer_id": 44145542, "question_id": 44139345, "link": "https://stackoverflow.com/questions/44139345/delete-all-leaves-in-a-tree-in-haskell/44145542#44145542", "title": "Delete all leaves in a tree in Haskell", "body": "<p>The problem isn't 100% specified in terms of what constitutes leaves and what should happen when the tree only has a single node. However, if we come up with a definition of \"leaf\" ...</p>\n\n<pre><code>isLeaf :: NBaum a -&gt; Bool\nisLeaf (NBlatt _)     = True\nisLeaf (NKnoten _ []) = True\nisLeaf _              = False\n</code></pre>\n\n<p>... we can give a recursive solution, recursing for each node in the list that is not a leaf, or removing it if it is.</p>\n\n<pre><code>entferneBlaetter :: NBaum a -&gt; NBaum a\nentferneBlaetter (NKnoten s xs) = NKnoten s [entferneBlaetter x | x &lt;- xs, not $ isLeaf x]\nentferneBlaetter x              = x\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 7291355, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ed78a444f6b132a5c6af56e3c51462cb?s=128&d=identicon&r=PG&f=1", "display_name": "Fl4mer", "link": "https://stackoverflow.com/users/7291355/fl4mer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1495645343, "creation_date": 1495553942, "last_edit_date": 1495645343, "question_id": 44139345, "link": "https://stackoverflow.com/questions/44139345/delete-all-leaves-in-a-tree-in-haskell", "title": "Delete all leaves in a tree in Haskell", "body": "<p>Hey guys i have a problem. I would like to delete all leaves of a tree.\nMy init of a tree is <code>data NBaum a = NBlatt a | NKnoten a [NBaum a]</code>. I have no idea how i can do this and which is the command that the Nblatt is empty. Maybe u guys can help me.</p>\n\n<p>My function should take a NBaum as an input and the output is a NBaum too.<code>entferneBlaetter :: NBaum a -&gt; NBaum a</code></p>\n\n<p>I tried already  this code but it's wrong:</p>\n\n<pre><code>entferneBlaetter (NBlatt _) = NBlatt \"test\"\nentferneBlaetter (NKnoten a b) = NKnoten a (entferneBlaetter_help b)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495544300, "post_id": 44134833, "comment_id": 75289497, "body": "You might be able to get away with <code>type Flip f a b = f b a</code> and <code>TypeSynonymInstances</code>, but really you should change the argument order or use a newtype instead."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1495548417, "post_id": 44134833, "comment_id": 75292776, "body": "@Lazersmoke: That won&#39;t work, since type synonyms need to be fully applied."}, {"owner": {"reputation": 815, "user_id": 245743, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11a87619d08da72466e99e16453ea318?s=128&d=identicon&r=PG", "display_name": "ppb", "link": "https://stackoverflow.com/users/245743/ppb"}, "edited": false, "score": 1, "creation_date": 1495552972, "post_id": 44134833, "comment_id": 75296300, "body": "I know it doesn&#39;t answer the question directly but perhaps make it a Bifunctor so you can map over a or b or both?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 815, "user_id": 245743, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11a87619d08da72466e99e16453ea318?s=128&d=identicon&r=PG", "display_name": "ppb", "link": "https://stackoverflow.com/users/245743/ppb"}, "edited": false, "score": 1, "creation_date": 1495555790, "post_id": 44134833, "comment_id": 75298166, "body": "@ppb &#39;s suggestion is a good alternative. It also give you the option of using <a href=\"https://hackage.haskell.org/package/bifunctors-5.4.1/docs/Data-Bifunctor-Flip.html\" rel=\"nofollow noreferrer\"><code>Data.Bifunctor.Flip</code></a> (yes, it&#39;s a newtype, but at least it&#39;s one you don&#39;t have to define)."}], "answers": [{"comments": [{"owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "edited": false, "score": 0, "creation_date": 1495580978, "post_id": 44139690, "comment_id": 75310496, "body": "Ahh. Stack overflow. One of the few places on the internet where people are genuinely\u200b helpful. Thank you very much for such and elaborate answer!"}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 6, "last_activity_date": 1495555001, "creation_date": 1495555001, "answer_id": 44139690, "question_id": 44134833, "link": "https://stackoverflow.com/questions/44134833/order-of-type-variables-in-instance-declarations/44139690#44139690", "title": "Order of type-variables in instance-declarations", "body": "<p>It's not arbitrary. It's how Hindley-Milner type inference works with higher-kinded types and curried type constructor application. Unification of type variables is based on the concept of generative type constructors.  That is, if <code>(f a) ~ (g b)</code>, then <code>f ~ g</code> and <code>a ~ b</code>, where <code>~</code> is type equality.</p>\n\n<p>Let's apply that to unification of an expression like <code>(fmap f someT)</code>, for <code>someT :: T a b</code>.  I'll start by giving everything other than <code>someT</code> fresh type variables, to work the way unification does.</p>\n\n<pre><code>someT :: T a b\nfmap :: (c -&gt; d) -&gt; f c -&gt; f d\nf :: e\n</code></pre>\n\n<p>By the fact that <code>fmap</code> is provided <code>f</code> as a first argument, we unify <code>(c -&gt; d) ~ e</code>. So..</p>\n\n<pre><code>fmap f :: f c -&gt; f d\nsomeT :: T a b\n</code></pre>\n\n<p>This is where generativity comes into it.  From here, we see <code>(f c) ~ (T a b)</code>.  Let me add some additional parenthesis for clarity:  <code>(f c) ~ ((T a) b)</code>.  This is how type constructors work in Haskell - they are curried in the same way as term-level functions. By generativity, <code>f ~ (T a)</code> and <code>c ~ b</code>.</p>\n\n<p>Then from that:</p>\n\n<pre><code>fmap f someT :: T a d\n</code></pre>\n\n<p>So it's necessarily true that the <code>Functor</code> instance must operate only on the second type argument of the type <code>T</code>.</p>\n\n<p>Of course this all goes back to the type inference algorithm. You could give up Hindley-Milner or curried type constructors to make things work differently. But the result would be very different from Haskell in far more ways than just allowing a couple instances that Haskell doesn't.</p>\n"}], "owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 44139690, "answer_count": 1, "score": 1, "last_activity_date": 1495555001, "creation_date": 1495542471, "question_id": 44134833, "link": "https://stackoverflow.com/questions/44134833/order-of-type-variables-in-instance-declarations", "title": "Order of type-variables in instance-declarations", "body": "<p>Suppose I have a type <code>T a b</code> and I want to write an instance declarations e.g. an instance declaration for <code>Functor</code> that ranges over <code>a</code> and <em>not</em> <code>b</code>. Is this possible without defining a <code>newtype</code>?</p>\n\n<p>I read <a href=\"https://stackoverflow.com/questions/16860473/what-is-the-rule-of-the-order-of-multiple-type-variables-in-haskell\">What is the rule of the order of multiple type variables in haskell?</a> which leads me to believe that this is not possible, but this seems completely arbitrary to me.</p>\n\n<p>What I'm hoping for is something like:</p>\n\n<pre><code>instance Functor (T * b)\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "ebnf", "megaparsec"], "comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495541692, "post_id": 44133794, "comment_id": 75287554, "body": "Does it work how you want it if you use <code>(try alternativeTerm)</code> in <code>production</code>? Just a guess, since it seems like you need backtracking."}, {"owner": {"reputation": 748, "user_id": 7801892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f87eb8937bf17dd8dee0658a4695d2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Kiener", "link": "https://stackoverflow.com/users/7801892/phil-kiener"}, "edited": false, "score": 0, "creation_date": 1495546398, "post_id": 44133794, "comment_id": 75291151, "body": "It seems like the parsing does not escape the inner <code>sepBy1</code>. It tries to parse the | as <code>term</code> and fails. What about using <code>sepEndBy1</code> instead?"}, {"owner": {"reputation": 616, "user_id": 3892684, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fs52b.png?s=128&g=1", "display_name": "Jan van Br&#252;gge", "link": "https://stackoverflow.com/users/3892684/jan-van-br%c3%bcgge"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495546837, "post_id": 44133794, "comment_id": 75291480, "body": "@Lazersmoke try does not work"}, {"owner": {"reputation": 616, "user_id": 3892684, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fs52b.png?s=128&g=1", "display_name": "Jan van Br&#252;gge", "link": "https://stackoverflow.com/users/3892684/jan-van-br%c3%bcgge"}, "reply_to_user": {"reputation": 748, "user_id": 7801892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f87eb8937bf17dd8dee0658a4695d2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Kiener", "link": "https://stackoverflow.com/users/7801892/phil-kiener"}, "edited": false, "score": 0, "creation_date": 1495546867, "post_id": 44133794, "comment_id": 75291506, "body": "@PhilippKiener which sepBy should I replace?"}, {"owner": {"reputation": 748, "user_id": 7801892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f87eb8937bf17dd8dee0658a4695d2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Kiener", "link": "https://stackoverflow.com/users/7801892/phil-kiener"}, "edited": false, "score": 0, "creation_date": 1495548150, "post_id": 44133794, "comment_id": 75292588, "body": "The one in <code>alternativeTerm</code>. This only works when there is a guaranteed space between the last term and the |, though."}], "answers": [{"comments": [{"owner": {"reputation": 616, "user_id": 3892684, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fs52b.png?s=128&g=1", "display_name": "Jan van Br&#252;gge", "link": "https://stackoverflow.com/users/3892684/jan-van-br%c3%bcgge"}, "edited": false, "score": 0, "creation_date": 1495609631, "post_id": 44137937, "comment_id": 75319449, "body": "Thanks, that works now. I will most likely add a tokenizer, so I dont have to deal with spaces any more"}], "tags": [], "owner": {"reputation": 748, "user_id": 7801892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f87eb8937bf17dd8dee0658a4695d2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Kiener", "link": "https://stackoverflow.com/users/7801892/phil-kiener"}, "is_accepted": true, "score": 1, "last_activity_date": 1495570598, "last_edit_date": 1495570598, "creation_date": 1495550467, "answer_id": 44137937, "question_id": 44133794, "link": "https://stackoverflow.com/questions/44133794/parse-ebnf-with-megaparsec-nested-sepby/44137937#44137937", "title": "Parse EBNF with Megaparsec nested sepBy", "body": "<p>It's probably best to expand my previous comment into a full answer.</p>\n\n<p>Your grammar is basically a list of list of terms seperated (and ended) by whitespace, which in turn is seperated by |. Your solution with <code>sepBy1</code> does not work because there is a trailing whitespace after <code>LITERAL</code> - <code>sepBy1</code> assumes there is another term following that whitespace and tries to apply <code>term</code> to the |, which fails.</p>\n\n<p>If your <code>alternativeTerm</code> is guaranteed to end with a whitespace character (or multiple), rewrite your <code>alternativeTerm</code> as follows:</p>\n\n<pre><code>alternativeTerm = (term `sepEndBy1` space) &gt;&gt;= return . AlternativeTerm\n</code></pre>\n"}], "owner": {"reputation": 616, "user_id": 3892684, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fs52b.png?s=128&g=1", "display_name": "Jan van Br&#252;gge", "link": "https://stackoverflow.com/users/3892684/jan-van-br%c3%bcgge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 44137937, "answer_count": 1, "score": 2, "last_activity_date": 1495570598, "creation_date": 1495539563, "question_id": 44133794, "link": "https://stackoverflow.com/questions/44133794/parse-ebnf-with-megaparsec-nested-sepby", "title": "Parse EBNF with Megaparsec nested sepBy", "body": "<p>As an exercise I try to parse a EBNF/ABNF grammar with Megaparsec. I got trivial stuff like terminals and optionals working, but I'm struggling with alternatives. With this grammar:</p>\n\n<pre><code>S ::= 'hello' ['world'] IDENTIFIER LITERAL | 'test';\n</code></pre>\n\n<p>And this code:</p>\n\n<pre><code>production :: Parser Production\nproduction = sepBy1 alternativeTerm (char '|') &gt;&gt;= return . Production\n\nalternativeTerm :: Parser AlternativeTerm\nalternativeTerm = sepBy1 term space &gt;&gt;= return . AlternativeTerm\n\nterm :: Parser Term\nterm = terminal\n    &lt;|&gt; optional\n    &lt;|&gt; identifier\n    &lt;|&gt; literal\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>unexpected '|'\nexpecting \"IDENTIFIER\", \"LITERAL\", ''', '[', or white space\n</code></pre>\n\n<p>I guess the alternativeTerm parser is not returning to the production parser when it encounters a sequence that it cannot parse and throws an error instead.</p>\n\n<p>What can I do about this? Change my ADT of an EBNF or should I somehow flatten the parsing. But then again, how can I do so?</p>\n"}, {"tags": ["haskell", "encoding", "hasql"], "comments": [{"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "edited": false, "score": 0, "creation_date": 1495547870, "post_id": 44133405, "comment_id": 75292354, "body": "Why would you at all need that? It seems like you have some design problem. Even if you encode such a value, you&#39;re likely to get into trouble on the server side, because the server always expects a specific type. Can you elaborate on your use case?"}, {"owner": {"reputation": 63, "user_id": 8053130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba9966601e4914c1df717d47a3bbbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn Rijkeboer", "link": "https://stackoverflow.com/users/8053130/martijn-rijkeboer"}, "reply_to_user": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "edited": false, "score": 0, "creation_date": 1495558974, "post_id": 44133405, "comment_id": 75300080, "body": "I&#39;m building an application that can load CSV data from a file into a database table. The user assigns CSV fields to database columns and specifies the data conversion to use. Since the user specifies the data conversion, I don&#39;t know upfront what kind of data each value will be, hence the sum-type with one entry per data type."}, {"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "edited": false, "score": 1, "creation_date": 1495614605, "post_id": 44133405, "comment_id": 75322898, "body": "Whenever you design database-driven application, the database should come first. If you approached your design that way, you would have discovered that it would have been impossible to create a schema, which supports what your aiming for (i.e., a column, which can hold any type).   The only way to encode a sum-type in a relational database is using multiple columns, one per each type. I.e.: sum_bool, sum_char ... And then you wouldn&#39;t need the sum value encoder, as I expected."}, {"owner": {"reputation": 63, "user_id": 8053130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba9966601e4914c1df717d47a3bbbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn Rijkeboer", "link": "https://stackoverflow.com/users/8053130/martijn-rijkeboer"}, "reply_to_user": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "edited": false, "score": 0, "creation_date": 1495733463, "post_id": 44133405, "comment_id": 75386729, "body": "To clarify: the result of the conversion is a <code>Map Text SumType</code> where the <code>Text</code> is the name of the database column, so I&#39;m not storing sum-types in the database. Furthermore, the user specifies both the database table layout and the conversion at run-time."}], "answers": [{"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": true, "score": 2, "last_activity_date": 1495550271, "creation_date": 1495550271, "answer_id": 44137843, "question_id": 44133405, "link": "https://stackoverflow.com/questions/44133405/hasql-encode-a-sum-type/44137843#44137843", "title": "Hasql: encode a sum-type", "body": "<p>While this seems highly likely to be a mistake in your design,\nin the current version of Hasql (0.19.*) it is possible to implement such an encoder\nat least on the level of <code>Params</code>.\nHowever I must notice that,\nunless provided with a use-case,\nwhich proves it useful, the support for this will be removed completely in the next major release in the sake of type-level security.</p>\n\n<p>Either way, here's how you can do that now:</p>\n\n<pre><code>import qualified Hasql.Encoders as A\n\ndata SumValue\n  = SumBool !(Maybe Bool)\n  | SumChar !(Maybe Char)\n  | SumDate !(Maybe Day)\n  | SumUuid !(Maybe UUID)\n  deriving (Eq, Show)\n\nsumValue :: A.Params SumValue\nsumValue =\n  contramap match $\n  chosen (A.nullableValue A.bool) $\n  chosen (A.nullableValue A.char) $\n  chosen (A.nullableValue A.date) $\n  A.nullableValue A.uuid\n  where\n    match =\n      \\case\n        SumBool x -&gt; Left x\n        SumChar x -&gt; Right (Left x)\n        SumDate x -&gt; Right (Right (Left x))\n        SumUuid x -&gt; Right (Right (Right x))\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 8053130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba9966601e4914c1df717d47a3bbbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn Rijkeboer", "link": "https://stackoverflow.com/users/8053130/martijn-rijkeboer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 44137843, "answer_count": 1, "score": 2, "last_activity_date": 1495550271, "creation_date": 1495538582, "question_id": 44133405, "link": "https://stackoverflow.com/questions/44133405/hasql-encode-a-sum-type", "title": "Hasql: encode a sum-type", "body": "<p>How to encode the following sum-type using Hasql? I tried to create an encoder <code>sumValue :: Value SumValue</code>, but I can't pattern match. E.g. I would like to encode <code>SumBool</code> with <code>Hasql.Encoders.bool</code> and <code>SumChar</code> with <code>Hasql.Encoders.char</code>.</p>\n\n<pre><code>data SumValue\n  = SumBool !(Maybe Bool)\n  | SumChar !(Maybe Char)\n  | SumDate !(Maybe Day)\n  | ...\n  | SumUuid !(Maybe UUID)\n  deriving (Eq, Show)\n</code></pre>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 5, "creation_date": 1495539100, "post_id": 44132526, "comment_id": 75285637, "body": "There is no question in your post."}, {"owner": {"reputation": 1, "user_id": 8052881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11f603742baa3094d0d856502ce118c?s=128&d=identicon&r=PG&f=1", "display_name": "jane_doe", "link": "https://stackoverflow.com/users/8052881/jane-doe"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1495557749, "post_id": 44132526, "comment_id": 75299376, "body": "I have to find all the possible paths in design tree and change one Int in Points and then 180 in design again."}, {"owner": {"reputation": 13132, "user_id": 2168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5e7e68e1cdaea224d93da209afb28e9d?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2168/john"}, "edited": false, "score": 0, "creation_date": 1495576999, "post_id": 44132526, "comment_id": 75309225, "body": "You&#39;ve told us what you have to do, but you still haven&#39;t told us what part you are having trouble with and want help on."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8052881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11f603742baa3094d0d856502ce118c?s=128&d=identicon&r=PG&f=1", "display_name": "jane_doe", "link": "https://stackoverflow.com/users/8052881/jane-doe"}, "edited": false, "score": 0, "creation_date": 1495561139, "post_id": 44141111, "comment_id": 75301209, "body": "Thanks a lot! What I mean:                                                                 data Tree = Leaf Points | Branch Points [Tree]                                     has    type Points = [(Int,Int,Int,Int)] and i want to change the last Integer there.                                                                                                   Also data Design = Design Tree Tree Int     has   design = Design mtree btree 180              and i want  to change that 180."}], "tags": [], "owner": {"reputation": 139, "user_id": 6053118, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Y9Y01.jpg?s=128&g=1", "display_name": "Quentin Liu", "link": "https://stackoverflow.com/users/6053118/quentin-liu"}, "is_accepted": false, "score": 0, "last_activity_date": 1495639135, "last_edit_date": 1592644375, "creation_date": 1495559520, "answer_id": 44141111, "question_id": 44132526, "link": "https://stackoverflow.com/questions/44132526/haskell-tree-delete-a-node-calculate-all-possible-paths/44141111#44141111", "title": "Haskell Tree delete a node / calculate all possible paths", "body": "<h2>Count paths</h2>\n<p>To find the number of paths in a tree, we recursively descend down the tree to count the number of subpaths for each node and then sum them up. So aside from having <code>numberPaths</code> as the interface, we also need another auxiliary function whose type signature is <code>Tree -&gt; Int</code>. Let's call it <code>descend</code>.</p>\n<pre><code>descend :: Tree -&gt; Int \n</code></pre>\n<p>We count <code>Leaf</code> as 1, and <code>Branch</code> as the sum of number of paths of its subtrees. So the <code>descend</code> becomes:</p>\n<pre><code>descend :: Tree -&gt; Int \ndescend (Leaf _)            = 1 \ndescend (Branch _ subtress) = foldr (\\tree sum -&gt; sum + descend tree) 0 subtrees \n</code></pre>\n<p>The function <code>numberPaths</code> only need to call <code>descend</code> to count its two trees.</p>\n<pre><code>numberPaths :: Design -&gt; Int \nnumberPaths (Design a b _) = descend a + descend b \n</code></pre>\n<h2>Chang Int</h2>\n<p>The type signature of <code>changeInt</code> indicates that no <code>Int</code> value is introduced to change <code>Design</code> type. This, I think, does not make sense so I have taken the liberty of changing it into <code>Int -&gt; Design -&gt; Design</code>.</p>\n<p>The implementation of <code>changeInt</code> follows a similar pattern. To change the tree we recursively walk down each level of the tree. We also introduce an auxiliary function <code>changePoints</code>.</p>\n<pre><code>changeTree :: Int -&gt; Tree -&gt; Tree\nchangeTree n (Leaf points)            = Leaf $ changePoints n points\nchangeTree n (Branch points subtrees) = Branch points' subtrees'\n    where points'   = changePoints n points \n          subtrees' = map (changeTree n) subtrees\n\nchangePoints :: Int -&gt; Points -&gt; Points \nchangePoints n points = map (\\(x, y, _, z) -&gt; (x, y, n, z)) points \n</code></pre>\n<p>The <code>changeInt</code> then only needs to call <code>changeTree</code> to finish the job.</p>\n<pre><code>changeInt :: Int -&gt; Design -&gt; Design \nchangeInt n (Design mtree btree _) = Design mtree' btree' n\n    where mtree' = changeTree n mtree \n          btree' = changeTree n btree \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8052881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11f603742baa3094d0d856502ce118c?s=128&d=identicon&r=PG&f=1", "display_name": "jane_doe", "link": "https://stackoverflow.com/users/8052881/jane-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495639135, "creation_date": 1495536097, "last_edit_date": 1495556826, "question_id": 44132526, "link": "https://stackoverflow.com/questions/44132526/haskell-tree-delete-a-node-calculate-all-possible-paths", "title": "Haskell Tree delete a node / calculate all possible paths", "body": "<p>I have these  structures: </p>\n\n<pre><code>data Tree = Leaf Points | Branch Points [Tree]\nderiving(Eq,Show)\n\ndata Design = Design Tree Tree Int\nderiving(Eq,Show)\n</code></pre>\n\n<p>data type <code>Tree</code> is a part of data type <code>Design</code> and <code>Design</code> holds two <code>Trees</code>: </p>\n\n<pre><code> type Points = [(Int,Int,Int,Int)]\n\n design = Design mtree btree 180\n</code></pre>\n\n<p>I have to find all the possible paths:</p>\n\n<pre><code>numberPaths :: Design -&gt; Int\n</code></pre>\n\n<p>and change the third <code>Integer</code> from <code>Points</code> and also 180 from <code>design</code>: </p>\n\n<pre><code>type Points = [(Int,Int,Int,Int)]\ndesign = Design mtree btree 180\n\nchangeInt :: Design -&gt; Design\n</code></pre>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1495536233, "post_id": 44132084, "comment_id": 75283522, "body": "<a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2010-September/083735.html\" rel=\"nofollow noreferrer\">Maybe this will be of use?</a> I&#39;d think about what are you really going to gain from such random functions, though. I&#39;d say that some edge cases is everything that this needs."}], "answers": [{"comments": [{"owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "edited": false, "score": 0, "creation_date": 1495549316, "post_id": 44132889, "comment_id": 75293425, "body": "I see this but I would like to define the Functor properties in a generic fashion. See my code above. This way I won&#39;t have to rewrite the properties for each type that I write"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 3, "last_activity_date": 1495537079, "creation_date": 1495537079, "answer_id": 44132889, "question_id": 44132084, "link": "https://stackoverflow.com/questions/44132084/how-to-write-an-arbitrary-instance-for-a-type-that-wraps-a-function/44132889#44132889", "title": "How to write an Arbitrary instance for a type that wraps a function?", "body": "<p>You should use <a href=\"https://hackage.haskell.org/package/QuickCheck-2.9.2/docs/Test-QuickCheck-Function.html\" rel=\"nofollow noreferrer\"><code>Test.QuickCheck.Function</code></a> wrapper to test functions. It seems to have no sense in having <code>Arbitrary</code> or <code>CoArbitrary</code> instances for <code>Transaction</code> if you only need to test type class laws for your <code>Transaction</code> type (but if you really need it, you can find <a href=\"https://stackoverflow.com/questions/43409610/how-to-write-a-test-for-statet-using-quickcheck\">my answer to this question</a>).</p>\n\n<p>To test laws you can write properties in the way like this:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\nimport Test.QuickCheck\nimport Test.QuickCheck.Function\n\nnewtype Transaction d e r = Transaction (d -&gt; Either e (d,r))\n  deriving (Functor)\n\n-- fmap id \u2261 id\nprop_transactionFunctorId :: Int\n                          -&gt; Fun Int (Either Bool (Int,String)) \n                          -&gt; Bool\nprop_transactionFunctorId d (Fun _ f) = let t              = Transaction f\n                                            Transaction f' = fmap id t\n                                        in f' d == f d\n</code></pre>\n\n<p>Well, this may look like not as pretty and nice as you want. But this is a good way to test arbitrary functions. For example, we can replace last line <code>in f' d == f d</code> to <code>in f' d == f 1</code> to see how it fails if it fails:</p>\n\n<pre><code>ghci&gt; quickCheck prop_transactionFunctorId \n*** Failed! Falsifiable (after 2 tests and 4 shrinks):    \n0\n{0-&gt;Left False, _-&gt;Right (0,\"\")}\n</code></pre>\n"}], "owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 44132889, "answer_count": 1, "score": 3, "last_activity_date": 1495549219, "creation_date": 1495534885, "last_edit_date": 1495549219, "question_id": 44132084, "link": "https://stackoverflow.com/questions/44132084/how-to-write-an-arbitrary-instance-for-a-type-that-wraps-a-function", "title": "How to write an Arbitrary instance for a type that wraps a function?", "body": "<p>I have this type which wraps a function</p>\n\n<pre><code>newtype Transaction d e r = Transaction (d -&gt; Either e (d,r))\n</code></pre>\n\n<p>...and I want to do quickcheck tests for its Functor &amp; Applicative instances but the compiler complains that it doesn't have an Arbitrary instance.</p>\n\n<p>I tried to do so but I'm stuck at generating the random function.</p>\n\n<p>Thanks!</p>\n\n<p>== UPDATE ==</p>\n\n<p>The quickcheck properties are defined like this</p>\n\n<pre><code>type IdProperty f a = f a -&gt; Bool\nfunctorIdProp :: (Functor f, Eq (f a)) =&gt; IdProperty f a\nfunctorIdProp x = (fmap id x) == id x\n\ntype CompositionProperty f a b c = f a -&gt; Fun a b -&gt; Fun b c -&gt; Bool\nfunctorCompProp :: (Functor f, Eq (f c)) =&gt; CompositionProperty f a b c\nfunctorCompProp x (apply -&gt; f) (apply -&gt; g) = (fmap (g . f) x) == (fmap g . fmap f $ x)\n\ninstance (Arbitrary ((-&gt;) d  (Either e (d, a)))) =&gt; Arbitrary (DbTr d e a) where\n    arbitrary = do\n      f &lt;- ...???\n      return $ Transaction f\n</code></pre>\n\n<p>...and the tests look like this:</p>\n\n<pre><code>spec = do\n  describe \"Functor properties for (Transaction Int String)\" $ do\n    it \"IdProperty (Transaction Int String) Int\" $ do\n      property (functorIdProp :: IdProperty (Transaction Int String) Int)\n\n    it \"CompositionProperty (Transaction Int String) Int String Float\" $ do\n      property (functorCompProp :: CompositionProperty (Transaction Int String) Int String Float)\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "higher-order-functions", "currying"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1495532597, "post_id": 44130958, "comment_id": 75280874, "body": "To full extent? I&#39;m not sure what exactly you are asking, or what part you don&#39;t understand."}, {"owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1495532772, "post_id": 44130958, "comment_id": 75281002, "body": "Well I don&#39;t understand how this function stands for an addition. To what extent does the function definition <i>defines</i> an addition."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1495533156, "post_id": 44130958, "comment_id": 75281282, "body": "The addition is defined by the <code>+</code> operator, which <code>plusc</code> uses. Maybe it helps to write out <code>plusc x y = x + y</code> or <code>plusc = \\x -&gt; \\y -&gt; x + y</code> (which are just syntactic sugar for each other, like <code>x + y</code> = <code>(+) x y</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1495533019, "post_id": 44131352, "comment_id": 75281181, "body": "Higher-order can also mean that a function returns another function, which is pretty standard for Haskell&#39;s curried functions though"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1495533089, "post_id": 44131352, "comment_id": 75281230, "body": "@Bergi oh well, okay, <i>returning</i> a function could perhaps also make a function a HOF; I very rarely look at it that way, but I&#39;ll edit it in."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1495555034, "post_id": 44131352, "comment_id": 75297702, "body": "@Bergi In Haskell, I also rarely think of function-returning functions as HOFs, but I guess that could still fit. I&#39;d probably be more tempted to call <code>plusc</code> a HOF because the <code>Num a =&gt;</code> constraint is implicitly passing a dictionary containing a bunch of functions to <code>plusc</code>. Still, I think that the &quot;HOF&quot; terminology is no longer that useful nowadays -- HOFs have become too common to notice them."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 0, "last_activity_date": 1495533033, "last_edit_date": 1495533033, "creation_date": 1495532909, "answer_id": 44131352, "question_id": 44130958, "link": "https://stackoverflow.com/questions/44130958/understanding-currying-and-hofs/44131352#44131352", "title": "Understanding currying and HOFs", "body": "<p>I wouldn't <em>personally</em> call <code>plusc</code> a HOF, because its arguments aren't functions. A way to spot an obvious HOF is to look for a parens in the signature that <em>aren't at the leftmost side</em>:</p>\n\n<pre><code>{- equivalent signature -}\nplusc :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>When we remove optional parens, it's obvious that the function isn't a HOF that takes functions, but it's curried.</p>\n\n<blockquote>\n  <p>Note: Since every curried function can <em>return</em> a function, though, we might say that after partially applying it, it returns a function, and as such operates on functions - so it is a HOF. I don't think this is particularly helpful way of describing/learning the concept, but I suppose the definition would span both parameters and results.</p>\n</blockquote>\n\n<p>An uncurried version would simply group its arguments:</p>\n\n<pre><code>plusUnc :: Num a =&gt; (a, a) -&gt; a\n</code></pre>\n\n<p>Now a HOF might <em>take</em> such a function and turn it into some other one:</p>\n\n<pre><code>imu :: Num a =&gt; (a -&gt; a -&gt; a) -&gt; (a -&gt; a -&gt; a)\nimu f = \\a b -&gt; f a b\n</code></pre>\n\n<blockquote>\n  <p>Note: The lambda impl could obviously be simplified, I spelled it out just for illustration.</p>\n</blockquote>\n\n<p>Note that <code>f</code> is the \"lower\" order function that's being passed into <code>imu</code>. To use it:</p>\n\n<pre><code>imuPlus = imu plusc  -- a function is being passed\n\nimuPlus 1 2          -- == 3 \n</code></pre>\n\n<blockquote>\n  <p>Note: since we're mixing both concepts (and you asked for both), <code>imu</code> is also curried. An uncurried version could look like this:</p>\n  \n  <p><code>imuUnc :: ((a -&gt; a -&gt; a), (a, a)) -&gt; a</code></p>\n  \n  <p>Now it is a HOF (it has a function in the parameters), but it doesn't return a function, which differs from the examples above.\n  It's just much easier to use when it's curried, though, mostly because of partial application.</p>\n</blockquote>\n"}], "owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495533033, "creation_date": 1495531881, "last_edit_date": 1495532816, "question_id": 44130958, "link": "https://stackoverflow.com/questions/44130958/understanding-currying-and-hofs", "title": "Understanding currying and HOFs", "body": "<p>I am currently studying functional programming and it's most important feature : Higher Order Functions. </p>\n\n<p>It's not as crystal clear as I'd like currently and therefore I'd like to understand perfectly how HOFs work. </p>\n\n<p>Considering this function</p>\n\n<pre><code>{- Curried addition. -}\nplusc :: Num a =&gt; a -&gt; (a -&gt; a)\nplusc = (+)\n</code></pre>\n\n<p>To what extent can we say that this function uses <strong>currying</strong> and is a HOF ? </p>\n\n<p>EDIT : Basically, I don't understand how the definition of the function stands for an addition (parameters, associativity, etc )</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1495530933, "post_id": 44130436, "comment_id": 75279684, "body": "I don&#39;t think you can&#39;t do this. You can play around a bit with overloaded string literals (see the GHC extension), but I&#39;m unsure how far you will get, or whether this is a good idea to begin with. One might also use a string-indexed GADT, but again I&#39;m not convinced -- it looks too complex when a basic solution exists (mapping to a regular sum type)."}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495531704, "post_id": 44130436, "comment_id": 75280234, "body": "chi: I have 30 such fields, each having at least 10 values. What&#39;s the fastest way to get this done?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1495554654, "post_id": 44130436, "comment_id": 75297456, "body": "If you need to autogenerate that many sum types, each with many fields, you could exploit Template Haskell to do the metaprogramming job. TH can autogenerate the sum types and the parsers / unparsers, in principle. I&#39;m not fluent enough in it to provide a good example."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495556352, "post_id": 44130436, "comment_id": 75298522, "body": "Maybe an enumeration to keys and a mapping to the string literals?  Or a constructor that checks <code>elem</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 3, "last_activity_date": 1495573781, "last_edit_date": 1495573781, "creation_date": 1495571586, "answer_id": 44144476, "question_id": 44130436, "link": "https://stackoverflow.com/questions/44130436/how-to-have-a-sum-type-adt-with-a-known-set-of-string-literals/44144476#44144476", "title": "How to have a sum-type (ADT) with a known set of string literals?", "body": "<p>Haskell doesn't have anything like TypeScript's <a href=\"https://www.typescriptlang.org/docs/handbook/advanced-types.html#string-literal-types\" rel=\"nofollow noreferrer\">string literal types</a> (which are singleton types: TypeScript will only allow you to use a given string if it can tell that you've checked the string does indeed fit the type), and the best way is probably to just hand-roll a regular datatype and a simple smart constructor. But as @chi points out in the comments, if you have a lot of strings to deal with this is probably a job for code generation. </p>\n\n<p>We'll write a Template Haskell helper to turn splices like</p>\n\n<pre><code>stringLitTy \"Foo\" [\"bar\", \"baz\"]\n</code></pre>\n\n<p>into a <code>data</code> declaration, a smart constructor, and a <code>toString</code> function:</p>\n\n<pre><code>data Foo = Bar | Baz deriving (Eq, Ord, Bounded, Enum, Show, Read)\n\nmkFoo :: String -&gt; Maybe Foo\nmkFoo \"bar\" = Just Bar\nmkFoo \"baz\" = Just Baz\nmkFoo _ = Nothing\n\nfooToString :: Foo -&gt; String\nfooToString Bar = \"bar\"\nfooToString Baz = \"baz\"\n</code></pre>\n\n<p>The code to do this is simple enough, so if you're not familiar with TH this'll be a good crash course.</p>\n\n<p>First let's create some names for the type and the functions, and a mapping from the string literals to some constructor names.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nmodule StringLit where\n\nimport Data.Char\nimport Language.Haskell.TH\n\nlegaliseCon :: String -&gt; String\nlegaliseCon (x:xs) = toUpper x : map (\\c -&gt; if not (isAlphaNum c) then '_' else c) xs\n\nlegaliseFun :: String -&gt; String\nlegaliseFun (x:xs) = toLower x : map (\\c -&gt; if not (isAlphaNum c) then '_' else c) xs\n\nstringLitTy :: String -&gt; [String] -&gt; Q [Dec]\nstringLitTy typeName strs =\n    let tyName = mkName $ legaliseCon typeName\n        constrName = mkName $ legaliseFun (\"mk\" ++ typeName)\n        toStringName = mkName $ legaliseFun (typeName ++ \"ToString\")\n        conNames = [(n, mkName $ legaliseCon n) | n &lt;- strs]\n    in sequenceA [\n        mkDataDecl tyName (map snd conNames),\n        mkConstrDecl constrName conNames,\n        mkToStringDecl toStringName conNames\n        ]\n</code></pre>\n\n<p><code>legaliseCon</code> and <code>legaliseFun</code> are blunt instruments to get a string into a form which is valid for a constructor or a function. (There's definitely room for improvement there!) <code>stringLitTy</code> calls <code>mkDataDecl</code>, <code>mkConstrDecl</code> and <code>mkToStringDecl</code>, below, to generate the top-level declarations. They're all pretty simple: <code>mkDataDecl</code> calls <a href=\"https://hackage.haskell.org/package/template-haskell-2.11.1.0/docs/Language-Haskell-TH.html#v:dataD\" rel=\"nofollow noreferrer\"><code>dataD</code></a> to construct the datatype declaration with an appropriate <code>deriving</code> clause.</p>\n\n<pre><code>enumClasses = sequenceA [\n    [t| Eq |],\n    [t| Ord |],\n    [t| Bounded |],\n    [t| Enum |],\n    [t| Show |],\n    [t| Read |]\n    ]\n\nmkDataDecl :: Name -&gt; [Name] -&gt; Q Dec\nmkDataDecl tyName conNames =\n    dataD\n        (return [])                     -- datatype context\n        tyName                          -- name\n        []                              -- type parameters\n        Nothing                         -- kind annotation\n        [normalC n [] | n &lt;- conNames]  -- constructors, none of which have any parameters\n        enumClasses                     -- \"deriving\" classes\n</code></pre>\n\n<p><code>mkConstrDecl</code> uses <a href=\"https://hackage.haskell.org/package/template-haskell-2.11.1.0/docs/Language-Haskell-TH.html#v:funD\" rel=\"nofollow noreferrer\"><code>funD</code></a> to generate the code for the smart constructor (<code>mkFoo</code>), based on the mapping from strings to the generated constructors' names.</p>\n\n<pre><code>mkConstrDecl :: Name -&gt; [(String, Name)] -&gt; Q Dec\nmkConstrDecl name map = funD name $ [\n    clause\n        [litP $ stringL str]                          -- the string literal pattern on the LHS\n        (normalB $ appE [| Just |] (conE con))        -- Just Con on the RHS\n        []                                            -- where clauses\n    | (str, con) &lt;- map]\n    ++ [clause [wildP] (normalB $ [| Nothing |]) []]  -- mkFoo _ = Nothing\n</code></pre>\n\n<p>And <code>mkToStringDecl</code> does much the same, except the constructors are on the left hand side and the string literals are on the right. And there's need for a wildcard clause or the <code>Maybe</code>.</p>\n\n<pre><code>mkToStringDecl :: Name -&gt; [(String, Name)] -&gt; Q Dec\nmkToStringDecl name map = funD name [\n    clause\n        [conP con []]\n        (normalB $ litE $ stringL str)\n        []\n    | (str, con) &lt;- map]\n</code></pre>\n\n<p>So, if I import <code>StringLit</code> in another module and write a splice,</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell\u00a0#-}\n\nmodule Test where\n\nimport StringLitTy\n\nstringLitTy \"EventTable\" [\"table1\", \"table2\", \"some_other_table\"]\n</code></pre>\n\n<p>I can perform case analysis on the constructors of the generated <code>EventTable</code> type. It's not exactly what you asked for in the question, but I think it gets you 90% of the way there.</p>\n\n<pre><code>tableNumber Table1 = Just 1\ntableNumber Table2 = Just 2\ntableNumber Some_other_table = Nothing\n\n-- for good measure:\nghci&gt; :l Test\n[1 of 2] Compiling StringLitTy      ( StringLitTy.hs, interpreted )\n[2 of 2] Compiling Test             ( Test.hs, interpreted )\nOk, modules loaded: Test, StringLitTy.\n\nghci&gt; :bro\ndata EventTable = Table1 | Table2 | Some_other_table\nmkEventTable :: [Char] -&gt; Maybe EventTable\neventTableToString :: EventTable -&gt; [Char]\n\nghci&gt; tableNumber Table1\nJust 1\n</code></pre>\n\n<p>Oh, one more thing: since the <code>Q</code> monad <a href=\"https://hackage.haskell.org/package/template-haskell-2.11.1.0/docs/Language-Haskell-TH.html#v:runIO\" rel=\"nofollow noreferrer\">allows you to run <code>IO</code> actions</a> in your splices, you can (say) query the database to get your table names. Template Haskell programming is \"just programming\", so you can do all the usual <code>Monad</code> stuff with <code>Q</code> (like <code>traverse</code>):</p>\n\n<pre><code>getTablesFromDb :: IO [(String, [String])]\ngetTablesFromDb = {- ... -}\nmkTables :: Q [Dec]\nmkTables = do\n    tables &lt;- runIO getTablesFromDb\n    concat &lt;$&gt; traverse (uncurry stringLitTy) tables\n</code></pre>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1495573781, "creation_date": 1495530468, "question_id": 44130436, "link": "https://stackoverflow.com/questions/44130436/how-to-have-a-sum-type-adt-with-a-known-set-of-string-literals", "title": "How to have a sum-type (ADT) with a known set of string literals?", "body": "<p>Is it possible to write code in the following spirit:</p>\n\n<pre><code>data EventTable = \"table1\" | \"table2\" | \"some_other_table\"\n\ncase eventTable of \n  \"table1\" -&gt; -- do something\n  \"table2\" -&gt; -- do something else\n  \"some_other_table\" -&gt; -- do something else\n  \"unknown_table\"-&gt; -- SHOULD NOT COMPILE\n</code></pre>\n\n<p>I'm trying to work directly with the string literals that a remote API provides, instead of first mapping them to a regular Haskell sum-type/ADT and having to write serialisation and deserialisation functions for it.</p>\n"}, {"tags": ["haskell", "referential-transparency"], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 2, "last_activity_date": 1495524688, "creation_date": 1495524688, "answer_id": 44128457, "question_id": 44128288, "link": "https://stackoverflow.com/questions/44128288/io-vs-referential-transparency/44128457#44128457", "title": "IO vs referential transparency", "body": "<p>Due to return values are wrapped into <code>IO</code>, you can't reuse them unless you \"pull\" them out, effectively running the IO action:</p>\n\n<pre><code>readLn :: IO String\n\ntwoLines = readLn ++ readLn -- can't do this, because (++) works on String's, not IO String's\n\ntwoLines' = do\n  l1 &lt;- readLn\n  l2 &lt;- readLn -- \"pulling\" out of readLn causes console input to be read again\n  return (l1 ++ l2) -- so l1 and l2 have different values, and this works\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 2, "creation_date": 1495601830, "post_id": 44129331, "comment_id": 75315640, "body": "Thinking of the <code>IO</code> monad in this way is a terrible way to think about it, and this particular view is an implementation detail of GHC and requires hacks in the compiler to work correctly. To see how terrible this is consider what concurrency would look like in this model. Depending on how seriously you take it, you find that it either provides absolutely no explanatory power or it devolves into metaphysics. Continuation-based or free monad based models are much clearer and more accurate. For this question though what <code>IO</code> actually is isn&#39;t relevant, just that it&#39;s a data type like any other."}, {"owner": {"reputation": 1213, "user_id": 544707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVoaL.jpg?s=128&g=1", "display_name": "Anler", "link": "https://stackoverflow.com/users/544707/anler"}, "reply_to_user": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1495611480, "post_id": 44129331, "comment_id": 75320744, "body": "Sorry, I didn&#39;t want to put that kind of emphasis, I also believe that knowing what IO is inside or if it&#39;s a Monad is irrelevant, my goal was to show that from the point of view of the Haskell programmer, functions returning IO-wrapped types are as referentially transparent as any other function, is the evaluation of the IO type by the runtime what isn&#39;t. This <i>contrived example</i> shows that if we can hide IO computations from the runtime, those IO functions do nothing: <a href=\"https://gist.github.com/anler/d2633d55a26e11d3805c776efba22eed\" rel=\"nofollow noreferrer\">gist.github.com/anler/d2633d55a26e11d3805c776efba22eed</a>"}], "tags": [], "owner": {"reputation": 1213, "user_id": 544707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVoaL.jpg?s=128&g=1", "display_name": "Anler", "link": "https://stackoverflow.com/users/544707/anler"}, "is_accepted": true, "score": 2, "last_activity_date": 1495527247, "creation_date": 1495527247, "answer_id": 44129331, "question_id": 44128288, "link": "https://stackoverflow.com/questions/44128288/io-vs-referential-transparency/44129331#44129331", "title": "IO vs referential transparency", "body": "<p>The IO type is defined as:</p>\n\n<pre><code>newtype IO a = IO (State# RealWorld -&gt; (# State# RealWorld, a #))\n</code></pre>\n\n<p>Notice is very similar to the State Monad where the state is <em>the state of the real world</em>, so imho you can think of IO as referentially transparent and pure, what's impure is the Haskell runtime (interpreter) that runs your IO actions (the algebra).</p>\n\n<p>Take a look at the Haskell wiki, it explains IO in greater detail: <a href=\"https://wiki.haskell.org/IO_inside\" rel=\"nofollow noreferrer\">IO Inside</a></p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 1, "last_activity_date": 1495589899, "last_edit_date": 1495589899, "creation_date": 1495530144, "answer_id": 44130308, "question_id": 44128288, "link": "https://stackoverflow.com/questions/44128288/io-vs-referential-transparency/44130308#44130308", "title": "IO vs referential transparency", "body": "<p>Sort of.  You\u2019ve probably heard that <code>IO</code>  is a monad, which means a value wrapped in it has to use monadic operations, such as bind (<code>&gt;&gt;=</code>), sequential composition (<code>&gt;&gt;</code>) and <code>return</code>.  So, you could write a greeting program like this:</p>\n\n<pre><code>prompt :: IO String\nprompt = putStrLn \"Who are you?\" &gt;&gt;\n         getLine &gt;&gt;=\n         \\name -&gt;\n           return $ \"Hello, \" ++ name ++ \"!\"\n\nmain :: IO ()\nmain = prompt &gt;&gt;=\n       putStrLn\n</code></pre>\n\n<p>You\u2019re more likely to see this with the equivalent <code>do</code> notation, which is just another way of writing  the exact same program.  In this case, though, I think the unsugared version makes it clearer that the computation is a series of statements chained together with <code>&gt;&gt;</code> and <code>&gt;&gt;=</code>, where we use <code>&gt;&gt;</code> when we want to throw out the result of the previous step, and <code>&gt;&gt;=</code> when we want to pass a result to the next function in the chain.  If we need to give that result a name, we can capture it as a parameter, like in the lambda expression <code>\\name -&gt;</code> inside <code>prompt</code>.  If we need to lift a simple <code>String</code> into an <code>IO String</code>, we use <code>return</code>.</p>\n\n<p>The equivalent in <code>do</code> notation, by the way, is:</p>\n\n<pre><code>prompt :: IO String\nprompt = do\n  putStrLn \"Who are you?\"\n  name &lt;- getLine\n  return $ \"Hello, \" ++ name ++ \"!\"\n\nmain :: IO ()\nmain = do\n  message &lt;- prompt\n  putStrLn message\n</code></pre>\n\n<p>So how does it know that <code>main</code>, which returns nothing, is not referentially transparent, and that <code>prompt</code>, which returns an <code>IO String</code>, is not either?  There is something special to <code>IO</code>, or at least something <code>IO</code> lacks: with many other monads, such as <code>State</code> and <code>Maybe</code>, there is a way to do a lazy computation inside the monad and discard the wrapper, getting a pure value back out.  You can declare a <code>State Int</code> monad, <code>do</code> deterministic, sequential, stateful computations inside it for a while, then use <code>evalState</code> to get the pure <code>Int</code> result back.  You can do a <code>Maybe Char</code> computation, like searching for a character in a string, check that it worked, and if so, read the pure <code>Char</code> back out.</p>\n\n<p>With <code>IO</code>, you cannot do this.  If you have an <code>IO String</code>, all you can do with it is bind it to an <code>IO</code> function that takes a <code>String</code> argument, such as <code>PutStrLn</code>, or pass it to a function that takes an <code>IO String</code> argument.  If you call <code>prompt</code> a second time, it won\u2019t silently give you the same result; it will actually run again.  If you tell it to pause for a few milliseconds, it won\u2019t lazily wait until you need some return value later in the program to do that.  If it returns an empty value like <code>IO ()</code>, the compiler will not optimize it by just returning that constant.</p>\n\n<p>The way this works internally is to wrap the object together with a state-of-the-world parameter that is different for each call.  That means that two different calls to <code>getLine</code> depend on different states of the world, and the return value of <code>main</code> requires computing the final state of the world, which depends on all previous <code>IO</code> operations.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 13, "last_activity_date": 1495551798, "creation_date": 1495551798, "answer_id": 44138500, "question_id": 44128288, "link": "https://stackoverflow.com/questions/44128288/io-vs-referential-transparency/44138500#44138500", "title": "IO vs referential transparency", "body": "<p>You need to distinguish between <em>evaluation</em> and <em>execution</em>.</p>\n\n<p>If you <em>evaluate</em> 2 + 7, the result is 9. If you replace one expression that evaluates to 9 with another, different expression that also evaluates to 9, then the meaning of the program has not changed. This is what referential transparency guarantees. We could common up several shared expressions that reduce to 9, or duplicate a shared expression into multiple copies, and the meaning of the program does not change. (Performance might, but not the end result.)</p>\n\n<p>If you <em>evaluate</em> <code>readLn</code>, it evaluates to an I/O command object. You can imagine it as being a data structure that describes what I/O operation(s) you want performed. But the object itself is just data. If you evaluate <code>readLn</code> twice, it returns the same I/O command object twice. You can merge several copies into one; you can split one copy into several. It doesn't change the meaning of the program.</p>\n\n<p>Now if you want to <em>execute</em> the I/O action, that's a different thing. Clearly, I/O operations need to be executed in exactly the way the program specifies, without being randomly duplicated or rearranged. But that's OK, because it's not the Haskell expression evaluation engine that does that. You can pretend that the Haskell runtime runs <code>main</code>, which builds a giant I/O command object representing the entire program. The Haskell runtime then reads this data structure and executes the I/O operations it requests, in the order specified. (Not actually how it works, but a useful mental model.)</p>\n\n<p>Ordinarily you don't need to bother thinking about this strict separation between <em>evaluating</em> <code>readLn</code> to get an I/O command object and then <em>executing</em> the resulting I/O command object to get a result. But strictly that's notionally what it does.</p>\n\n<p>(You may also have heard that I/O \"forms a monad\". That's merely a fancy way of saying that there's a particular set of operators for changing I/O command objects together into bigger I/O command objects. It's not central to understanding the separation between evaluate and execute.)</p>\n"}], "owner": {"reputation": 5628, "user_id": 342293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3127caeaad3e4eb8d20e2589356567c8?s=128&d=identicon&r=PG", "display_name": "Ron", "link": "https://stackoverflow.com/users/342293/ron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 867, "favorite_count": 1, "accepted_answer_id": 44129331, "answer_count": 4, "score": 2, "last_activity_date": 1495589899, "creation_date": 1495524261, "question_id": 44128288, "link": "https://stackoverflow.com/questions/44128288/io-vs-referential-transparency", "title": "IO vs referential transparency", "body": "<p>Sorry newb question here, but how does Haskell know not to apply referential transparency to e.g. <code>readLn</code> or when <code>putStrLn</code>-ing a same string twice? Is it because <code>IO</code> is involved? IOW, will not the compiler apply referential transparency to functions returning <code>IO</code>?</p>\n"}, {"tags": ["haskell", "category-theory"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 7, "creation_date": 1495512618, "post_id": 44125484, "comment_id": 75270088, "body": "&quot;[However], for any concrete type <code>T</code>, one can make <code>((,) T)</code> an applicative&quot; -- not really. You still need <code>T</code> to be a monoid, and not just because of <code>pure</code>: you also need to implement <code>(&lt;*&gt;)</code> in a way that the two methods follow the applicative laws."}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1495512934, "post_id": 44125484, "comment_id": 75270165, "body": "So all that is needed to answer this question is to find a non-monoid <code>T</code> and then <code>((,) T)</code> will be a concrete functor that fails to be an applicative?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1495515387, "post_id": 44125484, "comment_id": 75270905, "body": "Yup, that is enough."}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1495516538, "post_id": 44125484, "comment_id": 75271292, "body": "There&#39;s a theorem in mathematics that any collection with at least 2 elements can be made into a monoid.  So for any concrete type <code>T</code>, it could in principle be made a member of <code>Monoid</code>, and then could in principle be made <code>Applicative</code>.  What&#39;s wrong with this reasoning?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1495518515, "post_id": 44125484, "comment_id": 75272107, "body": "Is <code>Dead</code> from <a href=\"https://stackoverflow.com/a/7220865/3072788\">this answer</a> what you are looking for? There are no additional type variables..."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1495524772, "post_id": 44125484, "comment_id": 75275492, "body": "This answer is along the lines you&#39;ve started thinking: <a href=\"https://stackoverflow.com/a/36440023/414413\">stackoverflow.com/a/36440023/414413</a>"}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1523391262, "post_id": 44125484, "comment_id": 86539728, "body": "A simple example of a functor that is not applicative is (a -&gt; Int) -&gt; Maybe a. The type required for &lt;*&gt; has no implementation that satisfies the identity laws."}, {"owner": {"reputation": 3875, "user_id": 777775, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/53770527d89baf4424ddc7cbe05707ea?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/777775/tom"}, "reply_to_user": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1547649467, "post_id": 44125484, "comment_id": 95264447, "body": "@winitzki: how is <code>(a -&gt; Int) -&gt; Maybe a</code> a <code>Functor</code> (i.e. how do you define <code>fmap</code>)?"}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "reply_to_user": {"reputation": 3875, "user_id": 777775, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/53770527d89baf4424ddc7cbe05707ea?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/777775/tom"}, "edited": false, "score": 0, "creation_date": 1547690023, "post_id": 44125484, "comment_id": 95281629, "body": "@Tom <code>deriving Functor</code> should do that automatically. This type constructor uses <code>a</code> in covariant positions, so it&#39;s clearly a functor. A functor instance can be constructed mechanically. If you see how <code>(a -&gt; Int) -&gt; Int</code> and <code>z -&gt; Maybe a</code> implement their <code>fmap</code>s, you can then easily see what to do here."}, {"owner": {"reputation": 3875, "user_id": 777775, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/53770527d89baf4424ddc7cbe05707ea?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/777775/tom"}, "reply_to_user": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1547793101, "post_id": 44125484, "comment_id": 95321608, "body": "@winitzki: But of course, thanks! For those interested, the idea is that given a function <code>f :: a -&gt; b</code> and a function <code>b -&gt; Int</code> they can be composed to give a function <code>a -&gt; Int</code>. Given <code>x :: (a -&gt; Int) -&gt; Maybe a</code> one can apply it on the result and get a <code>Maybe a</code>, which can then be mapped using <code>Maybe</code>&#39;s <code>fmap</code> to a <code>Maybe b</code>, that is <code>fmap f x = \\g -&gt; fmap f (x (g . f))</code>."}, {"owner": {"reputation": 3875, "user_id": 777775, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/53770527d89baf4424ddc7cbe05707ea?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/777775/tom"}, "reply_to_user": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1547794055, "post_id": 44125484, "comment_id": 95321954, "body": "@winitzki: now the question is how it can be proven that no <code>&lt;*&gt;</code> implementation for the type could possibly satisfy the laws."}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "reply_to_user": {"reputation": 3875, "user_id": 777775, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/53770527d89baf4424ddc7cbe05707ea?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/777775/tom"}, "edited": false, "score": 1, "creation_date": 1547851383, "post_id": 44125484, "comment_id": 95348847, "body": "@Tom First, you derive an implementation from the type. It is simpler to consider <code>zip : F a -&gt; F b -&gt; F (a,b)</code> rather than <code>&lt;*&gt;</code>. Now, we need to implement <code>zip : ((a -&gt; Z) -&gt; Maybe a)) -&gt; ((b -&gt; Z) -&gt; Maybe b) -&gt; ((a, b) -&gt; Z) -&gt; Maybe (a, b)</code>. But a function with this type signature can only return <code>Nothing</code>, because there is no way of ever computing a pair <code>(a, b)</code> (we cannot have a value of type <code>a -&gt; Z</code> or <code>b -&gt; Z</code>, we only have <code>(a, b) -&gt; Z</code>). So this is the only implementation. However, a <code>zip</code> method that always returns <code>Nothing</code> will violate identity laws for applicative functors."}, {"owner": {"reputation": 3875, "user_id": 777775, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/53770527d89baf4424ddc7cbe05707ea?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/777775/tom"}, "reply_to_user": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1547906714, "post_id": 44125484, "comment_id": 95358747, "body": "Thanks for the explanation, @winitzki!"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 5370972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9760572b69f7d2052e560f88c02d8b99?s=128&d=identicon&r=PG&f=1", "display_name": "rbasso", "link": "https://stackoverflow.com/users/5370972/rbasso"}, "is_accepted": false, "score": 5, "last_activity_date": 1495520927, "last_edit_date": 1495520927, "creation_date": 1495520458, "answer_id": 44127177, "question_id": 44125484, "link": "https://stackoverflow.com/questions/44125484/concrete-type-example-of-a-functor-that-fails-to-be-an-applicative/44127177#44127177", "title": "Concrete Type Example of a Functor that Fails to be an Applicative?", "body": "<p>I don't have 50 reputation to comment here, so I'll try to do it as an answer:</p>\n\n<blockquote>\n  <p>however, for any concrete type T, one can make ((,) T) an applicative.</p>\n</blockquote>\n\n<p>...</p>\n\n<blockquote>\n  <p>There's a theorem in mathematics that any collection with at least 2 elements can be made into a monoid. So for any concrete type T, it could in principle be made a member of Monoid, and then could in principle be made Applicative. What's wrong with this reasoning?</p>\n</blockquote>\n\n<p>What about the tuple from the uninhabited type? <code>(,) Void</code></p>\n\n<p>It is a <code>Functor</code>,right?</p>\n\n<p>Could you derive <code>Applicative</code> for it? How would <code>pure</code> be implemented?</p>\n"}, {"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1495631066, "post_id": 44128799, "comment_id": 75334740, "body": "<a href=\"http://conal.net/papers/push-pull-frp/push-pull-frp.pdf\" rel=\"nofollow noreferrer\"><i>Push-Pull FRP</i></a> gives a <code>Monad</code> instance for <code>Event</code> which implements dynamic event switching. The corresponding <code>Applicative</code> instance takes the Cartesian product of the two events."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 3, "last_activity_date": 1495525672, "creation_date": 1495525672, "answer_id": 44128799, "question_id": 44125484, "link": "https://stackoverflow.com/questions/44125484/concrete-type-example-of-a-functor-that-fails-to-be-an-applicative/44128799#44128799", "title": "Concrete Type Example of a Functor that Fails to be an Applicative?", "body": "<p>There is nice example in <a href=\"https://hackage.haskell.org/package/reactive-banana\" rel=\"nofollow noreferrer\">reactive-banana library</a>.</p>\n\n<p>It features <code>Event a</code> types, which represents a single simultaneous event in time (think, an impulse), and <code>Behavior a</code> type, which represents a value that is available in any moment (for instance, emitting a value from the last event).</p>\n\n<p>Behavior is an Applicative, because you <strong>can combine</strong> two of them - they have a value in any point of time.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jdvT1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jdvT1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Event, though, is a Functor only, because  you <strong>can't combine</strong> them. Given two <code>Event</code>s you can't be sure they will happen simultaneosly.</p>\n\n<p><a href=\"https://i.stack.imgur.com/d43tx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d43tx.png\" alt=\"Event\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 0, "last_activity_date": 1495554180, "last_edit_date": 1592644375, "creation_date": 1495554180, "answer_id": 44139427, "question_id": 44125484, "link": "https://stackoverflow.com/questions/44125484/concrete-type-example-of-a-functor-that-fails-to-be-an-applicative/44139427#44139427", "title": "Concrete Type Example of a Functor that Fails to be an Applicative?", "body": "<blockquote>\n<blockquote>\n<p>&quot;[However], for any concrete type <code>T</code>, one can make <code>((,) T)</code> an applicative&quot; -- not really. You still need <code>T</code> to be a monoid, and not just because of pure: you also need to implement <code>(&lt;*&gt;)</code> in a way that the two methods follow the applicative laws.</p>\n</blockquote>\n<p>[...]</p>\n<p>There's a theorem in mathematics that any collection with at least 2 elements can be made into a monoid. So for any concrete type <code>T</code>, it could in principle be made a member of <code>Monoid</code>, and then could in principle be made <code>Applicative</code>. What's wrong with this reasoning?</p>\n</blockquote>\n<p>The &quot;in principle&quot; doesn't necessarily translate into code. Consider:</p>\n<pre><code>newtype UserID = UserID Integer\n</code></pre>\n<p>As far as I can see, there is no meaningful <code>Monoid</code> instance for <code>UserID</code>. In principle, one might use <code>0</code> and <code>(+)</code> on the underlying <code>Integer</code>, but that would amount to leaking an implementation detail for no good reason (and which is likely end up being hidden by making the type abstract). That being so, <code>(,) UserID</code> would be a perfectly good example of a <code>Functor</code> which is not an <code>Applicative</code>.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "closed_date": 1495638805, "answer_count": 3, "score": 8, "last_activity_date": 1495554180, "creation_date": 1495511369, "last_edit_date": 1495540989, "question_id": 44125484, "link": "https://stackoverflow.com/questions/44125484/concrete-type-example-of-a-functor-that-fails-to-be-an-applicative", "closed_reason": "Duplicate", "title": "Concrete Type Example of a Functor that Fails to be an Applicative?", "body": "<p>From <a href=\"https://stackoverflow.com/questions/7220436/good-examples-of-not-a-functor-functor-applicative-monad\">functors that are not applicatives</a>:</p>\n\n<blockquote>\n  <p><strong>A type constructor which is a Functor but not an Applicative.</strong> A simple example is a pair:</p>\n\n<pre><code>instance Functor ((,) r) where\n    fmap f (x,y) = (x, f y)\n</code></pre>\n  \n  <p>But there is no way how to define its <code>Applicative</code> instance without imposing additional restrictions on <code>r</code>. In particular, there is no way how to define <code>pure :: a -&gt; (r, a)</code> for an arbitrary <code>r</code>.</p>\n</blockquote>\n\n<p>Here, <code>pure</code> fails to be definable for <em>all types at once</em>; however, for any <strong>concrete</strong> type <code>T</code>, one can make <code>((,) T)</code> an applicative.</p>\n\n<p><strong>Question:</strong> Is there an example of a concrete functor (i.e., no type variables involved) that is a functor but not an applicative?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 6, "last_activity_date": 1495498562, "last_edit_date": 1495498562, "creation_date": 1495498081, "answer_id": 44123834, "question_id": 44123811, "link": "https://stackoverflow.com/questions/44123811/haskell-parsing-error-on-symbol-with-winghci/44123834#44123834", "title": "Haskell parsing error on \u2018|\u2019 symbol with WinGHCi", "body": "<p>Instead of this (#1):</p>\n\n<pre><code>case arg of\n  | Leaf x = x\n  | Node tLeft x tRight = x\n</code></pre>\n\n<p>You want this (#2):</p>\n\n<pre><code>case arg of\n  Leaf x -&gt; x\n  Node tLeft x tRight -&gt; x\n</code></pre>\n\n<p>The style of #1 is used in other ML-family languages, e.g., OCaml:</p>\n\n<pre><code>match arg with\n  | Leaf x -&gt; x\n  | Node (tLeft, x, tRight) -&gt; x\n</code></pre>\n\n<p>But Haskell uses the \u201clayout rule\u201d to desugar #2 into the following:</p>\n\n<pre><code>case arg of {\n  Leaf x -&gt; x;\n  Node tLeft x tRight -&gt; x;\n}\n</code></pre>\n\n<p>(And in fact you can write that explicitly if you prefer.)</p>\n\n<p>Note also that you use <code>-&gt;</code> with <code>case</code> expressions and <code>=</code> with definitions:</p>\n\n<pre><code>foo arg =\n  case arg of\n    Leaf x -&gt; x\n    Node tLeft x tRight -&gt; x\n\nfoo' (Leaf x) = x\nfoo' (Node tLeft x tRight) = x\n</code></pre>\n\n<p>This is true even if there\u2019s a guard expression on a pattern\u2014which is what the vertical bar (<code>|</code>) is actually used for:</p>\n\n<pre><code>foo arg =\n  case arg of\n    Leaf x\n      | x &lt; 0 -&gt; 0\n      | otherwise -&gt; x\n    Node tLeft x tRight\n      | x &lt; 0 -&gt; 0\n      | otherwise -&gt; x\n\nfoo' (Leaf x)\n  | x &lt; 0 = 0\n  | otherwise = x\nfoo' (Node tLeft x tRight)\n  | x &lt; 0 = 0\n  | otherwise = x\n</code></pre>\n"}], "owner": {"reputation": 372, "user_id": 1227197, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/391ebd18a7aa6add5f836d5281b3def3?s=128&d=identicon&r=PG", "display_name": "Maude", "link": "https://stackoverflow.com/users/1227197/maude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 44123834, "answer_count": 1, "score": 2, "last_activity_date": 1495500947, "creation_date": 1495497859, "last_edit_date": 1495500947, "question_id": 44123811, "link": "https://stackoverflow.com/questions/44123811/haskell-parsing-error-on-symbol-with-winghci", "title": "Haskell parsing error on \u2018|\u2019 symbol with WinGHCi", "body": "<p>I am new to Haskell and getting this infamous error.</p>\n\n<p>I have already consulted these links :\n<a href=\"https://stackoverflow.com/questions/39309616/haskell-parse-error-on-input\">Haskell: parse error on input `|&#39;</a> <a href=\"https://stackoverflow.com/questions/26057438/haskell-parse-error-on-input\">Haskell parse error on input &#39;|&#39;</a> <a href=\"https://stackoverflow.com/questions/15712506/haskell-parse-error-on-input\">Haskell - parse error on input `|&#39;</a> <a href=\"https://stackoverflow.com/questions/24918779/why-complains-haskell-parse-error-on-input-in-this-function\">Why complains Haskell parse error on input `|&#39; in this Function?</a> <a href=\"https://stackoverflow.com/questions/20381874/haskell-parse-error-on-input\">Haskell parse error on input `|&#39;</a></p>\n\n<p>What really surprises me is that I copied <strong>exactly</strong> the code that my university teacher gave us in class:</p>\n\n<pre><code>data TreeInt = Leaf Int\n             | Node TreeInt Int TreeInt\nfoo :: TreeInt -&gt; Int\nfoo arg =\n case arg of\n  | Leaf x = x\n  | Node tLeft x tRight = x\n</code></pre>\n\n<p>I know the problem is below foo arg because the following code compiles :</p>\n\n<pre><code>data TreeInt = Leaf Int \n             | Node TreeInt Int TreeInt\nfoo :: TreeInt -&gt; Int\nfoo arg = undefined\n</code></pre>\n\n<p>The exact error is : <code>hw.hs:6:4: error: parse error on input \u2018|\u2019</code>\nwhich makes me believe it is on the 6th line (| Leaf).</p>\n\n<p>What I've tried :</p>\n\n<ul>\n<li>Transform the code using pattern match (got another error)</li>\n<li>Put the case on the same line as foo arg</li>\n<li>Add more/less spaces</li>\n<li>Adding \"let\" since some versions of GHC have issues without it (no change)</li>\n</ul>\n"}, {"tags": ["haskell", "ghc", "ghci"], "answers": [{"tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": false, "score": 0, "last_activity_date": 1495498630, "creation_date": 1495498630, "answer_id": 44123890, "question_id": 44123666, "link": "https://stackoverflow.com/questions/44123666/why-do-ghc-and-ghci-differ-on-type-inference/44123890#44123890", "title": "Why do GHC and GHCI differ on type inference?", "body": "<p><code>NoMonomorphismRestriction</code> is a useful default in GHCI because you don't have to write out so many pesky type signatures in the repl. GHCI will try to infer the most general types it can.</p>\n\n<p><code>MonomorphismRestriction</code> is a useful default otherwise for efficiency / performance reasons. Specifically, the issue boils down to the fact that: </p>\n\n<blockquote>\n  <p>typeclasses essentially introduce additional function parameters -- specifically, the dictionary of code implementing the instances in question. In the case of typeclass polymorphic pattern bindings, you end up turning something that looked like a pattern binding -- a constant that would only ever be evaluated once, into what is really a function binding, something which will not be memoised.</p>\n</blockquote>\n\n<p><a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">Link</a></p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": true, "score": 6, "last_activity_date": 1495501636, "creation_date": 1495501636, "answer_id": 44124245, "question_id": 44123666, "link": "https://stackoverflow.com/questions/44123666/why-do-ghc-and-ghci-differ-on-type-inference/44124245#44124245", "title": "Why do GHC and GHCI differ on type inference?", "body": "<p>The background of why the committee made this decision is given, in the designers\u2019 own words, in the article \u201c<a href=\"http://haskell.cs.yale.edu/wp-content/uploads/2011/02/history.pdf\" rel=\"noreferrer\">A History of Haskell: Being Lazy with Class</a>\u201d by Paul Hudak <em>et al.</em></p>\n\n<blockquote>\n  <p>A major source of controversy in the early stages was the so-called\n  \u201cmonomorphism  restriction.\u201d  Suppose  that <code>genericLength</code> has this\n  overloaded type:</p>\n\n<pre><code>genericLength :: Num a =&gt; [b] -&gt; a\n</code></pre>\n  \n  <p>Now consider this definition:</p>\n\n<pre><code>f xs = (len, len)`\n  where\n    len = genericLength xs\n</code></pre>\n  \n  <p>It  looks  as  if <code>len</code> should  be  computed  only  once,  but  it  can\n  actually  be  computed twice.  Why?  Because  we  can  infer  the  type\n  <code>len :: (Num a) =&gt; a;</code>  when  desugared  with  the  dictionary-passing\n  translation, <code>len</code> becomes  a function that  is  called  once for each\n  occurrence of <code>len</code>, each of which might used at a different type.</p>\n  \n  <p>[John] Hughes argued strongly that it was unacceptable to silently\n  duplicate  computation  in  this  way.  His  argument  was  motivated  by\n  a program he had written that ran exponentially slower than he expected.\n  (This was admittedly with a very simple compiler, but we were reluctant to\n  make performance differences as big as this dependent on compiler\n  optimisations.)</p>\n  \n  <p>Following much debate, the committee adopted the now-notorious \n  monomorphism restriction. Stated briefly, it says that a definition\n  that  does  not  look  like  a  function  (i.e.  has  no  arguments  on\n  the left-hand  side)  should  be  monomorphic  in  any  overloaded\n  type variables.  In  this  example,  the  rule  forces <code>len</code> to  be  used\n  at  the same type at both its occurrences,  which solves the performance\n  problem. The programmer can supply an explicit type signature for <code>len</code> if\n  polymorphic behaviour is required.</p>\n  \n  <p><strong>The  monomorphism  restriction  is manifestly  a  wart  on  the  language. \n  It seems to bite every new Haskell programmer by giving rise  to  an\n  unexpected  or  obscure  error  message.</strong>  There  has  been much\n  discussion  of  alternatives.</p>\n</blockquote>\n\n<p>(18, Emphasis added.)  Note that John Hughes is a co-author of the article.</p>\n"}, {"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1495558888, "post_id": 44125877, "comment_id": 75300032, "body": "Excellent answer!  One extra note.  As you know, the way to turn the monomorphism restriction off in a source file, if someone reading this wants to, is <code>{-# LANGUAGE NoMonomorphismRestriction #-}</code>."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 3, "last_activity_date": 1495514118, "creation_date": 1495514118, "answer_id": 44125877, "question_id": 44123666, "link": "https://stackoverflow.com/questions/44123666/why-do-ghc-and-ghci-differ-on-type-inference/44125877#44125877", "title": "Why do GHC and GHCI differ on type inference?", "body": "<p>I can't replicate your result that GHCi infers the type <code>(Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool</code> even with <code>-XMonomorphismRestriction</code> (GHC 8.0.2).</p>\n\n<p>What I see is that when I enter the line <code>(!) = elem</code> it infers the type <code>(!) :: () -&gt; [()] -&gt; Bool</code>, which is actually a perfect illustration of why you would want GHCi to behave \"differently\" from GHC, given that GHC is using the monomorphism restriction.</p>\n\n<p>The problem described in @Davislor's answer that the monomorphism restriction was intended to address is that you could write code that syntactically looks like it's computing a value once, binding it to a name, and then using it several times, where actually the thing bound to a name is a reference to a closure awaiting a type class dictionary before it can really compute the value. All the use sites would separately work out what dictionary they need to pass and compute the value again, even if all the use sites actually pick the same dictionary (exactly as if you write a function of a number and then invoke it from several different places with the same parameter, you'd get the same result computed multiple times). But if the user was <em>thinking</em> of that binding as a simple value then this would be unexpected, and it's extremely likely that all the use-sites will want a single dictionary (because the user expected a reference to a single value computed from a single dictionary).</p>\n\n<p>The monomorphism restriction forces GHC not to <em>infer</em> types that still need a dictionary (for bindings that have no <strong>syntactic</strong> parameters). So now the dictionary is chosen once at the binding site, instead of separately at each use of the binding, and the value really is only computed once. But that only works if the dictionary chosen at the binding site is the <em>correct</em> one that all the use sites would have chosen. If GHC picked the wrong one at the binding site, then all the use-sites would be type errors, even if they all agree on what type (and thus dictionary) they were expecting.</p>\n\n<p>GHC compiles entire modules at once. So it can see the use sites and the binding site <strong>at the same time</strong>. Thus if any use of the binding requires a specific concrete type, the binding will use that type's dictionary, and everything will be well so long as all of the other use sites are compatible with that type (even if they were actually polymorphic and would also have worked with other types). This works even if the code that pins down the correct type is widely separated from the binding by many other calls; all the constraints on the types of things are effectively connected by unification during the type checking/inference phase, so when the compiler is choosing a type at the binding site it can \"see\" the requirements from all of the use-sites (within the same module).</p>\n\n<p>But if the use sites are not all consistent with a single concrete type, then you get a type error, as in your example. One use-site of <code>(!)</code> requires the <code>a</code> type variable to be instantiated as <code>Char</code>, the other requires a type that also has a <code>Num</code> instance (which <code>Char</code> doesn't).</p>\n\n<p>This wasn't consistent with our hopeful assumption that all the use-sites would want a single dictionary, and so the monomorphism restriction has resulted in an error that could have been avoided by inferring a more general type for <code>(!)</code>. It's certainly debatable that the monomorphism restriction prevents more problems than it solves, but given that it <strong>is</strong> there, surely we'd want GHCi to behave the same way, right?</p>\n\n<p>However GHCi is an interpreter. You enter code one statement at a time, not one module at a time. So when you type <code>(!) = elem</code> and hit enter, GHCi has to understand that statement and produce a value to bind to <code>(!)</code> with some specific type <em>right now</em> (it can be an unevaluated thunk, but we have to know what its type is). With the monomorphism restriction we can't infer <code>(Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool</code>, we have to pick a type for those type variables <strong>now</strong>, with no information from use-sites to help us pick something sensible. The extended default rules that are on in GHCi (another difference from GHC) default those to <code>[]</code> and <code>()</code>, so you get <code>(!) :: () -&gt; [()] -&gt; Bool</code><sup>1</sup>. Pretty useless, and you get a type error trying <em>either</em> of the uses from your example.</p>\n\n<p>The problem that the monomorphism restriction addresses is particularly egregious in the case of numeric calculations when you're not writing explicit type signatures. Since Haskell's numeric literals are overloaded you could easily write an entire complex calculation, complete with starting data, whose most general type is polymorphic with a <code>Num</code> or <code>Floating</code> or etc constraint. Most of the builtin numeric types are very small, so you're very likely to have values that you'd <em>much</em> rather store than compute multiple times. The scenario is more likely to happen, and more likely to be a problem.</p>\n\n<p>But it's also exactly with numeric types that the whole-module type-inference process is <strong>essential</strong> to defaulting type variables to a concrete type in a way that is at all usable (and small examples with numbers are exactly what people new to Haskell are likely to be trying out in the interpreter). Before the monomorphism restriction was off by default in GHCi, there was a constant stream of Haskell question here on Stack Overflow from people confused why they couldn't divide numbers in GHCi that they could in compiled code, or something similar (basically the reverse of your question here). In compiled code you can mostly just write code the way you want with no explicit types and the full-module type inference figures out whether it should default your integer literals to <code>Integer</code>, or <code>Int</code> if they need to be added to something returned by <code>length</code>, or <code>Double</code> if they need to be added to something and multiplied by something else which is elsewhere divided by something, etc etc. In GHCi a simple <code>x = 2</code> very often does the wrong under the monomorphism restriction turned on (because it'll pick <code>Integer</code> regardless of what you wanted to do with <code>x</code> later), with the result that you need to add far more type annotations in a quick-and-easy interactive interpreter than even the most ardent explicit-typist would use in production compiled code.</p>\n\n<p>So it's certainly debateable whether GHC should use the monomorphism restriction or not; it's intended to address a real problem, it just also causes some other ones<sup>2</sup>. But the monomorphism restriction is a <strong>terrible</strong> idea for the interpreter. The fundamental difference between line-at-a-time and module-at-a-time type inference means that even when they both did default to using it they behaved quite differently in practice anyway. GHCi without the monomorphism restriction is at least significantly more usable.</p>\n\n<hr>\n\n<p><sup>1</sup> Without the extended default rules you instead get an error about an ambiguous type variable, because it doesn't have <em>anything</em> to pin down a choice, not even the somewhat silly defaulting rules.</p>\n\n<p><sup>2</sup> I find it only a mild irritation in actual development because I write type signatures for top-level bindings. I find that's enough to make the monomorphism restriction apply only rarely, so it doesn't help or hinder me much. Thus I'd probably rather it was scrapped so that everything works consistently, especially as it seems to bite learners far more often than it bites me as a practitioner. On the other hand, debugging a rare performance problem on the occasion that it matters is <em>much</em> harder than rarely having to add a correct type signature that GHC annoyingly won't infer.</p>\n"}], "owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 696, "favorite_count": 1, "accepted_answer_id": 44124245, "answer_count": 3, "score": 3, "last_activity_date": 1495514118, "creation_date": 1495496751, "question_id": 44123666, "link": "https://stackoverflow.com/questions/44123666/why-do-ghc-and-ghci-differ-on-type-inference", "title": "Why do GHC and GHCI differ on type inference?", "body": "<p>I noticed, when doing a <a href=\"https://codegolf.stackexchange.com/q/120276/69259\">codegolf challenge</a>, that by default, GHC doesn't infer the most general type for variables, leading to type errors when you try to use it with two different types.</p>\n\n<p>For example:</p>\n\n<pre><code>(!) = elem\nx = 'l' ! \"hello\" -- From its use here, GHC assumes (!) :: Char -&gt; [Char] -&gt; Bool\ny = 5 ! [3..8] -- Fails because GHC expects these numbers to be of type Char, too\n</code></pre>\n\n<p>This can be changed using the pragma <code>NoMonomorphismRestriction</code>.</p>\n\n<p>However, typing this into GHCI produces no type error, and <code>:t (!)</code> reveals that here, it assumes <code>(Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool</code>, even when explicitly run with <code>-XMonomorphismRestriction</code>.</p>\n\n<p>Why do GHC and GHCI differ on assuming the most general type for functions?</p>\n\n<p>(Also, why have it enabled by default anyway? What does it help?)</p>\n"}, {"tags": ["haskell", "if-statement", "where-clause"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 4, "creation_date": 1495477818, "post_id": 44119762, "comment_id": 75258737, "body": "It seems like you want <code>||</code> not <code>|</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1495478884, "post_id": 44119762, "comment_id": 75259372, "body": "<code>|</code> is a <i>guard</i>."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495481916, "post_id": 44119762, "comment_id": 75260994, "body": "In C (and some of its descendants), comparisons return the integer values 1 and 0, so you can get away with using the bitwise <code>|</code> operator in place of the logical <code>||</code> operator. This is a holdover from the languages BCPL and B, which had no logical operators. In Haskell, <code>|</code> has no such meaning. It appears in the syntax of guards and list comprehensions. The compiler therefore tries to parse that line as a pattern guard, and cannot."}], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1495479016, "post_id": 44119870, "comment_id": 75259433, "body": "Perhaps it is worth pointing out what <code>|</code> and <code>||</code> mean (the difference between them)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1495495400, "post_id": 44119870, "comment_id": 75266139, "body": "And, because I can&#39;t help suggesting a slightly different shade for the shed, you can apply DeMorgan&#39;s laws to get <code>check2 c1 c2 = (getTime c1 &#47;= getTime c2) &amp;&amp; (getSubject c1 &#47;= getSubject c2)</code>."}], "tags": [], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "is_accepted": true, "score": 7, "last_activity_date": 1495479551, "last_edit_date": 1495479551, "creation_date": 1495478146, "answer_id": 44119870, "question_id": 44119762, "link": "https://stackoverflow.com/questions/44119762/parse-error-on-input/44119870#44119870", "title": "Parse error on Input &#39;|&#39;", "body": "<p>You should use <code>||</code> (the binary logical or operator, same as Java) instead of <code>|</code>.</p>\n\n<p>You can write your function more directly this way:</p>\n\n<pre><code>check2 :: Slot -&gt; Slot -&gt; Bool\ncheck2 c1 c2 = not ((getTime c1 == getTime c2) || (getSubject c1 == getSubject c2))\n</code></pre>\n\n<p>The <code>|</code> are used to define function with conditionals. For example, your own function can also be defined as:</p>\n\n<pre><code>check2 :: Slot -&gt; Slot -&gt; Bool\ncheck2 c1 c2 | (getTime c1 == getTime c2) || (getSubject c1 == getSubject c2) = False\n             | otherwise                                                      = True\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8049679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf0b6190e7bb47961ac2b9e7f65336?s=128&d=identicon&r=PG&f=1", "display_name": "Shanksum", "link": "https://stackoverflow.com/users/8049679/shanksum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 44119870, "answer_count": 1, "score": 1, "last_activity_date": 1495479551, "creation_date": 1495477755, "last_edit_date": 1495478193, "question_id": 44119762, "link": "https://stackoverflow.com/questions/44119762/parse-error-on-input", "title": "Parse error on Input &#39;|&#39;", "body": "<p>I looked into every single thread about this error message and tried everything, but it keeps disrupting the compiler. \nMy Code:</p>\n\n<pre><code>check2 :: Slot -&gt; Slot -&gt; Bool\ncheck2 c1 c2 = if (getTime c1 == getTime c2) | (getSubject c1 == getSubject c2)\n                then False\n                else True\n</code></pre>\n\n<p>It throws a nice <code>error: parse error on input \u2018|\u2019</code></p>\n\n<p>Clarification: all tabs are 8-spaces\nAs you may guess, the method is part of a more larger method and was in a <code>where</code> clause originally. If I put it in the <code>where</code> clause, the parse error is on a different place, which is highly frustrating.</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1495474421, "post_id": 44118862, "comment_id": 75256971, "body": "Well what is <code>slotListToSlot</code> supposed to do?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1495474458, "post_id": 44118862, "comment_id": 75256992, "body": "Wait, so is this the actual code in your file, with <code>???</code> literally appearing?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1495474509, "post_id": 44118862, "comment_id": 75257023, "body": "@luqui: based on the text, I would say there is no such line in the file. The OP only mentions that to denote the actual problem."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495474872, "post_id": 44118862, "comment_id": 75257222, "body": "You can use <code>undefined</code> as a temporary placeholder for a pattern that you mean to fill in later, such as, <code>slotListToSlot [] = undefined</code>. Be careful: the compiler won\u2019t alert you that you left a pattern undefined!"}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1495478846, "post_id": 44118862, "comment_id": 75259346, "body": "All the answers presumes that the OP want the first item in the list. Can the OP confirm that is the intended behavior of the <code>slotListToSlot</code> function?"}], "answers": [{"comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1495485272, "post_id": 44118926, "comment_id": 75262643, "body": "Don&#39;t forget to accept any anwer!"}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 5, "last_activity_date": 1495474518, "creation_date": 1495474518, "answer_id": 44118926, "question_id": 44118862, "link": "https://stackoverflow.com/questions/44118862/non-exhaustive-patterns-in-haskell/44118926#44118926", "title": "Non exhaustive patterns in Haskell", "body": "<p>if you don't want anything in your code but error for empty list, you could do</p>\n\n<pre><code> slotListToSlot :: [Slot] -&gt; Slot\n slotListToSlot [] = error \"no slot for empty list\"\n slotListToSlot (x:xs) = x\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 2, "creation_date": 1495475123, "post_id": 44119008, "comment_id": 75257346, "body": "Here is an example of a perfect answer, is very nice to read experts :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1495477368, "last_edit_date": 1495477368, "creation_date": 1495474930, "answer_id": 44119008, "question_id": 44118862, "link": "https://stackoverflow.com/questions/44118862/non-exhaustive-patterns-in-haskell/44119008#44119008", "title": "Non exhaustive patterns in Haskell", "body": "<p>Based on your question, it looks like you want to return the <em>first</em> element of the list.</p>\n\n<p>There is actually no need to implement such function on your own, since there is already a generic function: <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:head\" rel=\"nofollow noreferrer\"><code>head :: [a] -&gt; a</code></a>.</p>\n\n<blockquote>\n  <p><strong>Extract the first element</strong> of a list, which must be <strong>non-empty</strong>.</p>\n</blockquote>\n\n<p>Now of course you cannot return the <em>head</em> of an empty list. In that case the function will error:</p>\n\n<pre><code>Prelude&gt; head []\n*** Exception: Prelude.head: empty list\nPrelude Data.Maybe&gt; head [1]\n1\nPrelude Data.Maybe&gt; head [1,4]\n1\n</code></pre>\n\n<p>Usually in case there are \"exceptional circumstances\", it is better to use <code>Maybe</code>. For instance you can use: <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#v:listToMaybe\" rel=\"nofollow noreferrer\"><code>listToMaybe :: [a] -&gt; Maybe a</code></a>.</p>\n\n<blockquote>\n  <p>The <code>listToMaybe</code> function returns <strong><code>Nothing</code> on an empty list</strong> or <code>Just a</code> where <code>a</code> is the <strong>first element</strong> of the list.</p>\n</blockquote>\n\n<p>This function will thus return the head of the list (wrapped in a <code>Just</code>) in case the list contains at least one element, and otherwise <code>Nothing</code>. For instance:</p>\n\n<pre><code>Prelude&gt; :m Data.Maybe\nPrelude Data.Maybe&gt; listToMaybe []\nNothing\nPrelude Data.Maybe&gt; listToMaybe [1]\nJust 1\nPrelude Data.Maybe&gt; listToMaybe [1,4]\nJust 1\n</code></pre>\n\n<p>Now the type (<code>Maybe a</code>) contains information that there are two scenarios, and calling functions can then handle those (separately).</p>\n"}, {"comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 2, "creation_date": 1495475907, "post_id": 44119056, "comment_id": 75257777, "body": "Every case is explained! Just pick one, very very good, thanks for sharing :)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1495478555, "post_id": 44119056, "comment_id": 75259144, "body": "There is another option: don&#39;t write <code>slotListToSlot</code> at all, and simply use <code>case</code> in the places where you planned on calling it before. (You&#39;re <i>probably</i> going to find yourself doing that anyway with the suggested first option.)"}, {"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1495479223, "post_id": 44119056, "comment_id": 75259540, "body": "@DanielWagner it depends on how often <code>slotListToSlot</code> is currently used in the code. However, with a definition like <code>slotListToSlot = listToMaybe</code>, you could just use <code>listToMaybe</code> directly, indeed."}, {"owner": {"reputation": 55, "user_id": 8046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c67d44ba4bb1ea25f7a7707f31e3dec?s=128&d=identicon&r=PG&f=1", "display_name": "itonva", "link": "https://stackoverflow.com/users/8046509/itonva"}, "edited": false, "score": 0, "creation_date": 1495484040, "post_id": 44119056, "comment_id": 75262076, "body": "Wow thanks ! Now I understand how to use &quot;Maybe&quot; :)"}], "tags": [], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "is_accepted": false, "score": 6, "last_activity_date": 1495475679, "last_edit_date": 1495475679, "creation_date": 1495475161, "answer_id": 44119056, "question_id": 44118862, "link": "https://stackoverflow.com/questions/44118862/non-exhaustive-patterns-in-haskell/44119056#44119056", "title": "Non exhaustive patterns in Haskell", "body": "<p>You have three options:</p>\n\n<ol>\n<li><p>Use <code>Maybe</code>:</p>\n\n<pre><code>slotListToSlot :: [Slot] -&gt; Maybe Slot\nslotListToSlot [] = Nothing\nslotListToSlot (x:xs) = Just x\n</code></pre>\n\n<p>Alternative implementation: use <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#v:listToMaybe\" rel=\"noreferrer\"><code>listToMaybe</code></a> in the standard Data.Maybe package:</p>\n\n<pre><code>slotListToSlot :: [Slot] -&gt; Maybe Slot\nslotListToSlot = listToMaybe\n</code></pre></li>\n<li><p>Use <a href=\"http://hackage.haskell.org/package/NonEmpty\" rel=\"noreferrer\"><code>Data.List.NonEmpty</code></a>:</p>\n\n<pre><code>import Data.List.NonEmpty\n\nslotListToSlot :: NonEmpty Slot -&gt; Slot\nslotListToSlot = neHead\n</code></pre></li>\n<li><p>Use <code>error</code>:</p>\n\n<pre><code>slotListToSlot :: [Slot] -&gt; Slot\nslotListToSlot [] = error \"slotListToSlot: empty list\"\nslotListToSlot (x:xs) = x\n</code></pre></li>\n</ol>\n\n<p>I would recommend to use the first option, since 2. is unpractical, unless you work with <code>NonEmpty</code> everywhere in you program, and 3. is bad practice (makes your program vulnerable, because your function is partial, whereas using Maybe guarantees a crash-free function).</p>\n"}], "owner": {"reputation": 55, "user_id": 8046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c67d44ba4bb1ea25f7a7707f31e3dec?s=128&d=identicon&r=PG&f=1", "display_name": "itonva", "link": "https://stackoverflow.com/users/8046509/itonva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "closed_date": 1495527177, "answer_count": 3, "score": -1, "last_activity_date": 1572883230, "creation_date": 1495474278, "last_edit_date": 1572883230, "question_id": 44118862, "link": "https://stackoverflow.com/questions/44118862/non-exhaustive-patterns-in-haskell", "closed_reason": "Needs details or clarity", "title": "Non exhaustive patterns in Haskell", "body": "<p>I'm pretty new to Haskell so please understand that my question is kinda dumb. Actually it feels like it.</p>\n\n<p>So I've tried to solve the problem now for a couple of hours..\nI've got this</p>\n\n<pre><code>data Slot = Slot {\n            getTime :: Time,\n            getSubject :: Name\n            }\nderiving(Show,Eq)\n\n slotListToSlot :: [Slot] -&gt; Slot\n slotListToSlot [] = ???\n slotListToSlot (x:xs) = x\n</code></pre>\n\n<p>The compiler is complaining that there is no pattern for the empty List of Slots.\nOf course the questionmarks are just to show where code is missing.</p>\n\n<p>At this point I don't really know what to do.\nAny ideas and help is welcome ^^</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 6, "creation_date": 1495468577, "post_id": 44117197, "comment_id": 75253785, "body": "An <code>m a -&gt; m b</code> function can&#39;t do that because there&#39;s no general way to extract an <code>a</code> from an <code>m a</code>, <code>IO</code> being the most common example."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1495468590, "post_id": 44117197, "comment_id": 75253796, "body": "Well usually you cannot get a &quot;value&quot; out of a monad. The state of an I/O monad is for instance your entire system (and the state of the entire file system, the servers on the internet, hardware) at that moment (well virtually of course)."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1495468847, "post_id": 44117197, "comment_id": 75253939, "body": "As addition, you can think about <code>a -&gt; m b</code> as a callback. When computations will be run it can be called by &quot;interpretator&quot;."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1495468951, "post_id": 44117197, "comment_id": 75254008, "body": "If it were <code>m a -&gt; m b</code>, then we could always let <code>x &gt;&gt;= f = f x</code> for any <code>m</code>. This would be non interesting: it would not implement the &quot;temporary unboxing&quot; that <code>&gt;&gt;=</code> is about, since <code>f</code> would not be passed the &quot;unboxed value&quot;."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495469218, "post_id": 44117197, "comment_id": 75254169, "body": "To expand the example by Lee: consider <code>readLn &gt;&gt;= \\n -&gt; print (n+10 :: Int)</code> in the IO monad. This works because <code>n::Int</code>, if it were <code>n :: IO Int</code> we couldn&#39;t add 10 (nor print the result)."}, {"owner": {"reputation": 849, "user_id": 3316009, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q0EyA.jpg?s=128&g=1", "display_name": "calvin", "link": "https://stackoverflow.com/users/3316009/calvin"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1495469594, "post_id": 44117197, "comment_id": 75254380, "body": "@Lee I think if a value has type <code>m a</code>, it means this value is somewhat &quot;unsafe&quot; because it may cause side effects, apart from this, <code>m a</code> is just like <code>a</code>, so why can&#39;t we assume function <code>m a -&gt; m b</code> acts similar with <code>a -&gt; b</code>, so we can define <code>m a -&gt; m b</code> like defining <code>a -&gt; b</code>?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1495469910, "post_id": 44117197, "comment_id": 75254562, "body": "OK try defining a function of type <code>IO Int -&gt; IO String</code> without using <code>&gt;&gt;=</code>."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 4, "creation_date": 1495470273, "post_id": 44117197, "comment_id": 75254752, "body": "@calvin - The additional power that <code>Monad</code> has over <code>Applicative</code> is the ability to inspect the inner value <code>a</code> to choose the resulting value <code>m b</code>. If <code>(&gt;&gt;=)</code> took a function <code>m a -&gt; m b</code> then you would need a function <code>m a -&gt; a</code> to be able to inspect an <code>a</code> to decide on which value <code>m b</code> to return. However monads do not support such a function. Since monads are functors they already support lifting <code>a -&gt; b</code> to <code>m a -&gt; m b</code> with <code>fmap</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1495471399, "post_id": 44117197, "comment_id": 75255359, "body": "@Lee <i>If <code>(&gt;&gt;=)</code> took a function <code>m a -&gt; m b</code></i> then it would be called <code>(.)</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495471498, "post_id": 44117197, "comment_id": 75255409, "body": "@n.m. I don&#39;t think that is a useful or interesting challenge. <code>fmap show</code> is one reasonable example. It&#39;s quite easy to do using just Functor. The exciting thing about the Monad interface is that it lets us do <i>more</i> than that, by &quot;changing&quot; the IO wrapping our value."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1495471668, "post_id": 44117197, "comment_id": 75255483, "body": "@amalloy hmmm I&#39;m still living in the pre-AMP universe apparently."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1495471754, "post_id": 44117197, "comment_id": 75255531, "body": "@amalloy right; so the question becomes, &quot;can we satisfy ourselves with just <code>fmap</code>?&quot; And the answer is of course &quot;no&quot;: we&#39;d have to have a <i>primitive</i> <code>IO a</code> already defined for us, describing  any crazy computation that comes into our minds, to <code>fmap f</code> inside it (inside that <code>IO a</code> value, describing that crazy computation). (I&#39;m paraphrasing here what you&#39;ve said)."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1495473101, "post_id": 44117197, "comment_id": 75256268, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35387237/difference-in-capability-between-fmap-and-bind\">Difference in capability between fmap and bind?</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495473345, "post_id": 44117197, "comment_id": 75256399, "body": "@n.m. you meant not <code>(.)</code>, but <code>flip ($)</code> of course (and <a href=\"https://stackoverflow.com/questions/34545818/is-monad-bind-operator-closer-to-function-composition-chaining-or-functi/34561605#34561605\"><code>=&lt;&lt;</code> would become <code>$</code></a>)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1495473530, "post_id": 44117197, "comment_id": 75256504, "body": "@WillNess yeah, sure, my mistake."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495473827, "post_id": 44117197, "comment_id": 75256665, "body": "@n.m. not a mistake, just a minor detail. It <i>is</i> about the composition: <a href=\"https://stackoverflow.com/questions/11234632/monads-with-join-instead-of-bind/11249714#11249714\"><code>((g &lt;=&lt; f) =&lt;&lt;)  =  (g =&lt;&lt;) . (f =&lt;&lt;)  =  join . (g &lt;$&gt;) . join . (f &lt;$&gt;)</code></a>, and these &quot;promoted&quot; functions do plainly compose."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1495475620, "post_id": 44117197, "comment_id": 75257653, "body": "@calvin About &quot;<code>m a</code> is just like <code>a</code>&quot; -- no way! Consider <code>m = []</code>, the list monad. Is a list of integers the same as an integer? If <code>m = Maybe</code>, is an optional integer (which might not be there) the same as an integer? If <code>m = (-&gt; ) String</code>, is a function from strings to integers the same as an integer?"}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 10, "last_activity_date": 1590315613, "last_edit_date": 1590315613, "creation_date": 1495471100, "answer_id": 44118041, "question_id": 44117197, "link": "https://stackoverflow.com/questions/44117197/why-does-haskells-bind-function-take-a-function-from-non-monadic-to-monadic/44118041#44118041", "title": "Why does haskell&#39;s bind function take a function from non-monadic to monadic", "body": "<p><em>edit2:</em> OK, here's what I should've said from the start:</p>\n\n<h2>Monads are EDSLs,</h2>\n\n<p><em>E</em> as in <em>embedded</em> domain-specific languages. <em>Embedded</em> means that the language's statements are plain values in <em>our</em> language, Haskell.</p>\n\n<p>Let's try to have us an <em>IO</em>-language. Imagine we have <code>print1 :: IO ()</code> primitive, describing an action of printing an integer <code>1</code> at the prompt. Imagine we also have <code>print2 :: IO ()</code>. Both are plain Haskell values. In Haskell, we speak of these actions. This <em>IO</em>-language still needs to be interpreted / acted upon by some part of the run-time system <em>later</em>, at \"run\"-time. Having <em>two</em> languages, we have two worlds, two timelines.</p>\n\n<p>We could write <code>do { print1 ; print2 }</code> to describe compound actions. But we can't create a new primitive for printing <code>3</code> at the prompt, as it is <em>outside</em> our <em>pure</em> Haskell world. What we have here is an EDSL, but evidently not a very powerful one. We must have an infinite supply of primitives here; <em>not</em> a winning proposition.  And it is not even a Functor, as we can't modify these values. </p>\n\n<p>Now, what if we could? We'd then be able to tell <code>do { print1 ; print2 ; fmap (1+) print2 }</code>, to print out <code>3</code> as well. Now it's a Functor. More powerful, still not flexible enough.</p>\n\n<p>We get flexibility with primitives for <em>constructing</em> these action descriptors (like <code>print1</code>). It is e.g. <code>print :: Show a =&gt; a -&gt; IO a</code>. We can now talk about more versatile actions, like <code>do { print 42; getLine ; putStrLn (\"Hello, \" ++ \"... you!\") }</code>. </p>\n\n<p>But now we see the need to refer to the <em>\"results\"</em> of previous actions. We want to be able to write <code>do { print 42; s &lt;- getLine ; putStrLn (\"Hello, \" ++ s ++ \"!\") }</code>. We want to create (in Haskell world) new action descriptions (Haskell values describing actions in <em>IO</em>-world) based on  results (in Haskell world) of previous <em>IO</em>-actions that these <em>IO</em>-actions <em>will</em> produce, <em>when</em> they are run, <em>when</em> the <em>IO</em>-language is interpreted (the actions it describes been carried out in <em>IO</em>-world).</p>\n\n<p>This means the ability to create those <em>IO</em>-language statements from Haskell values, like with <code>print :: a -&gt; IO a</code>. And that is exactly the type you're asking about, and it <em>is</em> what makes this EDSL a <em>Monad</em>.</p>\n\n<hr>\n\n<p>Imagine we have an IO primitive (<code>a_primitive :: IO Int -&gt; IO ()</code>) which prints any positive integer as is, and prints <code>\"---\"</code> on a separate line before printing any non-positive integer. Then we could write <code>a_primitive (return 1)</code>, as you suggest. </p>\n\n<p>But IO is closed; it is impure; we can't write new IO primitives in Haskell, and there can't be a primitive already defined for every new idea that might come into our minds. So we write <code>(\\x -&gt; if x &gt; 0 then print x else do { putStrln \"---\"; print x })</code> instead, and that lambda expression's type is <code>Int -&gt; IO ()</code> (more or less). </p>\n\n<p>If the argument <code>x</code> in the above lambda-expression were of type <code>IO Int</code> the expression <code>x &gt; 0</code> would be mistyped. There is no way to get that <code>a</code> out of <code>IO a</code>  without the use of the standard <code>&gt;&gt;=</code> operator (or its equivalent).</p>\n\n<p>see also:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/39438091/how-monads-are-considered-pure/39647091#39647091\">How Monads are considered Pure?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/23342184/difference-between-monad-and-applicative-in-haskell\">Difference between Monad and Applicative in Haskell</a></li>\n<li><a href=\"https://stackoverflow.com/questions/34545818/is-monad-bind-operator-closer-to-function-composition-chaining-or-functi/34561605#34561605\">Is monad bind (&gt;&gt;=) operator closer to function composition (chaining) or function application?</a></li>\n<li><a href=\"http://stackoverflow.com/questions/11234632/monads-with-join-instead-of-bind/11249714#11249714\">Monads with Join() instead of Bind()</a></li>\n<li><a href=\"https://stackoverflow.com/questions/24467803/how-to-handle-side-effect-with-applicative/24467994#24467994\">How to handle side effect with Applicative?</a></li>\n</ul>\n\n<p>And, this <a href=\"https://stackoverflow.com/revisions/41310465/2\">quote</a>:</p>\n\n<blockquote>\n  <p>\"Someone at some point noticed, \"oh, in order to get impure effects\n  from pure code I need to do metaprogramming, which means one of my\n  types needs to be <em>'programs which compute an X'</em>. I want to take a\n  <em>'program that computes an X'</em> and a function which takes an X and\n  produces the next program, a <em>'program that computes a Y'</em>, and somehow\n  glue them together into a <em>'program which computes a Y'</em> \" (which is the\n  <code>bind</code> operation). The IO monad was born.\"</p>\n</blockquote>\n\n<hr>\n\n<p><em>edit:</em> These are the four types of <em>generalized</em> function application:</p>\n\n<pre><code>( $ ) ::                     (a -&gt;   b) -&gt;   a -&gt;   b     -- plain\n(&lt;$&gt;) :: Functor f     =&gt;    (a -&gt;   b) -&gt; f a -&gt; f b     -- functorial\n(&lt;*&gt;) :: Applicative f =&gt;  f (a -&gt;   b) -&gt; f a -&gt; f b     -- applicative\n(=&lt;&lt;) :: Monad f       =&gt;    (a -&gt; f b) -&gt; f a -&gt; f b     -- monadic\n</code></pre>\n\n<p>And here are the corresponding type derivation rules, with the flipped arguments order for clarity,</p>\n\n<pre><code> a                f a                f  a                f a\n a -&gt; b             a -&gt; b           f (a -&gt; b)            a -&gt; f b\n ------           --------           ----------          ----------\n      b           f      b           f       b           f        b\n\n no `f`s          one `f`            two `f`s,           two `f`s: \n                                     both known          one known,\n                                                         one constructed\n</code></pre>\n\n<p>Why? They just are. Your question is really, <em>why do we need Monads? Why Functors or Applicative Functors aren't enough?</em> And this was surely already asked and answered many times (e.g., the 2nd link in the list just above). For one, as I tried to show above, monads let us code new computations <em>in Haskell</em>.</p>\n"}], "owner": {"reputation": 849, "user_id": 3316009, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q0EyA.jpg?s=128&g=1", "display_name": "calvin", "link": "https://stackoverflow.com/users/3316009/calvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "accepted_answer_id": 44118041, "answer_count": 1, "score": 7, "last_activity_date": 1590315613, "creation_date": 1495468372, "last_edit_date": 1495478639, "question_id": 44117197, "link": "https://stackoverflow.com/questions/44117197/why-does-haskells-bind-function-take-a-function-from-non-monadic-to-monadic", "title": "Why does haskell&#39;s bind function take a function from non-monadic to monadic", "body": "<p>I have some questions about the definition of the binding function <code>(&gt;&gt;=)</code> in Haskell.</p>\n\n<p>Because Haskell is a pure language, so we can use Monad to handle operations with side effects. I think this strategy is somewhat like putting all actions may cause side effects to another world, and we can control them from our \"pure\" haskell world though <code>do</code> or <code>&gt;&gt;=</code>.</p>\n\n<p>So when I look at definition of <code>&gt;&gt;=</code> function  </p>\n\n<pre><code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>it takes a <code>(a -&gt; m b)</code> function, so result <code>m a</code> of the former action can be \"unpack\" to a non-monadic <code>a</code> in <code>&gt;&gt;=</code>. Then the function <code>(a -&gt; m b)</code> takes <code>a</code> as its input and return another monadic <code>m b</code> as its result. By the binding function I can operate on monadic without bringing any side effects into pure haskell codes.</p>\n\n<p>My question is why we use a <code>(a -&gt; m b)</code> function? In my opinion, a <code>m a -&gt; m b</code> function can also do this. Is there any reason, or just because it is designed like this?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>From comments I understand it's hard to extract <code>a</code> from <code>m a</code>. However, I think I can consider a monadic <code>m a</code> as a <code>a</code> with side effect.</p>\n\n<p>Is it possible to assume function <code>m a -&gt; m b</code> acts similar with <code>a -&gt; b</code>, so we can define <code>m a -&gt; m b</code> like defining <code>a -&gt; b</code>?</p>\n"}, {"tags": ["haskell", "typeclass", "functor", "quickcheck"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1495462743, "post_id": 44115075, "comment_id": 75249835, "body": "There is an arbitrary instance for functions <code>(CoArbitrary a, Arbitrary b) =&gt; Arbitrary (a -&gt; b)</code> you can then test for equality for functions - if you evaluate pointwise - i.e. you generate arbitrary <code>a</code> and compare the <code>f a</code> values"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1495462914, "post_id": 44115075, "comment_id": 75249961, "body": "for IO - you need to write your own Arbitrary instance - and except for the trivial instance <code>arbitrary = fmap pure . arbitrary</code> I cannot think of a reasonable one."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1495467539, "post_id": 44115075, "comment_id": 75253131, "body": "Usually, functions for QuickCheck should be represented by its <code>Fun</code> type."}, {"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 0, "creation_date": 1495477561, "post_id": 44115075, "comment_id": 75258604, "body": "You might want to use the <code>(.&amp;&amp;.)</code> operator from <code>Test.QuickCheck.Property</code> to combine properties, instead of creating an IO action and checking individually each property every time."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1495516845, "post_id": 44115075, "comment_id": 75271409, "body": "There is absolutely no way to verify the functor instance for <code>IO</code>, because your function (properly) requires <code>Eq (f a)</code> but you cannot have an instance <code>Eq (IO A)</code> for any type <code>A</code>. Functions are another story - a bit difficult, but <a href=\"https://hackage.haskell.org/package/QuickCheck-2.9.2/docs/Test-QuickCheck-Function.html\" rel=\"nofollow noreferrer\">doable</a>."}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1495462206, "creation_date": 1495462206, "question_id": 44115075, "link": "https://stackoverflow.com/questions/44115075/is-it-possible-to-quickcheck-functor-properties-of-the-function-type", "title": "Is it possible to quickcheck functor properties of the function type?", "body": "<p>I am trying to implement my own functor instances and quickcheck them, and have run into issues on typeclasses which are not instances of <code>Eq</code>, namely <code>(-&gt;)</code> and <code>IO</code>. My attempts result in a <code>No instance for (Eq ...)</code> error.</p>\n\n<p>In the <code>(-&gt;)</code> case I had run into a similar error with <code>Show</code>, i.e. <code>No instance for (Show ...)</code>, and was able to fix that by adding a <code>Show (a -&gt; b)</code> instance as suggested in an answer <a href=\"https://stackoverflow.com/questions/23504950/haskell-no-instance-for-show\">here</a>. It would seem that I might be able to solve also the lack of <code>Eq</code> instances by adding them similarly. However, <a href=\"https://stackoverflow.com/questions/9906628/equality-of-functions-in-haskell\">this question on function equality</a> notes that that in Haskell creating an instance of <code>Eq (a -&gt; b)</code> is equivalent to the halting problem and therefore impossible.</p>\n\n<p>I'm not sure whether creating an instance of <code>Eq IO a</code> is possible. In the <code>IO</code> case I also run into a <code>No instance for (Arbitrary ...)</code> error.</p>\n\n<p><strong>Is there some way to quickcheck the functor properties of the function type <code>(-&gt;)</code>? Is there some way to do the same for the <code>IO</code> type?</strong></p>\n\n<p>My code is as follows.</p>\n\n<pre><code>import Prelude hiding (Functor, fmap)\nimport Test.QuickCheck\nimport Test.QuickCheck.Function\n\nclass Functor f where\n  fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n\ninstance Functor IO where\n  fmap h f = f &gt;&gt;= (pure . h)\n\ninstance Functor ((-&gt;) e) where\n  fmap = (.)\n\ndata T a = T\n\nprop_functorid :: (Functor f, Eq (f a)) =&gt; T (f a) -&gt; f a -&gt; Bool\nprop_functorid T x = fmap id x == x\n\nprop_functorcompose :: (Functor f, Eq (f c)) =&gt; T (f a) -&gt; T b -&gt; T c -&gt; f a -&gt; Fun a b -&gt; Fun b c -&gt; Bool\nprop_functorcompose T T T x (apply -&gt; g) (apply -&gt; h) =\n  fmap (h . g) x == (fmap h . fmap g) x\n\ninstance Show (a -&gt; b) where\n  show a= \"function\"\n\nprop_function :: IO ()\nprop_function = do\n  quickCheck $ prop_functorid (T :: T (String -&gt; String))\n  quickCheck $ prop_functorcompose (T :: T (String -&gt; String)) (T :: T String) (T :: T String)\n\nprop_io :: IO ()\nprop_io = do\n  quickCheck $ prop_functorid (T :: T (IO String))\n  quickCheck $ prop_functorcompose (T :: T (IO String)) (T :: T String) (T :: T String)\n\nmain = do\n  prop_function\n  prop_io\n</code></pre>\n"}, {"tags": ["haskell", "gadt", "deriving"], "comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1495459117, "post_id": 44113874, "comment_id": 75247143, "body": "If adding the constraint will limit the inhabitants, the deriving mechanism certainly won&#39;t do it for you, nor would you want it to."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495462282, "post_id": 44113874, "comment_id": 75249443, "body": "@Lazersmoke I mean adding the constraints to the derived instance. This doesn&#39;t limit inhabitants, it only constructs the <code>Show</code> instance in a coherent way."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 2, "creation_date": 1495462891, "post_id": 44113874, "comment_id": 75249946, "body": "there is no good Show instance for T, no matter what you do, unless you restrict all tyvars (including existentials) to Show."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495477494, "post_id": 44113874, "comment_id": 75258561, "body": "If the <code>A</code> constructor is allowed to contain a non-showable number, how would you expect to show such <code>T</code> value?"}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 6, "last_activity_date": 1495481239, "creation_date": 1495481239, "answer_id": 44120707, "question_id": 44113874, "link": "https://stackoverflow.com/questions/44113874/automatically-deriving-show-instances-for-gadts/44120707#44120707", "title": "Automatically deriving show instances for GADTs", "body": "<p>I had an interesting thought, not sure how practical it is.  But if you want <code>T</code> to be showable when the parameters are showable, but also usable with not showable parameters, you could parameterize <code>T</code> over a constraint, using <code>ConstraintKinds</code>.</p>\n\n<pre><code>{-# LANGUAGE GADTs, ConstraintKinds #-}\n\nimport Data.Kind\n\ndata T :: (* -&gt; Constraint) -&gt; * where\n    A :: (Num n, c n) =&gt; n -&gt; T c\n    B :: (Num n, c n, Integral m, c m) =&gt; n -&gt; m -&gt; T c\n    ...\n</code></pre>\n\n<p>Then <code>T Show</code> will be showable... <em>maybe</em></p>\n\n<pre><code>deriving instance Show (T Show)\n</code></pre>\n\n<p>(with <code>StandaloneDeriving</code> extension) will work, but at the very least, <code>T</code> is showable in principle and you could write the instance manually.</p>\n\n<p>Though my practical advice is to reify the existentials.  An existential type is equivalent to the collection of its observations.  For example, if you had a class like</p>\n\n<pre><code>class Foo a where\n   getBool :: a -&gt; Bool\n   getInt  :: a -&gt; Int\n</code></pre>\n\n<p>then the existential</p>\n\n<pre><code>data AFoo where\n   AFoo :: Foo a =&gt; a\n</code></pre>\n\n<p>is exactly equivalent to <code>(Bool,Int)</code>, because the only thing you can do with a <code>Foo</code> whose type you don't know is call <code>getBool</code> on it or <code>getInt</code> on it.  You use <code>Num</code> in your datatype, and <code>Num</code> has <em>no observations</em>, since if you have an unknown <code>a</code> with <code>Num a</code>, the only thing you can do by calling methods of <code>Num</code> is get more <code>a</code>s out, and nothing ever concrete.  So your <code>A</code> constructor</p>\n\n<pre><code>A :: (Num n) =&gt; n -&gt; T\n</code></pre>\n\n<p>gives you <em>nothing</em> and you might as well just say</p>\n\n<pre><code>A :: T\n</code></pre>\n\n<p><code>Integral</code>, on the other hand, has <code>toInteger</code> as an observation.  So you could probably replace</p>\n\n<pre><code>B :: (Num n, Integral m) =&gt; n -&gt; m -&gt; T\n</code></pre>\n\n<p>with</p>\n\n<pre><code>B :: Integer -&gt; T\n</code></pre>\n\n<p>(we lost the <code>n</code> argument and replaced <code>m</code> with <code>Integer</code>).  I don't think this is technically equivalent since we could have implemented its operations differently than <code>Integral</code> does, but we're getting pretty technical at this point and I doubt you have need for it (I'd be interested in how if you do).</p>\n"}], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1503, "favorite_count": 0, "accepted_answer_id": 44120707, "answer_count": 1, "score": 2, "last_activity_date": 1495481239, "creation_date": 1495458897, "last_edit_date": 1495478604, "question_id": 44113874, "link": "https://stackoverflow.com/questions/44113874/automatically-deriving-show-instances-for-gadts", "title": "Automatically deriving show instances for GADTs", "body": "<p>Assume I have a complex GADT which with many hidden type parameters as constructors:</p>\n\n<pre><code>data T where\n  A :: Num n =&gt; n -&gt; T\n  B :: (Num n, Integral m) =&gt; n -&gt; m -&gt; T\n  C :: Floating a =&gt; [a] -&gt; T\n  -- and so on\n  Z :: Num n =&gt; n -&gt; n -&gt; T\n</code></pre>\n\n<p>I want to make this datatype showable without having to manually write the instance. Problem is, that since <code>Show</code> isn't a superclass of <code>Num</code> anymore, adding a simple <code>deriving instance Show T</code> isn't enough for the compiler to infer that it has to add <code>Show</code> constraints to all the internal hidden type parameters.</p>\n\n<p>For each hidden type parameter, it outputs something like </p>\n\n<pre><code>Could not deduce (Show n) arising from a use of 'showsPrec'\nfrom the context Num n\n  bound by a pattern with constructor\n             A :: forall n. Num n =&gt; n -&gt; T\n...\nPossible fix:\n  add (Show n) to the context of the data constructor 'A'\n</code></pre>\n\n<p>Adding a <code>Show</code> constraint to the datatype isn't an option either, since it limits the possible inhabitants of <code>T</code>. It seems like <code>deriving instanec Show T</code> should introduce the constraint <code>Show</code> on the hidden data types, although I am not sure.</p>\n\n<p>How can I go about this?</p>\n"}, {"tags": ["haskell", "monads", "dsl", "free-monad"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1495480985, "post_id": 44107783, "comment_id": 75260510, "body": "I&#39;m unsure about the semantics you expect from the <code>ObsModelF</code> type. Could you write an interpreter to clarify? Also, what is wrong with wrapping <code>beta 1 1</code> using <code>PureF</code> or a <code>lift</code>-like function?"}, {"owner": {"reputation": 135, "user_id": 698204, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/70f475a0bcd7c89d1b9308631047fb0a?s=128&d=identicon&r=PG", "display_name": "tmpethick", "link": "https://stackoverflow.com/users/698204/tmpethick"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1495483273, "post_id": 44107783, "comment_id": 75261691, "body": "I would like to <code>observe</code> an arbitrary distribution. If I lifted all distribution with <code>Pure</code> (both bernoulli and beta) I would have to unwrap bernoulli to lift it with <code>ObsF</code> again.   It seems like a lot of operations for a simpel task. What I want to achieve is fixing a <code>ModelF r</code> return value by &quot;labeling&quot; it as observed. I can try and elaborate more in the question body.."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1495485515, "post_id": 44107783, "comment_id": 75262772, "body": "From reading the blog post and a few more materials I have some idea of what it means to <code>observe</code> but I can&#39;t reconcile that with your type at the moment, hence why I asked to have an interpreter to look at. Furthermore, wrapping/unwrapping can usually be hidden pretty easily from the language user, but it&#39;s easier to figure out an appropriate way to clean up the API if there is a working implementation first."}, {"owner": {"reputation": 135, "user_id": 698204, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/70f475a0bcd7c89d1b9308631047fb0a?s=128&d=identicon&r=PG", "display_name": "tmpethick", "link": "https://stackoverflow.com/users/698204/tmpethick"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1495799461, "post_id": 44107783, "comment_id": 75414271, "body": "@Li-yaoXia I have updated the answer with a third attempt that includes an interpreter. I would really appreciate it if you could take a look and help me understand what is wrong."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1512262650, "post_id": 44107783, "comment_id": 82186845, "body": "You can use <code>ObsF !(ModelF r) r</code> if you want to make sure it doesn&#39;t nest indefinitely."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 698204, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/70f475a0bcd7c89d1b9308631047fb0a?s=128&d=identicon&r=PG", "display_name": "tmpethick", "link": "https://stackoverflow.com/users/698204/tmpethick"}, "edited": false, "score": 0, "creation_date": 1495744420, "post_id": 44163425, "comment_id": 75392570, "body": "Looks like a really nice port \u2013 I&#39;ll definitely have a closer look. You should also check out <a href=\"https://github.com/adscib/monad-bayes\" rel=\"nofollow noreferrer\">github.com/adscib/monad-bayes</a> if you haven&#39;t already. There seem to be a few similarities. It also looks like they have started adding single-site MH which was not part of the original paper.  My interpreter will eventually map it to a single-site MH so an observation should fix the <code>logPdf</code> and <code>sample</code> for a given distribution. I&#39;m struggling to understand how this can be modelled as a free monad though \u2013 would you stack the free monad?"}], "tags": [], "owner": {"reputation": 7922, "user_id": 99265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f392ec147661362aaddeb7e23f59d9?s=128&d=identicon&r=PG", "display_name": "Paul Horsfall", "link": "https://stackoverflow.com/users/99265/paul-horsfall"}, "is_accepted": false, "score": 1, "last_activity_date": 1495641792, "creation_date": 1495641792, "answer_id": 44163425, "question_id": 44107783, "link": "https://stackoverflow.com/questions/44107783/modeling-observation-for-probabilistic-programming-language-with-free-monads/44163425#44163425", "title": "Modeling observation for probabilistic programming language with free Monads", "body": "<p>I'm familiar with something similar in other languages/DSLs. I'm not sure the thing I have in mind is exactly what you're after, but I'll give a rough sketch of the idea. Maybe you'll find it helpful.</p>\n\n<p>The <code>observe</code> I'm familiar with has a type something like <code>Distribution a -&gt; a -&gt; Model ()</code>, and it is interpreted as multiplying the probability of the current path through the model by the probability(/density) of the observation under the distribution. This <code>observe</code> takes a <code>Distribution</code>, rather than a <code>Model</code>, as we need a way to compute the probability(/density) of the observation.</p>\n\n<p>Once you have a <code>Distribution</code> type, you can also replace the per distribution operations with a single operation for introducing uncertainty. This would take a <code>Distribution</code> as argument.</p>\n\n<p>I have a Haskell DSL that works in pretty much this way <a href=\"https://github.com/null-a/tyche\" rel=\"nofollow noreferrer\">here</a>. The only difference is that <code>observe</code> is <a href=\"https://github.com/null-a/tyche/blob/ac851be52cf01c4acbb62802c3314aa1173e750b/src/Tyche/Prelude.hs#L12-L13\" rel=\"nofollow noreferrer\">implemented</a> in terms of a simpler operation called <a href=\"https://github.com/null-a/tyche/blob/ac851be52cf01c4acbb62802c3314aa1173e750b/src/Tyche/Model.hs#L41-L45\" rel=\"nofollow noreferrer\"><code>weight</code>,</a> which arbitrarily modifies the log probability of the current path.</p>\n\n<p>BTW, this approach is lifted in its entirety from the <a href=\"http://webppl.org\" rel=\"nofollow noreferrer\">WebPPL</a> language.</p>\n"}, {"tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": false, "score": 1, "last_activity_date": 1512264216, "last_edit_date": 1512264216, "creation_date": 1512263024, "answer_id": 47614251, "question_id": 44107783, "link": "https://stackoverflow.com/questions/44107783/modeling-observation-for-probabilistic-programming-language-with-free-monads/47614251#47614251", "title": "Modeling observation for probabilistic programming language with free Monads", "body": "<p>Here is a suggestion</p>\n\n<pre><code>data ModelF r =\n    BernoulliF Double (Bool -&gt; r)\n  | BetaF Double Double (Double -&gt; r)\n  | ObsFail\n  deriving (Functor)\n</code></pre>\n\n<p>Then you can do</p>\n\n<pre><code>let dist = do\n      p &lt;- beta 1 1\n      b &lt;- bernoulli p\n      if (b==True)\n          then return ()\n          else ObsFail\n</code></pre>\n\n<p>In general, we can define</p>\n\n<pre><code>observe dist r = do\n    r' &lt;- dist\n    if r == r'\n        then return ()\n        else ObsFail\n</code></pre>\n\n<p>To sample, we sample like normal, except we re-sample it each time we get <code>ObsFail</code>.</p>\n"}], "owner": {"reputation": 135, "user_id": 698204, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/70f475a0bcd7c89d1b9308631047fb0a?s=128&d=identicon&r=PG", "display_name": "tmpethick", "link": "https://stackoverflow.com/users/698204/tmpethick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1512264216, "creation_date": 1495440623, "last_edit_date": 1495807492, "question_id": 44107783, "link": "https://stackoverflow.com/questions/44107783/modeling-observation-for-probabilistic-programming-language-with-free-monads", "title": "Modeling observation for probabilistic programming language with free Monads", "body": "<p>I am trying to implement a DST for probablistic programming inspired by <a href=\"https://jtobin.io/simple-probabilistic-programming\" rel=\"nofollow noreferrer\">Jared Tobin blog post</a>. </p>\n\n<p>A free monad for a DST including the bernoulli and beta distribution could look like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data ModelF r =\n    BernoulliF Double (Bool -&gt; r)\n  | BetaF Double Double (Double -&gt; r)\n  deriving (Functor)\n\ntype Model = Free ModelF\n\nbernoulli :: Double -&gt; Model Bool\nbernoulli p = liftF (BernoulliF p id)\n\nbeta :: Double -&gt; Double -&gt; Model Double\nbeta a b = liftF (BetaF a b id)\n</code></pre>\n\n<p>I would like to extend it to support observation on distributions. That is: force a specific return value.</p>\n\n<p>First attempt was to extend the functor:</p>\n\n<pre><code>data ModelF r =\n    BernoulliF Double (Bool -&gt; r)\n  | BetaF Double Double (Double -&gt; r)\n  | ObsF (ModelF r) r\n  deriving (Functor)\n</code></pre>\n\n<p>This is problematic however since it allows for a recursive nesting of <code>ObsF</code>.</p>\n\n<p>One solution would be to lift the free monad into another free monad representing an observed value:</p>\n\n<pre><code>data ObsModelF r =\n    PureF (Model r)\n  | ObsF (Model r) r\n  deriving (Functor)\n\nobserve :: Model r -&gt; r -&gt; Free ObsModelF r\nobserve model o = liftF (ObsF model o)\n</code></pre>\n\n<p>The syntax I am after though is:</p>\n\n<pre><code>let dist = do\n      p &lt;- beta 1 1\n      observe (bernoulli p) True\n</code></pre>\n\n<p>This is incompatible with <code>ObsModelF</code> since <code>beta 1 1</code> should also be lifted into <code>ObsModelF</code>. This requires two separate constructors: one for distributions without an observation and one with an observation. Is it possible to avoid that complexity in the DST?</p>\n\n<hr>\n\n<p>A third attempt. This time I wrap the distribution functor (<code>ModelF</code>) in the observation functor that I then lift (<code>ObsModelF</code>). \nI get some type errors I do not quite understand though (see the comments):</p>\n\n<pre><code>data ModelF r =\n    BernoulliF Double (Bool -&gt; r)\n  | BetaF Double Double (Double -&gt; r)\n  deriving (Functor)\n\ndata ObsModelF r =\n    PureF (ModelF r)\n  | ObsF (ModelF r) r\n  deriving (Functor)\n\ntype ObsModel = Free ObsModelF\n\nbernoulli :: Double -&gt; ObsModel Bool\nbernoulli p = liftF . PureF $ BernoulliF p id\n\nbeta :: Double -&gt; Double -&gt; ObsModel Double\nbeta a b = liftF . PureF $ BetaF a b id\n\nobserve :: ObsModel r -&gt; r -&gt; ObsModel r\nobserve f o = liftF $ case f of\n           (Free f') -&gt; case f' of\n               (PureF f'') -&gt;  ObsF f'' o   -----| Couldn't match expected type \u2018Free ObsModelF r\u2019\n               (ObsF f'' o') -&gt;  ObsF f'' o    --| with actual type \u2018r\u2019\n\ntoSampler :: (RandomGen g) =&gt; ObsModel r -&gt; State g r\ntoSampler = iterM $ \\case\n  ObsF a o -&gt; case a of \n    BernoulliF p f -&gt; return o &gt;&gt;= f  -----| Couldn't match type \u2018StateT g Data.Functor.Identity.Identity r\u2019\n    BetaF a b f    -&gt; return o &gt;&gt;= f     --| with \u2018Bool\u2019\n  PureF a -&gt; case a of \n    BernoulliF p f -&gt; MWC.bernoulli p &gt;&gt;= f\n    BetaF a b f    -&gt; MWC.beta a b &gt;&gt;= f\n</code></pre>\n\n<p>I have included a very simple interpreter (<code>toSampler</code>). Currently it ignores the distribution completely and just flatmaps the observation value. Please note that this is not the intended behaviour when conditioning on a distribution. It is only provided to show how the interpreter would traverse the free structure.</p>\n"}, {"tags": ["haskell", "template-haskell"], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1495505738, "post_id": 44114146, "comment_id": 75268391, "body": "The O.P. was trying to invoke the TH functions inside a monad. That&#39;s wrong: the TH is creating declarations that must appear at top level iin the program. So your answer is correctly putting the splices at top level."}], "tags": [], "owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "is_accepted": false, "score": 1, "last_activity_date": 1495459621, "creation_date": 1495459621, "answer_id": 44114146, "question_id": 44107336, "link": "https://stackoverflow.com/questions/44107336/how-to-define-a-type-in-a-templatehaskell-function-and-use-it-in-the-same-functi/44114146#44114146", "title": "How to define a type in a TemplateHaskell function and use it in the same function?", "body": "<p>The problem you are having is that <code>makeRecordSplice</code> needs to be in a different module than the one it is instantiated in. This Template-Haskell limitation ensures non-circular dependencies at compile time. It is an annoying limitation but not too difficult to go around. Here is one way you could do it:</p>\n\n\n\n<pre><code>{-# LANGUAGE FlexibleContexts       #-}\n{-# LANGUAGE FlexibleInstances      #-}\n{-# LANGUAGE FunctionalDependencies #-}\n{-# LANGUAGE MultiParamTypeClasses  #-}\n{-# LANGUAGE OverloadedStrings      #-}\n{-# LANGUAGE TemplateHaskell        #-}\n\nmodule Main where\n\nimport           Data.Profunctor.Product.TH (makeAdaptorAndInstance)\nimport           Language.Haskell.TH\nimport           Lib                        (makeRecordSplice)\n\n\n$(makeRecordSplice)\n$(makeAdaptorAndInstance \"pPerson2\" (mkName \"PersonPoly2\"))\n\nmain :: IO ()\nmain = undefined\n</code></pre>\n\n\n\n<pre><code>{-# LANGUAGE FlexibleContexts       #-}\n{-# LANGUAGE FlexibleInstances      #-}\n{-# LANGUAGE FunctionalDependencies #-}\n{-# LANGUAGE MultiParamTypeClasses  #-}\n{-# LANGUAGE OverloadedStrings      #-}\n{-# LANGUAGE TemplateHaskell        #-}\n\nmodule Lib where\n\nimport           Data.Profunctor.Product.TH (makeAdaptorAndInstance)\nimport           Language.Haskell.TH\n\nmakeRecordSplice :: Q [Dec]\nmakeRecordSplice = [d|\n  data PersonPoly2 a b = Person2\n    { id :: a\n    , name :: b\n    }\n  |]\n</code></pre>\n\n<p>You can obviously create an alias for <code>makeAdaptorAndInstance \"pPerson2\" (mkName \"PersonPoly2\")</code> and hide it in <code>Lib</code>, you just can't have a splice dependent on another one in the same module.</p>\n\n<p>Hope this helps! :-)</p>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1495459621, "creation_date": 1495439071, "question_id": 44107336, "link": "https://stackoverflow.com/questions/44107336/how-to-define-a-type-in-a-templatehaskell-function-and-use-it-in-the-same-functi", "title": "How to define a type in a TemplateHaskell function and use it in the same function?", "body": "<p>Is there any way to have as single TH function, define a type, and use the type, as well? Relevant code below. <code>PersonPoly2</code> is being defined by <code>makeRecordSplice</code> and then being passed to <code>makeAdaptorAndInstance</code> (from Opalaye), which is also a TH function.</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts       #-}\n{-# LANGUAGE FlexibleInstances      #-}\n{-# LANGUAGE FunctionalDependencies #-}\n{-# LANGUAGE MultiParamTypeClasses  #-}\n{-# LANGUAGE OverloadedStrings      #-}\n{-# LANGUAGE TemplateHaskell        #-}\n\nmodule Lib where\n\nimport           Data.Profunctor.Product.TH             (makeAdaptorAndInstance)\nimport Language.Haskell.TH\n\nmakeRecordSplice :: Q [Dec]\nmakeRecordSplice = [d|\n  data PersonPoly2 a b = Person2\n    { id :: a \n    , name :: b\n    }\n  |]\n\nmakeRecordAndAdapter :: Q [Dec]\nmakeRecordAndAdapter = do\n  record &lt;- makeRecordSplice\n  adapter &lt;- makeAdaptorAndInstance \"pPerson2\" (mkName \"PersonPoly2\")\n  return $ record ++ adapter\n\n\n-------------\n\n/home/Projects/scratch/app/Main.hs:26:1: error:\n    \u2018PersonPoly2\u2019 is not in scope at a reify\nFailed, modules loaded: Lib.\n</code></pre>\n"}, {"tags": ["haskell", "monads", "functor"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1495495177, "post_id": 44105828, "comment_id": 75266084, "body": "Well, this just pushes the question down to the <code>Applicative</code> level. That is: why is <code>fmap f x = pure f &lt;*&gt; x</code> a consequence of the <code>Applicative</code> laws? After all, they don&#39;t even mention <code>fmap</code>! And then to answer that, you need @duplode&#39;s observation about parametricity..."}], "tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": true, "score": 8, "last_activity_date": 1495433858, "last_edit_date": 1592644375, "creation_date": 1495433858, "answer_id": 44105828, "question_id": 44105493, "link": "https://stackoverflow.com/questions/44105493/relationship-between-fmap-and-bind/44105828#44105828", "title": "Relationship between fmap and bind", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Applicative.html\" rel=\"noreferrer\"><code>Control.Applicative</code></a> says</p>\n<blockquote>\n<p>As a consequence of these laws, the <code>Functor</code> instance for f will satisfy</p>\n<pre><code>fmap f x = pure f &lt;*&gt; x\n</code></pre>\n</blockquote>\n<p>The relationship between <code>Applicative</code> and <code>Monad</code> says</p>\n<blockquote>\n<pre><code>pure = return\n</code></pre>\n\n<pre><code>(&lt;*&gt;) = ap\n</code></pre>\n</blockquote>\n<p><a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad.html#v:ap\" rel=\"noreferrer\"><code>ap</code></a> says</p>\n<blockquote>\n<pre><code>return f `ap` x1 `ap` ... `ap` xn\n</code></pre>\n<p>is equivalent to</p>\n<pre><code>liftMn f x1 x2 ... xn\n</code></pre>\n</blockquote>\n<p>Therefore</p>\n<pre><code>fmap f x = pure f &lt;*&gt; x\n         = return f `ap` x\n         = liftM f x\n         = do { v &lt;- x; return (f v) }\n         = x &gt;&gt;= return . f\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "edited": false, "score": 0, "creation_date": 1495468427, "post_id": 44106008, "comment_id": 75253687, "body": "I think the substitutions are more straightforward in my answer but yours expresses more of the intuition for why it <i>should</i> be."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 7, "last_activity_date": 1495435154, "last_edit_date": 1495541447, "creation_date": 1495434612, "answer_id": 44106008, "question_id": 44105493, "link": "https://stackoverflow.com/questions/44105493/relationship-between-fmap-and-bind/44106008#44106008", "title": "Relationship between fmap and bind", "body": "<p><a href=\"https://stackoverflow.com/a/19775139/2751851\"><code>Functor</code> instances are unique</a>, in the sense that if <code>F</code> is a <code>Functor</code> and you have a function <code>foobar :: (a -&gt; b) -&gt; F a -&gt; F b</code> such that <code>foobar id = id</code> (that is, it follows the first functor law) then <code>foobar = fmap</code>. Now, consider this function:</p>\n\n<pre><code>liftM :: Monad f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\nliftM f xs = xs &gt;&gt;= return . f\n</code></pre>\n\n<p>What is <code>liftM id xs</code>, then?</p>\n\n<pre><code>liftM id xs\nxs &gt;&gt;= return . id\n-- id does nothing, so...\nxs &gt;&gt;= return\n-- By the second monad law...\nxs\n</code></pre>\n\n<p><code>liftM id xs = xs</code>; that is, <code>liftM id = id</code>. Therefore, <code>liftM = fmap</code>; or, in other words...</p>\n\n<pre><code>fmap f xs  =  xs &gt;&gt;= return . f\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/44105828/2751851\">epheriment's answer</a>, which routes through the <code>Applicative</code> laws, is also a valid way of reaching this conclusion.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6102088"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 972, "favorite_count": 1, "accepted_answer_id": 44105828, "answer_count": 2, "score": 5, "last_activity_date": 1495435154, "creation_date": 1495432338, "last_edit_date": 1592644375, "question_id": 44105493, "link": "https://stackoverflow.com/questions/44105493/relationship-between-fmap-and-bind", "title": "Relationship between fmap and bind", "body": "<p>After looking up the <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad.html\" rel=\"nofollow noreferrer\"><code>Control.Monad</code></a> documentation, I'm confused about\nthis passage:</p>\n<blockquote>\n<p>The above laws imply:</p>\n<p><code>fmap f xs  =  xs &gt;&gt;= return . f</code></p>\n</blockquote>\n<p>How do they imply that?</p>\n"}, {"tags": ["haskell", "applicative", "category-theory"], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1495431238, "post_id": 44104856, "comment_id": 75230367, "body": "For Answer 2, I think the type would be <code>(&lt;*&gt;) :: (r -&gt; r, a -&gt; b) -&gt; (r, a) -&gt; (r, b)</code>. This would then force the value of <code>r -&gt; r</code> to be <code>id</code>. You could then say <code>(r1, f) (r2, x) = (r1 r2, f x)</code>, or <code>(r1, f) (r2, x) = (r2, f x)</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 2, "creation_date": 1495435021, "post_id": 44104856, "comment_id": 75232011, "body": "@George That&#39;s not a valid specialisation of <code>(&lt;*&gt;)</code>, as <code>(r -&gt; r, a -&gt; b)</code> does not involve the same <code>Functor</code> -- there, you have <code>((,) (r -&gt; r))</code> rather than <code>((,) r)</code>."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 8, "last_activity_date": 1495428615, "creation_date": 1495428615, "answer_id": 44104856, "question_id": 44104502, "link": "https://stackoverflow.com/questions/44104502/why-is-r-a-functor-that-is-not-an-applicative/44104856#44104856", "title": "Why is `((,) r)` a Functor that is NOT an Applicative?", "body": "<p><strong>Answer 1:</strong></p>\n\n<blockquote>\n<pre><code>(pure f) (pure x, pure y) = (pure x, pure f y)\n</code></pre>\n</blockquote>\n\n<p>I don't understand what you mean by this line. It looks like nonsense: <code>pure f</code> would be a pair, and you can't apply a pair as if it were a function.</p>\n\n<blockquote>\n  <p>From there, the definition of <code>pure :: a -&gt; (r, a)</code> could depend on what <code>r</code> is.</p>\n</blockquote>\n\n<p>That is exactly the problem. <code>r</code> is fully general; the instance declaration says <code>((,) r)</code> is a Functor <em>for all types <code>r</code></em>. That means you have to somehow implement a single <code>pure :: a -&gt; (r, a)</code> that works with any type <code>r</code> that a caller might choose. This is impossible because there is no way to conjure up an arbitrary <code>r</code> from thin air.</p>\n\n<p>Or as your quote says:</p>\n\n<blockquote>\n  <blockquote>\n    <p>In particular, there is no way how to define <code>pure :: a -&gt; (r, a)</code> for an arbitrary <code>r</code>.</p>\n  </blockquote>\n</blockquote>\n\n<p>If you try to do something like</p>\n\n<pre><code>pure x = (0 :: Integer, x)\n</code></pre>\n\n<p>you get an error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Couldn't match expected type \u2018r\u2019 with actual type \u2018Integer\u2019\n  \u2018r\u2019 is a rigid type variable bound by\n      the instance declaration\n      at ...\n</code></pre>\n\n<hr>\n\n<p><strong>Answer 2:</strong></p>\n\n<p>What would <code>&lt;*&gt;</code> look like for pairs? It would be a function like</p>\n\n<pre><code>(&lt;*&gt;) :: (r, a -&gt; b) -&gt; (r, a) -&gt; (r, b)\n(r1, f) (r2, x) = (???, f x)\n</code></pre>\n\n<p>But what do you do with the <code>???</code> part? You have to put a value of <code>r</code> there, and fortunately you have some of those available (<code>r1</code>, <code>r2</code>). The problem is that (for arbitrary <code>r</code>) there is no general way to combine two values, so you have to pick one of them.</p>\n\n<p>That's where you run into trouble with the laws:</p>\n\n<pre><code>pure id &lt;*&gt; v = v\n</code></pre>\n\n<p>This law says we have to pick <code>r2</code> to preserve <code>v</code>.</p>\n\n<pre><code>u &lt;*&gt; pure y = pure ($ y) &lt;*&gt; u\n</code></pre>\n\n<p>Since we have to pick <code>r2</code> in <code>&lt;*&gt;</code>, the right-hand side of this law says the result will contain the <code>r</code> part of <code>u</code>. But that clashes with the left-hand side, which says that we get whatever <code>r</code> was returned by <code>pure y</code>. (<code>u</code> is a completely arbitrary pair so there's no way a fixed value returned by <code>pure</code> is always going to match it.)</p>\n\n<p>So we have a contradiction, meaning we can't even define <code>&lt;*&gt;</code> for <code>((,) r)</code>. Therefore the answer to your second question is \"no\".</p>\n\n<hr>\n\n<p>That said, there is a standard <code>Applicative</code> instance for pairs but it requires <code>r</code> to be a <code>Monoid</code>:</p>\n\n<pre><code>instance (Monoid r) =&gt; Applicative ((,) r) where\n    pure x = (mempty, x)\n    (r1, f) (r2, x) = (mappend r1 r2, f x)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1512204527, "post_id": 44107542, "comment_id": 82170760, "body": "Interestingly, it works the other way around as well. <code>instance Applicative ((,) r) =&gt; Monoid r</code>."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 10, "last_activity_date": 1495439746, "creation_date": 1495439746, "answer_id": 44107542, "question_id": 44104502, "link": "https://stackoverflow.com/questions/44104502/why-is-r-a-functor-that-is-not-an-applicative/44107542#44107542", "title": "Why is `((,) r)` a Functor that is NOT an Applicative?", "body": "<p>Suppose we have</p>\n\n<pre><code>pure :: forall r a. a -&gt; (r, a)\n</code></pre>\n\n<p>then, in particular, we have</p>\n\n<pre><code>magic :: forall r. r\nmagic = fst (pure ())\n</code></pre>\n\n<p>Now, we can specialise the type variable <code>r</code> to get</p>\n\n<pre><code>magic :: Void\n</code></pre>\n\n<p>where <code>Void</code> is the datatype with no constructors, which means</p>\n\n<pre><code>magic = undefined\n</code></pre>\n\n<p>but as type variables (and the types which specialise them) play no run time role, that means <code>magic</code> is <em>always</em> undefined.</p>\n\n<p>We've discovered that <code>((,) r)</code> can be <code>Applicative</code> only for <em>inhabited</em> <code>r</code>. And there's more. With any such instance, we can write</p>\n\n<pre><code>munge :: r -&gt; r -&gt; r\nmunge r0 r1 = fst ( pure (\\ _ _ -&gt; ()) &lt;*&gt; (r0, ()) &lt;*&gt; (r1, ()) )\n</code></pre>\n\n<p>to define a binary operator on <code>r</code>. The <code>Applicative</code> laws tell us effectively that <code>munge</code> must be an associative operator that absorbs <code>magic</code> on either side.</p>\n\n<p>That's to say there <em>is</em> a sensible instance</p>\n\n<pre><code>instance Monoid r =&gt; Applicative ((,) r) where\n  pure a              = (mempty, a)\n  (r0, f) &lt;*&gt; (r1, s) = (mappend r0 r1, f s)\n</code></pre>\n\n<p>(exactly what you get when you take <code>pure=return; (&lt;*&gt;)=ap</code> from the <code>Monad (Writer r)</code>).</p>\n\n<p>Of course, some pedants would argue that it is legal (if unhelpful) to define</p>\n\n<pre><code>instance Monoid r where\n  mempty = undefined\n  mappend _ _ = undefined\n  -- Monoid laws clearly hold\n</code></pre>\n\n<p>but I would argue that any sensible type class instance should contribute nontrivially to the defined fragment of the language.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 2, "answer_count": 2, "score": 8, "last_activity_date": 1495439746, "creation_date": 1495425907, "last_edit_date": 1495542894, "question_id": 44104502, "link": "https://stackoverflow.com/questions/44104502/why-is-r-a-functor-that-is-not-an-applicative", "title": "Why is `((,) r)` a Functor that is NOT an Applicative?", "body": "<p>From <a href=\"https://stackoverflow.com/questions/7220436/good-examples-of-not-a-functor-functor-applicative-monad\">functors that are not applicatives</a>:</p>\n\n<blockquote>\n  <p><strong>A type constructor which is a Functor but not an Applicative.</strong> A simple example is a pair:</p>\n\n<pre><code>instance Functor ((,) r) where\n    fmap f (x,y) = (x, f y)\n</code></pre>\n  \n  <p>But there is no way how to define its <code>Applicative</code> instance without imposing additional restrictions on <code>r</code>. In particular, there is no way how to define <code>pure :: a -&gt; (r, a)</code> for an arbitrary <code>r</code>.</p>\n</blockquote>\n\n<p><strong>Question 1:</strong> Why is this so? Here is how <code>pure</code> could work with functions <code>f</code> of type <code>a -&gt; b</code>:</p>\n\n<pre><code>(pure f) (pure x, pure y) = (pure x, pure f y)\n</code></pre>\n\n<p>From there, the definition of <code>pure :: a -&gt; (r, a)</code> could depend on what <code>r</code> is. For example, if <code>r</code> is <code>Integer</code>, then you could define</p>\n\n<pre><code>pure x = (0 :: Integer, x)\n</code></pre>\n\n<p>in your instance declaration. So what is the issue?</p>\n\n<p><strong>Question 2:</strong> Can we say in general that if <code>F</code> is a functor, then <code>&lt;*&gt;</code> can always be defined, but <code>pure</code> might not always be defined?</p>\n"}, {"tags": ["haskell", "category-theory"], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 0, "last_activity_date": 1495490359, "creation_date": 1495490359, "answer_id": 44122762, "question_id": 44103972, "link": "https://stackoverflow.com/questions/44103972/can-the-kind-be-thought-of-as-obhask/44122762#44122762", "title": "Can the kind `*` be thought of as `ob(Hask)`?", "body": "<p>Yes, but there are types of kind other than <code>*</code> in Haskell with <code>DataKinds</code> that won't be part of your <strong>Hask</strong> category.</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\ndata Foo = Bar\n</code></pre>\n\n<p><code>'Bar</code>'s kind is <code>Foo</code>, so you can't use <code>-&gt;</code> with it, so it would be outside your <strong>Hask</strong> but still a Haskell type.</p>\n"}, {"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 1, "last_activity_date": 1495994726, "creation_date": 1495994726, "answer_id": 44230428, "question_id": 44103972, "link": "https://stackoverflow.com/questions/44103972/can-the-kind-be-thought-of-as-obhask/44230428#44230428", "title": "Can the kind `*` be thought of as `ob(Hask)`?", "body": "<p>At this point it must be some sort of clich\u00e9 to link to the <a href=\"https://wiki.haskell.org/Hask\" rel=\"nofollow noreferrer\">Hask article on the Haskell wiki</a> every time a question about Hask gets brought up, but here it is.</p>\n\n<p>To expand on the wiki a little I think the answer to this question is a very boring yes, but only because Hask is <em>defined</em> such that the objects of Hask are types of kind \u2b51. The full definition is:</p>\n\n<ul>\n<li><p>Let every type of kind \u2b51 be an object of Hask, except <code>undefined</code>. I think \"Yes\" is essentially the answer to your question until a devil's advocate brings up <code>undefined</code> and <code>seq</code>, at which point the answer necessarily becomes more and more complicated.</p></li>\n<li><p>Let every function of type <code>A -&gt; B</code> be an arrow from the object corresponding to type <code>A</code> to the object corresponding to type <code>B</code>.</p></li>\n<li><p>Very carefully <a href=\"http://math.andrej.com/2016/08/06/hask-is-not-a-category/\" rel=\"nofollow noreferrer\">choose a notion of equality for the arrows, which may or may not exist</a> (<a href=\"https://www.reddit.com/r/haskell/comments/4wk0gs/hask_is_not_a_category/\" rel=\"nofollow noreferrer\">see ensuing discussion</a>) or maybe throw out <code>seq</code> or maybe give up altogether.</p></li>\n<li><p>Let the arrow corresponding to <code>id :: A -&gt; A</code> be the identity arrow for each object.</p></li>\n<li><p>Let <code>.</code>, which is associative &amp;c., correspond to the composition of arrows, which must be associative &amp;c.</p></li>\n</ul>\n\n<p>This is by no means the only category you can model Haskell programs with but we do this and bless it with the Hask name because a lot of other notions then naturally correspond to Haskell computation. For example, an endofunctor on this category would conveniently be represented by something of kind \u2b51 -> \u2b51 with a (lawful) function taking <code>fmap :: ((a :: \u2b51) -&gt; (b :: \u2b51)) -&gt; ((f a :: \u2b51) -&gt; (f b :: \u2b51))</code>.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 1, "accepted_answer_id": 44230428, "answer_count": 2, "score": 1, "last_activity_date": 1495994726, "creation_date": 1495421781, "question_id": 44103972, "link": "https://stackoverflow.com/questions/44103972/can-the-kind-be-thought-of-as-obhask", "title": "Can the kind `*` be thought of as `ob(Hask)`?", "body": "<p>If <strong>Hask</strong> is the category of all haskell types (with functions as arrows), then can we think of <code>ob(Hask)</code> (that is, the collection of objects of <strong>Hask</strong>) as equal to <code>*</code>?</p>\n\n<p>If not, in what sense is this wrong?</p>\n"}, {"tags": ["haskell", "category-theory"], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 6, "last_activity_date": 1495471117, "last_edit_date": 1495471117, "creation_date": 1495426195, "answer_id": 44104538, "question_id": 44103758, "link": "https://stackoverflow.com/questions/44103758/showing-that-newtype-t-a-t-a-int-is-a-type-constructor-that-is-not-a-fu/44104538#44104538", "title": "Showing that `newtype T a = T (a -&gt; Int)` is a Type Constructor that is Not a Functor", "body": "<p>Suppose that T is a functor. Then we have</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; T a -&gt; T b\n</code></pre>\n\n<p>Now, let's try implementing it.</p>\n\n<pre><code>instance Functor T where\n  fmap f (T g) = T $ \\x -&gt; _y\n</code></pre>\n\n<p>Clearly we start with something like this, and combine the values <code>f</code>, <code>g</code>, and <code>x</code> somehow to compute a value for <code>y</code> that's of the right type. How can we do that? Well, notice I've called it <code>_y</code>, which tells GHC I need some help figuring out what to put there. What does GHC have to say?</p>\n\n<pre><code>&lt;interactive&gt;:7:28: error:\n    \u2022 Found hole: _y :: Int\n      Or perhaps \u2018_y\u2019 is mis-spelled, or not in scope\n    \u2022 In the expression: _y\n      In the second argument of \u2018($)\u2019, namely \u2018\\ x -&gt; _y\u2019\n      In the expression: T $ \\ x -&gt; _y\n    \u2022 Relevant bindings include\n        x :: b (bound at &lt;interactive&gt;:7:23)\n        g :: a -&gt; Int (bound at &lt;interactive&gt;:7:13)\n        f :: a -&gt; b (bound at &lt;interactive&gt;:7:8)\n        fmap :: (a -&gt; b) -&gt; T a -&gt; T b (bound at &lt;interactive&gt;:7:3)\n</code></pre>\n\n<p>So now we're clear about the types of everything relevant, right? We need to return an <code>Int</code> somehow, and what we have to build it out of are:</p>\n\n<pre><code>        x :: b\n        g :: a -&gt; Int\n        f :: a -&gt; b\n</code></pre>\n\n<p>Well, okay, the only thing we have that can possibly create an <code>Int</code> is <code>g</code>, so let's fill that in, leaving <code>g</code>'s argument blank to ask GHC for more help:</p>\n\n<pre><code>instance Functor T where\n  fmap f (T g) = T $ \\x -&gt; g _y\n\n&lt;interactive&gt;:7:31: error:\n    \u2022 Found hole: _y :: a\n      Where: \u2018a\u2019 is a rigid type variable bound by\n               the type signature for:\n                 fmap :: forall a b. (a -&gt; b) -&gt; T a -&gt; T b\n               at &lt;interactive&gt;:7:3\n      Or perhaps \u2018_y\u2019 is mis-spelled, or not in scope\n    \u2022 In the first argument of \u2018g\u2019, namely \u2018(_y)\u2019\n      In the expression: g (_y)\n      In the second argument of \u2018($)\u2019, namely \u2018\\ x -&gt; g (_y)\u2019\n    \u2022 Relevant bindings include\n        x :: b (bound at &lt;interactive&gt;:7:23)\n        g :: a -&gt; Int (bound at &lt;interactive&gt;:7:13)\n        f :: a -&gt; b (bound at &lt;interactive&gt;:7:8)\n        fmap :: (a -&gt; b) -&gt; T a -&gt; T b (bound at &lt;interactive&gt;:7:3)\n</code></pre>\n\n<p>Okay, we could have predicted this ourselves: to call <code>g</code>, we need a value of type <code>a</code> from somewhere. But we don't have any values of type <code>a</code> in scope, and we don't have any functions that return a value of type <code>a</code> either! We're stuck: it's impossible to produce a value of the type we want now, even though at every step we did the only possible thing: there's nothing we could back up and try differently.</p>\n\n<p>Why did this happen? Because if I give you a function of type <code>a -&gt; Int</code> and say \"but by the way, here's a function from <code>a -&gt; b</code>, please give me back a function from <code>b -&gt; Int</code> instead\", you can't actually <em>use</em> the function from <code>a -&gt; b</code>, because nobody ever gives you any <code>a</code>s to call it on! If I had given you a function from <code>b -&gt; a</code> instead, that would be quite helpful, right? You could produce a function from <code>b -&gt; Int</code> then, by first calling the <code>b -&gt; a</code> function to get an <code>a</code>, and then calling the original <code>a -&gt; Int</code> function to get out the desired <code>Int</code>.</p>\n\n<p>And that's what a contravariant functor is about: we reverse the arrow in the function passed to <code>fmap</code>, so it can fmap over things you \"need\" (function arguments) instead of things you \"have\" (concrete values, return values of functions, etc).</p>\n\n<hr>\n\n<p>Aside: I claimed earlier that we had done \"the only possible thing\" at each step, which was a bit of a fib. We can't build an <code>Int</code> out of <code>f</code>, <code>g</code>, and <code>x</code>, but of course we can make up all sorts of numbers out of the air. We don't know anything about the type <code>b</code>, so we can't get an <code>Int</code> that's derived from it in some way, but we could just say \"let's always return zero\", and this technically satisfies the type checker:</p>\n\n<pre><code>instance Functor T where\n  fmap f (T g) = T $ const 0\n</code></pre>\n\n<p>Obviously this looks quite wrong, since it seems like <code>f</code> and <code>g</code> ought to be pretty important and we're ignoring them! But it type-checks, so we're okay, right?</p>\n\n<p>No, this violates one of the Functor laws:</p>\n\n<pre><code>fmap id = id\n</code></pre>\n\n<p>We can prove this easily enough:</p>\n\n<pre><code>fmap id (T $ const 5) = (T $ const 0) /= (T $ const 5)\n</code></pre>\n\n<p>And now we really <em>have</em> tried everything: the only way we have to build an <code>Int</code> without using our <code>b</code> type at all is to make it up out of nothing, and all such uses will be isomorphic to using <code>const</code>, which will violate the Functor laws.</p>\n"}, {"tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": true, "score": 6, "last_activity_date": 1495463306, "last_edit_date": 1495463306, "creation_date": 1495426645, "answer_id": 44104590, "question_id": 44103758, "link": "https://stackoverflow.com/questions/44103758/showing-that-newtype-t-a-t-a-int-is-a-type-constructor-that-is-not-a-fu/44104590#44104590", "title": "Showing that `newtype T a = T (a -&gt; Int)` is a Type Constructor that is Not a Functor", "body": "<p>Given</p>\n\n<pre><code>newtype T a = T (a -&gt; Int)\n</code></pre>\n\n<p>let's try to build the <code>Contravariant</code> instance for this datatype.</p>\n\n<p>Here's the typeclass in question:</p>\n\n<pre><code>class Contravariant f where\n  contramap :: (a -&gt; b) -&gt; f b -&gt; f a\n</code></pre>\n\n<p>Basically, <code>contramap</code> is akin to <code>fmap</code>, but instead of lifting a function <code>a -&gt; b</code> to <code>f a -&gt; f b</code>, it lifts it to <code>f b -&gt; f a</code>.</p>\n\n<p>Let's begin writing the instance...</p>\n\n<pre><code>instance Contravariant T where\n  contramap g (T f) = ?\n</code></pre>\n\n<p>Before we fill in the <code>?</code>, let's think about what the types of <code>g</code> and <code>f</code> are:</p>\n\n<pre><code>g :: a -&gt; b\nf :: b -&gt; Int\n</code></pre>\n\n<p>And for clarity, we might as well mention that</p>\n\n<pre><code>f a ~ T (a -&gt; Int)\nf b ~ T (b -&gt; Int)\n</code></pre>\n\n<p>So we can fill in the <code>?</code> as follows:</p>\n\n<pre><code>instance Contravariant T where\n  contramap g (T f) = T (f . g)\n</code></pre>\n\n<p>To be super pedantic, you might rename <code>g</code> as <code>aToB</code>, and <code>f</code> as <code>bToInt</code>.</p>\n\n<pre><code>instance Contravariant T where\n  contramap aToB (T bToInt) = T (bToInt . aToB)\n</code></pre>\n\n<p>The reason you can write a <code>Contravariant</code> instance for <code>T a</code> boils down to the fact that <code>a</code> is in contravariant position in <code>T (a -&gt; Int)</code>. The best way to convince yourself that <code>T a</code> isn't a <code>Functor</code> is to try (and fail) to write the <code>Functor</code> instance yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 5, "last_activity_date": 1495582761, "last_edit_date": 1495582761, "creation_date": 1495474870, "answer_id": 44118992, "question_id": 44103758, "link": "https://stackoverflow.com/questions/44103758/showing-that-newtype-t-a-t-a-int-is-a-type-constructor-that-is-not-a-fu/44118992#44118992", "title": "Showing that `newtype T a = T (a -&gt; Int)` is a Type Constructor that is Not a Functor", "body": "<p>Here's another bit of perspective. As liminalisht showed, <code>T</code> is <code>Contravariant</code>. What can we tell about types that are both covariant and contravariant?</p>\n\n<pre><code>import Data.Void\n\n\nchange1, change1', change2 :: (Functor f, Contravariant f) =&gt; f a -&gt; f b\nchange1 = contramap (const ()) . fmap (const ())\nchange1' = (() &gt;$) . (() &lt;$)\nchange2 = fmap absurd . contramap absurd\n</code></pre>\n\n<p>The first two implementations are basically the same (<code>change1'</code> being an optimization of <code>change1</code>); each of them uses the fact that <code>()</code> is a \"terminal object\" of <strong>Hask</strong>. <code>change2</code> instead uses the fact that <code>Void</code> is an \"initial object\".</p>\n\n<p>Each of these functions replaces all the <code>a</code>s in <code>f a</code> with <code>b</code>s without knowing anything whatsoever about <code>a</code>, <code>b</code>, or the relationship between them, leaving everything else the same. It should probably be clear that this means <code>f a</code> doesn't really depend on <code>a</code>. That is, <code>f</code>'s parameter must be phantom. That is <em>not</em> the case for <code>T</code>, so it can't also be covariant.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 44104590, "answer_count": 3, "score": 8, "last_activity_date": 1495582761, "creation_date": 1495419898, "question_id": 44103758, "link": "https://stackoverflow.com/questions/44103758/showing-that-newtype-t-a-t-a-int-is-a-type-constructor-that-is-not-a-fu", "title": "Showing that `newtype T a = T (a -&gt; Int)` is a Type Constructor that is Not a Functor", "body": "<p>It's been claimed that <code>newtype T a = T (a -&gt; Int)</code> is a type constructor that is not a functor (but is a contravariant functor). How so? Or what is the contravariant functor (whence I assume it will be obvious why this can't be made a normal functor)?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1495383636, "post_id": 44099021, "comment_id": 75218633, "body": "Does <code>let f x = sortByM x input</code> work?"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1495383802, "creation_date": 1495383802, "answer_id": 44099154, "question_id": 44099021, "link": "https://stackoverflow.com/questions/44099021/how-can-i-break-up-a-haskell-statement-when-the-type-of-a-parameter-is-not-stati/44099154#44099154", "title": "How can I break up a Haskell statement when the type of a parameter is not static?", "body": "<p>Making some assumptions about what you want... there tends to be lots of options on code structure.  You can have a sum type (not a great solution here):</p>\n\n<pre><code>  ...\n  sortF &lt;- let f = flip sortByM input\n    in case a of\n        \"name\" -&gt; Left &lt;$&gt; f (return . id         :: FilePath -&gt; IO FilePath)\n        \"time\" -&gt; Right &lt;$&gt; f (getModificationTime :: FilePath -&gt; IO UTCTime)\n        _ -&gt;      Right &lt;$&gt; f (getModificationTime :: FilePath -&gt; IO UTCTime)\n  either print print sortF\n</code></pre>\n\n<p>Since the only thing you really know about a \"multi-typed\" <code>sortF</code> is that it is an instance of <code>Show</code> you can just call <code>show</code> and use <code>String</code>:</p>\n\n<pre><code>  ...\n  sortF &lt;- let f = flip sortByM input\n    in show &lt;$&gt; case a of\n        \"name\" -&gt; f (return . id         :: FilePath -&gt; IO FilePath)\n        \"time\" -&gt; f (getModificationTime :: FilePath -&gt; IO UTCTime)\n        _ -&gt;      f (getModificationTime :: FilePath -&gt; IO UTCTime)\n  putStrLn sortF\n</code></pre>\n\n<p>And you can use a more function-oriented approach in combination with unifying the type to <code>String</code>:</p>\n\n<pre><code>  ...\n  let op | a == \"name\" = return . show\n         | otherwise   = fmap show . getModificationTime\n      f x = sortByM x input\n  putStrLn =&lt;&lt; f =&lt;&lt; op\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1495420287, "post_id": 44099184, "comment_id": 75227691, "body": "Shouldn\u2019t it suffice to give <code>f</code> a type signature?"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1495455077, "post_id": 44099184, "comment_id": 75244288, "body": "That would work, but it also means tangling with the type variable scoping rules, which I didn&#39;t want to get into (because I barely understand them myself). In this case that wouldn&#39;t be a problem, but if the top level function was polymorphic and you wanted to use those variables in the type of &quot;f&quot; then it would get hairy."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1495463974, "post_id": 44099184, "comment_id": 75250730, "body": "<code>ScopedTypeVariables</code> should have been part of the language\u2026"}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 6, "last_activity_date": 1495383964, "creation_date": 1495383964, "answer_id": 44099184, "question_id": 44099021, "link": "https://stackoverflow.com/questions/44099021/how-can-i-break-up-a-haskell-statement-when-the-type-of-a-parameter-is-not-stati/44099184#44099184", "title": "How can I break up a Haskell statement when the type of a parameter is not static?", "body": "<p>You are running into the <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"noreferrer\">Dreaded Monomorphism Restriction</a>. Due to issues with optimisation and code generation, when GHC sees a value that doesn't have explicit arguments it will infer a monomorphic type for it rather than the more general polymorphic type you would expect.</p>\n\n<p>You can either disable the restriction using the <code>NoMonomorphismRestriction</code> pragma, or you can give <code>f</code> an explicit parameter:</p>\n\n<pre><code>sortF &lt;- let f xs = sortByM xs input in ...\n</code></pre>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 44099184, "answer_count": 2, "score": 4, "last_activity_date": 1495383964, "creation_date": 1495382950, "question_id": 44099021, "link": "https://stackoverflow.com/questions/44099021/how-can-i-break-up-a-haskell-statement-when-the-type-of-a-parameter-is-not-stati", "title": "How can I break up a Haskell statement when the type of a parameter is not static?", "body": "<p>This is a bit difficult to explain, but I've run into this situation a few times.</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>work :: String -&gt; IO ()\nwork a = do\n  input &lt;- lines &lt;$&gt; getContents\n  sortF &lt;- let f = flip sortByM input\n    in case a of\n        \"name\" -&gt; f (return . id         :: FilePath -&gt; IO FilePath)\n        \"time\" -&gt; f (getModificationTime :: FilePath -&gt; IO UTCTime)\n        _ -&gt;      f (getModificationTime :: FilePath -&gt; IO UTCTime)\n  print sortF\n\nsortByM :: (Monad m, Ord a) =&gt; (b-&gt; m a) -&gt; [b] -&gt; m [b]\nsortByM f x = do\n  x' &lt;- mapM f x\n  return $ fst &lt;$&gt; (sortBy (comparing snd) $ zip x x')\n</code></pre>\n\n<p>The above throws an error of:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018UTCTime\u2019 with \u2018[Char]\u2019\n  Expected type: String -&gt; IO FilePath\n    Actual type: FilePath -&gt; IO UTCTime\n\u2022 In the first argument of \u2018f\u2019, namely\n    \u2018(getModificationTime :: FilePath -&gt; IO UTCTime)\u2019\n  In the expression:\n    f (getModificationTime :: FilePath -&gt; IO UTCTime)\n  In a case alternative:\n      \"time\" -&gt; f (getModificationTime :: FilePath -&gt; IO UTCTime)\n</code></pre>\n\n<p>Which makes sense, but is there a way to somehow achieve the above? Otherwise I have to do the below, which feels less maintainable:</p>\n\n<pre><code>work :: String -&gt; IO ()\nwork a = do\n  input &lt;- lines &lt;$&gt; getContents\n  sortF &lt;- case a of\n        \"name\" -&gt; flip sortByM input (return . id         :: FilePath -&gt; IO FilePath)\n        \"time\" -&gt; flip sortByM input (getModificationTime :: FilePath -&gt; IO UTCTime)\n        _ -&gt;      flip sortByM input (getModificationTime :: FilePath -&gt; IO UTCTime)\n  print sortF\n\nsortByM :: (Monad m, Ord a) =&gt; (b-&gt; m a) -&gt; [b] -&gt; m [b]\nsortByM f x = do\n  x' &lt;- mapM f x\n  return $ fst &lt;$&gt; (sortBy (comparing snd) $ zip x x')\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495381665, "post_id": 44098625, "comment_id": 75217952, "body": "You can always type <code>:t cons</code> in ghci and see the result. By the way you can express it in a more concise manner: <code>cons = (:)</code> so it is the sane as, and has the same type as, <code>(:)</code> which is a data constructor of <code>[a]</code>."}, {"owner": {"reputation": 1284, "user_id": 5716739, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8407f6b40c17739302bec2c3b1a235b4?s=128&d=identicon&r=PG&f=1", "display_name": "August", "link": "https://stackoverflow.com/users/5716739/august"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495381740, "post_id": 44098625, "comment_id": 75217975, "body": "@n.m. Thank you for your input. I was more interested in what kind of type should be given to <code>cons</code> rather than the actual function itself"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495381998, "post_id": 44098625, "comment_id": 75218053, "body": "The type that can/should be given to a function is intimately connected to how that function is defined."}], "answers": [{"comments": [{"owner": {"reputation": 1284, "user_id": 5716739, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8407f6b40c17739302bec2c3b1a235b4?s=128&d=identicon&r=PG&f=1", "display_name": "August", "link": "https://stackoverflow.com/users/5716739/august"}, "edited": false, "score": 0, "creation_date": 1495381400, "post_id": 44098689, "comment_id": 75217855, "body": "Thank you for the answer."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 1, "last_activity_date": 1495381157, "creation_date": 1495381157, "answer_id": 44098689, "question_id": 44098625, "link": "https://stackoverflow.com/questions/44098625/haskell-general-type-of-function-pushing-element-to-a-list/44098689#44098689", "title": "Haskell: General type of function pushing element to a list", "body": "<p>Remember, <code>a</code> and <code>b</code> are potentially different types, and here you want to be able to add an <code>a</code> to the list.  So, you want both lists to be type <code>[a]</code>.</p>\n\n<pre><code>cons :: a -&gt; [a] -&gt; [a]\ncons = (:)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1284, "user_id": 5716739, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8407f6b40c17739302bec2c3b1a235b4?s=128&d=identicon&r=PG&f=1", "display_name": "August", "link": "https://stackoverflow.com/users/5716739/august"}, "edited": false, "score": 0, "creation_date": 1495381312, "post_id": 44098693, "comment_id": 75217827, "body": "Thank you, that is what I was looking for"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1495381384, "last_edit_date": 1495381384, "creation_date": 1495381180, "answer_id": 44098693, "question_id": 44098625, "link": "https://stackoverflow.com/questions/44098625/haskell-general-type-of-function-pushing-element-to-a-list/44098693#44098693", "title": "Haskell: General type of function pushing element to a list", "body": "<p>A list is defined as (pseudocode):</p>\n\n<pre><code>data [a] = [] | a : [a]\n</code></pre>\n\n<p>Therefore a list can only contain <strong>elements of the same type</strong>: either it is an empty list (<code>[]</code>) so it does not contain any elements, or it is a CONS (<code>:</code>) and then the head is of type <code>a</code> and so is its tail <code>[a]</code>.</p>\n\n<p>Therefore if you define:</p>\n\n<pre><code>cons x xs = x : xs\n</code></pre>\n\n<p>Haskell takes a look at the signature of the constructor: <code>a : [a]</code>. So it derives that <code>x</code> is an <code>a</code>, <code>xs</code> is an <code>[a]</code>, and <code>(x:xs)</code> is an <code>[a]</code> as well (the head of the <code>data</code> statement).</p>\n\n<p>As a result, the most general type signature of <code>cons</code> is:</p>\n\n<pre><code><b>cons :: a -&gt; [a] -&gt; [a]</b>\ncons x xs = x : xs</code></pre>\n\n<p>You cannot define a <code>cons</code> with <code>x :: a</code> and <code>xs :: [b]</code> (with <code>a</code> different from <code>b</code>) since in that case you invoke the constructor <code>(:) :: a -&gt; [a] -&gt; [a]</code> with conflicting types.</p>\n\n<p>In Haskell, you usually do not <em>have to write type signatures</em>. If you omit them, Haskell will fill in the most generic one. You can use <code>:t</code> in the <code>ghci</code> interactive shell to obtain the type of a function. Like:</p>\n\n<pre><code>Prelude&gt; let cons x xs = x : xs\nPrelude&gt; :t cons\ncons :: a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Finally note you do not need to define a <code>cons</code> function, you can simply use <code>(:)</code>:</p>\n\n<pre><code>cons :: a -&gt; [a] -&gt; [a]\ncons = (:)\n</code></pre>\n"}], "owner": {"reputation": 1284, "user_id": 5716739, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8407f6b40c17739302bec2c3b1a235b4?s=128&d=identicon&r=PG&f=1", "display_name": "August", "link": "https://stackoverflow.com/users/5716739/august"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 44098693, "answer_count": 2, "score": 0, "last_activity_date": 1495381384, "creation_date": 1495380760, "question_id": 44098625, "link": "https://stackoverflow.com/questions/44098625/haskell-general-type-of-function-pushing-element-to-a-list", "title": "Haskell: General type of function pushing element to a list", "body": "<p>Given a general function</p>\n\n<pre><code>cons x xs = x:xs\n</code></pre>\n\n<p>How would one give it a general type? I tried doing</p>\n\n<pre><code>cons:: a -&gt; [b] -&gt; [c]\n</code></pre>\n\n<p>But it does not seem to work</p>\n"}, {"tags": ["haskell", "types", "higher-order-functions"], "comments": [{"owner": {"reputation": 6152, "user_id": 821720, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/63dd7aa72ef41e3f211cd81ab573b541?s=128&d=identicon&r=PG", "display_name": "Mukesh Soni", "link": "https://stackoverflow.com/users/821720/mukesh-soni"}, "edited": false, "score": 0, "creation_date": 1495372991, "post_id": 44097362, "comment_id": 75215490, "body": "Parenthesis in the type declaration are used to tell that we are expecting a function as an argument (parenthesis have the highest precedence). In your example, if there were no parenthesis, it would be <code>a -&gt; b -&gt; a -&gt; b</code> which you can read as a function taking 3 arguments and returning a value of type b. Where as <code>(a -&gt; b) -&gt; a -&gt; b</code> would read as a function taking 2 arguments (a function and another value of type a, and returning a value of type b"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1495378651, "post_id": 44097362, "comment_id": 75217082, "body": "&quot;<code>a</code> and <code>b</code> are type variables which indicates that <code>a</code> and <code>b</code> <b><i>may be</i></b> of different types&quot;."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1495380562, "post_id": 44097362, "comment_id": 75217622, "body": "@WillNess That\u2019s correct. <code>(a-&gt;b) -&gt; (a-&gt;b)</code> is a higher order function, like <code>apply</code> that takes a function as its argument and returns a function that itself has type <code>(a-&gt;b)</code>. So, what is <code>apply f</code>? Why, it\u2019s a function that takes an argument and applies <code>f</code> to it, and <code>f</code> has type <code>a-&gt;b</code>. So <code>apply f</code> is a function from type <code>a</code> to type <code>b</code>. Just as the type signature of <code>apply</code> says! That example is a bit contrived, but <code>(.)</code> and <code>map</code> are only slightly more complicated and very useful."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1495378974, "post_id": 44097448, "comment_id": 75217166, "body": "the key thing is that &quot;function of type <code>(a -&gt; b) -&gt; a -&gt; b</code> is a function that takes as argument a function of type <code>a -&gt; b</code> and <i>perhaps later</i> another argument of type <code>a</code> in order to return a <code>b</code> type value <i>then</i>&quot; - so that while <code>apply f</code> hadn&#39;t yet received that <code>a</code> value, it is itself a function of type <code>a -&gt; b</code>. i.e. <code>apply f :: a -&gt; b</code>. That&#39;s why <code>(a -&gt; b) -&gt; a -&gt; b</code> and <code>(a -&gt; b) -&gt; (a -&gt; b)</code> are the same type."}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1495379279, "post_id": 44097448, "comment_id": 75217262, "body": "I agree! +1 I didn&#39;t want to explain this in too much detail because I thought understanding that a function can be passed as an argument was the main road block for OP; not partial application or currying, which OP can get familiar with at a later point. :-)"}], "tags": [], "owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "is_accepted": true, "score": 7, "last_activity_date": 1495373241, "creation_date": 1495373241, "answer_id": 44097448, "question_id": 44097362, "link": "https://stackoverflow.com/questions/44097362/haskell-struggle-understanding-types/44097448#44097448", "title": "Haskell - Struggle understanding types", "body": "<p>Whenever you see parenthesis in the type signature you can think of it as one block. So <code>(a -&gt; b) -&gt; a -&gt; b</code> is the same as <code>c -&gt; a -&gt; b</code> where <code>c</code> stands for <code>a -&gt; b</code>. <code>c</code> just happens to be a type which is a function itself.</p>\n\n<p>The same way your first example <code>Integer -&gt; (Integer -&gt; Integer)</code> was a function that takes an <code>Integer</code> and returns a function <code>Integer -&gt; Integer</code>; your function <code>(a -&gt; b) -&gt; a -&gt; b</code> is a function that takes as argument a function <code>a -&gt; b</code> and an argument <code>a</code> in order to return a <code>b</code>.</p>\n\n<p>In the case of this function <code>apply</code> it is simply function application. If <code>apply</code> is defined as <code>apply f x = f x</code> it simply passes argument <code>x</code> to the function <code>f</code>. By the way, this function already exists in the Prelude and is called <code>($)</code>.</p>\n"}], "owner": {"reputation": 27, "user_id": 6486746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8fd9738db73355bb1210c6e271bec3f?s=128&d=identicon&r=PG", "display_name": "user337258", "link": "https://stackoverflow.com/users/6486746/user337258"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 44097448, "answer_count": 1, "score": 2, "last_activity_date": 1495792210, "creation_date": 1495372718, "last_edit_date": 1495792210, "question_id": 44097362, "link": "https://stackoverflow.com/questions/44097362/haskell-struggle-understanding-types", "title": "Haskell - Struggle understanding types", "body": "<p>I am new to Haskell, but it was really fun until now. Currently I am working on understanding Types and Type Classes</p>\n\n<p>Example: <code>add :: Integer -&gt; Integer -&gt; Integer</code>. <code>-&gt;</code> is right associative which means the declaration is similar to <code>Integer -&gt; (Integer -&gt; Integer)</code>, so far so good. But what does <code>(a-&gt;b) -&gt; a -&gt; b</code> mean? Why do we use parenthesis suddenly? \nIn my textbook there is an example for this declaration with a function <code>apply::(a-&gt;b)-&gt; a-&gt;b</code> with the def. <code>apply f x = f x</code>. But I don't understand that, isn't <code>(a-&gt;b)</code> a single function?</p>\n\n<p>I know that a and b are Typevariables which indicates that a and b are of different Types.</p>\n"}, {"tags": ["haskell", "show", "trace"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1495400098, "post_id": 44097140, "comment_id": 75223599, "body": "Please don&#39;t edit answers into questions. If you have something to add to the existing answers, leave a comment to them or, if it is a different solution altogether, post it as a new answer (it is fine to answer your own questions). I have rolled back your edits -- here is <a href=\"http://stackoverflow.com/revisions/5c2a5320-46d9-4819-9c24-af15f377a533/view-source\">a link to the source</a>, in case you want to use them for something else."}], "answers": [{"tags": [], "owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "is_accepted": true, "score": 1, "last_activity_date": 1495372690, "last_edit_date": 1495372690, "creation_date": 1495372363, "answer_id": 44097293, "question_id": 44097140, "link": "https://stackoverflow.com/questions/44097140/when-using-ghci-haskell-trace-how-does-one-avoid-interleaving-output/44097293#44097293", "title": "When using GHCi Haskell trace, how does one avoid interleaving output?", "body": "<p>Well the reason those lines are interleaved is because the list is the actual return value of your <code>Main.init</code> function. To be able to see the trace you need to force execution of the <code>Main.init</code> function. You could do this by enforcing strictness (<code>seq</code>, <code>deepseq</code>), but I think the simplest way would be to simply use the result in a way that doesn't interleave intermediate results.</p>\n\n<p>If you just want the trace without interleaved data but you don't care about data at the end, how about using <code>sum</code> to use the list.</p>\n\n<p>I suggest you try in ghci:</p>\n\n\n\n<pre><code>\u03bb &gt; sum (Main.init [2,3,5,7])\n\n    init [2,3,5,7] = 2 : (init [3,5,7])\n\n    init [3,5,7] = 3 : (init [5,7])\n\n    init [5,7] = 5 : (init [7])\n\n    init [7] = []\n10\n</code></pre>\n\n<p><strong>Other method</strong>:</p>\n\n<p>Since trace outputs to <code>stderr</code> and not <code>stdout</code> you can split the output on the command line:</p>\n\n<pre><code>\u279c  ~ ghc temp.hs -e \"Main.init [2, 3, 5, 7]\" &gt; /dev/null\n\n    init [2,3,5,7] = 2 : (init [3,5,7])\n\n    init [3,5,7] = 3 : (init [5,7])\n\n    init [5,7] = 5 : (init [7])\n\n    init [7] = []\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 1, "last_activity_date": 1495372434, "creation_date": 1495372434, "answer_id": 44097303, "question_id": 44097140, "link": "https://stackoverflow.com/questions/44097140/when-using-ghci-haskell-trace-how-does-one-avoid-interleaving-output/44097303#44097303", "title": "When using GHCi Haskell trace, how does one avoid interleaving output?", "body": "<p>GHCi implicitly uses <code>print</code>, and being lazy, it prints elements of a list as it evaluates them. You can compose it with a function that forces the whole list first.</p>\n\n<pre><code>force :: [a] -&gt; [a]\nforce xs = go xs `seq` xs\n  where go [] = ()\n        go (x : xs) = x `seq` go xs\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; print . force $ init [2, 3, 5, 7]\n</code></pre>\n\n<hr>\n\n<p><code>force</code> also exists in a more general form in the deepseq library,\nand with it you can use <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#using-a-custom-interactive-printing-function\" rel=\"nofollow noreferrer\">-interactive-print</a> to set <code>print . force</code> to be the default printer.</p>\n"}], "owner": {"reputation": 37, "user_id": 8028266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df4a53c886b04901f81ccaaf3e16d65?s=128&d=identicon&r=PG&f=1", "display_name": "\u03c9-inconsistent", "link": "https://stackoverflow.com/users/8028266/%cf%89-inconsistent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 44097293, "answer_count": 2, "score": 1, "last_activity_date": 1495400088, "creation_date": 1495371456, "last_edit_date": 1495400088, "question_id": 44097140, "link": "https://stackoverflow.com/questions/44097140/when-using-ghci-haskell-trace-how-does-one-avoid-interleaving-output", "title": "When using GHCi Haskell trace, how does one avoid interleaving output?", "body": "<p>While using The Glorious Glasgow Haskell Compilation System, version 8.0.2, I'm trying to add trace information to the following script:</p>\n\n<pre><code>import Debug.Trace\ninit :: Show a =&gt; [a] -&gt; [a]\ninit l@(x:xs) | trace\n          (\n            if (length l) &lt; 2\n               then ( \"\\n\\tinit [\" ++ show x ++ \"] = []\" )\n               else ( \"\\n\\tinit \" ++ show l ++ \" = \" ++ show x ++ \" : (init \" ++ show xs ++ \")\" )\n          ) False = undefined\ninit [_] = []\ninit (x:xs) = x : (Main.init xs)\n</code></pre>\n\n<p>However, the output of the trace is interleaved with the output of evaluating the expression <code>Main.init [2,3,5,7]</code>, as shown below:</p>\n\n<pre><code>C:\\&gt;ghci my_script.hs\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( my_script.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; Main.init [2,3,5,7]\n\n        init [2,3,5,7] = 2 : (init [3,5,7])\n[2\n        init [3,5,7] = 3 : (init [5,7])\n,3\n        init [5,7] = 5 : (init [7])\n,5\n        init [7] = []\n]\n*Main&gt; :quit\nLeaving GHCi.\n</code></pre>\n\n<p>How would one cause the following four lines to be omitted from the output?</p>\n\n<pre><code>[2\n,3\n,5\n]\n</code></pre>\n\n<p>I have already tried using a couple of different variations of <code>:set -fno-print-bind-result</code> as shown at <a href=\"https://downloads.haskell.org/~ghc/6.8.1/docs/html/users_guide/interactive-evaluation.html\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/6.8.1/docs/html/users_guide/interactive-evaluation.html</a>, but to no avail.</p>\n"}, {"tags": ["haskell", "exception", "ghci"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1495370162, "post_id": 44096908, "comment_id": 75214534, "body": "Does it do this if you write them as functions outside of main?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1495415571, "post_id": 44096908, "comment_id": 75226781, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/26738392/non-exhaustive-pattern-in-function-in-ghci\">Non exhaustive pattern in function in GHCi</a>"}], "answers": [{"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495380016, "post_id": 44096950, "comment_id": 75217449, "body": "You can also indent both parts of the definition to the same level after <code>let</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1495370227, "creation_date": 1495370227, "answer_id": 44096950, "question_id": 44096908, "link": "https://stackoverflow.com/questions/44096908/non-exhaustive-patterns-in-function-defined-in-ghci/44096950#44096950", "title": "Non-exhaustive patterns in function defined in GHCi", "body": "<p>The problem is that you <strong>define <code>sieve</code> in two separate <code>let</code> statements</strong>. As a result the Haskell compiler thinks that you define <strong>two separate <code>sieve</code> functions</strong>. Therefore the first <code>sieve</code> lacks a <code>(_:_)</code> pattern and the latter the <code>[]</code> pattern.</p>\n\n<p>If you later use <code>sieve</code>, the Haskell compiler will link to the closest one, so the latter (as a result a call to <code>sieve</code>) in <code>let primes = sieve [2..g]</code> will only know of the <em>second</em> <code>sieve</code> definition (and will thus error on the end of the list).</p>\n\n<p>You can solve this by using the following <code>let</code> statement:</p>\n\n<pre><code>let { sieve [] = [] ; sieve (p:xs) = p : sieve [x | x &lt;- xs, x `mod` p /= 0] }\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7984871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e8ec6b3a36339d43c281417ed0f19f2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Tmr", "link": "https://stackoverflow.com/users/7984871/j-tmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 44096950, "answer_count": 1, "score": 4, "last_activity_date": 1495379635, "creation_date": 1495369978, "last_edit_date": 1495379635, "question_id": 44096908, "link": "https://stackoverflow.com/questions/44096908/non-exhaustive-patterns-in-function-defined-in-ghci", "title": "Non-exhaustive patterns in function defined in GHCi", "body": "<p>I'm trying to write a sieve of Erasthosthenes function that gives a User all Primes from 2 to his upper Limit. So I've written this code:</p>\n\n<pre><code>main = do\nputStrLn \"Upper Limit\"\ng &lt;- readLn\nlet sieve [] = []\nlet sieve (p:xs) = p : sieve [x | x &lt;- xs, x `mod` p /= 0]\nlet primes = sieve [2..g]\nprint primes\n</code></pre>\n\n<p>The Code compiles and is giving me the right solution but I'm getting this exception at the end of the solution:\n*** Exception: Non-exhaustive patterns in function sieve\nSo I've checked what patterns aren't matched.</p>\n\n<pre><code>warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for `sieve': Patterns not matched: (_:_)\n\nwarning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for `sieve': Patterns not matched: []\n</code></pre>\n\n<p>Wich I don't understand since I've given <code>let sieve [] = []</code> \nAnd I thought _ in Haskell means any variable so what does the pattern (<em>:</em>) mean?\nAny help would be appreciated.</p>\n"}, {"tags": ["haskell", "reactive-banana"], "answers": [{"comments": [{"owner": {"reputation": 2319, "user_id": 2211273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d55ba6b0f08aed750502866c7e7ee77?s=128&d=identicon&r=PG", "display_name": "Kritzefitz", "link": "https://stackoverflow.com/users/2211273/kritzefitz"}, "edited": false, "score": 0, "creation_date": 1495453511, "post_id": 44100813, "comment_id": 75243218, "body": "Thanks for pointing this out. It doesn&#39;t help me solve the actual my problem though, so I edited my answer to clarify what that actually is."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 2319, "user_id": 2211273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d55ba6b0f08aed750502866c7e7ee77?s=128&d=identicon&r=PG", "display_name": "Kritzefitz", "link": "https://stackoverflow.com/users/2211273/kritzefitz"}, "edited": false, "score": 1, "creation_date": 1495744953, "post_id": 44100813, "comment_id": 75392848, "body": "Oh, I see, I like the new example. However, it also shows that discussing the semantics of <code>Behavior</code> is important. For instance, I imagine that the the dimensions of the grid are taken from two slider widgets. What happens if the user grabs the slider, moves it a bit, but not enough to change its value. Question: Will all the inputs in the grid be created anew, so that any values that the user has put in before be <i>lost</i>?"}, {"owner": {"reputation": 2319, "user_id": 2211273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d55ba6b0f08aed750502866c7e7ee77?s=128&d=identicon&r=PG", "display_name": "Kritzefitz", "link": "https://stackoverflow.com/users/2211273/kritzefitz"}, "edited": false, "score": 1, "creation_date": 1495795492, "post_id": 44100813, "comment_id": 75411910, "body": "I think you meant to use <code>plainChanges</code> in your first example, otherwise I don&#39;t see how it typechecks."}, {"owner": {"reputation": 2319, "user_id": 2211273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d55ba6b0f08aed750502866c7e7ee77?s=128&d=identicon&r=PG", "display_name": "Kritzefitz", "link": "https://stackoverflow.com/users/2211273/kritzefitz"}, "edited": false, "score": 0, "creation_date": 1495795746, "post_id": 44100813, "comment_id": 75412059, "body": "Normally I aim to re-use previously created inputs, so their current values aren&#39;t lost. However, this only works with <code>accumE</code> or <code>accumB</code>, which need <code>Event</code>s as input. I think the examples you have given in your edit solve this quite nicely. A combinator <code>executeLater :: Event (Future (MomentIO a)) -&gt; Event a</code> would be handy for working with <code>changes</code> without resorting to <code>plainChanges</code>."}], "tags": [], "owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "is_accepted": true, "score": 4, "last_activity_date": 1496000613, "last_edit_date": 1496000613, "creation_date": 1495394077, "answer_id": 44100813, "question_id": 44096071, "link": "https://stackoverflow.com/questions/44096071/dynamic-inputs-from-a-behavior-in-reactive-banana/44100813#44100813", "title": "Dynamic inputs from a Behavior in reactive-banana", "body": "<p>Well, one reason why this may not work is that it, perhaps, should not work. There is a litmus test for determining whether modeling the situation with a <code>Behavior</code> makes sense: What happens if <code>Behavior InputSpecification</code> were a genuinely <em>continuous</em> function? Say, you had a continuous frequency range (e.g. for radio stations) and each frequency would be associated to a new input that has to be set up. If you were to do a continuous frequency sweep, then you would have to create and discard infinitely many inputs, which is not possible. This is an indication that there is a deeper reason behind <code>Event InputSpecification</code> being the right type.</p>\n\n<p>More generally, the <code>Behavior</code> type encapsulates two important invariants:</p>\n\n<ol>\n<li>It does not depend on a sample rate.</li>\n<li>You cannot detect when or how often it \"changes\". For instance, if you have an <code>Event</code> whose occurrences all have the same value <code>[(0 seconds, x), (2 seconds, x), ..]</code>, then this invariant says that applying <code>stepper</code> to this will yield a <code>Behavior</code> that is <em>indistinguishable</em> from <code>pure x</code>.</li>\n</ol>\n\n<p>For pragmatic reasons, invariant 2 can be circumvented with <code>changes</code> function. You are allowed to use it if you feel that it \"morally preserves the invariant\". For instance, you can use it to display a text value on the screen only when the Behavior changes; this is more efficient than, say, polling at a fixed sample rate. Since the visual end result is the same for either Behavior mentioned above, you morally preserve the invariant in this case.</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>It looks like you need more explicit control about when to update. In this case, you can use an explicit event <code>e :: Event ()</code> that keeps track of when the inputs should be updated. Then, you can use the following combination to update the inputs only when this event triggers</p>\n\n<pre><code>e2 &lt;- plainChanges (imposeChanges b e)\nexecute $ updateDynamicInputs &lt;$&gt; e2\n...\n</code></pre>\n\n<p>(There should be a pure alternative for this, I will look into this.)</p>\n\n<p>Alternatively, you can replicate a \"Behavior with notification for updates\" machinery by hand, for instance introducing a type</p>\n\n<pre><code>data Dynamic a = D (Behavior a) (Event a)\n</code></pre>\n\n<p>and implement <code>Applicative</code> etc instances for this. This is a bit heavyweight but may be just what you need.</p>\n"}], "owner": {"reputation": 2319, "user_id": 2211273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d55ba6b0f08aed750502866c7e7ee77?s=128&d=identicon&r=PG", "display_name": "Kritzefitz", "link": "https://stackoverflow.com/users/2211273/kritzefitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 1, "accepted_answer_id": 44100813, "answer_count": 1, "score": 2, "last_activity_date": 1496000613, "creation_date": 1495364464, "last_edit_date": 1495453410, "question_id": 44096071, "link": "https://stackoverflow.com/questions/44096071/dynamic-inputs-from-a-behavior-in-reactive-banana", "title": "Dynamic inputs from a Behavior in reactive-banana", "body": "<p>When I want to work with dynamic inputs in reactive-banana, I usually envision a system that works roughly like this:</p>\n\n<pre><code>data InputSpecification -- Some data structure that specifies the inputs\n                        -- which should be active right now\n\ndata MyInterestingData -- Some data that is relevant to my business logic\n                       -- and is gathered through the dynamic inputs.\n\nemptyData :: MyInterestingData\nemptyData = -- Some initial MyInterestingData\n\nsetupDynamicInputs :: Event (InputSpecification) -&gt; MomentIO (Behavior MyInterestingData)\nsetupDynamicInputs specE = do\n    newBehavior &lt;- execute $ updateDynamicInputs &lt;$&gt; specE\n    switchB emptyData newBehavior\n\nupdateDynamicInputs :: InputSpecification -&gt; MomentIO (Behavior MyInterestingData)\nupdateDynamicInputs = -- Here the dynamic inputs are set up according to\n                      -- the specification and set up to update the returned\n                      -- Behavior\n</code></pre>\n\n<p>This works quite nicely and the inputs are updated whenever a new <code>InputSpecification</code> is fired.</p>\n\n<p>A problem I often stumble across is that my <code>InputSpecification</code> doesn't come in an <code>Event</code> but rather as a <code>Behavior InputSpecification</code> (probably because I needed <code>Applicative</code> combinators to construct it). The above approach doesn't work then, as <code>execute</code> and <code>switchB</code> can't be used on <code>Behaviors</code>.</p>\n\n<p>As a simple solution, I could use this function from the <a href=\"http://hackage.haskell.org/package/reactive-banana-1.1.0.1/docs/Reactive-Banana-Frameworks.html\" rel=\"nofollow noreferrer\">reactive-banana documentation</a>:</p>\n\n<blockquote>\n<pre><code>plainChanges :: Behavior a -&gt; MomentIO (Event a)\nplainChanges b = do\n    (e, handle) &lt;- newEvent\n    eb &lt;- changes b\n    reactimate' $ (fmap handle) &lt;$&gt; eb\n    return e\n</code></pre>\n</blockquote>\n\n<p>Then I could just use <code>setupDynamicInputs</code> on the <code>Event</code> obtained from <code>plainChanges</code>, but:</p>\n\n<blockquote>\n  <p>However, this approach is not recommended[...]</p>\n</blockquote>\n\n<p>So I'm a bit reluctant to use this approach.</p>\n\n<p>Is there a \"cleaner\" approach to keep my inputs in sync with the specification, when the specification is kept in a <code>Behavior</code>?</p>\n\n<h1>Edit</h1>\n\n<p>As Heinrich Apfelmus pointed out in his answer, the solution to my original question is not to use a <code>Behavior</code> for updating the <code>InputSpecification</code>. While I can understand the reasoning behind that, it doesn't solve the problem I'm having, so I will try to explain why I wanted to use a <code>Behavior</code> here.</p>\n\n<p>Updating the input through an <code>Event</code> is easy as long as the input is specified by a single input. As an example, if the dynamic inputs consists of a sequence of inputs, the specification for those inputs would just be an non-negative integer that denotes how many inputs should be shown.</p>\n\n<p>It gets more complex once the input specification is obtained via more than one input. For example, let's say our <code>InputSpecification</code> becomes <code>(Word, Word)</code> and specifies a grid of input with the given dimensions. If I obtain those dimensions via two different inputs, I would have to combine two <code>Event Word</code>s into one <code>Event (Word, Word)</code>, which isn't really a trivial task for <code>Event</code>s as they don't have an <code>Applicative</code> instance like <code>Behavior</code>s do. That's why I usually like to use <code>Behavior</code>s in such cases, but as discussed before they don't get you further when you actually want to create the inputs. So if <code>Behavior</code>s aren't the right solution here and <code>Event</code>s tend to get tediously hard (or impossible in the worst cases) to combine, what is the right solution for this problem?</p>\n"}, {"tags": ["haskell", "pandoc", "bibtex", "static-site", "hakyll"], "comments": [{"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1495361772, "post_id": 44092482, "comment_id": 75212146, "body": "You probably can use <a href=\"https://github.com/jgm/pandoc-citeproc\" rel=\"nofollow noreferrer\">pandoc-citeproc</a> to parse the .bib file into YAML or JSON and generate HTML from that..."}], "answers": [{"tags": [], "owner": {"reputation": 17042, "user_id": 4132844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08a948c9edbd32b99844191afb050667?s=128&d=identicon&r=PG&f=1", "display_name": "scoa", "link": "https://stackoverflow.com/users/4132844/scoa"}, "is_accepted": true, "score": 4, "last_activity_date": 1495439415, "creation_date": 1495439415, "answer_id": 44107447, "question_id": 44092482, "link": "https://stackoverflow.com/questions/44092482/list-of-all-bibtex-entries-in-a-bib-file-to-generate-hakyll-publication-list/44107447#44107447", "title": "List of all BibTex entries in a .bib file, to generate Hakyll publication list?", "body": "<p>You could use <a href=\"http://pandoc.org/MANUAL.html#citations\" rel=\"nofollow noreferrer\">this trick from the pandoc's manual</a>, the equivalent of biblatex's <code>\\nocite{*}</code>:</p>\n\n<blockquote>\n  <p>It is possible to create a bibliography with all the citations,\n  whether or not they appear in the document, by using a wildcard:</p>\n\n<pre><code>---\nnocite: |\n  @*\n---\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 7230, "user_id": 788337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wiVpx.png?s=128&g=1", "display_name": "jmite", "link": "https://stackoverflow.com/users/788337/jmite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 0, "accepted_answer_id": 44107447, "answer_count": 1, "score": 4, "last_activity_date": 1495439415, "creation_date": 1495332197, "question_id": 44092482, "link": "https://stackoverflow.com/questions/44092482/list-of-all-bibtex-entries-in-a-bib-file-to-generate-hakyll-publication-list", "title": "List of all BibTex entries in a .bib file, to generate Hakyll publication list?", "body": "<p>I'm making a personal website with Hakyll, and I'd like to list my publications.</p>\n\n<p>I've found <a href=\"https://hackage.haskell.org/package/hakyll-4.9.5.1/docs/Hakyll-Web-Pandoc-Biblio.html#t:Biblio\" rel=\"nofollow noreferrer\">this module</a> and <a href=\"https://github.com/mcmtroffaes/homepage/blob/master/posts/2015-01-09-hakyll-and-bibtex.markdown\" rel=\"nofollow noreferrer\">this guide</a> for how to print the references from a markdown document at the bottom.</p>\n\n<p>The problem with this is, it assumes you've got some document, where you cite all the things you want printed.</p>\n\n<p>What I want is to <em>generate</em> a document that lists <em>every</em> document my .bib file. In particular:</p>\n\n<ul>\n<li>I don't want to have to manually write the bibtex name of each publication I want listed</li>\n<li>I just want the \"references\" section printed, i.e. there's no place in the document where the publication is referenced, they're just listed at the end.</li>\n</ul>\n\n<p>Is it possible to get this information from the <code>Hakyll.Web.Pandoc.Biblio</code> module? Or do I need to separately parse the .bib file to get this? And once I do, how would I make go about generating this page with Hakyll?</p>\n"}, {"tags": ["haskell", "tuples", "typeclass", "functor"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1495327486, "post_id": 44092032, "comment_id": 75205818, "body": "Tangential note: &quot;type annotation container&quot; suggests something that happens at type level; simply &quot;annotation container&quot; works better as a description. (It might also be worth emphasising that it is just a pair, and &quot;annotation container&quot; is just a different way of thinking about it, that is, as a value with something else attached.)"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 2, "creation_date": 1495328100, "post_id": 44092032, "comment_id": 75205907, "body": "In ghci, <code>:info (,)</code> will tell you the source of instances for the pair type."}, {"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 0, "creation_date": 1495358624, "post_id": 44092032, "comment_id": 75211360, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13442544/why-does-the-2-tuple-functor-instance-only-apply-the-function-to-the-second-elem\">Why does the 2-tuple Functor instance only apply the function to the second element?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1495329260, "last_edit_date": 1495541905, "creation_date": 1495326846, "answer_id": 44092083, "question_id": 44092032, "link": "https://stackoverflow.com/questions/44092032/where-is-the-functor-implementation-of-e-the-type-annotation-container/44092083#44092083", "title": "Where is the Functor implementation of `((,) e)`, the type annotation container?", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/src/GHC.Base.html#line-648\" rel=\"nofollow noreferrer\">Here it is</a>:</p>\n\n<pre><code>instance Functor ((,) a) where\n    fmap f (x,y) = (x, f y)\n</code></pre>\n\n<p>In general, a convenient way to find instances is looking at the instances list in either <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Functor.html#t:Functor\" rel=\"nofollow noreferrer\">the documentation entry for the class</a> or the one for the data type (in almost all cases you'll find the instance in at least one of them) and following the source link.</p>\n\n<p>As Li-yao Xia notes in <a href=\"https://stackoverflow.com/questions/44092032/where-is-the-functor-implementation-of-e-the-type-annotation-container#comment75205907_44092032\">a comment</a>, another route is using <code>:i (,)</code> in GHCi, which will list all instances in scope for <code>(,)</code> along with the module they are defined. (In this specific case, that happens to be <code>GHC.Base</code>, which is not directly accessible through <a href=\"https://hackage.haskell.org/package/base-4.9.1.0\" rel=\"nofollow noreferrer\">the entry page for the <em>base</em> docs</a>, though it can be found in <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/src/\" rel=\"nofollow noreferrer\">the source tree listing</a> as well as through source links scattered across the docs, such as the one in the list of instances in <code>Data.Functor</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 0, "last_activity_date": 1495327742, "last_edit_date": 1495327742, "creation_date": 1495327112, "answer_id": 44092108, "question_id": 44092032, "link": "https://stackoverflow.com/questions/44092032/where-is-the-functor-implementation-of-e-the-type-annotation-container/44092108#44092108", "title": "Where is the Functor implementation of `((,) e)`, the type annotation container?", "body": "<p>It\u2019s declared in <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad.html#control.i:ic:Functor:Functor:37\" rel=\"nofollow noreferrer\">Control.Monad</a> (among other places).  The documentation includes <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/src/GHC.Base.html#line-648\" rel=\"nofollow noreferrer\">a link to the source</a> for GHC.  Other implementations may vary.</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1495357239, "creation_date": 1495357239, "answer_id": 44095015, "question_id": 44092032, "link": "https://stackoverflow.com/questions/44092032/where-is-the-functor-implementation-of-e-the-type-annotation-container/44095015#44095015", "title": "Where is the Functor implementation of `((,) e)`, the type annotation container?", "body": "<p><code>((,) e)</code> also has a very \"containerish\" comonad instance in <a href=\"http://hackage.haskell.org/package/comonad-5.0.1/docs/Control-Comonad.html\" rel=\"nofollow noreferrer\"><code>Control.Comonad</code></a>:</p>\n\n<ul>\n<li><code>extract :: (e, a) -&gt; a</code> discards the context and returns the value. I sometimes use this instead of <code>snd</code>.</li>\n<li><code>duplicate :: (e, a) -&gt; (e, (e, a))</code> puts both the value and context in the value.</li>\n<li><code>extend :: ((e, a) -&gt; b) -&gt; (e, a) -&gt; (e, b)</code> transforms the value taking the context into account.</li>\n</ul>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1495357239, "creation_date": 1495326093, "last_edit_date": 1495326566, "question_id": 44092032, "link": "https://stackoverflow.com/questions/44092032/where-is-the-functor-implementation-of-e-the-type-annotation-container", "title": "Where is the Functor implementation of `((,) e)`, the type annotation container?", "body": "<p>The <a href=\"https://wiki.haskell.org/Typeclassopedia\" rel=\"nofollow noreferrer\">Typeclassopedia</a> lists <code>((,) e)</code> as an instance of <code>Functor</code> and describes it as follows.</p>\n\n<blockquote>\n  <p><code>((,) e)</code> represents a container which holds an \u201cannotation\u201d of type e along with the actual value it holds. It might be clearer to write it as <code>(e,)</code>, by analogy with an operator section like <code>(1+)</code>, but that syntax is not allowed in types (although it is allowed in expressions with the <code>TupleSections</code> extension enabled). However, you can certainly think of it as <code>(e,)</code>.</p>\n</blockquote>\n\n<p>I am looking at the implementations of various typeclasses to improve my understanding. Currently looking at Functor implementations but cannot seem to find some of them, such as <code>((,) e)</code> and <code>((-&gt;) e)</code>. Where is the functor instance for <code>((,) e)</code> implemented?</p>\n"}, {"tags": ["list", "haskell", "filter"], "answers": [{"comments": [{"owner": {"reputation": 100, "user_id": 3910308, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9070aa8c67f70376b553786e6c7762f0?s=128&d=identicon&r=PG&f=1", "display_name": "Shadol", "link": "https://stackoverflow.com/users/3910308/shadol"}, "edited": false, "score": 0, "creation_date": 1495319243, "post_id": 44091354, "comment_id": 75204366, "body": "Thanks! I knew this question was easy for someone with a little more experience. I did know about anonymous functions but I didn&#39;t know about &quot;snd&quot;. I tried accessing it with a combination of (!!) but that didn&#39;t work. I&#39;ll accept your answer as soon as I can :)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 100, "user_id": 3910308, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9070aa8c67f70376b553786e6c7762f0?s=128&d=identicon&r=PG&f=1", "display_name": "Shadol", "link": "https://stackoverflow.com/users/3910308/shadol"}, "edited": false, "score": 0, "creation_date": 1495319386, "post_id": 44091354, "comment_id": 75204405, "body": "@Shadol you don&#39;t really need to know about <code>snd</code> either, because pattern-matching is usually preferrable. It definitely is preferrable in this case."}, {"owner": {"reputation": 100, "user_id": 3910308, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9070aa8c67f70376b553786e6c7762f0?s=128&d=identicon&r=PG&f=1", "display_name": "Shadol", "link": "https://stackoverflow.com/users/3910308/shadol"}, "edited": false, "score": 0, "creation_date": 1495319480, "post_id": 44091354, "comment_id": 75204423, "body": "It even worked with my self created filter function :D"}, {"owner": {"reputation": 100, "user_id": 3910308, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9070aa8c67f70376b553786e6c7762f0?s=128&d=identicon&r=PG&f=1", "display_name": "Shadol", "link": "https://stackoverflow.com/users/3910308/shadol"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1495319686, "post_id": 44091354, "comment_id": 75204454, "body": "@leftaroundabout if by &quot;pattern-matching&quot; you refer to something like my Ackermann Function I created here: <code>ackerF m n  \t| m == 0 = n+1 \t| m &gt; 0 &amp;&amp; n == 0 = ackerF (m-1) 1 \t| m &gt; 0 &amp;&amp; n &gt; 0 = ackerF (m-1) (ackerF m (n-1))</code>                                    Then I still don&#39;t know how to access the element I want with just that knowledge."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 100, "user_id": 3910308, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9070aa8c67f70376b553786e6c7762f0?s=128&d=identicon&r=PG&f=1", "display_name": "Shadol", "link": "https://stackoverflow.com/users/3910308/shadol"}, "edited": false, "score": 0, "creation_date": 1495321079, "post_id": 44091354, "comment_id": 75204720, "body": "@Shadol: I mean, to get at the second element a tuple you can just match the pattern <code>(_,f)</code>. Like, by writing that as the function argument, i.e. in this case <code>\\(_, f) -&gt; f &lt; 18.5 || f &gt; 25</code> as shown in the answer."}, {"owner": {"reputation": 100, "user_id": 3910308, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9070aa8c67f70376b553786e6c7762f0?s=128&d=identicon&r=PG&f=1", "display_name": "Shadol", "link": "https://stackoverflow.com/users/3910308/shadol"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1495322841, "post_id": 44091354, "comment_id": 75205057, "body": "@leftaroundabout Now I get it, thanks for that explanation. Really helpful to get some insight into how things are done in Haskell :)"}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 5, "last_activity_date": 1495318933, "creation_date": 1495318933, "answer_id": 44091354, "question_id": 44091329, "link": "https://stackoverflow.com/questions/44091329/filter-for-element-in-a-list-of-lists-in-haskell/44091354#44091354", "title": "Filter for element in a list of lists in Haskell", "body": "<p>You can do something like this:</p>\n\n<pre><code>Prelude&gt; filter (\\p -&gt; (snd p) &lt; 18.5 || (snd p) &gt; 25) [(1, 2.3), (1, 20.0)]\n[(1,2.3)]\n</code></pre>\n\n<p>The <a href=\"https://wiki.haskell.org/Anonymous_function\" rel=\"noreferrer\">lambda function</a> passed to <code>filter</code>, namely </p>\n\n<pre><code>(\\p -&gt; (snd p) &lt; 18.5 || (snd p) &gt; 25)\n</code></pre>\n\n<p>says that for every <code>p</code>, the second element of <code>p</code> must be less than 18.5 or over 25.</p>\n\n<hr>\n\n<p>Alternatively, you could write it like this</p>\n\n<pre><code>Prelude&gt; filter (\\(_, f) -&gt; f &lt; 18.5 || f &gt; 25) [(1, 2.3), (1, 20.0)]\n[(1,2.3)]\n</code></pre>\n\n<p>Here the function says that for any pair whose first value doesn't matter and the second one is <code>f</code>, <code>f</code> must be less than 18.5 or over 25.</p>\n"}, {"tags": [], "owner": {"reputation": 1102, "user_id": 2974922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fcd187a430dfd497db690eedc5af14?s=128&d=identicon&r=PG&f=1", "display_name": "nucleon", "link": "https://stackoverflow.com/users/2974922/nucleon"}, "is_accepted": false, "score": 1, "last_activity_date": 1495319918, "last_edit_date": 1495319918, "creation_date": 1495319588, "answer_id": 44091419, "question_id": 44091329, "link": "https://stackoverflow.com/questions/44091329/filter-for-element-in-a-list-of-lists-in-haskell/44091419#44091419", "title": "Filter for element in a list of lists in Haskell", "body": "<p>A compact version using point free style would be</p>\n\n<pre><code> filter ((&gt;18.5).snd) listexpression\n</code></pre>\n\n<p>This uses the function composition operator <code>.</code>, which reads as: First apply the <code>snd</code> function to a tuple from the list to extract the 2nd value, then apply the comparison to 18.5 to this value.</p>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 2801663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dad8e2d30c14d11bdc0f7ef167cce51?s=128&d=identicon&r=PG", "display_name": "SnowOnion", "link": "https://stackoverflow.com/users/2801663/snowonion"}, "is_accepted": false, "score": 2, "last_activity_date": 1495421219, "last_edit_date": 1495535495, "creation_date": 1495348281, "answer_id": 44093861, "question_id": 44091329, "link": "https://stackoverflow.com/questions/44091329/filter-for-element-in-a-list-of-lists-in-haskell/44093861#44093861", "title": "Filter for element in a list of lists in Haskell", "body": "<p>Glad to see  <a href=\"https://stackoverflow.com/a/44091354/2801663\">Ami Tavory's answer</a> solved your problem.</p>\n\n<p>But under that answer, you commented:</p>\n\n<blockquote>\n  <p>I tried accessing it with a combination of (!!) but that didn't work.</p>\n</blockquote>\n\n<p>With the insight of a teaching assistant [:D], I guess you confused <code>list</code> with <code>tuple</code> in Haskell.</p>\n\n<p><code>zip</code> returns a <code>list</code> of <code>tuple</code>, whereas <code>(!!)</code> take a <code>list</code> as (the first) argument (hence <code>(!!1)</code> take a single <code>list</code> argument), so <code>(!!1)</code> can't be applied to elements of the <code>list</code> returned by <code>zip</code>, which are of type <code>tuple</code>.</p>\n\n<pre><code>Prelude&gt; :t zip\nzip :: [a] -&gt; [b] -&gt; [(a, b)]\nPrelude&gt; :t (!!)\n(!!) :: [a] -&gt; Int -&gt; a\nPrelude&gt; :t (!!1)\n(!!1) :: [a] -&gt; a\n</code></pre>\n\n<p>And you've known that <code>fst</code> and <code>snd</code> are applied to <code>tuple</code>.</p>\n\n<pre><code>Prelude&gt; :t fst\nfst :: (a, b) -&gt; a\nPrelude&gt; :t snd\nsnd :: (a, b) -&gt; b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1495360455, "last_edit_date": 1495360455, "creation_date": 1495353494, "answer_id": 44094502, "question_id": 44091329, "link": "https://stackoverflow.com/questions/44091329/filter-for-element-in-a-list-of-lists-in-haskell/44094502#44094502", "title": "Filter for element in a list of lists in Haskell", "body": "<p>Just for a variety and some additional information which won't bite...</p>\n\n<p>In Haskell <a href=\"https://en.wikibooks.org/wiki/Haskell/Understanding_monads/List\" rel=\"nofollow noreferrer\">the list type is an instance of Monad class</a>. So a list operation like <code>filter</code> can simply be implemented by a monadic bind operator.</p>\n\n<pre><code>*Main&gt; [(1,2.3),(3,21.2),(5,17.1),(4,24.4)] &gt;&gt;= \\t -&gt; if snd t &lt; 25 &amp;&amp; snd t &gt; 18.5 then [t] else []\n[(3,21.2),(4,24.4)]\n</code></pre>\n\n<p>Monad is all about handling the contained data in a sequential manner. In the list monad the contained data is the value within the list itself. So the bind operator can be very handy to access to contained values (tuples) of the monadic value (the list of tuples) in a sequential manner.</p>\n\n<pre><code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>The type signature of the monadic bind operator states that it takes a monad type value <code>m a</code> as the first argument (the list of tuples here) and a function as the second argument which takes a pure value and returns a monadic value (takes a tuple and returns a tuple in a list or an empty list in this case).</p>\n\n<pre><code>\\t -&gt; if snd t &lt; 25 &amp;&amp; snd t &gt; 18.5 then [t] else []\n</code></pre>\n\n<p>It's critical to understand how and why the list items are applied one by one to the provided function. An entire list is one monadic value and the contained values those accessed by the bind operator are passed to the provided <code>a -&gt; m b</code> (take a pure value and return monadic value) type function. So all of the list items those applied to this function become a monadic value (<code>[t]</code> if condition satisfies or <code>[]</code> if it fails), are then concatenated by the bind operator to form one monadic return value (in this case a list of tuples those satisfy the condition which is implemented in the lambda function).</p>\n\n<p>This monadic operation can also be implemented with the <code>do</code> notation</p>\n\n<pre><code>do\nt &lt;- [(1,2.3),(3,21.2),(5,17.1),(4,24.4)]\nif snd t &lt; 25 &amp;&amp; snd t &gt; 18.5 then return t else []\n\n[(3,21.2),(4,24.4)]\n</code></pre>\n\n<p>Of course this terribly resembles the list comprehensions which is in fact a syntactical sugar to the monadic list operations. So lets implement it for a final time by using the list comprehensions.</p>\n\n<pre><code>*Main&gt; [t | t &lt;- [(1,2.3),(3,21.2),(5,17.1),(4,24.4)], snd t &lt; 25 &amp;&amp; snd t &gt; 18.5]\n[(3,21.2),(4,24.4)]\n</code></pre>\n"}], "owner": {"reputation": 100, "user_id": 3910308, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9070aa8c67f70376b553786e6c7762f0?s=128&d=identicon&r=PG&f=1", "display_name": "Shadol", "link": "https://stackoverflow.com/users/3910308/shadol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2291, "favorite_count": 0, "accepted_answer_id": 44091354, "answer_count": 4, "score": 1, "last_activity_date": 1495421219, "creation_date": 1495318719, "question_id": 44091329, "link": "https://stackoverflow.com/questions/44091329/filter-for-element-in-a-list-of-lists-in-haskell", "title": "Filter for element in a list of lists in Haskell", "body": "<p>I built a list of this structure: </p>\n\n<pre><code>[(Interger, Double)]\n</code></pre>\n\n<p>The List was created by using a zip over a list of Integers and a list of Doubles of exactly the same size.</p>\n\n<p>Now I want to filter the list for Doubles that are either &lt;18.5 or >25. The problem I have is I can't access the Doubles to use them in the filter function. </p>\n\n<p>It's probably easy but I'm a bloody noob in this language. I googled around a lot and read some other threads but I didn't find an answer.</p>\n\n<p>I got:</p>\n\n<pre><code>filter (&lt;18.5) listexpression\n</code></pre>\n\n<p>So what I'm struggling with is that listexpression. It's easy if it's a list of single values. I could filter before zipping but then I can't connect the data from  the filtered list to the other unfiltered List anymore.</p>\n\n<p>Edit: I forgot to mention. It's a worksheet. We were asked to build filter and map functions ourselves and are not allowed to use any additions to the basic Haskell. Meaning no imports are allowed.</p>\n"}, {"tags": ["haskell", "archlinux", "xmonad"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1495315729, "post_id": 44090826, "comment_id": 75203558, "body": "Well, what do you think how the compiler parses this code? (Draw parentheses) Hint: the solution on SuperUser that you&#39;ve linked doesn&#39;t have the error."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1495316142, "creation_date": 1495316142, "answer_id": 44091031, "question_id": 44090826, "link": "https://stackoverflow.com/questions/44090826/haskell-curly-brace-parse-error/44091031#44091031", "title": "Haskell curly brace parse error", "body": "<p>Indent everything after the <code>xmonad $ defaultConfig</code> line further to the right (it seems some of the indentation was lost when you pasted <a href=\"https://beginners-guide-to-xmonad.readthedocs.io/configure_xmonadhs.html\" rel=\"nofollow noreferrer\">the example</a>):</p>\n\n<pre><code>main = do\n    xmproc &lt;- spawnPipe \"xmobar\"\n\n    xmonad $ defaultConfig\n        { manageHook = manageDocks &lt;+&gt; manageHook defaultConfig\n        , layoutHook = avoidStruts  $  layoutHook defaultConfig\n        , logHook = dynamicLogWithPP xmobarPP\n                        { ppOutput = hPutStrLn xmproc\n                        , ppTitle = xmobarColor \"green\" \"\" . shorten 50\n                        }\n        , modMask = mod4Mask     -- Rebind Mod to the Windows key\n        } `additionalKeys`\n        [ ((mod4Mask .|. shiftMask, xK_z), spawn \"xscreensaver-command -lock; xset dpms force off\")\n        , ((controlMask, xK_Print), spawn \"sleep 0.2; scrot -s\")\n        , ((0, xK_Print), spawn \"scrot\")\n        ]\n</code></pre>\n\n<p>Lines at the \"parent\" indentation level in a do-block are parsed as separate statements, which is not appropriate here.</p>\n"}], "owner": {"reputation": 226, "user_id": 7525350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8684620dc1923d467f336e062c5e90c1?s=128&d=identicon&r=PG&f=1", "display_name": "tillyboy", "link": "https://stackoverflow.com/users/7525350/tillyboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 44091031, "answer_count": 1, "score": 0, "last_activity_date": 1495316212, "creation_date": 1495314591, "last_edit_date": 1495316212, "question_id": 44090826, "link": "https://stackoverflow.com/questions/44090826/haskell-curly-brace-parse-error", "title": "Haskell curly brace parse error", "body": "<p>Running Manjaro and trying to get XMonad to work I encountered a <code>parse error on input '{'</code> with the following <code>xmonad.hs</code>:</p>\n\n<pre><code>import XMonad\nimport XMonad.Hooks.DynamicLog\nimport XMonad.Hooks.ManageDocks\nimport XMonad.Util.Run(spawnPipe)\nimport XMonad.Util.EZConfig(additionalKeys)\nimport System.IO\n\nmain = do\n  xmproc &lt;- spawnPipe \"xmobar\"\n\n  xmonad $ defaultConfig\n  { manageHook = manageDocks &lt;+&gt; manageHook defaultConfig\n  , layoutHook = avoidStruts  $  layoutHook defaultConfig\n  , logHook = dynamicLogWithPP xmobarPP\n          { ppOutput = hPutStrLn xmproc\n          , pptitle = xmobarColor \"green\" \"\" . shorten 50\n          }\n  , modMask = mod4Mask   -- rebind Mod to the windows key\n  } `additionalKeys`\n  [ ((mod4Mask .|. shiftMask, xK_z), spawn \"xscreensaver-command -lock; xset dmps force off\")\n  , ((controlMask, xK_Print), spawn \"sleep 0.2; scrot -s\")\n  , ((0, xK_Print), spawn \"scrot\")\n  ]\n</code></pre>\n\n<p>I have found this <a href=\"https://superuser.com/questions/470067/what-is-wrong-in-this-xmonad-configuration\">solution on su.sx</a> and took my xmonad.hs from <a href=\"https://beginners-guide-to-xmonad.readthedocs.io/configure_xmonadhs.html\" rel=\"nofollow noreferrer\">readthedocs.io</a>.\nFor getting started I would like to use that config file, I do not know however how to apply the solution to this. If somebody proficient could explain why that error appears and how to fix it, I'd really appreciate it since I just recently started with Haskell and it's really bending my mind to an unknown extent... :D</p>\n"}, {"tags": ["haskell", "haskeline"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495352653, "post_id": 44089181, "comment_id": 75209968, "body": "It looks as if there are saved in the history file in the opposite order. Can you check that file? I wonder whether this is a bug of the library."}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1495303119, "creation_date": 1495303119, "question_id": 44089181, "link": "https://stackoverflow.com/questions/44089181/haskeline-history-in-the-wrong-order", "title": "Haskeline history in the wrong order", "body": "<p>I'm using Haskeline to make a CLI interface for a program. </p>\n\n<p>I use the basic configuration of Haskeline to save the commands stroked in a file.</p>\n\n<pre><code>mySettings = defaultSettings {\n                               autoAddHistory = True\n                             , historyFile = Just \"hist.txt\"\n                             }\n</code></pre>\n\n<p>When I am in the command line interface, I can use the upper arrow to call the previous command. Things are working fine with the same behaviour than BASH or GHCi.</p>\n\n<p>The file is correctly written and contain the commands in the right order (the first to the last)</p>\n\n<p>After restarting my program I use the up arrow to call the last command stroked, and I get .... the first ! And each time I press the upper arrow, I get the next command (instead of the previous).</p>\n\n<p>I'm surpised to have a the opposite behaviour when I restart my application.</p>\n\n<p><strong>Is it possible to reverse the order the commands are read in the file?</strong></p>\n\n<p><strong>Is it possible to recall the commands in the right order after restarting a Haskeline CLI program ?</strong></p>\n"}, {"tags": ["javascript", "haskell", "websocket"], "answers": [{"tags": [], "owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "is_accepted": true, "score": 2, "last_activity_date": 1495316733, "creation_date": 1495316733, "answer_id": 44091097, "question_id": 44087446, "link": "https://stackoverflow.com/questions/44087446/capturing-refresh-on-haskell-websockets-example-server/44091097#44091097", "title": "Capturing refresh on haskell websockets example server?", "body": "<blockquote>\n  <p>How would you capture the refresh-event...</p>\n</blockquote>\n\n<p>There isn't really such a thing as a refresh event to detect (I would love to be proved wrong in this!)</p>\n\n<blockquote>\n  <p>... and keep the user connected...</p>\n</blockquote>\n\n<p>The refresh, or rather, the leaving of the page before loading it again, causes the websocket to disconnect, and (especially if this is the only page on the site that is open), there isn't really much you can do about it.</p>\n\n<p>So the only thing that can be done, is have some sort of auto-reconnect the next time the page loads. A solution that allows this is one where..</p>\n\n<ul>\n<li>when the name is initially entered, the name is saved somewhere in the browser;</li>\n<li>when the page reloads, it checks for a previously saved name;</li>\n<li>and if it's found, it connects again using that name.</li>\n</ul>\n\n<p>Local storage is one such place to save this, as in the below example, modified from <a href=\"https://github.com/jaspervdj/websockets/tree/master/example\" rel=\"nofollow noreferrer\">https://github.com/jaspervdj/websockets/tree/master/example</a> to save/retrieve the name from local storage.</p>\n\n<pre><code>$(document).ready(function () {\n    var savedUser = sessionStorage.getItem(\"rejoin-user\");\n    if (savedUser) {\n        joinChat(savedUser);\n    }\n\n    $('#join-form').submit(function () {\n        joinChat($('#user').val())\n    });\n\n    function joinChat(user) {\n        sessionStorage.setItem(\"rejoin-user\", user);\n        $('#warnings').html('');\n        var ws = createChatSocket();\n\n        ws.onopen = function() {\n            ws.send('Hi! I am ' + user);\n        };\n\n        ws.onmessage = function(event) {\n            if(event.data.match('^Welcome! Users: ')) {\n                /* Calculate the list of initial users */\n                var str = event.data.replace(/^Welcome! Users: /, '');\n                if(str != \"\") {\n                    users = str.split(\", \");\n                    refreshUsers();\n                }\n\n                $('#join-section').hide();\n                $('#chat-section').show();\n                $('#users-section').show();\n\n                ws.onmessage = onMessage;\n\n                $('#message-form').submit(function () {\n                    var text = $('#text').val();\n                    ws.send(text);\n                    $('#text').val('');\n                    return false;\n                });\n            } else {\n                $('#warnings').append(event.data);\n                ws.close();\n            }\n        };\n\n        $('#join').append('Connecting...');\n\n        return false;\n    };\n});\n</code></pre>\n\n<blockquote>\n  <p>... Is this doable only on server side or does the client require modifications as well?</p>\n</blockquote>\n\n<p>It definitely needs something done in the client to auto-reconnect. The bare bones version above needs no changes to the server, but if you wanted something fancier, like having the cases of initial connect and auto reconnect handled/shown differently somehow, then the server might need to be modified.</p>\n"}], "owner": {"reputation": 799, "user_id": 1964881, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/bVDPU.png?s=128&g=1", "display_name": "Gspia", "link": "https://stackoverflow.com/users/1964881/gspia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 44091097, "answer_count": 1, "score": 1, "last_activity_date": 1495316796, "creation_date": 1495292819, "last_edit_date": 1495316796, "question_id": 44087446, "link": "https://stackoverflow.com/questions/44087446/capturing-refresh-on-haskell-websockets-example-server", "title": "Capturing refresh on haskell websockets example server?", "body": "<p>The websockets server <a href=\"https://github.com/jaspervdj/websockets/tree/master/example\" rel=\"nofollow noreferrer\">example</a> works as expected. On browser refresh (e.g. S-F5 with chrome), the websocket disconnects, still working as expected. After refresh, the user has to give name again to connect to the server.</p>\n\n<p>How would you capture the refresh-event and keep the user connected? E.g.\nIs this doable only on server side or does the client require modifications as well? Haskell examples or links to such would be nice as well as hints on how to do this!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1495290676, "post_id": 44086778, "comment_id": 75196201, "body": "Do you need the <code>do</code> notation when you already use <code>&gt;&gt;=</code> operator?"}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1495294568, "post_id": 44086778, "comment_id": 75197404, "body": "You&#39;re correct it&#39;s not needed."}], "answers": [{"tags": [], "owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "is_accepted": true, "score": 7, "last_activity_date": 1495314014, "last_edit_date": 1495542393, "creation_date": 1495291712, "answer_id": 44087266, "question_id": 44086778, "link": "https://stackoverflow.com/questions/44086778/haskell-get-directories-in-directory/44087266#44087266", "title": "Haskell get directories in directory", "body": "<p>It looks like you are using the package <a href=\"https://hackage.haskell.org/package/system-filepath-0.4.13.4\" rel=\"nofollow noreferrer\">system-filepath</a> which is deprecated, how about using the <a href=\"https://hackage.haskell.org/package/filepath-1.4.1.2\" rel=\"nofollow noreferrer\">filepath</a> package instead:</p>\n\n\n\n<pre><code>import           Control.Monad    (filterM)\nimport           System.Directory (doesDirectoryExist, listDirectory)\nimport           System.FilePath  ((&lt;/&gt;))\n\ngetDirectories :: FilePath -&gt; IO [FilePath]\ngetDirectories filePath = do\n  allFiles &lt;- listDirectory filePath\n  filterM (doesDirectoryExist . (filePath &lt;/&gt;)) allFiles\n</code></pre>\n\n<p>Or if you prefer explicitly using the bind operator:</p>\n\n\n\n<pre><code>import           Control.Monad    (filterM)\nimport           System.Directory (doesDirectoryExist, listDirectory)\nimport           System.FilePath  ((&lt;/&gt;))\n\ngetDirectories :: FilePath -&gt; IO [FilePath]\ngetDirectories filePath = listDirectory filePath\n                      &gt;&gt;= filterM (doesDirectoryExist . (filePath &lt;/&gt;))\n</code></pre>\n\n<p><strong>NOTE</strong>: Your version of the function will return the input filepath prepended to every output directory in the list. While this might be what you want, the version of <code>getDirectories</code> I am giving you may be more general as it behaves exactly like <code>listDirectory</code> and simply prunes the files/executables.</p>\n\n<p><strong>EDIT</strong>: Changed the import from <code>System.FilePath.Posix</code> to <code>System.FilePath</code> for true platform independence. Thanks to <a href=\"https://stackoverflow.com/questions/44086778/haskell-get-directories-in-directory/44087266#comment75202698_44087313\">Justin Raymond</a> for the suggestion.</p>\n"}, {"comments": [{"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1495292721, "post_id": 44087313, "comment_id": 75196858, "body": "The example with <code>getCurrentDirectory</code> should work, however the other one won&#39;t. <code>getDirectoryContents</code> gives you the content in relative filepaths not absolute!"}, {"owner": {"reputation": 3023, "user_id": 1691145, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b6744a17b41f3b0e5c7554a43a04094?s=128&d=identicon&r=PG", "display_name": "Justin Raymond", "link": "https://stackoverflow.com/users/1691145/justin-raymond"}, "reply_to_user": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1495301602, "post_id": 44087313, "comment_id": 75199540, "body": "@basil-henry fixed"}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1495307952, "post_id": 44087313, "comment_id": 75201408, "body": "Well you are now missing the path separator &quot;/&quot; or &quot;\\&quot; (on Windows). In my solution I use <code>(&lt;&#47;&gt;)</code> from the <code>filepath</code> package to do the platform dependent appending of the path."}, {"owner": {"reputation": 3023, "user_id": 1691145, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b6744a17b41f3b0e5c7554a43a04094?s=128&d=identicon&r=PG", "display_name": "Justin Raymond", "link": "https://stackoverflow.com/users/1691145/justin-raymond"}, "reply_to_user": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 1, "creation_date": 1495312637, "post_id": 44087313, "comment_id": 75202698, "body": "you just pass it as an argument. <code>foo&#47;</code> instead of <code>foo</code>. bfd. and if you want to get pedantic, you should import <code>System.FilePath</code> instead of <code>System.FilePath.Posix</code> for true platform independence."}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 1, "creation_date": 1495313196, "post_id": 44087313, "comment_id": 75202874, "body": "Fair enough! :)"}], "tags": [], "owner": {"reputation": 3023, "user_id": 1691145, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b6744a17b41f3b0e5c7554a43a04094?s=128&d=identicon&r=PG", "display_name": "Justin Raymond", "link": "https://stackoverflow.com/users/1691145/justin-raymond"}, "is_accepted": false, "score": 3, "last_activity_date": 1495301583, "last_edit_date": 1495301583, "creation_date": 1495292010, "answer_id": 44087313, "question_id": 44086778, "link": "https://stackoverflow.com/questions/44086778/haskell-get-directories-in-directory/44087313#44087313", "title": "Haskell get directories in directory", "body": "<p>All you need is <code>System.Directory</code>.</p>\n\n<pre><code>import Control.Monad (filterM)\nimport System.Directory (doesDirectoryExist, getCurrentDirectory, getDirectoryContents)\n\nlistDirs :: IO [FilePath]\nlistDirs = getCurrentDirectory &gt;&gt;= getDirectoryContents &gt;&gt;= filterM doesDirectoryExist\n</code></pre>\n\n<p>If you want to pass the filepath as argument, just doen't use <code>getCurrentDirectory</code>.</p>\n\n<pre><code>import Control.Monad (filterM)\nimport System.Directory (doesDirectoryExist, getCurrentDirectory)\n\nlistDirs :: FilePath -&gt; IO [FilePath]\nlistDirs path = getDirectoryContents path &gt;&gt;= filterM (doesDirectoryExist . (++) path)\n</code></pre>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "accepted_answer_id": 44087266, "answer_count": 2, "score": 2, "last_activity_date": 1495314014, "creation_date": 1495288826, "question_id": 44086778, "link": "https://stackoverflow.com/questions/44086778/haskell-get-directories-in-directory", "title": "Haskell get directories in directory", "body": "<p>How can I get a list of directories that are in a directory?</p>\n\n<p>I've come up with the below, but I'm hoping there is a more elegant way:</p>\n\n<pre><code>import System.Directory\nimport qualified Filesystem.Path as FsP\nimport Filesystem.Path.CurrentOS\nimport Control.Monad\n\ngetDirectories :: Prelude.FilePath -&gt; IO [Prelude.FilePath]\ngetDirectories x = do\n  listDirectory x\n  &gt;&gt;= (return . fmap decodeString)\n  &gt;&gt;= return . fmap (FsP.append (decodeString x))\n  &gt;&gt;= (return . fmap encodeString)\n  &gt;&gt;= filterM doesDirectoryExist\n</code></pre>\n"}, {"tags": ["haskell", "collatz"], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1495267423, "post_id": 44083406, "comment_id": 75189762, "body": "That doesn&#39;t compute a running maximum."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1495267777, "post_id": 44083406, "comment_id": 75189833, "body": "@melpomene I added the running maximum, but I&#39;m unsure about what the OP actually needs. Their wording is a bit unclear to me at the end."}, {"owner": {"reputation": 165, "user_id": 5456966, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8dc04bf934c404853fcf447efe2dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "ols", "link": "https://stackoverflow.com/users/5456966/ols"}, "edited": false, "score": 1, "creation_date": 1495267790, "post_id": 44083406, "comment_id": 75189836, "body": "Thanks. But I do not want to print all the results. Only the lengths that are higher than the &quot;current&quot; maximum length."}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1495284865, "post_id": 44083406, "comment_id": 75194415, "body": "The type signature for <code>loop</code> that keeps track of the running maximum looks wrong. You are missing the <code>prevMax</code> argument type. Also <code>nextMax</code> is misspelt on the last line of that function."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 1, "creation_date": 1495288533, "post_id": 44083406, "comment_id": 75195512, "body": "@basile-henry Thanks, should be fixed now."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1495288497, "last_edit_date": 1495288497, "creation_date": 1495267271, "answer_id": 44083406, "question_id": 44083250, "link": "https://stackoverflow.com/questions/44083250/finding-long-collatz-sequences-in-haskell/44083406#44083406", "title": "Finding long Collatz sequences in Haskell", "body": "<p>Use <code>map</code> and an infinite range</p>\n\n<pre><code>main = print $ map (collatzLength 1) [1,3..]\n</code></pre>\n\n<p>or use explicit recursion</p>\n\n<pre><code>main :: IO ()\nmain = loop 1\n\nloop :: Int -&gt; IO ()\nloop n = do\n   print (collatzLength 1 n)\n   loop (n+2)\n</code></pre>\n\n<p>The latter approach lets you have a finer control on the loop.</p>\n\n<p>Note that every loop computes the sequence number from scratch, without exploiting previously computed results. For a more efficient approach, look up <a href=\"https://en.wikipedia.org/wiki/Memoization\" rel=\"nofollow noreferrer\">memoization</a> (not to be confused with \"memorization\"). Such techniques allow the program to \"remember\" the result of previously computed recursive calls, so that new calls do not have to recompute the same value.</p>\n\n<p>If you want to keep the maximum of all returned values, you can use</p>\n\n<pre><code>loop :: Int -&gt; Int -&gt; IO ()\nloop n prevMax = do\n   let m = collatzLength 1 n\n   putStrLn $ \"collatzLength 1 \" ++ show n ++ \" = \" ++ show m\n   let nextMax = max prevMax m\n   putStrLn $ \"current maximum = \" ++ show nextMax\n   loop (n+2) nextMax\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>But I do not want to print all the results. Only the lengths that are higher than the \"current\" maximum length.</p>\n</blockquote>\n\n<p>Then, generate a list of those \"higher\" points:</p>\n\n<pre><code>-- Assumes a list of positive numbers.\n-- Returns the list of those elements which are larger than all the\n-- previous ones.\nhighPoints :: [Int] -&gt; [Int]\nhighPoints xs = go 0 xs\n   where\n   go :: Int -&gt; [Int] -&gt; [Int]\n   go _          []     = []\n   go currentMax (n:ns) | n &gt; currentMax = n : go n ns\n                        | otherwise      = go currentMax ns\n\nmain :: IO ()\nmain = do \n   let collatzSequence :: [Int]\n       collatzSequence = map (collatzLength 1) [1,3..]\n   print (highPoints collatzSequence)\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 5456966, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8dc04bf934c404853fcf447efe2dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "ols", "link": "https://stackoverflow.com/users/5456966/ols"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 44083406, "answer_count": 1, "score": 1, "last_activity_date": 1495288497, "creation_date": 1495266162, "last_edit_date": 1495266284, "question_id": 44083250, "link": "https://stackoverflow.com/questions/44083250/finding-long-collatz-sequences-in-haskell", "title": "Finding long Collatz sequences in Haskell", "body": "<p>Today, I am playing with Collatz sequences in Haskell ...</p>\n\n<p>Here is my code:</p>\n\n<pre><code>collatzLength :: Int -&gt; Integer -&gt; Int\ncollatzLength count 1 = count\ncollatzLength count n = collatzLength (count+1) $ if n `mod` 2 == 0 then n `div` 2 else 3*n+1\n\nmain =\n    print (collatzLength 1 (10^10000 + 1))\n</code></pre>\n\n<p>What I would like to do is to iterate infinitely on [1, 3 ..]. Each time a new maximum Collatz length is found, I want to display it on screen, and continue. I have no idea on how to do that in Haskell, as I have to keep and update the maximum length value somewhere.</p>\n"}, {"tags": ["haskell", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 6174035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/200e4fdb0fe5b13ebc1998e51ac17bc6?s=128&d=identicon&r=PG&f=1", "display_name": "user181407", "link": "https://stackoverflow.com/users/6174035/user181407"}, "edited": false, "score": 0, "creation_date": 1495263299, "post_id": 44082862, "comment_id": 75188818, "body": "Sorry, I should have clarified that my <code>parseAB</code> works fine, it&#39;s <code>parseFoo</code> that I&#39;m having issues with."}, {"owner": {"reputation": 6152, "user_id": 821720, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/63dd7aa72ef41e3f211cd81ab573b541?s=128&d=identicon&r=PG", "display_name": "Mukesh Soni", "link": "https://stackoverflow.com/users/821720/mukesh-soni"}, "reply_to_user": {"reputation": 235, "user_id": 6174035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/200e4fdb0fe5b13ebc1998e51ac17bc6?s=128&d=identicon&r=PG&f=1", "display_name": "user181407", "link": "https://stackoverflow.com/users/6174035/user181407"}, "edited": false, "score": 0, "creation_date": 1495263335, "post_id": 44082862, "comment_id": 75188825, "body": "ah, got it. your grammar needs backtracking"}, {"owner": {"reputation": 6152, "user_id": 821720, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/63dd7aa72ef41e3f211cd81ab573b541?s=128&d=identicon&r=PG", "display_name": "Mukesh Soni", "link": "https://stackoverflow.com/users/821720/mukesh-soni"}, "reply_to_user": {"reputation": 235, "user_id": 6174035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/200e4fdb0fe5b13ebc1998e51ac17bc6?s=128&d=identicon&r=PG&f=1", "display_name": "user181407", "link": "https://stackoverflow.com/users/6174035/user181407"}, "edited": false, "score": 1, "creation_date": 1495263376, "post_id": 44082862, "comment_id": 75188840, "body": "you need to change grammar to AB | A and use <code>try</code> from parsec"}, {"owner": {"reputation": 235, "user_id": 6174035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/200e4fdb0fe5b13ebc1998e51ac17bc6?s=128&d=identicon&r=PG&f=1", "display_name": "user181407", "link": "https://stackoverflow.com/users/6174035/user181407"}, "edited": false, "score": 0, "creation_date": 1495264444, "post_id": 44082862, "comment_id": 75189090, "body": "this does work for my purposes, but now I&#39;m wondering how one might prevent the string &quot;a b c&quot; from parsing as <code>AB</code>?  Essentially, I want the parse to fail if there is remaining non-whitespace text."}, {"owner": {"reputation": 6152, "user_id": 821720, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/63dd7aa72ef41e3f211cd81ab573b541?s=128&d=identicon&r=PG", "display_name": "Mukesh Soni", "link": "https://stackoverflow.com/users/821720/mukesh-soni"}, "reply_to_user": {"reputation": 235, "user_id": 6174035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/200e4fdb0fe5b13ebc1998e51ac17bc6?s=128&d=identicon&r=PG&f=1", "display_name": "user181407", "link": "https://stackoverflow.com/users/6174035/user181407"}, "edited": false, "score": 0, "creation_date": 1495265133, "post_id": 44082862, "comment_id": 75189251, "body": "You can definitely do it in parsec but the bigger problem might be defining your grammar completely first"}], "tags": [], "owner": {"reputation": 6152, "user_id": 821720, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/63dd7aa72ef41e3f211cd81ab573b541?s=128&d=identicon&r=PG", "display_name": "Mukesh Soni", "link": "https://stackoverflow.com/users/821720/mukesh-soni"}, "is_accepted": true, "score": 3, "last_activity_date": 1495263952, "last_edit_date": 1495263952, "creation_date": 1495263165, "answer_id": 44082862, "question_id": 44082834, "link": "https://stackoverflow.com/questions/44082834/checking-if-the-remaining-input-is-whitespace-with-parsec/44082862#44082862", "title": "Checking if the remaining input is whitespace with parsec", "body": "<p>You need to change grammar to <code>AB | A</code> and use <code>try</code> from parsec, which gives lookahead capability to your parser.</p>\n\n<p>This should work</p>\n\n<pre><code>parseFoo = try Parse AB &lt;|&gt; parse A\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 6174035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/200e4fdb0fe5b13ebc1998e51ac17bc6?s=128&d=identicon&r=PG&f=1", "display_name": "user181407", "link": "https://stackoverflow.com/users/6174035/user181407"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 2, "accepted_answer_id": 44082862, "answer_count": 1, "score": 0, "last_activity_date": 1495263952, "creation_date": 1495262933, "last_edit_date": 1495263251, "question_id": 44082834, "link": "https://stackoverflow.com/questions/44082834/checking-if-the-remaining-input-is-whitespace-with-parsec", "title": "Checking if the remaining input is whitespace with parsec", "body": "<p>I'm trying out the parsec library and I'm not sure how to handle this basic task.</p>\n\n<p>Suppose I have the following:</p>\n\n<pre><code>data Foo = A | AB\n</code></pre>\n\n<p>and I want the string \"a\" to be parsed as <code>A</code> and \"a b\" <code>AB</code>.  If I just do this:</p>\n\n<pre><code>parseA :: parser Foo\nparseA = do\n           reserved \"a\"\n           return A\n\nparseAB :: parser Foo\nparseAB = do\n            reserved \"a\"\n            reserved \"b\"\n            return AB\n\nparseFoo :: parser Foo\nparseFoo =  parseA\n        &lt;|&gt; parseAB\n</code></pre>\n\n<p>then <code>parseFoo</code> will parse \"a b\" as <code>A</code> since <code>parseA</code> doesn't care that there is non-whitespace still left after consuming the 'a'.  How can this be fixed?</p>\n"}, {"tags": ["arrays", "haskell", "vector"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1495285721, "post_id": 44082787, "comment_id": 75194671, "body": "You probably want to use <code>V.Vector (U.Vector a)</code>. That still gives you most of the performance advantage of unboxed vectors, provided the inner vectors aren&#39;t very small. Alternatively, if the inner vectors are <i>always the same, small size</i>, use an unboxable fixed-size type, e.g. from the <a href=\"http://hackage.haskell.org/package/linear\" rel=\"nofollow noreferrer\">linear package</a>."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1495285982, "post_id": 44083643, "comment_id": 75194758, "body": "I wonder if it wouldn&#39;t be possible to define an <code>Unbox a =&gt; Unbox (U.Vector a)</code> instance, whose vectors would be based on one flat array of values and one array of start-indices for the inner vectors. That should give decent performance for pure operations."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1495288221, "post_id": 44083643, "comment_id": 75195400, "body": "@leftaroundabout That might be possible, I think. I am not familiar enough with the <code>Unboxed</code> implementation to estimate if that would work nicely. (For instance, I just realized that the <code>Unbox</code> class has actually no fields.)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1495288688, "post_id": 44083643, "comment_id": 75195557, "body": "<code>Unbox a</code> is basically a synonym for <code>(G.Vector U.Vector a, GM.MVector U.MVector a)</code>. What&#39;s needed is a definition of <code>basicUnsafeSlice</code> etc.. And as I said, it appears that the <a href=\"http://hackage.haskell.org/package/vector-0.12.0.1/docs/Data-Vector-Generic.html#t:Vector\" rel=\"nofollow noreferrer\"><code>Vector</code> interface</a> could be nicely defined with a flattened-regions approach. <a href=\"http://hackage.haskell.org/package/vector-0.12.0.1/docs/Data-Vector-Generic-Mutable-Base.html#t:MVector\" rel=\"nofollow noreferrer\"><code>MVector</code></a> is where it gets hairy."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1495268883, "creation_date": 1495268883, "answer_id": 44083643, "question_id": 44082787, "link": "https://stackoverflow.com/questions/44082787/how-to-nest-unboxed-vectors/44083643#44083643", "title": "How to nest unboxed vectors?", "body": "<p>Well, we can start following the suggestion given by the compiler:</p>\n\n<pre><code>&gt; :set -XFlexibleContexts\n</code></pre>\n\n<p>However:</p>\n\n<pre><code>&gt; U.fromList [U.fromList [1..5]]\n\n&lt;interactive&gt;:10:1: error:\n    \u2022 No instance for (U.Unbox (U.Vector a0))\n        arising from a use of \u2018print\u2019\n</code></pre>\n\n<p>The issue here is the you can't unbox a vector (even if it's of unboxed data). To unbox a data type, you need to describe the byte layout precisely, including its size. But a vector does not have a size. Consider e.g.</p>\n\n<pre><code>U.fromList [U.fromList [1..5], U.fromList [1..7]]\n</code></pre>\n\n<p>Even in C, this would require a <a href=\"https://en.wikipedia.org/wiki/Jagged_array\" rel=\"noreferrer\">\"jagged\" matrix</a>, usually represented with pointers (= boxing). </p>\n"}], "owner": {"reputation": 1487, "user_id": 3668541, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/ba66d28285a3e98b836178617d096b75?s=128&d=identicon&r=PG&f=1", "display_name": "haz", "link": "https://stackoverflow.com/users/3668541/haz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1495268883, "creation_date": 1495262647, "question_id": 44082787, "link": "https://stackoverflow.com/questions/44082787/how-to-nest-unboxed-vectors", "title": "How to nest unboxed vectors?", "body": "<p>This may be a pretty basic question, but I've searched around and I cannot seem to find the answer.</p>\n\n<p>I would like to represent a 2D list using unboxed Vectors. This is easily done with normal vectors:</p>\n\n<pre><code>&gt; import qualified Data.Vector as V\n&gt; V.fromList [V.fromList [1..5]]\n[[1,2,3,4,5]]\n</code></pre>\n\n<p>But if I try with unboxed vectors:</p>\n\n<pre><code>&gt; import qualified Data.Vector.Unboxed as U\n&gt; U.fromList [U.fromList [1..5]]\n</code></pre>\n\n<p>I get the following error:   </p>\n\n<pre><code>\u2022 Non type-variable argument\n    in the constraint: U.Unbox (U.Vector a)\n  (Use FlexibleContexts to permit this)\n\u2022 When checking the inferred type\n    it :: forall a.\n          (U.Unbox (U.Vector a), U.Unbox a, Num a, Enum a) =&gt;\n          U.Vector (U.Vector a)\n</code></pre>\n\n<p>I suspect it has something to do with this:</p>\n\n<pre><code>&gt; V.fromList [1..5]\n[1,2,3,4,5]\n</code></pre>\n\n<p>whereas</p>\n\n<pre><code>&gt; U.fromList [1..5]\n[1.0,2.0,3.0,4.0,5.0]\n</code></pre>\n\n<p>But I can't seem to understand how to avoid this.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell", "function-composition"], "comments": [{"owner": {"reputation": 20427, "user_id": 2570261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e71068b09fc539447a0cee3e99fc419d?s=128&d=identicon&r=PG&f=1", "display_name": "Haleemur Ali", "link": "https://stackoverflow.com/users/2570261/haleemur-ali"}, "edited": false, "score": 0, "creation_date": 1495250217, "post_id": 44081428, "comment_id": 75186561, "body": "yeah, in these cases, I prefer to use the infix notation rather than point free notation as well."}], "answers": [{"comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1495251104, "post_id": 44081548, "comment_id": 75186707, "body": "The type signature of <code>of&#39;</code> can be generalized quite a bit further."}, {"owner": {"reputation": 20427, "user_id": 2570261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e71068b09fc539447a0cee3e99fc419d?s=128&d=identicon&r=PG&f=1", "display_name": "Haleemur Ali", "link": "https://stackoverflow.com/users/2570261/haleemur-ali"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1495251289, "post_id": 44081548, "comment_id": 75186740, "body": "true, but lazily hitting 1 key (i.e. <code>a</code>) is very satisfying :P. updating answer soon."}], "tags": [], "owner": {"reputation": 20427, "user_id": 2570261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e71068b09fc539447a0cee3e99fc419d?s=128&d=identicon&r=PG&f=1", "display_name": "Haleemur Ali", "link": "https://stackoverflow.com/users/2570261/haleemur-ali"}, "is_accepted": true, "score": 4, "last_activity_date": 1495251632, "last_edit_date": 1495251632, "creation_date": 1495249977, "answer_id": 44081548, "question_id": 44081428, "link": "https://stackoverflow.com/questions/44081428/haskell-absolute-difference-using-function-compsition/44081548#44081548", "title": "Haskell Absolute Difference Using Function Compsition", "body": "<p>The info for <code>(.)</code></p>\n\n<pre><code>Prelude&gt; :i (.)\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c   -- Defined in \u2018GHC.Base\u2019\n</code></pre>\n\n<p>shows that it accepts functions with types <code>a -&gt; b</code> </p>\n\n<p>but <code>(-)</code> has the type</p>\n\n<pre><code>Prelude&gt; :i (-)\nclass Num a where\n  ...\n  (-) :: a -&gt; a -&gt; a\n  ...\n    -- Defined in \u2018GHC.Num\u2019\ninfixl 6 -\n</code></pre>\n\n<p>so, it is possible to define another composition operator that accepts functions having the above type, and then they can be composed.</p>\n\n<pre><code>of' :: (a -&gt; a) -&gt; (a -&gt; a -&gt; a) -&gt; a -&gt; a -&gt; a\nof' f g a b = f (g a b)\n\nabdiff = abs `of'` (-)\n\nabdiff 1 10\n9\n</code></pre>\n\n<p>note: as user @david-young points out correctly, <code>of'</code> can be more general by specifying the type as below:</p>\n\n<pre><code>of' :: (a -&gt; b) -&gt; (c -&gt; d -&gt; a) -&gt; c -&gt; d -&gt; b\nof' f g x y = f (g x y)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 1, "creation_date": 1495290663, "post_id": 44081977, "comment_id": 75196194, "body": "Why not variadic composition? ;) <a href=\"http://stackoverflow.com/questions/9656797/variadic-compose-function\" title=\"variadic compose function\">stackoverflow.com/questions/9656797/variadic-compose-functio&zwnj;&#8203;n</a>"}], "tags": [], "owner": {"reputation": 431, "user_id": 3042847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812bf59589551344aeae214de49f6a?s=128&d=identicon&r=PG&f=1", "display_name": "xgrommx", "link": "https://stackoverflow.com/users/3042847/xgrommx"}, "is_accepted": false, "score": 1, "last_activity_date": 1495255281, "creation_date": 1495255281, "answer_id": 44081977, "question_id": 44081428, "link": "https://stackoverflow.com/questions/44081428/haskell-absolute-difference-using-function-compsition/44081977#44081977", "title": "Haskell Absolute Difference Using Function Compsition", "body": "<p>Why not an owl operator?</p>\n\n<pre><code>(...) = (.) . (.)\nabsoluteDifference = abs ... (-)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1495257312, "last_edit_date": 1495542890, "creation_date": 1495257312, "answer_id": 44082190, "question_id": 44081428, "link": "https://stackoverflow.com/questions/44081428/haskell-absolute-difference-using-function-compsition/44082190#44082190", "title": "Haskell Absolute Difference Using Function Compsition", "body": "<p>Besides defining a custom operator, as suggested by <a href=\"https://stackoverflow.com/a/44081548/2751851\">Haleemur Ali's answer</a>, one alternative is making the definition less point-free by having a single-argument function as the second argument of <code>(.)</code>.</p>\n\n<pre><code>absoluteDifference a = abs . (-) a\n</code></pre>\n\n<p>Given how similar are the roles of the two arguments in your function, from a readability point of view it doesn't make much sense to write it in this way (though it might work better in other cases).</p>\n\n<p>Another possibility is making it more point-free (by having a function-modifying function as the first argument of <code>(-)</code>):</p>\n\n<pre><code>absoluteDifference = (abs .) . (-)\n</code></pre>\n\n<p>While this is a nice parlour trick, this sort of code with <code>(.)</code> sections is rather cryptic, and it is generally a good idea to avoid it in \"real\" code.</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1495287182, "creation_date": 1495287182, "answer_id": 44086505, "question_id": 44081428, "link": "https://stackoverflow.com/questions/44081428/haskell-absolute-difference-using-function-compsition/44086505#44086505", "title": "Haskell Absolute Difference Using Function Compsition", "body": "<p>Actually your answer is pretty close. All you need is to amend it as follows;</p>\n\n<pre><code>absDiff :: Num a =&gt; a -&gt; a -&gt; a\nabsDiff n = abs . (n-)\n\n*Main&gt; absDiff 3 9\n6\n*Main&gt; absDiff 9 3\n6\n</code></pre>\n"}], "owner": {"reputation": 719, "user_id": 893959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Y5izK.jpg?s=128&g=1", "display_name": "Adam Hammes", "link": "https://stackoverflow.com/users/893959/adam-hammes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 0, "accepted_answer_id": 44081548, "answer_count": 4, "score": 2, "last_activity_date": 1495287182, "creation_date": 1495248456, "last_edit_date": 1495250069, "question_id": 44081428, "link": "https://stackoverflow.com/questions/44081428/haskell-absolute-difference-using-function-compsition", "title": "Haskell Absolute Difference Using Function Compsition", "body": "<p>I am trying to define a function to find the absolute difference of two numbers, such that both</p>\n\n<pre><code>absoluteDifference 2 5\nabsoluteDifference 5 2\n</code></pre>\n\n<p>return <code>3</code>.</p>\n\n<p>Here is my best effort so far:</p>\n\n<pre><code>absoluteDifference :: Num a =&gt; a -&gt; a -&gt; a\nabsoluteDifference = abs . (-)\n</code></pre>\n\n<p>In my head, this applies <code>abs</code> to the result of subtracting two numbers. However, this gives me the error</p>\n\n<pre><code>* Could not deduce (Num (a -&gt; a)) arising from a use of `abs'\n    (maybe you haven't applied a function to enough arguments?)\n  from the context: Num a\n    bound by the type signature for:\n               absoluteDifference :: Num a =&gt; a -&gt; a -&gt; a\n    at C:\\Users\\Adam\\dev\\daily-programmer\\e311\\e311.hs:3:1-42\n* In the first argument of `(.)', namely `abs'\n  In the expression: abs . (-)\n  In an equation for `absoluteDifference':\n      absoluteDifference = abs . (-)\n</code></pre>\n\n<p>Which I don't understand. I could trivially implement the function as</p>\n\n<pre><code>absoluteDifference a b = abs $ a - b\n</code></pre>\n\n<p>but I want to know how to compose the functions.</p>\n"}, {"tags": ["windows", "haskell", "windbg", "ghc", "dump"], "answers": [{"comments": [{"owner": {"reputation": 5666, "user_id": 2392683, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/974ad1bd6b5fe25cadefb23460e2b5d0?s=128&d=identicon&r=PG", "display_name": "chwarr", "link": "https://stackoverflow.com/users/2392683/chwarr"}, "edited": false, "score": 0, "creation_date": 1495604675, "post_id": 44080710, "comment_id": 75316781, "body": "Reading between the lines, there&#39;s very little that can be gotten from the .dmp file I have. Would you agree?"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 5666, "user_id": 2392683, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/974ad1bd6b5fe25cadefb23460e2b5d0?s=128&d=identicon&r=PG", "display_name": "chwarr", "link": "https://stackoverflow.com/users/2392683/chwarr"}, "edited": false, "score": 0, "creation_date": 1495606684, "post_id": 44080710, "comment_id": 75317759, "body": "I honestly was hoping that someone else would be able to tell me something more useful.  Since you have the source code to the original program, maybe you can reproduce the bug inside your debugger?"}, {"owner": {"reputation": 5666, "user_id": 2392683, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/974ad1bd6b5fe25cadefb23460e2b5d0?s=128&d=identicon&r=PG", "display_name": "chwarr", "link": "https://stackoverflow.com/users/2392683/chwarr"}, "edited": false, "score": 1, "creation_date": 1495609223, "post_id": 44080710, "comment_id": 75319186, "body": "Makes sense. This time, I was lucky to get more details that allow me to reproduce. Next time, who knows... :-)"}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1495240448, "creation_date": 1495240448, "answer_id": 44080710, "question_id": 44080298, "link": "https://stackoverflow.com/questions/44080298/what-information-can-i-glean-from-a-dump-of-a-ghc-haskell-process-on-windows/44080710#44080710", "title": "What information can I glean from a dump of a ghc Haskell process on Windows?", "body": "<p>Some resources that might be useful.  (If there are more up-to-date ones, I would like to see them myself.)</p>\n\n<ul>\n<li><a href=\"https://ghc.haskell.org/trac/ghc/wiki/Debugging/CompiledCode\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/wiki/Debugging/CompiledCode</a></li>\n<li><a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/debug-info.html\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/debug-info.html</a></li>\n<li><a href=\"https://wiki.haskell.org/Debugging\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Debugging</a></li>\n</ul>\n\n<p>A few important nuggets:</p>\n\n<p>The runtime flag <code>+RTS -?</code> Will tell you what runtime flags add debugging information.  These will start with <code>+RTS -D</code>.  For example, <code>+RTS -DS</code> turns on a number of runtime assertions and sanity checks.</p>\n\n<p>The strange names you see are encoded in something called Z-encoding.  This is defined at <a href=\"https://ghc.haskell.org/trac/ghc/browser/ghc/compiler/cmm/CLabel.hs\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/browser/ghc/compiler/cmm/CLabel.hs</a>.</p>\n\n<p>If you can recompile the code with debugging symbols on and threading off, and still reproduce the bug, you can set breakpoints (or hit control-C) inside the debugger and backtrace from there.  You can examine memory with a command like <code>print/a 0x006eb0c0</code> (although you seem to be using 64-bit pointers).  You can see the assembly-language instruction that crashed with <code>disassemble</code>.</p>\n\n<p>You need to use the <code>-ddump-stg</code> compile flag to see what the variable names mean, because that is the last phase of the transformation before the program is assembled, and the variable names you see in the debugger correspond to the ones here.</p>\n\n<p>You can instrument the code with <code>Debug.Trace</code>.</p>\n"}], "owner": {"reputation": 5666, "user_id": 2392683, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/974ad1bd6b5fe25cadefb23460e2b5d0?s=128&d=identicon&r=PG", "display_name": "chwarr", "link": "https://stackoverflow.com/users/2392683/chwarr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1495240448, "creation_date": 1495236488, "question_id": 44080298, "link": "https://stackoverflow.com/questions/44080298/what-information-can-i-glean-from-a-dump-of-a-ghc-haskell-process-on-windows", "title": "What information can I glean from a dump of a ghc Haskell process on Windows?", "body": "<p>One of the users of my command line application has reported what appears to be an infinite loop. They helpfully took a dump of the process (via Task Manager) while it was in this state and sent it to me.</p>\n\n<p>I'm not sure how to get useful information out of this dump. My normal technique of <code>windbg -z the-dump-file.dmp -y releases\\v5.0.0 -i releases\\v5.0.0</code> doesn't give me much information that I know how to interpret.  Are there ghc-specific tools I can use instead?</p>\n\n<p>Moving forward, are the build options I should add or other things I should do to my release process to make this kind of post-mortem debugging more fruitful?</p>\n\n<p>Here's an example of the stacks that I'm seeing. Not much useful info, especially for someone used to debugging C/C++ code in WinDbg. :-)</p>\n\n<pre><code>   0  Id: 112dc.cc18 Suspend: 1 Teb: 00000000`00341000 Unfrozen\n*** ERROR: Module load completed but symbols could not be loaded for gbc.exe\n # Child-SP          RetAddr           Call Site\n00 00000000`01b7d8d0 00000000`01049f71 gbc+0xc5676e\n01 00000000`01b7d930 00000000`0104b5b4 gbc+0xc49f71\n02 00000000`01b7d9a0 00000000`0104c644 gbc+0xc4b5b4\n03 00000000`01b7da60 00000000`0104c1fa gbc+0xc4c644\n04 00000000`01b7dab0 00000000`0042545b gbc+0xc4c1fa\n05 00000000`01b7db30 00000000`011c40a0 gbc+0x2545b\n06 00000000`01b7db38 00000000`0535bee1 gbc+0xdc40a0\n07 00000000`01b7db40 00000000`010ffd80 0x535bee1\n08 00000000`01b7db48 00000000`0535bee1 gbc+0xcffd80\n09 00000000`01b7db50 00007ffb`3581fb01 0x535bee1\n0a 00000000`01b7db58 00007ffb`3581b850 imm32!?MSCTF_NULL_THUNK_DATA_DLB+0x2e9\n0b 00000000`01b7db60 00000000`00000010 imm32!CtfImmGetCompatibleKeyboardLayout\n0c 00000000`01b7db68 00000000`00000000 0x10\n\n   1  Id: 112dc.d324 Suspend: 1 Teb: 00000000`00349000 Unfrozen\n # Child-SP          RetAddr           Call Site\n00 00000000`05c2fc48 00007ffb`36441563 ntdll!ZwWaitForWorkViaWorkerFactory+0x14\n01 00000000`05c2fc50 00007ffb`34172774 ntdll!TppWorkerThread+0x293\n02 00000000`05c2ff60 00007ffb`36470d61 kernel32!BaseThreadInitThunk+0x14\n03 00000000`05c2ff90 00000000`00000000 ntdll!RtlUserThreadStart+0x21\n\n   2  Id: 112dc.11b48 Suspend: 1 Teb: 00000000`0034b000 Unfrozen\n # Child-SP          RetAddr           Call Site\n00 00000000`0642dd38 00007ffb`32f2988f ntdll!ZwWaitForSingleObject+0x14\n01 00000000`0642dd40 00000000`00ffca15 KERNELBASE!WaitForSingleObjectEx+0x9f\n02 00000000`0642dde0 00000000`00000000 gbc+0xbfca15\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack", "ghcjs"], "answers": [{"comments": [{"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1495299511, "post_id": 44080772, "comment_id": 75198938, "body": "just a note for future generations with the same question: do not run ghcjs-boot with --quick!  :)"}], "tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": true, "score": 3, "last_activity_date": 1495240930, "creation_date": 1495240930, "answer_id": 44080772, "question_id": 44079938, "link": "https://stackoverflow.com/questions/44079938/using-custom-ghcjs-fork-with-stack/44080772#44080772", "title": "Using custom ghcjs fork with stack", "body": "<p>It expects the output of \"cabal sdist\" / \"stack sdist\" run after building and booting your copy of ghcjs</p>\n"}], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "accepted_answer_id": 44080772, "answer_count": 1, "score": 3, "last_activity_date": 1495240930, "creation_date": 1495233641, "question_id": 44079938, "link": "https://stackoverflow.com/questions/44079938/using-custom-ghcjs-fork-with-stack", "title": "Using custom ghcjs fork with stack", "body": "<p>I'm testing some of my own patches to ghcjs, and I was wondering how I can package it up to use with stack's fields, which seem to expect something like:</p>\n\n<pre><code>setup-info:\n  ghcjs:\n    source:\n      ghcjs-0.2.1.9007019_ghc-8.0.1:\n           url: http://ghcjs.tolysz.org/ghc-8.0-2017-02-05-lts-7.19-9007019.tar.gz\n           sha1: d2cfc25f9cda32a25a87d9af68891b2186ee52f9\n</code></pre>\n\n<p>However, I'm unsure what format the <code>.tar.gz</code> file is expected to be in?  I tried simply compressing the repository in a <code>.tar.gz</code> file and it doesn't seem to recognize it.  What is actually expected to be in here?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 0, "creation_date": 1495228650, "post_id": 44079097, "comment_id": 75182215, "body": "You could also derive <code>Functor</code>."}, {"owner": {"reputation": 75, "user_id": 1574335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746e3779afca8d97aeab9841086d3dec?s=128&d=identicon&r=PG", "display_name": "pip", "link": "https://stackoverflow.com/users/1574335/pip"}, "reply_to_user": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 0, "creation_date": 1495229305, "post_id": 44079097, "comment_id": 75182471, "body": "so you mean to map over the Ability type?"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495229592, "post_id": 44079097, "comment_id": 75182590, "body": "Another option is <code>where m = modifier&#39; s</code>. at the end of the block.  Combine it with <code>where a = ability&#39; s</code> and at least you move the boilerplate into utility functions that only need to be written once."}, {"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 0, "creation_date": 1495231977, "post_id": 44079097, "comment_id": 75183299, "body": "@pip <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Compiler/DeriveFunctor\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/wiki/Commentary/Compiler/DeriveFunc&zwnj;&#8203;tor</a> and then write <code>setModifier</code> with <code>fmap</code>. Or derive lenses."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 1574335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746e3779afca8d97aeab9841086d3dec?s=128&d=identicon&r=PG", "display_name": "pip", "link": "https://stackoverflow.com/users/1574335/pip"}, "edited": false, "score": 0, "creation_date": 1495229754, "post_id": 44079221, "comment_id": 75182650, "body": "maybe off topic, is Lens has anything related to this? I am asking because you mentioned getter/setter. I like your answer alot"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1495229370, "last_edit_date": 1495229370, "creation_date": 1495229159, "answer_id": 44079221, "question_id": 44079097, "link": "https://stackoverflow.com/questions/44079097/haskell-constructor-type-pattern-matching/44079221#44079221", "title": "Haskell Constructor Type Pattern Matching", "body": "<p>Usually if you have a datastructure where each possible constructor has a fields that has the same semantical meaning, you can use <em>record syntax</em>, and thus give that child a name:</p>\n\n<pre><code>data Ability = StrAbi <b>{ abilityValue :: </b>Integer <b>}</b>\n         | DexAbi <b>{ abilityValue :: </b>Integer <b>}</b>\n         | ConAbi <b>{ abilityValue :: </b>Integer <b>}</b>\n         | IntAbi <b>{ abilityValue :: </b>Integer <b>}</b>\n         | WisAbi <b>{ abilityValue :: </b>Integer <b>}</b>\n         | ChaAbi <b>{ abilityValue :: </b>Integer <b>}</b>\n         deriving (Show)</code></pre>\n\n<p>The nice thing is, you <em>automatically</em> have constructed a function <code>abilityValue :: Ability -&gt; Integer</code> that thus has access to that field.</p>\n\n<p>Next we can simply write:</p>\n\n<pre><code>setModifier :: Ability -> (Ability, Modifier)\nsetModifier abi = (abi, Modifier $ modifier' <b>$ abilityValue abi</b>)</code></pre>\n\n<p>There is of course some effort in <em>specifying</em> the name of the fields, but if these values have a \"similar semantical meaning\", then it will usually pay off since you have introduced a \"getter\" (and you can use record notation for \"setters\").</p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 1574335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746e3779afca8d97aeab9841086d3dec?s=128&d=identicon&r=PG", "display_name": "pip", "link": "https://stackoverflow.com/users/1574335/pip"}, "edited": false, "score": 0, "creation_date": 1495229983, "post_id": 44079318, "comment_id": 75182729, "body": "Thanks for the answer! For some reason I was avoiding record syntax for this, but I should for sure re-evaluate this."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 5, "creation_date": 1495231858, "post_id": 44079318, "comment_id": 75183269, "body": "The key improvement here is not record syntax at all, but factoring out the many duplicate Integer fields in different constructors to all be inside the same constructor with another field indicating the AbilityType."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1495232139, "post_id": 44079318, "comment_id": 75183331, "body": "To wit: without record syntax, <code>data Ability = Ability AbilityType Integer</code> and <code>setModifier a@(Ability _ v) = (a, Modifier $ modifier&#39; v)</code> is already worlds better than your original."}, {"owner": {"reputation": 75, "user_id": 1574335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746e3779afca8d97aeab9841086d3dec?s=128&d=identicon&r=PG", "display_name": "pip", "link": "https://stackoverflow.com/users/1574335/pip"}, "edited": false, "score": 0, "creation_date": 1495284415, "post_id": 44079318, "comment_id": 75194278, "body": "daniel - your answer crossed my mind but the pattern matching with _ gave me issue. i&#39;ll try again, and that is the apporach i want. thx"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 13, "last_activity_date": 1495229626, "creation_date": 1495229626, "answer_id": 44079318, "question_id": 44079097, "link": "https://stackoverflow.com/questions/44079097/haskell-constructor-type-pattern-matching/44079318#44079318", "title": "Haskell Constructor Type Pattern Matching", "body": "<p>Can you refactor the datatype?</p>\n\n<pre><code>data Ability = Ability { abilityType :: AbilityType, abilityValue :: Integer }\ndata AbilityType = Str | Dec | Con | Int | Wis | Cha\n</code></pre>\n\n<p><code>setModifier</code> would have the same definition as Willem Van Onsem.</p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1495232763, "last_edit_date": 1495232763, "creation_date": 1495232197, "answer_id": 44079731, "question_id": 44079097, "link": "https://stackoverflow.com/questions/44079097/haskell-constructor-type-pattern-matching/44079731#44079731", "title": "Haskell Constructor Type Pattern Matching", "body": "<p>Answering the comment-question about using Lens (with MicroLens-platform in this answer but for these operations its the exact same code as full Lens with smaller dependencies):</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Lens.Micro.Platform\ndata Ability\n         = StrAbi { _abilityValue :: Integer }\n         | DexAbi { _abilityValue :: Integer }\n         | ConAbi { _abilityValue :: Integer }\n         | IntAbi { _abilityValue :: Integer }\n         | WisAbi { _abilityValue :: Integer }\n         | ChaAbi { _abilityValue :: Integer }\n         deriving (Show)\nmakeLenses ''Ability\n\n-- Just some examples\ngetAbilityValue :: Ability -&gt; Integer\ngetAbilityValue ab = ab ^. abilityValue\n\nsetAbilityValue :: Ability -&gt; Integer -&gt; Ability\nsetAbilityValue ab val = ab &amp; abilityValue .~ val\n\nmodifyAbilityValue :: Ability -&gt; (Integer -&gt; Integer) -&gt; Ability\nmodifyAbilityValue ab f = ab &amp; abilityValue %~ f\n\n-- Edit after reading the question instead of just the comment:\ndata Modifier = Modifier Integer deriving (Show)\n\nsetModifier :: Ability -&gt; (Ability, Modifier)\nsetModifier ab = (ab,Modifier (ab ^. abilityValue))\n-- or import Control.Arrow and\n-- setModifier = id &amp;&amp;&amp; Modifier . (^. abilityValue)\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 1574335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746e3779afca8d97aeab9841086d3dec?s=128&d=identicon&r=PG", "display_name": "pip", "link": "https://stackoverflow.com/users/1574335/pip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 948, "favorite_count": 0, "accepted_answer_id": 44079221, "answer_count": 3, "score": 3, "last_activity_date": 1495232763, "creation_date": 1495228534, "question_id": 44079097, "link": "https://stackoverflow.com/questions/44079097/haskell-constructor-type-pattern-matching", "title": "Haskell Constructor Type Pattern Matching", "body": "<p>I have a simple type and function below, but seems a lot of boilerplate there, so wonder is there a better way to do it. My real question I guess is if I know the input is of type Ability, so any one of the Str/Dex etc, what is the easiest way to extract the Integer from it without pattern match each one of them?</p>\n\n<pre><code>data Ability = StrAbi Integer\n         | DexAbi Integer\n         | ConAbi Integer\n         | IntAbi Integer\n         | WisAbi Integer\n         | ChaAbi Integer\n         deriving (Show)\n\ndata Modifier = Modifier Integer deriving (Show)\n\nsetModifier :: Ability -&gt; (Ability, Modifier)\nsetModifier abi@(StrAbi s) = (abi, Modifier $ modifier' s)\nsetModifier abi@(DexAbi s) = (abi, Modifier $ modifier' s)\nsetModifier abi@(ConAbi s) = (abi, Modifier $ modifier' s)\nsetModifier abi@(IntAbi s) = (abi, Modifier $ modifier' s)\nsetModifier abi@(WisAbi s) = (abi, Modifier $ modifier' s)\nsetModifier abi@(ChaAbi s) = (abi, Modifier $ modifier' s)\n</code></pre>\n\n<p>Thanks,\n//</p>\n"}, {"tags": ["haskell", "recursion", "idris"], "answers": [{"comments": [{"owner": {"reputation": 20789, "user_id": 51428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2dfe31131d62b675b10d7b02284d5303?s=128&d=identicon&r=PG", "display_name": "flq", "link": "https://stackoverflow.com/users/51428/flq"}, "edited": false, "score": 0, "creation_date": 1495264075, "post_id": 44082671, "comment_id": 75189001, "body": "Baby steps, Anton :)"}], "tags": [], "owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "is_accepted": true, "score": 4, "last_activity_date": 1495264269, "last_edit_date": 1495264269, "creation_date": 1495261696, "answer_id": 44082671, "question_id": 44078891, "link": "https://stackoverflow.com/questions/44078891/how-do-i-evaluate-this-recursive-function-in-idris-interactive/44082671#44082671", "title": "How do I evaluate this recursive function in Idris interactive?", "body": "<p>As explained in the <a href=\"http://docs.idris-lang.org/en/latest/reference/repl.html\" rel=\"nofollow noreferrer\">manual</a>:</p>\n\n<blockquote>\n  <p>At compile-time it [Idris] will only evaluate things which it knows to be total\n  ... [skipped]...\n  The REPL, for convenience, uses the compile-time notion of evaluation.</p>\n</blockquote>\n\n<p>The totality checker is not able to discover that the <code>windowl</code> function is in fact total, so we can either cheat using the <code>assert_smaller</code> <a href=\"http://docs.idris-lang.org/en/latest/tutorial/theorems.html#hints-for-totality\" rel=\"nofollow noreferrer\">construction</a>:</p>\n\n<pre><code>total\nwindowl : Nat -&gt; List a -&gt; List (List a)\nwindowl size = loop\n  where\n    loop : List a -&gt; List (List a)\n    loop xs = case List.splitAt size xs of\n      (ys, []) =&gt; if length ys == size then [ys] else []\n      (ys, _) =&gt; ys :: loop (assert_smaller xs $ drop 1 xs)\n</code></pre>\n\n<p>or change <code>loop</code> to make totality obvious to the totality checker:</p>\n\n<pre><code>total\nwindowl : Nat -&gt; List a -&gt; List (List a)\nwindowl size = loop\n  where\n    loop : List a -&gt; List (List a)\n    loop [] = []\n    loop xs@(x :: xs') = case List.splitAt size xs of\n      (ys, []) =&gt; if length ys == size then [ys] else []\n      (ys, _) =&gt; ys :: loop xs'\n</code></pre>\n\n<p>Yes, I'm cutting corners here, replacing the hardcoded <code>drop 1</code> with pattern-matching to illustrate the idea. The more general case might require  more work.</p>\n\n<p>At this point, REPL fully evaluates the expression:</p>\n\n<pre><code>\u03bb\u03a0&gt; windowl 2 [1,2,3,4,5]\n[[1, 2], [2, 3], [3, 4], [4, 5]] : List (List Integer)\n</code></pre>\n"}], "owner": {"reputation": 20789, "user_id": 51428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2dfe31131d62b675b10d7b02284d5303?s=128&d=identicon&r=PG", "display_name": "flq", "link": "https://stackoverflow.com/users/51428/flq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 44082671, "answer_count": 1, "score": 4, "last_activity_date": 1495264269, "creation_date": 1495227510, "last_edit_date": 1495540498, "question_id": 44078891, "link": "https://stackoverflow.com/questions/44078891/how-do-i-evaluate-this-recursive-function-in-idris-interactive", "title": "How do I evaluate this recursive function in Idris interactive?", "body": "<p>Dabbling into Idris, I was trying to port <a href=\"https://stackoverflow.com/a/16762033/51428\">this Haskell function</a> to Idris. I think I succeeded, with this code...</p>\n\n<pre><code>windowl : Nat -&gt; List a -&gt; List (List a)\nwindowl size = loop\n  where\n    loop xs = case List.splitAt size xs of\n      (ys, []) =&gt; if length ys == size then [ys] else []\n      (ys, _) =&gt; ys :: loop (drop 1 xs)\n</code></pre>\n\n<p>However, when I call it in interactive idris, it appears that only the first call into the function is evaluated, the next step in the recursion is not. This is what I get on the console.</p>\n\n<pre><code>*hello&gt; windowl 2 [1,2,3,4,5]\n[1, 2] :: Main.windowl, loop Integer 2 [2, 3, 4, 5] : List (List Integer)\n</code></pre>\n\n<p>Can someone enlighten me as to what is happening and how I can get the function evaluated completely?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1495293524, "post_id": 44077968, "comment_id": 75197096, "body": "<code>cabal configure</code> will not try to install missing packages, but just look at what is installed when configuring the current package.  You can <code>cabal install</code> in the xml-fana directory or <code>cabal install base-ext-fana ; cabal configure</code> in the xml-fana directory after having added <code>base-et-fana</code> to the sandbox.  In practice you rarely need to manually <code>cabal configure</code> and instead almost always <code>cabal install</code>."}, {"owner": {"reputation": 2204, "user_id": 112298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/515a5692f7efeba0c7ef6906d67352be?s=128&d=identicon&r=PG", "display_name": "libeako", "link": "https://stackoverflow.com/users/112298/libeako"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1495299664, "post_id": 44077968, "comment_id": 75198980, "body": "So : it is not enough to &quot;add-source&quot; the dependency, but i also have to &quot;install&quot; it?"}, {"owner": {"reputation": 2204, "user_id": 112298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/515a5692f7efeba0c7ef6906d67352be?s=128&d=identicon&r=PG", "display_name": "libeako", "link": "https://stackoverflow.com/users/112298/libeako"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1495357018, "post_id": 44077968, "comment_id": 75210998, "body": "I you make it an answer then i accept it."}], "answers": [{"tags": [], "owner": {"reputation": 2204, "user_id": 112298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/515a5692f7efeba0c7ef6906d67352be?s=128&d=identicon&r=PG", "display_name": "libeako", "link": "https://stackoverflow.com/users/112298/libeako"}, "is_accepted": true, "score": 0, "last_activity_date": 1495393389, "creation_date": 1495393389, "answer_id": 44100716, "question_id": 44077968, "link": "https://stackoverflow.com/questions/44077968/cabal-local-dependency-missing/44100716#44100716", "title": "cabal - local dependency missing", "body": "<p><code>cabal --require-sandbox install base-ext-fana</code> solved my problem.</p>\n\n<p>What i missed was that it is not enough to tell cabal where it finds the dependency package [with <code>cabal sandbox add-source</code>], but i also have to install it.</p>\n\n<p>This solution was suggested by Thomas M. DuBuisson in a comment.</p>\n"}], "owner": {"reputation": 2204, "user_id": 112298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/515a5692f7efeba0c7ef6906d67352be?s=128&d=identicon&r=PG", "display_name": "libeako", "link": "https://stackoverflow.com/users/112298/libeako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 44100716, "answer_count": 1, "score": 0, "last_activity_date": 1495393389, "creation_date": 1495223196, "last_edit_date": 1495277133, "question_id": 44077968, "link": "https://stackoverflow.com/questions/44077968/cabal-local-dependency-missing", "title": "cabal - local dependency missing", "body": "<p>I am learning cabal. \nFighting with a \"dependencies are missing\" error.</p>\n\n<p>I have 2 cabal packages : \"base-ext-fana\", \"xml-fana\".\nBoth are sandboxed. base-ext-fana builds cleanly.\nxml-fana should depend on it. So i did <code>cabal add-source ../base-ext-fana</code>. I list base-ext-fana in xml-fana.cabal in the \"build-depends\" section. Still i get :</p>\n\n<pre><code>cabal: At least the following dependencies are missing:\nbase-ext-fana -any\n</code></pre>\n\n<p>on <code>cabal configure</code>.</p>\n\n<p><strong>Investigating myself</strong></p>\n\n<p>I suspected that i might make a mistake in base-ext-fana, so i replaced it with another package [\"idris\"] that i know must be correct and still got the same error. </p>\n\n<p>I know i did not misspelled the package path of base-ext-fana in <code>cabal add-source</code>, because i let bash complete it and <code>cabal add-source</code> did found base-ext-fana.cabal in it. The given path got added to file .cabal-sandbox/add-source-timestamps. I know i did not misspelled the package name base-ext-fana in xml-fana.cabal, becuase i copy-pasted it from base-ext-fana.cabal's name section.</p>\n\n<p>What else may cause the error?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1495225254, "post_id": 44077656, "comment_id": 75180770, "body": "It isn&#39;t. It&#39;s a lie."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1495226011, "post_id": 44077656, "comment_id": 75181125, "body": "On the other hand, the type <code>(forall b. b -&gt; b) -&gt; (a -&gt; b)</code> is much more defensibly equivalent to <code>(a -&gt; b)</code> (up to the usual caveats about defined-ness). Perhaps that is the kind of thing the tutorial was trying to convey -- or perhaps it is the mistake the author made, and should be fixed up not to claim equivalence at all."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1495226664, "post_id": 44077656, "comment_id": 75181422, "body": "@DanielWagner, I think my answer probably gets at what was really intended."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1495227108, "post_id": 44077656, "comment_id": 75181583, "body": "@dfeuer I think so, too. Perhaps this fix can be back-ported to the tutorial itself."}], "answers": [{"comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 2, "creation_date": 1495223489, "post_id": 44077878, "comment_id": 75179956, "body": "It&#39;s not quite an isomorphism because a function of type <code>((b -&gt; b) -&gt; a -&gt; b)</code> might apply the first argument not only once."}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1495223653, "post_id": 44077878, "comment_id": 75180034, "body": "In <code>in f x</code>, is <code>f :: b -&gt; b</code> and <code>x :: a</code>?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1495223700, "post_id": 44077878, "comment_id": 75180048, "body": "<code>f</code> is <code>((b -&gt; b) -&gt; a -&gt; b)</code> and <code>x</code> is <code>a</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1495225368, "post_id": 44077878, "comment_id": 75180814, "body": "@Li-yaoXia, makes me wonder, if there is no isomorphism, in what sense are the types equivalent?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1495225725, "post_id": 44077878, "comment_id": 75180977, "body": "Let <code>zero f x = x; one f x = f x; two f x = f (f x)</code>. Then <code>out (in zero) = out (in one) = out (in two) = one</code>, but <code>zero &#47;= one</code> and <code>one &#47;= two</code>, so this is not an isomorphism at all!"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1495226667, "post_id": 44077878, "comment_id": 75181424, "body": "I think the trick is that the original function is a <code>Lens</code>, which requires the argument to be used exactly once in a certain way, so that <code>Getting</code> is an over-approximation of the actual domain to consider."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 1, "last_activity_date": 1495223568, "last_edit_date": 1495223568, "creation_date": 1495222837, "answer_id": 44077878, "question_id": 44077656, "link": "https://stackoverflow.com/questions/44077656/justifying-a-type-equivalency-asserted-in-haskell-lens-library/44077878#44077878", "title": "Justifying a Type Equivalency Asserted in Haskell Lens Library", "body": "<p>The type says \"You give me a <code>b -&gt; b</code> and an <code>a</code>, and I'll give you a <code>b</code>.\" What can a function with that type do with its <code>b -&gt; b</code>? Two options:</p>\n\n<ol>\n<li>Ignore the function altogether</li>\n<li>Apply it to a <code>b</code></li>\n</ol>\n\n<p>How do you get hold of a <code>b</code> to apply the function to? You use the <code>a</code> to produce one. So either way, it has to do the work of an <code>a -&gt; b</code>.</p>\n\n<p>Here's some code to witness the (<em>edit: not-quite</em>) isomorphism.</p>\n\n<pre><code>in :: ((b -&gt; b) -&gt; a -&gt; b) -&gt; (a -&gt; b)\nin f x = f id x\n\nout :: (a -&gt; b) -&gt; ((b -&gt; b) -&gt; a -&gt; b)\nout f g x = g (f x)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 10, "last_activity_date": 1495256752, "last_edit_date": 1495256752, "creation_date": 1495226596, "answer_id": 44078709, "question_id": 44077656, "link": "https://stackoverflow.com/questions/44077656/justifying-a-type-equivalency-asserted-in-haskell-lens-library/44078709#44078709", "title": "Justifying a Type Equivalency Asserted in Haskell Lens Library", "body": "<p>The tutorial isn't very precise about this. Here's the full definition of <code>Getting</code>:</p>\n\n<pre><code>type Getting r s a = (a -&gt; Const r a) -&gt; s -&gt; Const r s\n</code></pre>\n\n<p>Stripping off the <code>newtype</code> noise,</p>\n\n<pre><code>Getting r s a ~= (a -&gt; r) -&gt; s -&gt; r\n</code></pre>\n\n<p>The interesting isomorphism you should get from this is the following:</p>\n\n<pre><code>(forall r. Getting r s a) ~= s -&gt; a\n</code></pre>\n\n<p>In a now-deleted comment, chi pointed out that this is a special case of the <a href=\"https://www.schoolofhaskell.com/user/bartosz/understanding-yoneda\" rel=\"nofollow noreferrer\">Yoneda lemma</a>.</p>\n\n<p>The isomorphism is witnessed by</p>\n\n<pre><code>fromGetting :: Getting a s a -&gt; (s -&gt; a)\nfromGetting g = getConst . g Const\n           -- ~= g id\n\n-- Note that the type of fromGetting is a harmless generalization of\n-- fromGetting :: (forall r. Getting r s a) -&gt; (s -&gt; a)\n\ntoGetting :: (s -&gt; a) -&gt; Getting r s a\ntoGetting f g = Const . getConst . g . f\n           -- ~= g . f\n\n-- Note that you can read the signature of toGetting as\n-- toGetting :: (s -&gt; a) -&gt; (forall r. Getting r s a)\n</code></pre>\n\n<p>Neither <code>fromGetting</code> nor <code>toGetting</code> has a rank-2 type, but to <em>describe</em> the isomorphism, the <code>forall</code> is essential. Why is this an isomorphism?.</p>\n\n<p>One side is easy: ignoring the <code>Const</code> noise,</p>\n\n<pre><code>  fromGetting (toGetting f)\n= toGetting f id\n= id . f\n= f\n</code></pre>\n\n<p>The other side is trickier.</p>\n\n<pre><code>  toGetting (fromGetting f)\n= toGetting (f id)\n= \\g -&gt; toGetting (f id) g\n= \\g -&gt; g . f id\n</code></pre>\n\n<p>Why is this equivalent to <code>f</code>? The <code>forall</code> is the key here:</p>\n\n<pre><code>f :: forall r. Getting r s a\n  -- forall r. (a -&gt; r) -&gt; s -&gt; r\n</code></pre>\n\n<p><code>f</code> has no way to produce an <code>r</code> except by applying the passed function (let's call it <code>p</code>) to a value of type <code>a</code>. It's given nothing but <code>p</code> and a value of type <code>s</code>. So <code>f</code> really can't do anything except extract an <code>a</code> from the <code>s</code> and apply <code>p</code> to the result. That is, <code>f p</code> must \"factor\" into the composition of two functions:</p>\n\n<pre><code>f p = p . h\n</code></pre>\n\n<p>So</p>\n\n<pre><code>g . f id = g . (id . h) = g . h = f g\n</code></pre>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 44078709, "answer_count": 2, "score": 2, "last_activity_date": 1495256752, "creation_date": 1495221982, "question_id": 44077656, "link": "https://stackoverflow.com/questions/44077656/justifying-a-type-equivalency-asserted-in-haskell-lens-library", "title": "Justifying a Type Equivalency Asserted in Haskell Lens Library", "body": "<p>According to the <a href=\"https://hackage.haskell.org/package/lens-tutorial-1.0.2/docs/Control-Lens-Tutorial.html#g:2\" rel=\"nofollow noreferrer\">tutorial on Lenses</a>:</p>\n\n<pre><code>type Getting b a b  = (b -&gt; Const b b) -&gt; (a -&gt; Const b a)\n\n-- ... equivalent to: (b -&gt;       b  ) -&gt; (a -&gt;       b  )\n\n-- ... equivalent to:                     (a -&gt;       b  )\n</code></pre>\n\n<p><strong>Question:</strong> Why is <code>(b -&gt; b) -&gt; (a -&gt; b)</code> equivalent to <code>(a -&gt; b)</code>?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1495210049, "post_id": 44074410, "comment_id": 75173092, "body": "Have you tried <code>:load xmonad</code> before doing the imports?"}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "reply_to_user": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1495210542, "post_id": 44074410, "comment_id": 75173337, "body": "That works, thanks. I still want to know why though."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1495210545, "creation_date": 1495210545, "answer_id": 44074636, "question_id": 44074410, "link": "https://stackoverflow.com/questions/44074410/how-can-i-import-a-module-that-is-in-ghci-paths/44074636#44074636", "title": "How can I import a module that is in GHCi paths?", "body": "<p>You can only import modules that are from some known package or which have been loaded. When you run <code>ghci xmonad.hs</code>, it loads <code>xmonad.hs</code> and any modules needed by it. When you run <code>ghci</code>, it doesn't load anything by default.</p>\n\n<p>You can load your module alone by running <code>:load FocusWindow</code>, or <code>:l FocusWindow</code> for short. That will automatically also \"import\" that module in a special way (specifically: making all names available, even un-exported ones), and you will also be able to do normal imports of modules used by <code>FocusWindow</code>.</p>\n\n<p>It would probably be a nice feature for ghci's <code>import</code> support to try loading unknown modules before complaining. I suspect a patch adding that feature would be accepted.</p>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 44074636, "answer_count": 1, "score": 0, "last_activity_date": 1495210828, "creation_date": 1495209607, "last_edit_date": 1495210828, "question_id": 44074410, "link": "https://stackoverflow.com/questions/44074410/how-can-i-import-a-module-that-is-in-ghci-paths", "title": "How can I import a module that is in GHCi paths?", "body": "<p>I seem unable to import a module when executing <code>ghci</code> directly, however I am able to load the module when executing <code>ghci xmonad.hs</code>.</p>\n\n<p><strong>Directory tree:</strong></p>\n\n<pre><code>.\n\u251c\u2500\u2500 ghcid.sh\n\u251c\u2500\u2500 lib\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 FocusWindow.hs\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 MiddleColumn.hs\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Readme.md\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 TAGS\n\u251c\u2500\u2500 Readme.md\n\u251c\u2500\u2500 TAGS\n\u251c\u2500\u2500 xmonad2.hs\n\u251c\u2500\u2500 xmonad.errors\n\u251c\u2500\u2500 xmonad.hs\n\u251c\u2500\u2500 xmonad.state\n\u251c\u2500\u2500 xmonad.state.backup\n\u2514\u2500\u2500 xmonad-x86_64-linux\n</code></pre>\n\n<p><strong>.ghci</strong></p>\n\n<pre><code>:set -Wall\n:set -i:lib\n</code></pre>\n\n<p><strong>ghci prompt:</strong></p>\n\n<pre><code>Prelude&gt; :show paths\ncurrent working directory: \n  /home/chris/.xmonad\nmodule import search paths:\n  .\n  lib\nDisplay all 2040 possibilities? (y or n)\nPrelude&gt; import FocusWindow\n\n&lt;no location info&gt;: error:\n    Could not find module \u2018FocusWindow\u2019\n    It is not a module in the current program, or in any known package.\n</code></pre>\n\n<p><strong>ghci xmonad.hs prompt</strong></p>\n\n<pre><code>GHCi, version 8.0.1: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /home/chris/.xmonad/.ghci\n[1 of 3] Compiling FocusWindow      ( lib/FocusWindow.hs, interpreted )\n[2 of 3] Compiling MiddleColumn     ( lib/MiddleColumn.hs, interpreted )\n[3 of 3] Compiling Main             ( xmonad.hs, interpreted )\nOk, modules loaded: MiddleColumn, FocusWindow, Main.\n*Main&gt; import FocusWindow\n*Main FocusWindow&gt; :show paths\ncurrent working directory: \n  /home/chris/.xmonad\nmodule import search paths:\n  .\n  lib\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1495207491, "post_id": 44073684, "comment_id": 75171527, "body": "You realise that this is a <a href=\"https://ghc.haskell.org/trac/ghc/wiki/TypeApplication\" rel=\"nofollow noreferrer\">type application</a> (which doesn&#39;t work at all prior to GHC-8.0)?"}, {"owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1495207590, "post_id": 44073684, "comment_id": 75171599, "body": "Yes I am aware of that. I am using ghc 8.0.2 to compile the code."}], "answers": [{"comments": [{"owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "edited": false, "score": 1, "creation_date": 1495208471, "post_id": 44073907, "comment_id": 75172146, "body": "It is funny. with <code>forall f . </code> the code failed to compile. But my code compiled as-is with turning on <code>ScopedTypeVariables</code> language extension."}, {"owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "edited": false, "score": 0, "creation_date": 1495210316, "post_id": 44073907, "comment_id": 75173229, "body": "Well a catch! The code compiles as long as no <code>data</code> has a <code>String</code> filed. Otherwise, the compiler complaints about  &quot;Overlapping instances for HasParser [Char]&quot;. This is confusing me, as I don&#39;t have <code>Char</code> as an instance of <code>HasParser</code>. See the code at <a href=\"https://pastebin.com/FYrQHa5w\" rel=\"nofollow noreferrer\">pastebin.com/FYrQHa5w</a>  . Code works fine without the <code>String</code> part."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "edited": false, "score": 0, "creation_date": 1495210887, "post_id": 44073907, "comment_id": 75173526, "body": "@user2812201 I believe the overlapping problem is caused by the <code>HasParser String</code> instance. In Haskell, strings are really lists of chars. Is switching to something like <code>Text</code> possible? If not, perhaps something like an OVERLAPPABLE pragma could work <a href=\"http://stackoverflow.com/questions/39215103/ghc-overlapping-instances-when-generalising-addition\" title=\"ghc overlapping instances when generalising addition\">stackoverflow.com/questions/39215103/&hellip;</a>"}, {"owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1495211470, "post_id": 44073907, "comment_id": 75173837, "body": "@danidiaz I believe the problem is caused by the <code>HasParser String</code> instance too. I&#39;m trying to understand the reason, though: I don&#39;t have <code>instance HasParser Char</code> anywhere in the code, but GHC seems to think <code>Char</code> is an instance of <code>HasParser</code>, why?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "edited": false, "score": 0, "creation_date": 1495211931, "post_id": 44073907, "comment_id": 75174085, "body": "@user2812201 The problem is really the instance for <code>String</code>. GHC sees that there are two possible definitions it can use: the basic instance for <code>String</code> and the one you have defined for lists, and it can&#39;t choose. You can nudge him trough a OVERLAPPABLE pragma in the more general instance or an OVERLAPPING pragma in your more specific instance, the one for <code>String</code>."}, {"owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1495212350, "post_id": 44073907, "comment_id": 75174311, "body": "@danidiaz Sorry for too many questions but I&#39;m really trying to understand this issue here. Let&#39;s look at the second way to instantiate <code>String</code>: as an list of <code>Char</code>s. Does not this require <code>Char</code> to be an instance of <code>HasParser</code> in the first place? Is GHC making <code>Char</code> an instance of <code>HasParser</code> automatically?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "edited": false, "score": 3, "creation_date": 1495212928, "post_id": 44073907, "comment_id": 75174582, "body": "@user2812201 This is because the way instance resolution works, which is less &quot;smart&quot; than commonly assumed. When selecting which instance to use, <i>only the instance head</i> is checked, <i>not</i> the preconditions! If <i>after</i> having commited to an instance the preconditions (<code>HasParser Char</code> in this case) can&#39;t be met, compilation simply fails. GHC doesn&#39;t use the absence of a precondition to reject potential instances or resolve an ambiguity."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1495207900, "creation_date": 1495207900, "answer_id": 44073907, "question_id": 44073684, "link": "https://stackoverflow.com/questions/44073684/generic-sop-and-lists-data-proxy-etc/44073907#44073907", "title": "generic-sop and lists, Data.Proxy etc", "body": "<p>You need <code>ScopedTypeVariables</code> for this.</p>\n\n<pre><code>{-# LANGUAGE ScoperTypeVariables, UnicodeSyntax #-}\n\ninstance \u2200 f . HasParser f =&gt; HasParser [f] where\n  getParser = many' (getParser @f)\n</code></pre>\n\n<p>(ASCII syntax <code>instance forall f . HasParser ...</code> also works.)</p>\n"}], "owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1495207900, "creation_date": 1495207201, "last_edit_date": 1495542878, "question_id": 44073684, "link": "https://stackoverflow.com/questions/44073684/generic-sop-and-lists-data-proxy-etc", "title": "generic-sop and lists, Data.Proxy etc", "body": "<p>In the spirit of the question I asked here, <a href=\"https://stackoverflow.com/questions/42583838/generically-build-parsers-from-custom-data-types\">(Generically) Build Parsers from custom data types?</a> \n@danidiaz supplied a solution that works beautifully.</p>\n\n<p>I'd like to do a little more like this: if <code>f</code> is an instance of a <code>HasParser</code>, a list of <code>f</code> is also an instance of the <code>HasParser</code>. Or in Haskell, that is</p>\n\n<pre><code>instance (HasParser f) =&gt; HasParser [f] where\n  getParser = many' (getParser @f)\n</code></pre>\n\n<p>Well, this would not compile. I get the following error message:</p>\n\n<blockquote>\n  <p>error: Not in scope: type variable \u2018f\u2019</p>\n</blockquote>\n\n<p>I am unfamiliar with the syntax with these language extensions. In particular, the usage of <code>@</code> with <code>Proxy</code> always confuses me a lot. Hope some one can show me where to find the best documentation to read. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1495201433, "post_id": 44071503, "comment_id": 75167321, "body": "I&#39;ll probably be scolded for that, so it&#39;s not an answer, but you can use Template Haskell to define such a function based on the fields in your datatype. You can construct it so that it matches only a list with a specific number of strings, and gracefully fails on anything else. You can also write it by hand, obviously, if your type isn&#39;t going to change any time soon."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1495201580, "post_id": 44071503, "comment_id": 75167416, "body": "@BartekBanachewicz TH was my first thought as well. But, yes, it is probably overkill, and would require to write more than the obvious function. Scrap-your-boilerplate would probably be simpler and require less typing."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1495201650, "post_id": 44071503, "comment_id": 75167463, "body": "@chi FWIW I did that as a helper and it&#39;s <a href=\"https://github.com/bananu7/Turnip/blob/master/src/Turnip/Eval/TH.hs#L66-L74\" rel=\"nofollow noreferrer\">not that bad</a>. Would have to go over fields of the type instead of <a href=\"https://github.com/bananu7/Turnip/blob/master/src/Turnip/Eval/TH.hs#L16-L18\" rel=\"nofollow noreferrer\">my Sig type</a>, but otherwise it&#39;s pretty much the same deal."}, {"owner": {"reputation": 354, "user_id": 1890194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcb7e8980480fb03cf2ea2bf863d4ca6?s=128&d=identicon&r=PG", "display_name": "Tapan Chugh", "link": "https://stackoverflow.com/users/1890194/tapan-chugh"}, "edited": false, "score": 0, "creation_date": 1495201932, "post_id": 44071503, "comment_id": 75167678, "body": "Unless the OP has a number of such types and (or) will change the type significantly during the development, TH is probably an overkill"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1495202031, "post_id": 44071503, "comment_id": 75167751, "body": "@BartekBanachewicz I think you should post that, it&#39;s nice to see all the possible approaches."}, {"owner": {"reputation": 5779, "user_id": 1255817, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9680f28a548dcaa8bfc2946254c5b3dc?s=128&d=identicon&r=PG", "display_name": "turtle", "link": "https://stackoverflow.com/users/1255817/turtle"}, "edited": false, "score": 0, "creation_date": 1495202118, "post_id": 44071503, "comment_id": 75167823, "body": "Thanks all. I&#39;m always amazed at the help and generosity of the Haskell community. I realize this is probably a trivial question, but the discussion is of great help to me."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495203684, "post_id": 44071503, "comment_id": 75168947, "body": "@chi I started to write it, but now I&#39;m 6 abstraction levels deep in <code>Lens</code> source code. Just made me appreciate your SYB solution more ;) (I&#39;ll post it if I can get a stripped-down version to work)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1495204852, "post_id": 44071503, "comment_id": 75169722, "body": "@BartekBanachewicz Actually, now I realized that SYB is harder than I thought. My (now deleted) answer actually answered another question. I failed to see that we want to construct <code>MyAwesomeType</code> from another type (a list), which is harder. I think SYB might still be used, but it&#39;s worse than I thought."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 3, "creation_date": 1495206335, "post_id": 44071503, "comment_id": 75170730, "body": "@turtle: This is not what you asked, but a type holding 25 undifferentiated values is a code smell. If fields &quot;a&quot;, &quot;b&quot; and &quot;c&quot; all mean different things (e.g. parameters from a config file) then you should translate the strings into types that mean something to the application, and also try to classify them into a hierarchy of smaller records (e.g. IP config versus application parameters). If you really have a data type holding 25 strings then use an array, vector or list and wrap it in a newtype."}], "answers": [{"comments": [{"owner": {"reputation": 5779, "user_id": 1255817, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9680f28a548dcaa8bfc2946254c5b3dc?s=128&d=identicon&r=PG", "display_name": "turtle", "link": "https://stackoverflow.com/users/1255817/turtle"}, "edited": false, "score": 0, "creation_date": 1495201187, "post_id": 44071578, "comment_id": 75167160, "body": "thanks for the help. i should have mentioned in my actually application, my type has a huge number of elements. not 3 but 25. is there an easier way than writing them all out like that?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 5779, "user_id": 1255817, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9680f28a548dcaa8bfc2946254c5b3dc?s=128&d=identicon&r=PG", "display_name": "turtle", "link": "https://stackoverflow.com/users/1255817/turtle"}, "edited": false, "score": 0, "creation_date": 1495201605, "post_id": 44071578, "comment_id": 75167432, "body": "@turtle: you could define such a function with template Haskell, but I&#39;m not a huge fan of that."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1495203844, "post_id": 44071578, "comment_id": 75169071, "body": "Wow, your TH solution looks really short and concise. Kudos, what I was attempting required much much more helpers to even wrap my head around the types."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1495203329, "last_edit_date": 1495203329, "creation_date": 1495201072, "answer_id": 44071578, "question_id": 44071503, "link": "https://stackoverflow.com/questions/44071503/how-to-map-data-elements-to-data-types/44071578#44071578", "title": "how to map data elements to data types", "body": "<h1>Three (or small) number of arguments</h1>\n\n<p>You can use a <em>lambda expression</em> for that:</p>\n\n<pre><code>map (<b>\\[a,b,c] -&gt; MyAwesomeType a b c</b>) xs</code></pre>\n\n<p>Nevertheless it us usually not a good idea to work with such lists anyway: at compile time it is unknown how many elements are in the list, so if there are less, or more than three, this will error. If you want some generic structure to store values in.</p>\n\n<p>You better use a <em>tuple</em> (here <code>(String,String,String)</code> since now you know that there are three elements, furthermore the elements can have different types (that is not the case with a list):</p>\n\n<pre><code>let xs = [(\"A\", \"B\", \"C\"),(\"D\", \"E\", \"F\")]\n--        ^    tuple    ^ ^    tuple    ^\n</code></pre>\n\n<p>Then you can work with:</p>\n\n<pre><code>map (<b>\\(a,b,c) -&gt; MyAwesomeType a b c</b>) xs</code></pre>\n\n<h1>More arguments with template Haskell</h1>\n\n<p>In case the number of \"arguments\" is huge (i.e. 25), then of course this will not be very elegantly. In that case you can decide to work with <em>template Haskell</em>, like:</p>\n\n<pre><code>module Templates where\n\nimport Control.Monad(replicateM)\nimport Language.Haskell.TH.Syntax(newName,Pat(ListP,VarP),Exp(LamE,VarE,AppE))\n\nlistmap n = do\n    xs &lt;- replicateM n $ newName \"x\"\n    f &lt;- newName \"f\"\n    return $ LamE [VarP f,ListP (map VarP xs)] $ foldl AppE (VarE f) $ map VarE xs\n</code></pre>\n\n<p>Now in the your main program, you can use <code>$(listmap 25)</code>:</p>\n\n<pre><code>*Template&gt; :t $(listmap 25)\n$(listmap 25)\n  :: (t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t1\n      -&gt; t)\n     -&gt; [t1] -&gt; t\n</code></pre>\n\n<p>So this constructs a function that takes as input a function that maps 25 <code>t1</code>s on a <code>t</code> and then constructs a function that maps a list of <code>t1</code>s to <code>t</code>.</p>\n\n<p>You can then use it like:</p>\n\n<pre><code>import Templates(listmap)\n\n{-# LANGUAGE TemplateHaskell #-}\n\nmap ($(listmap 25) MyAwesomeType) xs\n</code></pre>\n\n<p>As said before however, you better use tuples, you can do this with:</p>\n\n<pre><code>module Templates where\n\nimport Control.Monad(replicateM)\nimport Language.Haskell.TH.Syntax(newName,Pat(TupP,VarP),Exp(LamE,VarE,AppE))\n\ncurryN n = do\n    xs &lt;- replicateM n $ newName \"x\"\n    f &lt;- newName \"f\"\n    return $ LamE [VarP f,TupP (map VarP xs)] $ foldl AppE (VarE f) $ map VarE xs\n</code></pre>\n\n<p>which can then be used, like:</p>\n\n<pre><code>*Templates&gt; :t $(curryN 25)\n$(curryN 25)\n  :: (t25\n      -&gt; t24\n      -&gt; t23\n      -&gt; t22\n      -&gt; t21\n      -&gt; t20\n      -&gt; t19\n      -&gt; t18\n      -&gt; t17\n      -&gt; t16\n      -&gt; t15\n      -&gt; t14\n      -&gt; t13\n      -&gt; t12\n      -&gt; t11\n      -&gt; t10\n      -&gt; t9\n      -&gt; t8\n      -&gt; t7\n      -&gt; t6\n      -&gt; t5\n      -&gt; t4\n      -&gt; t3\n      -&gt; t2\n      -&gt; t1\n      -&gt; t)\n     -&gt; (t25, t24, t23, t22, t21, t20, t19, t18, t17, t16, t15, t14,\n         t13, t12, t11, t10, t9, t8, t7, t6, t5, t4, t3, t2, t1)\n     -&gt; t\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1495201548, "post_id": 44071714, "comment_id": 75167385, "body": "Should be <code>[String] -&gt; Maybe MyAwesomeType</code> and have a default match <code>converter _ = Nothing</code>. Impartial functions are dangerous!"}, {"owner": {"reputation": 354, "user_id": 1890194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcb7e8980480fb03cf2ea2bf863d4ca6?s=128&d=identicon&r=PG", "display_name": "Tapan Chugh", "link": "https://stackoverflow.com/users/1890194/tapan-chugh"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1495201652, "post_id": 44071714, "comment_id": 75167466, "body": "I agree. Was just trying to be quick. Edited."}, {"owner": {"reputation": 5779, "user_id": 1255817, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9680f28a548dcaa8bfc2946254c5b3dc?s=128&d=identicon&r=PG", "display_name": "turtle", "link": "https://stackoverflow.com/users/1255817/turtle"}, "edited": false, "score": 0, "creation_date": 1495202039, "post_id": 44071714, "comment_id": 75167758, "body": "Thanks for this. Maybe I&#39;ve transcribed something wrong, but I get <code>error: Parse error in pattern</code>."}, {"owner": {"reputation": 354, "user_id": 1890194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcb7e8980480fb03cf2ea2bf863d4ca6?s=128&d=identicon&r=PG", "display_name": "Tapan Chugh", "link": "https://stackoverflow.com/users/1890194/tapan-chugh"}, "reply_to_user": {"reputation": 5779, "user_id": 1255817, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9680f28a548dcaa8bfc2946254c5b3dc?s=128&d=identicon&r=PG", "display_name": "turtle", "link": "https://stackoverflow.com/users/1255817/turtle"}, "edited": false, "score": 0, "creation_date": 1495202243, "post_id": 44071714, "comment_id": 75167939, "body": "@turtle Try now."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1495204849, "post_id": 44071714, "comment_id": 75169721, "body": "that pattern can be written as <code>[a,b,c]</code> as well."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1495208229, "post_id": 44071714, "comment_id": 75172009, "body": "Partial functions, not impartial, @BartekBanachewicz."}], "tags": [], "owner": {"reputation": 354, "user_id": 1890194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcb7e8980480fb03cf2ea2bf863d4ca6?s=128&d=identicon&r=PG", "display_name": "Tapan Chugh", "link": "https://stackoverflow.com/users/1890194/tapan-chugh"}, "is_accepted": true, "score": 7, "last_activity_date": 1495202169, "last_edit_date": 1495202169, "creation_date": 1495201496, "answer_id": 44071714, "question_id": 44071503, "link": "https://stackoverflow.com/questions/44071503/how-to-map-data-elements-to-data-types/44071714#44071714", "title": "how to map data elements to data types", "body": "<p>You need to define a function to convert from the given type to your custom type. In the above example, you need a function</p>\n\n<pre><code>myAwesomeTypeConverter :: [String] -&gt; Maybe MyAwesomeType\nmyAwesomeTypeConverter (a:b:c:[]) = Just $ MyAwesomeType a b c\nmyAwesomeTypeConverter _ = Nothing\n</code></pre>\n\n<p>Now you can use this function to map over your array</p>\n\n<pre><code>map myAwesomeTypeConverter xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 3, "last_activity_date": 1495211655, "last_edit_date": 1495211655, "creation_date": 1495205393, "answer_id": 44073088, "question_id": 44071503, "link": "https://stackoverflow.com/questions/44071503/how-to-map-data-elements-to-data-types/44073088#44073088", "title": "how to map data elements to data types", "body": "<p>Another way of doing it, using <a href=\"http://hackage.haskell.org/package/generics-sop\" rel=\"nofollow noreferrer\">generics-sop</a>:</p>\n\n<pre><code>{-# language DeriveGeneric #-}\n{-# language TypeOperators #-}\n{-# language TypeFamilies #-}\n{-# language DataKinds #-}\n{-# language FlexibleContexts #-}\n{-# language ScopedTypeVariables #-}\n\nimport qualified GHC.Generics as GHC\nimport Generics.SOP\n\ndata MyAwesomeType = MyAwesomeType\n                   {\n                       a :: String,\n                       b :: String,\n                       c :: String\n                   } deriving (Show,GHC.Generic)\n\ninstance Generic MyAwesomeType -- this Generic is from generics-sop\n\nawesomeFromList :: forall c r xs. (Generic r, Code r ~ '[xs], All ((~) c) xs)\n                =&gt; [c]\n                -&gt; Maybe r\nawesomeFromList fields =\n    to . SOP . Z . hcliftA (Proxy :: Proxy ((~) c)) (mapKI id)\n    &lt;$&gt;\n    Generics.SOP.fromList fields\n</code></pre>\n\n<p>Works for any uniform record implementing <code>Generics.SOP.Generic</code>.</p>\n\n<pre><code>*Main&gt; awesomeFromList [\"foo\",\"bar\",\"baz\"] :: Maybe MyAwesomeType\nJust (MyAwesomeType {a = \"foo\", b = \"bar\", c = \"baz\"})\n</code></pre>\n"}], "owner": {"reputation": 5779, "user_id": 1255817, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9680f28a548dcaa8bfc2946254c5b3dc?s=128&d=identicon&r=PG", "display_name": "turtle", "link": "https://stackoverflow.com/users/1255817/turtle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 1, "accepted_answer_id": 44071714, "answer_count": 3, "score": 2, "last_activity_date": 1495211655, "creation_date": 1495200863, "last_edit_date": 1495201315, "question_id": 44071503, "link": "https://stackoverflow.com/questions/44071503/how-to-map-data-elements-to-data-types", "title": "how to map data elements to data types", "body": "<p>I have a data type that looks like this:</p>\n\n<pre><code>data MyAwesomeType = MyAwesomeType {\n                                     a :: String,\n                                     b :: String,\n                                     c :: String,\n                                     ...\n                                     -- 25 in total\n                                   } deriving (Show)\n</code></pre>\n\n<p>I have some data that looks like this:</p>\n\n<pre><code>let xs = [[\"A\", \"B\", \"C\", ...],[\"D\", \"E\", \"F\", ...]]\n</code></pre>\n\n<p>with one value for each field in the type.</p>\n\n<p>How can I apply my custom data type to each element in the above list? I was trying to do something like this, which does not work:</p>\n\n<pre><code>map (MyAwesomeType) xs\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "edited": false, "score": 1, "creation_date": 1495193563, "post_id": 44068734, "comment_id": 75161740, "body": "i guess youu cant. By the type signature, your function must accept any integer."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1495194790, "post_id": 44068734, "comment_id": 75162625, "body": "This signature won&#39;t allow that. You&#39;d need a custom datatype or dependent types (not in Haskell... yet ;))."}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1495194909, "post_id": 44068734, "comment_id": 75162712, "body": "Updated my question to indicate that the first argument&#39;s type doesn&#39;t have to be <code>[Int]</code>, but the output must be <code>[Int]</code>."}, {"owner": {"reputation": 670, "user_id": 7781818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f5392f913a0f47fab3e6719bda4b08?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7781818/chris"}, "edited": false, "score": 0, "creation_date": 1495196746, "post_id": 44068734, "comment_id": 75163957, "body": "in this case you actually can... check out the article on smart constructors: <a href=\"https://wiki.haskell.org/Smart_constructors\" rel=\"nofollow noreferrer\">wiki.haskell.org/Smart_constructors</a> There is an example given how you can model valid list elements using  phantom types and Peano numbers. you can also check out the comments here: <a href=\"http://stackoverflow.com/questions/43896822/how-to-do-bounds-checking-in-haskell-at-compile-time\" title=\"how to do bounds checking in haskell at compile time\">stackoverflow.com/questions/43896822/&hellip;</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1495211760, "post_id": 44068734, "comment_id": 75173987, "body": "Previously, on SO: <a href=\"http://stackoverflow.com/q/43896822/791604\">1</a>, <a href=\"http://stackoverflow.com/q/41743056/791604\">2</a>, <a href=\"http://stackoverflow.com/q/7978191/791604\">3</a>, and probably many more."}], "answers": [{"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1495193320, "post_id": 44068868, "comment_id": 75161568, "body": "Edited question - my mistake for not specifying at compile-time!"}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1495194276, "post_id": 44068868, "comment_id": 75162221, "body": "Edited answer, hope it helps. :-)"}, {"owner": {"reputation": 670, "user_id": 7781818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f5392f913a0f47fab3e6719bda4b08?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7781818/chris"}, "edited": false, "score": 0, "creation_date": 1495196867, "post_id": 44068868, "comment_id": 75164046, "body": "If you go for the custom type I would recommend making it an instance of the <code>Enum</code> type-class, this way you get the &quot;natural&quot; mapping from your custom type to the Ints for free..."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1495196901, "post_id": 44068868, "comment_id": 75164069, "body": "Welp, I wanted to post an answer with exactly what you wrote in the edit, so +1."}], "tags": [], "owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "is_accepted": false, "score": 5, "last_activity_date": 1495194199, "last_edit_date": 1495542881, "creation_date": 1495193265, "answer_id": 44068868, "question_id": 44068734, "link": "https://stackoverflow.com/questions/44068734/define-function-with-constraint-on-lists-elements/44068868#44068868", "title": "Define Function with Constraint on List&#39;s Elements?", "body": "<p>How about:</p>\n\n\n\n<pre><code>f :: [Int] -&gt; [Int]\nf = filter (\\x -&gt; x &gt;= 0 &amp;&amp; x &lt;= 5)\n</code></pre>\n\n<p>Or do you want to enforce the bounds on the type (dependent types)?</p>\n\n<p>If you want to restrict the range of the <code>Int</code> that is allowed you are probably better of using a <em>smart constructor</em>. Have a look <a href=\"https://stackoverflow.com/questions/7978191/how-to-make-a-type-with-restrictions\">here</a>. The idea is that you create your own datatype and your own custom constructor:</p>\n\n\n\n<pre><code>newtype Range0_5 = Range0_5 { unRange :: Int }\n\nmakeRange0_5 :: Int -&gt; Maybe Range0_5\nmakeRange0_5 x\n  | x &gt;= 0 &amp;&amp; x &lt;= 5 = Just $ Range0_5 x\n  | otherwise        = Nothing\n</code></pre>\n\n<p>If you make a <em>smart constructor</em>, it is important to not expose it to the user of the module. This can be done by simply not exporting the <code>Range0_5</code> constructor.</p>\n\n<p>However this is not a compile time check. Other languages than Haskell might be more appropriate if you really need such a feature.</p>\n\n<p>Since the range is fairly small, you could also make a sum type to represent it:</p>\n\n\n\n<pre><code>data Range0_5 = Int0 | Int1 | Int2 | Int3 | Int4 | Int5\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1495194505, "post_id": 44069247, "comment_id": 75162409, "body": "LiquidHaskell can&#39;t help me in this problem?"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1495207061, "post_id": 44069247, "comment_id": 75171227, "body": "@KevinMeredith Thanks for the link - it is a very interesting project. I addressed it in the answer."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": false, "score": 1, "last_activity_date": 1495210932, "last_edit_date": 1495210932, "creation_date": 1495194343, "answer_id": 44069247, "question_id": 44068734, "link": "https://stackoverflow.com/questions/44068734/define-function-with-constraint-on-lists-elements/44069247#44069247", "title": "Define Function with Constraint on List&#39;s Elements?", "body": "<p>If the signature is</p>\n\n<pre><code>f :: [Int] -&gt; [Int]\n</code></pre>\n\n<p>(which was the original form of the question), then it is impossible to enforce your constraint at compile time. This follows from the standard <a href=\"https://en.wikipedia.org/wiki/Halting_problem\" rel=\"nofollow noreferrer\">diagonalization argument of the Halting problem</a>. </p>\n\n<p>Suppose the compiler could detect that</p>\n\n<pre><code>f[g x]\n</code></pre>\n\n<p>should not compile. By incorporating the source code of the compiler into <code>g</code>, it could choose the opposite of the compiler's decision.</p>\n\n<hr>\n\n<p>Following your comment on <a href=\"https://ucsd-progsys.github.io/liquidhaskell-blog/\" rel=\"nofollow noreferrer\">Liquid Haskell</a> (which seems like a very interesting project), note the following:</p>\n\n<pre><code>{-@ type Even = {v:Int | v mod 2 = 0} @-}\n\n{-@ foo :: n:Even -&gt; {v:Bool | (v &lt;=&gt; (n mod 2 == 0))} @-}   \nfoo   :: Int -&gt; Bool \nfoo n = if n^2 - 1 == (n + 1) * (n - 1) then True else foo (n - 1)\n</code></pre>\n\n<p>LiquidHaskell claims this function is unsafe, because, potentially <code>foo n</code> calls <code>foo (n - 1)</code>. Note, however, that this will never happen: it will only be called if the relationship <em>n<sup>2</sup> - 1 &ne; (n + 1) (n - 1)</em>, which can never happen.</p>\n\n<p>Again, this is not a criticism of the quality of LiquidHaskell, but rather just pointing out that it, too, cannot solve Halting Problem like issues.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1495235652, "creation_date": 1495192836, "last_edit_date": 1495194871, "question_id": 44068734, "link": "https://stackoverflow.com/questions/44068734/define-function-with-constraint-on-lists-elements", "title": "Define Function with Constraint on List&#39;s Elements?", "body": "<p>How can I define a function with the following signature,</p>\n\n<pre><code>f :: [Int???] -&gt; [Int]\nf xs = _ -- what I do with xs doesn't matter for the question\n</code></pre>\n\n<p>where <code>a</code> is a List of <code>Int</code>'s </p>\n\n<p>such that the first argument's inputs, i.e. list elements, must be <code>&gt;= 0</code>, but <code>&lt;= 5</code> at compile-time?</p>\n\n<p>In other words,</p>\n\n<p><code>f [6]</code> would fail to compile.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1495187990, "post_id": 44066766, "comment_id": 75158044, "body": "What is your data definition? What module did you import? and how? Is this the full program?"}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1495188389, "post_id": 44066766, "comment_id": 75158336, "body": "I imported Data.Char and Data.List and this is definition:"}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1495188425, "post_id": 44066766, "comment_id": 75158357, "body": "data mkBTree xs = Leaf xs | Fork (mkBTree xs) xs (mkBTree xs)       deriving(Eq,Show)      data mkBTree xs = Leaf xs | Fork xs [mkBTree xs]       deriving(Eq,Show)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1495189664, "post_id": 44066766, "comment_id": 75159163, "body": "But you define <code>Leaf</code> and <code>Fork</code> twice. Can you <a href=\"https://stackoverflow.com/posts/44066766/edit\">edit</a> your question and show the full code (minimal working example)."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1495211515, "post_id": 44066766, "comment_id": 75173865, "body": "Don&#39;t add critical information as a comment or answer, edit the question and add the information there."}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "edited": false, "score": 1, "creation_date": 1495191587, "post_id": 44067776, "comment_id": 75160475, "body": "1) You cant repeat the name of the data type and constructors 2) What is NBaum type in the function? 3) What should the function do?"}], "tags": [], "owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "is_accepted": false, "score": -3, "last_activity_date": 1495189992, "creation_date": 1495189992, "answer_id": 44067776, "question_id": 44066766, "link": "https://stackoverflow.com/questions/44066766/binary-tree-in-generalized-statement/44067776#44067776", "title": "binary tree in generalized statement", "body": "<p>I have to implement a Code which accepts a binary tree and shows a generalised Statement: this is my Code                                                                                                                                                                                                                                                      import Data.Char \n       import Data.List</p>\n\n<pre><code>  data mkBTree xs = Leaf xs | Fork (mkBTree xs) xs (mkBTree xs)\n  deriving(Eq,Show)\n\n data mkBTree xs = Leaf xs | Fork xs [mkBTree xs]\n   deriving(Eq,Show)\n\n\nentferneBlaetter :: NBaum a -&gt; NBaum a\nentferneBlaetter xs\n             | (m == 0) = BBlatt (unwrap xs)\n         | otherwise = BKnoten (NBaum ys) (NBaum zs)\n         where m = (length xs) `div` 2\n                (ys, zs) = splitAt m xs\n                    unwrap [x] = x\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1495189992, "creation_date": 1495187362, "question_id": 44066766, "link": "https://stackoverflow.com/questions/44066766/binary-tree-in-generalized-statement", "title": "binary tree in generalized statement", "body": "<p>I have to implement a Code which accepts a binary tree and shows a generalised Statement: this is my Code </p>\n\n<pre><code>mkBTree xs\n    | (m == 0) = Leaf (unwrap xs)\n| otherwise = Fork (mkBTree ys) (mkBTree zs)\nwhere m = (length xs) `div` 2\n      (ys, zs) = splitAt m xs\n              unwrap [x] = x\n</code></pre>\n\n<p>but the only thing i get is something like: </p>\n\n<pre><code>Data constructor not in scope: Leaf :: a -&gt; t\nData constructor not in scope: Fork :: t -&gt; t -&gt; t\n</code></pre>\n\n<p>Failed, modules loaded: none.\nWhat is wrong here?</p>\n"}, {"tags": ["list", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1495203212, "post_id": 44064830, "comment_id": 75168640, "body": "For your particular application, is it important to preserve the pair order when only one variant is in the list?  (For example, if the list consists of only <code>[(2,1)]</code>, could you &quot;simplify&quot; the list to <code>[(1,2)]</code>?  Most of the answers given below assume you need to preserve pairs without inverted duplicates, but the solution might be simpler if you don&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 5008, "user_id": 5762796, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b3acb5c2021f4c279f29d61481b28e15?s=128&d=identicon&r=PG&f=1", "display_name": "Aleph0", "link": "https://stackoverflow.com/users/5762796/aleph0"}, "edited": false, "score": 0, "creation_date": 1495182462, "post_id": 44065013, "comment_id": 75154315, "body": "I think it should be nubBy instead of nubby. Great solution!"}, {"owner": {"reputation": 25491, "user_id": 49197, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15ebf24a33a29b9efbf9924f530dd736?s=128&d=identicon&r=PG", "display_name": "Hynek -Pichi- Vychodil", "link": "https://stackoverflow.com/users/49197/hynek-pichi-vychodil"}, "edited": false, "score": 0, "creation_date": 1495182848, "post_id": 44065013, "comment_id": 75154558, "body": "It is O(n^2). <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html#v:nub\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.9.1.0/docs/&hellip;</a>"}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 3, "last_activity_date": 1495182501, "last_edit_date": 1495182501, "creation_date": 1495182366, "answer_id": 44065013, "question_id": 44064830, "link": "https://stackoverflow.com/questions/44064830/removing-inverted-duplicates-from-list-of-tuples/44065013#44065013", "title": "Removing inverted duplicates from list of tuples", "body": "<p>You can filter them using your own function:</p>\n\n<pre><code>checkEqTuple :: (a, b) -&gt; (a, b) -&gt; Bool\ncheckEqTuple (x, y) (x', y') | (x==y' &amp;&amp; y == x') = True\n                             | (x==x' &amp;&amp; y == y') = True\n                             | otherwise          = False\n</code></pre>\n\n<p>then use <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html#v:nubBy\" rel=\"nofollow noreferrer\">nubBy</a></p>\n\n<pre><code>Prelude Data.List&gt; nubBy checkEqTuple [(1,2), (2,1)]\n[(1,2)]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25491, "user_id": 49197, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15ebf24a33a29b9efbf9924f530dd736?s=128&d=identicon&r=PG", "display_name": "Hynek -Pichi- Vychodil", "link": "https://stackoverflow.com/users/49197/hynek-pichi-vychodil"}, "edited": false, "score": 0, "creation_date": 1495183465, "post_id": 44065264, "comment_id": 75154953, "body": "You don&#39;t have to check (b, a) membership if you already set both variants into the set."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 25491, "user_id": 49197, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15ebf24a33a29b9efbf9924f530dd736?s=128&d=identicon&r=PG", "display_name": "Hynek -Pichi- Vychodil", "link": "https://stackoverflow.com/users/49197/hynek-pichi-vychodil"}, "edited": false, "score": 0, "creation_date": 1495183518, "post_id": 44065264, "comment_id": 75154980, "body": "@Hynek-Pichi-Vychodil That is true. Thanks! Corrected."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1495186517, "post_id": 44065264, "comment_id": 75157006, "body": "This could also be expressed as a fold. For example, if order is important, then something like <code>snd . foldr (\\ pair@(a, b) acc@(seen, result) -&gt; if pair `Set.member` seen || (b, a) `Set.member` seen then acc else (Set.insert pair seen, pair : result)) mempty</code>, or a version with <code>foldl&#39;</code> if filtering should go the other direction."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1495187217, "post_id": 44065264, "comment_id": 75157496, "body": "then with this solution the problem is solver in insertion right?"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1495187842, "post_id": 44065264, "comment_id": 75157942, "body": "@JonPurdy That&#39;s an excellent point - always pays to think if something is a <code>fold</code>. Thanks."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1495187868, "post_id": 44065264, "comment_id": 75157965, "body": "@DanielSanchez Sorry, I didn&#39;t understand your comment."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1495188057, "post_id": 44065264, "comment_id": 75158086, "body": "@AmiTavory, sorry I did not understood properly your code, I had check it now, and I understand now :). Very good solution"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1495188166, "post_id": 44065264, "comment_id": 75158174, "body": "@DanielSanchez Thanks. I like the simplicity &amp; reuse in your answer."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 5, "last_activity_date": 1495183560, "last_edit_date": 1495183560, "creation_date": 1495183164, "answer_id": 44065264, "question_id": 44064830, "link": "https://stackoverflow.com/questions/44064830/removing-inverted-duplicates-from-list-of-tuples/44065264#44065264", "title": "Removing inverted duplicates from list of tuples", "body": "<p>Perhaps an efficient way to do so (<em>O(n log(n))</em>) would be to track the tuples (and their reverses) already added, using <a href=\"https://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Set.html\" rel=\"nofollow noreferrer\"><code>Set</code></a>:</p>\n\n<pre><code>import qualified Data.Set as Set                                                                                                                                                                        \n\nremoveDups' :: Ord a =&gt; [(a, a)] -&gt; Set.Set (a, a) -&gt; [(a, a)]\nremoveDups' [] _ = []\nremoveDups' ((a, b):tl) s | (a, b) `Set.member` s = removeDups' tl s\nremoveDups' ((a, b):tl) s | (b, a) `Set.member` s = removeDups' tl s\nremoveDups' ((a, b):tl) s = ((a, b):rest) where\n    s' = Set.insert (a, b) s\n    rest = removeDups' tl s'\n\nremoveDups :: Ord a =&gt; [(a, a)] -&gt; [(a, a)]\nremoveDups l = removeDups' l (Set.fromList [])\n</code></pre>\n\n<p>The function <code>removeDups</code> calls the auxiliary function <code>removeDups'</code> with the list, and an empty set. For each pair, if it or its inverse are in the set, it is passed; otherwise, both it and its inverses are added, and the tail is processed.                        \\</p>\n\n<p>The complexity is <em>O(n log(n))</em>, as the size of the set is at most linear in <em>n</em>, at each step.                                      </p>\n\n<hr>\n\n<p><strong>Example</strong></p>\n\n<pre><code>...\n\nmain = do\n    putStrLn $ show $ removeDups [(1, 2), (1, 3), (2, 1)]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>$ ghc ord.hs &amp;&amp; ./ord\n[1 of 1] Compiling Main             ( ord.hs, ord.o )\nLinking ord ...\n[(1,2),(1,3)]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1495212589, "last_edit_date": 1495212589, "creation_date": 1495183803, "answer_id": 44065470, "question_id": 44064830, "link": "https://stackoverflow.com/questions/44064830/removing-inverted-duplicates-from-list-of-tuples/44065470#44065470", "title": "Removing inverted duplicates from list of tuples", "body": "<p>I feel like I'm repeating myself a bit, but that's okay. None of this code had been tested or even compiled, so there may be bugs. Suppose we can impose an <code>Ord</code> constraint for efficiency. I'll start with a limited implementation of sets of pairs.</p>\n\n<pre><code>import qualified Data.Set as S\nimport qualified Data.Map.Strict as M\n\nnewtype PairSet a b =\n  PS (M.Map a (S.Set b))\n\nempty :: PairSet a b\nempty = PS M.empty\n\ninsert :: (Ord a, Ord b)\n       =&gt; (a, b) -&gt; PairSet a b -&gt; PairSet a b\ninsert (a, b) (PS m) = PS $ M.insertWith S.union a (S.singleton b) m\n\nmember :: (Ord a, Ord b)\n       =&gt; (a, b) -&gt; PairSet a b -&gt; Bool\nmember (a, b) (PS m) =\n  case M.lookup a m of\n    Nothing -&gt; False\n    Just s -&gt; S.member b s\n</code></pre>\n\n<p>Now we just need to keep track of which pairs we've seen.</p>\n\n<pre><code>order :: Ord a =&gt; (a, a) -&gt; (a, a)\norder p@(a, b)\n  | a &lt;= b = p\n  | otherwise = (b, a)\n\nnubSwaps :: Ord a =&gt; [(a,a)] -&gt; [(a,a)]\nnubSwaps xs = foldr go (`seq` []) xs empty where\n  go p r s\n    | member op s = r s\n    | otherwise = p : r (insert op s)\n    where op = order p\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7100725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc9a9d85a5e8ce09614a0b71a487f9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Art&#250;r Bella", "link": "https://stackoverflow.com/users/7100725/art%c3%bar-bella"}, "is_accepted": false, "score": 0, "last_activity_date": 1520775936, "creation_date": 1520775936, "answer_id": 49220656, "question_id": 44064830, "link": "https://stackoverflow.com/questions/44064830/removing-inverted-duplicates-from-list-of-tuples/49220656#49220656", "title": "Removing inverted duplicates from list of tuples", "body": "<p>If a and b are ordered and compareable, you could just do this:</p>\n\n<pre><code>[(a,b) | (a,b) &lt;- yourList, a&lt;=b]\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 7150642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153854821602676/picture?type=large", "display_name": "Talal Zahid", "link": "https://stackoverflow.com/users/7150642/talal-zahid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 3, "accepted_answer_id": 44065264, "answer_count": 4, "score": 2, "last_activity_date": 1520775936, "creation_date": 1495181715, "last_edit_date": 1495204842, "question_id": 44064830, "link": "https://stackoverflow.com/questions/44064830/removing-inverted-duplicates-from-list-of-tuples", "title": "Removing inverted duplicates from list of tuples", "body": "<p>So basically I have a list of tuples [(a,b)], from which i have to do some filtering. One job is to remove inverted duplicates such that if (a,b) and (b,a) exist in the list, I only take one instance of them. But the list comprehension has not been very helpful. How to go about this in an efficient manner? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["string", "parsing", "haskell", "monads", "traversable"], "comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495166249, "post_id": 44060757, "comment_id": 75147072, "body": "It will be easier to help you if you post this as a MCVE."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495168207, "post_id": 44060757, "comment_id": 75147576, "body": "@Davislor I&#39;m not sure if this question needs an MCVE. The OP is trying to understand the implementation of a function, and not to figure out how to use it."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1495170213, "post_id": 44060757, "comment_id": 75148226, "body": "@duplode Well, I\u2019d like to help, but the code doesn\u2019t compile for me (using Parsec and hiding its <code>string</code>) and I don\u2019t have that book.  Maybe I\u2019m using the wrong <code>try</code> or the wrong version.  I don\u2019t know."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495170523, "post_id": 44060757, "comment_id": 75148328, "body": "@Davislor Leaving out the type signature, <code>\\s -&gt; s &lt;$ try (traverse_ char s) &lt;?&gt; show s</code> typechecks with a sensible type if you try it with <i>parsec</i>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495171183, "post_id": 44060757, "comment_id": 75148565, "body": "@Davislor If you mean an MCVE in the sense of including the definitions of everything so that it runs as written, then sure, I agree it would help (though I&#39;d say a confirmation of what I said in my comments above would also be enough)."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1495171281, "post_id": 44060757, "comment_id": 75148605, "body": "@duplode Okay, it compiles in ghc 8.0.2 if I use <code>{-# LANGUAGE FlexibleContexts #-}</code> and remove the type signature."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495173467, "post_id": 44060757, "comment_id": 75149416, "body": "@Davislor On a second look, I think all of our comments are moot. The title of the question mentions <code>Text.Parser.Char</code>, which pretty much certainly is <a href=\"https://hackage.haskell.org/package/parsers-0.12.4/docs/Text-Parser-Char.html\" rel=\"nofollow noreferrer\">this module</a> -- it does include a <code>string</code> definition exactly as the one in the question."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1495173653, "post_id": 44060757, "comment_id": 75149482, "body": "@duplode That makes sense. Maybe I\u2019m dumb, but I\u2019ll let this be a lesson for myself not to assume readers will figure out what they need to import."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1495174499, "last_edit_date": 1495174499, "creation_date": 1495172858, "answer_id": 44062295, "question_id": 44060757, "link": "https://stackoverflow.com/questions/44060757/string-implementation-in-text-parser-char/44062295#44062295", "title": "&quot;string&quot; Implementation in Text.Parser.Char", "body": "<blockquote>\n  <p>1) Why is <code>show</code> necessary?</p>\n</blockquote>\n\n<p>Because <code>show</code>ing a string (or a <code>Text</code>, etc.) escapes special characters, which makes sense for error messages:</p>\n\n<pre><code>GHCi&gt; import Text.Parsec -- Simulating your scenario with Parsec.\nGHCi&gt; runParser ((\\s -&gt; s &lt;$ try (traverse_ char s) &lt;?&gt; s) \"foo\\nbar\") () \"\" \"foo\"\nLeft (line 1, column 4):\nunexpected end of input\nexpecting foo\nbar\nGHCi&gt; runParser ((\\s -&gt; s &lt;$ try (traverse_ char s) &lt;?&gt; show s) \"foo\\nbar\") () \"\" \"foo\"\nLeft (line 1, column 4):\nunexpected end of input\nexpecting \"foo\\nbar\"\n</code></pre>\n\n<blockquote>\n  <p>2) Why is <code>s &lt;$</code> necessary? Doesn't traverse <code>char s &lt;?&gt; s</code> work the same? In other words, why do we throw away the results of the traversal?</p>\n</blockquote>\n\n<p>The result of the parse is unnecessary because we know in advance that it would be <code>s</code> (if the parse were successful). <code>traverse</code> would needlessly reconstruct <code>s</code> from the results of parsing each individual character. In general, if the results are not needed it is a good idea to use <code>traverse_</code> (which just combines the effects, discarding the results without trying to rebuild the data structure) rather than <code>traverse</code>, so that is likely why the function is written the way it is.</p>\n\n<blockquote>\n  <p>3) What is going on with the traversal?</p>\n</blockquote>\n\n<p><code>traverse_ char s</code> (<code>traverse_</code>, and not <code>traverse</code>, as explained above) is a parser. It tries to parse, in order, each character in <code>s</code>, while discarding the results, and it is built by sequencing parsers for each character in <code>s</code>. It may be helpful to remind that <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/src/Data.Foldable.html#traverse_\" rel=\"nofollow noreferrer\"><code>traverse_</code> is just a fold which uses <code>(*&gt;)</code></a>:</p>\n\n<pre><code>-- Slightly paraphrasing the definition in Data.Foldable:\ntraverse_ :: (Foldable t, Applicative f) =&gt; (a -&gt; f b) -&gt; t a -&gt; f ()\ntraverse_ f = foldr (\\x u -&gt; f x *&gt; u) (pure ())\n</code></pre>\n"}], "owner": {"reputation": 1491, "user_id": 3923882, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f8d4455db0f00ed542fb86deda730d11?s=128&d=identicon&r=PG&f=1", "display_name": "arcticmatt", "link": "https://stackoverflow.com/users/3923882/arcticmatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1495174499, "creation_date": 1495163273, "last_edit_date": 1495173586, "question_id": 44060757, "link": "https://stackoverflow.com/questions/44060757/string-implementation-in-text-parser-char", "title": "&quot;string&quot; Implementation in Text.Parser.Char", "body": "<p>First, just some quick context. I'm going through the <em>Haskell Programming From First Principles</em> book, and ran into the following exercise.</p>\n\n<blockquote>\n  <p>Try writing a Parser that does what <code>string</code> does, but using <code>char</code>.</p>\n</blockquote>\n\n<p>I couldn't figure it out, so I checked out <a href=\"https://hackage.haskell.org/package/parsers-0.12.4/docs/src/Text-Parser-Char.html#CharParsing\" rel=\"nofollow noreferrer\">the source for the implementation</a>. I'm currently trying to wrap my head around it. Here it is:</p>\n\n<pre><code>class Parsing m =&gt; CharParsing m where\n    -- etc.\n    string :: CharParsing m =&gt; String -&gt; m String\n    string s = s &lt;$ try (traverse_ char s) &lt;?&gt; show s\n</code></pre>\n\n<p>My questions are as follows, from most to least specific.  </p>\n\n<ol>\n<li><p>Why is <code>show</code> necessary?</p></li>\n<li><p>Why is <code>s &lt;$</code> necessary? Doesn't <code>traverse char s &lt;?&gt; s</code> work the same? In other words, why do we throw away the results of the traversal?</p></li>\n<li><p>What is going on with the traversal? I get what a list traversal does, so I guess I'm confused about the Applicative/Monad instances for Parser. On a high level, I get that the traversal applies <code>char</code>, which has type <code>CharParsing m =&gt; Char -&gt; m Char</code>, to every character in string <code>s</code>, and then collects all the results into something of type <code>Parser [Char]</code>. So the types make sense, but I have no idea what's going on in the background.</p></li>\n</ol>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell", "random", "ghc"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1495155665, "post_id": 44059855, "comment_id": 75144740, "body": "As you noted, int depends on a number of details. Why not use a generator with an architecture independent operation? One that already provided a serialization format?"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1495158048, "creation_date": 1495158048, "answer_id": 44060141, "question_id": 44059855, "link": "https://stackoverflow.com/questions/44059855/how-do-i-read-enough-data-to-deserialize-a-seed-of-type-int-without-assuming-a-f/44060141#44060141", "title": "How do I read enough data to deserialize a seed of type Int without assuming a fixed number of bits?", "body": "<p>The <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bits.html#t:FiniteBits\" rel=\"nofollow noreferrer\"><code>FiniteBits</code></a> class has got your back.</p>\n\n<pre><code>Data.Bits&gt; finiteBitSize (0 :: Int)\n64\n</code></pre>\n"}], "owner": {"reputation": 120535, "user_id": 123109, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/157c96de3d125abc1c363ff25c20dfaf?s=128&d=identicon&r=PG", "display_name": "Greg Bacon", "link": "https://stackoverflow.com/users/123109/greg-bacon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 44060141, "answer_count": 1, "score": 1, "last_activity_date": 1495158048, "creation_date": 1495155463, "question_id": 44059855, "link": "https://stackoverflow.com/questions/44059855/how-do-i-read-enough-data-to-deserialize-a-seed-of-type-int-without-assuming-a-f", "title": "How do I read enough data to deserialize a seed of type Int without assuming a fixed number of bits?", "body": "<p>We are given that <a href=\"http://hackage.haskell.org/package/random-1.1/docs/System-Random.html#v:mkStdGen\" rel=\"nofollow noreferrer\"><code>mkStdGen</code></a> has type <a href=\"http://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Int.html#t:Int\" rel=\"nofollow noreferrer\"><code>Int</code></a> \u2192 <a href=\"http://hackage.haskell.org/package/random-1.1/docs/System-Random.html#t:StdGen\" rel=\"nofollow noreferrer\"><code>StdGen</code></a> and <code>Int</code> is defined as</p>\n\n<blockquote>\n  <p>A fixed-precision integer type with at least the range <code>[-2^29 .. 2^29-1]</code>. The exact range for a given implementation can be determined by using <a href=\"http://hackage.haskell.org/package/base-4.7.0.1/docs/Prelude.html#v:minBound\" rel=\"nofollow noreferrer\"><code>minBound</code></a> and <a href=\"http://hackage.haskell.org/package/base-4.7.0.1/docs/Prelude.html#v:maxBound\" rel=\"nofollow noreferrer\"><code>maxBound</code></a> from the <a href=\"http://hackage.haskell.org/package/base-4.7.0.1/docs/Prelude.html#t:Bounded\" rel=\"nofollow noreferrer\"><code>Bounded</code></a> class.</p>\n</blockquote>\n\n<p>In other words, <code>Int</code> does not have a fixed upper limit on its width.</p>\n\n<p>The <a href=\"https://twitter.com/ExpertBeginner1\" rel=\"nofollow noreferrer\">Expert Beginner</a> may think, \u2018But GHC uses 31-bit <code>Int</code> on my machine \u2014 good enough for Simon Peyton Jones should be good enough for anyone!\u2019 and with great self-satisfaction write</p>\n\n<pre><code>generator :: IO StdGen\ngenerator = do\n  withBinaryFile \"/dev/urandom\" ReadMode $ \\h -&gt; do\n    let nbytes = 4\n        buf = take nbytes $ repeat (0::Word8)\n        toInt ws =\n          let [a,b,c,d] = (map fromIntegral ws) :: [Word32] in\n            fromIntegral $ (shiftL (clearBit a 7) 24) .|.\n                           (shiftL           b    16) .|.\n                           (shiftL           c     8) .|. d\n    withArray buf $ \\p -&gt; do\n      nread &lt;- hGetBuf h p nbytes\n      when (nread /= nbytes) $ error \"failed read\"\n      bytes &lt;- peekArray nbytes p\n      return $ mkStdGen (toInt bytes)\n</code></pre>\n\n<p>It did not occur to our hero to check a 64-bit GHC:</p>\n\n<pre><code>Prelude&gt; maxBound :: Int\n9223372036854775807\nPrelude&gt; 2^63\n9223372036854775808\n</code></pre>\n\n<p>or some other Haskell whose <code>Int</code> has the minimum 29 bits.</p>\n\n<p>How do we implement <code>generator</code> so as to avoid wasting or overflowing seed bits?</p>\n"}, {"tags": ["haskell", "functor", "either"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1495143865, "post_id": 44058164, "comment_id": 75141436, "body": "You can&#39;t access the <code>Either</code> type from that module, yet not have its related instances in scope. You should define your own <code>Either</code> type instead."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1495144329, "post_id": 44058164, "comment_id": 75141607, "body": "Relevant: <a href=\"http://stackoverflow.com/q/8728596/2751851\"><i>Explicitly import instances</i></a>"}, {"owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "edited": false, "score": 0, "creation_date": 1495144459, "post_id": 44058164, "comment_id": 75141657, "body": "I got something to work by defining my own <code>Either&#39;</code> type."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1495148251, "creation_date": 1495148251, "answer_id": 44059027, "question_id": 44058164, "link": "https://stackoverflow.com/questions/44058164/how-to-disregard-a-standard-module/44059027#44059027", "title": "How to disregard a standard module?", "body": "<p>You have two options:</p>\n\n<h3>Define your own <code>Either</code>.</h3>\n\n<pre><code>module Foo where\nimport Prelude hiding (Either)\n\ndata Either a b = Left a | Right b\n\ninstance Functor (Either a) where ...\n</code></pre>\n\n<h3>Define your own <code>Functor</code>.</h3>\n\n<pre><code>module Bar where\nimport Prelude hiding (Functor)\n\nclass Functor f where\n  fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n\ninstance Functor (Either a) where ...\n</code></pre>\n\n<hr>\n\n<p>As you discovered, you can also just make up non-clashing names rather than hiding things from the <code>Prelude</code>. But learning to hide things is pretty important; for example, you'll see many programs doing this:</p>\n\n<pre><code>import Control.Category\nimport Prelude hiding (id, (.))\n</code></pre>\n\n<p>That's because those programs want to use the more general <code>id</code> and <code>(.)</code> from <code>Control.Category</code> instead of the ones from the prelude.</p>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 44059027, "answer_count": 1, "score": 0, "last_activity_date": 1495148251, "creation_date": 1495143408, "question_id": 44058164, "link": "https://stackoverflow.com/questions/44058164/how-to-disregard-a-standard-module", "title": "How to disregard a standard module?", "body": "<p>As an exercise, I am trying to implement my own version of a standard Functor, in this case <code>Either</code>.</p>\n\n<p>My code looks similar to the standard definition:</p>\n\n<pre><code>instance Functor (Either a) where\n  fmap _ (Left x) = Left x\n  fmap f (Right y) = Right (f y)\n</code></pre>\n\n<p>When I attempt to compile it I get the following error:</p>\n\n<pre><code>ghc --make either.lhs\n[1 of 1] Compiling Main             ( either.lhs, either.o )\n\neither.lhs:14:12: error:\n    Duplicate instance declarations:\n      instance Functor (Either a) -- Defined at either.lhs:14:12\n      instance Functor (Either a) -- Defined in \u2018Data.Either\u2019\nmake: *** [hs] Error 1\n</code></pre>\n\n<p>The compiler sees a conflict with the standard instance defined in Data.Either. This is despite that I do not actually import the Data.Either module in my code. I would like to compile and test my own Functor implementation -- is there some way that I can perhaps hide Data.Either from the compiler to avoid the conflict?</p>\n"}, {"tags": ["haskell", "printing"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1495134836, "post_id": 44055971, "comment_id": 75137106, "body": "That&#39;s pretty weird. What ghc version, and how did you install it?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1495134921, "post_id": 44055971, "comment_id": 75137158, "body": "Is that really the exact contents of your file?"}, {"owner": {"reputation": 37, "user_id": 8028266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df4a53c886b04901f81ccaaf3e16d65?s=128&d=identicon&r=PG&f=1", "display_name": "\u03c9-inconsistent", "link": "https://stackoverflow.com/users/8028266/%cf%89-inconsistent"}, "edited": false, "score": 0, "creation_date": 1495135351, "post_id": 44055971, "comment_id": 75137372, "body": "Yes, those are the contents of my file as modeled after the examples of <a href=\"http://learnyouahaskell.com/input-and-output\" rel=\"nofollow noreferrer\">learnyouahaskell.com/input-and-output</a>."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1495135426, "post_id": 44055971, "comment_id": 75137413, "body": "Are you sure that you&#39;re in fact editing/showing us <code>c:\\my_script.hs</code> and not a <code>my_script.hs</code> in some other directory?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1495137900, "post_id": 44055971, "comment_id": 75138727, "body": "Weird. Just for fun, what happens if you run <code>main</code> from inside GHCi, instead?"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 1, "creation_date": 1495139511, "post_id": 44055971, "comment_id": 75139543, "body": "Try adding an <code>hFlush stdout</code> after your <code>putStrLn</code>? I&#39;m wondering if something funky is happening with buffers in the Command prompt"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1495141579, "post_id": 44055971, "comment_id": 75140517, "body": "@jkeuhlen Sounds like <a href=\"https://en.wikipedia.org/wiki/Waving_a_dead_chicken_%28over_it%29\" rel=\"nofollow noreferrer\">dead-chicken</a> territory to me. <code>putStrLn</code> should already flush the buffer."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1495141656, "post_id": 44055971, "comment_id": 75140550, "body": "Does the Windows command prompt have an equivalent of the *nix-y <code>which</code> command? In other words, can you ask whether, when you run <code>my_script</code>, it is running the <code>my_script.exe</code> that GHC just produced (versus some other thing from elsewhere on your PATH that also happens to be named <code>my_script</code>)?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1495150930, "post_id": 44055971, "comment_id": 75143712, "body": "People are making a good point about shadowing. What if you run it by typing the path? I imagine something like <code>.\\my_script</code>, but I don&#39;t really know Windows too well."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1495172797, "post_id": 44055971, "comment_id": 75149150, "body": "Unlikely to be the problem here, but some Windows editors replace spaces with tabs, which breaks two-dimensional code. That has caused code that appears correct to break for me."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1495264252, "post_id": 44055971, "comment_id": 75189047, "body": "Just to make sure, can you delete the exe, the .o and .hi file and recompile?"}, {"owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "edited": false, "score": 0, "creation_date": 1495394452, "post_id": 44055971, "comment_id": 75221996, "body": "Does it do the same thing if you just have the 1-liner <code>main = putStrLn &quot;Hello, World&quot;</code>? Might exclude anything to do with spaces vs tabs."}], "owner": {"reputation": 37, "user_id": 8028266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df4a53c886b04901f81ccaaf3e16d65?s=128&d=identicon&r=PG&f=1", "display_name": "\u03c9-inconsistent", "link": "https://stackoverflow.com/users/8028266/%cf%89-inconsistent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1495193879, "creation_date": 1495134372, "last_edit_date": 1495193879, "question_id": 44055971, "link": "https://stackoverflow.com/questions/44055971/why-does-a-haskell-script-using-putstrln-hang", "title": "Why does a Haskell script using putStrLn hang?", "body": "<p>On my Windows 7 Home Premium box, why does the following Haskell program hang?</p>\n\n<pre><code>main = do\n    putStrLn \"Hello, World\"\n</code></pre>\n\n<p>The script is compiled (using GHC) like this:</p>\n\n<pre><code>C:\\&gt;ghc --make my_script\n[1 of 1] Compiling Main             ( my_script.hs, my_script.o )\nLinking my_script.exe ...\n</code></pre>\n\n<p>The program is then executed like this:</p>\n\n<pre><code>C:\\&gt;my_script.exe\n</code></pre>\n\n<p>Even after several minutes, there is no output in the <b>Command Prompt</b> window.</p>\n\n<p>GHC version is:</p>\n\n<pre><code>C:\\&gt;ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 8.0.2\n</code></pre>\n\n<p>(Haskell compiler obtained from <a href=\"https://www.haskell.org/platform/windows.html\" rel=\"nofollow noreferrer\">https://www.haskell.org/platform/windows.html</a>.)<hr>\n<strong><em>Update</em></strong> Loading and executing in GHCi yields the following:</p>\n\n<pre><code>C:\\&gt;ghci my_script.hs\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( my_script.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; main\nHello, World\n*Main&gt; :quit\nLeaving GHCi.\n</code></pre>\n"}, {"tags": ["haskell", "type-conversion"], "comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1495127121, "post_id": 44053819, "comment_id": 75132759, "body": "<code>showDate (Date day month year) = &lt;do something with day, month, and year&gt;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 7996595, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/227275469df68e9e9218670936651c6a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Mayer", "link": "https://stackoverflow.com/users/7996595/r-mayer"}, "edited": false, "score": 0, "creation_date": 1495127597, "post_id": 44054057, "comment_id": 75133021, "body": "I know the patternmaching but i really tried all i know in syntax! thanks for helping me!"}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "edited": false, "score": 2, "creation_date": 1495132285, "post_id": 44054057, "comment_id": 75135693, "body": "You should use pattern matching. Pattern Matching is not an afterthought added to the language, but it is part of it&#39;s very core."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 79, "user_id": 7996595, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/227275469df68e9e9218670936651c6a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Mayer", "link": "https://stackoverflow.com/users/7996595/r-mayer"}, "edited": false, "score": 1, "creation_date": 1495140624, "post_id": 44054057, "comment_id": 75140079, "body": "@R.Mayer and in case you are wondering, <i>there is no other way</i>, given the way you have declared things.  If you had defined date with record fields, e.g. <code>data Date = Date { day :: Int, month :: Month, year :: Int }</code>, then you could use e.g <code>year date</code> to extract the year.  But without such a definition, pattern matching is the only way."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 4, "last_activity_date": 1495127637, "last_edit_date": 1495127637, "creation_date": 1495127507, "answer_id": 44054057, "question_id": 44053819, "link": "https://stackoverflow.com/questions/44053819/data-declaration-use-3-parameter/44054057#44054057", "title": "data declaration - use 3 parameter", "body": "<p>You do <code>pattern matching</code> in Haskell:</p>\n\n<pre><code>data Month = Jan | Feb | Mar | Apr | May | Jun | Jul | Aug | Sep | Oct | Nov | Dec deriving (Show)\ndata Date = Date Int Month Int\n\nshowData :: Date -&gt; String\nshowDate (Date day mon year) = \"Date is: \" ++ (show day) ++ \" \" ++ (show mon) ++  \" \" ++ (show year)\n</code></pre>\n\n<p>Note that I derive <code>Show</code> instance for <code>Month</code> type above by using <code>deriving (Show)</code>. Instead of doing it automatically, you can give your hand crafted <code>Show</code> instances like this:</p>\n\n<pre><code>instance Show Month where\n    show Jan = \"January\"\n    show Feb   = \"February\"\n    .... and so on\n</code></pre>\n\n<p>Demo:</p>\n\n<pre><code>*Main&gt; showDate (Date 3 Feb 2017)\n\"Date is: 3 Feb 2017\"\n</code></pre>\n\n<p>Or even like this:</p>\n\n<pre><code>data Month = Jan | Feb | Mar | Apr | May | Jun | Jul | Aug | Sep | Oct | Nov | Dec deriving (Show)\ndata Date = Date Int Month Int deriving (Show)\n</code></pre>\n\n<p>This will automatically derive the Show instance of your data type.</p>\n\n<pre><code>*Main&gt; show (Date 3 Feb 2017)\n\"Date 3 Feb 2017\"\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 7996595, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/227275469df68e9e9218670936651c6a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Mayer", "link": "https://stackoverflow.com/users/7996595/r-mayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 44054057, "answer_count": 1, "score": 1, "last_activity_date": 1495127637, "creation_date": 1495126666, "question_id": 44053819, "link": "https://stackoverflow.com/questions/44053819/data-declaration-use-3-parameter", "title": "data declaration - use 3 parameter", "body": "<p>i'm going to use the data types now but there is sth what i just know from other programming languages.\nimagine that \"Date\" get's (Year Month Day)</p>\n\n<p>when i have</p>\n\n<pre><code>data Month = Jan | Feb | Mar | Apr | May | Jun | Jul | Aug | Sep | Oct | Nov | Dec\ndata Date = Date Int Month Int\n</code></pre>\n\n<p>and i want to have a funktion </p>\n\n<pre><code>showDate :: Date -&gt; String\n</code></pre>\n\n<p>how can i take the 3. parameter from the datatype Date to create the year?\nor to describe better.. how can i create a String with returns for example \"May 18 2017\"</p>\n\n<p>in other languages i would write date[2] for the 3. parameter or date[0] for the 1. </p>\n\n<p>Thanks for help!</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 2, "creation_date": 1495120142, "post_id": 44051426, "comment_id": 75128424, "body": "You tell us. What <i>is</i> the problem? Are you getting an error? Does something not work right? Your question is very vague. Describe exactly what you&#39;re trying to do, what&#39;s actually happening, and what you tried to fix it already."}, {"owner": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1495120843, "post_id": 44051426, "comment_id": 75128944, "body": "I have so many of them. Therefore i thought it is weird and didn&#39;t add them in the beginning."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 2, "creation_date": 1495121834, "post_id": 44051426, "comment_id": 75129593, "body": "Always post errors you get. The less guessing we&#39;re forced to do about what your problem is, the higher chance someone will answer your question. You got lucky that an expert like Willem saw your question."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "edited": false, "score": 0, "creation_date": 1495121064, "post_id": 44051798, "comment_id": 75129101, "body": "thank you! I had changed them but all of them and of course it didn&#39;t work. Why did you use them just for NBlatt? because of [NBlatt] ?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "edited": false, "score": 0, "creation_date": 1495121146, "post_id": 44051798, "comment_id": 75129154, "body": "@Pelin: what do you mean with &quot;<i>Why did you use them just for NBlatt?</i>&quot;."}, {"owner": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "edited": false, "score": 0, "creation_date": 1495121608, "post_id": 44051798, "comment_id": 75129444, "body": "Sorry, was a stupid question. I figured it out now =)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1495121393, "last_edit_date": 1495121393, "creation_date": 1495120844, "answer_id": 44051798, "question_id": 44051426, "link": "https://stackoverflow.com/questions/44051426/what-is-wrong-with-my-haskell-general-tree/44051798#44051798", "title": "What is wrong with my haskell general tree?", "body": "<p>The problem is that if you describe a <strong>list <code>[]</code></strong>, you do this between <strong>square brackets</strong> separated <strong>with commas</strong>, like <code>[1,4,2,5]</code>. <strong>Not between round brackets</strong>: that is a tuple.</p>\n\n<pre><code>tree :: NBaum String\ntree  = <b>NKnoten</b> \"Sonne\" <b>[</b>\n    NKnoten \"Erde\"  <b>[</b>NBlatt \"MOND\"<b>]<b>,</b></b>\n    NBlatt \"Merkur\"<b>,</b>\n    NBlatt \"Venus\"<b>,</b>\n\n    NKnoten \"MARS\" <b>[</b>\n        NBlatt \"PHOBOS\"<b>,</b>  \n        NBlatt \"DEIMOS\" \n    <b>]<b>,</b></b>      \n    NKnoten \"JUPITER\" <b>[</b>\n        NBlatt \"Io\"<b>,</b>\n        NBlatt \"EUROPA\"<b>,</b>\n        NBlatt \"GANYMED\"<b>,</b>\n        NBlatt \"KALLISTO\"\n    <b>]</b>\n<b>]</b></code></pre>\n\n<p>Furthermore - as is highlighted in the code fragment - you (probably accidentally) - wrote the type name (<code>NBaum</code>) instead of constructor name (<code>NKnoten</code>) at the first object (the <code>\"Sonne\"</code>).</p>\n"}], "owner": {"reputation": 97, "user_id": 7953486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aca02eb0d7689dc6bd0a38698146f482?s=128&d=identicon&r=PG&f=1", "display_name": "Pelin", "link": "https://stackoverflow.com/users/7953486/pelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 44051798, "answer_count": 1, "score": 0, "last_activity_date": 1495179223, "creation_date": 1495119901, "last_edit_date": 1495120789, "question_id": 44051426, "link": "https://stackoverflow.com/questions/44051426/what-is-wrong-with-my-haskell-general-tree", "title": "What is wrong with my haskell general tree?", "body": "<p>Here is my code and there are so many things wrong about it that i can't see. \nWhat is the problem? or what \"are\" the problems?? I get these errors for several lines:</p>\n\n<ul>\n<li>Data constructor not in scope. NBaum </li>\n<li>Couldn't match expected type [NBaum [Char]]' with actual type `NBaum [Char]'</li>\n<li>In the second argument of NKnoten', namely `(NBlatt \"Io\")'</li>\n<li><p>In the sixth argument of `NBaum', namely</p>\n\n<pre><code>data NBaum a = NBlatt a | NKnoten a [NBaum a]\nderiving(Eq,Show)\n\n\ntree :: NBaum String\ntree  =   \nNBaum \"Sonne\"  \n(NKnoten \"Erde\"  \n    (NBlatt \"MOND\"  )\n\n)        \n(NBlatt \"Merkur\" )  \n(NBlatt \"Venus\" )  \n\n(NKnoten \"MARS\" \n\n    (NBlatt \"PHOBOS\" )  \n    (NBlatt \"DEIMOS\" )  \n)      \n(NKnoten \"JUPITER\" \n    (NBlatt \"Io\" )  \n    (NBlatt \"EUROPA\" ) \n    (NBlatt \"GANYMED\" )\n    (NBlatt \"KALLISTO\" )\n\n) \n</code></pre></li>\n</ul>\n"}, {"tags": ["haskell", "differentiation"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1495119713, "post_id": 44051280, "comment_id": 75128091, "body": "Well first you should think about <b>how you will represent a rational function</b>..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1495119803, "post_id": 44051280, "comment_id": 75128152, "body": "....in such a way that it will contain all of the information required for easy differentiation.."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1495137636, "post_id": 44051280, "comment_id": 75138591, "body": "You should really explain how your <code>Term</code> is supposed to represent a rational function; that&#39;s quite unclear. It looks more like a representation of a polynomial with integer coefficients."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 3775499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e4ae453ffda1099b6694aa046aa17a5?s=128&d=identicon&r=PG&f=1", "display_name": "MaMa", "link": "https://stackoverflow.com/users/3775499/mama"}, "edited": false, "score": 0, "creation_date": 1495120713, "post_id": 44051663, "comment_id": 75128842, "body": "With the guidelines of our professor we got the following as far as now:  data Term = Monom(Int, Int)                     | Addition[Term] deriving Show;  diff :: Term -&gt; Term diff (Monom(a, b)) = Monom(a*b, b-1)  Our struggle is to add the function for the differentiation of a sum. Can you help us with that?"}, {"owner": {"reputation": 31, "user_id": 3865744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17dd69e7fe8bdb4a3adb916d4c89096d?s=128&d=identicon&r=PG&f=1", "display_name": "SamTay", "link": "https://stackoverflow.com/users/3865744/samtay"}, "reply_to_user": {"reputation": 29, "user_id": 3775499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e4ae453ffda1099b6694aa046aa17a5?s=128&d=identicon&r=PG&f=1", "display_name": "MaMa", "link": "https://stackoverflow.com/users/3775499/mama"}, "edited": false, "score": 0, "creation_date": 1495121506, "post_id": 44051663, "comment_id": 75129383, "body": "I see. Your original question says you are tasked with creating a datatype, but your comment here indicates that the datatypes are already created, you are simply implementing the rest of the function <code>diff</code> so that it works with all values of type <code>Term</code>. I would update your original question, work out the actual logic for subtracting rational functions (or look it up), and then ask a more precise question regarding the Haskell syntax for how to implement it."}], "tags": [], "owner": {"reputation": 31, "user_id": 3865744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17dd69e7fe8bdb4a3adb916d4c89096d?s=128&d=identicon&r=PG&f=1", "display_name": "SamTay", "link": "https://stackoverflow.com/users/3865744/samtay"}, "is_accepted": false, "score": 0, "last_activity_date": 1495120461, "creation_date": 1495120461, "answer_id": 44051663, "question_id": 44051280, "link": "https://stackoverflow.com/questions/44051280/symbolic-differentiation-in-haskell/44051663#44051663", "title": "symbolic differentiation in Haskell", "body": "<p>Haskell has an extremely expressive type system. Don't over think it! Just write a type that can simply capture the definition of a rational function. Since a rational function <code>f(x)</code> is a function that can be written in the form <code>p(x)/q(x)</code> for polynomials <code>p(x)</code> and <code>q(x)</code>, all your rational function type needs to do is encompass is two polynomials:\n</p>\n\n<pre><code>data Polynomial = undefined -- your HW here\n\ndata RationalFunction = Polynomial Polynomial\n\n-- or\n\ndata RationalFunction = { numerator :: Polynomial\n                        , denominator :: Polynomial\n                        }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1495121650, "creation_date": 1495121650, "answer_id": 44052080, "question_id": 44051280, "link": "https://stackoverflow.com/questions/44051280/symbolic-differentiation-in-haskell/44052080#44052080", "title": "symbolic differentiation in Haskell", "body": "<p>You just need to add to the definition of <code>diff</code>. It has already been defined for one of the two constructors of the <code>Term</code> type, <code>Monom</code>. You now need to define it for the other constructor, <code>Addition</code>:</p>\n\n<pre><code>diff (Monom (a, b)) = Monom (a*b, b-1)\ndiff (Addition terms) = ???\n</code></pre>\n\n<p>Think about what the derivative of a polynomial is: the sum of the derivatives of the individual terms.</p>\n\n<p>1)  <code>d/dx x^2 + x == 2*x + 1</code></p>\n\n<p>Now think about how the above polynomial is represented as a <code>Term</code> value:</p>\n\n<p>2 ) <code>Addition [Monom (1,2), Monom (1, 1)]   -- x^2 + x</code></p>\n\n<p>And finally, how would the derivative be represented?</p>\n\n<p>3) <code>Addition [Monom(2, 1),  Monom (1, 0)]  -- 2*x + 1</code></p>\n\n<p>Your task is to replace <code>???</code> in the definition of <code>diff</code> with code that can take something like 2) and produce something like 3).</p>\n"}], "owner": {"reputation": 29, "user_id": 3775499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e4ae453ffda1099b6694aa046aa17a5?s=128&d=identicon&r=PG&f=1", "display_name": "MaMa", "link": "https://stackoverflow.com/users/3775499/mama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 709, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1495133931, "creation_date": 1495119512, "last_edit_date": 1495133931, "question_id": 44051280, "link": "https://stackoverflow.com/questions/44051280/symbolic-differentiation-in-haskell", "title": "symbolic differentiation in Haskell", "body": "<p>I'm new at Haskell-programming and have to do some excercises for my functional development lecture at the university. I got the task to create a datatype, called \"term\" which represents a rational function. The second task is to create a method which differentiates the entered term.</p>\n\n<p>We need a simple solution and constructors for: monomial, Addition, Multiplication, divison</p>\n\n<p>Given:</p>\n\n<pre><code> data Term = Monom (Int, Int) | Addition[Term] deriving Show\n    diff :: Term -&gt; Term\n    diff (Monom(a, b)) = Monom(a*b, b-1)\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Calling the following function will return the corresponsing derivation:</p>\n\n<pre><code>diff (Monom(a,b)) = if b&gt;0 then Monom(a*b, b-1) else Monom(0,0)\n</code></pre>\n\n<p>same for:</p>\n\n<pre><code>diff (Addition(x:xs)) = diff(x)\n</code></pre>\n\n<p>Can anyone tell me how to iterate over all elements in the entered list? The function above returns only the first derivated value..</p>\n\n<p>I appreciate every help or hint!</p>\n"}, {"tags": ["haskell", "nix", "nixos"], "comments": [{"owner": {"reputation": 2373, "user_id": 3335288, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qfxhh.jpg?s=128&g=1", "display_name": "Zimm i48", "link": "https://stackoverflow.com/users/3335288/zimm-i48"}, "edited": false, "score": 0, "creation_date": 1495185317, "post_id": 44047412, "comment_id": 75156111, "body": "The nix way of using development packages is indeed to go through <code>nix-shell</code> like you did. There might be specific issues with Haskell: I would advise you to read the <a href=\"https://nixos.org/nixpkgs/manual/#users-guide-to-the-haskell-infrastructure\" rel=\"nofollow noreferrer\">Haskell section of the nixpkgs manual</a> to learn more."}], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 1, "creation_date": 1495111340, "post_id": 44047561, "comment_id": 75121422, "body": "This method only work for <code>ghc</code> but not for <code>ghc-mod</code>; <code>$ nix-shell -p &quot;haskellPackages.ghcWithPackages (self: with self; [random ghc-mod])&quot;</code>; I am so confuse about nixos haskell system."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1505462252, "post_id": 44047561, "comment_id": 79432354, "body": "I wrote an answer to another question where I explain why it didn&#39;t work: <a href=\"https://stackoverflow.com/a/45023011/450128\">stackoverflow.com/a/45023011/450128</a>  (the question itself isn&#39;t strictly a duplicate)"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 4, "last_activity_date": 1505415975, "last_edit_date": 1505415975, "creation_date": 1495109878, "answer_id": 44047561, "question_id": 44047412, "link": "https://stackoverflow.com/questions/44047412/could-not-find-module-in-nix-shell/44047561#44047561", "title": "Could not find module in nix-shell", "body": "<p>I'm not aware of reasons why this doesn't work. But you could try this command:</p>\n\n<pre><code>nix-shell -p \"haskellPackages.ghcWithPackages (pkgs: with pkgs; [random])\"\n</code></pre>\n\n<p>Works for me. And now <code>ghci</code> sees <code>System.Random</code> package.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>This post is really helpful for beginners in their <code>nix + haskell</code> adventure: </p>\n\n<p><a href=\"http://alpmestan.com/posts/2017-09-06-quick-haskell-hacking-with-nix.html\" rel=\"nofollow noreferrer\">http://alpmestan.com/posts/2017-09-06-quick-haskell-hacking-with-nix.html</a></p>\n"}], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "accepted_answer_id": 44047561, "answer_count": 1, "score": 2, "last_activity_date": 1505415975, "creation_date": 1495109447, "last_edit_date": 1495111393, "question_id": 44047412, "link": "https://stackoverflow.com/questions/44047412/could-not-find-module-in-nix-shell", "title": "Could not find module in nix-shell", "body": "<p>What could be the reason for <code>missing module</code>?</p>\n\n<pre><code>$ nix-shell -p haskellPackages.ghc -p haskellPackages.random\n</code></pre>\n\n<p>give following shell</p>\n\n<pre><code>[nix-shell:~]$ ghci \nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /data/works/dotfiles/ghci\nPrelude&gt; import System.Random\n\n&lt;no location info&gt;: error:\n    Could not find module \u2018System.Random\u2019\n    It is not a module in the current program, or in any known package.\n</code></pre>\n\n<p>And <strong>what is the <code>nix</code> way to install and use Haskell packages?</strong></p>\n\n<p>I thought <code>nixos.haskellPackages.&lt;package&gt;</code> will automatically registered for ghc but it seem like it is not the case.</p>\n\n<p>Reinstall the <code>random</code> inside the shell don't fix it.</p>\n\n<pre><code>[nix-shell:~]$ nix-env -iA nixos.haskellPackages.random\ninstalling \u2018random-1.1\u2019\n\n[nix-shell:~]$ ghc-pkg list | grep -i random\n</code></pre>\n"}, {"tags": ["haskell", "interpreter", "brainfuck"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1495109650, "post_id": 44047146, "comment_id": 75120186, "body": "<a href=\"https://codereview.stackexchange.com/questions/128833/charmander-brainfuck-interpreter-in-haskell\">Here&#39;s some inspiration</a>."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 4, "creation_date": 1495129452, "post_id": 44047146, "comment_id": 75134065, "body": "Brainfuck is less complex than the typical arithmetic parser. It&#39;s equivalent to having a single operator and parentheses. Here&#39;s a parser that fits in this comment: <code>import Text.Parsec; import Text.Parsec.Char; data BF = Op Char | Loop [BF] deriving Show; main = let list =   many cmd; cmd = Op &lt;$&gt; oneOf &quot;&lt;&gt;+-.,&quot; &lt;|&gt; loop; loop = char &#39;[&#39; *&gt; (Loop &lt;$&gt; list) &lt;* char &#39;]&#39; in putStrLn .   show $ runParser list () &quot;&quot; &quot;[-&gt;+&lt;]&quot;</code>"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1495190665, "post_id": 44047146, "comment_id": 75159804, "body": "Those two comments are worth their ---weight--- character count in gold, but I&#39;m still voting to close this as <i>Unclear what you&#39;re asking</i>."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4037451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/inzw5.jpg?s=128&g=1", "display_name": "Sherub Thakur", "link": "https://stackoverflow.com/users/4037451/sherub-thakur"}, "is_accepted": false, "score": 1, "last_activity_date": 1496033697, "creation_date": 1496033697, "answer_id": 44234837, "question_id": 44047146, "link": "https://stackoverflow.com/questions/44047146/interpreter-for-brainfuck-in-haskell/44234837#44234837", "title": "Interpreter for Brainfuck in Haskell", "body": "<p>Some tips to write brainfuck interpreter in a language like haskell.</p>\n\n<p><em>Initially, I was thinking about writing the program using Array. Immediately after I started to implement the interpreter, I realized how inefficient the interpreter would be because there are many changes to the array. Then I switched to use STArray. But aside from holding an array of data pointers, I also need a mutable reference for the output String, which is impossible in STArray. So I was totally stunned.</em></p>\n\n<p>Study about <a href=\"https://en.wikipedia.org/wiki/Zipper_(data_structure)\" rel=\"nofollow noreferrer\">List Zippers</a>. It's a data structure which can be defined -> [Left of the pivot element] {Pivot element} [Right of the pivot element] which in code looks like.</p>\n\n<pre><code>`data Tape a = Tape [a] a [a]`\n</code></pre>\n\n<p>with that you can easily define <code>&gt;</code>, <code>&lt;</code>, <code>+</code>, <code>-</code> etc on this datatype.</p>\n\n<p><em>Writing a monadic parser might be a good idea, I thought then. But it turns out I don't know what kind of expressions I should use to model the problem. I only read a few papers on monadic parsing style and that's all. Brainfuck is much more complicated than naive Add and Minus, etc.</em></p>\n\n<p>That is not true, Brainfuck is rather less complex than a typical arithmetic parser. as pointed out in one of the comments. i.e something like the following should get you on the right track.</p>\n\n<p><code>stripComments = filter (`elem` \"+-&lt;&gt;[],.\")</code></p>\n\n<p>```</p>\n\n<pre><code>token :: Parser Token\ntoken = const TRight &lt;$&gt; char '&gt;'\n  &lt;|&gt; const TLeft  &lt;$&gt; char '&lt;'\n  &lt;|&gt; const TInc   &lt;$&gt; char '+'\n  &lt;|&gt; const TDec   &lt;$&gt; char '-'\n  &lt;|&gt; const TPrint &lt;$&gt; char ','\n  &lt;|&gt; const TRead  &lt;$&gt; char '.'\n  &lt;|&gt; const TLoopS &lt;$&gt; char '['\n  &lt;|&gt; const TLoopE &lt;$&gt; char ']'\n</code></pre>\n\n<p>```</p>\n\n<p>Lastly you will need an evaluation strategy, I would use something like the following for that.\n<code>eval :: String -&gt; Tape Token -&gt; Tape Int -&gt; String</code>\nwhere 1st argument is the input to the program, <code>Tape Token</code> would be the parsed program, <code>Tape Int</code> would be the manipulated values on the tape on which you will apply the values and the last argument would be the output.</p>\n\n<p>I believe this should help you get on the right track.</p>\n\n<p>I once did write something similar <a href=\"https://gist.github.com/sherubthakur/16a784e61efbe54d885ad60c6e18f254\" rel=\"nofollow noreferrer\">https://gist.github.com/sherubthakur/16a784e61efbe54d885ad60c6e18f254</a>.</p>\n"}], "owner": {"reputation": 139, "user_id": 6053118, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Y9Y01.jpg?s=128&g=1", "display_name": "Quentin Liu", "link": "https://stackoverflow.com/users/6053118/quentin-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496033697, "creation_date": 1495108750, "last_edit_date": 1496027775, "question_id": 44047146, "link": "https://stackoverflow.com/questions/44047146/interpreter-for-brainfuck-in-haskell", "title": "Interpreter for Brainfuck in Haskell", "body": "<p>I am doing a Haskell-related problem in <a href=\"https://www.codewars.com/kata/my-smallest-code-interpreter-aka-brainf-star-star-k/train/haskell\" rel=\"nofollow noreferrer\">codewar</a>, which is to write an interpreter for Brainfuck, the famous esoteric language. </p>\n\n<p>Initially, I was thinking about writing the program using <code>Array</code>. Immediately after I started to implement the interpreter, I realized how inefficient the interpreter would be because there are many changes to the array. Then I switched to use <code>STArray</code>. But aside from holding an array of data pointers, I also need a mutable reference for the output <code>String</code>, which is impossible in <code>STArray</code>. So I was totally stunned. </p>\n\n<p>Writing a monadic parser might be a good idea, I thought then. But it turns out I don't know what kind of expressions I should use to model the problem. I only read a few papers on monadic parsing style and that's all. Brainfuck is much more complicated than naive <code>Add</code> and <code>Minus</code>, etc.</p>\n\n<p>Any guidance to solve the problem is appreciated. Below is my code. I post it here only to show how messy the code is. Don't try to compile it, as it is full of type errors. </p>\n\n<pre><code>executeString' :: String -&gt; String -&gt; Maybe String\nexecuteString' []     _     = Just \"\"\nexecuteString' \",\"    _     = Nothing\n-- executeString' source input = Just $ map chr $ elems $ consume \n\nlength' ::String -&gt;  Int \nlength' source = right - left \n    where step (l, r) '&gt;' = (l,   r+1)\n          step (l, r) '&lt;' = (l+1, r)\n          (left, right) = foldl' step (0, 0) source\n\n-- decrement the data pointer \nneverMinus :: Int -&gt; Int \nneverMinus n = if n == 0 then 255 else n - 1 \n\n-- increment the data pointer \nalwaysPlus :: Int -&gt; Int \nalwaysPlus n = if n == 255 then 0 else n + 1 \n\nconsume :: String -&gt; String -&gt; (Array Int Int, Array Int Char) \nconsume source input = runSTArray $ do \n       pointer &lt;- newArray (0, arrlength') 0  \n       forM_ source $ \\t -&gt; do \n           pointed &lt;- readArray pointer point \n           elem &lt;- readArray pointer pointed\n           isWrong &lt;- readArray pointer error \n           status' &lt;- readArray pointer status \n           when (1 == isWrong) $ return 0 \n           when (doJump status') $ return 0\n           case t of \n               '&gt;' -&gt; writeArray pointer point (pointed + 1) \n               '&lt;' -&gt; writeArray pointer point (pointed - 1) \n               '+' -&gt; writeArray pointer pointed (alwaysPlus elem) \n               '-' -&gt; writeArray pointer pointed (neverMinus elem) \n               ',' -&gt; do  index &lt;- readArray pointer inputIndex \n                          writeArray pointer pointed (ord $\n                                head . drop index input)\n                          writeArray pointer inputIndex (index+1)\n                          1 \n               '[' -&gt; writeArray pointer status jump \n               ']' -&gt; writeArray pointer status execute \n       return pointer\n    where arrlength'  = length'' + 4 \n          length'' = length' source \n          strlength' = 1 +  foldl' (\\count s -&gt; case s of \n                                                 '.' -&gt; count + 1) 0 source \n          point      = length'' + 1\n          inputIndex = length'' + 2\n          status     = length'' + 3 -- should the program execute current instruction or jump\n          error      = length'' + 4 -- if there is program error during execution\n\n-- Program status \njump    = 1\nexecute = 0\n\ndoJump :: Int -&gt; Bool\ndoJump jump    = True\nduJump execute = False\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1495102184, "post_id": 44044633, "comment_id": 75115034, "body": "Have you tried to compile the suggested definition? The compiler might tell you why there&#39;s something wrong with that. (And by the way, you should copy the text in your question, and avoid images.)"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1495132876, "post_id": 44044910, "comment_id": 75136003, "body": "The circular linked list used to define <code>repeat</code> doesn&#39;t make this definition of <code>replicate</code> any better than one written in a more straightforward recursive fashion. <code>replicate</code> inherently needs to allocate the full length of the list (lazily). What actually happens in GHC is that the <code>repeat</code> used here will fuse (via rewrite rules) with the <code>take</code>, producing something much like a hand-written <code>replicate</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1495133066, "post_id": 44044910, "comment_id": 75136116, "body": "@dfeuer: it indeed does not improve the definition of <code>replicate</code>, but my point is that it can for some cases improve the definition of others that depend on <code>repeat</code> (and thus improves <code>repeat</code> itself). For instance a hypothetical <code>sumLess</code> that is a test that succeeds if the sum is less. Since you keep working on the same reference, the memory usage will not increase if <code>sumLess</code> is walking through the <code>repeat</code>."}, {"owner": {"reputation": 67, "user_id": 8030342, "user_type": "registered", "profile_image": "https://graph.facebook.com/810317785783715/picture?type=large", "display_name": "Kim Bogdan Fransson", "link": "https://stackoverflow.com/users/8030342/kim-bogdan-fransson"}, "edited": false, "score": 0, "creation_date": 1495437748, "post_id": 44044910, "comment_id": 75233462, "body": "Awesome! Thank you so much for the explanation."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1495103954, "last_edit_date": 1495103954, "creation_date": 1495102327, "answer_id": 44044910, "question_id": 44044633, "link": "https://stackoverflow.com/questions/44044633/insufficient-definition-of-replicate/44044910#44044910", "title": "Insufficient definition of replicate", "body": "<p>First of all there is a small syntax error in the question, it should be:</p>\n\n<pre><code>replicate n x = take n [x,x..]\n--                         ^ no comma\n</code></pre>\n\n<p>but let's not be picky.</p>\n\n<p>Now when you use range syntax (i.e. <code>x..</code>), then <code>x</code> should be of a type that is an instance of <code>Enum</code>. Indeed:</p>\n\n<pre><code>Prelude&gt; :t \\n x -&gt; take n [x,x..]\n\\n x -&gt; take n [x,x..] :: <b>Enum a =&gt;</b> Int -&gt; a -&gt; [a]</code></pre>\n\n<p>You can argue that <code>x,x..</code> will only generate <code>x</code>, but the Haskell compiler does not know that at compile time.</p>\n\n<p>So the type in <code>replicate</code> (in the question) is <strong>too specific</strong>: it implies a type constraint - <code>Enum a</code> - that is actually <em>not</em> necessary.</p>\n\n<p>Your own definition on the other hand is perfectly fine. Haskell has no problem with infinite lists since it uses lazy evaluation. Furthermore because you define <code>xs</code> with <code>xs</code> as tail, you actually constructed a circular linked list which also is better in terms of memory usage.</p>\n"}], "owner": {"reputation": 67, "user_id": 8030342, "user_type": "registered", "profile_image": "https://graph.facebook.com/810317785783715/picture?type=large", "display_name": "Kim Bogdan Fransson", "link": "https://stackoverflow.com/users/8030342/kim-bogdan-fransson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 44044910, "answer_count": 1, "score": 3, "last_activity_date": 1495132445, "creation_date": 1495101703, "last_edit_date": 1495132445, "question_id": 44044633, "link": "https://stackoverflow.com/questions/44044633/insufficient-definition-of-replicate", "title": "Insufficient definition of replicate", "body": "<p>I have a question that I think is rather tricky.</p>\n\n<blockquote>\n  <p>The standard prelude contains the function</p>\n\n<pre><code>replicate :: Int -&gt; a -&gt; [a]\n</code></pre>\n  \n  <p>The following might seem like a reasonable definition for it</p>\n\n<pre><code>replicate n x = take n [x,x,..]\n</code></pre>\n  \n  <p>But it is actually not sufficient. Why not?</p>\n</blockquote>\n\n<p>I know that the <code>replicate</code> function is defined as:</p>\n\n<pre><code>replicate        :: Int -&gt; a -&gt; [a]       \nreplicate n x    =  take n (repeat x)\n</code></pre>\n\n<p>And <code>repeat</code> is defined as:</p>\n\n<pre><code>repeat           :: a -&gt; [a]  \nrepeat x         =  xs where xs = x:xs\n</code></pre>\n\n<p>Is the definition insufficient (from the question) because it uses an infinite list?</p>\n"}, {"tags": ["haskell", "sudoku"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495101784, "post_id": 44043892, "comment_id": 75114779, "body": "Try this for the first  square: <code>concatMap (take 3) (take 3 rows)</code>."}, {"owner": {"reputation": 633, "user_id": 6033474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05444a58b05c7ae2832b2b0886cd04b1?s=128&d=identicon&r=PG&f=1", "display_name": "0248881", "link": "https://stackoverflow.com/users/6033474/0248881"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495102224, "post_id": 44043892, "comment_id": 75115066, "body": "@n.m. That works, but thats just the first square. How do I recursively obtain the rest of the squares so that they are all in one list."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495102523, "post_id": 44043892, "comment_id": 75115288, "body": "Are you really sure you want to do that? If you want to ultimately obtain a list of boxes, there are simpler ways. In order to get to an arbitrary box, you may want to use the <code>drop</code> function."}, {"owner": {"reputation": 633, "user_id": 6033474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05444a58b05c7ae2832b2b0886cd04b1?s=128&d=identicon&r=PG&f=1", "display_name": "0248881", "link": "https://stackoverflow.com/users/6033474/0248881"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1495102604, "post_id": 44043892, "comment_id": 75115347, "body": "Yes, ultimately I need a list which has lists of all the elements that are inside each box."}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 2, "creation_date": 1495102989, "post_id": 44043892, "comment_id": 75115586, "body": "How about: <code>concatMap (chunksOf 3) . transpose . map (chunksOf 3)</code> ? :-)"}, {"owner": {"reputation": 633, "user_id": 6033474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05444a58b05c7ae2832b2b0886cd04b1?s=128&d=identicon&r=PG&f=1", "display_name": "0248881", "link": "https://stackoverflow.com/users/6033474/0248881"}, "reply_to_user": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 0, "creation_date": 1495103278, "post_id": 44043892, "comment_id": 75115758, "body": "@basile-henry It returns an error <code>No instance for (Show ([e0] -&gt; [[e0]]))       (maybe you haven&#39;t applied enough arguments to a function?)       arising from a use of \u2018print\u2019     In a stmt of an interactive GHCi command: print it</code>"}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 1, "creation_date": 1495103329, "post_id": 44043892, "comment_id": 75115787, "body": "Yeah, you&#39;re supposed to apply it to rows: <code>f = concatMap (chunksOf 3) . transpose . map (chunksOf 3)</code> and then <code>f rows</code>"}, {"owner": {"reputation": 633, "user_id": 6033474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05444a58b05c7ae2832b2b0886cd04b1?s=128&d=identicon&r=PG&f=1", "display_name": "0248881", "link": "https://stackoverflow.com/users/6033474/0248881"}, "edited": false, "score": 0, "creation_date": 1495103686, "post_id": 44043892, "comment_id": 75116009, "body": "Sorry my bad, it works! Thanks a lot :)"}], "answers": [{"tags": [], "owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "is_accepted": true, "score": 1, "last_activity_date": 1495104568, "last_edit_date": 1495541894, "creation_date": 1495104568, "answer_id": 44045715, "question_id": 44043892, "link": "https://stackoverflow.com/questions/44043892/using-recursion-on-list-of-lists/44045715#44045715", "title": "Using recursion on list of lists", "body": "<p>I'm just going to put the answer here, since the comments section is probably not the right place for people to see it.</p>\n\n\n\n<pre><code>import           Data.List       (transpose)\nimport           Data.List.Split (chunksOf)\n\nsubSquares :: Int -&gt; [[a]] -&gt; [[[a]]]\nsubSquares size = concatMap (chunksOf size)\n                . transpose\n                . map (chunksOf size)\n</code></pre>\n\n<p>For example:</p>\n\n\n\n<pre><code>\u03bb &gt; rows = [[(x, y) | x &lt;- [0..8]] | y &lt;- [0..8]]\n\u03bb &gt; subSquares 3 rows\n[[[(0,0),(1,0),(2,0)],[(0,1),(1,1),(2,1)],[(0,2),(1,2),(2,2)]],[[(0,3),(1,3),(2,3)],[(0,4),(1,4),(2,4)],[(0,5),(1,5),(2,5)]],[[(0,6),(1,6),(2,6)],[(0,7),(1,7),(2,7)],[(0,8),(1,8),(2,8)]],[[(3,0),(4,0),(5,0)],[(3,1),(4,1),(5,1)],[(3,2),(4,2),(5,2)]],[[(3,3),(4,3),(5,3)],[(3,4),(4,4),(5,4)],[(3,5),(4,5),(5,5)]],[[(3,6),(4,6),(5,6)],[(3,7),(4,7),(5,7)],[(3,8),(4,8),(5,8)]],[[(6,0),(7,0),(8,0)],[(6,1),(7,1),(8,1)],[(6,2),(7,2),(8,2)]],[[(6,3),(7,3),(8,3)],[(6,4),(7,4),(8,4)],[(6,5),(7,5),(8,5)]],[[(6,6),(7,6),(8,6)],[(6,7),(7,7),(8,7)],[(6,8),(7,8),(8,8)]]]\n</code></pre>\n\n<p>Which, reformated, gives:</p>\n\n\n\n<pre><code>[ [ [(0,0),(1,0),(2,0)]\n  , [(0,1),(1,1),(2,1)]\n  , [(0,2),(1,2),(2,2)]\n  ]\n, [ [(0,3),(1,3),(2,3)]\n  , [(0,4),(1,4),(2,4)]\n  , [(0,5),(1,5),(2,5)]\n  ]\n, [ [(0,6),(1,6),(2,6)]\n  , [(0,7),(1,7),(2,7)]\n  , [(0,8),(1,8),(2,8)]\n  ]\n, [ [(3,0),(4,0),(5,0)]\n  , [(3,1),(4,1),(5,1)]\n  , [(3,2),(4,2),(5,2)]\n  ]\n, [ [(3,3),(4,3),(5,3)]\n  , [(3,4),(4,4),(5,4)]\n  , [(3,5),(4,5),(5,5)]\n  ]\n, [ [(3,6),(4,6),(5,6)]\n  , [(3,7),(4,7),(5,7)]\n  , [(3,8),(4,8),(5,8)]\n  ]\n, [ [(6,0),(7,0),(8,0)]\n  , [(6,1),(7,1),(8,1)]\n  , [(6,2),(7,2),(8,2)]\n  ]\n, [ [(6,3),(7,3),(8,3)]\n  , [(6,4),(7,4),(8,4)]\n  , [(6,5),(7,5),(8,5)]\n  ]\n, [ [(6,6),(7,6),(8,6)]\n  , [(6,7),(7,7),(8,7)]\n  , [(6,8),(7,8),(8,8)]\n  ]\n]\n</code></pre>\n\n<p>Thanks to <a href=\"https://stackoverflow.com/questions/44043892/using-recursion-on-list-of-lists?noredirect=1#comment75114779_44043892\">n.m.</a> for the initial idea. :-)</p>\n"}], "owner": {"reputation": 633, "user_id": 6033474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05444a58b05c7ae2832b2b0886cd04b1?s=128&d=identicon&r=PG&f=1", "display_name": "0248881", "link": "https://stackoverflow.com/users/6033474/0248881"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 44045715, "answer_count": 1, "score": 1, "last_activity_date": 1495104568, "creation_date": 1495099868, "last_edit_date": 1495104232, "question_id": 44043892, "link": "https://stackoverflow.com/questions/44043892/using-recursion-on-list-of-lists", "title": "Using recursion on list of lists", "body": "<p>I have a matrix which is a list with nine lists inside it. A visual representation of my matrix is of a sudoku.</p>\n\n<p><a href=\"https://i.stack.imgur.com/l1reg.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l1reg.jpg\" alt=\"Image of Sudoku\"></a></p>\n\n<p>I need to return the numbers (or elements) in each box (3x3) of the sudoku.\nFor example, the first three rows from this picture would be represented as</p>\n\n<pre><code>rows = \n[[Just 8, Nothing, Nothing, Just 4, Nothing, Just 6, Nothing, Nothing, Just 7],\n[Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Just 4, Nothing, Nothing],\n[Nothing, Just 1, Nothing, Nothing, Nothing, Nothing, Just 6, Just 5, Nothing]]\n</code></pre>\n\n<p>and what I want my function to return for the first box (and later on for the whole sudoku) is</p>\n\n<pre><code>[[Just 8, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Just 1, Nothing], ...]\n</code></pre>\n\n<p>Here is my attempt: I created a function which takes the first three elements from the first three lists and returns them. </p>\n\n<pre><code>getEm :: [[a]] -&gt; [a]\ngetEm x = concatMap (take 3)(take 3 x)\n</code></pre>\n\n<p>I then created another function which would remove the first three elements from the first three lists</p>\n\n<pre><code>dropEm :: Eq a =&gt; [a] -&gt; [a]\ndropEm x = delete itemZ listTwo\n    where\n    listOne = delete itemX x\n    listTwo = delete itemY listOne\n    itemX = (x!!0)\n    itemY = (x!!3)\n    itemZ = (x!!6)`\n</code></pre>\n\n<p>Here is the part I am stuck with. My goal is to create a recursive function which takes a matrix and then uses <code>getEm</code> to take the first three elements of the first three lists (a box) and adds them to a new list <code>finalList</code>. Then the function <code>dropEm</code> removes the first box (first three elements of the first three lists) and then the whole process repeats until the list is empty and there are no \"boxes\" to deal with. When the process is complete, the function just returns <code>finalList</code>.</p>\n\n<p>Here is what I have come up with, but I do not understand how to implement the recursive part with the two functions I created. </p>\n\n<pre><code>boxs m = case startList of\n   [] -&gt; finalList\n\n   where\n   startList = (chunksOf 3 (concat m))\n   finalList = []\n</code></pre>\n"}, {"tags": ["list", "haskell", "typeclass", "sudoku"], "comments": [{"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1495099593, "post_id": 44043658, "comment_id": 75113223, "body": "<code>okList :: Eq a =&gt;  [a]-&gt; Bool</code> should do"}, {"owner": {"reputation": 315, "user_id": 7940372, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e5744471a061ee3bf3a29ce9bb5a4a7?s=128&d=identicon&r=PG&f=1", "display_name": "420fedoras", "link": "https://stackoverflow.com/users/7940372/420fedoras"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1495099905, "post_id": 44043658, "comment_id": 75113466, "body": "@DanielSanchez I knew it had to be simple, was adding it to the type signature for okBlock. For future reference is the type signature in the where clause actually necessary? would I avoid this problem if I didn&#39;t define it?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1495100205, "post_id": 44043658, "comment_id": 75113660, "body": "Local type signatures are indeed usually not necessary, but they can definitely make some sense in big functions where it&#39;s hard to see what the local functions are supposed to do. In this case, I&#39;d leave the local signature, but specialise it to the type instantiation that&#39;s actually used: <code>okList :: [Cell] -&gt; Bool</code>. Or else make it a <i>global</i> definition with the general type <code>Eq a =&gt; [a] -&gt; Bool</code>, and a more descriptive name like <code>hasNoDuplicates</code>."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1495116837, "post_id": 44043658, "comment_id": 75125741, "body": "some notes unrelated to your question: you might find <code>catMaybes</code> useful, be aware of the time complexity of <code>nub</code> and <code>length</code>, useless use of guard where right-hand side is a <code>Bool</code>; instead: <code>okList list = length list == length (nub list)</code>"}, {"owner": {"reputation": 315, "user_id": 7940372, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e5744471a061ee3bf3a29ce9bb5a4a7?s=128&d=identicon&r=PG&f=1", "display_name": "420fedoras", "link": "https://stackoverflow.com/users/7940372/420fedoras"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1495205889, "post_id": 44043658, "comment_id": 75170437, "body": "@jberryman i actually define my own catMaybe as the assignment calls for <code>Nothing</code> s to be returned as &#39;.&#39; s, but I confess I did not know of it before and i will definitely use it later :&#39;)"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1495100792, "last_edit_date": 1495100792, "creation_date": 1495100002, "answer_id": 44043952, "question_id": 44043658, "link": "https://stackoverflow.com/questions/44043658/nub-not-compiling-when-checking-a-list-for-duplicates/44043952#44043952", "title": "nub not compiling when checking a list for duplicates", "body": "<p>Well you can only filter out duplicates, if there is a <strong>way to check whether two values are duplicates</strong>. If we look at the type signature for <code>nub</code>, we see:</p>\n\n<pre><code>nub :: Eq a =&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>So that means that in order to filter out duplicates in a list of <code>a</code>s, we need <code>a</code> to be an instance of the <code>Eq</code> class. We can thus simply forward the type constraint further in the signatures of the functions:</p>\n\n<pre><code>okBlock :: Block Cell -&gt; Bool\nokBlock b = okList $ filter (/= Nothing) b\n where\n  okList :: <b>Eq =&gt; </b>[a] -&gt; Bool\n  okList list\n   | (length list) == (length (nub list)) = True\n   | otherwise                            = False</code></pre>\n\n<p>We do <strong>not</strong> need to specify that <code>Cell</code> is an instance of <code>Eq</code> because:</p>\n\n<ul>\n<li><code>Int</code> is an instance of <code>Eq</code>;</li>\n<li>if <code>a</code> is an instance of <code>Eq</code>, so is <code>Maybe a</code>, so <code>Maybe Int</code> is an instance of <code>Eq</code>; and</li>\n<li>if <code>a</code> is an instance of <code>Eq</code>, so is <code>[a]</code>, so <code>[Maybe Int]</code> is an instance of <code>Eq</code>.</li>\n</ul>\n\n<p>That being said we can do some syntactical improvements of the code:</p>\n\n<ul>\n<li>there is no need to work with guards if you simply return the result of the guard <code>True</code> and <code>False</code>, and</li>\n<li>you can use an <em>eta reduction</em> and omit the <code>b</code> in <code>okBlock</code>.</li>\n<li>you don't need parentheses around function application (unless to feed to result straight to another, non-infix function).</li>\n</ul>\n\n<p>This gives us:</p>\n\n<pre><code>okBlock :: Block Cell -&gt; Bool\nokBlock = okList . filter (/= Nothing)\n  where\n    okList :: Eq =&gt; [a] -&gt; Bool\n    okList list = length list == length (nub list)\n</code></pre>\n\n<p>A final note is that usually you do <strong>not have to specify a type signature</strong>. In that case Haskell will aim to dervice the most generic type signature. So you can write:</p>\n\n<pre><code>okBlock = okList . filter (/= Nothing)\n  where\n    okList list = length list == length (nub list)\n</code></pre>\n\n<p>Now <code>okBlock</code> will have type:</p>\n\n<pre><code>Prelude Data.List&gt; :t okBlock\nokBlock :: Eq a =&gt; [Maybe a] -&gt; Bool\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 315, "user_id": 7940372, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e5744471a061ee3bf3a29ce9bb5a4a7?s=128&d=identicon&r=PG&f=1", "display_name": "420fedoras", "link": "https://stackoverflow.com/users/7940372/420fedoras"}, "edited": false, "score": 0, "creation_date": 1495205631, "post_id": 44059485, "comment_id": 75170267, "body": "this is very good information (and warning) for the future, however I don&#39;t believe it will be a problem here as this function will only encounter lists of length 9 (a single row, column, or square of a sudoku), and I only work with 81 total elements"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1495152166, "creation_date": 1495152166, "answer_id": 44059485, "question_id": 44043658, "link": "https://stackoverflow.com/questions/44043658/nub-not-compiling-when-checking-a-list-for-duplicates/44059485#44059485", "title": "nub not compiling when checking a list for duplicates", "body": "<p>Three points that are too big to make in a comment.</p>\n\n<h3><code>nub</code> is horribly slow</h3>\n\n<p><code>nub</code> takes <code>O(n^2)</code> time to process a list of length <code>n</code>. Unless you know the list is very short, this is the <em>wrong function</em> to use to remove duplicates from a list. Adding a bit more information about what sort of thing you're working with allows more efficient nubbing. The simplest, and probably most general, approach that isn't absolutely wretched is to use an <code>Ord</code> constraint:</p>\n\n<pre><code>import qualified Data.Set as S\n\nnubOrd :: Ord a =&gt; [a] -&gt; [a]\nnubOrd = go S.empty where\n  go _seen [] = []\n  go seen (a : as)\n    | a `S.member` seen = go seen as\n    | otherwise = go (S.insert a seen) as\n</code></pre>\n\n<h3><code>length</code> is wasteful</h3>\n\n<p>Suppose I write</p>\n\n<pre><code>sameLength :: [a] -&gt; [b] -&gt; Bool\nsameLength xs ys = length xs == length ys\n</code></pre>\n\n<p>(which uses the approach you did). Now imagine I calculate</p>\n\n<pre><code>sameLength [1..16] [1..2^100]\n</code></pre>\n\n<p>How long will that take? Calculating <code>length [1..16]</code> will take nanoseconds. Calculating <code>length [1..2^100]</code> will probably take billions of years using current hardware. Whoops. What's the right way? Pattern match!</p>\n\n<pre><code>sameLength [] [] = True\nsameLength (_ : xs) (_ : ys) = sameLength xs ys\nsameLength _ _ = False\n</code></pre>\n\n<h3>Nubbing isn't the right solution to this problem</h3>\n\n<p>Suppose I ask <code>noDuplicates (1 : [1,2..])</code>. Obviously, there's a duplicate, right at the beginning. But if I use <code>sameLength</code> and <code>nub</code> to check, I will <em>never get an answer</em>. It will keep building the nubbed list and comparing it to the original list until the <code>seen</code> becomes so large it exhausts your computer's memory. How can you fix that? By directly calculating what you need:</p>\n\n<pre><code>noDuplicates = go S.empty where\n  go _seen [] = True\n  go seen (x : xs)\n    | x `S.member` seen = False\n    | otherwise = go (S.insert x seen) xs\n</code></pre>\n\n<p>Now the program will conclude that there's a duplicate the moment it sees the second <code>1</code>.</p>\n"}], "owner": {"reputation": 315, "user_id": 7940372, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3e5744471a061ee3bf3a29ce9bb5a4a7?s=128&d=identicon&r=PG&f=1", "display_name": "420fedoras", "link": "https://stackoverflow.com/users/7940372/420fedoras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 44043952, "answer_count": 2, "score": 0, "last_activity_date": 1495152166, "creation_date": 1495099303, "last_edit_date": 1495102827, "question_id": 44043658, "link": "https://stackoverflow.com/questions/44043658/nub-not-compiling-when-checking-a-list-for-duplicates", "title": "nub not compiling when checking a list for duplicates", "body": "<p>Working on a sudoku inspired assignment and I need to implement a function that checks if a <code>Block Cell</code> has no repeated elements in it (to check if its a valid solution to the puzzle).</p>\n\n<pre><code>okBlock :: Block Cell -&gt; Bool\nokBlock b = okList $ filter (/= Nothing) b\n where\n  okList :: [a]-&gt; Bool\n  okList list\n   | (length list) == (length (nub list)) = True\n   | otherwise                            = False\n</code></pre>\n\n<ul>\n<li><code>Block a = [a]</code></li>\n<li><code>Cell = [Maybe Int]</code></li>\n</ul>\n\n<p>Haskell complains saying <code>No instance for (Eq a) arising from a use of \"==\" Possible fix: add (Eq a) to the context of the type signature for okList...</code></p>\n\n<p>Adding <code>Eq a</code> to the type signature does not help. I have tried the function in the terminal and it works fine for for lists, and for lists of lists (i.e the type I am feeding it in the function).</p>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["haskell", "dictionary", "existential-type"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 7, "creation_date": 1495095971, "post_id": 44040082, "comment_id": 75110648, "body": "What problem are you trying to solve that you think <code>DMap</code> will help you with?"}, {"owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1495102064, "post_id": 44040082, "comment_id": 75114972, "body": "I was thinking maybe it could be used to make a map where the values may have any different type depending on the type of key."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 2, "creation_date": 1495103918, "post_id": 44040082, "comment_id": 75116177, "body": "Well, there is one in the <a href=\"https://github.com/mokus0/dependent-map\" rel=\"nofollow noreferrer\">README</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1496030869, "post_id": 44040082, "comment_id": 75478646, "body": "<code>DMap</code> is used very heavily in <code>reflex</code>, so you can take a look at that package."}], "answers": [{"tags": [], "owner": {"reputation": 1138, "user_id": 3168464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DFToz.png?s=128&g=1", "display_name": "Vasiliy Kevroletin", "link": "https://stackoverflow.com/users/3168464/vasiliy-kevroletin"}, "is_accepted": false, "score": 0, "last_activity_date": 1528849806, "creation_date": 1528849806, "answer_id": 50827585, "question_id": 44040082, "link": "https://stackoverflow.com/questions/44040082/data-dependent-map-examples/50827585#50827585", "title": "Data.Dependent.Map examples", "body": "<p>From the <a href=\"https://github.com/mokus0/dependent-map/pull/16\" rel=\"nofollow noreferrer\">Updated README.md example</a> pull request. One need to implement <code>GEq</code> and <code>GCompare</code> instances for a GADT:</p>\n\n<pre><code>data Foo a where\n  AnInt   :: Foo Int\n  AString :: Foo String\n\nderiveGEq      ''Foo\nderiveGCompare ''Foo\n\ndmap1 :: DMap Foo Identity\ndmap1 = fromList [AnInt ==&gt; 1, AString ==&gt; \"bar\"]\n\nmain = do\n  print $ dmap1 ! AnInt\n  print $ dmap1 ! AString\n</code></pre>\n"}], "owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 3, "answer_count": 1, "score": 8, "last_activity_date": 1528849806, "creation_date": 1495088629, "last_edit_date": 1496027859, "question_id": 44040082, "link": "https://stackoverflow.com/questions/44040082/data-dependent-map-examples", "title": "Data.Dependent.Map examples", "body": "<p>Are there any examples anywhere of how to use the <a href=\"https://hackage.haskell.org/package/dependent-map/docs/Data-Dependent-Map.html\" rel=\"noreferrer\"><code>DMap</code></a> type? The package documentation is very learned, and I know it if for reference only, but it is singularly unhelpful for one getting started. Google reveals nothing that I can see.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1495081193, "post_id": 44038419, "comment_id": 75103317, "body": "<code>flip</code> <i>is</i> how you switch the argument order."}, {"owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1495082160, "post_id": 44038419, "comment_id": 75103530, "body": "But my question is why cant you call runState with its arguments in the normal order in this context, not about what flip does. I don&#39;t know how to invoke the do in this way."}], "answers": [{"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 1, "last_activity_date": 1495081488, "creation_date": 1495081488, "answer_id": 44038557, "question_id": 44038419, "link": "https://stackoverflow.com/questions/44038419/runstate-and-do-blocks/44038557#44038557", "title": "runState and do blocks", "body": "<p>The argument order for <code>runState</code> was probably chosen based on the assumption that the starting state (the second argument) would vary more frequently than the action (the first argument). If you want to flip the argument order, there's nothing else for it other than to use <code>flip</code> (or some other equivalent method). That's exactly what flip is for.</p>\n\n<p>If you'd like, you can give <code>flip runState</code> a name to make it easier to reuse. For example, <a href=\"https://hackage.haskell.org/package/lens-4.15.2/docs/src/Control.Lens.Lens.html#%26~\" rel=\"nofollow noreferrer\">lens has <code>&amp;~</code></a> for (the equivalent of) <code>flip execState</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1495082123, "creation_date": 1495082123, "answer_id": 44038654, "question_id": 44038419, "link": "https://stackoverflow.com/questions/44038419/runstate-and-do-blocks/44038654#44038654", "title": "runState and do blocks", "body": "<blockquote>\n  <p>how to put the do block as the first argument to runState?</p>\n</blockquote>\n\n<p>You can enclose the do-block in parentheses, as you would do with other expressions:  </p>\n\n<pre><code>  let r = runState (do\n        addItemToMap 101 \"one hundred and one\"\n        addItemToMap 1001 \"one thousand and one\") Map.empty\n</code></pre>\n\n<p>That is a bit awkward, though, which is why <code>flip</code> is often used with <code>runState</code> in the manner you describe.</p>\n"}], "owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 44038654, "answer_count": 2, "score": 0, "last_activity_date": 1495082123, "creation_date": 1495080559, "question_id": 44038419, "link": "https://stackoverflow.com/questions/44038419/runstate-and-do-blocks", "title": "runState and do blocks", "body": "<p>This is a question more pertaining to do block usage than the state monad. In the following code we can use a do block directly with runState, but only by using flip to reverse the order of arguments so that the initial state to use is given first.</p>\n\n<p>Why does one have to use the flip construct, in other words, how to put the do block as the first argument to runState?</p>\n\n<pre><code>module Main where\n\nimport qualified Data.Map as Map\nimport Control.Monad.State\n\ntype MapS = Map.Map Int String\n\n-- Add an item (key value pair) to map\naddItemToMap :: Int -&gt; String -&gt; State MapS ()\naddItemToMap x s = modify $ Map.insert x s\n\nmain :: IO ()\nmain = do\n  let r = flip runState Map.empty $ do\n        addItemToMap 101 \"one hundred and one\"\n        addItemToMap 1001 \"one thousand and one\"\n  print r\n</code></pre>\n"}, {"tags": ["function", "haskell", "types", "signature"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 4, "creation_date": 1495070222, "post_id": 44036924, "comment_id": 75100768, "body": "This doesn&#39;t answer the question as stated, but: What are you trying to do? The compiler will already automatically check to see if a type signature fits."}, {"owner": {"reputation": 37, "user_id": 8028266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df4a53c886b04901f81ccaaf3e16d65?s=128&d=identicon&r=PG&f=1", "display_name": "\u03c9-inconsistent", "link": "https://stackoverflow.com/users/8028266/%cf%89-inconsistent"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1495072400, "post_id": 44036924, "comment_id": 75101224, "body": "Essentially, I am trying to get the HUnit test case to pass."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 4, "creation_date": 1495072639, "post_id": 44036924, "comment_id": 75101277, "body": "But what I&#39;m saying is, that is unnecessary. You can just have something like <code>main = return () where _ = [tail, init, reverse] :: [[a] -&gt; [a]]</code> and the compiler will automatically tell you whether the type signature is valid as part of its type checking process (at compile time)."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1495079611, "post_id": 44036924, "comment_id": 75102894, "body": "Let&#39;s go one layer deeper.  Why are you writing unit tests for types?  Some people would consider that unnecessary since programs are type checked at compile time.  What do you gain by ensuring the type matches what you expected at some prior date?  Are you trying to make your unit tests ensure the API hasn&#39;t changed?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 3, "creation_date": 1495086747, "post_id": 44036924, "comment_id": 75105122, "body": "In response to the edit: You really don&#39;t need a unit test at all. If that signature in the code failed to type check, the code won&#39;t even run at all. The compiler would reject the program during compilation and provide an appropriate error message. This is a big reason for having a static type system in the first place, actually."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8028266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df4a53c886b04901f81ccaaf3e16d65?s=128&d=identicon&r=PG&f=1", "display_name": "\u03c9-inconsistent", "link": "https://stackoverflow.com/users/8028266/%cf%89-inconsistent"}, "edited": false, "score": 0, "creation_date": 1495107383, "post_id": 44041537, "comment_id": 75118557, "body": "Thanks to all of you for your comments.  You make good points."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 6, "last_activity_date": 1495093299, "creation_date": 1495093299, "answer_id": 44041537, "question_id": 44036924, "link": "https://stackoverflow.com/questions/44036924/in-a-haskell-script-how-does-one-programatically-obtain-the-type-signature-of-a/44041537#44041537", "title": "In a Haskell script, how does one programatically obtain the type signature of a function?", "body": "<p>You don't need a unit test to check a function's type. A unit tests runs after the code has been compiled, it's a dynamic test. However, type checking is a static test: all types are tested during the compilation of your program. Therefore, we can use GHC as a minimal static type checker and reduce your program to:</p>\n\n<pre><code>main :: IO ()\nmain = return ()\n  where\n    tailInitReverseAreListFunctions :: [[a] -&gt; [a]]\n    tailInitReverseAreListFunctions = [tail, init, reverse]\n</code></pre>\n\n<p>You don't even need that test anymore the moment you actually <em>test</em> your functions with real data, because that application will (statically) test the function's type too.</p>\n\n<p>Remember, Haskell is a statically typed language. The types are checked during compilation, <em>before</em> your code is run. Any type checking unit-test is therefore more or less a code-smell, because it can only pass.</p>\n"}], "owner": {"reputation": 37, "user_id": 8028266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df4a53c886b04901f81ccaaf3e16d65?s=128&d=identicon&r=PG&f=1", "display_name": "\u03c9-inconsistent", "link": "https://stackoverflow.com/users/8028266/%cf%89-inconsistent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 1, "accepted_answer_id": 44041537, "answer_count": 1, "score": 0, "last_activity_date": 1495093299, "creation_date": 1495068767, "last_edit_date": 1495091588, "question_id": 44036924, "link": "https://stackoverflow.com/questions/44036924/in-a-haskell-script-how-does-one-programatically-obtain-the-type-signature-of-a", "title": "In a Haskell script, how does one programatically obtain the type signature of a function?", "body": "<p>In Haskell (GHC), how can one obtain the type signature of the list of functions shown below?</p>\n\n<pre><code>[tail,init,reverse]\n</code></pre>\n\n<p>I unsuccessfully tried using the <code>typeOf</code> function of the <code>Data.Typeable</code> module. Specifically, I try to run the following Haskell script:</p>\n\n<pre><code>import Data.Typeable\nimport Test.HUnit\nmyTest = TestCase\n          ( assertEqual \"\\n\\nShould have been \\\"[[a] -&gt; [a]]\\\"\"\n            \"[[a] -&gt; [a]]\"\n            (show ( typeOf [tail,init,reverse] )) )\ntests = TestList [ (TestLabel \"myTest\" myTest) ]\n</code></pre>\n\n<p>However, GHC responds with the following error:</p>\n\n<pre><code>C:\\&gt;ghci my_script.hs\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( my_script.hs, interpreted )\nmy_script.hs:7:21: error:\n    * No instance for (Typeable a0) arising from a use of `typeOf'\n    * In the first argument of `show', namely\n        `(typeOf [tail, init, reverse])'\n      In the third argument of `assertEqual', namely\n        `(show (typeOf [tail, init, reverse]))'\n      In the first argument of `TestCase', namely\n        `(assertEqual\n            \"\\n\\\n            \\\\n\\\n            \\Should have been \\\"[[a] -&gt; [a]]\\\"\"\n            \"[[a] -&gt; [a]]\"\n            (show (typeOf [tail, init, reverse])))'\nFailed, modules loaded: none.\nPrelude&gt;\n</code></pre>\n\n<hr>\n\n<p><strong>Update:</strong> The following HUnit test case isn't quite what I wanted, but I did get it to pass (based on David Young's suggestion).  This test case at least forces the compiler to confirm that <code>[tail,init,reverse]</code> is of type <code>[ [a] -&gt; [a] ]</code>.</p>\n\n<pre><code>import Data.Typeable\nimport Test.HUnit\nmyTest = TestCase\n          ( assertEqual \"\\n\\nShould have been 3\"\n            3\n            ( length ( [tail,init,reverse] :: [[a]-&gt;[a]] ) ) )\ntests = TestList [ (TestLabel \"myTest\" myTest) ]\n</code></pre>\n\n\n\n<pre><code>C:\\&gt;my_script.hs\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( my_script.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; runTestTT tests\nCases: 1  Tried: 1  Errors: 0  Failures: 0\n</code></pre>\n"}]