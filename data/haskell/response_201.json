[{"tags": ["haskell", "existential-type", "singleton-type", "representable"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1542223468, "post_id": 53306846, "comment_id": 93495478, "body": "Well, it must be another existential type, mustn&#39;t it? Presumably <code>(SomeMat a, (Orig, a))</code>. I don&#39;t think the singletons make much difference here. \u2014 Anyways I find it dubious that you&#39;re using dependently-typed dimensions here: since the origin isn&#39;t fixed, different <code>Wind</code>s won&#39;t necessarily match even if they have the same type."}], "owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1542221064, "creation_date": 1542221064, "question_id": 53306846, "link": "https://stackoverflow.com/questions/53306846/how-to-use-the-singletons-library-to-define-a-hasrep-instance-for-existentially", "title": "How to use the singletons library to define a HasRep instance for existentially quantified types?", "body": "<p>I'd like to use existentially sized image windows for a couple of reasons:</p>\n\n<ul>\n<li>I'd like to pack different size windows into the same list.</li>\n<li>I'd like to make a <code>Zip</code> instance for my window type.</li>\n</ul>\n\n<p>I'm using this code to do this:</p>\n\n<pre><code>-- | A \"matrix\" represented as a composition of sized vectors.\ntype Mat h w = Vector h :.: Vector w\n\n-- | A handy alias for locating a window in the 2D plane.\ntype Orig = (Integer,Integer)\n\n-- | An attempt at using `singletons` to define windows.\ndata Wind :: Nat -&gt; Nat -&gt; Type -&gt; Type where  -- height -&gt; width\n  Wind\n    :: (KnownNat h, KnownNat w)\n    =&gt; { img  :: Mat h w a  -- ^ image data matrix\n       , ll   :: Orig       -- ^ position of lower-left corner\n       , dflt :: a          -- ^ out-of-bounds value\n       } -&gt; Wind h w a\n\ndata SomeWind a :: Type where\n  MkSomeWind :: Sing h -&gt; Sing w -&gt; Wind h w a -&gt; SomeWind a\n</code></pre>\n\n<p>Now, I need to make a <code>HasRep</code> instance for my <code>SomeWind</code> type:</p>\n\n<pre><code>import qualified ConCat.Rep as R\n\ninstance R.HasRep (SomeWind a) where\n  type Rep (SomeWind a) = ???\n  repr (MkSomeWind _ _ (Wind im orig def)) = (im, (orig, def))\n  abst (im :: (Vector h :.: Vector w) a, (orig, def)) =\n    MkSomeWind (SNat :: Sing h) (SNat :: Sing w) (Wind im orig def)\n</code></pre>\n\n<p>I have a nagging hunch that I ought to be able to use the <em>singletons</em> library to help me replace the \"???\" above with a correct definition, but I can't figure out how.</p>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["haskell", "typing", "lambda-calculus"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1542217383, "post_id": 53305859, "comment_id": 93492721, "body": "<code>(a -&gt; b) -&gt; a</code> is a type of a function that takes a single argument (which is itself a function). There is no second item to return."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542219233, "post_id": 53305859, "comment_id": 93493496, "body": "It&#39;s the same <code>a</code> throughout; <code>((int -&gt; bool) -&gt; [Char]) -&gt; int</code> isn&#39;t valid, because you can&#39;t unify <code>int</code> and <code>[Char]</code>. Quantification extends as far right as possible."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1542219651, "post_id": 53305859, "comment_id": 93493705, "body": "But more to the point, @n.m. is saying that <code>(a -&gt; b) -&gt; a</code> is not the same as <code>a -&gt; b -&gt; a</code>; the <code>-&gt;</code> operator is right-associative."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1542237488, "post_id": 53307632, "comment_id": 93501181, "body": "You can also go for the halting problem. See my answer, which goes through the excluded middle."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1542234132, "last_edit_date": 1542234132, "creation_date": 1542224352, "answer_id": 53307632, "question_id": 53305859, "link": "https://stackoverflow.com/questions/53305859/are-there-any-valid-definitions-of-this-lambda-statement-in-haskell/53307632#53307632", "title": "Are there any valid definitions of this lambda statement in Haskell?", "body": "<p>It's impossible, except by using infinite recursion or runtime errors, so to fail to terminate.</p>\n\n<p>We can prove that it is indeed impossible, exploiting some results from theoretical computer science. I don't know if there's an easier way to show that it's indeed impossible.</p>\n\n<p>If there were a way to write a terminating program with that type, by the <a href=\"https://en.wikipedia.org/wiki/Curry%E2%80%93Howard_correspondence\" rel=\"nofollow noreferrer\">Curry-Howard correspondence</a>, we would get that the logical formula <code>((a -&gt; b) -&gt; a) -&gt; a</code> (here, read <code>-&gt;</code> as \"implies\") is a theorem of propositional intuitionistic logic.</p>\n\n<p>Such formula is known as <a href=\"https://en.wikipedia.org/wiki/Peirce&#39;s_law\" rel=\"nofollow noreferrer\">Peirce's Law</a>, and is one of the key examples of a formula which is NOT provable in intuitionistic logic (by constrast, it <em>is</em> a theorem in classical logic).</p>\n\n<p>As a reasonably easy way to prove that Peirce's law is not an intuitionistic theorem, one can run a decision procedure for propositional intuitionistic logic, and observe that it outputs \"not a theorem\". As such procedure, we could perform a search for a cut-free proof in Gentzen's LJ sequent calculus: in this way we only need to check a finite (and smallish) number of possible proofs, and observe that each attempt fails.</p>\n"}, {"tags": [], "owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "is_accepted": false, "score": 1, "last_activity_date": 1542225402, "last_edit_date": 1542225402, "creation_date": 1542224658, "answer_id": 53307702, "question_id": 53305859, "link": "https://stackoverflow.com/questions/53305859/are-there-any-valid-definitions-of-this-lambda-statement-in-haskell/53307702#53307702", "title": "Are there any valid definitions of this lambda statement in Haskell?", "body": "<blockquote>\n  <p>The statement (a -> b) -> a would be implemented by taking two items and returning the latter.</p>\n</blockquote>\n\n<p>You're confusing this with <code>a -&gt; b -&gt; a</code> (which can also be written <code>a -&gt; (b -&gt; a)</code>. This is not the same.</p>\n\n<p><code>(a -&gt; b) -&gt; a</code> is a function that takes a single argument and returns a value of type <code>a</code>. The argument has type <code>a -&gt; b</code>, which means it is a function that takes a value of type <code>a</code> and returns a value of type <code>b</code>. This is not unlike (for example) the <code>filter</code> function:</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>This takes two arguments, a predicate function of type <code>a -&gt; Bool</code> and a list of type <code>[a]</code>, and returns a new filtered <code>[a]</code> value by passing each list item to the predicate.</p>\n\n<hr>\n\n<blockquote>\n  <p>I see an issue in that a and b can be any type, so for each instance of a, could a be a different type?</p>\n</blockquote>\n\n<p>No, if it could it would have a different name. <code>a</code> can be any type, but once you pick a type for <code>a</code>, every <code>a</code> in that type signature stands for that type. The <code>b</code> is a different letter, so it can be a different type from <code>a</code>.</p>\n\n<hr>\n\n<p>So, for your type signature <code>((a -&gt; b) -&gt; a) -&gt; a</code>, you would write a function that takes a single argument (another function) and returns an <code>a</code>. The argument function has type <code>(a -&gt; b) -&gt; a</code>, which means it takes a function of type <code>a -&gt; b</code> as an argument and returns an <code>a</code>.</p>\n\n<pre><code>func :: ((a -&gt; b) -&gt; a) -&gt; a\nfunc f = ...\n</code></pre>\n\n<p>The argument <code>f</code>, if called, would return an <code>a</code> that you could then return from <code>func</code>:</p>\n\n<pre><code>func :: ((a -&gt; b) -&gt; a) -&gt; a\nfunc f = f x\n  where x :: a -&gt; b\n        x = ...\n</code></pre>\n\n<p>However, to call <code>f</code> you would need to pass it a function <code>a -&gt; b</code>, for all types <code>a</code> and <code>b</code>. As you don't have such a function available, and there's no way to write such a function in general, I think this is impossible to implement.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1542242107, "last_edit_date": 1542242107, "creation_date": 1542236105, "answer_id": 53309947, "question_id": 53305859, "link": "https://stackoverflow.com/questions/53305859/are-there-any-valid-definitions-of-this-lambda-statement-in-haskell/53309947#53309947", "title": "Are there any valid definitions of this lambda statement in Haskell?", "body": "<p>Suppose you have a function</p>\n\n<pre><code>pierce :: ((a -&gt; b) -&gt; a) -&gt; a\n</code></pre>\n\n<p>Import</p>\n\n<pre><code>data Void\n</code></pre>\n\n<p>from <code>Data.Void</code>.</p>\n\n<p>Now we get to play games. We can instantiate <code>a</code> and <code>b</code> in the type of <code>pierce</code> to whatever we like. Let's define</p>\n\n<pre><code>type A p = Either p (p -&gt; Void)\n</code></pre>\n\n<p>and instantiate with</p>\n\n<pre><code>a ~ A p\nb ~ Void\n</code></pre>\n\n<p>So</p>\n\n<pre><code>pierce :: ((A p -&gt; Void) -&gt; A p) -&gt; A p\n</code></pre>\n\n<p>Let's write a helper:</p>\n\n<pre><code>noNegate :: forall p r. (A p -&gt; Void) -&gt; r\nnoNegate apv = absurd (n m)\n  where\n    m :: p -&gt; Void\n    m = apv . Left\n\n    n :: (p -&gt; Void) -&gt; Void\n    n = apv . Right\n</code></pre>\n\n<p>Now we can go for the kill:</p>\n\n<pre><code>lem :: Either p (p -&gt; Void)\nlem = pierce noNegate\n</code></pre>\n\n<p>If this function existed, it would be very strange.</p>\n\n<pre><code>lem @Void = Right id\nlem @() = Left ()\nlem @Int = Left ... -- some integer, somehow\n</code></pre>\n\n<p>The behavior of this function seems so weird because it violates parametricity, which Haskell functions can't do, but things only get worse for it.</p>\n\n<p>It's possible (but slightly annoying) to encode an arbitrary Turing machine as a Haskell type. And it's possible to design a type representing a proof that a particular Turing machine will halt (basically a type-indexed execution trace). Applying <code>lem</code> at such a trace type would solve the halting problem.</p>\n\n<hr>\n\n<p>Thanks to Haskell's laziness, some \"impossible\" functions turn out to be useful, albeit partial. For example,</p>\n\n<pre><code>fix :: (a -&gt; a) -&gt; a\n</code></pre>\n\n<p>is formally absurd, since <code>fix id</code> claims to give you anything you want. <code>pierce</code> is not such a function. Let's try to write it:</p>\n\n<pre><code>pierce :: ((a -&gt; b) -&gt; a) -&gt; a\npierce f = _\n</code></pre>\n\n<p>What must go on the right side? The <em>only</em> way to make an <code>a</code> is by applying <code>f</code>.</p>\n\n<pre><code>pierce f = f _\n</code></pre>\n\n<p>We must now supply something of type <code>a -&gt; b</code>. We don't have one. We don't know what <code>b</code> <em>is</em>, so we can't pull the usual trick of starting with some <code>b</code> constructor to gain a beat. Nothing can ever improve our <code>b</code>. So the very best we can do is</p>\n\n<pre><code>pierce f = f (const undefined)\n</code></pre>\n\n<p>which doesn't look remotely useful.</p>\n"}], "owner": {"reputation": 55, "user_id": 8218649, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/41371f4d51e71165cb768280ecc4f036?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Bernat", "link": "https://stackoverflow.com/users/8218649/adrian-bernat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 2, "accepted_answer_id": 53307632, "answer_count": 3, "score": 1, "last_activity_date": 1542248754, "creation_date": 1542216895, "last_edit_date": 1542248754, "question_id": 53305859, "link": "https://stackoverflow.com/questions/53305859/are-there-any-valid-definitions-of-this-lambda-statement-in-haskell", "title": "Are there any valid definitions of this lambda statement in Haskell?", "body": "<p>I have the following definition for a function in Haskell.</p>\n\n<pre><code>&gt; q7 :: forall a. forall b. ((a -&gt; b) -&gt; a) -&gt; a\n</code></pre>\n\n<p>I am challenged to either create a definition for it, or state why a definition does not exist. Here are my thoughts:</p>\n\n<p><code>q7</code> takes in any types for <code>a</code> and <code>b</code>. The statement <code>(a -&gt; b) -&gt; a</code> would be implemented by taking two items and returning the latter. Now, if I go one tier further, I can just return this same \"<code>a</code>\" to fulfill <code>((a -&gt; b) -&gt; a) -&gt; a</code>. I see an issue in that <code>a</code> and <code>b</code> can be any type, so for each instance of <code>a</code>, could <code>a</code> be a different type? For example, could it be something like <code>((Int -&gt; Bool) -&gt; [Char]) -&gt; Int</code>? I probably murdered that syntax. If anyone has any hints or if anyone can confirm or deny my ideas, I would appreciate it greatly! </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 1, "creation_date": 1542211620, "post_id": 53303804, "comment_id": 93489474, "body": "That is also a little bit like building an interpreter, so this a few chapters of <a href=\"http://cs.brown.edu/~sk/Publications/Books/ProgLangs/\" rel=\"nofollow noreferrer\">book</a> can help. Oh and it is not haskell specific."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1542227628, "post_id": 53304316, "comment_id": 93497341, "body": "This strategy may need some tweaks depending on exactly what &quot;every variable which is quantified (defined with \u2203 or \u2200) is quantified in its subformula only once&quot; means."}, {"owner": {"reputation": 11, "user_id": 10647955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8306b43a8da4ce75aab475c5dd8f5121?s=128&d=identicon&r=PG&f=1", "display_name": "chickpeas", "link": "https://stackoverflow.com/users/10647955/chickpeas"}, "edited": false, "score": 0, "creation_date": 1542230182, "post_id": 53304316, "comment_id": 93498413, "body": "Yes, I now have edited the question to clarify the satisfactory conditions."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11, "user_id": 10647955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8306b43a8da4ce75aab475c5dd8f5121?s=128&d=identicon&r=PG&f=1", "display_name": "chickpeas", "link": "https://stackoverflow.com/users/10647955/chickpeas"}, "edited": false, "score": 1, "creation_date": 1542230885, "post_id": 53304316, "comment_id": 93498714, "body": "@chickpeas Since you have made some progress thanks to this answer, I encourage you to spend some time thinking about how to modify your code yourself to compute whatever additional information is needed to check the extra conditions. It&#39;s not too hard. If you spend a lot of time thinking and trying things, and still get stuck, then opening a new question here on SO with some details of why you think it&#39;s not possible would be well-received. Make sure to link to this one and explain what progress you have made that differentiates the new question."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 11, "user_id": 10647955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8306b43a8da4ce75aab475c5dd8f5121?s=128&d=identicon&r=PG&f=1", "display_name": "chickpeas", "link": "https://stackoverflow.com/users/10647955/chickpeas"}, "edited": false, "score": 0, "creation_date": 1542231027, "post_id": 53304316, "comment_id": 93498761, "body": "@chickpeas I added some more hints for handling the bound variables."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1542230991, "last_edit_date": 1542230991, "creation_date": 1542211468, "answer_id": 53304316, "question_id": 53303804, "link": "https://stackoverflow.com/questions/53303804/haskell-check-whether-first-order-logic-formula-is-closed-sentence/53304316#53304316", "title": "Haskell - Check whether first order logic formula is closed/sentence", "body": "<p>This is a standard exercise. Here are some hints.</p>\n\n<p>First, define a function which outputs the free variables of a formula.</p>\n\n<pre><code>free :: Formula -&gt; Set String\n</code></pre>\n\n<p>Instead of <code>Set String</code> you can use <code>[String]</code>, if you prefer.\nTo implement this, proceed by induction on the formula. You will need to </p>\n\n<ol>\n<li>compute the union of two sets</li>\n<li>remove a variable from a set</li>\n</ol>\n\n<p>You will probably need to implement these operations, or rely on the standard library (check out <code>Data.Set</code> and <code>Data.List</code> on hoogle).</p>\n\n<p>Afterwards, to check whether a formula is closed you can simply use <code>null (free formula)</code> and obtain the wanted boolean.</p>\n\n<hr>\n\n<p>To implement the part \"each variable must be quantified only once\", it is more convenient to recursively define instead</p>\n\n<pre><code>freeBound :: Formula -&gt; Maybe ([String], [String])\n</code></pre>\n\n<p>to compute, simultaneously, the free and bound variables of the formula. When we find a duplicate bound variable, we return <code>Nothing</code> instead, marking the formula as invalid.</p>\n\n<p>For instance, we need</p>\n\n<pre><code>freeBound (Exists \"X\" (Equal (Fun \"c\" []) (Fun \"c\" [])))\n   = Just ([], [\"X\"])\nfreeBound (Exists \"X\" (Exists \"X\" (Equal (Fun \"c\" []) (Fun \"c\" []))))\n   = Nothing\n</code></pre>\n\n<p>To implement this we probably need some \"membership\" test (<code>elem</code>, to check that we do not quantify a second time) and some \"disjointed\" test (e.g. in <code>And p q</code> we need to ensure that the bound variables of <code>p</code> and <code>q</code> are disjoint).</p>\n\n<p>The <code>Maybe</code> wrapper could be a bit annoying to handle, but some relief to that could be obtained exploiting the monadic or applicative helpers. E.g.</p>\n\n<pre><code>freeBound (And p q) = do\n   (freeP, boundP) &lt;- freeBound p\n   (freeQ, boundQ) &lt;- freeBound q\n   guard (disjoint boundP boundQ)\n   return (freeP `union` freeQ, boundP `union` boundQ)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10647955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8306b43a8da4ce75aab475c5dd8f5121?s=128&d=identicon&r=PG&f=1", "display_name": "chickpeas", "link": "https://stackoverflow.com/users/10647955/chickpeas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542230991, "creation_date": 1542209942, "last_edit_date": 1542229292, "question_id": 53303804, "link": "https://stackoverflow.com/questions/53303804/haskell-check-whether-first-order-logic-formula-is-closed-sentence", "title": "Haskell - Check whether first order logic formula is closed/sentence", "body": "<p>I have a declaration of data types representing a first order logic formula:</p>\n\n<pre><code>    data Term = Var String\n              | Fun String [Term]\n              deriving (Eq, Show, Read)\n\n    data Formula = Pred String [Term]\n                 | Equal Term Term\n                 | Not Formula\n                 | And Formula Formula\n                 | Or Formula Formula\n                 | Implies Formula Formula\n                 | Exists String Formula\n                 | Forall String Formula\n                 deriving (Eq, Show, Read)\n</code></pre>\n\n<p>Now how can I define a function, returning a Bool value, that checks whether a given formula is closed (a sentence)? In closed formula there are no free variables, and every variable which is quantified (defined with \u2203 or \u2200) is quantified in its subformula only once.</p>\n\n<p>EDIT:\nThank you for the directions, I think I now have exactly what you described, a list of free variables of the formula. The problem would be the second part, where every variable, if it is quantified, can be quantified only once.</p>\n\n<p>For example a formula</p>\n\n<pre><code>formula :: Formula\nformula = Exists \"X\" (Exists \"X\" (Equal (Fun \"c\" []) (Fun \"c\" []))) \n</code></pre>\n\n<p>has no free variables, so my function returns <code>True</code>, but <code>\"X\"</code> is defined for <code>\u2203</code> two times, therefore it should not be valid. Formula \u2203X\u03c6 or \u2200X\u03c6 should not contain any subformulae \u2203X\u03c8 or \u2200X\u03c8. </p>\n\n<p>The part of the function obtaining free variables where existential quantifiers are defined looks like this</p>\n\n<pre><code>varFree (Exists x y) = filter (/= x) (varFree y)\nvarFree (Forall x y) = filter (/= x) (varFree y)\n</code></pre>\n\n<p>Any ideas how this could be modified?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 9, "last_activity_date": 1542189997, "creation_date": 1542189997, "answer_id": 53297591, "question_id": 53297408, "link": "https://stackoverflow.com/questions/53297408/haskell-making-int-an-instance-of-my-class/53297591#53297591", "title": "Haskell - Making Int an instance of my class", "body": "<p>There's nothing to pattern-match here. You don't care about the <em>value</em> of the integer, just that it <em>is</em> an integer. Which is already proven by the compiler before even <em>choosing</em> that instance. So, just make it</p>\n\n<pre><code>instance G\u00fcltig Int where\n  istG\u00fcltig _ = Ja\n</code></pre>\n\n<p>Alternatively you could also write <code>istG\u00fcltig a = Ja</code>, but variables that aren't used should not have names (in fact, <code>-Wall</code> will trigger a warning if they do).</p>\n\n<p>OTOH, <code>Int a</code> would only be valid if there was a <em>data type</em> like</p>\n\n<pre><code>data Int = Int {intData :: ???}\n</code></pre>\n\n<p>If fact <code>Int</code> <a href=\"http://hackage.haskell.org/package/ghc-prim-0.5.3/docs/src/GHC.Types.html#Int\" rel=\"noreferrer\"><em>does</em> kind of look like this</a>, but this is a GHC implementation detail:</p>\n\n<pre><code>data {-# CTYPE \"HsInt\" #-} Int = I# Int#\n</code></pre>\n\n<p>Here, <code>#Int</code> is a hard-baked machine representation type. It's an <em>unlifted type</em>, meaning it behaves in some regards different from standard Haskell values. You don't want to deal with this unless you really know why.</p>\n\n<p>Normally, you should just treat <code>Int</code> as an abstract type that can't be further unwrapped or anything. Just use it directly with standard numeric / comparison operators.</p>\n"}], "owner": {"reputation": 35, "user_id": 8500045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cb7437321e2b50315e96a65eef87aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Georg Natter", "link": "https://stackoverflow.com/users/8500045/georg-natter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 53297591, "answer_count": 1, "score": 1, "last_activity_date": 1542189997, "creation_date": 1542189476, "question_id": 53297408, "link": "https://stackoverflow.com/questions/53297408/haskell-making-int-an-instance-of-my-class", "title": "Haskell - Making Int an instance of my class", "body": "<p>When I try to make Int an Instance of my class Gueltig by:</p>\n\n<pre><code>instance Gueltig Int where\n    ist_gueltig (Int a) = Ja\n</code></pre>\n\n<p>, why do I get the error message \"Undefined data constructor \"Int\"\"?\nHow do I make instances of Int?</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["haskell", "bytestring", "aeson"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1542184969, "post_id": 53295922, "comment_id": 93472926, "body": "If <code>ByteString</code> is really the correct type here, then you should probably not be converting it to JSON. Use binary serialisation instead. If those fields actually contain text rather than binary data, then make the type <code>Text</code>. If they do contain binary data but you <i>need</i> to use JSON, use base64 or something like that."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 9, "last_activity_date": 1542191979, "last_edit_date": 1542191979, "creation_date": 1542184723, "answer_id": 53295993, "question_id": 53295922, "link": "https://stackoverflow.com/questions/53295922/haskell-aeson-no-instance-for-tojson-bytestring/53295993#53295993", "title": "Haskell, Aeson - no instance for (ToJSON ByteString)", "body": "<p>That's because there is no <code>ByteString</code> instance for <code>ToJSON</code> typeclass. Historically, it used to be present but it was removed because JSON strings should be valid unicode.</p>\n\n<p>You can find more details here: </p>\n\n<ul>\n<li><a href=\"https://github.com/bos/aeson/issues/126\" rel=\"noreferrer\">https://github.com/bos/aeson/issues/126</a></li>\n<li><a href=\"https://github.com/bos/aeson/commit/9ee73f303cacb8ae73b2325f2f47288522607420\" rel=\"noreferrer\">https://github.com/bos/aeson/commit/9ee73f303cacb8ae73b2325f2f47288522607420</a></li>\n<li><a href=\"https://github.com/bos/aeson/pull/148/files\" rel=\"noreferrer\">https://github.com/bos/aeson/pull/148/files</a></li>\n</ul>\n\n<p>For fixing it, I would convert it to <code>Text</code> type and then encode into JSON.</p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1285, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1542191979, "creation_date": 1542184420, "question_id": 53295922, "link": "https://stackoverflow.com/questions/53295922/haskell-aeson-no-instance-for-tojson-bytestring", "title": "Haskell, Aeson - no instance for (ToJSON ByteString)", "body": "<p>So happy making it this far, encountered a new hurdle: \nGot this code made to be encoded to JSON. However no matter when type I use as an instance, the compiler complains. Now I am obviously doing something wrong, but it is exactly what is in the documentation (when using DeriveGeneric obviously).  </p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings, DeriveGeneric #-}\n\nimport Data.Aeson\nimport Data.Text as T\nimport Data.ByteString.Lazy as B\nimport Data.ByteString.Lazy.Char8 as BC\nimport GHC.Generics\n\n-- decode :: FromJSON a =&gt; B.ByteString -&gt; Maybe a\n-- decode' :: FromJSON a =&gt; B.ByteString -&gt; Either String a\n-- encode :: ToJSON =&gt; a -&gt; B.ByteString\n\ndata System = System  { system :: BC.ByteString\n                  , make :: BC.ByteString\n                  , code :: Int\n                  } deriving (Generic, Show)\ninstance ToJSON System\n-- instance FromJSON System\n\nplatform = System { system = \"FPGA\"\n                  , make = \"Xilinx\"\n                  , code = 10165\n                  }\nencodePlatform :: BC.ByteString\nencodePlatform = encode platform\n</code></pre>\n\n<p>Compiler output: </p>\n\n<pre><code>    \u2022 No instance for (ToJSON ByteString)\n        arising from a use of \u2018aeson-1.4.1.0:Data.Aeson.Types.ToJSON.$dmtoJSON\u2019\n    \u2022 In the expression:\n        aeson-1.4.1.0:Data.Aeson.Types.ToJSON.$dmtoJSON @(System)\n      In an equation for \u2018toJSON\u2019:\n          toJSON = aeson-1.4.1.0:Data.Aeson.Types.ToJSON.$dmtoJSON @(System)\n      In the instance declaration for \u2018ToJSON System\u2019\n   |\n17 | instance ToJSON System\n</code></pre>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1542185086, "post_id": 53294823, "comment_id": 93472992, "body": "As far as I know <code>ViewPatterns</code> is kind of syntactic sugar for function pattern matching, Not function application. The sintax is <code>function -&gt; Constructor</code>. Try by matching the pattern <code>( , )</code>"}, {"owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "reply_to_user": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1542185338, "post_id": 53294823, "comment_id": 93473126, "body": "You can&#39;t pattern match on a function though, you can only apply a function. <code>f = show</code>. Then <code>(f -&gt; x, f -&gt; y) = (1, 2)</code> in GHCi after <code>:set -XViewPatterns</code>. It will give you <code>x == &quot;1&quot;</code> and <code>y == &quot;2&quot;</code>."}, {"owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "reply_to_user": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1542187912, "post_id": 53294823, "comment_id": 93474679, "body": "Based on the answers, it seems like a bug. I&#39;ve created a <a href=\"https://ghc.haskell.org/trac/ghc/ticket/15893#ticket\" rel=\"nofollow noreferrer\">ticket</a> for confirmation."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1542185941, "post_id": 53296277, "comment_id": 93473460, "body": "Answers in stereo :-P"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1542222127, "last_edit_date": 1542222127, "creation_date": 1542185814, "answer_id": 53296277, "question_id": 53294823, "link": "https://stackoverflow.com/questions/53294823/viewpatterns-affects-typechecking-in-an-unpredictable-manner/53296277#53296277", "title": "ViewPatterns affects typechecking in an unpredictable manner", "body": "<p>This is quite weird indeed. It might be a bug.</p>\n\n<p>Modifying the original code as follows</p>\n\n<pre><code>where\nf x = T.pack (V.toList x)\n(f -&gt; t_pre, f -&gt; t_post) = V.splitAt i v\n</code></pre>\n\n<p>makes GHC ask for <code>FlexibleContexts</code>. After doing that, we get a very strange error:</p>\n\n<pre><code>    Variable not in scope: f :: UV.Vector Char -&gt; t\n   |\n12 |     (f -&gt; t_pre, f -&gt; t_post) = V.splitAt i v\n   |      ^\n    Variable not in scope: f :: UV.Vector Char -&gt; t1\n   |\n12 |     (f -&gt; t_pre, f -&gt; t_post) = V.splitAt i v\n   |                  ^\n</code></pre>\n\n<p>This seems like a bug to me. <code>f</code> should be in scope there.</p>\n\n<p>Moving <code>f</code> to global scope:</p>\n\n<pre><code>   ...\n   where\n   (f -&gt; t_pre, f -&gt; t_post) = V.splitAt i v\n\nf x = T.pack (V.toList x)\n</code></pre>\n\n<p>The code now works just fine. It even works if we revert the global <code>f</code> to the pointfree definition.</p>\n\n<p>Using an explicit type annotation, as in</p>\n\n<pre><code>where\nf :: UV.Vector Char -&gt; Text\nf x = T.pack (V.toList x)\n(f -&gt; t_pre, f -&gt; t_post) = V.splitAt i v\n</code></pre>\n\n<p>produces a puzzling error message</p>\n\n<pre><code>\u2022 Variable not in scope: f :: UV.Vector Char -&gt; t\n\u2022 Perhaps you meant \u2018f\u2019 (line 12)\n</code></pre>\n\n<p>I can't understand what's really going on. In GHCi, both these work fine</p>\n\n<pre><code>&gt; let f = id ; foo (f -&gt; x) = x in foo ()\n()\n&gt; let bar = foo () where {f = id ; foo (f -&gt; x) = x} in bar\n()\n</code></pre>\n\n<p>Hence, we can use a local <code>f</code> in view patterns. Still, when the type of <code>f</code> needs some more careful type inference (?), then it can not be used in view patterns. This looks like a bug. At the very least, the error message should be more clear.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542185993, "post_id": 53296287, "comment_id": 93473490, "body": "Note that, weirdly, in some cases we can define <code>f</code> in the same scope (see my answer at the bottom). I have no idea on what triggers the error, and I suspect some interaction with type inference, but it&#39;s only a guess."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1542186111, "post_id": 53296287, "comment_id": 93473550, "body": "@chi No, I still get failures for pattern bindings not under a function (there has to be a name for these!).  E.g. <code>let f = id ; (f -&gt; x) = () in x</code> fails."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542189660, "post_id": 53296287, "comment_id": 93475785, "body": "Argh. So that matters as well. Too weird, it must be some bug. Moreover, <code>let f = id in let (f -&gt; x) = () in x</code> works..."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 4, "last_activity_date": 1542185842, "creation_date": 1542185842, "answer_id": 53296287, "question_id": 53294823, "link": "https://stackoverflow.com/questions/53294823/viewpatterns-affects-typechecking-in-an-unpredictable-manner/53296287#53296287", "title": "ViewPatterns affects typechecking in an unpredictable manner", "body": "<p>You have a problem with <code>f</code> which is caused by the monomorphism restriction.  If you eta expand <code>f</code>, give it a type signature, or turn on <code>NoMonomorphismRestriction</code>, then this error will go away.</p>\n\n<p>But you're still left with these errors, which came as a surprise to me!</p>\n\n<pre><code>Weird.hs:13:6: error:\n    Variable not in scope: f :: UV.Vector Char -&gt; t\n   |\n13 |     (f -&gt; t_pre, f -&gt; t_post) = V.splitAt i v\n   |      ^\n\nWeird.hs:13:18: error:\n    Variable not in scope: f :: UV.Vector Char -&gt; t1\n   |\n13 |     (f -&gt; t_pre, f -&gt; t_post) = V.splitAt i v\n   |                  ^\n</code></pre>\n\n<p>I guess view patterns don't work if they are defined in the same scope.  To see if view patterns needed to be top-level, I tried</p>\n\n<pre><code>bar :: Int -&gt; UV.Vector Char -&gt; (Text, Text)\nbar i v = let (f -&gt; t_pre, f -&gt; t_post) = V.splitAt i v in (t_pre, t_post)\n  where\n    f = T.pack . V.toList\n</code></pre>\n\n<p>which worked fine.  So I tried</p>\n\n<pre><code>f = T.pack . V.toList\n(f -&gt; t_pre, f -&gt; t_post) = V.splitAt 0 UV.empty\n</code></pre>\n\n<p>Which fails with <code>f</code> not in scope.</p>\n\n<p>Finally, if I put those patterns under a function call</p>\n\n<pre><code>f = T.pack . V.toList\ng (f -&gt; t_pre, f -&gt; t_post) = V.splitAt 0 UV.empty\n</code></pre>\n\n<p>then it's fine again.  So I guess the rule is that a \"value\" pattern binding can't use a view pattern which is defined in the same scope.  I find that weird, it might even be a bug.</p>\n"}], "owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "accepted_answer_id": 53296287, "answer_count": 2, "score": 4, "last_activity_date": 1542222127, "creation_date": 1542179441, "last_edit_date": 1542191641, "question_id": 53294823, "link": "https://stackoverflow.com/questions/53294823/viewpatterns-affects-typechecking-in-an-unpredictable-manner", "title": "ViewPatterns affects typechecking in an unpredictable manner", "body": "<p>Consider the following code snippet:</p>\n\n<pre><code>import Data.Text (Text)\nimport qualified Data.Text as T\nimport qualified Data.Vector.Unboxed as UV\nimport qualified Data.Vector.Generic as V\n\nbar :: Int -&gt; UV.Vector Char -&gt; (Text, Text)\nbar i v = (t_pre, t_post)\n  where\n    f = T.pack . V.toList\n    (t_pre, t_post) = (\\(x, y) -&gt; (f x, f y)) $ V.splitAt i v\n</code></pre>\n\n<p>This compiles ok as you might expect. However, if you replace the function calls with view patterns, you get a type error.</p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\n\nimport Data.Text (Text)\nimport qualified Data.Text as T\nimport qualified Data.Vector.Unboxed as UV\nimport qualified Data.Vector.Generic as V\n\nbar :: Int -&gt; UV.Vector Char -&gt; (Text, Text)\nbar i v = (t_pre, t_post)\n  where\n    f = T.pack . V.toList\n    (f -&gt; t_pre, f -&gt; t_post) = V.splitAt i v\n</code></pre>\n\n<p>This prints the following message (with <code>-fprint-potential-instances</code>):</p>\n\n<pre><code>    \u2022 Ambiguous type variable \u2018v0\u2019 arising from a use of \u2018V.toList\u2019\n      prevents the constraint \u2018(V.Vector v0 Char)\u2019 from being solved.\n      Relevant bindings include\n    f :: v0 Char -&gt; Text (bound at Weird.hs:11:5)\n      Probable fix: use a type annotation to specify what \u2018v0\u2019 should be.\n      These potential instances exist:\n    instance V.Vector UV.Vector Char\n      -- Defined in \u2018Data.Vector.Unboxed.Base\u2019\n    ...plus one instance involving out-of-scope types\n      instance primitive-0.6.3.0:Data.Primitive.Types.Prim a =&gt;\n               V.Vector Data.Vector.Primitive.Vector a\n        -- Defined in \u2018Data.Vector.Primitive\u2019\n    \u2022 In the second argument of \u2018(.)\u2019, namely \u2018V.toList\u2019\n      In the expression: T.pack . V.toList\n      In an equation for \u2018f\u2019: f = T.pack . V.toList\n   |\n11 |     f = T.pack . V.toList\n   |                  ^^^^^^^^\n\nWeird.hs:13:6: error:\n    Variable not in scope: f :: UV.Vector Char -&gt; t\n   |\n13 |     (f -&gt; t_pre, f -&gt; t_post) = V.splitAt i v\n   |      ^\n\nWeird.hs:13:18: error:\n    Variable not in scope: f :: UV.Vector Char -&gt; t1\n   |\n13 |     (f -&gt; t_pre, f -&gt; t_post) = V.splitAt i v\n   |                  ^\n</code></pre>\n\n<p>My understanding is that both the ways of expressing things are entirely equivalent, because a view pattern is just function application without naming the bound variable. Am I misunderstanding view patterns? Is it the desugaring that is interacting with the type checker in an unexpected manner? If I inline the definition of <code>f</code> at both the call sites, the type error goes away.</p>\n\n<p>I've tested this with GHCi 8.4.3.</p>\n\n<hr>\n\n<p>Update: This is a compiler bug. See GHC Trac <a href=\"https://ghc.haskell.org/trac/ghc/ticket/14293\" rel=\"nofollow noreferrer\">#14293</a> for more details.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1542177546, "post_id": 53294277, "comment_id": 93469822, "body": "Tip: think about foldr step [] xs ... use foldr and function (:) to construct a list"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "edited": false, "score": 0, "creation_date": 1542246859, "post_id": 53294820, "comment_id": 93503501, "body": "Aha!  I didn&#39;t think it was <i>that</i> difficult, but for some reason I just couldn&#39;t get it put together correctly and just kept getting more confused.  Thanks for helping straighten out my brain!    Playing around with it a little I could use it as a stand-alone lambda expression or in a function and changed it to use a <code>foldl</code> too.  I am loving learning Haskell!"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "reply_to_user": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "edited": false, "score": 0, "creation_date": 1542257863, "post_id": 53294820, "comment_id": 93505785, "body": "@Stormy Yes, Haskell is funny! Actually, foldl can be implemented by foldr, learning that can understand them in deep, if you have interested, see [Defining foldl in terms of foldr] <a href=\"https://stackoverflow.com/questions/6172004/writing-foldl-using-foldr\" title=\"writing foldl using foldr\">stackoverflow.com/questions/6172004/writing-foldl-using-fold&zwnj;&#8203;r</a>"}], "tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 4, "last_activity_date": 1542181153, "last_edit_date": 1542181153, "creation_date": 1542179433, "answer_id": 53294820, "question_id": 53294277, "link": "https://stackoverflow.com/questions/53294277/re-write-map-inttodigit-with-a-fold/53294820#53294820", "title": "Re-write &#39;map intToDigit&#39; with a fold...", "body": "<p>It is not difficult, think about the definition <code>foldr</code> (or <code>foldl</code>) of List:</p>\n\n<pre><code> foldr::(a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\n</code></pre>\n\n<p>Here <code>(a-&gt;b-&gt;b)</code> is the <code>step</code> function which will be applied on each element of list [a], b is your target.</p>\n\n<p>Now, you have a list of Int (<code>[Int]</code>), and need to convert to [Char] (or String).</p>\n\n<p>Relpace <code>[a]</code> by <code>[5,2,8,3,4]</code>, b by <code>[]::[Char]</code> (your target) and <code>(a-&gt;b-&gt;b)</code> by <code>step</code> function :</p>\n\n<pre><code>foldr step ([]::[Char]) [5,2,8,3,4]\n</code></pre>\n\n<p>We have known that <code>step function</code> has type <code>(a-&gt;b-&gt;b)</code>, specifically, <code>(Int-&gt;[Char]-&gt;[Char])</code>, the job need to do just convert <code>Int</code> to <code>[Char]</code>, as mentioned in question: <code>intToDigit</code> can be helped to convert <code>Int</code> to <code>Char</code> and <code>(:)</code> operator can append element at the head of <code>List</code> so:</p>\n\n<pre><code>step x s = intToDigit x : s\n</code></pre>\n\n<p>where s is <code>[Char]</code> (or <code>String</code>), put them all:</p>\n\n<pre><code>foldr (\\x s-&gt;intToDigit x : s) [] [5,2,8,3,4]\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 53294820, "answer_count": 1, "score": 0, "last_activity_date": 1542181153, "creation_date": 1542176864, "question_id": 53294277, "link": "https://stackoverflow.com/questions/53294277/re-write-map-inttodigit-with-a-fold", "title": "Re-write &#39;map intToDigit&#39; with a fold...", "body": "<p>So this one seems like it should be super-simple... but I'm not sure where to stick the 'fold' in (obviously you could fold either way)... </p>\n\n<p>It says \"write a function ( <code>intToString :: [Int] -&gt; [Char]</code> ) using a fold, that mimics this map:</p>\n\n<p><code>map intToDigit [5,2,8,3,4] == \"52834\"</code></p>\n\n<p>And then says, \"For the conversion, use <code>intToDigit :: Int -&gt; Char</code> from <code>Data.Char</code>.\"</p>\n\n<p>I'm not entirely sure I get the point... but yet it doesn't seem like it should be that hard -- you're just reading in the list (folding it in, I get how folds work in general) from either the left or right and doing the conversion... but I'm not sure how to set it up.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1542164724, "post_id": 53292342, "comment_id": 93466605, "body": "What you are asking and how far you have gotten is unclear.  If you have &quot;imported&quot; this file then you shouldn&#39;t have a string.  1. What does the file look like exactly?  2. How are you importing it?  I suspect you have a file with exactly the above quoted data and you haven&#39;t imported it but instead read it a la <code>readFile</code> or similar - hence my question."}, {"owner": {"reputation": 126, "user_id": 4577109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d1e1327d30934016b261f5120179a05?s=128&d=identicon&r=PG&f=1", "display_name": "Famous Jameis", "link": "https://stackoverflow.com/users/4577109/famous-jameis"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1542201685, "post_id": 53292342, "comment_id": 93482915, "body": "then I may not have even imported(read) the file correctly. the file contains exactly whats written."}, {"owner": {"reputation": 1550, "user_id": 8394915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb437a787174e7b83efa53f1a6901006?s=128&d=identicon&r=PG&f=1", "display_name": "cheersmate", "link": "https://stackoverflow.com/users/8394915/cheersmate"}, "edited": false, "score": 0, "creation_date": 1542213411, "post_id": 53292342, "comment_id": 93490601, "body": "Consider saving your data in another format like json."}, {"owner": {"reputation": 126, "user_id": 4577109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d1e1327d30934016b261f5120179a05?s=128&d=identicon&r=PG&f=1", "display_name": "Famous Jameis", "link": "https://stackoverflow.com/users/4577109/famous-jameis"}, "edited": false, "score": 0, "creation_date": 1542221134, "post_id": 53292342, "comment_id": 93494402, "body": "to give some background, this problem i am having is for a stupid class where I need to solve the SAT (google it), I&#39;ve already written a solution but am having a problem finding documentation on getting an ENTIRE (not line by line)file, into a string and converting it into the intended type.  I don&#39;t care about JSON because in a week i won&#39;t care about this assignment, etc etc."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1542347673, "post_id": 53292342, "comment_id": 93544002, "body": "It&#39;s unfortunate that you have such a negative view of a problem on SAT solvers - they are simply amazing and can help you solve really complex problems so quickly you&#39;d feel like a wizard.  Things like breaking encryption algorithms, proving functions correct, detecting deadlocks, isolating bad sensors in self-driving cars, solving sudoko, etc etc. Regardless, if you decide to flesh out the question as mentioned above then you still might find help."}], "answers": [{"tags": [], "owner": {"reputation": 2043, "user_id": 2676937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d42ec82c3feefc3c7e13b37dae77f21?s=128&d=identicon&r=PG", "display_name": "merlyn", "link": "https://stackoverflow.com/users/2676937/merlyn"}, "is_accepted": false, "score": 6, "last_activity_date": 1542165529, "creation_date": 1542165529, "answer_id": 53292707, "question_id": 53292342, "link": "https://stackoverflow.com/questions/53292342/haskell-convert-string-representation-of-integer-list-of-lists-to-integer-list/53292707#53292707", "title": "Haskell: Convert String representation of Integer List of Lists to Integer List of Lists", "body": "<p>You can use the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:read\" rel=\"noreferrer\">read</a> or <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Text-Read.html#v:readMaybe\" rel=\"noreferrer\">readMaybe</a> function.</p>\n\n<p>For example,</p>\n\n<pre><code>b :: [[Int]]\nb = read \"[[3, 4], [4, -5]]\"\n</code></pre>\n"}], "owner": {"reputation": 126, "user_id": 4577109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d1e1327d30934016b261f5120179a05?s=128&d=identicon&r=PG&f=1", "display_name": "Famous Jameis", "link": "https://stackoverflow.com/users/4577109/famous-jameis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1542165529, "creation_date": 1542162499, "question_id": 53292342, "link": "https://stackoverflow.com/questions/53292342/haskell-convert-string-representation-of-integer-list-of-lists-to-integer-list", "title": "Haskell: Convert String representation of Integer List of Lists to Integer List of Lists", "body": "<p>I have a file that contains a list of lists,</p>\n\n<p>namely <code>[[39, 40, 1], [-39, -40, 1], [-39, 40, -1], [1, 41, 2], [-1, -41, 2], [-1, 41, -2], [2, 42, 3], [-2, -42, 3], [-2, 42, -3], [3, 43, 4], [-3, -43, 4], [-3, 43, -4], [4, 44, 5], [-4, -44, 5], [-4, 44, -5], [5, 45, 6], [-5, -45, 6], [-5, 45, -6], [6, 46, 7], [-6, -46, 7], [6, -46, -7], [7, 47, 8], [-7, -47, 8], [7, -47, -8], [-7, 47, -8], [8, 48, 9], [8, -48, -9], [-8, 48, -9], [9, 49, 10], [-9, -49, 10], [9, -49, -10], [-9, 49, -10], [10, 50, 11], [10, -50, -11], [-10, 50, -11], [11, 51, 12], [-11, -51, 12], [11, -51, -12], [-11, 51, -12], [-12, -52, 13], [12, -52, -13], [-12, 52, -13], [-13, -53, 14], [13, -53, -14], [-13, 53, -14], [14, 54, 15], [-14, -54, 15], [14, -54, -15], [-14, 54, -15], [-15, -55, 16], [15, -55, -16], [-15, 55, -16], [16, 56, 17], [-16, -56, 17], [16, -56, -17], [-16, 56, -17], [17, 57, 18], [-17, -57, 18], [-17, 57, -18], [18, 58, 19], [-18, -58, 19], [18, -58, -19], [-18, 58, -19], [19, 59, 60], [-19, -59, 60], [-19, 59, -60], [20, 59, 60], [-20, -59, 60], [20, -59, -60], [-20, 59, -60], [21, 58, 20], [-21, -58, 20], [21, -58, -20], [-21, 58, -20], [22, 57, 21], [-22, -57, 21], [22, -57, -21], [-22, 57, -21], [23, 56, 22], [23, -56, -22], [-23, 56, -22], [24, 55, 23], [-24, -55, 23], [24, -55, -23], [-24, 55, -23], [-25, -54, 24], [25, -54, -24], [-25, 54, -24], [26, 53, 25], [-26, -53, 25], [26, -53, -25], [-26, 53, -25], [27, 52, 26], [-27, -52, 26], [27, -52, -26], [-27, 52, -26], [28, 51, 27], [-28, -51, 27], [-28, 51, -27], [29, 50, 28], [-29, -50, 28], [29, -50, -28], [-29, 50, -28], [30, 49, 29], [-30, -49, 29], [30, -49,-29], [-30, 49, -29], [31, 48, 30], [-31, -48, 30], [31, -48, -30], [-31, 48, -30], [32, 47, 31], [-32, -47, 31], [32, -47, -31], [-32, 47, -31], [33, 46, 32], [33, -46, -32], [-33, 46, -32], [34, 45, 33], [-34, -45, 33], [34, -45, -33], [-34, 45, -33], [35, 44, 34], [-35, -44, 34], [35, -44, -34], [-35, 44, -34],[36, 43, 35], [-36, -43, 35], [-36, 43, -35], [37, 42, 36], [-37, -42, 36], [37, -42, -36], [-37, 42, -36], [38, 41, 37], [-38, -41, 37], [38, -41, -37], [39, 40, -38], [-39, -40, -38], [39, -40, 38], [-39, 40, 38]]</code></p>\n\n<p>I have figured out how to import the file but am having trouble converting it from a String -> [[Int]].</p>\n\n<p>How would I go about do so?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1542132842, "post_id": 53287115, "comment_id": 93456316, "body": "What is <code>length binListToDec</code> supposed to do?"}, {"owner": {"reputation": 123, "user_id": 7182154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1116360391792657/picture?type=large", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/7182154/muhammad-usman"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1542132905, "post_id": 53287115, "comment_id": 93456346, "body": "take the length of the string passed to the function. and if its 0 ( empty) then return 1 as the sum @WillemVanOnsem"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1542132977, "post_id": 53287115, "comment_id": 93456385, "body": "but (a) the list you pass is <code>(x:xs)</code> and (b) the length can never be zero, since <code>(x:xs)</code> is the pattern for a non-empty list."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1542145076, "post_id": 53287300, "comment_id": 93461498, "body": "<code>all@(~(x:xs))</code> meets all three criteria. ...but that&#39;s not to say I recommend it. Just that it&#39;s possible. e.g. <code>binListToDec all@(~(x:xs)) = if length all == 0 then 0 else x + binListToDec xs</code> would work, though it would be slow for all the same reasons your first solution is."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1542149033, "post_id": 53287300, "comment_id": 93462966, "body": "@DanielWagner Thanks; I figured there was some bit of syntax I was forgetting about."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1542149031, "last_edit_date": 1542149031, "creation_date": 1542133348, "answer_id": 53287300, "question_id": 53287115, "link": "https://stackoverflow.com/questions/53287115/taking-sum-of-list-in-haskell/53287300#53287300", "title": "Taking sum of list in Haskell", "body": "<p>Among the myriad ways you could write this, two possibilities would be</p>\n\n<pre><code>binListToDec xs = if length xs == 0 then 0  -- see below\n                  else (head xs) + binListToDec (tail xs)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>binListToDec [] = 0\nbinListToDec (x:xs) = x + binListToDec xs\n</code></pre>\n\n<p>You appear to be trying to combine bits of each. There's no way to write a single pattern that matches simultaneously 1) an empty list and 2) a non-empty list with 3) its head and tail matched separately.</p>\n\n<ul>\n<li><code>xs</code> matches 1) and 2).</li>\n<li><code>all@(x:xs)</code> matches 2) and 3)</li>\n<li><p><strike>1) and 3) cannot be matched</strike>, because the pairing is nonsensical: an empty list doesn't have a separate head and tail. <code>[]</code> and <code>(x:xs)</code> match lists from two non-overlapping sets of possible list values.</p>\n\n<p>Update: there is a <em>lazy</em> pattern match <code>all@(~(x:xs))</code>. The tilde prevents the match <code>(x:xs)</code> from being attempted until there is a need to\nevaluate <code>x</code> or <code>xs</code>. We think of </p>\n\n<pre><code>binListToDec all@(~(x:xs)) = if length all == 0 then 0 else x + binListToDec\n</code></pre>\n\n<p>as equivalent to</p>\n\n<pre><code>binListToDec all = if length all == 0 \n                   then 0\n                   else let (x:xs) = all \n                        in x + binListToDec\n</code></pre>\n\n<p>A lazy pattern match can still fail, but here we defer using <code>x</code> and <code>xs</code> until we know it won't.</p></li>\n</ul>\n\n<hr>\n\n<p><code>length binListToDec</code> attempts to compute the length of the function itself, not the length of its argument, in your attempt. The correct argument for <code>length</code> is used above. Also, the generally accepted sum of an empty list is  0, not 1.</p>\n"}], "owner": {"reputation": 123, "user_id": 7182154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1116360391792657/picture?type=large", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/7182154/muhammad-usman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2066, "favorite_count": 1, "accepted_answer_id": 53287300, "answer_count": 1, "score": 2, "last_activity_date": 1542149031, "creation_date": 1542132637, "question_id": 53287115, "link": "https://stackoverflow.com/questions/53287115/taking-sum-of-list-in-haskell", "title": "Taking sum of list in Haskell", "body": "<p>I am trying to take the sum of a list in Haskell but it gives the error, please see the below code.</p>\n\n<pre><code>binListToDec :: [Int] -&gt; Int\nbinListToDec (x:xs) = if length binListToDec == 0 then 1\n                      else x + binListToDec xs\n</code></pre>\n\n<p>It gives the following error</p>\n\n<pre><code> * No instance for (Foldable ((-&gt;) [Int]))\n        arising from a use of `length'\n    * In the first argument of `(==)', namely `length binListToDec'\n      In the expression: length binListToDec == 0\n      In the expression:\n        if length binListToDec == 0 then 1 else x + binListToDec xs\n  |\n2 | binListToDec (x:xs) = if length binListToDec == 0 then 1\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1542127633, "creation_date": 1542127633, "answer_id": 53285790, "question_id": 53285607, "link": "https://stackoverflow.com/questions/53285607/list-of-data-to-string/53285790#53285790", "title": "list of Data to String", "body": "<p>To pattern-patch on <code>Pack xyz</code> in a lambda, you need to put it in parentheses:</p>\n\n<pre><code>            foldr (\\(Pack (a,b)) -&gt; ...)\n</code></pre>\n\n<p>What you wrote would actually parse as two separate arguments</p>\n\n<pre><code>            foldr (\\(Pack) -&gt; \\(a,b) -&gt; ...)\n</code></pre>\n\n<p>Next, you can't concatenate strings with <code>+</code>, that's for numbers. <code>++</code> or <code>&lt;&gt;</code> are for lists / strings.</p>\n\n<p>Then, the <code>-&gt; concat</code> isn't valid syntax. What you want to do is concatenate the remainder of the foldr computation to the shown <code>a</code> and <code>b</code>. That remainder is the second argument of the folding function:</p>\n\n<pre><code>            foldr (\\(Pack (a,b)) rest -&gt; show a ++ show b ++ rest)\n</code></pre>\n\n<p>...or shorter,</p>\n\n<pre><code>            foldr (\\(Pack (a,b)) -&gt; shows a . shows b)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1542138810, "post_id": 53285809, "comment_id": 93459028, "body": "<code>unpack xs = xs &gt;&gt;= pack2String</code> would make more sense to me as the list monad example."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1542140479, "post_id": 53285809, "comment_id": 93459726, "body": "@4castle I&#39;ll comment later if I can think of a good excuse for not saying that in the first place :) (Right now, I&#39;ll blame lack of coffee and/or good breakfast.)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1542140558, "last_edit_date": 1542140558, "creation_date": 1542127693, "answer_id": 53285809, "question_id": 53285607, "link": "https://stackoverflow.com/questions/53285607/list-of-data-to-string/53285809#53285809", "title": "list of Data to String", "body": "<p>Your <code>Pack</code> type is isomorphic to two-character strings:</p>\n\n<pre><code>pack2String :: Pack -&gt; String\npack2String (Pack (a,b)) = a:[b]\n\nstring2Pack :: String -&gt; Pack   -- partial, since String isn't limited in length\nstring2Pack (a:[b]) = Pack (a, b)\n</code></pre>\n\n<p>(Note that <code>Pack (a,b)</code> already adds an unnecessary level of wrapping; <code>data Pack  = Pack Char Char</code> is also isomorphic to <code>Pack (Char, Char)</code>.)</p>\n\n<p>As such, you don't actually need <code>foldr</code>; you can use the list monad instead.</p>\n\n<pre><code>unpack :: [Pack] -&gt; String\nunpack xs = xs &gt;&gt;= pack2String\n</code></pre>\n\n<p>If you aren't yet comfortable with monads, you can just use the <code>concatMap</code> function directly:</p>\n\n<pre><code>unpack :: [Pack] -&gt; String\nunpack = concatMap pack2String\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 9715006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb905e7fb1642526f814464beb1755c?s=128&d=identicon&r=PG&f=1", "display_name": "swaffelay", "link": "https://stackoverflow.com/users/9715006/swaffelay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 53285809, "answer_count": 2, "score": 0, "last_activity_date": 1542140558, "creation_date": 1542127044, "last_edit_date": 1542127090, "question_id": 53285607, "link": "https://stackoverflow.com/questions/53285607/list-of-data-to-string", "title": "list of Data to String", "body": "<p>So I have a list of Data, I know newtype is currently better but I will add more things to it. I would like to convert a list of Pack to a String.</p>\n\n<pre><code>unpack [Pack ('a','b'), Pack ('c','d') , Pack (' ', 'e') ] = \"abcd e\"  \n</code></pre>\n\n<p>I was thinking about using a foldl but am stuck trying to figure it out.</p>\n\n<pre><code>data Pack= Pack (Char, Char) deriving ( Show)\nunPack:: [Pack] -&gt; String\n\nunpack list = foldr (\\Pack (a,b) -&gt; show a + show b -&gt; concat) \"\" list\n</code></pre>\n\n<p>Thx for the helping </p>\n"}, {"tags": ["haskell", "dependency-injection"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1542125393, "post_id": 53284484, "comment_id": 93452084, "body": "I&#39;m not sure I know what dependency injection really is, but why not parameterize <code>get</code> by the http client function, like: <code>get myHttpLBS token endpoint = do ...</code>. <code>Reader</code> is an abstraction around argument passing. I don&#39;t tend to reach for it unless both of: 1) I already have a monad stack, and 2) I have multiple top-level functions that call each other, and in particular I&#39;d like to pass some value <i>through</i> a function, i.e. there is some function that does nothing but pass an argument to some other function. Other folks probably feel differently"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1542128539, "post_id": 53284484, "comment_id": 93454130, "body": "In functional programming, <a href=\"http://blog.ploeh.dk/2017/01/27/from-dependency-injection-to-dependency-rejection\" rel=\"nofollow noreferrer\">you can&#39;t use dependency injection because it makes everything impure</a>. Instead, you compose functions, keeping as many of them pure as possible."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542128628, "post_id": 53284484, "comment_id": 93454185, "body": "Did you write <code>uplink.hs</code>? Don&#39;t hard-code <code>httpLBS</code>; make it a parameter."}], "answers": [{"tags": [], "owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "is_accepted": false, "score": 0, "last_activity_date": 1542134761, "creation_date": 1542134761, "answer_id": 53287632, "question_id": 53284484, "link": "https://stackoverflow.com/questions/53284484/haskell-reader-monad-for-dependency-injection/53287632#53287632", "title": "haskell: reader-monad for dependency-injection", "body": "<p>In Haskell, dependency injection is just higher order programming + currying. You can write your code as the following.</p>\n\n<pre><code>-- where (? -&gt; ?) is the type of httpLBS\nget_ :: (? -&gt; ?) -&gt; String -&gt; String -&gt; IO B.ByteString\nget_ httpFunc token endpoint = do\n    req &lt;- parseRequest endpoint\n    resp &lt;- httpFunc $ withAuth token req\n    return $ getResponseBody resp\n\ngetProduction = get_ httpLBS\n\ngetTest = get_ httpMock\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 5006014, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/437a8a23959c7c7150c242c9a3efab0e?s=128&d=identicon&r=PG&f=1", "display_name": "stefa ng", "link": "https://stackoverflow.com/users/5006014/stefa-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542232154, "creation_date": 1542123523, "last_edit_date": 1542232154, "question_id": 53284484, "link": "https://stackoverflow.com/questions/53284484/haskell-reader-monad-for-dependency-injection", "title": "haskell: reader-monad for dependency-injection", "body": "<p>i get the basic functionality of the reader-monad from learnyouahaskell book and i've seen some advises here to make use of it for dependency-injection.\neven there are some examples here on stackoverflow, i dont know how to use it for integration-testing.</p>\n\n<p>my code is:</p>\n\n<pre><code>list :: Ctx -&gt; [String] -&gt; IO String\nlist ctx args = do\n    d &lt;- eitherDecode &lt;$&gt; Uplink.get (token ctx) (endpointActivities ctx) :: IO (Either String Activities)\n    case d of \n        Left err -&gt; return err \n        Right result -&gt; return $ unlines . filterByPrefix (parsePrefix args) . extractNames $ activities result\n</code></pre>\n\n<p>uplink.hs</p>\n\n<pre><code>get :: String -&gt; String -&gt; IO B.ByteString\nget token endpoint = do\n    req &lt;- parseRequest endpoint\n    resp &lt;- httpLBS $ withAuth token req\n    return $ getResponseBody resp\n</code></pre>\n\n<p>how can i mock the <strong>httpLBS</strong> - call for integration-testing with the reader-monad?</p>\n\n<hr>\n\n<p><strong>EDIT: !!!!</strong></p>\n\n<p>i almost have it now with the reader-monad. the only problem left is that i dont know how i can define that httpsLBS-function in my Ctx-data-type.</p>\n\n<p><strong>httpLBS</strong>-function-signature:</p>\n\n<pre><code>httpLBS :: MonadIO m =&gt; Request -&gt; m (Response ByteString) \n</code></pre>\n\n<p>my Ctx data-type-definition:</p>\n\n<pre><code>data Ctx =\n    Ctx {\n        token :: String,\n        endpointActivities :: String,\n        endpointTimeTrackingStart :: String,\n        httpLBSFunc :: MonadIO m =&gt; Request -&gt; m (Response ByteString)\n    } deriving (Show)\n</code></pre>\n\n<p>i always get the error: <em>Not in scope: type variable \u2018m\u2019</em>\nhow can i define that function in my Ctx-data-type with its constraints?</p>\n\n<p>i promise, that i will post my solution afterwards, when this last problem is solved </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 1, "last_activity_date": 1542126816, "last_edit_date": 1542126816, "creation_date": 1542125305, "answer_id": 53285026, "question_id": 53284410, "link": "https://stackoverflow.com/questions/53284410/haskell-pattern-matching-with-data-types/53285026#53285026", "title": "Haskell - Pattern matching with data types", "body": "<p>Yes, just create a function to print list of Expr:</p>\n\n<pre><code>import Control.Monad (forM_)\n\nprintExprList::[Expr]-&gt;Int-&gt;String-&gt;IO ()\nprintExprList exprs i desc  =  do \n    putStrLn $ concat (replicate i \"    \") ++ desc\n    forM_ (zip exprs [i..]) $ \\(e, j)-&gt; prettyPrint' e (j+1)\n</code></pre>\n\n<p>and then call it to print:</p>\n\n<pre><code>prettyPrint' :: Expr -&gt; Int -&gt; IO ()     \nprettyPrint' (Add x y) i  = printExprList [x, y]    i \"Add\"\nprettyPrint' (Mult x y) i = printExprList [x, y]    i \"Mult\"\nprettyPrint' (Neg x) i    = printExprList [x]       i \"Neg\"\nprettyPrint' (If x y z) i = printExprList [x, y, z] i \"If\"\n\nprettyPrint' (Num x) i = putStrLn $ concat (replicate i \"    \") \n                         ++ \"Num \" ++ show x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1542138618, "last_edit_date": 1542138618, "creation_date": 1542126498, "answer_id": 53285416, "question_id": 53284410, "link": "https://stackoverflow.com/questions/53284410/haskell-pattern-matching-with-data-types/53285416#53285416", "title": "Haskell - Pattern matching with data types", "body": "<p>First, I would stay out of the IO monad for as long as possible. Have <code>prettyPrint'</code> return a string to be printed.</p>\n\n<pre><code>prettyPrint :: Expr -&gt; IO ()\nprettyPrint = putStrLn . prettyPrint'\n</code></pre>\n\n<p>Now, the only job of <code>prettyPrint'</code> is to create a (possibly multiline) string to be printed. For numbers, that's easy: just use the <code>show</code> instance.</p>\n\n<pre><code>prettyPrint' :: Expr -&gt; String\nprettyPrint' e@(Num _) = show e\n-- or, ignoring the Show instance for Expr altogether\n-- prettyPrint' (Num x) = \"Num \" ++ show x\n</code></pre>\n\n<p>For the rest, there is a pattern:</p>\n\n<ol>\n<li>Identify the constructor</li>\n<li>Identify its arguments</li>\n<li>Join the constructor name and its pretty-printed arguments with newlines. Each argument will be indented one level relative to its operator; the recursion will take care of multiple levels of indentation.</li>\n</ol>\n\n<p>That will look like</p>\n\n<pre><code>prettyPrint' expr = let indent x = \"    \" ++ x\n                        (op, args) = case expr of\n                           Add x y  -&gt; (\"Add\",  [x,y])\n                           Mult x y -&gt; (\"Mult\", [x,y])\n                           Neg x    -&gt; (\"Neg\",  [x])\n                           If x y z -&gt; (\"If\",   [x,y,z])\n                    in intercalate \"\\n\" (op : map (indent . prettyPrint') args)\n</code></pre>\n\n<p>As an example, consider what <code>prettyPrint'</code> will do with the expression <code>Add (Num 3) (Num 5)</code>. First, it sets <code>op</code> to <code>\"Add\"</code> and <code>args</code> to <code>[Num 3, Num 5]</code>. Next, it maps <code>indent . prettyPrint'</code> over the argument list, to get <code>[\"    Num 3\", \"    Num 5\"]</code>.  Putting the operator on the front of the list yields <code>[\"Add\", \"    Num 3\", \"    Num 3\"]</code>, then joining them with <code>intercalate</code> produces <code>\"Add\\n    Num 3\\n    Num 5\"</code>.</p>\n\n<hr>\n\n<p>The only remaining boilerplate is in the <code>case</code> expression. I think it's possible to eliminate that, but it requires a level of generic programming I'm not familiar with. I'm sure someone else could probably run with my answer to fix that.</p>\n"}, {"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 1, "last_activity_date": 1542126613, "creation_date": 1542126613, "answer_id": 53285461, "question_id": 53284410, "link": "https://stackoverflow.com/questions/53284410/haskell-pattern-matching-with-data-types/53285461#53285461", "title": "Haskell - Pattern matching with data types", "body": "<p>In general, when addressing duplication in code, it pays to keep the <a href=\"https://en.wikipedia.org/wiki/Rule_of_three_(computer_programming)\" rel=\"nofollow noreferrer\">rule of three</a> in mind. Two occurrences of a block of code isn't necessarily a problem.</p>\n\n<p>That said, Haskell is a (very) strongly-typed language, so you generally can't pattern-match on arity like you can in, say, Erlang or Clojure.</p>\n\n<p>If you really want to abstract away the recursion part of a recursive data structure, you can define the <strong>catamorphism</strong> for it. People often also call this a <strong>fold</strong>, so let's keep that slightly more friendly name:</p>\n\n<pre><code>data Expr =\n  Num Int | Add Expr Expr | Mult Expr Expr | Neg Expr | If Bool Expr Expr deriving (Show, Read)\n\nfoldExpr ::\n  (Int -&gt; a) -&gt; (a -&gt; a -&gt; a) -&gt; (a -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; (Bool -&gt; a -&gt; a -&gt; a) -&gt; Expr -&gt; a\nfoldExpr num   _   _   _   _ (Num x) = num x\nfoldExpr num add mul neg iff (Add x y) = \n  add (foldExpr num add mul neg iff x) (foldExpr num add mul neg iff y)\nfoldExpr num add mul neg iff (Mult x y) =\n  mul (foldExpr num add mul neg iff x) (foldExpr num add mul neg iff y)\nfoldExpr num add mul neg iff (Neg x) = neg (foldExpr num add mul neg iff x)\nfoldExpr num add mul neg iff (If b x y) =\n  iff b (foldExpr num add mul neg iff x) (foldExpr num add mul neg iff y)\n</code></pre>\n\n<p>This is an entirely generic function that enables you turn turn any <code>Expr</code> value into any value of the type <code>a</code>, without worrying about reimplementing recursion every time. You just have to supply functions that deal with each of the cases.</p>\n\n<p>You can, for example, easily write an evaluator:</p>\n\n<pre><code>evaluate :: Expr -&gt; Int\nevaluate = foldExpr id (+) (*) negate (\\p x y -&gt; if p then x else y)\n</code></pre>\n\n<p>(Notice, BTW, that I changed the definition of <code>If</code>, because I couldn't see how the OP definition would work.)</p>\n\n<p>You can also write a function to turn an <code>Expr</code> value into a string, although this one is <strong>just a sketch</strong>; it needs indentation or bracket logic to work correctly:</p>\n\n<pre><code>prettyPrint :: Expr -&gt; String\nprettyPrint =\n  foldExpr\n    show -- Num\n    (\\x y -&gt; x ++ \"+\" ++ y) -- Add\n    (\\x y -&gt; x ++ \"*\" ++ y) -- Mult\n    (\\x -&gt; \"(-\" ++ x ++ \")\") -- Neg\n    (\\p x y -&gt; \"if \" ++ show p ++ \" then \" ++ x ++ \" else \" ++ y) -- If\n</code></pre>\n\n<p>You can try it out in GHCi:</p>\n\n<pre><code>*Q53284410&gt; evaluate (Num 42)\n42\n*Q53284410&gt; evaluate (Add (Num 40) (Num 2))\n42\n*Q53284410&gt; evaluate (Add (Mult (Num 4) (Num 10)) (Num 2))\n42\n*Q53284410&gt; prettyPrint $ Num 42\n\"42\"\n*Q53284410&gt; prettyPrint $ Mult (Num 6) (Num 7)\n\"6*7\"\n*Q53284410&gt; prettyPrint $ Add (Mult (Num 2) (Num 3)) (Num 7)\n\"2*3+7\"\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 8947589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7730c4ccf5b0ba18bfab2f335f5172f4?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/8947589/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 53285416, "answer_count": 3, "score": 6, "last_activity_date": 1542138618, "creation_date": 1542123245, "last_edit_date": 1542132322, "question_id": 53284410, "link": "https://stackoverflow.com/questions/53284410/haskell-pattern-matching-with-data-types", "title": "Haskell - Pattern matching with data types", "body": "<p>I have a data type and function like this: </p>\n\n<pre><code>data Expr = Num Int | Add Expr Expr | Mult Expr Expr | Neg Expr | If Expr Expr Expr deriving (Show, Read)\n\nprettyPrint :: Expr -&gt; IO () \nprettyPrint expr = prettyPrint' expr 0\n\n\nprettyPrint' :: Expr -&gt; Int -&gt; IO () \nprettyPrint' (Num x) i = putStrLn $ concat (replicate i \"    \") ++ \"Num \" ++ show x\n\nprettyPrint' (Add x y) i = do\n    putStrLn $ concat (replicate i \"    \") ++ \"Add\" \n    prettyPrint' x (i+1) \n    prettyPrint' y (i+1) \n\nprettyPrint' (Mult x y) i = do\n    putStrLn $ concat (replicate i \"    \") ++ \"Mult\" \n    prettyPrint' x (i+1) \n    prettyPrint' y (i+1) \n\nprettyPrint' (Neg x) i = do\n    putStrLn $ concat (replicate i \"    \") ++ \"Neg\" \n    prettyPrint' x (i+1) \n\nprettyPrint' (If x y z) i = do \n    putStrLn $ concat (replicate i \"    \") ++ \"If\" \n    prettyPrint' x (i+1) \n    prettyPrint' y (i+1) \n    prettyPrint' z (i+1) \n</code></pre>\n\n<p>In the function I am using pattern matching. The problem is that their is a lot of reuse of code. For example, the case for <code>Mult</code> and <code>Add</code> is basically the same code. Same goes for <code>Num</code> and <code>Neg</code>. Is there a way to write this based on how many variables the expression have? Like one for <code>Num</code> and <code>Neg</code>, since they have only one variable. One case for <code>Mult</code> and <code>Add</code>, since they have two variables. And a last case for <code>If</code>, since that expression have three variables.</p>\n\n<p>NOTE: </p>\n\n<p>I landed on this answer, I think it's a better solution than I started with: </p>\n\n<pre><code>prettyPrint :: Expr -&gt; IO () \nprettyPrint expr = putStrLn (prettyPrint' 1 expr)\n\nprettyPrint' :: Int -&gt; Expr -&gt; String\nprettyPrint' i (Num x) = \"Num \" ++ show x \nprettyPrint' i expr = \n    let indent x = concat (replicate i \"    \") ++ x \n        (op, args) = case expr of\n            Add x y  -&gt; (\"Add\",  [x,y])\n            Mult x y -&gt; (\"Mult\", [x,y])\n            Neg x    -&gt; (\"Neg\",  [x])\n            If x y z -&gt; (\"If\",   [x,y,z])\n    in intercalate \"\\n\" (op : map (indent . prettyPrint' (i + 1)) args)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 4, "last_activity_date": 1542083004, "last_edit_date": 1542083004, "creation_date": 1542082072, "answer_id": 53273657, "question_id": 53273610, "link": "https://stackoverflow.com/questions/53273610/converting-from-newtype-to-int-and-from-int-to-newtype/53273657#53273657", "title": "Converting from newtype to Int and from Int to newtype", "body": "<p>Use <code>fromIntegral</code> to convert between integral types, such as <code>Int</code> and <code>Integer</code>. Use <code>NT1</code> to convert from <code>Integer</code> to <code>NT1</code>, and pattern-matching from <code>NT1</code> to <code>Integer</code>. Finally, you can compose functions to connect things.</p>\n\n<pre><code>toNT1 :: Int -&gt; NT1\ntoNT1 = NT1 . fromIntegral\n\nfromNT1 :: NT1 -&gt; Int\nfromNT1 (NT1 x) = fromIntegral x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 6, "last_activity_date": 1542087141, "creation_date": 1542087141, "answer_id": 53274425, "question_id": 53273610, "link": "https://stackoverflow.com/questions/53273610/converting-from-newtype-to-int-and-from-int-to-newtype/53274425#53274425", "title": "Converting from newtype to Int and from Int to newtype", "body": "<p><code>e :: t</code> doesn\u2019t mean \u201cconvert expression <code>e</code> to type <code>t</code>\u201d, it\u2019s just an annotation that says \u201c<code>e</code> <em>has type</em> <code>t</code> (already)\u201d. So this:</p>\n\n<pre><code>let y = x :: Int in y\n</code></pre>\n\n<p>Means: assert that <code>x</code> has type <code>Int</code>, set <code>y</code> equal to <code>x</code>, and return <code>y</code>. That\u2019s why you got a type mismatch: <code>x</code> does not have type <code>Int</code> as you are claiming to the compiler. And this:</p>\n\n<pre><code>let x = x :: Integer\nin if x &gt;= 0 then x :: NT1 else x :: NT1\n</code></pre>\n\n<p>Means: declare a new variable <code>x</code>, set it equal to itself (an infinite loop), asserting that it has type <code>Integer</code>, then test whether that infinite loop returns a nonnegative value; either way, return <code>x</code>, asserting that it has type <code>NT1</code> (this contradicts the <code>Integer</code> from before).</p>\n\n<p>To convert between <code>Integer</code> and <code>Int</code>, you can use <code>fromIntegral :: (Integral a, Num b) =&gt; a -&gt; b</code>, which converts any integral type (such as <code>Int</code> or <code>Integer</code>) into any numeric type (such as <code>Int</code>, <code>Integer</code>, <code>Float</code>, <code>Double</code>, or <code>Ratio</code>).</p>\n\n<p>For converting from <code>newtype</code>s, you can use pattern-matching:</p>\n\n<pre><code>fromNT1ToInt :: NT1 -&gt; Int\nfromNT1ToInt (NT1 x) = fromIntegral x\n</code></pre>\n\n<p>Or add a record accessor function to the <code>newtype</code> and use that:</p>\n\n<pre><code>newtype NT1 = NT1 { nt1Val :: Integer }\n-- Note: nt1Val :: NT1 -&gt; Integer\n\nfromNT1ToInt :: NT1 -&gt; Int\nfromNT1ToInt nt = fromIntegral (nt1Val nt)\n-- Or, with function composition (.):\nfromNT1ToInt = fromIntegral . nt1Val\n</code></pre>\n\n<p>Or, finally, use <code>coerce</code> from <code>Data.Coerce</code>:</p>\n\n<pre><code>import Data.Coerce (coerce)\n\nfromNT1ToInt :: NT1 -&gt; Int\nfromNT1ToInt nt = fromIntegral (coerce nt :: Integer)\n</code></pre>\n\n<p>And of course, to construct a <code>newtype</code> you just use its constructor\u2014in this case, <code>NT1 :: Integer -&gt; NT1</code>, e.g. <code>NT1 5</code>.</p>\n"}], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 1, "accepted_answer_id": 53273657, "answer_count": 2, "score": 2, "last_activity_date": 1542115591, "creation_date": 1542081815, "last_edit_date": 1542115591, "question_id": 53273610, "link": "https://stackoverflow.com/questions/53273610/converting-from-newtype-to-int-and-from-int-to-newtype", "title": "Converting from newtype to Int and from Int to newtype", "body": "<p>How do I convert newtype to Int and vice versa? </p>\n\n<p>I tried: </p>\n\n<pre><code>newtype NT1 = NT1 Integer\n\nfromNT1toInt :: NT1 -&gt; Int\nfromNT1toInt x = let y = x :: Int\n                 in y\n</code></pre>\n\n<p>but I get could't match expected type error</p>\n\n<p>I tried making NT1 instance of Enum class \nbut I don't understand well how does toEnum work</p>\n\n<pre><code>newtype NT1 = NT1 Integer\n\ninstance  Enum NT1 where\ntoEnum x = let x = x :: Integer\n           in if x &gt;= 0\n                 then x :: NT1 \n                 else x :: NT1\n</code></pre>\n\n<p>when I call toEnum 5 :: NT1 this should return 5 NT1 but I get StackOverflow error.\nWhere am I making mistake? </p>\n\n<p>Edited: newtype name</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1542080512, "post_id": 53273415, "comment_id": 93429784, "body": "Without a helper definition, the most straightforward way would be with an anonymous function (a &quot;lambda&quot;)."}, {"owner": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542176087, "post_id": 53273415, "comment_id": 93469295, "body": "Holy cow, thank you everyone... i had actually thought of the lambda way later, but couldn&#39;t figure out putting together the function for some reason... but once i see it, I&#39;m like, &quot;that makes total sense&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1542097058, "post_id": 53273654, "comment_id": 93435172, "body": "For point-free code, it often helps readability to factor things into many small, generic, reusable definitions. For example, in this case I might write <code>divisibleBy d = (== 0) . (`mod` d)</code> (\u201cto be divisible by <i>d</i> means to be equal to zero modulo <i>d</i>\u201d) and then use <code>any (divisibleBy 42)</code>. Nothing wrong with using a lambda or auxiliary definition in a <code>where</code> clause, though."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1542123305, "post_id": 53273654, "comment_id": 93450700, "body": "@JonPurdy, I completely agree. The only challenge is figuring out the order of the arguments. <code>isDivisibleBy x y</code> sends a different message than <code>x `isDivisibleBy` y</code>."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1542140837, "post_id": 53273654, "comment_id": 93459879, "body": "@dfeuer: Yeah, same problem with other names really; <code>divides</code> with the same definition but used as <code>any (42 `divides`)</code> makes just as much sense, but <code>divides 42</code> is the wrong way around. This is why I prefer functions not be named such that they\u2019re intended to be used infix, because it\u2019s in conflict with using them in prefix; if you do want infix, an operator is preferable. (Besides, I have a personal objection to grave accents being used as quotation characters in a programming language, haha)"}], "tags": [], "owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "is_accepted": true, "score": 6, "last_activity_date": 1542085592, "last_edit_date": 1542085592, "creation_date": 1542082064, "answer_id": 53273654, "question_id": 53273415, "link": "https://stackoverflow.com/questions/53273415/use-any-to-tell-you-true-false-if-a-list-contains-some-values-divisible-by/53273654#53273654", "title": "Use &#39;any&#39; to tell you true/false, if a list contains some value(s) divisible by 42", "body": "<p>Composing <code>(0==)</code> and <code>(`mod 42`)</code>:</p>\n\n<pre><code>f :: [Integer] -&gt; Bool\nf = any ((0==).(`mod` 42))\n</code></pre>\n\n<p>futher reducing parenthesis noise:</p>\n\n<pre><code>f :: [Integer] -&gt; Bool\nf = any $ (0==).(`mod` 42)\n</code></pre>\n\n<p>Helper function:</p>\n\n<pre><code>f :: [Integer] -&gt; Bool\nf = any div42\n  where\n    div42 n = n `mod` 42 == 0\n</code></pre>\n\n<p>Stylistically, for this function, either way seems fine. However, say you wanted to check if any values are divisible by 42 <strong>OR</strong> 52, then utilizing composition may become more obfuscated/complex/futile. Whereas using a helper function keeps things readable: <code>div42Or52 n = n `mod` 42 == 0 || n `mod` 52 == 0</code>. Note, I've used a <code>where</code> clause above, but a <code>let in</code> expression or a lambda are possible alternative ways to structure helper functions.</p>\n\n<p>Ultimately, its up to the developer to balance concise code with understandable code.</p>\n"}, {"tags": [], "owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "is_accepted": false, "score": 8, "last_activity_date": 1542082322, "creation_date": 1542082322, "answer_id": 53273693, "question_id": 53273415, "link": "https://stackoverflow.com/questions/53273415/use-any-to-tell-you-true-false-if-a-list-contains-some-values-divisible-by/53273693#53273693", "title": "Use &#39;any&#39; to tell you true/false, if a list contains some value(s) divisible by 42", "body": "<p>You can define function inplace:</p>\n\n<pre><code>any (\\n -&gt; n `mod` 42 == 0) [1, 2, 42]\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 53273654, "answer_count": 2, "score": 3, "last_activity_date": 1542085592, "creation_date": 1542080146, "last_edit_date": 1542080348, "question_id": 53273415, "link": "https://stackoverflow.com/questions/53273415/use-any-to-tell-you-true-false-if-a-list-contains-some-values-divisible-by", "title": "Use &#39;any&#39; to tell you true/false, if a list contains some value(s) divisible by 42", "body": "<p>Having fun working through a Haskell tutorial... </p>\n\n<p>One problem posed is as you see in the subject line... this is one I'd really like to figure out, but I'm at a loss... I've used <code>any</code> like so:</p>\n\n<pre><code>ghci &gt;any (==55) [15,25,35,45,55,65,75,85,95]\nTrue\nghci &gt;any (==55) [15,25,35,45,54,65,75,85,95]\nFalse\nghci &gt;all even [2,4,6,8]\nTrue\nghci &gt;all even [1,3,5,7,9]\nFalse\n</code></pre>\n\n<p>and it seems like checking if a list element is divisible by 42 or not, should be fairly easy...</p>\n\n<p>I mean, you would check if any of the numbers in the list are <code>n `mod` 42 == 0</code>, right?  </p>\n\n<p>But how do you state that in the expression?  Or do you need to write a 'helper' function?</p>\n"}, {"tags": ["haskell", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "edited": false, "score": 0, "creation_date": 1542078305, "post_id": 53272316, "comment_id": 93429351, "body": "Think I missing something here.  I assume the caveat doesn&#39;t apply in my case as the only constraint on test in my case is on effs.   I have tried to apply the this solution in one of the child modules as follows:"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "edited": false, "score": 0, "creation_date": 1542078508, "post_id": 53272316, "comment_id": 93429392, "body": "Try putting your code and error messages (if any) on gist.github.com or some other pastebin."}, {"owner": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "edited": false, "score": 0, "creation_date": 1542078548, "post_id": 53272316, "comment_id": 93429396, "body": "OK doing it now"}, {"owner": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "edited": false, "score": 0, "creation_date": 1542079850, "post_id": 53272316, "comment_id": 93429651, "body": "gist summarising issues I am having compiling this: <a href=\"https://gist.github.com/theGhostJW/2b751dba4323fd5100fad711b9821bc0\" rel=\"nofollow noreferrer\">gist.github.com/theGhostJW/2b751dba4323fd5100fad711b9821bc0</a>"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "edited": false, "score": 0, "creation_date": 1542080187, "post_id": 53272316, "comment_id": 93429719, "body": "Oh I see, <code>Members</code> is a type family, so <code>Members es0 e0 ~ Members es1 e1</code> does not imply <code>es0 ~ es1</code>, and I was relying on that implication... So I think the next simplest way is to change <code>==&gt;</code> to a different type that directly exposes the effects list. I&#39;ll make an edit."}, {"owner": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "edited": false, "score": 0, "creation_date": 1542141814, "post_id": 53272316, "comment_id": 93460215, "body": "Still have issues. SO has suggested a move to chat: <a href=\"https://chat.stackoverflow.com/rooms/183529/discussion-between-john-walker-and-li-yao-xia\">chat.stackoverflow.com/rooms/183529/&hellip;</a>"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1542155226, "last_edit_date": 1542155226, "creation_date": 1542071265, "answer_id": 53272316, "question_id": 53272036, "link": "https://stackoverflow.com/questions/53272036/freer-simple-how-can-i-generate-a-list-of-effect-members-at-runtime/53272316#53272316", "title": "freer-simple - How can I generate a list of effect members at runtime?", "body": "<p>First, given a (type-level) list of effects <code>effs</code>, we can obtain a string of it via <code>Typeable</code>:</p>\n\n<pre><code>import Type.Reflection\n\nshowEffs :: forall effs. Typeable effs =&gt; String\nshowEffs = show (typeRep @effs)\n</code></pre>\n\n<p>Now the problem is for a function <code>f</code> to grab the constraint in the type of its argument. As you have witnessed, a naive attempt will fail: <code>f test</code> will specialize <code>test</code> and propagate the constraints upwards, resulting in errors about instance resolution and ambiguous type variables.</p>\n\n<p>A better solution is to replace <code>=&gt;</code> with a regular data type, which is \"matchable\".</p>\n\n<pre><code>newtype WithEffects_ es0 es1 a = WithEffects { unWithEffects :: Members es0 es1 =&gt; a }\n</code></pre>\n\n<p>The type synonyms also need some refactoring.</p>\n\n<pre><code>type EFileSystem = '[Logger, Ensure, FileSystem]\ntype WithEffects = WithEffects_ EFileSystem\n</code></pre>\n\n<p>Now a test looks like this:</p>\n\n<pre><code>test :: forall effs. WithEffects effs (Test Item effs ApState ValState)\ntest = WithEffects $ ... -- the rest unchanged\n</code></pre>\n\n<p>and you'll need to unwrap it explicitly with <code>unWithEffects test</code>. We can now extract a runtime representation of the effects <code>es0</code> from <code>WithEffects_ es0 es1 a</code>:</p>\n\n<pre><code>import Type.Reflection\n\neffsRepTest :: Typeable es0 =&gt; WithEffects_ es0 es1 a -&gt; TypeRep es\neffsRepTest _ = typeRep\n\nshowEffsTest :: Typeable es0 =&gt; WithEffects_ es0 es1 a -&gt; String\nshowEffsTest = show . effsRepTest\n</code></pre>\n\n<p>So, to extract a string representing <code>es0</code>, we can write:</p>\n\n<pre><code>showEffsTest test :: String\n</code></pre>\n\n<hr>\n\n<p>EDITED: you may find traces of an old version of this answer in the comments, which proposed to use <code>newtype c ==&gt; a = Arr { unArr :: c =&gt; a }</code>, but that doesn't work here as <code>Members</code> is a type family. So you need another type that carries the list of effects more explicitly <code>es0</code> like <code>WithEffects_</code>.</p>\n\n<hr>\n\n<p>EDITED, again:</p>\n\n<p>Here is a minimal compilable gist: <a href=\"https://gist.github.com/Lysxia/d7b6bdc23bcb43cb40439b7e037e8145\" rel=\"nofollow noreferrer\">https://gist.github.com/Lysxia/d7b6bdc23bcb43cb40439b7e037e8145</a></p>\n\n<p>The above answer actually prints this:</p>\n\n<pre><code>': (* -&gt; *) Logger (': (* -&gt; *) Ensure (': (* -&gt; *) FileSystem ('[] (* -&gt; *))))\n</code></pre>\n\n<p>For a better looking result, I implemented a custom printer in that gist (the <code>ShowTypes</code> class).</p>\n"}], "owner": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 53272316, "answer_count": 1, "score": 0, "last_activity_date": 1542155226, "creation_date": 1542068598, "question_id": 53272036, "link": "https://stackoverflow.com/questions/53272036/freer-simple-how-can-i-generate-a-list-of-effect-members-at-runtime", "title": "freer-simple - How can I generate a list of effect members at runtime?", "body": "<p>I am trying to create a function to generate a string representation of effects at runtime.</p>\n\n<p>-- In a shared module</p>\n\n<pre><code>... definitions for TestConfig, RunConfig\n\ndata GenericTest tc rc i effs as vs = GenericTest {\n  configuration :: tc,\n  components :: ItemClass i vs =&gt; TestComponents rc i effs as vs\n} deriving Typeable\n\ntype Test = GenericTest TestConfig RunConfig\n\ntype EFFLogger effs = Member Logger effs\ntype EFFFileSystem effs = Members '[Logger, Ensure, FileSystem] effs \n</code></pre>\n\n<p>-- Child module 1</p>\n\n<pre><code>.... definitions for items, iterator etc \n\ntype Effects effs = EFFFileSystem effs\n\ntest :: forall effs. Effects effs =&gt; Test Item effs ApState ValState\ntest = GenericTest {\n              configuration = config {address = moduleOf ''ApState},\n              components = TestComponents {\n                                testItems = items,\n                                testInteractor = interactor,\n                                testPrepState = prepState\n                            }\n            }\n</code></pre>\n\n<p>-- Child module 2 (the same as module 1 but different effects)</p>\n\n<pre><code>.... definitions for items, iterator etc \n\ntype Effects effs = EFFLogger effs\n\ntest :: forall effs. Effects effs =&gt; Test Item effs ApState ValState\ntest = GenericTest {\n              configuration = config {address = moduleOf ''ApState},\n              components = TestComponents {\n                                testItems = items,\n                                testInteractor = interactor,\n                                testPrepState = prepState\n                            }\n            }\n</code></pre>\n\n<p>At run time I want a function <code>f</code> such that:</p>\n\n<pre><code>&gt; f ChildMod1.test \n&gt; [\"Logger\", \"Ensure\", \"FileSystem\"]\n&gt;\n&gt; f ChildMod2.test \n&gt;  [\"Logger\"]\n</code></pre>\n\n<p>From repl with Child module 1 loaded I can get the following, which if I could get something similar in non-interpreted code would be enough to get me what I want: </p>\n\n<pre><code>&gt; :t test\n&gt; test\n    :: (Data.OpenUnion.Internal.FindElem Logger effs,\n        Data.OpenUnion.Internal.FindElem Ensure effs,\n        Data.OpenUnion.Internal.FindElem FileSystem effs) =&gt;\n       Test Item effs ApState ValState\n</code></pre>\n\n<p>I have tried using Typeable as suggested in the following:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28243383/how-can-i-read-the-metadata-of-a-type-at-runtime\">How can I read the metadata of a type at runtime?</a></p>\n\n<p>but typeOf gives me issues which I have no clue how to solve:</p>\n\n<pre><code>&gt; typeOf test\n\n  &lt;interactive&gt;:5:1-11: error:\n      * No instance for (Typeable effs0) arising from a use of `typeOf'\n      * In the expression: typeOf test\n        In an equation for `it': it = typeOf test\n\n  &lt;interactive&gt;:5:8-11: error:\n      * Ambiguous type variable `effs0' arising from a use of `test'\n        prevents the constraint `(Data.OpenUnion.Internal.FindElem\n                                    Logger effs0)' from being solved.\n        Probable fix: use a type annotation to specify what `effs0' should be.\n        These potential instances exist:\n          two instances involving out-of-scope types\n            instance [overlappable] Data.OpenUnion.Internal.FindElem t r =&gt;\n                                    Data.OpenUnion.Internal.FindElem t (t' : r)\n              -- Defined in `Data.OpenUnion.Internal'\n            instance Data.OpenUnion.Internal.FindElem t (t : r)\n              -- Defined in `Data.OpenUnion.Internal'\n      * In the first argument of `typeOf', namely `test'\n        In the expression: typeOf test\n        In an equation for `it': it = typeOf test\n</code></pre>\n"}, {"tags": ["haskell", "lazy-evaluation"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1618937433, "last_edit_date": 1618937433, "creation_date": 1542064190, "answer_id": 53271427, "question_id": 53271314, "link": "https://stackoverflow.com/questions/53271314/haskell-laziness-and-seq/53271427#53271427", "title": "Haskell laziness and seq", "body": "<p>Yes, you are right.</p>\n<p>Operationally, in case 1, variable <code>v</code> is bound to a thunk, an unevaluated expression which becomes larger and larger until <code>print</code> forces its evaluation. The memory footprint is not constant.</p>\n<p>In case 2, variable <code>v</code> is always bound to an evaluated number. The recursion runs in constant space.</p>\n<p>By the way, it is idiomatic to write <code>seq v' f' xs v'</code> as</p>\n<pre><code>v' `seq` f' xs v'\n</code></pre>\n<p>(which is equivalent since application is always strict on the function) or, leveraging <code>$!</code></p>\n<pre><code>f' xs $! v'\n</code></pre>\n<p>Another common choice is to use a bang pattern and forget <code>seq</code></p>\n<pre><code>f' [] !v = print v -- base case\nf' (x:xs) !v = f' xs v'\n  where v' = v + g x\n</code></pre>\n<p>The bangs <code>!</code> ensure that <code>v</code> is demanded immediately, so even if it is a thunk, it is evaluated before proceeding. This also ensures a constant memory footprint.</p>\n<p>As a profiling tool for strictness, you can try <code>Debug.Trace.trace</code>, which will print a debug message whenever some thunk is demanded. This is not to be used for general output, but for general debugging is fine.</p>\n"}], "owner": {"reputation": 328, "user_id": 9801788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c4d65bb8eb9216158702949a00454c?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/9801788/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 2, "accepted_answer_id": 53271427, "answer_count": 1, "score": 4, "last_activity_date": 1618937433, "creation_date": 1542063455, "last_edit_date": 1618906473, "question_id": 53271314, "link": "https://stackoverflow.com/questions/53271314/haskell-laziness-and-seq", "title": "Haskell laziness and seq", "body": "<p>I am trying to understand laziness and <code>seq</code> in Haskell:</p>\n<ul>\n<li><p>in (1), is it correct that no evaluation of <code>v</code> occurs until the print in the base case requires <code>v</code>?</p>\n</li>\n<li><p>in (2), is it correct that <code>v'</code> is evaluated before each recursive call, so that no evaluation of <code>v</code> is needed in the base case? If not, how do I implement this strict evaluation?</p>\n</li>\n<li><p>are there any profiling tools I can use to confirm these two points for myself?</p>\n</li>\n</ul>\n<br>\n<pre><code>main = do\n  f [1, 2, 3, 4] 0\n  f' [1, 2, 3, 4] 0\n\ng x = 42 * x -- this could be whatever\n\n-- 1. lazy\nf [] v = print v -- base case\nf (x:xs) v = f xs v'\n  where v' = v + g x\n\n-- 2. strict\nf' [] v = print v -- base case\nf' (x:xs) v = seq v' f' xs v'\n  where v' = v + g x\n</code></pre>\n<p>I know <code>foldl</code> and <code>foldl'</code> do what I want in these cases. I am more interested in understanding how this is implemented.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1542063069, "post_id": 53271215, "comment_id": 93425981, "body": "It doesn&#39;t work because the <code>a</code> in <code>a+1</code> refers to the <code>a</code> defined on that same line, so the definition is infinitely recursive. But which <code>a</code> do you want it to refer to? The parameter of <code>foo</code> or the one defined on line 1? Why do you have so many variables named <code>a</code>? What is the code meant to do? Is it just an experiment on how scope works?"}, {"owner": {"reputation": 53, "user_id": 5740540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0125f5295630e5d61bc81a3ab41eae87?s=128&d=identicon&r=PG&f=1", "display_name": "mpelia", "link": "https://stackoverflow.com/users/5740540/mpelia"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1542063327, "post_id": 53271215, "comment_id": 93426072, "body": "It&#39;s just an experiment. I have a more complex problem and I reduced it at this simple. It&#39;s about adding 2 binary numbers using 2 functions: one for the actual sum and one for carry bit. I don&#39;t know how to transfer the value of the carry bit to the next step of the recursion"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1542063585, "post_id": 53271215, "comment_id": 93426150, "body": "Okay, so how do you <i>want</i> the scope to work out. Like, what&#39;s your desired result here - which <code>a</code> do you want to refer to which definition? Do you want it to be the same as <code>foo a b = (a + 1) + foo (a + 1) (b - 1)</code> or something else?"}, {"owner": {"reputation": 53, "user_id": 5740540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0125f5295630e5d61bc81a3ab41eae87?s=128&d=identicon&r=PG&f=1", "display_name": "mpelia", "link": "https://stackoverflow.com/users/5740540/mpelia"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1542063782, "post_id": 53271215, "comment_id": 93426206, "body": "Yes, that&#39;s exactly what I want the function to do"}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 5, "last_activity_date": 1542064431, "creation_date": 1542064431, "answer_id": 53271460, "question_id": 53271215, "link": "https://stackoverflow.com/questions/53271215/haskell-code-using-a-pre-definite-variable/53271460#53271460", "title": "Haskell code using a pre definite variable", "body": "<p>In Haskell a variable is in scope during its definition, so in <code>a = a + 1</code>, the <code>a</code> is referring to itself. If we rename the variables in your code, so that all variables have unique names, it will look like this:</p>\n\n<pre><code>a1 = 5\nfoo :: Int -&gt; Int -&gt; Int\nfoo _ 0 = 0\nfoo a2 b = a3 + foo a3 (b - 1)\n  where\n    a3 = a3 + 1\n</code></pre>\n\n<p>So the problem here is that <code>a3 = a3 + 1</code> is infinitely recursive - <code>a3</code> can't be equal to its own value plus one. Also <code>a2</code> is never used.</p>\n\n<p>You said that you wanted it to refer to the value of the parameter, so now that the variables have different names we can fix this easily enough:</p>\n\n<pre><code>foo :: Int -&gt; Int -&gt; Int\nfoo _ 0 = 0\nfoo a2 b = a3 + foo a3 (b - 1)\n  where\n    a3 = a2 + 1\n</code></pre>\n\n<p>Note that I've left out <code>a1</code> this time since it's irrelevant to the <code>foo</code> function. We can also get rid of the <code>where</code> and just inline the <code>a2 + 1</code> part (and rename <code>a2</code> back to <code>a</code> since there will no longer be multiple ones):</p>\n\n<pre><code>foo :: Int -&gt; Int -&gt; Int\nfoo _ 0 = 0\nfoo a b = (a + 1) + foo (a + 1) (b - 1)\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5740540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0125f5295630e5d61bc81a3ab41eae87?s=128&d=identicon&r=PG&f=1", "display_name": "mpelia", "link": "https://stackoverflow.com/users/5740540/mpelia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 53271460, "answer_count": 1, "score": 0, "last_activity_date": 1542064431, "creation_date": 1542062897, "question_id": 53271215, "link": "https://stackoverflow.com/questions/53271215/haskell-code-using-a-pre-definite-variable", "title": "Haskell code using a pre definite variable", "body": "<p>Could anybody tell me why the following code in Haskell is not working?</p>\n\n<pre><code>a = 5\nfoo :: Int -&gt; Int -&gt; Int\nfoo a 0 = 0\nfoo a b = a + foo a (b - 1)\n  where\n    a = a + 1\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 5, "creation_date": 1542059535, "post_id": 53270609, "comment_id": 93424895, "body": "Note that in the cases where it works you don\u2019t have <code>NT</code> on the right-hand side of the equation."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1542059741, "post_id": 53270609, "comment_id": 93424980, "body": "I&#39;m confused. You say &quot;I should be able to do something like this&quot;, and then post code which defines an operation in terms of itself. Why would you expect that to work? Did you mean to just have eg. <code>x &gt; y</code> on the right-hand-side insteiad of the versions wrapped in <code>NT1</code>?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1542061017, "post_id": 53270609, "comment_id": 93425406, "body": "I&#39;ve rolled your post back to an earlier version. Please don&#39;t make large edits to your question to change what code you&#39;re asking for help with. If you&#39;ve found an answer in the comments, then post that as an answer yourself; or if you&#39;ve gotten over your current hurdle and have a new question, then post that as a new, separate question."}, {"owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542061168, "post_id": 53270609, "comment_id": 93425463, "body": "@amalloy I acctually added the addition to my question at the beginning of the post and left original question under that and marked it with <b><i>Original Question</i></b> I can&#39;t understand what was the problem? Why should I have posted it as an answer when I wasn&#39;t sure if it was correct myself?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1542065352, "post_id": 53270609, "comment_id": 93426640, "body": "@cheshire Indeed, I saw the old content was still there - thanks for trying to make sure you don&#39;t delete useful content. But it&#39;s still quite confusing to have the first thing a reader sees be an &quot;update&quot; to the following text, which they haven&#39;t even read yet! They&#39;d have to scroll past your update, read the original post, go back to your update, and try to mentally piece it all together. Better to just post your candidate solution as an answer, even if you don&#39;t know it&#39;s right. Lots of wrong answers are posted on Stack Overflow every day, and an answer makes room for votes/comments."}, {"owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542069696, "post_id": 53270609, "comment_id": 93427659, "body": "@amalloy ok thanks, will be more careful next time"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1542061025, "post_id": 53270747, "comment_id": 93425410, "body": "...and if you really want to implement all the <code>Ord</code> methods yourself for whatever reason, you can <code>(&gt;) (NT x) (NT y) = (&gt;) x y</code> (no <code>NT</code> wrappers on the right). Or, using infix notation the way it was intended, <code>NT x &gt; NT y = x &gt; y</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1542061243, "post_id": 53270747, "comment_id": 93425488, "body": "@DanielWagner: indeed, after rereading, that was missing, thanks :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1542061227, "last_edit_date": 1542061227, "creation_date": 1542060132, "answer_id": 53270747, "question_id": 53270609, "link": "https://stackoverflow.com/questions/53270609/making-newtype-instance-of-ord-class/53270747#53270747", "title": "Making newtype instance of Ord Class", "body": "<blockquote>\n  <p>following this I should be able to do something like this:</p>\n\n<pre><code>instance Ord NT1 where \n       (&gt;)  (NT1 x)(NT1 y)  =  (NT1 x) &gt;   (NT1 y)\n       (&lt;)  (NT1 x)(NT1 y)  =  (NT1 x) &lt;   (NT1 y)\n       (&lt;=) (NT1 x)(NT1 y)  =  (NT1 x) &lt;=  (NT1 y)\n       (&gt;=) (NT1 x)(NT1 y)  =  (NT1 x) &gt;=  (NT1 y)\n</code></pre>\n</blockquote>\n\n<p>What you here do is basically defining a set of functions where each function calls itself, with the <em>same</em> parameters, so this will get stuck in an infinite loop.</p>\n\n<p>Indeed, here for example you define:</p>\n\n<blockquote>\n<pre><code>instance Ord NT1 where \n       (&gt;)  (NT1 x)(NT1 y)  =  (NT1 x) &gt;   (NT1 y)\n</code></pre>\n</blockquote>\n\n<p>so that means that you say <code>NT1 x &gt; NT1 y</code>, given <code>NT1 x &gt; NT1 y</code>, but of course that does not really do anything.</p>\n\n<p>The nice thing is that you do not need to define all these functions: Haskell has constructed already a lot of other functions in the <code>Ord</code> typeclass in terms of others, so if we take a look at the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:Ord\" rel=\"noreferrer\">documentation for <code>Ord</code></a>, we see:</p>\n\n<blockquote>\n  <p><strong>Minimal complete definition</strong></p>\n\n<pre><code>compare | (&lt;=)\n</code></pre>\n</blockquote>\n\n<p>So implementing <code>compare</code>, or <code>(&lt;=)</code> is sufficient. Haskell can, based on that implementation, also calculate the other comparisons, as well as <code>min</code>, <code>max</code>, etc. You <em>can</em> implement these, if for example there are more efficient ways to check if <code>NT1 x &lt; NT1 y</code> than calling <code>compare</code> and checking if the result is <code>LT</code>.</p>\n\n<p>Your implementation like:</p>\n\n<blockquote>\n<pre><code>newtype NT1 = NT1 Integer\n\ninstance Eq NT1 where \n    (NT1 x) == (NT1 y) = x == y \n\ninstance Ord NT1 where \n    (NT1 x) `compare` (NT1 y) = x `compare` y\n</code></pre>\n</blockquote>\n\n<p>is thus sufficient, for example:</p>\n\n<pre><code>Prelude&gt; NT1 14 &lt; NT1 25\nTrue\n</code></pre>\n\n<p>thus compares the two objects correctly.</p>\n\n<p>This is also a straightforward implementation, the fact that two <code>NT1</code> objects are equal if the constructors are the same (well here there is only <em>one</em> constructor), and the arguments is a straightforward implementation.</p>\n\n<p><code>Ord</code> has also a \"popular\" implementation: an object is considered smaller than another object given that the constructor of the first object is defined before the constructor of the second object, or if the constructors are the same, that the arguments are smaller by comparing these \"lexicographically\".</p>\n\n<p>Haskell has support for these kind of implementations, you can use a <code>deriving</code> clause in your type definition:</p>\n\n<pre><code>newtype NT1 = NT1 Integer <b>deriving (Show, Eq, Ord)</b></code></pre>\n\n<p>Here we thus \"automatically\" implement the <code>Eq</code>, <code>Ord</code> and <code>Show</code> typeclass. For <code>Show</code> it is implemented by first showing the name of the constructor followed by the <code>show</code> of the arguments. It also adds brackets in some cases where it is ambiguous (although the rules are a bit more complex).</p>\n\n<p>We can also, like <a href=\"https://stackoverflow.com/questions/53270609/making-newtype-instance-of-ord-class/53270747?noredirect=1#comment93425410_53270747\">@DanielWagner says</a> implement these functions ourself, with:</p>\n\n<pre><code>instance Ord NT1 where \n    compare (NT1 x) (NT1 y) = compare x y\n    (&gt;)  (NT1 x)(NT1 y)  = <b>x &gt; y</b></code></pre>\n\n<p>Here we thus do <em>not</em> call this with <code>NT1</code> data constructors on the right side, since otherwise we would simply call this function again with the same parameters. With the above implementation, we call <code>x &gt; y</code>, so <code>(&gt;)</code> but on the <em>arguments</em> wrapped in the constructor.</p>\n"}], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 53270747, "answer_count": 1, "score": 2, "last_activity_date": 1542061227, "creation_date": 1542059366, "last_edit_date": 1542060947, "question_id": 53270609, "link": "https://stackoverflow.com/questions/53270609/making-newtype-instance-of-ord-class", "title": "Making newtype instance of Ord Class", "body": "<p>Since Ord is a Subclass of Eq I find it difficult to understand how making a newtype instance of that class will look like. </p>\n\n<p>I have managed to do this:</p>\n\n<pre><code>    newtype NT1 = NT1 Integer\n\n    instance Eq NT1 where \n        (NT1 x) == (NT1 y) = x == y \n\n    instance Ord NT1 where \n        (NT1 x) `compare` (NT1 y) = x `compare` y \n</code></pre>\n\n<p>If I for examle have a variable <code>x = NT1 5</code> and variable <code>y = NT1 5</code> and type x == y it will return <code>True</code> </p>\n\n<p>I managed also to do this:</p>\n\n<pre><code>instance Show NT1 where\n        show (NT1 n) = show n\n</code></pre>\n\n<p>whill display <code>x = NT1 5</code> as <code>5</code> instead of <code>NT1 5</code></p>\n\n<p>following this I should be able to do something like this: </p>\n\n<pre><code>instance Ord NT1 where \n       (&gt;)  (NT1 x)(NT1 y)  =  (NT1 x) &gt;   (NT1 y)\n       (&lt;)  (NT1 x)(NT1 y)  =  (NT1 x) &lt;   (NT1 y)\n       (&lt;=) (NT1 x)(NT1 y)  =  (NT1 x) &lt;=  (NT1 y)\n       (&gt;=) (NT1 x)(NT1 y)  =  (NT1 x) &gt;=  (NT1 y)\n</code></pre>\n\n<p>But this doesn't work. How do I do this with Ord class : </p>\n\n<pre><code>class  (Eq a) =&gt; Ord a  where\n    compare              :: a -&gt; a -&gt; Ordering\n    (&lt;), (&lt;=), (&gt;=), (&gt;) :: a -&gt; a -&gt; Bool\n    max, min             :: a -&gt; a -&gt; a\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["haskell", "asynchronous", "exception"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542050582, "post_id": 53268659, "comment_id": 93421343, "body": "This seems like a pretty normal behavior for a program to have. The user hits <code>^C</code> once: okay, fine, you want me to quit, give me a minute and I&#39;ll print what I know so far. The user hits <code>^C</code> again while this is happening? They are tired of waiting for the program to quit, and want it to just get out of the way so they can run some other command."}, {"owner": {"reputation": 101, "user_id": 3776835, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/29gyT.png?s=128&g=1", "display_name": "Timoth&#233;e Jourde", "link": "https://stackoverflow.com/users/3776835/timoth%c3%a9e-jourde"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542050923, "post_id": 53268659, "comment_id": 93421467, "body": "@amalloy sure, but since <code>CTRL-C</code> (always?) sends <code>SIGINT</code>, I would expect this piece of code to <i>always</i> work since it&#39;s using <code>uninterruptibleMask</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542051704, "post_id": 53268659, "comment_id": 93421824, "body": "You are interruptible while printing, because you have called <code>restore</code> once <code>query</code> completes, no? I am not very familiar with async exceptions either, but from reading the Control.Exception docs it seems that the <code>restore</code> argument exists to allow you to restore the masking state so you can say you no longer need to be masked."}, {"owner": {"reputation": 101, "user_id": 3776835, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/29gyT.png?s=128&g=1", "display_name": "Timoth&#233;e Jourde", "link": "https://stackoverflow.com/users/3776835/timoth%c3%a9e-jourde"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542051989, "post_id": 53268659, "comment_id": 93421953, "body": "@amalloy I&#39;m only calling <code>restore</code> inside <code>try</code> and the final print (<code>printInterrupted</code> and <code>printResults</code>) is done outside <code>try</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542053428, "post_id": 53268659, "comment_id": 93422545, "body": "So? <code>restore</code> <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html#v:mask\" rel=\"nofollow noreferrer\">can be used to restore the prevailing masking state within the context of the masked computation</a>. As far as I understand it, once your <code>try</code> completes successfully, the original masking state (i.e., not masked) will be restored, and so the rest of your <code>mask</code> computation is susceptible to being interrupted."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542053783, "post_id": 53268659, "comment_id": 93422699, "body": "Really <code>uninterruptibleMask</code> seems very odd here, since you <i>do</i> want to allow the user to interrupt your long-running search operation. Why use any masking operation at all? Simply run <code>search query results</code> within a <code>try</code>, and you&#39;ll be able to detect whether it was interrupted. If you really want to guarantee printing, you can <i>at that point</i> turn on a mask to stop the printing code from being interrupted, although I don&#39;t think that is a great idea."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 2, "creation_date": 1542054462, "post_id": 53268659, "comment_id": 93422975, "body": "Apparently, the Haskell runtime kills the program on the second Ctrl-C by default, unless a signal handler is installed <a href=\"https://stackoverflow.com/questions/2349233/catching-control-c-exception-in-ghc-haskell\" title=\"catching control c exception in ghc haskell\">stackoverflow.com/questions/2349233/&hellip;</a>"}, {"owner": {"reputation": 101, "user_id": 3776835, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/29gyT.png?s=128&g=1", "display_name": "Timoth&#233;e Jourde", "link": "https://stackoverflow.com/users/3776835/timoth%c3%a9e-jourde"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1542054699, "post_id": 53268659, "comment_id": 93423070, "body": "@danidiaz Thank you!"}, {"owner": {"reputation": 101, "user_id": 3776835, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/29gyT.png?s=128&g=1", "display_name": "Timoth&#233;e Jourde", "link": "https://stackoverflow.com/users/3776835/timoth%c3%a9e-jourde"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542054885, "post_id": 53268659, "comment_id": 93423135, "body": "@amalloy I thought <code>restore</code> was only restoring the masking state for the computation taken as argument"}], "owner": {"reputation": 101, "user_id": 3776835, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/29gyT.png?s=128&g=1", "display_name": "Timoth&#233;e Jourde", "link": "https://stackoverflow.com/users/3776835/timoth%c3%a9e-jourde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542050095, "creation_date": 1542050095, "question_id": 53268659, "link": "https://stackoverflow.com/questions/53268659/proper-handling-of-two-consecutive-userinterrupt-in-haskell", "title": "Proper handling of two consecutive UserInterrupt in Haskell", "body": "<p>My program is running a quite long iterative IO computation. At each iteration, I'm saving an intermediary result in case of a shutdown request. Upon such a request I want to stop the computation and print the intermediary result before terminating the program. Here is what I achieved, it works, but when I press <code>CTRL-C</code> more than once in my terminal, the final print is not done. This is the first time I have to deal with asynchronous exceptions, so I may be wrong.</p>\n\n<pre><code>main :: String -&gt; IO ()\nmain query = uninterruptibleMask $ \\restore -&gt; do\n  results &lt;- newIORef []\n  xe      &lt;- try $ restore $ search query results\n  case xe of\n    Right x -&gt; printCompleted &gt;&gt; printResults x\n    Left  e -&gt; do\n      printInterrupted\n      readIORef results &gt;&gt;= printResults\n      case e of\n        UserInterrupt -&gt; return ()\n        _             -&gt; throw e\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1542049132, "post_id": 53268383, "comment_id": 93420763, "body": "Do you launch ghc from the same directory? Could you show us exactly how you are launching the compilation?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1542050773, "post_id": 53268383, "comment_id": 93421404, "body": "Are you sure you don&#39;t have a file named <code>S6.*</code> with <code>module Main where ...</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 3, "last_activity_date": 1542080946, "creation_date": 1542080946, "answer_id": 53273507, "question_id": 53268383, "link": "https://stackoverflow.com/questions/53268383/cant-import-lhs-script-in-haskell/53273507#53273507", "title": "Can&#39;t import .lhs script in Haskell", "body": "<p>Looks like you need to specify at the top of the <code>S6.lhs</code> file that you want this file to be treated as the <code>S6</code> module, as opposed to the default module name of <code>Main</code>. You would do that with <code>module S6 where</code> or <code>module S6 (export, list) where</code>.</p>\n"}], "owner": {"reputation": 133, "user_id": 10634198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fWMgP.jpg?s=128&g=1", "display_name": "Dreik&#228;sehoch", "link": "https://stackoverflow.com/users/10634198/dreik%c3%a4sehoch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 53273507, "answer_count": 1, "score": 1, "last_activity_date": 1542080946, "creation_date": 1542048847, "last_edit_date": 1542049539, "question_id": 53268383, "link": "https://stackoverflow.com/questions/53268383/cant-import-lhs-script-in-haskell", "title": "Can&#39;t import .lhs script in Haskell", "body": "<p>I have two files, <code>S5.hs</code> and <code>S6.lhs</code>, <em>in the same folder</em>, and I want to import the <code>S6.lhs</code> script in <code>S5.hs</code>, but when i type <code>import S6</code>, i get:</p>\n\n<pre><code>Could not find module `S6'\nUse -v to see a list of the files searched for.\n|\n1 | import S6\n| ^^^^^^^^^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>When I lauch it from the folder, I get following message(the first line of the S6 file is <em>import Data.Array</em>):</p>\n\n<pre><code>    File name does not match module name:\nSaw: `Main'\nExpected: `S6'\n|\n1 | import Data.List\n| ^\n</code></pre>\n\n<p>Why is this happening?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1542047547, "post_id": 53268037, "comment_id": 93420162, "body": "What error do you get? Have you tried using GHC instead of GHCi? What version of GHC are you using? You have given us little information to work with, which makes this question inadequate. Please update it with useful, relevant information."}, {"owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1542048282, "post_id": 53268037, "comment_id": 93420444, "body": "@AJFarmar : I edited the question."}], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "edited": false, "score": 0, "creation_date": 1542055797, "post_id": 53268465, "comment_id": 93423482, "body": "As you know, there is type inference in Haskell, and encodePath is not polymorphic."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "edited": false, "score": 0, "creation_date": 1542057553, "post_id": 53268465, "comment_id": 93424170, "body": "@Florian This problem has nothing to do with type inference \u2013 this is just misuse of a function. What do you mean?"}, {"owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "edited": false, "score": 0, "creation_date": 1542060906, "post_id": 53268465, "comment_id": 93425370, "body": "OK, now I understand what you meant in your answer."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1542049177, "creation_date": 1542049177, "answer_id": 53268465, "question_id": 53268037, "link": "https://stackoverflow.com/questions/53268037/how-can-i-avoid-an-error-involving-lazy-bytestrings/53268465#53268465", "title": "How can I avoid an error involving lazy bytestrings?", "body": "<p>Your expression is 'correct' in a strict sense, that is to say it is well-typed, but your problem is what you're computing here:</p>\n\n<pre><code>read \"stuff\"\n</code></pre>\n\n<p>This is actually communicated in the error message:</p>\n\n<pre><code>\"*** Exception: Prelude.read: no parse\"\n--              ^^^^^^^^^^^^\n-- The underlined means the exception is due to the `read` function.\n</code></pre>\n\n<p>(Note that this is not an error \u2013 it is an exception, which arises when <em>running</em> the program, not when compiling it.)</p>\n\n<p>I don't know what you were trying to construct when you wrote <code>read \"stuff\"</code>, but there's nothing that <code>\"stuff\"</code> can be interpreted as, so it fails to parse.</p>\n\n<p>Examples of valid uses of <code>read</code> are: <code>read \"0\" :: Int</code>, <code>read \"True\" :: Bool</code> and so on. <code>read \"stuff\"</code> is meaningless and will naturally cause an exception.</p>\n\n<p>Perhaps you meant <code>maybeRead :: Read a =&gt; String -&gt; Maybe a</code> from <code>Data.(Lazy.)Text.Read</code>?</p>\n"}, {"comments": [{"owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "edited": false, "score": 0, "creation_date": 1542055731, "post_id": 53268536, "comment_id": 93423453, "body": "Nice. Importing Data.ByteString.Char8 and using pack does the trick."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1545001826, "post_id": 53268536, "comment_id": 94463172, "body": "NB: <code>Data.ByteString.Char8.pack</code> does everything mod 256"}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 2, "last_activity_date": 1542049487, "creation_date": 1542049487, "answer_id": 53268536, "question_id": 53268037, "link": "https://stackoverflow.com/questions/53268037/how-can-i-avoid-an-error-involving-lazy-bytestrings/53268536#53268536", "title": "How can I avoid an error involving lazy bytestrings?", "body": "<p>The thing that puzzled me was what type you were <code>read</code>ing the string \"stuff\" to, so I <a href=\"http://hackage.haskell.org/package/http-types-0.12.2/docs/Network-HTTP-Types.html#v:encodePath\" rel=\"nofollow noreferrer\">looked at the types</a>.</p>\n\n<pre><code>encodePath :: [Text] -&gt; Query -&gt; Builder\n</code></pre>\n\n<p>where <a href=\"http://hackage.haskell.org/package/http-types-0.12.2/docs/Network-HTTP-Types.html#t:QueryItem\" rel=\"nofollow noreferrer\">Query is an alias for <code>[(ByteString, Maybe ByteString)]</code></a>. So in this context you are specializing <code>read</code> to:</p>\n\n<pre><code>read :: String -&gt; ByteString\n</code></pre>\n\n<p>Looking at <a href=\"http://hackage.haskell.org/package/bytestring-0.10.8.2/docs/src/Data.ByteString.Internal.html#line-176\" rel=\"nofollow noreferrer\">the relevant Read instance</a>, we see:</p>\n\n<pre><code>instance Read ByteString where\n    readsPrec p str = [ (packChars x, y) | (x, y) &lt;- readsPrec p str ]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>packChars :: [Char] -&gt; ByteString\n</code></pre>\n\n<p>So, ByteString just delegates to String for reading, and then packs the result. So your code eventually boils down to:</p>\n\n<pre><code>read \"stuff\" :: String\n</code></pre>\n\n<p>which fails, of course. There's no String that Shows itself as the five characters <code>stuff</code>.</p>\n\n<p>Rather, it looks to me like you just want to be using <code>T.pack</code> to convert this to a ByteString, just as you do for your other strings.</p>\n"}], "owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 53268536, "answer_count": 2, "score": 0, "last_activity_date": 1542049487, "creation_date": 1542047278, "last_edit_date": 1542048245, "question_id": 53268037, "link": "https://stackoverflow.com/questions/53268037/how-can-i-avoid-an-error-involving-lazy-bytestrings", "title": "How can I avoid an error involving lazy bytestrings?", "body": "<p>I tried the following code :</p>\n\n<pre><code>import Network.HTTP.Types\nimport Data.Text as T\nimport Data.ByteString.Builder\n\nit = toLazyByteString $ encodePath (Prelude.map T.pack [\"foo\",\"bar\"]) [(read \"stuff\",Nothing)]\n\nmain = print it\n</code></pre>\n\n<p>ghci 7.10.3 accepts to give me a type but somehow cannot compute \"it\" :</p>\n\n<pre><code>\"*** Exception: Prelude.read: no parse\n</code></pre>\n\n<p>ghc 7.10.3 links but gives :</p>\n\n<pre><code>collect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>What is wrong with this expression ? I know it is an ugly expression and that it may look better with OverloadedStrings, but still, I am perplexed.</p>\n"}, {"tags": ["function", "haskell", "ghci", "toupper"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1542046292, "creation_date": 1542046292, "answer_id": 53267818, "question_id": 53267778, "link": "https://stackoverflow.com/questions/53267778/haskell-ghci-function-toupper-not-found/53267818#53267818", "title": "Haskell-ghci, function toUpper not found?", "body": "<p>The <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Char.html#v:toUpper\" rel=\"nofollow noreferrer\"><strong><code>toUpper :: Char -&gt; Char</code></strong></a> is not part of the <code>Prelude</code>, and thus not imported \"implicitly\".</p>\n\n<p>You can import it with:</p>\n\n<pre><code>import Data.Char(toUpper)</code></pre>\n\n<p>or just:</p>\n\n<pre><code>import Data.Char</code></pre>\n\n<p>to import all functions, datatypes, etc. defined in that module.</p>\n\n<p>Note that it has signature <code>Char -&gt; Char</code>, so it only converts a <em>single</em> character to its uppercase equivalent.</p>\n\n<p>You thus need to perform a <code>map</code>ping:</p>\n\n<pre><code>Prelude Data.Char&gt; map toUpper \"something\"\n\"SOMETHING\"\n</code></pre>\n"}], "owner": {"reputation": 339, "user_id": 5882642, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/202d1963ca33998dea7d176aef7053fa?s=128&d=identicon&r=PG&f=1", "display_name": "glc78", "link": "https://stackoverflow.com/users/5882642/glc78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 0, "accepted_answer_id": 53267818, "answer_count": 1, "score": 2, "last_activity_date": 1542046292, "creation_date": 1542046097, "question_id": 53267778, "link": "https://stackoverflow.com/questions/53267778/haskell-ghci-function-toupper-not-found", "title": "Haskell-ghci, function toUpper not found?", "body": "<p>I'have right now installed the ghci version 8.6.2 and following a tutorial I write:</p>\n\n<pre><code>toUpper \"something\"\n</code></pre>\n\n<p>but ghci compiler prints out:</p>\n\n<pre><code>Variable not in scope: toUpper :: [Char] -&gt; t\n</code></pre>\n\n<p>Do I miss some libraries or anything else?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1542015949, "creation_date": 1542015949, "answer_id": 53259476, "question_id": 53258843, "link": "https://stackoverflow.com/questions/53258843/system-process-how-to-keep-the-shell-session-instead-of-creating-a-new-process/53259476#53259476", "title": "System.Process How to keep the shell session instead of creating a new process?", "body": "<p>You cannot use an <em>external</em> program to change the current directory of the <em>current</em> program. That just won't work.</p>\n\n<p>It is for this reason that <code>cd</code> is a shell built-in operator, not an external program. (At least, that's how Unix does it. I'm not 100% sure about Windows.)</p>\n\n<p>Try using <a href=\"http://hackage.haskell.org/package/directory-1.3.3.1/docs/System-Directory.html#v:setCurrentDirectory\" rel=\"nofollow noreferrer\">setCurrentDirectory</a> instead. That should allow you to change your Haskell program's current directory, which will then stay permanent for the rest of the program's run (or until you change it again).</p>\n"}, {"tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 2, "last_activity_date": 1542016971, "creation_date": 1542016971, "answer_id": 53259799, "question_id": 53258843, "link": "https://stackoverflow.com/questions/53258843/system-process-how-to-keep-the-shell-session-instead-of-creating-a-new-process/53259799#53259799", "title": "System.Process How to keep the shell session instead of creating a new process?", "body": "<p>First a working code example:</p>\n\n<pre><code>module Main where\n\nimport System.Process\nimport System.IO\n\nourShell :: CreateProcess\nourShell =  (proc \"/bin/bash\" []) { std_in = CreatePipe, std_out = CreatePipe }\n\nmain = do\n  (Just bashIn, Just bashOut, Nothing, bashHandle) &lt;- createProcess ourShell\n\n  hSetBuffering bashIn NoBuffering\n  hSetBuffering bashOut NoBuffering\n\n  print \"Sending pwd\"\n  hPutStrLn bashIn \"pwd\"\n  print \"reading response\"\n  hGetLine bashOut &gt;&gt;= print\n\n  print \"Sending cd test\"\n  hPutStrLn bashIn \"cd test\"\n  print \"reading response\"\n--  hGetLine bashOut &gt;&gt;= print you need to know there is no answer ....\n\n  print \"Sending pwd\"\n  hPutStrLn bashIn \"pwd\"\n  print \"reading response\"\n  hGetLine bashOut &gt;&gt;= print\n\n  hPutStrLn bashIn \"exit\"\n  hGetContents bashOut &gt;&gt;= print\n  ec &lt;- waitForProcess bashHandle\n  print ec\n</code></pre>\n\n<p>This outputs on my machine in <code>/tmp</code> with an existing <code>/tmp/test</code>:</p>\n\n<pre><code>\"Sending pwd\"\n\"reading response\"\n\"/tmp\"\n\"Sending cd test\"\n\"reading response\"\n\"Sending pwd\"\n\"reading response\"\n\"/tmp/test\"\n\"\"\nExitSuccess\n</code></pre>\n\n<p>You start a shell and connect a pipe to its input stream and a pipe to its output stream. Now you can send commands to its input stream and read the responses from its output stream via the connected pipes.</p>\n\n<p>But now you need a protocol, so you know what output belongs to which command. So you need to know, for example, how many output lines will be generated for which output. If you for exampled tried to read a response for the <code>cd test</code> command, your program would hang, as there isn't any output.</p>\n\n<p>There are other ways to handle that, but they all involve heuristics of some kind and exceed the scope of the question.</p>\n"}], "owner": {"reputation": 1145, "user_id": 1780211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5337812625d313ee46e12042b0388fd?s=128&d=identicon&r=PG", "display_name": "Mo K", "link": "https://stackoverflow.com/users/1780211/mo-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 53259799, "answer_count": 2, "score": 2, "last_activity_date": 1542016971, "creation_date": 1542013517, "question_id": 53258843, "link": "https://stackoverflow.com/questions/53258843/system-process-how-to-keep-the-shell-session-instead-of-creating-a-new-process", "title": "System.Process How to keep the shell session instead of creating a new process?", "body": "<pre><code>import System.Process\n\ncreateProcess (shell \"pwd\") -- /Users/username/current-directory    \ncreateProcess (shell \"cd app\") -- LOST\ncreateProcess (shell \"pwd\") -- /Users/username/current-directory\n</code></pre>\n\n<p>Obviously, <code>createProcess (shell \"cd app\")</code> is not persistent in the next process.</p>\n\n<p>But, how can I keep the session persistent?</p>\n\n<p>I know I can pass <code>cwd</code> but</p>\n\n<pre><code>createProcess (shell \"mkdir some-dir &amp;&amp; cd some-dir\")\ncreateProcess (shell \"pwd\") { cwd = Just \"some-dir\" } \n</code></pre>\n\n<p>But, I have to parse the previous command to get \"some-dir.\"</p>\n\n<p>Is there something better than parsing the command?</p>\n"}, {"tags": ["haskell", "yesod", "keter"], "answers": [{"comments": [{"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1542099942, "post_id": 53274194, "comment_id": 93436677, "body": "Thanks, but I meant to do it without modifying the code of the app."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1542124378, "post_id": 53274194, "comment_id": 93451453, "body": "@artem I don&#39;t see any way of doing it without modifying the code. One hypothetical thing I can image is to see if postgres provides any query for checking if it&#39;s in read only mode. You can then use that information in the <code>runMigration</code> function to not run any migration. But for that to work, you have to patch <code>persistent</code> library and modify some code!"}, {"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1542192081, "post_id": 53274194, "comment_id": 93477314, "body": "Yep, so I take this as an answer &quot;not possible&quot;"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 0, "last_activity_date": 1542085778, "creation_date": 1542085778, "answer_id": 53274194, "question_id": 53257977, "link": "https://stackoverflow.com/questions/53257977/yesod-app-on-keter-with-read-only-access-to-db/53274194#53274194", "title": "Yesod app on keter with read-only access to DB", "body": "<blockquote>\n  <p>Is it possible to temporarily disable migration scripts at startup via keter or app configs or ENV variables?</p>\n</blockquote>\n\n<p>Yes, it's possible. The simplest way to do is using environment variables in my opinion.\nIf you are using yesod's scaffolding site, then you have to make the changes in the <code>makeFoundation</code> function which runs the migration. Note the the function named <code>runMigration</code> is used to perform it. You need to add a appropriate conditional to make it work.</p>\n"}], "owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 53274194, "answer_count": 1, "score": 1, "last_activity_date": 1542085778, "creation_date": 1542009818, "question_id": 53257977, "link": "https://stackoverflow.com/questions/53257977/yesod-app-on-keter-with-read-only-access-to-db", "title": "Yesod app on keter with read-only access to DB", "body": "<p>I have couple yesod apps deployed using keter with PostgreSQL. The thing I really like about them is the automatic DB migration that happens on deployment.</p>\n\n<p>But, now I have faced a small problem: I set up DB replica on another virtual machine; the second DB is slave and thus read-only. When I start keter with my apps deployed, the apps cannot start because they cannot successfully execute migration script. There are dummy changes only, no real change of table, but the app fails to start with\n<code>\"cannot execute ALTER TABLE in a read-only transaction\"</code>.</p>\n\n<p>Is it possible to temporarily disable migration scripts at startup via keter or app configs or ENV variables?</p>\n"}, {"tags": ["date", "parsing", "haskell"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 7, "creation_date": 1541997728, "post_id": 53256041, "comment_id": 93396683, "body": "Start by breaking the problem into smaller pieces. Do you know how to get input from the user in Haskell? Do you know how to declare a custom type? Or is there an existing type that you can use? Do you know basic Haskell syntax? If not, then you should find a book or tutorial."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 1, "creation_date": 1542034210, "post_id": 53256041, "comment_id": 93413366, "body": "please share some code"}, {"owner": {"reputation": 1, "user_id": 10638674, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "soowi", "link": "https://stackoverflow.com/users/10638674/soowi"}, "edited": false, "score": 0, "creation_date": 1542045918, "post_id": 53256041, "comment_id": 93419505, "body": "I edited with the attempt I tried. Thanks for looking."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1542169185, "post_id": 53256041, "comment_id": 93467455, "body": "You should keep the code in your question and post an answer explaining how you solve the problem."}], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 4309230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d55132f900d82089522c457076207f1?s=128&d=identicon&r=PG&f=1", "display_name": "Lein Matsumaru", "link": "https://stackoverflow.com/users/4309230/lein-matsumaru"}, "is_accepted": false, "score": -2, "last_activity_date": 1542036276, "creation_date": 1542036276, "answer_id": 53265224, "question_id": 53256041, "link": "https://stackoverflow.com/questions/53256041/parse-a-user-input-string-into-day-type-and-subtract-two-dates-in-haskell/53265224#53265224", "title": "Parse a user input string into Day type and subtract two dates in Haskell", "body": "<p>I think you want something below,</p>\n\n<pre><code>import Data.Time.Calender\nimport Data.List (intercalate)\n\nreplace :: String -&gt; String\nreplace src = intercalate \"-\" $ words $ filter (/= ',') src\n\nmain :: IO ()\nmain = do\n  -- Example input: 2018, 11, 12\n  dayString &lt;- getLine\n  let day = read (replace dayString) :: Day\n  -- Example output: 2018-11-12\n  print day\n</code></pre>\n\n<p>the problem was that <code>Day</code> expect to read of format <code>YYYY-MM-DD</code> but <code>YYYY, MM, DD</code></p>\n"}], "owner": {"reputation": 1, "user_id": 10638674, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "soowi", "link": "https://stackoverflow.com/users/10638674/soowi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1542169198, "creation_date": 1541997476, "last_edit_date": 1542169198, "question_id": 53256041, "link": "https://stackoverflow.com/questions/53256041/parse-a-user-input-string-into-day-type-and-subtract-two-dates-in-haskell", "title": "Parse a user input string into Day type and subtract two dates in Haskell", "body": "<p>I'm new to Haskell and I need some help. I will like to create a function that takes in a user's input in the format yyyy, mm, dd and convert it to type Day in order to use diffDays.</p>\n\n<p>This is what I tried:</p>\n\n<pre><code>today :: IO (Integer, Int, Int)\ntoday = getCurrentTime &gt;&gt;= return . toGregorian . utctDay\n\ngetDiffDays' :: IO Integer\ngetDiffDays' = do\n     putStr \"What is your birthdate (year, month, day)?: \"\n     dateOfBirth &lt;- getLine\n     let dob = read dateOfBirth :: Day\n     return diffDays today dob\n</code></pre>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1541992730, "post_id": 53255399, "comment_id": 93395652, "body": "(1) Do not use <code>sudo</code> to run <code>cabal</code>. With typical workflows, cabal-install is meant to be ran from your regular user account. (2) Make sure <code>$HOME&#47;.cabal&#47;bin</code>, the default location for executables installed with cabal-install, appears in your PATH before the system-wide location of your preexisting cabal-install. (3) Remember you can check where the executable actually is with <code>which cabal</code>."}, {"owner": {"reputation": 410, "user_id": 3927886, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/689a75ec29af93dcc938fdbd5f039b54?s=128&d=identicon&r=PG&f=1", "display_name": "RamiroPastor", "link": "https://stackoverflow.com/users/3927886/ramiropastor"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1541995888, "post_id": 53255399, "comment_id": 93396285, "body": "@duplode Your suggestions worked, thanks! but do you know how to solve my updated problem? the whole point of upgrading cabal was to run the command <code>new-test</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1541996881, "post_id": 53255399, "comment_id": 93396484, "body": "Note that, in your edit, you are still running <code>cabal</code> with <code>sudo</code>."}, {"owner": {"reputation": 410, "user_id": 3927886, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/689a75ec29af93dcc938fdbd5f039b54?s=128&d=identicon&r=PG&f=1", "display_name": "RamiroPastor", "link": "https://stackoverflow.com/users/3927886/ramiropastor"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542001092, "post_id": 53255399, "comment_id": 93397420, "body": "Won&#39;t work without sudo atm"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542001368, "post_id": 53255399, "comment_id": 93397482, "body": "&quot;Won&#39;t work without sudo atm&quot; -- Exactly how does it fail? If <code>cabal --v</code> and <code>which cabal</code> show you are indeed using the 2.4.0.0 version installed in your home directory, <code>cabal new-test</code> should, in principle, also work."}, {"owner": {"reputation": 410, "user_id": 3927886, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/689a75ec29af93dcc938fdbd5f039b54?s=128&d=identicon&r=PG&f=1", "display_name": "RamiroPastor", "link": "https://stackoverflow.com/users/3927886/ramiropastor"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542001790, "post_id": 53255399, "comment_id": 93397582, "body": "Updated question to show how it fails without sudo. Regarding <code>new-test</code>  i always get <code>unrecognised command</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542002101, "post_id": 53255399, "comment_id": 93397659, "body": "In all likelihood, you are getting &quot;permission denied&quot; errors because you installed cabal-install using sudo, which set wrong file permissions. Delete the whole <code>.cabal</code> directory (using sudo if necessary) and run <code>cabal install cabal-install</code> again, this time without using sudo (if it asks you to run <code>cabal update</code>, do so)."}, {"owner": {"reputation": 410, "user_id": 3927886, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/689a75ec29af93dcc938fdbd5f039b54?s=128&d=identicon&r=PG&f=1", "display_name": "RamiroPastor", "link": "https://stackoverflow.com/users/3927886/ramiropastor"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542002731, "post_id": 53255399, "comment_id": 93397848, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/183477/discussion-between-user3927886-and-duplode\">continue this discussion in chat</a>."}], "owner": {"reputation": 410, "user_id": 3927886, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/689a75ec29af93dcc938fdbd5f039b54?s=128&d=identicon&r=PG&f=1", "display_name": "RamiroPastor", "link": "https://stackoverflow.com/users/3927886/ramiropastor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542001713, "creation_date": 1541991153, "last_edit_date": 1542001713, "question_id": 53255399, "link": "https://stackoverflow.com/questions/53255399/cabal-unexpected-behaviour-when-upgrading", "title": "Cabal unexpected behaviour when upgrading", "body": "<pre><code>ramiro@omfg-hello:~$ cabal --version\ncabal-install version 1.24.0.2\ncompiled using version 1.24.2.0 of the Cabal library \nramiro@omfg-hello:~$ sudo cabal install cabal-install --force-reinstalls\n[sudo] password for ramiro: \nResolving dependencies...\nConfiguring cabal-install-2.4.0.0...\nBuilding cabal-install-2.4.0.0...\nInstalled cabal-install-2.4.0.0\nramiro@omfg-hello:~$ cabal --version\ncabal-install version 1.24.0.2\ncompiled using version 1.24.2.0 of the Cabal library \n</code></pre>\n\n<p>Indeed i wasn't expecting something like this. I'm stunned.</p>\n\n<p>Edit: </p>\n\n<p>Fixed with @duplode comment</p>\n\n<p>Further edit: </p>\n\n<p>Anybody knows why i'm still getting this?</p>\n\n<pre><code>ramiro@omfg-hello:~/Haskell/happstack-server$ sudo cabal new-test all\ncabal: unrecognised command: new-test (try --help)\n</code></pre>\n\n<p>At least i get the correct cabal version now</p>\n\n<pre><code>ramiro@omfg-hello:~/Haskell/happstack-server$ cabal --v\ncabal-install version 2.4.0.0\ncompiled using version 2.4.0.1 of the Cabal library \n</code></pre>\n\n<p>EditN : </p>\n\n<pre><code>ramiro@omfg-hello:~/Haskell/happstack-server$ cabal new-build\n/home/ramiro/.cabal/packages/hackage.haskell.org: openBinaryTempFileWithDefaultPermissions: permission denied (Permission denied)\nramiro@omfg-hello:~/Haskell/happstack-server$ sudo cabal new-build\n[sudo] password for ramiro: \nUp to date\nramiro@omfg-hello:~/Haskell/happstack-server$ \n</code></pre>\n\n<p>Non-sudo vs sudo.</p>\n"}, {"tags": ["list", "haskell", "recursion", "random", "monads"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 4, "creation_date": 1541989002, "post_id": 53255009, "comment_id": 93394997, "body": "What is the purpose of the input list? You never use its elements (<code>x</code>) in these examples. And you can write your <code>do</code>-notation version with <code>&gt;&gt;=</code> if you want with the standard desugaring: <code>sample (normal 0 1) gen &gt;&gt;= \\rand -&gt; let next = current + rand in recurse gen (next : history) xs</code>, or omitting the <code>let</code> binding, <code>sample (normal 0 1) gen &gt;&gt;= \\rand -&gt; recurse gen (current + rand : history) xs</code>."}, {"owner": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1542004544, "post_id": 53255009, "comment_id": 93398401, "body": "You&#39;re right the x values are not actually used, they may be in a different version of this function, and I often prefer that to a countdown to 0 as edge case. The desugaring makes sense, and it works, but I guess there is some odd structure with placing the return that is not as intuitive. I still need to find a way of doing away with the history@ construct, but that should be easier that the first part. Thanks."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1542007140, "post_id": 53255009, "comment_id": 93399337, "body": "Related: &quot;Building a list in a monad&quot; <a href=\"https://www.joachim-breitner.de/blog/620-Constructing_a_list_in_a_Monad\" rel=\"nofollow noreferrer\">joachim-breitner.de/blog/620-Constructing_a_list_in_a_Monad</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1542034674, "post_id": 53255009, "comment_id": 93413620, "body": "There&#39;s nothing &quot;impure&quot; about monads; they simply allow you to abstract away the explicit handling of the generator between calls to <code>purecurse</code>. The notion that monads are impure stems from the fact that one usually learns about monads by working with IO actions. For example, <code>getLine :: IO String</code> is an IO <i>action</i>, but <code>putStrLn :: String -&gt; IO ()</code> is a <i>pure</i> function that returns an IO action. The <code>&gt;&gt;=</code> operator is a pure function that creates a new IO action, e.g., <code>getLine &gt;&gt;= putStrLn :: IO ()</code>."}, {"owner": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542035780, "post_id": 53255009, "comment_id": 93414230, "body": "@chepner yes, I realize that, the point is not about the function being pure or not, but how to use translate/adapt a typical recursive function to one using monads. Thanks."}, {"owner": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1542065446, "post_id": 53255009, "comment_id": 93426669, "body": "@JonPurdy I think you reply is half of the answer I need. I managed to write it without the <code>@history</code> construct, that&#39;s the other half of the answer, I guess: <code>recurse&#39; gen _ [] = return []; recurse&#39; gen current (x:xs) = do   rand  &lt;- sample (normal 0 1) gen   let next = current + rand   future &lt;- recurse&#39; gen next xs   return (next:future)</code> but didn&#39;t manage to desugar it in a way similar to what you did. Putting the two things together would be the exact answer to the question I had, if it&#39;s at al possible. In any case thanks for all the help."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "edited": false, "score": 0, "creation_date": 1541990863, "post_id": 53255290, "comment_id": 93395343, "body": "I tried to make a sequence of what I think you are calling &quot;monadic actions&quot; to bind results to <code>m Double</code> variables, but I couldn&#39;t turn that into <code>m [Double]</code> the way I thought I could. I&#39;m assuming sequence would &quot;just work&quot; on a list of monads  so I could bind that to <code>m [Double]</code>, but I&#39;m still missing that previous step. I&#39;m no sure that would be the closest solution to the pure function structure, but in any case a full example would be much appreciated. Thanks."}, {"owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "reply_to_user": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "edited": false, "score": 0, "creation_date": 1542050355, "post_id": 53255290, "comment_id": 93421256, "body": "I edited my reply to provide an example. I had explicitly mentioned &quot;sequence&quot; but indeed your function can&#39;t be sequenced in that way. In any case, the is the same (which you may or may not like). You can abstract various bits of your code away, which results in some actions that you need to sequence / compose. The idea being that this should isolate away the bit or bits you find more confusing, and the rest should be easily relatable to non-monadic strategies."}, {"owner": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "edited": false, "score": 0, "creation_date": 1542065008, "post_id": 53255290, "comment_id": 93426551, "body": "Thanks for elaborating. It&#39;s not clear to me that this implementation accounts for the dependence of each new state on the previous state, not just the accumulator and the new &quot;random&quot; value, but admittedly it may be my fault in not understanding the monadic operators <code>&gt;=&gt;</code> and <code>*=&gt;</code>. I&#39;m not an experienced Haskeller and rarely go beyond <code>&gt;&gt;=</code> and <code>&gt;&gt;</code> with monads. Also I think monolithic recursion is very transparent, so I was hoping there could be an analogous way of doing that. However, it may well be that this is more idiomatic, but I don&#39;t really like it. In any case thanks for the help."}, {"owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "reply_to_user": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "edited": false, "score": 1, "creation_date": 1542067218, "post_id": 53255290, "comment_id": 93427104, "body": "OK, so edited the answer to include a monolithic alternative to yours. I suppose you  might prefer that. I do believe it should be very useful to go through the modular code though. In particular because the monolithic version implicitly does the work of (*=&gt;). And you might understand that better in isolation. Also the modular code gives you the opportunity to look at the version with (&gt;=&gt;) that just returns the last result, which is simpler and an intermediate step to understand how this all works. Also note (&gt;=&gt;) is very close to (&gt;&gt;=), it&#39;s just defined by (f &gt;=&gt; g) x = f x &gt;&gt;= g"}, {"owner": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "edited": false, "score": 0, "creation_date": 1542170209, "post_id": 53255290, "comment_id": 93467667, "body": "The <code>rc</code> function is half of what I wanted, the same as my comment above, the other part was using <code>&gt;&gt;=</code> instead of do, but I didn&#39;t seem to desugar that multiline statement correctly, if it&#39;s possible. That would be the exact answer I&#39;m looking for."}, {"owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "reply_to_user": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "edited": false, "score": 0, "creation_date": 1542189289, "post_id": 53255290, "comment_id": 93475553, "body": "Edited to include a version with <code>&gt;&gt;=</code> instead of do notation."}, {"owner": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "edited": false, "score": 0, "creation_date": 1542214625, "post_id": 53255290, "comment_id": 93491266, "body": "Sorry for all the trouble, that was exactly the structure I was looking for but couldn&#39;t figure out. These parentheses get pretty funky when nesting <code>&gt;&gt;=</code> operators. Obrigado."}, {"owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "reply_to_user": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "edited": false, "score": 0, "creation_date": 1542235370, "post_id": 53255290, "comment_id": 93500483, "body": "No worries! Glad it helped :)"}], "tags": [], "owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "is_accepted": true, "score": 1, "last_activity_date": 1542189369, "last_edit_date": 1542189369, "creation_date": 1541989840, "answer_id": 53255290, "question_id": 53255009, "link": "https://stackoverflow.com/questions/53255009/recursively-defining-a-list-of-monadic-random-numbers-most-idiomatic-haskell-an/53255290#53255290", "title": "Recursively defining a list of monadic random numbers: most idiomatic Haskell and analogous to pure code", "body": "<blockquote>\n  <p>The main question I would like help with is: is there a Haskell idiomatic way of writing such a recursion of monadic values resulting in a monadic list that is similar to the structure of a pure function?</p>\n</blockquote>\n\n<p>You can do it in two steps. Have your recursive function return a list of \"monadic actions\", then compose / sequence those actions.</p>\n\n<p>Lets consider a simpler but analogous function to yours, for ease of presentation. Instead of randomness lets consider input. The list you recourse over is there for size only (content is ignored) so lets just use an integer.</p>\n\n<pre><code>rc ::  Int -&gt; [Double] -&gt; IO [Double]\nrc 0 h        = return h\nrc n h@(cr:_) = do rand &lt;- readLn :: IO Double\n                   let nx = cr + rand\n                   rc (n-1)(nx:h) \n</code></pre>\n\n<p>Here is a similar alternative that works the way you wants</p>\n\n<pre><code>rc' ::  Int -&gt; Double -&gt; IO [Double]\nrc' 0 cr = return []\nrc' n cr = do rand &lt;- readLn :: IO Double\n              let nx = cr + rand\n              xs   &lt;- rc' (n-1) nx\n              return (nx : xs)\n</code></pre>\n\n<p>And here without do notation</p>\n\n<pre><code>rc'' ::  Int -&gt; Double -&gt; IO [Double]\nrc'' 0 cr = return []\nrc'' n cr = (readLn :: IO Double) &gt;&gt;= (\\rand -&gt; \n              let nx = cr + rand \n              in (rc'' (n-1) nx) &gt;&gt;= (\\xs -&gt;\n                 return (nx : xs))) \n</code></pre>\n\n<p>In any case, another thing you can do is abstract away pieces of code, rather than have a monolithic presentation. </p>\n\n<p>In each step you require the current value to generate a new one. So a step is a function of type <code>Double -&gt; IO Double</code>. And this is a pretty neat type, fundamental in the world of monads. You can bind values to a step via <code>x &gt;&gt;= step</code> or compose two steps with <code>step1 &gt;=&gt; step2</code>. So lets go with it.</p>\n\n<pre><code>step :: Double -&gt; IO Double\nstep cr = do rand &lt;- readLn :: IO Double\n             return (cr + rand)\n</code></pre>\n\n<p>It's very easy to understand. You 'generate' a number, add the current one and return the result. And you want to do <code>n</code> such steps, so make a list of steps. </p>\n\n<pre><code>steps :: Int -&gt; [Double -&gt; IO Double]\nsteps n = replicate n step \n</code></pre>\n\n<p>Now you can choose how to combine them. For instance it would be very natural to fold a list of steps with <code>&gt;=&gt;</code>. You would get this, </p>\n\n<pre><code>runSteps :: Int -&gt; Double -&gt; IO Double \nrunSteps n = foldr (&gt;=&gt;) return (steps n)\n</code></pre>\n\n<p>It's close to what you want but only returns the final result, rather than accumulate the generated values at each step. Below is a (restricted) type of <code>(&gt;=&gt;)</code> and the type of the operator <code>(*=&gt;)</code> we want.</p>\n\n<pre><code>(&gt;=&gt;) :: Monad m =&gt; (a -&gt; m a) -&gt; (b -&gt; m  a)  -&gt; a -&gt; m  a\n(*=&gt;) :: Monad m =&gt; (a -&gt; m a) -&gt; (a -&gt; m [a]) -&gt; a -&gt; m [a]\n</code></pre>\n\n<p>The definition is,</p>\n\n<pre><code>(*=&gt;) :: Monad m =&gt; (a -&gt; m a) -&gt; (a -&gt; m [a]) -&gt; a -&gt; m [a]\n(*=&gt;) ac uc c = do x  &lt;- ac c\n                   xs &lt;- uc x\n                   return (x:xs) \n</code></pre>\n\n<p>I actually think this encapsulates the bit you didn't particularly like. Now we abstracted it away to this isolated piece of code. Even away from the recursive calls. And finally we just fold to execute the steps. </p>\n\n<pre><code>execSteps :: Int -&gt; Double -&gt; IO [Double] \nexecSteps n = foldr (*=&gt;) (\\x -&gt; return []) (steps n) \n</code></pre>\n\n<p>This function differs from the original one in the initial input being a <code>Double</code> rather than a <code>[Double]</code>. But this is the type that makes sense. You'd just be passing a single wrapped double in the original function. And it accumulates the elements in the 'right' order as you requested. </p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "edited": false, "score": 0, "creation_date": 1542065769, "post_id": 53257543, "comment_id": 93426740, "body": "<code>pureceurse</code> is a typical recursively defined list where each item is defined at a step and joined to the previous ones with <code>:</code>, then appending <code>:[]</code> in the end to actually make it into a list. I wanted a monadic version of that in terms of basic monad operators, not higher level libraries, and not even do notation, if possible. In any case thanks for the help, I&#39;ll check it out."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1542007623, "creation_date": 1542007623, "answer_id": 53257543, "question_id": 53255009, "link": "https://stackoverflow.com/questions/53255009/recursively-defining-a-list-of-monadic-random-numbers-most-idiomatic-haskell-an/53257543#53257543", "title": "Recursively defining a list of monadic random numbers: most idiomatic Haskell and analogous to pure code", "body": "<p>In situations like this, I usually jump straight to using a streaming library with a suitably list-like interface, like <a href=\"http://hackage.haskell.org/package/streaming-0.2.2.0\" rel=\"nofollow noreferrer\">streaming</a>. They allow a more natural translation from pure code to monadic, and have the added benefit that you aren't required to construct/consume all of the results at once, but instead incrementally, just as with pure lists.</p>\n\n<p>I'm not sure what <code>purecurse</code> is doing, but it could be written as</p>\n\n<pre><code>import           Streaming\nimport qualified Streaming.Prelude as S\n\nrecurse :: PrimMonad m \n        =&gt; Gen (PrimState m) \n        -&gt; Double \n        -&gt; [Double] \n        -&gt; Stream (Of Double) m ()\nrecurse gen current [] = \n    return ()\nrecurse gen current (x:xs) =\n    S.yield current *&gt; -- (*&gt;) and (&gt;&gt;) work like concatenation for pure lists\n    lift (sample (normal 0 1) gen) &gt;&gt;= \\rand -&gt; \n    recurse gen (current + rand) xs\n</code></pre>\n\n<p>Or, more naturally using do-notation, as:</p>\n\n<pre><code>recurse :: PrimMonad m \n        =&gt; Gen (PrimState m) \n        -&gt; Double \n        -&gt; [Double] \n        -&gt; Stream (Of Double) m ()\nrecurse gen current [] = \n    return ()\nrecurse gen current (x:xs) = \n    do S.yield current -- (*&gt;) and (&gt;&gt;) work like concatenation for pure lists\n       rand &lt;- lift $ sample (normal 0 1) gen\n       recurse gen (current + rand) xs\n</code></pre>\n\n<p>Now you can use function like <a href=\"http://hackage.haskell.org/package/streaming-0.2.2.0/docs/Streaming-Prelude.html#v:take\" rel=\"nofollow noreferrer\"><code>S.take</code></a> to generate/extract only parts of the result. If you want to get the whole list, you can use <a href=\"http://hackage.haskell.org/package/streaming-0.2.2.0/docs/Streaming-Prelude.html#v:toList_\" rel=\"nofollow noreferrer\"><code>S.toList_</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "edited": false, "score": 0, "creation_date": 1542036416, "post_id": 53262452, "comment_id": 93414587, "body": "Thanks. I think applicative can be an alternative to monads here, I will have to take a closer look at what comes out of using it, but I want to keep it as readable as possible even for non-Haskellers, and applicative always looks kind of alien to many people (<code>&gt;&gt;=</code> too, to be fair). Thanks again."}], "tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 1, "last_activity_date": 1542040520, "last_edit_date": 1542040520, "creation_date": 1542026587, "answer_id": 53262452, "question_id": 53255009, "link": "https://stackoverflow.com/questions/53255009/recursively-defining-a-list-of-monadic-random-numbers-most-idiomatic-haskell-an/53262452#53262452", "title": "Recursively defining a list of monadic random numbers: most idiomatic Haskell and analogous to pure code", "body": "<blockquote>\n  <p>is there a Haskell idiomatic way of writing such a recursion of\n  monadic values resulting in a monadic list that is similar to the\n  structure of a pure function</p>\n</blockquote>\n\n<p>Usually, when need apply a monadic values to a pure function, <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Control-Applicative.html#t:Applicative\" rel=\"nofollow noreferrer\">Applicative</a> operator, such as <code>&lt;$&gt;</code>, <code>&lt;*&gt;</code> may be helpful.</p>\n\n<p>In particular, for list construction, it is often apply operator <code>(:)</code> in recursive way to build a list, like </p>\n\n<pre><code>f [] = []\nf (x:xs) = x : f xs\n</code></pre>\n\n<p>in prefix way:</p>\n\n<pre><code>(:) x (f xs)\n</code></pre>\n\n<p>However, (:) is pure function, not accept monadic value by default, but the good new is, every data type which is instance of Monad, it also be an instance of Applicative. with help of Applicative operator mentioned above, monadic value can be applied to pure function without any change. For example, </p>\n\n<pre><code>(:) &lt;$&gt; (pure x) &lt;*&gt; (pure .f) xs\n</code></pre>\n\n<p>will return a monadic List instead of pure list.</p>\n\n<p>Return to your question, personally, I think your solution in question is already almost a  idiomatic way to do that (since it is simple and readable) except always append <code>next random value</code> at the head of <code>history</code>. </p>\n\n<p>As you said, <code>the list back in reverse</code> and worse, when the <code>history</code> list has old random value already, it is inconvenient to find out which is new add to it.</p>\n\n<p>To solve it, it can be modified slightly as:</p>\n\n<pre><code>recurse :: PrimMonad m =&gt; Gen (PrimState m) -&gt; [Double] -&gt; [Double] -&gt; m [Double]\nrecurse gen history [] = return history\nrecurse gen history (x:xs) = do rand &lt;- (sample (normal 0 1) gen)\n                                let next = (last history) + rand\n                                recurse gen (history ++ [next]) xs\n</code></pre>\n\n<p>It make sense, if the last element of history is the newest random value.</p>\n\n<p>However, the different between <code>(:)</code> and <code>(++)</code> is: <code>(:)</code> is O(1), but (++) is O(N), where the N is the length of history list. (and <code>last history</code> is also O(N) instead of O(1)).</p>\n\n<p>To archive an efficient solution, a helper function may need to introduce, say, <code>newHistory</code>, to construct a new list of random value as:</p>\n\n<pre><code>newHistory::PrimMonad m=&gt;Gen(PrimState m)-&gt;m Double-&gt;[Double]-&gt;m [Double]\nnewHistory _ _ []             = return []\nnewHistory gen current (x:xs) = let next = (+) &lt;$&gt; current &lt;*&gt; sample (normal 0 1) gen\n                                in  (:) &lt;$&gt; next &lt;*&gt; newHistory gen next xs\n</code></pre>\n\n<p>As said before, with help of Applicative operator, the syntax look like pure function, except apply function in prefix way and use Applicative operator.</p>\n\n<p>And then append back to the original <code>history</code> list as:</p>\n\n<pre><code>(++) &lt;$&gt; pure history &lt;*&gt; newHistory gen (pure $ last history) xs\n</code></pre>\n\n<p>And the Applicative version of <code>recurse</code> function look like:</p>\n\n<pre><code>recurse2::PrimMonad m=&gt;Gen(PrimState m)-&gt;[Double]-&gt;[Double]-&gt;m [Double]\nrecurse2 gen history xs = \n    (++) &lt;$&gt; pure history &lt;*&gt; newHistory gen (pure $ last history) xs\n\n    where newHistory::PrimMonad m=&gt;Gen(PrimState m)-&gt;m Double-&gt;[Double]-&gt;m [Double]\n          newHistory _ _ []         = return []\n          newHistory gen current (x:xs) = \n            let next = (+) &lt;$&gt; current &lt;*&gt; sample (normal 0 1) gen\n            in  (:) &lt;$&gt; next &lt;*&gt; newHistory gen next xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "edited": false, "score": 0, "creation_date": 1542036666, "post_id": 53262611, "comment_id": 93414728, "body": "Thanks, but I do understand how desugaring works, and the do-notation function is doing what is expected. I am indeed having trouble with the interaction of the bind operator and recursion, that&#39;s what I needed help with, but thanks for your time."}], "tags": [], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "is_accepted": false, "score": 0, "last_activity_date": 1542027230, "creation_date": 1542027230, "answer_id": 53262611, "question_id": 53255009, "link": "https://stackoverflow.com/questions/53255009/recursively-defining-a-list-of-monadic-random-numbers-most-idiomatic-haskell-an/53262611#53262611", "title": "Recursively defining a list of monadic random numbers: most idiomatic Haskell and analogous to pure code", "body": "<p>Your issue seems to lie with do-notation and monads. You're assuming there's much more magic going on than there actually is: <a href=\"http://www.haskellforall.com/2014/10/how-to-desugar-haskell-code.html\" rel=\"nofollow noreferrer\">learning how the desugaring works</a> will help you out here.</p>\n\n<p>Anyway, let's try and convert the non-monadic version into the monadic one step-by-step. First, the type signature:</p>\n\n<pre><code>recurse :: PrimMonad m =&gt; Gen (PrimState m) -&gt; Double -&gt; [Double] -&gt; m [Double]\n</code></pre>\n\n<p>I'm not sure why you had <code>[Double]</code> as the second parameter in your version: we want to change as little as possible from the original. The first clause, then:</p>\n\n<pre><code>purecurse gen current [] = []\n-- Goes to:\nrecurse gen current [] = return []\n</code></pre>\n\n<p>Again, we're changing as little as possible: no effects were happening in this clause in your pure code, so no effects should be happening here, either. You got the next two lines right:</p>\n\n<pre><code>purecurse gen current (x:xs) = let (rand, gen2) = puregaussian gen 0 1\n                                   next = current + rand\n-- Goes to:\nrecurse gen current (x:xs) = do rand &lt;- (sample (normal 0 1) gen)\n                                let next = current + rand\n</code></pre>\n\n<p>But the last one tripped you up. Ideally, we would write:</p>\n\n<pre><code>in current:purecurse gen2 next xs\n-- Goes to:\ncurrent:recurse gen next xs\n</code></pre>\n\n<p>But it doesn't work! What's more, you get a confusing error:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018Double\u2019 with \u2018[Double]\u2019\n  Expected type: m [Double]\n    Actual type: [Double]\n</code></pre>\n\n<p>This is probably what led you down the wrong path. The issue has nothing to do with the lists: it's to do with the <code>m</code> (the encapsulating monad). When you write <code>current : xs</code>, <code>xs</code> has to be a list: in this example, it's actually a <code>m [Double]</code>, or a list wrapped in the monad. There's two ways to solve the problem (which are both equivalent). We could <em>unwrap</em> the list, using do notation again:</p>\n\n<pre><code>rest &lt;- recurse gen next xs\nreturn (current : rest)\n</code></pre>\n\n<p>Or we could <em>lift</em> the function <code>current :</code> to work inside the monad:</p>\n\n<pre><code>fmap (current:) (recurse gen next xs)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7724046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLUZn.png?s=128&g=1", "display_name": "Twisted Mersenne", "link": "https://stackoverflow.com/users/7724046/twisted-mersenne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 53255290, "answer_count": 4, "score": 2, "last_activity_date": 1542189369, "creation_date": 1541986831, "question_id": 53255009, "link": "https://stackoverflow.com/questions/53255009/recursively-defining-a-list-of-monadic-random-numbers-most-idiomatic-haskell-an", "title": "Recursively defining a list of monadic random numbers: most idiomatic Haskell and analogous to pure code", "body": "<p>I am trying to recursively make a list of random numbers that uses the previous value to get the next (so recursion is required instead of map or fold, and also I prefer to make it explicit unless map/foldr makes it ridiculously simple in comparison).</p>\n\n<p>Using a pure PRNG this is very straightforward and idiomatic, in my opinion (puregaussian uses System.Random to generate a normal variate and has type <code>puregaussian :: System.Random.RandomGen t =&gt; t -&gt; Double -&gt; Double -&gt; (Double, t)</code>).</p>\n\n<pre><code>purecurse :: System.Random.RandomGen t =&gt; t -&gt; Double -&gt; [Double] -&gt; [Double]\npurecurse gen current [] = []\npurecurse gen current (x:xs) = let (rand, gen2) = puregaussian gen 0 1\n                                   next = current + rand\n                               in current:purecurse gen2 next xs\n</code></pre>\n\n<p>Unfortunately, pure PRNGs don't seem do be as well developed in Haskell as the monadic ones, so I want to do the same thing using a library like random-fu or mwc-probability, and the solutions I found to work are either unidiomatic, not as concise, or both.</p>\n\n<p>Here's a solution using do notation that works, and why I'm not satisfied with it:</p>\n\n<pre><code>import Control.Monad.Primitive\nimport System.Random.MWC.Probability\n\nrecurse :: PrimMonad m =&gt; Gen (PrimState m) -&gt; [Double] -&gt; [Double] -&gt; m [Double]\nrecurse gen history@(current:_) [] = return history\nrecurse gen history@(current:_) (x:xs) = do\n                                         rand &lt;- (sample (normal 0 1) gen)\n                                         let next = current + rand\n                                         recurse gen (next:history) xs\n</code></pre>\n\n<p>First of all I would rather use <code>&gt;&gt;=</code> than do notation, but I couldn't find a way of binding the <code>rand</code> variable that has type <code>m Double</code> and then lifting it to get <code>m [Double]</code> at the end case. There doesn't seem to be a lot of documentation (that I could find) or examples on how to do something like that.\nI thought maybe it would be necessary to nest the <code>(&gt;&gt;=)</code> operators, but that could make the function extremely complicated or unreadable. If that is the tradeoff, maybe do notation is just cleaner, but I didn't manage to make even that work and would like to know how to.</p>\n\n<p>Second, the function requires the entire list to be passed on at each call, and gives the list back in reverse (and just switching <code>next</code> and <code>history</code> breaks it).</p>\n\n<p>So. I would like to be able to pass the initial state and a list to recurse over that returns a monadic list of values.</p>\n\n<p>The main question I would like help with is: is there a Haskell idiomatic way of writing such a recursion of monadic values resulting in a monadic list that is similar to the structure of a pure function?</p>\n"}, {"tags": ["json", "haskell", "aeson"], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 3, "last_activity_date": 1541967112, "last_edit_date": 1541967112, "creation_date": 1541965959, "answer_id": 53252594, "question_id": 53251928, "link": "https://stackoverflow.com/questions/53251928/haskell-aeson-is-there-a-better-way-of-getting-the-info-i-need-from-usda-data/53252594#53252594", "title": "Haskell, Aeson - Is there a better way of getting the info I need from USDA database?", "body": "<p>Define the types you'd like to deserialise into, for example:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\nmodule Q53251928 where\n\nimport Data.Aeson\nimport GHC.Generics\n\ndata Item = Item { ndbno :: String } deriving (Eq, Show, Generic)\ninstance FromJSON Item\n\ndata FoodStuff = FoodStuff { item :: [Item] } deriving (Eq, Show, Generic)\ninstance FromJSON FoodStuff\n\ndata RootJSON = RootJSON { list :: FoodStuff } deriving (Eq, Show, Generic)\ninstance FromJSON RootJSON\n</code></pre>\n\n<p>These types are the minimal types you'll need to access all the <code>ndbno</code> values. You can add other labels to the types to capture other data, e.g. <code>group</code>, <code>start</code>, <code>end</code>, etc.</p>\n\n<p>I downloaded the file in the link and attempted to decode it from GHCi, which worked fine:</p>\n\n<pre><code>*Q53251928 Q53251928&gt; decodeFileStrict \"download.json\" :: IO (Maybe RootJSON)\nJust (RootJSON {list = FoodStuff {item = [Item {ndbno = \"45044170\"},\nItem {ndbno = \"45044169\"},Item {ndbno = \"45287938\"},Item {ndbno = \"45314045\"},\nItem {ndbno = \"45036851\"},Item {ndbno = \"45036824\"},Item {ndbno = \"45198766\"},\nItem {ndbno = \"45270526\"},Item {ndbno = \"45270516\"},Item {ndbno = \"45374956\"},\nItem {ndbno = \"45215370\"},Item {ndbno = \"45225694\"},Item {ndbno = \"45225696\"},\nItem {ndbno = \"45217133\"},Item {ndbno = \"45053881\"},Item {ndbno = \"45270521\"},\nItem {ndbno = \"45226407\"},Item {ndbno = \"45218344\"},Item {ndbno = \"45225703\"},\nItem {ndbno = \"45335760\"},Item {ndbno = \"45221588\"},Item {ndbno = \"45193027\"},\nItem {ndbno = \"45194338\"},Item {ndbno = \"45194331\"},Item {ndbno = \"45256801\"}]}})\n</code></pre>\n"}], "owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 53252594, "answer_count": 1, "score": 2, "last_activity_date": 1541967112, "creation_date": 1541961490, "last_edit_date": 1541966068, "question_id": 53251928, "link": "https://stackoverflow.com/questions/53251928/haskell-aeson-is-there-a-better-way-of-getting-the-info-i-need-from-usda-data", "title": "Haskell, Aeson - Is there a better way of getting the info I need from USDA database?", "body": "<p>I'm a Haskell beginner trying to learn JSON parsing by going through USDA database.</p>\n\n<p>I want to get the value of <code>\"ndbno\"</code> key from this link \n<a href=\"https://api.nal.usda.gov/ndb/search/?format=json&amp;q=potato+salad&amp;sort=n&amp;max=25&amp;offset=0&amp;api_key=DEMO_KEY\" rel=\"nofollow noreferrer\">https://api.nal.usda.gov/ndb/search/?format=json&amp;q=potato+salad&amp;sort=n&amp;max=25&amp;offset=0&amp;api_key=DEMO_KEY</a></p>\n\n<p>The JSON file from that link looks like this:</p>\n\n<pre><code>{\n    \"list\": {\n        \"q\": \"potato salad\",\n        \"sr\": \"1\",\n        \"ds\": \"any\",\n        \"start\": 0,\n        \"end\": 25,\n        \"total\": 251,\n        \"group\": \"\",\n        \"sort\": \"n\",\n        \"item\": [\n            {\n                \"offset\": 0,\n                \"group\": \"Branded Food Products Database\",\n                \"name\": \"AHOLD, DEVILED EGG POTATO SALAD, UPC: 688267141584\",\n                \"ndbno\": \"45044170\",\n                \"ds\": \"LI\",\n                \"manu\": \"Ahold USA, Inc.\"\n            },\n            {\n                \"offset\": 1,\n                \"group\": \"Branded Food Products Database\",\n                \"name\": \"AHOLD, REDSKIN POTATO SALAD, UPC: 688267141591\",\n                \"ndbno\": \"45044169\",\n                \"ds\": \"LI\",\n                \"manu\": \"Ahold USA, Inc.\"\n                },\n...\n</code></pre>\n\n<p><code>\"nbdno\"</code> key is 4th in <code>\"item\"</code></p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n\nmodule Lib\n    ( someFunc\n    ) where\n\n\nimport           Data.Aeson\nimport           Data.HashMap.Strict  as HS\nimport           Data.List            as L\nimport           Data.Maybe\nimport           Data.Text\nimport           Data.Vector          as V\nimport           GHC.Generics\nimport           Network.HTTP.Conduit\nimport           Text.Pretty.Simple\n\n\ndata Food = Name (String, Text)\n          | Stuff (String, Int)\n    deriving (Eq, Read, Show, Generic)\n\n\n\nsomeFunc :: IO ()\nsomeFunc = putStrLn \"Under Consruction!\"\n\n\napiKey = \"https://api.nal.usda.gov/ndb/search/?format=json&amp;q=chana+dal&amp;sort=n&amp;max=25&amp;offset=0&amp;api_key=jJN9dsKFe507qjLVqbecijtrYB4AiojXVIt1EaEZ\"\n\n\ninstance FromJSON Food\n\n\nunString x = case x of\n  String x -&gt; x\n\nunObject x = case x of\n  Object x -&gt; x\n\nunArray x = case x of\n  Array x -&gt; x\n\n\ngetParsed :: IO ()\ngetParsed = do\n  x &lt;- simpleHttp apiKey\n  let y = (unObject . snd . L.head . HS.toList . fromJust) (decode x :: Maybe Object)\n      z = (unArray . snd . L.last . L.init) (HS.toList y)\n      a = V.map (unpack . unString . snd . L.head . L.drop 5 . HS.toList . unObject) z\n      b = V.map (\\x -&gt; read x :: Int) a\n  pPrint b\n</code></pre>\n\n<p>The way I implemented it is quite messy, but it gets the job done. </p>\n\n<p>It's just that the code looks really bad and almost impossible to read. So I was wondering if there's a better way of doing that.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541958178, "post_id": 53251440, "comment_id": 93387605, "body": "Here <code>x</code> and <code>y</code> seem to be <code>Bool</code>s, and your condition does not look correct."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541958204, "post_id": 53251440, "comment_id": 93387613, "body": "As for <code>Int</code>s, one can write <code>Int</code> literals, but since that domain is huge, it would really be a (very) bad idea."}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541958290, "post_id": 53251440, "comment_id": 93387641, "body": "check :: Bool -&gt; Bool -&gt; Bool do you mean this ??"}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541958473, "post_id": 53251440, "comment_id": 93387701, "body": "it&#39;s a homework and I have to do it today -_-"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 1, "creation_date": 1541958556, "post_id": 53251440, "comment_id": 93387725, "body": "If <code>x</code> and <code>y</code> are booleans, you can simply enumerate all possible choices and you&#39;re done. With ints, you can&#39;t do this (because there are infinitely many of them), so pattern-matching is not an option."}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1541958709, "post_id": 53251440, "comment_id": 93387765, "body": "can you give me an example ) @ForceBru"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1541958802, "post_id": 53251440, "comment_id": 93387789, "body": "Do you understand how pattern matching works in general? The <code>Bool</code> type is a union with two cases <code>True</code> and <code>False</code> so you can match against those values directly e.g. <code>f True = ...</code>"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1541958845, "post_id": 53251440, "comment_id": 93387799, "body": "@Amerov, literally enumerate all possible choices and define what the function returns in each case, like this: <code>check True True = True</code>, then, on the next line, <code>check False False = True</code>. I&#39;ll let you finish this yourself)"}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1541958921, "post_id": 53251440, "comment_id": 93387823, "body": "actually no that&#39;s why I asked for an example @Lee"}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1541958950, "post_id": 53251440, "comment_id": 93387832, "body": "@ForceBru Thanks &lt;3"}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1541959173, "post_id": 53251440, "comment_id": 93387887, "body": "@ForceBru Parse error in pattern: checkc    | 32 | checkc x y : False False = True    | ^^^^^^^^ Failed, no modules loaded. Prelude&gt;  I got this error"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1541959381, "post_id": 53251440, "comment_id": 93387952, "body": "Did you input <code>checkc | 32 | checkc x y : False False = True</code> as your code?"}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "edited": false, "score": 0, "creation_date": 1541959603, "post_id": 53251440, "comment_id": 93388019, "body": "yes  and  it returns an error and there is  a red line under the name checkc  and x  y"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1541963067, "post_id": 53251440, "comment_id": 93388938, "body": "@Amerov, but... what is it supposed to mean? Doesn&#39;t make much sense to me, and to the compiler too. Also, this is absolutely not what I was talking about. Please read about pattern-matching somewhere (you&#39;ve got the power of Google at your fingertips!)"}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1541966888, "post_id": 53251440, "comment_id": 93390106, "body": "@ForceBru If i didn&#39;t understand something doesn&#39;t mean to be mean with me ! either help freindly or don&#39;t    anyway  thanks"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "edited": false, "score": 0, "creation_date": 1541961169, "post_id": 53251817, "comment_id": 93388454, "body": "but in your code the definition looks different (check :: Int -&gt; Int -&gt; Bool)and this a homework i can&#39;t change it  :,(  I&#39;m given  the definition and I should continue with it"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "edited": false, "score": 0, "creation_date": 1541964154, "post_id": 53251817, "comment_id": 93389284, "body": "@Amerov What&#39;s it supposed to say? <code>check :: Bool -&gt; Bool -&gt; Bool</code> will only accept booleans (by definition) so the whole crux of your question (comparing integers to integers) is suspect :)"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "edited": false, "score": 0, "creation_date": 1541964288, "post_id": 53251817, "comment_id": 93389325, "body": "@Amerov Your last example (<code>checkC</code>) is failing for the same reason. You&#39;ve defined a two-parameter function <code>checkC :: Bool -&gt; Bool -&gt; Bool</code>, then provided a four-parameter function (<code>checkC x y boolA boolB</code>)"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 3, "last_activity_date": 1541964487, "last_edit_date": 1541964487, "creation_date": 1541960650, "answer_id": 53251817, "question_id": 53251440, "link": "https://stackoverflow.com/questions/53251440/haskell-pattern-matching-in-a-function/53251817#53251817", "title": "Haskell Pattern matching in a Function", "body": "<p>You can pattern match against bools because there's a finite (and small) number of combinations. Consider the whole combination space of <code>Bool</code>s (which is defined as <code>n^n</code> where <code>n</code> is the size of the space)</p>\n\n<pre><code>False False\nFalse True\nTrue False\nTrue True\n</code></pre>\n\n<p>It's trivial to enumerate these by hand in <code>check</code></p>\n\n<pre><code>check :: Bool -&gt; Bool -&gt; Bool\ncheck False False = True\ncheck False True  = False\ncheck True False  = False\ncheck True True   = True\n</code></pre>\n\n<p>But as you can deduce, <code>Int</code>s are not as trivial, since the space of all integers is literally infinite.</p>\n\n<p>You can pattern match in this way with ints if you have an infinite amount of programming time and hard drive space, because you have an infinite amount of patterns to write.</p>\n\n<pre><code>check :: Int -&gt; Int -&gt; Bool\ncheck 0 0 = True\ncheck 1 1 = True\ncheck (-1) (-1) = True\ncheck 2 2 = True\ncheck (-2) (-2) = True\n-- etc literally until infinity\ncheck _ _ = False\n</code></pre>\n\n<p>The way to write this is to either use guards:</p>\n\n<pre><code>check :: Int -&gt; Int -&gt; Bool\ncheck x y | x == y    = True\n          | otherwise = False\n</code></pre>\n\n<p>Or realize that there is a pretty standard function that already does this -- maybe you've heard of it? :-)</p>\n\n<pre><code>check :: Int -&gt; Int -&gt; Bool\ncheck = (==)\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 53251817, "answer_count": 1, "score": -4, "last_activity_date": 1541983177, "creation_date": 1541958056, "last_edit_date": 1541983177, "question_id": 53251440, "link": "https://stackoverflow.com/questions/53251440/haskell-pattern-matching-in-a-function", "title": "Haskell Pattern matching in a Function", "body": "<p>The two-argument function check returns True exactly when both\nBoolean operands have the same value. Otherwise it returns False.\nI should implement it using :</p>\n\n<pre><code>check :: Bool -&gt; Bool -&gt; Bool\n</code></pre>\n\n<p>1)- Conditional expressions(checkA)</p>\n\n<pre><code>checkA x y = if x &lt; y then False else True\n</code></pre>\n\n<p>-\n2)-Guarded equations (checkB).</p>\n\n<pre><code>checkB x y | x &lt; y = False  | otherwise =True\n</code></pre>\n\n<p>3)-Pattern matching (checkc).</p>\n\n<p>,but here I get an error</p>\n\n<pre><code>checkC x y  False False = True\n          True True = True\n          False True = False\n          True False = False\n</code></pre>\n\n<p>How can I use Pattern matching to say (if this and that are equivalent then ...)  when x and y are numbers(int)?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 4, "creation_date": 1541951812, "post_id": 53250487, "comment_id": 93385798, "body": "Your example is legal Haskell code. What exactly is your problem? That is, what about the solution you already have doesn\u2019t work?"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 2, "creation_date": 1541952252, "post_id": 53250487, "comment_id": 93385914, "body": "do you want this: mapping p f xs= map (\\x-&gt; if p x then f x else x) xs"}, {"owner": {"reputation": 25, "user_id": 9926103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ad4ff46db6737e25a56c666efddd41?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn", "link": "https://stackoverflow.com/users/9926103/glenn"}, "edited": false, "score": 0, "creation_date": 1541952646, "post_id": 53250487, "comment_id": 93386014, "body": "well the code I have now is considered bad design in my class, we need to try to avoid if and use guards and such instead"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541953182, "post_id": 53250487, "comment_id": 93386173, "body": "I&#39;d not consider that bad design at all. Still, if you want to use guards you can use <code>mapping all sub = map f all where f x | x `elem` sub = function x | otherwise = x</code>, giving a name for the function you <code>map</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 4, "creation_date": 1541953278, "post_id": 53250487, "comment_id": 93386206, "body": "Note that you are working with lists, and not arrays. This isn&#39;t just terminology nitpicking; it is important to keep the difference in mind as you learn to work with Haskell lists."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541958159, "post_id": 53250487, "comment_id": 93387600, "body": "Letting <code>sub</code> be the first argument would make this cleaner."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1541958755, "creation_date": 1541958755, "answer_id": 53251528, "question_id": 53250487, "link": "https://stackoverflow.com/questions/53250487/map-with-condition-in-haskell/53251528#53251528", "title": "Map with condition in Haskell", "body": "<p>The part that seems like bad design to me is that you fail to factor out the basic pattern. As <a href=\"https://stackoverflow.com/users/7940614/assembly-jc\">assembly.jc</a> has <a href=\"https://stackoverflow.com/questions/53250487/map-with-condition-in-haskell#comment93385914_53250487\">pointed out</a>, you should really give that its own function.</p>\n\n<pre><code>mapOnly :: (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]\nmapOnly p f = map $ \\x -&gt; if p x then f x else x\n</code></pre>\n\n<p>Using <code>if</code> seems quite reasonable style in this context; anything else really comes off as clunky.</p>\n"}, {"tags": [], "owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "is_accepted": false, "score": 0, "last_activity_date": 1542009584, "creation_date": 1542009584, "answer_id": 53257934, "question_id": 53250487, "link": "https://stackoverflow.com/questions/53250487/map-with-condition-in-haskell/53257934#53257934", "title": "Map with condition in Haskell", "body": "<p>If you are force to use guards, is pretty straightforward. I think <code>if .. then .. else</code> is a good pattern here though. As @dfeuer says, include the predicate and the function in <code>mapping</code>'s signature.   </p>\n\n<pre><code>mapping :: (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]\nmapping _ _ []     = []\nmapping p f (a:as)\n  | p a       = f a: mapping p f as\n  | otherwise = a:mapping p f as\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9926103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ad4ff46db6737e25a56c666efddd41?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn", "link": "https://stackoverflow.com/users/9926103/glenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "accepted_answer_id": 53251528, "answer_count": 2, "score": 0, "last_activity_date": 1542009584, "creation_date": 1541951740, "last_edit_date": 1541952839, "question_id": 53250487, "link": "https://stackoverflow.com/questions/53250487/map-with-condition-in-haskell", "title": "Map with condition in Haskell", "body": "<p>I want to make a mapping to an array with a function but only is a condition is fullfilled. For my particular problem I have an array of objects and only want to do a function on a sub-array of this big array.</p>\n\n<pre><code>function :: a -&gt; a\n\nmapping :: [a] -&gt; [a] -&gt; [a]\nmapping all sub = map (\\x -&gt; if (x `elem` sub) then function x else x) all \n</code></pre>\n\n<p>how can I do something like this ?</p>\n\n<p>edit: I know this code works but in my class this is considered bad design and we need to avoid using if statements and need to use guards and such instead.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 2, "creation_date": 1541925357, "post_id": 53246799, "comment_id": 93378999, "body": "Bad identation causes the problem I guess."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1541923457, "creation_date": 1541923457, "answer_id": 53246879, "question_id": 53246799, "link": "https://stackoverflow.com/questions/53246799/haskell-parse-error-on-input-in-where/53246879#53246879", "title": "Haskell: parse error on input \u2018=\u2019 in where", "body": "<p>This is bad indentation:</p>\n\n<pre><code>     where (us, vs) = (partition (&lt;b) xs)\n                  b = div (length xs) 2\n</code></pre>\n\n<p>Since the second equality is indented more than the first, it continues the first one, as if we wrote</p>\n\n<pre><code>     where (us, vs) = (partition (&lt;b) xs) b = div (length xs) 2\n</code></pre>\n\n<p>triggering the error.</p>\n\n<p>You instead want:</p>\n\n<pre><code>     where (us, vs) = (partition (&lt;b) xs)\n           b        = div (length xs) 2\n</code></pre>\n\n<p>so that both equations are indented in the same way.</p>\n"}], "owner": {"reputation": 296, "user_id": 5259210, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0h7oCVmcWec/AAAAAAAAAAI/AAAAAAAAABQ/dEfzXGh0UjA/photo.jpg?sz=128", "display_name": "Aries_is_there", "link": "https://stackoverflow.com/users/5259210/aries-is-there"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 53246879, "answer_count": 1, "score": 3, "last_activity_date": 1541923457, "creation_date": 1541922465, "question_id": 53246799, "link": "https://stackoverflow.com/questions/53246799/haskell-parse-error-on-input-in-where", "title": "Haskell: parse error on input \u2018=\u2019 in where", "body": "<p>I am new in Haskell and practicing Algorithm in Haskell follow the book \"Pearls of Functional Algorithm Design\"</p>\n\n<p>This is the algo to find the smallest natural number not in a given finite set X of natural numbers</p>\n\n<pre><code>import Data.List\nimport Data.Array\n\nminfree xs = if null ([0..b-1] \\\\ us)\n             then head ([b..] \\\\ vs)\n             else head ([0..b-1] \\\\ us)\n             where (us, vs) = (partition (&lt;b) xs)\n                          b = div (length xs) 2\n</code></pre>\n\n<p>Pff the compiler error like this</p>\n\n<pre><code>Prelude Data.Array Data.List&gt; :load 01_the_smallest_free_number.hs \n[1 of 1] Compiling Main             ( 01_the_smallest_free_number.hs, interpreted )\n\n01_the_smallest_free_number.hs:11:29: error:\n    parse error on input \u2018=\u2019\n    Perhaps you need a 'let' in a 'do' block?\n    e.g. 'let x = 5' instead of 'x = 5'\n   |\n11 |                           b = div (length xs) 2 \n   |                             ^\nFailed, no modules loaded.\n</code></pre>\n\n<p>Well obveriously add <code>let</code> before <code>b</code> is not the right answer I've tried.</p>\n\n<p>Then I replaced all <code>b</code> to <code>div (length xs) 2</code> that works, so seems here is the problem to be, but I don't get it</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 4, "creation_date": 1541918518, "post_id": 53246438, "comment_id": 93377869, "body": "Try <code>listLength (Cons 2 (Cons 2 Nil))</code>. The issue is that <code>[2,3]</code> has type <code>[Integer]</code>, but the <code>Cons</code> constructor requires a second argument of type <code>List Integer</code>, and due to Haskell&#39;s strong typing the two types are not the same!"}, {"owner": {"reputation": 67, "user_id": 6606588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l5QqZ.jpg?s=128&g=1", "display_name": "Nishara Kavindi", "link": "https://stackoverflow.com/users/6606588/nishara-kavindi"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1541918980, "post_id": 53246438, "comment_id": 93377938, "body": "It worked. Thank you"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1541923951, "post_id": 53246438, "comment_id": 93378740, "body": "To ease testing you can define and use some auxiliary conversion function like <code>fromList = foldr Cons Nil</code> and then write <code>listLength (fromList [1,7,2,5]))</code>. In this way you can convert standard lists to your lists before testing, and avoid to type all the <code>Cons</code>es."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1541925415, "post_id": 53246438, "comment_id": 93379011, "body": "@Nishara Kavindi Do you want me to turn my comment into a proper answer so this question can be marked as &#39;answered&#39;?"}, {"owner": {"reputation": 67, "user_id": 6606588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l5QqZ.jpg?s=128&g=1", "display_name": "Nishara Kavindi", "link": "https://stackoverflow.com/users/6606588/nishara-kavindi"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1542041534, "post_id": 53246438, "comment_id": 93417443, "body": "@bradrn Okey.You can do that."}], "answers": [{"tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 0, "last_activity_date": 1542067972, "creation_date": 1542067972, "answer_id": 53271954, "question_id": 53246438, "link": "https://stackoverflow.com/questions/53246438/calling-a-function-with-user-defined-datatypes-in-haskell/53271954#53271954", "title": "Calling a function with user defined datatypes in Haskell", "body": "<p>From my comment above:</p>\n\n<blockquote>\n  <p>Try using <code>listLength (Cons 2 (Cons 2 Nil))</code>. The issue is that <code>[2,3]</code> has type <code>[Integer]</code>, but the <code>Cons</code> constructor requires a second argument of type <code>List Integer</code>, and due to Haskell's strong typing the two types are not the same!</p>\n</blockquote>\n"}], "owner": {"reputation": 67, "user_id": 6606588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l5QqZ.jpg?s=128&g=1", "display_name": "Nishara Kavindi", "link": "https://stackoverflow.com/users/6606588/nishara-kavindi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 53271954, "answer_count": 1, "score": 1, "last_activity_date": 1542067972, "creation_date": 1541918274, "question_id": 53246438, "link": "https://stackoverflow.com/questions/53246438/calling-a-function-with-user-defined-datatypes-in-haskell", "title": "Calling a function with user defined datatypes in Haskell", "body": "<p>I defined a data type in Haskell</p>\n\n<pre><code>data List a=Nil\n |Cons a (List a)\n</code></pre>\n\n<p>I wrote a function using this data type</p>\n\n<pre><code>listLength Nil=0\nlistLength (Cons x xs)=1+listLength(xs) \n</code></pre>\n\n<p>I tried to call that function giving arguments like this</p>\n\n<pre><code>listLength (Cons 2 [2,3])\n</code></pre>\n\n<p>But I got an error:</p>\n\n<pre><code>&lt;interactive&gt;:68:20: error:\n    * Couldn't match expected type `List Integer'\n                  with actual type `[Integer]'\n    * In the second argument of `Cons', namely `[2, 3]'\n      In the first argument of `listLength', namely `(Cons 2 [2, 3])'\n      In the expression: listLength (Cons 2 [2, 3])\n</code></pre>\n\n<p>How do  call this function?</p>\n"}, {"tags": ["haskell", "reddit"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1541893353, "post_id": 53244335, "comment_id": 93374299, "body": "I&#39;m not familiar with the Reddit API, but I&#39;m guessing you&#39;re going to need to use the pagination options in the <code>Options</code> record. That said, what I&#39;ve seen of the documentation (of both the Haskell package and the underlying API) is fairly lousy, so you may have to do some experimenting. You may also find that the Haskell package doesn&#39;t give you enough access to the underlying API; I&#39;m not sure."}, {"owner": {"reputation": 286, "user_id": 9214910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22383025a510d1498c6cb790c140763?s=128&d=identicon&r=PG&f=1", "display_name": "Leif Metcalf", "link": "https://stackoverflow.com/users/9214910/leif-metcalf"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1541893892, "post_id": 53244335, "comment_id": 93374389, "body": "@dfeuer: That&#39;s it, thank you!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1541899867, "post_id": 53244335, "comment_id": 93375356, "body": "@LeifMetcalf I suggest you to post your solution as a self-answer."}, {"owner": {"reputation": 286, "user_id": 9214910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22383025a510d1498c6cb790c140763?s=128&d=identicon&r=PG&f=1", "display_name": "Leif Metcalf", "link": "https://stackoverflow.com/users/9214910/leif-metcalf"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1541915369, "post_id": 53244335, "comment_id": 93377354, "body": "@duplode Is what I wrote ok?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1541915882, "post_id": 53244335, "comment_id": 93377428, "body": "@LeifMetcalf It is fine. For the icing on the cake, consider adding your comment-grabbing function to the answer."}], "answers": [{"tags": [], "owner": {"reputation": 286, "user_id": 9214910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22383025a510d1498c6cb790c140763?s=128&d=identicon&r=PG&f=1", "display_name": "Leif Metcalf", "link": "https://stackoverflow.com/users/9214910/leif-metcalf"}, "is_accepted": false, "score": 2, "last_activity_date": 1541915180, "creation_date": 1541915180, "answer_id": 53246178, "question_id": 53244335, "link": "https://stackoverflow.com/questions/53244335/reddit-api-get-comments-as-they-come/53246178#53246178", "title": "Reddit API get comments as they come", "body": "<p>The <a href=\"https://www.reddit.com/dev/api#GET_comments_%7Barticle%7D\" rel=\"nofollow noreferrer\">comments endpoint</a> has a query parameter <code>before</code>. A request with this query parameter set to the <code>name</code> of any comment will return <em>only</em> the comments which are newer than that comment.</p>\n\n<p>Note that the <code>name</code> of a comment is not its <code>link_id</code>, which is what I was stuck on.</p>\n\n<p>For example, a request to <a href=\"https://reddit.com/r/foobar/comments.json?sort=new&amp;before=t1_e9eud8s\" rel=\"nofollow noreferrer\">www.reddit.com/r/foobar/comments.json?sort=new&amp;before=t1_e9eud8s</a> will return a listing of the comments that were posted <em>after</em> the comment with <code>name: t1_e9eud8s</code></p>\n"}], "owner": {"reputation": 286, "user_id": 9214910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22383025a510d1498c6cb790c140763?s=128&d=identicon&r=PG&f=1", "display_name": "Leif Metcalf", "link": "https://stackoverflow.com/users/9214910/leif-metcalf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1541915180, "creation_date": 1541891554, "last_edit_date": 1541893195, "question_id": 53244335, "link": "https://stackoverflow.com/questions/53244335/reddit-api-get-comments-as-they-come", "title": "Reddit API get comments as they come", "body": "<p>I have a function that takes in a Reddit comment and spits out a reply. I want this function to map over every new comment posted on Reddit.</p>\n\n<p>How should I get the comments from reddit? It seems a bit wasteful to just pull in the 100 most recent comments very often so none are missed. A way to get all comments newer than a specific comment be very good.</p>\n\n<p>Ideally the comments would just be a lazy list so I just could do</p>\n\n<pre><code>f :: Comment -&gt; IO ()\n\ngetComments :: IO [Comment]\n\nmain :: IO ()\nmain = do\n  comments &lt;- getComments\n  traverse_ f comments\n</code></pre>\n\n<p>Or I could write an interact function:</p>\n\n<pre><code>f :: Comment -&gt; Comment\n\ninteract :: (Comment -&gt; Comment) -&gt; IO ()\n\nmain :: IO ()\nmain = interact f\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "haskell-stack"], "comments": [{"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 1, "creation_date": 1541944760, "post_id": 53243925, "comment_id": 93383741, "body": "Have you tried installing <a href=\"https://formulae.brew.sh/formula/libiconv\" rel=\"nofollow noreferrer\">libiconv</a> ?"}, {"owner": {"reputation": 6400, "user_id": 1245418, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7005b0353700331ae983ee90c81b2e69?s=128&d=identicon&r=PG", "display_name": "Evan Zamir", "link": "https://stackoverflow.com/users/1245418/evan-zamir"}, "reply_to_user": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 0, "creation_date": 1541957792, "post_id": 53243925, "comment_id": 93387475, "body": "@bergey No I haven&#39;t tried that. Is that something that is required but not documented anywhere? Also, is this necessary on OS X?"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 0, "creation_date": 1542044201, "post_id": 53243925, "comment_id": 93418804, "body": "Those are errors from the linker, and I think the functions it&#39;s looking for are provided by <code>libiconv</code>.  It&#39;s one of those problems that I only run into every few years, when setting up a new computer, so I&#39;m not sure which OSes require it or how I figured this out.  I have <code>libiconv</code> installed on my Mac, so I assume I installed it in response to errors like these."}], "owner": {"reputation": 6400, "user_id": 1245418, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7005b0353700331ae983ee90c81b2e69?s=128&d=identicon&r=PG", "display_name": "Evan Zamir", "link": "https://stackoverflow.com/users/1245418/evan-zamir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 427, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1541887819, "creation_date": 1541887819, "question_id": 53243925, "link": "https://stackoverflow.com/questions/53243925/stack-build-error-undefined-symbols-for-architecture-x86-64", "title": "Stack Build error: Undefined symbols for architecture x86_64", "body": "<p>I am trying to run <code>stack build</code> and get the following errors:</p>\n\n<pre><code>bartosz $ stack setup\nThe GHC located at /Users/evanzamir/.stack/programs/x86_64-osx/ghc-8.4.4/bin/ghc failed to compile a sanity check. Please see:\n\n    http://docs.haskellstack.org/en/stable/install_and_upgrade/\n\nfor more information. Exception was:\nReceived ExitFailure 1 when running\nRaw command: /Users/evanzamir/.stack/programs/x86_64-osx/ghc-8.4.4/bin/ghc /private/var/folders/rj/vrrtj8094qb8gf4ky_r_mxq80000gn/T/stack-sanity-check4255/Main.hs -no-user-package-db\nRun from: /private/var/folders/rj/vrrtj8094qb8gf4ky_r_mxq80000gn/T/stack-sanity-check4255/\nStandard output:\n\n[1 of 1] Compiling Main             ( /private/var/folders/rj/vrrtj8094qb8gf4ky_r_mxq80000gn/T/stack-sanity-check4255/Main.hs, /private/var/folders/rj/vrrtj8094qb8gf4ky_r_mxq80000gn/T/stack-sanity-check4255/Main.o )\nLinking /private/var/folders/rj/vrrtj8094qb8gf4ky_r_mxq80000gn/T/stack-sanity-check4255/Main ...\nStandard error:\n\nclang: warning: argument unused during compilation: '-nopie' [-Wunused-command-line-argument]\nclang: warning: argument unused during compilation: '-nopie' [-Wunused-command-line-argument]\nUndefined symbols for architecture x86_64:\n  \"_iconv\", referenced from:\n      _hs_iconv in libHSbase-4.11.1.0.a(iconv.o)\n     (maybe you meant: _base_GHCziIOziEncodingziIconv_iconvEncoding1_closure, _base_GHCziIOziEncodingziIconv_iconvEncoding1_info , _base_GHCziIOziEncodingziIconv_iconvEncoding4_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding15_info , _base_GHCziIOziEncodingziIconv_iconvEncoding4_info , _base_GHCziIOziEncodingziIconv_iconvEncoding7_info , _base_GHCziIOziEncodingziIconv_iconvEncoding6_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding6_info , _base_GHCziIOziEncodingziIconv_iconvEncoding8_info , _hs_iconv_open , _base_GHCziIOziEncodingziIconv_iconvEncoding12_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding9_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding9_info , _base_GHCziIOziEncodingziIconv_iconvEncoding12_info , _base_GHCziIOziEncodingziIconv_iconvEncoding13_info , _base_GHCziIOziEncodingziIconv_iconvEncoding11_info , _base_GHCziIOziEncodingziIconv_iconvEncoding_info , _base_GHCziIOziEncodingziIconv_iconvEncoding7_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding13_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding2_info , _base_GHCziIOziEncodingziIconv_iconvEncoding11_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding14_bytes , _base_GHCziIOziEncodingziIconv_iconvEncoding15_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding2_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding3_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding8_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding10_bytes , _hs_iconv_close , _hs_iconv , _base_GHCziIOziEncodingziIconv_iconvEncoding5_closure )\n  \"_iconv_open\", referenced from:\n      _hs_iconv_open in libHSbase-4.11.1.0.a(iconv.o)\n     (maybe you meant: _hs_iconv_open)\n  \"_iconv_close\", referenced from:\n      _hs_iconv_close in libHSbase-4.11.1.0.a(iconv.o)\n     (maybe you meant: _hs_iconv_close)\n  \"_locale_charset\", referenced from:\n      _localeEncoding in libHSbase-4.11.1.0.a(PrelIOUtils.o)\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n`gcc' failed in phase `Linker'. (Exit code: 1)\n</code></pre>\n\n<p>Here is the output from <code>stack path</code>:</p>\n\n<pre><code>stack-root: /Users/evanzamir/.stack\nproject-root: /Users/evanzamir/Code/Haskell/bartosz\nconfig-location: /Users/evanzamir/Code/Haskell/bartosz/stack.yaml\nbin-path: /Users/evanzamir/.stack/snapshots/x86_64-osx/lts-12.17/8.4.4/bin:/Users/evanzamir/.stack/compiler-tools/x86_64-osx/ghc-8.4.4/bin:/Users/evanzamir/.stack/programs/x86_64-osx/ghc-8.4.4/bin:/Library/Frameworks/Python.framework/Versions/3.6/bin:/usr/local/bin/stack:/usr/local/smlnj-110.77/bin:/opt/local/bin:/opt/local/sbin:/Library/Frameworks/Python.framework/Versions/3.6/bin:/Users/evanzamir/.rvm/gems/ruby-1.9.3-p327/bin:/Users/evanzamir/.rvm/gems/ruby-1.9.3-p327@global/bin:/Users/evanzamir/.rvm/rubies/ruby-1.9.3-p327/bin:/Users/evanzamir/.rvm/bin:/usr/local/smlnj-110.77/bin:/opt/local/bin:/opt/local/sbin:/usr/local/share/npm/bin/jitsu :/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin:/usr/local/sbin:/usr/local/share/npm/bin:/usr/local/sbin:/usr/local/share/npm/bin\nprograms: /Users/evanzamir/.stack/programs/x86_64-osx\ncompiler-exe: /Users/evanzamir/.stack/programs/x86_64-osx/ghc-8.4.4/bin/ghc\ncompiler-bin: /Users/evanzamir/.stack/programs/x86_64-osx/ghc-8.4.4/bin\ncompiler-tools-bin: /Users/evanzamir/.stack/compiler-tools/x86_64-osx/ghc-8.4.4/bin\nlocal-bin: /Users/evanzamir/.local/bin\nextra-include-dirs: \nextra-library-dirs: \nsnapshot-pkg-db: /Users/evanzamir/.stack/snapshots/x86_64-osx/lts-12.17/8.4.4/pkgdb\nlocal-pkg-db: /Users/evanzamir/Code/Haskell/bartosz/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/pkgdb\nglobal-pkg-db: /Users/evanzamir/.stack/programs/x86_64-osx/ghc-8.4.4/lib/ghc-8.4.4/package.conf.d\nghc-package-path: /Users/evanzamir/Code/Haskell/bartosz/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/pkgdb:/Users/evanzamir/.stack/snapshots/x86_64-osx/lts-12.17/8.4.4/pkgdb:/Users/evanzamir/.stack/programs/x86_64-osx/ghc-8.4.4/lib/ghc-8.4.4/package.conf.d\nsnapshot-install-root: /Users/evanzamir/.stack/snapshots/x86_64-osx/lts-12.17/8.4.4\nlocal-install-root: /Users/evanzamir/Code/Haskell/bartosz/.stack-work/install/x86_64-osx/lts-12.17/8.4.4\nsnapshot-doc-root: /Users/evanzamir/.stack/snapshots/x86_64-osx/lts-12.17/8.4.4/doc\nlocal-doc-root: /Users/evanzamir/Code/Haskell/bartosz/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/doc\ndist-dir: .stack-work/dist/x86_64-osx/Cabal-2.2.0.1\nlocal-hpc-root: /Users/evanzamir/Code/Haskell/bartosz/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/hpc\nlocal-bin-path: /Users/evanzamir/.local/bin\nghc-paths: /Users/evanzamir/.stack/programs/x86_64-osx\n</code></pre>\n\n<p>Been trying to figure this out all day. I'm on OS X Mojave 14.1. I've tried installing stack using the script, Brew, directly from the binary, and even the Haskell Platform installer, and all are giving me errors.</p>\n"}, {"tags": ["arrays", "haskell"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 2, "creation_date": 1541881376, "post_id": 53243052, "comment_id": 93371596, "body": "what did you try?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1541881545, "post_id": 53243052, "comment_id": 93371644, "body": "Which <code>array</code> function is this?"}, {"owner": {"reputation": 133, "user_id": 10634198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fWMgP.jpg?s=128&g=1", "display_name": "Dreik&#228;sehoch", "link": "https://stackoverflow.com/users/10634198/dreik%c3%a4sehoch"}, "edited": false, "score": 0, "creation_date": 1541881661, "post_id": 53243052, "comment_id": 93371677, "body": "I tried to make an accumArray, but that didn&#39;t help much. I also tried with <i>product(snd (unzip (assocs a)))</i> but then I don&#39;t know how to put the result in the array."}, {"owner": {"reputation": 133, "user_id": 10634198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fWMgP.jpg?s=128&g=1", "display_name": "Dreik&#228;sehoch", "link": "https://stackoverflow.com/users/10634198/dreik%c3%a4sehoch"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1541881801, "post_id": 53243052, "comment_id": 93371717, "body": "@melpomene the array from Data.Array, i guess"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1541882278, "post_id": 53243052, "comment_id": 93371835, "body": "If you want to modify entries, why are you using an array?"}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 5, "last_activity_date": 1541883152, "last_edit_date": 1541883152, "creation_date": 1541882798, "answer_id": 53243245, "question_id": 53243052, "link": "https://stackoverflow.com/questions/53243052/change-the-entries-in-an-array-in-haskell/53243245#53243245", "title": "Change the entries in an array in Haskell", "body": "<p>If you wanted to multiply that by <code>5</code> it would be:</p>\n\n<pre><code>accum (*) a [((2,2),5)]\n--     ^  ^   ^     ^\n--     function to combine values\n--        array to read\n--            one of the indices to manipulated\n--                  value to give to f for the associated index\n</code></pre>\n\n<p>The signature of this function reads</p>\n\n<pre><code>accum :: Ix i =&gt; (e -&gt; a -&gt; e) -&gt; Array i e -&gt; [(i, a)] -&gt; Array i e\n</code></pre>\n\n<p>and its <a href=\"https://hackage.haskell.org/package/array-0.5.2.0/docs/Data-Array.html#v:accum\" rel=\"nofollow noreferrer\">documentation</a> says:</p>\n\n<blockquote>\n  <p>accum f takes an array and an association list and accumulates pairs\n  from the list into the array with the accumulating function f.</p>\n</blockquote>\n\n<p>So calling <code>accum f arrayValue listWithPairsOfIndicesAndValues</code> will call <code>f</code> for every index given in <code>listWithPairsOfIndicesAndValues</code> providing the old value and the value from <code>listWithPairsOfIndicesAndValues</code> for this index and return a new array with all the positions mentioned in <code>listWithPairsOfIndicesAndValues</code> updated with the values returned by the respective calls to <code>f</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1541882918, "creation_date": 1541882918, "answer_id": 53243263, "question_id": 53243052, "link": "https://stackoverflow.com/questions/53243052/change-the-entries-in-an-array-in-haskell/53243263#53243263", "title": "Change the entries in an array in Haskell", "body": "<p>One could use <code>a // [(2,2), n * (a ! (2,2))]</code> to multiply the element with index <code>(2,2)</code> by <code>n</code>.</p>\n\n<p>(There should also be some lens-y approach with a better syntax)</p>\n"}, {"tags": [], "owner": {"reputation": 665, "user_id": 10610632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb8dce0aefdec2cde25c0a79c32739?s=128&d=identicon&r=PG&f=1", "display_name": "RoyM", "link": "https://stackoverflow.com/users/10610632/roym"}, "is_accepted": false, "score": 4, "last_activity_date": 1541883102, "creation_date": 1541883102, "answer_id": 53243291, "question_id": 53243052, "link": "https://stackoverflow.com/questions/53243052/change-the-entries-in-an-array-in-haskell/53243291#53243291", "title": "Change the entries in an array in Haskell", "body": "<p>There's two different ways to your goal:</p>\n\n<ol>\n<li><p>Using the incremental update:</p>\n\n<p><code>a // [((2,2),(3*7))]</code></p>\n\n<p><code>&gt;&gt;&gt; array ((1,1),(2,2)) [((1,1),2),((1,2),2),((2,1),3),((2,2),21)]</code></p></li>\n</ol>\n\n<p>(Instead of 3*7, you could use your own n and refer to that same location (a!(2,2)))</p>\n\n<ol start=\"2\">\n<li><p>Using the accumulation:</p>\n\n<p><code>accum (*) a [((2,2), 7)]</code></p>\n\n<p><code>&gt;&gt;&gt; array ((1,1),(2,2)) [((1,1),2),((1,2),2),((2,1),3),((2,2),21)]</code></p></li>\n</ol>\n"}], "owner": {"reputation": 133, "user_id": 10634198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fWMgP.jpg?s=128&g=1", "display_name": "Dreik&#228;sehoch", "link": "https://stackoverflow.com/users/10634198/dreik%c3%a4sehoch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 870, "favorite_count": 0, "accepted_answer_id": 53243245, "answer_count": 3, "score": 1, "last_activity_date": 1541883152, "creation_date": 1541881112, "question_id": 53243052, "link": "https://stackoverflow.com/questions/53243052/change-the-entries-in-an-array-in-haskell", "title": "Change the entries in an array in Haskell", "body": "<p>Suppose you have </p>\n\n<p><code>let a = array ((1,1),(2,2)) [((2,1),3),((1,2),2),((1,1),2),((2,2),3)]</code></p>\n\n<p>Now I want that to multiply the 3 in the last tuple with some number. How can I do that?</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1541876780, "creation_date": 1541876780, "answer_id": 53242448, "question_id": 53242275, "link": "https://stackoverflow.com/questions/53242275/multi-parameter-context-constraints-in-haskell/53242448#53242448", "title": "Multi-parameter context constraints in haskell", "body": "<p>Essentially, a constraint like <code>Show a</code> constrains the type variable <code>a</code> to represent a showable type. You seem to understand this.</p>\n\n<p>A constraint of the form <code>C a b</code> constrains the pair of type variables <code>a</code> and <code>b</code>. Intuitively, this constrains means that there is a relation between such types.</p>\n\n<p>Consider this fictional class</p>\n\n<pre><code>class C a b where\n   sum :: a -&gt; b -&gt; (Int, b)\n</code></pre>\n\n<p>Intuitively, the constraint <code>C a b</code> means that <code>a</code> and <code>b</code> can be <code>sum</code>med together (in that order!), and the result of that sum will be a pair <code>(Int, b)</code>.</p>\n\n<p>In your case you are dealing with</p>\n\n<pre><code>class Monad m =&gt; MonadError e m | m -&gt; e where\n   throwError :: e -&gt; m a\n</code></pre>\n\n<p>Here, <code>MonadError e m</code> expresses the following relation between <code>e</code> and <code>m</code>.</p>\n\n<ol>\n<li><code>m</code> is a monad</li>\n<li><code>e</code> is a type for which we can convert any value <code>x :: e</code> into <code>throwError x :: m a</code>, for any <code>a</code>. Intuitively, this is an \"error\" type, representing the nature of some error, and <code>throwError</code> simply includes such value inside the monad</li>\n<li>given <code>m</code>, there is only one error type <code>e</code>. In other words, the relation is actually a function. This is expressed through a functional dependency <code>... | m -&gt; e</code> in the class above.</li>\n</ol>\n\n<p>The simple version is: <code>MonadError m a</code> means that <code>m</code> is a monad which can express some \"error values\", of type <code>e</code>.</p>\n\n<p>For example, if we have <code>MonadError M String</code> available, we can write</p>\n\n<pre><code>foo :: Int -&gt; M Int\nfoo n | n == 0    = throwError \"can't handle zero!\"\n      | otherwise = return (100 `div` n)\n</code></pre>\n"}], "owner": {"reputation": 710, "user_id": 2423110, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ORCLJ.jpg?s=128&g=1", "display_name": "Vance Palacio", "link": "https://stackoverflow.com/users/2423110/vance-palacio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 53242448, "answer_count": 1, "score": 1, "last_activity_date": 1541902036, "creation_date": 1541875587, "last_edit_date": 1541902036, "question_id": 53242275, "link": "https://stackoverflow.com/questions/53242275/multi-parameter-context-constraints-in-haskell", "title": "Multi-parameter context constraints in haskell", "body": "<p>I'm currently reading the paper <em>Monad Transformers Step by Step</em>\nby Martin Grabm\u00fcller.</p>\n\n<p>Theres a part in the paper where he lists off the following instance declaration:</p>\n\n<p><code>instance (MonadError e m) =&gt; MonadError e (ReaderT r m) where...</code></p>\n\n<p>I've looked all over but I can't really find any info on what exactly a multi-parameter constraint like <code>(Foo a b)</code> means. I don't totally understand how <code>e</code> and <code>m</code> work together within the instance head <code>=&gt; MonadError e (ReaderT r m)</code>. </p>\n\n<p>How do these multi-parameter constraints work? Thanks!</p>\n"}, {"tags": ["haskell", "input"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1541874925, "post_id": 53242140, "comment_id": 93369881, "body": "Probably relevant: <a href=\"https://stackoverflow.com/q/13190314/2751851\"><i>IO happens out of order when using getLine and putStr</i></a>"}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1541875435, "post_id": 53242140, "comment_id": 93370025, "body": "@duplode code still doesn&#39;t work, but that fixed not printing anything. Thanks, now I can debug"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1541875777, "post_id": 53242140, "comment_id": 93370101, "body": "You likely want <code>putStrLn</code>, or need to use <code>hSetBuffering</code> to disable line buffering. I&#39;m sure there&#39;s a dup question to link to but can&#39;t find one atm"}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1541876116, "post_id": 53242140, "comment_id": 93370196, "body": "@duplode Meta question: So duplode&#39;s comment fixed what I asked for, but the code still isn&#39;t working, but that does not seem to have anything to do with this question per se. Should I answer it myself with duplode&#39;s suggestion?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1541877875, "post_id": 53242140, "comment_id": 93370637, "body": "@TheCodingWombat I took a slightly different route and closed it as a duplicate of that question. Weren&#39;t it a duplicate, your idea of answering it yourself would have been entirely appropriate. And, as you have guessed, further problems with the code are best posted as separate questions."}], "owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 1, "closed_date": 1541877769, "answer_count": 0, "score": 0, "last_activity_date": 1541875217, "creation_date": 1541874634, "last_edit_date": 1541875217, "question_id": 53242140, "link": "https://stackoverflow.com/questions/53242140/not-all-code-in-do-block-seems-to-be-executed", "closed_reason": "Duplicate", "title": "Not all code in do block seems to be executed", "body": "<p>I want to read from a file in a game I'm making in Haskell using Gloss. The file is in JSON format, and the JSON is correctly loaded, but then it seems to get removed or something. In the code below, <code>putStr (show highScores2)</code> is ignored, and so are both of the <code>putStr</code> in the cases in the second code segment.</p>\n\n<p><strong>Why isn't the code in the cases executed, does this have to do with lazy evalutation? (or is it executed?)</strong> I don't see how, since this code is necessary for the remainder of the program.</p>\n\n<p>My JSON:\n<code>[{\"score\":345,\"date\":\"timeString\"}]</code></p>\n\n<p>My code:</p>\n\n<pre><code>main :: IO ()\nmain = do\n        gen &lt;- getStdGen\n        highScores &lt;- loadHighScores\n        let highScores2 = highScores ++ [Entry 895 \"testingtesting\"]\n        putStr (show highScores2)\n        playIO\n              FullScreen         -- Fullscreen\n              black              -- Background color\n              60                 -- Frames per second\n              (initialState gen highScores2) -- Initial state\n              view               -- View function\n              input              -- Event function\n              step               -- Step function\n</code></pre>\n\n<p>File handling code, in this segment <code>B.putStr json</code> does print something to the screen, so I know it reads the JSON, but both the <code>putStr</code>s are ignored in the case segment:</p>\n\n<pre><code>  loadHighScores :: IO [HighScoreEntry]\n  loadHighScores = do\n                    json &lt;- B.readFile highScorePath --Does not check for file does not exist\n                    B.putStr json\n                    -- let d = eitherDecode json :: Either String [HighScoreEntry]\n                    -- case d of\n                    --       Left err -&gt; return []\n                    --       Right hS  -&gt; putStr \"EUI\" &gt;&gt; return hS\n                    let d = decode json\n                    case d of\n                      Just hS -&gt; (putStr $ \"second - \" ++ show hS) &gt;&gt; return hS\n                      otherwise -&gt; (putStr \"whyyy\") &gt;&gt; return []\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[{\"score\":345,\"date\":\"timeString\"}]\n</code></pre>\n"}, {"tags": ["haskell", "asynchronous", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 1436, "user_id": 331402, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2e1a9840e3933650ab29f65e165233ed?s=128&d=identicon&r=PG", "display_name": "Icid", "link": "https://stackoverflow.com/users/331402/icid"}, "edited": false, "score": 0, "creation_date": 1541858760, "post_id": 53239679, "comment_id": 93365268, "body": "Didn&#39;t mean to have <code>stopProcess</code> in my code, my bad. But yes, thanks, <code>waitExitCode</code> seems to help. It still exits after 30 seconds though."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1541858230, "creation_date": 1541858230, "answer_id": 53239679, "question_id": 53239586, "link": "https://stackoverflow.com/questions/53239586/how-do-i-keep-a-spawned-process-alive-in-haskell/53239679#53239679", "title": "How do I keep a spawned process alive in Haskell?", "body": "<p>From the docs, it seems that <code>stopProcess</code> forces the process to stop (it sends SIGTERM on unix).  This is because the docs state that it calls <code>terminateProcess</code>, and then waits. </p>\n\n<p>We only want to wait without terminating the process. I would try <code>waitExitCode</code> or similar functions, instead.</p>\n"}], "owner": {"reputation": 1436, "user_id": 331402, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2e1a9840e3933650ab29f65e165233ed?s=128&d=identicon&r=PG", "display_name": "Icid", "link": "https://stackoverflow.com/users/331402/icid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1541858800, "creation_date": 1541857427, "last_edit_date": 1541858800, "question_id": 53239586, "link": "https://stackoverflow.com/questions/53239586/how-do-i-keep-a-spawned-process-alive-in-haskell", "title": "How do I keep a spawned process alive in Haskell?", "body": "<p>I'm trying to set up a \"bridge\" between my Haskell code and an interactive command-line process. More specifically, I'm trying to run an <a href=\"https://elm-lang.org/\" rel=\"nofollow noreferrer\">Elm</a> REPL and send/receive through stdin/stdout. I wasn't sure exactly which library to use for this, but I went with <a href=\"https://www.stackage.org/haddock/lts-12.17/typed-process-0.2.3.0/System-Process-Typed.html#v:inherit\" rel=\"nofollow noreferrer\"><code>typed-process</code></a>.</p>\n\n<p><strong>The issue I have is that my Haskell program finishes (or quits) while the REPL process is still running. How do I avoid this?</strong></p>\n\n<p>Also, another problem is that the REPL process isn't getting any input from the stdin handle.</p>\n\n<p><em>My current code looks like this:</em></p>\n\n<pre><code>run :: Document -&gt; IO (Result () Text)\nrun (Document moduleName tests) =  do\n    let config = createConfig\n\n    p &lt;- startProcess config\n\n    hSetBuffering (getStdin p) NoBuffering\n    hSetBuffering (getStdout p) NoBuffering\n\n    Data.Text.IO.hPutStr (getStdin p) \"True\\n\"\n    Data.Text.IO.hGetChunk (getStdout p) &gt;&gt;= print\n\n    _ &lt;- waitExitCode p\n\n    return (Ok ())\n\n\n{-| Config for process.\n-}\ncreateConfig =\n    shell \"elm repl\"\n        |&gt; setStdin createPipe\n        |&gt; setStdout createPipe\n        |&gt; setStderr closed\n</code></pre>\n"}, {"tags": ["haskell", "type-families"], "comments": [{"owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "edited": false, "score": 0, "creation_date": 1541979557, "post_id": 53239120, "comment_id": 93393202, "body": "Type synonyms (sans type families) are resolved before injectivity is checked, so that&#39;s not something that could help here. Also, you&#39;re not &quot;doubly in trouble&quot;. The reason why RHS can&#39;t be a bare type variable in the first place, as far as I understand, is exactly because allowing that would always lead to non-injectivity or type-safety violations (there is one exception and you probably know of it, it&#39;s not helpful here). What you apparently want is constrained type families (doi:10.1145/3110286). Those are, regrettably, not available in Haskell at the time of writing."}], "owner": {"reputation": 739, "user_id": 198277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfe3de23679d68748d82750de1b88dc?s=128&d=identicon&r=PG", "display_name": "Sam Derbyshire", "link": "https://stackoverflow.com/users/198277/sam-derbyshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 2, "answer_count": 0, "score": 6, "last_activity_date": 1541936573, "creation_date": 1541854212, "last_edit_date": 1541936573, "question_id": 53239120, "link": "https://stackoverflow.com/questions/53239120/is-there-a-way-to-make-this-type-family-injective", "title": "Is there a way to make this type family injective?", "body": "<p>The following type family</p>\n\n<pre><code>type family ListVariadic (as :: [Type]) (b :: Type) = (f :: Type) where  \n  ListVariadic (a ': as) b = a -&gt; ListVariadic as b\n  ListVariadic '[]       b = b\n</code></pre>\n\n<p>is visibly not injective, e.g. <code>ListVariadic '[] (a -&gt; a) ~ ListVariadic '[a] a</code>.<br>\nHowever it is very convenient to have injectivity to help type inference along, and I don't intend to use <code>ListVariadic</code> with its second argument being a function type.<br>\nI have come up with two workarounds, both quite unsatisfactory:</p>\n\n<p><strong>Option 1:</strong> Pass around type families that witness a left inverse to ListVariadic (through type-classes).</p>\n\n<pre><code>type family Arguments (f :: Type) :: [Type] where\n  Arguments (a -&gt; b) = a ': Arguments b\n  Arguments b        = '[]\ntype family Return (f :: Type) :: Type where\n  Return (a -&gt; b) = Return b\n  Return b        = b\n\nclass    ( f ~ ListVariadic (Arguments f) (Return f) ) =&gt; VariadicIsInjective f where\ninstance ( f ~ ListVariadic (Arguments f) (Return f) ) =&gt; VariadicIsInjective f where\n</code></pre>\n\n<p>For me this eventually introduced too much complexity, having to thread these helper typeclasses throughout.</p>\n\n<p><strong>Option 2.</strong> Explicitly list all non-function types that one is going to be using, in the definition of the variadic type family:</p>\n\n<pre><code>type family ListVariadic (as :: [Type]) (b :: Type) = (f :: Type) | f -&gt; as b where  \n  ListVariadic (a ': as) b = a -&gt; ListVariadic as b\n  ListVariadic '[] ()     = ()\n  ListVariadic '[] Bool   = Bool\n  ListVariadic '[] Word   = Word \n  ListVariadic '[] Int    = Int \n  ListVariadic '[] Float  = Float\n  ListVariadic '[] Double = Double\n  ... ... ...\n  ListVariadic '[] (a,b) = (a,b)\n  ListVariadic '[] (a,b,c) = (a,b,c)\n  ... ... ...\n  ListVariadic '[] [a] = [a]\n  ... ... ...\n</code></pre>\n\n<p>Then an injectivity annotation is possible and works as intended. It's obviously quite limited... and one still ends up with constraints of the form <code>a ~ ListVariadic '[] a</code> that need to be passed around.</p>\n\n<hr>\n\n<p>I was hoping there to be a way of writing the <code>ListVariadic</code> type family (or something fulfilling the same purpose), indicating that its second argument is not a function, and allow an injectivity annotation.<br>\nI know I am doubly in trouble, because in the provided first definition of <code>ListVariadic</code>, the second equation has a bare type variable on the right hand side. That's generally not allowed when checking for injectivity... but perhaps there are some clever tricks using type synonyms that can work around this problem?</p>\n"}, {"tags": ["haskell", "megaparsec"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1541855538, "post_id": 53239098, "comment_id": 93364452, "body": "Did you misspell &quot;lambda&quot;?"}, {"owner": {"reputation": 1436, "user_id": 331402, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2e1a9840e3933650ab29f65e165233ed?s=128&d=identicon&r=PG", "display_name": "Icid", "link": "https://stackoverflow.com/users/331402/icid"}, "edited": false, "score": 1, "creation_date": 1541858056, "post_id": 53239098, "comment_id": 93365097, "body": "Have you tried using the <code>dbg</code> function to see why it doesn&#39;t match? <a href=\"https://www.stackage.org/haddock/lts-12.17/megaparsec-6.5.0/Text-Megaparsec.html#v:dbg\" rel=\"nofollow noreferrer\">stackage.org/haddock/lts-12.17/megaparsec-6.5.0/&hellip;</a> Try adding <code>lambdaExpr = dbg &quot;lambdaExpr&quot; $ do</code>."}, {"owner": {"reputation": 823, "user_id": 560478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cede0930b58ad165da51737fff5644?s=128&d=identicon&r=PG", "display_name": "Philipp Siegmantel", "link": "https://stackoverflow.com/users/560478/philipp-siegmantel"}, "edited": false, "score": 0, "creation_date": 1541858724, "post_id": 53239098, "comment_id": 93365259, "body": "I did indeed misspell &quot;lmbda&quot;, the debug function helped"}], "answers": [{"tags": [], "owner": {"reputation": 823, "user_id": 560478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cede0930b58ad165da51737fff5644?s=128&d=identicon&r=PG", "display_name": "Philipp Siegmantel", "link": "https://stackoverflow.com/users/560478/philipp-siegmantel"}, "is_accepted": true, "score": 0, "last_activity_date": 1541858787, "creation_date": 1541858787, "answer_id": 53239757, "question_id": 53239098, "link": "https://stackoverflow.com/questions/53239098/haskell-megaparsec-reserved-word-parsed-as-identifier/53239757#53239757", "title": "Haskell Megaparsec - Reserved word parsed as identifier", "body": "<p>I misspelled \"lambda\", closing this question.</p>\n"}], "owner": {"reputation": 823, "user_id": 560478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cede0930b58ad165da51737fff5644?s=128&d=identicon&r=PG", "display_name": "Philipp Siegmantel", "link": "https://stackoverflow.com/users/560478/philipp-siegmantel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 1, "accepted_answer_id": 53239757, "answer_count": 1, "score": 3, "last_activity_date": 1541858787, "creation_date": 1541854030, "question_id": 53239098, "link": "https://stackoverflow.com/questions/53239098/haskell-megaparsec-reserved-word-parsed-as-identifier", "title": "Haskell Megaparsec - Reserved word parsed as identifier", "body": "<p>I'm trying to parse a simple language with lamdba expressions. But <code>runParser expr \"lamdbda(x) (return x)</code> returns <code>Right (Var \"lamdba\")</code> instead of <code>Right (Lambda [\"x\"] (Return (Var \"x\")))</code></p>\n\n<p>My guess is, that I have to add a <code>try</code> somewhere, but I can't figure out where. <code>lambdaExpr</code> parses lamdbas correctly.</p>\n\n<p>Ast.hs</p>\n\n<pre><code>data Expr = Const Integer\n          | BinOp Op Expr Expr\n          | Neg Expr\n          | If Expr Expr Expr\n          | Var String\n          | Lambda [String] Stmt\n  deriving (Show, Eq)\n\ndata Op = Multiply\n        | Divide\n        | Add\n        | Subtract\n  deriving (Show, Eq)\n\ndata Stmt = Decl String Expr\n          | Seq [Stmt]\n          | Print Expr\n          | Return Expr\n  deriving (Show, Eq)\n</code></pre>\n\n<p>Parser.hs</p>\n\n<pre><code>module Parser where\n\nimport Ast\n\nimport Control.Monad\nimport Data.Void\nimport Control.Monad.Combinators.Expr\nimport Text.Megaparsec\nimport Text.Megaparsec.Char\nimport qualified Text.Megaparsec.Char.Lexer as L\n\ntype Parser = Parsec Void String\n\nsc :: Parser ()\nsc = L.space space1 lineCmnt blockCmnt\n  where lineCmnt = L.skipLineComment \"--\"\n        blockCmnt = L.skipBlockComment \"{-\" \"-}\"\n\nlexeme :: Parser a -&gt; Parser a\nlexeme = L.lexeme sc\n\nsymbol :: String -&gt; Parser String\nsymbol = L.symbol sc\n\nparens :: Parser a -&gt; Parser a\nparens = between (symbol \"(\") (symbol \")\")\n\n\ninteger :: Parser Integer\ninteger = lexeme L.decimal\n\nrword :: String -&gt; Parser ()\nrword w = (lexeme . try) (string w *&gt; notFollowedBy alphaNumChar)\n\nrws :: [String] -- list of reserved words\nrws = [\"if\", \"then\", \"else\", \"let\", \"print\", \"lambda\", \"return\"]\n\nidentifier :: Parser String\nidentifier = (lexeme . try) (p &gt;&gt;= check)\n  where\n    p       = (:) &lt;$&gt; letterChar &lt;*&gt; many alphaNumChar\n    check x = if x `elem` rws\n              then fail $ \"keyword \" ++ show x ++ \" cannot be an identifier\"\n              else return x\n\nifExpr :: Parser Expr\nifExpr = do rword \"if\"\n            cond &lt;- expr\n            rword \"then\"\n            thn &lt;- expr\n            rword \"else\"\n            els &lt;- expr\n            return $ If cond thn els\n\nlambdaExpr :: Parser Expr\nlambdaExpr = do rword \"lambda\"\n                args &lt;- parens $ sepBy identifier (char ',')\n                s &lt;- stmt\n                return $ Lambda args s\n\nexpr :: Parser Expr\nexpr = makeExprParser term operators\n\nterm :: Parser Expr\nterm = parens expr\n  &lt;|&gt; lambdaExpr\n  &lt;|&gt; Const &lt;$&gt; integer\n  &lt;|&gt; Var &lt;$&gt; identifier\n  &lt;|&gt; ifExpr\n\noperators :: [[Operator Parser Expr]]\noperators =\n  [ [Prefix (Neg &lt;$ symbol \"-\") ]\n  , [ InfixL (BinOp Multiply &lt;$ symbol \"*\")\n    , InfixL (BinOp Divide   &lt;$ symbol \"/\") ]\n  , [ InfixL (BinOp Add      &lt;$ symbol \"+\")\n    , InfixL (BinOp Subtract &lt;$ symbol \"-\") ]\n  ]\n\ndeclStmt :: Parser Stmt\ndeclStmt = do rword \"let\"\n              name &lt;- identifier\n              void $ symbol \"=\"\n              e &lt;- expr\n              return $ Decl name e\n\nprintStmt :: Parser Stmt\nprintStmt = do rword \"print\"\n               e &lt;- expr\n               return $ Print e\n\nreturnStmt :: Parser Stmt\nreturnStmt = do rword \"return\"\n                e &lt;- expr\n                return $ Return e\n\nstmt :: Parser Stmt\nstmt = f &lt;$&gt; sepBy1 stmt' (symbol \";\")\n  where\n    -- if there's only one stmt return it without using \u2018Seq\u2019\n    f l = if length l == 1 then head l else Seq l\n\nstmt' :: Parser Stmt\nstmt' = declStmt\n        &lt;|&gt; printStmt\n        &lt;|&gt; returnStmt\n\nrunParser :: Parser a -&gt; String -&gt; Either (ParseError (Token String) Void) a\nrunParser p input = Text.Megaparsec.runParser p \"\" input\n</code></pre>\n"}, {"tags": ["haskell", "memory-management", "functional-programming", "ghc"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 7, "creation_date": 1541849175, "post_id": 53238460, "comment_id": 93362868, "body": "Well a lot of (high-level) languages keep it open how memory management is implemented. But for GHC, this <a href=\"https://wiki.haskell.org/GHC/Memory_Management\" rel=\"nofollow noreferrer\">wiki page</a> might be a start."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1541849388, "post_id": 53238460, "comment_id": 93362915, "body": "As a zeroth-order approximation you&#39;d have to say that <i>everything is on the heap</i> in Haskell, but more practically we can assume that the compiler will decide to put any variable whereever it&#39;s deemed best for performance. Quite often it will also eliminate variables <i>entirely</i>, or introduce new ones. All that the language specifies is that you&#39;ll get the right results in the end..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1541851810, "post_id": 53238460, "comment_id": 93363539, "body": "Don&#39;t forget that static/stack/heap memory does not really exist on its own. At the lower level, we only have RAM (including virtual memory). Then the OS may reserve a portion of the address space for the &quot;stack&quot;, allow processes to request more stack (e.g. <code>sbrk</code>) or heap (<code>mmap</code>), and pre-allocating a static portion when the executable is loaded. The the language runtime system can, on top of this, use garbage collection. Some variants of GC further divide the memory into generations or from-space/to-space (for copying GCs). These are further abstractions, usually implemented in the &quot;heap&quot;"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1541859902, "post_id": 53238460, "comment_id": 93365625, "body": "<i>Haskell</i> doesn&#39;t say anything about memory management. A particular <i>implementation</i> of Haskell makes those decisions."}], "owner": {"reputation": 301, "user_id": 9216582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242065e8b32c9a8292f68e753741fef1?s=128&d=identicon&r=PG", "display_name": "thlik", "link": "https://stackoverflow.com/users/9216582/thlik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 3, "answer_count": 0, "score": 3, "last_activity_date": 1542035508, "creation_date": 1541849063, "last_edit_date": 1542035508, "question_id": 53238460, "link": "https://stackoverflow.com/questions/53238460/how-does-haskell-manage-its-memory", "title": "How does Haskell manage its memory?", "body": "<p>So, we know that for most languages, throughout a program's execution:</p>\n\n<ul>\n<li>Global variables are stored in static memory.</li>\n<li>Local variables are stored in the stack memory.</li>\n<li>Arbitrarily-changing variables are stored in the heap.</li>\n</ul>\n\n<p>What about Haskell? All I know is that it is lazy. How does that translate into this context?</p>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1541879022, "post_id": 53236949, "comment_id": 93370951, "body": "try this code,  test1 has  error too: expecting space or &quot;as a&quot;, right?"}, {"owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1541958118, "post_id": 53236949, "comment_id": 93387578, "body": "exactly, but test2 works (doesn&#39;t contain any spaces)."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1542194284, "post_id": 53236949, "comment_id": 93478651, "body": "Finally, I find a simple solution using Parsec, please see the EDIT of my answer."}], "answers": [{"comments": [{"owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "edited": false, "score": 0, "creation_date": 1541844250, "post_id": 53237404, "comment_id": 93361766, "body": "maybe I misunderstand you - but in this case I get <code>parse error at (line 1, column 60): unexpected &quot;a&quot;</code> - I append the code I used to the question."}, {"owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "reply_to_user": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "edited": false, "score": 0, "creation_date": 1541952629, "post_id": 53237404, "comment_id": 93386010, "body": "You do not parse the spaces around the &quot;as a&quot;. It expect the &quot;as a&quot; but you provide &quot; as a &quot;"}, {"owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "reply_to_user": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "edited": false, "score": 0, "creation_date": 1541961520, "post_id": 53237404, "comment_id": 93388558, "body": "I think it might be the use of sep1 that forces it to accept two or more spaces."}, {"owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "edited": false, "score": 0, "creation_date": 1542005417, "post_id": 53237404, "comment_id": 93398748, "body": "interesting. So just using <code>many spaces</code> should capture one? But I get the same parsing error."}], "tags": [], "owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "is_accepted": false, "score": 1, "last_activity_date": 1541839850, "creation_date": 1541839850, "answer_id": 53237404, "question_id": 53236949, "link": "https://stackoverflow.com/questions/53236949/parsing-string-with-parsec-that-needs-to-end-with-particular-words/53237404#53237404", "title": "Parsing string with parsec that needs to end with particular words?", "body": "<p>You are working with the pattern: <code>Give {source} as a {target}</code>.\nSo you can pipe:</p>\n\n<ul>\n<li>Parser for <code>Give a</code></li>\n<li>Parser for <code>{source}</code></li>\n<li>Parser for <code>as a</code></li>\n<li>Parser for <code>{target}</code></li>\n</ul>\n\n<p>No need to wrap the parser for <code>{source}</code> with the parser for <code>as a</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "edited": false, "score": 0, "creation_date": 1541930076, "post_id": 53243421, "comment_id": 93379954, "body": "It&#39;s cleaner than my monstrosity ;)  However the space then seeps into the parser.  What I would like to learn how to reuse a &quot;clean&quot; parser in such situations. Say I have a second program that would send me the input as <code>&quot;123 123 123&quot;</code> (no ending space)."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "reply_to_user": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "edited": false, "score": 1, "creation_date": 1541936125, "post_id": 53243421, "comment_id": 93381497, "body": "@bdecaf But why don&#39;t use Parsec to extract the input string firstly, say &quot;164 151 155 145&quot; in test3, and then use inputParser to parse it ? which can reuse most Parser except questionParser."}, {"owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "edited": false, "score": 0, "creation_date": 1541957685, "post_id": 53243421, "comment_id": 93387441, "body": "sounds like an idea.  Need some time to wrap my head around how to do this ;)"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "reply_to_user": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "edited": false, "score": 0, "creation_date": 1542088461, "post_id": 53243421, "comment_id": 93431781, "body": "@bdecaf But the extract first approach need to parse same string twice. If need to parse a long string read from file, it is inefficient. I still look for a better way using Parsec to solve this type of problem. Maybe, in general, break string into tokens firstly is elegant approach, but too complex to your case."}], "tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 1, "last_activity_date": 1542194080, "last_edit_date": 1542194080, "creation_date": 1541884128, "answer_id": 53243421, "question_id": 53236949, "link": "https://stackoverflow.com/questions/53236949/parsing-string-with-parsec-that-needs-to-end-with-particular-words/53243421#53243421", "title": "Parsing string with parsec that needs to end with particular words?", "body": "<p>EDIT:</p>\n\n<p>As said in comment, the clean parser cannot be reused by <strong>Previouse solution</strong> stated at the end of this post.</p>\n\n<p>It led to develop a small parser using Parsec to handle all the possible situations for end parsing of numeric string separated by space i.e. </p>\n\n<ol>\n<li>end with a space followed by non-required-digit character, e.g. \"..11 as\"</li>\n<li>end with a space, e.g. \"..11 \"</li>\n<li>end with <code>eof</code>, e.g. \"..11\"</li>\n</ol>\n\n<p>and such a parser as below:</p>\n\n<pre><code>numParser:: (Parser Char-&gt;Parser String)-&gt;[Char]-&gt;Parser [String]\nnumParser repeatParser digits = \n    let digitParser = repeatParser $ oneOf digits\n        endParser = (try $ lookAhead $ (space &gt;&gt; noneOf digits)) &lt;|&gt;\n                    (try $ lookAhead $ (space &lt;* eof))           &lt;|&gt; \n                    (eof &gt;&gt; return ' ')\n    in do init &lt;- digitParser\n          rest &lt;- manyTill (space &gt;&gt; digitParser) endParser\n          return (init : rest)\n</code></pre>\n\n<p>And <code>binaryParser</code> and <code>octParser</code> need to be modified as below:</p>\n\n<pre><code>binaryParser = BinaryQuestion &lt;$&gt; numParser (count 8) \"01\"\noctParser    = OctalQuestion  &lt;$&gt; numParser many1 ['0'..'7']\n</code></pre>\n\n<p>And <strong>Nothing</strong> need to change of questionParser stated in question, for reference, I state it again here:</p>\n\n<pre><code>questionParser = do\n  string \"Give\"\n  many1 space\n  inp &lt;- inputParser \n  many1 space       --no need change to many\n  string \"as a\"\n  many1 space     \n  tar &lt;- targetParser\n  char '.'\n  eof\n  return $ Question inp tar\n</code></pre>\n\n<p>Previous Solution:</p>\n\n<p>The functions <code>endBy1</code> and <code>many</code> in <code>Text.Parsec</code> are helpful in this situation. </p>\n\n<p>To replace <code>sepBy1</code> by <code>endBy1</code> as</p>\n\n<pre><code>binaryParser = BinaryQuestion  &lt;$&gt; count 8 ( oneOf \"01\") `endBy1` space\n</code></pre>\n\n<p>and</p>\n\n<pre><code>octParser = OctalQuestion  &lt;$&gt;  (many1 (oneOf ['0'..'7'])) `endBy1` space\n</code></pre>\n\n<p>Unlike <code>sepBy1</code>, <code>endBy1</code> will read next some chars to determine whether end the parsing, and therefor, one space after the last digit will be consumed, i.e.</p>\n\n<pre><code>Give 164 151 155 145 as a word.\n                    ^ this space will be consumed\n</code></pre>\n\n<p>So, instead of checking one or many space before \"as a...\", it need check <strong>zero</strong> or many space, so why use <code>many</code> function instead of <code>many1</code>, now the code become:</p>\n\n<pre><code>...\ninp &lt;- inputParser \nmany space            -- change to many\nstring \"as a\"\n.... \n</code></pre>\n"}], "owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1542194080, "creation_date": 1541835415, "last_edit_date": 1541846447, "question_id": 53236949, "link": "https://stackoverflow.com/questions/53236949/parsing-string-with-parsec-that-needs-to-end-with-particular-words", "title": "Parsing string with parsec that needs to end with particular words?", "body": "<p>I am working on some programming exercises. The one I am working on has following input format:</p>\n\n<pre><code>Give xxxxxxxxx as yyyy.\n</code></pre>\n\n<p>xxxxxxxx can be in several formats that repeatedly show up during these exercises.  In particular its either binary (groups of 8 separated by spaces),  hexadecimal (without spaces) or octal (groups of up to 3 numbers).  I have already written parsers for these formats - however they all stumble over the \"as\". They looked like this</p>\n\n<pre><code>binaryParser = BinaryQuestion  &lt;$&gt; (count 8 ( oneOf \"01\") ) `sepBy1` space\n</code></pre>\n\n<p>I solved using this monstrosity (trimmed unnecessary code)</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Text.Parsec.ByteString\nimport Text.Parsec\nimport Text.Parsec.Char\nimport Data.ByteString.Char8 (pack, unpack, dropWhile, drop, snoc)\nimport qualified Data.ByteString as B \n\ndata Input = BinaryQuestion [String] \n           | HexQuestion [String]\n           | OctalQuestion [String]\n  deriving Show\ndata Question = Question {input :: Input, target :: Target} deriving Show\ndata Target = Word deriving Show\n\ntest1 :: B.ByteString\ntest1 = \"Give 01110100 01110101 01110010 01110100 01101100 01100101 as a word.\"\ntest2 :: B.ByteString\ntest2 = \"Give 646f63746f72 as a word.\"\ntest3 :: B.ByteString\ntest3 = \"Give 164 151 155 145 as a word.\"\n\ntargetParser :: Parser Target\ntargetParser = string \"word\" &gt;&gt; return Word\n\nwrapAs :: Parser a -&gt; Parser [a]\nwrapAs kind = manyTill kind (try (string \" as\"))\ninputParser :: Parser Input\ninputParser = choice [try binaryParser, try (space &gt;&gt; hexParser), try octParser]\nbinaryParser :: Parser Input\nbinaryParser = BinaryQuestion  &lt;$&gt; wrapAs (space &gt;&gt; count 8 ( oneOf \"01\") )\nhexParser :: Parser Input\nhexParser = HexQuestion &lt;$&gt; wrapAs (count 2 hexDigit)\noctParser :: Parser Input\noctParser = OctalQuestion  &lt;$&gt; wrapAs (many1 space &gt;&gt; many1 (oneOf ['0'..'7']))\n\nquestionParser :: Parser Question\nquestionParser = do\n  string \"Give\"\n  inp &lt;- inputParser \n  string \" a \"\n  tar &lt;- targetParser\n  char '.'\n  eof\n  return $ Question inp tar\n</code></pre>\n\n<p>I don't like that I need to use the following string \"as\" inside the parsing of Input, and they generally are less readable.  I mean using regex it would be trivial to have a trailing string.  So I am not satisfied with my solution.</p>\n\n<p>Is there a way I can reuse the 'nice' parsers - or at least use more readable parsers?</p>\n\n<p><strong>additional notes</strong></p>\n\n<p>The code I along the lines I wish I could get working would look like this:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Text.Parsec.ByteString\nimport Text.Parsec\nimport Text.Parsec.Char\nimport Data.ByteString.Char8 (pack, unpack, dropWhile, drop, snoc)\nimport qualified Data.ByteString as B \n\ndata Input = BinaryQuestion [String] \n           | HexQuestion [String]\n           | OctalQuestion [String]\n  deriving Show\ndata Question = Question {input :: Input, target :: Target} deriving Show\ndata Target = Word deriving Show\n\ntest1 :: B.ByteString\ntest1 = \"Give 01110100 01110101 01110010 01110100 01101100 01100101 as a word.\"\ntest2 :: B.ByteString\ntest2 = \"Give 646f63746f72 as a word.\"\ntest3 :: B.ByteString\ntest3 = \"Give 164 151 155 145 as a word.\"\n\ntargetParser :: Parser Target\ntargetParser = string \"word\" &gt;&gt; return Word\n\ninputParser :: Parser Input\ninputParser = choice [try binaryParser, try hexParser, try octParser]\nbinaryParser :: Parser Input\nbinaryParser = BinaryQuestion  &lt;$&gt; count 8 ( oneOf \"01\") `sepBy1` space\nhexParser :: Parser Input\nhexParser = HexQuestion &lt;$&gt; many1 (count 2 hexDigit)\noctParser :: Parser Input\noctParser = OctalQuestion  &lt;$&gt;  (many1 (oneOf ['0'..'7'])) `sepBy1` space\n\nquestionParser :: Parser Question\nquestionParser = do\n  string \"Give\"\n  many1 space\n  inp &lt;- inputParser \n  many1 space\n  string \"as a\"\n  many1 space\n  tar &lt;- targetParser\n  char '.'\n  eof\n  return $ Question inp tar\n</code></pre>\n\n<p>but <code>parseTest questionParser test3</code> will return me <code>parse error at (line 1, column 22):\nunexpected \"a\"</code></p>\n\n<p>I suppose the problem is that space is used as separator inside the input but also comes in the <code>as a</code> string.  I don't see any function inside parsec that would fit.  In frustration I tried adding <code>try</code> in various places - however no success.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2043, "user_id": 2676937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d42ec82c3feefc3c7e13b37dae77f21?s=128&d=identicon&r=PG", "display_name": "merlyn", "link": "https://stackoverflow.com/users/2676937/merlyn"}, "edited": false, "score": 5, "creation_date": 1541834773, "post_id": 53236842, "comment_id": 93359962, "body": "What if n isn&#39;t divisible by 3?"}, {"owner": {"reputation": 196, "user_id": 7091261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35bf483cee23e4cc151e0dd710f1fc5e?s=128&d=identicon&r=PG&f=1", "display_name": "Ak-Mo", "link": "https://stackoverflow.com/users/7091261/ak-mo"}, "reply_to_user": {"reputation": 2043, "user_id": 2676937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d42ec82c3feefc3c7e13b37dae77f21?s=128&d=identicon&r=PG", "display_name": "merlyn", "link": "https://stackoverflow.com/users/2676937/merlyn"}, "edited": false, "score": 0, "creation_date": 1541834874, "post_id": 53236842, "comment_id": 93359983, "body": "You can assume that the list&#39;s size is always divisible by n"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1541835185, "post_id": 53236842, "comment_id": 93360032, "body": "<a href=\"http://hackage.haskell.org/package/split-0.2.3.3/docs/Data-List-Split.html#v:chunksOf\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/split-0.2.3.3/docs/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 3, "last_activity_date": 1541835908, "creation_date": 1541835908, "answer_id": 53237001, "question_id": 53236842, "link": "https://stackoverflow.com/questions/53236842/transforming-a-flattened-list-into-a-nested-list-of-length-3/53237001#53237001", "title": "Transforming a flattened list into a nested list of length 3", "body": "<p>It is a good example show how to use of unfoldr as:</p>\n\n<pre><code>f n = unfoldr (\\xs-&gt;if null xs then Nothing else Just (take n xs, drop n xs))\n</code></pre>\n\n<p>Note that it can accept infinite list as:</p>\n\n<pre><code>take 4 $ f 3 [1..]\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>[[1,2,3],[4,5,6],[7,8,9],[10,11,12]]\n</code></pre>\n\n<p>for characters</p>\n\n<pre><code>take 4 $ f 3 ['a'..]\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>[\"abc\",\"def\",\"ghi\",\"jkl\"]\n</code></pre>\n"}], "owner": {"reputation": 196, "user_id": 7091261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35bf483cee23e4cc151e0dd710f1fc5e?s=128&d=identicon&r=PG&f=1", "display_name": "Ak-Mo", "link": "https://stackoverflow.com/users/7091261/ak-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "closed_date": 1541839282, "accepted_answer_id": 53237001, "answer_count": 1, "score": -1, "last_activity_date": 1541836348, "creation_date": 1541834284, "question_id": 53236842, "link": "https://stackoverflow.com/questions/53236842/transforming-a-flattened-list-into-a-nested-list-of-length-3", "closed_reason": "Duplicate", "title": "Transforming a flattened list into a nested list of length 3", "body": "<p>Given a flattened list in Haskell:</p>\n\n<pre><code>['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i']\n</code></pre>\n\n<p>and <code>n=3</code></p>\n\n<p>how can I change the list to:</p>\n\n<pre><code>[['a', 'b', 'c'], ['d', 'e', 'f'], ['g', 'h', 'i']]\n</code></pre>\n\n<p>preferably a solution where <code>n</code> is a variable </p>\n"}, {"tags": ["haskell", "monads", "foldable"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1541819937, "post_id": 53235661, "comment_id": 93357956, "body": "<code>wat :: [a] -&gt; Maybe a; wat xs = do { return (minimum xs) }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 3, "last_activity_date": 1541838456, "last_edit_date": 1541838456, "creation_date": 1541837653, "answer_id": 53237190, "question_id": 53235661, "link": "https://stackoverflow.com/questions/53235661/can-you-determine-the-min-or-max-of-a-list-using-only-the-list-monad/53237190#53237190", "title": "Can you determine the min or max of a list using only the list monad?", "body": "<p>I'm not entirely sure I understand the question, so forgive me if this isn't a useful answer, but as I understand it, the core of the question is this:</p>\n\n<blockquote>\n  <p>So it would not be possible to do an operation that produces a summary value like this within the confines of a <code>do</code> block?</p>\n</blockquote>\n\n<p>Correct, that would not be possible. Haskell's <code>do</code> notation is syntactic sugar over <code>Monad</code>, so basically syntactic sugar over <code>&gt;&gt;=</code> and <code>return</code>.</p>\n\n<p><code>return</code>, as you know, doesn't let you 'access' the contents of the <code>Monad</code>, so the only access to the contents you have is via <code>&gt;&gt;=</code>, and in the case of the list monad, for instance, that only gives you one value at a time.</p>\n\n<p>Notice that <code>Foldable</code> doesn't even require that the data container is a <code>Functor</code> (much less a <code>Monad</code>). Famously, <a href=\"http://hackage.haskell.org/package/containers/docs/Data-Set.html\" rel=\"nofollow noreferrer\">Set</a> isn't a <code>Functor</code> instance, but it <em>is</em> a <code>Foldable</code> instance.</p>\n\n<p>You can, for example, find the minimum value in a set:</p>\n\n<pre><code>Prelude Data.Foldable Set&gt; foldr (\\x -&gt; Just . maybe x (min x)) Nothing $ Set.fromList [42, 1337, 90125, 2112]\nJust 42\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 309, "user_id": 4740467, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e653edf458dc50848e813cf0dfde6a10?s=128&d=identicon&r=PG&f=1", "display_name": "Conor Quinn", "link": "https://stackoverflow.com/users/4740467/conor-quinn"}, "edited": false, "score": 0, "creation_date": 1541851760, "post_id": 53238249, "comment_id": 93363528, "body": "This is a really cool answer. But yea I meant from a single monadic context (not passing a value into a context), which I now understand is impossible due to the nature of join . fmap"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1541847494, "creation_date": 1541847494, "answer_id": 53238249, "question_id": 53235661, "link": "https://stackoverflow.com/questions/53235661/can-you-determine-the-min-or-max-of-a-list-using-only-the-list-monad/53238249#53238249", "title": "Can you determine the min or max of a list using only the list monad?", "body": "<p>The contrived and inefficient code below is the closest I can get to \"using only the list monad\". This is probably not what the OP is looking for, but here it is.</p>\n\n<p>I also exploit <code>head</code> (which you can replace with <code>listToMaybe</code>, if we want totality), and <code>null</code>. I also use <code>empty</code> (which you can replace with <code>[]</code>).</p>\n\n<p>The code works by non deterministically picking an element <code>m</code> and then checking that no greater elements exist. This has a quadratic complexity.</p>\n\n<pre><code>import Control.Applicative\n\nmaximum :: Ord a =&gt; [a] -&gt; a\nmaximum xs = head maxima\n   where\n   isMax m = null $ do\n      x &lt;- xs\n      if x &gt; m\n         then return x\n         else empty\n   maxima = do\n      m &lt;- xs   -- non deterministically pick a maximum\n      if isMax m\n         then return m\n         else empty\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "is_accepted": false, "score": 0, "last_activity_date": 1542654676, "last_edit_date": 1542654676, "creation_date": 1542653479, "answer_id": 53380938, "question_id": 53235661, "link": "https://stackoverflow.com/questions/53235661/can-you-determine-the-min-or-max-of-a-list-using-only-the-list-monad/53380938#53380938", "title": "Can you determine the min or max of a list using only the list monad?", "body": "<p>I'm also not sure, what the actual question ist, but the need for an accumulator can be hidden with a <code>Monoid</code> instance. Then - for your minimum example - you can use use <code>foldMap</code> from <code>Data.Foldable</code> to map and merge all values of your <code>Foldable</code>. E.g.:</p>\n\n<pre><code>data Min a = Min { getMin :: Maybe a } deriving Show\n\ninstance Ord a =&gt; Monoid (Min a) where\n  mempty                                = Min Nothing\n  mappend a (Min Nothing)               = a\n  mappend (Min Nothing) b               = b\n  mappend (Min (Just a)) (Min (Just b)) = Min (Just (min a b))\n\nfoldMin :: (Foldable t, Ord a) =&gt; t a -&gt; Maybe a\nfoldMin = getMin . foldMap (Min . Just)\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 4740467, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e653edf458dc50848e813cf0dfde6a10?s=128&d=identicon&r=PG&f=1", "display_name": "Conor Quinn", "link": "https://stackoverflow.com/users/4740467/conor-quinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 53237190, "answer_count": 3, "score": 4, "last_activity_date": 1542654676, "creation_date": 1541818850, "last_edit_date": 1541837196, "question_id": 53235661, "link": "https://stackoverflow.com/questions/53235661/can-you-determine-the-min-or-max-of-a-list-using-only-the-list-monad", "title": "Can you determine the min or max of a list using only the list monad?", "body": "<p>Trying to understand the relation between Monad and Foldable. I am aware that that part of the value of the Monad, Applicative and Functor typeclasses is their ability to lift functions over structure, but what if I wanted to generate a summary value (e.g. min or max) for the values contained in a Monad? </p>\n\n<p>This would be impossible without an accumulator right (like in foldable)? And to have an accumulator you have to inject or destroy structure?</p>\n\n<pre><code>min :: Ord a =&gt; a -&gt; a -&gt; a\n\nfoldMin :: (Foldable t, Ord a) =&gt; t a -&gt; Maybe a\nfoldMin t = foldr go Nothing t\n  where\n    go x Nothing = Just x\n    go x (Just y) = Just (min x y)\n</code></pre>\n\n<p>Here, the Nothing value is the accumulator. So it would not be possible to do an operation that produces a summary value like this within the confines of a <code>do</code> block?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1541809816, "post_id": 53234906, "comment_id": 93356532, "body": "Are you supposed to print it in a list format, or just return a list? What are the requirements specifically?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1541810511, "post_id": 53234906, "comment_id": 93356639, "body": "That&#39;s what&#39;s the <code>Show</code> instance for lists does. If you want some other behavior, don&#39;t use <code>show</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7841383, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207351325456378/picture?type=large", "display_name": "Aditya Sirohi", "link": "https://stackoverflow.com/users/7841383/aditya-sirohi"}, "edited": false, "score": 0, "creation_date": 1541814411, "post_id": 53235030, "comment_id": 93357287, "body": "okay. so it turns out the teacher doesn&#39;t care if it shows up as a string because as you said, a string is just a list of chars"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 11, "user_id": 7841383, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207351325456378/picture?type=large", "display_name": "Aditya Sirohi", "link": "https://stackoverflow.com/users/7841383/aditya-sirohi"}, "edited": false, "score": 0, "creation_date": 1541834104, "post_id": 53235030, "comment_id": 93359849, "body": "@AdityaSirohi: Just for your own reference, the <code>newtype</code> solution DarthFennec mentions is: <code>newtype C = C Char; instance Show C where { show (C c) = show c }</code>. Then <code>show (map C &quot;abc&quot;)</code> will produce the string <code>&quot;[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]&quot;</code> as expected. This is also a good opportunity to use <code>Data.Coerce.coerce</code>, which converts safely between a type and a <code>newtype</code> wrapper, with no runtime cost, e.g. <code>coerce &quot;abc&quot; :: [C]</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541860269, "post_id": 53235030, "comment_id": 93365722, "body": "Slight quibble: <code>show</code> doesn&#39;t <i>print</i> anything; it <i>returns</i> a string."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541967861, "post_id": 53235030, "comment_id": 93390410, "body": "@chepner, <code>show</code> doesn&#39;t &quot;return&quot; anything, it <i>evaluates to</i> a string. &gt;:)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541968312, "post_id": 53235030, "comment_id": 93390545, "body": "That&#39;s an even bigger quibble than my original quibble :)"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542047877, "post_id": 53235030, "comment_id": 93420280, "body": "@chepner It still &quot;prints&quot; <i>to</i> a string. Printing to a new string and printing to an existing file stream both require the same serialization steps, so I would argue that&#39;s a perfectly valid use of the word as long as that distinction is made."}], "tags": [], "owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "is_accepted": false, "score": 2, "last_activity_date": 1541810856, "creation_date": 1541810856, "answer_id": 53235030, "question_id": 53234906, "link": "https://stackoverflow.com/questions/53234906/haskell-code-prints-out-a-list-for-ints-but-not-for-chars/53235030#53235030", "title": "Haskell code prints out a list for ints but not for chars", "body": "<p>You're not doing anything wrong.</p>\n\n<p><code>String</code> is a type synonym for <code>[Char]</code>, so if you try to print a <code>[Char]</code> it will print as a <code>String</code>. This is somewhat of a special case, and it can be a little weird.</p>\n\n<p><code>Show</code> is the typeclass used to print things as a string. The definition of <code>Show</code> is something like this:</p>\n\n<pre><code>class Show a where\n    showsPrec :: Int -&gt; a -&gt; ShowS\n    show      :: a -&gt; String\n    showList  :: [a] -&gt; ShowS\n</code></pre>\n\n<p>The <code>showList</code> function is optional. The <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Text-Show.html#v:showList\" rel=\"nofollow noreferrer\">documentation</a> states:</p>\n\n<blockquote>\n  <p>The method <code>showList</code> is provided to allow the programmer to give a specialised way of showing lists of values. For example, this is used by the predefined <code>Show</code> instance of the <code>Char</code> type, where values of type <code>String</code> should be shown in double quotes, rather than between square brackets.</p>\n</blockquote>\n\n<p>So if you define a new type and instantiate <code>Show</code>, you can optionally define a special way to <code>show</code> a list of your type, separate from the way it's normally shown and separate from the way lists are normally shown. <code>Char</code> takes advantage of this, in that a <code>[Char]</code> (or equivalently, a <code>String</code>), is shown with double-quotes instead of as a list of <code>Char</code> values.</p>\n\n<hr>\n\n<p>I can't think of a way to get it to use the default <code>show</code> for a <code>[Char]</code>. I don't think there is one. A workaround might be to create a <code>newtype</code> wrapping <code>Char</code> with its own <code>Show</code> that uses the default <code>showList</code> implementation, but that doesn't seem appropriate here.</p>\n\n<p>If this is homework, I'd expect the grader to know about this already, and I seriously doubt you'd get marked down for it, especially since the problem doesn't appear to be about <code>show</code> at all.</p>\n"}], "owner": {"reputation": 11, "user_id": 7841383, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207351325456378/picture?type=large", "display_name": "Aditya Sirohi", "link": "https://stackoverflow.com/users/7841383/aditya-sirohi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541810856, "creation_date": 1541809216, "question_id": 53234906, "link": "https://stackoverflow.com/questions/53234906/haskell-code-prints-out-a-list-for-ints-but-not-for-chars", "title": "Haskell code prints out a list for ints but not for chars", "body": "<p>My code currently looks like this. It is supposed to show the possible first symbols in the regular expression definition given to us beforehand. I am supposed to print these out as a list. For example, if the answer is supposed to be [1,2], it will come out [1,2] but when the answer is supposed to be ['1','2'] it will come out \"12\" or when it is supposed to be ['a', 'b'] it will come out \"ab\". What am I doing wrong?</p>\n\n<pre><code>data RE a         -- regular expressions over an alphabet defined by 'a'\n    = Empty          -- empty regular expression\n    | Sym a          -- match the given symbol\n    | RE a :+: RE a  -- concatenation of two regular expressions\n    | RE a :|: RE a  -- choice between two regular expressions\n    | Rep (RE a)     -- zero or more repetitions of a regular expression\n    | Rep1 (RE a)    -- one or more repetitions of a regular expression\n    deriving (Show)\n\nfirstMatches :: RE a -&gt; [a]\nfirstMatches Empty = []\nfirstMatches (Sym a)= a:list\nfirstMatches(Rep(a))=firstMatches a\nfirstMatches(Rep1(a))=firstMatches a\nfirstMatches (Empty :+: b)= firstMatches b\nfirstMatches (a :+: _) = firstMatches a\nfirstMatches (a :|: b)= firstMatches a ++ firstMatches b\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1541810732, "post_id": 53234945, "comment_id": 93356667, "body": "Or simply <code>x `p` (countTree p k y) `p` (countTree p k z)</code>."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1541810838, "post_id": 53234945, "comment_id": 93356678, "body": "@bipll Yes. Updated. Thanks."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 1, "creation_date": 1541810911, "post_id": 53234945, "comment_id": 93356690, "body": "@bipll Oh, and just an FYI, you seem to have escaped your backticks using backslashes. You can put backticks in inlined code by surrounding the code in double backticks. Might be easier of there are a lot of backticks in the code."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1541834777, "post_id": 53234945, "comment_id": 93359964, "body": "It\u2019s kind of uncommon, but just as a curiosity, it\u2019s also possible to give a symbolic name to a parameter and then use it as a local operator, e.g., <code>countTree (%) k (Value x y z) = x % countTree (%) p k y % countTree (%) k z</code> where <code>%</code> can be whatever operator name you want. And since the operation <code>p</code>/<code>(%)</code> and the base value <code>k</code> are repeated on every call, this function also benefits from factoring the recursive bits into a helper function: <code>countTree (%) k = go where { go Nil = k; go (Value x y z) = x % go y % go z }</code>"}], "tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": false, "score": 3, "last_activity_date": 1541810831, "last_edit_date": 1541810831, "creation_date": 1541809723, "answer_id": 53234945, "question_id": 53234898, "link": "https://stackoverflow.com/questions/53234898/summing-up-all-the-nodes-a-tree-with-a-generic-type-haskell/53234945#53234945", "title": "Summing up all the nodes a tree with a generic type. (Haskell)", "body": "<pre><code>x (+) (countTree p k y) (+) (countTree p k z) \n</code></pre>\n\n<p>is attempting to treat <code>x</code> as a function, and pass to it as arguments all of </p>\n\n<pre><code>(+) (countTree p k y) (+) (countTree p k z)\n</code></pre>\n\n<p>If you want to have \"x + recur left + recur right\", you'd want something like:</p>\n\n<pre><code>x + (countTree p k y) + (countTree p k z)\n</code></pre>\n\n<p>I'm pretty sure however you actually want to use <code>p</code>, not <code>+</code> hard coded. Using prefix notation, you'd have to rearrange it a bit to something like :</p>\n\n<pre><code>(p (p x (countTree p k y)) (countTree p k z))\n</code></pre>\n\n<p>Or, you could use backticks to inline the calls to <code>p</code> as @bipll suggested:</p>\n\n<pre><code>x `p` (countTree p k y) `p` (countTree p k z)\n</code></pre>\n\n<hr>\n\n<p>A side note, but I'm also pretty sure you want <code>h</code> to be <code>k</code>. </p>\n"}], "owner": {"reputation": 31, "user_id": 10470086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ABpfO8koRkA/AAAAAAAAAAI/AAAAAAAAAMQ/0Glud0tdsKM/photo.jpg?sz=128", "display_name": "Li Wang", "link": "https://stackoverflow.com/users/10470086/li-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541810831, "creation_date": 1541809132, "question_id": 53234898, "link": "https://stackoverflow.com/questions/53234898/summing-up-all-the-nodes-a-tree-with-a-generic-type-haskell", "title": "Summing up all the nodes a tree with a generic type. (Haskell)", "body": "<p>I have been trying to write a code which takes all the integers in a tree and return a sum of them. I'm trying to do this with type <code>a</code>, which is from a data time:</p>\n\n<p><code>data Tree a = Nil | Value a (Tree a) (Tree a)\n deriving Show</code></p>\n\n<p>and we want to use:\n<code>tree = Value 2 (Value 2 (Value 2 Nil Nil) Nil) (Value 2 Nil Nil)</code></p>\n\n<p>and my code is as follow: </p>\n\n<pre><code>countTree :: (a -&gt; a -&gt; a) -&gt; a -&gt; Tree a -&gt; a\ncountTree p k (Nil) = h\ncountTree p k (Value x y z) = x (+) (countTree p k y) (+) (countTree p k z) \n</code></pre>\n\n<p>and I want to run my code as <code>countTree (+) 0 tree</code> and the results should return <code>8</code>. \nThe problem is that when I run my code it tells me that <code>x</code> has four arguments but it's type <code>a</code> has zero which I honestly don't understand why. I've modifying sections of my code, but no success once so ever, I could really use some assistance. </p>\n"}, {"tags": ["haskell", "divide-and-conquer", "karatsuba"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 6, "creation_date": 1541788174, "post_id": 53231314, "comment_id": 93349705, "body": "Write type signatures!  They will show you everything."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 5, "creation_date": 1541788457, "post_id": 53231314, "comment_id": 93349845, "body": "To elaborate on @luqui&#39;s comment: in general, if you add a type signature to each of your functions, the error messages will be closer to the code that needs to change.  Often they will also be more concrete &amp; easier to interpret."}, {"owner": {"reputation": 193, "user_id": 4887503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16fea0aa45d3a606279504a80a3e3159?s=128&d=identicon&r=PG&f=1", "display_name": "SuperM4n", "link": "https://stackoverflow.com/users/4887503/superm4n"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1541788616, "post_id": 53231314, "comment_id": 93349920, "body": "@luqui I am currently learning how to do it by myself but I am not there yet. I know that I can check signatures using <code>:t</code> command but that doesn&#39;t seem to help much. <code>divide</code> has <code>[a] -&gt; [[a]]</code> and <code>combine</code> has <code>[[b]] -&gt; b</code> which looks alright to me."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1541790055, "post_id": 53231314, "comment_id": 93350507, "body": "&quot;I am not there yet.&quot; Just write <code>divide :: [a] -&gt; [[a]]</code> above your <code>divide</code> definition, and <code>combine :: [[b]] -&gt; b</code> above your <code>combine</code> definition (and similar signatures above other definitions). That tells the type checker what types you expect those functions to be, so it can figure out whether the type error is in the caller or the callee. It helps a lot with error clarity."}, {"owner": {"reputation": 193, "user_id": 4887503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16fea0aa45d3a606279504a80a3e3159?s=128&d=identicon&r=PG&f=1", "display_name": "SuperM4n", "link": "https://stackoverflow.com/users/4887503/superm4n"}, "reply_to_user": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1541790662, "post_id": 53231314, "comment_id": 93350751, "body": "@DarthFennec I&#39;m sorry, I misunderstood above comments. I wrote &quot;I am not there yet&quot; because I thought that guys above were talking about the derivation of types (I don&#39;t know if this is the correct term in English.). I did as you asked and now indeed I have a more detailed error message. I&#39;ll try to improve my code, thank you."}], "owner": {"reputation": 193, "user_id": 4887503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16fea0aa45d3a606279504a80a3e3159?s=128&d=identicon&r=PG&f=1", "display_name": "SuperM4n", "link": "https://stackoverflow.com/users/4887503/superm4n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541787487, "creation_date": 1541787487, "question_id": 53231314, "link": "https://stackoverflow.com/questions/53231314/divide-and-conquer-approach-for-karatsuba-algorithm", "title": "Divide and conquer approach for Karatsuba algorithm", "body": "<p>I'm trying to write Karatsuba Algorithm using the divide and conquer approach in Haskell. I did it with merge sort algorithm but can't figure it out here and it's a little bit embarrassing at this point.</p>\n\n<p>My main function looks like this:</p>\n\n<pre><code>dz test end divide combine x = \n   if test x then end x\n   else combine(map(dz test end divide combine) (divide x))\n</code></pre>\n\n<p>I test it for values <code>1234</code> and <code>5678</code>: <code>dz test end divide combine [1234, 5678,2]</code>.</p>\n\n<p>So I have to write <code>test</code>, <code>end</code>, <code>divide</code> and <code>combine</code> functions.</p>\n\n<pre><code>lengthNumb x = length . show $ x\ntest (x:x1:xs) = (lengthNumb x) &lt; 4 || (lengthNumb x1) &lt; 4\nend (x:y:z:xs) = [x * y, z]\n</code></pre>\n\n<p>This is pretty straightforward. I just check if both numbers that I want to multiply are at least 4 digits long. If not I just use simple multiplication and carry <code>m</code> value. I know that Karatsuba works better for bigger numbers but this is just for testing purposes. </p>\n\n<pre><code>divide [] = []\ndivide (x:x1:x2:xs) = \n   let y1 = x `div` 10^x2\n     y2 = x `mod` 10^x2\n     y3 = x2 `div` 2\n     z1 = x1 `div` 10^x2\n     z2 = x1 `mod` 10^x2\n   in [[y1,y2,y3],[z1,z2,y3],[y1+y2, z1+z2, y3]]\n\ncombine [[x, x1],[y,y1],[z,z1]] = x * 10^(2*x1) + y + (z - x - y) * 10^x1\n</code></pre>\n\n<p>I was told that <code>combine</code> function should only do the final multiplication. So I guess it should get three numbers as an input (each with their <code>m</code> value) and then also do the necessary subtraction ( <code>z-x-y</code> ) because I couldn't do it in <code>divide</code>. </p>\n\n<p>But this is wrong. I get an error: </p>\n\n<pre><code>Occurs check: cannot construct the infinite type: a ~ [a]\n  Expected type: [[a]] -&gt; [a]\n\n  Actual type: [[[a]]] -&gt; [a]\n</code></pre>\n\n<p>I think it is a problem with the parameters of <code>combine</code> function but I don't know how to fix it. I also think that there could be a problem with how <code>combine</code> and <code>divide</code> work together because in one of the previous iterations the final result of multiplication was wrong. </p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "edited": false, "score": 0, "creation_date": 1543586172, "post_id": 53224088, "comment_id": 93983234, "body": "Upvoted, same problem."}, {"owner": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "edited": false, "score": 0, "creation_date": 1546547751, "post_id": 53224088, "comment_id": 94895155, "body": "I experience the same issue from time to time, but with no apparent pattern."}, {"owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "edited": false, "score": 0, "creation_date": 1559063064, "post_id": 53224088, "comment_id": 99298996, "body": "Try touching the handler that references the Hamlet file. This usually solves it for me."}], "owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1541759792, "creation_date": 1541759792, "question_id": 53224088, "link": "https://stackoverflow.com/questions/53224088/yesod-devel-wont-reload-static-files", "title": "Yesod devel won&#39;t reload static files", "body": "<p>I am on Linux Mint 18.3 with Linux Kernel 4.13.0-26-generic.</p>\n\n<p>I installed the scaffolded site using the instructions at <a href=\"https://www.yesodweb.com/page/quickstart\" rel=\"nofollow noreferrer\">https://www.yesodweb.com/page/quickstart</a> and I kept the vanilla dependencies.</p>\n\n<p>When I use </p>\n\n<pre><code>$ stack exec -- yesod devel\n</code></pre>\n\n<p>if I update my Hamlet files, the change will not reflect on the website, even if I refresh with enter.</p>\n\n<p>My Stack version is 1.9.1.</p>\n\n<p>Please help.</p>\n"}, {"tags": ["sorting", "haskell", "grouping"], "comments": [{"owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 0, "creation_date": 1541750734, "post_id": 53221864, "comment_id": 93330561, "body": "What doesn&#39;t work and what is expected? Could you provide sample cases?"}, {"owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "edited": false, "score": 0, "creation_date": 1541751032, "post_id": 53221864, "comment_id": 93330679, "body": "sortable should not be list. It should only be tuple."}, {"owner": {"reputation": 113, "user_id": 7100743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4359de379c78008b3651090e329874?s=128&d=identicon&r=PG&f=1", "display_name": "hellomatey27", "link": "https://stackoverflow.com/users/7100743/hellomatey27"}, "edited": false, "score": 0, "creation_date": 1541751600, "post_id": 53221864, "comment_id": 93330938, "body": "I want sortable to have that format. Changing the specification wouldn&#39;t achieve what I want. It makes sense in the larger picture."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1541751867, "post_id": 53221864, "comment_id": 93331068, "body": "I recommend you don&#39;t use tail-recursion style unless you have a specific reason. Functions that yield a list are usually better expressed with direct recursion \u2013 and they have better performance, too; tail recursion only makes sense with a strict accumulator."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1541752573, "post_id": 53221864, "comment_id": 93331405, "body": "Not sure you want, Would you give a simple example to describe what the desired result of funsort function?"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1541752947, "post_id": 53221864, "comment_id": 93331548, "body": "It would help if you gave meaningful names to your variables."}, {"owner": {"reputation": 113, "user_id": 7100743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4359de379c78008b3651090e329874?s=128&d=identicon&r=PG&f=1", "display_name": "hellomatey27", "link": "https://stackoverflow.com/users/7100743/hellomatey27"}, "edited": false, "score": 0, "creation_date": 1541753289, "post_id": 53221864, "comment_id": 93331696, "body": "Sure, if I have the list:  <code>[(&quot;a&quot;, 1), (&quot;b&quot;,1), (&quot;a&quot;,2), (&quot;c&quot;,0)]</code>  I want to end up with: <code>[[(&quot;a&quot;,1), (&quot;a&quot;,2)], [(&quot;b&quot;,1)], [(&quot;c&quot;,0)]]</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541786269, "post_id": 53221864, "comment_id": 93348801, "body": "See <code>Data.List.group</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541924627, "post_id": 53221864, "comment_id": 93378861, "body": "use <code>Data.List.group</code> only after <code>sortBy (comparing fst)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 4, "last_activity_date": 1541773562, "last_edit_date": 1541773562, "creation_date": 1541761259, "answer_id": 53224465, "question_id": 53221864, "link": "https://stackoverflow.com/questions/53221864/sorting-a-list-of-tuples-into-groups/53224465#53224465", "title": "Sorting a list of tuples into groups", "body": "<p>You just switched the order of arguments to <code>(:)</code>:</p>\n\n<pre><code>funsort :: Sortable -&gt; [Sortable] -&gt; [Sortable]\nfunsort [] ret = ret\nfunsort ((name, value):xs) ret =\n  let unsorted = (filter ((/=name).fst) xs) in\n  let filtered = (filter ((==name).fst) xs) in\n  let listofsortedlists = ((name,value) : filtered) in\n  funsort unsorted -- (ret : listofsortedlists)   -- wrong order\n                   (listofsortedlists : ret)\n</code></pre>\n\n<p>And it works with <code>[]</code> as the initial key-values store, as you no doubt intended:</p>\n\n<pre><code>&gt; funsort [(\"1\",1), (\"2\",10), (\"1\",100)] []\n[[(\"2\",10)],[(\"1\",1),(\"1\",100)]]\nit :: [Sortable]\n</code></pre>\n\n<p>Building a result list in reverse by consing unto a list is a common idiom in the more imperative, non-lazy functional languages. In Haskell, thanks to laziness, we can build a list in a top-down manner, with <em>\"guarded\"</em> recursion:</p>\n\n<pre><code>funsort [] = []\nfunsort ((name, value):xs) =\n  let unsorted = (filter ((/=name).fst) xs) in\n  let filtered = (filter ((==name).fst) xs) in\n  let listofsortedlists = ((name,value) : filtered) in\n  listofsortedlists : funsort unsorted \n</code></pre>\n\n<p>so that there's no need for the extra argument and the result comes in the right order:</p>\n\n<pre><code>&gt; funsort [(\"1\",1), (\"2\",10), (\"1\",100)]\n[[(\"1\",1),(\"1\",100)],[(\"2\",10)]]\n</code></pre>\n\n<p>A more performant way to code this though, is to go via the <code>Data.Map.Map String [Int]</code> route. Leaving it for your researching pleasure.</p>\n\n<p>cf. <a href=\"https://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Map-Strict.html#v:fromListWith\" rel=\"nofollow noreferrer\"><code>FromList</code></a> and friends.</p>\n"}], "owner": {"reputation": 113, "user_id": 7100743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4359de379c78008b3651090e329874?s=128&d=identicon&r=PG&f=1", "display_name": "hellomatey27", "link": "https://stackoverflow.com/users/7100743/hellomatey27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 53224465, "answer_count": 1, "score": 1, "last_activity_date": 1541774225, "creation_date": 1541750559, "last_edit_date": 1541774225, "question_id": 53221864, "link": "https://stackoverflow.com/questions/53221864/sorting-a-list-of-tuples-into-groups", "title": "Sorting a list of tuples into groups", "body": "<p>I have defined a type:</p>\n\n<p><code>type Sortable = [(String, Integer)]</code></p>\n\n<p>I would would to sort these into groups based on the string. Right now, I have:</p>\n\n<pre><code>funsort :: Sortable -&gt; [Sortable] -&gt; [Sortable]\nfunsort [] ret = ret\nfunsort ((name, value):xs) ret =\n  let unsorted = (filter ((/=name).fst) xs) in\n  let filtered = (filter ((==name).fst) xs) in\n  let listofsortedlists = ((name,value) : homies) in\n  funsort unsorted (ret : listofsortedlists)\n</code></pre>\n\n<p>It seems to me that this should work, but it doesn't. :-/</p>\n\n<p>I just get:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018(String, Value)\u2019 with \u2018[Sortable]\u2019\n  Expected type: [[Sortable]]\n    Actual type: [(String, Value)]\n\u2022 In the second argument of \u2018(:)\u2019, namely \u2018sortedlistoflists\u2019\n  In the second argument of \u2018funsort\u2019, namely \u2018(ret : sortedlistoflists)\u2019\n  In the expression: funsort unsorted (ret : sortedlistoflists)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1541755987, "post_id": 53221513, "comment_id": 93333000, "body": "If <code>x</code> is a space, it should become <code>&quot;%20&quot;</code>. You have that part mostly right (<code>:</code> should be <code>++</code>). If it\u2019s not a space, it should become what, considering what you have available in the function?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1541798662, "post_id": 53221513, "comment_id": 93353756, "body": "I imagine you have to do it recursively as an exercise for class. Just for your edification, the way you have done it with a list comprehension is quite nice; a recursive implementation of this function would be awkward &quot;in the wild&quot;."}, {"owner": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "edited": false, "score": 0, "creation_date": 1541892278, "post_id": 53221513, "comment_id": 93374117, "body": "Thank you luqui, I do appreciate that.  And yes, this is for a class -- but not for the actual graded assignment, just the &quot;working through the tutorial&quot; part.  I just hate leaving something un-figured-out, when it&#39;s implied there is, indeed, a solution.  Thank you Ry for making me think."}], "answers": [{"tags": [], "owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "is_accepted": false, "score": 2, "last_activity_date": 1541754303, "last_edit_date": 1541754303, "creation_date": 1541749244, "answer_id": 53221583, "question_id": 53221513, "link": "https://stackoverflow.com/questions/53221513/how-would-i-replace-spaces-in-a-string-with-20-recursively/53221583#53221583", "title": "How would i replace spaces in a string with \u201c%20&quot;, recursively?", "body": "<p>Try this</p>\n\n<pre><code>replace []     = []\nreplace (x:xs) = (if x == ' ' then \"%20\" else [x]) ++ replace xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1541766066, "post_id": 53224905, "comment_id": 93337985, "body": "<code>... | x==&#39; &#39; = &#39;%&#39;:&#39;2&#39;:&#39;0&#39;:replace xs</code> also works, avoiding <code>++</code>, but it&#39;s less readable"}, {"owner": {"reputation": 275, "user_id": 8733796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F32W1.jpg?s=128&g=1", "display_name": "zediogoviana", "link": "https://stackoverflow.com/users/8733796/zediogoviana"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541766645, "post_id": 53224905, "comment_id": 93338292, "body": "@chi yeah, you\u2019re right! I think they will understand the idea this way."}, {"owner": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "edited": false, "score": 0, "creation_date": 1541892352, "post_id": 53224905, "comment_id": 93374125, "body": "I do like the &quot;more readable&quot; especially when I&#39;m just learning the language... I&#39;ve only been at this for a week now.  Thank you."}, {"owner": {"reputation": 275, "user_id": 8733796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F32W1.jpg?s=128&g=1", "display_name": "zediogoviana", "link": "https://stackoverflow.com/users/8733796/zediogoviana"}, "reply_to_user": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "edited": false, "score": 0, "creation_date": 1541892675, "post_id": 53224905, "comment_id": 93374174, "body": "@Stormy you&#39;re welcome! Hope this solved your problem."}], "tags": [], "owner": {"reputation": 275, "user_id": 8733796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F32W1.jpg?s=128&g=1", "display_name": "zediogoviana", "link": "https://stackoverflow.com/users/8733796/zediogoviana"}, "is_accepted": true, "score": 3, "last_activity_date": 1541762940, "creation_date": 1541762940, "answer_id": 53224905, "question_id": 53221513, "link": "https://stackoverflow.com/questions/53221513/how-would-i-replace-spaces-in-a-string-with-20-recursively/53224905#53224905", "title": "How would i replace spaces in a string with \u201c%20&quot;, recursively?", "body": "<p>You miss the case where it is not a <code>' '</code>.\nSo, try this:</p>\n\n<pre><code>replace [] = []\nreplace (x:xs) \n    | x == ' ' = \"%20\" ++ replace xs\n    | otherwise = x : replace xs\n</code></pre>\n\n<p>You need to use <code>++</code> in your first guard because a <em>string</em> is a list of chars.</p>\n"}], "owner": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 53224905, "answer_count": 2, "score": 2, "last_activity_date": 1541762940, "creation_date": 1541748934, "question_id": 53221513, "link": "https://stackoverflow.com/questions/53221513/how-would-i-replace-spaces-in-a-string-with-20-recursively", "title": "How would i replace spaces in a string with \u201c%20&quot;, recursively?", "body": "<p>So I've figured this out non-recursively like this:</p>\n\n<pre><code>noSpaces :: [Char] -&gt; [Char]    \nnoSpaces xs = [f | r &lt;- xs, f &lt;- if (r == ' ') then \"%20\" else [r]]\n</code></pre>\n\n<p>but now i need to figure out how to do that recursively, with no pattern matching and no concatenation... </p>\n\n<p>I figured out other recursive functions (gcd, fib, and a couple others involving numbers) easily enough... but am lost on this for some reason and getting lost-er the more stuff i try that doesn't work... </p>\n\n<p>I found the other answer on here about doing this in Haskell... but that idea uses two separate functions, one being like a helper function -- how would you go about this all in one function, as concisely as possible?</p>\n\n<p>something like:</p>\n\n<pre><code>replace [Char] = [Char]\nreplace (x:xs)\n    | x == ' ' = \"%20\":replace xs\n</code></pre>\n\n<p>which compiles but of course i get the 'non-exhaustive patterns in function' error message, and can't figure out what to put in the 'otherwise' clause...</p>\n\n<p>any help would be appreciated!</p>\n"}, {"tags": ["list", "haskell", "nested", "pattern-matching"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541773871, "post_id": 53219437, "comment_id": 93341969, "body": "you don&#39;t need that nested case in the first place. the arguments to functions are  patterns, so you just write <code>iterator (D (x:xs)) (D (y:ys)) | x &gt; y = iterator ....</code>. nested patterns are allowed."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7100743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4359de379c78008b3651090e329874?s=128&d=identicon&r=PG&f=1", "display_name": "hellomatey27", "link": "https://stackoverflow.com/users/7100743/hellomatey27"}, "edited": false, "score": 0, "creation_date": 1541738682, "post_id": 53219671, "comment_id": 93327137, "body": "This fixed it, thanks!. Would you mind helping me add another layer? I&#39;ve modified SumCoolElement:  <code>data SumCoolElement = E Int</code>  I tried writing:  ` (D ((E fstint):xs))) []  -&gt; ...`, but it won&#39;t work."}, {"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "reply_to_user": {"reputation": 113, "user_id": 7100743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4359de379c78008b3651090e329874?s=128&d=identicon&r=PG&f=1", "display_name": "hellomatey27", "link": "https://stackoverflow.com/users/7100743/hellomatey27"}, "edited": false, "score": 0, "creation_date": 1541756681, "post_id": 53219671, "comment_id": 93333335, "body": "That seems correct - what&#39;s the error message, after fixing everything else?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541762751, "post_id": 53219671, "comment_id": 93336468, "body": "the error message? shouldn&#39;t it be &quot;not in scope: <code>x</code>, <code>xs</code>, <code>y</code>, <code>ys</code> ...&quot;?"}, {"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1541805565, "post_id": 53219671, "comment_id": 93355636, "body": "Expanded the answer."}], "tags": [], "owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "is_accepted": true, "score": 3, "last_activity_date": 1541805542, "last_edit_date": 1541805542, "creation_date": 1541735850, "answer_id": 53219671, "question_id": 53219437, "link": "https://stackoverflow.com/questions/53219437/pattern-matching-on-a-datatype-containing-a-list/53219671#53219671", "title": "Pattern matching on a datatype containing a list", "body": "<p>In expressions as well as patterns, <code>:</code> has lower priority than type application. Therefore, this kind of pattern:</p>\n\n<pre><code>f (D x:xs) = ...\n</code></pre>\n\n<p>will be parsed as:</p>\n\n<pre><code>f ((D x):xs) = ...\n</code></pre>\n\n<p>which is incorrect. You want to specify explicitly:</p>\n\n<pre><code>f (D (x:xs)) = ...\n</code></pre>\n\n<p>Or in your particular case:</p>\n\n<pre><code>(D (fstint:xs)) [] -&gt; ...\n(D (fstint:xs)) (D (sndint:ys)) | fstint &gt; sndint -&gt; ...\n  ...\n</code></pre>\n\n<p>There is the same issue on the right side of those expressions:</p>\n\n<pre><code>D (fstint + sndint) : xs\n</code></pre>\n\n<p>Will be parsed as:</p>\n\n<pre><code>(D fstint + sndint) : xs\n</code></pre>\n\n<p>It should be:</p>\n\n<pre><code>D (fstint + sndint : xs)\n</code></pre>\n\n<p>Finally, the other answer by @assembly.jc is also required to fix it - the argument of the <code>case</code> expression has undefined variables. You probably meant to say that <code>(x:xs)</code> is <code>lst1</code> and <code>(y:ys)</code> is <code>lst2</code>, but note that since the second list might be empty, it is easier to go pattern matching directly:</p>\n\n<pre><code>iterator :: Dtype -&gt; Dtype -&gt; Int\niterator (D fstint:xs) [] = fstint\niterator (D fstint:xs) (D sndint:ys) | fstint &gt; sndint = ...\n...\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7100743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4359de379c78008b3651090e329874?s=128&d=identicon&r=PG&f=1", "display_name": "hellomatey27", "link": "https://stackoverflow.com/users/7100743/hellomatey27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53219671, "answer_count": 1, "score": 1, "last_activity_date": 1541805542, "creation_date": 1541734104, "last_edit_date": 1541774044, "question_id": 53219437, "link": "https://stackoverflow.com/questions/53219437/pattern-matching-on-a-datatype-containing-a-list", "title": "Pattern matching on a datatype containing a list", "body": "<p>So, I have defined a data type which looks something like this:</p>\n\n<pre><code>data SumCoolElement = Int\nnewtype DType = D [SumCoolElement]\n</code></pre>\n\n<p>I want to iterate over <code>SumCoolElements</code>, which I am trying to do with this code:</p>\n\n<pre><code>iterator :: Dtype -&gt; DType -&gt; Int\niterator (D lst1) (D lst2) = case (x:xs) (y:ys) of\n  (D fstint:xs) [] -&gt; fstint\n  (D fstint:xs) (D sndint:ys) | fstint &gt; sndint -&gt; iterator (D (fstint + sndint) : xs) (D ys)\n  (D fstint:xs) (D sndint:ys) | fstint &lt; sndint -&gt; iterator (D (fstint - sndint) : xs) (D ys)\n</code></pre>\n\n<p>The code itself is pointless, but what annoys me is that I can't even get it to run. I seem to keep running into syntax errors no matter how I format the above. Can someone please guide me in the right direction?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1541722249, "post_id": 53217914, "comment_id": 93323688, "body": "You can use the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:any\" rel=\"nofollow noreferrer\"><code>any</code></a> function to see if the filtered list would have been empty. Idiomatically I think it makes more sense to just return the empty list, though."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1541723114, "post_id": 53217914, "comment_id": 93323894, "body": "The <code>Maybe</code> monad is for computations that may return zero or one value, while the list monad is for ones which can produce any number, from zero upwards. So <code>Maybe</code> is kind of a more limited sort of list, with at most one element. I don&#39;t see the need to combine them - just use lists."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 5, "creation_date": 1541727040, "post_id": 53217914, "comment_id": 93324668, "body": "@RobinZigmond Perhaps, but that depends on whether the OP wants the two kinds of emptiness to mean different things -- that is, <code>Just []</code> might mean &quot;the computation succeeded by default because there were no values to test&quot;, while <code>Nothing</code> would mean some value led to a failure. On the other hand, if the OP wanted their function to produce <code>Nothing</code> when given an empty list, collapsing the layers would make sense."}, {"owner": {"reputation": 113, "user_id": 7100743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4359de379c78008b3651090e329874?s=128&d=identicon&r=PG&f=1", "display_name": "hellomatey27", "link": "https://stackoverflow.com/users/7100743/hellomatey27"}, "edited": false, "score": 0, "creation_date": 1541732632, "post_id": 53217914, "comment_id": 93325856, "body": "That&#39;s exactly it duplode."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1541731745, "last_edit_date": 1541731745, "creation_date": 1541730909, "answer_id": 53219044, "question_id": 53217914, "link": "https://stackoverflow.com/questions/53217914/maybe-monad-and-a-list/53219044#53219044", "title": "Maybe monad and a list", "body": "<p>This looks like a good fit for <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Traversable.html#v:traverse\" rel=\"nofollow noreferrer\"><code>traverse</code></a>:</p>\n\n<pre><code>traverse :: (Traversable t, Applicative f) =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\n</code></pre>\n\n<p>That's a bit of a mouthful, so let's specialise it to your use case, with lists and <code>Maybe</code>:</p>\n\n<pre><code>GHCi&gt; :set -XTypeApplications\nGHCi&gt; :t traverse @[] @Maybe\ntraverse @[] @Maybe :: (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe [b]\n</code></pre>\n\n<p>It works like this: you give it an <code>a -&gt; Maybe b</code> function, which is applied to all elements of the list, just like <code>fmap</code> does. The twist is that the <code>Maybe b</code> values are then combined in a way that only gives you a modified list if there aren't any <code>Nothing</code>s; otherwise, the overall result is <code>Nothing</code>. That fits your requirements like a glove:</p>\n\n<pre><code>noneOrNothing :: (a -&gt; Bool) -&gt; [a] -&gt; Maybe [a]\nnoneOrNothing p = traverse (\\x -&gt; if p x then Nothing else Just x)\n</code></pre>\n\n<p>(<code>allOrNothing</code> would have been a more euphonic name, but then I'd have to flip the test with respect to your description.)</p>\n\n<p>There are a lot of things we might discuss about the <code>Traversable</code> and <code>Applicative</code> classes. For now, I will talk a bit more about <code>Applicative</code>, in case you haven't met it yet. <code>Applicative</code> is a superclass of <code>Monad</code> with two essential methods: <code>pure</code>, which is the same thing as <code>return</code>, and <code>(&lt;*&gt;)</code>, which is not entirely unlike <code>(&gt;&gt;=)</code> but crucially different from it. For the <code>Maybe</code> example... </p>\n\n<pre><code>GHCi&gt; :t (&gt;&gt;=) @Maybe\n(&gt;&gt;=) @Maybe :: Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b\nGHCi&gt; :t (&lt;*&gt;) @Maybe\n(&lt;*&gt;) @Maybe :: Maybe (a -&gt; b) -&gt; Maybe a -&gt; Maybe b\n</code></pre>\n\n<p>... we can describe the difference like this: in <code>mx &gt;&gt;= f</code>, if <code>mx</code> is a <code>Just</code>-value, <code>(&gt;&gt;=)</code> reaches inside of it to apply <code>f</code> and produce a result, which, depending on what was inside <code>mx</code>, will turn out to be a <code>Just</code>-value or a <code>Nothing</code>. In <code>mf &lt;*&gt; mx</code>, though, if <code>mf</code> and <code>mx</code> are <code>Just</code>-values you are guaranteed to get a <code>Just</code> value, which will hold the result of applying the function from <code>mf</code> to the value from <code>mx</code>. (By the way: what will happen if <code>mf</code> or <code>mx</code> are <code>Nothing</code>?)</p>\n\n<p><code>traverse</code> involves <code>Applicative</code> because the combining of values I mentioned at the beginning (which, in your example, turns a number of <code>Maybe a</code> values into a <code>Maybe [a]</code>) is done using <code>(&lt;*&gt;)</code>. As your question was originally about monads, it is worth noting that it is possible to define <code>traverse</code> using <code>Monad</code> rather than <code>Applicative</code>. This variation goes by the name <code>mapM</code>:</p>\n\n<pre><code>mapM :: (Traversable t, Monad m) =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)\n</code></pre>\n\n<p>We prefer <code>traverse</code> to <code>mapM</code> because it is more general -- as mentioned above, <code>Applicative</code> is a superclass of <code>Monad</code>.</p>\n\n<p>On a closing note, your intuition about this being \"a sort of filter\" makes a lot of sense. In particular, one way to think about <code>Maybe a</code> is that it is what you get when you pick booleans and attach values of type <code>a</code> to <code>True</code>. From that vantage point, <code>(&lt;*&gt;)</code> works as an <code>&amp;&amp;</code> for these weird booleans, which combines the attached values if you happen to supply two of them (cf. <a href=\"https://stackoverflow.com/questions/53217914/maybe-monad-and-a-list/53219044#comment93323688_53217914\">DarthFennec's suggestion</a> of an implementation using <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:any\" rel=\"nofollow noreferrer\"><code>any</code></a>). Once you get used to <code>Traversable</code>, you might enjoy having a look at <a href=\"http://hackage.haskell.org/package/witherable-0.2/docs/Data-Witherable.html\" rel=\"nofollow noreferrer\">the <code>Filterable</code> and <code>Witherable</code> classes</a>, which play with this relationship between <code>Maybe</code> and <code>Bool</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1541796933, "post_id": 53232543, "comment_id": 93353200, "body": "Nice answer. I would have liked to add a more step-by-step solution like this one, but then my answer would have grown too long and meandering."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 1, "last_activity_date": 1541797945, "last_edit_date": 1541797945, "creation_date": 1541793631, "answer_id": 53232543, "question_id": 53217914, "link": "https://stackoverflow.com/questions/53217914/maybe-monad-and-a-list/53232543#53232543", "title": "Maybe monad and a list", "body": "<p>duplode's answer is a good one, but I think it is also helpful to learn to operate within a monad in a more basic way. It can be a challenge to learn every little monad-general function, and see how they could fit together to solve a specific problem. So, here's a DIY solution that shows how to use do notation and recursion, tools which can help you with any monadic question.</p>\n\n<pre><code>forbid :: (a -&gt; Bool) -&gt; [a] -&gt; Maybe [a]\nforbid _ [] = Just []\nforbid p (x:xs) = if p x\n  then Nothing\n  else do\n    remainder &lt;- forbid p xs\n    Just (x : remainder)\n</code></pre>\n\n<p>Compare this to an implementation of <code>remove</code>, the opposite of <code>filter</code>:</p>\n\n<pre><code>remove :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nremove _ [] = []\nremove p (x:xs) = if p x\n  then remove p xs\n  else\n    let remainder = remove p xs\n    in x : remainder\n</code></pre>\n\n<p>The structure is the same, with just a couple differences: what you want to do when the predicate returns true, and how you get access to the value returned by the recursive call. For <code>remove</code>, the returned value is a list, and so you can just <code>let</code>-bind it and cons to it. With <code>forbid</code>, the returned value is only <em>maybe</em> a list, and so you need to use <code>&lt;-</code> to bind to that monadic value. If the return value was Nothing, bind will short-circuit the computation and return Nothing; if it was Just a list, the <code>do</code> block will continue, and cons a value to the front of that list. Then you wrap it back up in a Just.</p>\n"}], "owner": {"reputation": 113, "user_id": 7100743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4359de379c78008b3651090e329874?s=128&d=identicon&r=PG&f=1", "display_name": "hellomatey27", "link": "https://stackoverflow.com/users/7100743/hellomatey27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 53219044, "answer_count": 2, "score": 2, "last_activity_date": 1541797945, "creation_date": 1541721479, "question_id": 53217914, "link": "https://stackoverflow.com/questions/53217914/maybe-monad-and-a-list", "title": "Maybe monad and a list", "body": "<p>Ok, so I am trying to learn how to use monads, starting out with maybe. I've come up with an example that I can't figure out how to apply it to in a nice way, so I was hoping someone else could:</p>\n\n<p>I have a list containing a bunch of values. Depending on these values, my function should return the list itself, or a Nothing. In other words, I want to do a sort of filter, but with the consequence of a hit being the function failing.</p>\n\n<p>The only way I can think of is to use a filter, then comparing the size of the list I get back to zero. Is there a better way?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10300, "user_id": 428486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ca8698e59a2414899f97b850084f45?s=128&d=identicon&r=PG", "display_name": "lucascaro", "link": "https://stackoverflow.com/users/428486/lucascaro"}, "edited": false, "score": 1, "creation_date": 1541746767, "post_id": 53217335, "comment_id": 93329115, "body": "Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>! Questions along the lines of &quot;I want to do X; can someone tell me how to write my code?&quot; are considered off-topic on Stack Overflow. Please see <a href=\"https://stackoverflow.com/help/on-topic\">help center</a> for more details. Note that if your question is, &quot;I want to do X and I tried approach Y but it didn&#39;t work; can anyone help me figure out what I did wrong?&quot; then that question is on-topic on Stack Overflow, and you&#39;ll find many people willing to help you with your problem."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6342481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439684f108f4b556e5ae922869354749?s=128&d=identicon&r=PG&f=1", "display_name": "subttle", "link": "https://stackoverflow.com/users/6342481/subttle"}, "edited": false, "score": 2, "creation_date": 1541723200, "post_id": 53217587, "comment_id": 93323910, "body": "I don&#39;t know why I originally was thinking of <code>Rep1</code> as the &quot;optional&quot; operator (typically written <code>?</code>). If that were the case it would then be <code>True</code>. In the case of the positive closure, I think it would be something like a fold over the repeated concatenations but because we know it is repeated concatenation of the same expression we can instead just check it once with <code>nullable&#39; (Rep1 \u03b1) = nullable&#39; \u03b1</code> but I&#39;ll think carefully about that first before I make an edit."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1541784409, "post_id": 53217587, "comment_id": 93347951, "body": "That&#39;s correct and follows form the equality <code>L+ = L* L</code>. In a sense <code>L+</code> is &quot;syntactic sugar&quot; in regexps, and not a real primitive."}], "tags": [], "owner": {"reputation": 61, "user_id": 6342481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439684f108f4b556e5ae922869354749?s=128&d=identicon&r=PG&f=1", "display_name": "subttle", "link": "https://stackoverflow.com/users/6342481/subttle"}, "is_accepted": false, "score": 4, "last_activity_date": 1541951817, "last_edit_date": 1541951817, "creation_date": 1541718879, "answer_id": 53217587, "question_id": 53217335, "link": "https://stackoverflow.com/questions/53217335/haskell-function-to-check-emptiness-of-regular-expression/53217587#53217587", "title": "Haskell function to check emptiness of regular expression", "body": "<p>Computing Salomaa's Empty Word Property (sometimes also called \"nullable\") is typically done by putting the regular expression into a normal form which takes advantage of algebraic properties to remove redundant Kleene stars and then checks if there is a star operator still in the expression or if the expression has or is itself <code>Empty</code> as you've defined. Here is an <a href=\"https://github.com/subttle/regular/blob/504094878a39424d0ee6b973d1f3767cdbb81d23/src/RegExp.hs#L418\" rel=\"nofollow noreferrer\">example</a>.</p>\n\n<pre><code>-- decide if the language defined by r contains \u03b5, i.e.\n-- nullable (r) \u21d4 \u03b5 \u2208 \u2112(r)\n-- Also know as Salomaa's Empty Word Property (EWP)\nnullable \u2237 (Ord s) \u21d2 RegExp s \u2192 Bool\nnullable = nullable' . normalize\n  where nullable' Zero     = False\n        nullable' One      = True\n        nullable' (Lit  _) = False\n        nullable' (\u03b1 :| \u03b2) = nullable' \u03b1 || nullable' \u03b2\n        nullable' (\u03b1 :. \u03b2) = nullable' \u03b1 &amp;&amp; nullable' \u03b2\n        nullable' (Star _) = True\n</code></pre>\n\n<p>Adding a case for <code>Rep1</code> would look like <code>nullable' (Rep1 \u03b1) = nullable' \u03b1</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10626299, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "rete seduop", "link": "https://stackoverflow.com/users/10626299/rete-seduop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1541951817, "creation_date": 1541717370, "last_edit_date": 1541742781, "question_id": 53217335, "link": "https://stackoverflow.com/questions/53217335/haskell-function-to-check-emptiness-of-regular-expression", "title": "Haskell function to check emptiness of regular expression", "body": "<p>Hi I have the following data type for a regular expression:</p>\n\n<pre><code>data RE a            -- regular expressions over an alphabet defined by 'a'\n= Empty          -- empty regular expression\n| Sym a          -- match the given symbol\n| RE a :+: RE a  -- concatenation of two regular expressions\n| RE a :|: RE a  -- choice between two regular expressions\n| Rep (RE a)     -- zero or more repetitions of a regular expression\n| Rep1 (RE a)    -- one or more repetitions of a regular expression\nderiving (Show)\n</code></pre>\n\n<p>and I need to devise a method to check if that regular expression contains an Empty string. Such as (Rep (Sym 'a' :+: Sym 'b')) would be true and (Sym 'a') would be false.\nHow would I go about making this method to return a boolean?</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1541698132, "post_id": 53213014, "comment_id": 93313922, "body": "Same again with Cabal. Example of installing threepenny-gui: cabal: Error: some packages failed to install: threepenny-gui-0.8.3.0-57EYYliZ1loIOlAOTIgmI2 failed during the building phase. The exception was: ExitFailure 1"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 2, "creation_date": 1541699506, "post_id": 53213014, "comment_id": 93314519, "body": "If this is a continuation of a previous question, please edit that question instead of starting a new one.  If this is a new question, what command did you run?  Where is the code of <code>teststack</code>, so that we can try to reproduce the behavior?  If it is a permissions issue, what is the output of <code>ls -al</code>.  Pay attention to the difference between <code>.&#47;stack-work</code> and <code>.stack-work</code>.  The latter is a hidden directory in your current directory; the initial <code>.</code> tells MacOS &amp; Linux to hide a directory."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1541738340, "post_id": 53213014, "comment_id": 93327064, "body": "What catches my eye here is the &quot;permission denied&quot; bit. In particular, Stack is meant to be ran from your regular user account; you shouldn&#39;t be running it as admin or with elevated permissions. (Assuming typical workflows, the same goes for cabal-install.)"}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1541744681, "post_id": 53213014, "comment_id": 93328504, "body": "@Duplode, closed the other thread since they&#39;re related. Other systems require me to run the entire machine in admin. Should I sandbox the entire Haskell installation? I assumed stack/cabal was just asking for elevated permissions, hence the reason I didn&#39;t understand."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1541765524, "post_id": 53213014, "comment_id": 93337744, "body": "(1) I&#39;m not sure I get what you mean by &quot;sandbox the entire Haskell installation&quot;, but in any case running either cabal-install or Stack from your user account requires no special preparation: even if the tools themselves are installed globally (e.g. because you got them from your package manager), they default to installing packages to a suitable place in your user directory. (2) On another note, <code>.stack-work</code> is the directory in which Stack puts build artefacts. Stack creates it as a subdirectory of the project you are working on."}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 325, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541738081, "creation_date": 1541697614, "last_edit_date": 1541738081, "question_id": 53213014, "link": "https://stackoverflow.com/questions/53213014/haskell-stack-exitfailure1-on-build", "title": "Haskell, stack &#39;ExitFailure1&#39; on build", "body": "<p>I got an ExitFailure1 again. Now on Stack when I build a file (used to have this on Cabal, led me to a complete dirty reinstall). I have the feeling it is caused by the '<code>./stack-work</code>' permission denied. But where to find this '<code>./stack-work</code>'? Looking forward to you professional opinion, rather than me nuking the entire install again. </p>\n\n<pre><code>Configuring teststack-0.1.0.0...\n.stack-work/dist: createDirectory: permission denied (Permission denied)\n\n--  While building package teststack-0.1.0.0 using:\n      /Users/administrator/.stack/setup-exe-cache/x86_64-osx/Cabal-simple_mPHDZzAJ_2.2.0.1_ghc-8.4.4 --builddir=.stack-work/dist/x86_64-osx/Cabal-2.2.0.1 configure --with-ghc=/Users/administrator/.stack/programs/x86_64-osx/ghc-8.4.4/bin/ghc --with-ghc-pkg=/Users/administrator/.stack/programs/x86_64-osx/ghc-8.4.4/bin/ghc-pkg --user --package-db=clear --package-db=global --package-db=/Users/administrator/.stack/snapshots/x86_64-osx/lts-12.17/8.4.4/pkgdb --package-db=/Users/administrator/Desktop/Haskell/hs_level_0/teststack/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/pkgdb --libdir=/Users/administrator/Desktop/Haskell/hs_level_0/teststack/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/lib --bindir=/Users/administrator/Desktop/Haskell/hs_level_0/teststack/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/bin --datadir=/Users/administrator/Desktop/Haskell/hs_level_0/teststack/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/share --libexecdir=/Users/administrator/Desktop/Haskell/hs_level_0/teststack/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/libexec --sysconfdir=/Users/administrator/Desktop/Haskell/hs_level_0/teststack/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/etc --docdir=/Users/administrator/Desktop/Haskell/hs_level_0/teststack/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/doc/teststack-0.1.0.0 --htmldir=/Users/administrator/Desktop/Haskell/hs_level_0/teststack/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/doc/teststack-0.1.0.0 --haddockdir=/Users/administrator/Desktop/Haskell/hs_level_0/teststack/.stack-work/install/x86_64-osx/lts-12.17/8.4.4/doc/teststack-0.1.0.0 --dependency=base=base-4.11.1.0 --enable-tests --enable-benchmarks\n    Process exited with code: ExitFailure 1\nMacBook-2:teststack administrator$ \n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1541750095, "post_id": 53210948, "comment_id": 93330314, "body": "@Elmex80s: as far as I know UTCTime is not an instance of <code>Enum</code>."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1541758394, "post_id": 53210948, "comment_id": 93334232, "body": "I wouldn&#39;t expect it to work for times, but it might be interesting to find out if it could work for dates."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1541690913, "creation_date": 1541690913, "answer_id": 53210948, "question_id": 53210737, "link": "https://stackoverflow.com/questions/53210737/how-get-yesterday-in-haskell-current-date-1-day/53210948#53210948", "title": "How get yesterday in Haskell? Current date - 1 day?", "body": "<p>You can use the <a href=\"https://hackage.haskell.org/package/time-1.9.2/docs/Data-Time-Clock.html#v:addUTCTime\" rel=\"noreferrer\"><strong><code>addUTCTime :: NominalDiffTime -&gt; UTCTime -&gt; UTCTime</code></strong></a> function with as difference <a href=\"https://hackage.haskell.org/package/time-1.9.2/docs/Data-Time-Clock.html#v:nominalDay\" rel=\"noreferrer\"><strong><code>-nominalDay</code></strong></a>. For example:</p>\n\n<pre><code>Prelude Data.Time.Clock&gt; fmap (addUTCTime (-nominalDay)) getCurrentTime\n2018-11-07 15:27:57.8510597 UTC\n</code></pre>\n\n<p>or when you want to obtain the Gregorian date:</p>\n\n<pre><code>Prelude Data.Time.Clock Data.Time.Calendar&gt; fmap (toGregorian . utctDay . addUTCTime (-nominalDay)) getCurrentTime\n(2018,11,7) \n</code></pre>\n"}], "owner": {"reputation": 2348, "user_id": 622145, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e7aecc50090d4dd125d5394549cf17a0?s=128&d=identicon&r=PG", "display_name": "Twistleton", "link": "https://stackoverflow.com/users/622145/twistleton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 53210948, "answer_count": 1, "score": 4, "last_activity_date": 1541690913, "creation_date": 1541690335, "question_id": 53210737, "link": "https://stackoverflow.com/questions/53210737/how-get-yesterday-in-haskell-current-date-1-day", "title": "How get yesterday in Haskell? Current date - 1 day?", "body": "<p>How get <strong>yesterday</strong> in Haskell? For the current day - of course it works like this:</p>\n\n<pre><code>date :: IO (Integer,Int,Int) -- :: (year,month,day)\ndate = getCurrentTime &gt;&gt;= return . toGregorian . utctDay\n</code></pre>\n\n<p>But for yesterday? Does that work with diffUTCTime? </p>\n\n<p>With sql: </p>\n\n<pre><code>select current date, current date - 1 day from sysdba.routine \n08.11.2018 07.11.2018\n</code></pre>\n\n<p>But with Haskell?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1541689724, "post_id": 53210354, "comment_id": 93308970, "body": "If the type doesn&#39;t matter, then how can it be necessary to \u201cprovidce information about which particular polymorphic type must be specified\u201d? If it <i>really</i> doesn&#39;t matter, then <code>foo (Nothing :: Maybe ())</code> should be ok."}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 10, "last_activity_date": 1541690693, "creation_date": 1541690693, "answer_id": 53210877, "question_id": 53210354, "link": "https://stackoverflow.com/questions/53210354/haskell-ambiguous-type-variable-arising-from-using-a-function-where-said-var/53210877#53210877", "title": "Haskell: &quot;ambiguous type variable arising from using a function&quot;, where said variable actually doesn&#39;t matter", "body": "<p>\"doesn't matter\" is a property of the instance, and ghc doesn't introspect instances like that. For some types, it does matter. The <code>Show</code> instance for <code>[a]</code> depends on the type <code>a</code>, even when the list is empty. Check out the result of <code>show ([] :: [Char])</code> vs the result of <code>show ([] :: [Int])</code>.</p>\n\n<p>But all of that is sort of an aside. The fact is, types are determined at compile time, but values are determined at run time. You have presented a situation for which the type variables don't matter for only some input values. In this case, the type variables still matter, because they control behavior in the other cases.</p>\n\n<p>You're going to have to properly resolve the ambiguous types, because that's how ghc knows which code to use. There are some techniques for doing it conveniently, like using the ScopedTypeVariables extension, but it's hard to recommend one without having a more representative piece of code. The most important thing I can say is that it really does matter, though, because instance selection is done at compile time, long before a value is ever seen. </p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1541691515, "last_edit_date": 1541691515, "creation_date": 1541690748, "answer_id": 53210902, "question_id": 53210354, "link": "https://stackoverflow.com/questions/53210354/haskell-ambiguous-type-variable-arising-from-using-a-function-where-said-var/53210902#53210902", "title": "Haskell: &quot;ambiguous type variable arising from using a function&quot;, where said variable actually doesn&#39;t matter", "body": "<p>The type checker doesn't know what <code>foo</code> does with its argument, and specifically doesn't know that <code>Nothing</code> won't actually be used. But it <em>does</em> know that the argument must have type <code>Show a =&gt; Maybe a</code>, and <code>Nothing</code> has the more general type <code>Maybe a</code>. It's up to you to provide a sufficiently narrowly typed argument when calling <code>foo</code>.</p>\n\n<p>There's no need to define a new dummy type; any existing type with a <code>Show</code> instance will do.</p>\n\n<pre><code>bar :: [Char]\nbar = foo (Nothing :: Maybe ())\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 5377701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osnHj.jpg?s=128&g=1", "display_name": "O.Phillips", "link": "https://stackoverflow.com/users/5377701/o-phillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 53210877, "answer_count": 2, "score": 3, "last_activity_date": 1541691515, "creation_date": 1541689143, "question_id": 53210354, "link": "https://stackoverflow.com/questions/53210354/haskell-ambiguous-type-variable-arising-from-using-a-function-where-said-var", "title": "Haskell: &quot;ambiguous type variable arising from using a function&quot;, where said variable actually doesn&#39;t matter", "body": "<p>Consider the following function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>foo :: Show a =&gt; Maybe a -&gt; [Char] \nfoo (Just x) = show x \nfoo Nothing = \"Nothing\"\n</code></pre>\n\n<p>Then I try to use this function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>bar :: [Char]\nbar = foo Nothing\n</code></pre>\n\n<p>The argument that has been passed to <code>foo</code> is of type <code>Maybe a</code> where <code>a</code> is not specified, and indeed we don't care about <code>a</code>, because we use only the case of <code>foo</code> for the <code>Nothing</code>. But the GHC claims to provide the concrete type:</p>\n\n<blockquote>\n  <p>Ambiguous type variable <code>a0</code> arising from a use of <code>foo</code><br>\n  prevents the constraint <code>(Show a0)</code> from being solved.    Probable\n  fix: use a type annotation to specify what <code>a0</code> should be.</p>\n</blockquote>\n\n<p>GHC hints to specify the type. So the only fix I see there is to create a fake type which has an instance of <code>Show</code> type class:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE EmptyDataDecls, KindSignatures #-}\n{-# OPTIONS_GHC -fno-warn-missing-methods #-}\n\ndata Dummy :: *\n\ninstance Show Dummy\n\nbar :: [Char]\nbar = foo (Nothing :: Maybe Dummy)\n\nfoo :: Show a =&gt; Maybe a -&gt; [Char]\nfoo (Just x) = show x\nfoo Nothing = \"Nothing\"\n</code></pre>\n\n<p>It works, but seems to be pretty straightforward. But the real reason why I don't like this solution is because for my purposes this code is automatically generated from some meta data, which doesn't provide information about which particular polymorph type must be specified as <code>Dummy</code> (there are may be user data types with more than one parameters). So I wonder, is there any way to tell GHC, that if the type is not specified, this type doesn't matter?</p>\n"}, {"tags": ["haskell", "vim"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1541723690, "post_id": 53210179, "comment_id": 93323994, "body": "I recommend moving the solution you appended to the question to an answer."}], "answers": [{"comments": [{"owner": {"reputation": 2483, "user_id": 3563925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/153e227ddaa586841dbf53df8ca2729e?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Ponce", "link": "https://stackoverflow.com/users/3563925/guillaume-ponce"}, "edited": false, "score": 0, "creation_date": 1541689803, "post_id": 53210278, "comment_id": 93309024, "body": "Thanks. I was misled with a comparison to grep, which (as it seem), can take both arguments and data from the standard input."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2483, "user_id": 3563925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/153e227ddaa586841dbf53df8ca2729e?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Ponce", "link": "https://stackoverflow.com/users/3563925/guillaume-ponce"}, "edited": false, "score": 3, "creation_date": 1541691867, "post_id": 53210278, "comment_id": 93310298, "body": "Even with <code>grep</code>, there is a slight difference. The argument(s) to <code>grep</code> are names of files to read from in lieu of standard input, not the actual data that will be filtered. <code>grep &#39;f*&#39; bar foo</code> doesn&#39;t output <code>foo</code>; it tries to read from files named <code>bar</code> and <code>foo</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 6, "last_activity_date": 1541688948, "creation_date": 1541688948, "answer_id": 53210278, "question_id": 53210179, "link": "https://stackoverflow.com/questions/53210179/why-doesnt-my-haskell-cmd-line-program-get-arguments-from-vim-bang/53210278#53210278", "title": "Why doesn&#39;t my Haskell cmd line program get arguments from Vim Bang?", "body": "<p>The <code>!</code> command sends the seleted text to the program via standard input, not as a command line argument. The command line equivalent would be <code>somecommand | ./show-input</code>.</p>\n"}], "owner": {"reputation": 2483, "user_id": 3563925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/153e227ddaa586841dbf53df8ca2729e?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Ponce", "link": "https://stackoverflow.com/users/3563925/guillaume-ponce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 53210278, "answer_count": 1, "score": 1, "last_activity_date": 1541690726, "creation_date": 1541688658, "last_edit_date": 1541690726, "question_id": 53210179, "link": "https://stackoverflow.com/questions/53210179/why-doesnt-my-haskell-cmd-line-program-get-arguments-from-vim-bang", "title": "Why doesn&#39;t my Haskell cmd line program get arguments from Vim Bang?", "body": "<p>Vim has the possibility to let you replace selected text with the output of an external program. I'd like to take advantage of this with programs that I'd write in Haskell. But it doesn\u2019t get the selected text as args.</p>\n\n<p>-- show-input.hs</p>\n\n<pre><code>module Main where\n\nimport System.Environment\n\nmain = do\n    input &lt;- getArgs\n    putStr (\"Input was: \" ++ (show input))\n</code></pre>\n\n<p>When I run it from the command line (NixOS GNU/Linux, BASH), I get the expected behavior:</p>\n\n<pre><code>$ ./show-input test\nInput was: [\"test\"]\n</code></pre>\n\n<p>When I select some text in Vim and invoke <code>:'&lt;,'&gt;!~/show-input</code>, I get this\u00a0:</p>\n\n<pre><code>Input was: []\n</code></pre>\n\n<p>There is something weird here, but I can't tell if it is from the way Vim passes arguments or from the way Haskell gets them. I have tried with both console Vim and graphical gVim (8.0.1451), with the same result.</p>\n\n<hr>\n\n<p>NB: I can successfully use Vim Bang! with other external programs, such as grep. It works great.</p>\n\n<h2>---</h2>\n\n<h1>Correct version after chepner's answer</h1>\n\n<p>So, for anyone interested, just replace <code>getArgs</code> with <code>getContents</code> and you get your input all in a string (instead of a list of strings).</p>\n\n<pre><code>module Main where\n\nimport System.Environment\n\nmain = do\n    input &lt;- getContents\n    putStr (\"Input was: \" ++ (show input))\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1541687261, "post_id": 53209749, "comment_id": 93307463, "body": "Through pattern matching, so <code>f (DT mylist myint) = ...</code> with <code>...</code> an expression with <code>mylist</code> and <code>myint</code>."}, {"owner": {"reputation": 113, "user_id": 7100743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4359de379c78008b3651090e329874?s=128&d=identicon&r=PG&f=1", "display_name": "hellomatey27", "link": "https://stackoverflow.com/users/7100743/hellomatey27"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541687446, "post_id": 53209749, "comment_id": 93307591, "body": "Thanks, that format was all I needed!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541688768, "post_id": 53209749, "comment_id": 93308396, "body": "What is <code>List</code>? I assume it&#39;s something like <code>data List = ...</code> itself, but I&#39;m used to that word being used in a context like <code>data List a = Nil | Cons a (List a)</code>, so I keep wanting to read <code>DType</code> as a wrapper around a <code>List Int</code> value."}, {"owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "edited": false, "score": 1, "creation_date": 1541708130, "post_id": 53209749, "comment_id": 93318554, "body": "You said it is not a tuple but it is, in a sense. The type <code>DType</code> is essentially the same as <code>(List, Int)</code>, the difference being syntactic. The values of each type are of the form <code>DT xs n</code> and  <code>(xs, n)</code> respectively."}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 7100743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4359de379c78008b3651090e329874?s=128&d=identicon&r=PG&f=1", "display_name": "hellomatey27", "link": "https://stackoverflow.com/users/7100743/hellomatey27"}, "is_accepted": false, "score": 1, "last_activity_date": 1541687469, "creation_date": 1541687469, "answer_id": 53209831, "question_id": 53209749, "link": "https://stackoverflow.com/questions/53209749/how-to-interact-with-this-kind-of-datatype/53209831#53209831", "title": "How to interact with this kind of datatype", "body": "<p>Thanks to Willem above:</p>\n\n<p>Through pattern matching, so <code>f (DT mylist myint) = ...</code> with <code>...</code> an expression with mylist and myint</p>\n"}], "owner": {"reputation": 113, "user_id": 7100743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4359de379c78008b3651090e329874?s=128&d=identicon&r=PG&f=1", "display_name": "hellomatey27", "link": "https://stackoverflow.com/users/7100743/hellomatey27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542971822, "creation_date": 1541687187, "last_edit_date": 1542971822, "question_id": 53209749, "link": "https://stackoverflow.com/questions/53209749/how-to-interact-with-this-kind-of-datatype", "title": "How to interact with this kind of datatype", "body": "<p>I have a datatype which is defined as:</p>\n\n<pre><code>data DType = DT List Int\n</code></pre>\n\n<p>Since it's neither a tuple, a list, or anything else which looks like I'm used to in other languages, I'm a bit confused as to how I should interact with it. I'd very much appreciate a simple example.</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1541738565, "post_id": 53207766, "comment_id": 93327112, "body": "Presumably it is your installation, though it is hard to make a more precise diagnostic. You might find <a href=\"https://github.com/goldfirere/singletons/issues/147\" rel=\"nofollow noreferrer\">this discussion</a> relevant."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1541744477, "post_id": 53207766, "comment_id": 93328451, "body": "@duplode had the same feeling. Last time nuked all of it, reinstalled and it was stable again for 2 weeks... Anyway think I can close it and just start over"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541744517, "creation_date": 1541680138, "question_id": 53207766, "link": "https://stackoverflow.com/questions/53207766/haskell-cabal-network-simple-0-4-3-installation-issues", "title": "Haskell Cabal - network-simple-0.4.3 installation issues", "body": "<p>Had the issue Cabal showed errors before, but what I'd like to know: is there really something wrong with the package or is my installation fubar again. Can one of you help me out here?</p>\n\n<pre><code>MacBook-2:hs_level_0 administrator$ cabal install network-simple\nclang: warning: argument unused during compilation: '-nopie' [-Wunused-command-line-argument]\nResolving dependencies...\nConfiguring safe-exceptions-0.1.7.0...\nBuilding safe-exceptions-0.1.7.0...\nFailed to install safe-exceptions-0.1.7.0\nBuild log ( /Users/administrator/.cabal/logs/ghc-8.4.3/safe-exceptions-0.1.7.0-CwMBtoBr1y8CsvtCCUeprP.log ):\ncabal: Entering directory '/var/folders/81/50s00bl11pv7fn8dw4n0w03m0000gn/T/cabal-tmp-3554/safe-exceptions-0.1.7.0'\nConfiguring safe-exceptions-0.1.7.0...\nclang: warning: argument unused during compilation: '-nopie' [-Wunused-command-line-argument]\nPreprocessing library for safe-exceptions-0.1.7.0..\nBuilding library for safe-exceptions-0.1.7.0..\n[1 of 1] Compiling Control.Exception.Safe ( src/Control/Exception/Safe.hs, dist/build/Control/Exception/Safe.o )\n\nsrc/Control/Exception/Safe.hs:94:1: error:\n    Could not find module \u2018Control.Monad.Catch\u2019\n    There are files missing in the \u2018exceptions-0.10.0\u2019 package,\n    try running 'ghc-pkg check'.\n    Use -v to see a list of the files searched for.\n   |\n94 | import qualified Control.Monad.Catch as C\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nsrc/Control/Exception/Safe.hs:95:1: error:\n    Could not find module \u2018Control.Monad.Catch\u2019\n    There are files missing in the \u2018exceptions-0.10.0\u2019 package,\n    try running 'ghc-pkg check'.\n    Use -v to see a list of the files searched for.\n   |\n95 | import Control.Monad.Catch (Handler (..))\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\ncabal: Leaving directory '/var/folders/81/50s00bl11pv7fn8dw4n0w03m0000gn/T/cabal-tmp-3554/safe-exceptions-0.1.7.0'\ncabal: Error: some packages failed to install:\nnetwork-simple-0.4.3-Coj7l4Fv6BIGNsyIlRxnky depends on network-simple-0.4.3\nwhich failed to install.\nsafe-exceptions-0.1.7.0-CwMBtoBr1y8CsvtCCUeprP failed during the building\nphase. The except\n</code></pre>\n\n<p>ion was:\nExitFailure 1</p>\n"}, {"tags": ["parsing", "haskell", "operators"], "comments": [{"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "edited": false, "score": 0, "creation_date": 1541676869, "post_id": 53206866, "comment_id": 93301816, "body": "Would you like to do it with a parsing library like Parsec or just do it with vanilla Haskell?"}, {"owner": {"reputation": 53, "user_id": 10623312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axW6I.jpg?s=128&g=1", "display_name": "astrocurieux", "link": "https://stackoverflow.com/users/10623312/astrocurieux"}, "reply_to_user": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "edited": false, "score": 0, "creation_date": 1541677155, "post_id": 53206866, "comment_id": 93301987, "body": "I actually forgot to mention that I do not want to use Parsec"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 3, "creation_date": 1541677918, "post_id": 53206866, "comment_id": 93302379, "body": "List in Haskell cannot hold different type of element. like &#39;30&#39; is not a type of Char, so, it must be broken into &#39;3&#39; and &#39;0&#39; in order to store them in list, say [&#39;1&#39;, ...&#39;3&#39;, &#39;0&#39; ...]. The thing you need may be list of String, say [&quot;1&quot;, ... &quot;30&quot;, &quot;%&quot;..] right?"}, {"owner": {"reputation": 53, "user_id": 10623312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axW6I.jpg?s=128&g=1", "display_name": "astrocurieux", "link": "https://stackoverflow.com/users/10623312/astrocurieux"}, "edited": false, "score": 0, "creation_date": 1541678674, "post_id": 53206866, "comment_id": 93302739, "body": "yes it&#39;s exactly that, with the &#39;Words&#39; function my program works well, but I have to separate everything with spaces, it&#39;s very annoying ..."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 3, "creation_date": 1541679581, "post_id": 53206866, "comment_id": 93303213, "body": "What&#39;s wrong with parser libraries, it&#39;s the right tool for the job?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10623312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axW6I.jpg?s=128&g=1", "display_name": "astrocurieux", "link": "https://stackoverflow.com/users/10623312/astrocurieux"}, "edited": false, "score": 0, "creation_date": 1541686944, "post_id": 53208072, "comment_id": 93307246, "body": "first time I hear about &#39;pred&#39;."}, {"owner": {"reputation": 53, "user_id": 10623312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axW6I.jpg?s=128&g=1", "display_name": "astrocurieux", "link": "https://stackoverflow.com/users/10623312/astrocurieux"}, "edited": false, "score": 0, "creation_date": 1541687362, "post_id": 53208072, "comment_id": 93307534, "body": "thank you for your help, with the expresionToList function my problem is solved."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "reply_to_user": {"reputation": 53, "user_id": 10623312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axW6I.jpg?s=128&g=1", "display_name": "astrocurieux", "link": "https://stackoverflow.com/users/10623312/astrocurieux"}, "edited": false, "score": 0, "creation_date": 1542008471, "post_id": 53208072, "comment_id": 93399873, "body": "@astrocurieux <code>pred</code> function is defined in the where clause. It is not built-in function."}], "tags": [], "owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "is_accepted": true, "score": 4, "last_activity_date": 1541682154, "last_edit_date": 1541682154, "creation_date": 1541681253, "answer_id": 53208072, "question_id": 53206866, "link": "https://stackoverflow.com/questions/53206866/return-a-list-from-a-complex-string/53208072#53208072", "title": "return a list from a complex string", "body": "<p>As some users have pointed out, your returning type is <code>[String]</code> instead of <code>[Char]</code>. You can easily achieve this by the following:</p>\n\n<pre><code>import Data.Char\nimport Data.List\n\nexpresionToList :: String -&gt; [String]\nexpresionToList = groupBy readAsNumber\n  where readAsNumber c d = pred c &amp;&amp; pred d\n        pred x = isDigit x || x == '.'\n</code></pre>\n\n<ul>\n<li><p><code>pred</code> function returns True when its input is a digit or a dot, False otherwise</p></li>\n<li><p><code>readAsNumber</code> takes two returns True if both are a digit or a dot</p></li>\n<li>finally you group your string by <code>readAsNumber</code></li>\n</ul>\n"}], "owner": {"reputation": 53, "user_id": 10623312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axW6I.jpg?s=128&g=1", "display_name": "astrocurieux", "link": "https://stackoverflow.com/users/10623312/astrocurieux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 53208072, "answer_count": 1, "score": -1, "last_activity_date": 1541682154, "creation_date": 1541676597, "last_edit_date": 1541677212, "question_id": 53206866, "link": "https://stackoverflow.com/questions/53206866/return-a-list-from-a-complex-string", "title": "return a list from a complex string", "body": "<p>I start with haskell.</p>\n\n<p>I was wondering if I can convert a string to a list of different element's type like that : <code>\"1*30%4\" -&gt; ['1', '*', '30', '%', '4']</code> without Parsec</p>\n\n<p>I have already found answers but none really help me...\nlike <code>map (:[]) \"1*30%4\"</code>with GHCI\nor with the help of <code>intersperse</code>.</p>\n\n<p>but I do not know how to keep the right formats, I can not, for example, have numbers or float/double in my list because everything is cut one by one : <code>\"1*30%4\" -&gt; ['1', '*', '3', '0', '%', '4']</code> or <code>\"1*30.4%4\" -&gt; ['1', '*', '3', '0', '.', '4', '%', '4']</code> </p>\n\n<p>Someone can help me ? </p>\n"}, {"tags": ["parsing", "haskell", "parsec"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541671832, "post_id": 53204934, "comment_id": 93299162, "body": "The error states: &quot;Use FlexibleContexts to permit this&quot;. Your code is OK, but you need to enable the extension. (I&#39;d also add a type signature)"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10429975, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D-E2-UHsaOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWNBrMIBj8VPPmGT-WHLnDQWGC0Wg/mo/photo.jpg?sz=128", "display_name": "Yellowsgg", "link": "https://stackoverflow.com/users/10429975/yellowsgg"}, "edited": false, "score": 0, "creation_date": 1541672757, "post_id": 53205607, "comment_id": 93299661, "body": "Super! Thank you so much!"}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 2, "last_activity_date": 1541672133, "creation_date": 1541672133, "answer_id": 53205607, "question_id": 53204934, "link": "https://stackoverflow.com/questions/53204934/parsec-simple-parser-results-in-error-non-type-variable-argument-in-the-constra/53205607#53205607", "title": "Parsec simple parser results in error &quot;Non type-variable argument in the constraint: Stream s m Char&quot;", "body": "<p>Parsec parsers have rather complicated types due to their flexibility. You can get around this in two ways:</p>\n\n<ol>\n<li><p>Put <code>{-# Language FlexibleContexts #-}</code> at the top of your source file. This pragma tells GHC to do some extra type inference.</p></li>\n<li><p>(Recommended) Give char1 an explicit type.</p>\n\n<pre><code>char1 :: Char -&gt; Parsec String () Char   \nchar1 c = char c\n</code></pre></li>\n</ol>\n\n<p>This is recommended because you should always give any top-level declaration an explicit type. If you don't then all the compiler can tell you is that there is a type mismatch somewhere in your code (it will tell you where it found the contradiction, but that's not likely to be where the error is). With explicit type declarations the compiler can narrow it down.</p>\n\n<p>In this case, Parsec defines the <code>Parsec</code> type as</p>\n\n<pre><code>type Parsec s u = ParsecT s u Identity\n</code></pre>\n\n<p>You will recognise <code>ParsecT</code> from your error message. <code>ParsecT</code> is a monad transformer: it lets you have the parser do things in other monads (like IO) when it recognises the text. In this case we only want a parser, so we use the <code>Identity</code> monad, which does nothing.</p>\n\n<p>The <code>s</code> parameter is the stream of inputs. In this case we will say that the parser is taking its input from a <code>String</code>.</p>\n\n<p>The <code>u</code> parameter is a state. This allows you to do stuff like recording variable names in a symbol table as you encounter them. In this case we don't use a state so its just <code>()</code>.</p>\n\n<p>If you were writing a real parser then you would generally define your own type synonym, something like</p>\n\n<pre><code>type FooParser a = Parsec Text FooState a\n\nchar1 :: Char -&gt; FooParser Char\nchar1 = char\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10429975, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D-E2-UHsaOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWNBrMIBj8VPPmGT-WHLnDQWGC0Wg/mo/photo.jpg?sz=128", "display_name": "Yellowsgg", "link": "https://stackoverflow.com/users/10429975/yellowsgg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 53205607, "answer_count": 1, "score": 1, "last_activity_date": 1596902392, "creation_date": 1541669674, "last_edit_date": 1596902392, "question_id": 53204934, "link": "https://stackoverflow.com/questions/53204934/parsec-simple-parser-results-in-error-non-type-variable-argument-in-the-constra", "title": "Parsec simple parser results in error &quot;Non type-variable argument in the constraint: Stream s m Char&quot;", "body": "<p>Suppose I just want to create my own parser which is exactly the same with the <code>char</code> in Parsec, but when I run</p>\n\n<pre><code>import Text.Parsec\nchar1 c = char c\n</code></pre>\n\n<p>It gives me</p>\n\n<pre><code>? Non type-variable argument in the constraint: Stream s m Char\n  (Use FlexibleContexts to permit this)\n? When checking the inferred type\n    char1 :: forall s (m :: * -&gt; *) u.\n             Stream s m Char =&gt;\n             Char -&gt; ParsecT s u m Cha\n</code></pre>\n\n<p>How can I solve it? Is there any other imports that I should include? Thanks</p>\n"}, {"tags": ["parsing", "haskell", "monads", "do-notation"], "comments": [{"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1541656693, "post_id": 53202036, "comment_id": 93292760, "body": "do notation just be syntax sugar, de-sugar your case is: item &gt;&gt;= (\\c-&gt;if p c then return c else failParse). see: [link] (<a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/do_notation</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541666145, "post_id": 53202864, "comment_id": 93296089, "body": "@WillNess maybe you are right, the parameter c in (\\c-&gt;...) finally replace by the output of function inside item (i.e. pa in Parser pa). but if pa return Nothing, (\\c-&gt;...) will not be applied, so semantically, we can&#39;t say c == Nothing, as c never be replaced by Nothing.  So, I am not assign any meaning to (&lt;-), since the actual meaning must refers to definition of (&gt;&gt;=). But for accuracy, I shall delete the term &#39;extract nothing&#39; from my answer"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541668277, "post_id": 53202864, "comment_id": 93297137, "body": "Yes, so &lt;- eventually replaced by &gt;&gt;=, the expression below &lt;- become a function on the right-hand side of &gt;&gt;=, and c on the left of &lt;- become the parameter of the function. and so, what &lt;- do?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541668311, "post_id": 53202864, "comment_id": 93297162, "body": "&quot;extracts&quot; a value."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541669492, "post_id": 53202864, "comment_id": 93297818, "body": "Okay, fine. but I still prefer to translate &lt;- to &gt;&gt;= and see  how &gt;&gt;= defined on specific instance. It is accuracy and unambiguous."}], "tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 3, "last_activity_date": 1541666190, "last_edit_date": 1541666190, "creation_date": 1541660738, "answer_id": 53202864, "question_id": 53202036, "link": "https://stackoverflow.com/questions/53202036/how-does-the-haskell-do-notation-know-which-value-to-take-when-it-isnt-define/53202864#53202864", "title": "How does the Haskell `do` notation know which value to take when it isn&#39;t defined by a return?", "body": "<p>As comment mentioned, <code>&lt;-</code> just be <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"nofollow noreferrer\">do notation</a> syntax sugar and equivalent to:</p>\n\n<pre><code>item &gt;&gt;= (\\c-&gt;if p c \n              then return c \n              else failParse)\n</code></pre>\n\n<p>Okay, let see what is <code>c</code>? consider the definition of <code>(&gt;&gt;=)</code></p>\n\n<pre><code>(&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\n</code></pre>\n\n<p>or more readable way:</p>\n\n<pre><code>Parser a &gt;&gt;= (a -&gt; Parser b)\n</code></pre>\n\n<p>And Now, matches it with above expression <code>item &gt;&gt;= (\\c-&gt;if p c then return c else failParse)</code> give:</p>\n\n<pre><code>Parer a = item\n</code></pre>\n\n<p>and </p>\n\n<pre><code>(a-&gt;Parser b) = (\\c-&gt;if p c then return c else failParse) \n</code></pre>\n\n<p>and <code>item</code> has type:</p>\n\n<pre><code>item :: Parser Char\n</code></pre>\n\n<p>so, we can now replace <code>a</code> in <code>(&gt;&gt;=)</code> by Char, gives</p>\n\n<pre><code>Parser Char &gt;&gt;= (Char -&gt; Parser b)\n</code></pre>\n\n<p>and now <code>\\c-&gt;if p c then return c else failParse</code> also have type: <code>(Char -&gt; Parser b)</code></p>\n\n<p>and so <code>c</code> is a Char, and the whole expression can be extended to:</p>\n\n<pre><code>sat p =\nitem &gt;&gt;= (\\c-&gt;...) = \nParser pa &gt;= (\\c-&gt;...) = Parser $ \\input -&gt; case pa input of\n                                            Nothing -&gt; Nothing\n                                            Just (a,rest) -&gt; parse (f a) rest\n                         where f c =  if p c\n                                      then return c\n                                      else failParse\n                               pa input = case input of \"\"   -&gt; Nothing\n                                                       (h:t) -&gt; Just (h, t)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1603431312, "last_edit_date": 1603431312, "creation_date": 1541663951, "answer_id": 53203481, "question_id": 53202036, "link": "https://stackoverflow.com/questions/53202036/how-does-the-haskell-do-notation-know-which-value-to-take-when-it-isnt-define/53203481#53203481", "title": "How does the Haskell `do` notation know which value to take when it isn&#39;t defined by a return?", "body": "<p><em>TL;DR:</em> In general, by Monad laws,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>do { item }\n</code></pre>\n<p>is the same as</p>\n<pre class=\"lang-hs prettyprint-override\"><code>do { c &lt;- item\n   ; return c\n   }\n</code></pre>\n<p>so it <em>is</em> defined by a <code>return</code>, in a sense. Details follow.</p>\n<hr />\n<p>It does take one character out from the input string which is being <em>&quot;read&quot;</em>, so in this sense it <em>&quot;reads&quot;</em> that character:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>item :: Parser                                   Char\nitem = Parser $ \\ input -&gt;          -- input :: [Char]   \n             case input of { &quot;&quot;    -&gt; Nothing\n                           ; (h:t) -&gt; Just (h, t)  -- (h:t) :: [Char]\n                           }             -- h :: Char    t  :: [Char]\n</code></pre>\n<p>and I bet there's a definition</p>\n<pre class=\"lang-hs prettyprint-override\"><code>parse (Parser pa) input = pa input\n</code></pre>\n<p>defined there somewhere; so</p>\n<pre class=\"lang-hs prettyprint-override\"><code>parse item input = case input of { &quot;&quot;    -&gt; Nothing \n                                 ; (h:t) -&gt; Just (h, t) }\n</code></pre>\n<p>Next, what does <code>(&gt;&gt;=)</code> mean? It means that</p>\n<pre class=\"lang-hs prettyprint-override\"><code>parse (Parser pa &gt;&gt;= f) input = case (parse (Parser pa) input) of\n                     Nothing             -&gt; Nothing\n                     Just (a, leftovers) -&gt; parse (f a) leftovers\n</code></pre>\n<p>i.e.</p>\n<pre class=\"lang-hs prettyprint-override\"><code>parse (item      &gt;&gt;= f) input\n      = case (parse  item  input) of\n                     Nothing             -&gt; Nothing\n                     Just (a, leftovers) -&gt; parse (f a) leftovers\n      = case (case input of { &quot;&quot; -&gt; Nothing \n                            ; (h:t) -&gt; Just (h, t) \n                            }) of\n                     Nothing             -&gt; Nothing\n                     Just (a, leftovers) -&gt; parse (f a) leftovers\n      = case input of \n           &quot;&quot;    -&gt;                         Nothing \n           (h:t) -&gt; case Just (h, t) of {\n                         Just (a, leftovers) -&gt; parse (f a) leftovers }\n      = case input of \n           &quot;&quot;    -&gt; Nothing \n           (h:t) -&gt; parse (f h) t\n</code></pre>\n<p>Now,</p>\n<pre class=\"lang-hs prettyprint-override\"><code>-- sat p: a &quot;satisfies `p`&quot; parser \nsat :: (Char -&gt; Bool) -&gt; Parser Char\nsat p = do { c &lt;- item           -- sat p :: Parser Char\n           ; if p c              -- item  :: Parser Char,  c :: Char\n                then return c    -- return c  :: Parser Char\n                else failParse   -- failParse :: Parser Char\n           }\n      = item &gt;&gt;= (\\ c -&gt;\n                    if p c then return c else failParse)\n</code></pre>\n<p>(by unraveling the <code>do</code> syntax), and so</p>\n<pre class=\"lang-hs prettyprint-override\"><code>parse (sat p) input \n = parse (item &gt;&gt;= (\\ c -&gt;\n                    if p c then return c else failParse)) input\n   -- parse (item &gt;&gt;= f) input\n   --  = case input of { &quot;&quot; -&gt; Nothing ; (h:t) -&gt; parse (f h) t }\n = case input of \n       &quot;&quot;    -&gt; Nothing \n       (h:t) -&gt; parse ((\\ c -&gt; if p c then (return c)\n                                       else failParse) h) t\n = case input of \n       &quot;&quot;    -&gt; Nothing \n       (c:t) -&gt; parse (if p c then (return c) \n                               else failParse) t\n = case input of \n       &quot;&quot;    -&gt; Nothing \n       (c:t) -&gt; if p c then parse (return c) t\n                               else parse failParse t\n = case input of \n       &quot;&quot;    -&gt; Nothing \n       (c:t) -&gt; if p c then Just (c, t)\n                               else Nothing\n</code></pre>\n<p>Now the meaning of <code>sat p</code> should be clear: for <code>c</code> produced by <code>item</code> (which is the first character in the input, if input is non-empty), if <code>p c</code> holds, <code>c</code> is accepted and the parse succeeds, otherwise the parse fails:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>sat p = for c from item:                 -- do { c &lt;- item \n           if p c                        --    ; if p c\n                then return c            --        then return c \n                else failParse           --        else failParse }\n</code></pre>\n"}], "owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 1, "accepted_answer_id": 53202864, "answer_count": 2, "score": 4, "last_activity_date": 1603431312, "creation_date": 1541655127, "last_edit_date": 1582444399, "question_id": 53202036, "link": "https://stackoverflow.com/questions/53202036/how-does-the-haskell-do-notation-know-which-value-to-take-when-it-isnt-define", "title": "How does the Haskell `do` notation know which value to take when it isn&#39;t defined by a return?", "body": "<p>I have this monadic object.</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Parser a = Parser (String -&gt; Maybe (a, String))\n\ninstance Functor Parser where\n  -- fmap :: (a -&gt; b) -&gt; Parser a -&gt; Parser b\n  fmap f (Parser pa) =  Parser $ \\input -&gt; case pa input of\n                                             Nothing -&gt; Nothing\n                                             Just (a, rest) -&gt; Just (f a, rest)\n\ninstance Applicative Parser where\n  pure = return\n  (&lt;*&gt;) = ap\n\ninstance Monad Parser where\n  --return :: a -&gt; Parser a\n  return a =  Parser $ \\input -&gt; Just (a, input)\n\n  --(&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\n  (Parser pa) &gt;&gt;= f  = Parser $ \\input -&gt; case pa input of\n                                            Nothing -&gt; Nothing\n                                            Just (a,rest) -&gt; parse (f a) rest\n</code></pre>\n\n<p>And I have this definition of an <code>item</code> which I am told \"reads in a character\" but I don't really see any reading going on.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>item :: Parser Char\nitem = Parser $ \\ input -&gt; case input of \"\"    -&gt; Nothing\n                                         (h:t) -&gt; Just (h, t)\n</code></pre>\n\n<p>But ok, fine, maybe I should just relax about how literal to take the word \"read\" and jibe with it.  Moving on, I have </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>failParse :: Parser a\nfailParse = Parser $ \\ input -&gt; Nothing\n\nsat :: (Char -&gt; Bool) -&gt; Parser Char\nsat p = do c &lt;- item\n           if p c\n           then return c\n           else failParse\n</code></pre>\n\n<p>And this is where I get pretty confused.  What is getting stored in the variable <code>c</code>?  Since <code>item</code> is a <code>Parser</code> with parameter <code>Char</code>, my first guess is that <code>c</code> is storing such an object.  But after a second of thought I know that's not now the <code>do</code> notation works, you don't get the monad, you get the contents of the monad.  Great, but then that tells me <code>c</code> is then the function </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\\ input -&gt; case input of \"\"    -&gt; Nothing\n                         (h:t) -&gt; Just (h, t)\n</code></pre>\n\n<p>But clearly that's wrong since the next line of the definition of <code>sat</code> treats <code>c</code> like a character.  Not only is that not what I expect, but it's about three levels of structure down from what I expected!  It's not the function, it's not the <code>Maybe</code> object, and it's not the tuple, but it's the left coordinate of the <code>Just</code> tuple buried inside the function!  How is that little character working all that way outside?  What is instructing the <code>&lt;-</code> to extract this part of the monad?</p>\n"}, {"tags": ["performance", "haskell", "recursion", "towers-of-hanoi"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1541639478, "post_id": 53200042, "comment_id": 93288942, "body": "This version is tail-recursive, which might make it more efficient, yeah. To know for sure, you could try benchmarking it with <a href=\"http://hackage.haskell.org/package/criterion\" rel=\"nofollow noreferrer\">criterion</a> or examining the optimised GHC Core output with <code>-O2 -ddump-simpl</code> (with <code>-dsuppress-uniques -dsuppress-module-prefixes</code> to make it more readable)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1541671659, "post_id": 53200042, "comment_id": 93299062, "body": "The solution you posted is, essentially, the standard recursive solution except that it uses <a href=\"https://hackage.haskell.org/package/dlist-0.8.0.5/docs/Data-DList.html\" rel=\"nofollow noreferrer\">difference lists</a> instead of regular ones. Difference lists admit a faster concatenation, which you exploit to gain performance."}, {"owner": {"reputation": 75, "user_id": 2535251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3poq3.jpg?s=128&g=1", "display_name": "Marco_O", "link": "https://stackoverflow.com/users/2535251/marco-o"}, "edited": false, "score": 0, "creation_date": 1541675996, "post_id": 53200042, "comment_id": 93301282, "body": "Funny that you mention that, because it&#39;s the next homework assignment in the Haskell tutorial that I&#39;m following, which you may be familiar with. Perhaps it&#39;s meant to tell me that, when I learn something new, I should apply it to the previous exercise to improve it. Thank you Jon Purdy for criterion too."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1541680125, "post_id": 53200042, "comment_id": 93303484, "body": "@JonPurdy No, this is not tail-recursive. There is one recursive call in tail position (good), but there&#39;s also another one which is not in tail position. Perhaps you missed the second call."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541688521, "post_id": 53200042, "comment_id": 93308255, "body": "@chi yes, syntactically it is a <i>nested</i> recursion, but really because of Haskell&#39;s laziness it&#39;s <i>not</i> a double recursion like e.g. Fibonacci (where the nested call is forced by the strict <code>+</code>) but a guarded recursion (for the 2nd argument) -- the call is delayed (and not because of the <code>:</code>, but just because of the laziness). so it is very much like <i>tail</i> recursive tree traversal with explicit stack of &quot;do-next&quot; notes (either functions, or just the previously visited tree nodes themselves). when the leaf is reached the next action is called in tail position too."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541689173, "post_id": 53200042, "comment_id": 93308625, "body": "@WillNess I completely agree. I still think it&#39;s not entirely correct to call it tail recursion. A key point is that, because of laziness, tail recursion is not that important. E.g. <code>map f (x:xs)=f x:map f xs</code> is not tail recursive, but it&#39;s much better than its tail recursive variant (and it works on infinite lists, too!)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541689313, "post_id": 53200042, "comment_id": 93308726, "body": "@chi (obligatory mention of <a href=\"https://stackoverflow.com/a/13879693/849891\">this canonical DL answer</a> by Daniel Fischer and also <a href=\"https://stackoverflow.com/a/14942678/849891\">this (my answer)</a> which is also somewhat relevant). DL is efficient because it is like a tree traversal. (and a very interesting - and very related - historical code from John McCarthy linked from <a href=\"https://stackoverflow.com/a/43945275/849891\">this</a> another answer of mine). ---- although in <code>map</code> it is guarded by an explicitly lazy <i>data constructor</i> - what <i>is</i> usually referred to as &quot;guarded&quot; recursion."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541690021, "post_id": 53200042, "comment_id": 93309166, "body": "@chi shall we say, it builds guarded-recursive calls in a tail-recursive fashion. :)"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 2535251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3poq3.jpg?s=128&g=1", "display_name": "Marco_O", "link": "https://stackoverflow.com/users/2535251/marco-o"}, "edited": false, "score": 0, "creation_date": 1541640365, "post_id": 53200235, "comment_id": 93289145, "body": "Strange, I thought that, since you had an empty list as an argument of &quot;hanoiToList&quot;, you had to put something in its place (&#39;l&#39; in my case), so that it matched. Is this correct?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 75, "user_id": 2535251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3poq3.jpg?s=128&g=1", "display_name": "Marco_O", "link": "https://stackoverflow.com/users/2535251/marco-o"}, "edited": false, "score": 0, "creation_date": 1541644416, "post_id": 53200235, "comment_id": 93290057, "body": "@Marco_O nah. Functions are values that can be returned from other functions. If you never inspect an argument, it&#39;s often possible to never even name it."}, {"owner": {"reputation": 75, "user_id": 2535251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3poq3.jpg?s=128&g=1", "display_name": "Marco_O", "link": "https://stackoverflow.com/users/2535251/marco-o"}, "edited": false, "score": 0, "creation_date": 1541668585, "post_id": 53200235, "comment_id": 93297315, "body": "Thank you! I noticed something that was off about my code. I&#39;m going to edit it to show you the changes."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 75, "user_id": 2535251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3poq3.jpg?s=128&g=1", "display_name": "Marco_O", "link": "https://stackoverflow.com/users/2535251/marco-o"}, "edited": false, "score": 1, "creation_date": 1541690469, "post_id": 53200235, "comment_id": 93309427, "body": "@Marco_O <code>hanoiToList 0 _ _ _ l = l</code> === <code>hanoiToList 0 _ _ _ = \\l -&gt; l</code> === <code>hanoiToList 0 _ _ _ = id</code>. it&#39;s the same thing. So even if you have <code>hanoiToList n a b c []</code> as your top call, what&#39;s being matched in the definition is <code>hanoiToList n a b c</code>, which is evaluated, returns a function, and that function gets applied to <code>[]</code>. looks different, but is the same."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 3, "last_activity_date": 1541681462, "last_edit_date": 1541681462, "creation_date": 1541639778, "answer_id": 53200235, "question_id": 53200042, "link": "https://stackoverflow.com/questions/53200042/is-this-haskell-tower-of-hanoi-solution-more-efficient-or-simply-redundant/53200235#53200235", "title": "Is this Haskell Tower of Hanoi solution more efficient or simply redundant?", "body": "<p>Yep, that gets rid of the inefficient copying of <code>(:)</code> constructors. It's a slightly non-idiomatic way to write it, but the more idiomatic way should have identical performance when compiled with optimizations.</p>\n\n<pre><code>hanoi n a b c = hanoiToList n a b c []\n  where\n    hanoiToList 0 _ _ _ = id\n    hanoiToList n a b c = hanoiToList (n-1) a c b . ((a, b) :) . hanoiToList (n-1) c b a\n</code></pre>\n\n<p>That's the slightly more idiomatic approach. It's all about emphasizing the viewpoint that you're building up a transformation of a value.  In practice it's identical as long as function composition is being inlined and simplified as expected. </p>\n"}], "owner": {"reputation": 75, "user_id": 2535251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3poq3.jpg?s=128&g=1", "display_name": "Marco_O", "link": "https://stackoverflow.com/users/2535251/marco-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 1, "accepted_answer_id": 53200235, "answer_count": 1, "score": 1, "last_activity_date": 1541681462, "creation_date": 1541637965, "last_edit_date": 1541668673, "question_id": 53200042, "link": "https://stackoverflow.com/questions/53200042/is-this-haskell-tower-of-hanoi-solution-more-efficient-or-simply-redundant", "title": "Is this Haskell Tower of Hanoi solution more efficient or simply redundant?", "body": "<p><a href=\"https://stackoverflow.com/a/27644446/2535251\">This</a> Haskell solution has been described as recursive, but not quite efficient according to a few claims, so I have tried to rewrite it with that in mind. The problem is described in a course that is available online and whose homework was the <a href=\"https://www.seas.upenn.edu/~cis194/spring13/hw/01-intro.pdf\" rel=\"nofollow noreferrer\">Tower of Hanoi</a>.</p>\n\n<p>A new solution of mine:</p>\n\n<pre><code>type Peg = String\ntype Move = (Peg, Peg)\n\nhanoi :: Integer -&gt; Peg -&gt; Peg -&gt; Peg -&gt; [Move]\n\nhanoi n a b c = hanoiToList n a b c []\n  where\n    hanoiToList 0 _ _ _ l = l\n    -- hanoiToList 1 a b _ l = (a, b) : l\n    hanoiToList n a b c l = hanoiToList (n-1) a c b ((a, b) : hanoiToList (n-1) c b a l)\n</code></pre>\n\n<hr>\n\n<p>Let me explain the reasoning: if the function is going to end up as a list, then you had better compare it to another that takes an empty one as an argument, otherwise append it after it has been solved, which I believe to be the cause of inefficiency, thus leading to the same function being called in its place. The result has been checked and it's correct, but I wanted to know whether this is more efficient or simply redundant, considering the previous solution that I linked to. </p>\n\n<p>EDIT: I commented a line that was unnecessary.</p>\n"}]