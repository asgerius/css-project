[{"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1459988528, "post_id": 36463988, "comment_id": 60540714, "body": "I like the reasoning you&#39;ve shown here! A proposal for how to make progress: consider using this style of reasoning to figure out what <code>runReader (ask &gt;&gt;= f) x</code> does. This gives you a name (specifically, <code>x</code>) for the &quot;hidden&quot; bit that you can track and see where it ends up."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1459988831, "post_id": 36463988, "comment_id": 60540798, "body": "Ok, I consider it tomorrow. However, Could you give answer for this problem - for safety. When it comes to operator <code>&lt;-</code> in terms of do section. it use runReader ?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1459994761, "post_id": 36463988, "comment_id": 60542331, "body": "No, <code>do</code> notation never produces new uses of <code>runReader</code> -- but using the results of a <code>do</code> notation block defining a <code>Reader</code> action requires its use."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 5, "last_activity_date": 1460003451, "creation_date": 1460003451, "answer_id": 36466726, "question_id": 36463988, "link": "https://stackoverflow.com/questions/36463988/haskell-why-ask-retrieves-enviroment-from-reader-monad/36466726#36466726", "title": "haskell - why ask retrieves enviroment from Reader monad", "body": "<p>I think the main point is, that there is really <em>nothing</em> hidden inside <code>Reader</code> - instead it's a function - and your <em>hidden</em> value enters the stage when you <em>run</em> the reader (this is when <strong>you</strong> show your hidden value to the reader and let it evaluate to some output).</p>\n\n<h2>revisiting the definition</h2>\n\n<p>Well let's simplify things a bit and assume that the structure for our <code>Reader</code> Monad is defined as this:</p>\n\n<pre><code>data Reader h a = Reader { run :: h -&gt; a }\n</code></pre>\n\n<p>that means you <em>hidden</em> value will have some type <code>h</code> and the <code>Reader</code> is just a function that produces some other value (of type <code>a</code>) from when presented with such a value.</p>\n\n<p>As you can see there is no value hidden at all - you have to provide it yourself when <em>running</em> the <code>Reader</code> with <code>run</code></p>\n\n<p>Here is an example:</p>\n\n<pre><code>showInt :: Reader Int String\nshowInt = Reader show\n</code></pre>\n\n<p>you'll use it like</p>\n\n<pre><code>\u03bb&gt; run showInt 5\n\"5\" -- has type :: String\n</code></pre>\n\n<h2>make it a Monad</h2>\n\n<p>the Monad instance is basically this (you'll have to provide instances for <code>Applicative</code> and <code>Functor</code> too, which I'll skip)</p>\n\n<pre><code>instance Monad (Reader h) where \n    return v =\n      Reader (const v)\n    r &gt;&gt;= f  = Reader $ \\ h -&gt;\n      let v = run r h\n          r' = f v\n      in run r' h\n</code></pre>\n\n<p>notice how again you wait till someone provides you with a <code>h</code> (by calling <code>run</code>) and then:</p>\n\n<ul>\n<li>first get the value <code>v</code> out of the reader using <code>run r h</code></li>\n<li>use this <code>v</code> to get another reader <code>f'</code></li>\n<li>finally get the value of this reader by running it with <strong>the same</strong> <code>h</code>: <code>run r' h</code></li>\n</ul>\n\n<h2>what is <code>ask</code></h2>\n\n<p>well as you said: it's just the reader using <code>id</code> - it will reproduce the given value when run:</p>\n\n<pre><code>ask :: Reader h h\nask = Reader id\n</code></pre>\n\n<h2>your question</h2>\n\n<p>now we can finally deal with the question:</p>\n\n<p>what happens if we run</p>\n\n<pre><code>let r = ask &gt;&gt;= (\\x -&gt; return x) \n</code></pre>\n\n<p>well let's stick a \"Hello\" in:</p>\n\n<pre><code>run r \"Hello\"\n{ def r }\n= run (ask &gt;&gt;= return) \"Hello\"\n{ def &gt;&gt;= }\n= run (\\h -&gt;\n   let v  = run ask h\n       r' = return v\n   in run r' h) \"Hello\"\n{ def run: plug \"Hello\" into h }\n = let v  = run ask \"Hello\"\n       r' = return v\n   in run r' \"Hello\"\n{ ask = Reader id - so run ask \"Hello\" = \"Hello\" -&gt; v = \"Hello\" }\n= let r' = return \"Hello\"\n  in run r' \"Hello\"\n{ simplify }\n= run (return \"Hello\") \"Hello\"\n{ r' = const \"Hello\" = \\ _ -&gt; \"Hello\" }\n= (\\ _ -&gt; \"Hello\") \"Hello\"\n{ apply }\n= \"Hello\"\n</code></pre>\n\n<h2>laws</h2>\n\n<p>By the way: it's a good thing that it worked out that way, because one of the monad-laws (which should hold but are not enforced by Haskell) states:</p>\n\n<pre><code>m &gt;&gt;= return == m\n</code></pre>\n\n<p>which means here, that your reader <code>ask &gt;&gt;= return == ask</code></p>\n\n<p>which would have made all this a bit easier ;)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 36466726, "answer_count": 1, "score": 2, "last_activity_date": 1460003451, "creation_date": 1459984662, "last_edit_date": 1460001815, "question_id": 36463988, "link": "https://stackoverflow.com/questions/36463988/haskell-why-ask-retrieves-enviroment-from-reader-monad", "title": "haskell - why ask retrieves enviroment from Reader monad", "body": "<p>I can't understand this:  </p>\n\n<p>Assuming <code>t</code> is <em>hidden</em> inside a Reader Monad.  </p>\n\n<p>I can get to it using <code>ask</code>:  </p>\n\n<pre><code>do\n   x &lt;- ask\n   ...\n</code></pre>\n\n<p>which <em>unpacks</em>  the hidden value into <code>x</code>   </p>\n\n<p>Now I'm trying to understand what <code>&gt;&gt;=</code> will do but I struggle with it.</p>\n\n<p>Can you explain that to me?</p>\n\n<hr>\n\n<p>Here, is my attempt:  </p>\n\n<pre><code>f = \\x -&gt; x  \n\nask &gt;&gt;= (\\x -&gt; return x) \n= Reader $ \\r -&gt; f (ask (r))  r \n{ using the fact that ask is identity }\n= Reader $ \\r -&gt; f(r) r \n</code></pre>\n\n<p>However, I don't see how this get's to the <em>hidden</em>  value</p>\n"}, {"tags": ["list", "haskell", "tail"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6079242, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/866e1ad926011e12fccc371a1f76ded5?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil Gautam", "link": "https://stackoverflow.com/users/6079242/sunil-gautam"}, "edited": false, "score": 0, "creation_date": 1459986634, "post_id": 36463907, "comment_id": 60540228, "body": "thanks.. i solved it anyways but has 5 lines of code.. your one is so simple.. thanks man"}], "tags": [], "owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "is_accepted": false, "score": 1, "last_activity_date": 1459984191, "creation_date": 1459984191, "answer_id": 36463907, "question_id": 36463398, "link": "https://stackoverflow.com/questions/36463398/haskell-recursion-of-tail-function/36463907#36463907", "title": "Haskell recursion of tail function", "body": "<p>It looks like you want <code>map (func2 3.0) (tails list)</code>.</p>\n"}], "owner": {"reputation": 39, "user_id": 6079242, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/866e1ad926011e12fccc371a1f76ded5?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil Gautam", "link": "https://stackoverflow.com/users/6079242/sunil-gautam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459997866, "creation_date": 1459981477, "last_edit_date": 1459997866, "question_id": 36463398, "link": "https://stackoverflow.com/questions/36463398/haskell-recursion-of-tail-function", "title": "Haskell recursion of tail function", "body": "<p>I have this function</p>\n\n<pre><code>func1 :: Double -&gt; [(Double,Double)] -&gt; Maybe [(Double,Double)]\n...............\nfunc2 :: Double -&gt; [(Double,Double)] -&gt; [(Double,Double)]\nfunc2 d [] =  []\nfunc2 d list = \n  let dsegs1 = func1 d list\n      dsegs2 = func2 d (tail list)\n  in  fromJust dsegs1 ++ dsegs2\n</code></pre>\n\n<p>The simple flow I would like to achieve in <code>func2</code> is as follows:</p>\n\n<pre><code>let x = func2 3.0 list\nlet y = func2 3.0 (tail list)\nlet z = func2 3.0 (tail (tail list))\nlet a = func2 3.0 (tail (tail (tail list)))\n</code></pre>\n\n<p>call <code>func2</code> <em>n</em> times until it returns nothing at the end and concat <code>x</code>,<code>y</code>,<code>z</code>,..., <code>a</code>.</p>\n\n<p>How would I do that? </p>\n"}, {"tags": ["user-interface", "haskell", "wxwidgets", "wxhaskell"], "answers": [{"tags": [], "owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "is_accepted": true, "score": 1, "last_activity_date": 1460019251, "creation_date": 1460019251, "answer_id": 36471230, "question_id": 36461112, "link": "https://stackoverflow.com/questions/36461112/wxhaskell-the-window-appears-too-tiny/36471230#36471230", "title": "wxHaskell : the window appears too tiny", "body": "<p>Setting a minimum size instead of the client size</p>\n\n<pre><code>set f [ layout := minsize (sz 300 300) $ widget sw ]\n</code></pre>\n\n<p>works for me.</p>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 36471230, "answer_count": 1, "score": 1, "last_activity_date": 1460019251, "creation_date": 1459972465, "question_id": 36461112, "link": "https://stackoverflow.com/questions/36461112/wxhaskell-the-window-appears-too-tiny", "title": "wxHaskell : the window appears too tiny", "body": "<p>I have a little program in haskell, using wxhaskell. It displays a window with a panel inside, containing some drawings. The problem is that the window shrinks to a very tiny size, and I have to expand it with the mouse.</p>\n\n<p>How can I define correctly the size?</p>\n\n<p>here is my program:</p>\n\n<pre><code>module Main where\nimport Graphics.UI.WX\nimport Graphics.UI.WXCore\n\nmain :: IO ()\nmain\n  = start hello\n\nhello :: IO ()\nhello = do \n        f    &lt;- frame    [text := \"HELLO!\"]\n        sw &lt;- panel f [ on paint := onpaint]\n        set f   [clientSize  := sz 300 300,\n                layout := fill $ widget sw]\n        return()\n\n    where \n        onpaint dc pnel = do \n            circle dc (pt 200 200) 20 [penKind := PenDash DashDot]\n            drawPoint dc (pt 200 200) []\n</code></pre>\n\n<p>thank you.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1459971659, "post_id": 36460833, "comment_id": 60533561, "body": "yes that&#39;s a common complaint - it&#39;s because of the way <code>Foldable</code> works with only the last part of the tuple and the fact that there is a <code>Foldable</code> instance for <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Foldable.html#t:Foldable\" rel=\"nofollow noreferrer\">2-tuples</a> and only for those - I recommend you just take it as is - if you want you can find plenty of discussions around this - here is an <a href=\"https://mail.haskell.org/pipermail/libraries/2016-February/026701.html\" rel=\"nofollow noreferrer\">example: Haskell Foldable Wats</a>"}, {"owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459972315, "post_id": 36460833, "comment_id": 60533919, "body": "Even more confusion <a href=\"https://mail.haskell.org/pipermail/libraries/2016-February/026706.html\" rel=\"nofollow noreferrer\">awaits me here</a>! I haven&#39;t seen this coming."}, {"owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459972394, "post_id": 36460833, "comment_id": 60533970, "body": "And <a href=\"https://mail.haskell.org/pipermail/libraries/2016-February/026734.html\" rel=\"nofollow noreferrer\">some empathy for my poor mind</a>. But still, confusion persists :("}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1459972819, "post_id": 36460833, "comment_id": 60534216, "body": "<a href=\"http://stackoverflow.com/questions/36113469/why-is-tolist-1-2-2/36113707#36113707\">Related question</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 2, "creation_date": 1459973471, "post_id": 36461185, "comment_id": 60534573, "body": "I&#39;m trying to interpret what you wrote by also examining the fact that <code>minimum (1, 2)</code> returns <code>2</code>,  <code>minimum (2,1)</code> returns <code>1</code>, and <code>minimum (&#39;c&#39;, 2)</code> returns <code>2</code>."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 0, "creation_date": 1459973731, "post_id": 36461185, "comment_id": 60534742, "body": "@Emre Sevin&#231; When you have a tuple of numbers, it is often the case that they are semantically different, even if the types are equal... Some integer paired with the number of times it appears somewhere, for example. If the numbers are semantically equal, they should better be in a &quot;uniform&quot; container like a list or a vector."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 0, "creation_date": 1459974000, "post_id": 36461185, "comment_id": 60534912, "body": "@EmreSevin&#231; I wonder what you would expect <code>minimum (&#39;c&#39;, 2)</code> to return."}, {"owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 0, "creation_date": 1459974045, "post_id": 36461185, "comment_id": 60534941, "body": "Just to make things clear, I&#39;m not trying to use a tuple where using a list makes much more sense. All I&#39;m trying to understand is: what&#39;s happening behind-the-scenes when functions such as <code>length</code> and <code>minimum</code> are applied to 2-tuples, 3-tuples, etc."}, {"owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 0, "creation_date": 1459974233, "post_id": 36461185, "comment_id": 60535053, "body": "Daniel, for <code>minimum (&#39;c&#39;, 2)</code>, I can&#39;t say anything right now, but for <code>length (1, 1)</code> my initial reaction would be: It should not work, (1, 1) is not a list, <code>length</code> is for lists. But after reading same things again and again, and obviously looking at the fact that <code>length</code> is defined for <code>Foldable</code>, it is obvious that I have to learn much more about <code>Foldable</code> to really understand the answers given so far."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 3, "creation_date": 1459975084, "post_id": 36461185, "comment_id": 60535513, "body": "@EmreSevin&#231; <code>Foldable</code> is basically the &quot;convertible into list&quot; typeclass. All its operations could be performed with the same results on the list obtained from the <code>Foldable</code> value using <code>toList</code>. They are defined directly in <code>Foldable</code> for efficiency reasons (for example, if a container keeps track of its own length, that is more efficient that traversing the full length of the list).  Also, if a container has more than one type parameter (like 2-tuples do,  and maps) for the purposes of <code>Foldable</code> its &quot;element type&quot; will always be its last parameter."}, {"owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 0, "creation_date": 1459975335, "post_id": 36461185, "comment_id": 60535673, "body": "Checking <a href=\"http://stackoverflow.com/a/36113707/236007\">this answer</a> shared above by the author, and seeing that in <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Foldable.html\" rel=\"nofollow noreferrer\">Data.Foldable</a>  <code>Foldable ((,) a)</code> instance has a function such as <code>toList :: (a, b) -&gt; [b]</code>, my current understanding is that, somehow, a 2-tuple is converted to a list that has the tuple&#39;s last item, and in turn, functions such as <code>length</code> and <code>minimum</code> is applied to that list. This seems to answer &quot;how?&quot;. The &quot;why?&quot; is still not clear for me (and apparently there&#39;s some controversy (?))"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 0, "creation_date": 1459975477, "post_id": 36461185, "comment_id": 60535752, "body": "@Emre Sevin&#231; It&#39;s more a question of &quot;why not?&quot; than &quot;why?&quot;."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 1, "creation_date": 1459982016, "post_id": 36461185, "comment_id": 60538844, "body": "@EmreSevin&#231; do you mean \u201cwhy does <code>toList</code> only use the second element\u201d (I think I&#39;ve explained that in the linked post), or \u201cwhy does <code>length</code> operate on the list generated by the <code>Foldable</code> instance\u201d \u2013 that is basically a matter of necessity, to keep the semantics consistent. For instance, you might want to compute the <i>average</i> of all numbers in some container. If you do this as <code>sum xs &#47; length xs</code>, but the sum only goes over one element yet the length is two, you get a complete garbage result. (Admittedly, that would be a rather na&#239;ve thing to do, anyway.)"}, {"owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460013360, "post_id": 36461185, "comment_id": 60549248, "body": "@leftaroundabout my &quot;why&quot; was more like &quot;why make a design / naming decision that leads to such a great confusion&quot;. I mean something <a href=\"https://www.reddit.com/r/haskell/comments/3okick/foldable_for_nonhaskellers_haskells_controversial/cvzgvex\" rel=\"nofollow noreferrer\">like that</a>. I think I&#39;ll need to read <a href=\"http://tojans.me/blog/2015/10/13/foldable-for-non-haskellers-haskells-controversial-ftp-proposal/\" rel=\"nofollow noreferrer\">this</a> and <a href=\"http://bitemyapp.com/posts/2015-10-19-either-is-not-arbitrary.html\" rel=\"nofollow noreferrer\">this</a> to understand it better."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1460028078, "post_id": 36461185, "comment_id": 60559515, "body": "Yeah. I think it <i>would</i> have been better to never give <code>(a,)</code> a <code>Foldable</code> instance,"}, {"owner": {"reputation": 917, "user_id": 1667423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3ff1fb6d7b142bca9bb38ec7abd66184?s=128&d=identicon&r=PG", "display_name": "user76284", "link": "https://stackoverflow.com/users/1667423/user76284"}, "edited": false, "score": 2, "creation_date": 1511228906, "post_id": 36461185, "comment_id": 81761631, "body": "&quot;If a type can be made an instance of a typeclass in a well defined, lawful way, it should have that instance. Even if it doesn&#39;t seem very useful and, in some cases, may be confusing.&quot;  I completely disagree with this. What makes you think this is a good idea?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 917, "user_id": 1667423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3ff1fb6d7b142bca9bb38ec7abd66184?s=128&d=identicon&r=PG", "display_name": "user76284", "link": "https://stackoverflow.com/users/1667423/user76284"}, "edited": false, "score": 0, "creation_date": 1511290746, "post_id": 36461185, "comment_id": 81795514, "body": "@user76284 This is highly subjective, but I would dislike the lack of uniformity in how some types are deemed worthy of instances and others not, when they could have them just as well. Someone somewhere might need them, why force an orphan instance upon him? Less subjectively, the more instances a type has the more code you can potentially get &quot;for free&quot; when composing types. The composition of two Foldable functors is Foldable for example. Opting out by defining your own tuple-like type is relatively easy as well, I often do it for folds with complex accumulators to make code more legible."}, {"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "edited": false, "score": 0, "creation_date": 1512803610, "post_id": 36461185, "comment_id": 82413031, "body": "I have a, I think fairly important, follow up question. In what situations, if any, is it useful to have a Foldable instance for <code>(a,)</code>? Can someone give me a small and concrete(!) example?"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 26, "last_activity_date": 1459977704, "last_edit_date": 1459977704, "creation_date": 1459972760, "answer_id": 36461185, "question_id": 36460833, "link": "https://stackoverflow.com/questions/36460833/why-does-length-return-1-for-a-tuple-with-2-elements-and-gives-an-error-for-a-t/36461185#36461185", "title": "Why does length return 1 for a tuple with 2 elements, and gives an error for a tuple with more elements?", "body": "<p>You have encountered a Haskell <em>cause c\u00e9l\u00e8bre</em> that has sparked much discussion and gnashing of teeth.</p>\n\n<p>Basically, for the purposes of <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Foldable.html\"><code>Foldable</code></a> (the typeclass that provides <code>length</code>), 2-tuples are not considered a container of two elements, but a container of <em>one</em> element accompanied by some context.</p>\n\n<p>You can extract a list of elements of type <code>a</code> from any <code>Foldable a</code>. Notice that for 2-tuples the type variable of the <code>Foldable</code> is that of the <em>second</em> element of the tuple, and it can be different from the type of the first element.</p>\n\n<p>If you had a <code>('c',2) :: (Char,Int)</code> tuple, it would be no mystery that you couldn't extract two <code>Int</code>s in that case! But when the types are equal it becomes confusing.</p>\n\n<p>As for why <code>length (1::Int, 1::Int, 1::Int)</code> fails, 3-tuples don't have a <code>Foldable</code> instance defined, but perhaps they should have one, for consistency. 3-tuples would also have length 1.</p>\n\n<p>By the way, the <code>Identity</code> functor, that could be considered a kind of 1-tuple, is also <code>Foldable</code> and of course has length 1 as well.</p>\n\n<p>Should the <code>Foldable</code> instance for tuples exist <em>at all</em>? I think the underlying philosophy in favor of yes is one of, shall we call it, \"plenitude\". If a type can be made an instance of a typeclass in a well defined, lawful way, <em>it should have that instance</em>. Even if it doesn't seem very useful and, in some cases, may be confusing.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 13, "last_activity_date": 1459975518, "last_edit_date": 1459975518, "creation_date": 1459975113, "answer_id": 36461880, "question_id": 36460833, "link": "https://stackoverflow.com/questions/36460833/why-does-length-return-1-for-a-tuple-with-2-elements-and-gives-an-error-for-a-t/36461880#36461880", "title": "Why does length return 1 for a tuple with 2 elements, and gives an error for a tuple with more elements?", "body": "<p>I like danidiaz's answer because it provides the high-level intuition about how the <code>Foldable</code> instance for tuples works and what it intuitively means. However it seems there is still some confusion about the mechanics of it; so in this answer I will focus on the \"behind-the-scenes\" bits. The full text of the <code>Foldable</code> instance in question is <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/src/Data.Foldable.html#line-252\" rel=\"noreferrer\">available online</a> and looks like this:</p>\n\n<pre><code>instance Foldable ((,) a) where\n    foldMap f (_, y) = f y\n    foldr f z (_, y) = f y z\n</code></pre>\n\n<p>You can already see from this instance that the first part of each tuple is <em>completely ignored</em> in all <code>Foldable</code> methods. However, to complete the picture, we need to look at the definitions for <code>minimum</code> and <code>length</code>. Since this instance does not include definitions for <code>minimum</code> and <code>length</code>, we should look at the default definitions for these. The class declaration for <code>Foldable</code> looks like this (with irrelevant bits elided):</p>\n\n<pre><code>class Foldable t where\n    length :: t a -&gt; Int\n    length = foldl' (\\c _ -&gt; c+1) 0\n\n    foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n    foldl' f z0 xs = foldr f' id xs z0\n      where f' x k z = k $! f z x\n\n    minimum :: forall a . Ord a =&gt; t a -&gt; a\n    minimum = fromMaybe (error \"minimum: empty structure\") .\n       getMin . foldMap (Min #. (Just :: a -&gt; Maybe a))\n</code></pre>\n\n<p>So now, let's expand these definitions and see where they get us.</p>\n\n<pre><code>length (a, b)\n= { definition of length }\nfoldl' (\\c _ -&gt; c+1) 0 (a, b)\n= { definition of foldl' }\nfoldr (\\x k z -&gt; k $! (\\c _ -&gt; c+1) z x) id (a, b) 0\n= { definition of foldr }\n(\\x k z -&gt; k $! (\\c _ -&gt; c+1) z x) b id 0\n= { beta reduction }\nid $! (\\c _ -&gt; c+1) 0 b\n= { id $! e = e }\n(\\c _ -&gt; c+1) 0 b\n= { beta reduction }\n1\n</code></pre>\n\n<p>Note that the conclusion holds regardless of what we plug in for <code>a</code> and <code>b</code>. Now let's do <code>minimum</code>. For our purposes, we will replace <code>(#.)</code> with <code>(.)</code> -- the only difference is efficiency, which we don't care about for this particular line of reasoning.</p>\n\n<pre><code>minimum (a, b)\n= { definition of minimum }\n( fromMaybe (error \"minimum: empty structure\")\n. getMin\n. foldMap (Min . Just)\n) (a, b)\n= { definition of (.) }\n( fromMaybe (error \"minimum: empty structure\")\n. getMin\n) (foldMap (Min . Just) (a, b))\n= { definition of foldMap }\n( fromMaybe (error \"minimum: empty structure\")\n. getMin\n) ((Min . Just) b)\n= { definition of (.) }\nfromMaybe (error \"minimum: empty structure\")\n(getMin (Min (Just b)))\n= { definition of getMin }\nfromMaybe (error \"minimum: empty structure\") (Just b)\n= { definition of fromMaybe }\nb\n</code></pre>\n"}], "owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2465, "favorite_count": 9, "accepted_answer_id": 36461185, "answer_count": 2, "score": 27, "last_activity_date": 1459977704, "creation_date": 1459971497, "question_id": 36460833, "link": "https://stackoverflow.com/questions/36460833/why-does-length-return-1-for-a-tuple-with-2-elements-and-gives-an-error-for-a-t", "title": "Why does length return 1 for a tuple with 2 elements, and gives an error for a tuple with more elements?", "body": "<p>I'm studying Haskell using the book \"<a href=\"http://haskellbook.com/\" rel=\"noreferrer\">Haskell Programming from First Principles</a>\", and towards the end of Chapter 4, \"Basic datatypes\", I've come across something that confused me. The book mentions a function <code>length</code> and says that it works on <code>Lists</code>s. Everything is fine with that, but when I try this <code>length</code> function with various <code>Tuple</code>s, what I see confused me:</p>\n\n<p>First, let's see the type of <code>length</code>:</p>\n\n<pre><code>:t length\nlength :: Foldable t =&gt; t a -&gt; Int\n</code></pre>\n\n<p>OK, so I read above as \"takes a Foldable, which I think as a list for convenience, and returns an Int, that is the number of elements in the list.\" Hence my first confusion: Why does the the following work at all:</p>\n\n<pre><code>length (1, 1)\n1\n</code></pre>\n\n<p>Because to me, it seems like I've just passed a tuple with two elements to <code>length</code>, and it returned 1. Is tuple a list? Is tuple Foldable? And of course, why <code>1</code>? </p>\n\n<p>Now I go one step further:</p>\n\n<pre><code>length (1, 1, 1)\n\n&lt;interactive&gt;:6:1:\n    No instance for (Foldable ((,,) t0 t1))\n      arising from a use of \u2018length\u2019\n    In the expression: length (1, 1, 1)\n    In an equation for \u2018it\u2019: it = length (1, 1, 1)\n\n&lt;interactive&gt;:6:9:\n    No instance for (Num t0) arising from the literal \u20181\u2019\n    The type variable \u2018t0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance Num Integer -- Defined in \u2018GHC.Num\u2019\n      instance Num Double -- Defined in \u2018GHC.Float\u2019\n      instance Num Float -- Defined in \u2018GHC.Float\u2019\n      ...plus two others\n    In the expression: 1\n    In the first argument of \u2018length\u2019, namely \u2018(1, 1, 1)\u2019\n    In the expression: length (1, 1, 1)\n\n&lt;interactive&gt;:6:12:\n    No instance for (Num t1) arising from the literal \u20181\u2019\n    The type variable \u2018t1\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance Num Integer -- Defined in \u2018GHC.Num\u2019\n      instance Num Double -- Defined in \u2018GHC.Float\u2019\n      instance Num Float -- Defined in \u2018GHC.Float\u2019\n      ...plus two others\n    In the expression: 1\n    In the first argument of \u2018length\u2019, namely \u2018(1, 1, 1)\u2019\n    In the expression: length (1, 1, 1)\n</code></pre>\n\n<p>Another try:</p>\n\n<pre><code>length (1::Int, 1::Int, 1::Int)\n\n&lt;interactive&gt;:7:1:\n    No instance for (Foldable ((,,) Int Int))\n      arising from a use of \u2018length\u2019\n    In the expression: length (1 :: Int, 1 :: Int, 1 :: Int)\n    In an equation for \u2018it\u2019: it = length (1 :: Int, 1 :: Int, 1 :: Int)\n</code></pre>\n\n<p>But the following works:</p>\n\n<pre><code>length (1::Int, 1::Int)\n1\n</code></pre>\n\n<p>Is there any good explanation for the behavior I'm observing above? Am I misreading the type of <code>length</code>? Or is there something else going on behind the scenes? </p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 1802, "user_id": 1897767, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b60e45c2f2adbfef9aa2d7c200b27f67?s=128&d=identicon&r=PG", "display_name": "Daishi Nakajima", "link": "https://stackoverflow.com/users/1897767/daishi-nakajima"}, "edited": false, "score": 0, "creation_date": 1460006089, "post_id": 36466515, "comment_id": 60545554, "body": "Thank you. Using session is good way! And, I noticed by this answer. This way seems can be easily implemented by setting <code>redirectToRefere</code> and using <code>setUltDest</code> in <code>authenticate</code>."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1460001947, "creation_date": 1460001947, "answer_id": 36466515, "question_id": 36459135, "link": "https://stackoverflow.com/questions/36459135/change-the-redirect-destination-by-which-plugin-was-used-in-yesod-auth/36466515#36466515", "title": "Change the redirect destination by which plugin was used in yesod-auth", "body": "<p>I don't think it can be done directly like this. However you could have the login destination be a page that checks for a session value telling you which plugin was used for login and redirect from there.</p>\n"}], "owner": {"reputation": 1802, "user_id": 1897767, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b60e45c2f2adbfef9aa2d7c200b27f67?s=128&d=identicon&r=PG", "display_name": "Daishi Nakajima", "link": "https://stackoverflow.com/users/1897767/daishi-nakajima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 36466515, "answer_count": 1, "score": 0, "last_activity_date": 1460001947, "creation_date": 1459966420, "question_id": 36459135, "link": "https://stackoverflow.com/questions/36459135/change-the-redirect-destination-by-which-plugin-was-used-in-yesod-auth", "title": "Change the redirect destination by which plugin was used in yesod-auth", "body": "<p>I'm using multiple plugins(Yesod.Auth.Email, Yesod.Auth.OAuth2.Github, etc).<br>\nI want to change the redirect destination by which plugin was used.</p>\n\n<p>I want to do something like following:</p>\n\n<pre><code>instance YesodAuth App where\n    loginDest _ =\n        | plugin == \"email\" = HomeR\n        | plugin == \"github\" = SettingR\n</code></pre>\n\n<p>How can I do?</p>\n\n<p>thanks.</p>\n"}, {"tags": ["haskell", "sublimetext3", "hsdev"], "answers": [{"tags": [], "owner": {"reputation": 10249, "user_id": 1329116, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e58c33b56b00d4148810d427a04e21e0?s=128&d=identicon&r=PG", "display_name": "idleberg", "link": "https://stackoverflow.com/users/1329116/idleberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1459976366, "creation_date": 1459976366, "answer_id": 36462235, "question_id": 36458465, "link": "https://stackoverflow.com/questions/36458465/sublimehaskell-doesnt-use-path/36462235#36462235", "title": "SublimeHaskell doesn&#39;t use path", "body": "<p>Since Windows uses backslashes, have you tried using them? Only thing to keep in mind is escaping them.</p>\n\n<p>Example:</p>\n\n<pre><code>\"C:\\\\Users\\\\Arne\\\\AppData\\\\Roaming\\\\cabal\\\\bin\"\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5677970, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0b5a841ee9dc5580c22731c5269424a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arne", "link": "https://stackoverflow.com/users/5677970/arne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1605, "favorite_count": 0, "accepted_answer_id": 36462235, "answer_count": 1, "score": 2, "last_activity_date": 1460311639, "creation_date": 1459964523, "last_edit_date": 1460311639, "question_id": 36458465, "link": "https://stackoverflow.com/questions/36458465/sublimehaskell-doesnt-use-path", "title": "SublimeHaskell doesn&#39;t use path", "body": "<p>Using Windows 10. Compiling and Executing Prelude functions / basic Haskell Code with ctrl+b works.</p>\n\n<p>Error on starting:</p>\n\n<pre><code>SublimeHaskell: hsdev executable couldn't be found!\nIt's used in most features of SublimeHaskell\nCheck if it's installed and in PATH\nIf it's not installed, run 'cabal install hsdev' to install hsdev\nYou may also want to adjust 'add_to_PATH' setting\n</code></pre>\n\n<p>My SublimeHaskell User settings:</p>\n\n<pre><code>{\n\"add_to_PATH\":\n[\n    \"C:/Users/Arne/AppData/Roaming/cabal/bin\",\n],\n\"enable_hdevtools\": true\n}\n</code></pre>\n\n<p>hdevtools.exe is in the right folder.</p>\n\n<p>Importing packages I installed via cabal install don't work either. </p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 2, "creation_date": 1459960080, "post_id": 36456616, "comment_id": 60526359, "body": "&quot;<code>ask &gt;&gt;= f = (\\k -&gt; f (ask k) k)</code>&quot; This is wrong."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1459962577, "post_id": 36456616, "comment_id": 60527906, "body": "so show me please correct equality. I found it here <a href=\"https://www.haskell.org/wiki/df4e1f5471fe2a2Monads_as_containers\" rel=\"nofollow noreferrer\">haskell.org/wiki/df4e1f5471fe2a2Monads_as_containers</a>"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1459968361, "post_id": 36456616, "comment_id": 60531520, "body": "the other answers have to correct equalities."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1459962855, "post_id": 36457067, "comment_id": 60528090, "body": "What does mean r in \\r ?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1459963983, "post_id": 36457067, "comment_id": 60528811, "body": "@HaskellFun Are you asking what the syntax <code>\\r -&gt; ...</code> means or are you asking what the <code>r</code> parameter represents?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1459965174, "post_id": 36457067, "comment_id": 60529566, "body": "what represents. I know this syntax, just lambda :)"}], "tags": [], "owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "is_accepted": false, "score": 5, "last_activity_date": 1459960638, "last_edit_date": 1459960638, "creation_date": 1459960326, "answer_id": 36457067, "question_id": 36456616, "link": "https://stackoverflow.com/questions/36456616/haskell-parameters-of-ask/36457067#36457067", "title": "Haskell, parameters of ask", "body": "<p>A value of type <code>m a</code> where <code>m</code> is a Monad, can be thought of as a \"monadic action\". So <code>ask</code> doesn't take any parameters, it's just a value that you can bind (<code>&gt;&gt;=</code>) to extract some value from a Reader monad.</p>\n\n<p>Look at the definition of <code>ask</code> for <code>ReaderT</code> in <code>Control.Monad.Trans.Reader</code>:</p>\n\n<pre><code>-- | Fetch the value of the environment.\nask :: (Monad m) =&gt; ReaderT r m r\nask = ReaderT return\n</code></pre>\n\n<p><code>ReaderT</code> is just a data constructor that contains a value of type <code>r -&gt; m a</code>, so <code>ReaderT return</code> is a value of type <code>ReaderT r m r</code> that contains a function, <code>return</code> (of the monad <code>m</code>).</p>\n\n<p>In other words, <code>ask</code> here is a \"monadic action\" that extracts the value of stored inside the <code>Reader</code>.</p>\n\n<pre><code>ask &gt;&gt;= f \n</code></pre>\n\n<p>Which is</p>\n\n<pre><code>(ReaderT return) &gt;&gt;= f\n</code></pre>\n\n<p>Using definition of <code>&gt;&gt;=</code> for Reader, we get:    </p>\n\n<pre><code>ReaderT $ \\ r -&gt; do\n    a &lt;- runReaderT (ReaderT return) r\n    runReaderT (f a) r\n</code></pre>\n\n<p>Which reduces to</p>\n\n<pre><code>ReaderT $ \\ r -&gt; do\n    a &lt;- return r\n    runReaderT (f a) r\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>ReaderT $ \\r -&gt; runReaderT (f r) r\n</code></pre>\n\n<p>So, it passes the stored value along to decide the next action and also passes the value so the next actions can read it as it was before.</p>\n\n<p>(If this wasn't clear, look for a Reader tutorial maybe)</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1459971984, "post_id": 36459214, "comment_id": 60533732, "body": "So it should be true that: <code>ask &gt;&gt;= f = Reader (\\r -&gt; f (ask r) r) = Reader (\\r -&gt; f(r) r)</code>"}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 3, "last_activity_date": 1459966634, "creation_date": 1459966634, "answer_id": 36459214, "question_id": 36456616, "link": "https://stackoverflow.com/questions/36456616/haskell-parameters-of-ask/36459214#36459214", "title": "Haskell, parameters of ask", "body": "<p>It's the <code>Reader</code> monad.  Ultimately the best answer is just to study its implementation, which in it simplest version (no monad transformers, no classes) can be defined like this:</p>\n\n<pre><code>newtype Reader r a = Reader { runReader :: r -&gt; a }\n</code></pre>\n\n<p>This is a <code>newtype</code> declaration, so <code>Reader r a</code> is just a \"relabeling\" (so to speak) of the function type <code>r -&gt; a</code>.  <code>ask</code> is defined like this: </p>\n\n<pre><code>ask :: Reader r r\nask = Reader (\\r -&gt; r)\n</code></pre>\n\n<p>Which means that <code>ask</code> is a relabeled <strong>identity function</strong>\u2014the function that just returns its own argument.  We can see this if we use the <code>runReader</code> operation to feed values to it :</p>\n\n<pre><code>ghci&gt; runReader ask 5\n5\n\nghci&gt; runReader ask \"Hello world!\"\n\"Hello world!\"\n</code></pre>\n\n<p>That doesn't look very useful, but the magic comes from the fact that <code>Reader</code> has instances for <code>Functor</code>, <code>Applicative</code> and <code>Monad</code>:</p>\n\n<pre><code>instance Functor (Reader r) where\n  fmap f (Reader g) =\n      -- A `Reader` that applies `f` to the original `Reader`'s results \n      Reader (\\r -&gt; f (g r))\n\ninstance Applicative (Reader r) where\n  pure a = \n      -- A `Reader` that ignores its `r` argument and just produces\n      -- a fixed value.\n      Reader (\\_ -&gt; a)\n\n  Reader ff &lt;*&gt; Reader fa =\n      -- A `Reader` that \"combines\" two `Reader`s by feeding the same \n      -- `r` value to both, and then combining their results \n      Reader (\\r -&gt; ff r (fa r))\n\ninstance Monad (Reader r) where\n  return = pure\n\n  Reader fa &gt;&gt;= k = \n      -- A `Reader` that feeds the same `r` both to the original one\n      -- and to the one computed by the `k` function\n      Reader (\\r -&gt; k (fa r) r)\n</code></pre>\n\n<p>If you study these, you'll notice that what <code>Reader</code> is about is <em>delaying</em> the point of the program where you apply the wrapper <code>r -&gt; a</code> function to an <code>r</code>.  Normally, if you have a function of type <code>r -&gt; a</code> and you want to get a value of type <code>a</code>, you have to feed the function an argument of type <code>r</code>.  The <code>Reader</code> class instances allow you instead to supply functions that will be used to operate on the <code>a</code> ahead of time, and then supply the <code>r</code> in the end. </p>\n\n<p>The <code>ReaderT</code> type and the <code>MonadReader</code> class (which has the <code>ask :: MonadReader r m =&gt; m r</code> method) are just more advanced versions of this.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 1, "accepted_answer_id": 36459214, "answer_count": 2, "score": 0, "last_activity_date": 1459966634, "creation_date": 1459959124, "question_id": 36456616, "link": "https://stackoverflow.com/questions/36456616/haskell-parameters-of-ask", "title": "Haskell, parameters of ask", "body": "<p>Could you help what parameter is getting by <code>ask</code> ?\nWe often can see <code>ask &gt;&gt;= f</code>\nIt means that <code>ask &gt;&gt;= f = (\\k -&gt; f (ask k) k)</code><br>\nSo ask must be able to get k, function from enviroment.<br>\nHowever, in docs it is written: <code>ask :: m r</code>.\nWhere am I wrong ?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1459956572, "post_id": 36455107, "comment_id": 60523740, "body": "Start with a solution that only works on lists of length 1 and uses pattern matching (on lists and <code>Char</code> literals). Google &quot;pattern matching haskell&quot; if you don&#39;t understand what I mean. Then add more cases (to match the empty list) and a recursive call to <code>unionList</code> to support lists of arbitrary length."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 3, "creation_date": 1459956575, "post_id": 36455107, "comment_id": 60523742, "body": "Look at <code>zipWith</code>."}, {"owner": {"reputation": 9, "user_id": 6167009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96e78966478335103d5b8abc36aeae4b?s=128&d=identicon&r=PG&f=1", "display_name": "evian1", "link": "https://stackoverflow.com/users/6167009/evian1"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1459956752, "post_id": 36455107, "comment_id": 60523878, "body": "@ReinHenrichs - I looked into zipWith and will use it for the image union. but i want to get the unionList function to work as defined above first and use it with zipWith."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1459956791, "post_id": 36455107, "comment_id": 60523902, "body": "<code>unionList</code> is the function that I am suggesting you use <code>zipWith</code> for. The function as defined above is wrong, and I don&#39;t know how to make it work, since it is wrong."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1459956853, "post_id": 36455107, "comment_id": 60523947, "body": "If you use prelude functions I would suggest at least looking at their implementation so that you learn something from this exercise"}, {"owner": {"reputation": 9, "user_id": 6167009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96e78966478335103d5b8abc36aeae4b?s=128&d=identicon&r=PG&f=1", "display_name": "evian1", "link": "https://stackoverflow.com/users/6167009/evian1"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1459957431, "post_id": 36455107, "comment_id": 60524404, "body": "@ReinHenrichs - I&#39;m new to Haskell so feel free to completely ignore how I&#39;ve done it and go about it how you would do it."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1459957501, "post_id": 36455107, "comment_id": 60524460, "body": "Try doing it with <code>zipWith</code>. I don&#39;t want to just give you the answer because this is homework."}, {"owner": {"reputation": 9, "user_id": 6167009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96e78966478335103d5b8abc36aeae4b?s=128&d=identicon&r=PG&f=1", "display_name": "evian1", "link": "https://stackoverflow.com/users/6167009/evian1"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1459957784, "post_id": 36455107, "comment_id": 60524694, "body": "@ReinHenrichs - its not homework. i&#39;m learning Haskell in my spare time  so i asked for some material that will help me practice from my professor. Though I understand where your coming from."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1459958544, "post_id": 36455107, "comment_id": 60525286, "body": "Your example looks more like &quot;element-wise OR&quot;, not a UNION (with the lists being treated like sets)."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6167009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96e78966478335103d5b8abc36aeae4b?s=128&d=identicon&r=PG&f=1", "display_name": "evian1", "link": "https://stackoverflow.com/users/6167009/evian1"}, "edited": false, "score": 0, "creation_date": 1459960181, "post_id": 36456803, "comment_id": 60526428, "body": "It is for the UnionList function. How will i include this for the image union function.  (edit in question)"}, {"owner": {"reputation": 717, "user_id": 6153295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f7c00152580418fa24446dc7558c6e?s=128&d=identicon&r=PG", "display_name": "Niels Heisterkamp", "link": "https://stackoverflow.com/users/6153295/niels-heisterkamp"}, "reply_to_user": {"reputation": 9, "user_id": 6167009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96e78966478335103d5b8abc36aeae4b?s=128&d=identicon&r=PG&f=1", "display_name": "evian1", "link": "https://stackoverflow.com/users/6167009/evian1"}, "edited": false, "score": 0, "creation_date": 1459960682, "post_id": 36456803, "comment_id": 60526754, "body": "I&#39;ve edited my answer to include your edited question, is this what you&#39;re looking for?"}], "tags": [], "owner": {"reputation": 717, "user_id": 6153295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f7c00152580418fa24446dc7558c6e?s=128&d=identicon&r=PG", "display_name": "Niels Heisterkamp", "link": "https://stackoverflow.com/users/6153295/niels-heisterkamp"}, "is_accepted": false, "score": 1, "last_activity_date": 1459963491, "last_edit_date": 1459963491, "creation_date": 1459959619, "answer_id": 36456803, "question_id": 36455107, "link": "https://stackoverflow.com/questions/36455107/haskell-improve-list-union/36456803#36456803", "title": "Haskell :improve list union", "body": "<p>\nThere are probably better ways to do this, but I had some fun trying out a couple of methods.</p>\n\n<p>Pattern matching on list head item:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>unionList1 :: String -&gt; String -&gt; String\nunionList1 ('X':xs) ( _ :ys) = 'X' : unionList1 xs ys\nunionList1 ( _ :xs) ('X':ys) = 'X' : unionList1 xs ys\nunionList1 ( _ :xs) ( _ :ys) = ' ' : unionList1 xs ys\nunionList1     _        _    = []\n</code></pre>\n\n<p>Guards!</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>unionList2 :: String -&gt; String -&gt; String\nunionList2 (x:xs) (y:ys)\n  | x == ' '   = y : rest\n  | y == ' '   = x : rest\n  | otherwise  = x : rest\n  where rest   = unionList2 xs ys\nunionList2 _ _ = []\n</code></pre>\n\n<p>And a solution as proposed with <code>zipWith</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>unionList3 :: String -&gt; String -&gt; String\nunionList3 = zipWith (\\x y -&gt; if x /= ' ' then x else y)\n</code></pre>\n\n<p>You can then use one of these union functions on the image:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>imgUnion :: [String] -&gt; [String] -&gt; [String]\nimgUnion = zipWith unionList3\n\nmain :: IO ()\nmain = do\n    let img1 = [\"  XX  \",\n                \" X  X \",\n                \"  XX  \"]\n        img2 = [\"XX XX\",\n                \"  X  \",\n                \"XX XX\"]\n\n    mapM_ putStrLn (imgUnion img1 img2)\n</code></pre>\n\n<p>Gives as output:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>XXXXX\n XX X\nXXXXX\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6167009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96e78966478335103d5b8abc36aeae4b?s=128&d=identicon&r=PG&f=1", "display_name": "evian1", "link": "https://stackoverflow.com/users/6167009/evian1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1459963491, "creation_date": 1459955164, "last_edit_date": 1459959782, "question_id": 36455107, "link": "https://stackoverflow.com/questions/36455107/haskell-improve-list-union", "title": "Haskell :improve list union", "body": "<p>I want to create a union function for two images (created using lists of type string.) I have started by creating a unionList function that combines two lists.</p>\n\n<pre><code>unionList :: String -&gt; String -&gt; String  \nunionList xs ys =  xs ++ foldl (flip delete) ys xs\n</code></pre>\n\n<p>This works but not how i want it too.<br>\nI want it to work like:  </p>\n\n<pre><code>input = unionList [\u2019 \u2019,\u2019 \u2019,\u2019X\u2019,\u2019X\u2019,\u2019 \u2019] [\u2019X\u2019,\u2019 \u2019,\u2019X\u2019,\u2019 \u2019,\u2019X\u2019] \noutput = \"X XXX\"\n</code></pre>\n\n<p>any ideas on how it's done to achieve this.</p>\n\n<p>EDIT: I'm ultimately trying to create a union of two images.</p>\n\n<pre><code>image 1 = [\"  XX  \",     image 2 = [\"XX XX\",         type Img = [String]\n           \" X  X \",                \"  X  \",\n           \"  XX  \"]                \"XX XX\"]          \n</code></pre>\n\n<p>^<br>\n<em>examples</em> </p>\n\n<pre><code>Input = (imgUnion (image 1) (image 2))\n</code></pre>\n\n<p>should give me the union of the two images.<br>\nimgUnion defined as </p>\n\n<pre><code>imgUnion :: Img -&gt; Img -&gt; Img\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1459953381, "post_id": 36454052, "comment_id": 60521235, "body": "Additionally, I used ask because &gt;&gt;= passes enviroment to two subcomputations. So I can&#39;t put this function to get this argument (enviroment)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 0, "last_activity_date": 1459952659, "creation_date": 1459952659, "answer_id": 36454052, "question_id": 36453887, "link": "https://stackoverflow.com/questions/36453887/haskell-getting-value-from-bindings/36454052#36454052", "title": "Haskell, getting value from bindings", "body": "<p>I'm not sure I understand the question completely. Why don't you add a parameter for <code>\"b\"</code> ?</p>\n\n<pre><code>get_valueM :: String -&gt; Reader Bindings Int\nget_valueM x = asks (lookupVar \"b\") &gt;&gt;= (\\value -&gt; ask &gt;&gt;= (\\_ -&gt; return value))\n</code></pre>\n\n<p>By the way, what is the last <code>ask</code> for? You don't use its result and it has no side effects, so it looks as it can be removed.</p>\n\n<pre><code>get_valueM :: String -&gt; Reader Bindings Int\nget_valueM x = asks (lookupVar \"b\") &gt;&gt;= (\\value -&gt; return value)\n</code></pre>\n\n<p>which can be simplified to</p>\n\n<pre><code>get_valueM :: String -&gt; Reader Bindings Int\nget_valueM x = asks (lookupVar \"b\") &gt;&gt;= return\n</code></pre>\n\n<p>which can be simplified to</p>\n\n<pre><code>get_valueM :: String -&gt; Reader Bindings Int\nget_valueM x = asks (lookupVar \"b\")\n</code></pre>\n\n<p>Finally, let me add that I consider these partial functions dangerous. <code>lookupVar</code> shouldn't crash when a binding is not found. Still, these can be convenient when toying around.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 36454052, "answer_count": 1, "score": 0, "last_activity_date": 1459952659, "creation_date": 1459952280, "question_id": 36453887, "link": "https://stackoverflow.com/questions/36453887/haskell-getting-value-from-bindings", "title": "Haskell, getting value from bindings", "body": "<p>Here is an example from haskell tutorial:</p>\n\n<pre><code>type Bindings = Map.Map String Int\n\nisCountCorrect :: Bindings -&gt; Bool\nisCountCorrect bindings = runReader calc_isCountCorrect bindings\n\ncalc_isCountCorrect :: Reader Bindings Bool\ncalc_isCountCorrect = do\n    count &lt;- asks (lookupVar \"count\")\n    bindings &lt;- ask\n    return (count == (Map.size bindings))\n\nlookupVar :: String -&gt; Bindings -&gt; Int\nlookupVar name bindings = fromJust (Map.lookup name bindings)\n\nsampleBindings = Map.fromList [(\"count\", 4), (\"1\", 1), (\"b\", 2)]\n\nmain = do\n    putStr $ \"Count is correct for bindings \" ++ (show  sampleBindings) ++ \": \"\n    putStrLn $ show (isCountCorrect sampleBindings)\n</code></pre>\n\n<p>I created function to get value for \"2\". I have no idea how to make it generic for arbitrary String.  Could you help me ?</p>\n\n<pre><code>get_valueM :: Reader Bindings Int\nget_valueM = asks (lookupVar \"b\") &gt;&gt;= (\\value -&gt; ask &gt;&gt;= (\\_ -&gt; return value))\n\nget_value :: Bindings -&gt; Int\nget_value bindings = runReader get_valueM bindings\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1459951499, "post_id": 36452844, "comment_id": 60519680, "body": "You probably shouldn&#39;t assume that the image is a square."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459951652, "post_id": 36452844, "comment_id": 60519811, "body": "<code>rotate90 = reverse . transpose</code>. Or, if you want to rotate clockwise, <code>transpose . reverse</code>. (This is not only more concise, it&#39;s also much more efficient \u2013 no indexing \u2013 and will work even on non-rectangular \u201cimages\u201d, though the result probably won&#39;t be what you want then.)"}, {"owner": {"reputation": 9, "user_id": 6167009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96e78966478335103d5b8abc36aeae4b?s=128&d=identicon&r=PG&f=1", "display_name": "evian1", "link": "https://stackoverflow.com/users/6167009/evian1"}, "edited": false, "score": 0, "creation_date": 1459952401, "post_id": 36452844, "comment_id": 60520399, "body": "<b>rotate90 = reverse . transpose</b> - - worked well. Thank you."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1459956655, "post_id": 36452844, "comment_id": 60523812, "body": "BTW this is an application of group theory."}], "answers": [{"comments": [{"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459951891, "post_id": 36453581, "comment_id": 60520006, "body": "@chi - I like it!  I&#39;ll make the change."}, {"owner": {"reputation": 9, "user_id": 6167009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96e78966478335103d5b8abc36aeae4b?s=128&d=identicon&r=PG&f=1", "display_name": "evian1", "link": "https://stackoverflow.com/users/6167009/evian1"}, "edited": false, "score": 0, "creation_date": 1459951941, "post_id": 36453581, "comment_id": 60520038, "body": "the images already exist in a Haskell program and a defined &#39;pic :: Int -&gt; Pic&#39;. I am using the function on them. usage: rotate90 (pic 1) etc."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1459957959, "post_id": 36453581, "comment_id": 60524844, "body": "Are you sure that&#39;s a rotation? <code>(foldr (zipWith (:)) $ repeat &quot;&quot;) [&quot;ABCDE&quot;,&quot;P   F&quot;,&quot;O   G&quot;,&quot;N   H&quot;,&quot;MLKJI&quot;] = [&quot;APONM&quot;,&quot;B   L&quot;,&quot;C   K&quot;,&quot;D   J&quot;,&quot;EFGHI&quot;]</code>"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1459983765, "post_id": 36453581, "comment_id": 60539402, "body": "@pigworker - you are correct, I added a reverse to fix things."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 2, "last_activity_date": 1459983732, "last_edit_date": 1459983732, "creation_date": 1459951578, "answer_id": 36453581, "question_id": 36452844, "link": "https://stackoverflow.com/questions/36452844/haskell-rotating-image-90/36453581#36453581", "title": "Haskell: rotating image 90", "body": "<p>This works</p>\n\n<pre><code>rotate90 = (map reverse .) $ foldr (zipWith (:)) $ repeat \"\"\n</code></pre>\n\n<p>usage:</p>\n\n<pre><code>&gt; rotate90 [\"XXXX\", \"X   \", \"XXX \", \"X   \", \"XXXX\"]\n[\"XXXXX\",\"X X X\",\"X X X\",\"X   X\"]\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6167009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96e78966478335103d5b8abc36aeae4b?s=128&d=identicon&r=PG&f=1", "display_name": "evian1", "link": "https://stackoverflow.com/users/6167009/evian1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 1, "accepted_answer_id": 36453581, "answer_count": 1, "score": 0, "last_activity_date": 1459983732, "creation_date": 1459949877, "last_edit_date": 1459950517, "question_id": 36452844, "link": "https://stackoverflow.com/questions/36452844/haskell-rotating-image-90", "title": "Haskell: rotating image 90", "body": "<p>I've Created an image using lists of type string. So they kind of look like this  </p>\n\n<pre><code>pic 1 =  \n[\"xxxx\",   \n \"x   \",   \n \"xxx \",  \n \"x   \",  \n \"xxxx\"]\n</code></pre>\n\n<p>So i'm trying to create a 90 degrees rotation (clockwise). This is the code i have so far, it seems to work too a level but not properly on all images. </p>\n\n<pre><code>rotateLine90 :: Pic -&gt; Int -&gt; [Char]     \nrotateLine90 pic n = reverse [line!!n | line&lt;-pic]\n\nrotate90 :: Pic -&gt; Pic  \nrotate90 pic = [rotateLine90 pic i | i&lt;-[0 .. (length pic) - 1]]\n</code></pre>\n\n<p>any ideas on how to improve the code.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31108, "user_id": 350351, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b1a41bbf4677c8961237c4d147e764d6?s=128&d=identicon&r=PG", "display_name": "Daenyth", "link": "https://stackoverflow.com/users/350351/daenyth"}, "edited": false, "score": 0, "creation_date": 1459944633, "post_id": 36450697, "comment_id": 60514079, "body": "Paste the full compiler output"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459951464, "post_id": 36450697, "comment_id": 60519655, "body": "The error reads, roughly, as &quot;the second argument of <code>(.)</code> must be a function (<code>a0 -&gt; m0 String</code>) but it is not (<code>IO String</code>)&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 8, "last_activity_date": 1459944856, "creation_date": 1459944856, "answer_id": 36450847, "question_id": 36450697, "link": "https://stackoverflow.com/questions/36450697/haskell-why-i-cant-use-liftm-lines-getcontents/36450847#36450847", "title": "Haskell: why I cant use liftM lines . getContents", "body": "<p><code>readFile</code> is a function <code>FilePath -&gt; IO String</code> while <code>getContents</code> is just <code>IO String</code> so you cannot use the <code>(.)</code> operator to compose it with <code>liftM lines</code>. You should just use</p>\n\n<pre><code>getLinesIn = liftM lines getContents\n</code></pre>\n\n<p>or</p>\n\n<pre><code>getLinesIn = fmap lines getContents\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 6166491, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/78ae8fea419df91409fa6dc7a8857ae3?s=128&d=identicon&r=PG&f=1", "display_name": "lindaon", "link": "https://stackoverflow.com/users/6166491/lindaon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 2, "accepted_answer_id": 36450847, "answer_count": 1, "score": 2, "last_activity_date": 1459944856, "creation_date": 1459944502, "last_edit_date": 1459944778, "question_id": 36450697, "link": "https://stackoverflow.com/questions/36450697/haskell-why-i-cant-use-liftm-lines-getcontents", "title": "Haskell: why I cant use liftM lines . getContents", "body": "<p>I have <code>getLinesIn = liftM lines . getContents</code> than</p>\n\n<pre><code>readAndWriteIn = do\n  list &lt;- getLinesIn\n</code></pre>\n\n<p>and it doesnt work.\nIt says: Couldn't match expected type a0 -> m0 String with actual type IO String.\nI dont understand why is that?\nWhen I use <code>getLinesFile = liftM lines . readFile</code>\nIt works fine.\nI need to do the same with getContents. Is there a way?</p>\n\n<p>Thanks for any ideas.</p>\n\n<p>EDIT:\nFull output:</p>\n\n<pre><code>Couldn't match expected type `a0 -&gt; m0 String'\n            with actual type `IO String'\nIn the second argument of `(.)', namely `getContents'\nIn the expression: liftM lines . getContents\nIn an equation for `getLinesIn':\n    getLinesIn = liftM lines . getContents\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1459943969, "post_id": 36450443, "comment_id": 60513591, "body": "What if my input is not well-formed? E.g. <code>transpose&#39; [&quot;a&quot;, &quot;&quot;]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1459945574, "post_id": 36450713, "comment_id": 60514821, "body": "you could create a safe version of head and tail  (which exists in the safe package already), but the type would be <code>[a]-&gt;Maybe a</code> and <code>[a]-&gt;Maybe [a]</code>.  Note that <code>headMay [] = Nothing</code>, not <code>[]</code>.  Also, note that regular <code>head</code>, <code>tail</code> define the empty list case as <code>head [] = error &quot;&lt;some message&gt;&quot;</code>, <code>tail [] = error &quot;&lt;some message&gt;&quot;</code>."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 1, "creation_date": 1459947394, "post_id": 36450713, "comment_id": 60516348, "body": "depends what you did....  You should be able to use the <code>error</code> version as is, and the warning will go away.  If you want to use the <code>Maybe</code> version, you will have to restructure the program to be able to deal with that <code>Maybe</code>, it isn&#39;t a simple replacement."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 2, "last_activity_date": 1459944569, "creation_date": 1459944569, "answer_id": 36450713, "question_id": 36450443, "link": "https://stackoverflow.com/questions/36450443/non-exhaustive-pattern-in-my-function-head/36450713#36450713", "title": "Non-exhaustive pattern in my function head&#39;", "body": "<p>Both <code>head'</code> and <code>tail'</code> don't define what happens if you provide the empty list as a parameter.  You need to define the following:</p>\n\n<pre><code>head' [] = ....\ntail' [] = ....\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1459952226, "post_id": 36451977, "comment_id": 60520259, "body": "The library <code>transpose</code> is similar to yours, except that <code>[]</code> is used as a base case (we prefer that, if possible ;-)) and that lists comprehensions are used instead of <code>map head</code> so that they fail gracefully (skipping missing elements for ragged matrices). <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/src/Data.OldList.html#transpose\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.2.0/docs/src/&hellip;</a>"}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": false, "score": 1, "last_activity_date": 1459947716, "creation_date": 1459947716, "answer_id": 36451977, "question_id": 36450443, "link": "https://stackoverflow.com/questions/36450443/non-exhaustive-pattern-in-my-function-head/36451977#36451977", "title": "Non-exhaustive pattern in my function head&#39;", "body": "<p>I'm not very fluent yet in Haskell, however the following version of <code>transpose'</code> works well for non-ragged matrices:</p>\n\n<pre><code>transpose' :: [[a]] -&gt; [[a]]\ntranspose' ([x]: xs) = [x: map singleTail' xs] where\n    singleTail' [x] = x\ntranspose' rows = (map head rows) : transpose' (map tail rows) \n</code></pre>\n\n<p>E.g., </p>\n\n<pre><code>&gt;&gt;&gt; transpose' [[1], [2], [3]]\n[[1,2,3]]\n\n&gt;&gt;&gt; transpose' [[1,2,3]]\n[[1], [2], [3]]\n\n&gt;&gt;&gt; transpose' [[1, 2], [2, 3], [3, 4]]\n[[1,2,3],[2,3,4]]\n</code></pre>\n\n<p>but fails for ragged matrices:</p>\n\n<pre><code>&gt;&gt;&gt; transpose' [[1, 2], [2, 3], [3, 4, 5]]\n:3:5-23: Non-exhaustive patterns in function singleTail'\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6166509"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1460473993, "creation_date": 1459943779, "last_edit_date": 1460473993, "question_id": 36450443, "link": "https://stackoverflow.com/questions/36450443/non-exhaustive-pattern-in-my-function-head", "title": "Non-exhaustive pattern in my function head&#39;", "body": "<pre><code>transpose' :: [[a]] -&gt; [[a]]\ntranspose' [[]]    = []\ntranspose' [[], _] = []\ntranspose' rows    = (map head' rows) : transpose' (map tail' rows)\n  where\n    head' (x:_) = x\n    tail' (_:xs) = xs\n\nmatMult3 :: (Num a) =&gt; [[a]] -&gt; [[a]] -&gt; [[a]]\nmatMult3 a b = [ [ sum $ zipWith (*) ar bc | bc &lt;- (transpose' b) ] | ar &lt;- a ]\n</code></pre>\n\n<p>Anyone got any ideas as to why this could be throwing up a non-exhaustive? I feel like there is something missing but I'm too new to haskell itself to actually know, I'm self teaching it so that might be why, any advice would be appreciated.</p>\n"}, {"tags": ["function", "haskell", "functor", "difference"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1459940108, "post_id": 36448563, "comment_id": 60510690, "body": "\u201cFunctor: seems just the same like a normal Functor.\u201d \u2013 well, seems to make sense! ... actually not even that is quite correct though: all <a href=\"http://hackage.haskell.org/package/base/docs/Control-Monad-Instances.html#t:Functor\" rel=\"nofollow noreferrer\"><code>Functor</code></a>s are specifically <i>endofunctors</i> of the <b>Hask</b> category."}], "answers": [{"tags": [], "owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "is_accepted": false, "score": 12, "last_activity_date": 1520993769, "last_edit_date": 1520993769, "creation_date": 1459939280, "answer_id": 36448674, "question_id": 36448563, "link": "https://stackoverflow.com/questions/36448563/whats-the-difference-between-a-function-and-a-functor-in-haskell-only-definiti/36448674#36448674", "title": "What&#39;s the difference between a function and a functor in Haskell? Only definition?", "body": "<p>First of all, it's not true that \"everything is a function\" in Haskell. Many things are not functions, like <code>4</code>. Or the string <code>\"vik santata\"</code>.</p>\n\n<p>In Haskell, a function is something which maps some input to an output. A function is a value which you can apply to some other value to get a result. If a value has a <code>-&gt;</code> in its type, chances are that it may be a function (but there are infinitely many exceptions to this rule of thumb ;-)).</p>\n\n<p>Here are some examples of functions (quoting from a GHCI session):</p>\n\n<pre><code>\u03bb: :t fst\nfst :: (a, b) -&gt; a\n\u03bb: :t even\neven :: Integral a =&gt; a -&gt; Bool\n</code></pre>\n\n<p>Here are a few examples of things which are not functions:</p>\n\n<ul>\n<li><p>A (polymorphic) value which can assume any type <code>a</code> provided that the type is a member of the <code>Num</code> class (e.g. <code>Int</code> would be a valid type). The exact value would be inferred from how the number is used. </p>\n\n<p>Note that this type has <code>=&gt;</code> in it, which is something different altogether than <code>-&gt;</code>. It denotes a \"class constraint\".</p>\n\n<pre><code>\u03bb: :t 5\n5 :: Num a =&gt; a\n</code></pre></li>\n<li><p>A list of functions. Note that this has a <code>-&gt;</code> in its type, but it's not the top level type constructor (the toplevel type is <code>[]</code>, i.e. \"list\"):</p>\n\n<pre><code>\u03bb: :t [fst, snd]\n[fst, snd] :: [(a, a) -&gt; a]\n</code></pre></li>\n</ul>\n\n<p><em>Functors</em> are not things you can apply to values. Functors are types whose values can be used with (and returned by) the <code>fmap</code> function (provided that the <code>fmap</code> function complies to certain rules, often called 'laws'). You can find a basic list of types which are part of the <code>Functor</code> using GHCI:</p>\n\n<pre><code>\u03bb: :i Functor\n[...]\ninstance Functor (Either a) -- Defined in \u2018Data.Either\u2019\ninstance Functor [] -- Defined in \u2018GHC.Base\u2019\ninstance Functor Maybe -- Defined in \u2018GHC.Base\u2019\n[...]\n</code></pre>\n\n<p>This means you can apply <code>fmap</code> to lists, or to <code>Maybe</code> values, or to <code>Either</code> values.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1459947437, "last_edit_date": 1459947437, "creation_date": 1459940808, "answer_id": 36449311, "question_id": 36448563, "link": "https://stackoverflow.com/questions/36448563/whats-the-difference-between-a-function-and-a-functor-in-haskell-only-definiti/36449311#36449311", "title": "What&#39;s the difference between a function and a functor in Haskell? Only definition?", "body": "<p>Actually, a <a href=\"https://en.wikipedia.org/wiki/Functor\" rel=\"nofollow\">functor</a> is <strong><em>two</em> functions</strong>, but only one of them is a Haskell function (and I'm not sure it's the function you suspect it to be).</p>\n\n<ol>\n<li><p>A <em>type level function</em>. The <a href=\"https://en.wikipedia.org/wiki/Category_(mathematics)#Definition\" rel=\"nofollow\">objects</a> of the <strong>Hask</strong> category are types with kind <code>*</code>, and a functor maps such types to other types. You can see this aspect of functors in ghci, using the <code>:kind</code> query:</p>\n\n<pre><code>Prelude&gt; :k Maybe\nMaybe :: * -&gt; *\nPrelude&gt; :k []\n[] :: * -&gt; *\nPrelude&gt; :k IO\nIO :: * -&gt; *\n</code></pre>\n\n<p>What these functions do is rather boring: they map, for instance,</p>\n\n<ul>\n<li><code>Int</code> to <code>Maybe Int</code></li>\n<li><code>()</code> to <code>IO ()</code></li>\n<li><code>String</code> to <code>[[Char]]</code>.</li>\n</ul>\n\n<p>By this I don't mean that they map <em>integer numbers to maybe-integers</em> etc. &ndash; that's <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Applicative.html#v:pure\" rel=\"nofollow\">a more specific operation</a>, not possible for every functor. I just mean, they map the <em>type</em> <code>Int</code>, as a single entity, to the type <code>Maybe Int</code>.</p></li>\n<li><p>A value-level function, which maps <em>morphisms</em> (i.e. Haskell functions) to morphisms. The target morphism always maps between the types that result from applying the type-level function to the domain and codomain of the original function.<br>This function is what you get with <code>fmap</code>:</p>\n\n<ul>\n<li><code>fmap :: (Int -&gt; Double) -&gt; (Maybe Int -&gt; Maybe Double)</code></li>\n<li><code>fmap :: (() -&gt; Bool) -&gt; (IO () -&gt; IO Bool)</code></li>\n<li><code>fmap :: (Char -&gt; String) -&gt; String -&gt; [String]</code>.</li>\n</ul></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 5184, "user_id": 1935631, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0e4d0d6c5ce5e9350cacc818ee350347?s=128&d=identicon&r=PG", "display_name": "Sassa NF", "link": "https://stackoverflow.com/users/1935631/sassa-nf"}, "edited": false, "score": 0, "creation_date": 1530829243, "post_id": 36449504, "comment_id": 89382838, "body": "<code>instance Functor ((-&gt;)a) where fmap = (.)</code> does not have &quot;a container&quot; type."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1459941292, "creation_date": 1459941292, "answer_id": 36449504, "question_id": 36448563, "link": "https://stackoverflow.com/questions/36448563/whats-the-difference-between-a-function-and-a-functor-in-haskell-only-definiti/36449504#36449504", "title": "What&#39;s the difference between a function and a functor in Haskell? Only definition?", "body": "<p>For something to be a functor - you need two things:</p>\n\n<ul>\n<li>a container type*</li>\n<li>a special function that converts a function from containees to a function converting containers</li>\n</ul>\n\n<p>the first is depending on your own definition but the second one has been codified in the \"interface\" called <code>Functor</code> and the conversion function has been named <code>fmap</code>.</p>\n\n<p>thus you always start with something like</p>\n\n<pre><code>data Maybe a = Just a | Nothing\n\ninstance Functor Maybe where\n    -- fmap :: (a -&gt; b) -&gt; Maybe a -&gt; Maybe b\n    fmap f (Just a) = Just (f a)\n    fmap _ Nothing = Nothing\n</code></pre>\n\n<p>Functions on the other hand - do not need a container to work - so they are not related to Functor in that kind of way. On the other hand every Functor, has to implement the function <code>fmap</code> to earn its name.</p>\n\n<p>Moreover convention wants a <code>Functor</code> to adhere to certain laws - but this cannot be enforced by the compiler/type checker.</p>\n\n<p><sub>*: this container can also be a phantom type, e.g. <code>data Proxy a = Proxy</code> in this case the name <em>container</em> is debatable, but I would still use that name</sub></p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1459941853, "creation_date": 1459941853, "answer_id": 36449697, "question_id": 36448563, "link": "https://stackoverflow.com/questions/36448563/whats-the-difference-between-a-function-and-a-functor-in-haskell-only-definiti/36449697#36449697", "title": "What&#39;s the difference between a function and a functor in Haskell? Only definition?", "body": "<ol start=\"3\">\n<li>Not everything in Haskell is a function. Non-functions include <code>\"Hello World\"</code>, <code>(3 :: Int, 'a')</code>, and <code>Just 'x'</code>. Things whose types include <code>=&gt;</code> are not necessarily functions either, although GHC (generally) translates them into functions in its intermediate representation.</li>\n</ol>\n\n<p>What is a functor? Given categories C and D, a functor f from C to D consists of a mapping fo from the objects of C into the objects of D and a mapping fm from the morphisms of C into the morphisms of D such that</p>\n\n<ol>\n<li>If x and y are objects in C and p is a morphism from x to y then fm(p) is a morphism from fo(x) to fo(y).</li>\n<li>If x is an object in C and id is the identity morphism from x to x then fm(id) is the identity morphism from fo(x) to fo(x).</li>\n<li>If x, y, and z are objects in C, p is a morphism from y to z, and q is a morphism from x to y, then fm(p . q) = fm(p).fm(q), where the dot represents morphism composition.</li>\n</ol>\n\n<p>How does this relate to Haskell? We like to think of Haskell types and Haskell functions between them as forming a category. This is only approximately true, for various reasons, but it's a useful guide to intuition. The <code>Functor</code> class then represents injective endofunctors from this <strong>Hask</strong> category to itself. In particular, a <code>Functor</code> consists of a mapping (specifically a type constructor or partial application of type constructor) from types to types, along with a mapping (the <code>fmap</code> function) from functions to functions which obeys the above laws.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1459947889, "post_id": 36451576, "comment_id": 60516764, "body": "\u201cEach category has two properties:\u201d <b>3.</b> identity and composition obey the laws <code>id \u2218 f \u2261 f \u2218 id \u2261 f</code> and <code>(f \u2218 g) \u2218 h \u2261 f \u2218 (g \u2218 h)</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1459957048, "post_id": 36451576, "comment_id": 60524114, "body": "These aren&#39;t <i>all</i> the endofunctors on <b>Hask</b>, though. A type family matched with an appropriate function could be a functor, but never a <code>Functor</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1459957637, "post_id": 36451576, "comment_id": 60524575, "body": "I haven&#39;t learned type families yet, so I couldn&#39;t explain them in categorical terms."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1459960128, "post_id": 36451576, "comment_id": 60526388, "body": "Well, a type family is interesting in this regard because it can potentially map two different types to one, and because it doesn&#39;t &quot;mark&quot; its results with a type constructor. So type family+function seems a more precise representation in Haskell of the <i>idea</i> of an endofunctor, but that doesn&#39;t fit into the typeclass system nearly as neatly as <code>Functor</code> does."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1459957766, "last_edit_date": 1459957766, "creation_date": 1459946694, "answer_id": 36451576, "question_id": 36448563, "link": "https://stackoverflow.com/questions/36448563/whats-the-difference-between-a-function-and-a-functor-in-haskell-only-definiti/36451576#36451576", "title": "What&#39;s the difference between a function and a functor in Haskell? Only definition?", "body": "<p>It helps to know a little category theory. A category is just a set of objects with arrows between them. They can model many things in mathematics, but for our purposes we are interested in the category of type; <strong>Hask</strong> is the category of Haskell types, with each type being an object in <strong>Hask</strong> and each function being an arrow between the argument type and the return type. For example, <code>Int</code>, <code>Char</code>, <code>[Char]</code>, and <code>Bool</code> are all objects in <strong>Hask</strong>, and <code>ord :: Char -&gt; Int</code>, <code>odd :: Int -&gt; Bool</code>, and <code>repeat :: Char -&gt; [Char]</code> would be some examples of arrows in <strong>Hask</strong>.</p>\n\n<p>Each category has several properties:</p>\n\n<ol>\n<li><p>Every object has an identity arrow.</p></li>\n<li><p>Arrows compose, so that if <code>a -&gt; b</code> and <code>b -&gt; c</code> are arrows, then so is <code>a -&gt; c</code>.</p></li>\n<li><p>Identity arrows are both left and right identities for composition.</p></li>\n<li><p>Composition is associative.</p></li>\n</ol>\n\n<p>The reason that <strong>Hask</strong> is a category is that every type has an identity function, and functions compose. That is, <code>id :: Int -&gt; Int</code> and <code>id :: Char -&gt; Char</code> are identity arrows for the category, and <code>odd . ord :: Char -&gt; Bool</code> are composed arrows.</p>\n\n<p>(Ignore for now that we think of <code>id</code> is polymorphic function with type <code>a -&gt; a</code> instead of a bunch of separate functions with concrete types. This demonstrates a concept in category theory called a <em>natural transformation</em> that you don't need to think about now.)</p>\n\n<hr>\n\n<p>In category theory, a functor F is a mapping between two categories; it maps each object of one category to an object of the other, and it <em>also</em> maps each arrow of one category to an arrow of the other. If <code>a</code> is an object in one category, we say that F a is the object in the other category. We also say that if f is an arrow in the first category, the corresponding arrow in the other if F f.</p>\n\n<p>Not just any mapping is a functor. It has to obey two properties which should look familiar.</p>\n\n<ol>\n<li>F has to map the identity arrow for an object a to the identity arrow of the object F a.</li>\n<li>F has to preserve composition. That means that the composition of two arrows in the first category has to be mapped to the composition of the corresponding arrows in the other category. That is, if <code>h = g \u2218 f</code> is in the first category, then <code>h</code> is mapped to <code>F h = F g \u2218 F f</code> in the other.</li>\n</ol>\n\n<p>Finally, an <em>endofunctor</em> is a special name for a functor that maps one category to <em>itself</em>. In <strong>Hask</strong>, the typeclass <code>Functor</code> captures the idea of an endofunctor from <strong>Hask</strong> to <strong>Hask</strong>. The type constructor itself maps the types, and <code>fmap</code> is used to map the arrows.</p>\n\n<hr>\n\n<p>Let's take <code>Maybe</code> as an example. The type constructor <code>Maybe</code> is an endofuntor, because it maps objects in <strong>Hask</strong> (types) to other objects in <strong>Hask</strong> (other types). (This point is obscured a little bit since we don't have new names for the target types, so think of <code>Maybe</code> as mapping <code>Int</code> to the type <code>Maybe Int</code>.)</p>\n\n<p>To map an arrow <code>a -&gt; b</code> to <code>Maybe a -&gt; Maybe b</code>, we provide a defintion for <code>fmap</code> in the instance of <code>Maybe Int</code>.\n<code>Maybe</code> also maps functions, but using the name <code>fmap</code> instead. The functor laws it must obey are the same as two listed in the definition of a functor.</p>\n\n<ol>\n<li><code>fmap id = id</code>  (Maps <code>id :: Int -&gt; Int</code> to <code>id :: Maybe Int -&gt; Maybe Int</code>.</li>\n<li><code>fmap f . fmap g = fmap f . g</code> (That is, <code>fmap odd . fmap ord $ x</code> has to return the same value as <code>fmap (odd . ord) $ x</code> for any possible value <code>x</code> of type <code>Maybe Int</code>.</li>\n</ol>\n\n<hr>\n\n<p>As an unrelated tangent, others have pointed out that some things in Haskell are not functions, namely literal values like <code>4</code> and <code>\"hello\"</code>. While true in the programming language (you can't, for instance, compose <code>4</code> with another function that takes an <code>Int</code> as a value), it <em>is</em> true that in category theory that you can replace values with functions from the unit type <code>()</code> to the type of the value. That is, the literal value 4 can be thought of as an arrow <code>4 :: () -&gt; Int</code> that, when applied to the (only) value of type <code>()</code>, it returns a value of type <code>Int</code> corresponding to the integer 4. This arrow would compose like any other; <code>odd . 4 :: () -&gt; Bool</code> would map the value from the unit type to a Boolean value indicating whether the integer 4 is odd or not.</p>\n\n<p>Mathematically, this is nice. We don't have to define any structure for types; they just <em>are</em>, and since we already have the idea of a type defined, we don't need a separate definition for what a value of a type is; we just just define them in terms of functions. (You might notice we still need an actual value from the unit type, though. There might be a way of avoiding that in our definition, but I don't know category theory well enough to explain that one way or the other.)</p>\n\n<p>For the actual implementation of our programming language, think of literal values as being an optimization to avoid the conceptual and performance overhead of having to use <code>4 ()</code> in place of <code>4</code> every time we just want a constant value.</p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1108, "favorite_count": 2, "accepted_answer_id": 36451576, "answer_count": 5, "score": 3, "last_activity_date": 1520993769, "creation_date": 1459938996, "question_id": 36448563, "link": "https://stackoverflow.com/questions/36448563/whats-the-difference-between-a-function-and-a-functor-in-haskell-only-definiti", "title": "What&#39;s the difference between a function and a functor in Haskell? Only definition?", "body": "<p>In Haskell, when writing a function, it means we map something(input) to another thing(output). I tried LYAH to understand the definition of Functor: seems just the same like a normal Functor.</p>\n\n<ol>\n<li>Is there any restriction that a function could be called a Functor?</li>\n<li>Is Functor allowed to have I/O or any other side effect?</li>\n<li>If in Haskell, \"everthing is a function\", then what's the point of introducing the \"Functor\" concept? A restricted version of function, or an enhancement version of a function?</li>\n</ol>\n\n<p>Very confused, need your advice.\nThanks.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 2, "creation_date": 1459995614, "post_id": 36448506, "comment_id": 60542568, "body": "There is an open issue for this feature request: <a href=\"https://github.com/commercialhaskell/stack/issues/1933\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/1933</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1238, "user_id": 2929228, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/cb14a0ca1c489bdb92f63429a6a5cff2?s=128&d=identicon&r=PG&f=1", "display_name": "Sam P", "link": "https://stackoverflow.com/users/2929228/sam-p"}, "edited": false, "score": 0, "creation_date": 1459941787, "post_id": 36448659, "comment_id": 60511911, "body": "Is there a way to automate deps being added to the cabal file? It&#39;s nice using package managers from other languages when they handle adding the dependencies with the correct version to the file for you. Or is this a deliberate design decision?"}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 1238, "user_id": 2929228, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/cb14a0ca1c489bdb92f63429a6a5cff2?s=128&d=identicon&r=PG&f=1", "display_name": "Sam P", "link": "https://stackoverflow.com/users/2929228/sam-p"}, "edited": false, "score": 1, "creation_date": 1459942476, "post_id": 36448659, "comment_id": 60512458, "body": "I don&#39;t think there&#39;s a way to automate it. I think it&#39;s an intentional decision based on how complex <code>.cabal</code> files can be and that you may have multiple packages and multiple <code>.cabal</code> files in a single Stack project. By nature, it isn&#39;t as simple as, for example, a <code>packages.json</code> file in a node project."}, {"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 3, "creation_date": 1459995574, "post_id": 36448659, "comment_id": 60542558, "body": "Stack also supports a <code>package.yaml</code> file, which is much simpler than <code>.cabal</code> files. <a href=\"https://github.com/sol/hpack\" rel=\"nofollow noreferrer\">hpack</a> turns the YAML file into a Cabal file."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 4, "last_activity_date": 1459939242, "creation_date": 1459939242, "answer_id": 36448659, "question_id": 36448506, "link": "https://stackoverflow.com/questions/36448506/how-to-get-stack-to-save-dependencies/36448659#36448659", "title": "How to get stack to save dependencies?", "body": "<p>You still keep your dependencies in a <code>.cabal</code> file. From <a href=\"http://docs.haskellstack.org/en/stable/faq/\" rel=\"nofollow\">the Stack FAQ</a>:</p>\n\n<blockquote>\n  <ul>\n  <li>A .cabal file is provided for each package, and defines all package-level metadata just like it does in the cabal-install world: modules, executables, test suites, etc. No change at all on this front.</li>\n  <li>A stack.yaml file references 1 or more packages, and provides information on where dependencies come from.</li>\n  </ul>\n</blockquote>\n\n<p>If you need additional versions of dependencies than the LTS Haskell snapshot you're using, you'll add them to the <a href=\"http://docs.haskellstack.org/en/stable/faq/#i-need-to-use-a-different-version-of-a-package-than-what-is-provided-by-the-lts-haskell-snapshot-im-using-what-should-i-do\" rel=\"nofollow\"><code>extra-deps</code> portion of the stack.yaml file</a>.</p>\n"}], "owner": {"reputation": 1238, "user_id": 2929228, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/cb14a0ca1c489bdb92f63429a6a5cff2?s=128&d=identicon&r=PG&f=1", "display_name": "Sam P", "link": "https://stackoverflow.com/users/2929228/sam-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 36448659, "answer_count": 1, "score": 0, "last_activity_date": 1483518778, "creation_date": 1459938826, "last_edit_date": 1483518778, "question_id": 36448506, "link": "https://stackoverflow.com/questions/36448506/how-to-get-stack-to-save-dependencies", "title": "How to get stack to save dependencies?", "body": "<p>I'm using the <code>stack install</code> command to save dependencies for a new project. How do I get it to save those dependencies into <code>stack.yaml</code>? Unless I'm missing something, I can't see where stack is recording the project dependencies and I can't seem to find anything in a docs about this.</p>\n"}, {"tags": ["haskell", "command-line-arguments", "optparse-generic"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459940876, "post_id": 36446923, "comment_id": 60511250, "body": "I think optparse-generic is pretty limited in what sorts of types in can automatically create a parser for. The docs say it doesn&#39;t support nested record fields. You may have to write the parser yourself with optparse-applicative. See <a href=\"https://hackage.haskell.org/package/optparse-applicative-0.12.1.0/docs/Options-Applicative-Builder.html\" rel=\"nofollow noreferrer\">subparser and command</a>."}, {"owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "edited": false, "score": 0, "creation_date": 1460022298, "post_id": 36446923, "comment_id": 60555240, "body": "Is your question related to <a href=\"https://github.com/Gabriel439/Haskell-Optparse-Generic-Library/issues/18\" rel=\"nofollow noreferrer\">github.com/Gabriel439/Haskell-Optparse-Generic-Library/issue&zwnj;&#8203;s/&hellip;</a> ?"}], "owner": {"reputation": 7520, "user_id": 2143551, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vAzam.png?s=128&g=1", "display_name": "corny", "link": "https://stackoverflow.com/users/2143551/corny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459934798, "creation_date": 1459934798, "last_edit_date": 1495540241, "question_id": 36446923, "link": "https://stackoverflow.com/questions/36446923/haskell-combining-subcommands-with-other-parsing-option-in-optparse-generic", "title": "Haskell, combining subcommands with other parsing option in optparse-generic", "body": "<p>I'm using <a href=\"https://hackage.haskell.org/package/optparse-generic\" rel=\"nofollow noreferrer\">optparse-generic</a> to parse the command line arguments of a program called <code>example</code>. I am combining labeled and unlabeled datatypes (as <a href=\"https://stackoverflow.com/questions/36375556/haskell-unnamed-command-line-arguments-for-optparse-generic\">asked before</a>).</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Labeled = Labeled { foo :: Maybe Int &lt;?&gt; \"Help about foo\" } deriving (Generic, Show)\n\ninstance ParseRecord Labeled\n\ndata Unlabeled = Unlabeled (String &lt;?&gt; \"Help about the mandatory last argument.\") deriving (Generic, Show)\n\ninstance ParseRecord Unlabeled\n\ndata Mixed = Mixed Labeled Unlabeled deriving (Show)\n\ninstance ParseRecord Mixed where\n    parseRecord = Mixed &lt;$&gt; parseRecord &lt;*&gt; parseRecord\n</code></pre>\n\n<p>It generates the following help text.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>Usage: example [--foo INT] STRING\n\nAvailable options:\n  -h,--help                Show this help text\n  --foo INT                Help about foo \n  STRING                   Help about the mandatory last argument.\n</code></pre>\n\n<p>Now I would like to extend <code>example</code> to support different modular tasks. For example, as shown in the <a href=\"https://hackage.haskell.org/package/optparse-generic-1.1.0/docs/Options-Generic.html\" rel=\"nofollow noreferrer\">documentation</a>, let's assume <code>example</code> can perform a <code>Create</code> and a <code>Kill</code> task. Each task may need different command line options.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data ExampleTasks\n    = Create { name :: Text, duration :: Maybe Int }\n    | Kill   { name :: Text }\n    deriving (Generic, Show)\n</code></pre>\n\n<p><strong>Question 1:</strong> \nI would like to combine these things such that a user can now additionally select the task which will be performed by <code>example</code>. How can this be achieved?</p>\n\n<p>For example, I want to be able to call <code>example</code> as follows:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>./example --foo 42 --task kill --name=foo \"the last mandatory argument\"\n</code></pre>\n\n<p>or</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>./example --task create --name=foo --duration 60 /bin/bash\n</code></pre>\n\n<p>The help text should look similar to something like the following (or maybe a nicer and clearer structure):</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>Usage: example [--foo INT] (--task TASKNAME TASKOPTIONS) STRING\n\nAvailable options:\n  -h,--help                Show this help text\n  --foo INT                Help about foo \n  STRING                   Help about the mandatory last argument.\n\nAvailable tasks:\n  create                   Help about create\n  kill                     Help about kill\n\nAvailable taskoptions for create:\n  --name STRING            Help about the name in create\n  --duration ...           In seconds\n\nAvailable taskoptions for kill\n  --name STRING            Help about the name\n</code></pre>\n\n<p><strong>Question 2:</strong> Can the whole <code>--task</code> argument and its parameters be optional? For example, I'd like to call:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>./example --foo 42 \"the last mandatory argument\"\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1459944029, "post_id": 36445713, "comment_id": 60513636, "body": "The above is parsed as <code>(replicate&#39;) - (1 123)</code> where the last part means &quot;function <code>1</code> applied to argument <code>123</code>&quot;, whcih makes no sense. The type checker then complains that <code>replicate&#39;</code> has not a numeric type: <code>Num (i-&gt;a-&gt;[a])</code> has no instance."}, {"owner": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459948213, "post_id": 36445713, "comment_id": 60517048, "body": "@chi thanks for the explanation."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "edited": false, "score": 0, "creation_date": 1459932525, "post_id": 36445803, "comment_id": 60505055, "body": "Thank you for your quick response.Can you explain about why we have to use (Num a,Ord a) ?"}], "tags": [], "owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "is_accepted": true, "score": 3, "last_activity_date": 1459931974, "creation_date": 1459931974, "answer_id": 36445803, "question_id": 36445713, "link": "https://stackoverflow.com/questions/36445713/self-defined-function-to-replicate-a-number-and-return-a-list/36445803#36445803", "title": "Self defined Function to replicate a Number and return a List?", "body": "<p>Surround the negative number with parentheses i.e. <code>myreplica (-1) 123</code>. However, you might instead want to add a special case using <code>error</code> for negative numbers in first argument, since it doesn't make sense to repeat something a negative number of times.</p>\n\n<p><a href=\"http://rextester.com/ZLJH64460\" rel=\"nofollow\">Demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 0, "last_activity_date": 1459932432, "creation_date": 1459932432, "answer_id": 36445973, "question_id": 36445713, "link": "https://stackoverflow.com/questions/36445713/self-defined-function-to-replicate-a-number-and-return-a-list/36445973#36445973", "title": "Self defined Function to replicate a Number and return a List?", "body": "<p>You dont really need <code>(Num a, Ord a)</code>, but it is reconmedable, also notice that it is better to use the <code>(:)</code>function instead of '(++)' as follows:</p>\n\n<pre><code> myreplica :: (Num a,Ord a) =&gt; a -&gt; b -&gt; [b]\n myreplica num val \n         | num &lt;= 0  = []\n         | otherwise = val : myreplica (num-1) val\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 36445803, "answer_count": 2, "score": 0, "last_activity_date": 1459932432, "creation_date": 1459931744, "question_id": 36445713, "link": "https://stackoverflow.com/questions/36445713/self-defined-function-to-replicate-a-number-and-return-a-list", "title": "Self defined Function to replicate a Number and return a List?", "body": "<pre><code> myreplica :: (Num a,Ord a) =&gt; a -&gt; b -&gt; [b]\n myreplica num val \n         | num &lt;= 0 = []\n         | otherwise = [val] ++ myreplica (num-1) val\n</code></pre>\n\n<p>The above function takes two values Num and Val and returns a List L = [val,val...num times].The code works fine for 0 and positive values but when i give input like </p>\n\n<pre><code>\"ghci&gt; \" replicate' -1 123 \n\n&lt;interactive&gt;:72:1:\n    Non type-variable argument in the constraint: Num (i -&gt; a -&gt; [a])\n    (Use FlexibleContexts to permit this)\n   When checking that \u2018it\u2019 has the inferred type\n      it :: forall i a a1.\n            (Num i, Num a1, Num (i -&gt; a -&gt; [a]), Num (a1 -&gt; i -&gt; a -&gt; [a]),\n             Ord i) =&gt;\n            i -&gt; a -&gt; [a]\n</code></pre>\n\n<p>I get the following error message.How can I make it work for negative numbers?\n<strong>Why do we need (Num a,Ord a) constraint?</strong>  </p>\n"}, {"tags": ["haskell", "ghc", "typeclass", "inference", "unification"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1459932111, "post_id": 36445578, "comment_id": 60504787, "body": "It isn&#39;t a bug. <code>useStuffBAD _ = let x = stuff in (x, content x)</code> and <code>useStuffBAD2 = content . useStuffOK</code>. The type really is ambiguous there - you could be referring to any <code>stuff</code> in either of those expressions. <code>useStuffOK</code> works because the output type is given by the type signature. Since <code>content :: Stuff a -&gt; String</code> does not mention the type <code>a</code> in the result, uses of this function are ambiguous if the type is not explicitly given or cannot be inferred from the context."}, {"owner": {"reputation": 124, "user_id": 1712404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade704f67cf97cec306b8b23fca89a95?s=128&d=identicon&r=PG", "display_name": "Rvion", "link": "https://stackoverflow.com/users/1712404/rvion"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459933760, "post_id": 36445578, "comment_id": 60505921, "body": "@user2407038 just edited my question: when I give the type explicitely, it doesn&#39;t work neither because ghc doesn&#39;t unify the <code>a</code> from the class declaration and the <code>a</code> from the class method. In my case, useStuffBAD is explicit about what instance it should choose. I still have the impression that this is a problem in ghc."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 3, "creation_date": 1459935328, "post_id": 36445578, "comment_id": 60507156, "body": "I think you maybe need <code>{-# LANGUAGE ScopedTypeVariables #-}</code> on top of your file for that to work - on its own ghc does not know that <code>Stuff a</code> from <code>(Stuff a, String)</code> is the same as <code>stuff :: Stuff a</code>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1459939370, "post_id": 36445578, "comment_id": 60510185, "body": "@Ravion the code in your update <a href=\"https://ideone.com/Wahdck\" rel=\"nofollow noreferrer\">compiles</a> (at least on 7.10.3) with nothing but <code>ScopedTypeVariables</code>, so you either haven&#39;t actually enabled, or you are using an older version which may actually have a bug."}, {"owner": {"reputation": 124, "user_id": 1712404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade704f67cf97cec306b8b23fca89a95?s=128&d=identicon&r=PG", "display_name": "Rvion", "link": "https://stackoverflow.com/users/1712404/rvion"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459943110, "post_id": 36445578, "comment_id": 60512926, "body": "@user2407038 you are right, my bad !"}, {"owner": {"reputation": 124, "user_id": 1712404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade704f67cf97cec306b8b23fca89a95?s=128&d=identicon&r=PG", "display_name": "Rvion", "link": "https://stackoverflow.com/users/1712404/rvion"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1459943201, "post_id": 36445578, "comment_id": 60512999, "body": "@epsilonhalbe thanks !"}], "answers": [{"tags": [], "owner": {"reputation": 124, "user_id": 1712404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade704f67cf97cec306b8b23fca89a95?s=128&d=identicon&r=PG", "display_name": "Rvion", "link": "https://stackoverflow.com/users/1712404/rvion"}, "is_accepted": true, "score": 0, "last_activity_date": 1459943272, "creation_date": 1459943272, "answer_id": 36450249, "question_id": 36445578, "link": "https://stackoverflow.com/questions/36445578/ghc-do-not-resolve-correctly-constraint-in-typeclass-methods-ghc-bug-limitati/36450249#36450249", "title": "GHC do not resolve correctly constraint in typeclass methods (ghc bug / limitation ?)", "body": "<p>as @epsilonhalbe and @user2407038 pointed out, I was missing ScopedTypeVariables extension</p>\n"}], "owner": {"reputation": 124, "user_id": 1712404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade704f67cf97cec306b8b23fca89a95?s=128&d=identicon&r=PG", "display_name": "Rvion", "link": "https://stackoverflow.com/users/1712404/rvion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 36450249, "answer_count": 1, "score": 0, "last_activity_date": 1459943272, "creation_date": 1459931364, "last_edit_date": 1459933935, "question_id": 36445578, "link": "https://stackoverflow.com/questions/36445578/ghc-do-not-resolve-correctly-constraint-in-typeclass-methods-ghc-bug-limitati", "title": "GHC do not resolve correctly constraint in typeclass methods (ghc bug / limitation ?)", "body": "<p>GHC do not resolve / propagate constraint in the default implementation of some of my class members. The behaviour is really strange and it seems to me like it's a bug.</p>\n\n<p>Can someone help me / explain to me what's wrong ?</p>\n\n<ol>\n<li>How can I tell GHC to unify the <code>a</code> from the class declaration and the <code>a</code> from the class method so the definition is not ambiguous</li>\n<li>Is there something I don't understand ?</li>\n</ol>\n\n<p>code:</p>\n\n<pre><code>module Foo where\nimport Data.Proxy\n\ndata Stuff a = Stuff\n  {content :: String}\n\nclass HasStuff a where\n  stuff :: Stuff a\n\n  -- This works\n  useStuffOK :: Proxy a -&gt; (Stuff a)\n  useStuffOK _ = (stuff)\n\n  -- those don't work, \n  -- (but I think ghc has all the information necessary to figure it out)\n  useStuffBAD :: Proxy a -&gt; (Stuff a, String)\n  useStuffBAD _ = (stuff, content (stuff :: Stuff a))\n  -- Could not deduce (HasStuff a1) arising from a use of \u2018stuff\u2019\n  -- from the context (HasStuff a)\n  --   bound by the class declaration for \u2018HasStuff\u2019\n  --   at Test.hs:(7,1)-(17,45)\n\n  useStuffBAD2 :: Proxy a -&gt; String\n  useStuffBAD2 _ = content (stuff :: Stuff a)\n  -- Could not deduce (HasStuff a1) arising from a use of \u2018stuff\u2019\n  -- from the context (HasStuff a)\n  --   bound by the class declaration for \u2018HasStuff\u2019\n  --   at Test.hs:(7,1)-(17,45)\n\ninstance HasStuff Int where\n  stuff = Stuff \"ok\"\n\n-- inference works here\nx :: Stuff Int\nx = stuff\n\n-- works here too\nx :: String\nx = content (stuff :: Stuff Int)\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1459940321, "post_id": 36445429, "comment_id": 60510861, "body": "You&#39;d have to drop the <code>Just</code> though: <code>readSquareTransition</code> already returns a Maybe something."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1459943821, "post_id": 36445429, "comment_id": 60513487, "body": "You should add parentheses around <code>readSquareTransition xs</code>, or a <code>$</code> before it, or use the infix <code>(&lt;$&gt;)</code> instead of <code>fmap</code>."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 3, "last_activity_date": 1459944329, "last_edit_date": 1459944329, "creation_date": 1459931003, "answer_id": 36445429, "question_id": 36445138, "link": "https://stackoverflow.com/questions/36445138/haskell-string-to-maybe-list/36445429#36445429", "title": "Haskell String to Maybe List", "body": "<p>Change this</p>\n\n<pre><code>'L' -&gt; Just (L : readSquareTransition xs)\n'R' -&gt; Just (R : readSquareTransition xs)\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>'L' -&gt; fmap (L :) $ readSquareTransition xs\n'R' -&gt; fmap (R :) $ readSquareTransition xs\n</code></pre>\n\n<p>The problem is that readSquareTransition returns a <code>Maybe [SquareTurn]</code>, so you can't apply <code>(:)</code> to it (<code>(:)</code> requires a List).  <code>fmap</code> however lets you apply into the <code>Just</code> (while preserving a <code>Nothing</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 3, "last_activity_date": 1459940552, "creation_date": 1459940552, "answer_id": 36449203, "question_id": 36445138, "link": "https://stackoverflow.com/questions/36445138/haskell-string-to-maybe-list/36449203#36449203", "title": "Haskell String to Maybe List", "body": "<p>A modular way of doing this would be to define <code>readSquareTurn</code> first which defines how to turn a <code>Char</code> into a single <code>SquareTurn</code> (with the possibility of failure):</p>\n\n<pre><code>readSquareTurn :: Char -&gt; Maybe SquareTurn\nreadSquareTurn x = case x of\n  'L' -&gt; Just L\n  'R' -&gt; Just R\n  _   -&gt; Nothing\n</code></pre>\n\n<p>and then use <code>mapM :: (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe [b]</code> to process the whole <code>String</code> like so:</p>\n\n<pre><code>readSquareTransition :: String -&gt; Maybe [SquareTurn]\nreadSquareTransition = mapM readSquareTurn\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6165390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad035214660d26a3b717e2d0b17f1f63?s=128&d=identicon&r=PG&f=1", "display_name": "Feng Sidong", "link": "https://stackoverflow.com/users/6165390/feng-sidong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 36449203, "answer_count": 2, "score": 3, "last_activity_date": 1459944329, "creation_date": 1459930189, "question_id": 36445138, "link": "https://stackoverflow.com/questions/36445138/haskell-string-to-maybe-list", "title": "Haskell String to Maybe List", "body": "<pre><code>readSquareTransition :: String -&gt; Maybe [SquareTurn]\nreadSquareTransition [] = Just []\nreadSquareTransition (x:xs) = case x of\n      'L' -&gt; Just (L : readSquareTransition xs)\n      'R' -&gt; Just (R : readSquareTransition xs)\n       _      -&gt; Nothing\n</code></pre>\n\n<p>I want to get Just [L,L,R,R]. But looks like i failed :( Here is the error message!</p>\n\n<pre><code>src/StudentSources/LangtonsAnt.hs:231:24:\nCouldn't match expected type \u2018[SquareTurn]\u2019\n            with actual type \u2018Maybe [SquareTurn]\u2019\nIn the second argument of \u2018(:)\u2019, namely \u2018readSquareTransition xs\u2019\nIn the first argument of \u2018Just\u2019, namely\n  \u2018(L : readSquareTransition xs)\u2019\n\nsrc/StudentSources/LangtonsAnt.hs:232:24:\nCouldn't match expected type \u2018[SquareTurn]\u2019\n            with actual type \u2018Maybe [SquareTurn]\u2019\nIn the second argument of \u2018(:)\u2019, namely \u2018readSquareTransition xs\u2019\nIn the first argument of \u2018Just\u2019, namely\n  \u2018(R : readSquareTransition xs)\u2019\n</code></pre>\n"}, {"tags": ["haskell", "prototype", "raytracing"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1459931787, "post_id": 36445088, "comment_id": 60504583, "body": "If you are going the existential quantification route, then the output has to be existentially quantified as well. This is likely an overly complex representation, all of these &quot;things&quot; which you&#39;ve described should just be datatypes. As an aside, the type system is there to help, not hinder you, so if you are fighting against it, it&#39;s almost certainly the case that you&#39;ve modeled something incorrectly."}], "answers": [{"comments": [{"owner": {"reputation": 456, "user_id": 2899125, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d598986370ac4fc07224de45128ad429?s=128&d=identicon&r=PG&f=1", "display_name": "darwinsenior", "link": "https://stackoverflow.com/users/2899125/darwinsenior"}, "edited": false, "score": 0, "creation_date": 1461026109, "post_id": 36682857, "comment_id": 61000864, "body": "Thanks for that. Originally I was translating the C++ code to Haskell. And now I finished the code. The performance is far better than I think, but I still cannot reason about it very well. For the suggestion for function over object, I always have a mental model where in C++ callable function is way faster than lambda closure and for me material has actually two functions."}, {"owner": {"reputation": 456, "user_id": 2899125, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d598986370ac4fc07224de45128ad429?s=128&d=identicon&r=PG&f=1", "display_name": "darwinsenior", "link": "https://stackoverflow.com/users/2899125/darwinsenior"}, "edited": false, "score": 0, "creation_date": 1461026675, "post_id": 36682857, "comment_id": 61000996, "body": "I really enjoy haskell. So, what is the idiomatic way of writing haskell? I currently really like the language after this raytracing project. It is just so easy to write new features without worry about existing code.  Currently I used a reader monad for all raytracing settings and a random monad below for any function that needs sampling. Is that a bad practice?"}, {"owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "reply_to_user": {"reputation": 456, "user_id": 2899125, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d598986370ac4fc07224de45128ad429?s=128&d=identicon&r=PG&f=1", "display_name": "darwinsenior", "link": "https://stackoverflow.com/users/2899125/darwinsenior"}, "edited": false, "score": 0, "creation_date": 1461180931, "post_id": 36682857, "comment_id": 61087223, "body": "@darwinsenior: As you will probably be using rendering settings and random numbers a lot throughout the renderer, it is probably perfectly fine. In particular since you split out the constant data into reader instead of just putting everything into a single state. You may still try to keep out the monad of all functions that need neither render settings nor random numbers."}, {"owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "reply_to_user": {"reputation": 456, "user_id": 2899125, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d598986370ac4fc07224de45128ad429?s=128&d=identicon&r=PG&f=1", "display_name": "darwinsenior", "link": "https://stackoverflow.com/users/2899125/darwinsenior"}, "edited": false, "score": 0, "creation_date": 1461181344, "post_id": 36682857, "comment_id": 61087467, "body": "@darwinsenior: I cannot comment too much on the performance of functions. However, the functions of a type-class get stored in something similar to a &quot;vtable&quot; in C++. So in cases where the compiler cannot optimize it away, calls to functions of a type-class may be more expensive due to an additional indirection. Function vs lambda: Remember that in Haskell, all functions are lambdas: &quot;foo x = x+1&quot; is just short-hand for: &quot;foo = \\x -&gt; x+1&quot;. However, actual closures get allocated on the heap, and may be more expensive, the more variables they capture."}], "tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": false, "score": 1, "last_activity_date": 1460931668, "creation_date": 1460931668, "answer_id": 36682857, "question_id": 36445088, "link": "https://stackoverflow.com/questions/36445088/any-idea-how-to-build-a-more-complete-raytracer-in-haskell/36682857#36682857", "title": "Any idea how to build a more complete raytracer in Haskell?", "body": "<p>As a beginner you should try to avoid language extensions, because they can mislead you to less ideomatic solutions.</p>\n\n<p>In Haskell, you sometimes rely on functions for polymorphism where you would use inheritance in other languages. Consider this simple sketch, which prefers functions over \"objects\":</p>\n\n<pre><code>type Geometry = Ray -&gt; Intersection\ntype Material = UV -&gt; Color\n\ndata Object = Object { objGeometry :: Geometry\n                     , objMaterial :: Material\n                     }\n\nblackbody :: Material\nblackbody uv = RGB 0 0 0\n\nsphere :: Double -&gt; Geometry\nsphere radius ray = ...\n</code></pre>\n\n<p>Of course, to get reasonable performance, this would need to be extended with bounding boxes and other optimizations. Still, it shows that you can approach the problem from a completely different side.</p>\n\n<h2>About your implementation</h2>\n\n<p>This looks more like a proper type for <code>Object</code>:</p>\n\n<pre><code>data Object geo mat = Object ...\n</code></pre>\n\n<p>The constraint <code>(Geometry geo, Material mat) => </code> should instead go on the functions which handle <code>Object</code>, and only when they actually need it.</p>\n\n<p><code>raytrace_objects</code> will not work this way, because the <code>objects</code> parameter is of type <em>list</em> (<code>[]</code>). All elements in a list must be of the same type. This type is fixed at compile time. <code>Object geo mat</code> is <em>not</em> a plain type, because the parameters are not yet known. So there cannot be any actual values of this type. <code>Object Sphere Wood</code> might be a suitable type. Thus, <code>[Object Sphere Wood]</code> is a list that can only contain wooden spheres.</p>\n\n<p><strong>Food for thought and search engines:</strong> <code>Object geo mat</code> (which is a short notation for <code>forall geo mat. Object geo mat</code>) is a <em>higher-order type</em> which has <em>kind</em> <code>* -> * -> * </code>. <code>[x]</code> has kind <code>* -> * </code>, and <code>[Int]</code> has kind <code>* </code>.</p>\n\n<p>This is a key difference between algebraic data types with type-classes in contrast to object-oriented programming: The Haskell compiler needs to know <em>all</em> types at compile time, whereas OO languages typically only need to know an interface and do not care about the actual runtime type.</p>\n\n<p>Higher-order types and type-classes are more like <em>templates</em> in C++.</p>\n\n<h2>Further pointers</h2>\n\n<p>You could solve your problem at hand with heterogenous lists (e.g. <code>HList</code> from <a href=\"https://hackage.haskell.org/package/HList\" rel=\"nofollow\">Hackage</a>), which work more like OO lists in the sense that they can accept objects of varying types. Or you try more idiomatic solutions like the one outlined above.</p>\n"}], "owner": {"reputation": 456, "user_id": 2899125, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d598986370ac4fc07224de45128ad429?s=128&d=identicon&r=PG&f=1", "display_name": "darwinsenior", "link": "https://stackoverflow.com/users/2899125/darwinsenior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460931668, "creation_date": 1459930063, "question_id": 36445088, "link": "https://stackoverflow.com/questions/36445088/any-idea-how-to-build-a-more-complete-raytracer-in-haskell", "title": "Any idea how to build a more complete raytracer in Haskell?", "body": "<p>I am currently take a course on production graphics and since we are spend the whole semester building a raytracer I would like to experiment as much as possible. I used to use C++ but it gets really messy at some point. And I trust haskell as a very good language for prototyping, and clean code. However, I would really appreciate some advice as now I could not find a way for data representation.</p>\n\n<p>Here is currently what I thought.</p>\n\n<p>A raytracer in general is a <code>scene</code> as an environment so I might use a monad (build upon state monad probably) to connect different part in the tracer.</p>\n\n<p><code>Camera</code> is the simplest. It has Position and Direction and can be moved around and rotate.</p>\n\n<p>The other parts become tricky. I wish to have <code>Screen</code> which could either generate pinhole or depth of field, and a list of <code>lights</code> that could be <code>environment</code>, <code>point light</code>, <code>area light</code> or <code>directional light</code>. The objects in the <code>scene</code> is made up by <code>material</code> and <code>geometry</code> where material might have <code>phong</code> or <code>glossy</code> or <code>transparent</code> so on and so forth, and <code>geometry</code> could be <code>sphere</code> <code>triangle</code> <code>plane</code> or a bunch of them (I am thinking <code>bhv</code> or <code>kdtree</code> as representation)</p>\n\n<p>So, if I am in C++, I am pretty sure I will use inheritance to express such polymorphism. However, I am stuck on how should I represent that in haskell.</p>\n\n<p>My initial attempt (if I do not have to consider secondary ray at all) is to use <code>typeclass</code>. So I have something like this</p>\n\n<pre><code>class Geometry geo where\n    intersect :: geo -&gt; Ray -&gt; Intersection\nclass Material mat where\n    shade :: (Light l) =&gt; mat -&gt; Intersection -&gt; l -&gt; Color\n</code></pre>\n\n<p>And so I define my Objects in the following way. I looked up and I tend to use <code>RankNTypes</code> (I think I made a mistake here)</p>\n\n<pre><code>data Object = forall . geo mat (Geometry geo, Material mat) =&gt; Object geo mat \n</code></pre>\n\n<p>Then I found I could not go on if I plan to implement the following function.</p>\n\n<pre><code>raytrace_objects :: (Material mat) =&gt; Ray -&gt; [Objects] -&gt; (Intersection, mat)\nraytrace_objects ray objects =\n  foldl reduce (farest_intersection, blackbody) objects\n  where\n    reduce (Object geo mat) old@(old_inter, _) =\n      if new_inter &lt; old_inter\n        then (new_inter, mat)\n        else old\n      where\n        new_inter = intersect ray geo\n</code></pre>\n\n<p>And <code>blackbody</code> just return black for the shading function</p>\n\n<p>Suddenly I found that it is impossible!!!! <code>mat</code> has to match the material type whatever the nearest objects has. And it is not decidable during the static analysis. So, I am stuck. Is there any suggestion how I could surpass the haskell's type system or is there a better way to do it?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6165221, "user_type": "registered", "profile_image": "https://graph.facebook.com/737180216384995/picture?type=large", "display_name": "Jonathan  Zhuang", "link": "https://stackoverflow.com/users/6165221/jonathan-zhuang"}, "edited": false, "score": 0, "creation_date": 1459929466, "post_id": 36444532, "comment_id": 60503228, "body": "Thanks a lot about the answer of constructor field name. It&#39;s solved now."}, {"owner": {"reputation": 9, "user_id": 6165221, "user_type": "registered", "profile_image": "https://graph.facebook.com/737180216384995/picture?type=large", "display_name": "Jonathan  Zhuang", "link": "https://stackoverflow.com/users/6165221/jonathan-zhuang"}, "edited": false, "score": 0, "creation_date": 1459929528, "post_id": 36444532, "comment_id": 60503268, "body": "But may i ask for a solution of the &quot;not in scope: &quot;x&quot;&quot; ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 9, "user_id": 6165221, "user_type": "registered", "profile_image": "https://graph.facebook.com/737180216384995/picture?type=large", "display_name": "Jonathan  Zhuang", "link": "https://stackoverflow.com/users/6165221/jonathan-zhuang"}, "edited": false, "score": 0, "creation_date": 1459943659, "post_id": 36444532, "comment_id": 60513352, "body": "@JonathanZhuang <code>x</code> was not declared at all... I&#39;m not sure about what your are trying to achieve with that line."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1459928483, "creation_date": 1459928483, "answer_id": 36444532, "question_id": 36444392, "link": "https://stackoverflow.com/questions/36444392/what-is-is-not-a-visible-constructor-field-name-mean/36444532#36444532", "title": "What is &quot;is not a (visible) constructor field name&quot; mean?", "body": "<pre><code>new_cell = old_cell { old_cellstate = new_cellstate}\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>new_cell = old_cell { cellState = new_cellstate}\n</code></pre>\n\n<p>You have to use the <em>name</em> of the field on the left of the <code>=</code> sign, not the previous value of said field. The name of the field is the one which was used in the <code>data T = K { fieldName :: Type , ... }</code> declaration.</p>\n\n<p>There is a similar issue for <code>squareWorld</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 6165221, "user_type": "registered", "profile_image": "https://graph.facebook.com/737180216384995/picture?type=large", "display_name": "Jonathan  Zhuang", "link": "https://stackoverflow.com/users/6165221/jonathan-zhuang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459928483, "creation_date": 1459928091, "last_edit_date": 1459928291, "question_id": 36444392, "link": "https://stackoverflow.com/questions/36444392/what-is-is-not-a-visible-constructor-field-name-mean", "title": "What is &quot;is not a (visible) constructor field name&quot; mean?", "body": "<pre><code>changecolour :: SquareWorld -&gt; SquareWorld \nchangecolour squareWorld =\n    let \n    old_cell = theWorld squareWorld\n    old_cellstate = cellState old_cell\n    new_cellstate =nextCellState (old_cellstate (x : xs))\n    new_cell = old_cell { old_cellstate = new_cellstate}\n    newsquareWorld = squareWorld { old_cell = new_cell}\n    in\n    newsquareWorld\n\ndata Cell = Cell {cellPosition :: Coord, cellState :: CellState}\n  deriving (Show, Eq)\n\nnextCellState :: CellState -&gt; CellState\nnextCellState (CellState (_ :&lt; xs)) = CellState xs\n\ndata SquareWorld = SquareWorld { theAnt :: Ant, theWorld :: [Cell]}\n  deriving Show\n</code></pre>\n\n<p>The error message is :   </p>\n\n<blockquote>\n  <p>[12 of 14] Compiling StudentSources.LangtonsAnt ( src/StudentSources/LangtonsAnt.hs, build/x86_64/StudentSources/LangtonsAnt.o )</p>\n  \n  <p>src/StudentSources/LangtonsAnt.hs:154:50: Not in scope: \u2018x\u2019</p>\n  \n  <p>src/StudentSources/LangtonsAnt.hs:154:54: Not in scope: \u2018xs\u2019</p>\n  \n  <p>src/StudentSources/LangtonsAnt.hs:155:27:\n      \u2018old_cellstate\u2019 is not a (visible) constructor field name</p>\n  \n  <p>src/StudentSources/LangtonsAnt.hs:156:36:\n      \u2018old_cell\u2019 is not a (visible) constructor field name</p>\n</blockquote>\n\n<p><strong>What should i do ?</strong></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459927473, "post_id": 36444105, "comment_id": 60501990, "body": "is the key supposed to be the same length as you input (one-time-pad style) or do you want to <i>repeat</i> it? - Also isn&#39;t the function supposed to be either <code>String -&gt; String -&gt; String</code> or <code>String -&gt; String -&gt; [Word8]</code> or <code>[Word8] -&gt; [Word8] -&gt; [Word8]</code>?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1459927492, "post_id": 36444105, "comment_id": 60502001, "body": "now matter what: have a look at <code>zipWith</code>"}, {"owner": {"reputation": 5, "user_id": 4284741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100001258697205/picture?type=large", "display_name": "Tudorut Robert", "link": "https://stackoverflow.com/users/4284741/tudorut-robert"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459927561, "post_id": 36444105, "comment_id": 60502034, "body": "@Carsten The key is supposed to be the same length as the input, and the function should be as I said above because I can covert the key from String to Word8 and backwards"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459927698, "post_id": 36444105, "comment_id": 60502129, "body": "you convert a <code>String</code> to <code>Word8</code>?  - you mean <code>[Word8]</code>? Anyway if you know this it&#39;s really just <code>zipWith xor</code> instead of the <code>map</code>"}, {"owner": {"reputation": 5, "user_id": 4284741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100001258697205/picture?type=large", "display_name": "Tudorut Robert", "link": "https://stackoverflow.com/users/4284741/tudorut-robert"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459927756, "post_id": 36444105, "comment_id": 60502167, "body": "@Carsten looked at zipWith, should I do it in the following way &#39;encrypt str = zipWith xor str (convertToWord8 key)&#39; ,I still do not know how to make it point-free tough"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459927884, "post_id": 36444105, "comment_id": 60502247, "body": "I&#39;ll never understand the fascination with point-free - but look closely - why don&#39;t you switch the arguments a bit and see what it gives you: <code>encrypt str = zipWith xor (convertToWord8 key) str</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459927950, "post_id": 36444105, "comment_id": 60502293, "body": "btw: this does not seem to match your signature - isn&#39;t the key supposed to be a <code>[Word8]</code> and the <code>string</code> a <code>String</code>?"}, {"owner": {"reputation": 5, "user_id": 4284741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100001258697205/picture?type=large", "display_name": "Tudorut Robert", "link": "https://stackoverflow.com/users/4284741/tudorut-robert"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459927988, "post_id": 36444105, "comment_id": 60502314, "body": "@Carsten I am currently not at home, I am actually posting from a phone, but as soon as I do that, i will post here. One more question tough: Given the same situation but wanting to encrypt the same string with a map array [(Char, Char)] ex [(&quot;A&quot;, &quot;B&quot;)] will encrypt all A&#39;s into B&#39;s how would I do that? As well with a zipwith? But with what operator?"}, {"owner": {"reputation": 5, "user_id": 4284741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100001258697205/picture?type=large", "display_name": "Tudorut Robert", "link": "https://stackoverflow.com/users/4284741/tudorut-robert"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459928161, "post_id": 36444105, "comment_id": 60502416, "body": "@Carsten Yes, the key should be [Word8] and the str a String"}], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": false, "score": 1, "last_activity_date": 1462646880, "creation_date": 1462646880, "answer_id": 37092408, "question_id": 36444105, "link": "https://stackoverflow.com/questions/36444105/xor-crypt-haskell/37092408#37092408", "title": "XOR Crypt Haskell", "body": "<p>Judging from your comments, you want to have this in point-free style:</p>\n\n<pre><code>encrypt = zipWith xor . convertToWord8\n</code></pre>\n\n<p>There is a tool called \"<a href=\"https://hackage.haskell.org/package/pointfree\" rel=\"nofollow\">pointfree</a>\" which can automatically convert expressions to pointfree style.</p>\n\n<p>Comments:</p>\n\n<ul>\n<li>Do not over-do point-free style. Anything but very short snippets may easily become unreadable. That is because point-free style can obfuscate the structure of the expression, and it strips away helpful variable names.</li>\n<li>Do not call your function <em>encrypt</em> if it only obfuscates.</li>\n</ul>\n"}], "owner": {"reputation": 5, "user_id": 4284741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100001258697205/picture?type=large", "display_name": "Tudorut Robert", "link": "https://stackoverflow.com/users/4284741/tudorut-robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462646880, "creation_date": 1459927175, "question_id": 36444105, "link": "https://stackoverflow.com/questions/36444105/xor-crypt-haskell", "title": "XOR Crypt Haskell", "body": "<p>I am trying to encrypt a String with a Key given as an argument using XOR from Data.Bits, as well, I am trying to learn how to create this in Haskell.</p>\n\n<p>Please note that I am new to this programming language and I would like to learn by myself how to do this. If possible, I would like to get some hints on how to do it</p>\n\n<p>What I tought off till now:</p>\n\n<pre><code>encrypt string = map xor $ split \"\" string\n</code></pre>\n\n<p>Yet I don't really know how to use a Key to encrypt it, where should I add it? Maybe repeat the map \"Key\" times?</p>\n\n<p>The function signature is\nString -> [Word8] -> [Word8]\nAnd I am trying to create it point-free(only with the string argument)</p>\n"}, {"tags": ["json", "haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 681, "user_id": 3961879, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/pidYM.jpg?s=128&g=1", "display_name": "carpemb", "link": "https://stackoverflow.com/users/3961879/carpemb"}, "edited": false, "score": 0, "creation_date": 1459921279, "post_id": 36441892, "comment_id": 60498730, "body": "Yeah, this works for me too. Thank you! That&#39;s one of the cooler uses of list comprehensions I&#39;ve seen thus far. I was fiddling around with Vectors and HashMaps before, but the types would get inferred to Value in ways I was finding hard to debug."}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 1, "last_activity_date": 1459918814, "creation_date": 1459918814, "answer_id": 36441892, "question_id": 36441443, "link": "https://stackoverflow.com/questions/36441443/parsing-nested-heterogeneous-json-arrays-with-aeson/36441892#36441892", "title": "Parsing nested heterogeneous JSON arrays with Aeson", "body": "<p>In more complicated examples like these, it's good to keep in mind that underneath the Aeson <code>Value</code> type are simple data structures\u00a0\u2013 <code>Vector</code> for arrays and <code>HashMap</code> for objects. A little more exotic than the lists and maps we're used to dealing with, but still data structures that have <code>Foldable</code> and <code>Traversable</code>  instances. With that in mind, we can declare these instances:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport qualified Control.Lens as Lens\nimport qualified Data.Foldable as Foldable\nimport qualified Data.Text.Strict.Lens as Lens\nimport           Data.Aeson\nimport           Data.Aeson.Types\n\nnewtype ExtractedPackets =\n  ExtractedPackets [ExtractedPacket] deriving (Show)\n\ninstance FromJSON ExtractedPackets where\n  parseJSON (Object o) = do\n    let subparsers =\n          [ ExtractedPacket (Lens.view Lens.unpacked key) &lt;$&gt; parseJSON packets\n          | (key, Array values) &lt;- Lens.itoList o\n          , packets@(Array _) &lt;- Foldable.toList values]\n    packets &lt;- sequence subparsers\n    return (ExtractedPackets packets)\n  parseJSON invalid =\n    typeMismatch \"ExtractedPackets\" invalid\n\ninstance FromJSON ExtractedPacketField where\n  parseJSON (Object o) =\n    ExtractedPacketField &lt;$&gt; o .: \"field1\" &lt;*&gt; o .: \"field2\"\n  parseJSON invalid =\n    typeMismatch \"ExtractedPacketField\" invalid\n</code></pre>\n\n<p>We have to newtype the list of packets because there's already a <code>FromJSON</code> instance for <code>FromJSON a =&gt; FromJSON [a]</code> and it doesn't do what we want (it, specifically, is only equipped to deal with homogeneous lists). </p>\n\n\n\n<p>Once we do that, we can get our hands on the hashmap inside the object and traverse its keys and values as tuples. Mapping over the tuples, we produce a <code>[Parser ExpectedPacket]</code>, which we can <code>sequence</code> into a <code>Parser [ExpectedPacket]</code>. I'm using <code>lens</code> liberally here to do the boring stuff, like converting between packed and unpacked strings or breaking down the hashmap into key-and-value tuples. You can use the <code>text</code> and <code>unordered-containers</code> packages to achieve the same goals if you don't want to pull in <code>lens</code>.</p>\n\n<p>It seems to work on the example provided:</p>\n\n<pre><code>\u03bb&gt; eitherDecode bytes :: Either String ExtractedPackets\nRight (ExtractedPackets [ExtractedPacket {packetName = \"packetX_Name\",\npacketFields = [ExtractedPacketField {field1 = \"value1\", field2 =\n\"value2\"},ExtractedPacketField {field1 = \"value3\", field2 =\n\"value4\"},ExtractedPacketField {field1 = \"value5\", field2 =\n\"value6\"}]},ExtractedPacket {packetName = \"packetY_Name\", packetFields\n= [ExtractedPacketField {field1 = \"value7\", field2 =\n\"value8\"},ExtractedPacketField {field1 = \"value9\", field2 =\n\"value10\"}]}])\n</code></pre>\n\n<p>Lastly, I often find that using <code>typeMismatch</code> and <code>eitherDecode</code> to be tremendously helpful for debugging Aeson instances.</p>\n"}], "owner": {"reputation": 681, "user_id": 3961879, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/pidYM.jpg?s=128&g=1", "display_name": "carpemb", "link": "https://stackoverflow.com/users/3961879/carpemb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 1, "accepted_answer_id": 36441892, "answer_count": 1, "score": 0, "last_activity_date": 1459918837, "creation_date": 1459916536, "last_edit_date": 1459918837, "question_id": 36441443, "link": "https://stackoverflow.com/questions/36441443/parsing-nested-heterogeneous-json-arrays-with-aeson", "title": "Parsing nested heterogeneous JSON arrays with Aeson", "body": "<p>So, I've hit something of a roadblock with parsing the following JSON with the Haskell Aeson library.</p>\n\n<p>So say I have the following:</p>\n\n<pre><code>\"packetX_Name\": [\n  \"container\",\n  [\n    {\n      \"field1\": \"value1\",\n      \"field2\": \"value2\"\n    },\n    {\n      \"field1\": \"value3\",\n      \"field2\": \"value4\"\n    },\n    {\n      \"field1\": \"value5\",\n      \"field2\": \"value6\"\n    }\n  ]\n],\n\"packetY_Name\": [\n  \"container\",\n  [\n    {\n      \"field1\": \"value7\",\n      \"field2\": \"value8\"\n    },\n    {\n      \"field1\": \"value9\",\n      \"field2\": \"value10\"\n    }\n  ]\n],\netc...\n</code></pre>\n\n<p>And I would ideally like to parse this using data types like this:</p>\n\n<pre><code>data ExtractedPacket = ExtractedPacket\n  { packetName   :: String\n  , packetFields :: [ExtractedPacketField]\n  } deriving (Show,Eq)\n\ninstance FromJSON ExtractedPacket where\n  parseJSON = blah\n\ndata ExtractedPacketField = ExtractedPacketField\n  { field1  :: String\n  , field2 :: String\n  } deriving (Show,Eq)\n\ninstance FromJSON ExtractedPacketField where\n  parseJSON = blah\n</code></pre>\n\n<p>And get something like the following:</p>\n\n<pre><code>ExtractedPacket\n  \"packetX_Name\"\n  [ ExtractedPacketField \"value1\" \"value2\"\n  , ExtractedPacketField \"value3\" \"value4\"\n  , ExtractedPacketField \"value5\" \"value6\"\n  ]\n\nExtractedPacket\n \"packetY_Name\"\n  [ ExtractedPacketField \"value7\" \"value8\"\n  , ExtractedPacketField \"value10\" \"value10\"\n  ]\n</code></pre>\n\n<p>This JSON example is describing network packets and each packet has a different name (such as \"packetX_Name\") that can't be parsed the same way \"field1\" or \"field2\" can be. It'll be different every time. Most of the Aeson examples out there are quite unhelpful when it comes to situations like this. I've noticed a function in the API docs called <code>withArray</code> that matches on a <code>String</code>, but I'm at a lose as to what to use for <code>(Array -&gt; Parser a)</code></p>\n\n<p>The part I'm really stuck on is parsing the heterogeneous array that starts with a String \"container\" and then has an array with all the objects in it. Thus far, I've been indexing straight to the array of objects, but the type system started to become a real labyrinth and I found it really hard to approach this in a way that isn't ugly and hackish. On top of this, Aeson doesn't produce very helpful error messages.</p>\n\n<p>Any ideas on how to approach this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1459915515, "post_id": 36440948, "comment_id": 60496787, "body": "System.Console.Haskeline"}, {"owner": {"reputation": 1300, "user_id": 1631438, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4e67c5782420d28c6629a12bc63deae2?s=128&d=identicon&r=PG&f=1", "display_name": "MdxBhmt", "link": "https://stackoverflow.com/users/1631438/mdxbhmt"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1459973593, "post_id": 36440948, "comment_id": 60534644, "body": "Thanks! That had exactly what I needed and more!"}], "answers": [{"tags": [], "owner": {"reputation": 1300, "user_id": 1631438, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4e67c5782420d28c6629a12bc63deae2?s=128&d=identicon&r=PG&f=1", "display_name": "MdxBhmt", "link": "https://stackoverflow.com/users/1631438/mdxbhmt"}, "is_accepted": false, "score": 1, "last_activity_date": 1459973609, "creation_date": 1459973609, "answer_id": 36461416, "question_id": 36440948, "link": "https://stackoverflow.com/questions/36440948/how-to-have-a-user-interactable-default-string-for-getline/36461416#36461416", "title": "How to have a (user-interactable) default string for getLine?", "body": "<p>As recomended by n.m. , <code>getInputLineWithInitial</code> from <code>System.Console.Haskeline</code>did the trick!</p>\n"}], "owner": {"reputation": 1300, "user_id": 1631438, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4e67c5782420d28c6629a12bc63deae2?s=128&d=identicon&r=PG&f=1", "display_name": "MdxBhmt", "link": "https://stackoverflow.com/users/1631438/mdxbhmt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459973609, "creation_date": 1459913366, "question_id": 36440948, "link": "https://stackoverflow.com/questions/36440948/how-to-have-a-user-interactable-default-string-for-getline", "title": "How to have a (user-interactable) default string for getLine?", "body": "<p>I want to present a terminal user an editable string, in place of giving an empty buffer to write.</p>\n\n<p>I'm thinking something like a text form with a default string, much common in UI.</p>\n\n<p>Is there any trick using System.IO to simulate this kind of behavior, since more complex libraries (like ansi-terminal) doesn't provide this utility? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 138, "user_id": 1544008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0c56aae0ef5e0981403733f7f248c1f?s=128&d=identicon&r=PG", "display_name": "ArthurVard", "link": "https://stackoverflow.com/users/1544008/arthurvard"}, "edited": false, "score": 2, "creation_date": 1459916746, "post_id": 36440246, "comment_id": 60497158, "body": "In such cases you should figure out the function type for your need then  ask <a href=\"https://www.haskell.org/hoogle\" rel=\"nofollow noreferrer\">hoogle</a>.  For this task search param is <b>(a -&gt; Bool) -&gt; [a] -&gt; [a]</b>."}], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 4, "last_activity_date": 1459908992, "creation_date": 1459908992, "answer_id": 36440297, "question_id": 36440246, "link": "https://stackoverflow.com/questions/36440246/why-does-haskells-find-always-return-only-one-element/36440297#36440297", "title": "Why does Haskell&#39;s find always return only one element?", "body": "<p>Use <code>filter</code></p>\n\n<pre><code>&gt; filter odd [2,4,7,9,11]\n[7, 9, 11]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 4, "last_activity_date": 1459909049, "creation_date": 1459909049, "answer_id": 36440309, "question_id": 36440246, "link": "https://stackoverflow.com/questions/36440246/why-does-haskells-find-always-return-only-one-element/36440309#36440309", "title": "Why does Haskell&#39;s find always return only one element?", "body": "<p>You're looking for <code>filter</code>, not <code>find</code>. The job of <code>find</code> is to find the first one, or let you know there isn't one. The job of <code>filter</code> is to make a list of all of them.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 6, "last_activity_date": 1459912693, "last_edit_date": 1459912693, "creation_date": 1459909821, "answer_id": 36440437, "question_id": 36440246, "link": "https://stackoverflow.com/questions/36440246/why-does-haskells-find-always-return-only-one-element/36440437#36440437", "title": "Why does Haskell&#39;s find always return only one element?", "body": "<p>From the <a href=\"http://hackage.haskell.org/package/base-4.6.0.1/docs/Data-List.html#v:find\" rel=\"nofollow\">documentation</a>:</p>\n\n<blockquote>\n  <p>The <code>find</code> function takes a predicate and a list and returns the <strong>first</strong> element in the list matching the predicate, or <code>Nothing</code> if there is no such element.</p>\n</blockquote>\n\n<p>Use <a href=\"http://hackage.haskell.org/package/base-4.6.0.1/docs/Data-List.html#v:filter\" rel=\"nofollow\"><code>filter</code></a> instead:</p>\n\n<pre><code>&gt; filter odd [2,4,7,9,11]\n[7, 9, 11]\n</code></pre>\n"}], "owner": {"reputation": 8007, "user_id": 5890784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dec46088a284202a3be71897845a669d?s=128&d=identicon&r=PG&f=1", "display_name": "Hind Forsum", "link": "https://stackoverflow.com/users/5890784/hind-forsum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 36440437, "answer_count": 3, "score": 0, "last_activity_date": 1459952348, "creation_date": 1459908680, "last_edit_date": 1459952348, "question_id": 36440246, "link": "https://stackoverflow.com/questions/36440246/why-does-haskells-find-always-return-only-one-element", "title": "Why does Haskell&#39;s find always return only one element?", "body": "<pre><code>Prelude&gt; find odd [2,4,7,9,11]\nJust 7\n</code></pre>\n\n<p>I would expect this to return [7,9,11], as they're all odd numbers. Why does <code>find</code> return <code>Just 7</code>?</p>\n\n<p>Is there any way I can tell the <code>odd</code> function to return what I expect?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1459907386, "post_id": 36440031, "comment_id": 60494581, "body": "Lookup <code>$</code>, <code>flip</code>, and currying."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 4, "creation_date": 1459907753, "post_id": 36440031, "comment_id": 60494689, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13134857/haskell-mapping-function-application\">Haskell: mapping function application</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1459911301, "post_id": 36440031, "comment_id": 60495635, "body": "This isn&#39;t a duplicate of the suggestion; <code>service</code> needs to return a single <code>Car</code>, not a list of type <code>[Car]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1015, "user_id": 4784639, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SGRA7.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/4784639/marco"}, "edited": false, "score": 0, "creation_date": 1459946138, "post_id": 36440558, "comment_id": 60515284, "body": "Thanks, here is how i used what you told me:                                       Services (Car plate currentTanq tanqSize) list = foldl (flip ($)) (Car plate currentTanq tanqSize) list"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1459912472, "last_edit_date": 1459912472, "creation_date": 1459910645, "answer_id": 36440558, "question_id": 36440031, "link": "https://stackoverflow.com/questions/36440031/haskell-inverting-map/36440558#36440558", "title": "Haskell: Inverting &#39;map&#39;", "body": "<p>You can use <code>foldl</code> for this:</p>\n\n<pre><code>service :: Car -&gt; [Services] -&gt; Car\nservice car functions = foldl (flip ($)) car functions\n\nservice someCar [emptyTank, (refuel 10), (changePlate \"abc 123\"), (upgradeTank 15)]\n</code></pre>\n\n<p><code>($)</code> is function application, but to use it with <code>foldl</code> (to apply the functions in the correct order, we need to flip its arguments so that <code>arg $ f</code> evaluates to <code>f arg</code>. Using <code>(flip ($))</code> with <code>foldl</code> will cause the first function in <code>functions</code> to be applied to <code>car</code>, then the second function will be applied to the result of the first, then the third to the result of the second, etc.</p>\n\n<p>(<code>foldr</code> could be used with simply <code>($)</code> instead of <code>flip ($)</code>, but it would apply the functions from right to left, not left to right. Compare</p>\n\n<pre><code>foldl (flip ($)) 3 [(+4), (*5)]  -- Returns (3+4)*5 = 35\n</code></pre>\n\n<p>with</p>\n\n<pre><code>foldr ($) 3 [(+4), (*5)] -- Returns (3*5) + 4 = 19\n</code></pre>\n\n<p>)</p>\n\n<hr>\n\n<p>Another way of looking at this is that you want to compose your list of functions into one function:</p>\n\n<pre><code>(upgradeTank 15) . (changePlate \"abc 123\") . (refuel 10) . emptyTank $ someCar\n</code></pre>\n\n<p>which you can also do with <code>foldl</code> (or <code>foldr</code>? It doesn't seem to make a difference which you use here), using <code>(.)</code> to reduce the list to a single function, then applying that function to <code>car</code>. The <code>id</code> function is used as the other argument for the first call to <code>(.)</code> made by <code>foldl</code>. You do need to reverse the list of functions first, though, since composition is right-associative.</p>\n\n<pre><code>service car functions = foldl (.) id (reverse functions) $ car\n</code></pre>\n"}], "owner": {"reputation": 1015, "user_id": 4784639, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SGRA7.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/4784639/marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 36440558, "answer_count": 1, "score": 0, "last_activity_date": 1459912472, "creation_date": 1459907169, "question_id": 36440031, "link": "https://stackoverflow.com/questions/36440031/haskell-inverting-map", "title": "Haskell: Inverting &#39;map&#39;", "body": "<p>As you may already know when you use map it recibes a function and apply that function to every element of the list</p>\n\n<pre><code>map f xs is the list obtained by applying f to each element of xs, i.e.,\n</code></pre>\n\n<p>But in my case i have a list of functions y need to apply in order to an specific value. This are the types, to give a better idea:</p>\n\n<pre><code>data Auto = Auto {plate :: String, currentTank :: Int, tanqSize :: Int} deriving (Show, Eq)\ntype Services = Car -&gt; Car\nservice :: Car -&gt; [Services] -&gt; Car\n</code></pre>\n\n<p>As i explained before [Services] will be a list of functions that recibe 'Car' and return 'Car'. I need to apply in order those functions to the 'Car' that recibes 'service' and return it with all the modifications done.</p>\n\n<p>Here are some examples of functions may appear on the list:</p>\n\n<pre><code>emptyTank :: Services\nreFuel :: Int -&gt; Services\nchangePlate :: String -&gt; Services\nupgradeTank :: Int -&gt; Services\n</code></pre>\n\n<p>Do anyone know a way to solve this? In case you know a more apropiate function to use insted of map, tell me and i ll look into it.</p>\n"}, {"tags": ["loops", "haskell", "io", "polynomial-math"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1459895152, "post_id": 36438057, "comment_id": 60491107, "body": "I&#39;ve removed your reimplementation of the <code>Prelude</code>, as it didn&#39;t seem relevant to your question. If you think it is relevant, feel free to revert the edit and add a short explanation of why we should pay special attention to your version of the standard functions."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1459897127, "post_id": 36438057, "comment_id": 60491853, "body": "You can loop an IO action over a list with <code>mapM</code> (probably <code>mapM_</code> is more useful to you here). If <code>cs</code> are the coefficients of the polynomial and <code>x</code> is the x-value, then <code>sum $ zipWith (*) (reverse cs) $ iterate (*x) 1</code> is the value of polynomial at x."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 4, "last_activity_date": 1459917452, "creation_date": 1459917452, "answer_id": 36441613, "question_id": 36438057, "link": "https://stackoverflow.com/questions/36438057/i-o-loop-in-haskell/36441613#36441613", "title": "I/O Loop in Haskell", "body": "<h2>Warning:</h2>\n\n<p>I spoil this completely so feel free to stop at any point and try to go on yourself</p>\n\n<hr>\n\n<p>Instead of pushing it all into this single function I will instead break this down into smaller tasks/functions.</p>\n\n<p>So let's start with this.</p>\n\n<h2>1. Input</h2>\n\n<p>On obvious part is to ask for an value - and if we are on it we can make sure that the user input is any good (I am using <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Text-Read.html#v:readMaybe\" rel=\"nofollow\"><code>Text.Read.readMaybe</code></a> for this:</p>\n\n<pre><code>query :: Read a =&gt; String -&gt; IO a\nquery prompt = do\n  putStr $ prompt ++ \": \"\n  val &lt;- readMaybe &lt;$&gt; getLine\n  case val of\n    Nothing -&gt; do\n      putStrLn \"Sorry that's a wrong value - please reenter\"\n      query prompt\n    Just v -&gt; return v\n</code></pre>\n\n<p>please note that I appended the <code>\": \"</code> part already so you don't have to do this for your <code>prompt</code>s</p>\n\n<hr>\n\n<p>having this all the questions to your user become almost trivial:</p>\n\n<pre><code>queryDegree :: IO Int\nqueryDegree = query \"What is the degree of the polynomial\"\n\nqueryCoef :: Int -&gt; IO (Int, Double)\nqueryCoef i = do\n  c &lt;- query prompt\n  return (i,c)\n  where prompt = \"What is the x^\" ++ show i ++ \" coefficient\"\n\nqueryPoint :: IO Double\nqueryPoint = query \"What value do you want to evaluate at\"\n</code></pre>\n\n<p>please note that I provide the powers together with the coefficients - this make the calculation a bit easier but is not strictly necessary here I guess (you could argue that this is more than the function should do at this point and later use <code>zip</code> to get the powers too)</p>\n\n<hr>\n\n<p>Asking all the inputs is now really easy once you've seen <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:mapM\" rel=\"nofollow\"><code>mapM</code></a> and what it can do - it's the point where you usually would want <em>to write a loop</em>:</p>\n\n<pre><code>queryPoly :: IO [(Int, Double)]\nqueryPoly = do\n  n &lt;- queryDegree\n  mapM queryCoef [n,n-1..0]\n</code></pre>\n\n<h2>2. Evaluation</h2>\n\n<p>Do evaluate this I just need to evaluate each term at the given point (that is each <em>power, coefficient</em> pair in the list) - which you can do using <code>map</code> - after we just need to sum this all up (<code>sum</code> can do this):</p>\n\n<pre><code>evaluate :: Double -&gt; [(Int, Double)] -&gt; Double\nevaluate x = sum . map (\\ (i,c) -&gt; c*x^i)\n</code></pre>\n\n<h2>3. Output</h2>\n\n<p>Is rather boring:</p>\n\n<pre><code>presentResult :: Double -&gt; IO ()\npresentResult v = putStrLn $ \"The vaule of the polynomial is \" ++ show v\n</code></pre>\n\n<h2>4. Getting it all together</h2>\n\n<p>I just have to ask for the inputs, evaluate the value and then present it:</p>\n\n<pre><code>evalpoly :: IO ()\nevalpoly = do\n  p &lt;- queryPoly\n  x &lt;- queryPoint\n  presentResult $ evaluate x p\n</code></pre>\n\n<h2>5. Test-Run</h2>\n\n<p>Here is an example run</p>\n\n<pre><code>What is the degree of the polynomial: 3\nWhat is the x^3 coefficient: 1.0\nWhat is the x^2 coefficient: -2.0\nWhat is the x^1 coefficient: Hallo\nSorry that's a wrong value - please reenter\nWhat is the x^1 coefficient: 0\nWhat is the x^0 coefficient: 10.0\nWhat value do you want to evaluate at: -1.0\nThe vaule of the polynomial is 7.0\n</code></pre>\n\n<hr>\n\n<h2>complete Code</h2>\n\n<p>Note that I like to enter the no-buffering because I run into trouble on Windows occasionally if I don't have it - you probably can live without</p>\n\n<pre><code>module Main where\n\nimport Control.Monad (mapM)\nimport Text.Read (readMaybe)\nimport System.IO (BufferMode(..), stdout, hSetBuffering)\n\nquery :: Read a =&gt; String -&gt; IO a\nquery prompt = do\n  putStr $ prompt ++ \": \"\n  val &lt;- readMaybe &lt;$&gt; getLine\n  case val of\n    Nothing -&gt; do\n      putStrLn \"Sorry that's a wrong value - please reenter\"\n      query prompt\n    Just v -&gt; return v\n\nqueryDegree :: IO Int\nqueryDegree = query \"What is the degree of the polynomial\"\n\nqueryCoef :: Int -&gt; IO (Int, Double)\nqueryCoef i = do\n  c &lt;- query prompt\n  return (fromIntegral i,c)\n  where prompt = \"What is the x^\" ++ show i ++ \" coefficient\"\n\nqueryPoint :: IO Double\nqueryPoint = query \"What value do you want to evaluate at\"\n\nqueryPoly :: IO [(Int, Double)]\nqueryPoly = do\n  n &lt;- queryDegree\n  mapM queryCoef [n,n-1..0]\n\nevaluate :: Double -&gt; [(Int, Double)] -&gt; Double\nevaluate x = sum . map (\\ (i,c) -&gt; c*x^i)\n\npresentResult :: Double -&gt; IO ()\npresentResult v = putStrLn $ \"The vaule of the polynomial is \" ++ show v\n\nevalpoly :: IO ()\nevalpoly = do\n  p &lt;- queryPoly\n  x &lt;- queryPoint\n  presentResult $ evaluate x p\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 4296407, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5b6394226433412b0d1ad46bb0318b28?s=128&d=identicon&r=PG&f=1", "display_name": "JMV12", "link": "https://stackoverflow.com/users/4296407/jmv12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1459917452, "creation_date": 1459894567, "last_edit_date": 1459895109, "question_id": 36438057, "link": "https://stackoverflow.com/questions/36438057/i-o-loop-in-haskell", "title": "I/O Loop in Haskell", "body": "<p>I am currently working on this Haskell problem and I seem to be stuck.</p>\n\n<p>Write a function, evalpoly, that will ask a user for the degree of a single variable polynomial, then read in the coefficients for the polynomial (from highest power to lowest), then for a value, and will output the value of the polynomial evaluated at that value.  As an example run:</p>\n\n<pre><code>&gt; evalpoly\nWhat is the degree of the polynomial: 3\nWhat is the x^3 coefficient: 1.0\nWhat is the x^2 coefficient: - 2.0\nWhat is the x^1 coefficient: 0\nWhat is the x^0 coefficient: 10.0\nWhat value do you want to evaluate at: -1.0\nThe value of the polynomial is 7.0\n</code></pre>\n\n<p>As of now, I have this:</p>\n\n<pre><code>evalpoly :: IO ()\nevalpoly  = putStr \"What is the degree of the polynomial: \" &gt;&gt;\n          getLine &gt;&gt;= \\xs -&gt;\n          putStr \"What is the x^\" &gt;&gt;\n          putStr (show xs) &gt;&gt;\n          putStr \" coefficient: \" &gt;&gt;\n          putStrLn \"\"\n</code></pre>\n\n<p>How would I go about adding the loop and calculations?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1459888206, "post_id": 36436235, "comment_id": 60487549, "body": "Type signatures are of the form <code>expression::type</code>. All values to the left of <code>::</code>, all types to the right."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1459888724, "creation_date": 1459888724, "answer_id": 36436593, "question_id": 36436235, "link": "https://stackoverflow.com/questions/36436235/ghci-asking-for-type-or-value-namespaces/36436593#36436593", "title": "GHCI asking for type or value namespaces?", "body": "<p>Since it only makes sense to ask for the types of expressions, you can be confident that <code>:t StateT</code> is using the expression namespace. Likewise, in a type ascription/declaration <code>foo :: bar</code>, the left hand side <code>foo</code> is always an expression and the right hand side <code>bar</code> is always a type. So as you say, in</p>\n\n<pre><code>StateT :: (s -&gt; m (a, s)) -&gt; StateT s m a\n</code></pre>\n\n<p>the first <code>StateT</code> is from the expression namespace, and the second <code>StateT</code> is from the type namespace. If you want to ask for the \"type\" of a type-level expression, you can use the <code>:kind</code> command (or <code>:k</code> for short), in which case the argument is always a type-level expression. Thus:</p>\n\n<pre><code>Control.Monad.State&gt; :k StateT\nStateT :: * -&gt; (* -&gt; *) -&gt; * -&gt; *\n</code></pre>\n\n<p>Here the <code>::</code> denotes a <em>kind</em> ascription, so in <code>foo :: bar</code>, <code>foo</code> is a type-level expression and <code>bar</code> is a kind-level expression.</p>\n\n<p>Usually it is possible to tell -- completely syntactically -- which namespace a given name is from, but the <code>:info</code> command is a bit special. When you ask for info on a name that appears in both namespaces, it gives you info about both.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1459888760, "creation_date": 1459888760, "answer_id": 36436604, "question_id": 36436235, "link": "https://stackoverflow.com/questions/36436235/ghci-asking-for-type-or-value-namespaces/36436604#36436604", "title": "GHCI asking for type or value namespaces?", "body": "<ul>\n<li><code>:t</code>[<code>ype</code>] always uses the value namespace</li>\n<li><code>:k</code>[<code>ind</code>] always uses the type namespace</li>\n<li><p><code>:i</code>[<code>nfo</code>] uses both, displaying all matching identifiers. For instance,</p>\n\n<pre><code>Prelude&gt; data Q = A\nPrelude&gt; data A = Q\nPrelude&gt; :i Q\ndata A = Q  -- Defined at &lt;interactive&gt;:5:10\n\ndata Q = A  -- Defined at &lt;interactive&gt;:4:1\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 36436604, "answer_count": 2, "score": 1, "last_activity_date": 1459888760, "creation_date": 1459887514, "question_id": 36436235, "link": "https://stackoverflow.com/questions/36436235/ghci-asking-for-type-or-value-namespaces", "title": "GHCI asking for type or value namespaces?", "body": "<p>When asking <code>GHCI</code> for <code>type</code> or <code>info</code>, which namespace is used for names and expressions?</p>\n\n<pre><code> :type &lt;expr&gt;                show the type of &lt;expr&gt;\n :info[!] [&lt;name&gt; ...]       display information about the given names\n                             (!: do not filter instances)\n</code></pre>\n\n<p>I'm not sure what I'm asking for and what does the following signature mean.</p>\n\n<pre><code>Prelude Control.Monad.State&gt; :t StateT\nStateT :: (s -&gt; m (a, s)) -&gt; StateT s m a\n</code></pre>\n\n<p>Is first <code>StateT</code> from value namespace and second from type namespace in the response line?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1459889764, "post_id": 36436132, "comment_id": 60488454, "body": "You can <i>sort of</i> do what you ask if you&#39;re willing to perform the monadic actions associated with all possible input <code>a</code> values at once up front. Occasionally this is what you want -- but usually not."}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1583959395, "post_id": 36436132, "comment_id": 107291919, "body": "You need to add some laws to this type signature. Otherwise, an implementation could ignore the first argument and return the second without change."}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1459888189, "post_id": 36436353, "comment_id": 60487542, "body": "Yep! The asked-for function would downgrade a Monad action to an Applicative action, which is impossible. What they should do instead is upgrade the Applicative action to a Monad action."}, {"owner": {"reputation": 1595, "user_id": 84423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9114304b96acd7b2bd88275eaccdbdbf?s=128&d=identicon&r=PG", "display_name": "Ben Doerr", "link": "https://stackoverflow.com/users/84423/ben-doerr"}, "edited": false, "score": 0, "creation_date": 1459948572, "post_id": 36436353, "comment_id": 60517335, "body": "That&#39;s generally what I figured I was going to need to do. Just didn&#39;t have the words to reason about it yet."}], "tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": true, "score": 13, "last_activity_date": 1459887889, "last_edit_date": 1495542232, "creation_date": 1459887889, "answer_id": 36436353, "question_id": 36436132, "link": "https://stackoverflow.com/questions/36436132/haskell-a-m-a-m-a-a-m-a-a/36436353#36436353", "title": "Haskell (a -&gt; m a) -&gt; m (a -&gt; a) -&gt; m (a -&gt; a)", "body": "<p>You can't do this, in general.  The problem is your result type: <code>m (a -&gt; a)</code>.  This is a <em>single</em> monadic action which produces a function; but your first input has the form <code>a -&gt; m a</code>, which (potentially) produces a <em>different</em> monadic action for each argument.  So, for example, for the <code>[]</code> monad <code>[a -&gt; a]</code> is list of functions with a fixed length, whereas <code>a -&gt; [a]</code> can have a different length for each argument.  So there's no way to 'push' the function type back into the <code>m</code> in general; see <a href=\"https://stackoverflow.com/questions/26264411/what-is-the-general-case-of-quickchecks-promote-function\">What is the general case of QuickCheck&#39;s promote function?</a> for a related SO question.</p>\n\n<p>If <code>a -&gt; m a</code> would work for what you need, then you can turn your <code>m (a -&gt; a)</code> argument into <code>a -&gt; m a</code> using</p>\n\n<pre><code>\\ x -&gt; fmap ($ x) af\n</code></pre>\n\n<p>and use <code>&gt;=&gt;</code> (or <code>&lt;=&lt;</code>, it's not clear from your types) to compose the functions together.</p>\n"}], "owner": {"reputation": 1595, "user_id": 84423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9114304b96acd7b2bd88275eaccdbdbf?s=128&d=identicon&r=PG", "display_name": "Ben Doerr", "link": "https://stackoverflow.com/users/84423/ben-doerr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 36436353, "answer_count": 1, "score": 8, "last_activity_date": 1459887889, "creation_date": 1459887162, "question_id": 36436132, "link": "https://stackoverflow.com/questions/36436132/haskell-a-m-a-m-a-a-m-a-a", "title": "Haskell (a -&gt; m a) -&gt; m (a -&gt; a) -&gt; m (a -&gt; a)", "body": "<p>I've been digging into Haskell for the past months, I've run into a situation with monads that I am not quite sure how to handle.</p>\n\n<p>I have one value of type <code>a -&gt; m a</code> and a second of type <code>m (a -&gt; a)</code> and I need to compose them such that the result of the first ends up as the input into the of the second and produces a <code>m (a -&gt; a)</code> if possible. I've been stuck on this for the past day now and I'm not wrapping my head around it. I suppose that I am looking for a function like <code>(a -&gt; m a) -&gt; m (a -&gt; a) -&gt; m (a -&gt; a)</code>. I can provide a more concrete example if it makes more sense.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 30577, "user_id": 476496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85197b0087c5bee323d2690c977878f8?s=128&d=identicon&r=PG", "display_name": "Vincent Savard", "link": "https://stackoverflow.com/users/476496/vincent-savard"}, "edited": false, "score": 3, "creation_date": 1459882124, "post_id": 36434015, "comment_id": 60483778, "body": "It&#39;s really weird to see people voting to close this for &quot;asking us to recommend or find a book, tool, software library, tutorial or other off-site resource&quot;. That&#39;s not even close to be the case here. Please take time to read the question carefully before using close votes."}], "answers": [{"comments": [{"owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "edited": false, "score": 0, "creation_date": 1459882209, "post_id": 36434575, "comment_id": 60483819, "body": "Thanks for the reply. My directory package version is &quot;directory-1.2.2.0&quot;. Is &quot;cabal update&#39; don&#39;t update the directory package ? Can you tell me how to get the latest package..."}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "edited": false, "score": 1, "creation_date": 1459883422, "post_id": 36434575, "comment_id": 60484537, "body": "You&#39;ll need to add <code>directory &gt;= 1.2.5.0</code> to your <code>build-depends</code> section of the .cabal file. If you&#39;re using Stack, then add <code>&#39;directory-1.2.5.1&#39;</code> to the <code>extra-deps</code> section in your <code>stack.yaml</code> file. (if you&#39;re just using cabal, I don&#39;t recall the extra dependency step off hand)"}, {"owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "edited": false, "score": 0, "creation_date": 1459884505, "post_id": 36434575, "comment_id": 60485208, "body": "Thanks for the help. Command &quot;cabal install &#39;directory-1.2.5.0&#39; &quot; solves the issue."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 6, "last_activity_date": 1459881886, "creation_date": 1459881886, "answer_id": 36434575, "question_id": 36434015, "link": "https://stackoverflow.com/questions/36434015/haskell-not-in-scope-listdirectory/36434575#36434575", "title": "Haskell: Not in scope: \u2018listDirectory\u2019", "body": "<p><code>listDirectory</code> wasn't added until <a href=\"https://github.com/haskell/directory/releases/tag/v1.2.5.0\">version 1.2.5.0</a> last December. Take a look at your version of the <code>directory</code> package by running <code>ghc-pkg list</code>, or if you are using Stack, run <code>stack exec ghc-pkg list</code>.</p>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 0, "accepted_answer_id": 36434575, "answer_count": 1, "score": 4, "last_activity_date": 1587328362, "creation_date": 1459880185, "last_edit_date": 1459880675, "question_id": 36434015, "link": "https://stackoverflow.com/questions/36434015/haskell-not-in-scope-listdirectory", "title": "Haskell: Not in scope: \u2018listDirectory\u2019", "body": "<p>I am using GHC version 7.10.2. When i try to use listDirectory function, I am getting following error.</p>\n\n<pre><code>Prelude System.Directory&gt; :t listDirectory\n\n&lt;interactive&gt;:1:1: Not in scope: \u2018listDirectory\u2019\n</code></pre>\n\n<p>I am also updated my packages using 'cabal update'. </p>\n\n<p><strong>Reference</strong>\n<a href=\"https://hackage.haskell.org/package/directory-1.2.5.1/docs/System-Directory.html\" rel=\"nofollow\">https://hackage.haskell.org/package/directory-1.2.5.1/docs/System-Directory.html</a></p>\n"}, {"tags": ["haskell", "monads", "scoping"], "answers": [{"comments": [{"owner": {"reputation": 1478, "user_id": 2694653, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2ab9cc51a2c71aa4bb9ab5d5525eca68?s=128&d=identicon&r=PG&f=1", "display_name": "DARK_DUCK", "link": "https://stackoverflow.com/users/2694653/dark-duck"}, "edited": false, "score": 0, "creation_date": 1459872615, "post_id": 36431567, "comment_id": 60477538, "body": "I&#39;m sorry there are two good answers and this one was the first.  I understand now. It all make sense because now there is one lambda for all different a, it explains why I was confused about this code.   thank you very much (both of you)"}], "tags": [], "owner": {"reputation": 49501, "user_id": 784338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae195ac7c8a5e9002a808544572cc5fc?s=128&d=identicon&r=PG", "display_name": "Daniel Gratzer", "link": "https://stackoverflow.com/users/784338/daniel-gratzer"}, "is_accepted": true, "score": 12, "last_activity_date": 1459872308, "creation_date": 1459872308, "answer_id": 36431567, "question_id": 36431489, "link": "https://stackoverflow.com/questions/36431489/understanding-scoping-with-haskell-monads/36431567#36431567", "title": "Understanding scoping with haskell monads", "body": "<p>The issue is that the scope of the lambda in your code is not quite right. It should extend all the way to the end of the expression, not just around the small computation. Your code should desugar to</p>\n\n<pre><code> l &gt;&gt;= (\\a -&gt; m &gt;&gt;= (\\b -&gt; return (a, b))\n</code></pre>\n\n<p>You can drop the parentheses by the way, which makes it a little more pleasant.</p>\n\n<pre><code> l &gt;&gt;= \\a -&gt; m &gt;&gt;= \\b -&gt; return (a, b)\n</code></pre>\n\n<p>but this kind of obscures the meaning. If you want to be painfully explicit, we can convert to prefix notation and say</p>\n\n<pre><code> bind a f = a &gt;&gt;= f\n bind l (\\a -&gt; bind m (\\b -&gt; return (a, b))\n</code></pre>\n\n<p>Perhaps stripping away some of the operator sugar helps.</p>\n\n<p>Note how the >>='s nest <em>inside</em> the lambda, not around it. This ensures that <code>a</code> remains in scope. In fact, this nesting is a little bit of a pain to write out by hand, that's part of the impetus for do-notation :)</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 7, "last_activity_date": 1459872324, "creation_date": 1459872324, "answer_id": 36431573, "question_id": 36431489, "link": "https://stackoverflow.com/questions/36431489/understanding-scoping-with-haskell-monads/36431573#36431573", "title": "Understanding scoping with haskell monads", "body": "<p>The problem is with your parentheses. You write</p>\n\n<pre><code>res = l &gt;&gt;= (\\a -&gt; m) &gt;&gt;= (\\b -&gt; return (a, b))\n</code></pre>\n\n<p>but what you need is</p>\n\n<pre><code>res = l &gt;&gt;= (\\a -&gt; m &gt;&gt;= (\\b -&gt; return (a, b)))\n</code></pre>\n\n<p>which can also be written</p>\n\n<pre><code>res = l &gt;&gt;= \\a -&gt; m &gt;&gt;= \\b -&gt; return (a, b)\n</code></pre>\n\n<p>You ended the lambda expression binding <code>a</code> prematurely, and then tried to use <code>a</code>.</p>\n"}], "owner": {"reputation": 1478, "user_id": 2694653, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2ab9cc51a2c71aa4bb9ab5d5525eca68?s=128&d=identicon&r=PG&f=1", "display_name": "DARK_DUCK", "link": "https://stackoverflow.com/users/2694653/dark-duck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 36431567, "answer_count": 2, "score": 4, "last_activity_date": 1459872324, "creation_date": 1459872107, "last_edit_date": 1459872218, "question_id": 36431489, "link": "https://stackoverflow.com/questions/36431489/understanding-scoping-with-haskell-monads", "title": "Understanding scoping with haskell monads", "body": "<p>I'm trying to understand how the scope works in do blocks.</p>\n\n<p>If I have the following code:</p>\n\n<pre><code>l = [1, 2, 3]\nm = [1, 2]\n</code></pre>\n\n<p>then this works fine </p>\n\n<pre><code>res = do\n    a &lt;- l\n    b &lt;- m\n    return (a, b)\n</code></pre>\n\n<p>And return the Cartesian product of <code>m</code> and <code>l</code>.</p>\n\n<p>To understand the scope I tried to rewrite this in a different form (without do blocks)</p>\n\n<p>I know that do blocks are just syntactic sugar over monadic operations so I tried to \"unsugar\" it and by using <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation#Translating_the_bind_operator\" rel=\"nofollow\">this</a> and came up with this:</p>\n\n<pre><code>res = l &gt;&gt;= (\\a -&gt; m) &gt;&gt;= (\\b -&gt; return (a, b))\n</code></pre>\n\n<p>Strangely I get this error <code>Not in scope: \u2018a\u2019</code>. </p>\n\n<p>Can anyone tell me where I did it wrong and possibly, how the scoping works because it really looks like magic that the <code>return</code> in the do block is able to access a ?</p>\n\n<p>Thank you very much</p>\n"}, {"tags": ["haskell", "timeout"], "answers": [{"comments": [{"owner": {"reputation": 49501, "user_id": 784338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae195ac7c8a5e9002a808544572cc5fc?s=128&d=identicon&r=PG", "display_name": "Daniel Gratzer", "link": "https://stackoverflow.com/users/784338/daniel-gratzer"}, "edited": false, "score": 1, "creation_date": 1459875127, "post_id": 36431961, "comment_id": 60479267, "body": "You definitely want to use <code>atomicModifyIORef&#39;</code> here or just use <code>MVar</code>s properly, this currently has a race condition otherwise, we can kill this thread midway through writing to the <code>IORef</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 49501, "user_id": 784338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae195ac7c8a5e9002a808544572cc5fc?s=128&d=identicon&r=PG", "display_name": "Daniel Gratzer", "link": "https://stackoverflow.com/users/784338/daniel-gratzer"}, "edited": false, "score": 0, "creation_date": 1459875321, "post_id": 36431961, "comment_id": 60479401, "body": "@jozefg, I read through the &quot;Memory Model&quot; section of the documentation, which attempts to explain this, and I found it rather opaque. It looks like the difference is more about what operations can be reordered, right? So the only potential problem with the non-atomic versions here (if I&#39;m understanding correctly) is that you might not get the very last value in case of an interrupted computation."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 49501, "user_id": 784338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae195ac7c8a5e9002a808544572cc5fc?s=128&d=identicon&r=PG", "display_name": "Daniel Gratzer", "link": "https://stackoverflow.com/users/784338/daniel-gratzer"}, "edited": false, "score": 0, "creation_date": 1459875359, "post_id": 36431961, "comment_id": 60479418, "body": "There&#39;s no way to &quot;partially write&quot; an <code>IORef</code>, since it only contains a single pointer."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 49501, "user_id": 784338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae195ac7c8a5e9002a808544572cc5fc?s=128&d=identicon&r=PG", "display_name": "Daniel Gratzer", "link": "https://stackoverflow.com/users/784338/daniel-gratzer"}, "edited": false, "score": 0, "creation_date": 1459875480, "post_id": 36431961, "comment_id": 60479496, "body": "OTOH, if it can do something awful like just returning the very first value, then the atomic versions are definitely the way to go. I don&#39;t know enough about it."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1459887501, "post_id": 36431961, "comment_id": 60487159, "body": "It would probably be simpler not read from the <code>IORef</code> in <code>iterStep</code>. Just pass the parameters along as normal function parameters. I&#39;m almost certain this would be more efficient than reading from the <code>IORef</code> anyways."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459888618, "post_id": 36431961, "comment_id": 60487792, "body": "@user2407038, could reordering end up causing the partial result reported be one other than the last (at worst, the first)?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459889999, "post_id": 36431961, "comment_id": 60488625, "body": "@dfeuer I don&#39;t see how the writes could be re-ordered, unless the compiler for some reason decided to optimize away the writes altogether. Each write has a branch in between (<code>if p oldVal ..</code>), in general there is no way to tell if there even will even be any writes to reorder at all! I don&#39;t think the compiler would move the writes past a call to a recursive function either. Even if there weren&#39;t these natural barriers in the code, I think <code>atomicWriteIORef</code> would do it."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459890299, "post_id": 36431961, "comment_id": 60488788, "body": "@dfeuer If you wanted to make this really robust, I think that the worker thread would need a lock which it releases between every iteration, and at the end of the timeout the main thread (instead of killer the worker directly) waits on the lock, then kills the worker (the <code>async</code> library would probably help quite a bit here)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1459891240, "post_id": 36431961, "comment_id": 60489282, "body": "@user2407038, that may be &quot;robust&quot; in one sense, bit doesn&#39;t guarantee that the worker dies in a timely fashion."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1459874770, "last_edit_date": 1459874770, "creation_date": 1459873482, "answer_id": 36431961, "question_id": 36431318, "link": "https://stackoverflow.com/questions/36431318/time-bounded-function-with-partial-result-in-haskell/36431961#36431961", "title": "Time bounded function with partial result in Haskell", "body": "<p>I believe your best bet is to use an <code>IORef</code> to keep track of the current computation state. Even if the computation is interrupted, its side effects won't be undone. Be sure to use just <em>one</em> <code>IORef</code> for both the counter and the current value; otherwise they could go out of sync in case of a timeout.</p>\n\n<p>I'm not at all experienced with asynchronous code in Haskell, so take this with a grain of salt, but it seems to work.</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\nmodule IterTimeout where\nimport Control.Applicative\nimport Data.IORef\nimport System.Timeout\n\niter :: a -&gt; (a -&gt; a) -&gt; (a -&gt; Bool) -&gt; Int -&gt; IO (Either (Int, a) (Int, a))\niter x f p t = do\n  ref &lt;- newIORef (0, x)\n  result &lt;- timeout t (iterStep f p ref)\n  maybe (Left &lt;$&gt; readIORef ref) (return . Right) result\n\niterStep :: (a -&gt; a) -&gt; (a -&gt; Bool) -&gt; IORef (Int, a) -&gt; IO (Int, a)\niterStep f p ref = go\n  where\n    go = do\n      old@(!oldCount, oldVal) &lt;- readIORef ref\n      if p oldVal\n        then return old\n        else writeIORef ref (oldCount + 1, f oldVal) &gt;&gt; go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 5, "last_activity_date": 1459910044, "last_edit_date": 1459910044, "creation_date": 1459896353, "answer_id": 36438407, "question_id": 36431318, "link": "https://stackoverflow.com/questions/36431318/time-bounded-function-with-partial-result-in-haskell/36438407#36438407", "title": "Time bounded function with partial result in Haskell", "body": "<p>I believe it is simplest to delegate such tasks to libraries with better abstraction capability than that offered by <code>base</code>, e.g. <a href=\"https://hackage.haskell.org/package/async-2.1.0/docs/Control-Concurrent-Async.html\" rel=\"nofollow\"><code>async</code></a>:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-} \n\nimport Control.Concurrent.Async \nimport Control.Concurrent \n\niter :: a -&gt; (a -&gt; a) -&gt; (a -&gt; Bool) -&gt; Int -&gt; IO (Either (Int, a) (Int, a))\niter z f p maxt = do \n  o &lt;- newMVar (0, z)\n  let loop old@(!i,x) = do \n        modifyMVar_ o (const $ return old)\n        if p x then return old else loop (i+1, f x)\n  race (threadDelay maxt &gt;&gt; readMVar o) (loop (0, z))\n</code></pre>\n\n<p><code>race</code> takes two <code>IO</code> actions and returns whichever completes first, killing the other. The left action completes only if the maximum time has elapsed, and that thread is able to read the <code>MVar</code>. Since the other thread holds the <code>MVar</code> for a short period of time (while it is writing the result) the worker will never be interrupted while writing the result.</p>\n\n<p>Note also that the only thing that forces the chain of applications <code>f $ f $ f..</code> is the predicate <code>p</code> - if you pass a lazy function (e.g. <code>const False</code>) then this will not work as you want. In practice there are few cases when you would use such a function (esp. with numeric computing), so it likely won't be of much concern. But in this case <code>loop</code> does no actual work and builds a ridiculously large number amount of applications:</p>\n\n<pre><code>&gt;iter 2 (\\x -&gt; x * x) (const False) (10^6)\nLeft (472190,Interrupted.\n</code></pre>\n\n<p>My computer will never be able to print this result because it has <a href=\"https://www.wolframalpha.com/input/?i=2%5E2%5E472190\" rel=\"nofollow\">6.8\u00d710^142142 digits</a>. However:</p>\n\n<pre><code>&gt;iter 2 (\\x -&gt; x * x) (&lt;0) (10^6)\nLeft (24,Interrupted\n</code></pre>\n\n<p>This is a small number with only about <a href=\"https://www.wolframalpha.com/input/?i=2%5E2%5E24\" rel=\"nofollow\">5,000,000 digits</a>. </p>\n"}], "owner": {"reputation": 305, "user_id": 3315928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085d0ebe8f6fbb01dbcc2223a9e7a397?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmeet Singh", "link": "https://stackoverflow.com/users/3315928/gurmeet-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 36438407, "answer_count": 2, "score": 2, "last_activity_date": 1459910044, "creation_date": 1459871621, "question_id": 36431318, "link": "https://stackoverflow.com/questions/36431318/time-bounded-function-with-partial-result-in-haskell", "title": "Time bounded function with partial result in Haskell", "body": "<p>An initial value (x), function (f), a predicate (p) and a time bound (t) is given. I want to apply 'f' repeatedly on x till it satisfies the 'p'. But on the same time wanna make sure it doesn't exceeds time limit. If time exceeds 't', it should return the partial result i.e., a pair of a number 'n' and value of applying 'f' n-times on 'x', for the largest n for which it actually performed the computation.</p>\n\n<p>If partial result condition is relaxed, this can be easily programmed as -</p>\n\n<pre><code>import System.Timeout\n\niter :: a -&gt; (a -&gt; a) -&gt; (a -&gt; Bool) -&gt; Int -&gt; IO (Maybe (Int, a))\niter x f p t = do\n  let fs = x:(map f fs)\n  timeout t $ return $! head $ filter (\\x -&gt; p $ snd x) $ zip [1..] fs\n</code></pre>\n\n<p>I want it to have signature similar to - </p>\n\n<pre><code>iter :: a -&gt; (a -&gt; a) -&gt; (a -&gt; Bool) -&gt; Int -&gt; IO (Either (Int, a) (Int, a))\n</code></pre>\n\n<p>With Left for partial result and Right for complete result.</p>\n\n<p>An silly and trivial example use of above function is -</p>\n\n<pre><code>*Main&gt; iter 1 (+2) (&gt; 1000000) 1000000\nJust (500001,1000001)\n*Main&gt; iter 1 (+2) (&gt; 1000000) 100000\nNothing\n</code></pre>\n\n<p>I want the second call to return partial computed result. Is there a simple way to do it?</p>\n\n<p>More practical examples can be Newton\u2013Raphson method or gradient descent.</p>\n"}, {"tags": ["haskell", "module", "compilation", "main"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1459870113, "post_id": 36430686, "comment_id": 60475659, "body": "just change <code>double 6</code> into <code>print $ double 6</code> ... it will compile"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459870143, "post_id": 36430686, "comment_id": 60475677, "body": "to see why you should read a bit about <code>IO</code> (and the <i>feared</i> <code>IO</code> Monad)"}, {"owner": {"reputation": 129, "user_id": 5943974, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1vici.png?s=128&g=1", "display_name": "possum_pendulum", "link": "https://stackoverflow.com/users/5943974/possum-pendulum"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459870486, "post_id": 36430686, "comment_id": 60475915, "body": "Thanks, that makes sense because the main has to complete an I/O action, correct? What would it look like if I needed to do multiple tasks in the main?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459870642, "post_id": 36430686, "comment_id": 60476050, "body": "it does not really have to do something but it needs to be of type <code>IO ()</code> (<code>main = return () </code> would do nothing but still be ok) - if you want to do more than one thing you use <code>main = do \\n firstThing \\n secondThing \\n ...</code> or use <code>sequence</code> (or <code>forM</code> or <code>mapM</code> or <code>&gt;&gt;=</code> or <code>&gt;&gt;</code>or ... the possibilities are really endless ;)) - but that should really be part of your course!"}, {"owner": {"reputation": 129, "user_id": 5943974, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1vici.png?s=128&g=1", "display_name": "possum_pendulum", "link": "https://stackoverflow.com/users/5943974/possum-pendulum"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459870885, "post_id": 36430686, "comment_id": 60476234, "body": "Thanks again. Yes it should certainly be a part of the course, unfortunately my professor is not great and has only taught us GHCi commands and not how to translate them into compilable source code. I appreciate the help, friend"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459871019, "post_id": 36430686, "comment_id": 60476352, "body": "you surely get to it - it&#39;s not unusual to postpone this stuff a bit till you are fit to handle the monad stuff"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1459872287, "post_id": 36430686, "comment_id": 60477311, "body": "@possum_pendulum also, add an optimization flag like <code>-O</code> or <code>-O2</code> when compiling."}], "answers": [{"tags": [], "owner": {"reputation": 49501, "user_id": 784338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae195ac7c8a5e9002a808544572cc5fc?s=128&d=identicon&r=PG", "display_name": "Daniel Gratzer", "link": "https://stackoverflow.com/users/784338/daniel-gratzer"}, "is_accepted": false, "score": 1, "last_activity_date": 1459872918, "creation_date": 1459872918, "answer_id": 36431768, "question_id": 36430686, "link": "https://stackoverflow.com/questions/36430686/compilable-executable-haskell-source-code-example/36431768#36431768", "title": "Compilable/Executable Haskell Source Code Example", "body": "<p>The issue here is that when GHC is compiling your code it expects <code>main</code> to have a type suitable for the entry point to your program. It needs to have the type of \"code which does input-output\" because otherwise a Haskell program doesn't actually do anything observable! </p>\n\n<p>That is, it expects to find <code>main :: IO X</code> for some <code>X</code>. It's considered good practice to have <code>main :: IO ()</code> which signifies that <code>main</code> is some program which does input-output and finally produces <code>()</code>, a trivial result.</p>\n\n<p>Currently you have <code>main :: Integer</code>, a type error. Fixing this demands you decide what you want your program to do when run, a good default is printing something. We can use the function <code>print :: Show a =&gt; a -&gt; IO ()</code> which will convert the supplied value to a string using <code>show</code> and print it to standard out. So we can write</p>\n\n<pre><code> main :: IO ()\n main = print (double 6)\n</code></pre>\n\n<p>And everything will work just like you're at the REPL.</p>\n\n<p>In general, read more about <code>IO</code> in <a href=\"http://book.realworldhaskell.org/read/io.html\" rel=\"nofollow\">Real World Haskell</a>. It's perfectly possible to use it without understanding monads or whatever.</p>\n"}, {"tags": [], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "is_accepted": false, "score": 0, "last_activity_date": 1459879172, "creation_date": 1459879172, "answer_id": 36433702, "question_id": 36430686, "link": "https://stackoverflow.com/questions/36430686/compilable-executable-haskell-source-code-example/36433702#36433702", "title": "Compilable/Executable Haskell Source Code Example", "body": "<p>\"my assignments require...\" then ask your instructor. Check first whether she already gave you the answer (in the problem statement, or in class).</p>\n"}], "owner": {"reputation": 129, "user_id": 5943974, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1vici.png?s=128&g=1", "display_name": "possum_pendulum", "link": "https://stackoverflow.com/users/5943974/possum-pendulum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459879172, "creation_date": 1459870025, "question_id": 36430686, "link": "https://stackoverflow.com/questions/36430686/compilable-executable-haskell-source-code-example", "title": "Compilable/Executable Haskell Source Code Example", "body": "<p>I am learning Haskell as part of a Programming Languages course I am taking. I'm having quite a hard time understanding how to write entire Haskell programs. I understand basic syntax as used in GHCi, but my assignments require creating .hs files and compiling/executing them in Windows CMD, using commands:</p>\n\n<pre><code>ghc -o test test.hs\ntest.exe\n</code></pre>\n\n<p>If someone could explain how to write the following example then I think I will understand what I need in order to proceed.</p>\n\n<pre><code>module Main where\ndouble :: Integer -&gt; Integer\ndouble x = x * 2\n\nmain :: IO ()\nmain = double 6\n</code></pre>\n\n<p>All I want to do here is to write a function that returns the double of an integer parameter, and have the main call that function with the parameter '6'. What should I be doing differently as far as separating the main module and function modules in the .hs file? Thanks for the help.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1459867404, "post_id": 36429567, "comment_id": 60473603, "body": "Missing parens (<code>mylast (x:[]) = ...</code>). Also you can&#39;t return a <code>String</code> from a function that&#39;s supposed to return <code>a</code>, neither can you append <code>x</code> to it."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1459869082, "post_id": 36429567, "comment_id": 60474924, "body": "You don&#39;t need <code>Eq</code> qualification either since <code>last</code> doesn&#39;t depend on the identity of the elements, just the position."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1459868453, "post_id": 36429660, "comment_id": 60474431, "body": "You might want to explain why it is that the <code>Maybe a</code> result is so much more useful than the attempted <code>String</code> result. That&#39;s obvious to us, but it might smell of needless abstraction to a newcomer."}, {"owner": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "edited": false, "score": 0, "creation_date": 1459877444, "post_id": 36429660, "comment_id": 60480745, "body": "@Chad Gilbert I tried to run the script by Removing Just And it was throwing an error.What does  Just Actually do ?"}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "edited": false, "score": 0, "creation_date": 1459878525, "post_id": 36429660, "comment_id": 60481407, "body": "@v.sharathchandra - I updated my answer with an example of how to use the return value of the <code>Maybe a</code> returned by <code>mylast</code> by returning a string that describes the contents. Think of <code>Just</code> as a wrapper around a successful value."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 2, "last_activity_date": 1459878396, "last_edit_date": 1459878396, "creation_date": 1459867505, "answer_id": 36429660, "question_id": 36429567, "link": "https://stackoverflow.com/questions/36429567/program-to-find-the-last-element-in-the-list/36429660#36429660", "title": "Program To Find the Last Element in the List?", "body": "<p>A few things are wrong.</p>\n\n<p>You need parentheses around your pattern matching for <code>(x:[])</code> and <code>(x:xs)</code>.</p>\n\n<p>You are also missing a case for the empty list, so it will crash. A safer way of handling this is to use <code>Maybe</code>, returning <code>Nothing</code> on an empty list. You <em>could</em> let your program crash on an empty list, but that's generally considered bad form. The <code>Maybe</code> type allows you to explicitly state, in the most simple manner, that your function may return a non-successful result. In other languages, you might return a <code>null</code> on bad input.</p>\n\n<p>You don't need the <code>Eq</code> typeclass because you aren't comparing anything. Furthermore, you are returning a String when your declaration says you should be returning a value of type <code>a</code>. I recommend this implementation:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>mylast :: [a] -&gt; Maybe a\nmylast [] = Nothing\nmylast (x:[]) = Just x\nmylast (_:xs) = mylast xs\n</code></pre>\n\n<p>Now you can use the result of <code>mylast</code> to display the original text you showed in your example, plus you can show a friendly message (rather than crashing) if an empty list was provided:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>displayLast :: Show a =&gt; [a] -&gt; String\ndisplayLast list =\n  case mylast list of\n    Nothing -&gt; \"The list was empty!\"\n    Just lastItem -&gt; \"Last element is \" ++ (show lastItem)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": -2, "last_activity_date": 1459868985, "creation_date": 1459868985, "answer_id": 36430248, "question_id": 36429567, "link": "https://stackoverflow.com/questions/36429567/program-to-find-the-last-element-in-the-list/36430248#36430248", "title": "Program To Find the Last Element in the List?", "body": "<pre><code>Prelude&gt; :info last\nlast :: [a] -&gt; a        -- Defined in `GHC.List'\n\nPrelude&gt; last [1..10]\n10\n\nPrelude&gt; last []\n*** Exception: Prelude.last: empty list\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1001, "favorite_count": 0, "accepted_answer_id": 36429660, "answer_count": 2, "score": 1, "last_activity_date": 1459878396, "creation_date": 1459867224, "question_id": 36429567, "link": "https://stackoverflow.com/questions/36429567/program-to-find-the-last-element-in-the-list", "title": "Program To Find the Last Element in the List?", "body": "<pre><code>mylast :: (Eq a) =&gt; [a] -&gt; a\nmylast x:[] = \"Last element is \" ++ x\nmylast x:xs = mylast xs\n</code></pre>\n\n<p>I wanted to find the last element of a List L given as input to mylast function.\nAs the List may contain integers or characters or strings I used Eq typeclass for indicating that type of elements of the list should belong to Eq.But I am getting the Following Error:\n       <em>LastEle.hs:2:1: Parse error in pattern: mylast</em></p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1459866822, "post_id": 36429164, "comment_id": 60473094, "body": "i assume the value of the type is correct and your type declaration is not - therefore I adjusted the type"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1459866889, "post_id": 36429164, "comment_id": 60473149, "body": "could you please elaborate what you mean by accessing? Also could you show expected input/output of such a function?"}, {"owner": {"reputation": 765, "user_id": 3316409, "user_type": "registered", "profile_image": "https://graph.facebook.com/719585406/picture?type=large", "display_name": "dvaergiller", "link": "https://stackoverflow.com/users/3316409/dvaergiller"}, "edited": false, "score": 0, "creation_date": 1459868470, "post_id": 36429164, "comment_id": 60474446, "body": "Is the problem about always accessing all data after the fourth tuple, regardless of how many tuples are in the first list of the outer tuple? Or is it about getting all the data in the second list of the outer tuple?"}], "answers": [{"tags": [], "owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "is_accepted": false, "score": 1, "last_activity_date": 1459868046, "last_edit_date": 1459868046, "creation_date": 1459867101, "answer_id": 36429510, "question_id": 36429164, "link": "https://stackoverflow.com/questions/36429164/list-operation-in-haskell/36429510#36429510", "title": "List operation in Haskell", "body": "<p>It's not a list, but a tuple of lists. In fact, a tuple of lists of tuples.</p>\n\n<p>To get the second part of a tuple, use the <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:snd\" rel=\"nofollow\"><code>snd</code></a> command:</p>\n\n<pre><code>snd ([(1.0,1.0), (2.0,1.0), (1.0,1.0), (1.0,3.0)],[(1.0,4.0), (1.0,5.0), (1.0,1.0), (1.0,2.0), (1.0,3.0), (1.0,4.0), (1.0,5.0)])\n</code></pre>\n\n<p>This yields:</p>\n\n<pre><code>[(1.0,4.0),(1.0,5.0),(1.0,1.0),(1.0,2.0),(1.0,3.0),(1.0,4.0),(1.0,5.0)]\n</code></pre>\n\n<p>From here on, you can continue to get the parts of the second list using <code>tail</code> or the <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:-33--33-\" rel=\"nofollow\"><code>!!</code></a> operator.</p>\n\n<p>For completeness, the first part of a tuple can be obtained using the <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:fst\" rel=\"nofollow\"><code>fst</code></a> command.</p>\n"}, {"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 4, "last_activity_date": 1459867182, "creation_date": 1459867182, "answer_id": 36429548, "question_id": 36429164, "link": "https://stackoverflow.com/questions/36429164/list-operation-in-haskell/36429548#36429548", "title": "List operation in Haskell", "body": "<p>Well, for one, your list isn't a list, but a tuple :)</p>\n\n<pre><code>type MyData = (MyList, MyList)\ntype MyList = [MyListElem]\ntype MyListElem = (Double, Double)\n</code></pre>\n\n<p>Now, accessing the 2nd list is simply <code>snd</code>.</p>\n\n<pre><code>snd :: (a,b) -&gt; b\n</code></pre>\n\n<p>So in your case:</p>\n\n<pre><code>snd :: MyData -&gt; MyList\n</code></pre>\n\n<hr>\n\n<p>Alternatively, using <code>Lens</code>, you can use a lens on that directly:</p>\n\n<pre><code>list ^. _2\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6079242, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/866e1ad926011e12fccc371a1f76ded5?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil Gautam", "link": "https://stackoverflow.com/users/6079242/sunil-gautam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1459868046, "creation_date": 1459866200, "last_edit_date": 1459866826, "question_id": 36429164, "link": "https://stackoverflow.com/questions/36429164/list-operation-in-haskell", "title": "List operation in Haskell", "body": "<p>I have this list of type <code>([(Double,Double)],[(Double,Double)])</code>. <code>example list = ([(1.0,1.0), (2.0,1.0), (1.0,1.0), (1.0,3.0)],[(1.0,4.0), (1.0,5.0), (1.0,1.0), (1.0,2.0), (1.0,3.0), (1.0,4.0), (1.0,5.0)])</code></p>\n\n<p>How would I access all the data after the fourth tuple (1.0, 3.0). I have already tried the tail function but doesn't seem to work. Thanks.</p>\n"}, {"tags": ["haskell", "smallcheck"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1459860837, "post_id": 36426303, "comment_id": 60468180, "body": "you could create a random <code>[NonNegative Int]</code> of even length and then use a <code>scan (+) 0</code> and a helper function to pair them up."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1459861065, "post_id": 36426303, "comment_id": 60468369, "body": "ahh and watch out for <code>Int</code>-overflows ;-)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1459863277, "post_id": 36426303, "comment_id": 60470071, "body": "@epsilonhalbe, that&#39;s clever, but test properties should usually be more obviously correct/complete."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1459891574, "post_id": 36426303, "comment_id": 60489470, "body": "@dfeuer If I understand correctly this is not the property to prove, but the input for them, the properties themselves should be simple/correct. =&gt; added an answer to make this more concrete."}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1459891659, "post_id": 36433538, "comment_id": 60489506, "body": "I think sorting/merging is an unnecessary overhead, compared to generating them on their own, if they are just generated for test properties sake"}], "tags": [], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "is_accepted": true, "score": 3, "last_activity_date": 1459886216, "last_edit_date": 1459886216, "creation_date": 1459878670, "answer_id": 36433538, "question_id": 36426303, "link": "https://stackoverflow.com/questions/36426303/smallcheck-generate-data-satisfying-invariants/36433538#36433538", "title": "SmallCheck generate data satisfying invariants", "body": "<p>Favour application-specific types over built-int types (Int, List). This is advice not just for SmallCheck, but for any piece of software, in any language.</p>\n\n<pre><code>data Interval = Interval (Int,Int)\ndata Domain = Domain [Interval]\n</code></pre>\n\n<p>Write smart constructors that enforce your invariants.</p>\n\n<pre><code>interval :: Int -&gt; Int -&gt; Interval\ninterval x y = Interval (min x y, max x y) -- if you want this\n\ndomain :: [Interval] -&gt; Domain\ndomain ints = Domain ... (something that sorts intervals, and perhaps merges them)\n</code></pre>\n\n<p>Then use these to create Serial instances.</p>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1459891440, "creation_date": 1459891440, "answer_id": 36437323, "question_id": 36426303, "link": "https://stackoverflow.com/questions/36426303/smallcheck-generate-data-satisfying-invariants/36437323#36437323", "title": "SmallCheck generate data satisfying invariants", "body": "<p>I do agree that this problem is solved better with user-defined types.</p>\n\n<p>I assume you are writing an algorithm that has some property for disjoint half-open intervals sorted in an ascending order, then the following provides <code>Serial</code> instances.</p>\n\n<p>I decided to give <code>Interval</code> and <code>AscDisjIntervals</code> different generators rather than implementing one in terms of the other.</p>\n\n<p>The algorithm for <code>AscDisjIntervals</code> is as I already wrote in the comment</p>\n\n<ul>\n<li>generating a list of non-negative <code>Integer</code>s (this is to avoid <code>Int</code> overflow)</li>\n<li>summing these integers (this asserts an ascending order of all values</li>\n<li>generating pairs from this list (discarding the last single element if the list has an odd number of elements)</li>\n</ul>\n\n<p><code>Intervals.hs</code></p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses #-}\nmodule Intervals where\n\nnewtype Interval = I (Integer,Integer) deriving(Eq)\n\ninstance Show Interval where\n    show (I (a,b)) = \"[\"++show a ++ \", \"++ show b ++ \"]\"\n\ninstance Monad m =&gt; Serial m Interval where\n    series = let a_b a b = I (getNonNegative $ min a b , getNonNegative $ max a b) \n             in cons2 a_b\n\nnewtype AscDisjIntervals = ADI [Interval] deriving (Eq)\n\ninstance Show AscDisjIntervals where\n    show (ADI x) = \"|- \"++ (unwords $ map show x) ++ \" -&gt;\"\n\ninstance Monad m =&gt; Serial m AscDisjIntervals where\n    series = cons1 aux1\n\naux1 :: [NonNegative Int] -&gt; AscDisjIntervals\naux1 xx = ADI . generator . tail $ scanl (+) 0 xx\n  where generator [] = []\n        generator (_:[]) = []\n        generator (x:y:xs) = let i = I (getNonNegative x ,getNonNegative y)\n                        in i:generator xs\n</code></pre>\n\n<p>Note: I only compiled the program and did not test any properties.</p>\n"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 36433538, "answer_count": 2, "score": 1, "last_activity_date": 1459891440, "creation_date": 1459859024, "question_id": 36426303, "link": "https://stackoverflow.com/questions/36426303/smallcheck-generate-data-satisfying-invariants", "title": "SmallCheck generate data satisfying invariants", "body": "<p>I want to use SmallCheck to test my code. I managed to generate arbitrary lists of pairs of ints, but that's not what my type should contain. The list represents a set of ranges, where <code>[1,3),[4,6)</code> would be encoded/stored as <code>[(1,3),(4,6)]</code>. </p>\n\n<p>These are the invariants for the normalized form of my ranges:</p>\n\n<pre><code>fst a &lt; snd a \nsnd a &lt; fst b where a is before b in the list\n</code></pre>\n\n<p>I would like to communicate this to SmallCheck so that it doesn't generate loads of values that I throw away, because they aren't satisfying my invariants, but maybe that's not possible. </p>\n\n<p>How can I generate lists satisfying my invariants?</p>\n"}, {"tags": ["haskell", "primes"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 1, "creation_date": 1459855283, "post_id": 36424064, "comment_id": 60464054, "body": "<a href=\"http://hayoo.fh-wedel.de/?query=Data.Numbers.Primes\" rel=\"nofollow noreferrer\">Hayoo</a> is a good search engine for stuff like this."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1459882572, "post_id": 36424064, "comment_id": 60484030, "body": "Also, start using stack to save yourself from dependency hell issues."}, {"owner": {"reputation": 2262, "user_id": 4551565, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3177185a7dbdb6bc72aee5f5554e53a?s=128&d=identicon&r=PG&f=1", "display_name": "Pigna", "link": "https://stackoverflow.com/users/4551565/pigna"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1459884979, "post_id": 36424064, "comment_id": 60485515, "body": "@MichaelLitchard newbie here, can you elaborate please?"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1459885801, "post_id": 36424064, "comment_id": 60486083, "body": "Ah yes, well the further along you go, the more likely you will run into the transitivity problem we call &quot;dependency hell&quot;. Check out stack for a solution. <a href=\"https://github.com/commercialhaskell/stack/tree/master/doc\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/tree/master/doc</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1459901421, "post_id": 36424064, "comment_id": 60493112, "body": "use the <a href=\"https://hackage.haskell.org/package/arithmoi-0.4.1.3/docs/Math-NumberTheory-Primes-Sieve.html#v:primes\" rel=\"nofollow noreferrer\">arithmoi package</a>."}], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 7, "last_activity_date": 1459852873, "creation_date": 1459852873, "answer_id": 36424095, "question_id": 36424064, "link": "https://stackoverflow.com/questions/36424064/haskell-where-is-data-numbers-primes-library/36424095#36424095", "title": "Haskell: where is Data.Numbers.Primes library?", "body": "<p>The package you're looking for is called <a href=\"https://hackage.haskell.org/package/primes\" rel=\"noreferrer\"><code>primes</code></a>.</p>\n\n<p>There's no rule that the package will be called as it's top-level module name. Typically, packages put themselves under whatever makes sense, but that's pretty much arbitrary. When in doubt, <a href=\"https://hackage.haskell.org/packages/search?terms=Primes\" rel=\"noreferrer\">Hackage search</a> helps.</p>\n"}], "owner": {"reputation": 2262, "user_id": 4551565, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3177185a7dbdb6bc72aee5f5554e53a?s=128&d=identicon&r=PG&f=1", "display_name": "Pigna", "link": "https://stackoverflow.com/users/4551565/pigna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1557, "favorite_count": 0, "accepted_answer_id": 36424095, "answer_count": 1, "score": 7, "last_activity_date": 1459852873, "creation_date": 1459852810, "question_id": 36424064, "link": "https://stackoverflow.com/questions/36424064/haskell-where-is-data-numbers-primes-library", "title": "Haskell: where is Data.Numbers.Primes library?", "body": "<p>I tried importing Data.Numbers.Primes</p>\n\n<pre><code>import Data.Numbers.Primes\n</code></pre>\n\n<p>runhaskell gave me:</p>\n\n<pre><code>5.hs:1:8:\n    Could not find module `Data.Numbers.Primes'\n    Use -v to see a list of the files searched for.\n</code></pre>\n\n<p>ghci gave me:</p>\n\n<pre><code>&lt;no location info&gt;:\n    Could not find module `Data.Numbers.Primes'\n    It is not a module in the current program, or in any known package.\n</code></pre>\n\n<p>I tried to install Data.Numbers.Primes through cabal, but I got:</p>\n\n<pre><code>cabal update\n...\ncabal install Data\ncabal: There is no package named 'Data'.\nYou may need to run 'cabal update' to get the latest list of available\npackages.\ncabal install Data.Numbers.Primes\ncabal: The file does not exist 'Data.Numbers.Primes'.\n</code></pre>\n\n<p>help?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1459850629, "post_id": 36423095, "comment_id": 60460629, "body": "whatever you use - <code>Double</code> is usually no good idea if you are working with money and interest: <a href=\"https://stackoverflow.com/questions/3730019/why-not-use-double-or-float-to-represent-currency\">see this question</a>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1459850678, "post_id": 36423095, "comment_id": 60460675, "body": "I think <a href=\"https://hackage.haskell.org/package/Decimal\" rel=\"nofollow noreferrer\">Decimal</a> might be a good way to start"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1459851518, "post_id": 36423095, "comment_id": 60461288, "body": "Usually, it is sufficient to use an integral type, for example, store $19.99 as 1999, and convert to $19.99 for display purposes. This assumes you know ahead of time what the smallest unit of currency is. If you need to deal with arbitrary fractions of a unit, then something with fixed precision (like Decimal) is more appropriate. Under no circumstances should you use a floating-point type."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1459852829, "post_id": 36423095, "comment_id": 60462280, "body": "<code>Fractional</code> is a type class, not a type."}, {"owner": {"reputation": 653, "user_id": 2236092, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e95a9d73105658172c8932d5a920751?s=128&d=identicon&r=PG", "display_name": "schernichkin", "link": "https://stackoverflow.com/users/2236092/schernichkin"}, "edited": false, "score": 1, "creation_date": 1459854130, "post_id": 36423095, "comment_id": 60463221, "body": "It depends. All valuation, risk management and P&amp;L software I saw uses Doubles because lot of formulas contain transcendental operations which renders precise math useless. On other hand precise math makes sense for accounting. But I never seen accounting software which uses precise math, for some reason people stick to fixed-point math in such software."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1459857427, "post_id": 36423095, "comment_id": 60465639, "body": "Use <code>Integer</code> (or <code>Int</code>) to count the cents (or whatever the smallest denomination of your currency is.)"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459857540, "post_id": 36423095, "comment_id": 60465720, "body": "A quote from the Decimal library @Carsten was talking about &quot;While (/) is defined, you don&#39;t normally want to use it. Instead The functions &quot;divide&quot; and &quot;allocate&quot; will split a decimal amount into lists of results which are guaranteed to sum to the original number. <b>This is a useful property when doing financial arithmetic</b>&quot; (emphasis added)."}, {"owner": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "edited": false, "score": 0, "creation_date": 1459858677, "post_id": 36423095, "comment_id": 60466544, "body": "Has anyone used <a href=\"http://hackage.haskell.org/package/cyclotomic\" rel=\"nofollow noreferrer\">cyclotomic</a>?"}], "owner": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1459932588, "creation_date": 1459850377, "last_edit_date": 1459932588, "question_id": 36423095, "link": "https://stackoverflow.com/questions/36423095/best-type-to-represent-financial-amounts", "title": "Best Type To Represent Financial Amounts", "body": "<p>What is the best type to use to represent financial amounts in Haskell?</p>\n\n<p>I am doing some heavy calculations on the price of a financial product and would like to know which is the best type to use when there could potentially be thousands of arithmetic operations done on the price and a list of prices could be averaged.</p>\n\n<p>At the moment I am using <code>Double</code> but I don't think that may be the best choice. Others types I have come across are <code>RealFrac</code> <s>and <code>Fractional</code></s>.</p>\n\n<p><strong>Update</strong></p>\n\n<p>For the person that has marked this post to be closed, the link provided debates whether to use Double or Float. My post is concerned with discounting both these types in favour of a potentially better suited type to represent financial amounts and calculations using financial amounts. Moreover, as @Carsten indicates Double is not a good idea.</p>\n"}, {"tags": ["haskell", "coq", "non-deterministic"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1459871160, "post_id": 36422203, "comment_id": 60476466, "body": "You&#39;re probably looking for <a href=\"http://okmij.org/ftp/Haskell/extensible/more.pdf\" rel=\"nofollow noreferrer\"><code>Freer</code></a> monads and the <code>NDet</code> effect there. Everything is strictly positive and this representation even gives you non-determinism with <a href=\"http://okmij.org/ftp/papers/LogicT.pdf\" rel=\"nofollow noreferrer\">committed choice</a>. I <a href=\"https://github.com/effectfully/Eff/blob/master/Simple/Effect/NonDet.agda\" rel=\"nofollow noreferrer\">implemented</a> that in Agda, but the code is horrible due to the Agda&#39;s way of handling universe polymorphism."}, {"owner": {"reputation": 1238, "user_id": 458384, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/668e072f4deda51e0b1be0b493f67cb3?s=128&d=identicon&r=PG", "display_name": "ichistmeinname", "link": "https://stackoverflow.com/users/458384/ichistmeinname"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1459925441, "post_id": 36422203, "comment_id": 60500798, "body": "Committed choice (or call-time choice as the FLP community likes to call it) is exactly what I want to formalise with Coq! My current source is <a href=\"http://homes.soic.indiana.edu/ccshan/rational/lazy-nondet.pdf\" rel=\"nofollow noreferrer\">another paper</a> that is explicitly modelling a FLP-like semantics of non-determinism with monads. Since I&#39;m still trying to figure out which model would be best suited to be used in Coq, I&#39;m definitely going to look at the representation with Oleg&#39;s <code>Freer</code> monads -- as far as I remember, I have already read the paper (for a different context). So thanks for the reminder!"}], "answers": [{"comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1459853735, "post_id": 36424318, "comment_id": 60462954, "body": "Abel&#39;s work in that direction is implemented in <a href=\"http://www2.tcs.ifi.lmu.de/~abel/miniagda/\" rel=\"nofollow noreferrer\">MiniAgda</a>."}, {"owner": {"reputation": 1238, "user_id": 458384, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/668e072f4deda51e0b1be0b493f67cb3?s=128&d=identicon&r=PG", "display_name": "ichistmeinname", "link": "https://stackoverflow.com/users/458384/ichistmeinname"}, "edited": false, "score": 0, "creation_date": 1459865887, "post_id": 36424318, "comment_id": 60472310, "body": "Thanks for the quick answer; unfortunately, I forgot to write that I&#39;m still a beginner in Coq. Could you maybe elaborate a bit on the idea behind this encoding? And is it the right way to define values of type <code>List M A</code> with <code>existT</code>? This kind of construction is new for me and somehow googling didn&#39;t help."}], "tags": [], "owner": {"reputation": 2949, "user_id": 388716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cecc6baa259672022cc36c917d57d734?s=128&d=identicon&r=PG", "display_name": "jbapple", "link": "https://stackoverflow.com/users/388716/jbapple"}, "is_accepted": true, "score": 3, "last_activity_date": 1459853441, "creation_date": 1459853441, "answer_id": 36424318, "question_id": 36422203, "link": "https://stackoverflow.com/questions/36422203/data-structures-with-nondeterministic-components-in-coq/36424318#36424318", "title": "Data structures with nondeterministic components in Coq", "body": "<p>See <a href=\"http://adam.chlipala.net/cpdt/html/InductiveTypes.html\" rel=\"nofollow\">Chlipala's \"Certified Programming with Dependent Types\"</a>. If you had <code>Definition Id T := T -&gt; T</code>, then <code>List Id</code> could produce a non-terminating term. I think you might also be able to derive a contradiction by <code>Definition Not T := T -&gt; False</code>, especially if you drop the <code>Nil</code> constructor and accept the law of excluded middle.</p>\n\n<p>It would be nice if there were some way to annotate <code>M</code> as only using its argument in positive locations. I think Andreas Abel may have done some work in this direction.</p>\n\n<p>Anyway, if you're willing to restrict your datatypes just a little bit, you could use:</p>\n\n<pre><code>Fixpoint SizedList M A (n : nat) : Type :=\n  match n with\n    | 0 =&gt; unit\n    | S m =&gt; option (M A * M (SizedList M A m))\n  end.\n\nDefinition List M A := { n : nat &amp; SizedList M A n }.\n</code></pre>\n"}], "owner": {"reputation": 1238, "user_id": 458384, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/668e072f4deda51e0b1be0b493f67cb3?s=128&d=identicon&r=PG", "display_name": "ichistmeinname", "link": "https://stackoverflow.com/users/458384/ichistmeinname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 4, "accepted_answer_id": 36424318, "answer_count": 1, "score": 5, "last_activity_date": 1459853441, "creation_date": 1459848258, "question_id": 36422203, "link": "https://stackoverflow.com/questions/36422203/data-structures-with-nondeterministic-components-in-coq", "title": "Data structures with nondeterministic components in Coq", "body": "<p>I tried to model a less naive monadic encoding of non-determinism (less naive than MonadPlus and common lists) in Coq that is often used in Haskell; for example the encoding for lists looks like</p>\n\n<pre><code>data List m a = Nil | Cons (m a) (m (List m a))\n</code></pre>\n\n<p>whereas the corresponding definition in Coq would like as follows.</p>\n\n<pre><code>Inductive List (M: Type -&gt; Type) (A: Type) :=\n   Nil: List M A\n | Cons : M A -&gt; M (List M A) -&gt; List M A.\n</code></pre>\n\n<p>However, this kind of definition is not allowed in Coq because of the \"strictly positive\"-condition for inductive data types.</p>\n\n<p>I'm not sure if I am aiming for a Coq-specific answer or an alternative implementation in Haskell that I can formalise in Coq, but I am happy to read any suggestions on how to overcome this problem.</p>\n"}, {"tags": ["windows", "haskell", "dll", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1459847428, "post_id": 36421651, "comment_id": 60458254, "body": "can you please close/delete this question? Or restate it so it shows the actual problem? As it is it won&#39;t be of any use to future people searching for answers"}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459856932, "post_id": 36421651, "comment_id": 60465263, "body": "@Carsten I&#39;ll try to restate it so it serves some purpose. This information wasn&#39;t really in plain sight so maybe it will save someone some time in the future"}, {"owner": {"reputation": 2667, "user_id": 325725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3db095f94749aaedfea12b927b13cf74?s=128&d=identicon&r=PG", "display_name": "Phyx", "link": "https://stackoverflow.com/users/325725/phyx"}, "edited": false, "score": 0, "creation_date": 1464719248, "post_id": 36421651, "comment_id": 62594724, "body": "Just a note, this isn&#39;t the entire answer. GHCi (since 7.10.3) also searches the included mingw-w64 bindist folder and any and all extra-lib-dirs. a package specified in it&#39;s .cabal file."}], "tags": [], "owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "is_accepted": true, "score": 1, "last_activity_date": 1459857166, "last_edit_date": 1459857166, "creation_date": 1459846775, "answer_id": 36421651, "question_id": 36421376, "link": "https://stackoverflow.com/questions/36421376/where-does-ghci-search-for-dlls/36421651#36421651", "title": "Where does GHCi search for DLLs?", "body": "<p>I've found the answer here <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci-invocation.html\" rel=\"nofollow\">https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci-invocation.html</a></p>\n\n<p>Apparently GHCi searches the standard search path of the OS.</p>\n"}], "owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 36421651, "answer_count": 1, "score": 1, "last_activity_date": 1459857166, "creation_date": 1459846005, "last_edit_date": 1459857088, "question_id": 36421376, "link": "https://stackoverflow.com/questions/36421376/where-does-ghci-search-for-dlls", "title": "Where does GHCi search for DLLs?", "body": "<p>When I do <code>stack repl</code> it fails to find the DLLs for a library that my project uses. I can fix this by placing them in the root of my package but this is unsatisfactory since I'd like them to be separated from my package.</p>\n\n<p>Where does GHCi look for them?</p>\n"}, {"tags": ["windows", "haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": true, "score": 3, "last_activity_date": 1460108400, "last_edit_date": 1460108400, "creation_date": 1459843097, "answer_id": 36420363, "question_id": 36420315, "link": "https://stackoverflow.com/questions/36420315/ghc-fhpc-code-coverage-on-windows-10/36420363#36420363", "title": "GHC -fhpc code coverage on Windows 10", "body": "<p>Apparently, removing all <code>*.hi</code> and <code>*.o</code> files, forcing the compiler to recompile, worked. I really think the compiler should've noticed the flag, and that some files were missing. </p>\n\n<p><a href=\"https://ghc.haskell.org/trac/ghc/ticket/11798\" rel=\"nofollow\">https://ghc.haskell.org/trac/ghc/ticket/11798</a></p>\n"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 36420363, "answer_count": 1, "score": 1, "last_activity_date": 1460108400, "creation_date": 1459842949, "last_edit_date": 1459859262, "question_id": 36420315, "link": "https://stackoverflow.com/questions/36420315/ghc-fhpc-code-coverage-on-windows-10", "title": "GHC -fhpc code coverage on Windows 10", "body": "<p>I'm trying to check code coverage for my tasty unit tests. I found a way to do it <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/hpc.html\" rel=\"nofollow\">in the GHC docs user guide for hpc</a>. The problem is that <code>ghc -fhpc Myfile.hs</code> doesn't generate a <code>.hpc</code> subdirectory or any <code>.tix</code> file, as the documentation claims it to do. Subsequently, I cannot run <code>hpc report</code>.</p>\n\n<p>What am I missing? Does this not work on Windows?</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1459841850, "post_id": 36419844, "comment_id": 60454510, "body": "Try adding a <code>deriving Show</code> to the end of the <code>data</code> declaration. Then you can pull up GHCi, run <code>zip (Node (Leaf 1) (Leaf 2)) (Node (Leaf 3) (Leaf 4))</code>, and look at the output."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1459842679, "post_id": 36419844, "comment_id": 60455055, "body": "is it only me or is this <code>zip</code> a bit strange?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459842977, "post_id": 36419844, "comment_id": 60455258, "body": "wouldn&#39;t you expect that <code>zip (Node (Leaf &#39;a&#39;) (Leaf &#39;b&#39;)) (Node (Leaf 3) (Leaf 4))</code> works and produces <code>Node (Leaf (&#39;a&#39;,3)) (Leaf (&#39;b&#39;,4))</code>?"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1459843771, "post_id": 36419844, "comment_id": 60455751, "body": "I believe you should have <code>zip :: Tree a -&gt; Tree b -&gt; Tree (a,b)</code>. Try to add the type signature to your function and you&#39;ll see that it is incorrect. Your function has type <code>Tree a -&gt; Tree a -&gt; Tree (a,a)</code>.   You are probably following the same tutorial/course as <a href=\"http://stackoverflow.com/q/36398709/510937\">this question</a>."}, {"owner": {"reputation": 55, "user_id": 5578181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c76a4d1844d06fdf385c3c8091e32a4?s=128&d=identicon&r=PG&f=1", "display_name": "programnub", "link": "https://stackoverflow.com/users/5578181/programnub"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1459843983, "post_id": 36419844, "comment_id": 60455899, "body": "@haoformayor I tried doing that and yes it did work thank you. I got an output of           Node (Leaf (1,2)) (Leaf (3,4))"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1459844461, "post_id": 36419844, "comment_id": 60456173, "body": "@Bakuriu maybe we should mark this as an duplicate - this question is both better stated and has a great answer already"}], "owner": {"reputation": 55, "user_id": 5578181, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c76a4d1844d06fdf385c3c8091e32a4?s=128&d=identicon&r=PG&f=1", "display_name": "programnub", "link": "https://stackoverflow.com/users/5578181/programnub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "closed_date": 1459847451, "answer_count": 0, "score": 0, "last_activity_date": 1459843331, "creation_date": 1459841447, "last_edit_date": 1459843331, "question_id": 36419844, "link": "https://stackoverflow.com/questions/36419844/haskell-defining-trees-using-zip-zipwith", "closed_reason": "Duplicate", "title": "Haskell: Defining Trees using zip/zipWith", "body": "<p>I am really new with Haskell and I decided to play around with <code>Tree</code>s using the <code>zip</code> function. I was able to find this code from a website but I am not sure what input should I use. It would be really helpful if someone explained/help me with this.</p>\n\n<pre><code>data Tree a = Node (Tree a) (Tree a) | Leaf a\n\nzip (Leaf a) (Leaf b) = Leaf (a,b)\nzip (Leaf a) (Node l r) = Leaf (a,a)\nzip (Node l r) (Leaf b) = Leaf (b,b)\nzip (Node l1 r1) (Node l2 r2) = Node (zip l1 r1) (zip l2 r2)\n</code></pre>\n"}, {"tags": ["haskell", "monads", "fold", "parsec", "reader-monad"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1459834559, "post_id": 36417814, "comment_id": 60450699, "body": "I don&#39;t know and I don&#39;t have time to look in depth right now, but I&#39;m guessing you should look less at <code>foldl</code> and more at <code>traverse</code>."}], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 5, "last_activity_date": 1459841644, "last_edit_date": 1459841644, "creation_date": 1459840554, "answer_id": 36419563, "question_id": 36417814, "link": "https://stackoverflow.com/questions/36417814/recursively-walking-an-ast-using-foldl-and-the-reader-monad-without-boilerplate/36419563#36419563", "title": "Recursively walking an AST using foldl and the Reader monad without boilerplate", "body": "<h2>A lensy approach</h2>\n\n<p>A moment for generic programming to shine! This very problem, the problem of folding over a recursive datatype without boilerplate, is the motivation for the <a href=\"http://ndmitchell.com/downloads/slides-uniform_boilerplate_and_list_processing-30_sep_2007.pdf\" rel=\"nofollow\">uniplate/biplate library</a>. That design now lives on in its most modern form in <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-Plated.html\" rel=\"nofollow\"><code>Control.Lens.Plated</code></a> c/o the <code>lens</code> package. To take advantage of it:</p>\n\n<ul>\n<li><p>Turn on <code>DeriveDataTypeable</code> and add <code>deriving (Data)</code> to your <code>Node</code>, <code>ArgumentList</code>, <code>Argument</code>.</p></li>\n<li><p>Right away you're able to take advantage of <code>uniplate</code> from <code>Data.Data.Lens</code>. This is a traversal, an object that \u2013 when passed to the right lens helpers \u2013\u00a0will yield you all the values of type <code>Node</code> inside a given <code>Node</code>. Basically it runs one step of your recursive <code>walk</code> function.</p></li>\n<li><p>An example: </p>\n\n<pre><code>\u03bb&gt; Blockquote [BreakTag, Blockquote [BreakTag]] ^.. uniplate\n[BreakTag,Blockquote [BreakTag]]\n\u03bb&gt; Blockquote [BreakTag, Blockquote [BreakTag]] ^.. uniplate . uniplate\n[BreakTag]\n\u03bb&gt; Blockquote [BreakTag, Blockquote [BreakTag]] ^.. uniplate . uniplate . uniplate\n[]\n</code></pre></li>\n<li><p>But wait, there's more. If <code>uniplate</code> is one small step for generics, then <code>cosmosOf uniplate</code> is one large step for programmerkind. <code>cosmosOf</code> repeatedly uses <code>uniplate</code> to retrieve the children, grandchildren, greatgrandchildren, and so on from a given <code>Node</code>.</p>\n\n<pre><code>\u03bb&gt; Blockquote [BreakTag, Blockquote [BreakTag]] ^..  cosmosOf uniplate\n[ Blockquote [BreakTag,Blockquote [BreakTag]]\n, BreakTag\n, Blockquote [BreakTag]\n, BreakTag]\n</code></pre></li>\n<li><p>In both examples, we're taking advantage of how compositional <code>lens</code> traversals (and folds) are. The hierarchy of lens and why they compose so well is beyond the confines of this little textbox, but suffice it to say that they're super mega useful.</p></li>\n<li><p>Use the <code>foldlOf</code> helper in <code>Control.Lens.Fold</code> to implement your <code>walk</code> function:</p>\n\n<pre><code>walk' :: Monoid a =&gt; (Node -&gt; a) -&gt; a -&gt; Node -&gt; a\nwalk' f acc n =\n  foldlOf (cosmosOf uniplate . to f) (&lt;&gt;) acc n\n</code></pre>\n\n<p>Not so bad. <code>to f</code> creates a getter from your <code>f</code> and it's composed with the cosmic fold to reach all the descendants; each value from this getter is folded and accumulated into our monoid.</p></li>\n</ul>\n\n<p>As for <code>node</code>, you'll have to build a custom fold. <code>cosmosOf uniplate</code> doesn't work so well here because sometimes you short-circuit the recursion (e.g. in the <code>Blockquote</code> case). You'll have to write <code>cosmosOf foo</code> and build <code>foo</code> piecemeal out of <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-Fold.html#g:3\" rel=\"nofollow\">lens helpers</a>; note you can still use <code>uniplate</code> to discharge most of the cases in your custom fold. This is quite a large bit of code and it's getting awful late, so I'll leave it as an exercise to the reader. I'm 90% certain it's possible.</p>\n\n<p>As for the reader monad, you can either use <code>foldlMOf</code> or note that <code>type Env = Reader State String</code> is isomorphic to <code>State -&gt; String</code> and note that <code>State -&gt; String</code> has a <code>Monoid</code> instance because <code>Monoid String</code> exists. This all means that you should be able to implement <code>node</code> with the non-monadic <code>foldlOf</code>, like we did above \u2013 all we really want to do is concatenate a bunch of monoidal values, in the end.</p>\n\n<p>This solution isn't perfect: it requires future code readers to know a good bit of knowledge about lens and how traversals/folds/getters gel with <code>Data.Data</code> and why these functions all have funny little <code>Of</code> suffixes on them. But you must admit that there's a beautiful sort of conciseness and power to <code>Plated</code> that abstracts away the boring recursion part of folding over custom datatypes so you only have to pattern match on the leaves of the data structure (like <code>BreakTag</code> in <code>node</code>) and edge cases (like <code>Blockquote</code> in <code>node</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 3, "last_activity_date": 1459983269, "last_edit_date": 1495540354, "creation_date": 1459983269, "answer_id": 36463726, "question_id": 36417814, "link": "https://stackoverflow.com/questions/36417814/recursively-walking-an-ast-using-foldl-and-the-reader-monad-without-boilerplate/36463726#36463726", "title": "Recursively walking an AST using foldl and the Reader monad without boilerplate", "body": "<p>Your <code>walk</code> function looks very much like the <code>Foldable</code> class, which is the superclass of <code>Traversable</code> (which dfeuer also points out in a comment).  In your position I'd have a look at the <a href=\"https://www.stackage.org/package/mono-traversable\" rel=\"nofollow noreferrer\"><code>mono-traversable</code> package</a>.</p>\n\n<p>But I have a hunch that your <code>Node</code> type won't actually turn out to be a good <code>MonoTraversable</code> instance as currently formulated.  The reason, informally, is that there isn't a good separation between these concepts:</p>\n\n<ol>\n<li>The <em>structure</em> of the AST: which nodes are the children of which.</li>\n<li>The <em>content</em> of the AST: the \"attributes\" at each node.</li>\n</ol>\n\n<p>One very informal way to think of the <code>Functor</code> and <code>Traversable</code> classes is that they operate on the \"content\" of a value without altering is \"structure\" (but <a href=\"https://stackoverflow.com/questions/19177125/sets-functors-and-eq-confusion/19192745#19192745\">beware of taking that analogy too literally</a>).  I considered writing a <code>MonoTraversable</code> instance for your <code>Node</code> type but backed off quickly after some thought:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nimport Data.MonoTraversable\n\n-- Here is the root of the problem.  The type function \n-- `Element` is supposed to pick out which pieces of a \n-- `Node` are its \"content\" as opposed to its \"structure,\"\n-- but with `Node` as formulated there isn't a distinction!\ntype instance Element Node = Node\n</code></pre>\n\n<p>Given that, the <code>otraverse</code> method, which has this principal type:</p>\n\n<pre><code>otraverse :: Applicative f =&gt; (Element mono -&gt; f (Element mono)) -&gt; mono -&gt; f mono\n</code></pre>\n\n<p>...would end up with this specialized type when <code>mono := Node</code>:</p>\n\n<pre><code>otraverse :: Applicative f =&gt; (Node -&gt; f Node) -&gt; Node -&gt; f Node    \n</code></pre>\n\n<p>...and I'm worried that somebody could try to call <code>otraverse</code> with a function that discards the children of the root node, e.g., how evil is it when somebody attempts <code>otraverse (return Separator)</code>?  </p>\n\n<p>I haven't checked whether these instances are unlawful for sure, so I might be worried over nothing here, it's worth checking if I'm wrong.  But it certainly \"smells bad\" according to my design sense.</p>\n\n<hr>\n\n<p>So what to do?  I'd look into reformulating the <code>Node</code> type a little bit, splitting it into two types:</p>\n\n<ol>\n<li>A <code>Content</code> type that expresses the information that is visible at each step of the left-to-right walk of the AST, but not how the <code>Content</code>s nest;</li>\n<li>A <code>Structure</code> type that defines the possible shapes of the tree\u2014how the <code>Content</code>s nest.</li>\n</ol>\n\n<p>Once that is done, you'd be able to reformulate your <code>walk</code> function like this:</p>\n\n<pre><code>walk :: Monoid a =&gt; (Content -&gt; a) -&gt; a -&gt; Structure -&gt; a\n</code></pre>\n\n<p>Note that the second argument of this function (the initial <code>acc :: Monoid a =&gt; a</code> value) is superfluous, these two functions look interdefinable:</p>\n\n<pre><code>walk' :: Monoid a =&gt; (Content -&gt; a) -&gt; Structure -&gt; a\nwalk' f = walk f mempty\n\nwalk :: Monoid a =&gt; (Content -&gt; a) -&gt; a -&gt; Structure -&gt; a\nwalk f acc tree = acc &lt;&gt; walk' f tree\n</code></pre>\n\n<p>And my <code>walk'</code> signature then looks like it would be the <code>ofoldMap</code> method from <code>mono-traversable</code>:</p>\n\n<pre><code>ofoldMap :: Monoid m =&gt; (Element mono -&gt; m) -&gt; mono -&gt; m\n</code></pre>\n\n<p>Which then would make it natural to ask whether you can implement <code>MonoTraversable</code> for your reformulated type and get the <code>otraverse</code> operation whose signature I mentioned above, which specialized with <code>f := Reader r</code>, and <code>mono := Structure</code> and <code>Element mono := Content</code> would be:</p>\n\n<pre><code>otraverse :: (Content -&gt; Reader r Content) -&gt; Structure -&gt; Reader r Structure\n</code></pre>\n"}], "owner": {"reputation": 4387, "user_id": 2103996, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ef9ecd30591995af2cf62cde10b26e49?s=128&d=identicon&r=PG", "display_name": "wincent", "link": "https://stackoverflow.com/users/2103996/wincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 2, "accepted_answer_id": 36419563, "answer_count": 2, "score": 3, "last_activity_date": 1459983269, "creation_date": 1459834058, "last_edit_date": 1459840727, "question_id": 36417814, "link": "https://stackoverflow.com/questions/36417814/recursively-walking-an-ast-using-foldl-and-the-reader-monad-without-boilerplate", "title": "Recursively walking an AST using foldl and the Reader monad without boilerplate", "body": "<p>I'm traversing <a href=\"https://github.com/wincent/docvim/blob/47e40f0e4f64098bbb4bceccf74e88756ac7d2f6/lib/Docvim/AST.hs#L7-L59\" rel=\"nofollow\">an AST</a> using <a href=\"https://github.com/wincent/docvim/blob/47e40f0e4f64098bbb4bceccf74e88756ac7d2f6/lib/Docvim/Printer/Markdown.hs#L31-L57\" rel=\"nofollow\">simple pattern matching</a> and <a href=\"https://github.com/wincent/docvim/blob/47e40f0e4f64098bbb4bceccf74e88756ac7d2f6/lib/Docvim/Printer/Markdown.hs#L24-L26\" rel=\"nofollow\">the <code>Reader</code> monad</a>.</p>\n\n<p>Elsewhere in my project I've defined <a href=\"https://github.com/wincent/docvim/blob/47e40f0e4f64098bbb4bceccf74e88756ac7d2f6/lib/Docvim/AST.hs#L100-L111\" rel=\"nofollow\">a <code>walk</code> function</a> for traversing the AST, which at its heart uses <code>foldl</code> to reduce the results of visiting each node in the tree into a single monoidal result (for example, <a href=\"https://github.com/wincent/docvim/blob/47e40f0e4f64098bbb4bceccf74e88756ac7d2f6/lib/Docvim/Visitor/Symbol.hs#L11-L32\" rel=\"nofollow\">to produce a \"symbol table\"</a> from the special nodes in the tree).</p>\n\n<p>My question is: is it possible to combine these two approaches and use a function like my <code>walk</code> function:</p>\n\n<pre><code>walk :: Monoid a =&gt; (Node -&gt; a) -&gt; a -&gt; Node -&gt; a\nwalk f acc n = foldl (walk f) (acc &lt;&gt; f n) children\n  where\n    children = case n of\n      Blockquote b           -&gt; b\n      DocBlock d             -&gt; d\n      FunctionDeclaration {} -&gt; functionBody n\n      List l                 -&gt; l\n      ListItem i             -&gt; i\n      Paragraph p            -&gt; p\n      Unit u                 -&gt; u\n      _                      -&gt; [] -- no Node children\n</code></pre>\n\n<p>and the <code>Reader</code> \u2014\u00a0like the traversal in the code below (some bits omitted for brevity) \u2014 at the same time? </p>\n\n<pre><code>markdown :: Node -&gt; String\nmarkdown n = runReader (node n) state\n  where state = State (getSymbols n) (getPluginName n)\n\nnode :: Node -&gt; Env\nnode n = case n of\n  Blockquote b            -&gt; blockquote b &gt;&gt;= appendNewline &gt;&gt;= appendNewline\n  DocBlock d              -&gt; nodes d\n  FunctionDeclaration {}  -&gt; nodes $ functionBody n\n  Paragraph p             -&gt; nodes p &gt;&gt;= appendNewline &gt;&gt;= appendNewline\n  Link l                  -&gt; link l\n  List ls                 -&gt; nodes ls &gt;&gt;= appendNewline\n  ListItem l              -&gt; fmap (\"- \" ++) (nodes l) &gt;&gt;= appendNewline\n  Unit u                  -&gt; nodes u\n</code></pre>\n\n<p>My use motivation here is that my <code>walk</code> function already encodes the knowledge of how to do get the children for each pattern and how to perform an in-order traversal of the AST. I don't really want to reimplement that for every traversal, so it would be nice to use <code>walk</code> in more places, including ones where I need to use <code>Reader</code> (and likely later on, <code>State</code>, probably in a stack).</p>\n\n<p>Can these things be fruitfully combined?</p>\n"}, {"tags": ["parsing", "haskell"], "comments": [{"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 2, "creation_date": 1459818610, "post_id": 36415302, "comment_id": 60446354, "body": "Strings are lists, so use the list functions in prelude, such as <code>takeWhile</code>  to tackle the problem one step at a time, then combine the steps until you get the solution. Or, you look into Parsec."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1459825372, "creation_date": 1459825372, "answer_id": 36416395, "question_id": 36415302, "link": "https://stackoverflow.com/questions/36415302/haskell-parsing-specific-patterns-from-a-string/36416395#36416395", "title": "Haskell - Parsing specific patterns from a string", "body": "<p>There are many ways to skin this cat. Here's a hint for a particularly quick and dirty way:</p>\n\n<pre><code>Text.Regex.TDFA&gt; let s = \"/show\\\\ hellow how are /dont\\\\ you /;dont\\\\ doing /;show\\\\\"\nText.Regex.TDFA&gt; s =~ \"/[^/\\\\]*\\\\\\\\\" :: [[String]]\n[[\"/show\\\\\"],[\"/dont\\\\\"],[\"/;dont\\\\\"],[\"/;show\\\\\"]]\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5927617, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/415b65efd5744b4b4395b69ea79d2c87?s=128&d=identicon&r=PG&f=1", "display_name": "Minmater", "link": "https://stackoverflow.com/users/5927617/minmater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1459881401, "creation_date": 1459817378, "question_id": 36415302, "link": "https://stackoverflow.com/questions/36415302/haskell-parsing-specific-patterns-from-a-string", "title": "Haskell - Parsing specific patterns from a string", "body": "<p>I'm trying to solve a problem to do with parsing patterns from a string in Haskell.</p>\n\n<p>Given the following string:</p>\n\n<pre><code>s = \"/show\\ hello how are /dont\\ you /;dont\\ doing /;show\\\"\n</code></pre>\n\n<p>The program would read until finding '/' then hold content found until finding '\\'. The content will be compared against a list of approved words which I have already sorted.</p>\n\n<p>The issue I'm having is actually parsing the content from the string and holding on to it to perform the required checks.</p>\n\n<p>How would I go about doing this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1459815769, "post_id": 36414373, "comment_id": 60445569, "body": "<code>let x = 2</code> isn&#39;t an expression (or at least, it&#39;s not an expression that affects any other expression). Are you looking to add an assignment <i>statement</i> to your language?"}, {"owner": {"reputation": 13, "user_id": 4015595, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qOA1o.jpg?s=128&g=1", "display_name": "Mandy", "link": "https://stackoverflow.com/users/4015595/mandy"}, "edited": false, "score": 0, "creation_date": 1459815962, "post_id": 36414373, "comment_id": 60445618, "body": "Sorry I was confused chepner, the second part of the question gives a context to what is required hopefully now."}], "answers": [{"comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1459895145, "post_id": 36415187, "comment_id": 60491105, "body": "Now <code>sub &quot;e&quot; (C 2) $ Let [(&quot;e&quot;, C 3), (&quot;f&quot;, V &quot;e&quot;)] $ V &quot;f&quot;</code> evaluates to <code>Let [(&quot;e&quot;,C 3.0),(&quot;f&quot;,C 2.0)] (V &quot;f&quot;)</code> rather than <code>Let [(&quot;e&quot;, C 3), (&quot;f&quot;, V &quot;e&quot;)] $ V &quot;f&quot;</code> which is what I&#39;d expect from an Haskell-style let-binding. Then again OP&#39;s question was about binding a <i>single</i> variable at a time which would not suffer from this problem. I suppose, your smart multi-let could be defined as a combinator by a simple <code>foldr</code> rather than a constructor."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1459895278, "post_id": 36415187, "comment_id": 60491148, "body": "@gallis Earlier revisions of the question specified no &quot;recursive&quot; bindings, and I believe this is what it meant."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1459895405, "post_id": 36415187, "comment_id": 60491196, "body": "I&#39;m not talking about recursive bindings, but shadowing. Which leads me to notice that the current setup suffers from variable capture: <code>sub &quot;e&quot; (V &quot;f&quot;) $ Let [(&quot;f&quot;, C 2)] $ V &quot;e&quot;</code> evaluates to <code>Let [(&quot;f&quot;,C 2.0)] (V &quot;f&quot;)</code>. Ouch. Personally, I always get binding wrong so I tend to try to get the typechecker on my side to prevent all of these issues."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1459895532, "post_id": 36415187, "comment_id": 60491242, "body": "Crap, yeah, this is more complicated than I first thought. Good learning exercise :)"}], "tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 0, "last_activity_date": 1459892762, "last_edit_date": 1459892762, "creation_date": 1459816510, "answer_id": 36415187, "question_id": 36414373, "link": "https://stackoverflow.com/questions/36414373/data-type-for-arithmetic-expressions-with-let-bindings-in-haskell/36415187#36415187", "title": "Data type for arithmetic expressions with let bindings in haskell", "body": "<p>Here's a variant of the original <code>Expr</code> type that adds variables (<code>V</code>) and let bindings (<code>Let</code>).</p>\n\n<pre><code>data Expr = C Float | V String\n          | Let [(String, Expr)] Expr\n          | Expr :+ Expr | Expr :- Expr\n          | Expr :* Expr | Expr :/ Expr\n</code></pre>\n\n<p>To help write <code>evaluate</code>, you may want to start with a function that does variable substitution:</p>\n\n<pre><code>data Expr = C Float | V String\n          | Let [(String, Expr)] Expr\n          | Expr :+ Expr | Expr :- Expr\n          | Expr :* Expr | Expr :/ Expr\n            deriving Show\n\n-- | @sub var value e@ replaces variables named @var@ with the value @value@\n-- wherever anywhere that variable occurs in expression @e@.\nsub :: String -&gt; Expr -&gt; Expr -&gt; Expr\n\n-- \"let x = y in x\" = y\nsub v1 value (V v2) | v1 == v2 = value\n\n-- \"let x = y in z\" = z\nsub _ _ e@(V _) = e\n\n-- Constants are unaffected\nsub _ _ c@(C _) = c\n\n-- For operators, apply @sub a b@ recursively to the operands.\nsub a b (e1 :+ e2) = (sub a b e1) :+ (sub a b e2)\nsub a b (e1 :- e2) = (sub a b e1) :- (sub a b e2)\nsub a b (e1 :* e2) = (sub a b e1) :* (sub a b e2)\nsub a b (e1 :/ e2) = (sub a b e1) :/ (sub a b e2)\n\n-- The variable is shadowed by a let binding, so only substitute\n-- into the bindings, and leave the body expression unmodified.\nsub a b (Let bindings e) | bindingsContains a bindings =\n    Let (subIntoBindings a b bindings) e\n\n-- Apply @sub a b@ recursively to the body of the let expression.\nsub a b (Let bindings body) =\n    Let (subIntoBindings a b bindings) (sub a b body)\n\nbindingsContains :: String -&gt; [(String, Expr)] -&gt; Bool\nbindingsContains x bindings =\n    Data.Maybe.isJust $ Data.List.find ((== x) . fst) bindings\n\nsubIntoBindings :: String -&gt; Expr -&gt; [(a, Expr)] -&gt; [(a, Expr)]\nsubIntoBindings a b bindings = (fmap . fmap) (sub a b) bindings\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4015595, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qOA1o.jpg?s=128&g=1", "display_name": "Mandy", "link": "https://stackoverflow.com/users/4015595/mandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 1, "accepted_answer_id": 36415187, "answer_count": 1, "score": 0, "last_activity_date": 1459985919, "creation_date": 1459810816, "last_edit_date": 1459985919, "question_id": 36414373, "link": "https://stackoverflow.com/questions/36414373/data-type-for-arithmetic-expressions-with-let-bindings-in-haskell", "title": "Data type for arithmetic expressions with let bindings in haskell", "body": "<p>Data type for arithmetic expressions with let bindings in haskell</p>\n"}, {"tags": ["function", "haskell", "types", "operation"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 3, "creation_date": 1459807880, "post_id": 36413610, "comment_id": 60443153, "body": "on a side note - your <code>Either Bool a</code> is never using <code>Left True</code> therefore this is equivalent to using a <code>Maybe a</code>, if your choice is an <code>Either</code> I&#39;d recommend using <code>Either String</code> and using the <code>Left</code> for <code>Left &quot;nice descriptive error message&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "edited": false, "score": 2, "creation_date": 1459808182, "post_id": 36413756, "comment_id": 60443268, "body": "@MercedesCabreraTorres: you should <i>understand</i> how it&#39;s done step by step, but that&#39;s not how you&#39;d do it in a large-scale project. When have a nesting of not two but, say, <i>eight</i> possibly-failing computations, then giving each one its own <code>case</code> would be very awkward indeed. Fortunately, the monad instance takes this burden from us!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1459807626, "creation_date": 1459807626, "answer_id": 36413756, "question_id": 36413610, "link": "https://stackoverflow.com/questions/36413610/haskell-create-new-operator-and-control-error/36413756#36413756", "title": "haskell create new operator, and control error", "body": "<p>I don't know what <code>Taulell</code> is, let's guess <code>Taulell = [[a]]</code> for some <code>a</code>.</p>\n\n<p>We have</p>\n\n<pre><code>t :: [[a]]  -- Taulell\nu :: Int\nd :: Int\n</code></pre>\n\n<p>hence</p>\n\n<pre><code>t !!! u :: Either Bool [a]\n</code></pre>\n\n<p>Then we write</p>\n\n<pre><code>(t !!! u) !!! d\n</code></pre>\n\n<p>but here the leftmost argument is not a list, it's an <code>Either Bool [a]</code>. Hence a type error arises.</p>\n\n<p>Instead, we could try, e.g.</p>\n\n<pre><code>case t !!! u of\n   Left b -&gt; ...\n   Right l -&gt; case l !!! d of\n                 Left c  -&gt; ...\n                 Rigth w -&gt; ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "edited": false, "score": 0, "creation_date": 1459808415, "post_id": 36413779, "comment_id": 60443355, "body": "then &gt;&gt; = is the equivalent of   Left b -&gt; ...  Right l -&gt; case l !!! d of .... no? thank&#39;s"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "edited": false, "score": 0, "creation_date": 1459808614, "post_id": 36413779, "comment_id": 60443423, "body": "Yes, in this case it is equivalent. But the monadic bind is far more general, it also works for types completely unlike <code>Either</code>!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1459808674, "last_edit_date": 1495541750, "creation_date": 1459807769, "answer_id": 36413779, "question_id": 36413610, "link": "https://stackoverflow.com/questions/36413610/haskell-create-new-operator-and-control-error/36413779#36413779", "title": "haskell create new operator, and control error", "body": "<p><code>!!!</code> needs a list as its left argument, but for a nested list it does not give a simple list as the result. It gives an <code>Either Bool [a]</code> as the result.</p>\n\n<p>You can't use that again as the argument to <code>!!!</code>, but you can easily enough <em>apply</em> <code>!!!</code> to the <code>Either</code>-contained list:</p>\n\n<pre><code>esTerra:: Taulell -&gt; (Int,Int) -&gt; Bool\nesTerra t (u,d) = \n    case t!!!u &gt;&gt;= (!!!d) of\n        Left e -&gt; False\n        Right p -&gt; True\n</code></pre>\n\n<p>Here, I've used the monadic bind operator <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad-Instances.html#v:-62--62--61-\" rel=\"nofollow noreferrer\"><code>&gt;&gt;=</code></a> to combine two possibly-failing lookups into one, which will succeed only if <em>both</em> lookups do. This is equivalent to <em>twice</em> explicitly unwrapping the <code>Either</code> structure with a <code>case</code> construct, <a href=\"https://stackoverflow.com/a/36413756/745903\">as shown by chi</a>.</p>\n"}], "owner": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 36413756, "answer_count": 2, "score": 0, "last_activity_date": 1459808674, "creation_date": 1459806973, "question_id": 36413610, "link": "https://stackoverflow.com/questions/36413610/haskell-create-new-operator-and-control-error", "title": "haskell create new operator, and control error", "body": "<p>I have the following structure:</p>\n\n<p>Terra [['0','1','0','1'],['0','1','0','1'],['1','0','G','1']]</p>\n\n<p>and de function:</p>\n\n<pre><code>esTerra:: Taulell -&gt; (Int,Int) -&gt; Bool\nesTerra t (u,d) = \n    case t!!!u!!!d of\n        Left e -&gt; False\n        Right p -&gt; True\n\n\n(!!!) :: [a] -&gt; Int -&gt; Either Bool a \nxs !!! n | n &lt; 0 = Left False   -- error Exception: Prelude.!!:...\n[] !!! _ = Left False           -- error Exception: Prelude.!!:...\n(x:_) !!! 0 = Right x\n(_:xs) !!! n = xs!!!(n-1)\n</code></pre>\n\n<p>the function !!! is equal the operation !! but when you have to return an error message returns False</p>\n\n<p>but return error:</p>\n\n<pre><code>Couldn't match expected type \u2018[a0]\u2019\n            with actual type \u2018Either Bool [Char]\u2019\nIn the first argument of \u2018(!!!)\u2019, namely \u2018t !!! u\u2019\nIn the expression: t !!! u !!! d\nIn the expression:\n  case t !!! u !!! d of {\n    Left e -&gt; False\n    Right p -&gt; True }\n</code></pre>\n\n<p>Because?</p>\n\n<p>Thank's</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1459801504, "post_id": 36412011, "comment_id": 60441947, "body": "1. You cannot &quot;intersect two lists&quot;. You can intersect sets. Your code mentions &quot;union&quot;, not &quot;intersect&quot;. You can use lists to represent sets. But you should not, most of the time. 2. &quot;code does not work&quot; - be more specific. Syntax error? Type error? Semantics error (you get a result, but it is wrong)? In the latter case, also include the specification (that says what is right)."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1459853176, "post_id": 36412011, "comment_id": 60462498, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/6050306/foldl-foldr-query\">foldl / foldr query</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1459813860, "post_id": 36412083, "comment_id": 60445041, "body": "This is done so make it more apparent what order the operator is applied in."}], "tags": [], "owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "is_accepted": true, "score": 6, "last_activity_date": 1459801942, "last_edit_date": 1459801942, "creation_date": 1459800915, "answer_id": 36412083, "question_id": 36412011, "link": "https://stackoverflow.com/questions/36412011/haskell-foldr-and-foldl/36412083#36412083", "title": "Haskell foldr and foldl", "body": "<p><code>foldr</code> has the type</p>\n\n<pre><code>(a -&gt; b -&gt; b) -&gt; [a] -&gt; b -&gt; b\n</code></pre>\n\n<p>while <code>foldl</code> has the type </p>\n\n<pre><code>(b -&gt; a -&gt; b) -&gt; [a] -&gt; b -&gt; b \n</code></pre>\n\n<p>Note the order of the two parameters. </p>\n\n<pre><code>(\\x acc -&gt; ...\n</code></pre>\n\n<p>would fix the error.</p>\n"}], "owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 36412083, "answer_count": 1, "score": 1, "last_activity_date": 1459801942, "creation_date": 1459800698, "question_id": 36412011, "link": "https://stackoverflow.com/questions/36412011/haskell-foldr-and-foldl", "title": "Haskell foldr and foldl", "body": "<p>The code below is used to generate the intersection of two lists:</p>\n\n<pre><code>unionSet :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\nunionSet a b = foldl (\\acc x -&gt; if elem x acc then acc else acc ++ [x]) a b\n</code></pre>\n\n<p>Why does the <code>foldl</code> function work but when I use <code>foldr</code> it generates errors?</p>\n"}, {"tags": ["haskell", "lambda", "compiler-construction", "interpreter", "lambda-calculus"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1459801342, "post_id": 36411895, "comment_id": 60440068, "body": "Normally, names generated from thin air are pretty much useless. Typically, it&#39;s much more useful to try to transform user-provided names when necessary and as little as possible. Have you seen the <code>bound</code> package? It&#39;s a bit intense, but has a very good reputation."}, {"owner": {"reputation": 49501, "user_id": 784338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae195ac7c8a5e9002a808544572cc5fc?s=128&d=identicon&r=PG", "display_name": "Daniel Gratzer", "link": "https://stackoverflow.com/users/784338/daniel-gratzer"}, "edited": false, "score": 2, "creation_date": 1459801998, "post_id": 36411895, "comment_id": 60440396, "body": "I think the <code>bound</code> package combined with my <code>bound-gen</code> library has everything that you want."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1459813985, "post_id": 36411895, "comment_id": 60445081, "body": "One interesting thing to look at is <a href=\"https://en.wikipedia.org/wiki/De_Bruijn_index\" rel=\"nofollow noreferrer\">De Bruijn indices</a>."}], "owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1459800290, "creation_date": 1459800290, "question_id": 36411895, "link": "https://stackoverflow.com/questions/36411895/generating-fresh-names-for-nameless-lambda-terms", "title": "Generating fresh names for nameless lambda terms", "body": "<p>Is there some common technique or library for generating fresh names when converting nameless lambda terms to named ones?</p>\n\n<p>This is what I came up with (the minimal example is based on the representation from <a href=\"https://www.schoolofhaskell.com/user/edwardk/bound\" rel=\"nofollow\">school of haskell</a>):</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n\nmodule Main where\n\nimport Control.Monad.Reader\nimport Data.List ((\\\\))\n\n-- named terms -----------------------------------------------------------------\n\ninfixl 9 :@\ninfixr 0 :!\n\ndata Lambda a =\n      Var a\n    | (Lambda a) :@ (Lambda a)\n    | a :! (Lambda a)\n    deriving Show\n\n-- nameless terms --------------------------------------------------------------\n\nnewtype Scope a = Scope (Exp a)\n    deriving (Eq, Show, Read)\n\ninfixl 9 :$\n\ndata Exp a =\n      F a\n    | B !Int\n    | (Exp a) :$ (Exp a)\n    | L (Scope a)\n    deriving (Eq, Show)\n\nabstract :: Eq a =&gt; a -&gt; Exp a -&gt; Scope a\nabstract name expr = Scope $ absName 0 expr where\n    absName distance (F name') | name == name' = B distance\n                               | otherwise        = F name'\n    absName distance (B index) = B index\n    absName distance (fun :$ arg) = absName distance fun :$ absName distance arg\n    absName distance (L (Scope body)) = L $ Scope $ absName (succ distance) body\n\ninstantiate :: Exp a -&gt; Scope a -&gt; Exp a \ninstantiate ersatz (Scope body) = replace 0 body where\n    replace distance (B index) | index == distance = ersatz\n                               | otherwise         = B index\n    replace distance (F name) = F name\n    replace distance (fun :$ arg) = replace distance fun :$ replace distance arg\n    replace distance (L (Scope body)) = L $ Scope $ replace (succ distance) body\n\n-- unnaming and naming ---------------------------------------------------------\n\nunname :: Eq a =&gt; Lambda a -&gt; Exp a\nunname (Var a) = F a\nunname (fun :@ arg) = unname fun :$ unname arg\nunname (n :! body) = L (abstract n (unname body))\n\nname :: (Eq a, Generator a) =&gt; Exp a -&gt; Lambda a\nname exp = runReader (nm exp) []\n\nnm :: (Eq a, Generator a) =&gt; Exp a -&gt; Reader [a] (Lambda a)\nnm (F a) = return $ Var a\nnm (fun :$ arg) = (:@) &lt;$&gt; nm fun &lt;*&gt; nm arg\nnm (L scope) = do\n    used &lt;- ask\n    let fresh = generate used\n    undefined\n    local (fresh:) ((fresh :!) &lt;$&gt; nm (instantiate (F fresh) scope))\n\ntype Gen a = [a]\n\nclass Eq a =&gt; Generator a where\n    generator :: Gen a\n    generate :: [a] -&gt; a\n    generate used = head (generator \\\\ used)\n\ninstance Generator [Char] where\n    generator = [ [i] | i &lt;- ['a'..'z']] ++ [i: show j | j &lt;- [1..], i &lt;- ['a'..'z']]\n\n-- test data -------------------------------------------------------------------\n\ns = \"f\" :! \"g\" :! \"x\" :! (Var \"f\" :@ Var \"x\") :@ (Var \"g\" :@ Var \"x\")\nk = \"x\" :! \"y\" :! Var \"x\"\ni = \"x\" :! Var \"x\"\n</code></pre>\n\n<p>While this works I think the whole <code>name</code>, <code>nm</code>, <code>generator</code> construction is not very elegant and I'm pretty sure it does not scale very well. Is there a common technique or library that is used in cases like this?</p>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["haskell", "monads", "maybe"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1459802951, "post_id": 36411049, "comment_id": 60440889, "body": "By switching from <code>Maybe</code> to <code>First</code>, you can just use <code>fold</code>."}, {"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "edited": false, "score": 0, "creation_date": 1504078955, "post_id": 36411049, "comment_id": 78867177, "body": "Seems to need <code>firstJust xs = asum xs &lt;|&gt; Nothing</code> to handle empty lists."}, {"owner": {"reputation": 12530, "user_id": 381619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8f67f35200cf319e30329dddd412b6d?s=128&d=identicon&r=PG", "display_name": "Neil Mayhew", "link": "https://stackoverflow.com/users/381619/neil-mayhew"}, "reply_to_user": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "edited": false, "score": 1, "creation_date": 1509393880, "post_id": 36411049, "comment_id": 80993657, "body": "@StevenShaw <code>asum ([] :: [Maybe Int])</code> is <code>Nothing</code> so no problem with empty lists."}, {"owner": {"reputation": 12530, "user_id": 381619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8f67f35200cf319e30329dddd412b6d?s=128&d=identicon&r=PG", "display_name": "Neil Mayhew", "link": "https://stackoverflow.com/users/381619/neil-mayhew"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509394003, "post_id": 36411049, "comment_id": 80993724, "body": "@dfeuer This has the advantage that you could use <code>Last</code> with the same approach."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 20, "last_activity_date": 1459798677, "last_edit_date": 1459798677, "creation_date": 1459797424, "answer_id": 36411049, "question_id": 36410971, "link": "https://stackoverflow.com/questions/36410971/extracting-the-first-just-value-from-maybe-a/36411049#36411049", "title": "Extracting the first Just value from [Maybe a]", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:msum\"><strong><code>msum</code></strong></a> from <code>Control.Monad</code>:</p>\n\n<pre><code>\\&gt; msum [Nothing, Just 1, Nothing, Just 2]\nJust 1\n</code></pre>\n\n<p>or <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Foldable.html#v:asum\"><strong><code>asum</code></strong></a> from <code>Data.Foldable</code>:</p>\n\n<pre><code>\\&gt; asum [Nothing, Just 1, Nothing, Just 2]\nJust 1\n</code></pre>\n\n<p>Both are documented as:</p>\n\n<blockquote>\n  <p>The sum of a collection of actions, generalizing <code>concat</code>.</p>\n</blockquote>\n\n<p>with signature:</p>\n\n<pre><code>msum :: (Foldable t, MonadPlus m) =&gt; t (m a) -&gt; m a\nasum :: (Foldable t, Alternative f) =&gt; t (f a) -&gt; f a\n</code></pre>\n\n<p>and behave as above due to <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/src/GHC.Base.html#line-685\"><code>Maybe</code> instance of <code>Alternative</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "is_accepted": false, "score": 3, "last_activity_date": 1459848424, "creation_date": 1459848424, "answer_id": 36422271, "question_id": 36410971, "link": "https://stackoverflow.com/questions/36410971/extracting-the-first-just-value-from-maybe-a/36422271#36422271", "title": "Extracting the first Just value from [Maybe a]", "body": "<pre><code>import Data.Foldable (find)\nimport Data.Maybe (isJust)\nimport Control.Monad (join)\n\nfirstJust = join . find isJust\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>&gt; firstJust [Nothing, Just 1, Nothing, Just 2]\nJust 1\n\n&gt; firstJust [Nothing, Nothing]\nNothing\n</code></pre>\n"}], "owner": {"reputation": 9113, "user_id": 2097780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db5b03704c129196a4e9415e55413ce6?s=128&d=identicon&r=PG", "display_name": "kirbyfan64sos", "link": "https://stackoverflow.com/users/2097780/kirbyfan64sos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2346, "favorite_count": 1, "accepted_answer_id": 36411049, "answer_count": 2, "score": 8, "last_activity_date": 1459848424, "creation_date": 1459797186, "last_edit_date": 1459802229, "question_id": 36410971, "link": "https://stackoverflow.com/questions/36410971/extracting-the-first-just-value-from-maybe-a", "title": "Extracting the first Just value from [Maybe a]", "body": "<p>Say I have a list like:</p>\n\n<pre><code>[Nothing, Just 1, Nothing, Just 2]\n</code></pre>\n\n<p>I want to get the first <code>Just</code> (non-error) value; in this case, it's <code>Just 1</code>. The only thing I can think of is:</p>\n\n<pre><code>firstJust xs = case filter isJust xs of\n                 []     -&gt; Nothing\n                 Just x -&gt; Just x\n</code></pre>\n\n<p>Is there a better/monad-generic way to do this?</p>\n"}, {"tags": ["haskell", "red-black-tree", "recursive-datastructures"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1459795147, "post_id": 36410304, "comment_id": 60436539, "body": "Sadly, you can&#39;t name two fields of two different types in the same way. Try naming them <code>blackValue,..,blackRightChild</code> and similarly for the red counterparts."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459795474, "post_id": 36410304, "comment_id": 60436715, "body": "@chi May the chi be with you! That worked! I&#39;m amazed that Haskell has this restriction - would never have guessed. Would you perhaps write that as an answer? I&#39;ve spent several hours playing around with this and searching all over the internet - maybe it will help someone else."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1459795476, "post_id": 36410304, "comment_id": 60436718, "body": "While you certainly can enforce the &quot;no red node with a red child&quot; invariant, it turns out that enforcing the full complement of red-black tree invariants without breaking performance is really hard. After you&#39;ve skimmed papers about it, I suspect you&#39;ll come to the same conclusion I did--you&#39;re generally better off biting the bullet and using 2-3-4 trees instead."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1459795548, "post_id": 36410304, "comment_id": 60436754, "body": "There&#39;s actually a new GHC feature that lifts this restriction in the upcoming 8.0 release."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1459795622, "post_id": 36410304, "comment_id": 60436805, "body": "@dfeuer Thanks for your comment. If you&#39;d care to share the links, I&#39;d appreciate it. Is it at all possible to enforce everything? I&#39;m at loss how to enforce the basic search-tree invariant (namely that the left subtree&#39;s keys are \\leq, and the right&#39;s are \\geq)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1459795813, "post_id": 36410304, "comment_id": 60436913, "body": "@AmiTavory, in Haskell, it will be very hard to enforce the order invariants, inefficiently, and for natural-number keys. I was actually referring only to the full shape invariants. A fully dependently typed language would make enforcing the order invariants easier and more useful."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1459805398, "post_id": 36410304, "comment_id": 60442083, "body": "I don&#39;t happen to have links on hand. I last looked at the articles several years ago. I seem to remember there being a couple of them. In each case, the authors started out talking big, but ended up having to perform some horribly expensive operation that couldn&#39;t be amortized properly in a persistent context."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1459851762, "post_id": 36410304, "comment_id": 60461486, "body": "Btw, you may be interested in <a href=\"https://www.youtube.com/watch?v=rhWMhTjQzsU\" rel=\"nofollow noreferrer\">Stephanie Weirich&#39;s talk</a> where she does just that."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1459854900, "post_id": 36410304, "comment_id": 60463736, "body": "@gallais Many thanks for the link!"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1459867600, "post_id": 36410304, "comment_id": 60473724, "body": "There has been a simple implementation in the ghc testsuite for years fwiw <a href=\"https://github.com/ghc/ghc/blob/master/testsuite/tests/polykinds/RedBlack.hs\" rel=\"nofollow noreferrer\">github.com/ghc/ghc/blob/master/testsuite/tests/polykinds/&hellip;</a> I&#39;m not sure it gets all the desired invariants, and it&#39;s probably slow..."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1459875150, "post_id": 36410304, "comment_id": 60479284, "body": "Thanks for the link, @Michael"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1459796057, "last_edit_date": 1459796057, "creation_date": 1459795876, "answer_id": 36410563, "question_id": 36410304, "link": "https://stackoverflow.com/questions/36410304/structurally-enforcing-no-red-children-of-red-node/36410563#36410563", "title": "Structurally Enforcing No Red Children Of Red Node", "body": "<p>Different record types must have distinct field names. E.g., this is not allowed:</p>\n\n<pre><code>data A = A { field :: Int }\ndata B = B { field :: Char }\n</code></pre>\n\n<p>while this is OK:</p>\n\n<pre><code>data A = A { aField :: Int }\ndata B = B { bField :: Char }\n</code></pre>\n\n<p>The former would attempt to define two projections</p>\n\n<pre><code>field :: A -&gt; Int\nfield :: B -&gt; Char\n</code></pre>\n\n<p>but, alas, we can't have a name with two types. (At least, not so easily...)\nThis issue is not present in OOP languages, where field names can never be used on their own, but they must be immediately applied to some object, as in <code>object.field</code> -- which is unambiguous, provided we already know the type of <code>object</code>. Haskell allows standalone projections, making things more complicated here.</p>\n\n<p>The latter approach instead defines</p>\n\n<pre><code>aField :: A -&gt; Int\nbField :: B -&gt; Char\n</code></pre>\n\n<p>and avoids the issue.</p>\n\n<p>As @dfeuer comments above, GHC 8.0 will likely relax this constraint.</p>\n"}], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 36410563, "answer_count": 1, "score": 1, "last_activity_date": 1459796057, "creation_date": 1459795011, "question_id": 36410304, "link": "https://stackoverflow.com/questions/36410304/structurally-enforcing-no-red-children-of-red-node", "title": "Structurally Enforcing No Red Children Of Red Node", "body": "<p>While studying <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">Learn You A Haskell For Great Good</a> and <a href=\"https://rads.stackoverflow.com/amzn/click/com/0521663504\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Purely Functional Data Structures</a>, I thought to try to reimplement a <a href=\"https://en.wikipedia.org/wiki/Red%E2%80%93black_tree\" rel=\"nofollow noreferrer\">Red Black tree</a> while trying to structurally enforce another tree invariant.</p>\n\n<p>Paraphrasing Okasaki's code, his node looks something like this:</p>\n\n<pre><code>import Data.Maybe\n\ndata Color = Red | Black\n\ndata Node a = Node {\n    value :: a,\n    color :: Color,\n    leftChild :: Maybe (Node a),\n    rightChild :: Maybe (Node a)}\n</code></pre>\n\n<p>One of the properties of a red black tree is that <a href=\"https://en.wikipedia.org/wiki/Red%E2%80%93black_tree#Properties\" rel=\"nofollow noreferrer\">a red node cannot have a direct-child red node</a>, so I tried to encode this as the following:</p>\n\n<pre><code>import Data.Either\n\ndata BlackNode a = BlackNode {\n    value :: a,\n    leftChild :: Maybe (Either (BlackNode a) (RedNode a)),\n    rightChild :: Maybe (Either (BlackNode a) (RedNode a))}\ndata RedNode a = RedNode {\n    value :: a,\n    leftChild :: Maybe (BlackNode a),\n    rightChild :: Maybe (BlackNode a)}\n</code></pre>\n\n<p>This outputs the errors:</p>\n\n<pre><code>Multiple declarations of `rightChild'\nDeclared at: :4:5\n             :8:5\n\n\nMultiple declarations of `leftChild'\nDeclared at: :3:5\n             :7:5\n\n\nMultiple declarations of `value'\nDeclared at: :2:5\n             :6:5\n</code></pre>\n\n<p>I've tried several modifications of the previous code, but they all fail compilation. What is the correct way of doing this?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2963, "user_id": 1528246, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/f76f3e46a94eb011d85d14bf54425950?s=128&d=identicon&r=PG", "display_name": "rogergl", "link": "https://stackoverflow.com/users/1528246/rogergl"}, "edited": false, "score": 0, "creation_date": 1459834999, "post_id": 36412995, "comment_id": 60450869, "body": "This gives:  Not in scope: \u2018fromString\u2019"}, {"owner": {"reputation": 2963, "user_id": 1528246, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/f76f3e46a94eb011d85d14bf54425950?s=128&d=identicon&r=PG", "display_name": "rogergl", "link": "https://stackoverflow.com/users/1528246/rogergl"}, "edited": false, "score": 0, "creation_date": 1459874506, "post_id": 36412995, "comment_id": 60478839, "body": "And what does . fromString really do ?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 2963, "user_id": 1528246, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/f76f3e46a94eb011d85d14bf54425950?s=128&d=identicon&r=PG", "display_name": "rogergl", "link": "https://stackoverflow.com/users/1528246/rogergl"}, "edited": false, "score": 0, "creation_date": 1459879258, "post_id": 36412995, "comment_id": 60481860, "body": "formatting convert a string to a query. The dot is just compose the two functions"}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 1, "last_activity_date": 1459804540, "creation_date": 1459804540, "answer_id": 36412995, "question_id": 36409568, "link": "https://stackoverflow.com/questions/36409568/how-to-build-a-query-string-with-mysql-simpl/36412995#36412995", "title": "How to build a query string with mysql-simpl?", "body": "<p>Use fromString to transform a string to a query</p>\n\n<pre><code> SqlQuery_ . fromString $ \"describe\" ++ table\n</code></pre>\n\n<p>( not tested, I am answering from my phone)</p>\n"}], "owner": {"reputation": 2963, "user_id": 1528246, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/f76f3e46a94eb011d85d14bf54425950?s=128&d=identicon&r=PG", "display_name": "rogergl", "link": "https://stackoverflow.com/users/1528246/rogergl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459804540, "creation_date": 1459792500, "question_id": 36409568, "link": "https://stackoverflow.com/questions/36409568/how-to-build-a-query-string-with-mysql-simpl", "title": "How to build a query string with mysql-simpl?", "body": "<p>I know that the Query type exists to make code injection difficult. But I need to call \"describe tablename\" and substitute the table name with the table I want to describe.</p>\n\n<p>Since I'm fairly new to Haskell I have no idea how to accomplish this.</p>\n\n<p>So far the code looks like this:</p>\n\n<pre><code>describe :: String -&gt; SqlQuery [FieldInfo]\ndescribe table = sqlQuery_ \"describe \" ++ table\n</code></pre>\n\n<p>But that results in</p>\n\n<pre><code>Couldn't match expected type \u2018[Char]\u2019\n</code></pre>\n"}, {"tags": ["haskell", "join", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "is_accepted": true, "score": 0, "last_activity_date": 1460119946, "creation_date": 1460119946, "answer_id": 36500043, "question_id": 36409550, "link": "https://stackoverflow.com/questions/36409550/haskell-esqueleto-maybe-keys-dont-bind-on-leftouterjoin/36500043#36500043", "title": "Haskell Esqueleto - Maybe Keys don&#39;t bind on LeftOuterJoin", "body": "<p>I managed to understand the problem and solve it myself, instead of</p>\n\n<pre><code>E.on $ pf E.?. ProductFlowOrderItem E.==. E.just (oi ^. OrderItemId)\n</code></pre>\n\n<p>use this</p>\n\n<pre><code>E.on $ pf E.?. ProductFlowOrderItem E.==. (E.just . E.just) (oi ^. OrderItemId)\n</code></pre>\n\n<p>It is necessary to make the types match, because we are using <code>E.?.</code> with an already <code>Maybe</code> value, so, we have to make the right side a <code>Maybe (Maybe AType)</code>, otherwise it would be wrong, and to make it I just used <code>E.just . E.just</code> which will wrap two times.</p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 36500043, "answer_count": 1, "score": 0, "last_activity_date": 1460119946, "creation_date": 1459792434, "last_edit_date": 1459796564, "question_id": 36409550, "link": "https://stackoverflow.com/questions/36409550/haskell-esqueleto-maybe-keys-dont-bind-on-leftouterjoin", "title": "Haskell Esqueleto - Maybe Keys don&#39;t bind on LeftOuterJoin", "body": "<p>I am with some trouble while making a join which uses a <code>maybe foreign key</code>.</p>\n\n<p>My Models:</p>\n\n<pre><code>OrderItem\n  productSnapshot ProductSnapshotId\n\nProductFlow\n  productInstance ProductInstanceId\n  orderItem OrderItemId Maybe\n\nProductSnapshot\n  productInstance ProductInstanceId\n\nProductInstance\n  code Text\n</code></pre>\n\n<p>And my joins: </p>\n\n<pre><code>type Entities = [(Entity OrderItem, Entity ProductSnapshot, Entity ProductInstance, Maybe (Entity ProductFlow))]\n\nloadEntities :: OrderItemId -&gt; Handler Entities\nloadEntities oiId = runDB\n  $ E.select\n  $ E.from $ \\(oi `E.InnerJoin` ps `E.InnerJoin` pi `E.LeftOuterJoin` pf) -&gt; do\n    E.on $ pf E.?. ProductFlowOrderItem E.==. E.just (oi ^. OrderItemId)\n    E.on $ pi ^. ProductInstanceId E.==. ps ^. ProductSnapshotProductInstance\n    E.on $ ps ^. ProductSnapshotId E.==. oi ^. OrderItemProductSnapshot\n    E.where_ (oi ^. OrderItemId E.==. E.val oiId)\n    return (oi, ps, pi, pf)\n</code></pre>\n\n<p>I tried the <code>Esqueleto</code> join showed above, but I got the following error:</p>\n\n<pre><code>Couldn't match type \u2018Key OrderItem\u2019 with \u2018Maybe (Key OrderItem)\u2019\n    Expected type: EntityField OrderItem (Maybe (Key OrderItem))\n      Actual type: EntityField OrderItem (Key OrderItem)\n    In the second argument of \u2018(^.)\u2019, namely \u2018OrderItemId\u2019\n    In the first argument of \u2018E.just\u2019, namely \u2018(oi ^. OrderItemId)\u2019\n</code></pre>\n\n<p>I think it is caused because I'm using a maybe foreign key. I tried other ways, and got strange type errors. I think I don't understand completely well how these joins work, so a brief explanation about <code>E.^.</code>, <code>E.just</code> and <code>E.?.</code> would improve my Esqueleto usage.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5620, "user_id": 3194929, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/58daa530c5993a911f34e4c90e9da257?s=128&d=identicon&r=PG", "display_name": "afathman", "link": "https://stackoverflow.com/users/3194929/afathman"}, "edited": false, "score": 1, "creation_date": 1459790835, "post_id": 36408783, "comment_id": 60434097, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/6121256/efficiently-checking-that-all-the-elements-of-a-big-list-are-the-same\">efficiently checking that all the elements of a (big) list are the same</a>"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1459792507, "post_id": 36408783, "comment_id": 60435056, "body": "Did you think really hard about it?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459795017, "post_id": 36408783, "comment_id": 60436471, "body": "The first example compares strings by length, the second example compares integers by value. What should this function actually do?"}], "answers": [{"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 0, "last_activity_date": 1459790676, "creation_date": 1459790676, "answer_id": 36409036, "question_id": 36408783, "link": "https://stackoverflow.com/questions/36408783/haskell-creating-an-isequal-function-for-a-list/36409036#36409036", "title": "Haskell: Creating an isEqual function for a list", "body": "<p>You can try</p>\n\n<pre><code>minimumBy length == maximumBy length\n</code></pre>\n\n<p>(untested, and doesn't work for empty lists)</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1459791527, "creation_date": 1459791527, "answer_id": 36409289, "question_id": 36408783, "link": "https://stackoverflow.com/questions/36408783/haskell-creating-an-isequal-function-for-a-list/36409289#36409289", "title": "Haskell: Creating an isEqual function for a list", "body": "<p>probably easier to write it recursively</p>\n\n<pre><code>isEq [] = True\nisEq [x] = True\nisEq (x:y:xs) = x==y &amp;&amp; isEq (y:xs)\n</code></pre>\n\n<p>so short circuits with the first unequal size.</p>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1459796090, "post_id": 36409549, "comment_id": 60437062, "body": "I think he wants to apply <code>length</code> first, <i>then</i> remove duplicates. <code>(== 1) . nub . length</code>."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1459796250, "post_id": 36409549, "comment_id": 60437163, "body": "@chepner - he put both versions in the question.  In fact, I first did it locally with the extra length added, then took it out to match his <code>isEqual</code> function.  Note that your snippet won&#39;t work, since you need an extra map (for the list), and still need the lone length after the nub to be able to verify that the nubbed list is of length 1."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1459796939, "post_id": 36409549, "comment_id": 60437535, "body": "Oh, right. But his first question definitely wants to compare <i>lengths</i> of strings, not the strings themselves. So something like <code>(== 1) . nub . (map length)</code>?"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1459803807, "post_id": 36409549, "comment_id": 60441288, "body": "@chepner - you still need the extra length....  The (== 1) is checking that the length of the post-nubbed list is 1.  Try <code>(== 1) . length . nub . map length</code>"}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 0, "last_activity_date": 1459792428, "creation_date": 1459792428, "answer_id": 36409549, "question_id": 36408783, "link": "https://stackoverflow.com/questions/36408783/haskell-creating-an-isequal-function-for-a-list/36409549#36409549", "title": "Haskell: Creating an isEqual function for a list", "body": "<p>There is always the one liner....</p>\n\n<pre><code>(== 1) . length . nub\n</code></pre>\n\n<p>You will need to import <code>Data.List</code>.  This will perform less well than pattern matching (barely so for lists smaller than 100), but it is easy to read, and probably fits the criteria \"least amount of code\".</p>\n"}], "owner": {"reputation": 7, "user_id": 6156780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc811236822dbb5b43b4f8caa363db89?s=128&d=identicon&r=PG&f=1", "display_name": "ki15", "link": "https://stackoverflow.com/users/6156780/ki15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "answer_count": 3, "score": -4, "last_activity_date": 1459852485, "creation_date": 1459789861, "last_edit_date": 1459852485, "question_id": 36408783, "link": "https://stackoverflow.com/questions/36408783/haskell-creating-an-isequal-function-for-a-list", "title": "Haskell: Creating an isEqual function for a list", "body": "<p>I want to create an isEqual function to compare the length of each string in a list. \nIf each String is of equal size e.g. [\"that\", \"there\", \"9999\", \" 1 #\"]  </p>\n\n<p>return True if all strings are equal length\nELSE return False.</p>\n\n<p>I'm looking for a way that requires the least amount of code and run time.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 2, "creation_date": 1459788636, "post_id": 36408355, "comment_id": 60432759, "body": "Cannot reproduce, works as expected on my GHCi. Could you post the whole error message?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459789091, "post_id": 36408355, "comment_id": 60433041, "body": "btw: your <code>lastLetter</code> is just <code>return . last</code> and indeed <code>read . return . last $ show 1234 :: Integer</code> should work like a charm (the <code>:: Integer</code> is important - if you remove it you&#39;ll get your mentioned error)"}, {"owner": {"reputation": 1253, "user_id": 421251, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ae0c7a2c316de725f1608cf1a6e38572?s=128&d=identicon&r=PG", "display_name": "Benjamin Barenblat", "link": "https://stackoverflow.com/users/421251/benjamin-barenblat"}, "edited": false, "score": 1, "creation_date": 1459789768, "post_id": 36408355, "comment_id": 60433429, "body": "For this particular use case, consider using modular arithmetic instead of formatting and reparsing the integer: <code>lastDigit = abs . flip rem 10</code>."}], "owner": {"reputation": 5386, "user_id": 1101034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TtOV8.gif?s=128&g=1", "display_name": "Tiffany", "link": "https://stackoverflow.com/users/1101034/tiffany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459788370, "creation_date": 1459788370, "question_id": 36408355, "link": "https://stackoverflow.com/questions/36408355/haskell-no-parse", "title": "Haskell No Parse", "body": "<p>I'm getting a \"no parse\" error when I test these functions (with input of ordinary integers) and I don't know why. What am I doing wrong here?</p>\n\n<pre><code>lastLetter :: String -&gt; String\nlastLetter (l:[]) = [l]\nlastLetter (l:ls) = lastLetter(ls)\n\nlastDigit :: Integer -&gt; Integer\nlastDigit = read . lastLetter . show\n</code></pre>\n"}, {"tags": ["html", "parsing", "haskell"], "comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1459787702, "post_id": 36407995, "comment_id": 60432181, "body": "<a href=\"http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454\">Don&#39;t use regular expressions.</a>"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1459787835, "post_id": 36407995, "comment_id": 60432260, "body": "Also, after you turn in your assignment, take a look at the source code of the package. Haskell is easy to read for the most part."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1459792633, "post_id": 36407995, "comment_id": 60435113, "body": "The question is very broad....  Can you use parser packages?  Which one, parsec, happy (the approaches are very different)?  Do you have to write a parser from first principles?  Are you building for performance?"}, {"owner": {"reputation": 5, "user_id": 3324236, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a735a27a91e2a327a09b873e6cad27a7?s=128&d=identicon&r=PG&f=1", "display_name": "user3324236", "link": "https://stackoverflow.com/users/3324236/user3324236"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1459814758, "post_id": 36407995, "comment_id": 60445287, "body": "@PyRulez that doesn&#39;t really help me writing the function."}, {"owner": {"reputation": 5, "user_id": 3324236, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a735a27a91e2a327a09b873e6cad27a7?s=128&d=identicon&r=PG&f=1", "display_name": "user3324236", "link": "https://stackoverflow.com/users/3324236/user3324236"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1459814826, "post_id": 36407995, "comment_id": 60445311, "body": "@jamshidh we can not use any parser packages. We have to write a parser from first principles. No performance does not matter."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1459815181, "post_id": 36407995, "comment_id": 60445403, "body": "@user3324236 Okay, sorry. This may be more helpful: <a href=\"http://dev.stephendiehl.com/fun/002_parsers.html\" rel=\"nofollow noreferrer\">dev.stephendiehl.com/fun/002_parsers.html</a>"}], "owner": {"reputation": 5, "user_id": 3324236, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a735a27a91e2a327a09b873e6cad27a7?s=128&d=identicon&r=PG&f=1", "display_name": "user3324236", "link": "https://stackoverflow.com/users/3324236/user3324236"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459787710, "creation_date": 1459787232, "last_edit_date": 1459787710, "question_id": 36407995, "link": "https://stackoverflow.com/questions/36407995/html-tag-parser-in-haskell", "title": "Html Tag parser in Haskell", "body": "<p>Hi I have an assignment which is supposed to check given a string if it can become a valid html file. like for example running this:</p>\n\n<pre><code>doc2 = \u201c&lt;head&gt; Test2 &lt;body&gt; Testing &lt;/body&gt;\"\n</code></pre>\n\n<p>should output this: </p>\n\n<pre><code>\u03bb parse hmtl doc2\n(False, \u201c&lt;head&gt; Test2 &lt;body&gt; Testing &lt;/body&gt;\u201d)\n</code></pre>\n\n<p>the trouble I am having is creating a parser for the tags. \nI know that there is a package, but we are not allowed to use it. Any ideas on how to do this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459784503, "post_id": 36407027, "comment_id": 60430156, "body": "try <code>maximum . map length</code> or if you&#39;re sure the picture is a valid and well-dimensioned one: <code>length . first</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459784693, "post_id": 36407027, "comment_id": 60430289, "body": "@Carsten <code>max</code> is binary, <code>maximum</code> takes a list"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459784714, "post_id": 36407027, "comment_id": 60430301, "body": "@chi ... thanks (self-facepalm) - this happens if you don&#39;t check and rely on your stupid brain ;)"}, {"owner": {"reputation": 7, "user_id": 6156780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc811236822dbb5b43b4f8caa363db89?s=128&d=identicon&r=PG&f=1", "display_name": "ki15", "link": "https://stackoverflow.com/users/6156780/ki15"}, "edited": false, "score": 0, "creation_date": 1459785250, "post_id": 36407027, "comment_id": 60430650, "body": "Thanks That&#39;s got me the width. Still having a problem getting it defined as sizePic :: Pic -&gt; (Int, Int)"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459785383, "post_id": 36407027, "comment_id": 60430748, "body": "@Carsten AFAIK, giving clear answers to homework-like questions isn&#39;t considered to be a good thing."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1459786193, "post_id": 36407027, "comment_id": 60431282, "body": "@arrowd 1: homework is no problem here - 2: it&#39;s not the answer, 3: my homework-senses did not <i>tingle</i> here"}, {"owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "edited": false, "score": 0, "creation_date": 1459792372, "post_id": 36407027, "comment_id": 60434972, "body": "If you want the <code>length</code> of the <code>head</code>, surely there&#39;s a straightforward way to get it..."}], "answers": [{"comments": [{"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 1, "creation_date": 1459786161, "post_id": 36407125, "comment_id": 60431256, "body": "I like your input, I think it&#39;s more constructive than an answer, but as I just implied, I don&#39;t think this is an answer."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 1, "last_activity_date": 1459784549, "creation_date": 1459784549, "answer_id": 36407125, "question_id": 36407027, "link": "https://stackoverflow.com/questions/36407027/haskell-getting-the-size-of-a-image/36407125#36407125", "title": "Haskell: getting the size of a image", "body": "<p>Hint \u21161: Strings in Haskell are lists of <code>Char</code>s. That is, every line in your \"image\" is <code>[Char]</code>.</p>\n\n<p>Hint \u21162: To get a width you need to apply <code>length</code> to the first (or last, or any other) line.</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 1, "last_activity_date": 1459785248, "creation_date": 1459785248, "answer_id": 36407363, "question_id": 36407027, "link": "https://stackoverflow.com/questions/36407027/haskell-getting-the-size-of-a-image/36407363#36407363", "title": "Haskell: getting the size of a image", "body": "<p>this is not going to help you as a beginner, but to give a taste of what can be done</p>\n\n<pre><code>&gt; import Control.Arrow\n&gt; (length &amp;&amp;&amp; (length . head)) s\n(3,9)\n</code></pre>\n\n<p>you can write your version as</p>\n\n<pre><code>type Pic = [String]\n\nsizePic :: Pic -&gt; (Int, Int)\nsizePic [] = (0,0)  \nsizePic (x:xs) = (1+length xs, length x)\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6156780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc811236822dbb5b43b4f8caa363db89?s=128&d=identicon&r=PG&f=1", "display_name": "ki15", "link": "https://stackoverflow.com/users/6156780/ki15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 36407363, "answer_count": 2, "score": -1, "last_activity_date": 1459786337, "creation_date": 1459784284, "last_edit_date": 1459786337, "question_id": 36407027, "link": "https://stackoverflow.com/questions/36407027/haskell-getting-the-size-of-a-image", "title": "Haskell: getting the size of a image", "body": "<p>I'm new to Haskell and asked a professor of mine for some Exercise to help with my learning. He gave me something on image manipulation.\nI have several images created using strings in Haskell, e.g. </p>\n\n<pre><code>pic :: Int -&gt; Pic \npic 1 = [\"  ####   \",\n         \" ##  ##  \",\n         \"  ####   \"]\n</code></pre>\n\n<p>I want to obtain the image size e.g. width 9 height 3 in (9,3) format. \nDefining it as</p>\n\n<p><code>sizePic :: Pic -&gt; (Int, Int)</code></p>\n\n<p>The height is simply using the Length function.\nHeight :: Pic -> Int\nHeight = length</p>\n\n<p>The width i'm having some trouble with.\nWidth :: Pic -> Int\nWidth =</p>\n\n<p>I simply want the length of the head to be shown (all strings are equal length)</p>\n\n<p>any ideas.</p>\n"}, {"tags": ["string", "list", "haskell", "find", "character"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 4, "creation_date": 1459783513, "post_id": 36406553, "comment_id": 60429439, "body": "What has been your approach so far?  Can you write a function to test if a character appears in a string?  For example, <code>contains &quot;aba&quot; &#39;b&#39;</code> would return <code>True</code>."}, {"owner": {"reputation": 11, "user_id": 5119388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc431bc83a484e9e7e86bab6e9b99d1a?s=128&d=identicon&r=PG&f=1", "display_name": "molinet", "link": "https://stackoverflow.com/users/5119388/molinet"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1459784327, "post_id": 36406553, "comment_id": 60430028, "body": "@bheklilr As far as I could see, this function is deprecated. Instead isInfixOf can be used, which in this case <code>isInfixOf &quot;b&quot; &quot;aba&quot;</code> would return <code>True</code>"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1459784558, "post_id": 36406553, "comment_id": 60430200, "body": "I was actually unaware that there was a <code>contains</code> function already, I was intending that you write your own =P  I&#39;m assuming that this is an assignment and it&#39;s supposed to help teach you about working with recursion on linked lists, in which case you should implement everything you can to learn as much as you can."}], "answers": [{"comments": [{"owner": {"reputation": 3370, "user_id": 722938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MtO4E.jpg?s=128&g=1", "display_name": "is7s", "link": "https://stackoverflow.com/users/722938/is7s"}, "edited": false, "score": 1, "creation_date": 1459784341, "post_id": 36406832, "comment_id": 60430040, "body": "You can use <code>listToMaybe</code> instead of <code>safeHead</code>."}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459784814, "post_id": 36406832, "comment_id": 60430369, "body": "@chi - <code>elem c</code> is of type <code>String -&gt; Bool</code>. It may be due to the fact that <code>elem</code> is usually used in infix form that you&#39;re thinking it should accept a <code>Char</code>."}, {"owner": {"reputation": 11, "user_id": 5119388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc431bc83a484e9e7e86bab6e9b99d1a?s=128&d=identicon&r=PG&f=1", "display_name": "molinet", "link": "https://stackoverflow.com/users/5119388/molinet"}, "reply_to_user": {"reputation": 3370, "user_id": 722938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MtO4E.jpg?s=128&g=1", "display_name": "is7s", "link": "https://stackoverflow.com/users/722938/is7s"}, "edited": false, "score": 0, "creation_date": 1459786588, "post_id": 36406832, "comment_id": 60431528, "body": "@ChadGilbert - I just need the index value but this is great. As @is7s says <code>listToMaybe</code> can be used instead of safeHead. Thanks!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459789781, "post_id": 36406832, "comment_id": 60433437, "body": "@ChadGilbert Indeed <code>elem c :: String -&gt; Bool</code>, but <code>filter</code> will pass a <code>Char</code> to that, which looks wrong. Am I missing something?"}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1459790412, "post_id": 36406832, "comment_id": 60433815, "body": "@chi - <code>filter</code> would be passing a <code>String</code> to <code>elem c</code> if its input was a list of strings, but in my example I&#39;m passing a zipped list of ints and strings. It <a href=\"http://rextester.com/YDB37923\" rel=\"nofollow noreferrer\">compiles and works as advertised</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459794037, "post_id": 36406832, "comment_id": 60435934, "body": "@ChadGilbert You&#39;re correct. I missed a <code>[]</code> in my head. Thank you."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 1, "last_activity_date": 1459785009, "last_edit_date": 1459785009, "creation_date": 1459783784, "answer_id": 36406832, "question_id": 36406553, "link": "https://stackoverflow.com/questions/36406553/haskell-get-the-index-of-the-first-occurrence-in-a-list-of-strings/36406832#36406832", "title": "Haskell - Get the index of the first occurrence in a list of strings", "body": "<p>You ask for the first <em>position</em> so I'm not clear whether you want an index value or the actual value. Here's a function that gives you a tuple containing both the index and the value at that index.</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>import Data.Maybe\n\nfirstOccurrenceOf :: Char -&gt; [String] -&gt; Maybe (Int, String)\nfirstOccurrenceOf c list =\n  listToMaybe $ filter (elem c . snd) $ zip [0..] list\n</code></pre>\n\n<p><code>listToMaybe</code> provides a safe alternative to <code>head</code> which will return <code>Nothing</code> instead of crashing on an empty list.</p>\n"}, {"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 2, "last_activity_date": 1459784327, "creation_date": 1459784327, "answer_id": 36407045, "question_id": 36406553, "link": "https://stackoverflow.com/questions/36406553/haskell-get-the-index-of-the-first-occurrence-in-a-list-of-strings/36407045#36407045", "title": "Haskell - Get the index of the first occurrence in a list of strings", "body": "<p>Here is a function that will do what you want:</p>\n\n<pre><code>getIndexWithb = findIndex ('b' `elem`)\n</code></pre>\n\n<p>You will need to import <code>Data.List</code> to make this work.  Also note that this function returns type <code>Maybe Int</code> for the case that <code>'b'</code> never appears in any of the strings.</p>\n\n<hr>\n\n<p>Usage:</p>\n\n<pre><code>&gt; getIndexWithb [ \"aaa\", \"aaa\", \"aba\", \"aaa\"]\nJust 2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1253, "user_id": 421251, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ae0c7a2c316de725f1608cf1a6e38572?s=128&d=identicon&r=PG", "display_name": "Benjamin Barenblat", "link": "https://stackoverflow.com/users/421251/benjamin-barenblat"}, "is_accepted": false, "score": 2, "last_activity_date": 1459784336, "creation_date": 1459784336, "answer_id": 36407052, "question_id": 36406553, "link": "https://stackoverflow.com/questions/36406553/haskell-get-the-index-of-the-first-occurrence-in-a-list-of-strings/36407052#36407052", "title": "Haskell - Get the index of the first occurrence in a list of strings", "body": "<p><a href=\"https://www.haskell.org/onlinereport/list.html\" rel=\"nofollow\">The List Utilities chapter of the Haskell Report</a> describes a function <code>findIndex</code> which finds the index of the first element of a list that satisfies an arbitrary predicate.  It can be implemented as</p>\n\n<pre><code>findIndex p xs =\n  case [ i | (x, i) &lt;- zip xs [0..], p x ] of\n    [] -&gt; Nothing\n    e:_ -&gt; Just e\n</code></pre>\n\n<p>With that, you can find the first element of the list that contains <code>'b'</code> with</p>\n\n<pre><code>findIndex ('b'`elem`) [\"aaa\", \"aaa\", \"aba\", \"aaa\"]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5119388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc431bc83a484e9e7e86bab6e9b99d1a?s=128&d=identicon&r=PG&f=1", "display_name": "molinet", "link": "https://stackoverflow.com/users/5119388/molinet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4765, "favorite_count": 0, "accepted_answer_id": 36407045, "answer_count": 3, "score": -1, "last_activity_date": 1459785009, "creation_date": 1459783038, "last_edit_date": 1459783508, "question_id": 36406553, "link": "https://stackoverflow.com/questions/36406553/haskell-get-the-index-of-the-first-occurrence-in-a-list-of-strings", "title": "Haskell - Get the index of the first occurrence in a list of strings", "body": "<p>I have a list of strings like the following:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>[ \"aaa\", \"aaa\", \"aba\", \"aaa\"]\n</code></pre>\n\n<p>I want to make a function that returns the first position of the list where there is an item containing the character 'b'. How can I do it in Haskell?</p>\n"}, {"tags": ["haskell", "type-inference"], "answers": [{"tags": [], "owner": {"reputation": 49501, "user_id": 784338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae195ac7c8a5e9002a808544572cc5fc?s=128&d=identicon&r=PG", "display_name": "Daniel Gratzer", "link": "https://stackoverflow.com/users/784338/daniel-gratzer"}, "is_accepted": true, "score": 3, "last_activity_date": 1459777121, "creation_date": 1459777121, "answer_id": 36404298, "question_id": 36404153, "link": "https://stackoverflow.com/questions/36404153/type-inference-engine-haskell/36404298#36404298", "title": "Type inference engine haskell", "body": "<p>A great reference on the subject would be \"Typing Haskell in Haskell\" by Mark Jones. There's a <a href=\"https://gist.github.com/chrisdone/0075a16b32bfd4f62b7b\" rel=\"nofollow\">markdown version</a> transcribed by Chris Done avaliable as well as <a href=\"http://web.cecs.pdx.edu/~mpj/thih/\" rel=\"nofollow\">the original</a>. Additionally, <a href=\"http://www.cis.upenn.edu/~bcpierce/tapl/\" rel=\"nofollow\">Types and Programming Languages</a> has an explanation of the classic Algorithm W (underlying Haskell and ML style type inference) and a proof of its correctness.</p>\n\n<p>Keep in mind that type inference as a problem depends very heavily on the source language you're typing and small changes at the language level heavily impact the language. For example:</p>\n\n<ul>\n<li>Do you have let generalization?</li>\n<li>Type classes?</li>\n<li>A value or monomorphism restriction?</li>\n<li>Modules of any sort?</li>\n</ul>\n\n<p>Answering yes or no to any of these questions will wildly alter your type inference algorithm. More information is needed in your question to be able to give you more specific resources though.</p>\n\n<p>In Typing Haskell in Haskell there's also no attempt to deal with issues a real compiler might have to, like producing an annotated version of the AST so that future compilation passes know <em>how</em> something was typed, not just that it was typed. If you're building a compiler then you'll almost certainly want to do this.</p>\n"}], "owner": {"reputation": 870, "user_id": 1759068, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/4CfUy.jpg?s=128&g=1", "display_name": "Yevgraf Andreyevich Zhivago", "link": "https://stackoverflow.com/users/1759068/yevgraf-andreyevich-zhivago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 2, "closed_date": 1459777333, "accepted_answer_id": 36404298, "answer_count": 1, "score": 1, "last_activity_date": 1459807682, "creation_date": 1459776726, "last_edit_date": 1459807682, "question_id": 36404153, "link": "https://stackoverflow.com/questions/36404153/type-inference-engine-haskell", "closed_reason": "Not suitable for this site", "title": "Type inference engine haskell", "body": "<p>I am working on a project that requires me to write my own type inference engine in Haskell. </p>\n\n<ol>\n<li>Why unification algorithm is important for building inference engine</li>\n<li>Can I create this type inference engine with language like C#\nMany thanks</li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459777805, "post_id": 36403148, "comment_id": 60425334, "body": "If by &quot;work without specifying an actual type&quot; you mean you want the compiler to figure out which type it is, it simply isn&#39;t possible. Even if you have a representation of the type stored internally, you can&#39;t recover it. It will always have to be existentially quantified, no matter what you do with it. Even then, your show instance is <code>instance Show a =&gt; Show (Message a)</code> so you are obligated to produce a proof of <code>Show a</code> to show a message - nowhere do you store or compute such a proof (i.e. in the way that <code>KnownSymbol</code> is stored in <code>Message</code>)."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459780212, "post_id": 36403148, "comment_id": 60427024, "body": "@user2407038, yep, good point. That is what I was wondering about. It seems then I have to specify the exact type for decoding, instead of leaving it generic. So, this approach doesn&#39;t work when decoding messages over the network where we don&#39;t know what the actual type is, without looking at the <code>type</code> field."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459781052, "post_id": 36403148, "comment_id": 60427676, "body": "The approach works - you just have to bite the existential quantification bullet so to speak. Dealing with existential quantification is clunky at times but it is the only way you can type information from runtime values. See my answer for a slightly modified approach."}], "answers": [{"comments": [{"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1459786731, "post_id": 36405705, "comment_id": 60431606, "body": "thank you for taking time to answer this. Very helpful. Perhaps a gist with the whole code will also be very useful to have, if you still have it. Will help me tie the knots together."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1459787157, "post_id": 36405705, "comment_id": 60431865, "body": "The code in the answer is pretty much it, minus imports, which I just copied from your code. <a href=\"https://gist.github.com/anonymous/5291f5a767c4bd12fac7f5cb8fc8bba1\" rel=\"nofollow noreferrer\">Full code</a>"}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 3, "last_activity_date": 1459781623, "last_edit_date": 1459781623, "creation_date": 1459780754, "answer_id": 36405705, "question_id": 36403148, "link": "https://stackoverflow.com/questions/36403148/decoding-json-data-types-using-knownsymbol-proxy-approach/36405705#36405705", "title": "Decoding JSON data types using knownsymbol/proxy approach", "body": "<p>The core of the issue is that you want to leave the type variables as parameters to allow class constraints on those parameters as needed, but you also want to have the type existentially quantified (because the type actually depends on a runtime value).</p>\n\n<p>The simple thing you can exploit here is that the set of type satisfying <code>TypeKey x ~ a</code> is finite. Instead of representing this a type family, consider the following representation:</p>\n\n<pre><code>data TypeKeyOf (a :: *) (x :: Symbol) where \n  IntK :: Int `TypeKeyOf` \"int\" \n  StringK :: String `TypeKeyOf` \"string\" \n</code></pre>\n\n<p>Note that you can represent a generic finite map from e.g. <code>*</code> to <code>Symbol</code> but for simplicity lets keep it concrete. </p>\n\n<p>You can now very easily write a function which \"proves\" various things about a type key:</p>\n\n<pre><code>type IsTypeKey a x = (ToJSON a, FromJSON a, KnownSymbol x)\n\nisTypeKey :: TypeKeyOf a x -&gt; (IsTypeKey a x =&gt; r) -&gt; r \nisTypeKey IntK k = k \nisTypeKey StringK k = k \n\nkeyOf :: TypeKeyOf a x -&gt; Proxy x \nkeyOf _ = Proxy \n</code></pre>\n\n<p>Crucially, your type class instances should not have contexts - your type information is all hidden. </p>\n\n<pre><code>instance ToJSON (TypeKeyOf a x) where \n  toJSON k = isTypeKey k (A.String . pack . symbolVal . keyOf $ k)\n\ndata SomeTypeKey = forall a x . TK (TypeKeyOf a x) \n\ninstance FromJSON SomeTypeKey where \n    parseJSON (A.String s) \n      | s == \"int\" = return $ TK IntK \n      | s == \"string\" = return $ TK StringK \n    parseJSON _      = mzero\n</code></pre>\n\n<p>Again, the <code>Payload</code> type variables are existentially quantified. This doesn't mean you can do less with this type (in fact, you can do more). </p>\n\n<pre><code>data Payload where\n  Payload :: a `TypeKeyOf` s -&gt; a -&gt; Payload \n\ninstance ToJSON Payload where\n    toJSON (Payload k a) = \n      object [ \"type\" .= k \n             , isTypeKey k $ \"data\" .= a\n             ]\n\ninstance FromJSON Payload where\n    parseJSON (Object v) = \n      (v .: \"type\") &gt;&gt;= \\(TK q) -&gt; isTypeKey q (Payload q &lt;$&gt; v .: \"data\") \n    parseJSON _ = mzero \n</code></pre>\n\n<p>Note how at various points <code>isTypeKey</code> is used to prove that various things are instances of the appropriate classes.</p>\n\n<p>If you try to write a show instance:</p>\n\n<pre><code>instance Show Payload where\n    show (Payload k a) = isTypeKey k $ \n      \"Payload \" &lt;&gt; symbolVal (keyOf k) &lt;&gt; \" \" &lt;&gt; show a\n</code></pre>\n\n<p>You get <code>No instance for Show a ...</code>. This is fixed by adding the required constraint to <code>IsTypeKey</code>:</p>\n\n<pre><code>type IsTypeKey a x = (ToJSON a, FromJSON a, KnownSymbol x, Show a)\n</code></pre>\n\n<p>And now the type really is completely determined by the parse, but it is simply existentially quantified:</p>\n\n<pre><code>&gt;decode \"{\\\"type\\\": \\\"string\\\", \\\"data\\\": \\\"hello\\\"}\" :: Maybe Payload\nJust Payload string \"hello\"\n&gt;decode \"{\\\"type\\\": \\\"int\\\", \\\"data\\\": 42}\" :: Maybe Payload\nJust Payload int 42\n</code></pre>\n\n<p>Note that if you \"know\" the actual type of the payload, you can still extract\nthat value in a type safe way, since you really know <em>everything</em> about the types, given that you can always find out precisely what they are. </p>\n\n<pre><code>class HasTypeKey a (x :: Symbol) | x -&gt; a where \n  typeKey :: TypeKeyOf a x \n\ninstance HasTypeKey Int \"int\" where typeKey = IntK \ninstance HasTypeKey String \"string\" where typeKey = StringK \n\ntypeKeyOf :: HasTypeKey a x =&gt; Proxy x -&gt; TypeKeyOf a x \ntypeKeyOf _ = typeKey \n\nsameKey :: TypeKeyOf a x -&gt; TypeKeyOf a' x' -&gt; Maybe ('(a, x) :~: '(a', x'))\nsameKey IntK IntK = Just Refl \nsameKey StringK StringK = Just Refl \nsameKey _ _ = Nothing \n\nextractPayload :: HasTypeKey a x =&gt; Proxy x -&gt; Payload -&gt; Maybe a \nextractPayload t' (Payload t x) = fmap (\\Refl -&gt; x) $ sameKey t (typeKeyOf t')\n</code></pre>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 36405705, "answer_count": 1, "score": 1, "last_activity_date": 1459781623, "creation_date": 1459774162, "question_id": 36403148, "link": "https://stackoverflow.com/questions/36403148/decoding-json-data-types-using-knownsymbol-proxy-approach", "title": "Decoding JSON data types using knownsymbol/proxy approach", "body": "<p>I am trying out the JSON decoding approach as laid out in a <a href=\"http://aaronlevin.ca/post/111871447488/using-dataproxy-to-encode-types-in-your-json\" rel=\"nofollow\">blog post</a>. Basically, we handle the data type for JSON encoding and decoding using <code>KnownSymbol</code> and <code>typefamilies</code>. So far so good. I tried out the code for <a href=\"https://gist.github.com/aaronlevin/4aa22bd9c79997029167#file-06-polymorphic-containers-hs\" rel=\"nofollow\">polymorphic containers</a> but with actual decoding type (<code>Message String</code>) specified:</p>\n\n<pre><code>*Test&gt; messageStringA\n\"{ \\\"payload\\\": {\\\"type\\\": \\\"string\\\", \\\"data\\\": \\\"cool\\\"} }\"\n*Test&gt; decode messageStringA :: Maybe (Message String)\nJust Message ( Payload string \"cool\" )\n</code></pre>\n\n<p>Now, I will like the decoding to work without specifying actual type - so, I added that code - instead of <code>Message String</code>, now we have <code>Message a</code> type:</p>\n\n<pre><code>decode1 :: (s ~ TypeKey a, KnownSymbol s, FromJSON a) =&gt; BL.ByteString -&gt; Maybe (Message a)\ndecode1 = decode\n\ntestDecode :: (s ~ TypeKey a, KnownSymbol s, FromJSON a) =&gt; Maybe (Message a)\ntestDecode = decode1 messageStringA\n</code></pre>\n\n<p>Compilation is fine, but at run-time, I get this error in <code>ghci</code>:</p>\n\n<pre><code>*Test&gt; :set -XFlexibleContexts\n*Test&gt; testDecode\n\n&lt;interactive&gt;:5:1:\n    No instance for (KnownSymbol (TypeKey a0))\n      arising from a use of \u2018it\u2019\n    In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>Will appreciate pointers on what I am doing wrong here. It looks to me that <code>ghci</code> is unable to print since there is no instance of <code>Show</code> for <code>KnownSymbol (TypeKey a)</code>.</p>\n"}, {"tags": ["haskell", "concurrency", "gtk", "gtk2hs"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459773083, "post_id": 36402378, "comment_id": 60421693, "body": "It would be helpful for us if you got rid of the ui file \u2013 that doesn&#39;t really seem necessary here. Without it, we could just quickly test the program."}, {"owner": {"reputation": 428, "user_id": 1520657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599f6ac58a187b4e89ad8cb576304166?s=128&d=identicon&r=PG", "display_name": "MichaelO", "link": "https://stackoverflow.com/users/1520657/michaelo"}, "edited": false, "score": 0, "creation_date": 1459774643, "post_id": 36402378, "comment_id": 60422886, "body": "I think <code>renderWithDrawable</code> creates a new context for cairo and the commands after it should be in the same context to see something (it makes no sense to do a <code>stroke</code> in a new context when there was nothing drawn before in this new context)."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459776339, "post_id": 36402378, "comment_id": 60424173, "body": "@leftaroundabout ok, I will make it and provide you with it as soon I will be at home"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459782605, "post_id": 36402378, "comment_id": 60428755, "body": "@leftaroundabout ok, it&#39;s done"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459784629, "post_id": 36402378, "comment_id": 60430243, "body": "@leftaroundabout here is a tutorial that could help you if all the tools are not installed : <a href=\"http://rizwanbulbul.blogspot.fr/2010/06/installing-leksah-gtk-gtk2hs-and-glade.html\" rel=\"nofollow noreferrer\">rizwanbulbul.blogspot.fr/2010/06/&hellip;</a>"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1459784777, "post_id": 36402378, "comment_id": 60430340, "body": "...and here&#39;s an other, which is better I think : <a href=\"https://pamiz.wordpress.com/2012/12/11/packages-needed-to-install-gtk2hs-on-ubuntu/\" rel=\"nofollow noreferrer\">pamiz.wordpress.com/2012/12/11/&hellip;</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459785336, "post_id": 36402378, "comment_id": 60430710, "body": "So... what part of the question remains? \u2014 You needn&#39;t add information on how to install packages, just try to keep your posts short, focused and your own code self-contained (like the second example is, now; very good)."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459785772, "post_id": 36402378, "comment_id": 60431000, "body": "@leftaroundabout I would like my program to display the points progressively : now they are all displayed together after having been computed. For this particular example, this not seems to be important, but for some other programs which need more time to be computed, it could become of high importance."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459786819, "post_id": 36402378, "comment_id": 60431662, "body": "Ok, so basically <a href=\"http://stackoverflow.com/questions/36378409/haskell-gtk-how-to-draw-points-as-soon-as-they-are-computed\">your other question</a>."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1459789345, "post_id": 36402378, "comment_id": 60433181, "body": "We could continue with the other question, as we have to select only one, and the title of the other one fits best to the remaining problem!"}], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 2, "last_activity_date": 1459772386, "creation_date": 1459772386, "answer_id": 36402456, "question_id": 36402378, "link": "https://stackoverflow.com/questions/36402378/haskell-gtk2hs-no-point-is-displayed-in-a-canvas-parallel-drawing/36402456#36402456", "title": "haskell &amp; Gtk2hs : no point is displayed in a canvas (parallel drawing)", "body": "<p>While i haven't worked with Gtk2Hs, i guess the problem is in <code>affiche2</code>. Try changing it to this:</p>\n\n<pre><code>affiche2 win a b = do\n  renderWithDrawable win $ do\n    setSourceRGB 0 1 0\n    setLineWidth 1\n    C.rectangle a b 1 1 \n    stroke\n</code></pre>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 36402456, "answer_count": 1, "score": 0, "last_activity_date": 1459782576, "creation_date": 1459772178, "last_edit_date": 1459782576, "question_id": 36402378, "link": "https://stackoverflow.com/questions/36402378/haskell-gtk2hs-no-point-is-displayed-in-a-canvas-parallel-drawing", "title": "haskell &amp; Gtk2hs : no point is displayed in a canvas (parallel drawing)", "body": "<p>I wrote a little program which has to display the mandelbrot set, in haskell, using Gtk2Hs.</p>\n\n<p>thought there is no compilation error, nothing is displayed in the canvas (the component in which the points are colored)...</p>\n\n<p>could you help me to debug this logical error?</p>\n\n<p>my code:</p>\n\n<pre><code>module Main where\n\nimport           Control.Monad            (when)\nimport           Graphics.Rendering.Cairo as C\nimport           Graphics.UI.Gtk\nimport           Graphics.UI.Gtk.Builder  ()\n\n\nmain :: IO()\nmain = do\n    _ &lt;- initGUI\n    builder &lt;- builderNew\n    builderAddFromFile builder \"09-mandelbrot.ui\"\n\n    window   &lt;- builderGetObject builder castToWindow \"Figure de Mandelbrot\"\n    canvas &lt;- builderGetObject builder castToDrawingArea \"drawingarea1\"\n    _ &lt;- onExpose canvas $ const (updateCanvas canvas)\n\n    widgetShowAll window\n    mainGUI\n\n\nupdateCanvas :: DrawingArea -&gt; IO Bool\nupdateCanvas canvas = do\n  win &lt;- widgetGetDrawWindow canvas\n  (width, height) &lt;- widgetGetSize canvas\n  _ &lt;- mapM_ (affiche win)  (points (fromIntegral width) (fromIntegral height))\n\n  return True\n\nk :: Int\nk=100\n\nmandelbrot :: Double -&gt; Double -&gt; Bool\nmandelbrot a b =\n  let\n    mandelrec :: Double -&gt; Double -&gt; Int -&gt; Bool\n    mandelrec x y i\n      | (x * x + y * y &gt; 4) = False\n      | (i==k) &amp;&amp; (x * x + y * y &lt;= 4) = True\n      | otherwise = mandelrec x' y' (i+1)\n            where x' = x * x - y * y + a\n                  y' = 2 * x * y + b\n  in mandelrec 0 0 0\n\naffiche2 :: DrawWindow -&gt; Double -&gt; Double -&gt; IO()\naffiche2 win a b = do\n  renderWithDrawable win $ setSourceRGB 0 1 0\n  renderWithDrawable win $ setLineWidth 1\n  renderWithDrawable win $ C.rectangle a b 1 1 \n  renderWithDrawable win stroke\n\n\naffiche :: DrawWindow -&gt; ((Double,Double), (Double,Double)) -&gt; IO ()\naffiche win ((a0,a), (b0,b)) = when (mandelbrot a b) $ postGUIAsync (affiche2 win a0 b0)\n\ncolonnes :: Double -&gt; [(Double, Double)]\ncolonnes w = [ (t,t/w*4-2) | t&lt;-[0..(w-1)] ]\n\nlignes :: Double -&gt; [(Double, Double)]\nlignes h = [ (t,t/h*4-2) | t&lt;-[0..(h-1)] ]\n\npoints :: Double -&gt; Double -&gt; [((Double, Double), (Double, Double))]\npoints w h = [ (colonne,ligne)| colonne &lt;- colonnes w,ligne &lt;- lignes h]\n</code></pre>\n\n<p>main() is not interesting, it works, I am sure.\nupdate_canvas grab some values (width, height, win) and call the side-effect function, affiche, providing it the values in \"points\" (points contains the good values, namely the coordinates of the points between [-2..2] for the 2 axes.\nmandelbrot is good, since I succeeded in drawing the mandelbrot set (yet all points were drawed together). \nI think if there is a problem, it could come from affiche or affiche2, but I'm new to Gtk programming.</p>\n\n<p>thank you.</p>\n\n<h2>EDIT</h2>\n\n<p>Well, it works with your change, but why?\nand I have another question : if I raise the parameter k (say to 1000), the set is displayed only 17 seconds after having launched the program, and it is displayed very quickly; but that's not what I would like : I want the points be drawed as soon as they are computed. DO you know what change I must do? </p>\n\n<h2> EDIT 2</h2>\n\n<p>here is a code which\n- works : it displays the image in &lt;10s\n- doesn't use any UI or GLADE file\n- draws points after all are computed</p>\n\n<pre><code>module Main where\n\nimport           Control.Monad            (when)\nimport           Graphics.Rendering.Cairo as C\nimport           Graphics.UI.Gtk\nimport           Graphics.UI.Gtk.Builder  ()\n\n\nmain :: IO()\nmain = do\n    _ &lt;- initGUI\n\n    window &lt;- windowNew\n    windowSetPosition window WinPosCenter\n    windowSetDefaultSize window 500 350\n    set window [windowTitle := \"Ensemble de Mandelbrot\"]\n    on window objectDestroy mainQuit\n\n    canvas &lt;- drawingAreaNew\n    canvas `on` sizeRequest $ return (Requisition 450 300)\n    window `containerAdd` canvas\n\n    _ &lt;- onExpose canvas $ const (updateCanvas canvas)\n\n    widgetShowAll window\n    mainGUI\n\n\nupdateCanvas :: DrawingArea -&gt; IO Bool\nupdateCanvas canvas = do\n  win &lt;- widgetGetDrawWindow canvas\n  (width, height) &lt;- widgetGetSize canvas\n  _ &lt;- mapM_ (affiche win)  (points (fromIntegral width) (fromIntegral height))\n\n  return True\n\nk :: Int\nk=100 -- 100 : after launching, u must wait less than 10s\n\nmandelbrot :: Double -&gt; Double -&gt; Bool\nmandelbrot a b =\n  let\n    mandelrec :: Double -&gt; Double -&gt; Int -&gt; Bool\n    mandelrec x y i\n      | (x * x + y * y &gt; 4) = False\n      | (i==k) &amp;&amp; (x * x + y * y &lt;= 4) = True\n      | otherwise = mandelrec x' y' (i+1)\n            where x' = x * x - y * y + a\n                  y' = 2 * x * y + b\n  in mandelrec 0 0 0\n\naffiche2 :: DrawWindow -&gt; Double -&gt; Double -&gt; IO()\naffiche2 win a b = renderWithDrawable win $ do\n    setSourceRGB 0 0 0\n    setLineWidth 1\n    C.rectangle a b 1 1 \n    stroke\n\n\naffiche :: DrawWindow -&gt; ((Double,Double), (Double,Double)) -&gt; IO ()\naffiche win ((a0,a), (b0,b)) = when (mandelbrot a b) $ postGUIAsync (affiche2 win a0 b0)\n\ncolonnes :: Double -&gt; [(Double, Double)]\ncolonnes w = [ (t,t/w*4-2) | t&lt;-[0..(w-1)] ]\n\nlignes :: Double -&gt; [(Double, Double)]\nlignes h = [ (t,t/h*4-2) | t&lt;-[0..(h-1)] ]\n\npoints :: Double -&gt; Double -&gt; [((Double, Double), (Double, Double))]\npoints w h = [ (colonne,ligne)| colonne &lt;- colonnes w,ligne &lt;- lignes h]\n</code></pre>\n\n<p>olivier</p>\n"}, {"tags": ["haskell", "binary-tree"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1459776434, "post_id": 36398709, "comment_id": 60424261, "body": "Note that you only really have to define <code>zipTreeWith :: (a -&gt; b -&gt; c) -&gt; (Tree a) -&gt; (Tree b) -&gt; (Tree c)</code>, since <code>zipTree</code> is then just the special case <code>zipWith = zipTreeWith (,)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 6, "last_activity_date": 1459763162, "last_edit_date": 1459763162, "creation_date": 1459762550, "answer_id": 36399073, "question_id": 36398709, "link": "https://stackoverflow.com/questions/36398709/zipwith-for-trees-in-haskell/36399073#36399073", "title": "zipWith for trees in Haskell", "body": "<p>First of all I believe your solution is not elegant because you are using <code>undefined</code>.\nYou want to avoid partial functions, and structures, as much as possible and simply inserting some <code>Node undefined undefined</code> in a tree structure doesn't sound like a good idea.</p>\n\n<p>Think about this: once you have a <code>Node undefined undefined</code> how would it act with the other operations on the tree? You'd probably get tons of exceptions.</p>\n\n<p>So you have to find an alternative. </p>\n\n<pre><code>zipTree (Node l r) (Leaf a) = Node x y\n    where\n        x = ... ? \n        y = ... ? \n</code></pre>\n\n<p>Now how should <code>x</code> and <code>y</code> be defined? <code>x</code> should depend on <code>l</code> and <code>Leaf a</code> while <code>y</code> should depend on <code>r</code> and <code>Leaf a</code>. </p>\n\n<p>The easiest way to define this case is to simply perform the recursive calls:</p>\n\n<pre><code>zipTree (Node l r) a@(Leaf _) = Node (zipTree l a) (zipTree r a)\n</code></pre>\n\n<p>So we are zipping all leafs in the <code>l</code> and <code>r</code> subtrees with the leaf <code>a</code>.</p>\n\n<p>As for the <code>zipWithTree</code>: that's easy. You have to add an <code>f</code> parameter and use <code>f x y</code> instead of <code>(x, y)</code> when you perform the zipping, which is done only in the <code>Leaf</code> v <code>Leaf</code> case:</p>\n\n<pre><code>zipWithTree f (Leaf a) (Leaf b) = Leaf $ f a b\n</code></pre>\n\n<p>Obviously you have to add the <code>f</code> parameter to all the rules and pass <code>f</code> to recursive calls.</p>\n\n<hr>\n\n<p>Note that there is also an other way to define <code>zipWith</code>, which is:</p>\n\n<pre><code>zipTree (Node _ _) (Leaf a) = Leaf (undefined, a)\n</code></pre>\n\n<p>This still isn't a good solution because it introduces an <code>undefined</code> however it has some advantages against the <code>Node undefined undefined</code> solution:</p>\n\n<ol>\n<li><p>It acts for similarly to <code>zip</code> from lists. <code>zip [1,2] [1,2,3,4] == [(1,1), (2,2)]</code> so you stop when the shorter list ends.</p></li>\n<li><p>The <code>undefined</code> is <em>inside</em> the value. This allows for example to have:</p>\n\n<pre><code>mapTree snd (zipTree x y) == y\n</code></pre>\n\n<p>whenever <code>x</code> has longer branches. Using <code>Node undefined undefined</code> you have <code>mapTree f (zipTree x y)</code> is <em>always</em> an exception whenever the trees aren't isomorphic (because <code>mapTree</code> will try to evaluate <code>undefined</code>).</p></li>\n</ol>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6137776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 2, "accepted_answer_id": 36399073, "answer_count": 1, "score": 3, "last_activity_date": 1459767849, "creation_date": 1459761455, "last_edit_date": 1459767849, "question_id": 36398709, "link": "https://stackoverflow.com/questions/36398709/zipwith-for-trees-in-haskell", "title": "zipWith for trees in Haskell", "body": "<p>I am learning Haskell using The Haskell School of Expression: Learning Functional Programming through Multimedia and I am unsure how to go about solving this exercise. </p>\n\n<blockquote>\n  <p>Using the definition of trees given by </p>\n\n<pre><code>data Tree a = Node (Tree a) (Tree a) | Leaf a\n</code></pre>\n  \n  <p>Define tree versions of the list functions <code>zip</code> and <code>zipWith</code>. There\n  will be cases at the leaves or where trees are of different shapes\n  where you\u2019ll have to make design decisions. Try to make your decisions\n  as elegant as possible.</p>\n</blockquote>\n\n<p>For <code>zip</code> I have this but I am unsure if it is \"elegant\"</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>zipTree :: Tree a -&gt; Tree b -&gt; Tree (a,b)\nzipTree (Leaf a)     (Leaf b)     = Leaf (a,b)\nzipTree (Node l1 r1) (Node l2 r2) = \n  let l = zipTree l1 l2\n      r = zipTree r1 r2 \n  in Node l r \n\n-- Problems...\nzipTree (Node _ _)  (Leaf _)   = Node undefined undefined\nzipTree (Leaf _)    (Node _ _) = Node undefined undefined\n</code></pre>\n\n<p>And I am unsure how to adapt it to have <code>zipWith</code> functionality although I do know a elegant definition of zipWith.</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>zipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWith f (x:xs) (y:ys) = f x y : zipWith f xs ys\nzipWith _ _ _ = []\n</code></pre>\n"}, {"tags": ["haskell", "testing", "graph", "geometry", "quickcheck"], "comments": [{"owner": {"reputation": 41, "user_id": 5125477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbf12abb42007cd53d25fae5c3e52015?s=128&d=identicon&r=PG&f=1", "display_name": "Fluids", "link": "https://stackoverflow.com/users/5125477/fluids"}, "edited": false, "score": 0, "creation_date": 1464875237, "post_id": 36398392, "comment_id": 62672229, "body": "73233 &gt; Quando for grande quero poder correr scripts para avaliar indiv&#237;duos."}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 3, "last_activity_date": 1459768330, "creation_date": 1459768330, "answer_id": 36401039, "question_id": 36398392, "link": "https://stackoverflow.com/questions/36398392/arbitrary-instance-for-generating-unbiased-graphs-for-quickcheck/36401039#36401039", "title": "Arbitrary instance for generating unbiased graphs for quickcheck", "body": "<p>First you must figure out how to construct a graph which satisfies those properties. </p>\n\n<p>DAG: If your nodes admit some ordering, and for each edge <code>(u,v)</code> you have <code>u &lt; v</code> then the graph is acyclic. This ordering can be any ordering at all, so you can just manufacture an arbitrary ordering on the set of nodes in the graph. </p>\n\n<p>Forest: If your graph has no edges, this property is trivially satisfied. Initially you can add any edge whose source is any node. If you add an edge, remove the source of that edge from the remaining available nodes.</p>\n\n<p>I guess the big question is how to translate this to code. QuickCheck provides many combinators, esp. for selecting from lists, with and without replacement, of various sizes, etc. </p>\n\n<pre><code>instance (Ord v, Arbitrary v) =&gt; Arbitrary (Graph v) where \n  arbitrary = do \n    ns &lt;- Set.fromList &lt;$&gt; liftA2 (++) (replicateM 10 arbitrary) arbitrary\n</code></pre>\n\n<p>First you generate a random set of nodes. </p>\n\n<pre><code>    let ns' = map reverse $ drop 2 $ inits $ Set.toList ns \n</code></pre>\n\n<p>For each node, this computes the (non-empty) set of nodes which are \"greater\" than that node. Here \"greater\" just means according to the arbitrary ordering induced by the order of the elements in the list. This gets you the DAG property.</p>\n\n<pre><code>    es &lt;- sublistOf ns' &gt;&gt;= \n            mapM (\\(f:ts) -&gt; Edge f &lt;$&gt; elements ts)\n</code></pre>\n\n<p>You then get a random sublist of that list (which gets you the forest property), and for each element in that random sublist, you create an edge pointing from the \"largest\" node in that set to one that is \"smaller\". </p>\n\n<pre><code>    return $ Graph ns (Set.fromList es) \n</code></pre>\n\n<p>Then you're done! Test like so: </p>\n\n<pre><code>main = quickCheck $ forAll arbitrary (liftA2 (&amp;&amp;) (isDAG :: Graph Integer -&gt; Bool) isForest)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 0, "last_activity_date": 1461782747, "creation_date": 1461782747, "answer_id": 36898354, "question_id": 36398392, "link": "https://stackoverflow.com/questions/36398392/arbitrary-instance-for-generating-unbiased-graphs-for-quickcheck/36898354#36898354", "title": "Arbitrary instance for generating unbiased graphs for quickcheck", "body": "<p>A natural way of constructing graphs is inductively, adding one node at a time. Then it becomes quite easy to ensure the required properties hold:</p>\n\n<ul>\n<li>If for each added node its edges point only to existing nodes (and not in the other direction), we ensure the DAG property.</li>\n<li>If there is at most one edge going from a node, we ensure the forest property. (As you didn't provide the <code>adj</code> function, it's not clear if by \"forest\" you mean there is at most one edge going <em>from</em> a node or <em>to</em> a node.)</li>\n</ul>\n\n<p>So the process of generating such a graph would go as follows:</p>\n\n<ol>\n<li>Generate a list of random nodes.</li>\n<li>Construct a graph by add them one by one. For each node, either add a random edge to one of the already added nodes, or no edge (decide randomly).</li>\n</ol>\n\n<p>The main factor here is deciding whether to add an edge or not. By tweaking this parameter you get more or less trees in your forest. One option is to use <a href=\"http://haddock.stackage.org/lts-5.14/QuickCheck-2.8.1/Test-QuickCheck.html#v:frequency\" rel=\"nofollow\"><code>frequency</code></a> for that.</p>\n"}], "owner": {"reputation": 41, "user_id": 5125477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbf12abb42007cd53d25fae5c3e52015?s=128&d=identicon&r=PG&f=1", "display_name": "Fluids", "link": "https://stackoverflow.com/users/5125477/fluids"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 2, "accepted_answer_id": 36401039, "answer_count": 2, "score": 2, "last_activity_date": 1461782747, "creation_date": 1459760480, "last_edit_date": 1459775191, "question_id": 36398392, "link": "https://stackoverflow.com/questions/36398392/arbitrary-instance-for-generating-unbiased-graphs-for-quickcheck", "title": "Arbitrary instance for generating unbiased graphs for quickcheck", "body": "<pre><code>module Main where\n\nimport Test.QuickCheck\nimport Data.Set as Set    \n\ndata Edge v = Edge {source :: v, target :: v}\n                  deriving (Show,Eq,Ord)\n\ndata Graph v = Graph {nodes :: Set v, edges :: Set (Edge v)}\n               deriving Show\n\ninstance Arbitrary v =&gt; Int-&gt; Arbitrary (Edge v) where\n    arbitrary = sized aux \n        where aux n = do s &lt;- arbitrary\n                         t &lt;- arbitrary `suchThat` (/= s)\n                         return $ Edge {source = s, target = t}\n\n\ninstance (Ord v, Arbitrary v) =&gt; Arbitrary (Graph v) where\n    arbitrary = aux `suchThat` isValid\n        where aux = do ns &lt;- arbitrary \n                       es &lt;- arbitrary \n                       return $ Graph {nodes = fromList ns, edges = fromList es}\n</code></pre>\n\n<p>This current definition of the instance is generating graphs with few edges, how do I alter it so it's less biased and it satisfies these two functions? :</p>\n\n<p>-- | The function 'isDAG' tests if the graph is acyclic.</p>\n\n<pre><code>isDAG :: Ord v =&gt; Graph v -&gt; Bool\nisDAG g = isValid g &amp;&amp; all nocycle (nodes g)\n    where nocycle v = all (\\a -&gt; v `notMember` reachable g a) $ Set.map target (adj g v)\n</code></pre>\n\n<p>-- | The function 'isForest' tests if a valid DAG is a florest (a set of trees), in other words,\n-- if every node(vertex) has a maximum of one adjacent.</p>\n\n<pre><code>isForest :: Ord v =&gt; DAG v -&gt; Bool\nisForest g = isDAG g &amp;&amp; all (\\v -&gt; length (adj g v) &lt;= 1) (nodes g)\n</code></pre>\n"}, {"tags": ["haskell", "linked-list", "monads", "verification"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1459788373, "post_id": 36396622, "comment_id": 60432604, "body": "<code>Fail String</code> should not be part of the <code>LinkedList a</code> type. It represents a failure to create a valid value, not a value itself."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4424299"}, "edited": false, "score": 0, "creation_date": 1459757418, "post_id": 36397317, "comment_id": 60411577, "body": "Aha, thank you! I totally forgot about the monad laws. What about my other functions? I think it would be better to let them return a LinkedList as well?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1459758730, "post_id": 36397317, "comment_id": 60412294, "body": "I think <code>Null</code> and <code>Fail String</code> can be converged into a single constructor. Also using <code>error</code> in the code isn&#39;t usually a good practice. Try modelling the error variant using <code>Maybe</code> or <code>Either</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459762120, "post_id": 36397317, "comment_id": 60414364, "body": "People often play fast and loose with the monad laws and say that the laws hold up to <i>some</i> equality, not necessarily definitional equality. I think a sensible notion of equality could simply consider all failing cases to be equal."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 4, "last_activity_date": 1459756806, "creation_date": 1459756806, "answer_id": 36397317, "question_id": 36396622, "link": "https://stackoverflow.com/questions/36396622/verification-of-linkedlist-monad-in-haskell/36397317#36397317", "title": "Verification of LinkedList Monad in Haskell", "body": "<p>You have to verify the monad laws to see if you are on the right track. Let's start with the left identity law:</p>\n\n<pre><code>return a &gt;&gt;= f = f a\n</code></pre>\n\n<p>Let's take <code>f</code> function as:</p>\n\n<pre><code>testFun :: Int -&gt; LinkedList Int\ntestFun x = Success (x + 2, Fail \"hello\")\n</code></pre>\n\n<p>Let's compute <code>return 3 &gt;&gt;= testFun</code>:</p>\n\n<pre><code>return 3 = Success (3, Null)\nreturn 3 &gt;&gt;= testFun = Success (5, Null)\n</code></pre>\n\n<p>Let's compute <code>testFun 3</code>:</p>\n\n<pre><code>testFun 3 = Success (5, Fail \"hello\")\n</code></pre>\n\n<p><code>Success (5, Null)</code> is not equal to <code>Success (5, Fail \"hello\")</code>.</p>\n\n<p>So it isn't a proper monad.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4424299"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 1, "accepted_answer_id": 36397317, "answer_count": 1, "score": 1, "last_activity_date": 1459756806, "creation_date": 1459754273, "question_id": 36396622, "link": "https://stackoverflow.com/questions/36396622/verification-of-linkedlist-monad-in-haskell", "title": "Verification of LinkedList Monad in Haskell", "body": "<p>I'm still learning Haskell and at the moment I'm practicing monads. Now, I defined a LinkedList monad in Haskell and implemented it, but I'm not completely sure if I'm on the right track. The reason that I'm not certain is the fact that I'm not making use of the bind or unit functions in the other functions (such as add or getFirstItem).</p>\n\n<p>This is my code so far:</p>\n\n<pre><code>module LinkedList where\n\nimport Control.Applicative\nimport Control.Monad (ap)\n\ndata LinkedList a = Success (a, LinkedList a) | Null | Fail String\n\ninstance (Show a) =&gt; Show (LinkedList a) where\n    show (Success (x, previous)) = (show x) ++ \" ~ \" ++ (show previous)\n    show (Fail s) = \"An error occured \" ++ s\n    show Null = \"END\"\n\ninstance Functor LinkedList where\n    fmap f (Success (x, y)) = Success (f x, fmap f y)\n    fmap f Null = Null\n    fmap f (Fail s) = Fail s\n\ninstance Applicative LinkedList where\n    pure  = return\n    (&lt;*&gt;) = ap\n\ninstance Monad LinkedList where\n    return x = Success (x, Null)\n    (Success (x, xs)) &gt;&gt;= f = Success (getFirstItem (f x), xs &gt;&gt;= f)\n    (Fail s) &gt;&gt;= f = Fail s\n    Null &gt;&gt;= f = Null\n\n-- Get the first element from the LinkedList\ngetFirstItem :: LinkedList a -&gt; a\ngetFirstItem (Success (x, xs)) = x\ngetFirstItem Null = error \"Cannot take first element of empty list\"\ngetFirstItem (Fail s) = error (show s)\n\n-- Get the nth element from the LinkedList\ngetItem :: LinkedList a -&gt; Integer -&gt; a\ngetItem (Success (x, xs)) n = if n == 0 then x else getItem xs (n - 1)\ngetItem (Fail s) _ = error (show s)\ngetItem Null _ = error \"LinkedList out of bounds\"\n\n-- Add a single element to the LinkedList\nadd :: LinkedList a -&gt; a -&gt; LinkedList a\nadd (Success (x, xs)) y = Success (x, (add xs y))\nadd Null y = Success (y, Null)\nadd (Fail s) _ = error (show s)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1459750461, "post_id": 36395486, "comment_id": 60407891, "body": "Could you give us a minimal &quot;working&quot; example i.e. cabal file and stack.yaml. it is not clear to me that/how the second function is ever called at all. Do you have two executables or one."}, {"owner": {"reputation": 117, "user_id": 6128623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e1407a7a8512763aa48a722c864f66c?s=128&d=identicon&r=PG&f=1", "display_name": "Judi", "link": "https://stackoverflow.com/users/6128623/judi"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1459750543, "post_id": 36395486, "comment_id": 60407929, "body": "@epsilonhalbe, one exec. it&#39;s called from <code>myFMain</code>."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 6128623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e1407a7a8512763aa48a722c864f66c?s=128&d=identicon&r=PG&f=1", "display_name": "Judi", "link": "https://stackoverflow.com/users/6128623/judi"}, "edited": false, "score": 0, "creation_date": 1459750934, "post_id": 36395668, "comment_id": 60408124, "body": "<code>Couldn&#39;t match expected type \u2018IO a0\u2019                 with actual type \u2018m0 a10 -&gt; m0 r0\u2019 </code> without &quot;read&quot;"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 117, "user_id": 6128623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e1407a7a8512763aa48a722c864f66c?s=128&d=identicon&r=PG&f=1", "display_name": "Judi", "link": "https://stackoverflow.com/users/6128623/judi"}, "edited": false, "score": 0, "creation_date": 1459751390, "post_id": 36395668, "comment_id": 60408339, "body": "You don&#39;t need <code>liftM</code> there too. Just <code>env &lt;- getEnv &quot;ENV&quot;</code>."}, {"owner": {"reputation": 117, "user_id": 6128623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e1407a7a8512763aa48a722c864f66c?s=128&d=identicon&r=PG&f=1", "display_name": "Judi", "link": "https://stackoverflow.com/users/6128623/judi"}, "edited": false, "score": 0, "creation_date": 1459770347, "post_id": 36395668, "comment_id": 60419821, "body": "why do I need liftM in <code>port &lt;- liftM read $ getEnv &quot;PORT</code> then?"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 117, "user_id": 6128623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e1407a7a8512763aa48a722c864f66c?s=128&d=identicon&r=PG&f=1", "display_name": "Judi", "link": "https://stackoverflow.com/users/6128623/judi"}, "edited": false, "score": 0, "creation_date": 1459771205, "post_id": 36395668, "comment_id": 60420381, "body": "Because <code>getEnv</code> has type <code>IO String</code> and <code>read</code> operates on <code>String</code>. With <code>liftM</code> you make <code>read</code> operate on <code>IO String</code> at the cost of returning <code>IO a</code>. Alternative way to write this: <code>env0 &lt;- getEnv &quot;PORT&quot;; let env = read env0</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461341715, "post_id": 36395668, "comment_id": 61171544, "body": "Presumably, <code>run</code> takes an <code>Int</code> as its first argument. In order to convert an <code>IO String</code> value to an <code>Int</code>, you first need to convert it to <code>IO Int</code>, which is what <code>liftM read</code> does."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 5, "last_activity_date": 1459750510, "creation_date": 1459750510, "answer_id": 36395668, "question_id": 36395486, "link": "https://stackoverflow.com/questions/36395486/unable-to-parse-environment-variable-in-another-module/36395668#36395668", "title": "Unable to parse environment variable in another module", "body": "<p><code>getEnv</code> returns <code>IO String</code>, why do you call <code>read</code> on its result? You can use it right away.</p>\n\n<p>If you really want this, execute <code>show \"asd\"</code> and look what string should look like to be correctly parsed by <code>read</code>.</p>\n"}], "owner": {"reputation": 117, "user_id": 6128623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e1407a7a8512763aa48a722c864f66c?s=128&d=identicon&r=PG&f=1", "display_name": "Judi", "link": "https://stackoverflow.com/users/6128623/judi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 36395668, "answer_count": 1, "score": 0, "last_activity_date": 1459750510, "creation_date": 1459749681, "last_edit_date": 1459750184, "question_id": 36395486, "link": "https://stackoverflow.com/questions/36395486/unable-to-parse-environment-variable-in-another-module", "title": "Unable to parse environment variable in another module", "body": "<p>I have 2 modules and each of them I read environment variables.  In the main module it's being read correctly and in another one not:</p>\n\n<pre><code>--Main module\n\nimport Module2\nstartApp :: IO ()\nstartApp = do\n  port &lt;- liftM read $ getEnv \"PORT\" -- ok\n  print $ \"Listening the port \" ++ (show port) ++ \"...\" -- ok\n  run port app\n\n\n-- it's not called immediately\nmyFMain = do\n  Module2.myF \n  --.........\n\n\n\n--Module2\n----...........\n\nmyF :: IO MyData\nmyF = do\n  env &lt;- liftM read $ getEnv \"ENV\" :: IO String\n  print $ \"ENV is \" ++ (show env) -- error Prelude.read: no parse\n  --.........\n</code></pre>\n\n<p>I run it as <code>PORT=3344 ENV=development stack exec my-app-exe</code>. Might it be because it's not in the main module and it's thus loaded when I first call it? It's called when a user requests a url.</p>\n"}, {"tags": ["haskell", "type-conversion"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1459738613, "post_id": 36393905, "comment_id": 60404510, "body": "Converting from <code>Int -&gt; Int -&gt; Int</code> to <code>Integer -&gt; Integer -&gt; Integer</code> isn\u2019t safe in general because it means someone can pass an argument to the new function that\u2019s out of the range of <code>Int</code>."}, {"owner": {"reputation": 83, "user_id": 3595342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6d182ac9d85c70e89b285e5a9b412f26?s=128&d=identicon&r=PG&f=1", "display_name": "user3595342", "link": "https://stackoverflow.com/users/3595342/user3595342"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1459739098, "post_id": 36393905, "comment_id": 60404608, "body": "But lets say if I only want to convert and do not care about being &quot;safe&quot;. Is there a method for such conversion"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1459739243, "post_id": 36393905, "comment_id": 60404640, "body": "<code>\\f x y -&gt; fromIntegral (fromIntegral x `f` fromIntegral y)</code>"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1459739457, "post_id": 36393905, "comment_id": 60404691, "body": "No, there isn\u2019t. (Unless you\u2019re okay with defining what all the \u201ccorrect\u201d conversions are and enabling a bunch of extensions. Then there might be a way. [And there <i>is</i> something straightforward and still unpleasant in that vein with Template Haskell.] But seriously, just write it out instead.)"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1459748212, "post_id": 36393905, "comment_id": 60407018, "body": "@RyanO&#39;Hara I think you have that backwards. <code>Int</code> is fixed (machine word size) precision and <code>Integer</code> is arbitrary precision. Also, even converting the other direction, you don&#39;t need to do anything fancy like that. You just need to use <code>fromIntegral</code>, which is a part of the standard Prelude (nothing needs to be imported for that, let alone needing extensions and definitely not Template Haskell)."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1459748554, "post_id": 36393905, "comment_id": 60407152, "body": "Additionally, if you want more safety, you could just use write a small wrapper around <code>fromIntegral</code> using <code>Maybe</code> or <code>Either</code>, which is a pretty standard Haskell technique for dealing with that sort of situation (when you do need that extra bit of added safety)."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1459751078, "post_id": 36393905, "comment_id": 60408187, "body": "@DavidYoung: Original function accepts <code>Int</code>. Converted function accepts <code>Integer</code>. Pass <code>1000000000000000000000</code> and\u2026? You can safely use <code>fromIntegral</code> on the result, but I wrote \u201cpass an argument\u201d."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1459810035, "post_id": 36393905, "comment_id": 60443923, "body": "@RyanO&#39;Hara Ahh, that&#39;s a good point. However, there is nothing tricky about implementing the unsafe version of this conversion. Unless I misunderstood, it sounds like you were saying that you needed to do some advanced things on the level of Template Haskell in order to perform the conversion."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1459842743, "post_id": 36393905, "comment_id": 60455095, "body": "@DavidYoung: If I had to make a generic way to take functions <code>a -&gt; b -&gt; c -&gt; \u2026 -&gt; x</code> and turn them into <code>a&#39; -&gt; b&#39; -&gt; c&#39; -&gt; \u2026 -&gt; x&#39;</code> based on predefined <code>a -&gt; a&#39;, \u2026, x -&gt; x&#39;</code> conversion functions, I would probably start by trying Template Haskell. There might be other extensions that would work too. For a specific case, of course you can just convert everything individually, though."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 3595342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6d182ac9d85c70e89b285e5a9b412f26?s=128&d=identicon&r=PG&f=1", "display_name": "user3595342", "link": "https://stackoverflow.com/users/3595342/user3595342"}, "edited": false, "score": 0, "creation_date": 1459739781, "post_id": 36393979, "comment_id": 60404762, "body": "I look at the link, and the conversion basically require us to know the functions before hand. What if the inputfunc is a blackbox function we don&#39;t know, can we still convert such a function?"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 83, "user_id": 3595342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6d182ac9d85c70e89b285e5a9b412f26?s=128&d=identicon&r=PG&f=1", "display_name": "user3595342", "link": "https://stackoverflow.com/users/3595342/user3595342"}, "edited": false, "score": 1, "creation_date": 1459741897, "post_id": 36393979, "comment_id": 60405169, "body": "@user3595342 rewrite <code>myfunc</code> as a function of three arguments. Create arguments to supply the inputfunc, and then process it&#39;s output."}], "tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": false, "score": 2, "last_activity_date": 1459739258, "creation_date": 1459739258, "answer_id": 36393979, "question_id": 36393905, "link": "https://stackoverflow.com/questions/36393905/is-there-a-way-to-convert-function-type-in-haskell/36393979#36393979", "title": "Is there a way to convert function type in haskell?", "body": "<p>Hints:</p>\n\n<ul>\n<li><p><code>(Int -&gt; Int -&gt; Int) -&gt; (Integer -&gt; Integer -&gt; Integer)</code> can also be written <code>(Int -&gt; Int -&gt; Int) -&gt; Integer -&gt; Integer -&gt; Integer</code>. It is a function of three arguments.</p></li>\n<li><p><a href=\"https://wiki.haskell.org/Converting_numbers#Converting_from_and_between_integral_types_.28integer-like_types.29\" rel=\"nofollow\">Converting Numbers</a></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "is_accepted": true, "score": 2, "last_activity_date": 1459812291, "creation_date": 1459812291, "answer_id": 36414594, "question_id": 36393905, "link": "https://stackoverflow.com/questions/36393905/is-there-a-way-to-convert-function-type-in-haskell/36414594#36414594", "title": "Is there a way to convert function type in haskell?", "body": "<p>As already explained by others, what you want is basically this:</p>\n\n<pre><code>convert f x y = fromIntegral (f (fromIntegral x) (fromIntegral y))\n</code></pre>\n\n<p>This is pretty straightforward. However, if I were to do it, I'd take advantage of the <code>on</code> function from <code>Data.Function</code>, which converts the inputs of functions that take two arguments before applying it. So, in your example, it would look like this:</p>\n\n<pre><code>convert f x y = fromIntegral ((f `on` fromIntegral) x y)\n</code></pre>\n\n<p>I, personally, would go one step further and make this function point-free, but because <code>on f fromIntegral</code> expects two arguments, you can't just use <code>(.)</code>, so I usually define an operator for this:</p>\n\n<pre><code>(.:) = (.) . (.)\n</code></pre>\n\n<p>You can figure out why this works on your own if you'd like, but now I can define convert as this:</p>\n\n<pre><code>convert f = fromIntegral .: (f `on` fromIntegral)\n</code></pre>\n\n<p>I feel that this is a lot more readable, but I am biased because I have been coding Haskell like this for a while now.</p>\n\n<p>Also, if you look at the inferred type of this variable, you'd see that it's much more general than what you wanted:</p>\n\n<pre><code> convert :: (Integral a, Integral a1, Num b, Num b1) = (b1 -&gt; b1 -&gt; a) -&gt; a1 -&gt; a1 -&gt; b\n</code></pre>\n\n<p>Anyway, I hope this is somewhat useful. </p>\n\n<p>I really don't mean for this post to intimidate you as a newcomer, so if any of it confuses you, please ask me questions and I'd happily answer :)</p>\n"}], "owner": {"reputation": 83, "user_id": 3595342, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6d182ac9d85c70e89b285e5a9b412f26?s=128&d=identicon&r=PG&f=1", "display_name": "user3595342", "link": "https://stackoverflow.com/users/3595342/user3595342"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 602, "favorite_count": 0, "accepted_answer_id": 36414594, "answer_count": 2, "score": 1, "last_activity_date": 1459812291, "creation_date": 1459738508, "question_id": 36393905, "link": "https://stackoverflow.com/questions/36393905/is-there-a-way-to-convert-function-type-in-haskell", "title": "Is there a way to convert function type in haskell?", "body": "<p>I am fairly new to haskell and I run into this problem with type converting a function. Let's say I don't know anything about a function other than its function type. Is it possible to convert its function type and put it as a new function.\nFor example</p>\n\n<pre><code>myfunc:: (Int -&gt; Int -&gt; Int) -&gt; (Integer -&gt; Integer -&gt; Integer)\nmyfunc inputfunc = (function with type (Integer -&gt; Integer -&gt; Integer))\n</code></pre>\n\n<p>Are there ways to do such a thing?</p>\n"}, {"tags": ["haskell", "servant"], "answers": [{"tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": false, "score": 7, "last_activity_date": 1459740575, "last_edit_date": 1459740575, "creation_date": 1459738524, "answer_id": 36393906, "question_id": 36393834, "link": "https://stackoverflow.com/questions/36393834/types-mismatch-should-i-necessarily-use-liftio/36393906#36393906", "title": "Types mismatch, should I necessarily use liftIO?", "body": "<p>I think you won't be able to avoid it.  Everthing in a do-block must be in the same monad, so with the initial </p>\n\n<pre><code> del :: Int -&gt; ExceptT ServantErr IO ()\n del myId = liftIO $ do ...\n</code></pre>\n\n<p>every line must be in <code>IO</code>. But you can rearrange things in various ways, e.g. with a subordinate IO block, where some things come together:</p>\n\n<pre><code> del myId = do\n   a &lt;- liftIO $ do \n     cn &lt;- getConnection\n     execute cn \"delete from table1 where id = ?\" [myId]\n   case a of\n     1 -&gt; return ()\n     _ -&gt; throwE err503\n</code></pre>\n\n<p>or, with <code>Control.Monad.unless</code>, say:</p>\n\n<pre><code>del myId = do\n  a &lt;- liftIO $ do \n     cn &lt;- getConnection\n     execute cn \"delete from table1 where id = ?\" [myId]\n  unless (a == 1) $ throwE err503\n</code></pre>\n\n<p>and any number of other ways. You don't say which <code>getConnection</code> and <code>execute</code> you are using, but are you sure they are not already <code>MonadIO m =&gt; m ..</code>? In which case you can drop the <code>liftIO</code> after all?</p>\n"}], "owner": {"reputation": 21726, "user_id": 1708058, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4a0b611077fcb9f7ede011fdc46e4d4c?s=128&d=identicon&r=PG", "display_name": "Alan Coromano", "link": "https://stackoverflow.com/users/1708058/alan-coromano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459740575, "creation_date": 1459737838, "question_id": 36393834, "link": "https://stackoverflow.com/questions/36393834/types-mismatch-should-i-necessarily-use-liftio", "title": "Types mismatch, should I necessarily use liftIO?", "body": "<p>I want to perform a delete operation in Servant and return an error or (). Here's my code:</p>\n\n<pre><code>del :: Int -&gt; ExceptT ServantErr IO ()\ndel myId = liftIO $ do\n  cn &lt;- getConnection\n  a &lt;- execute cn \"delete from table1 where id = ?\" [myId]\n  case a of\n    1 -&gt; return ()\n    _ -&gt; throwE err503 --compile error\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>  Couldn't match expected type \u2018IO ()\u2019\n                with actual type \u2018ExceptT ServantErr m0 a0\u2019\n    In the expression: throwE err503\n    In a case alternative: _ -&gt; throwE err503\n</code></pre>\n\n<p>I'd prefer not to use liftIO before each expression if possible:</p>\n\n<pre><code>del myId =  do\n  cn &lt;- liftIO getConnection\n  a &lt;- liftIO $ execute cn \"delete from table1 where id = ?\" [myId]\n  case a of\n    1 -&gt; return ()\n    _ -&gt; throwE err503\n</code></pre>\n\n<p>How can I return an error then?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 1, "creation_date": 1459740882, "post_id": 36393745, "comment_id": 60404957, "body": "When I post an empty ByteString, I <i>do</i> see a Content-Length: 0. I&#39;m using wreq-0.4.1.0 if that helps. <a href=\"https://gist.github.com/hlian/c403ed77d4011c749011bbb76e07d1a7\" rel=\"nofollow noreferrer\">gist.github.com/hlian/c403ed77d4011c749011bbb76e07d1a7</a>"}, {"owner": {"reputation": 365, "user_id": 1560138, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/370b89d2b931def9f3df67326283b295?s=128&d=identicon&r=PG", "display_name": "tmortiboy", "link": "https://stackoverflow.com/users/1560138/tmortiboy"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1459752023, "post_id": 36393745, "comment_id": 60408634, "body": "@haoformayor you are right. I can even see the header in fiddler. Its a problem with the service I am using, not with Wreq."}], "owner": {"reputation": 365, "user_id": 1560138, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/370b89d2b931def9f3df67326283b295?s=128&d=identicon&r=PG", "display_name": "tmortiboy", "link": "https://stackoverflow.com/users/1560138/tmortiboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1459737098, "creation_date": 1459737098, "question_id": 36393745, "link": "https://stackoverflow.com/questions/36393745/haskell-using-network-wreq-to-post-header-with-content-length-0", "title": "Haskell: Using Network.Wreq to POST header with Content-Length: 0", "body": "<p>I am consuming an API that has an endpoint of <code>/{id}/delete</code> that method type is POST, but requires an empty body, and so requires the header <code>Content-Length: 0</code> to be set.</p>\n\n<p>I am using <a href=\"https://hackage.haskell.org/package/wreq-0.4.1.0/docs/Network-Wreq-Session.html#v:postWith\" rel=\"nofollow\">Newtork.Wreq.Session.postWith</a> to send my request, but if I use an empty body, no body or content length header is included.</p>\n\n<p>If I try to manually add the header using <code>&amp; header \"Content-Length\" .~ [\"0\"]</code>, this is not included in the request.</p>\n\n<p>Is there a way to get Wreq to add this header for an empty body?</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1459736615, "post_id": 36393571, "comment_id": 60404147, "body": "This gives &quot;Conflicting family instance declarations&quot; for <code>Yeah</code> on GHC 7.10.3."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459736692, "post_id": 36393571, "comment_id": 60404157, "body": "@user2407038, interesting! I tested it under 7.8.3. I shall have to see whether I can patch this up to work on 7.10.3."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 5, "last_activity_date": 1459741225, "last_edit_date": 1459741225, "creation_date": 1459735477, "answer_id": 36393571, "question_id": 36393570, "link": "https://stackoverflow.com/questions/36393570/is-it-safe-to-postulate-unit-types-are-equal/36393571#36393571", "title": "Is it safe to postulate unit types are equal?", "body": "<p>This is unsafe under GHC 7.8.3 (see code below). As user2407038 remarks, the following is rejected by GHC 7.10.3. Unsurprisingly, this data family is evil enough that the type checker was changed to prohibit it. I'm still trying to see if there's a way to make this happen under 7.10.3.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE DataKinds #-}\n\nmodule UnitsEqual where\nimport Unsafe.Coerce\nimport Data.Type.Equality\n\ndata family Yeah (a :: ()) b c\ndata instance Yeah '() b c = Yeah { yeah :: b }\ndata instance Yeah a b c = Nope c\n\n-- Entirely valid\ncastYeah :: x :~: y -&gt; Yeah x p q -&gt; Yeah y p q\ncastYeah Refl x = x\n\n-- Bad postulate\nunitsEqual :: (x :: ()) :~: (y :: ())\nunitsEqual = unsafeCoerce (Refl :: '() :~: '())\n\n-- Oh no! This doesn't actually cast, but\n-- it's horrible enough. It consistently produces\n-- either segmentation faults or nonsense,\n-- whether the types are the same or not.\nuc :: a -&gt; b\nuc a = yeah $ castYeah unitsEqual (Nope a)\n</code></pre>\n\n<p><strike>I <em>believe</em>, however, that it <em>is</em> safe to postulate</p>\n\n<pre><code>voidsEqual :: (a :: Void) :~: (b :: Void)\n</code></pre>\n\n<p>because there's no apparent way to distinguish any of the stuck/bogus types inhabiting <code>Void</code>.</strike></p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1459740931, "post_id": 36393920, "comment_id": 60404962, "body": "<code>Any</code> is not a special case (any more). It&#39;s now defined as <code>type family Any :: k where {}</code>. It&#39;s a &quot;stuck type family&quot;."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1459761511, "post_id": 36393920, "comment_id": 60414001, "body": "I assume that is of GHC 8.0 or the like? It doesn&#39;t seem to even be valid syntax with 7.10.3."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1459762071, "post_id": 36393920, "comment_id": 60414331, "body": "I guess so. You can get all the same features with an open type family if you just never make any instances."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 1, "last_activity_date": 1459738693, "creation_date": 1459738693, "answer_id": 36393920, "question_id": 36393570, "link": "https://stackoverflow.com/questions/36393570/is-it-safe-to-postulate-unit-types-are-equal/36393920#36393920", "title": "Is it safe to postulate unit types are equal?", "body": "<p>Disclaimer: this answer is mainly guesswork, because this behaviour really confused me and I still am not too sure of exactly the semantics of <code>Any</code> in the typechecker. </p>\n\n<p>In your example, disregarding that <code>Yeah</code> should probably be rejected, when it computes the type of <code>Nope a</code> it finds an ambiguous type variable and instantiates it to <code>Any</code>. This is the same mechanism that makes e.g. <code>length []</code> work. </p>\n\n<p>You can do the same with a GADT, which is accepted on GHC 7.10: </p>\n\n<pre><code>data Yeah (a :: ()) b c where \n  Yeah :: b -&gt; Yeah '() b c \n  Nope :: c -&gt; Yeah Any b c\n</code></pre>\n\n<p>To write <code>uc</code> you need a function </p>\n\n<pre><code>yeah :: Yeah '() b c -&gt; b \nyeah (Yeah a) = a \nyeah (Nope _) = error \"???\" \n</code></pre>\n\n<p>In the second case, the equality <code>'() ~ Any</code> is given, which I assumed was trivially false, as are e.g. <code>'True ~ 'False</code>, <code>Int ~ Bool</code>, etc. The typechecker knows these facts:</p>\n\n<pre><code>okay :: 'True :~: 'False -&gt; x\n-- okay Refl = error \"???\" -- Compiler rejects this case\nokay x = case x of \n</code></pre>\n\n<p>but not this one!</p>\n\n<pre><code>really :: Any :~: '() -&gt; x\nreally Refl = error \"???\" -- Perfectly valid pattern match\n</code></pre>\n\n<p>You can't actually call this function:</p>\n\n<pre><code>&gt;:t really Refl\n\n&lt;interactive&gt;:1:8: Warning:\n    Couldn't match type `Any' with '()\n    Expected type: Any :~: '()\n      Actual type: '() :~: '()\n    In the first argument of `really', namely `Refl'\n    In the expression: really Refl\n</code></pre>\n\n<p>and while <code>uc</code> typechecks (definition unchanged) it no longer breaks:</p>\n\n<pre><code>&gt;uc 'a' :: Int\n*** Exception: ???\n</code></pre>\n\n<p>It would seem that the typechecker does not believe that <code>'() :~: Any</code> is uninhabited, because it isn't, because the typechecker is internally allowed to produce such a proof, but the user is still barred from writing it themselves. </p>\n\n<p>All this to say: I think if you pretend <code>Any</code> does not exist, then <code>unitsEqual</code> is sound, and the unsoundness arises from the existence of <code>Any</code>. It would seem to be explicitly false by counterexample - <code>Any :~: '()</code> - but it seems there is a special typechecker rule for <code>Any</code> that says <code>x ~ y</code> is trivially false only if <code>x</code> and <code>y</code> are different types and neither <code>x</code> or <code>y</code> is <code>Any</code>. </p>\n\n<p><code>voidEqual</code> is equally unsound because <code>Any :: Void</code>, <code>Any Any :: Void</code>, <code>Any Any Any :: Void</code>, etc.</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1459741225, "creation_date": 1459735477, "question_id": 36393570, "link": "https://stackoverflow.com/questions/36393570/is-it-safe-to-postulate-unit-types-are-equal", "title": "Is it safe to postulate unit types are equal?", "body": "<p>Is it safe to postulate that all types of kind <code>()</code> are the same? That is, can the following be used to break type safety?</p>\n\n<pre><code>-- Bad postulate\nunitsEqual :: (x :: ()) :~: (y :: ())\nunitsEqual = unsafeCoerce (Refl :: '() :~: '())\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "is_accepted": true, "score": 2, "last_activity_date": 1459735796, "last_edit_date": 1459735796, "creation_date": 1459731709, "answer_id": 36393155, "question_id": 36393010, "link": "https://stackoverflow.com/questions/36393010/haskell-working-on-char-list/36393155#36393155", "title": "Haskell working on char list", "body": "<p>There are several issues in your original code, as listed in the bottom.</p>\n\n<p>I tried to fix the <strong>grammar</strong> and got something that compiles, not sure if the behavior is correct or what you need:</p>\n\n<pre><code>vert = ['m', 'n', 'o', 'p', 'q']\nfind2 :: Char -&gt; [Char] -&gt; [Char]\nfind2 ch (x:xs) = if x == ch then (x:xs) else find2 ch xs\n\ndiagonals = foldl (\\acc x -&gt; acc ++ \n                              foldl (\\ acc2 y -&gt; acc2 ++ [x] ++ [y]) [] \n                                (if x == (head vert) \n                                    then (init (tail (find2 x vert)))\n                                    else (tail (find2 x vert))) )\n        [] vert \n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>*Main&gt; diagonals\n\"mnmompnonpnqopoqpq\"\n</code></pre>\n\n<p>Not sure if the logic is correct, and maybe you need to inspect it further.</p>\n\n<p>The issues with the original code are:</p>\n\n<p>First, I think there is a missing <code>)</code> in the line <code>foldl (\\ acc2 y -&gt; acc2 ++ (x:y)</code>.</p>\n\n<p>Second, I think you need to put the <code>if</code> expression in a parenthesis.</p>\n\n<p>Third, the type of your <code>foldl</code> (e.g. the 2nd one) and the type of <code>tail (find2 x vert)))</code> do not match. You need to modify the definition of the <code>foldl</code> to at least make sure the type is correct.</p>\n\n<p>Forth, the variable <code>vertiges</code> is undefined.</p>\n\n<p>-- Edit --</p>\n\n<p>To obtain the actual diagonals, a quick and dirty way (not necessarily most efficient) is to use list comprehension to construct edges and filter out those whose vertices are neighbors to each other, i.e. those with vertex distance (<code>dist</code>) being 1 or n-1. A sample code is as follows:</p>\n\n<pre><code>import Data.List\nimport Data.Maybe\n\ndist a b vert = abs( fromJust(elemIndex a vert) - fromJust(elemIndex b vert)) `mod` length vert\n\ndiagonals' = [(a,b) | a &lt;- vert, b &lt;- vert, a &lt; b, \n     dist a b vert /= 1, dist a b vert /= length vert -1]\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>*Main&gt; diagonals'\n[('m','o'),('m','p'),('n','p'),('n','q'),('o','q')]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 3, "last_activity_date": 1459735720, "creation_date": 1459735720, "answer_id": 36393592, "question_id": 36393010, "link": "https://stackoverflow.com/questions/36393010/haskell-working-on-char-list/36393592#36393592", "title": "Haskell working on char list", "body": "<p>You can define diagonals as the difference between all edges and sides, which both will be easier to generate</p>\n\n<p>for example</p>\n\n<pre><code>edges :: [a] -&gt; [(a,a)]                                \nedges [] = []                      \nedges [x] = []\nedges (x:xs) = (map ((,) x) xs) ++ edges xs\n</code></pre>\n\n<p>and </p>\n\n<pre><code>sides :: [a] -&gt; [(a,a)] \nsides [] = []\nsides [x] = []\nsides (x:xs) = zip (x:x:init xs) (last xs:xs)\n</code></pre>\n\n<p>now</p>\n\n<pre><code>import Data.List((\\\\))\ndiagonals x = edges x \\\\ sides x\n</code></pre>\n\n<p>a triangle shouldn't have any diagonals</p>\n\n<pre><code>&gt; diagonals [1..3]\n[]\n\n&gt; diagonals [1..4]\n[(1,3),(2,4)]\n\n&gt; diagonals vert\n[('m','o'),('m','p'),('n','p'),('n','q'),('o','q')]\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 36393155, "answer_count": 2, "score": 2, "last_activity_date": 1459735796, "creation_date": 1459730398, "last_edit_date": 1459732178, "question_id": 36393010, "link": "https://stackoverflow.com/questions/36393010/haskell-working-on-char-list", "title": "Haskell working on char list", "body": "<p>I am new to Haskell and I have a polygon represented as a list of vertices</p>\n\n<pre><code>vert = ['m', 'n', 'o', 'p', 'q']\n</code></pre>\n\n<p>and I want to return all the diagonals. The result should be </p>\n\n<pre><code>[(m, o), (m, p), (n, p), (n, q), (o, q)]\n</code></pre>\n\n<p>I have the below code but I got an error <code>parse error on input if</code> and even though I would put only <code>(tail (find2 x vert))</code> I got a lot of other errors.</p>\n\n<pre><code>vert = ['m', 'n', 'o', 'p', 'q']\nfind2 :: Char -&gt; [Char] -&gt; [Char]\nfind2 ch (x:xs) = if x == ch then (x:xs) else find2 ch xs\n\ndiagonals = foldl (\\acc x -&gt; acc ++ \n                                foldl (\\ acc2 y -&gt; acc2 ++ (x:y) \n                                [] \n                                if x == (head vert) \n                                    then (init (tail (find2 x vert)))\n                                    else (tail (find2 x vert)))\n        [] vert\n</code></pre>\n\n<p>The find2 function returns the sublist of a list starting from a character.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1821, "user_id": 2391244, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DyC7o.jpg?s=128&g=1", "display_name": "BalinKingOfMoria Reinstate CMs", "link": "https://stackoverflow.com/users/2391244/balinkingofmoria-reinstate-cms"}, "edited": false, "score": 1, "creation_date": 1459729717, "post_id": 36392926, "comment_id": 60402592, "body": "Just to confirm, the OP&#39;s problem is that they&#39;re basically trying to define <code>main</code> inside the <code>do</code> block."}], "tags": [], "owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "is_accepted": false, "score": 2, "last_activity_date": 1459729482, "creation_date": 1459729482, "answer_id": 36392926, "question_id": 36392726, "link": "https://stackoverflow.com/questions/36392726/parse-error-on-input-haskell-error/36392926#36392926", "title": "Parse error on input &quot;=&quot; haskell error", "body": "<p>Although this fact is not as advertised as in the case of, say, Python, Haskell does have <a href=\"https://en.wikibooks.org/wiki/Haskell/Indentation\" rel=\"nofollow\">syntactically significant indentation</a>. In your case the code in the bodies of <code>do</code>s must be indented:</p>\n\n<pre><code>stories = do\n    let str0 = \"There once was \"\n    str1 &lt;- [\"a princess \", \"a cat \", \"a little boy \"]\n    let str2 = \"who lived in \"\n    return (  str0 ++ str1  )\n\nmain = do\n    let len = length stories\n    putStrLn (\"Enter a number from 0 to \" ++ show (len - 1))\n    n &lt;- readLn\n    putStrLn \"\"\n    putStrLn (stories !! n)\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 2659970, "user_type": "registered", "accept_rate": 32, "profile_image": "https://graph.facebook.com/100001336658325/picture?type=large", "display_name": "Nika Tsogiaidze", "link": "https://stackoverflow.com/users/2659970/nika-tsogiaidze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459815563, "creation_date": 1459727615, "last_edit_date": 1459815563, "question_id": 36392726, "link": "https://stackoverflow.com/questions/36392726/parse-error-on-input-haskell-error", "title": "Parse error on input &quot;=&quot; haskell error", "body": "<p>When I write only <code>main = do ...</code> block, it works perfectly. When I put only <code>stories = do...</code> block it also works. Maybe there is an indentation problem. </p>\n\n<p>Here is the code: </p>\n\n<pre><code>stories = do\nlet str0 = \"There once was \"\nstr1 &lt;- [\"a princess \", \"a cat \", \"a little boy \"]\nlet str2 = \"who lived in \"\nreturn (  str0 ++ str1  )\n\nmain = do\nlet len = length stories\nputStrLn (\"Enter a number from 0 to \" ++ show (len - 1))\nn &lt;- readLn\nputStrLn \"\"\nputStrLn (stories !! n)\n</code></pre>\n\n<p>What is wrong with it?</p>\n"}, {"tags": ["http", "haskell"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1459735070, "post_id": 36392055, "comment_id": 60403807, "body": "I know this is not what you&#39;re asking for, but if you just want to debug your server, you could do worse than just sniffing the traffic and looking at it, with e.g. <a href=\"https://www.wireshark.org/\" rel=\"nofollow noreferrer\">Wireshark</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 0, "creation_date": 1459803429, "post_id": 36397300, "comment_id": 60441113, "body": "Right, i can pattern match on the constructor and get the ByteString back! I didn&#39;t think about this at first!  Suggesting Wireshark is like a surrender. I have a data structure in my code and i don&#39;t see why i shouldn&#39;t be able to inspect it.  You mention that inspecting the request might somehow consume it. This is weird in a language like Haskell where immutability and explicit side effects are the rule"}, {"owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 0, "creation_date": 1459804177, "post_id": 36397300, "comment_id": 60441481, "body": "I involved the library author in the discussion <a href=\"https://github.com/snoyberg/http-client/issues/184\" rel=\"nofollow noreferrer\">github.com/snoyberg/http-client/issues/184</a>"}, {"owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 0, "creation_date": 1459889990, "post_id": 36397300, "comment_id": 60488616, "body": "maybe i could use a <a href=\"http://hackage.haskell.org/package/http-client-0.4.2.2/docs/Network-HTTP-Client-Internal.html#v:dummyConnection\" rel=\"nofollow noreferrer\">dummyConnection</a> with a <a href=\"http://hackage.haskell.org/package/http-client-0.4.2.2/docs/Network-HTTP-Client-Internal.html#v:requestBuilder\" rel=\"nofollow noreferrer\">requestBuilder</a>, but i am not sure how to use the <code>dummyConnection</code>"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "reply_to_user": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 1, "creation_date": 1459945487, "post_id": 36397300, "comment_id": 60514758, "body": "@danza I don&#39;t think <code>dummyConnection</code> will send the request to any remote server and <code>requestBuilder</code> will consume the request anyway. One solution may be to generate exactly the same request twice (if it&#39;s ever possible in your program) and print the <code>RequestBody</code> of one, send to server the other. You definitely won&#39;t be able to do <code>show :: RequestBody -&gt; String</code> still."}, {"owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 0, "creation_date": 1459976112, "post_id": 36397300, "comment_id": 60536164, "body": "I hoped to use <code>dummyConnection</code> in order to get a serialisation of my request without getting into the different constructors, i don&#39;t care about sending it to the server at the moment, and i have no problems with consuming it. In the end i managed to serialise it writing a partial function which extracted the strict bytestring. I found out that was the constructor in my case. Thanks a lot for your support, i was lost!"}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 3, "last_activity_date": 1459871386, "last_edit_date": 1459871386, "creation_date": 1459756720, "answer_id": 36397300, "question_id": 36392055, "link": "https://stackoverflow.com/questions/36392055/how-to-inspect-the-body-of-an-outgoing-http-request-created-with-http-client/36397300#36397300", "title": "How to inspect the body of an outgoing HTTP request created with `http-client` (Haskell)", "body": "<p><code>RequestBody</code> has five constructors.</p>\n\n<pre><code>data RequestBody\n    = RequestBodyLBS L.ByteString\n    | RequestBodyBS S.ByteString\n    | RequestBodyBuilder Int64 Builder\n    | RequestBodyStream Int64 (GivesPopper ())\n    | RequestBodyStreamChunked (GivesPopper ())\n</code></pre>\n\n<p>First two are wrappers of bytestring, the third is a <code>Blaze.ByteString.Builder</code> which can be easily converted to bytestring, the last two are functions of type <code>(IO ByteString -&gt; IO a) -&gt; IO a</code> as the type synonym showed:</p>\n\n<pre><code>type Popper = IO S.ByteString\ntype NeedsPopper a = Popper -&gt; IO a\ntype GivesPopper a = NeedsPopper a -&gt; IO a\n</code></pre>\n\n<p>feed them <code>&gt;&gt;= print</code> multiple  times and you will get the complete request body printed to console.</p>\n\n<p>You should not do this because these <code>GivesPopper ()</code> generators can only be executed once: if you extract the content beforehand then the request body will not be sent to the server. That's why they didn't provide a Show instance for <code>RequestBody</code> data type. You'd better capture the buckets containing your http request with e.g. <a href=\"https://www.wireshark.org/\" rel=\"nofollow\">Wireshark</a>.</p>\n\n<hr>\n\n<blockquote>\n  <p>I have a data structure in my code and i don't see why i shouldn't be able to inspect it. You mention that inspecting the request might somehow consume it. This is weird in a language like Haskell where immutability and explicit side effects are the rule</p>\n</blockquote>\n\n<p>That's right for most of the types in Haskell, but <code>Popper</code> is actually <code>IO S.ByteString</code>, a bytestring stream (usually) populated by a file handler, while handler in Haskell is an <code>MVar</code> which is not so different from variables in imperative languages: it may be a value or null, may be assigned and reassigned and the side effect is visible globally.</p>\n\n<p>An example from <code>Network.HTTP.Client.MultipartFormData</code>:</p>\n\n<pre><code>streamFile :: FilePath -&gt; GivesPopper ()\nstreamFile fp np =\n    withFile fp ReadMode $ np . go\n  where\n    -- go :: Handle -&gt; Popper \n    go h = BS.hGetSome h defaultChunkSize\n</code></pre>\n"}], "owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 36397300, "answer_count": 1, "score": 6, "last_activity_date": 1459871386, "creation_date": 1459722778, "last_edit_date": 1459803182, "question_id": 36392055, "link": "https://stackoverflow.com/questions/36392055/how-to-inspect-the-body-of-an-outgoing-http-request-created-with-http-client", "title": "How to inspect the body of an outgoing HTTP request created with `http-client` (Haskell)", "body": "<p>I am using Haskell to send a POST HTTP request via the <a href=\"http://hackage.haskell.org/package/http-client-0.4.2.2/docs/Network-HTTP-Client.html#t:Request\" rel=\"nofollow\"><code>http-client</code></a> package, but as a response i am getting an error from the remote server. I would like to inspect my request in order to be sure that i am sending the expected parameters in the body.</p>\n\n<p>I managed to bind my request to a variable in the Haskell interpreter, but i can't figure out how to see its body. When i use <code>requestBody</code> on my request i get a value of type <a href=\"http://hackage.haskell.org/package/http-client-0.4.2.2/docs/Network-HTTP-Client.html#t:RequestBody\" rel=\"nofollow\">RequestBody</a>, but it is not an instance of show.</p>\n\n<p>In the library i can't find any helpful function. There are just many constructors, and some functions related to a <code>Popper</code> type.</p>\n\n<p>How can i inspect that value? This seems a common use case to me, yet the library doesn't seem to support it. Am i using it wrong?</p>\n\n<h3>Edit:</h3>\n\n<p>I know what Wireshark is and how to use it, but i expect to be able to programmatically inspect what i am sending</p>\n"}, {"tags": ["haskell", "ghc", "yesod", "haskell-stack"], "comments": [{"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 2, "creation_date": 1459726518, "post_id": 36391328, "comment_id": 60401884, "body": "For what it&#39;s worth, now that you have those binaries installed <code>stack</code> will reuse them for future installs. Are you expecting to do a lot of from-scratch installing?"}], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 2, "last_activity_date": 1459749178, "creation_date": 1459749178, "answer_id": 36395380, "question_id": 36391328, "link": "https://stackoverflow.com/questions/36391328/using-precompiled-binaries-in-yesod-development/36395380#36395380", "title": "Using precompiled binaries in yesod development", "body": "<p>Take a look at <a href=\"http://www.yesodweb.com/book/deploying-your-webapp\" rel=\"nofollow\">Deploying your Webapp</a> chapter of the Yesod Web Framework Book. In short, there is a deploy manager called Keter that is integrated into <code>yesod</code> tool and can be used to deploy compiled apps.</p>\n"}], "owner": {"reputation": 10218, "user_id": 1684670, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/0de21f6ec42b67830c9308664e0abf72?s=128&d=identicon&r=PG", "display_name": "thkang", "link": "https://stackoverflow.com/users/1684670/thkang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1483477795, "creation_date": 1459718423, "last_edit_date": 1483477795, "question_id": 36391328, "link": "https://stackoverflow.com/questions/36391328/using-precompiled-binaries-in-yesod-development", "title": "Using precompiled binaries in yesod development", "body": "<p>Yesod quickstart recommends me that:</p>\n\n<pre><code>Follow the installation instructions for stack to get stack.\nCreate a new scaffolded site: stack new my-project yesod-sqlite &amp;&amp; cd my-project\n    NOTE: Use stack templates to see other available Yesod scaffoldings.\nInstall the yesod command line tool: stack install yesod-bin cabal-install --install-ghc\nBuild libraries: stack build\nLaunch devel server: stack exec -- yesod devel\nView your Yesod site at http://localhost:3000/\n</code></pre>\n\n<p>However <code>stack install ..</code> and <code>stack build</code> wants to download and compile ~200 packages and build time is unacceptable (about an hour).</p>\n\n<p>On top of that, your app itself isn't compiled until <code>stack exec</code>, and it can take some time if I have many TH stuffs like hamlet and persistent.</p>\n\n<p>I think it is preferable to have my stack or cabal download everything as precompiled binaries, and run my dev site via <code>runhaskell</code> or <code>stack exec runhaskell</code> for minimum compilation time. So here are my two questions:</p>\n\n<ol>\n<li>How can I use precompiled binaries for stack and yesod installs?</li>\n<li>How can I make ghci to reload source after edit while running in interpreted mode? <code>yesod devel</code> does that, but it tries to recompile ..</li>\n</ol>\n"}, {"tags": ["haskell", "gtk", "monads", "gtk2hs"], "answers": [{"comments": [{"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1459771360, "post_id": 36395474, "comment_id": 60420488, "body": "hello,thanks, I no more have compilation errors, but nothing is displayed in the window. please have a look at my new question (I am writing it at the moment)"}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 2, "last_activity_date": 1459749629, "creation_date": 1459749629, "answer_id": 36395474, "question_id": 36389574, "link": "https://stackoverflow.com/questions/36389574/error-using-affiche/36395474#36395474", "title": "Error using affiche", "body": "<p>Since you use <code>affiche2</code> in <code>when</code>, its return type should be <code>IO ()</code>, because that's what <code>when</code> accepts. To make it work you need to found out how to turn <code>Render</code> into <code>IO</code>, supposedly with <code>renderWithDrawable</code>.</p>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1459797581, "creation_date": 1459708981, "last_edit_date": 1459797581, "question_id": 36389574, "link": "https://stackoverflow.com/questions/36389574/error-using-affiche", "title": "Error using affiche", "body": "<p>Concerning the writing of a function in Haskell, using Gtk (via the package Gtk2Hs); here are my requirements:</p>\n\n<ul>\n<li><p>The function should have the signature:</p>\n\n<pre><code>affiche :: ((Double,Double), (Double,Double)) -&gt; IO Bool\n</code></pre></li>\n<li><p>The parameters are noted (a0, a), (b0, b); the function should use an external function called mandelbrot: if mandelbrot (a, b) is true, then there must be a call to: postGUIAsync affiche2 a0 b0, where affiche2 is (I also introduced my try to write affiche):</p>\n\n<pre><code>affiche2 :: Double -&gt; Double -&gt; Render()\naffiche2 a b = do\n  C.rectangle a b 1 1 \n  stroke\n\naffiche :: ((Double,Double), (Double,Double)) -&gt; IO Bool\naffiche ((a0,a), (b0,b)) = when (mandelbrot a b) $ affiche2 a0 b0\n</code></pre></li>\n</ul>\n\n<p>My attempt to write affiche does not use postGUIAsync, and it raises the error:</p>\n\n<pre><code>Error: Couldn't match type \u2018Render\u2019 with \u2018IO\u2019\n  Expected type: IO Bool\n    Actual type: Render ()\n</code></pre>\n"}, {"tags": ["list", "haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1459714408, "post_id": 36387477, "comment_id": 60398045, "body": "Check out the haskell tag info page re. finding functions and other interesting stuff: <a href=\"http://stackoverflow.com/tags/haskell/info\">stackoverflow.com/tags/haskell/info</a>"}], "answers": [{"comments": [{"owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "edited": false, "score": 12, "creation_date": 1459699259, "post_id": 36387512, "comment_id": 60392126, "body": "Or <code>replicate 5 0</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1459700009, "post_id": 36387512, "comment_id": 60392385, "body": "<code>*</code> works the same for lists and integers; it&#39;s repeated addition. <code>some_list * 3 == 3 * some_list == some_list + some_list + some_list</code>, where list addition is just concatenation."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1459710773, "post_id": 36387512, "comment_id": 60396536, "body": "@n.m That comment was in response to Sibi&#39;s comment about Python&#39;s syntax."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1459713024, "post_id": 36387512, "comment_id": 60397464, "body": "@chepner: this is indeed kind of consistent by itself. Unfortunately, it&#39;s glaringly inconsistent with other use of numerical operators. Consider <code>numpy.array([0]) * 3</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1459728650, "post_id": 36387512, "comment_id": 60402376, "body": "I think we&#39;re getting to the point where we would just be discussing the pros and cons of operator overloading vs a proliferation of type-specific operators (or even type-specific functions)."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 8, "last_activity_date": 1459710860, "last_edit_date": 1459710860, "creation_date": 1459698238, "answer_id": 36387512, "question_id": 36387477, "link": "https://stackoverflow.com/questions/36387477/list-of-n-zeros-in-haskell/36387512#36387512", "title": "list of n zeros in Haskell", "body": "<p>You can do this:</p>\n\n<pre><code>\u03bb&gt; take 5 (repeat 0)\n[0,0,0,0,0]\n</code></pre>\n\n<p>Or as @obadz points out, this is even more concise:</p>\n\n<pre><code>\u03bb&gt; replicate 5 0\n[0,0,0,0,0]\n</code></pre>\n\n<p>I personally don't like the python syntax. <code>*</code> means multiplication but it does something else in your case. But that's just my opinion :).</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": -1, "last_activity_date": 1459706277, "last_edit_date": 1459706277, "creation_date": 1459701481, "answer_id": 36388098, "question_id": 36387477, "link": "https://stackoverflow.com/questions/36387477/list-of-n-zeros-in-haskell/36388098#36388098", "title": "list of n zeros in Haskell", "body": "<p>you can define it yourself (as a toy example)</p>\n\n<pre><code>(*) :: [a] -&gt; Int -&gt; [a]                     \n(*) xs n = take n $ cycle xs\n</code></pre>\n\n<p>so you can have</p>\n\n<pre><code>Prelude&gt; [0]*5                                                      \n[0,0,0,0,0]\n\nPrelude&gt; [0,1]*5\n[0,1,0,1,0]\n</code></pre>\n\n<p>obviously, by redefining existing operators have \"side effects\"</p>\n\n<pre><code>Prelude&gt; 4*4\n\n&lt;interactive&gt;:169:1:\n    Non type-variable argument in the constraint: Num [a]\n    (Use FlexibleContexts to permit this)\n    When checking that `it' has the inferred type\n      it :: forall a. Num [a] =&gt; [a]\n</code></pre>\n\n<p>or perhaps <code>python</code> interpretation is replicate the list n times (instead of picking n elements from the cycled list elements).  In that case you can define it as</p>\n\n<pre><code>(*) :: [a] -&gt; Int -&gt; [a]                                                                                 \n(*) xs n = concat $ replicate n xs                                                                       \n\n\nPrelude&gt; [0]*4                                                                                                        \n[0,0,0,0]\n\nPrelude&gt; [0,1]*4                                                                                                      \n[0,1,0,1,0,1,0,1]\n</code></pre>\n\n<p>obviously, this is a toy example and you may want to define another operator or simply a function for this.</p>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 0, "last_activity_date": 1459714449, "creation_date": 1459714449, "answer_id": 36390608, "question_id": 36387477, "link": "https://stackoverflow.com/questions/36387477/list-of-n-zeros-in-haskell/36390608#36390608", "title": "list of n zeros in Haskell", "body": "<p>Another possibility:</p>\n\n<pre><code>import Data.Monoid\n\nzeroes = 5 * [0] where (*) = mtimes\n</code></pre>\n"}], "owner": {"reputation": 2262, "user_id": 4551565, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3177185a7dbdb6bc72aee5f5554e53a?s=128&d=identicon&r=PG&f=1", "display_name": "Pigna", "link": "https://stackoverflow.com/users/4551565/pigna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4087, "favorite_count": 0, "accepted_answer_id": 36387512, "answer_count": 3, "score": 3, "last_activity_date": 1459714449, "creation_date": 1459698046, "last_edit_date": 1459708063, "question_id": 36387477, "link": "https://stackoverflow.com/questions/36387477/list-of-n-zeros-in-haskell", "title": "list of n zeros in Haskell", "body": "<p>This is probably very easy, but I cannot figure out how to do the equivalent of Python's</p>\n\n<pre><code>[0]*n\n</code></pre>\n\n<p>in Haskell, in order to get a list with n zeros.</p>\n\n<pre><code>[0]*n\n</code></pre>\n\n<p>doesn't work. Am I obliged to do something like: <code>[0 | x &lt;-[1..5]]</code> ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 4, "creation_date": 1459697226, "post_id": 36387272, "comment_id": 60391355, "body": "<a href=\"http://stackoverflow.com/help/asking\">Welcome to StackOverflow</a>. Now did you have a question?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459697803, "post_id": 36387272, "comment_id": 60391581, "body": "use patterns - depending on what you want <code>triangle_areas (x:y:z:ds)</code> or <code>triangle_areas (x:ds@(y:z:_))</code>"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1459702687, "post_id": 36387272, "comment_id": 60393341, "body": "probably need to check the triangle inequality is satisfied for the sides as well."}], "answers": [{"comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1459697973, "post_id": 36387451, "comment_id": 60391639, "body": "<code>triangle_area</code> cannot be concatenated like that (it&#39;s not a list). Also this fails to pattern match for lists of length 1 and 2."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1459698024, "post_id": 36387451, "comment_id": 60391656, "body": "I specifically said I was assuming an input list whose length is a multiple of 3. There are many ways to handle other lists: ignore them, as in your answer, raise an exception, return an <code>Either a [Double]</code> value for some appropriate type <code>a</code>, etc."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1459698158, "post_id": 36387451, "comment_id": 60391698, "body": "The user can pick a way to handle the exception; I think it&#39;s beyond the scope of this question."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1459698387, "post_id": 36387451, "comment_id": 60391787, "body": "It&#39;s no weaker than your solution, which is to silently ignore extra input. I was just up front about my assumption."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1459698354, "last_edit_date": 1459698354, "creation_date": 1459697890, "answer_id": 36387451, "question_id": 36387272, "link": "https://stackoverflow.com/questions/36387272/returning-doubles-in-haskell/36387451#36387451", "title": "Returning Doubles in haskell", "body": "<p>Use pattern matching to get the first three elements of the input, then recurse. It's simplest if you assume <code>triangle_areas</code> is always called with a list whose length is a multiple of 3.</p>\n\n<pre><code>triangle_areas :: [Double] -&gt; [Double]\ntriangle_areas [] = []\ntriangle_areas (a:b:c:xs) = triangle_area a b c : triangle_areas xs\n</code></pre>\n\n<p>For lists with an extra element or two, there are many options. One is to simply ignore them.</p>\n\n<pre><code>-- Case 3\ntriangle_areas _ = []\n</code></pre>\n\n<p>Another is to simple return an error</p>\n\n<pre><code>-- Case 3\ntriangle_areas _ = error \"Incomplete final set\"\n</code></pre>\n\n<p>Yet another is to return an <code>Either</code> value</p>\n\n<pre><code>triangle_areas :: [Double] -&gt; Either String [Double]\ntriangle_areas [] = Right []\ntriangle_areas (a:b:c:xs) = Right $ triangle_area a b c : triangle_areas xs\ntriangle_areas _ = Left \"Incomplete final set\"\n</code></pre>\n\n<p>And there are others.</p>\n"}], "owner": {"reputation": 7, "user_id": 6151952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c64ef44e13821a8ad6ad95ea85ececd5?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cash", "link": "https://stackoverflow.com/users/6151952/johnny-cash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459698579, "creation_date": 1459696907, "last_edit_date": 1459697193, "question_id": 36387272, "link": "https://stackoverflow.com/questions/36387272/returning-doubles-in-haskell", "title": "Returning Doubles in haskell", "body": "<p>Now what I want to do is to write another function, triangle_areas (note the use of plural here), that takes a list of Doubles, treats each consecutive group of three Doubles as the lengths of the three sides of a triangle, uses triangle_area to calculate its area; and after processing all Doubles in the list, returns all calculated areas as a list of Doubles.</p>\n\n<p>Here is my code so far.</p>\n\n<pre><code>triangle_area :: Double -&gt; Double -&gt; Double -&gt; Double\ntriangle_area a b c = sqrt (s * (s - a) * (s - b) * (s - c))\n    where s = (a + b + c) / 2.0\n\ntriangle_areas :: [Double] -&gt; [Double]\ntriangle_areas xs = []\n</code></pre>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1459690089, "post_id": 36385940, "comment_id": 60388815, "body": "I would do either: wrap it <code>newtype MyComplex a = Complex a</code> or write another function <code>show&#39;</code> - everything besides seems a bit harsh"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3692497"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459690834, "post_id": 36385940, "comment_id": 60389037, "body": "The problem with newtype is that I would have to add instances for all the math stuff."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 5, "creation_date": 1459691077, "post_id": 36385940, "comment_id": 60389109, "body": "@1213 <code>newtype</code> allows to automatically derive instances provided by the type you are wrapping."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3692497"}, "edited": false, "score": 0, "creation_date": 1459691798, "post_id": 36385940, "comment_id": 60389352, "body": "Oh I didn&#39;t know that ^^ doesn&#39;t seem so inconvenient anymore."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1459701677, "post_id": 36385940, "comment_id": 60392956, "body": "You add <code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}</code> and then you can write <code>newtype MyComplex a = MyComplex (Complex a) deriving (Eq, Num, Fractional, Floating)</code>."}], "owner": {"user_type": "does_not_exist", "display_name": "user3692497"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1459689906, "creation_date": 1459689906, "question_id": 36385940, "link": "https://stackoverflow.com/questions/36385940/custom-show-instance-for-complex", "title": "Custom Show instance for Complex", "body": "<p>I want to print complex numbers like this:</p>\n\n<pre><code>instance (Show a) =&gt; Show (Complex a) where\n    show (a :+ b) = show a ++ \" \":show b ++ \"i\"\n</code></pre>\n\n<p>But the module is <code>deriving(Show)</code> for <code>Complex</code>. I could copy the <code>Data.Complex</code> module, remove the <code>deriving(Show)</code> part and add my own instance or before printing I could map all complex numbers to a custom type which can only print complex numbers but doesn't care about doing math with them but this is annoying when you have complex numbers somewhere hidden in a tree or so. Are there better solutions to this? For example an extension that lets you override derived instances?</p>\n"}, {"tags": ["haskell", "refactoring", "dry", "typeclass"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1459687192, "post_id": 36385295, "comment_id": 60387862, "body": "If you like separate types, why don&#39;t you use <code>newtype</code>?"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1459688783, "post_id": 36385295, "comment_id": 60388405, "body": "You could define &quot;showSym :: Char -&gt; Maybe Integer -&gt; String&quot;. Also, you might want to make it clear which type it is in the text output."}, {"owner": {"reputation": 2158, "user_id": 1875565, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f710fcfe1f162e7792a2f46d0cef72e1?s=128&d=identicon&r=PG", "display_name": "Veky", "link": "https://stackoverflow.com/users/1875565/veky"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1459689302, "post_id": 36385295, "comment_id": 60388578, "body": "@Zeta I&#39;m not sure how <code>newtype</code> would help here. I&#39;d still have to write three separate <code>instance</code>s, right?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459689524, "post_id": 36385295, "comment_id": 60388642, "body": "@Veky yes but those would be rather trivial like <code>show (MyWrapper a) = show a</code> (of course you could do the same here) - if you don&#39;t need to overwrite anything other a simple type-synonym might be ok too"}, {"owner": {"reputation": 2158, "user_id": 1875565, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f710fcfe1f162e7792a2f46d0cef72e1?s=128&d=identicon&r=PG", "display_name": "Veky", "link": "https://stackoverflow.com/users/1875565/veky"}, "edited": false, "score": 0, "creation_date": 1459689697, "post_id": 36385295, "comment_id": 60388702, "body": "Hmm... so I define another (base) type, write show for it, and then define these three using it? Or are you saying that I can just say <code>instance Show (Char, Maybe Integer) where ...</code> without defining new type?"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1459735348, "post_id": 36385295, "comment_id": 60403884, "body": "At the very least you could factor out <code>showWithPrefix :: (Show a) =&gt; Char -&gt; Maybe a -&gt; String</code> as <code>showWithPrefix c n = c : maybe &quot;&quot; show n</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 0, "last_activity_date": 1526121528, "creation_date": 1526121528, "answer_id": 50305305, "question_id": 36385295, "link": "https://stackoverflow.com/questions/36385295/refactoring-haskell-code/50305305#50305305", "title": "Refactoring Haskell code", "body": "<p>You can use make a helper function or two to reduce the repetition.</p>\n\n<pre><code>showIfJust :: (Show a) =&gt; Maybe a -&gt; String\nshowIfJust (Just a) = show a\nshowIfJust _ = \"\"\n\nshowCharMaybe = (Show a) =&gt; Char -&gt; Maybe a -&gt; String\nshowCharMaybe c m = c : showIfJust m\n\ndata Variable = Var Char (Maybe Integer)\n    deriving (Eq)\n\ninstance Show Variable where\n    -- this can be written as\n    -- c : showIfJust n\n    -- or showCharMaybe c m\n    show (Var c mn) = showCharMaybe c mn\n\ndata Funcsymb = FuncS Char (Maybe Integer)\n    deriving (Eq)\n\ninstance Show Funcsymb where\n    show (FuncS c mn) = showCharMaybe c mn\n\ndata Relsymb = RelS Char (Maybe Integer)\n    deriving (Eq)\n\ninstance Show Relsymb where\n    show (RelS c mn) = showCharMaybe c mn\n</code></pre>\n\n<p>Also, you can switch the <code>data</code> declarations to <code>newtype</code> since they are all single constructor declarations. It is a small optimization. <a href=\"https://wiki.haskell.org/Newtype\" rel=\"nofollow noreferrer\">More details about newtype</a>.</p>\n"}], "owner": {"reputation": 2158, "user_id": 1875565, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f710fcfe1f162e7792a2f46d0cef72e1?s=128&d=identicon&r=PG", "display_name": "Veky", "link": "https://stackoverflow.com/users/1875565/veky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1526121528, "creation_date": 1459685852, "last_edit_date": 1459686345, "question_id": 36385295, "link": "https://stackoverflow.com/questions/36385295/refactoring-haskell-code", "title": "Refactoring Haskell code", "body": "<p>Can instantiating a typeclass be generalized?</p>\n\n<p>I have following bits of Haskell code:</p>\n\n<pre><code>data Variable = Var Char (Maybe Integer)\n    deriving (Eq)\ninstance Show Variable where\n    show (Var c Nothing) = [c]\n    show (Var c (Just n)) = c : show n\n\ndata Funcsymb = FuncS Char (Maybe Integer)\n    deriving (Eq)\ninstance Show Funcsymb where\n    show (FuncS c Nothing) = [c]\n    show (FuncS c (Just n)) = c : show n\n\ndata Relsymb = RelS Char (Maybe Integer)\n    deriving (Eq)\ninstance Show Relsymb where\n    show (RelS c Nothing) = [c]\n    show (RelS c (Just n)) = c : show n\n</code></pre>\n\n<p>Can I write it without so much duplication? I know I can just use <code>(Char, Maybe Integer)</code> for all three, but I'd rather have separate types.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1459681378, "post_id": 36384579, "comment_id": 60386177, "body": "are you sure that your <code>kinds</code> are right (<code>&#39;GET</code> vs. <code>*</code> etc) (your instance should look like <code>(Verb (n :: GET) (s :: Nat) ..)</code> (note I am not sure on the <code>Nat</code> here ^^)"}, {"owner": {"reputation": 363, "user_id": 2618122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e87c7136315e1392460f7293fc333d9?s=128&d=identicon&r=PG", "display_name": "robert", "link": "https://stackoverflow.com/users/2618122/robert"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459681989, "post_id": 36384579, "comment_id": 60386353, "body": "Thanks alot Carsten - that did the trick - I&#39;ll post an answer once I resolved the other errors that are now popping up."}], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1459714974, "post_id": 36384888, "comment_id": 60398234, "body": "PolyKinds will often introduce a lot of errors if suddenly enabled - by default the kind of a type variable defaults to <code>*</code> if not specified, but with PolyKinds the kinds of type variables are instead generalized to a fresh kind variable. Also note that you don&#39;t need a kind annotation on each occurrence of a type variable - any one is enough."}, {"owner": {"reputation": 363, "user_id": 2618122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e87c7136315e1392460f7293fc333d9?s=128&d=identicon&r=PG", "display_name": "robert", "link": "https://stackoverflow.com/users/2618122/robert"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459776096, "post_id": 36384888, "comment_id": 60424002, "body": "Huh - good catch, I am so used to copy pasting with type level programming, that I did not even think about it - but it makes a lot of sense that the annotation is only needed once."}], "tags": [], "owner": {"reputation": 363, "user_id": 2618122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e87c7136315e1392460f7293fc333d9?s=128&d=identicon&r=PG", "display_name": "robert", "link": "https://stackoverflow.com/users/2618122/robert"}, "is_accepted": false, "score": 5, "last_activity_date": 1459776043, "last_edit_date": 1459776043, "creation_date": 1459683194, "answer_id": 36384888, "question_id": 36384579, "link": "https://stackoverflow.com/questions/36384579/no-instance-for-error-but-the-instance-exists-kinds-did-not-match/36384888#36384888", "title": "&quot;No instance for&quot; error - but the instance exists (kinds did not match)", "body": "<p>The given instance has default kind '*' for n s ct and a. Either use poly kinds as for n or the right concrete kinds:</p>\n\n<pre><code>(Verb (n :: k1) (s :: Nat) (ct :: [*]) a)\n</code></pre>\n\n<p>The correct instance would look like this:</p>\n\n<pre><code>instance GetEndpoint (Verb (n :: k1) (s :: Nat) (ct :: [*]) a) (Verb n s ct a) 'True where\n  getEndpoint _ _ _ _ server = server\n</code></pre>\n\n<p>If you don't want to enable PolyKinds (it introduced a bunch of other errors), you can use the more restricted <code>StdMethod</code> for n:</p>\n\n<pre><code>instance GetEndpoint (Verb (n :: StdMethod) (s :: Nat) (ct :: [*]) a) (Verb n s ct a) 'True where\n  getEndpoint _ _ _ _ server = server\n</code></pre>\n\n<p>Full code (compiling and even working as expected), can be found <a href=\"https://github.com/eskimor/servant-subscriber/blob/cb023f40eda08207d70a96cff567db92630b2448/src/Lib.hs\" rel=\"nofollow\">here</a>.</p>\n\n<p>Thanks again Carsten for this really quick help!</p>\n"}], "owner": {"reputation": 363, "user_id": 2618122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e87c7136315e1392460f7293fc333d9?s=128&d=identicon&r=PG", "display_name": "robert", "link": "https://stackoverflow.com/users/2618122/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1459776043, "creation_date": 1459680958, "last_edit_date": 1459684282, "question_id": 36384579, "link": "https://stackoverflow.com/questions/36384579/no-instance-for-error-but-the-instance-exists-kinds-did-not-match", "title": "&quot;No instance for&quot; error - but the instance exists (kinds did not match)", "body": "<p>I get the following error from ghc for my servant library:</p>\n\n<pre><code>No instance for (GetEndpoint\n                       (Verb 'GET 200 '[JSON] Position)\n                       (Verb 'GET 200 '[JSON] Position)\n                       'True)\narising from a use of `callServer3'\n</code></pre>\n\n<p>but I have an instance in scope, which looks like that:</p>\n\n<pre><code>instance GetEndpoint (Verb n s ct a) (Verb n s ct a) 'True where\n  getEndpoint _ _ _ _ server = server\n</code></pre>\n\n<p>which looks exactly like the one ghc can not find. I am a bit confused right now.</p>\n\n<p>Full code can be found here:</p>\n\n<ul>\n<li><a href=\"https://github.com/eskimor/servant-subscriber/blob/2f11e9de5bfc77656aa54918b06da866687638dd/src/Lib.hs\" rel=\"nofollow\">Instance definition</a> - right at the bottom of the file.</li>\n<li><a href=\"https://github.com/eskimor/servant-subscriber/blob/2f11e9de5bfc77656aa54918b06da866687638dd/test/Spec.hs\" rel=\"nofollow\">File triggering the error</a> - relevant code also at the bottom.</li>\n</ul>\n\n<p>Any clues? Thanks a lot for any hints!</p>\n"}, {"tags": ["haskell", "command-line-arguments", "optparse-generic"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1459714637, "post_id": 36384451, "comment_id": 60398130, "body": "<code>data Labeled = Labeled (String &lt;?&gt; &quot;Select the foo&quot;)</code>  will give you <code>...STRING                   Select the foo...</code> in the <code>--help</code> message."}, {"owner": {"reputation": 7520, "user_id": 2143551, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vAzam.png?s=128&g=1", "display_name": "corny", "link": "https://stackoverflow.com/users/2143551/corny"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459749492, "post_id": 36384451, "comment_id": 60407479, "body": "Ahh, parenthesis. How stupid of me. @user2407038, could you please post this as regular answer so I can mark the question as solved."}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 1, "last_activity_date": 1459761717, "creation_date": 1459761717, "answer_id": 36398789, "question_id": 36384451, "link": "https://stackoverflow.com/questions/36384451/haskell-documentation-for-unlabeled-command-line-arguments-in-optparse-generic/36398789#36398789", "title": "Haskell, documentation for unlabeled command line arguments in optparse-generic", "body": "<p>data <code>Labeled = Labeled (String &lt;?&gt; \"Select the foo\")</code> will give you </p>\n\n<pre><code>...\nSTRING     Select the foo\n... \n</code></pre>\n\n<p>in the <code>--help</code> message. To perhaps clarify, the <code>&lt;?&gt;</code> is simply a type constructor, it is just syntactically an operator. Maybe fun fact: you can write <code>data X = X (Int `Either` Bool)</code> as well.</p>\n"}], "owner": {"reputation": 7520, "user_id": 2143551, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vAzam.png?s=128&g=1", "display_name": "corny", "link": "https://stackoverflow.com/users/2143551/corny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 36398789, "answer_count": 1, "score": 1, "last_activity_date": 1459761717, "creation_date": 1459680172, "question_id": 36384451, "link": "https://stackoverflow.com/questions/36384451/haskell-documentation-for-unlabeled-command-line-arguments-in-optparse-generic", "title": "Haskell, documentation for unlabeled command line arguments in optparse-generic", "body": "<p>I'm using <a href=\"https://hackage.haskell.org/package/optparse-generic\" rel=\"nofollow\">optparse-generic</a> to parse the command line arguments of a program called <code>example</code>. I have a datatype with an unnamed field. For example:</p>\n\n<pre><code>data Unlabeled = Unlabeled String deriving (Generic, Show)\n</code></pre>\n\n<p>This generates a program which can be called as follows: <code>./exmaple \"foo\"</code>. However, for the user, there is no documentation what the <code>String</code>-parameter is about. In particular, <code>./example --help</code> does not give any valuable information about this positional <code>String</code> argument <code>./example</code> expects.</p>\n\n<p>Using named datatypes (record syntax), it is possible to add documentation to the datatype. For example</p>\n\n<pre><code>data Labeled = Labeled {name :: String &lt;?&gt; \"Select the foo\"} deriving (Generic, Show)\n</code></pre>\n\n<p>This generates help text for the program. For example, when called <code>./example --help</code>, it will display <code>--name STRING    Select the foo</code>.</p>\n\n<p>How can I add documentation to unnamed datatypes in the same way as I can do for record-syntax-datatypes?</p>\n"}, {"tags": ["string", "haskell", "text", "yesod"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459679991, "post_id": 36384380, "comment_id": 60385775, "body": "well the problem is not that it does not try .. the problem is that you have more instances of <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-String.html#v:IsString\" rel=\"nofollow noreferrer\"><code>IsString</code></a> in scope (it tells you which: <code>Value</code>, <code>ByteString</code>, <code>Text</code>, ...) - so you have to help it decide which you want"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459680271, "post_id": 36384380, "comment_id": 60385853, "body": "btw: <code>OverloadedString</code> does not tell GHC to use <code>Text</code> - it tells it to use <code>fromString</code> (see <code>IsString</code>) to parse strings - very similar to the way numbers are handled with number-literals and <code>fromInteger</code> in <code>Num</code>"}], "answers": [{"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 2, "last_activity_date": 1459682973, "last_edit_date": 1459682973, "creation_date": 1459682662, "answer_id": 36384811, "question_id": 36384380, "link": "https://stackoverflow.com/questions/36384380/how-does-xoverloadedstrings-work-in-yesod/36384811#36384811", "title": "How does `-XOverloadedStrings` work? (in Yesod)", "body": "<p>When you use OverloadedStrings, explicit strings are treated in a similar way to explicit numbers. So</p>\n\n<pre><code>x = \"foo\"\n</code></pre>\n\n<p>is desugared into </p>\n\n<pre><code>x = fromString \"foo\"\n</code></pre>\n\n<p>The IsString class defines the \"fromString\" function, so now all the type checker knows is that</p>\n\n<pre><code>x :: (IsString a) =&gt; a\n</code></pre>\n\n<p>So this is why the compiler is complaining that the type is ambiguous. There are several different string types with a ToJSON instance, and the compiler is complaining that it doesn't know which one to pick.</p>\n\n<p>The only solutions, I'm afraid, are to lose the OverloadedStrings or to put in explicit type annotations to tell the compiler which instance to pick.</p>\n\n<p>On String versus Text: efficiency is not a particularly big issue when you are using short constant strings like this. If you are processing text in bulk then its a bigger issue, and also the Haskell concept of String = [Char] breaks down in some languages. Text handles these properly, but String doesn't. So if you ever need to internationalise your code then String can present you with obscure problems when you try to do things like capitalise words.</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1459696127, "last_edit_date": 1459696127, "creation_date": 1459682759, "answer_id": 36384822, "question_id": 36384380, "link": "https://stackoverflow.com/questions/36384380/how-does-xoverloadedstrings-work-in-yesod/36384822#36384822", "title": "How does `-XOverloadedStrings` work? (in Yesod)", "body": "<p><code>object</code> takes a list of <code>Pair</code> values as argument. <code>Pair</code> is <code>type Pair = (Text, Value)</code> and it is an instance of tye <code>KeyValue</code> typeclass, which provides the convenience constructor <code>(.=) :: ToJSON v =&gt; Text -&gt; v -&gt; kv</code>.</p>\n\n<p>The problem is as follows: <code>.=</code> requires the value type to have a <code>ToJSON</code> instance, but doesn't force the caller into any concrete type. </p>\n\n<p>Meanwhile, the <a href=\"http://haddock.stackage.org/lts-5.11/base-4.8.2.0/Data-String.html#t:IsString\" rel=\"nofollow\"><code>fromString</code></a> function from <code>IsString</code> is overloaded on its return type: <code>fromString :: String -&gt; a</code>. The precise implementation to call is determined from the return type. When <code>OverloadedStrings</code> is used, <code>fromString</code> is called implicitly for string literals.</p>\n\n<p>If we feed directly the result of <code>fromString</code> as the value argument of <code>.=</code>, the compiler doesn't have enough information to assing a concrete type to the value. Should it create a <code>Text</code> value and convert it to json? Or perhaps create a <code>ByteString</code> instead and convert it to json? The problem is similar to ambiguous compositions like <code>show . read</code>.</p>\n\n<p>Personally, instead of using type annotations I would solve the ambiguity by wrapping the string literals using the <a href=\"http://hackage.haskell.org/package/aeson-0.11.1.4/docs/Data-Aeson.html#t:Value\" rel=\"nofollow\"><code>String</code></a> constructor of the <code>Value</code> type. It tells the compiler that the literal will be <code>Text</code>, and of course <code>Value</code> is an instance of <code>ToJSON</code>. This is a bit less verbose than type annotations:</p>\n\n<pre><code>foo :: Value\nfoo = object [\"foo\" .= String \"faa\"]\n</code></pre>\n\n<p>You could also define a specialization of <code>.=</code> that took a concrete <code>Text</code> as the value:</p>\n\n<pre><code>(.=|) :: KeyValue kv =&gt; Text -&gt; Text -&gt; kv \n(.=|) = (.=)\n\nfoo :: Value\nfoo = object [\"foo\" .=| \"faa\"] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": false, "score": 2, "last_activity_date": 1459748052, "last_edit_date": 1459748052, "creation_date": 1459716366, "answer_id": 36390960, "question_id": 36384380, "link": "https://stackoverflow.com/questions/36384380/how-does-xoverloadedstrings-work-in-yesod/36390960#36390960", "title": "How does `-XOverloadedStrings` work? (in Yesod)", "body": "<p>The JSON code snippet you're looking at does work correctly straight out of the book. There's an additional pragma at the top of it that's missing from your code:</p>\n\n<pre><code>{-# LANGUAGE ExtendedDefaultRules #-}\n</code></pre>\n\n<p>I'm not a huge fan of the code snippet doing that, since I'm pretty sure people don't use that pragma in production code. It would be more typical to write the code like this:</p>\n\n<pre><code>getHomeR  = return $ object [\"msg\" .= (\"Hello World\" :: String)]\n</code></pre>\n\n<p>Note that GHCi uses <code>ExtendedDefaultRules</code> to make it easier to enter expressions into the REPL without having to specify their type. If you type <code>object [\"msg\" .= \"Hello World\"]</code> into GHCi it'll tell you what it's defaulting to:</p>\n\n<pre><code>ghci &gt; object [\"msg\" .= \"Hello World\"]\n\n&lt;interactive&gt;:2:18: Warning:\n    Defaulting the following constraint(s) to type \u2018String\u2019\n      (IsString a0)\n        arising from the literal \u2018\"Hello World\"\u2019 at &lt;interactive&gt;:2:18-30\n      (ToJSON a0) arising from a use of \u2018.=\u2019 at &lt;interactive&gt;:2:15-16\n    In the second argument of \u2018(.=)\u2019, namely \u2018\"Hello World\"\u2019\n    In the expression: \"msg\" .= \"Hello World\"\n    In the first argument of \u2018object\u2019, namely\n      \u2018[\"msg\" .= \"Hello World\"]\u2019\n\n&lt;interactive&gt;:2:18: Warning:\n    Defaulting the following constraint(s) to type \u2018String\u2019\n      (IsString a0)\n        arising from the literal \u2018\"Hello World\"\u2019 at &lt;interactive&gt;:2:18-30\n      (ToJSON a0) arising from a use of \u2018.=\u2019 at &lt;interactive&gt;:2:15-16\n    In the second argument of \u2018(.=)\u2019, namely \u2018\"Hello World\"\u2019\n    In the expression: \"msg\" .= \"Hello World\"\n    In the first argument of \u2018object\u2019, namely\n      \u2018[\"msg\" .= \"Hello World\"]\u2019\nObject (fromList [(\"msg\",String \"Hello World\")])\n</code></pre>\n"}], "owner": {"reputation": 10218, "user_id": 1684670, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/0de21f6ec42b67830c9308664e0abf72?s=128&d=identicon&r=PG", "display_name": "thkang", "link": "https://stackoverflow.com/users/1684670/thkang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1459748052, "creation_date": 1459679818, "question_id": 36384380, "link": "https://stackoverflow.com/questions/36384380/how-does-xoverloadedstrings-work-in-yesod", "title": "How does `-XOverloadedStrings` work? (in Yesod)", "body": "<p>I'm following Yesod tutorials from their official yesod book. (<a href=\"http://www.yesodweb.com/book/basics\" rel=\"nofollow\">http://www.yesodweb.com/book/basics</a>)</p>\n\n<p>Unfortunately their tutorials on the book won't work, worse is that its output is very cryptic message about types not mathcing that took me quite a while to understand. Here's their original code and error message which is produced by the  code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings     #-}\n{-# LANGUAGE QuasiQuotes           #-}\n{-# LANGUAGE TemplateHaskell       #-}\n{-# LANGUAGE TypeFamilies          #-}\nimport           Yesod\n\ndata Links = Links\n\nmkYesod \"Links\" [parseRoutes|\n/ HomeR GET\n|]\n\ninstance Yesod Links\n\ngetHomeR = return $ object [\"msg\" .= \"Hello World\"]\n\nmain :: IO ()\nmain = warp 3000 Links\n</code></pre>\n\n<p>error:</p>\n\n<pre><code>helloworld2.hs:18:36:\n    No instance for (ToJSON a0) arising from a use of \u2018.=\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance ToJSON a =&gt; ToJSON (Control.Applicative.Const a b)\n        -- Defined in \u2018Data.Aeson.Compat\u2019\n      instance ToJSON (Data.Proxy.Proxy a)\n        -- Defined in \u2018Data.Aeson.Compat\u2019\n      instance ToJSON Data.Version.Version\n        -- Defined in \u2018Data.Aeson.Compat\u2019\n      ...plus 7 others\n    In the expression: \"msg\" .= \"Hello World\"\n    In the first argument of \u2018object\u2019, namely\n      \u2018[\"msg\" .= \"Hello World\"]\u2019\n    In the second argument of \u2018($)\u2019, namely\n      \u2018object [\"msg\" .= \"Hello World\"]\u2019\n\nhelloworld2.hs:18:40:\n    No instance for (Data.String.IsString a0)\n      arising from the literal \u2018\"Hello World\"\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance Data.String.IsString Value\n        -- Defined in \u2018aeson-0.9.0.1:Data.Aeson.Types.Internal\u2019\n      instance (a ~ Data.ByteString.Internal.ByteString) =&gt;\n               Data.String.IsString\n                 (attoparsec-0.13.0.1:Data.Attoparsec.ByteString.Internal.Parser a)\n        -- Defined in \u2018Data.Attoparsec.ByteString.Char8\u2019\n      instance (a ~ Data.Text.Internal.Text) =&gt;\n               Data.String.IsString\n                 (attoparsec-0.13.0.1:Data.Attoparsec.Text.Internal.Parser a)\n        -- Defined in \u2018attoparsec-0.13.0.1:Data.Attoparsec.Text.Internal\u2019\n      ...plus 9 others\n    In the second argument of \u2018(.=)\u2019, namely \u2018\"Hello World\"\u2019\n    In the expression: \"msg\" .= \"Hello World\"\n    In the first argument of \u2018object\u2019, namely\n      \u2018[\"msg\" .= \"Hello World\"]\u2019\n</code></pre>\n\n<p>it seems <code>object [\"msg\" .= \"Hello World\"]</code> is the problem. GHC doesn't understand what are types of <code>\"msg\"</code> and <code>\"Hello World\"</code>, and can't build a <code>JSON</code> <code>object</code> out of them. I had to make their types explicit, that:</p>\n\n<pre><code>import           Data.Text (Text)\ngetHomeR = return $ object [(\"msg\" :: Text) .= (\"Hello World\" :: Text)]\n</code></pre>\n\n<p>it seems <code>Aeson</code> has toJSON instances for <code>Text</code> type, and I've heard that most of the text-processing codes use <code>Text</code> type, not <code>String</code> ([Char]) for efficiency reasons. But wouldn't it be nice, if every double-quoted code (<code>\"msg\"</code>, <code>\"Hello World\"</code>) is parsed as <code>Text</code> instead of <code>String</code> automatically? I've thought the <code>OverloadedStrings</code> pragma tells the compiler to do exactly that(\"overload\" the strings into <code>Text</code>), but above errors without type signature indicates that I was wrong.</p>\n\n<p>of course, If I have to give <code>:: Text</code> type signature for every string I write for output it would be very tedious and cumbersome - is there any solution for this, or is it me just don't understand enough to write Haskell and Yesod codes?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459675300, "post_id": 36383645, "comment_id": 60384310, "body": "just use <code>map</code> instead of <code>forM</code> (switch arguments of course) - list-monads are supposed to combine every value ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459675358, "post_id": 36383645, "comment_id": 60384327, "body": "Ok, but can you give some comment ?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459675457, "post_id": 36383645, "comment_id": 60384351, "body": "well it&#39;s in the definition of the list-monad - the second one happens because the <i>output</i> / value of the IO computation you get is a list of two unit-values (one from each print) - if you don&#39;t want to know use <code>forM_</code> there"}, {"owner": {"reputation": 49501, "user_id": 784338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae195ac7c8a5e9002a808544572cc5fc?s=128&d=identicon&r=PG", "display_name": "Daniel Gratzer", "link": "https://stackoverflow.com/users/784338/daniel-gratzer"}, "edited": false, "score": 0, "creation_date": 1459676313, "post_id": 36383645, "comment_id": 60384632, "body": "Worth noting, in the common scenario where you feed <code>mapM</code>/<code>forM</code> a function which return <code>m ()</code>, it&#39;s often better to use the <code>mapM_</code>/<code>forM_</code> relatives. These behave almost identically but don&#39;t bother to build up a list as a result because a list of <code>()</code>s is almost never helpful."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1459676176, "last_edit_date": 1459676176, "creation_date": 1459675743, "answer_id": 36383713, "question_id": 36383645, "link": "https://stackoverflow.com/questions/36383645/haskell-form-why-this-code-returns-such-result/36383713#36383713", "title": "Haskell, forM - why this code returns such result?", "body": "<h2>regarding your strange <code>[(),()]</code></h2>\n\n<p>for the second one remember: <code>print</code> is <code>Show a =&gt; a -&gt; IO ()</code> (and has the sideeffect of printing out the value with <code>show</code>)</p>\n\n<p>now</p>\n\n<pre><code>forM [5,6] print -- same as yours\n= mapM print [5,6]\n= sequence $ fmap print [5,6]\n= sequence [print 5, print 6]\n</code></pre>\n\n<p>now for the sideeffects: <code>sequence</code> in the <code>IO</code> monad will just compute one after the other </p>\n\n<p>but for the <em>result</em> it's <code>[(),()]</code> (remember: <code>sqeuence :: [IO a] -&gt; IO [a]</code>)</p>\n\n<p>so you get first the sideeffects (<code>5</code> and <code>6</code> printed on newlines) and then the result of this computation <code>[(),()]</code></p>\n\n<h3>getting rid of it:</h3>\n\n<p>you can get rid of this by using <code>forM_</code> instead (which will give <code>()</code> back):</p>\n\n<pre><code>&gt; import Control.Monad(forM_)\n&gt; forM_ [5,6] print\n5\n6\n</code></pre>\n\n<hr>\n\n<h2>regarding the list-monad</h2>\n\n<p>you can see why the first from this:</p>\n\n<pre><code>forM [5,6] (\\x -&gt; x:[7])\n= mapM (\\x -&gt; x:[7]) [5,6]\n= sequence (fmap (\\...) [5,6])\n= sequence [[5,7],[6,7]]\n= [[5,6],[5,7],[7,6],[7,7]]\n</code></pre>\n\n<p>remember - the list-monad is basically doing the cross-product there</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1459676303, "creation_date": 1459676303, "answer_id": 36383785, "question_id": 36383645, "link": "https://stackoverflow.com/questions/36383645/haskell-form-why-this-code-returns-such-result/36383785#36383785", "title": "Haskell, forM - why this code returns such result?", "body": "<p><code>print 5</code> is a value of type <code>IO ()</code>, an action that does I/O and that finally returns a value of type <code>()</code> (there is only one such value: <code>()</code>).</p>\n\n<p><code>forM list print</code> executes <code>print</code> an every value in <code>list</code>, and <em>returns</em> the list of their return values. This is a list of <code>()</code>, which is why you see a final <code>[(),...,()]</code>.By comparison <code>forM_ list print</code> will not return a list of results, but a single (). </p>\n\n<p>Note that GHCi special-cases <code>IO ()</code> actions, in that GHCi does not print the final <code>()</code> result. This is not the case for e.g. <code>IO [()]</code> actions, so GHCi will print the final list at the end.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 36383713, "answer_count": 2, "score": 2, "last_activity_date": 1459676303, "creation_date": 1459675179, "question_id": 36383645, "link": "https://stackoverflow.com/questions/36383645/haskell-form-why-this-code-returns-such-result", "title": "Haskell, forM - why this code returns such result?", "body": "<p>I was very surprised when I saw it:</p>\n\n<pre><code>forM [5,6] (\\x -&gt; x:[7])\n[[5,6],[5,7],[7,6],[7,7]]\n</code></pre>\n\n<p><strong>I would like to get</strong> <code>[[5,7], [6,7]]</code>. I know that it is possible to get it using map, but I am learning monads now.<br>\nI make a next step, and try:  </p>\n\n<pre><code>forM [5,6] (\\x -&gt; print x)\n5\n6\n[(),()]\n</code></pre>\n\n<p>What does it mean? <code>[(), ()]</code> is at least strange. Could you explain me this issue ?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 2221, "user_id": 448591, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5520f21f2e367d78c29d08d3b30b954f?s=128&d=identicon&r=PG", "display_name": "Jakob Runge", "link": "https://stackoverflow.com/users/448591/jakob-runge"}, "is_accepted": true, "score": 3, "last_activity_date": 1459670030, "creation_date": 1459670030, "answer_id": 36382926, "question_id": 36382793, "link": "https://stackoverflow.com/questions/36382793/haskell-difference-between-hgetbuf-hgetbufsome-and-hgetbufnonblocking/36382926#36382926", "title": "Haskell: Difference between hGetBuf, hGetBufSome and hGetBufNonBlocking", "body": "<p>Comming from the <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/System-IO.html#v:hGetBuf\" rel=\"nofollow\">documentation</a> I think the difference is like this:</p>\n\n<ul>\n<li><code>hGetBuf</code> blocks execution until either the specified number of bytes have been read or <code>EOF</code> is reached.</li>\n<li><code>hGetBufSome</code> blocks execution until it can either read at least <strong>some</strong> bytes, or until <code>EOF</code> has been reached. It doesn't read more than the given number of bytes.</li>\n<li><code>hGetBufNonBlocking</code> doesn't block execution. It tries to read the given number of bytes if any are available, but may return fewer.</li>\n</ul>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "accepted_answer_id": 36382926, "answer_count": 1, "score": 1, "last_activity_date": 1459670030, "creation_date": 1459668888, "question_id": 36382793, "link": "https://stackoverflow.com/questions/36382793/haskell-difference-between-hgetbuf-hgetbufsome-and-hgetbufnonblocking", "title": "Haskell: Difference between hGetBuf, hGetBufSome and hGetBufNonBlocking", "body": "<p>Can some body explain me the difference between hGetBuf and hGetBufSome. When to use hGetBuf, hGetBufSome, hGetBufNonBlocking?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 21726, "user_id": 1708058, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4a0b611077fcb9f7ede011fdc46e4d4c?s=128&d=identicon&r=PG", "display_name": "Alan Coromano", "link": "https://stackoverflow.com/users/1708058/alan-coromano"}, "edited": false, "score": 0, "creation_date": 1459667080, "post_id": 36382091, "comment_id": 60382146, "body": "how can I apply it to my case?"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1459662905, "creation_date": 1459662905, "answer_id": 36382091, "question_id": 36381712, "link": "https://stackoverflow.com/questions/36381712/how-to-simply-all-data-definitions-having-the-same-kind-and-name-of-a-field/36382091#36382091", "title": "How to simply all &quot;data&quot; definitions having the same kind and name of a field?", "body": "<p>Sometimes it's best to separate things.</p>\n\n<pre><code>data Identified a = Identified\n  { ident :: !Int\n  , payload :: a }\n</code></pre>\n\n<p>Now you can deal with identified things in an entirely uniform way.</p>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1459692051, "post_id": 36383179, "comment_id": 60389443, "body": "I think <code>DuplicateRecordFields</code> solves a different problem than the user is asking about. (Although I am glad to learn about it!)"}], "tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": false, "score": 2, "last_activity_date": 1459671870, "creation_date": 1459671870, "answer_id": 36383179, "question_id": 36381712, "link": "https://stackoverflow.com/questions/36381712/how-to-simply-all-data-definitions-having-the-same-kind-and-name-of-a-field/36383179#36383179", "title": "How to simply all &quot;data&quot; definitions having the same kind and name of a field?", "body": "<p>In GHC 8.0 with <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Records/OverloadedRecordFields/DuplicateRecordFields\" rel=\"nofollow\">DuplicateRecordFields</a> you can use the same record field name for many data types. This is part of the larger feature of <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Records/OverloadedRecordFields/Redesign\" rel=\"nofollow\">OverloadedRecordFields</a>.</p>\n\n<p>Part 3, <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Records/OverloadedRecordFields/MagicClasses\" rel=\"nofollow\">MagicClasses</a>, introduces derivable type classes for <code>HasField</code> and <code>UpdateField</code>. This is similar in idea to your <code>DataTable</code>.</p>\n\n<p>If you want a field in your data type then you must declare it in the data type definition. I am not aware of any extensions, other than <a href=\"https://wiki.haskell.org/Template_Haskell\" rel=\"nofollow\">Template Haskell</a>, which change this.</p>\n"}], "owner": {"reputation": 21726, "user_id": 1708058, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4a0b611077fcb9f7ede011fdc46e4d4c?s=128&d=identicon&r=PG", "display_name": "Alan Coromano", "link": "https://stackoverflow.com/users/1708058/alan-coromano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459671870, "creation_date": 1459658870, "last_edit_date": 1459659191, "question_id": 36381712, "link": "https://stackoverflow.com/questions/36381712/how-to-simply-all-data-definitions-having-the-same-kind-and-name-of-a-field", "title": "How to simply all &quot;data&quot; definitions having the same kind and name of a field?", "body": "<p>I have many \"data\" which represent sql table in a database. </p>\n\n<pre><code>    data User = User { userId :: Int, userName :: String }\n    data Article = Article { articleId :: Int, articleTitle :: String, articleBody :: String }\n-- .......\n</code></pre>\n\n<p>All of them has the field \"id\" as a primary key. I wonder, is there any way to get rid of necessity to define it each time for each \"data\", can I anyhow simplify that? If do this:</p>\n\n<pre><code>class DataTable a where \n  myId :: Int\n</code></pre>\n\n<p>it won't change anything, will? I'll still have to define \"id\" for each data and then implement it for DataTable, in fact it'll make more complex.</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459658477, "post_id": 36380497, "comment_id": 60380695, "body": "I think the type of <code>g</code> is strange.. why does it return a string? Why not start with a function <code>:: (Process a, Typeable a) =&gt; Map String Dynamic -&gt; Maybe (a -&gt; a)</code> which computes the string from the <code>TypeRep</code> and returns the desired function (wrapped in Maybe of course)."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1459683932, "post_id": 36380497, "comment_id": 60386850, "body": "@user2407038, my bad about commented version of <code>g</code>. Should return <code>Maybe a</code>. Fixed."}], "answers": [{"comments": [{"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1459683713, "post_id": 36381546, "comment_id": 60386790, "body": "If we call reify within main, is the created instance visible outside the main body, i.e., it has global scope like compile-time typeclass instance? This is one thing about reflection dynamic typeclass instances that hasn&#39;t been clear to me."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 4, "creation_date": 1459684045, "post_id": 36381546, "comment_id": 60386883, "body": "@Sal The instance <code>Buildable (Yeah s a)</code> is a normal instance; it has a global scope just like any instance. You just can&#39;t satisfy it without the <code>Reifies s (Configuration a)</code> context, which means that the instance is only <i>usable</i> inside a call to <code>reify</code>. In practice, all this means is that you can&#39;t write a second instance <code>Buildable (Yeah s a)</code> which overlaps this one, as GHC never uses instance contexts to choose between two instances."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1459656824, "creation_date": 1459656824, "answer_id": 36381546, "question_id": 36380497, "link": "https://stackoverflow.com/questions/36380497/passing-runtime-information-for-polymorphic-function/36381546#36381546", "title": "Passing runtime information for polymorphic function", "body": "<p>This question really isn't self-contained, but it sounds like you might be able to use the facilities in the <a href=\"https://hackage.haskell.org/package/reflection\" rel=\"nofollow\"><code>reflection</code></a> package. In particular, it lets you use runtime information in typeclass instances. For example, you could write something like this (untested).</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables,\n      UndecidableInstances, .... #-}\nimport Data.Proxy\nimport Data.Reflection\n\ndata Configuration a = Configuration\n  { the_builder :: a -&gt; a\n  , someOtherThing :: Int\n  , whatever :: Char }\n\nclass Buildable a where\n  builder :: a -&gt; a\n\nnewtype Yeah s a = Yeah a\n\ninstance Reifies s (Configuration a) =&gt;\n            Buildable (Yeah s a) where\n  builder (Yeah x) = Yeah $ the_builder (reflect (Proxy :: Proxy s)) x\n</code></pre>\n\n<p>Then you can write</p>\n\n<pre><code>reify config $ \\(_ :: Proxy s) -&gt; expr\n</code></pre>\n\n<p>and within <code>expr</code>, the type <code>Yeah s a</code> will be an instance of the <code>Buildable</code> class.</p>\n"}, {"comments": [{"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1459683779, "post_id": 36383321, "comment_id": 60386808, "body": "yep, I don&#39;t own the <code>build</code>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1459684407, "post_id": 36383321, "comment_id": 60386964, "body": "You don&#39;t own the <code>Process</code> class you had in your question?"}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1459684495, "post_id": 36383321, "comment_id": 60386990, "body": "Yep, I do own the <code>Process</code> class."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 1, "creation_date": 1459684675, "post_id": 36383321, "comment_id": 60387031, "body": "So what&#39;s the problem? Put <code>build</code> in your <code>Process</code> class, as you originally intended, with a type which gives it access to the run-time config. Keep it simple. You don&#39;t need <code>reflection</code> or <code>DataKinds</code> or <code>Dynamic</code>."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1459685094, "post_id": 36383321, "comment_id": 60387184, "body": "Yep, figuring out how to refactor process class. No need for Reflection then."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1459691224, "post_id": 36383321, "comment_id": 60389162, "body": "don&#39;t we have to pass <code>config</code> argument for readerT to the function which will call <code>build</code> on the message? If so, then, we have n config for n type instances of message, no?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1459699487, "post_id": 36383321, "comment_id": 60392218, "body": "I don&#39;t understand your question. My proposed design is not complicated: you read the config file(s) into a single in-memory data structure; each implementation of <code>build</code> receives the config data through the reader monad and uses it to decide how to build whatever it needs to build. One config, <code>n</code> instances."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1459703167, "post_id": 36383321, "comment_id": 60393531, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/108096/discussion-between-sal-and-benjamin-hodgson\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 1, "last_activity_date": 1459686793, "last_edit_date": 1459686793, "creation_date": 1459672863, "answer_id": 36383321, "question_id": 36380497, "link": "https://stackoverflow.com/questions/36380497/passing-runtime-information-for-polymorphic-function/36383321#36383321", "title": "Passing runtime information for polymorphic function", "body": "<p>If you're able to change the declaration of <code>builder</code>, why not do it the old-fashioned way and just plumb in the config using a monad?</p>\n\n<pre><code>data Config = Config {\n    theHeader :: String,\n    somethingElse :: Int,\n    andAnotherThing :: Bool\n}\n\nclass Buildable a where\n    build :: MonadReader Config m =&gt; String -&gt; m a\n\n\ndata Msg = Msg { msg :: String } deriving (Show)\n\ninstance Buildable Msg where\n    build body = do\n        config &lt;- ask\n        return $ Msg { msg = theHeader config ++ body }\n\n\n-- imagine we're getting this from a file in the IO monad\nreadConfigFile = return $ Config {\n    theHeader = \"foo\",\n    somethingElse = 4,\n    andAnotherThing = False\n}\n-- imagine we're reading this from the wire\ngetFromSocket = return \"bar\"\n\nmain = do\n    config &lt;- readConfigFile\n    body &lt;- getFromSocket\n    msg &lt;- runReaderT (build body) config\n    print msg\n</code></pre>\n\n<p>@dfeuer's <code>reflection</code> answer becomes useful if you don't own the class and can't add the monadic context to <code>build</code>'s type.</p>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1459686793, "creation_date": 1459645291, "last_edit_date": 1495541751, "question_id": 36380497, "link": "https://stackoverflow.com/questions/36380497/passing-runtime-information-for-polymorphic-function", "title": "Passing runtime information for polymorphic function", "body": "<p>This is follow-up to my previous <a href=\"https://stackoverflow.com/questions/36375610/constructing-proxy-type-given-the-input\">question</a> about type-indexed map. Following the discussion in the comments, I am posting the actual problem here to see if there is a neat way to solve this using dependent-type programming.</p>\n\n<p>The problem is that given run-time information that we need for a typeclass function - we have different types of messages coming over the wire, and we use that function to do message specific processing using the run-time configuration - how do we pass run-time information (one run-time configuration for each type instance) to that function? </p>\n\n<p>Toy code below with comments - we use typeclass function <code>f</code> within <code>g</code> which gets runtime information and applies it to <code>f</code>  - btw, the set of message types <code>a</code> is fixed - so, we can use closed typefamilies if need be:</p>\n\n<pre><code>module Main where\n\nmain :: IO ()\nmain = do\n  let runtimeinfo = Mesg { aString = \"someheader\"}\n      builder = (\\x -&gt; Mesg { aString = (aString runtimeinfo) ++ (aString x)})  \n  -- should call function \"app\" on this line which will call function \"g\"\n  return () \n\ndata Mesg = Mesg {aString :: String} deriving Show\n\nclass Process a where\n  f :: a -&gt; a -- FYI, in actual app, output type is (StateT a IO Builder)\n  -- We can't define builder below at compile-time because it is created at run-time in main above\n--builder :: a -&gt; a \n\ninstance Process Mesg where\n  f inp = Mesg { aString = (reverse (aString inp))} -- contrived example - a placeholder for some processing on message\n\n-- g is not directly reachable from main - main calls a function \"app\" which \n-- calls g (after receiving \"inp\" of type \"a\" over the wire) - so, to pass \n-- builder, we have to pass it along. builder is from runtime configuration - \n-- in this example, it is created in main. If it were part of typeclass Process,\n-- we won't need to pass it along\ng :: Process a =&gt; (a -&gt; a) -&gt; a -&gt; a\ng builder inp = builder $ f inp -- we call processing function f here with runtime builder\n\n-- Alternative approach pseudo code - map here is created in main, and passed to g via app\n{--\n g :: (Process a, Typeable a) =&gt; Map String Dynamic -&gt; a -&gt; Maybe a\n g map inp = (retrieve corresponding builder from map using type-indexed string), apply here with f\n--}\n</code></pre>\n\n<p>My solution so far is type-indexed map in <code>g</code> which looks up <code>builder</code> for the type <code>a</code>. </p>\n"}, {"tags": ["c#", "haskell"], "comments": [{"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 0, "creation_date": 1459640073, "post_id": 36379888, "comment_id": 60377236, "body": "I don&#39;t know Haskell. Does this mean that A is an object containing a float, an int, and... B?  And D contains an instance of A and an int? (What is B? Another float, or the same float?) I look forward to the answer because I&#39;ll probably learn something."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 2, "creation_date": 1459640498, "post_id": 36379888, "comment_id": 60377362, "body": "@ScottHannen <code>A</code> is an object containing exactly one of a <code>Float</code>, an <code>Int</code>, or a list of <code>B</code>s. <code>D</code> is an object containing exactly one of a list of <code>A</code>s or an <code>Int</code>. The <code>B</code> type is not yet defined in this snippet (possibly McAngus meant <code>data B = ...</code> instead of <code>data D = ...</code>?)."}, {"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 0, "creation_date": 1459640905, "post_id": 36379888, "comment_id": 60377454, "body": "I don&#39;t think that can be very well represented in C#. A class property can be only one thing - a single property can&#39;t represent the possibility of a float or an int or another type. A property could be of type &#39;object` in which case you could put anything in it, but then it has no specific type at all. It could also be anything else (or null.) Am I understanding that right? You could write something with multiple properties but then you&#39;d be working against the language."}, {"owner": {"reputation": 6834, "user_id": 2216380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f211d4b44d6c2cafdf0fe0ea5e13cd4?s=128&d=identicon&r=PG", "display_name": "Royal Bg", "link": "https://stackoverflow.com/users/2216380/royal-bg"}, "edited": false, "score": 0, "creation_date": 1459644024, "post_id": 36379888, "comment_id": 60378094, "body": "You can use generics for that <code>class A&lt;T&gt; where T : Int32, Int64</code>"}, {"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "reply_to_user": {"reputation": 6834, "user_id": 2216380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f211d4b44d6c2cafdf0fe0ea5e13cd4?s=128&d=identicon&r=PG", "display_name": "Royal Bg", "link": "https://stackoverflow.com/users/2216380/royal-bg"}, "edited": false, "score": 0, "creation_date": 1459644334, "post_id": 36379888, "comment_id": 60378155, "body": "@RoyalBg Generic constraints in C# are additive, something cannot be both a float and an int."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1459646558, "post_id": 36379888, "comment_id": 60378561, "body": "The so-called &quot;visitor pattern&quot; (AKA Church encoding) is the closest OOP concept to algebraic data types. I&#39;d recommend you have a look at that."}, {"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459648494, "post_id": 36379888, "comment_id": 60378901, "body": "@chi I think that&#39;s what McAngus was referring to with &quot;create a class [...] then use inheritance&quot;. If not, then that is what I would suggest and do in the general case.  For McAngus, are you intending to restrict to data types where constructors only have one component, or do you want the general case?"}], "answers": [{"comments": [{"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 1, "creation_date": 1459648281, "post_id": 36380585, "comment_id": 60378865, "body": "Is your intent that you would use <code>instanceof</code> and downcasting to work with these?  Otherwise your solution is incomplete.  Also, I suspect that this is the solution the OP had in mind and is wondering if there is an alternative."}, {"owner": {"reputation": 1714, "user_id": 1097517, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/60ea0ac47e08c82ea6d4948ef04a4c5b?s=128&d=identicon&r=PG", "display_name": "McAngus", "link": "https://stackoverflow.com/users/1097517/mcangus"}, "edited": false, "score": 0, "creation_date": 1459649236, "post_id": 36380585, "comment_id": 60379054, "body": "You are correct, this is what I have been doing. The reason I am looking for an alternative is that the number of Haskell lines is a lot less than the number of C# or Java lines for the equivalent."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1459649500, "post_id": 36380585, "comment_id": 60379135, "body": "yes, <code>instanceof</code> checks will be like constructor pattern matching in Haskell.  Number of lines won&#39;t be comparable since Haskell has a very sophisticated type system.  I&quot;m not sure about C# but C++ has a primitive Union type whereas  Java doesn&#39;t."}, {"owner": {"reputation": 3663, "user_id": 3909293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G9txC.png?s=128&g=1", "display_name": "Diligent Key Presser", "link": "https://stackoverflow.com/users/3909293/diligent-key-presser"}, "edited": false, "score": 0, "creation_date": 1459654977, "post_id": 36380585, "comment_id": 60380127, "body": "@karakfa C# allows to emulate unions from C++ with <code>StructLayout</code> attribute."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1459646043, "creation_date": 1459646043, "answer_id": 36380585, "question_id": 36379888, "link": "https://stackoverflow.com/questions/36379888/haskell-data-equivalent-in-object-oriented-language/36380585#36380585", "title": "Haskell &quot;data&quot; equivalent in Object Oriented Language", "body": "<p>java equivalent of </p>\n\n<pre><code>data A = B Float\n       | C Int\n       | D [B]\n</code></pre>\n\n<p>can be written as such</p>\n\n<pre><code>interface A {};  // marker interface\nclass B implements A {\n    final float value;\n    B(float value) {this.value=value;}   // constructor\n}\nclass C implements A {\n    final int value;\n    C(int value) {this.value=value;}     // constructor\n}\nclass D implements A {\n    final B[] values;\n    D(B[] values) {this.values=values;}  // constructor\n}\n</code></pre>\n\n<p>etc.</p>\n"}, {"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": false, "score": 2, "last_activity_date": 1459676045, "last_edit_date": 1459676045, "creation_date": 1459675336, "answer_id": 36383660, "question_id": 36379888, "link": "https://stackoverflow.com/questions/36379888/haskell-data-equivalent-in-object-oriented-language/36383660#36383660", "title": "Haskell &quot;data&quot; equivalent in Object Oriented Language", "body": "<p>You can implement any ADT in C# that has at least one constructor. I do not know of any implementation for <code>data Void</code>. The products are easy, as these are simply classes or structs, but sums are not native to the language and so you have to do some extra work.</p>\n\n<pre><code>data Example a =\n    Foo { foo :: a }\n  | Bar { bar :: a, qux :: Int }\n</code></pre>\n\n<p>This is the example I will implement using the usual <em>tagged union</em>. You can define a union like in C but this is unusual in C#. Instead I will use an extra indirection, but the principle is the same. From the example I give it should be clear how to extrapolate to any ADT.</p>\n\n<pre><code>// Sealed because we don't want subtypes of our ADT.\npublic sealed class Example&lt;A&gt;\n{\n  // A class for each constructor.\n  // Sealed because we cannot allow subtypes to be defined and used.\n  public sealed class Foo\n  {\n    public readonly A foo;\n    public Foo(A foo) { this.foo = foo; }\n  }\n\n  // A class for each constructor.\n  // Sealed because we cannot allow subtypes to be defined and used.\n  public sealed class Bar\n  {\n    public readonly A bar;\n    public readonly int qux;\n    public Bar(A bar, int qux) { this.bar = bar; this.qux = qux; }\n  }\n\n  // An enum of constructors.\n  // Private because this is an implementation detail.\n  private enum Tag : byte\n  {\n    Foo,\n    Bar\n  }\n\n  // Store the constructor used.\n  // Private because this is an implementation detail.\n  private readonly Tag TheTag;\n\n  // Store the term object.\n  // Private because we will define safe case analysis to access\n  // this value later.\n  private readonly object Term;\n\n  // The only constructor.\n  // Private because we are going to define proper ways to\n  // construct Example`1 later.\n  private Example(Tag tag, object term)\n  {\n    TheTag = tag;\n    Term = term;\n  }\n\n  // Case analysis. This is how you get the value back out.\n  // This is like case/of or the functions \"maybe\", \"either\", etc.\n  public B Cases&lt;B&gt;(Func&lt;Foo,B&gt; caseFoo, Func&lt;Bar,B&gt; caseBar)\n  {\n    // Because we defined an enum we can use an efficient switch\n    // statement to jump directly to the correct branch.\n    switch (TheTag)\n    {\n      // These casts are guaranteed to be safe because of the\n      // functions we define to construct Example`1's.\n      case Tag.Foo: return caseFoo((Foo)Term);\n      case Tag.Bar: return caseBar((Bar)Term);\n      // C# does not check the exhaustiveness of the switch statement\n      // so we have to throw something here unfortunately.\n      default: throw new Exception(\"missing case!\");\n    }\n  }\n\n  // This constructs an Example`1 with the Foo constructor.\n  public static Example&lt;A&gt; Create(Foo term)\n  {\n    return new Example&lt;A&gt;(Tag.Foo, term);\n  }\n\n  // This constructs an Example`1 with the Bar constructor.\n  public static Example&lt;A&gt; Create(Bar term)\n  {\n    return new Example&lt;A&gt;(Tag.Bar, term);\n  }\n\n  // You can define whatever other conveniences you want!\n\n}\n</code></pre>\n\n<p>When I implement an ADT in C# I am trying to come as close as I can to Haskell. If <code>Example&lt;A&gt;</code> was not sealed then subtypes could be defined, but this is not something you can do with ADTs in Haskell. If <code>Foo</code> or <code>Bar</code> were not sealed then subtypes could be defined, but Haskell does not feature subtyping a constructor.</p>\n\n<p>C# has <code>null</code> and there is nothing that can be done about it, so I have to ignore that as a possibility. If you're working with certain ADTs such as <code>Maybe</code>, or any ADT with a zero-argument constructor then you can use a struct and avoid the <code>null</code> problem. I will example this later.</p>\n\n<p>Constructing <code>Example&lt;A&gt;</code> should work like it does in Haskell. That is why the only publicly available ways to construct <code>Example&lt;A&gt;</code> is through <code>Create(Foo)</code> and <code>Create(Bar)</code>. You could refactor to use C# constructors for this, but actually in C# constructors are inconvenient because they do not benefit from type inference nor can they be typed as delegates. In fact, to infer the type parameter <code>A</code> you would define a second static class called <code>Example</code> and define two <code>Create</code> methods there, just as <code>Tuple.Create</code> is.</p>\n\n<p>Case analysis should also work as it does in Haskell. Unlike <code>Nullable&lt;T&gt;</code>, for example, this solution is impossible to use incorrectly (barring reflection, which can ruin anything). This may cost performance and may cost readability sometimes but that can be a worthwhile tradeoff for correctness.</p>\n\n<p>With constructors and case analysis taken care of we're done.</p>\n\n<p>You will not get away with the brevity of Haskell's ADTs in C#. I recommend using code generation to overcome this problem. Also, if you do find time to make such a tool, please share!</p>\n\n<p>Finally I offer an implementation for <code>Maybe&lt;A&gt;</code>. This implementation is special because unlike <code>Example&lt;A&gt;</code> it does not have any unwanted values (<code>Example&lt;A&gt;</code> unfortunately has the value <code>null</code>). You can achieve the same for any ADT which has a zero-argument constructor.</p>\n\n<pre><code>// A struct instead of a sealed class. This means instead of\n// null we have the implicit empty constructor. The empty\n// constructor initializes all fields to their default values\n// which is determined by their type.\n//\n// The trick here is that default(Maybe&lt;A&gt;) = Maybe&lt;A&gt;.Nothing().\n//\npublic struct Maybe&lt;A&gt;\n{\n  // Same as before.\n  private enum Tag : byte\n  {\n    // Must be 0, because this is the default value of any enum.\n    Nothing = 0,\n    Just = 1\n  }\n\n  // By default is Nothing\n  private readonly Tag TheTag;\n\n  // Can use type A instead of object. Saves a cast.\n  private readonly A Value;\n\n  // Same as before.\n  private Maybe(Tag theTag, A value)\n  {\n    TheTag = theTag;\n    Value = value;\n  }\n\n  // Same as before.\n  public B Cases&lt;B&gt;(Func&lt;B&gt; caseNothing, Func&lt;A,B&gt; caseJust)\n  {\n    switch (TheTag)\n    {\n      case Tag.Nothing: return caseNothing();\n      case Tag.Just: return caseJust(Term);\n      default: throw new Exception(\"missing case!\");\n    }\n  }\n\n  // Same as before.\n  public static Maybe&lt;A&gt; Nothing()\n  {\n    return new Maybe&lt;A&gt;(Tag.Nothing, default(A));\n  }\n\n  // Same as before.\n  public static Maybe&lt;A&gt; Just(A value)\n  {\n    return new Maybe&lt;A&gt;(Tag.Just, value);\n  }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1714, "user_id": 1097517, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/60ea0ac47e08c82ea6d4948ef04a4c5b?s=128&d=identicon&r=PG", "display_name": "McAngus", "link": "https://stackoverflow.com/users/1097517/mcangus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459686437, "creation_date": 1459639790, "last_edit_date": 1459686437, "question_id": 36379888, "link": "https://stackoverflow.com/questions/36379888/haskell-data-equivalent-in-object-oriented-language", "title": "Haskell &quot;data&quot; equivalent in Object Oriented Language", "body": "<p>In Haskell you can easily define a complex structure in a few lines. A small example being:</p>\n\n<pre><code>data A = B Float\n       | C Int\n       | D [D]\n\ndata D = E [A]\n       | F Int\n</code></pre>\n\n<p>To convert this to an object oriented language, would you have to create a class for <code>A-F</code> then use inheritance to define this same structure? Or is there some other short hand?</p>\n\n<p>I have an assignment which the data types are specified in Haskell, and I (mistakenly) chose C# but it is too late to go back now.</p>\n"}, {"tags": ["haskell", "module"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6150218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f51bf3df5c8cda28c37f7d858f07f8e?s=128&d=identicon&r=PG&f=1", "display_name": "user6150218", "link": "https://stackoverflow.com/users/6150218/user6150218"}, "edited": false, "score": 0, "creation_date": 1459632242, "post_id": 36378867, "comment_id": 60375141, "body": "Of course; I should have thought of that!  I will accept this answer once the time window passes."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 3, "last_activity_date": 1459632141, "creation_date": 1459632141, "answer_id": 36378867, "question_id": 36378777, "link": "https://stackoverflow.com/questions/36378777/haskell-refer-to-values-in-own-module/36378867#36378867", "title": "Haskell refer to values in own module", "body": "<p>Change your import to</p>\n\n<pre><code>import qualified Very.Long.Module.Name.To.Be.Wrapped as M\n</code></pre>\n\n<p>Then you will only have to qualify references to M.fun - unqualified <code>fun</code> will refer unambiguously to the current module's version.</p>\n"}], "owner": {"reputation": 13, "user_id": 6150218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f51bf3df5c8cda28c37f7d858f07f8e?s=128&d=identicon&r=PG&f=1", "display_name": "user6150218", "link": "https://stackoverflow.com/users/6150218/user6150218"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 36378867, "answer_count": 1, "score": 1, "last_activity_date": 1459632141, "creation_date": 1459631684, "question_id": 36378777, "link": "https://stackoverflow.com/questions/36378777/haskell-refer-to-values-in-own-module", "title": "Haskell refer to values in own module", "body": "<p>I am writing a module that basically wraps functionality provided by another module, so there are a several instances of values with the same name imported into the same scope, and I have to disambiguate by prepending the module that I want to use.  I know that I can import the other module under a shorter name (using an <code>as</code> clause), but is there any way to reference values in the current module in the same way?  I have tried importing myself qualified, but that causes a cyclic import.</p>\n\n<p>To clarify, I am looking for something along the lines of:</p>\n\n<pre><code>module Very.Long.Wrapper.Module.Name (fun) as Self where\n\nimport Very.Long.Module.Name.To.Be.Wrapped as M\n\nSelf.fun = doSomethingWith M.fun\n</code></pre>\n\n<p>or anything else that will let me do the last line without the entire module name.</p>\n"}, {"tags": ["haskell", "gtk", "gtk2hs"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1459641690, "post_id": 36378409, "comment_id": 60377627, "body": "Are you trying to draw the entire Mandelbrot in the <code>expose</code> event? If so, you are blocking the GTK+ main loop and not allowing other events to occur until after the Mandelbrot is finished. What you could do is calculate the points in another thread and send them back to the GUI thread via the <code>gdk_threads_add_idle()</code> function, which then calls <code>gtk_widget_queue_draw_area()</code> to request a re-expose of the given pixel. (How to store the pixel values for redraw is up to you.) I don&#39;t know how that&#39;s used from Haskell though, sorry."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1459678901, "post_id": 36378409, "comment_id": 60385441, "body": "hello, unfortunately, it&#39;s not sufficient enough to allow me to finish my program. I&#39;m not enough experimented in haskell to modify it, but I found something interesting at <a href=\"https://wiki.haskell.org/Gtk2Hs/Tutorials/ThreadedGUIs\" rel=\"nofollow noreferrer\">wiki.haskell.org/Gtk2Hs/Tutorials/ThreadedGUIs</a>, if someone could show me how to modify that would be nice!"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1459773856, "post_id": 36378409, "comment_id": 60422284, "body": "@andlabs isn&#39;t the function you gave me a C function? I mean, I won&#39;t be able to insert it to my haskell code, no? please have a look at my new code, but if I well understood you, the problem comes from the &quot;expose&quot; call. Can you help me more?"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1459778746, "post_id": 36378409, "comment_id": 60426018, "body": "They are C functions, but those give you the hint as to what to look for. You will need to check your Haskell documentation to see what the equivalent is. I don&#39;t know Haskell; sorry."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459787039, "post_id": 36378409, "comment_id": 60431793, "body": "So, you you update <i>this</i> to not need a ui file? And, try to avoid code duplication."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1459868865, "post_id": 36378409, "comment_id": 60474764, "body": "hello, nothing new? I tried to put onExpose as the first argument of mapM_, in order to get rid of the sessions which are created at each call to onExpose, but in this code nothing appears in the canvas... I am desperate."}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1459795730, "creation_date": 1459629303, "last_edit_date": 1459795730, "question_id": 36378409, "link": "https://stackoverflow.com/questions/36378409/haskell-gtk-how-to-draw-points-as-soon-as-they-are-computed", "title": "Haskell &amp; Gtk : how to draw points as soon as they are computed", "body": "<p>I created a working program displaying the Mandelbrot set, but the whole set is displayed after all is computed; I wonder which changes of the code I must do in order to have a points displayed as soon as it's known if it belongs to the set or not.</p>\n\n<p>Here is my program; the beginning is not very important, it's more or less common to all programs using Gtk:</p>\n\n<pre><code>module Main where\n\nimport           Control.Monad            (when)\nimport           Graphics.Rendering.Cairo as C\nimport           Graphics.UI.Gtk\nimport           Graphics.UI.Gtk.Builder  ()\n\n\nmain :: IO()\nmain = do\n    _ &lt;- initGUI\n\n    window &lt;- windowNew\n    windowSetPosition window WinPosCenter\n    windowSetDefaultSize window 500 350\n    set window [windowTitle := \"Ensemble de Mandelbrot\"]\n    on window objectDestroy mainQuit\n\n    canvas &lt;- drawingAreaNew\n    canvas `on` sizeRequest $ return (Requisition 450 300)\n    window `containerAdd` canvas\n\n    _ &lt;- onExpose canvas $ const (updateCanvas canvas)\n\n    widgetShowAll window\n    mainGUI\n\n\nupdateCanvas :: DrawingArea -&gt; IO Bool\nupdateCanvas canvas = do\n  win &lt;- widgetGetDrawWindow canvas\n  (width, height) &lt;- widgetGetSize canvas\n  _ &lt;- mapM_ (affiche win)  (points (fromIntegral width) (fromIntegral height))\n\n  return True\n\nk :: Int\nk=100 -- 100 : after launching, u must wait less than 10s\n\nmandelbrot :: Double -&gt; Double -&gt; Bool\nmandelbrot a b =\n  let\n    mandelrec :: Double -&gt; Double -&gt; Int -&gt; Bool\n    mandelrec x y i\n      | (x * x + y * y &gt; 4) = False\n      | (i==k) &amp;&amp; (x * x + y * y &lt;= 4) = True\n      | otherwise = mandelrec x' y' (i+1)\n            where x' = x * x - y * y + a\n                  y' = 2 * x * y + b\n  in mandelrec 0 0 0\n\naffiche2 :: DrawWindow -&gt; Double -&gt; Double -&gt; IO()\naffiche2 win a b = renderWithDrawable win $ do\n    setSourceRGB 0 0 0\n    setLineWidth 1\n    C.rectangle a b 1 1 \n    stroke\n\n\naffiche :: DrawWindow -&gt; ((Double,Double), (Double,Double)) -&gt; IO ()\naffiche win ((a0,a), (b0,b)) = when (mandelbrot a b) $ postGUIAsync (affiche2 win a0 b0)\n\ncolonnes :: Double -&gt; [(Double, Double)]\ncolonnes w = [ (t,t/w*4-2) | t&lt;-[0..(w-1)] ]\n\nlignes :: Double -&gt; [(Double, Double)]\nlignes h = [ (t,t/h*4-2) | t&lt;-[0..(h-1)] ]\n\npoints :: Double -&gt; Double -&gt; [((Double, Double), (Double, Double))]\npoints w h = [ (colonne,ligne)| colonne &lt;- colonnes w,ligne &lt;- lignes h]\n</code></pre>\n"}, {"tags": ["algorithm", "haskell", "random"], "comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1459628628, "post_id": 36378250, "comment_id": 60374006, "body": "Also, I&#39;m aware of <a href=\"http://lpaste.net/158197\" rel=\"nofollow noreferrer\">this</a>. But that requires the generated values to be pseudorandomish. I just need them to not collide, so it could be the most predictable thing. I guess that is not the same problem, but excuse me if it is."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1459628645, "post_id": 36378250, "comment_id": 60374012, "body": "I don&#39;t think this is achievable. If you want N splittings to generate distinct numbers, then they must generate 2^N distinct numbers, hence most of these must be comparable to 2^N."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459628840, "post_id": 36378250, "comment_id": 60374057, "body": "I don&#39;t need that all possible splittings generate different numbers. I just need that a <b>small sample</b> of random splitting sequences is very unlikely to have a collision. (<code>like: sample = [sa, sb, sc, sd, se]</code>, where those are obtained from splitting a root seed and getting fst/snd and so on)"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459629015, "post_id": 36378250, "comment_id": 60374106, "body": "Basically, I have a graph rewriting system on which nodes can have children and all nodes need an unique global id. So, whenever a node reproduces, it must come up with two different ids that must be different from any other id on the graph, without global synchronization. Edit: also, I&#39;ll never have as much as 2^64 nodes, so the space will never be fully saturated. I just want a simple fair way to split values through that space."}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1459633362, "post_id": 36378801, "comment_id": 60375516, "body": "I have no idea how that black magic works, but looks reliable. Thanks!"}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": false, "score": 2, "last_activity_date": 1459631770, "creation_date": 1459631770, "answer_id": 36378801, "question_id": 36378250, "link": "https://stackoverflow.com/questions/36378250/how-do-i-cheaply-produce-an-infinite-splittable-stream-of-non-colliding-numbers/36378801#36378801", "title": "How do I cheaply produce an infinite splittable stream of non-colliding numbers from a single seed?", "body": "<p>Unfortunately, I can't prove any statistical properties on the following, so it is just a heuristic. It is based on the <a href=\"https://en.wikipedia.org/wiki/Xorshift#xorshift.2A\" rel=\"nofollow\">xorshift</a> family of pseudo-random sequence generators, which is known to be very fast.</p>\n\n<p>Consider the <a href=\"https://en.wikipedia.org/wiki/Xorshift#xorshift.2A\" rel=\"nofollow\">xorshift* algorithm</a>, here shown in C:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nuint64_t x; /* The state must be seeded with a nonzero value. */\n\nuint64_t xorshift64star(void) {\n    x ^= x &gt;&gt; 12; // a\n    x ^= x &lt;&lt; 25; // b\n    x ^= x &gt;&gt; 27; // c\n    return x * UINT64_C(2685821657736338717);\n}\n</code></pre>\n\n<p>The explanation in the wikipedia entry states:</p>\n\n<blockquote>\n  <p>A xorshift* generator takes a xorshift generator, and applies an invertible multiplication (modulo the word size) to its output as a non-linear transformation.</p>\n</blockquote>\n\n<p>The heuristic algorithm I suggest is:</p>\n\n<ul>\n<li><p>Give the head node some nonzero value <code>x</code>.</p></li>\n<li><p>For each split, run the algorithm above with <code>x</code> at the beginning as the value of the parent. However, for the return value</p>\n\n<ul>\n<li><p>for the left child, replace the last line with <code>return x;</code> (essentially the classic <code>xorshift</code> algorithm)</p></li>\n<li><p>for the right child, use the last line as stated above.</p></li>\n</ul></li>\n</ul>\n\n<p>At any node <em>u</em>, take any two nonidentical descendant paths leading to distinct <em>v</em> and <em>w</em>. Then either</p>\n\n<ul>\n<li><p><em>v</em> is a descendant of <em>w</em>, and thus at least either xorshift or xorshift* was applied at least once to the value of <em>w</em>  to obtain the value of <em>v</em>.</p></li>\n<li><p><em>w</em> is a descendant of <em>v</em>, and the same argument can be made.</p></li>\n<li><p>neither node is a parent of the other. In this case, at least a single non-linear transformation was made along the path leading from <em>u</em> to the lowest common ancestor of <em>v</em> and <em>w</em> (possibly <em>u</em> itself).</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1459633427, "post_id": 36379000, "comment_id": 60375533, "body": "This is either terribly wrong or a much better solution. I&#39;ll be researching this one. Thanks!"}, {"owner": {"reputation": 12959, "user_id": 166235, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/500f5311f76465693c5dc701f6250cf6?s=128&d=identicon&r=PG", "display_name": "Rotsor", "link": "https://stackoverflow.com/users/166235/rotsor"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1574343908, "post_id": 36379000, "comment_id": 104205880, "body": "@MaiaVictor, so which one is it? :-)"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1574619673, "post_id": 36379000, "comment_id": 104287292, "body": "I can&#39;t recall what I had for lunch. This was 3 years ago. Sorry you&#39;ll need to figure it out..."}], "tags": [], "owner": {"reputation": 12959, "user_id": 166235, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/500f5311f76465693c5dc701f6250cf6?s=128&d=identicon&r=PG", "display_name": "Rotsor", "link": "https://stackoverflow.com/users/166235/rotsor"}, "is_accepted": false, "score": 2, "last_activity_date": 1459632989, "creation_date": 1459632989, "answer_id": 36379000, "question_id": 36378250, "link": "https://stackoverflow.com/questions/36378250/how-do-i-cheaply-produce-an-infinite-splittable-stream-of-non-colliding-numbers/36379000#36379000", "title": "How do I cheaply produce an infinite splittable stream of non-colliding numbers from a single seed?", "body": "<p>Also starting with a disclaimer: I'm not a cryptographer and this might be really bad.</p>\n\n<p>However, you can try <code>\\x -&gt; (x*3+1, x*3+2)</code>. This relies on modulo-2^64 semantics for integer overflow. Quick tests didn't reveal any obvious collision patterns. The idea is that multiplication by 3 does not care about integer overflow. In particular, <code>3^n</code> is always different value from <code>2*3^n</code>, doesn't matter how big <code>n</code>.</p>\n\n<p>This is the test I've done:</p>\n\n<pre><code>import Control.Monad\nimport Data.Int\nimport Text.Printf\nimport System.Random (randomRIO)\nimport qualified Data.Set as Set\n\nsplit :: Int32 -&gt; (Int32, Int32)\nsplit x = (x * 3 + 1, x * 3 + 2)\n\nbools bias n =\n  replicateM n (randomRIO (0, 1.0) &gt;&gt;= \\x -&gt; if x &lt; bias then return False else return True)\n\ngogo bias =\n  bools bias 100000 &gt;&gt;= \\l -&gt; do\n    let things = scanl (\\x b -&gt; if b then fst (split x) else snd (split x)) 0 l\n    printf \"%.2f %d %d\\n\" bias (length things) (length $ Set.toList (Set.fromList things))\n    return things\n\nmain = do\n  things &lt;- mapM gogo [0.0 :: Double, 0.05 .. 1]\n  printf \"all  %d %d\\n\" (length $ concat things) (length $ Set.toList (Set.fromList $ concat things))\n\n\n\n0.00 100001 100001\n0.05 100001 100001\n0.10 100001 100001\n0.15 100001 100001\n0.20 100001 100001\n0.25 100001 100000\n0.30 100001 99997\n0.35 100001 99998\n0.40 100001 99999\n0.45 100001 99999\n0.50 100001 100001\n0.55 100001 100000\n0.60 100001 100001\n0.65 100001 100001\n0.70 100001 99998\n0.75 100001 99999\n0.80 100001 100001\n0.85 100001 100001\n0.90 100001 100001\n0.95 100001 100001\n1.00 100001 100001\nall  2100021 2099351\n</code></pre>\n\n<p>The number of collisions seems to roughly agree with what one might expect from a random sample of that size.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1459632989, "creation_date": 1459628273, "question_id": 36378250, "link": "https://stackoverflow.com/questions/36378250/how-do-i-cheaply-produce-an-infinite-splittable-stream-of-non-colliding-numbers", "title": "How do I cheaply produce an infinite splittable stream of non-colliding numbers from a single seed?", "body": "<p>I need a function <code>split : Word64 -&gt; (Word64, Word64)</code> that takes any Word64 and splits it into two different Word64s in a way that I can keep splitting children and grandchildren in any arbitrary order while avoiding a collision. That is, for any pair <code>sa, sb</code> of consecutive splittings of a seed (such as <code>sa = fst.split.fst.split$ seed</code>), <code>sa</code> must be different from <code>sb</code> with >99.99% odds.</p>\n\n<p>I've thought in using a <a href=\"http://szudzik.com/ElegantPairing.pdf\" rel=\"nofollow\">pairing function</a>, but that makes children exponentially bigger than parents, so, after a few splits there is an integer overflow. I need something that basically sends any value on the space of possible Word64 bits to two other values in a semi randomly fashion. Also, I need it to be as quick and simple as possible. The fewer instructions, the better. It is probably a very stupid calculation that I'm missing.</p>\n\n<p>What can be used here?</p>\n\n<p><em>Disclaimer: I have asked similar questions before, but now I finally have a better understanding of the problem and know exactly what I need.</em></p>\n"}, {"tags": ["haskell", "indentation"], "answers": [{"comments": [{"owner": {"reputation": 456, "user_id": 2899125, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d598986370ac4fc07224de45128ad429?s=128&d=identicon&r=PG&f=1", "display_name": "darwinsenior", "link": "https://stackoverflow.com/users/2899125/darwinsenior"}, "edited": false, "score": 0, "creation_date": 1459627964, "post_id": 36378052, "comment_id": 60373787, "body": "Thanks. But is there a reason why it is the case?"}, {"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "reply_to_user": {"reputation": 456, "user_id": 2899125, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d598986370ac4fc07224de45128ad429?s=128&d=identicon&r=PG&f=1", "display_name": "darwinsenior", "link": "https://stackoverflow.com/users/2899125/darwinsenior"}, "edited": false, "score": 0, "creation_date": 1459628490, "post_id": 36378052, "comment_id": 60373947, "body": "Because it was as if the body of the <code>do</code> block was not part of the function, and therefor it was as though you had an empty <code>do</code> block, which is why you got the error message you did."}], "tags": [], "owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "is_accepted": true, "score": 3, "last_activity_date": 1459626942, "creation_date": 1459626942, "answer_id": 36378052, "question_id": 36378026, "link": "https://stackoverflow.com/questions/36378026/haskell-indentation-block-last-statement-in-a-do-block-must-be-an-expression/36378052#36378052", "title": "Haskell indentation block &quot;last statement in a do-block must be an expression&quot;", "body": "<p>The body of <code>loop</code> needs to be indented more than its name. e.g.:</p>\n\n<pre><code>consumeLoop :: Server -&gt; NeovimRead -&gt; NeovimWrite -&gt; Neovim r st ()\nconsumeLoop server read write = do\n    status &lt;- liftIO $ takeMVar (status server)\n    if status == Running\n       then loop\n       else liftIO $ putMVar (status server) status\n  where\n    loop = do\n      action &lt;- liftIO $ readaction server\n      ...\n</code></pre>\n"}], "owner": {"reputation": 456, "user_id": 2899125, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d598986370ac4fc07224de45128ad429?s=128&d=identicon&r=PG&f=1", "display_name": "darwinsenior", "link": "https://stackoverflow.com/users/2899125/darwinsenior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 36378052, "answer_count": 1, "score": 1, "last_activity_date": 1459626942, "creation_date": 1459626725, "question_id": 36378026, "link": "https://stackoverflow.com/questions/36378026/haskell-indentation-block-last-statement-in-a-do-block-must-be-an-expression", "title": "Haskell indentation block &quot;last statement in a do-block must be an expression&quot;", "body": "<p>I am very confused about haskell indentation especially <code>do</code> block with <code>let</code> and <code>where</code></p>\n\n<p>I got the following error on line <code>action &lt;-</code> \"last statement in a do-block must be an expression\" How should I fix this?</p>\n\n<p>I have the following definition</p>\n\n<pre><code>type NeovimRead = Neovim r st Text\ntype NeovimWrite = Text -&gt; Neovim r st ()\n\nconsumeLoop :: Server -&gt; NeovimRead -&gt; NeovimWrite -&gt; Neovim r st ()\nconsumeLoop server read write = do\n    status &lt;- liftIO $ takeMVar (status server)\n    if status == Running\n       then loop\n       else liftIO $ putMVar (status server) status\n  where loop = do\n    action &lt;- liftIO $ readaction server\n    case action of\n      ReadBuffer -&gt; do\n        text &lt;- read\n        liftIO $ putMVar (buffer server) text\n      WriteBuffer -&gt; do\n        text &lt;- liftIO $ takeMVar (buffer server)\n        write text\n    liftIO $ putMVar (status server) Running\n    consumeLoop server read write\n</code></pre>\n"}, {"tags": ["haskell", "towers-of-hanoi"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1459622942, "post_id": 36377226, "comment_id": 60372284, "body": "Could you please document your function? What exactly is <code>n</code>? What exactly is <code>using</code>? And where did you find this algorithm?"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1459623185, "post_id": 36377226, "comment_id": 60372345, "body": "@dfeuer Sorry for that - I added an explanation. Please LMK if anything else is unclear. Thanks!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1459625158, "post_id": 36377226, "comment_id": 60372941, "body": "Note that <code>using</code> doesn&#39;t have to be specified as an argument; it is completely specified by <code>3 - (from + to)</code>."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1459626136, "post_id": 36377226, "comment_id": 60373241, "body": "@chepner Many thanks. That does indeed simplify the code in the first part of the question (now corrected/updated). The focus of the question is on the second part, though, that uses of the output from the first part to build the configurations."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1459649954, "post_id": 36377226, "comment_id": 60379234, "body": "Well, you could define functions <code>popNth :: Int -&gt; [[x]] -&gt; (x, [[x]])</code> and <code>pushNth :: Int -&gt; x -&gt; [[x]] -&gt; [[x]]</code> and define <code>changeConfig</code> in terms of that right?"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1459681348, "post_id": 36377226, "comment_id": 60386165, "body": "@jberryman Good idea, thanks! It&#39;s what I&#39;ll do."}], "answers": [{"tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": false, "score": 1, "last_activity_date": 1459687914, "last_edit_date": 1459687914, "creation_date": 1459687396, "answer_id": 36385540, "question_id": 36377226, "link": "https://stackoverflow.com/questions/36377226/transforming-towers-of-hanoi-movement-sequence-to-configuration-sequence/36385540#36385540", "title": "Transforming Towers Of Hanoi Movement Sequence To Configuration Sequence", "body": "<p>Thanks to kind help by chepner and jberryman, here's what I came up with.</p>\n\n<p>The function finding the movements is unchanged:</p>\n\n<pre><code>doHanoi :: Int -&gt; Int -&gt; Int -&gt; [(Int, Int)]\ndoHanoi 0 _ _ = []\ndoHanoi n from to = first ++ [(from, to)] ++ last \n    where\n        using = 3 - from - to;\n        first = doHanoi (n - 1) from using; \n        last = doHanoi (n - 1) using to\n</code></pre>\n\n<p>Now an auxiliary function, <code>changePeg es i from to new_e</code> returns the output to peg <code>i</code> assuming it contained elements <code>es</code>, its index was <code>i</code>, the movement was from <code>from</code> to <code>to</code>, and of element <code>new_e</code>.</p>\n\n<pre><code>changePeg :: [Int] -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; [Int]\nchangePeg es i from to new_e\n    | i == from = tail es\n    | i == to = new_e: es\n    | otherwise = es\n</code></pre>\n\n<p>Using this, <code>changeConfig</code> becomes</p>\n\n<pre><code>changeConfig :: [[Int]] -&gt; (Int, Int) -&gt; [[Int]]\nchangeConfig es (from, to) = new_es where\n    new_e = head $ es !! from;\n    new_es = [changePeg (es !! i) i from to new_e | i &lt;- [0.. 2]]\n</code></pre>\n\n<p>As before, the solution can be found with </p>\n\n<pre><code>&gt;&gt;&gt; scanl changeConfig [[0.. 2], [], []] (doHanoi 3 0 2)\n[[[0,1,2],[],[]],[[1,2],[],[0]],[[2],[1],[0]],[[2],[0,1],[]],[[],[0,1],[2]],[[0],[1],[2]],[[0],[],[1,2]],[[],[],[0,1,2]]]\n</code></pre>\n"}], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459687914, "creation_date": 1459621780, "last_edit_date": 1459687432, "question_id": 36377226, "link": "https://stackoverflow.com/questions/36377226/transforming-towers-of-hanoi-movement-sequence-to-configuration-sequence", "title": "Transforming Towers Of Hanoi Movement Sequence To Configuration Sequence", "body": "<p>As part of some \"self imposed homework\" on Haskell study, I did the classic solution of the Towers of Hanoi:</p>\n\n<pre><code>doHanoi :: Int -&gt; Int -&gt; Int -&gt; [(Int, Int)]\ndoHanoi 0 _ _ = []\ndoHanoi n from to = first ++ [(from, to)] ++ last \n    where\n        using = 3 - from - to;\n        first = doHanoi (n - 1) from using; \n        last = doHanoi (n - 1) using to\n</code></pre>\n\n<p>(where the meaning of <code>doHanoi n from to using</code> get the asequence of movements assuming the disks <code>0.. n - 1</code> are at peg <code>from</code>, and we need to move them to peg <code>to</code>.)</p>\n\n<p>This gives the sequence of movements, e.g.,</p>\n\n<pre><code>&gt;&gt;&gt; doHanoi 3 0 2\n[(0,2),(0,1),(2,1),(0,2),(1,0),(1,2),(0,2)]\n</code></pre>\n\n<p>I then wanted to see if I could transform the output into the set of configurations (i.e., initially, all rings are on the left peg, then there are intermediate configurations, finally all rings are on the right peg). I could do this by writing a <code>changeConfig</code> function</p>\n\n<pre><code>changeConfig :: [[Int]] -&gt; (Int, Int) -&gt; [[Int]]\nchangeConfig [e0:e0s, e1s, e2s] (0, 1) = [e0s, e0:e1s, e2s]\nchangeConfig [e0:e0s, e1s, e2s] (0, 2) = [e0s, e1s, e0:e2s]\nchangeConfig [e0s, e1:e1s, e2s] (1, 0) = [e1:e0s, e1s, e2s]\nchangeConfig [e0s, e1:e1s, e2s] (1, 2) = [e0s, e1s, e1:e2s]\nchangeConfig [e0s, e1s, e2:e2s] (2, 0) = [e2:e0s, e1s, e2s]\nchangeConfig [e0s, e1s, e2:e2s] (2, 1) = [e0s, e2:e1s, e2s]\n</code></pre>\n\n<p>then using <a href=\"https://www.haskell.org/hoogle/?hoogle=scanl\" rel=\"nofollow\"><code>scanl</code></a>:</p>\n\n<pre><code>&gt;&gt;&gt; scanl changeConfig [[0.. 2], [], []] (doHanoi 3 0 2 1)\n[[[0,1,2],[],[]],[[1,2],[],[0]],[[2],[1],[0]],[[2],[0,1],[]],[[],[0,1],[2]],[[0],[1],[2]],[[0],[],[1,2]],[[],[],[0,1,2]]]\n</code></pre>\n\n<p>While this works, I think I'm missing something in <code>changeConfig</code>: this is just an exhaustive enumeration of all configurations, in a setting that has some form of cyclic symmetry, that happened to work because there are three pegs, and would not scale well (in terms of LOC). What is the \"Haskellic\" way to write it?</p>\n"}, {"tags": ["haskell", "graph", "fractals", "gtk2hs"], "answers": [{"tags": [], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "is_accepted": false, "score": 1, "last_activity_date": 1459628922, "creation_date": 1459628922, "answer_id": 36378341, "question_id": 36376842, "link": "https://stackoverflow.com/questions/36376842/logical-error-in-the-display-of-the-mandelbrot-set-in-haskell/36378341#36378341", "title": "logical error in the display of the mandelbrot set in haskell", "body": "<p>well, it works now.</p>\n\n<p>I was not collecting all the points in the range [-2..2][-2..2] but only those placed in the diagonal.</p>\n\n<p>here is a valid code:</p>\n\n<pre><code>module Main where\n\nimport Graphics.UI.Gtk\nimport Graphics.UI.Gtk.Builder()\nimport Graphics.Rendering.Cairo as C\nimport Control.Monad (when)\n\n\nmain :: IO()\nmain = do\n    _ &lt;- initGUI\n    builder &lt;- builderNew\n    builderAddFromFile builder \"09-mandelbrot.ui\"\n\n    window   &lt;- builderGetObject builder castToWindow \"Figure de Mandelbrot\"\n    canvas &lt;- builderGetObject builder castToDrawingArea \"drawingarea1\"\n    _ &lt;- onExpose canvas $ const (updateCanvas canvas) \n\n    widgetShowAll window\n    mainGUI\n\n\nupdateCanvas :: DrawingArea -&gt; IO Bool\nupdateCanvas canvas = do\n  win &lt;- widgetGetDrawWindow canvas\n  (width, height) &lt;- widgetGetSize canvas\n  renderWithDrawable win $ example (fromIntegral width) (fromIntegral height)\n  return True\n\nk :: Int\nk=100\n\nmandelbrot :: Double -&gt; Double -&gt; Bool\nmandelbrot a b = \n  let \n    mandelrec :: Double -&gt; Double -&gt; Int -&gt; Bool \n    mandelrec x y i\n      | (x * x + y * y &gt; 4) = False\n      | (i==k) &amp;&amp; (x * x + y * y &lt;= 4) = True\n      | otherwise = mandelrec x' y' (i+1)\n            where x' = x * x - y * y + a\n                  y' = 2 * x * y + b\n  in mandelrec 0 0 0\n\naffiche2 :: Double -&gt; Double -&gt; Render()\naffiche2 a b = do\n  C.rectangle a b 1 1\n  stroke\n\naffiche :: ((Double,Double), (Double,Double)) -&gt; Render()\naffiche ((a0,a), (b0,b)) = when (mandelbrot a b) $ affiche2 a0 b0\n\ncolonnes w = [ (t,t/w*4-2) | t&lt;-[0..(w-1)] ]\nlignes h = [ (t,t/h*4-2) | t&lt;-[0..(h-1)] ]\npoints w h = [ (colonne,ligne)| colonne &lt;- colonnes w,ligne &lt;- lignes h]\n\nexample :: Double -&gt; Double -&gt; C.Render ()\nexample width height = do\n    setSourceRGB 0 0 0\n    setLineWidth 1\n\n    mapM_ affiche (points width height)\n    stroke\n</code></pre>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459628922, "creation_date": 1459619640, "question_id": 36376842, "link": "https://stackoverflow.com/questions/36376842/logical-error-in-the-display-of-the-mandelbrot-set-in-haskell", "title": "logical error in the display of the mandelbrot set in haskell", "body": "<p>I created a program whose purpose is to draw a fractal set (the manderbrot set) and it does not contain any syntax error, but only one pixel appears, not the set.</p>\n\n<p>here is my program:</p>\n\n<pre><code>module Main where\n\nimport Graphics.UI.Gtk\nimport Graphics.UI.Gtk.Builder()\nimport Graphics.Rendering.Cairo as C\nimport Control.Monad (when)\n\n\nmain :: IO()\nmain = do\n    _ &lt;- initGUI\n    builder &lt;- builderNew\n    builderAddFromFile builder \"09-mandelbrot.ui\"\n\n    window   &lt;- builderGetObject builder castToWindow \"Figure de Mandelbrot\"\n    canvas &lt;- builderGetObject builder castToDrawingArea \"drawingarea1\"\n    _ &lt;- onExpose canvas $ const (updateCanvas canvas) \n\n    widgetShowAll window\n    mainGUI\n\n\nupdateCanvas :: DrawingArea -&gt; IO Bool\nupdateCanvas canvas = do\n  win &lt;- widgetGetDrawWindow canvas\n  (width, height) &lt;- widgetGetSize canvas\n  renderWithDrawable win $ example (fromIntegral width) (fromIntegral height)\n  return True\n\nk=100\n\nmandelbrot :: Double -&gt; Double -&gt; Bool\nmandelbrot a b = \n  let \n    mandelrec :: Double -&gt; Double -&gt; Int -&gt; Bool \n    mandelrec x y i\n      | (x * x + y * y &gt; 4) = False\n      | (i==k) &amp;&amp; (x * x + y * y &lt;= 4) = True\n      | otherwise = mandelrec x' y' (i+1)\n            where x' = x * x - y * y + a\n                  y' = 2 * x * y + b\n  in mandelrec 0 0 0\n\naffiche :: (Double, Double) -&gt; Render()\naffiche (a, b) = when (mandelbrot a b) $ C.rectangle a b 1 1\n\ncolonnes w = [ t/w*4-2 | t&lt;-[0..(w-1)] ]\nlignes h = [ t/h*4-2 | t&lt;-[0..(h-1)] ]\n\n\nexample :: Double -&gt; Double -&gt; C.Render ()\nexample width height = do\n    setSourceRGB 0 0 0\n    setLineWidth 1\n\n    mapM_ affiche (zip (colonnes width) (lignes height))\n    stroke\n</code></pre>\n\n<p>I can give you explanations if needed.\nI already tested the functions lignes &amp; colonnes, it seems ok.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": true, "score": 8, "last_activity_date": 1459616964, "creation_date": 1459616964, "answer_id": 36376319, "question_id": 36376245, "link": "https://stackoverflow.com/questions/36376245/one-argument-insted-of-two-either/36376319#36376319", "title": "One argument insted of two. Either", "body": "<p>Type constructors, like normal functions, are curried in Haskell. That means you can give a constructor that takes two arguments, such as <code>Either</code>, one argument, and the result is a type constructor that needs only one argument to construct a full <code>Either</code>.</p>\n\n<p>The <code>Monad</code> typeclass is not for simple types, but for type constructors taking one argument. For example, you have <code>instance Monad Maybe</code>, but <code>Maybe</code> is not a type, it's a type constructor taking one argument. So you can't make <code>Either</code> an instance of <code>Monad</code>, since it takes two arguments, not one, and you can't make <code>Either a b</code> an instance, since it takes no arguments. You can make <code>Either a</code> an instance of monad.</p>\n\n<p>In Haskell, we say that a simple type has kind <code>*</code>, a type constructor taking one argument like <code>Maybe</code> has kind <code>* -&gt; *</code>, and <code>Either</code> has kind <code>* -&gt; * -&gt; *</code>. <code>Monad</code> wants something of kind <code>* -&gt; *</code>, and by supplying one type to <code>Either</code>, that's what you get.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 36376319, "answer_count": 1, "score": 0, "last_activity_date": 1459616964, "creation_date": 1459616643, "question_id": 36376245, "link": "https://stackoverflow.com/questions/36376245/one-argument-insted-of-two-either", "title": "One argument insted of two. Either", "body": "<pre><code>instance Monad (Either e) where\n        return = Right\n        Right m &gt;&gt;= k = k m\n        Left e  &gt;&gt;= _ = Left e\n</code></pre>\n\n<p>I found a such piece of code. It is not understandable for me because, after all, <code>Either</code> constructor type gets two arguments ( <code>Either a b</code> ) and here\ntook one. I don't understandy why it is possible.</p>\n"}, {"tags": ["haskell", "data-kinds"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1459616048, "post_id": 36375610, "comment_id": 60369705, "body": "Incidentally, what are you trying to achieve here? I notice a few code smells: dynamic typing, &quot;stringly typed&quot; type-level computation, <a href=\"https://typesandkinds.wordpress.com/2015/09/09/what-are-type-families/\" rel=\"nofollow noreferrer\">non-covering closed type families</a>. I wonder if your life might be easier if you were to reorganise your code around singleton values instead."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1459617200, "post_id": 36375610, "comment_id": 60370160, "body": "@BenjaminHodgson, yep, I don&#39;t like this approach, but here is what I am trying to solve: given a set of data constructors of different types, define a polymorphic function over that set that calls type-specific builder (some kind of XML template - data of a type <code>a</code> gets translated to an XML request of type <code>a</code>). For that, I need to load builders at run-time configuration, and pass to the function so that it can, given data of type <code>a</code>, retrieve the builder of type <code>a</code>, and then call it. That function is couple of functions away from <code>main</code>."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1459617755, "post_id": 36375610, "comment_id": 60370412, "body": "@BenjaminHodgson, I also considered <a href=\"https://www.schoolofhaskell.com/user/thoughtpolice/using-reflection\" rel=\"nofollow noreferrer\">reification approach</a> (basically, define a typeclass with the builder and the builder function, and pass the builder at runtime. However, the code I came up with in my head doesn&#39;t look clean either. Perhaps reification is a better approach, and I should create another question at SO."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1459623675, "post_id": 36375610, "comment_id": 60372490, "body": "I&#39;m concerned that you may be bringing imperative(/OO(/Java))-style thinking to a functional environment. To me this sounds like a textbook use-case for classes: <code>class ToXml a where { toXml :: a -&gt; Xml }</code>. No need for complicated code like this or <code>reflection</code>."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1459626388, "post_id": 36375610, "comment_id": 60373321, "body": "@BenjaminHodgson, however, <code>toXML</code> itself is run-time load from a file, not compile-time. In case it puts you at ease, I haven&#39;t programmed in imperative languages in long time :) It is just that this problem itself seems to be imperative - in main, we do this (this is a <code>heist</code> compiled builder actually): <code>aFn :: StateT AnAPI IO Builder &lt;- genBuilder &quot;curdir&quot; &quot;atemplate&quot;</code>. It probably isn&#39;t possible to instantiate a compile-time class with run-time <code>aFn</code> member."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1459632166, "post_id": 36375610, "comment_id": 60375114, "body": "This is an interesting situation. I suspect Haskell&#39;s dependently-typed facilities can be used to give a neat, typed way of doing what you need. However, the nature of the solution depends on a number of variables, such as whether the set of serialisable types is known and finite. I think this warrants a separate question with more details."}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1459645384, "post_id": 36375610, "comment_id": 60378344, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/108057/discussion-between-sal-and-benjamin-hodgson\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 4, "last_activity_date": 1459639757, "last_edit_date": 1459639757, "creation_date": 1459613969, "answer_id": 36375705, "question_id": 36375610, "link": "https://stackoverflow.com/questions/36375610/constructing-proxy-type-given-the-input/36375705#36375705", "title": "Constructing Proxy type given the input", "body": "<p>Use <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/other-type-extensions.html#scoped-type-variables\" rel=\"nofollow\">the <code>ScopedTypeVariables</code> extension</a>. This allows you to refer to <code>forall</code>-bound type variables in the body of the definition in which they are bound.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\ngetMapVal2 :: forall a s. (s ~ TypeKey a, Typeable a, KnownSymbol s) =&gt; Map.HashMap String Dynamic -&gt; a -&gt; Maybe a\ngetMapVal2 m ty = extract $ Map.lookup (symbolVal (Proxy :: Proxy (TypeKey a))) m\n</code></pre>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 36375705, "answer_count": 1, "score": 1, "last_activity_date": 1459639757, "creation_date": 1459613423, "question_id": 36375610, "link": "https://stackoverflow.com/questions/36375610/constructing-proxy-type-given-the-input", "title": "Constructing Proxy type given the input", "body": "<p>Given the code below which looks up type-specific information in <code>Data.HashMap</code> for a type, is it possible to define a new function <code>getMapVal2</code> as documented in the comments, to build the <code>TypeKey</code> argument given the type? </p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE DataKinds #-}\n\nimport Data.Monoid ((&lt;&gt;))\nimport Data.Proxy (Proxy(Proxy))\nimport GHC.TypeLits (KnownSymbol, Symbol, symbolVal)\nimport qualified Data.HashMap.Strict as Map (HashMap, empty, insert, lookup)\nimport Data.Dynamic\nimport GHC.Generics\nimport Data.Maybe (fromJust, isNothing, maybe)\n\ntype family TypeKey (a :: *) :: Symbol where\n    TypeKey Int = \"int\"\n    TypeKey T = \"trec\"\n\ndata T = T { aInt :: Int} deriving (Show, Generic, Typeable)\n\nextract ::(s ~ TypeKey a, Typeable a, KnownSymbol s) =&gt; Maybe Dynamic -&gt; Maybe a\nextract dyn = if (isNothing dyn) then Nothing else fromDynamic . fromJust $ dyn   \n\ngetMapVal :: (s ~ TypeKey a, Typeable a, KnownSymbol s) =&gt; Map.HashMap String Dynamic -&gt; String -&gt; Maybe a\ngetMapVal m k = extract $ Map.lookup k m \n\n{-- How do we get the TypeKey lookup for type a?\ngetMapVal2 :: (s ~ TypeKey a, Typeable a, KnownSymbol s) =&gt; Map.HashMap String Dynamic -&gt; a -&gt; Maybe a\ngetMapVal2 m ty = extract $ Map.lookup (symbolVal (Proxy :: Proxy (TypeKey ???))) m\n--}\n\nmain = do\n  let map = Map.insert (symbolVal (Proxy :: Proxy (TypeKey T))) (toDyn $ T {aInt=5}) Map.empty -- we insert some value in hashmap for type T - it is of same type\n      val = getMapVal map (symbolVal (Proxy :: Proxy (TypeKey T))) :: Maybe T -- now let us retrieve the value in map for Type T. We pass the SymbolVal ourselves\n    --val =  getMapVal2 map (T {aInt = 2}) -- now we want to lookup map value given something of a type T. Need getMapVal2 to build symbolval given the input type\n  print $ maybe \"\" show val -- prints value stored in Hashmap for type T which is: T {aInt=5}\n</code></pre>\n\n<p>This is just a toy code to test passing type specific configuration at run-time via <code>Data.HashMap</code> to a polymorphic function that acts on types of a typeclass.</p>\n"}, {"tags": ["haskell", "command-line-arguments", "optparse-generic"], "comments": [{"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 2, "creation_date": 1459617054, "post_id": 36375556, "comment_id": 60370096, "body": "I don&#39;t think, we need an <a href=\"https://stackoverflow.com/questions/tagged/optparse-generic\">optparse-generic</a> tag. What&#39;s wrong with <a href=\"https://stackoverflow.com/questions/tagged/command-line-parsing\">command-line-parsing</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 708134, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/36f1e433c4e029dcd48d6c5cae1e4600?s=128&d=identicon&r=PG", "display_name": "Lyndon Maydwell", "link": "https://stackoverflow.com/users/708134/lyndon-maydwell"}, "edited": false, "score": 2, "creation_date": 1511061888, "post_id": 36382477, "comment_id": 81699356, "body": "This seems to print the help text multiple times when you run with <code>--help</code>. Not sure how to address this..."}], "tags": [], "owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "is_accepted": true, "score": 3, "last_activity_date": 1459666484, "creation_date": 1459666484, "answer_id": 36382477, "question_id": 36375556, "link": "https://stackoverflow.com/questions/36375556/haskell-unnamed-command-line-arguments-for-optparse-generic/36382477#36382477", "title": "Haskell, unnamed command line arguments for optparse-generic", "body": "<p><code>optparse-generic</code> does not support generating such a parser from a single data type definition since Haskell does not support records with both labeled and unlabeled fields.</p>\n\n<p>However, what you can do is generate one data type for all the labeled fields and one type for the unlabeled fields and then combine them using <code>Applicative</code> operations, like this:</p>\n\n<pre><code>data Labeled = Labeled { foo :: Int } deriving (Generic, Show)\n\ninstance ParseRecord Labeled\n\ndata Unlabeled = Unlabeled String deriving (Generic, Show)\n\ninstance ParseRecord Unlabeled\n\ndata Mixed = Mixed Labeled Unlabeled deriving (Show)\n\ninstance ParseRecord Mixed where\n    parseRecord = Mixed &lt;$&gt; parseRecord &lt;*&gt; parseRecord\n</code></pre>\n"}], "owner": {"reputation": 7520, "user_id": 2143551, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vAzam.png?s=128&g=1", "display_name": "corny", "link": "https://stackoverflow.com/users/2143551/corny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 36382477, "answer_count": 1, "score": 3, "last_activity_date": 1459666484, "creation_date": 1459613140, "question_id": 36375556, "link": "https://stackoverflow.com/questions/36375556/haskell-unnamed-command-line-arguments-for-optparse-generic", "title": "Haskell, unnamed command line arguments for optparse-generic", "body": "<p>I'm using <a href=\"https://hackage.haskell.org/package/optparse-generic\" rel=\"nofollow\">optparse-generic</a> to parse the command line arguments of a program called <code>example</code>. I have a datatype with named fields (record syntax). For example:</p>\n\n<pre><code>data Example = Example { foo :: Int, bar :: String } deriving (Generic, Show)\n</code></pre>\n\n<p>This generates a program which can be called as follows:</p>\n\n<pre><code>./example --foo 42 --bar \"baz\"\n</code></pre>\n\n<p>How can I tell optparse-generic that <code>bar</code> should be an unnamed, mandatory, positional command line argument. That means, I don't want to type <code>--bar</code> when I call <code>example</code>. For example, I want to call <code>example</code> the following:</p>\n\n<pre><code>./example --foo 42 \"baz\"\n</code></pre>\n"}, {"tags": ["loops", "haskell", "side-effects"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459615554, "post_id": 36374883, "comment_id": 60369504, "body": "There is no reason to write floating point literals in the form <code>300.0</code> in Haskell; <code>300&#47;4</code> works just fine. It would make sense to give <code>colonnes</code> and <code>lignes</code> the correct <i>signature</i> though, i.e. <code>[Double]</code>."}, {"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 2, "creation_date": 1459616132, "post_id": 36374883, "comment_id": 60369731, "body": "Since you already seem to be familiar with list comprehensions, you might prefer droping <code>affiche</code> altogether and just using <code>sequence_ [C.rectangle a b 1 1 | a &lt;- colonnes, b &lt;- lignes, mandelbrot a b]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1459612411, "post_id": 36375312, "comment_id": 60368429, "body": "There&#39;s still the issue of the calls to <code>map</code>. I&#39;m not sure if that&#39;s something you want to address in this answer."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459615408, "post_id": 36375312, "comment_id": 60369454, "body": "Ah. <code>zip</code> is of course also curried, i.e. you need <code>zip colonnes lignes</code>, not <code>zip (colonnes, lignes)</code>. How did I miss this? (But as I said, <code>zip</code> is probably not the right thing anyway, here... test it out and see.)"}, {"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1459616252, "post_id": 36375312, "comment_id": 60369780, "body": "Since you already point out that Haskell is not an imperative language, I believe there&#39;s not much use in talking about &#39;statements&#39; (e.g. <code>if statement</code>)."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1459619317, "post_id": 36375312, "comment_id": 60371060, "body": "@leftaroundabout thanks, the compiler does not raise errors no more, but...the mandelbrot set doesn&#39;t appear. I will create an other topic for this error."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1459619695, "post_id": 36375312, "comment_id": 60371203, "body": "Ah, but a diagonal line does appear, won&#39;t it?"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1459702992, "post_id": 36375312, "comment_id": 60393467, "body": "@leftaroundabout hello, it works now but I am facing to a new challenge : pls have a look at #haskell and gtk : how to draw points as soon as they are computed# : it&#39;s the new question I submitted"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1459617641, "last_edit_date": 1459617641, "creation_date": 1459611804, "answer_id": 36375312, "question_id": 36374883, "link": "https://stackoverflow.com/questions/36374883/haskell-how-to-draw-some-pixels-side-effects-using-gtk-and-the-function-map/36375312#36375312", "title": "haskell : how to draw some pixels (side effects) using gtk and the function map", "body": "<p>The <code>if</code> construct in Haskell doesn't work like in other languages: it's actually the equivalent to the ternary <em>conditional operator</em> that's <code>? :</code> in C-like languages. That means, if you use <code>if ... then</code>, you <em>must</em> aways also have an <code>else</code> branch.</p>\n\n<p>The reason: Haskell isn't imperative; you don't write out <em>what should be done</em> but <em>what the result should be</em>. In an imperative language, you can <em>do nothing</em>, but in Haskell you always need to specify <em>some</em> result.</p>\n\n<p>Now, a monadic <code>do</code> block of course is basically an imperative embedded language. Here, you <em>can</em> just specify that a local result should be the <a href=\"https://en.wikipedia.org/wiki/NOP\" rel=\"nofollow\">no-op</a> action, to achieve that nothing is done at that point:</p>\n\n<pre><code>    affiche a b = do \n      if mandelbrot a b then \n        C.rectangle a b 1 1\n        return ()   -- note: `return` isn't needed here\n       else\n        return ()\n      return ()  -- nor here\n</code></pre>\n\n<p>A shorter way of writing this would be with the <a href=\"http://hackage.haskell.org/package/base/docs/Control-Monad.html#v:when\" rel=\"nofollow\"><code>when</code></a> combinator, which is basically if-then-else with a <code>return ()</code> in the else-branch:</p>\n\n<pre><code>    affiche a b = when (mandelbrot a b) $ C.rectangle a b 1 1\n</code></pre>\n\n<p>There's another problem with your code:</p>\n\n<pre><code>  in \n    map (\\t -&gt; t/300*4-2) colonnes      -- number list\n    map (\\t -&gt; t/200*4-2) lignes        -- number list\n    map affiche (zip (colonnes,lignes)) -- list of `Render ()` actions\n    stroke                              -- `Render ()` action\n</code></pre>\n\n<p>There, you just write out a couple of expressions of completely different types. You can't do that! What is Haskell supposed to <em>do</em> with these expressions?</p>\n\n<p>Well, evidently you want to <em>execute a sequence of actions</em>. Hence you need <code>do</code> again!</p>\n\n<pre><code>  in do\n    ...\n</code></pre>\n\n<p>But these lists you get from <code>map (\\t -&gt; t/300*4-2) colonnes</code> are not actions at all. You can't execute them, just <em>evaluate</em> them. In this case, apparently you want <code>colonnes</code> to be the <em>result</em> of mapping that function over the list <code>[0..299]</code>. Well, then why don't you specify this right away?</p>\n\n<pre><code>    colonnes = map (\\t -&gt; t/300*4-2) [0..299]\n    lignes = map (\\t -&gt; t/200*4-2) [0..199]\n</code></pre>\n\n<p>or, why not as a list comprehension</p>\n\n<pre><code>    colonnes = [ t/300*4-2 | t&lt;-[0..299] ]\n    lignes = [ t/200*4-2) t&lt;-[0..199] ]\n</code></pre>\n\n<p>Finally, you need to map <code>affiche</code> over the lists. That's in fact a &ldquo;monadic action map&rdquo;. The function for this is <a href=\"http://hackage.haskell.org/package/base/docs/Control-Monad.html#v:mapM_\" rel=\"nofollow\"><code>mapM_</code></a>, not <code>map</code>.</p>\n\n<pre><code>    colonnes = [ t/300*4-2 | t&lt;-[0..299] ]\n    lignes = [ t/200*4-2) t&lt;-[0..199] ]\n  in\n    mapM_ affiche $ zip colonnes lignes\n    stroke\n</code></pre>\n\n<p>Almost there, but not quite. If the signature of <code>affiche</code> would take a <em>tuple</em> of two numbers (you get such tuples from <code>zip</code>), then this would work. However, <code>affiche a b = do</code> means the function is <a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"nofollow\">curried</a> (as is customary in Haskell, in particularly also for <code>zip</code>!). You can easily undo that though</p>\n\n<pre><code>    mapM_ (uncurry affiche) $ zip colonnes lignes\n</code></pre>\n\n<p>but in this specific case I would actually recommend instead defining</p>\n\n<pre><code>    affiche :: (Float,Float) -&gt; C.Render ()\n    affiche (a,b) = when (mandelbrot a b) $ C.rectangle a b 1 1\n</code></pre>\n\n<p>because <code>a</code> and <code>b</code> really belong together, forming a single coordinate specification.</p>\n\n<p>There's one more problem: you've used <code>Float</code> numbers here. Well... <a href=\"https://wiki.haskell.org/Performance/Floating_point\" rel=\"nofollow\">it doesn't really make sense to do that, in Haskell</a>. At any rate, <a href=\"http://hackage.haskell.org/package/cairo-0.13.1.1/docs/Graphics-Rendering-Cairo.html#v:rectangle\" rel=\"nofollow\"><code>rectangle</code></a> needs <code>Double</code> as arguments, so either switch both <code>affiche</code> and <code>mandelbrot</code> to also take <code>Double</code>, or convert <code>a</code> and <code>b</code> before passing to <code>rectangle</code>:</p>\n\n<pre><code>    affiche :: (Float,Float) -&gt; C.Render ()\n    affiche (a,b) = when (mandelbrot a b)\n                  $ C.rectangle (realToFrac a) (realToFrac b) 1 1\n</code></pre>\n\n<p>Oh, and yet another thing: I don't think <code>zip</code> does the right thing here. But... figure this out yourself...</p>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 36375312, "answer_count": 1, "score": 1, "last_activity_date": 1459687963, "creation_date": 1459609530, "last_edit_date": 1459687963, "question_id": 36374883, "link": "https://stackoverflow.com/questions/36374883/haskell-how-to-draw-some-pixels-side-effects-using-gtk-and-the-function-map", "title": "haskell : how to draw some pixels (side effects) using gtk and the function map", "body": "<p>I am trying to learn <a href=\"https://hackage.haskell.org/package/gtk\" rel=\"nofollow\">gtk2hs</a>, an API wich allows haskell programs to use windows, menus, toolbars and graphs.</p>\n\n<p>I want to draw the Mandelbrot set, so I began to write the stuff, but I am stuck at the end, namely when I have to use side effects to draw each point of the Mandelbrot set.</p>\n\n<p>The datas are : I have a canvas (a drawing area) of 300px * 200px, and a function <code>mandelbrot :: Float -&gt; Float -&gt; Bool</code>, whose output is true if the point is in the mandelbrot set, and false otherwise.</p>\n\n<p>the work to achieve is : for each pixel (width : 0 to 300, height : 0 to 200), transform the coordinates to a range of [-2..2]*[-2..2], call the mandelbrot function, and if the result is true, call a function of the package <a href=\"http://hackage.haskell.org/package/cairo\" rel=\"nofollow\">Cairo</a> which draws the point. (The function is <a href=\"http://hackage.haskell.org/package/cairo-0.13.1.1/docs/Graphics-Rendering-Cairo.html#v:rectangle\" rel=\"nofollow\"><code>C.rectangle a b 1 1</code></a>.)</p>\n\n<p>My try: </p>\n\n<pre><code>example :: Double -&gt; Double -&gt; C.Render ()\nexample width height = do\n  setSourceRGB 0 0 0\n  setLineWidth 1\n\n  let \n    affiche a b = do \n      if (mandelbrot a b) then \n        C.rectangle a b 1 1\n        return()\n      return ()\n\n    colonnes = [0..299]\n    lignes = [0..199]\n  in \n    map (\\t -&gt; t/300*4-2) colonnes\n    map (\\t -&gt; t/200*4-2) lignes\n    map affiche (zip (colonnes,lignes))\n    stroke            -- it displays the changes on the screen\n</code></pre>\n\n<p>It triggers the error:\n- at the second <code>return</code>:</p>\n\n<pre><code>Error: Parse error: return\n</code></pre>\n\n<p>thanks</p>\n\n<p>EDIT:\nThanks a lot for your answer.\nI greatly improved my program, but I still have errors.</p>\n\n<p>here is the latest version:</p>\n\n<pre><code>affiche :: Double -&gt; Double -&gt; Render()\naffiche a b = when (mandelbrot a b) $ C.rectangle a b 1 1\n\ncolonnes = [ t/300.0*4.0-2.0 | t&lt;-[0.0..299.0] ]\nlignes = [ t/200.0*4.0-2.0 | t&lt;-[0.0..199.0] ]\n\n\nexample :: Double -&gt; Double -&gt; C.Render ()\nexample width height = do\n    setSourceRGB 0 0 0\n    setLineWidth 1\n\n    mapM_ (\\ (a, b) -&gt; affiche a b) (zip (colonnes,lignes))\n    stroke\n</code></pre>\n\n<p>and the error is:</p>\n\n<p>(all 2 at the line with \"mapM_\"):</p>\n\n<pre><code>*   Couldn't match type \u2018[(a0, b0)]\u2019 with \u2018(Double, Double)\u2019\n  Expected type: [b0] -&gt; (Double, Double)\n    Actual type: [b0] -&gt; [(a0, b0)]\n  In the second argument of \u2018mapM_\u2019, namely\n    \u2018(zip (colonnes, lignes))\u2019\n  In a stmt of a 'do' block:\n    mapM_ (\\ (a, b) -&gt; affiche a b) (zip (colonnes, lignes))\n\n\n*  Couldn't match expected type \u2018[a0]\u2019\n              with actual type \u2018([Double], [Double])\u2019\n  In the first argument of \u2018zip\u2019, namely \u2018(colonnes, lignes)\u2019\n  In the second argument of \u2018mapM_\u2019, namely\n    \u2018(zip (colonnes, lignes))\u2019\n  In a stmt of a 'do' block:\n    mapM_ (\\ (a, b) -&gt; affiche a b) (zip (colonnes, lignes))\n</code></pre>\n\n<p>I also have an other question : please confirm me that if a function returns the type \"Render()\" then all the statements inside it should return a value of this type.\nthanks</p>\n"}, {"tags": ["function", "haskell", "types"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1459608488, "post_id": 36374670, "comment_id": 60367094, "body": "It&#39;s <code>Integer</code>. <code>Integral</code> is a type class."}, {"owner": {"reputation": 2262, "user_id": 4551565, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3177185a7dbdb6bc72aee5f5554e53a?s=128&d=identicon&r=PG&f=1", "display_name": "Pigna", "link": "https://stackoverflow.com/users/4551565/pigna"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1459608783, "post_id": 36374670, "comment_id": 60367200, "body": "thanks, corrected, but I still get an error"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1459608909, "post_id": 36374670, "comment_id": 60367247, "body": "<code>&#47;</code> in <code>n*x*(x+1)&#47;2</code> is defined for only fractions. You may use <code>quot</code> or <code>div</code> instead."}, {"owner": {"reputation": 2262, "user_id": 4551565, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3177185a7dbdb6bc72aee5f5554e53a?s=128&d=identicon&r=PG&f=1", "display_name": "Pigna", "link": "https://stackoverflow.com/users/4551565/pigna"}, "edited": false, "score": 0, "creation_date": 1459612050, "post_id": 36374670, "comment_id": 60368328, "body": "I already did that when I rewrote sdb function"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1459612692, "post_id": 36374670, "comment_id": 60368511, "body": "opps - sorry - nevermind"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1459650058, "post_id": 36374670, "comment_id": 60379261, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2376981/haskell-types-frustrating-a-simple-average-function\">Haskell types frustrating a simple &#39;average&#39; function</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2262, "user_id": 4551565, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3177185a7dbdb6bc72aee5f5554e53a?s=128&d=identicon&r=PG&f=1", "display_name": "Pigna", "link": "https://stackoverflow.com/users/4551565/pigna"}, "edited": false, "score": 1, "creation_date": 1459614631, "post_id": 36375757, "comment_id": 60369207, "body": "shorter, of course, but slower :/ and it&#39;s a different algorithm from mine. I asked for a more idiomatic and/or concise way of writing the same algorithm because I&#39;m new to Haskell and I want to learn the best syntax"}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 2262, "user_id": 4551565, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3177185a7dbdb6bc72aee5f5554e53a?s=128&d=identicon&r=PG&f=1", "display_name": "Pigna", "link": "https://stackoverflow.com/users/4551565/pigna"}, "edited": false, "score": 1, "creation_date": 1459616426, "post_id": 36375757, "comment_id": 60369847, "body": "It is more idiomatic and concise. Looking at this code it is extremely easy to see what is actually going on, it&#39;s almost like a specification of the problem itself (Sum all numbers from 1 to 999 that are divisible by 3 or 5). I do agree that it is slower, but that would only matter if you where working with upper bounds of much higher than <code>999</code>."}, {"owner": {"reputation": 2262, "user_id": 4551565, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3177185a7dbdb6bc72aee5f5554e53a?s=128&d=identicon&r=PG&f=1", "display_name": "Pigna", "link": "https://stackoverflow.com/users/4551565/pigna"}, "edited": false, "score": 0, "creation_date": 1459618207, "post_id": 36375757, "comment_id": 60370607, "body": "oh sure, but I put 999 just as an example. Sorry for not being clear!"}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 2262, "user_id": 4551565, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3177185a7dbdb6bc72aee5f5554e53a?s=128&d=identicon&r=PG&f=1", "display_name": "Pigna", "link": "https://stackoverflow.com/users/4551565/pigna"}, "edited": false, "score": 0, "creation_date": 1459699407, "post_id": 36375757, "comment_id": 60392184, "body": "@Pigna, in that case your solution was good. I added a little more general one, see the edit."}], "tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": true, "score": 0, "last_activity_date": 1459699355, "last_edit_date": 1459699355, "creation_date": 1459614213, "answer_id": 36375757, "question_id": 36374670, "link": "https://stackoverflow.com/questions/36374670/sum-of-multiples-of-3-and-5-below-1000-in-haskell/36375757#36375757", "title": "sum of multiples of 3 and 5 below 1000 in Haskell", "body": "<p>How about this:</p>\n\n<pre><code>sum [x | x &lt;- [1..999], x `mod` 3 == 0 || x `mod` 5 == 0]\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>For a small upper bound like <code>999</code> this would be a more idiomatic and concise way, but if a more general solution is required, above would be too slow. Here is a better approach, which similarly to the questions itself, uses \"Gauss's trick\" to sum numbers divisible by <code>n</code>:</p>\n\n<pre><code>sumOfMults :: Integral a =&gt; a -&gt; a -&gt; a -&gt; a\nsumOfMults n1 n2 m = sdb n1 + sdb n2 - sdb (lcm n1 n2) where\n  sdb n = let x = m `div` n\n          in n * x * (x + 1) `div` 2\n</code></pre>\n"}], "owner": {"reputation": 2262, "user_id": 4551565, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3177185a7dbdb6bc72aee5f5554e53a?s=128&d=identicon&r=PG&f=1", "display_name": "Pigna", "link": "https://stackoverflow.com/users/4551565/pigna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 0, "accepted_answer_id": 36375757, "answer_count": 1, "score": 1, "last_activity_date": 1459699355, "creation_date": 1459608326, "last_edit_date": 1459608997, "question_id": 36374670, "link": "https://stackoverflow.com/questions/36374670/sum-of-multiples-of-3-and-5-below-1000-in-haskell", "title": "sum of multiples of 3 and 5 below 1000 in Haskell", "body": "<p>The following works fine:</p>\n\n<pre><code>sdb n = sum [n,n*2..999]\nmain = print $ sdb 3 + sdb 5 - sdb 15\n</code></pre>\n\n<p>But it's not that efficient since it has to sum 999/n times each time sdb is called.\nwhen I rewrote sdb:</p>\n\n<pre><code>sdb n = \n    let x = quot 999 n\n    in n*x*(x+1)/2\n</code></pre>\n\n<p>and <code>runhaskell</code> the whole code, I got an entire page of error. Summing it up:</p>\n\n<pre><code>... No instance for (Show a0) arising from a use of `print'\n... No instance for (Integral a0) arising from a use of `sdb'\n... No instance for (Num a0) arising from a use of `-'\n</code></pre>\n\n<p>I added type declaration for sdb:</p>\n\n<pre><code>sdb :: Integer -&gt; Integer\n</code></pre>\n\n<p>but I got another error:</p>\n\n<pre><code>No instance for (Fractional Integer) arising from a use of `/'\n    Possible fix: add an instance declaration for (Fractional Integer)\n    In the expression: n * x * (x + 1) / 2\n    In the expression: let x = quot 999 n in n * x * (x + 1) / 2\n    In an equation for `sdb':\n        sdb n = let x = quot 999 n in n * x * (x + 1) / 2\n</code></pre>\n\n<p>I don't get it.</p>\n\n<ol>\n<li><p>What should I correct? Can you also explain why I got those errors?\n<strong>SOLVED</strong>: I changed <code>/</code> with <code>div</code>.</p></li>\n<li><p>Is there a more idiomatic and/or concise way to write the same algorithm?</p></li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 4, "creation_date": 1459607281, "post_id": 36374399, "comment_id": 60366699, "body": "When learning Haskell, but type signatures on <i>everything</i>. What do you intend the type of <code>helper</code> to be? The equation for the <code>(h:t)</code> case has a different type than the equation for the <code>[]</code> case, hence the error."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 2, "creation_date": 1459618507, "post_id": 36374399, "comment_id": 60370720, "body": "What resources are you using to learn Haskell? Would you like pointers to other sources?"}], "answers": [{"comments": [{"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1459630676, "post_id": 36378533, "comment_id": 60374649, "body": "Thanks, but I am looking a &quot;raw&quot; solution -&gt; I mean using <code>&gt;&gt;=</code>"}, {"owner": {"reputation": 765, "user_id": 3316409, "user_type": "registered", "profile_image": "https://graph.facebook.com/719585406/picture?type=large", "display_name": "dvaergiller", "link": "https://stackoverflow.com/users/3316409/dvaergiller"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1459632901, "post_id": 36378533, "comment_id": 60375360, "body": "This solutions is the most concise one. You could probably replace <code>mapM</code> with something that uses <code>&gt;&gt;=</code> but... why?"}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1459632991, "post_id": 36378533, "comment_id": 60375391, "body": "because I don&#39;t understand monad and I do my best to understand it :)"}, {"owner": {"reputation": 765, "user_id": 3316409, "user_type": "registered", "profile_image": "https://graph.facebook.com/719585406/picture?type=large", "display_name": "dvaergiller", "link": "https://stackoverflow.com/users/3316409/dvaergiller"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1459687099, "post_id": 36378533, "comment_id": 60387836, "body": "Ah. I see! That&#39;s of course a good enough reason. Ingo seems to have that covered for you =)"}], "tags": [], "owner": {"reputation": 765, "user_id": 3316409, "user_type": "registered", "profile_image": "https://graph.facebook.com/719585406/picture?type=large", "display_name": "dvaergiller", "link": "https://stackoverflow.com/users/3316409/dvaergiller"}, "is_accepted": false, "score": 2, "last_activity_date": 1459629988, "creation_date": 1459629988, "answer_id": 36378533, "question_id": 36374399, "link": "https://stackoverflow.com/questions/36374399/monadic-excerise-haskell-i-cant-deal-with-that/36378533#36378533", "title": "Monadic excerise Haskell. I can&#39;t deal with that", "body": "<p>You could use the mapM function to monadically map over the words:</p>\n\n<pre><code>extractInt :: String -&gt; Either String [Int]\nextractInt s = mapM readEither (words s)\n</code></pre>\n\n<p>If any one call to readEither happens to return Left, then the function will do so too. Is that what you are looking for?</p>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 2, "last_activity_date": 1459687398, "last_edit_date": 1459687398, "creation_date": 1459639855, "answer_id": 36379899, "question_id": 36374399, "link": "https://stackoverflow.com/questions/36374399/monadic-excerise-haskell-i-cant-deal-with-that/36379899#36379899", "title": "Monadic excerise Haskell. I can&#39;t deal with that", "body": "<p>If you want \"something with >>=\" your helper function should look like:</p>\n\n<pre><code>helper [] = Right []\nhelper (w:ws) = readEither w &gt;&gt;= \\i -&gt; fmap (i:) (helper ws)\n</code></pre>\n\n<p>Explanation: Clearly, for an empty list of words, we want an empty list of integers. For a nonempty list, we do <code>readEither</code> on the first word, which gives us an <code>Either String Int</code>. The bind (>>=) will pass the resulting integer to the function on the right hand side, but only if the result was <code>Right</code> If it was <code>Left</code> this is the overall result of the helper.</p>\n\n<p>Now, the function on the right hand side of (>>=) applies the <code>helper</code> to the remaining words. As we know, this will result in <code>Either String [Int]</code>. Then it prepends the integer that resulted from conversion of the first word to the list in the <code>Right</code> result, if there is one. If, however, <code>helper</code> returned a <code>Left</code> value, the <code>fmap</code> won't change anything, and so this will be the overall result.</p>\n\n<p>So the 2nd line with the (>>=) expands approxiamtely to the following code:</p>\n\n<pre><code>case readEither w of\n    Left err  -&gt; Left err\n    Right int -&gt; case helper ws of\n        Left err -&gt; Left err\n        Right ints -&gt; Right (int:ints)\n</code></pre>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 36379899, "answer_count": 2, "score": -1, "last_activity_date": 1459687398, "creation_date": 1459606621, "question_id": 36374399, "link": "https://stackoverflow.com/questions/36374399/monadic-excerise-haskell-i-cant-deal-with-that", "title": "Monadic excerise Haskell. I can&#39;t deal with that", "body": "<p>I am trying to write my function which extract numbers from string, for example:</p>\n\n<pre><code>\"321 43 123 213\" -&gt; [321, 43, 123, 3212]\n\"dsa\" -&gt; Error\n\"123 da\" -&gt; Error\n</code></pre>\n\n<p>And I would like to do it using readEither and in monadic way ( I try to understand monads). My attemption:</p>\n\n<pre><code>import Text.Read\n\nunit :: Either String [Int]\nunit = Right []\n\nextractInt :: String -&gt; Either String [Int]\nextractInt s =  helper (words s) where\n    helper (h:t) = (bind readEither h) . (helper t)\n    helper [] = Right []\n\nbind :: (String -&gt; Either String Int) -&gt; String -&gt; (Either String [Int] -&gt; Either String [Int])\nbind f x z = bind' (f x) z where\n    bind' (Left s) _ = Left s\n    bind' (Right i) (Right l) =  Right (l ++ [i])\n    bind' (Left s) _  = Left s\n</code></pre>\n\n<ol>\n<li>Please help me solve my problem.</li>\n<li>Please say something my solution.</li>\n<li>Please say my how to do it correctly. ;)</li>\n</ol>\n\n<p>Error:</p>\n\n<pre><code>    Couldn't match expected type `a0 -&gt; Either String [Int]'\n                with actual type `Either a1 [t0]'\n    In the return type of a call of `Right'\n    Probable cause: `Right' is applied to too many arguments\n    In the expression: Right [1]\n    In an equation for `helper': helper [] = Right [1]\nFailed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["shell", "haskell", "io", "samba"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1459605603, "post_id": 36373902, "comment_id": 60366161, "body": "Off topic: I&#39;d use <code>proc</code> instead of <code>shell</code> -- the latter requires careful escaping and is very fragile, the former just takes the arguments."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1459605717, "creation_date": 1459605717, "answer_id": 36374236, "question_id": 36373902, "link": "https://stackoverflow.com/questions/36373902/haskell-system-process-gives-an-error-when-password-is-required/36374236#36374236", "title": "Haskell - System.Process gives an error when password is required", "body": "<p>Use <a href=\"http://hackage.haskell.org/package/process-1.4.2.0/docs/System-Process.html#v:readCreateProcess\" rel=\"nofollow\"><code>readCreateProcess</code></a>:</p>\n\n<pre><code>readCreateProcess :: CreateProcess -&gt; String -&gt; IO String   \n</code></pre>\n\n<p>The additional <code>String</code> will be passed to the command as standard input.</p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 36374236, "answer_count": 1, "score": 0, "last_activity_date": 1459605717, "creation_date": 1459603815, "question_id": 36373902, "link": "https://stackoverflow.com/questions/36373902/haskell-system-process-gives-an-error-when-password-is-required", "title": "Haskell - System.Process gives an error when password is required", "body": "<p>I am creating a Haskell program to automatically add a user to the system and then add it to samba, but it asks password, and I would like to use the same. I did not find any parameter we can use with <code>smbclient</code> to achieve such goal. What can I do?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>import System.Environment(getArgs)\nimport System.Process (createProcess, shell)\n\nmain = do\n  (user:pass:_) &lt;- getArgs\n  putStrLn $ \"Creating user \" ++ user ++ \" \" ++ pass ++ \"...\"\n  callCommand $ \"useradd \" ++ user\n  callCommand $ \"echo \\\"\" ++ user ++ \"\\\":\\\"\" ++ pass ++ \"\\\" | chpasswd\"  \n  putStrLn $ \"User Created. Adding it to samba...\"\n  callCommand $ \"smbpasswd -a \" ++ user\n\ncallCommand = createProcess . shell\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>-bash# runghc test.hs testUser 12345\nCreating user testUser 12345...\nUser Created. Adding it to samba...\nchpasswd: (user testUser) pam_chauthtok() failed, error:\nAuthentication token manipulation error\nchpasswd: (line 1, user testUser) password not changed\n-bash# New SMB password:\nRetype new SMB password:\nFailed to add entry for user testUser.\n</code></pre>\n\n<p>Can I pass the <code>pass</code> argument received from user to the <code>smbclient</code> program (or press Enter automatically), and avoid this error?</p>\n"}, {"tags": ["shell", "haskell", "io"], "answers": [{"comments": [{"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 0, "creation_date": 1459603497, "post_id": 36373298, "comment_id": 60365463, "body": "How can I check it? I&#39;ve just installed <code>haskell-platform</code> on a Debian system today (May 2nd, 2016), using <code>apt-get install haskell-platform</code>, shouldn&#39;t it be the newest??"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 0, "creation_date": 1459603959, "post_id": 36373298, "comment_id": 60365645, "body": "@FtheBuilder Are you writing from the future? If I move my mouse over the &quot;6 mins ago&quot; text beside your name the date shown is today 2 <b>April</b> 2016.  Anyway I believe Debian <i>might</i> use a slightly outdated version of haskell-platform."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1459604265, "post_id": 36373298, "comment_id": 60365764, "body": "@Bakuriu I made  a mistake. Well, that is fine."}], "tags": [], "owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "is_accepted": true, "score": 2, "last_activity_date": 1459600388, "creation_date": 1459600388, "answer_id": 36373298, "question_id": 36373234, "link": "https://stackoverflow.com/questions/36373234/haskell-system-process-callcommand-and-other-functions-are-not-available/36373298#36373298", "title": "Haskell - System.Process callCommand and other functions are not available", "body": "<p><code>callProcess</code> was added to the <a href=\"https://hackage.haskell.org/package/process\" rel=\"nofollow\"><code>process</code></a> library in version <code>1.2.0.0</code>. I suspect you are using an earlier version.</p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 36373298, "answer_count": 1, "score": 1, "last_activity_date": 1459600388, "creation_date": 1459600033, "question_id": 36373234, "link": "https://stackoverflow.com/questions/36373234/haskell-system-process-callcommand-and-other-functions-are-not-available", "title": "Haskell - System.Process callCommand and other functions are not available", "body": "<p>While reading the docs of <code>System.Process</code> and trying to use <code>callCommand</code> I discovered that it is not available:</p>\n\n<pre><code>test.hs:1:24: Module `System.Process' does not export `callCommand'\n</code></pre>\n\n<p>Why?</p>\n"}, {"tags": ["haskell", "servant"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1459598641, "post_id": 36372860, "comment_id": 60363898, "body": "You can do <code>serveDirectory</code> if your static pages are already in correct structure."}, {"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1459598774, "post_id": 36372860, "comment_id": 60363947, "body": "@zakyggaps, updated."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1459599137, "post_id": 36372860, "comment_id": 60364069, "body": "Servant APIs will be matched in order, top to bottom. You can put it at the last line."}, {"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1459599661, "post_id": 36372860, "comment_id": 60364238, "body": "@zakyggaps, in the 1st &quot;server&quot; I have serveDirectory &quot;static/&quot; and in 2nd I have &quot;getItems :&lt;|&gt; getItem&quot; . How can I combine them?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1459600159, "post_id": 36372860, "comment_id": 60364364, "body": "You cannot do that: <code>:&lt;|&gt;</code> is right associative, if <code>&quot;&#47;&quot; :&gt; Raw</code> is the last case you have to define your API with all the three cases in it like <code>case1 :&lt;|&gt; case2 :&lt;|&gt; case3</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1459600490, "post_id": 36372860, "comment_id": 60364466, "body": "@zakyggaps, what&#39;s the point for you of commenting here if you can write an answer?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1459600668, "post_id": 36372860, "comment_id": 60364507, "body": "Sorry, I was searching for a duplicate but didn&#39;t find one. I will try organize an answer."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "edited": false, "score": 0, "creation_date": 1459601087, "post_id": 36373394, "comment_id": 60364650, "body": "why isn&#39;t it <code>:&lt;|&gt; &quot;&quot; :&gt;  Raw</code> or <code>:&lt;|&gt; &quot;&#47;&quot; :&gt; Raw</code>? why merely <code>:&lt;|&gt; Raw</code>?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1459601224, "post_id": 36373394, "comment_id": 60364698, "body": "Both <code>Raw</code> and <code>&quot;&#47;&quot; :&gt; Raw</code> will point to the root path. I chose the shorter."}, {"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "edited": false, "score": 0, "creation_date": 1459601258, "post_id": 36373394, "comment_id": 60364711, "body": "actually <code>:&lt;|&gt; &quot;&quot; :&gt; Raw</code> and <code>:&lt;|&gt; &quot;&#47;&quot; :&gt; Raw</code> aren&#39;t working. The server doesn&#39;t return anything, like it&#39;s not found. I wonder why?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1459601823, "post_id": 36373394, "comment_id": 60364903, "body": "@OskarK. I cannot reproduce that. <code>&quot;&#47;&quot; :&gt; Raw</code> and <code>Raw</code> have the same consequence as I tried."}, {"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "edited": false, "score": 0, "creation_date": 1459602700, "post_id": 36373394, "comment_id": 60365187, "body": "do you know how can I handle the root case, that is, when I request &quot;localhost:1234&quot;, how can I return the page &quot;index.html&quot;? Meaning, I want to return &quot;index.html&quot; for both &quot;localhost:1234&quot; and &quot;localhost:1234/index.html&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "edited": false, "score": 0, "creation_date": 1459602814, "post_id": 36373394, "comment_id": 60365220, "body": "actually, it already returns index.html. Hm, why exactly index.html?"}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 7, "last_activity_date": 1459659179, "last_edit_date": 1459659179, "creation_date": 1459600975, "answer_id": 36373394, "question_id": 36372860, "link": "https://stackoverflow.com/questions/36372860/html-page-in-servant-how-to-combine-rest-api-and-static-html-pages/36373394#36373394", "title": "Html page in Servant -- how to combine REST API and static html pages?", "body": "<blockquote>\n  <p>how to combine REST API and static html pages?</p>\n</blockquote>\n\n<p>You may serve the directory containing your static website at root path by <code>serveDirectory</code>. It has to be the last case in your Servant API or other cases will never be matched.</p>\n\n<pre><code>type API = \n    \"api\" :&gt; \"items\" :&gt; Get '[JSON] [MyData] :&lt;|&gt;\n    \"api\" :&gt; \"items\" :&gt; Capture \"id\" Int :&gt; Get '[JSON] MyData :&lt;|&gt;\n    Raw\n\napi :: Proxy API \napi = Proxy\n\nserver :: Server API \nserver = getItems\n    :&lt;|&gt; getItem \n    :&lt;|&gt; serveDirectory \"static/\"\n</code></pre>\n\n<p>Also if any static page name crashes with your APIs it will be shadowed.</p>\n\n<hr>\n\n<blockquote>\n  <p>why isn't it <code>\"/\" :&gt; Raw</code>?</p>\n</blockquote>\n\n<p>Looks like my browser cached some static pages. <code>\"/\" :&gt; Raw</code> gives no response under <code>/index.html</code> after cleaned the cache.</p>\n\n<p>a string literal in api will be encoded to legal uri parts first, therefore <code>\"/\"</code> will be <code>\"%2F\"</code> and your files are mapped to <code>/%2F/index.html</code> and so on.</p>\n\n<hr>\n\n<blockquote>\n  <p>do you know how can I handle the root case?</p>\n</blockquote>\n\n<p>To serve a response at root path, you may define a <code>Get</code> endpoint with no prefix:</p>\n\n<pre><code>type API = Get '[HTML] RawHtml\n</code></pre>\n\n<p>It can be anywhere in your API except the last line.</p>\n\n<p>To serve a local file as html response you have to distinguish the file from other bytestrings, maybe wrap it in a newtype:</p>\n\n<pre><code>newtype RawHtml = RawHtml { unRaw :: BS.ByteString }\n\n-- tell Servant how to render the newtype to html page, in this case simply unwrap it\ninstance MimeRender HTML RawHtml where\n    mimeRender _ =  unRaw\n</code></pre>\n\n<p>and in your controller:</p>\n\n<pre><code>-- ...\n:&lt;|&gt; fmap RawHtml (liftIO $ BS.readFile \"your/file/path.html\")\n</code></pre>\n\n<p>Or if the page has another address already, you can redirect users there:</p>\n\n<pre><code>-- ...\n:&lt;|&gt; throwError err301 { errHeaders = [(\"Location\", \"index.html\")] }\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>it already returns index.html. Hm, why exactly index.html?</p>\n</blockquote>\n\n<p><code>serveDirectory</code> calls a wai application <code>staticApp</code> with a setting <code>defaultFileServerSettings</code>. In that setting users will be redirected to <code>index.htm</code> or <code>index.html</code> if something went wrong:</p>\n\n<pre><code>defaultFileServerSettings root = StaticSettings\n    { ssLookupFile = fileSystemLookup (fmap Just . hashFile) root\n    , ssMkRedirect = defaultMkRedirect\n    , ssGetMimeType = return . defaultMimeLookup . fromPiece . fileName\n    , ssMaxAge = NoMaxAge\n    , ssListing = Just defaultListing\n    , ssIndices = map unsafeToPiece [\"index.html\", \"index.htm\"]\n    , ssRedirectToIndex = False\n    , ssUseHash = False\n    , ssAddTrailingSlash = False\n    , ss404Handler = Nothing\n    }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1655, "favorite_count": 3, "accepted_answer_id": 36373394, "answer_count": 1, "score": 5, "last_activity_date": 1459659179, "creation_date": 1459597870, "last_edit_date": 1459601440, "question_id": 36372860, "link": "https://stackoverflow.com/questions/36372860/html-page-in-servant-how-to-combine-rest-api-and-static-html-pages", "title": "Html page in Servant -- how to combine REST API and static html pages?", "body": "<p>I have a simple hello world Servant application. I need to add some static or dynamic html pages to it. How can I do that? In the documentation it's not mentioned. Note I don't want to create a html layout in Haskell code, I want Haskell to show the html pages that's already created. </p>\n\n<p>UPDATE:</p>\n\n<p>How can I combine this:</p>\n\n<pre><code>type MyApi = \"/\" :&gt; Raw\n\nserver :: Server MyApi\nserver = serveDirectory \"static/\" -- index.html, about.html \n</code></pre>\n\n<p>with what I have already:</p>\n\n<pre><code>  type API = \n    \"api\" :&gt; \"items\" :&gt; Get '[JSON] [MyData] :&lt;|&gt;\n    \"api\" :&gt; \"items\" :&gt; Capture \"id\" Int :&gt; Get '[JSON] MyData\n\n\n  app :: Application\n  app = serve api server\n\n  api :: Proxy API\n  api = Proxy\n\n  server :: Server API\n  server = getItems :&lt;|&gt; getItem\n\n  startApp :: IO ()\n  startApp =  run 1234 app\n</code></pre>\n\n<p>UPDATE2:</p>\n\n<p>Working:</p>\n\n<pre><code>type API = \n    \"api\" :&gt; \"items\" :&gt; Get '[JSON] [MyData] :&lt;|&gt;\n    \"api\" :&gt; \"items\" :&gt; Capture \"id\" Int :&gt; Get '[JSON] MyData :&lt;|&gt;\n    Raw\n</code></pre>\n\n<p>Not working, no response at all:</p>\n\n<pre><code>type API = \n    \"api\" :&gt; \"items\" :&gt; Get '[JSON] [MyData] :&lt;|&gt;\n    \"api\" :&gt; \"items\" :&gt; Capture \"id\" Int :&gt; Get '[JSON] MyData :&lt;|&gt;\n    \"/\" :&gt; Raw\n\n-- or\n\ntype API = \n    \"api\" :&gt; \"items\" :&gt; Get '[JSON] [MyData] :&lt;|&gt;\n    \"api\" :&gt; \"items\" :&gt; Capture \"id\" Int :&gt; Get '[JSON] MyData :&lt;|&gt;\n    \"\" :&gt; Raw\n</code></pre>\n\n<p>I wonder why?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 7, "creation_date": 1459592217, "post_id": 36371956, "comment_id": 60362133, "body": "No difference but the order of the arguments. <code>mapM = flip forM</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1459592531, "post_id": 36371956, "comment_id": 60362193, "body": "you can have <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/src/Data.Traversable.html#forM\" rel=\"nofollow noreferrer\">a look</a> for yourself ;)"}, {"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1459596090, "post_id": 36371956, "comment_id": 60363118, "body": "By the way, both are deprecated since GHC 7.10. <code>for</code>/<code>traverse</code> should be used instead."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1459612578, "post_id": 36371956, "comment_id": 60368467, "body": "They aren&#39;t deprecated!"}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 6, "last_activity_date": 1459593707, "creation_date": 1459593707, "answer_id": 36372219, "question_id": 36371956, "link": "https://stackoverflow.com/questions/36371956/difference-between-mapm-and-form/36372219#36372219", "title": "difference between mapM and forM", "body": "<p><code>forM</code> is defined as <code>flip mapM</code> in <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/src/Data.Traversable.html#forM\"><code>base</code></a>:</p>\n\n<pre><code>-- | 'forM' is 'mapM' with its arguments flipped. For a version that\n-- ignores the results see 'Data.Foldable.forM_'.\nforM :: (Traversable t, Monad m) =&gt; t a -&gt; (a -&gt; m b) -&gt; m (t b)\n{-# INLINE forM #-}\nforM = flip mapM\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 36372219, "answer_count": 1, "score": 1, "last_activity_date": 1459593707, "creation_date": 1459592162, "question_id": 36371956, "link": "https://stackoverflow.com/questions/36371956/difference-between-mapm-and-form", "title": "difference between mapM and forM", "body": "<p>Could you tell me is there exists some difference between <code>mapM</code> and <code>forM</code> ?\nLook at signatures:  </p>\n\n<pre><code>mapM :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]\nforM :: Monad m =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]\n</code></pre>\n\n<p>The only thing is order of arguments.  It is unvailable, but does it really only difference ?</p>\n"}]