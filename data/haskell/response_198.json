[{"tags": ["haskell", "c-preprocessor", "ghc", "cabal"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1540411300, "post_id": 52977012, "comment_id": 92860616, "body": "What command do you run to get that error?"}, {"owner": {"reputation": 315, "user_id": 10553912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f00c8ffb0cb3b02b08b70ce031bd004?s=128&d=identicon&r=PG&f=1", "display_name": "racherb", "link": "https://stackoverflow.com/users/10553912/racherb"}, "edited": false, "score": 0, "creation_date": 1540412607, "post_id": 52977012, "comment_id": 92861233, "body": "The error occurs when I execute any the following command: stack install"}, {"owner": {"reputation": 315, "user_id": 10553912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f00c8ffb0cb3b02b08b70ce031bd004?s=128&d=identicon&r=PG&f=1", "display_name": "racherb", "link": "https://stackoverflow.com/users/10553912/racherb"}, "edited": false, "score": 1, "creation_date": 1540420076, "post_id": 52977012, "comment_id": 92863924, "body": "<b>cpp code must be unindented</b>. In my case, while the Haskell code indentation was correct, the c++ statement within the Haskell code must be unindented."}, {"owner": {"reputation": 315, "user_id": 10553912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f00c8ffb0cb3b02b08b70ce031bd004?s=128&d=identicon&r=PG&f=1", "display_name": "racherb", "link": "https://stackoverflow.com/users/10553912/racherb"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1540420849, "post_id": 52977012, "comment_id": 92864157, "body": "Thank you DanielWagner and @ThomasM.DuBuisson for the support. The problem has been solved."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1540421176, "post_id": 52977012, "comment_id": 92864277, "body": "As long as the <code>#</code> is on the first column the text that follows (e.g. <code>if MIN_VERSION ...</code>) can be indented as much as you like, which can be useful for readability"}, {"owner": {"reputation": 23007, "user_id": 7943564, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b6f0ad4cd865587a782bf697d3b18d18?s=128&d=identicon&r=PG&f=1", "display_name": "glennsl", "link": "https://stackoverflow.com/users/7943564/glennsl"}, "edited": false, "score": 0, "creation_date": 1540456119, "post_id": 52977012, "comment_id": 92875014, "body": "@RacielHernand Could you make a proper answer, so other people might easier find it and learn from it as well?"}, {"owner": {"reputation": 315, "user_id": 10553912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f00c8ffb0cb3b02b08b70ce031bd004?s=128&d=identicon&r=PG&f=1", "display_name": "racherb", "link": "https://stackoverflow.com/users/10553912/racherb"}, "reply_to_user": {"reputation": 23007, "user_id": 7943564, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b6f0ad4cd865587a782bf697d3b18d18?s=128&d=identicon&r=PG&f=1", "display_name": "glennsl", "link": "https://stackoverflow.com/users/7943564/glennsl"}, "edited": false, "score": 1, "creation_date": 1540474641, "post_id": 52977012, "comment_id": 92886516, "body": "Thank you @glennsl. It was ready, a summary of the solution was added."}], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 10553912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f00c8ffb0cb3b02b08b70ce031bd004?s=128&d=identicon&r=PG&f=1", "display_name": "racherb", "link": "https://stackoverflow.com/users/10553912/racherb"}, "is_accepted": true, "score": 1, "last_activity_date": 1540473439, "creation_date": 1540473439, "answer_id": 52990255, "question_id": 52977012, "link": "https://stackoverflow.com/questions/52977012/the-cpp-statements-included-in-the-haskell-code-dont-work/52990255#52990255", "title": "The cpp statements included in the haskell code don&#39;t work", "body": "<p><strong>cpp statement inside code haskell must be unindented.</strong> </p>\n\n<blockquote>\n  <p>In my case, while the Haskell code indentation was correct, the c++\n  statement within the Haskell code must be unindented.</p>\n</blockquote>\n\n<p>I simply took the code line from cpp to zero indentation. The rest of the Haskell code stays the same. </p>\n\n<p>Code corrected:</p>\n\n<pre><code>{-# LANGUAGE CPP #-}\n  ...\n#if MIN_VERSION_base(4,9,0)\n  import Data.Functor.Classes\n  ...\n#endif\n</code></pre>\n\n<p>Best regards.</p>\n"}], "owner": {"reputation": 315, "user_id": 10553912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f00c8ffb0cb3b02b08b70ce031bd004?s=128&d=identicon&r=PG&f=1", "display_name": "racherb", "link": "https://stackoverflow.com/users/10553912/racherb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 52990255, "answer_count": 1, "score": 0, "last_activity_date": 1540473439, "creation_date": 1540410994, "last_edit_date": 1540419660, "question_id": 52977012, "link": "https://stackoverflow.com/questions/52977012/the-cpp-statements-included-in-the-haskell-code-dont-work", "title": "The cpp statements included in the haskell code don&#39;t work", "body": "<p>I'm using the <strong>{-# LANGUAGE CPP #-}</strong> pragma in Haskell, however, the cpp statements included in the haskell code don't work for me: The compiler gives me the following error when I run stack install:</p>\n\n<pre><code>error: parse error on input '#'.\n</code></pre>\n\n<p>Any suggestions?</p>\n\n<p>This is a sample of the code I am using with GHC version 8.4.3:</p>\n\n<pre><code>{-# LANGUAGE CPP #-}\n  ...\n  #if MIN_VERSION_base(4,9,0)\n  import Data.Functor.Classes\n  #endif\n</code></pre>\n"}, {"tags": ["string", "list", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1540477238, "last_edit_date": 1540477238, "creation_date": 1540410989, "answer_id": 52977009, "question_id": 52976725, "link": "https://stackoverflow.com/questions/52976725/convert-a-string-of-strings-of-numbers-into-words-like-the-old-phones/52977009#52977009", "title": "Convert a string of strings of numbers into words like the old phones", "body": "<p>A classic mistake is to implement <em>too</em> much logic into a single function. Instead of trying to do the entire decoding into the <code>numbers</code> function, it might be better to split up the tasks in reusable components, such that these are easy to understand, debug, and reuse.</p>\n\n<p>Here as first function, we can map the digit to a <code>String</code> containing the characters, like:</p>\n\n<pre><code>digtoseq :: Char -&gt; String\ndigtoseq '2' = \"abc\"\ndigtoseq '3' = \"def\"\ndigtoseq '4' = \"ghi\"\ndigtoseq '5' = \"jkl\"\ndigtoseq '6' = \"mno\"\ndigtoseq '7' = \"pqrs\"\ndigtoseq '8' = \"tuv\"\ndigtoseq '9' = \"wxyz\"\ndigtoseq '0' = \" \"\n</code></pre>\n\n<p>We here can add extra characters, for example the <code>'.'</code> to specify the sequence behind each phone key.</p>\n\n<p>Now we can implement a function that makes use of <code>digtoseq</code>, for example <code>digstrtoseq</code>:</p>\n\n<pre><code>digstrtoseq :: String -&gt; Char\ndigstrtoseq (x:xs) = digtoseq x !! length xs\n</code></pre>\n\n<p>here we thus take the length of the string, as well as the first character, and we move through the string of <code>digtoseq x</code>, to obtain the <code>n-1</code>-th element (with <code>n</code> the length of the input string). So for <code>\"22\"</code>, we get:</p>\n\n<pre><code>Prelude&gt; digstrtoseq \"22\"\n'b'\nPrelude&gt; digstrtoseq \"33\"\n'e'\nPrelude&gt; digstrtoseq \"2\"\n'a'\n</code></pre>\n\n<p>so now it is only a matter of <code>map</code>ping this function over the string of input:</p>\n\n<pre><code>numbers :: [String] -&gt; String\nnumbers = map digstrtoseq\n</code></pre>\n\n<p>and then we obtain:</p>\n\n<pre><code>Prelude&gt; numbers [\"22\", \"33\", \"2\"]\n\"bea\"\n</code></pre>\n\n<p>Note that here we made some assumptions, some of these can be improved by rewriting the functions, other are better solved by changing the type of the input:</p>\n\n<ol>\n<li>we assume that no string has a length larger than the length of the sequence behind it, so <code>\"2222\"</code> will not occur;</li>\n<li>we assume that the character in the string element is repeated over the entire string, so <code>\"231\"</code> will not occur;</li>\n<li>we assume that the strings contain only valid digits, so no <code>\"~\"</code>;</li>\n<li>we assume that each string contains at least one character, so no <code>\"\"</code>.</li>\n</ol>\n\n<p>A large amount of the assumptions originate from the fact that we here use <code>[String]</code> as input type, which gives a lot of freedom. Yes it is possible to raise errors, or to return <code>Nothing</code> in that case, but it might be better to define a type like:</p>\n\n<pre><code>data Key = Two | Three | Four | Five | Six | Seven | Eight | Nine | Zero\n</code></pre>\n\n<p>and then as input take <code>[(Key, Int)]</code>, since then assumptions (2) and (3) are simply \"guaranteed\" through the input type.</p>\n"}, {"tags": [], "owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "is_accepted": true, "score": 2, "last_activity_date": 1540411200, "creation_date": 1540411200, "answer_id": 52977076, "question_id": 52976725, "link": "https://stackoverflow.com/questions/52976725/convert-a-string-of-strings-of-numbers-into-words-like-the-old-phones/52977076#52977076", "title": "Convert a string of strings of numbers into words like the old phones", "body": "<p>Willem beat me to it but here's what I came up with. You might want to complete the keyboard though</p>\n\n<pre><code>numToChar :: Char -&gt; Int -&gt; Char\nnumToChar '2' i = \"abc\" !! (i - 1)\nnumToChar '3' i = \"def\" !! (i - 1)\nnumToChar '4' i = \"ghi\" !! (i - 1)\nnumToChar '5' i = \"jkl\" !! (i - 1)\nnumToChar '6' i = \"mno\" !! (i - 1)\nnumToChar '7' i = \"pqrs\" !! (i - 1)\nnumToChar '8' i = \"tuv\" !! (i - 1)\nnumToChar '9' i = \"wxyz\" !! (i - 1)\n\nnumbers n = [numToChar (head x) (length x) | x &lt;- n]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1540573033, "creation_date": 1540573033, "answer_id": 53013283, "question_id": 52976725, "link": "https://stackoverflow.com/questions/52976725/convert-a-string-of-strings-of-numbers-into-words-like-the-old-phones/53013283#53013283", "title": "Convert a string of strings of numbers into words like the old phones", "body": "<p>There are indeed more direct methods of translation or mapping. The ASCII character set can be exploited for such. This function is robust. The only limitation I can see is the length of the ASCII character set. The assumption is what we cannot type what will not be used. The first digit matters only. Anything can be used after it.</p>\n\n<pre><code>td=\\(s:sx)-&gt;[toEnum (47+d+e+(length sx))::Char|d&lt;-[fromEnum s],e&lt;-[2*(mod d 50) + if d &gt; 55 then 1 else 0]]\n</code></pre>\n\n<p>Use td any way you want.</p>\n\n<pre><code>concat $ map td [\"222\",\"33\",\"9999\",\"4\"]\n</code></pre>\n\n<p>\"cezg\"</p>\n"}], "owner": {"reputation": 45, "user_id": 10554061, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-D91t_GzPz2g/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCiG4rFipbbL11u8Sc1runL_TStHQ/mo/photo.jpg?sz=128", "display_name": "Fernando Albuquerque", "link": "https://stackoverflow.com/users/10554061/fernando-albuquerque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 52977076, "answer_count": 3, "score": 0, "last_activity_date": 1540573033, "creation_date": 1540409840, "question_id": 52976725, "link": "https://stackoverflow.com/questions/52976725/convert-a-string-of-strings-of-numbers-into-words-like-the-old-phones", "title": "Convert a string of strings of numbers into words like the old phones", "body": "<p>Basically i have a list of lists made of strings that are only numbers like [\"22\",\"333\",\"2\"] and i want to transform it into the string \"bea\". Think of this like the old phones if u press 2 twice you get a b, if you press 4 once you get a j, like that. Only can use prelude functions</p>\n\n<p>I tried it like this </p>\n\n<pre><code>numbers ws [] = ws\nnumbers ws (x:xs) = if head \"2ABC\" == head x\n                    then ws ++ \"2ABC\" !! length x ++ numbers ws xs\n                    else if head \"3DEF\" == head x\n                    then ws ++ \"3DEF\" !! length x ++ numbers ws xs\n....\n</code></pre>\n\n<p>But this gives me errors so can you help me guys?                     </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1540405609, "post_id": 52975556, "comment_id": 92857960, "body": "@MarkSeemann I&#39;m in favor of such comments in general, but here OP has posted the code they have actually tried, and it seems pretty clear that the place they&#39;re getting stuck is in that code, since it doesn&#39;t type check."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1540405969, "post_id": 52975556, "comment_id": 92858135, "body": "@amalloy Agreed. My mistake. I&#39;ve deleted my comment."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 5, "last_activity_date": 1540843932, "last_edit_date": 1540843932, "creation_date": 1540406217, "answer_id": 52975866, "question_id": 52975556, "link": "https://stackoverflow.com/questions/52975556/how-do-i-iterate-through-an-n-element-list-and-apply-a-function-on-each-element/52975866#52975866", "title": "How do i iterate through an n element list and apply a function on each element", "body": "<p>First, consider using more domain-centered data types for your values, instead of just using ints with special meanings. e.g. it looks like here you're playing Rock Paper Scissors, so you'd have a better time with something like</p>\n\n<pre><code>data Symbol = Rock | Paper | Scissors deriving Eq\ndata Outcome = Win | Lose | Tie\n\nevalTurn :: Symbol -&gt; Symbol -&gt; Outcome\nevalTurn x y | x == y = Tie\nevalTurn Rock Paper = Lose\n-- ...\n</code></pre>\n\n<p>As is, you've accidentally repeated a case in your <code>evalTurn</code>: you have that <code>evalTurn 0 1 = 1</code>, but also <code>evalTurn 0 1 = -1</code>. This would be easier to spot if you used richer domain models. Or, if you want to stick with your integers, there is actually a shortcut using modular arithmetic:</p>\n\n<pre><code>evalTurn x y = case (y - x) `mod` 3 of\n  0 -&gt; 0\n  1 -&gt; 1\n  2 -&gt; -1\n</code></pre>\n\n<p>As to your actual question there are a number of problems before you can get to what you're trying to fix. <code>evalTurn</code>, <code>evalBunch</code>, and <code>evalMatch</code> all disagree on what the type of Symbol should be, and how many arguments <code>evalTurn</code> actually takes. Does it make sense to call <code>evalTurn</code> with one argument, as <code>evalBunch</code> does? Surely not.</p>\n\n<p>My first suggestion would be to forget this <code>evalBunch</code> function completely, and write <code>evalMatch</code> in terms of <code>evalTurn</code> directly. It would probably be good practice for you to write it recursively by hand, rather than using fancy zips, curries, and function composition.</p>\n\n<hr>\n\n<p>Another thing you could do, if you like the richer domain models I suggsted but don't want to write out all 9 cases (or 7 if you shortcut the <code>x == y</code> cases), is to instead define \"does X beat Y\" as a boolean primitive, and then build upon that to decide the more complicated question of who wins a match:</p>\n\n<pre><code>beats :: Symbol -&gt; Symbol -&gt; Bool\nRock `beats` Scissors = True\nScissors `beats` Paper = True\nPaper `beats` Rock = True\n_ `beats` _ = False\n\nevalTurn :: Symbol -&gt; Symbol -&gt; Outcome\nevalTurn x y | x `beats` y = Win\n             | y `beats` x = Lose\n             | otherwise = Tie\n</code></pre>\n\n<p>It's not really much shorter, perhaps even longer. But it avoided repetition, and now as a nice side benefit the program \"knows\" a little more about Symbols outside the context of <code>evalTurn</code>, which may prove useful somehow in another part of the program. For example, you could use this to draw a tutorial diagram of what beats what.</p>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1540596180, "post_id": 52994794, "comment_id": 92938063, "body": "You mean <code>sum . fmap evalTurn</code>. With <code>$</code> instead of <code>.</code> it has a rather odd type, not at all what you intend."}, {"owner": {"reputation": 315, "user_id": 10553912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f00c8ffb0cb3b02b08b70ce031bd004?s=128&d=identicon&r=PG&f=1", "display_name": "racherb", "link": "https://stackoverflow.com/users/10553912/racherb"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1540678486, "post_id": 52994794, "comment_id": 92955201, "body": "The Poinfree style is more elegant and readable (most of the time). However, &quot;evalBunch v = sum $ fmap evalTurn v&quot; is equivalent to writing &quot;evalBunch = sum . fmap evalTurn&quot;. Best regards!"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1540679410, "post_id": 52994794, "comment_id": 92955384, "body": "Indeed, both of your current versions are fine. My comment was in reference to your <a href=\"https://stackoverflow.com/revisions/52994794/2\">earlier, incorrect version</a>, where you had written <code>evalBunch = sum $ fmap evalTurn</code>, which is not equivalent."}, {"owner": {"reputation": 315, "user_id": 10553912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f00c8ffb0cb3b02b08b70ce031bd004?s=128&d=identicon&r=PG&f=1", "display_name": "racherb", "link": "https://stackoverflow.com/users/10553912/racherb"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1540683264, "post_id": 52994794, "comment_id": 92955989, "body": "@amalloy,  thank you for your contribution. Best regards!"}], "tags": [], "owner": {"reputation": 315, "user_id": 10553912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f00c8ffb0cb3b02b08b70ce031bd004?s=128&d=identicon&r=PG&f=1", "display_name": "racherb", "link": "https://stackoverflow.com/users/10553912/racherb"}, "is_accepted": true, "score": 0, "last_activity_date": 1540678762, "last_edit_date": 1540678762, "creation_date": 1540487762, "answer_id": 52994794, "question_id": 52975556, "link": "https://stackoverflow.com/questions/52975556/how-do-i-iterate-through-an-n-element-list-and-apply-a-function-on-each-element/52994794#52994794", "title": "How do i iterate through an n element list and apply a function on each element", "body": "<p>Keeping a little to the way in which the initial problem was presented, I suggest the following simplifications:</p>\n\n<pre><code>type Symbol = Int\ntype Outcome = Int\n\nevalTurn :: (Symbol, Symbol) -&gt; Outcome\nevalTurn (x, y)\n  | (x == y)           =  0\n  | (x == 0 &amp;&amp; y == 1) =  1\n  | (x == 0 &amp;&amp; y == 2) = -1\n  | (x == 1 &amp;&amp; y == 2) =  1\n  | (x == 2 &amp;&amp; y == 0) =  1\n  | (x == 2 &amp;&amp; y == 1) = -1\n  | (x == 1 &amp;&amp; y == 0) = -1\n\nevalBunch :: (Foldable t, Functor t) =&gt; t (Symbol, Symbol) -&gt; Outcome\nevalBunch v = sum $ fmap evalTurn v\n\n--Pointfree style is more elegant\n--evalBunch = sum . fmap evalTurn\n</code></pre>\n\n<p>So, doesn't this function solve your use case?</p>\n\n<pre><code>Prelude&gt; evalBunch [(1, 0), (1,0), (1,0)] \nPrelude&gt; -3\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10539691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54570bd3e562e269bdc35174f10b0067?s=128&d=identicon&r=PG&f=1", "display_name": "vKkU4NBz5x", "link": "https://stackoverflow.com/users/10539691/vkku4nbz5x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 52994794, "answer_count": 2, "score": -2, "last_activity_date": 1540843932, "creation_date": 1540404849, "question_id": 52975556, "link": "https://stackoverflow.com/questions/52975556/how-do-i-iterate-through-an-n-element-list-and-apply-a-function-on-each-element", "title": "How do i iterate through an n element list and apply a function on each element", "body": "<p>right player wins , the function returns 1, if the other side does its -1</p>\n\n<pre><code>evalTurn :: Symbol -&gt; Symbol -&gt; Outcome\nevalTurn x y | x == y = 0\nevalTurn 0 1 = 1\nevalTurn 0 2 = -1\nevalTurn 1 2 = 1\nevalTurn 0 1 = -1\nevalTurn 2 0 = 1\nevalTurn 2 1 = -1\nevalTurn 1 0 = -1\n</code></pre>\n\n<p>i need to evaluate the following with the truth table above.</p>\n\n<pre><code>evalBunch (x,y,z) = evalTurn x + evalTurn y + evalTurn z\n\nevalMatch :: ([Symbol], [Symbol]) -&gt; Outcome\nevalMatch (x,y) = evalBunch (zip x y)\n</code></pre>\n\n<p>the test case presents 2 players with each turn's result , summed up</p>\n\n<pre><code>evalMatch ([1,1,1], [0,0,0]) == -3\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "edited": false, "score": 0, "creation_date": 1540403563, "post_id": 52974920, "comment_id": 92856855, "body": "use <code>takeWhile</code> and <code>dropWhile</code> but have a special case where space is ignored."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1540406893, "post_id": 52975445, "comment_id": 92858560, "body": "Instead of writing <code>x:xs</code> twice in the body of your last equation, you could simplify to: <code>split (x:xs) = (x : takeWhile (== x) xs) : (split $ dropWhile (== x) xs)</code>"}, {"owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "edited": false, "score": 2, "creation_date": 1540454022, "post_id": 52975445, "comment_id": 92873926, "body": "span can be used in last line to simplify things. let (a,b) = span (== x) (x:xs)    in a:(split b)"}], "tags": [], "owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "is_accepted": false, "score": 3, "last_activity_date": 1540404457, "creation_date": 1540404457, "answer_id": 52975445, "question_id": 52974920, "link": "https://stackoverflow.com/questions/52974920/how-can-split-a-string-with-two-conditions/52975445#52975445", "title": "How can split a string with two conditions?", "body": "<pre><code>split :: String -&gt; [String]\nsplit [] = []\nsplit (' ':xs) = split xs\nsplit (x:xs) = (takeWhile (== x) (x:xs)) : (split $ dropWhile (== x) (x:xs))\n</code></pre>\n\n<p>So this is a recursive definition where there are 2 cases:</p>\n\n<ol>\n<li>If head is a space then ignore it.</li>\n<li>Otherwise, take as many of the same characters as you can, then call the function on the remaining part of the string.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "is_accepted": false, "score": 5, "last_activity_date": 1540452011, "creation_date": 1540452011, "answer_id": 52983540, "question_id": 52974920, "link": "https://stackoverflow.com/questions/52974920/how-can-split-a-string-with-two-conditions/52983540#52983540", "title": "How can split a string with two conditions?", "body": "<p>So you want to split by <code>words</code> and then <code>group</code> equal elements in each split. You have the functions for doing so,</p>\n\n<pre><code>import Data.List\n\nsliceIt :: String -&gt; [String]\nsliceIt s = concatMap group $ words s  \n\nsliceItPointFree = concatMap group . words -- Point free notation. Same but cooler\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 8752268, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209630376667858/picture?type=large", "display_name": "Jo&#227;o Santos", "link": "https://stackoverflow.com/users/8752268/jo%c3%a3o-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1540452011, "creation_date": 1540402401, "last_edit_date": 1540404663, "question_id": 52974920, "link": "https://stackoverflow.com/questions/52974920/how-can-split-a-string-with-two-conditions", "title": "How can split a string with two conditions?", "body": "<p>So basically I want to split my string with two conditions , when have a empty space or a diferent letter from the next one.</p>\n\n<p>An example:</p>\n\n<p>if I have this string ,<code>\"AAA ADDD DD\"</code>, I want to split to this, <code>[\"AAA\",\"A\",\"DDD\",\"DD\"]</code></p>\n\n<p>So I made this code:</p>\n\n<pre><code>sliceIt :: String -&gt; [String]\nsliceIt xs = words xs\n</code></pre>\n\n<p>But it only splits the inicial string when an empty space exists.\nHow can I also split when a caracter is next to a diferent one?\nCan this problem be solve easier with recursion?</p>\n"}, {"tags": ["javascript", "haskell", "functional-programming", "monads", "category-theory"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1540485617, "post_id": 52983138, "comment_id": 92893474, "body": "I believe an idempotent monad in Wadler&#39;s sense can be expressed even more compactly: <code>u *&gt; u = u</code>. I don&#39;t (yet) have a proof that this is sufficient, but I&#39;m quite confident it follows from the <code>Applicative</code> laws."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10180218"}, "edited": false, "score": 0, "creation_date": 1540516678, "post_id": 52983138, "comment_id": 92904771, "body": "Thanks. Firstly, reading your answer, I misunderstood that idempotent monads was what I was talking about, but since it appears to be IdentiyMonad, I think this is not what I mention here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10180218"}, "edited": false, "score": 0, "creation_date": 1540516965, "post_id": 52983138, "comment_id": 92904837, "body": "However, idempotent is the word I will keep using. Identity monad is  idempotent for the value, but what I mention here is  idempotent for the monadic type, and the monadic value can be changed according to the functors."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1540522378, "post_id": 52983138, "comment_id": 92905879, "body": "@bayesian-study (1) Glass half-empty view: if by &quot;<code>T</code> is an idempotent functor&quot; you&#39;d mean &quot;<code>TT</code> and <code>T</code> are the same&quot;, a question arises about what &quot;the same&quot; would mean. If we are working in <b>Hask</b>, I think any useful notion of sameness will end up referring to the value level (e.g. &quot;being the same means being isomorphic&quot;). (2) Glass half-full view: if we give up on sameness, I don&#39;t think you need to repurpose &quot;idempotent&quot; to express this idea, because &quot;monoid&quot; will do just fine. It seems, &quot;a monad is a monoid in the category of endofunctors&quot; captures the gist of what you&#39;re aiming at."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1540587298, "post_id": 52983138, "comment_id": 92935973, "body": "@dfeuer I have figured out an almost-proof of that. I say &quot;almost&quot; because it relies on <code>u *&gt; u = u</code> and <code>u &lt;* u = u</code> being equivalent. This feels like it should be an evident truth, but I&#39;m finding it surprisingly troublesome to properly justify it. Maybe I&#39;m missing something obvious... if you have any suggestions, I&#39;m all ears!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1540588028, "post_id": 52983138, "comment_id": 92936203, "body": "If there&#39;s a proof, it must involve the <code>Applicative</code> composition law, since that&#39;s the only one that&#39;s not trivial. But no, I don&#39;t really know how to do it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10180218"}, "edited": false, "score": 0, "creation_date": 1540940305, "post_id": 52983138, "comment_id": 93046397, "body": "@duplode Thanks for your comments again, and I would like to ask further. Isn&#39;t a free-monad idempotent? According to your mention:&quot;It isn&#39;t required for the flattening to be a lossless operation (i.e. for join to be an isomorphism).&quot;, join can be designed to be not an isomorpohism, but from my understanding, free-monad includes join(probably isomorphism) already, and any monads are derived from the free-monad by designing a functor that is out of territory of the built-in join."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1540991041, "post_id": 52983138, "comment_id": 93064635, "body": "@bayesian-study Not really. For a counterexample, <code>Free (Const ())</code> is <code>Maybe</code> (they are isomorphic, and the instances match), whose <code>join</code> is not an isomorphism. I feel there is something to your intuition (the <code>join</code> of a free monad, in a sense, does as little as necessary -- cf. the answers to <a href=\"https://stackoverflow.com/q/13352205/2751851\"><i>What are free monads?</i></a>), but it isn&#39;t idempotency in that sense. Also note that not all monads are free monads -- cf. <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2017-January/126026.html\" rel=\"nofollow noreferrer\">this Haskell Cafe message</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10180218"}, "edited": false, "score": 0, "creation_date": 1540999089, "post_id": 52983138, "comment_id": 93070301, "body": "@duplode Thanks. My intuition is, 1. Functors/Monads are Objects that have binary operations between a value and a function: <code>a * f * f * f.....</code> where <code>*</code> as any binary operator(like wild-card) to be defined. 2. This generalization is is called as Free Functors/Free Monads."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10180218"}, "edited": false, "score": 0, "creation_date": 1540999431, "post_id": 52983138, "comment_id": 93070541, "body": "So, I feel something wrong about <code>join</code> that should be built-in structure in a free monad should be defines for each cases because all we care about to define the feature of free monad is the &quot;wild-card&quot; part that is the binary operator."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10180218"}, "edited": false, "score": 0, "creation_date": 1540999889, "post_id": 52983138, "comment_id": 93070868, "body": "However, like the HaskellCafe post you&#39;ve introduced, I&#39;ve heard that the list monad is not a free monad, so which means my intuition: &quot;Monads are Objects that have binary operations between a value and a function: <code>a * f * f * f.....</code>&quot; is not even generalization of Monads. This is truly confusing."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1554573135, "post_id": 52983138, "comment_id": 97805028, "body": "@dfeuer I found a counterexample to the <code>u *&gt; u = u</code> conjecture. I wrote a little about it <a href=\"https://duplode.github.io/posts/idempotent-applicatives-parametricity-and-a-puzzle.html\" rel=\"nofollow noreferrer\">here</a> (the actual counterexample is down in the &quot;Something twisted&quot; section). Over at r/haskell, Li-yao Xia also noted <a href=\"https://www.reddit.com/r/haskell/comments/b7xsp1/idempotent_applicatives_parametricity_and_a_puzzle/ejvvtln/\" rel=\"nofollow noreferrer\">a related example</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554579241, "post_id": 52983138, "comment_id": 97806698, "body": "That&#39;s certainly interesting, but I don&#39;t think it disproves my conjecture. You&#39;ve shown that an idempotent <i>element</i> in the weak sense is not necessarily am idempotent element in the strong sense. But <code>Evil x y *&gt; Evil x y</code> is not generally <code>Evil x y</code>, so <code>Twisted</code> is not an idempotent <i>monad</i> in the weak sense."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554579948, "post_id": 52983138, "comment_id": 97806888, "body": "@dfeuer &quot;But <code>Evil x y *&gt; Evil x y</code> is not generally <code>Evil x y</code>&quot; -- <code>Evil x y *&gt; Evil x y </code> is <code>snd &lt;$&gt; fzip (Evil x y, Evil x y)</code>, which is <code>snd &lt;$&gt; Evil (x, x) (x, y)</code>, which is <code>Evil x y</code>. (The one that doesn&#39;t hold is <code>Evil x y &lt;* Evil x y = Evil x y</code>.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554580308, "post_id": 52983138, "comment_id": 97806982, "body": "Oh, I must&#39;ve missed something. I&#39;ll have to look again."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 10, "last_activity_date": 1554572593, "last_edit_date": 1554572593, "creation_date": 1540450537, "answer_id": 52983138, "question_id": 52973336, "link": "https://stackoverflow.com/questions/52973336/monads-not-with-flatmap-but-flatunit/52983138#52983138", "title": "Monads not with &quot;flatMap&quot; but &quot;flatUnit&quot;?", "body": "<p>In this answer, I won't dwell on <code>flatUnit</code>. As others have pointed out, <code>join . return = id</code> for any monad (it is one of the monad laws), and so there isn't much to talk about it in and of itself. Instead, I will discuss some of the surrounding themes raised in the discussion here.</p>\n\n<p>Quoting a comment:</p>\n\n<blockquote>\n  <p>in other words, functor with a flat structure, it's a monad.</p>\n</blockquote>\n\n<p>This, I believe, is the heart of the question. A monad need not be a functor with a flat structure, but a functor whose values can be flat<em>tened</em> (with <code>join</code>) in a way that follows certain laws (\"a monoid in the category of endofunctors\", as the saying goes). It isn't required for the flattening to be a lossless operation (i.e. for <code>join</code> to be an isomorphism).</p>\n\n<p>Monads whose <code>join</code> is an isomorphism are called, in category theory parlance, <a href=\"https://ncatlab.org/nlab/show/idempotent+monad\" rel=\"nofollow noreferrer\">idempotent monads</a> <sup>1</sup>. For a Haskell <code>Monad</code> to be idempotent, though, the monadic values must have no extra structure. That means most monads of immediate interest to a programmer won't be idempotent (in fact, I'm having trouble to think of idempotent Haskell <code>Monad</code>s that aren't <code>Identity</code> or identity-like). One example already raised in the comments was that of lists:</p>\n\n<pre><code>join [[1,2],[3,4,5]] = [1,2,3,4,5] -- Grouping information discarded\n</code></pre>\n\n<p>The function/reader monad gives what I'd say is an even more dramatic illustration:</p>\n\n<pre><code>join (+) = \\x -&gt; x + x\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/q/52906712/2751851\">This recent question</a> gives an interesting illustration involving <code>Maybe</code>. The OP there had a function with signature...</p>\n\n<pre><code>appFunc :: Integer -&gt; Integer -&gt; Bool -&gt; Maybe (Integer,Integer)\n</code></pre>\n\n<p>... and used it like this...</p>\n\n<pre><code>appFunc &lt;$&gt; u &lt;*&gt; v &lt;*&gt; w\n</code></pre>\n\n<p>... thus obtaining a <code>Maybe (Maybe (Integer, Integer))</code> result. The two layers of <code>Maybe</code> correspond to two different ways of failing: if <code>u</code>, <code>v</code> or <code>w</code> are <code>Nothing</code>, we get <code>Nothing</code>; if the three of them are <code>Just</code>-values but <code>appFunc</code> results in <code>Nothing</code>, we get <code>Just Nothing</code>; finally, if everything succeeds we get a <code>Just</code>-value within a <code>Just</code>. Now, it might be the case that we, like the author of that question, didn't care about which layer of <code>Maybe</code> led to the failure; in that case, we would discard that information, either by using <code>join</code> on the result or by rewriting it as <code>u &gt;&gt;= \\x -&gt; v &gt;&gt;= \\y -&gt; w &gt;&gt;= \\b -&gt; appFunc x y b</code>. In any case, the information is there for us to use or discard.</p>\n\n<hr>\n\n<p>Note 1: In <em>Combining Monads</em> by King and Wadler (one of <a href=\"http://homepages.inf.ed.ac.uk/wadler/topics/monads.html\" rel=\"nofollow noreferrer\">Wadler's papers about monads</a>), the authors introduce a different, and largely unrelated, meaning for \"idempotent monad\". In their sense, an idempotent monad is one for which (in applicative notation) <code>f &lt;$&gt; u &lt;*&gt; u = (\\x -&gt; f x x) &lt;$&gt; u</code> -- one example would be <code>Maybe</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10180218"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "closed_date": 1540569676, "answer_count": 1, "score": -10, "last_activity_date": 1554572593, "creation_date": 1540396638, "last_edit_date": 1540527071, "question_id": 52973336, "link": "https://stackoverflow.com/questions/52973336/monads-not-with-flatmap-but-flatunit", "closed_reason": "Needs details or clarity", "title": "Monads not with &quot;flatMap&quot; but &quot;flatUnit&quot;?", "body": "<p>Monads in category theory is defined by triples <strong>T, unit, flat</strong>\u27e9. </p>\n\n<pre><code>class Monad t where\n  map :: (a -&gt; b) -&gt; (t a -&gt; t b) -- functorial action\n  unit :: a -&gt; t a\n  flat :: t (t a) -&gt; t a\n\nclass KleisliTriple t where\n  unit :: a -&gt; t a\n  flatMap :: t a -&gt; (a -&gt; t b) -&gt; t b\n</code></pre>\n\n<p>KleisliTriple flats the structure by the operator: <code>flatMap</code> (or <code>bind</code> in Haskell) that is composition of <code>map</code> and <code>flat</code>.</p>\n\n<p>However, I always think it's much simpler and easier to understand and implement the Monad conept in functional programming to compose functions by flatten the structure with the object such as <code>flatUnit</code> that is composition of <code>unit</code> and <code>flat</code>.</p>\n\n<p>In this case, <code>flatUnit(flatUnit(x)) =  flatUnit(x)</code>. I actually implemented in this manner in JavaScript, and with <code>flatUnit</code> and <code>map</code> (just a legacy functor operator), all the benefit of Monad seems to be obtained. </p>\n\n<p>So, here's my question.</p>\n\n<p>I have kept looking for documents about the kind of <code>flatUnit</code> formalization in functional programming, but never found it. I understand there's a historical context that Eugenio Moggi who first discovered the relevance of monads in functional programming, and in his paper that happened to be KleisliTriple application, but since Monads are not limited to Kleisli Category and considering the simplicity of <code>flatUnit</code>, to me it's very strange.</p>\n\n<p>Why is that? and what do I miss?</p>\n\n<p>EDIT:code is removed.</p>\n"}, {"tags": ["haskell", "typeclass", "existential-type", "coproduct"], "comments": [{"owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "edited": false, "score": 0, "creation_date": 1540870868, "post_id": 52973009, "comment_id": 93013175, "body": "@Jon Purdy did give a <a href=\"https://stackoverflow.com/a/52995532/1525842\">great answer below</a>. For the curious, <a href=\"https://blog.jle.im/entry/introduction-to-singletons-1.html\" rel=\"nofollow noreferrer\">this singleton&#39;s tutorial</a> goes in great depth about this design pattern."}], "answers": [{"comments": [{"owner": {"reputation": 5649, "user_id": 49733, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/46d6184d8f4347ca961b6a9479a8cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Ryan Tolmasky I", "link": "https://stackoverflow.com/users/49733/francisco-ryan-tolmasky-i"}, "edited": false, "score": 0, "creation_date": 1540486516, "post_id": 52973954, "comment_id": 92893929, "body": "Sure -- I guess I can do this (although I was more looking to see if I just didn&#39;t understand something and I should be modeling things differently -- ideally without language extensions). The more I use these data constructors the more it seems that they&#39;re somewhat of a code smell. That is to say, if it merits its own constructor with its own completely different internals, why does it not merit its own top level type? Solely to get around the lack of coproducts and the verbosity of chained Eithers?"}], "tags": [], "owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "is_accepted": false, "score": 3, "last_activity_date": 1540410049, "last_edit_date": 1540410049, "creation_date": 1540398712, "answer_id": 52973954, "question_id": 52973009, "link": "https://stackoverflow.com/questions/52973009/existential-type-classes-vs-data-constructors-vs-coproducts/52973954#52973954", "title": "Existential type classes vs. Data Constructors vs. Coproducts", "body": "<p>The first thing that came to my mind reading your sentence: \"I quickly realized I wanted to be able to write functions that took specific results\" is <strong>Refinement Types</strong>.</p>\n\n<p>They allow to take only some values from a type as input, and make those constraints compile-time check/error.</p>\n\n<p>There is this video from a talk at HaskellX 2018, that introduces LiquidHaskell, which allows the use of Refinement Types in Haskell:</p>\n\n<p><a href=\"https://skillsmatter.com/skillscasts/11068-keynote-looking-forward-to-niki-vazou-s-keynote-at-haskellx-2018\" rel=\"nofollow noreferrer\">https://skillsmatter.com/skillscasts/11068-keynote-looking-forward-to-niki-vazou-s-keynote-at-haskellx-2018</a></p>\n\n<p>You have to decorate your haskell function signature, and have LiquidHaskell installed:</p>\n\n<p><code>f :: Int -&gt; i : Int {i | i &lt; 3} -&gt; Int</code> would be a function which could only accept as second parameter an <code>Int</code> with a value <code>&lt; 3</code>, checked at compile time.</p>\n\n<p>You might as well put constraints on your <code>Result</code> type.</p>\n"}, {"comments": [{"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1542324460, "post_id": 52995532, "comment_id": 93539030, "body": "I&#39;m working on your thorough example so as to learn <code>DataKinds</code>, and I have some problem understanding how to bind a variable to a value of type e.g. <code>Result &#39;Skipped</code> . The data constructor <code>SkippedResult</code> seems to expect a list of <code>Result &#39;Skipped</code> so as to be able to construct a <code>Result &#39;Skipped</code>. As a consequence I have a chicken and egg problem when I&#39;m trying to compile sth because I don&#39;t see how to provide a list of T, if for constructing a T, I have to provide a list of T. How would you write <code>var :: Result &#39;Skipped</code>    <code>var = SkippedResult _</code> ? GHC does not help me with the hole :-)"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1542330616, "post_id": 52995532, "comment_id": 93540394, "body": "@StephaneRolland: I was just following your examples; you have the same issue with the code from your question, <code>data Skipped = Skipped [Skipped]</code>: it\u2019s not really useful unless you add more information. For example, say you want a skipped test to include a test name and a list of children. Then you can declare <code>SkippedResult :: Text -&gt; [Result &#39;Skipped] -&gt; Result &#39;Skipped</code>, and use it like <code>SkippedResult &quot;test1&quot; []</code> for a skipped test with no children, or <code>SkippedResult &quot;group1&quot; [SkippedResult &quot;test1&quot; [], SkippedResult &quot;test2&quot; []]</code> for a skipped test group with some children (also skipped)."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 1, "creation_date": 1542330829, "post_id": 52995532, "comment_id": 93540443, "body": "@StephaneRolland: Alternatively, you could add more constructors that happen to have the same tag, e.g.: <code>SkippedResult :: { testName :: Text } -&gt; Result &#39;Skipped</code> and <code>SkippedResults :: { groupName :: Text, children :: [Result &#39;Skipped] } -&gt; Result &#39;Skipped</code>, then you would use <code>SkippedResult &quot;test&quot;</code> for a leaf (single test) and <code>SkippedResults &quot;group&quot; [\u2026]</code> for a branch (test group)."}, {"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1542351165, "post_id": 52995532, "comment_id": 93545168, "body": "I&#39;m not the OP who posted the question maybe that&#39;s one of the reason it  made no sense for me ;-)"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1542358616, "post_id": 52995532, "comment_id": 93548010, "body": "@StephaneRolland: Oh, I\u2019m sorry! I should\u2019ve paid more attention, haha"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1540490751, "creation_date": 1540490751, "answer_id": 52995532, "question_id": 52973009, "link": "https://stackoverflow.com/questions/52973009/existential-type-classes-vs-data-constructors-vs-coproducts/52995532#52995532", "title": "Existential type classes vs. Data Constructors vs. Coproducts", "body": "<p>I think what you may be looking for is <code>GADTs</code> with <code>DataKinds</code>. This lets you refine the types of each constructor in a data type to a particular set of possible values. For example:</p>\n\n<pre><code>data TestType = Test | Suite\n\ndata Node (t :: TestType) where\n  TestNode :: { source :: String } -&gt; Node 'Test\n  SuiteNode :: { title :: String, children :: [SomeNode] } -&gt; Node 'Suite\n\ndata SomeNode where\n  SomeNode :: Node t -&gt; SomeNode\n</code></pre>\n\n<p>Then when a function operates only on tests, it can take a <code>Node 'Test</code>; on suites, a <code>Node 'Suite</code>; and on either, a polymorphic <code>Node a</code>. When pattern-matching on a <code>Node a</code>, each <code>case</code> branch gets access to an equality constraint:</p>\n\n<pre><code>useNode :: Node a -&gt; Foo\nuseNode node = case node of\n  TestNode source -&gt;          {- here it\u2019s known that (a ~ 'Test) -}\n  SuiteNode title children -&gt; {- here, (a ~ 'Suite) -}\n</code></pre>\n\n<p>Indeed if you took a concrete <code>Node 'Test</code>, the <code>SuiteNode</code> branch would be disallowed by the compiler, since it can\u2019t ever match.</p>\n\n<p><code>SomeNode</code> is an existential that wraps a <code>Node</code> of an unknown type; you can add extra class constraints to this if you want.</p>\n\n<p>You can do a similar thing with <code>Result</code>:</p>\n\n<pre><code>data ResultType = Success | Omitted | Failure | Skipped\n\ndata Result (t :: ResultType) where\n  SuccessResult\n    :: [Either (Result 'Success) (Result 'Skipped)]\n    -&gt; Result 'Success\n  FailureResult\n    :: [SomeResult]\n    -&gt; Result 'Failure\n  OmittedResult\n    :: [Result 'Omitted]\n    -&gt; Result 'Omitted\n  SkippedResult\n    :: [Result 'Skipped]\n    -&gt; Result 'Skipped\n\ndata SomeResult where\n  SomeResult :: Result t -&gt; SomeResult\n</code></pre>\n\n<p>Of course I assume in your actual code there\u2019s more information in these types; as it is, they don\u2019t represent much. When you have a dynamic computation such as running a test that may produce different kinds of result, you can return it wrapped in <code>SomeResult</code>.</p>\n\n<p>In order to work with dynamic results, you may need to prove to the compiler that two types are equal; for that, I direct you to <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Type-Equality.html\" rel=\"nofollow noreferrer\"><code>Data.Type.Equality</code></a>, which provides a type <code>a :~: b</code> which is inhabited by a single constructor <code>Refl</code> when the two types <code>a</code> and <code>b</code> are equal; you can pattern-match on this to inform the typechecker about type equalities, or use the various combinators to carry out more complicated proofs.</p>\n\n<p>Also useful in conjunction with <code>GADTs</code> (and <code>ExistentialTypes</code>, less generally) is <code>RankNTypes</code>, which basically enables you to pass polymorphic functions as arguments to other functions; this is necessary if you want to consume an existential generically:</p>\n\n<pre><code>consumeResult :: SomeResult -&gt; (forall t. Result t -&gt; r) -&gt; r\nconsumeResult (SomeResult res) k = k res\n</code></pre>\n\n<p>This is an example of <em>continuation-passing style</em> (CPS), where <code>k</code> is the continuation.</p>\n\n<p>As a final note, these extensions are widely used and largely uncontroversial; you needn\u2019t be wary of opting in to (most) type system extensions when they let you express what you mean more directly.</p>\n"}], "owner": {"reputation": 5649, "user_id": 49733, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/46d6184d8f4347ca961b6a9479a8cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Ryan Tolmasky I", "link": "https://stackoverflow.com/users/49733/francisco-ryan-tolmasky-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1540490751, "creation_date": 1540395585, "last_edit_date": 1540396000, "question_id": 52973009, "link": "https://stackoverflow.com/questions/52973009/existential-type-classes-vs-data-constructors-vs-coproducts", "title": "Existential type classes vs. Data Constructors vs. Coproducts", "body": "<p>I find myself running up against the same pattern in my designs where I start with a type with a few data constructors, eventually want to be able to type against those data constructors and thus split them into their own types, just to then have to increase the verbosity of other parts of the program by needing to use Either or another tagged-union for situations where I still need to represent multiple of these types (namely collections).</p>\n\n<p>I am hoping someone can point me to a better way of accomplishing what I'm trying to do. Let me start with a simple example. I am modeling a testing system, where you can have nested test suites which eventually end in tests. So, something like this:</p>\n\n<pre><code>data Node =\n    Test { source::string }\n    Suite { title::string, children::[Node] }\n</code></pre>\n\n<p>So, pretty simple so far, essentially a fancy Tree/Leaf declaration. However, I quickly realize that I want to be able to make functions that take Tests specifically. As such, I'll now split it up as so:</p>\n\n<pre><code>data Test = Test { source::string }\ndata Suite = Suite { title::string, children::[Either Test Suite] }\n</code></pre>\n\n<p>Alternatively I might roll a \"custom\" Either (especially if the example is more complicated and has more than 2 options), say something like:</p>\n\n<pre><code>data Node =\n   fromTest Test\n   fromSuite Suite\n</code></pre>\n\n<p>So, already its pretty unfortunate that just to be able to have a <code>Suite</code> that can have a combination of Suites or Tests I end up with a weird overhead <code>Either</code> class (whether it be with an actual <code>Either</code> or a custom one). If I use existential type classes, I could get away with making both <code>Test</code> and <code>Suite</code> derive \"Node_\" and then have <code>Suite</code> own a List of said <code>Node</code>s. Coproducts would allow something similar, where I'd essentially do the same <code>Either</code> strategy without the verbosity of the tags.</p>\n\n<p>Allow me to expand now with a more complex example. The results of the tests can be either Skipped (the test was disabled), Success, Failure, or Omitted (the test or suite could not be run due to a previous failure). Again, I originally started with something like this:</p>\n\n<pre><code>data Result = Success | Omitted | Failure | Skipped\ndata ResultTree =\n    Tree { children::[ResultTree], result::Result } |\n    Leaf Result\n</code></pre>\n\n<p>But I quickly realized I wanted to be able to write functions that took specific results, and more importantly, have the type itself enforce the ownership properties: A successful suite must only own Success or Skipped children, Failure's children can be anything, Omitted can only own Omitted, etc. So now I end up with something like this:</p>\n\n<pre><code>data Success = Success { children::[Either Success Skipped] }\ndata Failure = Failure { children::[AnyResult] }\ndata Omitted = Omitted { children::[Omitted] }\ndata Skipped = Skipped { children::[Skipped] }\ndata AnyResult =\n  fromSuccess Success |\n  fromFailure Failure |\n  fromOmitted Omitted |\n  fromSkipped Skipped\n</code></pre>\n\n<p>Again, I now have these weird \"Wrapper\" types like <code>AnyResult</code>, but, I get type enforcement of something that used to only be enforced from runtime operation. Is there a better strategy to this that doesn't involve turning on features like existential type classes?</p>\n"}, {"tags": ["haskell", "io-monad"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1540384069, "post_id": 52968982, "comment_id": 92844163, "body": "You canuse <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:sequence-95-\" rel=\"nofollow noreferrer\"><b>sequence_</b></a>"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1540385743, "post_id": 52968982, "comment_id": 92845356, "body": "<code>generate s cnd incr = takeWhile cnd (iterate incr s)</code>"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 4, "creation_date": 1540394748, "post_id": 52968982, "comment_id": 92851799, "body": "<code>[IO ()]</code> is a more specific instance of <code>[a]</code> (in which <code>a</code> is <code>IO ()</code>) so you can pass it to <code>foldl</code>. Also you can ask hoogle this kind of question: <a href=\"https://hoogle.haskell.org/?hoogle=%5BIO%20()%5D%20-%3E%20IO%20()&amp;scope=set%3Ahaskell-platform\" rel=\"nofollow noreferrer\">hoogle.haskell.org/&hellip;</a>"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1540491122, "post_id": 52968982, "comment_id": 92896226, "body": "Apart from <code>sequence_</code>, you could write this as a fold directly using e.g. <code>foldr (*&gt;) (pure ())</code> (or <code>foldr (&gt;&gt;) (return ())</code>). This is more or less what <code>sequence</code>/<code>sequence_</code>/<code>sequenceA</code> do: join up the actions using applicative/monadic sequencing (<code>*&gt;</code>/<code>&gt;&gt;</code>) with the \u201cbase case\u201d being an action that does nothing (<code>pure ()</code>/<code>return ()</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 10, "last_activity_date": 1540384443, "creation_date": 1540384443, "answer_id": 52969120, "question_id": 52968982, "link": "https://stackoverflow.com/questions/52968982/haskell-io-to-io/52969120#52969120", "title": "Haskell: [IO ()] to IO ()", "body": "<p>The function you are looking for is:</p>\n\n<pre><code><b><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:sequence_\" rel=\"noreferrer\">sequence_ :: (Foldable t, Monad m) => t (m a) -> m ()</a></b></code></pre>\n\n<p>But we can actually just replace <code>map</code>, such that we do not need an extra function. You can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:mapM\" rel=\"noreferrer\"><strong><code>mapM_ :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m ()</code></strong></a> here instead of <code>map</code>, so:</p>\n\n<pre><code>for :: a -&gt; (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; (a -&gt; IO ()) -&gt; IO()\nfor s cnd incr ioFn = <b>mapM_</b> ioFn (generate s cnd incr)</code></pre>\n\n<p>This thus will apply the function <code>ioFun</code> on all elements of <code>generate s cnd incr</code>, and eventually return the unit <code>()</code>.</p>\n"}], "owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 52969120, "answer_count": 1, "score": 6, "last_activity_date": 1540384797, "creation_date": 1540384012, "last_edit_date": 1540384797, "question_id": 52968982, "link": "https://stackoverflow.com/questions/52968982/haskell-io-to-io", "title": "Haskell: [IO ()] to IO ()", "body": "<p>Haskell wiki has the following question:</p>\n\n<p><a href=\"https://en.wikibooks.org/wiki/Haskell/Higher-order_functions\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/Haskell/Higher-order_functions</a>\n<code>\nfor :: a -&gt; (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; (a -&gt; IO ()) -&gt; IO ()\nfor i p f job = -- ???\n</code></p>\n\n<p>I was able to come up with the following implementation:</p>\n\n<pre><code>generate :: a -&gt; (a-&gt;Bool) -&gt; (a-&gt;a) -&gt; [a]\ngenerate s cnd incr = if (cnd s) then [] else [s] ++ generate (incr s) cnd incr\n\n-- collapse :: [IO ()] -&gt; IO ()\n-- collapse (x:xs) = x ++ collapse xs\n-- does not work ^^^^^^\n\n\nfor::a-&gt;(a-&gt;Bool)-&gt;(a-&gt;a)-&gt;(a-&gt;IO())-&gt;IO()\nfor s cnd incr ioFn = map (ioFn) (generate s cnd incr)\n</code></pre>\n\n<p>Ofcourse <code>map (ioFn) (generate s cnd incr)</code> results in <code>[IO ()]</code>. I am not sure how this can be transformed to <code>IO ()</code>\nI need something like <code>foldl</code> but the one that works with <code>[IO ()]</code> instead of <code>[a]</code>.</p>\n"}, {"tags": ["string", "list", "haskell", "recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1540371355, "post_id": 52964773, "comment_id": 92836119, "body": "What is not working with your attempt?"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540371445, "post_id": 52964773, "comment_id": 92836176, "body": "I haven&#39;t tried yet i would like to know how to code the problem"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540371469, "post_id": 52964773, "comment_id": 92836192, "body": "Basically u receive a list and then u gotta split it like that and i don&#39;t know how to do it"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1540371483, "post_id": 52964773, "comment_id": 92836202, "body": "Homework questions without an attempt are off-topic on StackOverflow: <a href=\"https://softwareengineering.meta.stackexchange.com/questions/6166/open-letter-to-students-with-homework-problems/\" title=\"open letter to students with homework problems\">softwareengineering.meta.stackexchange.com/questions/6166/&hellip;</a>"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540371584, "post_id": 52964773, "comment_id": 92836270, "body": "I&#39;ve tried to do it but my code doesn&#39;t work. I tried to code it like first u check if the first element of the list is equal to the next one if it is u keep checking if it isnt u split it"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540371598, "post_id": 52964773, "comment_id": 92836277, "body": "But the way i did it doesn&#39;t work"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540371619, "post_id": 52964773, "comment_id": 92836296, "body": "i&#39;ve been trying to do this for a week now so that&#39;s why i&#39;m asking for help"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1540371658, "post_id": 52964773, "comment_id": 92836322, "body": "well you can share the attempt that does not work, such that we can help fixing it."}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540372097, "post_id": 52964773, "comment_id": 92836615, "body": "List xs = ListSplit xs ListSplit (x:xs)       |x == head xs = x : ListSplit x xs       |otherwise = x:[]"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540372393, "post_id": 52964773, "comment_id": 92836815, "body": "Ok, a first problem I spot is that your function starts with an <i>uppercase</i>. Functions start with a lowercase in Haskell. It is also not clear to me why you define two functions: <code>List</code> and <code>SplitList</code>, since you basically define <code>List</code> to be exactly the same as <code>SplitList</code>."}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540372442, "post_id": 52964773, "comment_id": 92836840, "body": "i know but the first function has more than 1 guard"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540372488, "post_id": 52964773, "comment_id": 92836875, "body": "list xs       |length xs == 0 = &quot;&quot;       |otherwise = listSplit xs        listSplit (x:xs)       |x == head xs = x : ListSplit x xs       |otherwise = x:[]"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1540372515, "post_id": 52964773, "comment_id": 92836898, "body": "please <a href=\"https://stackoverflow.com/posts/52964773/edit\">edit</a> the question."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1540373524, "post_id": 52964773, "comment_id": 92837537, "body": "Try <code>words</code>, it is in the Prelude."}, {"owner": {"reputation": 23007, "user_id": 7943564, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b6f0ad4cd865587a782bf697d3b18d18?s=128&d=identicon&r=PG&f=1", "display_name": "glennsl", "link": "https://stackoverflow.com/users/7943564/glennsl"}, "edited": false, "score": 0, "creation_date": 1540377282, "post_id": 52964773, "comment_id": 92839879, "body": "Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and at the very least explain <b>why</b> it doesn&#39;t work. For bonus points, also explain the reasoning behind your current approach. Help us help you!"}, {"owner": {"reputation": 23007, "user_id": 7943564, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b6f0ad4cd865587a782bf697d3b18d18?s=128&d=identicon&r=PG&f=1", "display_name": "glennsl", "link": "https://stackoverflow.com/users/7943564/glennsl"}, "edited": false, "score": 0, "creation_date": 1540377341, "post_id": 52964773, "comment_id": 92839919, "body": "You might also want to read <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is \u201cCan someone help me?\u201d not an actual question?</a>"}, {"owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "edited": false, "score": 0, "creation_date": 1540384685, "post_id": 52964773, "comment_id": 92844562, "body": "You could get the <code>head</code> then <code>takeWhile</code> elements are equal. Then <code>dropWhile</code> those values. Recurse until <code>[]</code>. Maybe <code>filter</code> everything but numbers out first."}], "answers": [{"tags": [], "owner": {"reputation": 152, "user_id": 1935301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a80cd7bdb07f8b6d39385943c0f6fb4?s=128&d=identicon&r=PG", "display_name": "ryan91", "link": "https://stackoverflow.com/users/1935301/ryan91"}, "is_accepted": true, "score": 1, "last_activity_date": 1540389672, "creation_date": 1540389672, "answer_id": 52970965, "question_id": 52964773, "link": "https://stackoverflow.com/questions/52964773/how-to-split-a-list-of-numbers-into-a-set-of-list-with-all-the-numbers-in-haskel/52970965#52970965", "title": "How to split a list of numbers into a set of list with all the numbers in Haskell", "body": "<p>So since I don't quite understand your approach and ghci lists 18 compile errors in your code, I'm afraid I can't help you with your attempt at a solution.</p>\n\n<p>As pointed out in a comment, a possible solution would be:</p>\n\n<pre><code>listSplit xs = listSplit' [] (filter (`elem` ['0'..'9']) xs)\n\nlistSplit' ws (x:xs) = listSplit' (ws ++ [x : takeWhile (==x) xs]) (dropWhile (==x) xs)\nlistSplit' ws [] = ws\n</code></pre>\n\n<ol>\n<li><p>Filter every element of the string that is not a number (Data.Char.isNumber would do this, too, but the premise was to only use Prelude functions) and call <code>listSplit'</code> on the filtered list.</p></li>\n<li><p><code>(ws ++ [x : takeWhile (==x) xs])</code> collects everything in <code>xs</code> until it reaches a letter that does not equal <code>x</code>, wraps this in a list and appends it to <code>ws</code>.</p></li>\n<li><p><code>(dropWhile (==x) xs)</code> removes every letter in <code>xs</code> until it reaches a letter that does not equal <code>x</code>.</p></li>\n<li><p>Finally, the function calls itself with the updated <code>ws</code> and the reduced <code>xs</code></p></li>\n<li><p>If there are no more remaining elements, the function returns <code>ws</code></p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 980, "user_id": 188732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/874f701e9232b9e40cc70669bdc55924?s=128&d=identicon&r=PG", "display_name": "kongo2002", "link": "https://stackoverflow.com/users/188732/kongo2002"}, "is_accepted": false, "score": 0, "last_activity_date": 1540401183, "last_edit_date": 1540401183, "creation_date": 1540394658, "answer_id": 52972710, "question_id": 52964773, "link": "https://stackoverflow.com/questions/52964773/how-to-split-a-list-of-numbers-into-a-set-of-list-with-all-the-numbers-in-haskel/52972710#52972710", "title": "How to split a list of numbers into a set of list with all the numbers in Haskell", "body": "<p>If your goal is to use very few pre-defined functions this might give you some ideas:</p>\n\n<pre><code>listSplit :: String -&gt; [String]\nlistSplit xs =\n  let (as, a) = foldr go ([], []) numbers\n  in  a : as\n where\n  isNumber x = x `elem` ['0'..'9']\n  numbers    = filter isNumber xs\n\n  go cur (res, []) = (res, [cur])\n  go cur (res, lst@(a:_))\n    | a == cur  = (res, a : lst)\n    | otherwise = (lst : res, [cur])\n</code></pre>\n\n<p>Of course you can replace <code>foldr</code> with your own recursion as well:</p>\n\n<pre><code>numberSplit :: String -&gt; [String]\nnumberSplit xs =\n  let numbers = filter (`elem` ['0'..'9']) xs\n  in  listSplit numbers\n\n\nlistSplit :: Eq a =&gt; [a] -&gt; [[a]]\nlistSplit =\n  reverse . go [] []\n where\n  go acc as [] = as : acc\n  go acc [] (x:xs) = go acc [x] xs\n  go acc as@(a:_) (x:xs)\n    | a == x    = go acc (a : as) xs\n    | otherwise = go (as : acc) [x] xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "is_accepted": false, "score": 0, "last_activity_date": 1540410248, "last_edit_date": 1540410248, "creation_date": 1540398722, "answer_id": 52973959, "question_id": 52964773, "link": "https://stackoverflow.com/questions/52964773/how-to-split-a-list-of-numbers-into-a-set-of-list-with-all-the-numbers-in-haskel/52973959#52973959", "title": "How to split a list of numbers into a set of list with all the numbers in Haskell", "body": "<p>I had a moment to implement this but I think this is what you're looking for.</p>\n\n<pre><code>listSplit s = go filtered\n  where filtered = [c | c &lt;- s, elem c ['0'..'9']]\n        go [] = []\n        go (x:xs) = (x : takeWhile (== x) xs) : (go $ dropWhile (== x) xs)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 52970965, "answer_count": 3, "score": -2, "last_activity_date": 1540410248, "creation_date": 1540371286, "last_edit_date": 1540373048, "question_id": 52964773, "link": "https://stackoverflow.com/questions/52964773/how-to-split-a-list-of-numbers-into-a-set-of-list-with-all-the-numbers-in-haskel", "title": "How to split a list of numbers into a set of list with all the numbers in Haskell", "body": "<p>How do i split a list in Haskell, for example, \"222 33244\" into [\"222\",\"33\",\"2\",\"444\"] only through recursion and fuctions on the prelude?</p>\n\n<p>My current attempt is:</p>\n\n<pre><code>list xs\n  |length xs == 0 = \"\"\n  |otherwise = listSplit xs\n\n listSplit (x:xs)\n  |x == head xs = x : ListSplitNext x xs\n  |otherwise = x:[]\n\n listSplitNext a (x:xs)\n  |a == x = a : listSplitNext x xs\n  |otherwise = listSplit xs\n</code></pre>\n"}, {"tags": ["sorting", "haskell", "int", "digits"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1540369876, "post_id": 52964295, "comment_id": 92835269, "body": "Well it looks like you do this in two steps (a) obtain the individual digits, and (b) check if these are ordered."}, {"owner": {"reputation": 89, "user_id": 7256731, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-kqOYXoYkmrM/AAAAAAAAAAI/AAAAAAAAANk/DgRGAEkiRKM/photo.jpg?sz=128", "display_name": "Eduardo Ramos", "link": "https://stackoverflow.com/users/7256731/eduardo-ramos"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540370078, "post_id": 52964295, "comment_id": 92835385, "body": "I have found out a way to do the first step: <code>digits:: Integral x =&gt; x -&gt; [x] digits 0 = [] digits x = listaDigitos (x div 10) ++ [x mod 10].</code> Any clues on the second one? Thanks."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1540370135, "post_id": 52964295, "comment_id": 92835412, "body": "use <code>zip</code> to get every two consecutive digits, and then check if for <code>all</code> items it holds that <code>digit &lt;= nxt_digit</code>."}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 7671431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8dbf6f132deeebc3106cf3e6ee9fbd9?s=128&d=identicon&r=PG&f=1", "display_name": "vps", "link": "https://stackoverflow.com/users/7671431/vps"}, "is_accepted": true, "score": 1, "last_activity_date": 1553185435, "last_edit_date": 1553185435, "creation_date": 1540370674, "answer_id": 52964568, "question_id": 52964295, "link": "https://stackoverflow.com/questions/52964295/check-if-number-has-its-digits-in-order/52964568#52964568", "title": "Check if number has its digits in order", "body": "<p>My idea is this:</p>\n\n<pre><code>ordenado n\n   | mod n 10 &gt; mod (div n 10) 10 = ordenado (div n 10)\n   | n == 0 = True\n   | otherwise = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 6, "last_activity_date": 1540372785, "creation_date": 1540372785, "answer_id": 52965329, "question_id": 52964295, "link": "https://stackoverflow.com/questions/52964295/check-if-number-has-its-digits-in-order/52965329#52965329", "title": "Check if number has its digits in order", "body": "<p>I think @vps approach is proper enough but just for some variety you may also do the job as follows;</p>\n\n<pre><code>Prelude&gt; and $ zipWith (&lt;) &lt;*&gt; tail $ show 1479\nTrue\nPrelude&gt; and $ zipWith (&lt;) &lt;*&gt; tail $ show 1293\nFalse\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1541058996, "last_edit_date": 1541058996, "creation_date": 1540378969, "answer_id": 52967334, "question_id": 52964295, "link": "https://stackoverflow.com/questions/52964295/check-if-number-has-its-digits-in-order/52967334#52967334", "title": "Check if number has its digits in order", "body": "<p>You can convert it into String and use simple recursion and pattern matching. </p>\n\n<pre><code>   checkInOrder :: Int -&gt; Bool\n   checkInOrder x = isInOrder $ show x\n\n   isInOrder :: (Ord a) =&gt; [a] -&gt; Bool    \n   isInOrder [] = True\n   isInOrder [x] = True\n   isInOrder (x:y:xs) = (x &lt; y) &amp;&amp; (isInOrder (y:xs))\n\n   main = print (checkInOrder 1234) \n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 7256731, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-kqOYXoYkmrM/AAAAAAAAAAI/AAAAAAAAANk/DgRGAEkiRKM/photo.jpg?sz=128", "display_name": "Eduardo Ramos", "link": "https://stackoverflow.com/users/7256731/eduardo-ramos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 52964568, "answer_count": 3, "score": -3, "last_activity_date": 1553185435, "creation_date": 1540369790, "last_edit_date": 1540377033, "question_id": 52964295, "link": "https://stackoverflow.com/questions/52964295/check-if-number-has-its-digits-in-order", "title": "Check if number has its digits in order", "body": "<p>I am trying to check if, given any number, its digits are in order. Example:</p>\n\n<p>1479 -> TRUE</p>\n\n<p>1293 -> FALSE</p>\n\n<p>Is there a proper way to do this in Haskell? I am new to the language and feel really lost at the moment. Thank you.</p>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1540363879, "post_id": 52962370, "comment_id": 92831831, "body": "There is no way to write this function. Haskell does not support dependant types."}], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 1, "last_activity_date": 1540428796, "creation_date": 1540428796, "answer_id": 52979834, "question_id": 52962370, "link": "https://stackoverflow.com/questions/52962370/how-to-convert-a-type-from-templatehaskell-to-a-proxy/52979834#52979834", "title": "How to convert a Type (from TemplateHaskell) to a Proxy?", "body": "<p>You want a function that, given a type, produces <em>an expression</em> for a <code>Proxy</code> for that type.</p>\n\n<pre><code>proxyFor :: Type -&gt; Exp\nproxyFor = SigE (ConE 'Proxy) . AppT (ConT ''Proxy)\n</code></pre>\n\n<p>e.g.</p>\n\n<pre><code>ghci&gt; let x = $(return $ proxyFor (ConT ''Int)) in x\nProxy\n</code></pre>\n\n<p>You can <code>map</code> <code>proxyFor</code> over your <code>[Type]</code>, get a <code>[Exp]</code>, and apply them to your function.</p>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540428796, "creation_date": 1540362908, "question_id": 52962370, "link": "https://stackoverflow.com/questions/52962370/how-to-convert-a-type-from-templatehaskell-to-a-proxy", "title": "How to convert a Type (from TemplateHaskell) to a Proxy?", "body": "<p>I'm neck deep in some complex TemplateHaskell and am desperately looking for a function with the following type signature:</p>\n\n<pre><code>Language.Haskell.TH.Type -&gt; Data.Proxy.Proxy a\n</code></pre>\n\n<p>Does something like this exist? I can appreciate that it would be hard to determine the type <code>a</code> in the type-sig given above, but is there no way that that the compiler can look at what is inside <code>Type</code> and figure out what <code>a</code> should be?</p>\n\n<p>Here's more context of the overall problem I'm trying to solve: I've \"de-structured\" a record-type via TH and have a value of <code>[Type]</code>, where each element in the list corresponds to a field in the record. I need to pass each of these types to an existing function that takes only a <code>Proxy a</code>. If it makes things easier, the original record already has an instance of <code>Generic</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 2, "creation_date": 1540339277, "post_id": 52959263, "comment_id": 92825836, "body": "This is still a homework question, and you have not attempted to solve the problem."}, {"owner": {"reputation": 13, "user_id": 10549099, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xboOceFcfts/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCgWV3k7rtfjmYge1tclgOtq8FpNA/mo/photo.jpg?sz=128", "display_name": "Hask", "link": "https://stackoverflow.com/users/10549099/hask"}, "reply_to_user": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 2, "creation_date": 1540339524, "post_id": 52959263, "comment_id": 92825884, "body": "See that code. Just 1 part missing from the question k of 17, return true since 10 + 7 is 17. Just that. Yes it is homework. I have done most of it already"}, {"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 1, "creation_date": 1540340484, "post_id": 52959263, "comment_id": 92826083, "body": "The part that is missing is the main part.  And you did not attempt it."}, {"owner": {"reputation": 26090, "user_id": 1324345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49a5646905e90183ecc762ff8ea35ca1?s=128&d=identicon&r=PG", "display_name": "alroc", "link": "https://stackoverflow.com/users/1324345/alroc"}, "edited": false, "score": 1, "creation_date": 1540344309, "post_id": 52959263, "comment_id": 92826779, "body": "I&#39;m voting to close this question as off-topic because it is a homework question"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1540370929, "post_id": 52959263, "comment_id": 92835875, "body": "So the problem is <a href=\"https://i.imgur.com/rCr9A.png\" rel=\"nofollow noreferrer\">in two parts</a> and you have done Part 1."}], "answers": [{"tags": [], "owner": {"reputation": 8823, "user_id": 10335956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/257330a2508f0360e0c81b432d25a6e0?s=128&d=identicon&r=PG&f=1", "display_name": "E.Coms", "link": "https://stackoverflow.com/users/10335956/e-coms"}, "is_accepted": false, "score": 0, "last_activity_date": 1540342654, "creation_date": 1540342654, "answer_id": 52959699, "question_id": 52959263, "link": "https://stackoverflow.com/questions/52959263/haskell-given-a-list-of-numbers-and-a-number-k-return-whether-any-two-numbers/52959699#52959699", "title": "Haskell: Given a list of numbers and a number k, return whether any two numbers from the list add up to k", "body": "<p>It's a naive method, not optimized and just show an example.</p>\n\n<pre><code>toList :: String -&gt; [Integer]\ntoList input = read (\"[\" ++ input ++ \"]\")\n\n\n\ncheck :: Integer -&gt; [Integer] -&gt; Bool \ncheck k (x:xs) = if ((k-x) `elem` xs) \n         then True\n         else (check k xs)\ncheck k x = False \n\nmain = do\nlet k = 12\n putStrLn \"Enter a list of numbers (separated by comma):\"\n input &lt;- getLine\n print $  (check k  (toList input))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "is_accepted": true, "score": 1, "last_activity_date": 1541157272, "last_edit_date": 1541157272, "creation_date": 1540362432, "answer_id": 52962259, "question_id": 52959263, "link": "https://stackoverflow.com/questions/52959263/haskell-given-a-list-of-numbers-and-a-number-k-return-whether-any-two-numbers/52962259#52962259", "title": "Haskell: Given a list of numbers and a number k, return whether any two numbers from the list add up to k", "body": "<p>There are following approaches. </p>\n\n<p>1) Create a list pf pairs which are all combinations [(10,10),(10,15),..,(15,10),(15,3)..]. \nNow you can use simple <strong>any</strong> function on this list to check if any pair add up to given number. </p>\n\n<pre><code>getCoupleList :: [a]-&gt;[(a,a)]\ngetCoupleList [] = []\ngetCoupleList [x] = []\ngetCoupleList (x:xs) = map (\\y-&gt;(x,y)) xs ++ getCoupleList xs\n\ngetSumOfCoupleList :: Num a =&gt; [(a,a)]-&gt;[a]\ngetSumOfCoupleList xs = map (\\x -&gt; fst x + snd x) xs \n\nisSum :: [Int]-&gt;Int-&gt;Bool\nisSum xs k = any (==k) $ (getSumOfCoupleList.getCoupleList) xs\n</code></pre>\n\n<p>or directly check wuthout getSumOfCoupleList</p>\n\n<pre><code>isSum xs k = any (\\(a,b)-&gt; a + b == k) $ (getSumOfCoupleList.getCoupleList) xs\n</code></pre>\n\n<p>If you check creating the couple list and finding the sum in not needed. We can directly get the list of sum with simple changes.  </p>\n\n<pre><code>getSumList :: Num a=&gt;[a]-&gt;[a]\ngetSumList [] = []\ngetSumList [x] = []\ngetSumList (x:xs) = map (+x) xs ++ getSumList xs\n\nisSum1 :: [Int]-&gt;Int-&gt;Bool\nisSum1 xs k = any (==k) $ getSumList xs \n</code></pre>\n\n<p>2) Create another list from given list by subtracting every element from 17. Now just check if any number from first list is present in second. </p>\n\n<pre><code>isSum2 :: [Int]-&gt;Int-&gt;Bool \nisSum2 xs k = let newList = map (k-) xs\n                  intersectList = xs `intersect` newList\n                  in not (null intersectList)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10581898, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B3IY2MgoiUk/AAAAAAAAAAI/AAAAAAAABjw/SA5OY5WQUsc/photo.jpg?sz=128", "display_name": "Malick Alexandre Sarr", "link": "https://stackoverflow.com/users/10581898/malick-alexandre-sarr"}, "is_accepted": false, "score": 0, "last_activity_date": 1540920629, "creation_date": 1540920629, "answer_id": 53069812, "question_id": 52959263, "link": "https://stackoverflow.com/questions/52959263/haskell-given-a-list-of-numbers-and-a-number-k-return-whether-any-two-numbers/53069812#53069812", "title": "Haskell: Given a list of numbers and a number k, return whether any two numbers from the list add up to k", "body": "<p>I was recently asked the same exact question in an interview, here's one of my answer</p>\n\n<pre><code>import util\narr = [10, 15, 3, 8]\nk = 17\nfor i in range(0, len(arr)):\n    arr_new.append(abs(arr[i] -17))\n\n\nres= list(set(arr).intersection(arr_new))\n\nif (len(res)&gt;0):\n    print(str(res[0]) + \" + \" + str(res[1]) +\"= \"+ str(k ))\nelse:\n    print(\"No numbers add up to k\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10549099, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xboOceFcfts/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCgWV3k7rtfjmYge1tclgOtq8FpNA/mo/photo.jpg?sz=128", "display_name": "Hask", "link": "https://stackoverflow.com/users/10549099/hask"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1004, "favorite_count": 0, "accepted_answer_id": 52962259, "answer_count": 3, "score": -6, "last_activity_date": 1541157272, "creation_date": 1540338695, "question_id": 52959263, "link": "https://stackoverflow.com/questions/52959263/haskell-given-a-list-of-numbers-and-a-number-k-return-whether-any-two-numbers", "title": "Haskell: Given a list of numbers and a number k, return whether any two numbers from the list add up to k", "body": "<p>Given a list of numbers and a number k, return whether any two numbers from the list add up to k.</p>\n\n<p>For example, given [10, 15, 3, 7] and k of 17, return true since 10 + 7 is 17.</p>\n\n<p>The program must prompt the user for input.</p>\n\n<p>The program must accept the list as a collection of comma separated values.</p>\n\n<p>The values should all be integers.</p>\n\n<p>The input list can be between 1 and 42 number long.</p>\n\n<p>What I have done</p>\n\n<p>I have been able to input the list of integer as a list and seperated by commas but am not able to return true when 2 numbers add to k</p>\n\n<pre><code>toList :: String -&gt; [Integer]\ntoList input = read (\"[\" ++ input ++ \"]\")\n\nmain = do\n   putStrLn \"Enter a list of numbers (separated by comma):\"\n   input &lt;- getLine\n   print $ k (toList input)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1540325145, "post_id": 52955380, "comment_id": 92821596, "body": "I wonder if CPP can help here. Perhaps we can use something like <code>#ifdef HLINT</code> to remove the annotations when not using hlint? (To be honest, I&#39;m also unsure about whether CPP is compatible with Safe Haskell.)"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1540325606, "post_id": 52955380, "comment_id": 92821818, "body": "@chi No conditional inclusions in source; ever."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 2, "creation_date": 1540326400, "post_id": 52955380, "comment_id": 92822178, "body": "This isn&#39;t really an answer, but the Trac ticket at the link tells you to leave a comment if you run into this. The &quot;do not allow any annotations at all under <code>Safe</code>&quot; is apparently just a quick band-aid because no one could be bothered to fix the safety issues properly, and because this legitimate use case was not foreseen. If enough people (and &quot;enough&quot; could may mean 1 or 2) complain, it may be fixed at the source."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 2, "creation_date": 1540327459, "post_id": 52955380, "comment_id": 92822586, "body": "Actually, looking into this more, there seems to be a mechanism to use <code>hlint.yaml</code> instead of annotations(?). But it&#39;s not clear from the documentation how to translate the annotations above into an proper <code>hlint.yaml</code> config. That would be an answer."}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 8858744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce6af5055f7fcb64b18f6060237fc77?s=128&d=identicon&r=PG&f=1", "display_name": "zenhack", "link": "https://stackoverflow.com/users/8858744/zenhack"}, "is_accepted": true, "score": 2, "last_activity_date": 1546572032, "creation_date": 1546572032, "answer_id": 54032725, "question_id": 52955380, "link": "https://stackoverflow.com/questions/52955380/how-can-i-use-annotations-to-customize-hlint-and-mark-my-haskell-package-as-safe/54032725#54032725", "title": "How can I use annotations to customize HLint and mark my Haskell package as Safe?", "body": "<p>Instead of using <code>ANN</code> pragmas, you can use either:</p>\n\n<pre><code>{-# HLINT ignore \"Use mappend\" #-}\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>{- HLINT ignore \"Use mappend\" -}\n</code></pre>\n\n<p>The former will trigger a warning from GHC about an unknown pragma.</p>\n\n<p>See also:</p>\n\n<p><a href=\"https://github.com/ndmitchell/hlint#ignoring-hints\" rel=\"nofollow noreferrer\">https://github.com/ndmitchell/hlint#ignoring-hints</a></p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 1, "accepted_answer_id": 54032725, "answer_count": 1, "score": 7, "last_activity_date": 1546603780, "creation_date": 1540318421, "last_edit_date": 1546603780, "question_id": 52955380, "link": "https://stackoverflow.com/questions/52955380/how-can-i-use-annotations-to-customize-hlint-and-mark-my-haskell-package-as-safe", "title": "How can I use annotations to customize HLint and mark my Haskell package as Safe?", "body": "<p>In <a href=\"https://github.com/orome/crypto-enigma-hs\" rel=\"noreferrer\">my package</a> I have <a href=\"https://github.com/orome/crypto-enigma-hs/blob/73b6e3c28fcf7394667ed1fe97075c1355788f6b/Crypto/Enigma.hs#L76\" rel=\"noreferrer\">several annotations</a> to help customize my use of <code>hlint</code>:</p>\n\n<pre><code>{-# ANN module (\"HLint: ignore Use infix\"::String) #-}\n{-# ANN module (\"HLint: ignore Use mappend\"::String) #-}\n{-# ANN module (\"HLint: ignore Use fmap\"::String) #-}\n{-# ANN module (\"HLint: error Redundant $\"::String) #-}\n{-# ANN module (\"HLint: ignore Use .\"::String) #-}\n</code></pre>\n\n<p>But when I try to mark my package as Safe with</p>\n\n<pre><code>{-# LANGUAGE Safe #-}\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>    \u2022 Annotations are not compatible with Safe Haskell.\n      See https://ghc.haskell.org/trac/ghc/ticket/10826\n    \u2022 In the annotation:\n        {-# ANN module (\"HLint: ignore Use .\" :: String) #-}\n   |\n80 | {-# ANN module (\"HLint: ignore Use .\"::String) #-}\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>while with the annotations removed, I can build and test as Safe without errors.</p>\n\n<p>Is there an alternative way to customize Hlint that allows my package to be marked as Safe?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 0, "creation_date": 1540317579, "post_id": 52955062, "comment_id": 92818053, "body": "Do you mean <code>type Application = Request -&gt; (forall b. (Response -&gt; IO b)) -&gt; IO b</code> ?  I think the final paren may not be where you intend."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 1, "creation_date": 1540322804, "post_id": 52955062, "comment_id": 92820509, "body": "No, I meant what I said. See <a href=\"https://github.com/yesodweb/wai/commit/1e1b8c222cce96c3d58cd27318922c318642050d\" rel=\"nofollow noreferrer\">the history of <code>wai</code></a>. The type you gave is invalid. <code>b</code> is out of scope in the final <code>IO b</code>."}, {"owner": {"reputation": 249, "user_id": 1722399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e98942645afd09fdd8e00853bff4f2?s=128&d=identicon&r=PG", "display_name": "xafizoff", "link": "https://stackoverflow.com/users/1722399/xafizoff"}, "edited": false, "score": 0, "creation_date": 1540362303, "post_id": 52955062, "comment_id": 92831091, "body": "Thank you for such an exhaustive answer."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 6, "last_activity_date": 1541597435, "last_edit_date": 1541597435, "creation_date": 1540317164, "answer_id": 52955062, "question_id": 52954218, "link": "https://stackoverflow.com/questions/52954218/responsereceived-data-type-in-wai/52955062#52955062", "title": "ResponseReceived data type in WAI", "body": "<p><code>Application</code> should really be</p>\n\n<pre><code>type Application = Request -&gt; (forall b. (Response -&gt; IO b) -&gt; IO b)\n-- a.k.a. Request -&gt; Codensity IO Response\n-- newtype Codensity f a = Codensity { runCodensity :: forall b. (a -&gt; f b) -&gt; f b }\n-- which is closely related to continuations\n</code></pre>\n\n<p>That is, an <code>Application</code> takes a <code>Request</code>, a function <code>f</code>, and it calls <code>f</code> with a <code>Response</code>.</p>\n\n<pre><code>app :: Application\napp req f = f _resp\n</code></pre>\n\n<p><code>Application</code> <em>forces</em> you to call <code>f</code>. There is no other function capable of producing an <code>IO b</code> inside <code>app</code> except for <code>f</code>, so, since <code>app</code> must produce an <code>IO b</code>, <code>app</code> must call <code>f</code>. <code>wai</code> depends on <code>app</code> calling <code>f</code>, and it could enforce it with this <code>Application</code>. However, <code>Application</code> is higher-ranked, which is somewhat undesirable.</p>\n\n<p>The solution actually used is:</p>\n\n<pre><code>type Application = Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived\n-- a.k.a. Request -&gt; ContT ResponseReceived IO Response\n-- in general, ContT is \"bigger\" and \"weaker\" than Codensity\n-- but, in exchange, does not require higher ranked types\n\napp :: Application\napp req f = f _resp\n</code></pre>\n\n<p><code>f</code> is still the only thing <code>app</code> has on hand that can produce a <code>ResponseReceived</code>, as long as <code>app</code> doesn't break the contract it has with <code>wai</code> and import the constructor. You can't replace <code>ResponseReceived</code> with <code>()</code>. Everyone and their mother has the constructor (<code>()</code>) for <code>()</code> available. I don't think it's even possible to <em>not</em> have it. This makes it unsuitable for <code>Application</code>:</p>\n\n<pre><code>type Application = Request -&gt; (Response -&gt; IO ()) -&gt; IO ()\napp :: Application\napp _ _ = return () -- uh oh\n</code></pre>\n"}], "owner": {"reputation": 249, "user_id": 1722399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e98942645afd09fdd8e00853bff4f2?s=128&d=identicon&r=PG", "display_name": "xafizoff", "link": "https://stackoverflow.com/users/1722399/xafizoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 52955062, "answer_count": 1, "score": 0, "last_activity_date": 1541597435, "creation_date": 1540313702, "last_edit_date": 1592644375, "question_id": 52954218, "link": "https://stackoverflow.com/questions/52954218/responsereceived-data-type-in-wai", "title": "ResponseReceived data type in WAI", "body": "<p>I wonder, why WAI's <code>Aplication</code> type is designed as <code>Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived</code>. Why not <code>Request -&gt; (Response -&gt; IO ()) -&gt; IO ()</code>? The docs say</p>\n<blockquote>\n<p>A special datatype to indicate that the WAI handler has received the response. This is to avoid the need for Rank2Types in the definition of Application.</p>\n<p>It is highly advised that only WAI handlers import and use the data constructor for this data type.</p>\n</blockquote>\n<p>How this special datatype helps to avoid <code>Rank2Types</code>?</p>\n"}, {"tags": ["ios", "haskell", "cross-compiling", "template-haskell"], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1540326503, "creation_date": 1540313406, "last_edit_date": 1540326503, "question_id": 52954142, "link": "https://stackoverflow.com/questions/52954142/how-do-i-use-ghcslave-without-signing-errors", "title": "How do I use GHCSlave without signing errors?", "body": "<p>I have gotten <a href=\"https://github.com/zw3rk/ghc-slave\" rel=\"nofollow noreferrer\"><code>ghc-slave</code></a> to build for an iPhone 6S running iOS 12.0.1. I put this into a helper script so that I don't confuse <code>cabal</code> with constantly changing IP addresses:</p>\n\n<p><strong><code>connect_to_iphone</code></strong></p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>#!/bin/bash\nexec iserv-proxy \"$@\" &lt;iphone ip&gt; &lt;port&gt;\n</code></pre>\n\n<p>I started GHCSlave on the iPhone, and I trusted my developer certificate as it asked.</p>\n\n<p>I then cloned <code>singletons</code>, and tried to compile it.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>git clone https://github.com/goldfirere/singletons\ncd singletons\ncabal --with-ghc=aarch64-apple-ios-ghc \\\n      --with-ghc-pkg=aarch64-apple-ios-ghc-pkg \\\n      --with-gcc=aarch64-apple-ios-clang \\\n      --with-ld=aarch64-apple-ios-ld \\\n      --hsc2hs-options=--cross-compile \\\n      --disable-shared \\\n      --configure-option=--host=aarch64-apple-ios\n      --ghc-options=-fexternal-interpreter \\\n      --ghc-options=-pgmi=/path/to/connect_to_iphone\n      new-configure\ncabal new-build\n</code></pre>\n\n<p>When building <code>th-lift-instances</code>, TH was first needed. GHCSlave on the iPhone showed that the libraries were being sent over to run the TH. However, the moment execution of the TH actually began, GHCSlave crashed. The logs from XCode show</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>...\nException Type:  EXC_BAD_ACCESS (SIGKILL - CODESIGNING)\n...\nTermination Reason: Namespace CODESIGNING, Code 0x2\n...\n</code></pre>\n\n<p>I'm not sure where to get started fixing this. How do I use GHCSlave without signing errors?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1540313332, "post_id": 52953919, "comment_id": 92815935, "body": "Have you studied the error message carefully? What do you think it&#39;s telling you, or what specifically are you struggling with? (reading type errors is a really important skill to learn/practice so I think you&#39;d be better served with a hint rather than someone just telling you how to fix your code)"}, {"owner": {"reputation": 63, "user_id": 9438207, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RIhJNvBvNt8/AAAAAAAAAAI/AAAAAAAAAXA/YbekIDjAMVQ/photo.jpg?sz=128", "display_name": "Ben Graham", "link": "https://stackoverflow.com/users/9438207/ben-graham"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1540313618, "post_id": 52953919, "comment_id": 92816077, "body": "Fair point, i managed to get through the second error but the first one has really stumped me"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1540313966, "post_id": 52953919, "comment_id": 92816263, "body": "Hint: what is the type of <code>Copy</code>? What is the type of <code>Copy &#39;a&#39;</code>? (You can ask <code>ghci</code> by doing <code>Prelude&gt; :t Copy &#39;a&#39;</code>) What is the type of the <code>x</code> bound in the lambda in <code>filter</code>?"}, {"owner": {"reputation": 63, "user_id": 9438207, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RIhJNvBvNt8/AAAAAAAAAAI/AAAAAAAAAXA/YbekIDjAMVQ/photo.jpg?sz=128", "display_name": "Ben Graham", "link": "https://stackoverflow.com/users/9438207/ben-graham"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1540314513, "post_id": 52953919, "comment_id": 92816548, "body": "the type of Copy &#39;a&#39; is Edit, so im guessing the x in the lambda function isnt. Can i please get a hint on how to make it so, as i thought the x would be polymorphic :/"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1540315773, "post_id": 52953919, "comment_id": 92817169, "body": "You know the type of <code>Copy &#39;a&#39;</code> is <code>Edit</code>, so it stands to reason that <code>Copy</code> on its own is <code>Char -&gt; Edit</code> (a function that takes a <code>Char</code> and returns an <code>Edit</code>). On the other hand, <code>x</code> is an <code>Edit</code>, which is a different type."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1540316177, "post_id": 52953919, "comment_id": 92817363, "body": "Hopefully the last comment ^ helps clear up the type error. What you really want to do is not use <code>(&#47;=) :: Eq a=&gt; a -&gt; a -&gt; Bool</code>, but instead do <code>filter isCopy ...</code> where <code>isCopy</code> is defined using pattern-matching"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1540318229, "post_id": 52953919, "comment_id": 92818355, "body": "If you want some motivation on how to write an <code>isCopy</code> function then look at the <code>Data.Maybe.isJust</code> function."}], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 1, "last_activity_date": 1540354691, "creation_date": 1540354691, "answer_id": 52961049, "question_id": 52953919, "link": "https://stackoverflow.com/questions/52953919/calculating-cost-of-edit-operations-in-list-haskell/52961049#52961049", "title": "Calculating cost of edit operations in List haskell", "body": "<p><code>Copy</code> is a constructor of <code>Edit</code> with one field of type <code>Char</code>, so it has the following function type:</p>\n\n<pre><code>Copy :: Char -&gt; Edit\n</code></pre>\n\n<p>In fact, with <code>{-# LANGUAGE GADTSyntax #-}</code> you can write the type of each constructor explicitly in the definition, which you may find clearer:</p>\n\n<pre><code>data Edit where\n  Change :: Char -&gt; Char -&gt; Edit\n  Copy   :: Char -&gt; Edit\n  Delete :: Char -&gt; Edit\n  Insert :: Char -&gt; Edit\n  deriving (Eq, Show)\n</code></pre>\n\n<p>Therefore the function that you pass to <code>filter</code>, <code>\\x -&gt; x /= Copy</code>, has the following inferred type, because you\u2019re trying to compare <code>x</code> to the function <code>Copy</code>:</p>\n\n<pre><code>(Eq (Char -&gt; Edit))\n  =&gt; (Char -&gt; Edit) -&gt; Bool\n</code></pre>\n\n<p><code>filter</code> has this type:</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>And because <code>a</code> is deduced as equal to <code>Char -&gt; Edit</code>, the type of <code>filter (\\x -&gt; x /= Copy)</code> is inferred as:</p>\n\n<pre><code>(Eq (Char -&gt; Edit))\n  =&gt; [Char -&gt; Edit] -&gt; [Char -&gt; Edit]\n</code></pre>\n\n<p>Which of course is not what you want, for two reasons\u2014first, it doesn\u2019t express what you want (that an edit wasn\u2019t constructed with the <code>Copy</code> constructor), and second, it can\u2019t work because there\u2019s no instance <code>Eq (Char -&gt; Edit)</code> that lets you compare functions, nor could you write one since functions aren\u2019t comparable.</p>\n\n<p>If you want to check whether a value of type <code>Edit</code> was constructed with <code>Copy</code> in the call to <code>filter</code>, you should use <em>pattern-matching</em> instead. A simple way to do that is to write a function:</p>\n\n<pre><code>isCopy :: Edit -&gt; Bool\nisCopy edit = case edit of\n  {- your implementation here -}\n</code></pre>\n\n<p>Then use that in the condition of <code>filter</code>:</p>\n\n<pre><code>filter (\\x -&gt; {- your condition here -})\n</code></pre>\n\n<p>And it will have type <code>[Edit] -&gt; [Edit]</code> as desired. Instead of writing a separate function <code>isCopy</code>, you can also write this inline using a <code>case</code> expression:</p>\n\n<pre><code>filter (\\x -&gt; case x of\n  {- your implementation here -})\n</code></pre>\n\n<p>Another way to solve this problem is to break it down into smaller parts, by writing a function <code>cost1 :: Edit -&gt; Int</code> which returns the cost of a <em>single</em> edit:</p>\n\n<pre><code>cost1 :: Edit -&gt; Int\ncost1 edit = case edit of\n  Change _ _ -&gt; 1\n  Copy _ -&gt; 0\n  {- remaining cases -}\n</code></pre>\n\n<p>Then <code>cost</code> can use <code>map</code> or a list comprehension to apply <code>cost1</code> to the whole list of edits, and take the <code>sum</code> of the result.</p>\n"}], "owner": {"reputation": 63, "user_id": 9438207, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RIhJNvBvNt8/AAAAAAAAAAI/AAAAAAAAAXA/YbekIDjAMVQ/photo.jpg?sz=128", "display_name": "Ben Graham", "link": "https://stackoverflow.com/users/9438207/ben-graham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 52961049, "answer_count": 1, "score": 1, "last_activity_date": 1540354691, "creation_date": 1540312561, "last_edit_date": 1540313441, "question_id": 52953919, "link": "https://stackoverflow.com/questions/52953919/calculating-cost-of-edit-operations-in-list-haskell", "title": "Calculating cost of edit operations in List haskell", "body": "<pre><code>data Edit = \n        Change Char Char|\n        Copy Char|\n        Delete Char|\n        Insert Char\n        deriving (Eq, Show)\n\ncost :: [Edit] -&gt; Int\ncost edits\n    = length ( filter (\\x -&gt; x /= Copy) edits )\n\nmain :: IO()\nmain\n    = putStrLn ( show ( cost [Copy 'e', Copy 'x', Insert 'm', Insert 'o', Change 'e' 'u', Copy 't', Delete 'e', Change 'r' 'h'] ) )\n</code></pre>\n\n<p>I am trying to calculate the cost of List using an algebraic data type, each edit costs 1 apart from copy which costs 0.</p>\n\n<p>I am currently getting the error:</p>\n\n<pre><code>    * Couldn't match type `Edit' with `Char -&gt; Edit'\n      Expected type: [Char -&gt; Edit]\n        Actual type: [Edit]\n    * In the second argument of `filter', namely `edits'\n      In the first argument of `length', namely\n        `(filter (\\ x -&gt; x /= Copy) edits)'\n      In the expression: length (filter (\\ x -&gt; x /= Copy) edits)\n                                        ^^^^^\n</code></pre>\n\n<p>I cant seen to grasp algebraic types so any help appreciated</p>\n"}, {"tags": ["haskell", "time", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10479712, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YF0cZu3Saq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXSc2LVlx58EBWp06qhvwEGMwRBUg/mo/photo.jpg?sz=128", "display_name": "juice", "link": "https://stackoverflow.com/users/10479712/juice"}, "edited": false, "score": 0, "creation_date": 1540320147, "post_id": 52953221, "comment_id": 92819250, "body": "I&#39;m use parseTimeM,but i&#39;m dont getting error     let dayFromUser = parseTimeM True defaultTimeLocale &quot;%Y-%m-%d %H:%M:%S&quot; (date ++ &quot; 12:00:00&quot;) :: Maybe UTCTime   case dayFromUser of     Nothing -&gt; return $ Left &quot;asd&quot;     Just validDay -&gt; do  when the user enters nonsense, I want the program to immediately die and give an error. But it continues to work. And I get an error from this line already isLeft date         -&gt; return $ Left &quot;error&quot;"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 7, "user_id": 10479712, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YF0cZu3Saq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXSc2LVlx58EBWp06qhvwEGMwRBUg/mo/photo.jpg?sz=128", "display_name": "juice", "link": "https://stackoverflow.com/users/10479712/juice"}, "edited": false, "score": 0, "creation_date": 1540324636, "post_id": 52953221, "comment_id": 92821344, "body": "Please edit your question with the revised code &amp; include the error message that you are now getting."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 1, "last_activity_date": 1540309972, "creation_date": 1540309972, "answer_id": 52953221, "question_id": 52952640, "link": "https://stackoverflow.com/questions/52952640/where-can-i-catch-an-exception/52953221#52953221", "title": "Where can I catch an exception?", "body": "<p>The easiest change to your program is to use <a href=\"https://hackage.haskell.org/package/time-1.9.2/docs/Data-Time-Format.html#v:parseTimeM\" rel=\"nofollow noreferrer\">parseTimeM</a> instead of <code>parseTimeOrError</code>.  </p>\n\n<p><code>Maybe</code> is one of the possible types that can be filled in for <code>m</code>, so you can write:</p>\n\n<p><code>parseTimeM True defaultTimeLocale \"%Y-%m-%d %H:%M:%S\" \"2018-10-23 11:41:20\" :: Maybe UTCTime</code></p>\n\n<p>In your program, <code>validDay -&gt; do</code> can change to <code>Just validDay -&gt; do</code>, and GHC will infer the <code>Maybe</code>, so you won't need the explicit type signature that I gave above.</p>\n"}], "owner": {"reputation": 7, "user_id": 10479712, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YF0cZu3Saq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXSc2LVlx58EBWp06qhvwEGMwRBUg/mo/photo.jpg?sz=128", "display_name": "juice", "link": "https://stackoverflow.com/users/10479712/juice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1540309972, "creation_date": 1540308164, "question_id": 52952640, "link": "https://stackoverflow.com/questions/52952640/where-can-i-catch-an-exception", "title": "Where can I catch an exception?", "body": "<p>My code: </p>\n\n<pre><code>{-# LANGUAGE MultiWayIf        #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nmodule UserData where\n\nimport           Control.Exception\nimport           Data.Either\nimport           Data.Maybe\nimport           Data.Time         (getCurrentTime)\nimport           Data.Time.Clock\nimport           Data.Time.Format\n\nimport           Types\n\nround' :: NominalDiffTime -&gt; Integer\nround' mark\n    | mark &lt; 0 = 0\n    | mark2 &gt; 100 = 100\n    | otherwise = mark2\n    where mark2 = round mark\n\nsupportedCities :: [City]\nsupportedCities = [Aragatsotn .. Yerevan]\n\ngetUserData :: IO (Either String (UTCTime,City))\ngetUserData = do\n    date         &lt;- getDateFromUser\n    cityFromUser &lt;- getCityFromUser\n    if | isLeft date         -&gt; return $ Left \"error\"\n       | isNothing cityFromUser -&gt; return $ Left \"error\"\n       | otherwise      -&gt; let [realDate] = rights [date] in return $ Right \n</code></pre>\n\n<p>(realDate, fromJust cityFromUser)</p>\n\n<pre><code>getDateFromUser :: IO (Either String UTCTime)\ngetDateFromUser = do\n  Prelude.putStrLn \"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0434\u043b\u044f \u043f\u0440\u043e\u0433\u043d\u043e\u0437\u0430 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u0413\u0413\u0413\u0413-\u041c\u041c-\u0414\u0414:\"\n  currentTime &lt;- getCurrentTime\n  date        &lt;- Prelude.getLine\n  let dayFromUser = parseTimeOrError True defaultTimeLocale \"%Y-%m-%d %H:%M:%S\" (date ++ \" 12:00:00\") :: UTCTime\n  case dayFromUser of\n    validDay -&gt; do\n          let differenceInNominalDiffTime = diffUTCTime validDay currentTime\n              secondsInDay = 86400\n              differenceInDays = round' $ differenceInNominalDiffTime / secondsInDay\n          if differenceInDays &gt;= 0 &amp;&amp; differenceInDays &lt;= 5\n              then return $ Right validDay\n              else return $ Left \"asdasd\"\n\ngetCityFromUser :: IO (Maybe City)\ngetCityFromUser = do\n    Prelude.putStrLn \"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043e\u0434\u0438\u043d \u0438\u0437 \u044d\u0442\u0438\u0445 \u043c\u0430\u0440\u0437\u043e\u0432:\"\n    print [Aragatsotn .. Yerevan]\n    cityFromUser &lt;- Prelude.getLine\n    let cityAsString = Prelude.map show supportedCities\n    if cityFromUser `elem` cityAsString\n       then return $ Just (read cityFromUser :: City)\n       else return Nothing\n</code></pre>\n\n<p>This code working.</p>\n\n<p>I getting error</p>\n\n<p>But as far as I understand the parse function, parseTimeOrError returns an exception. How and where should I catch this exception?   </p>\n\n<p>That is, instead of an exception, I need to show some string</p>\n\n<p>like \"sorry,your data is incorrect\"</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1540312428, "post_id": 52952522, "comment_id": 92815505, "body": "these won&#39;t give you rectangles but 4-sided polygons (quadrilateral).  Also you&#39;ll get all the permutations of the 4 sides as separate shapes.  Perhaps define it as a &lt;= b &lt;= c &lt;= d.  Note also that some will be invalid as shapes e.g. (1,1,1,19)"}], "answers": [{"tags": [], "owner": {"reputation": 754, "user_id": 2140910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CtvpI.jpg?s=128&g=1", "display_name": "Bjartur Thorlacius", "link": "https://stackoverflow.com/users/2140910/bjartur-thorlacius"}, "is_accepted": false, "score": 2, "last_activity_date": 1540310208, "creation_date": 1540310208, "answer_id": 52953300, "question_id": 52952522, "link": "https://stackoverflow.com/questions/52952522/how-can-i-use-let-statement-to-get-combinations-for-subset-sum-in-haskell/52953300#52953300", "title": "How can I use let statement to get combinations for subset sum in Haskell?", "body": "<p>Just add an argument name after <code>rectangles</code> and use that in place of 22. Example:</p>\n\n<pre><code>let rectangles perimeter = [(a,b,c,d) | d &lt;- [1..10],c &lt;- [1..10], b &lt;- [1..10], a &lt;-[1..10],\n    a+b+c+d == perimeter]\n</code></pre>\n\n<p><br/><br/></p>\n\n<hr>\n\n<p>Optional Information</p>\n\n<hr>\n\n<p>If you're curious, you can write a function Haskell in a few ways, but only some of them apply in each context.</p>\n\n<p>To define a global function, you omit the let (and make sure that the line(s) is/are unindented and not a part of any other definition).</p>\n\n<pre><code> rectangles perimeter = [(a,b,c,d) | d &lt;- [1..10],c &lt;- [1..10], b &lt;- [1..10], a &lt;- [1..10],\n            perimeter == a+b+c+d]\n</code></pre>\n\n<p>Within a definition, the syntax is the same but surrounded with <code>let</code> .. <code>in</code>.</p>\n\n<pre><code>squares = let\n              sidelengths ceil = [1..ceil]\n          in\n              [ (a,a,a,a) | a &lt;- sidelengths 10 ]\n</code></pre>\n\n<p>If you don't like <code>in</code>, you can use <code>let</code> within <code>do</code>:</p>\n\n<pre><code>    squares = do\n                  let sidelengths ceil = [1..ceil]\n                  [ (a,a,a,a) | a &lt;- sidelengths 10 ]\n</code></pre>\n\n<p>At last, in every instance, you could also move the argument name to the right of the equals sign if you surround it with <code>\\</code> and <code>-&gt;</code>.</p>\n\n<pre><code>let rectangles = \\perimeter-&gt;\n    [(a,b,c,d) | d &lt;- [1..10],c &lt;- [1..10], b &lt;- [1..10], a &lt;-[1..10],\n       a+b+c+d == perimeter]\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10547144, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216801865581116/picture?type=large", "display_name": "Tun&#231; Emran", "link": "https://stackoverflow.com/users/10547144/tun%c3%a7-emran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540324786, "creation_date": 1540307778, "last_edit_date": 1540324786, "question_id": 52952522, "link": "https://stackoverflow.com/questions/52952522/how-can-i-use-let-statement-to-get-combinations-for-subset-sum-in-haskell", "title": "How can I use let statement to get combinations for subset sum in Haskell?", "body": "<pre><code>let rectangles = \n       [(a,b,c,d) | d &lt;- [1..10],c &lt;- [1..10], b &lt;- [1..10], a &lt;- [1..10],a+b+c+d == 22]\n</code></pre>\n\n<p>I have this code that works but I want to make this a function so I can change the value of 22</p>\n"}, {"tags": ["haskell", "data-structures", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1540316040, "post_id": 52950540, "comment_id": 92817286, "body": "Does this approach mean I can put what are now <code>Moving Bullet</code> and <code>Moving Asteroid</code> into one array/list? That seems wonderful"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 1, "creation_date": 1540316183, "post_id": 52950540, "comment_id": 92817370, "body": "Yup! You can have a <code>[Movable]</code> now because they are wrapped up into a single type. In the same vein, since <code>Moving</code> is no longer polymorphic, you can have <code>[Moving]</code> that contains both <code>Bullet</code>s and <code>Asteroid</code>s"}], "tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": true, "score": 3, "last_activity_date": 1540301908, "creation_date": 1540301908, "answer_id": 52950540, "question_id": 52949311, "link": "https://stackoverflow.com/questions/52949311/haskell-pattern-matching-on-different-data-types/52950540#52950540", "title": "Haskell Pattern matching on different data types", "body": "<p>You can't pattern match this way because <code>Moving o</code> is polymorphic. If you had a function that moved only bullets, <code>Moving Bullet</code> would work to pattern match just like this.</p>\n\n<p>There are lots of different ways to get around this.One easy solution, depending on other aspects of your game, would be to bring <code>Bullet</code> and <code>Asteroid</code> into a single <code>Movable</code> data type that you can pattern match on instead: </p>\n\n<pre><code>data Moving = Moving {\n                    position :: Position,\n                    velocity :: Velocity,\n                    size :: Float, \n                    specifics :: Movable\n}\n\ndata Movable = B Bullet | A Asteroid \n\ndata Bullet = Bullet {\n                damage :: Int\n              }\n            | DeadBullet\n\ndata Asteroid = Asteroid  \n              | DeadAsteroid \n\nmove :: Float -&gt; Moving -&gt; Moving\nmove secs (Moving (x, y) v@(vx, vy) s t@(B _)) = Moving (x', y') v s t\n  where x' = (x + vx * secs)\n        y' = (y + vy * secs)\n\nmove secs (Moving (x, y) v@(vx, vy) s t) = Moving (x', y') v s t\n  where x' = (x + vx * secs) `mod'` width\n        y' = (y + vy * secs) `mod'` height\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1540304582, "post_id": 52950743, "comment_id": 92810718, "body": "shouldn&#39;t be the type of <code>move :: Float -&gt; Moving s -&gt; Moving s</code>?"}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1540316533, "post_id": 52950743, "comment_id": 92817539, "body": "Thanks for the BTW, but I omitted that to create a minimal working example. I&#39;ll go with @Jkeuhlen &#39;s approach for now. But I&#39;ll definitely look into this way of solving this and previous problems on which you also suggested me using classes."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1540306265, "last_edit_date": 1540306265, "creation_date": 1540302515, "answer_id": 52950743, "question_id": 52949311, "link": "https://stackoverflow.com/questions/52949311/haskell-pattern-matching-on-different-data-types/52950743#52950743", "title": "Haskell Pattern matching on different data types", "body": "<p>I don't disagree with jkeuhlen (or <a href=\"https://stackoverflow.com/a/52896185/745903\">chepner in your first question on this</a>): you may not really need the type distinction at all, can keep it all on the value level.</p>\n\n<p>But you <em>can</em> also do it on the type level, and this does make some sense because moving an object should never change its type. This is now something where you'd use a class. You could just make <code>move</code> a method:</p>\n\n<pre><code>type Time = Float\n\nclass ObjSpecific s where\n  move :: Time -&gt; Moving s -&gt; Moving s\n\ninstance ObjSpecific Bullet where\n  move \u03b4t (Moving p v s t) = -- definition without edge-wrapping\ninstance ObjSpecific Asteroid where\n  move \u03b4t (...) = ... -- definition with edge-wrapping\n</code></pre>\n\n<p>BTW, I think you should probably do something to get rid of the bullets after they've left the screen... perhaps make it <code>move :: Time -&gt; Moving s -&gt; Maybe (Moving s)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1540315608, "post_id": 52950937, "comment_id": 92817076, "body": "Is one of the ways of implementing this better than the other? (Edit: That probably depends largely on the rest of my implementation of the game)"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 1, "creation_date": 1540323575, "post_id": 52950937, "comment_id": 92820862, "body": "Yes, that&#39;s why I added the last paragraph. If you have a list of all moving objects then jkeuhlen&#39;s approach would be better."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 2, "last_activity_date": 1540303106, "creation_date": 1540303106, "answer_id": 52950937, "question_id": 52949311, "link": "https://stackoverflow.com/questions/52949311/haskell-pattern-matching-on-different-data-types/52950937#52950937", "title": "Haskell Pattern matching on different data types", "body": "<p>In addition to <a href=\"https://stackoverflow.com/users/3806046/jkeuhlen\">jkeuhlen</a>'s answer, you could also use a typeclass:</p>\n\n<pre><code>class Moveable a where\n    move :: Float -&gt; a -&gt; a\n    position :: a -&gt; Position\n    velocity :: a -&gt; Velocity\n\ndata Asteroid = Asteroid {\n      asteroidP :: Position,\n      asteroidV :: Velocity\n   }\n\ninstance Moveable Asteroid where\n    move secs (Asteroid (x, y) v@(vx, vy)) = \n       Asteroid ((x + secs*vx) `mod'` width, (y + secs*vy) `mod'` height) v\n    position = asteroidP\n    velocity = asteroidV\n</code></pre>\n\n<p>And similarly for <code>Bullet</code>.</p>\n\n<p>This looks similar to the OO approach of inheritance, which you may be familiar with. However bear in mind that <code>Moveable</code> in this code is a set of types, but is not itself a type. You cannot create a list of Moveable things and put both asteroids and bullets into it. Bullet and Asteroid remain distinct types. If you want to put both of them in a list then you have to use jkeulen's approach (there is nothing wrong with combining both, of course).</p>\n"}], "owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 0, "accepted_answer_id": 52950540, "answer_count": 3, "score": 2, "last_activity_date": 1540306265, "creation_date": 1540298314, "question_id": 52949311, "link": "https://stackoverflow.com/questions/52949311/haskell-pattern-matching-on-different-data-types", "title": "Haskell Pattern matching on different data types", "body": "<p>I am creating an Asteroids clone and want to create a move function. I thought I could use pattern matching on data types, but of course the type signature then does not conform to the actual method. <strong>I want to use different code if the <code>t</code> parameter in the <code>Moving</code> data type in the <code>move</code> function is of data type <code>Bullet</code> and tried this, but that doesn't work.</strong> Any ideas besides making a specialised move function (which might be better here, but I still want to know if there are other ways).</p>\n\n<p>So I have <code>Moving Asteroid</code> and <code>Moving Bullet</code> and want to pattern match on the type of either <code>Asteroid</code> or <code>Bullet</code> (or other types which I didn't post here to give a minimum example)</p>\n\n<p><em>What the <code>move</code> function should do in one sentence: Use wraparound for moving all types of <code>Moving o</code> except <code>Moving Bullet</code>.</em></p>\n\n<p>Some contextual code:</p>\n\n<pre><code>data Moving s = Moving {\n                    position :: Position,\n                    velocity :: Velocity,\n                    size :: Float, \n                    specifics :: s\n}\n\ndata Bullet = Bullet {\n                damage :: Int\n              }\n            | DeadBullet\n\ndata Asteroid = Asteroid  \n              | DeadAsteroid\n\nmove :: Float -&gt; Moving o -&gt; Moving o\nmove secs (Moving (x, y) v@(vx, vy) s t@(Bullet _)) = Moving (x', y') v s t\n  where x' = (x + vx * secs)\n        y' = (y + vy * secs)\n\nmove secs (Moving (x, y) v@(vx, vy) s t) = Moving (x', y') v s t\n  where x' = (x + vx * secs) `mod'` width\n        y' = (y + vy * secs) `mod'` height\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>src\\Controller.hs:100:42: error:\n    * Couldn't match expected type `o' with actual type `Bullet'\n</code></pre>\n"}, {"tags": ["haskell", "cursor", "mouse", "gloss"], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": true, "score": 1, "last_activity_date": 1544104821, "last_edit_date": 1544104821, "creation_date": 1544104509, "answer_id": 53652980, "question_id": 52948251, "link": "https://stackoverflow.com/questions/52948251/how-to-hide-the-mouse-cursor-in-haskell-gloss/53652980#53652980", "title": "How to hide the mouse cursor in Haskell Gloss", "body": "<p>This functionality isn't exposed by gloss: it would be more easily achievable if the <code>Internal</code> modules were exposed (by using eg. <a href=\"https://github.com/benl23x5/gloss/blob/master/gloss/Graphics/Gloss/Internals/Interface/Game.hs\" rel=\"nofollow noreferrer\"><code>playWithBackendIO</code></a> and some custom instances of <a href=\"https://github.com/benl23x5/gloss/blob/master/gloss/Graphics/Gloss/Internals/Interface/Backend/GLUT.hs\" rel=\"nofollow noreferrer\"><code>Backend</code></a> to hide the cursor). If you really want this functionality, it'd be best to <a href=\"https://github.com/benl23x5/gloss\" rel=\"nofollow noreferrer\">fork the project</a> and add the functionality you want.</p>\n\n<hr>\n\n<p>There are workarounds without modifying the original package though: when using any of the <code>...IO</code> functions, we can perform arbitrary <code>IO</code> actions inside the functions we pass in, which allows us to modify the state of the backend.</p>\n\n<p>I'm going to use <code>displayIO</code> here for simplicity, but this works for any of the modes like <code>playIO</code> etc.</p>\n\n<pre><code>import Prelude hiding (init)\nimport Control.Monad\nimport Data.IORef\nimport Data.StateVar\nimport Graphics.Gloss\nimport Graphics.Gloss.Interface.IO.Display\nimport qualified Graphics.UI.GLUT.Window as Glut\n\ninit :: IO ()\ninit = Glut.cursor $= Glut.None\n\nrender :: IORef Bool -&gt; IO Picture\nrender doneInit = do\n    needsInit &lt;- not &lt;$&gt; readIORef doneInit\n    when needsInit $ do\n        init\n        writeIORef doneInit True\n    return $ color white $ circle 30\n\ncontrollerCallback :: Controller -&gt; IO ()\ncontrollerCallback _ = return ()\n\nmain :: IO ()\nmain = do\n    let disp = InWindow \"test\" (800, 600) (0, 0)\n    initVar &lt;- newIORef False\n    displayIO disp black (render initVar) controllerCallback\n</code></pre>\n\n<p>The vital piece is <code>Glut.cursor $= Glut.None</code>, which sets GLUT's <a href=\"https://hackage.haskell.org/package/GLUT-2.7.0.14/docs/Graphics-UI-GLUT-Window.html#v:cursor\" rel=\"nofollow noreferrer\"><code>cursor</code></a> value using StateVar's <code>$=</code> function and automatically updates the glut context. We only want to run this once, so we use an <code>IORef</code> to keep track of whether we've run it before.</p>\n\n<p>Finally, this doesn't work for the GLFW backend. gloss uses a <a href=\"https://hackage.haskell.org/package/GLFW-b-0.0.2.2/docs/Graphics-UI-GLFW.html\" rel=\"nofollow noreferrer\">very old version of GLFW-b which doesn't support anything to do with cursor modes</a>. <a href=\"https://hackage.haskell.org/package/GLFW-b-3.2.1.0/docs/Graphics-UI-GLFW.html\" rel=\"nofollow noreferrer\">More modern versions do</a>, but I've not been able to find a way to get the <code>Window</code> instance as Gloss just discards it.</p>\n"}], "owner": {"reputation": 71, "user_id": 8622570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/582f23659e7dcea18acadd21019d271a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Maassen", "link": "https://stackoverflow.com/users/8622570/jeroen-maassen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 1, "accepted_answer_id": 53652980, "answer_count": 1, "score": 3, "last_activity_date": 1544104821, "creation_date": 1540295121, "question_id": 52948251, "link": "https://stackoverflow.com/questions/52948251/how-to-hide-the-mouse-cursor-in-haskell-gloss", "title": "How to hide the mouse cursor in Haskell Gloss", "body": "<p>Is it possible to hide the cursor using Gloss in Haskell? We want to replace the player with the mouse position.</p>\n"}, {"tags": ["haskell", "monoids"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540294157, "post_id": 52947871, "comment_id": 92803869, "body": "A monoid has always <i>exactly one</i> &quot;neutral element&quot;. So it is likely that you here mean <code>Fst mempty</code>? But then this is still not a monoid, since <code>Fst x &lt;&gt; Fst mempty</code> will return <code>Fst mempty</code>, even if if <code>x &#47;= mempty</code>. So I have the impression that your <code>(&lt;&gt;)</code> is not fit for a monoid."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1540296535, "post_id": 52948198, "comment_id": 92805341, "body": "Actually one <i>could</i> write monoid instances based on the OP&#39;s <code>&lt;&gt;</code> \u2013 but they would have to be isomorphic to <code>instance Monoid (Or () b)</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1540296760, "post_id": 52948198, "comment_id": 92805473, "body": "@leftaroundabout: ah, indeed. Updated."}, {"owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "edited": false, "score": 0, "creation_date": 1540300447, "post_id": 52948198, "comment_id": 92807904, "body": "Awesome explanation. Just for clear, this is why the book ignores the Or type when asking the reader to define Monoid. That was all because of my mistake to mention there is such an exercise. But I learned a lot from this. Thanks!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1540296653, "last_edit_date": 1540296653, "creation_date": 1540295013, "answer_id": 52948198, "question_id": 52947871, "link": "https://stackoverflow.com/questions/52947871/how-to-define-a-mempty-on-this-or-type/52948198#52948198", "title": "How to define a `mempty` on this `Or` type?", "body": "<p><strong>In short</strong>: your definition for <code>(&lt;&gt;)</code> can not be used as the binary operator for a monoid. Unless one can guarantee that there is only one possible value for <code>a</code> (or <code>b</code> if we use <code>Snd</code> as the constructor for a \"neutral element\").</p>\n\n<blockquote>\n  <p>according to the above rules, apparently a <code>Fst x</code> should be the <code>mempty</code> if it was a <code>Monoid</code>.</p>\n</blockquote>\n\n<p>Exactly, <em>if</em> it was a <a href=\"https://en.wikipedia.org/wiki/Monoid\" rel=\"nofollow noreferrer\">monoid [wiki]</a>. But for a monoid it can be proven that there exists *exactly <em>one</em> identity element. The proof is as follows: given there are two neutral elements <em>e<sub>1</sub></em> and <em>e<sub>1</sub></em>, then it means that <em>e<sub>1</sub>&oplus;e<sub>2</sub>=e<sub>1</sub></em>, but at the same time <em>e<sub>1</sub>&oplus;e<sub>2</sub>=e<sub>2</sub></em> (since <em>a&oplus;e=e&oplus;a=a</em> holds with <em>e</em> an identity element), so that means that <em>e<sub>1</sub>=e<sub>2</sub></em> holds, and thus the two are the same.</p>\n\n<p>Now in your definition of <code>(&lt;&gt;)</code> there is no such identity element. Indeed, say that this element is <code>Fst e</code>, then it should hold that:</p>\n\n<pre><code>Fst e &lt;&gt; Fst a = Fst a\n</code></pre>\n\n<p>which holds (the first line of your definition), but it should also hold that:</p>\n\n<pre><code>Fst a &lt;&gt; Fst e = Fst a\n</code></pre>\n\n<p>and this will, according to your <code>(&lt;&gt;)</code> function only hold if <code>a</code> is <code>e</code>. The only way we can thus declare this a monoid is if we can only define <em>one</em> value in the <code>Fst</code> constructor, like <a href=\"https://stackoverflow.com/questions/52947871/how-to-define-a-mempty-on-this-or-type/52948198?noredirect=1#comment92805341_52948198\">@leftroundabout</a> says, for example:</p>\n\n<pre><code>instance Monoid (Or () b) where\n    mempty = Fst ()\n    mappend = (&lt;&gt;)\n</code></pre>\n\n<p>We can thus conclude that your <code>(&lt;&gt;)</code> function is <em>not</em> suited as a binary operator for a monoid. You will need to come up with a different binary operator that is structured in such a way that this can be used in a monoid.</p>\n\n<p>Now it could still be possible that the identity element is of the form <code>Snd e</code>, but then again:</p>\n\n<pre><code>(Snd x) &lt;&gt; (Snd e) = Snd x\n(Snd e) &lt;&gt; (Snd x) = Snd x\n</code></pre>\n\n<p>should both hold, whereas in your implementation:</p>\n\n<pre><code>(Snd x) &lt;&gt; (Snd _)= Snd x\n</code></pre>\n\n<p>the latter will not hold (since <code>x</code> can be different from <code>e</code>).</p>\n"}], "owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 52948198, "answer_count": 1, "score": 0, "last_activity_date": 1540296653, "creation_date": 1540293995, "question_id": 52947871, "link": "https://stackoverflow.com/questions/52947871/how-to-define-a-mempty-on-this-or-type", "title": "How to define a `mempty` on this `Or` type?", "body": "<p>In the book Haskell Programming from first Principles, there is an exercise which asks me to instantiate <code>Monoid</code> on an <code>Or</code> type:</p>\n\n<pre><code>data Or a b =\n  Fst a\n  | Snd b\n  deriving (Eq, Show)\n</code></pre>\n\n<p>previously, we defined the rules when instantiate <code>Semigroup</code>: </p>\n\n<pre><code>instance Semigroup (Or a b) where\n  (Fst _) &lt;&gt; (Fst y) = Fst y\n  (Fst _) &lt;&gt; (Snd y) = Snd y\n  (Snd x) &lt;&gt; (Fst _) = Snd x\n  (Snd x) &lt;&gt; (Snd _)= Snd x\n</code></pre>\n\n<p>according to the above rules, apparently a <code>Fst x</code> should be the <code>mempty</code> if it was a Monoid, where <code>x</code> is anything of type <code>a</code>. But I don't know how to write the rules:</p>\n\n<pre><code>instance (Monoid a, Monoid b) =&gt; Monoid (Or a b) where\n  mempty = ???  -- Please help me with this, to make every (Fst x) be mempty.\n  mappend = (&lt;&gt;)\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 78, "user_id": 2426608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a7de6139461421894537e34e64c74c4?s=128&d=identicon&r=PG", "display_name": "Andrzej Rybczak", "link": "https://stackoverflow.com/users/2426608/andrzej-rybczak"}, "edited": false, "score": 0, "creation_date": 1540386040, "post_id": 52960375, "comment_id": 92845589, "body": "That doesn&#39;t seem right. Even if you do  newtype OpticN p a b s t = OpticN { runOpticN :: p a b -&gt; p s t } and write Profunctor and Choice instances, then f +++ g = OpticN $ runOpticN (left&#39; f) . runOpticN (right&#39; g) has a different type signature."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 78, "user_id": 2426608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a7de6139461421894537e34e64c74c4?s=128&d=identicon&r=PG", "display_name": "Andrzej Rybczak", "link": "https://stackoverflow.com/users/2426608/andrzej-rybczak"}, "edited": false, "score": 1, "creation_date": 1540396694, "post_id": 52960375, "comment_id": 92853054, "body": "I don&#39;t follow you.  I think you can write <code>instance Choice p =&gt; Choice (OpticN p s t)</code>; I haven&#39;t checked it.  Then <code>(+++) :: (Category p, Choice p) =&gt; p -&gt; p -&gt; p</code> works with the definition I gave above.  I have not worked out whether the <code>Category</code> constraint is required for <code>choosing</code>."}, {"owner": {"reputation": 78, "user_id": 2426608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a7de6139461421894537e34e64c74c4?s=128&d=identicon&r=PG", "display_name": "Andrzej Rybczak", "link": "https://stackoverflow.com/users/2426608/andrzej-rybczak"}, "edited": false, "score": 0, "creation_date": 1540402319, "post_id": 52960375, "comment_id": 92856180, "body": "Ok, I see, you meant (.) from Control.Category. Look, p +++ q = left&#39; p . right&#39; q has a signature (+++) :: (Choice p, C.Category p) =&gt; p s t -&gt; p s&#39; t&#39; -&gt; p (Either s s&#39;) (Either t t&#39;), so you need to use my newtype wrapper for types to match (see <a href=\"https://pastebin.com/xxWRmi3w\" rel=\"nofollow noreferrer\">pastebin.com/xxWRmi3w</a>). The other thing is that this is supposed to work for Lenses, which only require Strong, Choice is for Prisms, Folds, Traversals etc. I also thought that Category doesn&#39;t play any role here, so that&#39;s weird."}, {"owner": {"reputation": 78, "user_id": 2426608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a7de6139461421894537e34e64c74c4?s=128&d=identicon&r=PG", "display_name": "Andrzej Rybczak", "link": "https://stackoverflow.com/users/2426608/andrzej-rybczak"}, "edited": false, "score": 0, "creation_date": 1540403149, "post_id": 52960375, "comment_id": 92856648, "body": "But what is more important, at some point p is supposed to become either Star f (for Traversals), (-&gt;) (for Setters), Forget r (for Getters and Folds) or Tagged (for Review). Star f is a category if f is a Monad, but we want f to be only Applicative, (-&gt;) is fine, Forget r and Tagged cannot be category (well, I guess you can write (.), but you for sure can&#39;t write id)."}, {"owner": {"reputation": 78, "user_id": 2426608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a7de6139461421894537e34e64c74c4?s=128&d=identicon&r=PG", "display_name": "Andrzej Rybczak", "link": "https://stackoverflow.com/users/2426608/andrzej-rybczak"}, "edited": false, "score": 0, "creation_date": 1540403362, "post_id": 52960375, "comment_id": 92856749, "body": "So it looks like something weaker is needed, which brings us back to SumProfunctor ;)"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 78, "user_id": 2426608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a7de6139461421894537e34e64c74c4?s=128&d=identicon&r=PG", "display_name": "Andrzej Rybczak", "link": "https://stackoverflow.com/users/2426608/andrzej-rybczak"}, "edited": false, "score": 1, "creation_date": 1540403518, "post_id": 52960375, "comment_id": 92856834, "body": "Thank you.  Now I understand your point about <code>OpticN</code>.  I don&#39;t know the solution, and I won&#39;t have more time to tinker with in for a couple of days."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 78, "user_id": 2426608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a7de6139461421894537e34e64c74c4?s=128&d=identicon&r=PG", "display_name": "Andrzej Rybczak", "link": "https://stackoverflow.com/users/2426608/andrzej-rybczak"}, "edited": false, "score": 0, "creation_date": 1540433935, "post_id": 52960375, "comment_id": 92867100, "body": "How about <code>choosing f g = lens (either (get f) (get g)) (either (flip (set f)) (flip (set g)))</code> ?"}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 1, "last_activity_date": 1540349128, "creation_date": 1540349128, "answer_id": 52960375, "question_id": 52944118, "link": "https://stackoverflow.com/questions/52944118/problem-with-defining-choosing-function-for-a-profunctor-lens/52960375#52960375", "title": "Problem with defining choosing function for a profunctor lens", "body": "<p><code>SumProfunctor</code> is equivalent to <a href=\"https://hackage.haskell.org/package/profunctors-5.3/docs/Data-Profunctor-Choice.html#t:Choice\" rel=\"nofollow noreferrer\">Choice</a>, with <code>p +++ q = left p . right q</code></p>\n\n<p><a href=\"https://hackage.haskell.org/package/profunctors-5.3/docs/Data-Profunctor-Choice.html#t:Cochoice\" rel=\"nofollow noreferrer\">Cochoice</a> is the dual class:</p>\n\n<pre><code>instance Cochoice p =&gt; Choice (Re p s t) where\n    left' (Re f) = Re (f . unleft)\n    right' (Re f) = Re (f . unright)\n\ninstance Choice p =&gt; Cochoice (Re p s t) where\n    unleft (Re f) = Re (f . left')\n    unright (Re f) = Re (f . right')\n</code></pre>\n"}], "owner": {"reputation": 78, "user_id": 2426608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a7de6139461421894537e34e64c74c4?s=128&d=identicon&r=PG", "display_name": "Andrzej Rybczak", "link": "https://stackoverflow.com/users/2426608/andrzej-rybczak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540349128, "creation_date": 1540282100, "last_edit_date": 1540314957, "question_id": 52944118, "link": "https://stackoverflow.com/questions/52944118/problem-with-defining-choosing-function-for-a-profunctor-lens", "title": "Problem with defining choosing function for a profunctor lens", "body": "<p>I'm fiddling with profunctor optics and I've some up against something I can't quite figure out.</p>\n\n<p>The profunctor encoding of Lens and its inversion is as follows:</p>\n\n<pre><code>type Optic p s t a b = p a b -&gt; p s t\n\ntype Lens s t a b = forall p. Strong p =&gt; Optic p s t a b\n\ntype LensyReview t b = forall p. Costrong p =&gt; Optic p t t b b\n</code></pre>\n\n<p>you can freely convert between them back and forth using</p>\n\n<pre><code>newtype Re p s t a b = Re { unRe :: p b a -&gt; p t s }\n\ninstance Profunctor p =&gt; Profunctor (Re p s t) where\n  dimap f g (Re p) = Re (p . dimap g f)\n\ninstance Strong p =&gt; Costrong (Re p s t) where\n  unfirst  (Re p) = Re (p . first')\n  unsecond (Re p) = Re (p . second')\n\ninstance Costrong p =&gt; Strong (Re p s t) where\n  first'  (Re p) = Re (p . unfirst)\n  second' (Re p) = Re (p . unsecond)\n\nre :: Optic (Re p a b) s t a b -&gt; Optic p b a t s\nre optic = unRe (optic (Re id)))\n</code></pre>\n\n<p>Now, I tried to implement choosing function (<a href=\"https://hackage.haskell.org/package/lens-4.17/docs/Control-Lens-Lens.html#v:choosing\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/lens-4.17/docs/Control-Lens-Lens.html#v:choosing</a>) for a profunctor lens.</p>\n\n<p>It turns out that this requires additional type class:</p>\n\n<pre><code>class Profunctor p =&gt; SumProfunctor p where\n  (+++!) :: p a b -&gt; p a' b' -&gt; p (Either a a') (Either b b')\n</code></pre>\n\n<p>then if we include SumProfunctor in Lens, we can write</p>\n\n<pre><code>choosing :: Lens s t a b -&gt; Lens s' t' a b -&gt; Lens (Either s s') (Either t t') a b\nchoosing optic optic' = \\pab -&gt; optic pab +++! optic' pab\n</code></pre>\n\n<p>but then there needs to be another \"dual\" type class that follows the pattern for Re such that</p>\n\n<pre><code>instance Unknown p =&gt; ProfunctorSum (Re p s t)\ninstance ProfunctorSum p =&gt; Unknown (Re p s t)\n</code></pre>\n\n<p>so that Lens is reversible.</p>\n\n<p>The closest I came up with was:</p>\n\n<pre><code>class Profunctor p =&gt; Unknown p where\n  unsum :: p (Either a a') (Either b b') -&gt; (p a b -&gt; r) -&gt; (p a' b' -&gt; r) -&gt; r\n</code></pre>\n\n<p>as there is a sensible instance for Tagged of it and then you can write</p>\n\n<pre><code>instance Unknown p =&gt; SumProfunctor (Re p s t) where\n  Re f +++! Re g = Re (\\s -&gt; unsum s f g)\n</code></pre>\n\n<p>but defining it in the other direction, i.e.</p>\n\n<pre><code>instance SumProfunctor p =&gt; Unknown (Re p s t) where\n  unsum = ???\n</code></pre>\n\n<p>doesn't seem possible.</p>\n\n<p>Am on on the right track or some other method is needed?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 2, "last_activity_date": 1540272637, "creation_date": 1540272637, "answer_id": 52941742, "question_id": 52941085, "link": "https://stackoverflow.com/questions/52941085/assigning-the-splitat-n-list-to-pairx-y-in-haskell/52941742#52941742", "title": "Assigning the splitAt n list to pair(x,y) in haskell", "body": "<p>You can do a pattern match (in this case on the pair returned by <code>splitAt</code>) inside a <code>let</code> in a list comprehension, so you can do</p>\n\n<pre><code>[ doSomethingWith x y | n &lt;- [1..((length list)-1), let (x, y) = splitAt n list ]\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10535138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757510090ea7bfff573bff3d4bc36c7c?s=128&d=identicon&r=PG&f=1", "display_name": "user10535138", "link": "https://stackoverflow.com/users/10535138/user10535138"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 52941742, "answer_count": 1, "score": -1, "last_activity_date": 1540275667, "creation_date": 1540268033, "last_edit_date": 1540275667, "question_id": 52941085, "link": "https://stackoverflow.com/questions/52941085/assigning-the-splitat-n-list-to-pairx-y-in-haskell", "title": "Assigning the splitAt n list to pair(x,y) in haskell", "body": "<p>I have a statement <code>[splitAt n list | n &lt;- [1..((length list)-1)]</code>  which when runs on [1,2,3,4], gives <code>[([1],[2,3,4]),([1,2],[3,4]),([1,2,3],[4])]\n</code>. I want to assign each pair to variables x and y </p>\n\n<p>example: </p>\n\n<pre><code>x=[1]\ny=[2,3,4]\nx=[1,2]\ny=[3,4] \netc\n</code></pre>\n\n<p>How to achieve this? </p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1540266989, "post_id": 52940820, "comment_id": 92790464, "body": "No, a minimal definition needs both <code>randomR</code> and <code>random</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1540267066, "post_id": 52940820, "comment_id": 92790489, "body": "No extension is needed; your type annotation is redundant."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1540269529, "post_id": 52940820, "comment_id": 92790973, "body": "@cmal I have given a sample implementation of <code>randomR</code>. Note that the first argument to <code>randomR</code> is a range. Since your type only contains two values, I&#39;m skipping them entirely. You can modify it if you need a different behavior."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1540269577, "post_id": 52940820, "comment_id": 92790980, "body": "Your implementation returns invalid results if you do e.g. <code>randomR (Frue, Frue)</code>."}, {"owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "edited": false, "score": 0, "creation_date": 1540269582, "post_id": 52940820, "comment_id": 92790982, "body": "Thanks for the answer. If I want to implement randomR and random like the following, what should I change to make it compile? <code>instance Random Fool where randomR (Frue, Frue) g = (Frue,g) randomR (Fulse, x) g = do b &lt;- getStdRandom (randomR (True, False)) return $ (if b then x else Fulse,g) random g = do b &lt;- getStdRandom (randomR (True, False)) return $ if b then Frue else Fulse</code> Currently the error message is Couldn&#39;t match type \u2018IO\u2019 with \u2018(,) Fool\u2019 ... b &lt;- getStdRandom (randomR (True, False))"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1540269724, "post_id": 52940820, "comment_id": 92791019, "body": "@melpomene Yeah, I know. The proper implemntation is : ```    randomR (Frue, Frue) g = (Frue, g)     randomR (Fulse, Fulse) g = (Fulse, g)     randomR _ g = random g ``` . But I think OP will be able to figure out from here."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "edited": false, "score": 0, "creation_date": 1540270137, "post_id": 52940820, "comment_id": 92791137, "body": "@cmal You shouldn&#39;t have a <code>do</code> block there (or call <code>getStdRandom</code>)."}, {"owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1540270474, "post_id": 52940820, "comment_id": 92791241, "body": "Can you show me some code of <code>random g = ???</code>? Thanks a lot. @melpomene"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "edited": false, "score": 0, "creation_date": 1540305259, "post_id": 52940820, "comment_id": 92811174, "body": "@cmal It&#39;s here: <a href=\"https://stackoverflow.com/questions/52940687/no-instance-for-system-random-random-on-a-custom-typeclass-when-using-choose/52940820#comment92791019_52940820\" title=\"no instance for system random random on a custom typeclass when using choose\">stackoverflow.com/questions/52940687/&hellip;</a>"}, {"owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "edited": false, "score": 0, "creation_date": 1540347477, "post_id": 52940820, "comment_id": 92827397, "body": "@Sibi hi, it only defines <code>randomR</code>, but not <code>random g</code>. How to implement the <code>random g</code> ? Thanks!"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "edited": false, "score": 0, "creation_date": 1540355759, "post_id": 52940820, "comment_id": 92829025, "body": "@cmal <code>random g</code> is defined in my answer."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 0, "last_activity_date": 1540269762, "last_edit_date": 1540269762, "creation_date": 1540266092, "answer_id": 52940820, "question_id": 52940687, "link": "https://stackoverflow.com/questions/52940687/no-instance-for-system-random-random-on-a-custom-typeclass-when-using-choose/52940820#52940820", "title": "`No instance for System.Random.Random` on a custom typeclass when using `choose`", "body": "<p>The <code>Test.Quickcheck</code> module's <code>choose</code> function has the following type signature:</p>\n\n<pre><code>choose :: Random a =&gt; (a, a) -&gt; Gen a \n</code></pre>\n\n<p>So, if you are planning to use <code>choose</code> function on your <code>Fool</code> type, it has to be made instance of <code>Random</code> typeclass as seen in the above type signature.</p>\n\n<p>This is where <a href=\"https://www.stackage.org/haddock/lts-12.14/random-1.1/System-Random.html#t:Random\" rel=\"nofollow noreferrer\">Random typeclass</a> is defined. It needs either a minimal implementation of either <code>randomR</code> and <code>random</code>.</p>\n\n<p>Since your type <code>Fool</code> has only two values, it's isomorphic to <code>Bool</code> type. So, you can define a function mapping the values appropriately:</p>\n\n<pre><code>mapBool :: Bool -&gt; Fool\nmapBool False = Fulse\nmapBool True = Frue\n</code></pre>\n\n<p>And then you can define a typeclass instance for your type:</p>\n\n<pre><code>instance Random Fool where\n    random g = let (b :: Bool, g') = random g\n               in (mapBool b, g')\n    randomR _ g = (random g) -- Note that this doesn't work correctly. You need to pattern match and fix this.\n</code></pre>\n\n<p>The above code should make your module compile fine.</p>\n"}], "owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540269762, "creation_date": 1540264927, "question_id": 52940687, "link": "https://stackoverflow.com/questions/52940687/no-instance-for-system-random-random-on-a-custom-typeclass-when-using-choose", "title": "`No instance for System.Random.Random` on a custom typeclass when using `choose`", "body": "<p>I am doing an exercise in Haskell Programming from First Principles. It asks me to generate equal probabilities, and 1/3, 2/3 probabilities from each of:</p>\n\n<pre><code>data Fool =\n  Fulse\n  | Frue\n  deriving (Eq, Show)\n</code></pre>\n\n<p>And my answer is</p>\n\n<pre><code>module Random where\n\n-- import Test.Hspec\nimport Test.QuickCheck\n\ndata Fool =\n  Fulse\n  | Frue\n  deriving (Eq, Show)\n\n\ngenFool :: Gen Fool\ngenFool = choose (Fulse, Frue)\n\ngenFool' :: Gen Fool\ngenFool' = do\n  frequency [(2, return Fulse)\n            ,(1, return Frue)]\n</code></pre>\n\n<p>but <code>genFool</code> is wrong. The error message is :</p>\n\n<pre><code>../chap14/random.hs:13:11: error:\n    \u2022 No instance for (System.Random.Random Fool)\n        arising from a use of \u2018choose\u2019\n    \u2022 In the expression: choose (Fulse, Frue)\n      In an equation for \u2018genFool\u2019: genFool = choose (Fulse, Frue)\n   |\n13 | genFool = choose (Fulse, Frue)\n   |           ^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Previously I have some code like this:</p>\n\n<pre><code>genBool :: Gen Bool\ngenBool = choose (False, True)\n</code></pre>\n\n<p>which works properly. I think there may be some predefined <code>instance</code> of <code>System.Random.Random Fool</code> to make the <code>choose</code> work.</p>\n\n<p>What should I do to make the my version of <code>genFool</code> compile?</p>\n\n<p>And btw, why is the <code>return Fulse</code> in the second <code>genFool'</code> of type <code>Gen Fool</code>?</p>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1540256216, "post_id": 52935569, "comment_id": 92788136, "body": "If you are hoping that the fields will have reduced types (ie. the type family will be &quot;evaluated&quot; in the info returned) you&#39;re completely out of luck. TH doesn&#39;t let you tap into that part of the compiler."}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1540263566, "post_id": 52935569, "comment_id": 92789792, "body": "@Alec do you know <b>any</b> way that this can be achieved? It is not necessary that TH has to do this &quot;type-family evaluation&quot;. I am fine if the type-family expression is evaluated <i>outside</i> of TH, and the resultant type is passed to TH."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1540268977, "post_id": 52935569, "comment_id": 92790872, "body": "The only avenue I can think of that would let you access the sort of machinery you need would be a GHC plugin. Even then, I&#39;m not sure how you&#39;d feed the result back out to TH. :/"}], "answers": [{"comments": [{"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1540258709, "post_id": 52936026, "comment_id": 92788720, "body": "Thanks! I think the <code>[t|MyRecord SomeSelector|]</code> solution might solve my problem. Do you know where the <code>t</code> function / QQ is defined? I want to see it&#39;s type signature and internal workings. I tried it on stackage and GHCi, but nothing worked, eg <code>:t TH.t</code>, <code>:i TH.t</code>, <code>:kind! TH.t</code>"}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1540258923, "post_id": 52936026, "comment_id": 92788761, "body": "Also, does <code>applySubstitution</code> &quot;evaluate&quot; the &quot;type-family expression&quot;, or does it does a mechanical / blind substitution of the type-variable? I&#39;m trying to reconcile solution 1 with Alec&#39;s comment on the question."}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1540259246, "post_id": 52936026, "comment_id": 92788863, "body": "I got <code>[t|MyRecord WithMaybe|]</code> working, but the <code>Type</code> that it is returning is - <code>AppT (ConT Editor.App.MyRecord) (ConT Editor.App.WithMaybe)</code> - which means that the type-family expression is not being evaluated. Will <code>applySubstitution</code> do things differently?"}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1540263503, "post_id": 52936026, "comment_id": 92789778, "body": "Okay, tried <code>applySubstitution</code> as well. Unfortunately, it is not really &quot;applying / expanding / evaluating&quot; the type-family expression. It is simply substituting the free type-variable with <code>WithMaybe &#47; WithoutMaybe</code> and leaving that &quot;unapplied&quot;."}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": false, "score": 1, "last_activity_date": 1540234530, "creation_date": 1540234530, "answer_id": 52936026, "question_id": 52935569, "link": "https://stackoverflow.com/questions/52935569/how-to-apply-a-type-variable-in-template-haskell/52936026#52936026", "title": "How to &quot;apply&quot; a type-variable in Template Haskell?", "body": "<p>This seems like possibly two questions:</p>\n\n<ol>\n<li><p>You want to know how to substitute a free type variable in a type.</p>\n\n<p>The best way to do this I know of is to use <a href=\"http://hackage.haskell.org/package/th-abstraction-0.2.8.0/docs/Language-Haskell-TH-Datatype.html#v:applySubstitution\" rel=\"nofollow noreferrer\"><code>applySubstitution</code></a> from the <code>th-abstraction</code> package, which also helpfully includes normalized representations of datatypes across GHC versions so you don\u2019t tether yourself to a single version of Template Haskell.</p></li>\n<li><p>You want to know how to pass an applied type using TH instead of a single name.</p>\n\n<p>The quoted syntax\u2014i.e. <code>'ValueName</code> or <code>''TypeName</code>\u2014quote <em>names</em>, which correspond simply to references to bindings. <code>MyRecord SomeSelector</code> clearly isn\u2019t a name, it\u2019s a type. Therefore, you should use the type quotation syntax instead of the name quotation syntax, which is written <code>[t|MyRecord SomeSelector|]</code>. This quotation will give you a value of type <a href=\"http://hackage.haskell.org/package/template-haskell-2.13.0.0/docs/Language-Haskell-TH-Syntax.html#t:Type\" rel=\"nofollow noreferrer\"><code>Language.Haskell.TH.Syntax.Type</code></a>, which is a structured datatype that represents the AST of an arbitrary Haskell type.</p></li>\n</ol>\n\n<p>As far as I know, there is no function written down in some library that allows you to go directly from a <code>Type</code> with the shape <code>T X ...</code> to the reified list of constructors associated with <code>T</code>, with its argument variables instantiated with types <code>X ...</code>. This is, of course, a partial function: <code>[t|forall a. a|]</code> quotes a valid <code>Type</code>, but it is not of the shape <code>T X ...</code>, so you\u2019ll have to handle that failure mode yourself (and hopefully report a useful error message). It can be defined in terms of <code>applySubstitution</code> without too much effort, but you will have to do a bit of groveling through the <code>Type</code> you receive to extract the right information.</p>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540259157, "creation_date": 1540232792, "last_edit_date": 1540259157, "question_id": 52935569, "link": "https://stackoverflow.com/questions/52935569/how-to-apply-a-type-variable-in-template-haskell", "title": "How to &quot;apply&quot; a type-variable in Template Haskell?", "body": "<p>I'm passing a record with the following structure to a Template Haskell function:</p>\n\n<pre><code>module Editor.App where\n\ndata WithMaybe\ndata WithoutMaybe\n\ntype family TypeSelector a b where\n  TypeSelector WithMaybe b = Maybe b\n  TypeSelector WithoutMaybe b = b\n\ndata MyRecord a = MyRecord\n  { field1 :: TypeSelector a Int\n  , field2 :: TypeSelector a String\n  }\n\n$(myTHFunction ''MyRecord)\n</code></pre>\n\n<p>Inside <code>myTHFunction</code> I'm calling <code>reify</code> and it is correctly giving me the following type-<code>Info</code>:</p>\n\n<pre><code>TyConI \n  (DataD \n    []\n    Editor.App.MyRecord \n    [KindedTV a_6989586621679348600 StarT] \n    Nothing \n    [RecC Editor.App.MyRecord \n      [ ( Editor.App.field1\n        , Bang NoSourceUnpackedness NoSourceStrictness\n        , AppT  (AppT (ConT Editor.App.TypeSelector) (VarT a_6989586621679348600)) \n                (ConT GHC.Types.Int) )\n      , ( Editor.App.field2\n        , Bang NoSourceUnpackedness NoSourceStrictness\n        , AppT  (AppT (ConT Editor.App.TypeSelector) (VarT a_6989586621679348600)) \n                (ConT GHC.Base.String) )\n      ]\n    ] \n    []\n  )\n</code></pre>\n\n<p>However, in my application logic, I cannot proceed with an unapplied <code>KindedTV a_6989586621679348600 StarT</code>. So, my question is:</p>\n\n<ul>\n<li>how do I \"apply\" this type-variable in TH</li>\n<li>or, how do I apply it <em>before</em> passing it to TH. I tried <code>$(myTHFunction ''(MyRecord SomeSelector))</code> but that doesn't work.</li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1540232880, "post_id": 52935493, "comment_id": 92780224, "body": "So, you want to map a function over the output of <code>splitAt</code>?"}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 2, "creation_date": 1540233023, "post_id": 52935493, "comment_id": 92780288, "body": "Ok. First, do notation is related with monads. It is not design to be an imperative interface for haskell in general. So as an advice, forget it exists until you learn how to think functional. Your problem can be solve using function <code>map</code> and <code>inits</code> from <code>Data.List</code> library. Give it a try and come back if you can&#39;t solve it"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 0, "creation_date": 1540237646, "post_id": 52935493, "comment_id": 92782589, "body": "What have you tried so far?  Have you written a recursive function on lists before?  In Haskell?  If not, what Haskell code have you written that might be a starting point?  (Non-recursive functions on lists?  Functions using <code>case</code>?  Functions on <code>Int</code>?)"}], "answers": [{"tags": [], "owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1540465868, "creation_date": 1540465868, "answer_id": 52987888, "question_id": 52935493, "link": "https://stackoverflow.com/questions/52935493/recursive-functions-in-haskell/52987888#52987888", "title": "Recursive functions in Haskell", "body": "<p>First write a function about what you want to do for a single list. For the simplicity, I am assuming that you want the first element of the list in string format. But this could be any function. </p>\n\n<pre><code>getFirstElement :: [a] -&gt; String\ngetFirstEement [] = \"\"\ngetFirstElement (x:xs) = show x \n</code></pre>\n\n<p>Now you want to run this on list of list and combine them. You can write another function for it. What this will do is get the first element of all the lists and combine them </p>\n\n<pre><code>combineList :: [[a]] -&gt; String\ncombineList [] = \"\"\ncombineList (x:xs) = getFirstElement x ++ &lt;any separator if needed&gt; ++ combineList xs\n</code></pre>\n\n<p>The above is using very basic of recursion and pattern matching. The last line of combinelist can be also written using fold function. </p>\n\n<p>On further note, there is something called as \"Applicative Functors\" which exists with purpose \"sequence computations and combine their results\".</p>\n"}], "owner": {"reputation": 25, "user_id": 10535138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757510090ea7bfff573bff3d4bc36c7c?s=128&d=identicon&r=PG&f=1", "display_name": "user10535138", "link": "https://stackoverflow.com/users/10535138/user10535138"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540465868, "creation_date": 1540232476, "question_id": 52935493, "link": "https://stackoverflow.com/questions/52935493/recursive-functions-in-haskell", "title": "Recursive functions in Haskell", "body": "<p>I have a function which splits the list in n-1 ways. After splitting I want to perform operations on each item of a split in a recursive way. I am not able to figure out how to go about this recursion as I am new to Haskel and was not able to understand how values can be used in Haskell</p>\n\n<pre><code>recur(list)= do [splitAt n list | n &lt;- [1..((length list)-1)]]\n                print say each first element of split( say [1,2] it should print [1] )\n                recur(second element of list)\n</code></pre>\n\n<p>I wanted to know how to use the output of split and acrry on with next steps since Haskell we cant use variable declaration and use that variable.</p>\n"}, {"tags": ["haskell", "cmd", "ghci", "quickcheck"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1540224626, "post_id": 52933324, "comment_id": 92776292, "body": "You need to define an <code>instance Arbitrary Direction</code>. See the docs for the quickcheck library"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 8, "last_activity_date": 1540225136, "creation_date": 1540225136, "answer_id": 52933685, "question_id": 52933324, "link": "https://stackoverflow.com/questions/52933324/why-does-no-instance-for-arbitrary-arising-from-a-use-of-quickcheck-error/52933685#52933685", "title": "Why does &quot;No instance for (Arbitrary) arising from a use of `quickCheck&#39;&quot; error appears?", "body": "<p>You defined:</p>\n\n<pre><code>Direction = North | South | East | West\n        deriving (Eq, Show)\n</code></pre>\n\n<p>There is no <code>instance Arbitrary Direction</code> in the above. After all, how could there be? You just now defined direction and the only instances in the whole world are <code>Eq</code> and <code>Show</code>.</p>\n\n<p>Try:</p>\n\n<pre><code>import Test.QuickCheck\ndata Direction = North | South | East | West\n   deriving (Eq,Show)\n\ninstance Arbitrary Direction where\n    arbitrary = elements [North,South,East,West]\n</code></pre>\n\n<p>The <code>elements</code> function comes from <code>Test.QuickCheck</code> just like <code>Arbitrary</code>.</p>\n\n<p>As a meta-note: If your instructor did not immediately see the issue here then there was either a miscommunication or you should plan on supplementing your Haskell education such as using online resources like wikibooks, printed material such as The Craft of Functional Programming, or lots of conversations at places like freenode.</p>\n"}], "owner": {"reputation": 43, "user_id": 10243350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26b669afce864c12f6a1e824706ed2e3?s=128&d=identicon&r=PG&f=1", "display_name": "madalici98", "link": "https://stackoverflow.com/users/10243350/madalici98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "accepted_answer_id": 52933685, "answer_count": 1, "score": 3, "last_activity_date": 1540225136, "creation_date": 1540223726, "question_id": 52933324, "link": "https://stackoverflow.com/questions/52933324/why-does-no-instance-for-arbitrary-arising-from-a-use-of-quickcheck-error", "title": "Why does &quot;No instance for (Arbitrary) arising from a use of `quickCheck&#39;&quot; error appears?", "body": "<p>I'm new to Haskell and I'm having some trouble with this error. I'm using ghci on Windows. This is the code:</p>\n\n<pre><code>data Direction = North | South | East | West\n            deriving (Eq, Show)\ntype Point = (Int, Int)\norigin = (0,0)\ntype Road = [Direction]\nmovement :: Point -&gt; Road -&gt; Point\n{- ... }\ntest :: Road -&gt; Road -&gt; Bool\ntest road1 road2 = movement origin road1 == movement origin road2\n-- i check if two roads lead to the same destination starting from \n-- the origin point in a grid\n</code></pre>\n\n<p>This is what happens when I try to run the test:</p>\n\n<pre><code>*Main&gt; quickCheck test\n&lt;interactive&gt;:8:1: error:\n* No instance for (Arbitrary Direction)\n    arising from a use of `quickCheck'\n* In the expression: quickCheck test\n  In an equation for `it': it = quickCheck test\n</code></pre>\n\n<p>My teacher told me my code is correct, but had no explanation why this happens on Windows, thus provided no solution. Neither I found anything helpful on the web. I'd really appreciate an explanation. </p>\n"}, {"tags": ["haskell", "functional-programming", "stack-overflow"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1540222076, "post_id": 52932828, "comment_id": 92774886, "body": "You call <code>(customPower x y) -1</code> in the recursive case."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1540229043, "post_id": 52932828, "comment_id": 92778478, "body": "Another color for the bikeshed: <code>customPower x y = iterate ((1+).(x*)) 1 !! y</code>. If you want to get really cool, I bet this can be done as a variant of repeated squaring."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1540229928, "post_id": 52932828, "comment_id": 92778909, "body": "(Yep: you can compute <code>customPower x y</code> by summing up the bottom row of the matrix <code>[[1,0],[1,x]]^y</code>, and you can compute the latter with the usual repeated squaring algorithm.)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1540311803, "post_id": 52932828, "comment_id": 92815195, "body": "<a href=\"https://en.wikipedia.org/wiki/Horner%27s_method\" rel=\"nofollow noreferrer\">Horner&#39;s rule</a>: <code>foldr (\\a r -&gt; a + x*r) 0 [1 | i &lt;- [0..y]]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1540226698, "post_id": 52932892, "comment_id": 92777344, "body": "It might make sense to mention that the OP&#39;s code (and your direct fix for it) is not tail recursive, so it will stack up delayed additions instead of performing them as it goes. <code>customPower = go 1 where go acc x y | y &gt; 0 = go (x^y + acc) x (y - 1) | otherwise = acc</code> will fix the problem in optimized code. In unoptimized code, you&#39;ll need <code>go !acc x y = ...</code> or <code>| y &gt; 0 = acc `seq` ...</code>. The versions you give using <code>sum</code> will also build up thunks when not sufficiently optimized (and especially specialized)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1540279644, "last_edit_date": 1540279644, "creation_date": 1540222247, "answer_id": 52932892, "question_id": 52932828, "link": "https://stackoverflow.com/questions/52932828/how-do-i-avoid-stackoverflow-error-in-haskell/52932892#52932892", "title": "How do I avoid stackoverflow error in Haskell", "body": "<p>The operators have lower precedence than function calls, this means that your recursive call:</p>\n\n<pre><code>... + (customPower x y-1)\n</code></pre>\n\n<p>is interpreted as:</p>\n\n<pre><code>... + ((customPower x y)-1)\n</code></pre>\n\n<p>so you keep calling with the <em>same</em> parameters, therefore the recursion can never end.</p>\n\n<p>We can fix this by adding brackets for <code>y-1</code>:</p>\n\n<pre><code>customPower :: Int -&gt; Int -&gt; Int\ncustomPower x y\n    | y &gt; 0 = x^y + customPower x <b>(y-1)</b>\n    | otherwise = 1</code></pre>\n\n<p>With this modifications, we do not get stuck in an infinite loop:</p>\n\n<pre><code>Prelude&gt; customPower 5 3\n156 \n</code></pre>\n\n<p>We can rewrite the above by making use of <a href=\"https://www.haskell.org/hoogle/?hoogle=sum\" rel=\"nofollow noreferrer\"><strong><code>sum :: Num a =&gt; [a] -&gt; a</code></strong></a> and <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:map\" rel=\"nofollow noreferrer\"><strong><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code></strong></a> to implement this with a one-liner:</p>\n\n<pre><code>customPower :: (Num a, Integral b) =&gt; a -&gt; b -&gt; a\ncustomPower x y = sum (map (x^) [0..y])\n</code></pre>\n\n<p>or we can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:iterate\" rel=\"nofollow noreferrer\"><strong><code>iterate :: (a -&gt; a) -&gt; a -&gt; [a]</code></strong></a>:</p>\n\n<pre><code>customPower :: (Num a, Integral b) =&gt; a -&gt; b -&gt; a\ncustomPower x y = sum (take (y+1) (iterate (x*) 1))\n</code></pre>\n\n<p>Due to Haskell's laziness, the above attempts will likely still result in a call stack that scales linear with the value of <code>y</code>: the functions are, like @dfeuer says, not tail recursive functions, we can however work with an accumulator here:</p>\n\n<pre><code>customPower :: Int -&gt; Int -&gt; Int\ncustomPower x = go 1\n    where go a y | y &gt; 1 = a\n                 | otherwise = seq a (go (a+x^y) (y-1))\n</code></pre>\n\n<p>since the above sum is equal to a simple formula, we can even calculate the value in <em>O(y log x)</em>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>   y\n.\u2014\u2014\u2014\u2014            y+1\n \u2572     i       x    - 1\n \u2571    x    =   \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n*\u2014\u2014\u2014\u2014            x - 1\n  i=0\n</code></pre>\n\n<p>So we can calculate the value with:</p>\n\n<pre><code>customPower :: (Integral a, Integral b) =&gt; a -&gt; b -&gt; a\ncustomPower x y = div (x^(y+1) - 1) (x - 1)\n</code></pre>\n\n<p>This will usually work faster, although in a rare case where the result times <code>x -1</code> is larger than the maximum representable number of the type <code>a</code>, this will result in overflow and will return the wrong number.</p>\n"}], "owner": {"reputation": 105, "user_id": 6096729, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/029b459c6b382344dfff47179b6d9a91?s=128&d=identicon&r=PG&f=1", "display_name": "vucko95", "link": "https://stackoverflow.com/users/6096729/vucko95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 52932892, "answer_count": 1, "score": 2, "last_activity_date": 1540279644, "creation_date": 1540221988, "question_id": 52932828, "link": "https://stackoverflow.com/questions/52932828/how-do-i-avoid-stackoverflow-error-in-haskell", "title": "How do I avoid stackoverflow error in Haskell", "body": "<p>I want to make this Function: </p>\n\n<p>calling <strong>customPower 2 2</strong> \nwould give back 2^2 + 2^1 + 1</p>\n\n<p>calling <strong>customPower 3 3</strong> \nwould give back 3^3 + 3^2 + 3^1 + 1 </p>\n\n<p>Here is my code:</p>\n\n<pre><code>customPower :: Int -&gt; Int -&gt; Int\ncustomPower x y\n          | y == 0 = 1\n          | y &gt; 0 = (x^(y)) + (customPower x y-1)\n</code></pre>\n\n<p>It gives me stack overflow exception and I can't find where is the error. Everything seems fine. </p>\n"}, {"tags": ["haskell", "recursion", "io", "do-notation"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1540219702, "post_id": 52931892, "comment_id": 92773440, "body": "Just use <code>return ()</code>; that&#39;s the simplest way to create an <code>IO ()</code> value."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1540219875, "post_id": 52931892, "comment_id": 92773557, "body": "Otherwise, it&#39;s not clear what you want. Do you want a list of 10 random numbers?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1540219954, "post_id": 52931892, "comment_id": 92773599, "body": "As is, <code>fNoInspectPerHour</code> doesn&#39;t really do anything except modify the state of the random number generator; it doesn&#39;t do anything with the random number it generates."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1540221306, "post_id": 52932360, "comment_id": 92774428, "body": "...and this combination of <code>sequence</code> and <code>replicate</code> is so common that it&#39;s got a standard name, <code>replicateM</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1540221748, "post_id": 52932360, "comment_id": 92774695, "body": "Oh, I thought that existed, but it didn&#39;t seem to be in scope. I had to import <code>Control.Monad</code> first."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1540222670, "post_id": 52932360, "comment_id": 92775224, "body": "Thanks @Chepner and Daniel Wagner. That certainly helped me out.. Still got a lot to learn. Haskell&#39;s trying to keep it interesting."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1540223206, "post_id": 52932360, "comment_id": 92775551, "body": "By the way @Chepner: your example works from the prompt, but how to incorporate in the do-block....?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1540223693, "post_id": 52932360, "comment_id": 92775801, "body": "Why do you need a <code>do</code> block? It&#39;s still not clear what the purpose of <code>fNoInspectPerHour</code> is, since it doesn&#39;t do anything with the generated number."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1540224079, "post_id": 52932360, "comment_id": 92776005, "body": "I mean, you can write <code>replicateM 3 fNoInspectPerHour</code> to get a value of <code>IO [(), (),  ()]</code>, but unless you actually yield each random number, what&#39;s the point?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1540228810, "post_id": 52932360, "comment_id": 92778392, "body": "@Madderote you can write <code>fNoInspectPerHour = do {    generateInspectList &lt;- sequence (replicate 10 (randomRIO (fMinInspect,fMaxInspect))) ;   print generateInspectList }</code> if that&#39;s what you meant to do."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1540277098, "post_id": 52932360, "comment_id": 92793670, "body": "@Chepner, first need to get them before I can use them, but your insights and those of Will Ness already helped solving it. I am apparently struggling also with the number of ways to address problems in Haskell. Thanks!!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1540277290, "post_id": 52932360, "comment_id": 92793771, "body": "@Madderote great to hear that it helps. Keep at it, keep asking on SO (and elsewhere), and keep keeping engaged on your questions! :)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1540228430, "last_edit_date": 1540228430, "creation_date": 1540220425, "answer_id": 52932360, "question_id": 52931892, "link": "https://stackoverflow.com/questions/52931892/haskell-recursion-in-io-action/52932360#52932360", "title": "Haskell recursion in IO action", "body": "<p><code>randomIO (fMinInspect, fMaxInspect)</code> is an IO action, a value of type <code>(Num a, Random a) =&gt; IO a</code>. (For simplicity, we'll assume that <code>a</code> is <code>Int</code> from now on.)\nNote that each execution of the action can generate a <em>different</em> random value; that's the difference between <code>IO Int</code> being an <em>action</em> that generates a random value and being a random value itself.</p>\n\n<p>Once we have that action, we can create a list of actions with <code>replicate 10 (randomRIO (fMinInspect, fMaxInspect))</code>; this will have type <code>[IO Int]</code>, 10 copies of an IO action.</p>\n\n<p>The <code>sequence</code> function can change your list of IO actions into an IO action that yields a list of values (each value being produced by the corresponding action), converting a value of type <code>[IO Int]</code> into a value of type <code>IO [Int]</code>.</p>\n\n<pre><code>&gt; fMinInspect = 1\n&gt; fMaxInspect = 12\n&gt; sequence (replicate 10 (randomRIO (fMinInspect, fMaxInspect)))\n[1,6,6,1,7,5,8,4,7,7]\n</code></pre>\n\n<p>(Here, as usual, GCHi is executing the IO action, which was produced by <code>sequence</code>, and returns the result produced by that IO action.)</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 1, "last_activity_date": 1540229190, "creation_date": 1540229190, "answer_id": 52934677, "question_id": 52931892, "link": "https://stackoverflow.com/questions/52931892/haskell-recursion-in-io-action/52934677#52934677", "title": "Haskell recursion in IO action", "body": "<p>If you actually meant to use recursion yourself here, you could write e.g. </p>\n\n<pre><code>fNoInspectPerHour :: Int -&gt; IO () \nfNoInspectPerHour 0 = return () \nfNoInspectPerHour n = do { \n    generateInspect &lt;- randomRIO (fMinInspect,fMaxInspect) ; \n    --  Int            IO Int\n    putStrLn generateInspect ;    -- or do some other IO action\n    --                 IO ()\n    fNoInspectPerHour (n-1) \n    --                 IO ()\n    }\n</code></pre>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 52934677, "answer_count": 2, "score": 0, "last_activity_date": 1540278261, "creation_date": 1540219004, "last_edit_date": 1540278261, "question_id": 52931892, "link": "https://stackoverflow.com/questions/52931892/haskell-recursion-in-io-action", "title": "Haskell recursion in IO action", "body": "<p>Still a beginner that can't figure out a recursive loop in an <code>IO</code> action. Assume:</p>\n\n<pre><code>fMinInspect :: Int\nfMinInspect = 1\nfMaxInspect :: Int\nfMaxInspect = 12\n-- fNoInspectPerHour :: IO ()\nfNoInspectPerHour = do\n  generateInspect &lt;- randomRIO (fMinInspect,fMaxInspect)\n  putStrLn \"\"\n</code></pre>\n\n<p>I would like to generate a list for let's say 10 machines I want randomly checked, can I then make a repeated call to something that would add 10x <code>fNoInspectPerHour</code> to a list? </p>\n\n<p>I tried an external function, but I can't get the actions from the <code>IO ()</code>. Note that <code>putStrLn</code> is just to terminate the <code>do</code>-block, since I don't need console output. </p>\n\n<p>PS. suggestions on terminating a <code>do</code>-block without the <code>putStrLn</code> is welcome too.</p>\n"}, {"tags": ["haskell", "strictness", "criterion"], "comments": [{"owner": {"reputation": 409, "user_id": 235169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207855ffbca40767813706aa338f7d69?s=128&d=identicon&r=PG", "display_name": "Andreas Klebinger", "link": "https://stackoverflow.com/users/235169/andreas-klebinger"}, "edited": false, "score": 1, "creation_date": 1540210853, "post_id": 52929071, "comment_id": 92767531, "body": "It&#39;s always helpful to include a way for other to reproduce your error."}, {"owner": {"reputation": 318, "user_id": 2295871, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/dfdf75ad2a4730f1114c7b463def0596?s=128&d=identicon&r=PG", "display_name": "nbdip", "link": "https://stackoverflow.com/users/2295871/nbdip"}, "reply_to_user": {"reputation": 409, "user_id": 235169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207855ffbca40767813706aa338f7d69?s=128&d=identicon&r=PG", "display_name": "Andreas Klebinger", "link": "https://stackoverflow.com/users/235169/andreas-klebinger"}, "edited": false, "score": 0, "creation_date": 1540211444, "post_id": 52929071, "comment_id": 92767900, "body": "This is just a small part of a big bachelor&#39;s thesis project, which I am not allowed to share publicly. However, I am adding the benchmark call of Criterion, that causes this error. I dont know if that makes any difference though"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1540211553, "post_id": 52929071, "comment_id": 92767980, "body": "Have you tried doing what GHC suggests in its &quot;probable fix&quot;...?"}, {"owner": {"reputation": 318, "user_id": 2295871, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/dfdf75ad2a4730f1114c7b463def0596?s=128&d=identicon&r=PG", "display_name": "nbdip", "link": "https://stackoverflow.com/users/2295871/nbdip"}, "edited": false, "score": 0, "creation_date": 1540212331, "post_id": 52929071, "comment_id": 92768477, "body": "I am not sure, how I can do its suggestion without changing the data type definitions"}], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 2295871, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/dfdf75ad2a4730f1114c7b463def0596?s=128&d=identicon&r=PG", "display_name": "nbdip", "link": "https://stackoverflow.com/users/2295871/nbdip"}, "edited": false, "score": 0, "creation_date": 1540215348, "post_id": 52930436, "comment_id": 92770571, "body": "Thank you very much for your answer. I thought the problem was occuring due to compiler not being able to resolve the recursive data type, since the other variant was working fine without explicitly adding the type signature. Therefore, I haven&#39;t consider adding the signature explicitly."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 3, "last_activity_date": 1540214429, "creation_date": 1540214429, "answer_id": 52930436, "question_id": 52929071, "link": "https://stackoverflow.com/questions/52929071/how-to-fully-evaluate-a-recursive-data-type-using-control-deepseq-in-haskell/52930436#52930436", "title": "How to fully evaluate a recursive data type using Control.DeepSeq in Haskell?", "body": "<p>You can add a type signature to <code>testFunction</code> where you pass it to <code>nf</code>.  Something like:</p>\n\n<p><code>nf (testFunction :: [[Int]] -&gt; ExampleDataType3 Double Int) [[1,0,1,1],[0,0,0,1],[1,1,1,0],[0,1,0,1]]</code></p>\n\n<p>I picked the type Double; you may pick some other type.  Since there are several options, GHC gives the <code>Ambiguous type variable</code> error rather than arbitrarily picking one.</p>\n"}], "owner": {"reputation": 318, "user_id": 2295871, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/dfdf75ad2a4730f1114c7b463def0596?s=128&d=identicon&r=PG", "display_name": "nbdip", "link": "https://stackoverflow.com/users/2295871/nbdip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 52930436, "answer_count": 1, "score": 3, "last_activity_date": 1540214429, "creation_date": 1540210353, "last_edit_date": 1540214426, "question_id": 52929071, "link": "https://stackoverflow.com/questions/52929071/how-to-fully-evaluate-a-recursive-data-type-using-control-deepseq-in-haskell", "title": "How to fully evaluate a recursive data type using Control.DeepSeq in Haskell?", "body": "<p>I am trying to benchmark (with <a href=\"http://www.serpentine.com/criterion/tutorial.html\" rel=\"nofollow noreferrer\">Criterion</a>) a function, which uses a recursive data type. I found a <a href=\"https://stackoverflow.com/questions/31477176/how-can-i-define-nfdata-instance-for-recursive-singleton-type\">similar question</a> with an answer that I haven't been able to apply for my case. For non-recursive data types, the following works:</p>\n\n<pre><code>data ExampleDataType1 a = \n    ValueConst1 String String String String \n  | ValueConst2 String String\n  | ValueConst3 a\n  | ValueConst4 String        \nderiving (Show, Eq, Ord)\n\n\ninstance DeepSeq.NFData a =&gt; DeepSeq.NFData (ExampleDataType1 a) where\n    rnf (ValueConst1 c1 c2 c3 c4) = DeepSeq.rnf c1 `seq` DeepSeq.rnf c2 `seq` DeepSeq.rnf c3 `seq` DeepSeq.rnf c4\n    rnf (ValueConst2 c1 c2)       = DeepSeq.rnf c1 `seq` DeepSeq.rnf c2\n    rnf (ValueConst3 c1)          = DeepSeq.rnf c1\n    rnf (ValueConst4 c2)          = DeepSeq.rnf c2 \n</code></pre>\n\n<p>However, doing the following:</p>\n\n<pre><code>infixl 6 :+: -- Addition\ninfixl 7 :*: -- Multiplication\ndata ExampleDataType2 a =\n\n    ValueConst5 (ExampleDataType2 a) \n    | a :*: String    \n    | (ExampleDataType2 a) :+: (ExampleDataType2 a)      \n    | ValueConst6 String a     \n    | ValueConst7 String a     \n    deriving (Show, Eq, Ord)\n\ntype MapExample a b = Map.Map String (Either (ExampleDataType1 a) (ExampleDataType2 b))\n\ndata ExampleDataType3 a b = ExampleDataType3 {\n    start :: String,\n    mapList :: [MapExample a b]\n\n    } deriving Show\n\n\ninstance DeepSeq.NFData a =&gt; DeepSeq.NFData (ExampleDataType1 a) where\n    rnf (ValueConst1 c1 c2 c3 c4) = DeepSeq.rnf c1 `seq` DeepSeq.rnf c2 `seq` DeepSeq.rnf c3 `seq` DeepSeq.rnf c4\n    rnf (ValueConst2 c1 c2)       = DeepSeq.rnf c1 `seq` DeepSeq.rnf c2\n    rnf (ValueConst3 c1)          = DeepSeq.rnf c1\n    rnf (ValueConst4 c2)          = DeepSeq.rnf c2 \n\ninstance DeepSeq.NFData b =&gt; DeepSeq.NFData (ExampleDataType2 b) where\n    rnf (ValueConst5 c1)           = DeepSeq.rnf c1\n    rnf (val1 :+: val2)            = DeepSeq.rnf val1 `seq` DeepSeq.rnf val2\n    rnf (val :*: str)              = DeepSeq.rnf val `seq` DeepSeq.rnf str\n    rnf (ValueConst6 str val)      = DeepSeq.rnf str `seq` DeepSeq.rnf val\n    rnf (ValueConst7 str val)      = DeepSeq.rnf str `seq` DeepSeq.rnf val\n\ninstance (DeepSeq.NFData a, DeepSeq.NFData b) =&gt; DeepSeq.NFData (ExampleDataType3 a b) where\n    rnf (ExampleDataType3 s lst) =  DeepSeq.rnf s `seq` DeepSeq.rnf lst\n</code></pre>\n\n<p>results in an error, when calling the <code>nf</code> function of <code>Criterion.Main</code> on the function I wish to benchmark, which has the signature <code>testFunction :: (Show a1, Integral a1, Num a2, Eq a2) =&gt; [[a1]] -&gt; ExampleDataType3 a2 a1</code>: </p>\n\n<pre><code>\u2022 Ambiguous type variable \u2018a20\u2019 arising from a use of \u2018nf\u2019\n      prevents the constraint \u2018(Control.DeepSeq.NFData\n                                  a20)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a20\u2019 should be.\n      These potential instances exist:\n        instance [safe] (Control.DeepSeq.NFData a,\n                         Control.DeepSeq.NFData b) =&gt;\n                        Control.DeepSeq.NFData (Either a b)\n          -- Defined in \u2018Control.DeepSeq\u2019\n        instance (Control.DeepSeq.NFData k, Control.DeepSeq.NFData a) =&gt;\n\n                 Control.DeepSeq.NFData (Map.Map k a)\n          -- Defined in \u2018Data.Map.Internal\u2019\n        instance Control.DeepSeq.NFData a =&gt;\n                 Control.DeepSeq.NFData (Set.Set a)\n          -- Defined in \u2018Data.Set.Internal\u2019\n        ...plus 20 others\n        ...plus 150 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n</code></pre>\n\n<p>I would appreciate every answer on how one should fully evaluate a recursive data type.</p>\n\n<p>Edit 1:</p>\n\n<p>The benchmark call that causes the error:</p>\n\n<pre><code>main = defaultMain [\n            bgroup \"TestCases\" [ bench \"Case 1\" $ nf testFunction [[1,0,1,1],[0,0,0,1],[1,1,1,0],[0,1,0,1]]\n                         ]]\n</code></pre>\n\n<p>The function <code>testFunction</code> does its job as desired except I fail to fully evaluate the recursive data type so that <code>nf</code> function of Criterion can accept my function as an input. Therefore, I would like to avoid changing the data type.</p>\n"}, {"tags": ["haskell", "semigroup"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1540208748, "post_id": 52927898, "comment_id": 92766315, "body": "What do you mean that &#39;it does not work&#39;? Please edit your question to describe the actual problem(s) you&#39;re seeing."}, {"owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1540221378, "post_id": 52927898, "comment_id": 92774475, "body": "sorry for confusing you. I am also confused by the intent of these questions. So when I say it works, I really mean that these code compiles. And when I say it does not work, they cannot compile. But I also want to know the intent of these exercise, so I used it does not work. But it is somewhat confusing, too.  Sorry for that."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1540230230, "post_id": 52927898, "comment_id": 92779048, "body": "These types are not higher-kinded. They are parameterized, but their parameters are types; to be higher-kinded, their parameters would need to themselves be parameterized types. I&#39;ve fixed your question up for you."}], "answers": [{"comments": [{"owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "edited": false, "score": 0, "creation_date": 1540260468, "post_id": 52929228, "comment_id": 92789148, "body": "Hi, @chi. Should the instance of <code>Semigroup</code> use <code>a1</code>, <code>a2</code>? If so, why is it different from the instance of type <code>IdentityAssoc</code>? like in this:  <code>instance (Semigroup a) =&gt; Semigroup (Identity a) where   (Identity a1) &lt;&gt; (Identity a2) = Identity (a1 &lt;&gt; a2)</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "edited": false, "score": 0, "creation_date": 1540287344, "post_id": 52929228, "comment_id": 92799537, "body": "@cmal No in should be <code>instance Semigroup a =&gt; Semigroup (Identity a)</code>. There is no instance for <code>IdentityAssoc</code>, that is a function type for which we do not need a semigroup."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1540210828, "creation_date": 1540210828, "answer_id": 52929228, "question_id": 52927898, "link": "https://stackoverflow.com/questions/52927898/how-to-write-semigroup-instance-and-their-quickchecks-on-parameterized-types/52929228#52929228", "title": "How to write `Semigroup` instance and their `quickCheck`s on parameterized types?", "body": "<p>This is wrong:</p>\n\n<pre><code>instance Arbitrary (Identity a) where\n  arbitrary = return (Identity a)\n</code></pre>\n\n<p><code>a</code> is not a value variable, it is a type variable. We need a value of type <code>a</code> to pass to the <code>Identity</code> constructor, not the <code>a</code> type itself.</p>\n\n<p>So we need something like</p>\n\n<pre><code>instance Arbitrary a =&gt; Arbitrary (Identity a) where\n  arbitrary = do\n     x &lt;- arbitrary         -- generate a value of type a\n     return (Identity x)    -- turn it into a value of type (Identity a)\n</code></pre>\n\n<p>(or, more concisely, <code>arbitrary = Identity &lt;$&gt; arbitrary</code>)</p>\n\n<p>Note how we have to require that <code>a</code> is a type for which we can generate random samples (adding <code>Arbitrary a =&gt;</code> after <code>Instance</code>). Otherwise, we can't use <code>x &lt;- arbitrary</code> to generate a sample for <code>a</code>.</p>\n\n<p>Further:</p>\n\n<pre><code>type IdentityAssoc =\n  (Identity a0) -&gt; (Identity a1) -&gt; (Identity a2) -&gt; Bool\n</code></pre>\n\n<p>Here we can't refer to <code>a1,a1,a2</code>, since we haven't defined those types anywhere. We need to choose concrete types, like <code>Int</code>. Further, these three types must be the same type, since <code>(&lt;&gt;)</code> takes two values of the same type, and returns a value in that type.</p>\n"}], "owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 52929228, "answer_count": 1, "score": 0, "last_activity_date": 1540435924, "creation_date": 1540206514, "last_edit_date": 1540435924, "question_id": 52927898, "link": "https://stackoverflow.com/questions/52927898/how-to-write-semigroup-instance-and-their-quickchecks-on-parameterized-types", "title": "How to write `Semigroup` instance and their `quickCheck`s on parameterized types?", "body": "<p>In the exercises of Haskell Programming from First Principle book on Semigroup, I am asked to write <code>quickCheck</code> for user defined typeclasses. There are many typeclasses, but I do not understand how to write even the basic ones:</p>\n\n<h2>Problems:</h2>\n\n<p>The first is for <code>Trivial</code>:</p>\n\n<pre><code>module Exercise where\n\nimport Test.QuickCheck\n\ndata Trivial =\n  Trivial\n  deriving (Eq, Show)\n\ninstance Semigroup Trivial where\n  _ &lt;&gt; _ = undefined\n\ninstance Arbitrary Trivial where\n  arbitrary = return Trivial\n\nsemigroupAssoc :: (Eq m, Semigroup m) =&gt; m -&gt; m -&gt; m -&gt; Bool\nsemigroupAssoc a b c = (a &lt;&gt; (b &lt;&gt; c)) == ((a &lt;&gt; b) &lt;&gt; c)\n\ntype TrivialAssoc = Trivial -&gt; Trivial -&gt; Trivial -&gt; Bool\n</code></pre>\n\n<p>The second is for </p>\n\n<pre><code>newtype Identity a = Identity a\n</code></pre>\n\n<p>and the third is for:</p>\n\n<pre><code>data Two a b =\n  Two a b\n</code></pre>\n\n<h2>My answers:</h2>\n\n<p>For the first, I changed the <code>instance</code> expression to </p>\n\n<pre><code>instance Semigroup Trivial where\n  _ &lt;&gt; _ = Trivial\n</code></pre>\n\n<p>and it works.</p>\n\n<p>I tried the following code but not work for the second:</p>\n\n<pre><code>newtype Identity a = Identity a\n\ninstance (Semigroup a) =&gt; Semigroup (Identity a) where\n  (Identity a1) &lt;&gt; (Identity a2) = Identity (a1 &lt;&gt; a2)\n\ninstance Arbitrary (Identity a) where\n  arbitrary = return (Identity a)\n\ntype IdentityAssoc =\n  (Identity a0) -&gt; (Identity a1) -&gt; (Identity a2) -&gt; Bool\n\nmain :: IO ()\nmain =\n  quickCheck (semigroupAssoc :: IdentityAssoc)\n</code></pre>\n\n<p>I find I do not understand what the <code>quickTest</code> should check here. I even tried:</p>\n\n<pre><code>import Data.NonEmpty\n\nnewtype Identity a = Identity a\n\ninstance (Semigroup a) =&gt; Semigroup (Identity a) where\n  (Identity a1) &lt;&gt; (Identity a2) = Identity (a1 &lt;&gt; a2)\n\ninstance Arbitrary (Identity a) where\n  arbitrary = return (Identity a)\n\ntype IdentityAssoc =\n  (Identity (NonEmpty Int)) -&gt; (Identity (NonEmpty Int)) -&gt; (Identity (NonEmpty Int)) -&gt; Bool\n\nmain :: IO ()\nmain =\n  quickCheck (semigroupAssoc :: IdentityAssoc)\n</code></pre>\n\n<p>to make the parameterized types' parameters concrete. But it does not work either.</p>\n\n<p>For the third, I do not know how to write them. But I think it is similar to the second one.</p>\n\n<p>Can someone explain on these so that I can understand how to write the <code>instance</code> of parameterized Semigroups and their <code>quickTest</code> arbitrary?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1540211026, "post_id": 52927095, "comment_id": 92767627, "body": "You may simply <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:foldl1\" rel=\"nofollow noreferrer\"><code>foldl1</code></a> by <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:intersect\" rel=\"nofollow noreferrer\"><code>Data.List.intersect</code></a> if i got you right. Such as <code>foldl1 intersect [[1,2,3], [0,1,3], [1,3,4]]</code> would result <code>[1,3]</code>."}, {"owner": {"reputation": 67, "user_id": 10503579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3032201fe6d616038f5b1871d301608e?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous Panther", "link": "https://stackoverflow.com/users/10503579/anonymous-panther"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1540216389, "post_id": 52927095, "comment_id": 92771253, "body": "@Redu thanks for your tip can you give any example?"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1540217646, "post_id": 52927095, "comment_id": 92772100, "body": "&quot;the longest sub-list of each of the list of lists&quot;, to me sounds like an intersection of multiple lists and your example supports that. Haskell is ready for this job out of the box. As mentioned in my above comment <code>foldl1</code> and <code>intersect</code> which lives in <code>Data.List</code> are sufficient. <code>foldl1 Data.List.intersect [[1,2,3,4,5,6,7,8,9], [-3,-2,-1,0,1,2,3,4,5], [3,4,4,4,5,6,7]]</code> would return <code>[3,4,5]</code>."}, {"owner": {"reputation": 67, "user_id": 10503579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3032201fe6d616038f5b1871d301608e?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous Panther", "link": "https://stackoverflow.com/users/10503579/anonymous-panther"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1540224259, "post_id": 52927095, "comment_id": 92776104, "body": "@Redu exactly that&#39;s my idea as well but I am not allowed to use Data.List or import any 3rd party library"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1540232238, "post_id": 52927095, "comment_id": 92779938, "body": "Why only an <code>Eq</code> constraint? That&#39;s rather wimpy, and most <i>efficient</i> implementations of this function will want more. <code>Ord</code> would open up a lot more options."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1540205484, "creation_date": 1540205484, "answer_id": 52927577, "question_id": 52927095, "link": "https://stackoverflow.com/questions/52927095/longest-common-sub-list/52927577#52927577", "title": "Longest common sub-list", "body": "<p>For your <code>findCombinations</code> function, you can adopt the following approach.</p>\n\n<ul>\n<li>there is only one sublist of <code>[]</code>, namely <code>[]</code> itself</li>\n<li>the sublists of <code>x:xs</code>, instead, have two forms:\n\n<ul>\n<li>the sublists of <code>xs</code></li>\n<li>the sublists of <code>xs</code>, where <code>x</code> has been added in front of each of them</li>\n</ul></li>\n</ul>\n\n<p>You can start coding this by first defining a function <code>addToAll :: a -&gt; [[a]] -&gt; [[a]]</code> such that, for instance, <code>addToAll 2 [[1,5],[],[8,5,6]] = [[2,1,5],[2],[2,8,5,6]]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1540230800, "post_id": 52934652, "comment_id": 92779290, "body": "1) The question is not very clear, but I believe the OP wants the sublists, not the subsets; <code>intersection</code> ignores the order in the list elements, when it might matter (the longest sublists of &quot;ab&quot; and &quot;ba&quot; are &quot;a&quot; and &quot;b&quot;, not &quot;ab&quot; nor &quot;ba&quot;)  2) <code>(\\e -&gt; any (== e) xs)</code> can also be written <code>(`elem` xs)</code>"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1540242703, "post_id": 52934652, "comment_id": 92784788, "body": "@chi Well i don&#39;t think it&#39;s a problem since a slightest change in the sub lists will prevent the problem you mention. On the other hand checking if all sublists having exactly same elements in advance is a trivial job. So i guess no need for combinatronics here. The main problem here is with the built in <code>intersect</code> function since when you do like <code>foldl1 intersect [1,2,2,3] [1,2,4]</code> the result is <code>[1,2,2]</code>. Which brings me to the necessity of chaining a <code>nub</code> stage such as <code>nub . foldl1 intersect $ [[1,2,3,4,4,4,4,5,6,7,8,9], [-3,-2,-1,0,1,2,3,4,5], [3,4,5,6,7]]</code>"}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1540230511, "last_edit_date": 1540230511, "creation_date": 1540229081, "answer_id": 52934652, "question_id": 52927095, "link": "https://stackoverflow.com/questions/52927095/longest-common-sub-list/52934652#52934652", "title": "Longest common sub-list", "body": "<p>Ok what you need can simply be done by using <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:foldl1\" rel=\"nofollow noreferrer\">foldl1</a> applied by <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:intersect\" rel=\"nofollow noreferrer\">Data.List.intersect</a>. Such as;</p>\n\n<pre><code>Prelude&gt; foldl1 Data.List.intersect [[1,2,3], [0,1,3], [1,3,4]]\nPrelude&gt; [1,3]\n</code></pre>\n\n<p><code>Data.List</code> is a very common library and many of it's inhabitants are default in Prelude such as <code>foldl1</code>. So it shouldn't be a big deal to import <code>intersect</code> from it. However <code>intersect</code> by itself is a very simple code and you may simply implement it yourself or <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/Data.OldList.html#intersect\" rel=\"nofollow noreferrer\">steal it from the definition</a>. Let's do it;</p>\n\n<pre><code>Prelude&gt; let isect xs ys = filter (\\e -&gt; any (== e) xs) ys\nPrelude&gt; foldl1 isect [[1,2,3,4,5,6,7,8,9], [-3,-2,-1,0,1,2,3,4,5], [3,4,4,4,5,6,7]]\n[3,4,5]\n</code></pre>\n\n<p>So here you go. Your library agnostic function is.</p>\n\n<pre><code>f :: Eq a =&gt; [[a]] -&gt; [a]\nf = foldl1 isect\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10503579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3032201fe6d616038f5b1871d301608e?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous Panther", "link": "https://stackoverflow.com/users/10503579/anonymous-panther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1540230511, "creation_date": 1540203793, "last_edit_date": 1540206085, "question_id": 52927095, "link": "https://stackoverflow.com/questions/52927095/longest-common-sub-list", "title": "Longest common sub-list", "body": "<p>I need a function <code>f :: Eq a =&gt; [[a]] -&gt; [a]</code> returning the longest sub-list of each of the list of lists supplied. E.g., <code>f [[1,2,3], [0,1,3], [1,3,4]] =\n[1,3]</code>. [1,3] is defined to be a sub-List of <code>[1,2,3]</code>, therefore the elements of the sublist don't have to be in neighbouring positions of the super-list.</p>\n\n<p>What I have thought so far is making a function let's call it: <code>findCombinations :: [a] -&gt; [[a]]</code> that takes a list and returns all possible combinations of elements of that list. For example, <code>[1,2,3] -&gt; [[1],[2],[3],[1,2],[1,3],[2,3],[1,2,3]]</code>, and then using that function for every sublist of the superlist in order to find all possible combinations for each sublist and then find the combinations that appears the most, however I am stuck with the implementation. Any ideas?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1540202196, "post_id": 52926297, "comment_id": 92762673, "body": "<code>&quot;http:&#47;&#47;httpbin.org&quot; {</code> looks like a type error."}, {"owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1540202843, "post_id": 52926297, "comment_id": 92763062, "body": "@melpomene It&#39;s a made-up site. Not important"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1540203103, "post_id": 52926297, "comment_id": 92763190, "body": "Ah, it&#39;s not a type error because of OverloadedStrings. Are you simply looking for <a href=\"http://hackage.haskell.org/package/http-client-0.5.13.1/docs/Network-HTTP-Client.html#v:requestHeaders\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/http-client-0.5.13.1/docs/&hellip;</a>?"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540201738, "creation_date": 1540201083, "last_edit_date": 1540201738, "question_id": 52926297, "link": "https://stackoverflow.com/questions/52926297/haskell-http-client-browser-simulation", "title": "Haskell http client browser simulation", "body": "<p>I'm thinking of using low level http client library to simulate a real browser. </p>\n\n<p>Below is the exmaple code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Network.HTTP.Client\n\nmain :: IO ()\nmain = do\n    let settings = managerSetProxy\n            (proxyEnvironment Nothing)\n            defaultManagerSettings\n    man &lt;- newManager settings\n    let req = \"http://httpbin.org\"\n            -- Note that the following settings will be completely ignored.\n            { proxy = Just $ Proxy \"localhost\" 1234\n            }\n    httpLbs req man &gt;&gt;= print\n</code></pre>\n\n<p>Which part could I customize? the <code>req</code> or manager settings? Could anyone show me an example how to simulate below Chrome request headers?</p>\n\n<pre><code>:authority: example.com\n:method: GET\n:path: /ebooks/1/added/desc.html\n:scheme: https\naccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\naccept-encoding: gzip, deflate, br\naccept-language: en-US,en;q=0.9,fr;q=0.8,zh-CN;q=0.7,zh;q=0.6,zh-TW;q=0.5,pt;q=0.4\ncache-control: max-age=0\nreferer: https://torlock.unblocked.gdn/ebooks/1/added/desc.html\nupgrade-insecure-requests: 1\nuser-agent: Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Mobile Safari/537.36\n</code></pre>\n\n<p>Btw: Is it enough for a website to think it's a brower accessing it just by modifying the request header?</p>\n"}, {"tags": ["haskell", "types", "compiler-errors", "typeclass", "parametric-polymorphism"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1540195601, "post_id": 52924772, "comment_id": 92758904, "body": "Because your signature says &quot;I can return <i>any</i> <code>b</code>, as long as it is <code>Eq b</code>), but your implementation is clearly only returning <code>Int</code>s."}, {"owner": {"reputation": 3960, "user_id": 1556475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dbf54fca536242c214a1f99a6b9b8931?s=128&d=identicon&r=PG", "display_name": "Cameron Ball", "link": "https://stackoverflow.com/users/1556475/cameron-ball"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540195665, "post_id": 52924772, "comment_id": 92758931, "body": "I suppose I&#39;m misunderstanding the value of saying &quot;i can return any b&quot;."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1540212038, "post_id": 52924772, "comment_id": 92768322, "body": "You might also like <a href=\"https://stackoverflow.com/q/42820603/791604\">this question</a>; there I describe types as a sort of two-player game, and I think it&#39;s a good way to summarize what&#39;s going on here."}], "answers": [{"comments": [{"owner": {"reputation": 3960, "user_id": 1556475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dbf54fca536242c214a1f99a6b9b8931?s=128&d=identicon&r=PG", "display_name": "Cameron Ball", "link": "https://stackoverflow.com/users/1556475/cameron-ball"}, "edited": false, "score": 1, "creation_date": 1540197112, "post_id": 52925066, "comment_id": 92759678, "body": "&quot;It is not your function that decides what type to return. It&#39;s your function&#39;s use that determines that.&quot; - that statement helps a lot. Thanks. Getting my head around parametric polymorphism is a challenge sometimes."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3960, "user_id": 1556475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dbf54fca536242c214a1f99a6b9b8931?s=128&d=identicon&r=PG", "display_name": "Cameron Ball", "link": "https://stackoverflow.com/users/1556475/cameron-ball"}, "edited": false, "score": 5, "creation_date": 1540197908, "post_id": 52925066, "comment_id": 92760095, "body": "@CameronBall I think it helps a lot visualizing the implicit type arguments. For instance, when we write <code>id True</code> GHC internally expands this to <code>id @Bool True</code>, where the <code>@Bool</code> part chooses the type <code>a</code> in <code>id :: forall a. a-&gt;a</code>. Essentially, polymorphic functions are functions with one or more &quot;type&quot; arguments, which need to be passed with the special <code>@T</code> syntax, or omitted so that type inference can fill them for us. As an exercise, you can try to add all the <code>@T</code>s on your own and see what&#39;s under the hood (turn on the <code>TypeApplications</code> extension first)."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 10, "last_activity_date": 1540200378, "last_edit_date": 1540200378, "creation_date": 1540196646, "answer_id": 52925066, "question_id": 52924772, "link": "https://stackoverflow.com/questions/52924772/why-is-this-implementation-invalid/52925066#52925066", "title": "Why is this implementation invalid?", "body": "<p>No, your type signature, which is actually</p>\n\n<pre><code>forall a b. (Eq a, Eq b) =&gt; a -&gt; b\n</code></pre>\n\n<p>means that your function must be callable with <em>any</em> types <code>a</code> and <code>b</code>, as determined by the <em>call site</em>, as long as both are instances of <code>Eq</code>.</p>\n\n<p><em>It is not your function that decides what type to return.</em> It's your function's <em>use</em> that determines that.</p>\n\n<p>So you should be able to write</p>\n\n<pre><code>    let { i :: Int; i = 1;\n          n :: Integer; y :: Double;\n          n = foo i;   -- foo :: Int -&gt; Integer\n          y = foo i    -- foo :: Int -&gt; Double\n        }\n</code></pre>\n\n<p>and as you can see, the only implementation for your function is <em>no</em> implementation:</p>\n\n<pre><code>foo _ = x where {x = x}\n</code></pre>\n\n<p>because you have no way to produce a value of <em>any</em> type that's demanded of you. That type can be anything, and you have no way of knowing anything about it.</p>\n\n<hr>\n\n<p>By the way <em>other</em> typeclasses might actually allow you to define <em>something</em> here, like </p>\n\n<pre><code>foo :: (Enum a, Enum b, Bounded a, Bounded b) =&gt; a -&gt; b \nfoo a = snd . last $ zip [minBound .. a] (cycle [minBound ..])\n</code></pre>\n\n<p>I'm not saying it's a sensible definition, just that it is possible:</p>\n\n<pre><code>&gt; foo () :: Bool\nFalse\n\n&gt; foo True :: Int\n-9223372036854775807\n\n&gt; foo (0 :: Int) :: Bool\nInterrupted.\n</code></pre>\n\n<p>It is probably a common misconception for programmers coming from the more usual languages to think that <code>foo :: (Eq a) =&gt; a</code> means \"I get to define <code>foo</code>  to return any type I want, as long as it is in <code>Eq</code>\". It doesn't. :)</p>\n"}], "owner": {"reputation": 3960, "user_id": 1556475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dbf54fca536242c214a1f99a6b9b8931?s=128&d=identicon&r=PG", "display_name": "Cameron Ball", "link": "https://stackoverflow.com/users/1556475/cameron-ball"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 52925066, "answer_count": 1, "score": 5, "last_activity_date": 1540218556, "creation_date": 1540195485, "last_edit_date": 1540218556, "question_id": 52924772, "link": "https://stackoverflow.com/questions/52924772/why-is-this-implementation-invalid", "title": "Why is this implementation invalid?", "body": "<p>Let's say I have the following type signature:</p>\n\n<pre><code>someFunction :: (Eq a, Eq b) =&gt; a -&gt; b\n</code></pre>\n\n<p>With implementation:</p>\n\n<pre><code>someFunction x = (2 :: Int)\n</code></pre>\n\n<p>(Don't look in to it too far, it's just an example).</p>\n\n<p>My understanding of the signature is that \"<code>someFunction</code> takes an argument that is an instance of the <code>Eq</code> typeclass, and returns a value (that can be of a different type) that is an instance of the <code>Eq</code> typeclass\". <code>Int</code> is an instance of <code>Eq</code>, so why does GHC get upset about this implementation?</p>\n\n<p>The error makes it obvious enough:</p>\n\n<blockquote>\n<pre><code>Couldn't match expected type \u2018b\u2019 with actual type \u2018Int\u2019\n     \u2018b\u2019 is a rigid type variable bound by\n       the type signature for:\n         someFunction :: forall a b. (Eq a, Eq b) =&gt; a -&gt; b\n</code></pre>\n</blockquote>\n\n<p>I guess what I don't understand is the requirement that it work \"forall\" <code>b</code>. Any code using this function should only rely on the fact that <code>b</code> is an instance of <code>Eq</code>, right? In my head, the implementation does match the signature. What about my implementation is breaking the expectations of this  signature?</p>\n"}, {"tags": ["haskell", "types", "error-handling", "compiler-errors"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1540177037, "post_id": 52921794, "comment_id": 92752942, "body": "Note the difference between tuples and your various Vector types."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 43, "user_id": 10534572, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e-nJFsJgZ7s/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBptpMuY-tLheOl8oAOurZgVEALdg/mo/photo.jpg?sz=128", "display_name": "killderich111", "link": "https://stackoverflow.com/users/10534572/killderich111"}, "edited": false, "score": 0, "creation_date": 1540200997, "post_id": 52921998, "comment_id": 92761956, "body": "I would (<a href=\"https://stackoverflow.com/a/52778686/745903\">again</a>) remark that the lack of a <code>VectorSpace</code> instance for <code>(1,2,3,3)</code> is because the class is misdesigned. It doesn&#39;t really make sense for a vector space to be parameterised over the scalar type. <a href=\"http://hackage.haskell.org/package/vector-space-0.15/docs/Data-VectorSpace.html\" rel=\"nofollow noreferrer\">The preferred vector space class</a> has the scalar as an associated type family instead. @killderich111 could you say where this comes from? Is it from some kind of tutorial or course?"}], "tags": [], "owner": {"reputation": 192, "user_id": 10538387, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MzMyjPapfMw/AAAAAAAAAAI/AAAAAAAAAAo/TGOKilbIRZI/photo.jpg?sz=128", "display_name": "Vanessa McHale", "link": "https://stackoverflow.com/users/10538387/vanessa-mchale"}, "is_accepted": true, "score": 3, "last_activity_date": 1540178518, "creation_date": 1540178518, "answer_id": 52921998, "question_id": 52921794, "link": "https://stackoverflow.com/questions/52921794/haskell-non-type-variable-argument-in-the-constraint/52921998#52921998", "title": "Haskell: Non type-variable argument in the constraint?", "body": "<p>You need to use the <code>Vector4</code> constructor, viz.</p>\n\n<pre><code>vecF (Vector4 (1,2,3,3)) [ Vector4 (2,1,2,2), Vector4 (13,3,2,1)]\n</code></pre>\n\n<p>Basically, the error message is telling you exactly what you need to know - namely, that <code>(1,2,3,3)</code> has no <code>VectorSpace</code> instance. In this case that is because you are calling it on something which is not a vector on its underlying type.</p>\n\n<p>The reason it says there's no instance for <code>VectorSpace ((,,,) t2 t1 t)</code> is that it's trying to match the type of <code>(1, 2, 3, 4)</code> with <code>v a</code> over some <code>a</code> - and here it tried to use <code>Num t, Num t1, Num t2 =&gt; (t, t1, t2,)</code> as the higher-kinded bit.</p>\n"}], "owner": {"reputation": 43, "user_id": 10534572, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e-nJFsJgZ7s/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBptpMuY-tLheOl8oAOurZgVEALdg/mo/photo.jpg?sz=128", "display_name": "killderich111", "link": "https://stackoverflow.com/users/10534572/killderich111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 1, "accepted_answer_id": 52921998, "answer_count": 1, "score": 2, "last_activity_date": 1540178518, "creation_date": 1540176502, "question_id": 52921794, "link": "https://stackoverflow.com/questions/52921794/haskell-non-type-variable-argument-in-the-constraint", "title": "Haskell: Non type-variable argument in the constraint?", "body": "<p>This is the code, it is a bit non-straightforward I apologize. Basically the function vecF is supposed to have two results v1,v2 if entering two inputs v0 and vs, but for some reason I end up getting error messages.</p>\n\n<pre><code>newtype Vector2 a = Vector2 (a,a)\n  deriving (Show,Eq)\nnewtype Vector3 a = Vector3 (a,a,a)\n  deriving (Show,Eq)\nnewtype Vector4 a = Vector4 (a,a,a,a)\n  deriving (Show,Eq)\n\nclass VectorSpace v where\n  vecZero       :: (Num a) =&gt; v a\n  vecSum        :: (Num a) =&gt; v a -&gt; v a -&gt; v a\n  vecScalarProd :: (Num a) =&gt; a -&gt; v a -&gt; v a\n  vecMagnitude  :: (Floating a) =&gt; v a -&gt; a\n  vecInnerProd  :: (Num a) =&gt; v a -&gt; v a-&gt; a\n\ninstance VectorSpace Vector2 where\n  vecZero = Vector2 (0,0)\n  vecSum (Vector2 (q,w)) (Vector2 (a,s)) = Vector2 (q+a,w+s)\n  vecScalarProd x (Vector2 (q,w)) = Vector2 (q*x,w*x)\n  vecMagnitude (Vector2 (q,w)) = sqrt(q*q+w*w)\n  vecInnerProd (Vector2 (q,w)) (Vector2 (a,s)) = q*a+w*s\n\ninstance VectorSpace Vector3 where\n  vecZero = Vector3 (0,0,0)\n  vecSum (Vector3 (q,w,e)) (Vector3 (a,s,d)) = Vector3 (q+a,w+s,e+d)\n  vecScalarProd x (Vector3 (q,w,e)) = Vector3 (q*x,w*x,e*x)\n  vecMagnitude (Vector3 (q,w,e)) = sqrt(q*q+w*w+e*e)\n  vecInnerProd (Vector3 (q,w,e)) (Vector3 (a,s,d)) = q*a+w*s+e*d\n\ninstance VectorSpace Vector4 where\n  vecZero = Vector4 (0,0,0,0)\n  vecSum (Vector4 (q,w,e,r)) (Vector4 (a,s,d,f)) = Vector4 \n(q+a,w+s,e+d,r+f)\n  vecScalarProd x (Vector4 (q,w,e,r)) = Vector4 (q*x,w*x,e*x,r*x)\n  vecMagnitude (Vector4 (q,w,e,r)) = sqrt(q*q+w*w+e*e+r*r)\n  vecInnerProd (Vector4 (q,w,e,r))(Vector4 (a,s,d,f)) =\n    q*a+w*s+e*d+r*f\n\nvecF :: (Floating a, Ord a, VectorSpace v) =&gt; v a -&gt; [v a] -&gt; (v a, v a)\nvecF v0 vs = (v1,v2) where\n            v0Neg     = vecScalarProd (-1) v0\n            v1MinMag  = minimumBy (comparing snd)(zip [0..]  \n[vecMagnitude (vecSum v0Neg v) | v &lt;- vs])\n            v1Index   = fst v1MinMag\n            v1Min     = [vecSum v0Neg v | v &lt;- vs] !! v1Index\n            v1        = vecSum v0 v1Min\n\n            v2MaxMag  = maximumBy (comparing snd)(zip [0..]  \n[vecMagnitude (vecSum v0Neg v) | v &lt;- vs])\n            v2Index   = fst v2MaxMag\n            v2Max     = [vecSum v0Neg v | v &lt;- vs] !! v2Index\n            v2        = vecSum v0 v2Max\n</code></pre>\n\n<p>Below is errors I got when i enter:</p>\n\n<pre><code> vecF (1,2,3,3) [(2,1,2,2),(13,3,2,1)]\n</code></pre>\n\n<p>.</p>\n\n<pre><code> \u2022Non type-variable argument\n    in the constraint: VectorSpace ((,,,) t2 t1 t)\n  (Use FlexibleContexts to permit this)\n  \u2022When checking the inferred type\n    it :: forall a t t1 t2.\n          (Num t, Num t1, Num t2, VectorSpace ((,,,) t2 t1 t), Ord a,\n           Floating a) =&gt;\n          ((t2, t1, t, a), (t2, t1, t, a))\n</code></pre>\n\n<p>I have tried using FlexibleContexts like this, </p>\n\n<pre><code>:set -XFlexibleContexts\n</code></pre>\n\n<p>and then I get this new error message</p>\n\n<pre><code> \u2022 When checking the inferred type\n    it :: forall a t t1 t2.\n          (Num t, Num t1, Num t2, VectorSpace ((,,,) t2 t1 t), Ord a,\n           Floating a) =&gt;\n          ((t2, t1, t, a), (t2, t1, t, a))\n\u2022 No instance for (VectorSpace ((,,,) t2 t1 t0))\n    arising from a use of \u2018it\u2019\n\u2022 In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>Is there any way I can fix this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1540172317, "post_id": 52921119, "comment_id": 92752165, "body": "you can&#39;t skip the <code>then</code> keyword in the <code>if ... then ... else ...</code> expression."}], "answers": [{"tags": [], "owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "is_accepted": true, "score": 6, "last_activity_date": 1540168735, "creation_date": 1540168735, "answer_id": 52921143, "question_id": 52921119, "link": "https://stackoverflow.com/questions/52921119/haskell-error-parse-error-on-input-else/52921143#52921143", "title": "Haskell: error: parse error on input \u2018else\u2019", "body": "<pre><code>if incrementBid &lt;= length hand\n    incrementBid\nelse -- &lt;- error occurs on this line \n    incrementBid - 2\n</code></pre>\n\n<p><code>then</code> is not optional and it is missing in this block.</p>\n"}], "owner": {"reputation": 145, "user_id": 10448841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ee631428bfbd476b1ab1c60d534e084?s=128&d=identicon&r=PG&f=1", "display_name": "Maqruis1", "link": "https://stackoverflow.com/users/10448841/maqruis1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 52921143, "answer_count": 1, "score": 1, "last_activity_date": 1540168735, "creation_date": 1540168537, "question_id": 52921119, "link": "https://stackoverflow.com/questions/52921119/haskell-error-parse-error-on-input-else", "title": "Haskell: error: parse error on input \u2018else\u2019", "body": "<pre><code>avoidHookRule :: Int -&gt; [Cards] -&gt; Int\navoidHookRule initialBid hand = if decrementBid /= 0\n                                    then\n                                      decrementBid\n                                    else\n                                      if incrementBid &lt;= length hand\n                                          incrementBid\n                                      else -- &lt;- error occurs on this line \n                                          incrementBid - 2\n                                where incrementBid = initialBid + 1\n                                      decrementBid = initialBid - 1\n</code></pre>\n\n<p>As the title says I get the error on my else statement. Why is this happening? How do I fix it? Thank you </p>\n"}, {"tags": ["haskell", "random", "types", "io"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1540155099, "post_id": 52919638, "comment_id": 92749052, "body": "Did you try adding a type annotation as the error suggested? Is there something in particular about the message that you&#39;re confused by?"}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1540155482, "post_id": 52919638, "comment_id": 92749150, "body": "I don&#39;t know how to add a type signature to a function call. And randomR is a library function so that one already has a type signature"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1540155542, "post_id": 52919638, "comment_id": 92749166, "body": "Errors aside, reusing the same <code>gen</code> that many times is wrong. For instance <code>fst $ randomR (0.0, 1.0) gen</code> will return the same number, when used many times. There&#39;s a reason why <code>randomR</code> returns a pair with a <i>new</i> <code>gen</code>: so that the old <code>gen</code> can be forgotten and new numbers are taken using the new ones. You need to &quot;chain&quot; an pass around your <code>gen</code>s (or use a monad for that)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1540155612, "post_id": 52919638, "comment_id": 92749189, "body": "You can add a signature to ambiguous numbers writing e.g. <code>(0.0 :: Float)</code> instead of simply <code>0.0</code>."}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 1, "creation_date": 1540155633, "post_id": 52919638, "comment_id": 92749197, "body": "I think I understand monads, but applying them myself remains difficult. could you give an answer that uses monads?"}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1540156633, "post_id": 52919638, "comment_id": 92749387, "body": "@chi How do I chain and pass the gen in the same function, I don&#39;t see how"}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1540159994, "post_id": 52919638, "comment_id": 92750145, "body": "@chi I used the monad now, but I still have the same generator all the time so I can&#39;t generate multiple random numbers in the same frame it seems"}], "answers": [{"comments": [{"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1540162108, "post_id": 52920457, "comment_id": 92750572, "body": "I think it works now. Did you mean that I should use the example snippet in my <code>getEnemies</code> function? Here&#39;s a picture <a href=\"https://gyazo.com/aac50d59746bab9c106fecbe454f3e49\" rel=\"nofollow noreferrer\">link to gyazo picture</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 2, "creation_date": 1540162325, "post_id": 52920457, "comment_id": 92750612, "body": "@TheCodingWombat Don&#39;t forget to return <code>g5</code> from <code>genEnemies</code> so that the caller of <code>genEnemies</code> can use the updated <code>StdGen</code> and not reuse random numbers -- and update callers to use the same pattern of passing updated <code>StdGen</code>s to followup random-number-generation methods!"}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1540162540, "post_id": 52920457, "comment_id": 92750651, "body": "How can my <code>genEnemies</code> method return <code>g5</code>, it already returns an array of moving Enemies. Using a tuple?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 1, "creation_date": 1540169907, "post_id": 52920457, "comment_id": 92751797, "body": "@TheCodingWombat Yep, exactly."}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1540246759, "post_id": 52920457, "comment_id": 92786075, "body": "I got the none-monad version working. I tried creating it with Monads like you suggested: <a href=\"https://gyazo.com/88aecf094358b64f24f185a8bfdac809\" rel=\"nofollow noreferrer\">See this gyazo link</a>. I can&#39;t find any resources on the internet with good examples. This works when I call the genMoving function once, but the new monad function doesn&#39;t return a new generator, so calling the genMoving function again results in the same five random numbers.."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1540262582, "post_id": 52920457, "comment_id": 92789605, "body": "@TheCodingWombat Probably worth another question. But in short: <code>genMoving&#39;</code> will need to be in the monad as well. Once in the monad, always in the monad -- at the very top level, your whole game will be in the monad and you&#39;ll just feed in the initial random number generator once."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1540160704, "creation_date": 1540160704, "answer_id": 52920457, "question_id": 52919638, "link": "https://stackoverflow.com/questions/52919638/ambiguous-type-error-multiple-different-random-values-in-the-same-function/52920457#52920457", "title": "Ambiguous type error &amp; Multiple different random values in the same function", "body": "<p>The usual pattern when you want to generate multiple random numbers in Haskell goes like this:</p>\n\n<pre><code>foo :: StdGen -&gt; (StdGen, (Int, Int, Int))\nfoo g0 = let\n    (val1, g1) = randomR (0, 10) g0\n    (val2, g2) = randomR (0, 10) g1\n    (val3, g3) = randomR (0, 10) g2\n    in (g3, (val1, val2, val3))\n</code></pre>\n\n<p>For example, in ghci:</p>\n\n<pre><code>System.Random&gt; foo (mkStdGen 0)\n(1346387765 2103410263,(7,10,2))\n</code></pre>\n\n<p>You can see it returned three different numbers -- unlike what you would get if you called <code>randomR</code> with <code>g0</code> each time as you did in your code.</p>\n\n<p>Hopefully you catch the pattern: call <code>randomR</code> with the range you want and a <code>StdGen</code>; use the value it returned as your random piece and the <code>StdGen</code> it returned as the input next time you call <code>randomR</code>. It's also important that you return the updated <code>StdGen</code> from your random function, so that you can continue the pattern in later calls.</p>\n\n<p>Later you can look into monads, specifically <a href=\"http://hackage.haskell.org/package/MonadRandom-0.5.1.1/docs/Control-Monad-Trans-Random-Lazy.html\" rel=\"nofollow noreferrer\"><code>RandT</code></a>, which can abstract away the process of feeding the most recently updated <code>StdGen</code> into the next call to <code>randomR</code>. A sample of the <code>RandT</code> style looks like this:</p>\n\n<pre><code>foo' :: MonadRandom m =&gt; m (Int, Int, Int)\nfoo' = do\n    val1 &lt;- getRandomR (0, 10)\n    val2 &lt;- getRandomR (0, 10)\n    val3 &lt;- getRandomR (0, 10)\n    return (val1, val2, val3)\n</code></pre>\n\n<p>...but for now, stick with the basics. Once you understand them thoroughly it will feel much less magical when you implement (or reuse) the abstractions that let you do that kind of thing.</p>\n"}], "owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 52920457, "answer_count": 1, "score": 1, "last_activity_date": 1540160704, "creation_date": 1540154224, "last_edit_date": 1540154586, "question_id": 52919638, "link": "https://stackoverflow.com/questions/52919638/ambiguous-type-error-multiple-different-random-values-in-the-same-function", "title": "Ambiguous type error &amp; Multiple different random values in the same function", "body": "<p>I need multiple random numbers in different ranges (which could be avoided by multiplying the result of the random number generator with a constant).</p>\n\n<p>I'm making an Asteroid clone in Haskell, and I want to generate randomly spawned enemies. I want to let them spawn at the edge of the screen with the same velocity (so norm of velocity vector equal).</p>\n\n<p>Additional info: When an entity hits the edge of the screen it appears again at the other side, this is why I chose to only let enemies spawn at two of four edges of the screen and made the velocity really determine where you first see them appear.</p>\n\n<p>I looked at <code>System.Random</code> and ran into difficulties. I figured I needed five random numbers: </p>\n\n<ol>\n<li>A random number to determine if at this frame a monster should\nspawn.</li>\n<li>Random x position or random y position (spawns at the edge</li>\n<li>Random number to determine on which side of the screen an enemy spawns</li>\n<li>Random number for x velocity</li>\n<li>Random number (1 or -1) to create a velocity vector with a set norm.</li>\n</ol>\n\n<p>At the start of the game I generate a new StdGen and after that I do this every frame.</p>\n\n<p>Solutions I thought of but thought were bad practice: Instead of passing down generators through methods, create a new generator every time using <code>newStdGen</code>.</p>\n\n<p>I also thought of calling the newRand function for all the random numbers I need. But if I had a function that required two random numbers in the same range, the two random numbers would be identical, since identical input always gives identical output in Haskell.</p>\n\n<p><strong>Problem: Ambiguous type variables at all the random calls except for the call to the newRand function (that is also used to update the generator each frame), because Haskell doesn't know which type of number to use.</strong></p>\n\n<p>Sample error:</p>\n\n<pre><code>src\\Controller.hs:45:56: error:\n    * Ambiguous type variable `a0' arising from the literal `0.0'\n      prevents the constraint `(Fractional a0)' from being solved.\n      Relevant bindings include\n        axis :: a0 (bound at src\\Controller.hs:45:25)\n      Probable fix: use a type annotation to specify what `a0' should be.\n      These potential instances exist:\n        instance HasResolution a =&gt; Fractional (Fixed a)\n          -- Defined in `Data.Fixed'\n        instance Fractional Double -- Defined in `GHC.Float'\n        instance Fractional Float -- Defined in `GHC.Float'\n        ...plus three instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    * In the expression: 0.0\n      In the first argument of `randomR', namely `(0.0, 1.0)'\n      In the second argument of `($)', namely `randomR (0.0, 1.0) gen'\n   |\n45 |                         axis = signum $ fst $ randomR (0.0, 1.0) gen\n   |                                                        ^^^\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>newRand :: StdGen -&gt; (Float, Float) -&gt; (Float, StdGen)\nnewRand gen (a, b) = randomR (a, b) gen\n\ngenEnemies :: StdGen -&gt; Float -&gt; [Moving Enemy]\ngenEnemies gen time | rand &gt; 995 = [Moving (x, y) (vx, vy) defaultEnemy]\n                    | otherwise  = []\n                  where rand = fst $ newRand (0, 1000) gen\n                        x | axis &lt; 0.5  = fst $ randomR (0.0, width) gen\n                          | otherwise   = 0\n                        y | axis &gt;= 0.5 = fst $ randomR (0.0, height) gen\n                          | otherwise   = 0\n                        axis = signum $ fst $ randomR (0.0, 1.0) gen\n                        vx   = fst $ randomR (-20.0, 20.0) gen\n                        vy   = sgn * sqrt (400 - vx*vx)                  \n                        sgn  = (signum $ fst $ randomR (-1.0, 1.0) gen)\n</code></pre>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1540152817, "post_id": 52919415, "comment_id": 92748482, "body": "SO is not a coding service. You should post your best attempt at solving this, and ask about specific issues you met. Asking others to write the code from scratch for you will only lead to the question being closed. Start by 1) writing the type for your function, 2) defining the base case (n=0), 3) defining the inductive case."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1540152838, "post_id": 52919415, "comment_id": 92748490, "body": "<a href=\"https://www.haskell.org/hoogle/?hoogle=Char+-%3E+Integer+-%3E+%5BChar%5D\" rel=\"nofollow noreferrer\">First result from Hoogle after transcribing your &quot;take a char and an integer and return the char n times&quot; to <code>Char -&gt; Integer -&gt; [Char]</code>.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 3, "user_id": 10537423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ab7e53fadb57d0c79d11f88605b1acf?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/10537423/josh"}, "edited": false, "score": 4, "creation_date": 1540171901, "post_id": 52919659, "comment_id": 92752101, "body": "@Oscar That belongs in a separate question, but you need to supply your attempt first and explain where you&#39;re stuck, because this site isn&#39;t a code writing service."}], "tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": true, "score": 4, "last_activity_date": 1540154823, "last_edit_date": 1540154823, "creation_date": 1540154336, "answer_id": 52919659, "question_id": 52919415, "link": "https://stackoverflow.com/questions/52919415/haskell-returning-a-char-nth-times/52919659#52919659", "title": "Haskell, returning a char nth times", "body": "<p>To start with, a function is a map from one type to another and from one value to another. Lists and <code>Data.Map</code> are also maps, just like functions. This means that you can enumerate all the possible cases to define your function. Let's do this and see if a pattern emerges:</p>\n\n<pre><code>rep :: Char -&gt; Int -&gt; [Char]\nrep x 0 = []  --Something repeated zero times is an empty list\nrep x 1 = [x]  --Something repeated one time is a list with one entry\nrep x 2 = [x, x]\nrep x 3 = [x, x, x]\nrep x 4 = [x, x, x, x]\n</code></pre>\n\n<p>See the pattern?</p>\n\n<pre><code>rep x 0 = []\nrep x n = x : (rep x $ n - 1)\n</code></pre>\n\n<p>Aaaand this is your function!</p>\n\n<p>Note that this applies to any type, not only <code>Char</code>, so we can change the type signature:</p>\n\n<pre><code>rep :: a -&gt; Int -&gt; [a]\n</code></pre>\n\n<p>What if <code>n &lt; 0</code>? Right now, Haskell will enter an infinite loop attempting to do:</p>\n\n<pre><code>x : (x : (x : (x : (...))))\n</code></pre>\n\n<p>How do we fix that? You can just return an empty list, for example:</p>\n\n<pre><code>rep x n = if n &lt;= 0 then [] else x : (rep x $ n - 1)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10537423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ab7e53fadb57d0c79d11f88605b1acf?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/10537423/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "closed_date": 1540171698, "accepted_answer_id": 52919659, "answer_count": 1, "score": -5, "last_activity_date": 1540219147, "creation_date": 1540152563, "last_edit_date": 1540219147, "question_id": 52919415, "link": "https://stackoverflow.com/questions/52919415/haskell-returning-a-char-nth-times", "closed_reason": "Needs more focus", "title": "Haskell, returning a char nth times", "body": "<p>I am trying to make a function in haskell using recursion that takes two arguments.\nThe function takes a char and an integer and will return the char n th times depending on the integer. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1540142134, "post_id": 52917724, "comment_id": 92745590, "body": "Are you using a version of GHC that is not 64-bits? The <code>CPP</code> at the top of the <code>GHC.IntWord64</code> module (from <code>ghc-prim</code>) in which <code>xor64#</code> is defined makes it clear that these functions are only available if <code>WORD_SIZE_IN_BITS &lt; 64</code>..."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1540147840, "post_id": 52917724, "comment_id": 92747224, "body": "Is there some particular reason you can&#39;t just use the regular Data.Bits API on Word64? GHC is quite good at inlining and unboxing numeric code"}, {"owner": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1540192388, "post_id": 52917724, "comment_id": 92757184, "body": "@jberryman, GHC is indeed pretty good at optimizing boxed code into unboxed. The thing I&#39;m trying to do here is test GHCs abilities. I already have a version of the code using the Data.Bits API and I want to compare the generated code to a version written using unboxed primitives."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1540223016, "post_id": 52917724, "comment_id": 92775452, "body": "Okay, as you probably know you can pretty easily see whether these optimizations kick in by looking at core (look for Int#, etc)"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1540142234, "post_id": 52917853, "comment_id": 92745619, "body": "@Alec Are you sure? It isn&#39;t here, and from the source, <code>GHC.Word</code> doesn&#39;t even appear to import <code>GHC.IntWord64</code> on modern architectures."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1540142294, "post_id": 52917853, "comment_id": 92745640, "body": "@Alec Ah, I see what&#39;s going on. Okay, I&#39;ll update my answer."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1540142298, "post_id": 52917853, "comment_id": 92745642, "body": "Yeah. I noticed and commented on the initial q too. <code>GHC.IntWord64</code> exports nothing unless <code>WORD_SIZE_IN_BITS &lt; 64</code>."}, {"owner": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "edited": false, "score": 0, "creation_date": 1540145862, "post_id": 52917853, "comment_id": 92746717, "body": "Thanks. I get the feeling that the primops for Word64# are not exported on 64 bit machines and that I&#39;m expected to just use Word#. If I&#39;m right I think that&#39;s an unfortunate choice by the GHC developers since my code will compile just fine on a 32 bit machine but produce the wrong answer. Oh well, I guess I&#39;ll just have to write something about it in the documentation."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "edited": false, "score": 0, "creation_date": 1540148240, "post_id": 52917853, "comment_id": 92747350, "body": "@svenningsson You can do what GHC does: use #if to differentiate."}, {"owner": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "edited": false, "score": 0, "creation_date": 1540192444, "post_id": 52917853, "comment_id": 92757209, "body": "@DanielWagner indeed I can do that. Though if the primitives for Word64# had been exported, I wouldn&#39;t have had to."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "edited": false, "score": 0, "creation_date": 1540209369, "post_id": 52917853, "comment_id": 92766718, "body": "@svenningsson Yes, you would have still had to: there ain&#39;t no Word64# on 64-bit machines!"}, {"owner": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "edited": false, "score": 0, "creation_date": 1540535296, "post_id": 52917853, "comment_id": 92909303, "body": "@DanielWagner, Word64# does actually exist on 64-bit machines. Try the following: id64 :: Word64# -&gt; Word64#; id64 x = x. It compiles just fine. Too bad I can&#39;t do anything with values of the type..."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1540143180, "last_edit_date": 1540143180, "creation_date": 1540141850, "answer_id": 52917853, "question_id": 52917724, "link": "https://stackoverflow.com/questions/52917724/how-do-i-get-access-to-xor64/52917853#52917853", "title": "How do I get access to xor64#", "body": "<p>The <a href=\"http://hackage.haskell.org/package/ghc-prim\" rel=\"nofollow noreferrer\"><code>ghc-prim</code></a> package offers access to these low-level primitives.</p>\n\n<p>On 64-bit (and higher) machines, <code>xor64#</code> is not used in <code>GHC.Word</code> (and not available from anywhere): it is <code>#if</code>'d out. Instead <code>xor#</code> is used, which is available from <a href=\"http://hackage.haskell.org/package/ghc-prim-0.5.3/docs/GHC-Prim.html\" rel=\"nofollow noreferrer\"><code>GHC.Prim</code></a>.</p>\n\n<p>On lesser machines, <code>xor64#</code> is used and made available from <code>GHC.IntWord64</code>.</p>\n"}], "owner": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52917853, "answer_count": 1, "score": 2, "last_activity_date": 1540143180, "creation_date": 1540140953, "question_id": 52917724, "link": "https://stackoverflow.com/questions/52917724/how-do-i-get-access-to-xor64", "title": "How do I get access to xor64#", "body": "<p>I'm trying to do some programming with unboxed, 64 bit words. Specifically, I'd like to xor values of type <code>Word64#</code>. In the GHC.Word module I can see that the primitive operation <code>xor64#</code> is used for this purpose. But I cannot seem to get access to that operation. I tried to use the exact same import as the GHC.Word module but GHC still gives me an error saying that <code>xor64#</code> is not in scope. What should I import to get access to it?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540141015, "post_id": 52917722, "comment_id": 92745268, "body": "Hint: <code>foldr</code> has a first parameter a function of tye <code>a -&gt; Bool -&gt; a</code>, here you specify that <code>f</code> has type <code>a -&gt; Bool</code>, so it looks like you want as output <code>Bool</code> instead of <code>[a]</code>, and as functio <code>a -&gt; Bool -&gt; Bool</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1540141464, "post_id": 52917722, "comment_id": 92745381, "body": "You say &quot;not sure how [foldr] works when passing a single-argument function&quot;. The answer to that is easy: it <i>doesn&#39;t</i> work."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1540141564, "post_id": 52917722, "comment_id": 92745409, "body": "&quot;<i>how it works when passing a single argument function into foldr and getting a list in return</i>&quot; - by not doing that. Your job in this task is to write an appropriate wrapper function that calls <code>f</code> and operates with a list."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1540143605, "post_id": 52917722, "comment_id": 92745999, "body": "see <code>filtering</code> <a href=\"https://stackoverflow.com/a/52678045/849891\">here</a>. It is related to your problem. You will need to tweak it. (<a href=\"https://stackoverflow.com/a/52034637/849891\">this</a> is also related). disclaimer: both are my answers."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1540195249, "post_id": 52917722, "comment_id": 92758742, "body": "a followup question for you: implement <code>takeUntil p xs</code> which takes elements <code>x</code> from <code>xs</code> until the first <code>p x</code> returns <code>True</code>; including that first successful <code>x</code> in the resulting list as its last element."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 6531041, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9608949f5389592ff98140d22a63367a?s=128&d=identicon&r=PG&f=1", "display_name": "justan0therlurker", "link": "https://stackoverflow.com/users/6531041/justan0therlurker"}, "edited": false, "score": 0, "creation_date": 1540160074, "post_id": 52918752, "comment_id": 92750159, "body": "Thank you Dan! Quick trivial questions: In the result why do you not need to pattern match for [a]? Why do you not pass in the second argument for foldr? By &quot;second argument&quot; I meant the x value in your <code>foldr f x [1,2,3,4]</code> example."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "reply_to_user": {"reputation": 109, "user_id": 6531041, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9608949f5389592ff98140d22a63367a?s=128&d=identicon&r=PG&f=1", "display_name": "justan0therlurker", "link": "https://stackoverflow.com/users/6531041/justan0therlurker"}, "edited": false, "score": 1, "creation_date": 1540189404, "post_id": 52918752, "comment_id": 92755882, "body": "@justan0therlurker I pass <code>[]</code> but don\u2019t really mention it. If you get to the end of the list then the result is <code>[]</code>. Just ask what <code>func p []</code> should be."}, {"owner": {"reputation": 109, "user_id": 6531041, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9608949f5389592ff98140d22a63367a?s=128&d=identicon&r=PG&f=1", "display_name": "justan0therlurker", "link": "https://stackoverflow.com/users/6531041/justan0therlurker"}, "edited": false, "score": 0, "creation_date": 1540221547, "post_id": 52918752, "comment_id": 92774574, "body": "still a bit confused. So when I explicitly pattern match for [a] by doing: <code>func p as = foldr f [] as ...</code> it works the same way. How is it able to infer that the [a] parameter will still be passed into foldr when you don&#39;t explicitly pattern match for it and feed it into foldr?"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "reply_to_user": {"reputation": 109, "user_id": 6531041, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9608949f5389592ff98140d22a63367a?s=128&d=identicon&r=PG&f=1", "display_name": "justan0therlurker", "link": "https://stackoverflow.com/users/6531041/justan0therlurker"}, "edited": false, "score": 0, "creation_date": 1540229027, "post_id": 52918752, "comment_id": 92778474, "body": "In Haskell there is a feature called partial evaluation. Specifically, the following are equivalent (so long as the types are ok): <code>\\x -&gt; f y x</code>, and <code>f y</code>"}], "tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 3, "last_activity_date": 1540152494, "last_edit_date": 1540152494, "creation_date": 1540148040, "answer_id": 52918752, "question_id": 52917722, "link": "https://stackoverflow.com/questions/52917722/using-haskells-foldr/52918752#52918752", "title": "Using Haskell&#39;s foldr", "body": "<p>Let\u2019s do an easier case first, and write a function that uses foldr to do nothing (to break down the list and make a the same list). Let\u2019s look at the type signature of <code>foldr</code>:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>And we want to write an expression of the form</p>\n\n<pre><code>foldr ?1 ?2 :: [a] -&gt; [a]\n</code></pre>\n\n<p>Now this tells us that (in the signature of <code>foldr</code>) we can replace <code>b</code> with <code>[a]</code>.</p>\n\n<p>A thing we haven\u2019t worked out, <code>?2</code>, is what we replace the end of the list with and it has type <code>b = [a]</code>. We don\u2019t really have anything of type <code>a</code> so let\u2019s just try the most stupid thing we can:</p>\n\n<pre><code>foldr ?1 []\n</code></pre>\n\n<p>And now the next missing thing: we have <code>?1 :: a -&gt; [a] -&gt; [a]</code>. Let\u2019s write a function for this. Now there are two reasonable things we can do with a list of things and another thing and nothing else:</p>\n\n<ol>\n<li>Add it to the start</li>\n<li>Add it to the end</li>\n</ol>\n\n<p>I think 1 is more reasonable so let\u2019s try that:</p>\n\n<pre><code>myFunc = foldr (\\x xs -&gt; x : xs) []\n</code></pre>\n\n<p>And now we can try it out:</p>\n\n<pre><code>&gt; myFunc [1,2,3,4]\n[1,2,3,4]\n</code></pre>\n\n<hr>\n\n<p>So what is the intuition for <code>foldr</code> here? Well one way to think of it is that the function passed gets put into your list instead of <code>:</code>, with the other item replacing <code>[]</code> so we get</p>\n\n<pre><code>foldr f x [1,2,3,4]\n\u2014\u2014&gt;\nfoldr f x (1:(2:(3:(4:[]))))\n\u2014\u2014&gt;\nf 1 (f 2 (f 3 (f 4 x)))\n</code></pre>\n\n<p>So how can we do what we want (essentially implement <code>takeWhile</code> with <code>foldr</code>) by choosing our function carefully? Well there are two cases:</p>\n\n<ol>\n<li>The predicate is true on the item being considered</li>\n<li>The predicate is false for the item being considered</li>\n</ol>\n\n<p>In case 1 we need to include our item in the list, and so we can try doing things like we did with our identity function above.</p>\n\n<p>In case 2, we want to not include the item, and not include anything after it, so we can just return <code>[]</code>. </p>\n\n<p>Suppose our function does the right thing for the predicate \"less than 3\", here is how we might evaluate it:</p>\n\n<pre><code>f 1 (f 2 (f 3 (f 4 x)))\n--T    T    F    F   (Result of predicate)\n-- what f should become:\n1 : (2 : ([]         ))\n\u2014\u2014&gt;\n[1,2]\n</code></pre>\n\n<p>So all we need to do is implement <code>f</code>. Suppose the predicate is called <code>p</code>. Then:</p>\n\n<pre><code>f x xs = if p x then x : xs else []\n</code></pre>\n\n<p>And now we can write</p>\n\n<pre><code>func p = foldr f [] where\n  f x xs = if p x then x : xs else []\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 6531041, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9608949f5389592ff98140d22a63367a?s=128&d=identicon&r=PG&f=1", "display_name": "justan0therlurker", "link": "https://stackoverflow.com/users/6531041/justan0therlurker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 52918752, "answer_count": 1, "score": 1, "last_activity_date": 1540152494, "creation_date": 1540140946, "last_edit_date": 1540143312, "question_id": 52917722, "link": "https://stackoverflow.com/questions/52917722/using-haskells-foldr", "title": "Using Haskell&#39;s foldr", "body": "<p>I'm learning Haskell and I've been wrestling with this problem: </p>\n\n<blockquote>\n  <p>Write <code>func :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code> (take elements of a list until the predicate is false) using <code>foldr</code></p>\n</blockquote>\n\n<p>This is what I have so far:</p>\n\n<pre><code>func :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfunc f li = foldr f True li\n</code></pre>\n\n<p>and got the following errors:</p>\n\n<pre><code>Couldn't match expected type \u2018[a]\u2019 with actual type \u2018Bool\u2019\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Couldn't match type \u2018Bool\u2019 with \u2018Bool -&gt; Bool\u2019\nExpected type: a -&gt; Bool -&gt; Bool\nActual type: a -&gt; Bool\n</code></pre>\n\n<p>I'm a bit confused since I learned foldr by passing a function with two arguments and getting a single value. For example I've used the function by calling </p>\n\n<pre><code>foldr (\\x -&gt; \\y -&gt; x*y*5) 1 [1,2,3,4,5] \n</code></pre>\n\n<p>to get a single value but not sure how it works when passing a single argument function into foldr and getting a list in return. Thank you very much.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1540137759, "post_id": 52917139, "comment_id": 92744268, "body": "&quot;Because the output of my function depend not only on the a it receive as input&quot; - unfortunately you can&#39;t do that in Haskell, because it&#39;s referentially transparent. That is, the output value of a function depends only on the parameters passed to it."}, {"owner": {"reputation": 1008, "user_id": 2302508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/t3O8C.png?s=128&g=1", "display_name": "BlackCap", "link": "https://stackoverflow.com/users/2302508/blackcap"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1540137940, "post_id": 52917139, "comment_id": 92744318, "body": "This is true for pure functions, but because this is in the IO monad I can store state between calls. This is what I am doing manually at the moment and are trying to avoid"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1540138695, "last_edit_date": 1540138695, "creation_date": 1540138306, "answer_id": 52917308, "question_id": 52917139, "link": "https://stackoverflow.com/questions/52917139/convert-io-callback-to-infinite-list/52917308#52917308", "title": "Convert IO callback to infinite list", "body": "<p>This is not exactly what you asked for, but it might be enough for your purposes, I think.</p>\n\n<pre><code>magical :: ([a] -&gt; IO ()) -&gt; IO (a -&gt; IO ())\nmagical f = do\n   list &lt;- newIORef []\n   let g x = do\n          modifyIORef list (x:)\n          xs &lt;- readIORef list\n          f xs   -- or (reverse xs), if you need FIFO ordering\n   return g\n</code></pre>\n\n<p>So if you have a function <code>fooHistory :: [a] -&gt; IO ()</code>, you can use</p>\n\n<pre><code>main = do\n   ...\n   foo &lt;- magical fooHistory\n   setHandler foo -- here we have foo :: a -&gt; IO ()\n   ...\n</code></pre>\n\n<p>As @danidaz wrote above, you probably do not need <code>magical</code>, but can play the same trick directly in your <code>fooHistory</code>, modifying a list reference (<code>IORef [a]</code>).</p>\n\n<pre><code>main = do\n   ...\n   list &lt;- newIORef []\n   let fooHistory x = do\n          modifyIORef list (x:)\n          xs &lt;- readIORef list\n          use xs   -- or (reverse xs), if you need FIFO ordering\n   setHandler fooHistory -- here we have fooHistory :: a -&gt; IO ()\n   ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 3, "last_activity_date": 1540153372, "creation_date": 1540153372, "answer_id": 52919525, "question_id": 52917139, "link": "https://stackoverflow.com/questions/52917139/convert-io-callback-to-infinite-list/52919525#52919525", "title": "Convert IO callback to infinite list", "body": "<p>The <code>IORef</code> solution is indeed the simplest one. If you'd like to explore a pure (but more complex) variant, have a look at <a href=\"https://www.schoolofhaskell.com/school/to-infinity-and-beyond/pick-of-the-week/conduit-overview\" rel=\"nofollow noreferrer\">conduit</a>. There are other implementations of the same concept, see <a href=\"https://wiki.haskell.org/Iteratee_I/O\" rel=\"nofollow noreferrer\">Iteratee I/O</a>, but I found myself <em>conduit</em> to be very easy to use.</p>\n\n<p>A conduit (AKA pipe) is an abstraction of of program that can accept input and/or produce output. As such, it can keep internal state, if needed. In your case, <code>magical</code> would be a <em>sink</em>, that is, a conduit that accepts input of some type, but produces no output. By wiring it into a <em>source</em>, a program that produces output, you complete the pipeline and then ever time the sink asks for an input, the source is run until it produces its output.</p>\n\n<p>In your case you'd have roughly something like</p>\n\n<pre><code>magical :: Sink a IO () -- consumes a stream of `a`s, no result\nmagical = go (some initial state)\n  where\n    go state = do\n      m'input &lt;- await\n      case m'input of\n        Nothing -&gt; return ()  -- finish\n        Just input -&gt; do\n          -- do something with the input\n          go (some updated state)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1008, "user_id": 2302508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/t3O8C.png?s=128&g=1", "display_name": "BlackCap", "link": "https://stackoverflow.com/users/2302508/blackcap"}, "is_accepted": false, "score": 2, "last_activity_date": 1540162644, "creation_date": 1540162644, "answer_id": 52920620, "question_id": 52917139, "link": "https://stackoverflow.com/questions/52917139/convert-io-callback-to-infinite-list/52920620#52920620", "title": "Convert IO callback to infinite list", "body": "<p><code>Control.Concurrent.Chan</code> does almost exactly what I wanted!</p>\n\n<pre><code>import Control.Monad           (forever)\nimport Control.Concurrent      (forkIO)\nimport Control.Concurrent.Chan\n\n\nsetHandler :: (Char -&gt; IO ()) -&gt; IO ()\nsetHandler f = void . forkIO . forever $ getChar &gt;&gt;= f\n\nprocess :: String -&gt; IO ()\nprocess ('h':'i':xs) = putStrLn \"hi\" &gt;&gt; process xs\nprocess ('a':xs)     = putStrLn \"a\" &gt;&gt; process xs\nprocess (x:xs)       = process xs\nprocess _            = error \"Guaranteed to be infinite\"\n\n\nmain :: IO ()\nmain = do\n  c &lt;- newChan\n  setHandler $ writeChan c\n  list &lt;- getChanContents c\n  process list\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 192, "user_id": 10538387, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MzMyjPapfMw/AAAAAAAAAAI/AAAAAAAAAAo/TGOKilbIRZI/photo.jpg?sz=128", "display_name": "Vanessa McHale", "link": "https://stackoverflow.com/users/10538387/vanessa-mchale"}, "is_accepted": false, "score": 0, "last_activity_date": 1540179138, "creation_date": 1540179138, "answer_id": 52922061, "question_id": 52917139, "link": "https://stackoverflow.com/questions/52917139/convert-io-callback-to-infinite-list/52922061#52922061", "title": "Convert IO callback to infinite list", "body": "<p>This seems like a flaw in the library design to me. You might consider an upstream patch so that you could provide something more versatile as input. </p>\n"}], "owner": {"reputation": 1008, "user_id": 2302508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/t3O8C.png?s=128&g=1", "display_name": "BlackCap", "link": "https://stackoverflow.com/users/2302508/blackcap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 52917308, "answer_count": 4, "score": 2, "last_activity_date": 1540179138, "creation_date": 1540137342, "last_edit_date": 1540137761, "question_id": 52917139, "link": "https://stackoverflow.com/questions/52917139/convert-io-callback-to-infinite-list", "title": "Convert IO callback to infinite list", "body": "<p>I am using a library that I can provide with a function <code>a -&gt; IO ()</code>, which it will call occasionally.</p>\n\n<p>Because the output of my function depends not only on the <code>a</code> it receives as input, but also on the previous <code>a</code>'s, it would be much easier for me to write a function <code>[a] -&gt; IO ()</code>, where <code>[a]</code> is infinite.</p>\n\n<p>Can I write a function:</p>\n\n<pre><code>magical :: ([a] -&gt; IO ()) -&gt; (a -&gt; IO ())\n</code></pre>\n\n<p>That collects the <code>a</code>'s it receives from the callback and passes them to my function as a lazy infinite list?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1540128589, "post_id": 52915806, "comment_id": 92741611, "body": "What if you use <code>compare `on` getCoordBlockY</code> instead of <code>compare `on` (  getCoordPersonY . )</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1540136983, "post_id": 52915806, "comment_id": 92744040, "body": "Is <code>getCoordPersonY</code> a typo for <code>getCoordBlockY</code>? If not, you should include its definition."}], "answers": [{"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1540131761, "post_id": 52915881, "comment_id": 92742519, "body": "Also, <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ord.html#v:comparing\" rel=\"nofollow noreferrer\"><code>comparing</code></a> <code>= on compare</code>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1540131906, "last_edit_date": 1540131906, "creation_date": 1540129038, "answer_id": 52915881, "question_id": 52915806, "link": "https://stackoverflow.com/questions/52915806/sorting-a-custom-data-type/52915881#52915881", "title": "Sorting a custom data type", "body": "<p>I think you have some misunderstanding on how <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Function.html#v:on\" rel=\"nofollow noreferrer\"><strong><code>on :: (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c</code></strong></a>, <code>on</code> basically is implemented like:</p>\n\n<pre><code>on :: (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c\non f g x y = f (g x) (g y)\n</code></pre>\n\n<p>This function thus \"preprocesses\" the values with a function <code>g :: a -&gt; b</code>, and then calls <code>f</code> on the two preprocessed parameters.</p>\n\n<p>If you thus write:</p>\n\n<pre><code>on compare getCoordBlockY :: Person -&gt; Person -&gt; Ordering\n</code></pre>\n\n<p>you thus first obtain the <em>y</em>-coordinate of the two <code>Person</code> objects, and then compare these.</p>\n\n<p>You thus can implement your sorting function like:</p>\n\n<pre><code>sortPersons :: [Person] -&gt; [Person]\nsortPersons = sortBy (on compare getCoordPersonY)\n</code></pre>\n\n<p>As <a href=\"https://stackoverflow.com/questions/52915806/sorting-a-custom-data-type/52915881?noredirect=1#comment92742519_52915881\">@Bergi</a> comments, you can also use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ord.html#v:comparing\" rel=\"nofollow noreferrer\"><strong><code>comparing :: Ord b =&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; Ordering</code></strong></a>, which is defined as:</p>\n\n<pre><code>comparing :: Ord b =&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; Ordering\ncomparing = on compare\n</code></pre>\n\n<p>so a shorter version of <code>sortPersons</code> is:</p>\n\n<pre><code>sortPersons :: [Person] -&gt; [Person]\nsortPersons = sortBy (comparing getCoordPersonY)\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 9715006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb905e7fb1642526f814464beb1755c?s=128&d=identicon&r=PG&f=1", "display_name": "swaffelay", "link": "https://stackoverflow.com/users/9715006/swaffelay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540131906, "creation_date": 1540128520, "last_edit_date": 1540131043, "question_id": 52915806, "link": "https://stackoverflow.com/questions/52915806/sorting-a-custom-data-type", "title": "Sorting a custom data type", "body": "<p>So I would like to sort a list of persons comparing them on the second element of the tuple.</p>\n\n<pre><code>import Data.List (sortBy)\nimport Data.Function (on)\nimport Data.Ord (comparing)\n\n\ndata Person = Person (Int, Int) Color deriving (Eq, Show)\n\ngetCoordBlockY :: Person-&gt; Int\ngetCoordBlockY (Person (a,b) _ ) = b\n\nsortPersons :: [Person] -&gt; [Person]\nsortPersons lijst = sortBy (compare `on` (  getCoordPersonY . )) lijst\n</code></pre>\n\n<p>But this doesn't compile. How would I go about doing this in Haskell?\nThanks for the help.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1540123400, "post_id": 52915083, "comment_id": 92740246, "body": "Did you mean to use <code>let</code> instead of <code>&lt;-</code>?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1540123594, "post_id": 52915083, "comment_id": 92740285, "body": "There is no assignment in Haskell. <code>&lt;-</code> isn&#39;t an assignment, and <code>do</code> and <code>return</code> don&#39;t do what similarly named constructs do in other languages. You need a better Haskell tutorial."}, {"owner": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "edited": false, "score": 0, "creation_date": 1540123608, "post_id": 52915083, "comment_id": 92740289, "body": "maybe, I will try it out and see if the result matches my expectation"}, {"owner": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "edited": false, "score": 0, "creation_date": 1540123676, "post_id": 52915083, "comment_id": 92740304, "body": "sry, the <code>return</code> was a copy &amp; paste error from another function... I think let does the trick"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1540123727, "post_id": 52915083, "comment_id": 92740316, "body": "<code>&lt;-</code> is used to &quot;extract&quot; values from a monadish value. In your case (a list function) it could be used to iterate over the elements of a list."}, {"owner": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1540124000, "post_id": 52915083, "comment_id": 92740398, "body": "Yup, <code>let</code> does the trick. @melpomene want to create a real answer or should I just delete the question for my confusion about the syntax?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1540128823, "post_id": 52915083, "comment_id": 92741688, "body": "When starting out, I recommend using <code>&gt;&gt;=</code> et al. explicitly, rather than using <code>do</code> notation. Use <code>do</code> once you understand what benefits it provides."}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1540139580, "post_id": 52917246, "comment_id": 92744843, "body": "I think you meant to write: <b>Stop using <code>do</code> notation. It does not <code>do</code> what you think it does.</b> ;-)"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 1, "last_activity_date": 1540137921, "creation_date": 1540137921, "answer_id": 52917246, "question_id": 52915083, "link": "https://stackoverflow.com/questions/52915083/type-error-when-asigning-tuple-in-do-notation-in-haskell/52917246#52917246", "title": "Type error when asigning tuple in do notation in haskell", "body": "<p>Short answer: <strong>Stop using <code>do</code> notation. It does not do what you think it does.</strong></p>\n\n<p>Long answer:</p>\n\n<p><code>do</code>-notation is being misused here. I won't do a full monad tutorial here, but I'll show you what you should have done, line by line.</p>\n\n<p>Firstly, the line <code>myFold fn lst = do</code> is wrong, because you shouldn't be using <code>do</code>-notation, so let's remove it:</p>\n\n<pre><code>myFold fn lst =\n</code></pre>\n\n<p>Secondly, the line <code>(ast, newLst) &lt;- (fn lst)</code> is misusing a construct in <code>do</code>-notation, namely the arrow. What you <em>actually</em> want is a plain old <code>let</code>-statement, so let's replace that, noting that we also need an accompanying <code>in</code> later.</p>\n\n<pre><code>    let (ast, newLst) = fn lst\n</code></pre>\n\n<p>Thirdly, you need an <code>in</code> when you express the value you want to return:</p>\n\n<pre><code>    in myFold fn newLst ++ [ast]\n</code></pre>\n\n<p>So, all in all:</p>\n\n<pre><code>myFold fn lst =\n    let (ast, newLst) = fn lst\n    in myFold fn newLst ++ [ast]\n</code></pre>\n\n<p>If you want to find out how to <em>properly</em> use <code>do</code>-notation, provided that you understand Monads, there are <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"nofollow noreferrer\">plenty</a> <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow noreferrer\">of tutorials</a> available online. I will not explain this here because this is completely outside the scope of the core issue in this code.</p>\n"}], "owner": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 52917246, "answer_count": 1, "score": 0, "last_activity_date": 1540137921, "creation_date": 1540123139, "last_edit_date": 1540123515, "question_id": 52915083, "link": "https://stackoverflow.com/questions/52915083/type-error-when-asigning-tuple-in-do-notation-in-haskell", "title": "Type error when asigning tuple in do notation in haskell", "body": "<p>This is the haskell code I have:</p>\n\n<pre><code>myFold:: ([a] -&gt; (b, [a])) -&gt; [a] -&gt; [b]\nmyFold fn []  = []\nmyFold fn lst = do\n    (ast, newLst) &lt;- (fn lst)\n    myFold fn newLst ++ [ast]\n</code></pre>\n\n<p>I think everybody who knows haskell will get what I want to do. However this code is wrong and I really don't get why. The compiler complains that the types don't match in the line <code>(ast, newLst) &lt;- (fn lst)</code> and I cannot see what's wrong.. Can somebody point me to how the syntax must be? Also I am pretty sure that there are better ways to do this so please feel free to provide alternatives.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1540119383, "creation_date": 1540119383, "answer_id": 52914551, "question_id": 52914495, "link": "https://stackoverflow.com/questions/52914495/how-to-instantiate-eq-or-any-class-for-a-type-with-different-constructors-hask/52914551#52914551", "title": "How to instantiate Eq (or any class) for a type with different constructors Haskell", "body": "<blockquote>\n  <p>Should I add a comparation between <code>Constructor1</code> and <code>Constructor2</code>. I don't think so, because they could be from different types.</p>\n</blockquote>\n\n<p>Well that is of course up to you, you could specify that <code>Constructor1 i</code> is equal to <code>Constructor2 p</code> given that <code>age p == fromIntegral i</code>, so that <code>Constructor1</code> basically holds an \"age\" and <code>Constructor2</code> is equal that constructor given the age of that person has that age, but that depends on <em>what you</em> consider two equal <code>Example</code>s. As long as your function satisfies the <a href=\"https://en.wikipedia.org/wiki/Equivalence_relation#Definition\" rel=\"noreferrer\"><em>equivalence relation conditions</em></a> there is no problem.</p>\n\n<p>If you do not want any <code>Constructor1</code> object to be equal to <code>Constructor2</code>, you should add a line that returns <code>False</code> in that case:</p>\n\n<pre><code>instance Eq Example where\n    (==) (Constructor1 e1) (Constructor1 e2) = e1 == e2\n    (==) (Constructor2 e1) (Constructor2 e2) = e1 == e2\n    (==) _ _ = False</code></pre>\n\n<p>But you can save you the trouble in that <em>specific</em> case, and just write:</p>\n\n<pre><code>data Example = Constructor1 Integer | Constructor2 Person <b>deriving Eq</b></code></pre>\n\n<p>Haskell then implement an <code>instance Eq</code> automatically, where two <code>Example</code> objects are considered equal given the <em>data constructors</em> are the same, and all the parameters are <em>equal</em>. In all other cases the two objects are considered <em>not</em> equal.</p>\n"}, {"tags": [], "owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "is_accepted": true, "score": 7, "last_activity_date": 1540119852, "last_edit_date": 1540119852, "creation_date": 1540119393, "answer_id": 52914554, "question_id": 52914495, "link": "https://stackoverflow.com/questions/52914495/how-to-instantiate-eq-or-any-class-for-a-type-with-different-constructors-hask/52914554#52914554", "title": "How to instantiate Eq (or any class) for a type with different constructors Haskell", "body": "<blockquote>\n  <p>Should I add a comparation between Constructor1 and Constructor2? </p>\n</blockquote>\n\n<p>You have to, otherwise your implementation of <code>Eq</code> would be incomplete.</p>\n\n<p>After all your cases, just add</p>\n\n<pre><code>(==) _ _ = False\n</code></pre>\n\n<blockquote>\n  <p>I don't think so, because they could be from different types.</p>\n</blockquote>\n\n<p>But they are of the same type, they are both <code>Example</code> values.</p>\n\n<p>So your <code>Eq</code> function needs to be able to compare them.</p>\n\n<p>If you think it makes sense to have a <code>Constructor1 number</code> and a <code>Constructor2 person</code> be equal under some conditions you can write the appropriate predicate to do that. But that seems unusual and you should probably make your own typeclass for this kind of comparison instead of using <code>Eq</code>. If you do use <code>Eq</code>, make sure it satisfies reflexivity, transitivity and symmetry.</p>\n\n<hr>\n\n<p>Also note that for \"boring\" mechanic <code>Eq</code> instances, the compiler can derive them automatically (and it will create the same thing you would have written anyway):</p>\n\n<pre><code>data Example = Constructor1 Integer | Constructor2 Person\n  deriving Eq\n</code></pre>\n\n<p>You can also derive <code>Show</code>.</p>\n\n<p><a href=\"https://www.reddit.com/r/haskell/comments/28gxxz/how_does_deriving_eq_work/\" rel=\"noreferrer\">https://www.reddit.com/r/haskell/comments/28gxxz/how_does_deriving_eq_work/</a></p>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 3, "last_activity_date": 1540119409, "creation_date": 1540119409, "answer_id": 52914555, "question_id": 52914495, "link": "https://stackoverflow.com/questions/52914495/how-to-instantiate-eq-or-any-class-for-a-type-with-different-constructors-hask/52914555#52914555", "title": "How to instantiate Eq (or any class) for a type with different constructors Haskell", "body": "<p>Why don't you just do</p>\n\n<pre><code>data Example = Constructor1 Integer | Constructor2 Person\n    deriving (Eq)\n</code></pre>\n\n<p>? Then the compiler will instantiate <code>Eq</code> for you.</p>\n\n<p>If you want to do it manually, then yes, you should add a case for comparing different constructors. If the standard library didn't do this, then e.g. <code>True == False</code> would throw an exception (<code>True</code> and <code>False</code> are different constructors of the <code>Bool</code> type) and so would <code>\"hello\" == \"\"</code> (<code>\"\"</code> is <code>[]</code> (at type <code>[Char]</code>) and <code>\"hello\"</code> is <code>'h' : \"ello\"</code>, so again you have different constructors (<code>[]</code> and <code>:</code>)).</p>\n\n<p>You can do it like this:</p>\n\n<pre><code>instance Eq Example where\n    (==) (Constructor1 e1) (Constructor1 e2) = e1 == e2\n    (==) (Constructor2 e1) (Constructor2 e2) = e1 == e2\n    (==) _ _ = False\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 10321338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/20Pz7.jpg?s=128&g=1", "display_name": "OnlyDavies", "link": "https://stackoverflow.com/users/10321338/onlydavies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 52914554, "answer_count": 3, "score": 1, "last_activity_date": 1540119852, "creation_date": 1540118970, "question_id": 52914495, "link": "https://stackoverflow.com/questions/52914495/how-to-instantiate-eq-or-any-class-for-a-type-with-different-constructors-hask", "title": "How to instantiate Eq (or any class) for a type with different constructors Haskell", "body": "<p>I have a doubt about this thing.</p>\n\n<p>If I have this type:</p>\n\n<pre><code>data Person = Person {name :: String, age :: Int} \n\ndata Example = Constructor1 Integer | Constructor2 Person\n</code></pre>\n\n<p>I want to instantiate Eq class for Example</p>\n\n<pre><code>instantiate Eq Example where\n(==) (Constructor1 e1) (Constructor1 e2) = e1 ==e2\n(==) (Constructor2 e1) (Constructor2 e2) = e1 == e2\n</code></pre>\n\n<p>We can supposed that I have already instantiated the Eq class for Person, so I can compare Person with Person.</p>\n\n<p>This is the way for instantiate a class with a type with multiple constructors?</p>\n\n<p>And other doubt. Should I add a comparation between Constructor1 and Constructor2. I don't think so, because they could be from different types.</p>\n\n<p>I'm talking about something like this stuff:</p>\n\n<pre><code>(==) (Constructor1 e1) (Constructor2 e2) == \"no idea how to compare Person with Int\"\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1540113461, "post_id": 52913736, "comment_id": 92737726, "body": "You first &quot;order&quot; by the second tuple. Note that <code>groupBy</code> is an &quot;online&quot; algorithm, it only groups &quot;sequences&quot; that satisfy the predicate, it does not look in the &quot;far future&quot; to see if some other element eventually shows up with the same <code>snd</code> item."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1540113521, "post_id": 52913736, "comment_id": 92737740, "body": "If you want this result you need to sort the list. groupBy only merges adjacent elements."}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 5, "last_activity_date": 1540113700, "creation_date": 1540113700, "answer_id": 52913787, "question_id": 52913736, "link": "https://stackoverflow.com/questions/52913736/groupby-on-snd-element-of-tuple/52913787#52913787", "title": "groupBy on snd element of tuple", "body": "<p>Reading in the documentation of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:groupBy\" rel=\"noreferrer\">groupBy</a> we are referred to the documentation of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:group\" rel=\"noreferrer\">group</a>, which states</p>\n\n<blockquote>\n  <p>The group function takes a list and returns a list of lists such that\n  the concatenation of the result is equal to the argument.</p>\n</blockquote>\n\n<p>That's a not very obvious way of saying: \"We only group equal, adjacent elements.\"</p>\n\n<p>So <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:sortBy\" rel=\"noreferrer\">sortBy</a> your list first.</p>\n"}], "owner": {"reputation": 293, "user_id": 9715006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb905e7fb1642526f814464beb1755c?s=128&d=identicon&r=PG&f=1", "display_name": "swaffelay", "link": "https://stackoverflow.com/users/9715006/swaffelay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 52913787, "answer_count": 1, "score": 1, "last_activity_date": 1540113971, "creation_date": 1540113299, "last_edit_date": 1540113971, "question_id": 52913736, "link": "https://stackoverflow.com/questions/52913736/groupby-on-snd-element-of-tuple", "title": "groupBy on snd element of tuple", "body": "<p>So I would like to use <code>groupBy</code> to group my list of tuples based on their <code>snd</code> element. Every tuple with the same <code>snd</code> element should be in the same list</p>\n\n<pre><code>group ::  [(Int,Int)] -&gt; [[(Int,Int)]]\ngroup = groupBy (\\a b -&gt; snd a == snd b) lijst\n</code></pre>\n\n<p>A <code>groupBy</code> of the list <code>[(1,2),(8,9),(5,2),(9,2),(3,9),(1,1)]</code> should return\n<code>[[(1,2),(5,2),(9,2)],[(8,9),(3,9)],[1,1]]</code>.</p>\n\n<p>However it returns  <code>[[(1,2)],[(8,9)],[(5,2),(9,2)],[(3,9)],[(1,1)]]</code>.</p>\n\n<p>How can I make this function work ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1540105193, "post_id": 52912347, "comment_id": 92736020, "body": "There is no way to do this in vanilla Haskell, since there is no expression type."}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 9, "last_activity_date": 1540106528, "last_edit_date": 1540106528, "creation_date": 1540106123, "answer_id": 52912947, "question_id": 52912347, "link": "https://stackoverflow.com/questions/52912347/printing-expressions-rather-than-values-in-haskell/52912947#52912947", "title": "Printing expressions rather than values in haskell", "body": "<p>That's not a thing you can do with the <code>Prelude</code> types, like <code>Int</code> or <code>Integer</code>.  Haskell isn't a language that keeps expressions around at runtime.  But Haskell does make numeric literals polymorphic, and you can always create data types that do keep <em>some</em> representation of the expression around.</p>\n\n<p>Or you can use a library that does all that.  <a href=\"https://hackage.haskell.org/package/simple-reflect-0.3.3\" rel=\"noreferrer\">simple-reflect</a> is one that does that.</p>\n\n<pre><code>Prelude Debug.SimpleReflect.Expr&gt; 1 + 2 :: Expr\n1 + 2\nPrelude Debug.SimpleReflect.Expr&gt; (1 + 2) * 3 :: Expr\n(1 + 2) * 3\n</code></pre>\n\n<p>Note that it works based on implementing all the numeric type class operations, not as textual analysis.  For instance, it does its own pretty-printing:</p>\n\n<pre><code>Prelude Debug.SimpleReflect.Expr&gt; 1 + (2 * 3) :: Expr\n1 + 2 * 3\n</code></pre>\n\n<p>See how it lost the parens there?  That's because they were redundant, and it can pretty-print an identical expression without them.</p>\n\n<p>Even further in this direction, operations that aren't part of the numeric type classes aren't represented in the <code>Expr</code> type, so you get things like this:</p>\n\n<pre><code>Prelude Debug.SimpleReflect.Expr&gt; foldl (+) 0 [1..5] :: Expr\n0 + 1 + 2 + 3 + 4 + 5\n</code></pre>\n\n<p>The <code>foldl</code> is evaluated in its entirety, rather than kept around symbolically.  That's because <code>foldl</code> isn't an operation in any of the numeric type classes, so <code>Expr</code> can't have any instances that preserve it.</p>\n\n<p>So - in general, not possible.  Haskell isn't a language that keeps representations of source expressions around at runtime.  But it <em>is</em> a language that gives you really powerful capabilities for working with new and interesting types, and depending on your needs, maybe that's good enough.</p>\n"}], "owner": {"reputation": 25, "user_id": 10535138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757510090ea7bfff573bff3d4bc36c7c?s=128&d=identicon&r=PG&f=1", "display_name": "user10535138", "link": "https://stackoverflow.com/users/10535138/user10535138"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1540106528, "creation_date": 1540099634, "question_id": 52912347, "link": "https://stackoverflow.com/questions/52912347/printing-expressions-rather-than-values-in-haskell", "title": "Printing expressions rather than values in haskell", "body": "<p>I want to print\n <code>(1+2)</code> \nas an expression rather than its evaluation 3 in Haskell. I have tried print and show options but it is still giving 3 instead of (1+2). </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 4, "creation_date": 1540088157, "post_id": 52911594, "comment_id": 92733837, "body": "I think this kind of optimization is called &quot;fusion&quot; and the compiler will try to do it, but it is tricky in general and an ongoing area of research. <a href=\"https://stackoverflow.com/q/38905369/14955\">stackoverflow.com/q/38905369/14955</a>"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1540088234, "post_id": 52911594, "comment_id": 92733848, "body": "Note that the quoted section says <i>imperative</i> language, so isn\u2019t talking about what Haskell does there. That said, the LYAH snippet is confused\u2014the distinction it\u2019s describing has nothing to do with imperative versus functional programming languages and everything to do with strict vs lazy languages. In any case, your definition of <code>doubleMe</code> isn\u2019t the one LYAH is describing, since your definition has type <code>Num a =&gt; a -&gt; a</code>, but LYAH\u2019s hypothetical function has type <code>Num a =&gt; [a] -&gt; [a]</code>."}, {"owner": {"reputation": 1159, "user_id": 4416430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b90072585437351ddc189b7a89162838?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4416430/james"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1540088553, "post_id": 52911594, "comment_id": 92733891, "body": "@Alexis King I see, so it does do the reduction I thought it did, it just doesn&#39;t go all the way to * 8, it does 2*2*2*x for each element carrying out 3 operations instead of one, and only doing one pass. (I&#39;m a bit daft, should have paid more attention to the next paragraph)."}, {"owner": {"reputation": 1159, "user_id": 4416430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b90072585437351ddc189b7a89162838?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4416430/james"}, "reply_to_user": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1540088802, "post_id": 52911594, "comment_id": 92733924, "body": "@Thilo that&#39;s what I&#39;m interested in, thank you!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1540111186, "post_id": 52911594, "comment_id": 92737198, "body": "Also note that <code>doubleMe</code> operates on lists, not single values, so its code is more complex than <code>\\x -&gt; 2*x</code>, and more likely something like <code>map (\\x -&gt; 2*x)</code>, where <code>map</code> is defined by recursion on lists. In general, it&#39;s not easy to optimize multiple calls to recursive functions away, albeit the compiler might recognize the well-known library function <code>map</code> and perform custom optimizations on that one."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1540116292, "post_id": 52911594, "comment_id": 92738391, "body": "in Haskell, <code>doubleMe doubleMe doubleMe xs</code> is <code>doubleMe(doubleMe)(doubleMe)(xs)</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1540129014, "post_id": 52911594, "comment_id": 92741748, "body": "Your beta reduction makes several invalid simplifications in order to reach your assumed conclusion."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1540130077, "post_id": 52911594, "comment_id": 92742040, "body": "You are confusing <code>doubleMe doubleMe doubleMe xs</code> with <code>doubleMe (doubleMe (doubleMe xs))</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1159, "user_id": 4416430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b90072585437351ddc189b7a89162838?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4416430/james"}, "edited": false, "score": 1, "creation_date": 1540088671, "post_id": 52911648, "comment_id": 92733906, "body": "Yeah I think I did too, but it did leave me wondering if there was a way for haskell to reduce the function all the way down to (\\x.* 8 x) rather than doing (\\x. * 2 * 2 * 2 x) - which is three operations for each element."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1540104959, "post_id": 52911648, "comment_id": 92735980, "body": "This optimization should actually be quite easy for the compiler to do."}], "tags": [], "owner": {"reputation": 20379, "user_id": 497934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba65fe61781731f1b551098a887b4212?s=128&d=identicon&r=PG", "display_name": "Maxpm", "link": "https://stackoverflow.com/users/497934/maxpm"}, "is_accepted": true, "score": 4, "last_activity_date": 1540088302, "creation_date": 1540088302, "answer_id": 52911648, "question_id": 52911594, "link": "https://stackoverflow.com/questions/52911594/how-does-function-evaluation-work-in-haskell/52911648#52911648", "title": "How does function evaluation work in Haskell", "body": "<p>I think you're just misreading that paragraph.  It says (emphasis mine):</p>\n\n<blockquote>\n  <p>If we wanted to multiply our list by 8 <strong>in an imperative language</strong> and did <code>doubleMe(doubleMe(doubleMe(xs)))</code>, it would probably pass through the list once and make a copy and then return it.</p>\n</blockquote>\n\n<p>An imperative language is a language like C or Python.  Not Haskell.</p>\n\n<p>That same paragraph goes on to contrast that behavior with what a \"lazy language\" does:</p>\n\n<blockquote>\n  <p>In a lazy language ... it only does one pass through the list and only when you really need it. That way when you want something from a lazy language you can just take some initial data and efficiently transform and mend it so it resembles what you want at the end.</p>\n</blockquote>\n\n<p>Which is closer to what you expect.  </p>\n"}], "owner": {"reputation": 1159, "user_id": 4416430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b90072585437351ddc189b7a89162838?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4416430/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 52911648, "answer_count": 1, "score": 1, "last_activity_date": 1540088302, "creation_date": 1540087612, "question_id": 52911594, "link": "https://stackoverflow.com/questions/52911594/how-does-function-evaluation-work-in-haskell", "title": "How does function evaluation work in Haskell", "body": "<p>I felt my knowledge of functional programming was a bit lacking so I decided to look online and follow a tutorial to get better when I cam across <a href=\"http://learnyouahaskell.com/introduction\" rel=\"nofollow noreferrer\">this</a> where it states on the first page </p>\n\n<blockquote>\n  <p>\"Say you have an immutable list of numbers xs = [1,2,3,4,5,6,7,8] and\n  a function doubleMe which multiplies every element by 2 and then\n  returns a new list. If we wanted to multiply our list by 8 in an\n  imperative language and did doubleMe(doubleMe(doubleMe(xs))), it would\n  probably pass through the list once and make a copy and then return\n  it. Then it would pass through the list another two times and return\n  the result.\"</p>\n</blockquote>\n\n<p>From my knowledge of functional programming this seems wrong, let me show you why:</p>\n\n<pre><code>doubleMe = (\\x.* 2 x)\n</code></pre>\n\n<p>so </p>\n\n<pre><code>doubleMe doubleMe doubleMe xs\n</code></pre>\n\n<p>would beta reduce to:</p>\n\n<pre><code>(\\x.* 2 x) doubleMe doubleMe xs -&gt;beta\n(* 2 doubleMe) doubleMe xs \n(* 2 (\\x.* 2 x)) doubleMe xs -&gt;eta\n(\\x.* 2 * 2 x) doubleMe  xs -&gt;beta\n(* 2 * 2 doubleMe)  xs\n(* 2 * 2 (\\x.* 2 x)) xs -&gt;eta\n(\\x.* 2 * 2 * 2 x) xs -&gt;beta\n(* 2 * 2 * 2 xs) -&gt;beta\n(* 4 * 2 xs) -&gt; beta\n(* 8 xs)\n</code></pre>\n\n<p>which means the function is beta equivalent to (\\x. * 8 x)</p>\n\n<p>I was under the impression the Haskell compiler carried out this reduction prior to execution, meaning no, it wouldn't make 3 passes over the list like this tutorial suggested, it would only make one. Am I wrong? If so then why doesn't Haskell do this? Surely it would make large improvements to performance.</p>\n"}, {"tags": ["haskell", "asynchronous", "io"], "owner": {"reputation": 4369, "user_id": 3102935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/22985d9fffff3b76a11b1f2bccbf2f42?s=128&d=identicon&r=PG&f=1", "display_name": "WorldSEnder", "link": "https://stackoverflow.com/users/3102935/worldsender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1540125439, "creation_date": 1540082285, "last_edit_date": 1540125439, "question_id": 52911221, "link": "https://stackoverflow.com/questions/52911221/how-to-use-aio-read3-in-haskell", "title": "How to use aio_read(3) in Haskell?", "body": "<p>In Linux one is able to asynchronously read from a file by calling <a href=\"http://man7.org/linux/man-pages/man3/aio_read.3.html\" rel=\"nofollow noreferrer\">aio_read(3)</a> from C. A <a href=\"http://man7.org/linux/man-pages/man7/sigevent.7.html\" rel=\"nofollow noreferrer\">sigevent</a> structure is one of the parameters and there are different options one can specify to be notified when the operation is complete. Let me summarize:</p>\n\n<ul>\n<li><p><strong>SIGEV_NONE</strong> no notification.</p>\n\n<p>The status can be checked with aio_error(3). The operation is async, but completion must be busily awaited in some loop which is not what I want.</p></li>\n<li><p><strong>SIGEV_SIGNAL</strong> a signal is raised to the process.</p>\n\n<p>In theory, this can be caught in Haskell by installing a signal handler via <a href=\"https://hackage.haskell.org/package/unix-2.7.2.2/docs/System-Posix-Signals.html#t:SignalInfo\" rel=\"nofollow noreferrer\">System.Posix.Signals</a>. There is a problem though: the API of <code>SignalInfo</code> doesn't include the crucial <code>si_value</code> that let's one communicate some specifics about the read request, like a <code>StaticPtr</code>. This is unfortunate.</p></li>\n<li><p><strong>SIGEV_THREAD</strong> this would start a new thread, according to the documentation.</p>\n\n<p>I don't know how to represent this in Haskell. My best guess would be an <code>IO ()</code> action. I'm not sure how to write the accompanying native code.</p></li>\n</ul>\n\n<hr>\n\n<p>How can I use <code>aio_read</code> or something of that sort in Haskell? I will probably not get around using FFI on this (or a library).</p>\n"}, {"tags": ["haskell", "tuples"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1540077108, "post_id": 52910840, "comment_id": 92732508, "body": "It looks here that since the <code>T</code>s have no &quot;argument&quot;, there is no &quot;maximum&quot;."}, {"owner": {"reputation": 43, "user_id": 10534572, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e-nJFsJgZ7s/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBptpMuY-tLheOl8oAOurZgVEALdg/mo/photo.jpg?sz=128", "display_name": "killderich111", "link": "https://stackoverflow.com/users/10534572/killderich111"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540079097, "post_id": 52910840, "comment_id": 92732779, "body": "The problem is, at the same time, i&#39;d like to keep the first number as well."}], "answers": [{"tags": [], "owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "is_accepted": false, "score": 4, "last_activity_date": 1540081018, "creation_date": 1540081018, "answer_id": 52911113, "question_id": 52910840, "link": "https://stackoverflow.com/questions/52910840/haskell-finding-maximum-value-in-a-list-of-tuples/52911113#52911113", "title": "Haskell: Finding maximum value in a list of tuples", "body": "<p>Welcome to Stack Overflow.</p>\n\n<p>Use <code>maximumBy (comparing snd)</code>, where <code>maximumBy</code> is from <code>Data.List</code> and <code>comparing</code> is from <code>Data.Ord</code>.</p>\n\n<p>I'll leave it to you to find out what are these functions. <a href=\"http://hackage.haskell.org/package/base\" rel=\"nofollow noreferrer\">Hackage</a> is the place to find out.</p>\n"}], "owner": {"reputation": 43, "user_id": 10534572, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e-nJFsJgZ7s/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBptpMuY-tLheOl8oAOurZgVEALdg/mo/photo.jpg?sz=128", "display_name": "killderich111", "link": "https://stackoverflow.com/users/10534572/killderich111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540116541, "creation_date": 1540077056, "last_edit_date": 1540116541, "question_id": 52910840, "link": "https://stackoverflow.com/questions/52910840/haskell-finding-maximum-value-in-a-list-of-tuples", "title": "Haskell: Finding maximum value in a list of tuples", "body": "<pre><code>[(0,9.1104335791443),(1,11.575836902790225),(2,6.928203230275509),(3,10.816653826391969)] \n</code></pre>\n\n<p>For a list like this one, <code>[(A,T),(A,T),(A,T),(A,T)]</code>, Is there a way I can find the maximum value among the Ts while ignoring the As?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1540061069, "post_id": 52908954, "comment_id": 92728573, "body": "Well you did not define a record type with a field <code>position</code>, so this is expected behavior. You here define <code>position</code> as some sort of &quot;getter&quot;, so even if somehow you can call a &quot;setter&quot; like this, it would not make much sense."}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540061162, "post_id": 52908954, "comment_id": 92728601, "body": "@WillemVanOnsem  don&#39;t understand, I said I defined classes that have a Movable instance (as you can now see in the question&#39;s code)."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1540061238, "post_id": 52908954, "comment_id": 92728619, "body": "A <code>class</code> in Haskell is more what is an &quot;interface&quot; in other programming languages. You here define functions like: <code>position :: m -&gt; Position</code>, so it &quot;converts&quot; a <code>Movable</code> to a <code>Position</code>, not the other way around."}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540061635, "post_id": 52908954, "comment_id": 92728724, "body": "But doesn&#39;t this question look like the one I linked to? @willemVanOnsem"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540061716, "post_id": 52908954, "comment_id": 92728749, "body": "but here you only assign fields defined in the <code>data</code> clause."}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540061938, "post_id": 52908954, "comment_id": 92728815, "body": "@willemvanonsem so there is no way in haskell to get this kind of behavior? A function that works on multiple data types that all have the Movable class?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1540061980, "post_id": 52908954, "comment_id": 92728830, "body": "you can define a &quot;setter&quot; like <code>setPosition -&gt; Position -&gt; m -&gt; m</code> and then call the &quot;setter&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1540120231, "post_id": 52909160, "comment_id": 92739397, "body": "This worked, thank you. As you&#39;ve now twice suggested, I&#39;ll use the parameterised way. I only wanted to also know how to use this approach."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1540062657, "last_edit_date": 1540062657, "creation_date": 1540062317, "answer_id": 52909160, "question_id": 52908954, "link": "https://stackoverflow.com/questions/52908954/invalid-record-selector-and-type-classes/52909160#52909160", "title": "Invalid record selector and type classes", "body": "<p>First, as <a href=\"https://stackoverflow.com/questions/52896071/haskell-inheritance-data-constructors/52896589#52896589\">we already recommended in the other question</a>, you should probably not use <em>any class at all</em> for this problem, but just a parameterised record.</p>\n\n<p>A class is not like in OO that it actually defines a data structure. It just defines some operations that may use <em>values of the instance type</em> to give you something, but that's just a special case. Those values might as well be computed on the fly, and there's generally no way to <em>set</em> them to another value. If you need that, then such a \u201cgetter method\u201d is not sufficient, you also need a \u201csetter\u201d. Idiomatically in modern Haskell, you'd do both in one go: the combination of getter an setter is called a <a href=\"http://hackage.haskell.org/package/lens-4.17/docs/Control-Lens.html\" rel=\"nofollow noreferrer\">lens</a>.</p>\n\n<pre><code>import Control.Lens\n\nclass Movable m where\n  position :: Lens' m Position\n  velocity :: Lens' m Velocity\n\ninstance Movable Player where\n  position f plyr = fmap (\\p -&gt; plyr{playerPosition=p}) . f $ playerPosition plyr\n  velocity f plyr = fmap (\\v -&gt; plyr{playerVelocity=v}) . f $ playerVelocity plyr\n</code></pre>\n\n<p>Then you can write</p>\n\n<pre><code>move :: Movable o =&gt; o -&gt; o\nmove o = o &amp; position .~ (x', y')\n  where (x, y) = o ^. position\n        (vx, vy) = o ^. velocity\n        x' = x + vx\n        y' = y + vy\n</code></pre>\n\n<p>or, shorter with <a href=\"http://hackage.haskell.org/package/vector-space\" rel=\"nofollow noreferrer\">vector-space</a>,</p>\n\n<pre><code>import Data.AffineSpace\n\nmove :: Movable o =&gt; o -&gt; o\nmove o = o &amp; position %~ (.+^ o^.velocity)\n</code></pre>\n"}], "owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "accepted_answer_id": 52909160, "answer_count": 1, "score": 0, "last_activity_date": 1540062657, "creation_date": 1540060896, "last_edit_date": 1540061126, "question_id": 52908954, "link": "https://stackoverflow.com/questions/52908954/invalid-record-selector-and-type-classes", "title": "Invalid record selector and type classes", "body": "<p>I have a class <code>Movable</code> and multiple data types that instance this class. I want to create a generic move function for all these classes as I did below, but apparently my record syntax is incorrect since I get the following error:</p>\n\n<pre><code>src\\Controller.hs:24:13: error:\n    * `position' is not a record selector\n    * In the expression: o {position = (x', y')}\n      In an equation for `move':\n          move o\n            = o {position = (x', y')}\n            where\n                (x, y) = position o\n                (vx, vy) = velocity o\n                x' = x + vx\n                y' = y + vy\n   |\n24 | move o = o {position = (x', y')}\n   |             ^^^^^^^^\n</code></pre>\n\n<p>I tried applying this <a href=\"https://stackoverflow.com/questions/17763438/record-selectors-in-haskells-type-classes\">StackOverflow answer</a>, but I didn't get it to work. <strong>How to fix this? Or are there other ways beside using record syntax to solve this problem?</strong>\nHere you can see my code:</p>\n\n<pre><code>type Position = (Float, Float)\ntype Velocity = (Float, Float)\n\nclass Movable m where\n    position :: m -&gt; Position\n    velocity :: m -&gt; Velocity\n\ndata Player = Player { \n                playerBulletType :: Bullet,\n                playerHealth :: Health,\n                playerMaxVelocity :: MaxVelocity,\n                playerVelocity :: Velocity,\n                playerPosition :: Position,\n                playerSprite :: Sprite\n              }\n\ninstance Movable Player where\n    position = playerPosition\n    velocity = playerVelocity\n\nmove :: Movable o =&gt; o -&gt; o\nmove o = o {position = (x', y')}\n  where (x, y) = position o\n        (vx, vy) = velocity o\n        x' = x + vx\n        y' = y + vy\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1540058349, "post_id": 52908558, "comment_id": 92727787, "body": "Are you sure this is the best way to handle this? What about an <code>[[Int]]</code>? Then clearing the last row, is just &quot;popping&quot; the head of the list, and appending an empty row at the end."}], "answers": [{"tags": [], "owner": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "is_accepted": true, "score": 2, "last_activity_date": 1540058955, "creation_date": 1540058955, "answer_id": 52908649, "question_id": 52908558, "link": "https://stackoverflow.com/questions/52908558/tetris-clearing-full-rows/52908649#52908649", "title": "Tetris clearing full rows", "body": "<p>This is a fairly complicated thing to handle, given the data structure, <code>[(Int, Int)]</code>, used. I'd recommend a more appropriate one.</p>\n\n<p>With that said, there are several stages. Here's one possible way of doing it:</p>\n\n<ol>\n<li>Sort the input list by (y, x) values (you can <code>Data.Tuple.swap</code> the tuples to convert from (x, y)) so that all the elements on each row are next to each other and so that the lower rows are earlier in the list.</li>\n<li>Group the input list by y values so that all the rows are in different sublists.</li>\n<li>Convert the tuples to just x values.</li>\n<li>Filter out any sublists that have 15 elements.</li>\n<li>Reconstitute the tuples by adding the index of each sublist as its elements' y values.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": false, "score": 1, "last_activity_date": 1540061760, "last_edit_date": 1540061760, "creation_date": 1540061390, "answer_id": 52909014, "question_id": 52908558, "link": "https://stackoverflow.com/questions/52908558/tetris-clearing-full-rows/52909014#52909014", "title": "Tetris clearing full rows", "body": "<p>Here is the method we will use:</p>\n\n<ol>\n<li>We fold over the list counting how many items are in each row</li>\n<li>We if any rows are full</li>\n<li>we filter out the co\u00f6rdinates of items in full rows </li>\n</ol>\n\n<p>Intro</p>\n\n<pre><code>import Data.Map as M\n</code></pre>\n\n<p>Step 1</p>\n\n<pre><code>countInRows :: [(Int,Int)] -&gt; M.Map Int Int\ncountInRows items =\n  M.fromListWith (+) [(row,1) | (col,row) &lt;- items]\n</code></pre>\n\n<p>This works by:</p>\n\n<ol>\n<li>converting your list elements into things that say \u201cI know about 1 full square in row <em>n</em>\u201d</li>\n<li>Merging them together by adding up the number of full squares for each row,</li>\n<li>Putting that result into a map associating a row with how full it is</li>\n</ol>\n\n<p>Step 2</p>\n\n<pre><code>isFull :: Int -&gt; M.Map Int Int -&gt; Int -&gt; Bool\nisFull width counts row =\n  M.findWithDefault 0 row counts &gt;= width\n</code></pre>\n\n<p>This will find how full a row is (if it isn\u2019t in the map then it must have 0 full squares). If there are as many full squares as the board is wide then the row must be full.</p>\n\n<p>Step 3 (putting it all together)</p>\n\n<pre><code>import Data.Map as M\nremoveFullRows :: Int -&gt; [(Int,Int)] -&gt; [(Int,Int)]\nremoveFullRows items =\n  filter (not . isFull . row) items where\n  counts = M.fromListWith (+) [(row,1) | (col,row) &lt;- items]\n  isFull row =\n    M.findWithDefault 0 row counts &gt;= width\n  row (x,y) = y\n</code></pre>\n\n<p>We filter out the items by getting the row, seeing if it is full, and if not then we keep the item.</p>\n"}], "owner": {"reputation": 293, "user_id": 9715006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb905e7fb1642526f814464beb1755c?s=128&d=identicon&r=PG&f=1", "display_name": "swaffelay", "link": "https://stackoverflow.com/users/9715006/swaffelay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 52908649, "answer_count": 2, "score": -1, "last_activity_date": 1540061760, "creation_date": 1540058266, "question_id": 52908558, "link": "https://stackoverflow.com/questions/52908558/tetris-clearing-full-rows", "title": "Tetris clearing full rows", "body": "<p>So I am making a tetris game using haskell and I am having troubles implementing the last feature, clearing the full rows and decrementing every tuple above it.</p>\n\n<p>as the bord I am using a list with [(xcoord , ycoord) ] with only the coordinates that are occupied.</p>\n\n<p>I am thinking about checking if the list has 15 (width of the tetris game ) tuples with the same ycoord and so, if this is the case the row is full and everything above the row is gets their ycoord decremented by 1.</p>\n\n<pre><code>removeFullRow :: [(Int,Int)] -&gt; [(Int,Int)]\nremoveFullRow list = ?\n</code></pre>\n\n<p>What is the best way going about this in haskell ?</p>\n\n<p>Thx for the help</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1540056148, "post_id": 52907501, "comment_id": 92727146, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7787317/list-of-different-types\">List of different types?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 1, "last_activity_date": 1540053330, "creation_date": 1540053330, "answer_id": 52907814, "question_id": 52907501, "link": "https://stackoverflow.com/questions/52907501/creating-list-of-values-of-the-same-typeclass-but-different-types/52907814#52907814", "title": "Creating list of values of the same typeclass but different types", "body": "<p>If you just need a few different shapes, you can enumerate each shape as a constructor, here is a example:</p>\n\n<pre><code>data SomeShapes = Triangle {...}\n                  | Square {...}\n\ninstance Shape SomeShapes where \n    area (Triangle x) = ...\n    area (Square x) = ....\n</code></pre>\n\n<p>now you can put them in a list, because they are same type of SomeShapes</p>\n\n<pre><code>[Triangle {...}, Square {...}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1540054035, "last_edit_date": 1540054035, "creation_date": 1540053359, "answer_id": 52907818, "question_id": 52907501, "link": "https://stackoverflow.com/questions/52907501/creating-list-of-values-of-the-same-typeclass-but-different-types/52907818#52907818", "title": "Creating list of values of the same typeclass but different types", "body": "<p>Your wrapped type is probably the best idea.</p>\n\n<p>It can be improved by noting that, in a lazy language like Haskell, the type <code>() -&gt; T</code> essentially works like the plain <code>T</code>. You probably want to delay computation and write stuff like <code>let f = \\ () -&gt; 1+2</code> which does not perform addition until the function <code>f</code> is called with argument <code>()</code>. However, <code>let f = 1+2</code> already does not perform addition until <code>f</code> is really needed by some other expression -- this is laziness.</p>\n\n<p>So, we can simply use</p>\n\n<pre><code>data WrappedShape = WrappedShape {\n    getArea :: Double\n  , getNumVertices :: Integer\n}\n\nwrap s = WrappedShape {\n    getArea = area s\n  , getNumVertices = vertices s\n}\n\nx = [wrap (Triangle (...)), wrap (Square (...))]\n</code></pre>\n\n<p>and forget about passing <code>()</code> later on: when we will access a list element, the area/vertices will be computed (whatever we need). That is <code>print (getArea (head x))</code> will compute the area of the triangle.</p>\n\n<p>The <code>\\ () -&gt; ...</code> trick is indeed needed in eager languages, but in Haskell it is an anti-pattern. Roughly, in Haskell everything has a <code>\\ () -&gt; ...</code> on top, roughly speaking, s o there's no need to add another one.</p>\n\n<hr>\n\n<p>These is another solution to your problem, which is called an \"existential type\". However, this sometimes turns into an <a href=\"https://lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/\" rel=\"nofollow noreferrer\">anti-pattern</a> as well, so I do not recommend to use it lightly.</p>\n\n<p>It would work as follows</p>\n\n<pre><code>data WrappedShape = forall a. Shape a =&gt; WrappedShape a\n\nx = [WrappedShape (Triangle ...), WrappedShape (Square ...)]\n\nexampleUsage = case head x of WrappedShape s -&gt; area s\n</code></pre>\n\n<p>This is more convenient when the type class has a lots of methods, since we do not have to write a lot of fields in the wrapped type.</p>\n\n<p>The main downside of this technique is that it involves more complex type machinery, for no real gain. I mean a basic list <code>[(Double, Integer)]</code> has the same functionality of <code>[WrappedShape]</code> (list of existentials), so why bother with the latter?</p>\n\n<p>Luke Palmer <a href=\"https://lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/\" rel=\"nofollow noreferrer\">wrote</a> about this anti-pattern. I do not agree with that post completely, but I think he does have some good points.</p>\n\n<p>I do not have a clear-cut line where I would start using existentials over the basic approach, but these factors are what I would consider:</p>\n\n<ul>\n<li>How many methods does the type class have?</li>\n<li>Are there any methods of the type class where the type <code>a</code> (the one related to the class) appears not only as an argument? E.g. a method <code>foo :: a -&gt; (String, a)</code>?</li>\n</ul>\n"}], "owner": {"reputation": 61, "user_id": 10533467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d612c08d11ef4d2895329ab9adfa948a?s=128&d=identicon&r=PG&f=1", "display_name": "Nebuchadnezzar", "link": "https://stackoverflow.com/users/10533467/nebuchadnezzar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1540054035, "creation_date": 1540051104, "question_id": 52907501, "link": "https://stackoverflow.com/questions/52907501/creating-list-of-values-of-the-same-typeclass-but-different-types", "title": "Creating list of values of the same typeclass but different types", "body": "<p>I'm new to Haskell and trying to do something which I'm sure is easy but I'm not seeing the right way to do it.</p>\n\n<p>What I want is a list of values of a particular typeclass, but different types of that typeclass.  Eg:</p>\n\n<pre><code>class Shape a where\n  area :: a -&gt; Double\n  numVertices :: a -&gt; Integer\n\ndata Triangle = Triangle {...}\ndata Square = Square {...}\n\ninstance Shape Triangle where ...  \ninstance Shape Square where ...\n\nx = [Triangle (...), Square (...)]\n</code></pre>\n\n<p>I'm getting a compiler error because the list has different types.  What's the right way to do what I'm trying to do here?  The only thing I've been able to come up with is doing something like this:</p>\n\n<pre><code>data WrappedShape = WrappedShape {\n    getArea :: () -&gt; Double\n  , getNumVertices :: () -&gt; Integer\n}\n\nwrap s = WrappedShape {\n    getArea = \\ () -&gt; area s\n  , getNumVertices = \\ () -&gt; vertices s\n}\n\nx = [wrap (Triangle (...)), wrap (Square (...))]\n</code></pre>\n\n<p>This works, but it's heavy on boilerplate, since I have to effectively define Shape twice and with differently-named members.  What's the standard way to do this sort of thing?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 0, "creation_date": 1540056337, "post_id": 52906984, "comment_id": 92727202, "body": "Why doesn&#39;t the infinite loop run in <code>let !x = repeat &quot;&quot; in 1</code>  ?"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 0, "creation_date": 1540056447, "post_id": 52906984, "comment_id": 92727232, "body": "@sof The bang-pattern forces the <i>function</i> (from a <code>Num a</code> dictionary to an <code>a</code>), not the value. Indeed, it <i>can\u2019t</i> force a value, since no value exists\u2014it doesn\u2019t know what <code>a</code> will be. Forcing a function doesn\u2019t cause the function to be invoked, of course, so the bang pattern doesn\u2019t really do anything in that case."}, {"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 0, "creation_date": 1540057174, "post_id": 52906984, "comment_id": 92727444, "body": "in this case <code>let !x = id $ trace &quot;id&quot; &quot;&quot; in 1</code>, the function <code>id</code> is forced to run, why?"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 0, "creation_date": 1540059137, "post_id": 52906984, "comment_id": 92728022, "body": "@sof Because in that case, the RHS of the binding (<code>id $ trace &quot;id&quot; &quot;&quot;</code>) is monomorphic, so it really does just define a value, not a function (assuming you don\u2019t have <code>OverloadedStrings</code> enabled). The critical component to understanding this answer is understanding that a constrained type of the form <code>C x =&gt; a</code> behaves at runtime like a function <code>CDict x -&gt; a</code>, where <code>CDict</code> is the type of method dictionaries for the class <code>C</code>. Forcing this no more runs the body of the function than forcing a function of type <code>Integer -&gt; Integer</code> would."}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 4, "last_activity_date": 1540047663, "creation_date": 1540047663, "answer_id": 52906984, "question_id": 52906878, "link": "https://stackoverflow.com/questions/52906878/simple-examples-to-clarify-on-memoisation-and-strictness/52906984#52906984", "title": "Simple examples to clarify on memoisation and strictness", "body": "<p>You\u2019ve been bitten by the fact that, since GHC 7.8.1, the <a href=\"https://stackoverflow.com/a/32496865/465378\">monomorphism restriction</a> is disabled in GHCi by default. This means that the <code>x</code> binding is generalized to a polymorphic, typeclass-constrained binding with the type</p>\n\n<pre><code>x :: Num a =&gt; a\n</code></pre>\n\n<p>since <code>1</code> is a polymorphic number literal. Even though this type does not include any function arrows (<code>-&gt;</code>), at runtime, it behaves more like a function than as a value, since it is really a function that accepts a <code>Num</code> typeclass dictionary and uses it to construct its result.</p>\n\n<p>You can avoid this by explicitly annotating the literal to avoid the polymorphism:</p>\n\n<pre><code>ghci&gt; let x = trace \"one\" (1 :: Integer) in (x, x)\n(one\n1,1)\nghci&gt; let !x = trace \"one\" (1 :: Integer) in 1\none\n1\n</code></pre>\n\n<p>Normally, the aforementioned monomorphism restriction is in place, precisely to prevent this kind of confusion where a binding that is syntactically a value definition can have its RHS evaluated multiple times. The linked answer describes some of the tradeoffs of the restriction, but if you want, you can switch it back on, which will make your original examples do what you expect:</p>\n\n<pre><code>ghci&gt; :set -XMonomorphismRestriction\nghci&gt; let x = trace \"one\" 1 in (x, x)\n(one\n1,1)\nghci&gt; let !x = trace \"one\" 1 in 1\none\n1\n</code></pre>\n"}], "owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 52906984, "answer_count": 1, "score": 1, "last_activity_date": 1540047663, "creation_date": 1540046932, "question_id": 52906878, "link": "https://stackoverflow.com/questions/52906878/simple-examples-to-clarify-on-memoisation-and-strictness", "title": "Simple examples to clarify on memoisation and strictness", "body": "<p>1.</p>\n\n<pre><code>ghci&gt; let x = trace \"one\" 1 in (x, x)\n\n(one\n1,one\n1)\n</code></pre>\n\n<p>I expected <code>let-expr</code> would memorize <code>x</code>, so the result would look like:</p>\n\n<pre><code>(one\n1,1)\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>ghci&gt; let !x = undefined in 1\n\n...\nerror\n...\n</code></pre>\n\n<p>Ok, strictly evaluated <code>bang-pattern</code>.</p>\n\n<pre><code>ghci&gt; let !x = trace \"one\" 1 in 1\n\n    1\n</code></pre>\n\n<p>Because of the strictness I expected the result would look like:</p>\n\n<pre><code>one\n1\n</code></pre>\n"}, {"tags": ["haskell", "monads", "applicative", "maybe"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1540047214, "post_id": 52906712, "comment_id": 92724554, "body": "I can&#39;t think of anything simpler. I thought about defining a custom <code>&lt;$&gt;</code>-like combinator, but it seems unfeasible because the original expression is parsed as <code>(((appFunc &lt;$&gt; Just 3) &lt;*&gt; Just 1) &lt;*&gt; Just True)</code> so even redefining <code>&lt;$&gt;</code> does not help (unless we want something which only works with arity 3)."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1540047499, "post_id": 52906712, "comment_id": 92724634, "body": "It is perhaps worth mentioning that <code>join</code> <i>is</i> a monad solution: <code>join :: Monad m =&gt; m (m a) -&gt; m a</code>, <code>join mm = mm &gt;&gt;= id</code> and <code>m &gt;&gt;= f = join (f &lt;$&gt; m)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1540059372, "post_id": 52906968, "comment_id": 92728088, "body": "Thanks, the usage of <code>do</code> was a big idiomatic AHA moment!"}], "tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 4, "last_activity_date": 1540048315, "last_edit_date": 1540048315, "creation_date": 1540047546, "answer_id": 52906968, "question_id": 52906712, "link": "https://stackoverflow.com/questions/52906712/question-about-applicative-and-nested-maybe/52906968#52906968", "title": "Question about applicative and nested Maybe", "body": "<p>Why not just</p>\n\n<pre><code>module Main where\n\nimport Data.Bool\n\nappFunc :: Integer -&gt; Integer -&gt; Bool -&gt; Maybe (Integer, Integer)\nappFunc i1 i2 what = bool Nothing (Just (i1,i2)) what\n\nresult = do\n  i1 &lt;- Just 1\n  i2 &lt;- Just 2\n  test &lt;- Just True\n  appFunc i1 i2 test\n\nresult2 = Just 1 &gt;&gt;= \\i1 -&gt; Just 2 &gt;&gt;= \\i2 -&gt; Just True &gt;&gt;= appFunc i1 i2 \n\nmain = do\n  print result\n  print result2\n</code></pre>\n\n<p>Your <code>appFunc</code> is more like a typical <code>monadFunc</code>. As duplode already mentioned, using <code>join</code> is just a monad solution, I just rephrased that into the more idiomatic style.</p>\n\n<p>To get a better intuition of those things, let's look at the signature of the central applicative operation</p>\n\n<pre><code>(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>All three parameters to <code>(&lt;*&gt;)</code> are applicatively wrapped values and <code>(&lt;*&gt;)</code> knows the \"wrapping\" before it needs to peak into it, to do something with them. For example</p>\n\n<pre><code>Just (+1) &lt;*&gt; Just 5\n</code></pre>\n\n<p>here, the calculation involving the \"wrapped\" function <code>(+1)</code> and the \"wrapped\" value <code>5</code> can't alter the \"wrapping\" <code>Just</code> in this case.</p>\n\n<p>Your <code>appFunc</code> on the other hand, needs pure values to produce something in a \"wrapping\". That's not applicative. Here we need to do some calculations with the values, to know, what a constituent part of the \"wrapping\" will be.</p>\n\n<p>Let's look at the central monadic operation:</p>\n\n<pre><code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>Here the second parameter does exactly that. It is a function taking a pure value and returning something in a wrapping. Just like <code>appFunc i1 i2</code>.</p>\n"}], "owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 52906968, "answer_count": 1, "score": 3, "last_activity_date": 1540048315, "creation_date": 1540045719, "last_edit_date": 1540046030, "question_id": 52906712, "link": "https://stackoverflow.com/questions/52906712/question-about-applicative-and-nested-maybe", "title": "Question about applicative and nested Maybe", "body": "<p>I wrote this function:</p>\n\n<pre><code>appFunc :: Integer -&gt; Integer -&gt; Bool -&gt; Maybe (Integer,Integer)\nappFunc i1 i2 b = if b then Just (i1,i2) else Nothing\n</code></pre>\n\n<p>And then I use it as such in GHCi:</p>\n\n<pre><code>&gt; appFunc &lt;$&gt; Just 3 &lt;*&gt; Nothing &lt;*&gt; Just True\nNothing\n</code></pre>\n\n<p>Which is great because if at least one of the parameters is <code>Nothing</code> then the whole expression evaluates to <code>Nothing</code>. However, when all parameters are <code>Just</code> then I get a nested <code>Maybe</code>:</p>\n\n<pre><code>&gt; appFunc &lt;$&gt; Just 3 &lt;*&gt; Just 1 &lt;*&gt; Just False\nJust Nothing\n</code></pre>\n\n<p>Ideally, I would like it to evaluate to plain old <code>Nothing</code>. So my solution was to use <code>join</code>:</p>\n\n<pre><code>&gt; join $ appFunc &lt;$&gt; Just 3 &lt;*&gt; Just 1 &lt;*&gt; Just True\nJust (3,1) \n</code></pre>\n\n<p>Is there a better solution or cleaner style? I was experimenting with the monad <code>&gt;&gt;=</code> function but with no success. For example I tried writing:</p>\n\n<pre><code>&gt; Just True &gt;&gt;= appFunc &lt;$&gt; Just 3 &lt;*&gt; Just 1\n* Couldn't match expected type `Bool -&gt; Maybe b'\n              with actual type `Maybe (Bool -&gt; Maybe (Integer, Integer))'\n* Possible cause: `(&lt;*&gt;)' is applied to too many arguments\n  In the second argument of `(&gt;&gt;=)', namely\n    `appFunc &lt;$&gt; Just 5 &lt;*&gt; Just 4'\n  In the expression: Just True &gt;&gt;= appFunc &lt;$&gt; Just 5 &lt;*&gt; Just 4\n  In an equation for `it':\n      it = Just True &gt;&gt;= appFunc &lt;$&gt; Just 5 &lt;*&gt; Just 4\n* Relevant bindings include\n    it :: Maybe b (bound at &lt;interactive&gt;:51:1)\n</code></pre>\n\n<p>This error makes sense to me because:</p>\n\n<pre><code> appFunc &lt;$&gt; Just 3 &lt;*&gt; Just 1 :: m (a -&gt; m b) \n</code></pre>\n\n<p>whereas <code>&gt;&gt;= :: m a -&gt; (a -&gt; m b) -&gt; m b</code></p>\n\n<p>Is there a monad solution or should I just stick to the applicative style with <code>join</code>?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 618, "user_id": 5753978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0bHl.jpg?s=128&g=1", "display_name": "neallred", "link": "https://stackoverflow.com/users/5753978/neallred"}, "edited": false, "score": 1, "creation_date": 1540042278, "post_id": 52906168, "comment_id": 92723008, "body": "D&#39;oh. It makes perfect sense now. Checking <code>Main.mappend (Nada) (Only [3,4]) == Nada</code> would have made that clear to me. Thanks!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 618, "user_id": 5753978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0bHl.jpg?s=128&g=1", "display_name": "neallred", "link": "https://stackoverflow.com/users/5753978/neallred"}, "edited": false, "score": 2, "creation_date": 1540044534, "post_id": 52906168, "comment_id": 92723730, "body": "@neallred Turning on warnings warns about the issue: &quot;This binding for \u2018mempty\u2019 shadows the existing binding&quot;. Keep warnings enabled to avoid this in the future."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1540041995, "creation_date": 1540041995, "answer_id": 52906168, "question_id": 52906062, "link": "https://stackoverflow.com/questions/52906062/derive-monoid-instance-for-custom-maybe-data-type/52906168#52906168", "title": "Derive monoid instance for custom `Maybe` data type", "body": "<blockquote>\n  <p>Why does it behave like this?</p>\n</blockquote>\n\n<p>Because that is how <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Monoid.html#v:First\" rel=\"nofollow noreferrer\"><strong><code>First</code></strong></a> has been designed. The idea of <code>First</code> is to \"wrap\" a <code>Maybe a</code> value, and to implement the <code>Monoid</code> like:</p>\n\n<pre><code>instance Monoid (First a) where\n    mempty = First Nothing\n    mappend l@(First (Just _)) _ = l\n    mappend _ x = x\n</code></pre>\n\n<p>It thus returns the first <code>First</code> constructor that wrapps a value <code>Just</code> data constructor. This can be useful when we use the <code>mconcat</code>:</p>\n\n<pre><code>Prelude Data.Monoid&gt; mconcat [First Nothing, First (Just 0), First Nothing, First (Just 118), First (Just 999)]\nFirst {getFirst = Just 0}\n</code></pre>\n\n<p>We thus do not use the <code>Monoid (Maybe a)</code> implementation, the <code>First</code> decides how the <code>Monoid</code> looks like. A similar thing happens with <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Monoid.html#v:Sum\" rel=\"nofollow noreferrer\"><strong><code>Sum</code></strong></a> and <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Monoid.html#v:Product\" rel=\"nofollow noreferrer\"><strong><code>Product</code></strong></a></p>\n\n<blockquote>\n  <p>How do I get <code>mappend</code> for <code>Optional</code> to behave like the instance for <code>Maybe</code> that concatenates lists rather than taking the first <code>Only</code> value?</p>\n</blockquote>\n\n<p>There is an <em>error</em> in your definition. You use <code>mempty</code> in the head of a function like:</p>\n\n<pre><code>mappend x <b>mempty</b> = x</code></pre>\n\n<p>is <em>just a variable named <code>mempty</code></em>. So the first line will match <em>everything</em>. You should fix it, like you intend with:</p>\n\n<pre><code>instance Monoid a =&gt; Monoid (Optional a) where\n    mempty = Nada\n    mappend x <b>Nada</b> = x\n    mappend <b>Nada</b> x = x\n    mappend (Only x) (Only y) = Only (Prelude.mappend x y)</code></pre>\n"}], "owner": {"reputation": 618, "user_id": 5753978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0bHl.jpg?s=128&g=1", "display_name": "neallred", "link": "https://stackoverflow.com/users/5753978/neallred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 52906168, "answer_count": 1, "score": 1, "last_activity_date": 1540041995, "creation_date": 1540041292, "question_id": 52906062, "link": "https://stackoverflow.com/questions/52906062/derive-monoid-instance-for-custom-maybe-data-type", "title": "Derive monoid instance for custom `Maybe` data type", "body": "<p>For learning purposes, i am trying to create an <code>Optional</code> data type that mimics <code>Maybe</code> in the typeclass instance of <code>Monoid</code> where</p>\n\n<pre><code>-- Data.Monoid&gt; Prelude.mappend (Just [1,2]) (Just [3,4])\n-- Just [1,2,3,4]\n</code></pre>\n\n<p>Instead, I am getting the behavior of the <code>First</code> instance of <code>Maybe</code> for <code>Monoid</code>.</p>\n\n<pre><code>-- Data.Monoid&gt; (First (Just [1,2])) &lt;&gt; (First (Just [3,4]))\n-- First {getFirst = Just [1,2]}\n</code></pre>\n\n<p>My data type and typeclass instance are:</p>\n\n<pre><code>data Optional a =\n  Nada\n  | Only a\n  deriving (Eq, Show)\n\n instance Monoid a\n  =&gt; Monoid (Optional a) where\nmempty = Nada\nmappend x mempty = x\nmappend mempty (Only x) = Only x\nmappend (Only x) (Only y) = Only (Prelude.mappend x y)\n</code></pre>\n\n<p>My questions are</p>\n\n<ul>\n<li>Why does it behave like this?</li>\n<li>How do I get <code>mappend</code> for <code>Optional</code> to behave like the instance for <code>Maybe</code> that concatenates lists rather than taking the first <code>Only</code> value?</li>\n</ul>\n"}, {"tags": ["haskell", "state-monad"], "answers": [{"tags": [], "owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "is_accepted": false, "score": 2, "last_activity_date": 1540044253, "creation_date": 1540044253, "answer_id": 52906517, "question_id": 52905634, "link": "https://stackoverflow.com/questions/52905634/how-to-hide-state-from-functions-that-call-other-functions-that-use-that-state/52906517#52906517", "title": "How to hide state from functions that call other functions that use that state", "body": "<p>You can't quite \"hide the configuration away\" in the type signature, of course: a plain old function <code>Int -&gt; Int</code> must be referentially transparent, and so it can't also depend on or accept some <code>Config</code> value.</p>\n\n<p>What you probably want to do is something like:</p>\n\n<pre><code>fun2 :: Int -&gt; State Config Int    -- An `Int -&gt; Int` that depends on `Config` state.\n                                   -- Compare to how `Int -&gt; IO Int` is like an\n                                   -- `Int -&gt; Int` function that depends on IO.\nfun2 j = do\n  c1 &lt;- get\n  return (3 * fun c1 j)\n</code></pre>\n\n<p>And then wherever you have a <code>c :: Config</code>,  you can get the result by something like</p>\n\n<pre><code>let result = evalState (fun2 42) c    -- An Int.\n</code></pre>\n\n<hr>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/17325485/combining-statet-io-with-state\">Combining StateT IO with State</a>:</p>\n\n<pre><code>hoistState :: Monad m =&gt; State s a -&gt; StateT s m a\nhoistState = StateT . (return .) . runState\n</code></pre>\n\n<p>Then you can write something like</p>\n\n<pre><code>testB :: StateT Config IO ()\ntestB = do\n    -- Fancy:\n    result &lt;- hoistState (fun2 42)\n\n    -- Equivalent:\n    c &lt;- get\n    let result' = evalState (fun2 42) c\n\n    lift (print (result, result'))\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7375363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027a5697007f5a9719439e9d5906621d?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell learner", "link": "https://stackoverflow.com/users/7375363/haskell-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540044253, "creation_date": 1540038489, "question_id": 52905634, "link": "https://stackoverflow.com/questions/52905634/how-to-hide-state-from-functions-that-call-other-functions-that-use-that-state", "title": "How to hide state from functions that call other functions that use that state", "body": "<p>I would like to have some higher level functions in my Haskell program call other functions that eventually call functions that use some state or configuration, and not have to pass the state around all these function calls. I understand this is a classic use of the state monad (or possibly the Reader monad?). </p>\n\n<p>(I'm also not sure if it should be StateT (as in my example below) to enable doing IO, or if results should somehow be output separately.)</p>\n\n<p>At this stage I'm pretty confused by all the tutorials, blog posts, and similar questions here, and can't pick out the solution. Or have I misunderstood the hiding thing?</p>\n\n<p>Here's a small example:</p>\n\n<pre><code>import Control.Monad.State\n\n-- Here's a simple configuration type:\ndata Config = MkConfig {\n      name :: String\n    , num  :: Int\n    } deriving Show\n\n-- Here's a couple of configurations.\n-- (They're hard coded and pre-defined.)\nc1 = MkConfig \"low\" 7\nc2 = MkConfig \"high\" 10\n\n-- Here's a lower level function that explicitly uses the config.\n-- (The String is ignored here for simplicity, but it could be used.)\nfun :: Config -&gt; Int -&gt; Int\nfun (MkConfig _ i) j = i*j\n\n-- testA and GoA work fine as expected.\n-- fun uses the different configs c1,c2 in the right way.\ntestA = do\n    a &lt;- get\n    lift (print (fun a 2))\n    put c2\n    a &lt;- get\n    lift (print (fun a 4))\n\ngoA = evalStateT testA c1\n-- (c1 could be put at the start of testA instead.)\n\n-- But what I really want is to use fun2 that calls fun, \n-- and not explicitly need state.\n-- But this function definition does not compile:\nfun2 :: Int -&gt; Int\nfun2 j = 3 * fun cf j  \n-- fun needs a config arg cf, but where from?\n\n-- I would like a similar way of using fun2 as in testB and goB here.\ntestB = do\n    a &lt;- get\n    lift (print (fun2 3))  -- but fun2 doesn't take the state in a \n    put c2\n    a &lt;- get\n    lift (print (fun2 42))  -- but fun2 doesn't take the state in a \n\ngoB = evalStateT testB c1 \n</code></pre>\n\n<p>I want to hide the configuration away from the higher level functions like fun2 in my program, while still retaining the ability to change configuration and run those functions with the new configuration. This is a 'how to do it question' (unless I've got the wrong idea completely).</p>\n"}, {"tags": ["swift", "haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 6834, "user_id": 969305, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/907e9d9cf38a8479035a2514f11b55a4?s=128&d=identicon&r=PG", "display_name": "sam-w", "link": "https://stackoverflow.com/users/969305/sam-w"}, "edited": false, "score": 0, "creation_date": 1540042982, "post_id": 52905486, "comment_id": 92723236, "body": "Nice documentation of a nice trick. Two comments: 1) I&#39;d love to see some further explanation of why this is useful, possible applications (maybe built into the code examples) 2) why the use of <code>Maybe</code> as a type when we already have <code>Optional</code>?"}, {"owner": {"reputation": 6932, "user_id": 4149826, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xjN5y.png?s=128&g=1", "display_name": "duan", "link": "https://stackoverflow.com/users/4149826/duan"}, "reply_to_user": {"reputation": 6834, "user_id": 969305, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/907e9d9cf38a8479035a2514f11b55a4?s=128&d=identicon&r=PG", "display_name": "sam-w", "link": "https://stackoverflow.com/users/969305/sam-w"}, "edited": false, "score": 0, "creation_date": 1540045133, "post_id": 52905486, "comment_id": 92723928, "body": "@sjwarner <code>Functor</code> is a concept from functional programming. It is an abstraction of a way to apply a function over or around some structure that we don\u2019t want to alter.  You may heard of <code>Monad</code>, it is a typeclass(protocol) based on <code>Functor</code>."}, {"owner": {"reputation": 6834, "user_id": 969305, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/907e9d9cf38a8479035a2514f11b55a4?s=128&d=identicon&r=PG", "display_name": "sam-w", "link": "https://stackoverflow.com/users/969305/sam-w"}, "edited": false, "score": 0, "creation_date": 1540086858, "post_id": 52905486, "comment_id": 92733681, "body": "Absolutely, that&#39;s a good definition. But I&#39;m assuming that by posting a question and self-answer, you&#39;re seeking to educate existing Swift users. Perhaps you&#39;d see value in editing your question or answer to better convey to any readers not just <i>what</i> a functor is, but also <i>why</i> it&#39;s useful; what real-world problems can it be applied to? :)"}, {"owner": {"reputation": 6932, "user_id": 4149826, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xjN5y.png?s=128&g=1", "display_name": "duan", "link": "https://stackoverflow.com/users/4149826/duan"}, "reply_to_user": {"reputation": 6834, "user_id": 969305, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/907e9d9cf38a8479035a2514f11b55a4?s=128&d=identicon&r=PG", "display_name": "sam-w", "link": "https://stackoverflow.com/users/969305/sam-w"}, "edited": false, "score": 1, "creation_date": 1540105246, "post_id": 52905486, "comment_id": 92736025, "body": "@sjwarner the question is not about functor, it&#39;s about HKT constraint in protocol."}, {"owner": {"reputation": 317, "user_id": 7286194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b346026acd028b9e61ebdf12468c477a?s=128&d=identicon&r=PG&f=1", "display_name": "fantom", "link": "https://stackoverflow.com/users/7286194/fantom"}, "edited": false, "score": 0, "creation_date": 1596294124, "post_id": 52905486, "comment_id": 111768966, "body": "Note that using this approach you cannot prevent container altering, i.e you can write such Functor implementation that maps Array to Maybe for example, which is violation of functor rules (this part <code>associatedtype FA: Functor = Self</code> sets FA default to Self, but doesn&#39;t prevent altering it)"}], "tags": [], "owner": {"reputation": 6932, "user_id": 4149826, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xjN5y.png?s=128&g=1", "display_name": "duan", "link": "https://stackoverflow.com/users/4149826/duan"}, "is_accepted": false, "score": 5, "last_activity_date": 1559465074, "last_edit_date": 1559465074, "creation_date": 1540037304, "answer_id": 52905486, "question_id": 52905485, "link": "https://stackoverflow.com/questions/52905485/how-to-declare-protocol-for-hkt-in-swift/52905486#52905486", "title": "How to declare protocol for HKT in swift?", "body": "<p>Swift does not support HKT as a type form natively, but you can simulate the constraint with a trick of <code>associatedtype</code>:</p>\n\n<pre><code>public protocol Functor {\n    /// (* -&gt; *)\n    associatedtype FA: Functor = Self\n    /// *\n    associatedtype A\n    /// fmap\n    func fmap&lt;B&gt;(_ f: ((A) -&gt; B)) -&gt; FA where FA.A == B\n}\n</code></pre>\n\n<p>And conformance example:</p>\n\n<pre><code>enum Maybe&lt;A&gt; {\n    case just(A)\n    case nothing\n}\n\nextension Maybe: Functor {\n    func fmap&lt;B&gt;(_ transform: ((A) -&gt; B)) -&gt; Maybe&lt;B&gt; {\n        switch self {\n        case .nothing:\n            return .nothing\n        case .just(let v):\n            return .just(transform(v))\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 6932, "user_id": 4149826, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xjN5y.png?s=128&g=1", "display_name": "duan", "link": "https://stackoverflow.com/users/4149826/duan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 3, "answer_count": 1, "score": 5, "last_activity_date": 1559465074, "creation_date": 1540037304, "last_edit_date": 1540115185, "question_id": 52905485, "link": "https://stackoverflow.com/questions/52905485/how-to-declare-protocol-for-hkt-in-swift", "title": "How to declare protocol for HKT in swift?", "body": "<p>In Haskell, when using <code>typeclass</code>, it is easy to declare constraint of its' instances' type kind. </p>\n\n<pre><code>class Functor (f :: * -&gt; *) where\n  ...\n</code></pre>\n\n<p><code>* -&gt; *</code> represents HKT (Higher-Kinded Types), this means any type conforming to <code>Functor</code> must be a HKT. </p>\n\n<p>How can I achieve this with Swift's <code>protocol</code> ? </p>\n"}, {"tags": ["haskell", "maybe", "unwrap"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1540018112, "post_id": 52903151, "comment_id": 92717574, "body": "Well this is just not a good idea. You can add a default value for a <code>Nothing</code>, or you can ignore that line, but then you will get an error in case it is a <code>Maybe</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 4, "creation_date": 1540018483, "post_id": 52903151, "comment_id": 92717646, "body": "Is there a larger problem you\u2019re trying to solve here? If so, could you describe it?"}], "answers": [{"comments": [{"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1540106300, "post_id": 52903215, "comment_id": 92736219, "body": "Very clear Willem! What I actually needed is your example 1. Just don&#39;t want users confronted with Nothing and catch it by using a default value, as you indicated. Also thanks very much for putting this in context and indicate the other options I have."}, {"owner": {"reputation": 1403, "user_id": 1748746, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/ZMrp9.png?s=128&g=1", "display_name": "Anthony Raimondo", "link": "https://stackoverflow.com/users/1748746/anthony-raimondo"}, "edited": false, "score": 0, "creation_date": 1540672882, "post_id": 52903215, "comment_id": 92953961, "body": "What is wrong with restricting Maybe to Monoids? unwrapping Nothing would return mempty"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1403, "user_id": 1748746, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/ZMrp9.png?s=128&g=1", "display_name": "Anthony Raimondo", "link": "https://stackoverflow.com/users/1748746/anthony-raimondo"}, "edited": false, "score": 0, "creation_date": 1540672984, "post_id": 52903215, "comment_id": 92953972, "body": "@AnthonyRaimondo: yes, but then this thus only works for <code>Monoid</code>s, since &quot;raw&quot; <code>Int</code>s are for example not <code>Monoid</code>s (well <code>Sum</code>, and <code>Product</code> are), this would thus result in a lot of wrapping and unwrapping in monoid constructors."}, {"owner": {"reputation": 1403, "user_id": 1748746, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/ZMrp9.png?s=128&g=1", "display_name": "Anthony Raimondo", "link": "https://stackoverflow.com/users/1748746/anthony-raimondo"}, "edited": false, "score": 0, "creation_date": 1540673315, "post_id": 52903215, "comment_id": 92954055, "body": "@Willem Van Onsem makes sense, thanks didnt realize Int was not a monoid!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1540026550, "last_edit_date": 1540026550, "creation_date": 1540018654, "answer_id": 52903215, "question_id": 52903151, "link": "https://stackoverflow.com/questions/52903151/haskell-unwrap-maybe-keep-polymorphism/52903215#52903215", "title": "Haskell unwrap Maybe keep polymorphism", "body": "<p>That is logical. The compiler explects a value of type <code>a</code>, but here there is no value you can provide, since <code>a</code> can be anything (a <code>Bool</code>, <code>Int</code>, <code>[Int]</code>, <code>Maybe Int</code>, etc.).</p>\n\n<p>This is not that much a programming problem, it is more a <em>design</em> problem: what do you want to do in case it is a <code>Nothing</code>? There are some options here:</p>\n\n<ol>\n<li><p>providing a default value, so then the signature is:</p>\n\n<pre><code>fUnwrap :: <b>a -&gt;</b> Maybe a -&gt; a \nfUnwrap <b>_</b> (Just n) = n\nfUnwrap <b>d</b> Nothing = <b>d</b></code></pre></li>\n<li><p>we raise an error in case it is <code>Nothing</code> (we can do this both be leaving the line out, or raising an error explicitly, although in the latter case we can specify a reason):</p>\n\n<pre><code>fUnwrap :: Maybe a -&gt; a\nfUnwrap (Just n) = n\nfUnwrap Nothing = <b>error \"Nothing has no value\"</b></code></pre></li>\n<li><p>we return <code>undefined</code>:</p>\n\n<pre><code>fUnwrap :: Maybe a -&gt; a\nfUnwrap (Just n) = n\nfUnwrap Nothing = <b>undefined</b></code></pre>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:undefined\" rel=\"noreferrer\"><strong><code>undefined :: a</code></strong></a> is an object that raises an error if it is evaluated. It is thus a special case of <code>error</code>, but we \"postpone\" evaluation such that if the value is not necessary, we do not get an error.</p></li>\n</ol>\n\n<p>But personally I think the first approach is advisable here, since function signatures do not specify that these can raise an error, it thus results in code that might fail, without having a hint that it can.</p>\n\n<p>A <code>Maybe a</code> is typically used as the result type of a computation that can \"fail\": in case it succeeds, it returns <code>Just x</code> (with <code>x</code> the result), and otherwise it returns <code>Nothing</code>.</p>\n\n<p>You can use for example <code>do</code> notation to construct a <code>Maybe a</code> out of a chain of computations that can fail. For example:</p>\n\n<pre><code>foo :: Int -&gt; Maybe Int\nfoo x = do\n    y &lt;- someComputation x\n    otherComputation y\n</code></pre>\n\n<p>with here fore example <code>someComputation, otherComputation :: Int -&gt; Maybe Int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1540106080, "post_id": 52903230, "comment_id": 92736165, "body": "I do realize that I can operate on Maybe types, but the point is the output to eg. JSON, XML. I don&#39;t want Just&#39;s and Nothing&#39;s in there, but actually values or &quot; &quot;."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1541177878, "post_id": 52903230, "comment_id": 93140372, "body": "@Madderote in that case use <code>maybe &quot; &quot; show</code>. Always ask directly what you want to know. :)"}], "tags": [], "owner": {"reputation": 9333, "user_id": 85215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d65f736083a06748fb7816b96a3ffd?s=128&d=identicon&r=PG", "display_name": "Jonas H&#248;gh", "link": "https://stackoverflow.com/users/85215/jonas-h%c3%b8gh"}, "is_accepted": false, "score": 3, "last_activity_date": 1540018766, "creation_date": 1540018766, "answer_id": 52903230, "question_id": 52903151, "link": "https://stackoverflow.com/questions/52903151/haskell-unwrap-maybe-keep-polymorphism/52903230#52903230", "title": "Haskell unwrap Maybe keep polymorphism", "body": "<p>This is not possible as your function is written. Since the function is pure, you cannot return an a as your only input is Nothing.</p>\n\n<p>The beauty of Maybe is that you don't need to \"unwrap\" it. You can use the fmap function to operate on the wrapped data only if it exists,  and implicitly do nothing in the Nothing case.</p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 52903215, "answer_count": 2, "score": 0, "last_activity_date": 1540026550, "creation_date": 1540018013, "question_id": 52903151, "link": "https://stackoverflow.com/questions/52903151/haskell-unwrap-maybe-keep-polymorphism", "title": "Haskell unwrap Maybe keep polymorphism", "body": "<p>Haskell beginner here again. If I want to unwrap a <code>Maybe</code> type and want to keep it abstract I would use:</p>\n\n<pre><code>fUnwrap :: Maybe a -&gt; a \nfUnwrap (Just n) = n \nfUnwrap Nothing = ???\n</code></pre>\n\n<p>No matter what I do with <code>Nothing</code>, compiler keeps nagging about being more specific on what to do with <code>Nothing</code>... Can you guys help me out?</p>\n"}, {"tags": ["haskell", "ghc", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1540048622, "post_id": 52904306, "comment_id": 92724999, "body": "Seems <code>:type +v</code> is unavailable in 8.0.2; I get a &quot;parse error on input \u2018+\u2019&quot;. This also doesn&#39;t really answer the question. Is that because the way the order of type variables is determined is subject to change? If it is, then I guess I could always check in ghci before using a value, but I was wondering if I could determine how to apply type values from only looking at documentation."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1540055465, "post_id": 52904306, "comment_id": 92726966, "body": "You can only use type applications on things that have a type signature, and there the order is determined by <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#visible-type-application\" rel=\"nofollow noreferrer\">the order they appear lexically in the type signature</a>.  If GHC has to infer the type (no type annocation around), then there is no guaranteed order \u2013 but you also cannot use such an expression with visible type application."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 3, "creation_date": 1540075934, "post_id": 52904306, "comment_id": 92732349, "body": "I provided an edit that tries to incorporate your comment as part of the answer."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 18, "last_activity_date": 1540078299, "last_edit_date": 1540078299, "creation_date": 1540028401, "answer_id": 52904306, "question_id": 52902067, "link": "https://stackoverflow.com/questions/52902067/how-does-haskell-determine-the-order-of-type-variables-in-implicit-foralls/52904306#52904306", "title": "How does haskell determine the order of type variables in implicit foralls?", "body": "<p>TL;DR: Type variable order is determined by first left-to-right encounter.  When in doubt, use <code>:type +v</code>.</p>\n\n<h3>Don't use <code>:type</code></h3>\n\n<p>Using <code>:type</code> is misleading here. <code>:type</code> infers the type of a whole expression. So when you write <code>:t (,)</code>, the type checker looks at</p>\n\n<pre><code>(,) :: forall a b. a -&gt; b -&gt; (a, b)\n</code></pre>\n\n<p>and instantiates all the forall\u2019s with fresh type variables</p>\n\n<pre><code>(,) :: a1 -&gt; b1 -&gt; (a1, b1)\n</code></pre>\n\n<p>which is necessary if you would apply <code>(,)</code>. Alas, you don\u2019t, so type inference is almost done, and it generalizes over all free variables, and you get, for example,</p>\n\n<pre><code>(,) :: forall {b} {a}. a -&gt; b -&gt; (a, b)\n</code></pre>\n\n<p>This step makes no guarantees over the order of the free variable, and the compiler is free to change.</p>\n\n<p>Also note that it writes <code>forall {a}</code> instead of <code>forall a</code>, which means that you can\u2019t use visible type application here.</p>\n\n<h3>Use <code>:type +v</code></h3>\n\n<p>But of course you can use <code>(,) @Bool</code> \u2013 but here the type-checker treats the first expression differently and does not do this instantiation/generalization step.</p>\n\n<p>And you can get this behaviour in GHCi as well \u2013 <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#ghci-cmd-:type%20+v\" rel=\"noreferrer\">pass <code>+v</code> to <code>:type</code></a>:</p>\n\n<pre><code>:type +v (,)\n(,) :: forall a b. a -&gt; b -&gt; (a, b)\n:type +v (,) @Bool\n(,) @Bool :: forall b. Bool -&gt; b -&gt; (Bool, b)\n</code></pre>\n\n<p>Look, no <code>{\u2026}</code> around type variables!</p>\n\n<h3>Where does this order come from?</h3>\n\n<p>The <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#visible-type-application\" rel=\"noreferrer\">the GHC user's guide section on visible type application</a>  states:</p>\n\n<blockquote>\n  <p>If an identifier\u2019s type signature does not include an explicit forall, the type variable arguments appear in the left-to-right order in which the variables appear in the type. So, foo :: Monad m => a b -> m (a c) will have its type variables ordered as m, a, b, c.</p>\n</blockquote>\n\n<p>That this only applies to things that have an explicit type signature. There is no guaranteed order to variables in inferred types, but you also can't use expressions with inferred types with <code>VisibleTypeApplication</code>.</p>\n"}], "owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 1, "accepted_answer_id": 52904306, "answer_count": 1, "score": 15, "last_activity_date": 1540078299, "creation_date": 1540004738, "last_edit_date": 1592644375, "question_id": 52902067, "link": "https://stackoverflow.com/questions/52902067/how-does-haskell-determine-the-order-of-type-variables-in-implicit-foralls", "title": "How does haskell determine the order of type variables in implicit foralls?", "body": "<p>So I just recently learned about and started using <code>TypeApplications</code>, and was wondering how we can generally know what type variables we're assigning. <a href=\"https://ghc.haskell.org/trac/ghc/wiki/TypeApplication\" rel=\"noreferrer\">The documentation on <code>TypeApplications</code> I found</a> mentions:</p>\n<blockquote>\n<p>What order is used to instantiate the type variables?</p>\n<p>Left-to-right order of the type variables appearing in the foralls. This is the most logical order that occurs when the instantiation is done at the type-variable level. Nested foralls work slightly differently, but at a single forall location with multiple variables, left-to-right order takes place. (See below for nested foralls).</p>\n</blockquote>\n<p>However I haven't found mention of how order of type variables in implicit foralls is determined. I tried looking at different examples with <code>-fprint-explicit-foralls</code> to see if there was a simple pattern, but I'm getting different results in different versions of ghci. :/</p>\n<p>In ghci version 8.0.2, I get:</p>\n<pre><code>&gt; :t (,,)\n(,,) :: forall {c} {b} {a}. a -&gt; b -&gt; c -&gt; (a, b, c)\n</code></pre>\n<p>while in ghci version 8.4.3, I get:</p>\n<pre><code>&gt; :t (,,)\n(,,) :: forall {a} {b} {c}. a -&gt; b -&gt; c -&gt; (a, b, c)\n</code></pre>\n<p>Then again, maybe that's simply a bug in how foralls were being printed in 8.0.2, because otherwise type applications seem to be done right-to-left with the variables of forall, contrary to what the documentation says:</p>\n<pre><code>&gt; :t (,,) @Bool\n(,,) @Bool :: forall {c} {b}. Bool -&gt; b -&gt; c -&gt; (Bool, b, c)\n</code></pre>\n<p>So are type variables put in implicit foralls always in the order they appear first left-to-right in the type body (including the constraints)?</p>\n"}, {"tags": ["haskell", "functional-programming", "algebraic-data-types"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1540021469, "post_id": 52901609, "comment_id": 92718134, "body": "Minor point: don&#39;t call <code>Foo Int</code> and <code>Bar Int</code> types, since they are not. Here, only <code>MyAlgebraicType</code> is a type. Usually, we call <code>Foo</code> and <code>Bar</code> &quot;constructors&quot;. More informally, one can ask &quot;how to determine the form of a value in an algebraic (data) type?&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 3, "last_activity_date": 1540000316, "creation_date": 1540000316, "answer_id": 52901771, "question_id": 52901609, "link": "https://stackoverflow.com/questions/52901609/determining-type-of-algebraic-data-structure/52901771#52901771", "title": "Determining type of algebraic data structure", "body": "<p>Using <code>case</code>:</p>\n\n<pre><code>let var = Bar 42 in\ncase var of\n    Foo _ -&gt; putStrLn \"It's a Foo!\"\n    Bar _ -&gt; putStrLn \"It's a Bar!\"\n</code></pre>\n\n<p>Those <code>_</code> can be replaced with a variable name to bind the <code>Int</code> that is contained.</p>\n\n<p>You can also use a pattern matching definition (which is more common than <code>case</code>):</p>\n\n<pre><code>tellMeIt :: MyAlgebraicType -&gt; IO ()\ntellMeIt (Foo _) = putStrLn \"It's a Foo!\"\ntellMeIt (Bar _) = putStrLn \"It's a Bar!\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1540001769, "post_id": 52901831, "comment_id": 92715556, "body": "An idiom: <code>isBar x = is [ () | Bar{} &lt;- [x] ]</code> (where <code>is = not . null</code>).   Unfortunately it&#39;s a very noisy idiom."}], "tags": [], "owner": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "is_accepted": false, "score": 0, "last_activity_date": 1540001169, "creation_date": 1540001169, "answer_id": 52901831, "question_id": 52901609, "link": "https://stackoverflow.com/questions/52901609/determining-type-of-algebraic-data-structure/52901831#52901831", "title": "Determining type of algebraic data structure", "body": "<p>Pattern matching is usually better, but in some cases, code can be easier to read using functions like these:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>isFoo :: MyAlgebraicType -&gt; Bool\nisFoo (Foo _) = True\nisFoo _       = False\n\nisBar :: MyAlgebraicType -&gt; Bool\nisBar (Bar _) = True\nisBar _       = False\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 7473854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64161a6ba5c289d5c73dcc3563e1641?s=128&d=identicon&r=PG&f=1", "display_name": "cb7", "link": "https://stackoverflow.com/users/7473854/cb7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1540001169, "creation_date": 1539998038, "question_id": 52901609, "link": "https://stackoverflow.com/questions/52901609/determining-type-of-algebraic-data-structure", "title": "Determining type of algebraic data structure", "body": "<p>Suppose <code>data MyAlgebraicType :: Foo Int | Bar Int</code>. If I have a variable of type <code>MyAlgebraicType</code>, how do I determine if it is a <code>Foo Int</code> or a <code>Bar Int</code>?</p>\n"}, {"tags": ["haskell", "arguments", "pattern-matching"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539990756, "post_id": 52900286, "comment_id": 92714044, "body": "Thumb rule: if a guard block does not end with <code>otherwise</code>, then the pattern before the guards likely does not catch all the cases, so it can be ignored when checking exhaustiveness. (Also, turn on warnings, so that you do not have to catch these errors only at runtime)"}], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 7473854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64161a6ba5c289d5c73dcc3563e1641?s=128&d=identicon&r=PG&f=1", "display_name": "cb7", "link": "https://stackoverflow.com/users/7473854/cb7"}, "edited": false, "score": 0, "creation_date": 1539985997, "post_id": 52900334, "comment_id": 92712949, "body": "Oh yeah, that was silly. I didn&#39;t consider that the last of the four &quot;outside&quot; cases itself relied on various cases."}], "tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": true, "score": 4, "last_activity_date": 1539985805, "creation_date": 1539985805, "answer_id": 52900334, "question_id": 52900286, "link": "https://stackoverflow.com/questions/52900286/non-exhaustive-patterns-in-haskell-function/52900334#52900334", "title": "&quot;Non-exhaustive patterns&quot; in Haskell function", "body": "<p>You have actually covered six cases, because the fourth case you mention has three different guards:</p>\n\n<ul>\n<li>Both are empty</li>\n<li>A is empty</li>\n<li>B is empty</li>\n<li>Neither are empty, and the first elements are the same</li>\n<li>Neither are empty, and A is longer</li>\n<li>Neither are empty, and B is longer</li>\n</ul>\n\n<p>You are missing:</p>\n\n<ul>\n<li>Neither are empty, the first elements are unequal, and they are the same length</li>\n</ul>\n\n<p>And that last one is exactly the case for <code>\"abc\"</code> and <code>\"bca\"</code></p>\n"}], "owner": {"reputation": 363, "user_id": 7473854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f64161a6ba5c289d5c73dcc3563e1641?s=128&d=identicon&r=PG&f=1", "display_name": "cb7", "link": "https://stackoverflow.com/users/7473854/cb7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 52900334, "answer_count": 1, "score": 0, "last_activity_date": 1539985805, "creation_date": 1539985483, "question_id": 52900286, "link": "https://stackoverflow.com/questions/52900286/non-exhaustive-patterns-in-haskell-function", "title": "&quot;Non-exhaustive patterns&quot; in Haskell function", "body": "<p>In the following Haskell function:</p>\n\n<pre><code>allTransformations :: String -&gt; String -&gt; [Transformation]\nallTransformations \"\" \"\" = []\nallTransformations a \"\" = [map (\\a -&gt; Delete a) a]\nallTransformations \"\" b = [map (\\b -&gt; Insert b) b]\nallTransformations (x:xs) (y:ys)\n    | x == y = map (\\t -&gt; (Copy x) : t) rest\n    | (length xs) &lt; (length ys) = (map (\\t -&gt; (Insert y) : t) rest) ++ (map (\\t -&gt; (Change x y) : t) rest)\n    | (length xs) &gt; (length ys) = (map (\\t -&gt; (Delete x) : t) rest) ++ (map (\\t -&gt; (Change x y) : t) rest)\n    where rest = allTransformations xs ys\n</code></pre>\n\n<p>When running <code>allTransformations \"abc\" \"bca\"</code> I get the error \"Non-exhaustive patterns in function allTransformations\". Where is the problem?</p>\n\n<p>I've covered four cases: both arguments are empty strings, the second argument is empty and the first is not, the first argument is empty and the second is not, and neither argument is empty.</p>\n\n<p>This is all the possible cases, right?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539984190, "post_id": 52900056, "comment_id": 92712415, "body": "Hint: <code>isPrefixOf</code> is just a function, so you can use it with <code>isPrefoxOf n x</code>, or <code>n `isPrefixOf` x</code>."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1539984794, "last_edit_date": 1539984794, "creation_date": 1539984470, "answer_id": 52900129, "question_id": 52900056, "link": "https://stackoverflow.com/questions/52900056/taking-an-input-string-and-return-a-string-list-of-only-the-words-that-start-wit/52900129#52900129", "title": "Taking an input string and return a string list of only the words that start with &quot;ba&quot;?", "body": "<p>I think that by using <a href=\"https://www.haskell.org/hoogle/?hoogle=filter\" rel=\"nofollow noreferrer\"><strong><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code></strong></a> here, you make the problem easier.</p>\n\n<p>You can as filter condition use - like in your code <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:isPrefixOf\" rel=\"nofollow noreferrer\"><strong><code>isPrefixOf :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool</code></strong></a>, but you here wrote in in \"infix\" notation, but without writing backticks. You thus can call the function with:</p>\n\n<pre><code>isPrefixOf n x\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>n `isPrefixOf` x\n</code></pre>\n\n<p>A final problem with your code is that you write:</p>\n\n<pre><code>getWords(\"ba\" words(n))\n</code></pre>\n\n<p>Here you seem to call a function with brackets, which is quite common in languages like Java, C++, etc. In Haskell however, a function <code>f</code> is called with a parameter <code>x</code> like <code>f x</code>, so you make a call with:</p>\n\n<pre><code>getWords \"ba\" (words n)\n</code></pre>\n\n<p>If we use <code>filter</code> here, we thus obtain:</p>\n\n<pre><code>allBaWords :: String -&gt; [String]\nallBaWords n = filter (\\x -&gt; isPrefixOf \"ba\" x) (words n)\n</code></pre>\n\n<p>or shorter:</p>\n\n<pre><code>allBaWords :: String -&gt; [String]\nallBaWords = filter (isPrefixOf \"ba\") . words\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1539984783, "creation_date": 1539984783, "answer_id": 52900179, "question_id": 52900056, "link": "https://stackoverflow.com/questions/52900056/taking-an-input-string-and-return-a-string-list-of-only-the-words-that-start-wit/52900179#52900179", "title": "Taking an input string and return a string list of only the words that start with &quot;ba&quot;?", "body": "<p>We can break up the problem into three logical parts:</p>\n\n<ol>\n<li>Separate a string into a list of words.</li>\n<li>Recognize whether a word starts with \"ba\".</li>\n<li>Given a list, get a list of all the elements that satisfy a certain condition (often called a <em>predicate</em>).</li>\n</ol>\n\n<p>Let's start by importing a couple standard modules:</p>\n\n<pre><code>import Data.List (isPrefixOf)\nimport Data.String (words)\n</code></pre>\n\n<p>Let's start with (2):</p>\n\n<pre><code>startsWithBa :: String -&gt; Bool\nstartsWithBa s = -- something using isPrefixOf\n</code></pre>\n\n<p>As others have noted, you have to enclose <code>isPrefixOf</code> in backticks if you want to use it infix (which most people tend to do so it reads nicely).</p>\n\n<p>Now to separate the string into words, we use</p>\n\n<pre><code>words :: String -&gt; [String]\n</code></pre>\n\n<p>To extract just the strings that start with \"ba\", we can use the function</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>I'll let you try to put these pieces together.</p>\n"}], "owner": {"reputation": 1, "user_id": 10480151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae307a0e6f2429c140f431569928d7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Parker", "link": "https://stackoverflow.com/users/10480151/joe-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539984794, "creation_date": 1539983962, "question_id": 52900056, "link": "https://stackoverflow.com/questions/52900056/taking-an-input-string-and-return-a-string-list-of-only-the-words-that-start-wit", "title": "Taking an input string and return a string list of only the words that start with &quot;ba&quot;?", "body": "<p>I'm trying to write a code in which would take a input string say: </p>\n\n<pre><code>I love bacon, but I love bananas more.\n</code></pre>\n\n<p>and return <code>[\"bacon\",\"bananas\"]</code> as output.</p>\n\n<p>However I've ran into some troubles with my code, as I can't seem to properly implement this, currently my idea is that I would input a string and then use <code>word()</code> to split up the string into a string list, and then call getWrods to extract all the words with \"ba\" as their prefix and then return a list composed of words that start with \"ba\" for the main function allWords. </p>\n\n<p>My code is as follows:</p>\n\n<pre><code>getWords:: String -&gt; [String] -&gt; [String]\ngetWords n [] = []\ngetWords n (x:xs)\n | n isPrefixOf x = [x] ++ getWords n xs\n |otherwise = getWords n xs\n\n\nallWordss:: String -&gt; [String]\nallWordss n = getWords(\"ba\" words(n))\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "currying"], "comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1539978210, "post_id": 52898876, "comment_id": 92710350, "body": "Please provide a <a href=\"https://stackoverflow.com/help/mcve\">mcve</a> of the code you want to simplify."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1539979454, "post_id": 52898876, "comment_id": 92710770, "body": "The isomorphism you want between <code>Int -&gt; ... Int -&gt; Int</code> and <code>(Int, ..., Int) -&gt; Int</code> isn&#39;t going to be any prettier than what you are doing now. Somewhere along the line, a bad design decision lead to you needing <code>f</code> to have that type."}, {"owner": {"reputation": 943, "user_id": 1218369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a85c134fa9ef24652bde3dddf082042a?s=128&d=identicon&r=PG", "display_name": "luke", "link": "https://stackoverflow.com/users/1218369/luke"}, "edited": false, "score": 0, "creation_date": 1539979762, "post_id": 52898876, "comment_id": 92710868, "body": "That&#39;s what I was thinking. I didn&#39;t make the design decision for <code>f</code> but have to work with it. Was just hoping there was a way to select all the arguments like in other languages or formulate a function using validate which I could use to make a definition for f without specifying the arguments."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1539980882, "creation_date": 1539980882, "answer_id": 52899485, "question_id": 52898876, "link": "https://stackoverflow.com/questions/52898876/haskell-abbreviating-multiple-parameters-to-a-single-variable/52899485#52899485", "title": "Haskell abbreviating multiple parameters to a single variable", "body": "<p>First, let's rewrite this in a form that looks closer to composing a partial application of <code>filterFirst</code> with a function that actually consumes the <code>t</code> values:</p>\n\n<pre><code>f t1 t2 t3 t4 t5 t6 t7 t8 t9 = let cf = validate t1 t2 t3 t4 t5 t6 t7 t8 t9\n                               in (flip filterFirst) (findAll [1..9]) cf\n</code></pre>\n\n<p><a href=\"http://pointfree.io\" rel=\"nofollow noreferrer\">http://pointfree.io</a> then tells us that the above is equivalent to</p>\n\n<pre><code>f = ((((((((flip filterFirst (findAll [1..9]) .) .) .) .) .) .) .) .) . validate\n</code></pre>\n\n<p>The multiple layers of composition allows us to avoid repeating the <code>t</code> names in the definition.</p>\n\n<p>I wouldn't, however, claim this is an improvement over your explicit version.</p>\n"}], "owner": {"reputation": 943, "user_id": 1218369, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a85c134fa9ef24652bde3dddf082042a?s=128&d=identicon&r=PG", "display_name": "luke", "link": "https://stackoverflow.com/users/1218369/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 52899485, "answer_count": 1, "score": 0, "last_activity_date": 1539980882, "creation_date": 1539977643, "last_edit_date": 1539978925, "question_id": 52898876, "link": "https://stackoverflow.com/questions/52898876/haskell-abbreviating-multiple-parameters-to-a-single-variable", "title": "Haskell abbreviating multiple parameters to a single variable", "body": "<p>So I have a function which <em>has to</em> have a certain type. My implementation is similar to the following:</p>\n\n<pre><code>f :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int\nf t1 t2 t3 t4 t5 t6 t7 t8 t9\n    = filterFirst checkFunc p\n    where\n        p = findAll [1..9]\n        checkFunc = validate t1 t2 t3 t4 t5 t6 t7 t8 t9\n</code></pre>\n\n<p>Now is there any way I could abbreviate the t values to either <em>change validate and then rearrange f</em> or something similar the following:</p>\n\n<pre><code>f :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int\nf ts\n    = filterFirst checkFunc p\n    where\n        p = findAll [1..9]\n        checkFunc = validate ts\n</code></pre>\n\n<p>A way to make this look cleaner would be amazing.</p>\n\n<p><strong>Edit:</strong> More Detail</p>\n\n<pre><code>validate :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; [Int] -&gt; Bool\nvalidate t1 t2 t3 t4 t5 t6 t7 t8 t9 is =\n    [t1, t2, t3, t4, t5, t6, t7, t8, t9] == sums is\n\n-- Calculates sums from specific indexes in list\nsums :: [Int] -&gt; [Int]\n\n-- from https://stackoverflow.com/a/28904773/1218369\nfilterFirst :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n\n-- Find all possible permutations\nfindAll :: [a] -&gt; [[a]]\n-- Basically Data.List (permutations)\n</code></pre>\n\n<p>The problem is f must have the values passed as parameters. I was looking and even some function that takes any number of parameters and produces a list would be helpful but I can't seem to find any module with such function.</p>\n"}, {"tags": ["haskell", "data-structures", "clojure", "ocaml", "purely-functional"], "comments": [{"owner": {"reputation": 24733, "user_id": 1822379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/lrflF.jpg?s=128&g=1", "display_name": "Alan Thompson", "link": "https://stackoverflow.com/users/1822379/alan-thompson"}, "edited": false, "score": 0, "creation_date": 1539974654, "post_id": 52898190, "comment_id": 92708906, "body": "Can you describe a use-case for this?  It sounds like you have contradictory goals."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539975961, "post_id": 52898190, "comment_id": 92709437, "body": "Readers still have to block the writer; you can&#39;t risk that a write update will invalidate an index during a read."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539976159, "post_id": 52898190, "comment_id": 92709517, "body": "Or more accurately, an <i>existing</i> read blocks a writer, but a read request cannot preempt a pending write request, to avoid starvation."}, {"owner": {"reputation": 2438, "user_id": 185646, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01cc07930d88f6f16a6dbaa6590942f4?s=128&d=identicon&r=PG", "display_name": "skyde", "link": "https://stackoverflow.com/users/185646/skyde"}, "edited": false, "score": 0, "creation_date": 1539983815, "post_id": 52898190, "comment_id": 92712298, "body": "chepner: the object is immutable and never updated in place. The writer cannot modify it it can only create a new version that share some object with the old version. The reader and the writer will simply lock while updating the pointer that point to the latest version. No lock is needed to use the snapshot after the snapshot is taken."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1540024520, "post_id": 52898190, "comment_id": 92718827, "body": "Why do you need random access? It seems that without it, you could just use one of the several <a href=\"https://stackoverflow.com/q/27933941/1333025\">concurrent queues</a>."}, {"owner": {"reputation": 2438, "user_id": 185646, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01cc07930d88f6f16a6dbaa6590942f4?s=128&d=identicon&r=PG", "display_name": "skyde", "link": "https://stackoverflow.com/users/185646/skyde"}, "edited": false, "score": 0, "creation_date": 1540094361, "post_id": 52898190, "comment_id": 92734597, "body": "yes I need random access, because several reader are reading from different position concurrently."}], "answers": [{"comments": [{"owner": {"reputation": 2438, "user_id": 185646, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01cc07930d88f6f16a6dbaa6590942f4?s=128&d=identicon&r=PG", "display_name": "skyde", "link": "https://stackoverflow.com/users/185646/skyde"}, "edited": false, "score": 0, "creation_date": 1539983941, "post_id": 52898525, "comment_id": 92712337, "body": "thanks a lot luqui, so finger tree are better than clojure PersistentVector?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 2438, "user_id": 185646, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01cc07930d88f6f16a6dbaa6590942f4?s=128&d=identicon&r=PG", "display_name": "skyde", "link": "https://stackoverflow.com/users/185646/skyde"}, "edited": false, "score": 0, "creation_date": 1539987128, "post_id": 52898525, "comment_id": 92713239, "body": "After a little reading, it seems like clojure persistent vectors are just 32-ary trees.  Finger trees will be better at push and pop at both ends; random access should be comparable."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2438, "user_id": 185646, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01cc07930d88f6f16a6dbaa6590942f4?s=128&d=identicon&r=PG", "display_name": "skyde", "link": "https://stackoverflow.com/users/185646/skyde"}, "edited": false, "score": 2, "creation_date": 1540008529, "post_id": 52898525, "comment_id": 92716255, "body": "@skyde, the finger trees in <code>Data.Sequence</code> have fairly bad constant factors. You might be better off eating a (small) logarithmic cost for access to the ends in exchange for better random access from a bushier tree. It all depends on your usage patterns of course."}, {"owner": {"reputation": 2438, "user_id": 185646, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01cc07930d88f6f16a6dbaa6590942f4?s=128&d=identicon&r=PG", "display_name": "skyde", "link": "https://stackoverflow.com/users/185646/skyde"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1540094441, "post_id": 52898525, "comment_id": 92734606, "body": "@dfeuer could you clarify what you mean when you say Data.Sequence have fairly bad constant factors. Do you mean that random access will be slow compared to 32-ary tree ?"}, {"owner": {"reputation": 2438, "user_id": 185646, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01cc07930d88f6f16a6dbaa6590942f4?s=128&d=identicon&r=PG", "display_name": "skyde", "link": "https://stackoverflow.com/users/185646/skyde"}, "edited": false, "score": 1, "creation_date": 1540095265, "post_id": 52898525, "comment_id": 92734698, "body": "Clojure persisten vector cannot be used as a queue because subseq maintains a reference to the entire underlying vector, so none of the items being &quot;popped&quot; from the back will ever be garbage collected :("}, {"owner": {"reputation": 2438, "user_id": 185646, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01cc07930d88f6f16a6dbaa6590942f4?s=128&d=identicon&r=PG", "display_name": "skyde", "link": "https://stackoverflow.com/users/185646/skyde"}, "edited": false, "score": 0, "creation_date": 1540102615, "post_id": 52898525, "comment_id": 92735640, "body": "would using Data.Sequence as a queue cause the same problem when removing element?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1540106336, "post_id": 52898525, "comment_id": 92736227, "body": "No, <code>Data.Sequence</code> shouldn&#39;t suffer from that problem; it doesn&#39;t do slicing. Yes, random access will generally be slower than for a 32ary tree. Also, a tree designed for reasonably efficient pushes and pops from either side is likely slower than one designed for optimal queue performance (when that&#39;s all you need)."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 5, "last_activity_date": 1539975927, "creation_date": 1539975927, "answer_id": 52898525, "question_id": 52898190, "link": "https://stackoverflow.com/questions/52898190/purely-functional-persistent-ring-buffer/52898525#52898525", "title": "Purely functional (persistent) ring buffer", "body": "<p>The <a href=\"http://www.staff.city.ac.uk/~ross/papers/FingerTree.html\" rel=\"noreferrer\">finger tree</a> (in the standard library as <a href=\"http://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Sequence.html\" rel=\"noreferrer\"><code>Data.Sequence</code></a>) is the go-to for persistent random-access sequences.  I think it satisfies your criteria\u2013\u2013random access indexing is <em>O(log n)</em> (more specifically, the log of the index's distance from the edge), the others are <em>O(1)</em>.  I'm not aware of any persistent data structures that do better than that.</p>\n"}], "owner": {"reputation": 2438, "user_id": 185646, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01cc07930d88f6f16a6dbaa6590942f4?s=128&d=identicon&r=PG", "display_name": "skyde", "link": "https://stackoverflow.com/users/185646/skyde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 52898525, "answer_count": 1, "score": 2, "last_activity_date": 1540056803, "creation_date": 1539974179, "last_edit_date": 1540056803, "question_id": 52898190, "link": "https://stackoverflow.com/questions/52898190/purely-functional-persistent-ring-buffer", "title": "Purely functional (persistent) ring buffer", "body": "<p>I would like to implement a ring buffer using purely functional data structure with the following operations</p>\n\n<ul>\n<li>Efficient random access by index  </li>\n<li>Add to front</li>\n<li>Remove from back</li>\n</ul>\n\n<p>The reason for using persistent data structure is because I have one writer thread and several reader thread and I want to avoid the readers blocking the writer.</p>\n\n<p>This can be done easily by having readers thread only hold the lock while taking a snapshot and then using the snapshot for processing.</p>\n\n<p>What are the existing available data structure that support those operation?</p>\n\n<ul>\n<li>Doubly-linked list can't do index lookup efficiently and are O(n)</li>\n<li>Clojure PersistentVector based on Phil Bagwell Ideal Hash Tree, support access by index in log32N and subvec can be used to remove element from the start.</li>\n<li>Hash array mapped trie could also be used by storing integer as key but might not be super efficient.</li>\n</ul>\n\n<p>Which other purely functional data structure could be used in this case?</p>\n"}, {"tags": ["haskell", "http-headers", "servant"], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 2, "last_activity_date": 1539978991, "creation_date": 1539978991, "answer_id": 52899116, "question_id": 52898044, "link": "https://stackoverflow.com/questions/52898044/servant-see-all-request-headers/52899116#52899116", "title": "Servant: see all request headers", "body": "<p>I use <a href=\"https://hackage.haskell.org/package/wai-extra-3.0.24.3/docs/Network-Wai-Middleware-RequestLogger.html#v:mkRequestLogger\" rel=\"nofollow noreferrer\">Network.Wai.Middleware.RequestLogger</a> to log headers for all incoming requests, regardless of which Servant endpoint ends up handling the request.  I've used this to understand under-documented APIs, and for other sorts of debugging.</p>\n"}], "owner": {"reputation": 5, "user_id": 5688494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fffef1061c439b8bd5fa894197061959?s=128&d=identicon&r=PG&f=1", "display_name": "goosetherumfoodle", "link": "https://stackoverflow.com/users/5688494/goosetherumfoodle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 52899116, "answer_count": 1, "score": 0, "last_activity_date": 1539978991, "creation_date": 1539973525, "last_edit_date": 1539973884, "question_id": 52898044, "link": "https://stackoverflow.com/questions/52898044/servant-see-all-request-headers", "title": "Servant: see all request headers", "body": "<p>I know from the documentation that I can do something like the following to capture a specific header:</p>\n\n<pre><code>type MyApi = \"view-my-referer\" :&gt; Header \"from\" Referer :&gt; Get '[JSON] Referer\n</code></pre>\n\n<p>But I'm exploring some webhooks that aren't well documented, and I'd like to just inspect <em>all</em> the headers in the request. </p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539969686, "post_id": 52896768, "comment_id": 92706715, "body": "@ChaiT.Rex Right, that&#39;s why I hoped using the pragmas <code>OVERLAPPING</code> and <code>OVERLAPPABLE</code> would cause the instance where they are necessarily equal to override the instance where they may or may not be."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539971084, "post_id": 52896768, "comment_id": 92707317, "body": "@assembly.jc Because it varies. I may call <code>g</code> to get a <code>D</code> and other times I may call <code>g</code> to get a <code>C</code>. I get the feeling Li-yao Xia may have also misunderstood that."}], "answers": [{"comments": [{"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539974075, "post_id": 52897229, "comment_id": 92708679, "body": "This showed me that I can avoid the use of <code>Proxy</code> by using <code>AllowAmbiguousTypes</code> and <code>TypeApplications</code>, which is great. Thank you. However, I think you misunderstood the main problem. The crux is that I have a function (represented by <code>g</code> in my example) where the definition of each line varies depending on whether a type variable in <code>g</code> matches with a concrete type that&#39;s different in each line. Using your approach, one variable is not enough to determine what definition applies. I could use 2 and instantiate only using concrete types, but it would be many instances and only 2 definitions."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 1, "last_activity_date": 1539969888, "creation_date": 1539969888, "answer_id": 52897229, "question_id": 52896768, "link": "https://stackoverflow.com/questions/52896768/how-to-chose-a-value-of-a-constant-type-based-on-an-unrelated-type/52897229#52897229", "title": "How to chose a value of a constant type based on an unrelated type?", "body": "<p>Here's how we'd do it nowadays with ambiguous types and type applications. Ambiguous types allow you to have class members that don't mention the class parameters (otherwise you can use proxies).</p>\n\n<p>Here <code>c</code> is <code>0</code> if <code>a ~ T</code>, or <code>1</code> if <code>a ~ U</code>:</p>\n\n<pre><code>{-# LANGUAGE AllowAmbiguousTypes, TypeApplications #-}\n\ndata T\ndata U\n\nclass C a where\n  c :: Int\n\ninstance C T where\n  c = 0\n\ninstance C U where\n  c = 1\n\nmain :: IO ()\nmain = print (c @T) &gt;&gt; print (c @U)\n</code></pre>\n\n<p>If you really want to match <em>any</em> type in the event that <code>a</code> is not <code>T</code> (why would you though), you can use overlapping instances (and the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#overlapping-instances\" rel=\"nofollow noreferrer\">GHC manual</a> is the best reference about how they work):</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-} -- in addition to the above\n\ninstance {-# OVERLAPPABLE #-} C a where\n  c = 0\n\nmain = print (c @String)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539971484, "post_id": 52897467, "comment_id": 92707485, "body": "<code>T</code> is interesting :). It&#39;s just a simplified example. I&#39;ll explain how the example is linked to my actual scenario in an edit to the question."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539971583, "post_id": 52897467, "comment_id": 92707537, "body": "@JoL <code>T</code> may be interesting for you, but seems orthogonal to the question of checking type equality -- which is the part you&#39;re actually having difficulty with. So what I&#39;m saying is that whatever you&#39;re doing with <code>T</code>, great, and it can almost certainly be mixed with the technique I&#39;ve shown here without great effort."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539971588, "post_id": 52897467, "comment_id": 92707540, "body": "The relevance lies in that its variable determines the instances used."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539972612, "post_id": 52897467, "comment_id": 92708025, "body": "I&#39;ve added an EDIT to the question explaining how the different things in my example links to my actual scenario."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539972838, "post_id": 52897467, "comment_id": 92708141, "body": "I&#39;m currently reading your example to understand if it applies. I&#39;ve never used <code>Typeable</code> so I&#39;m looking into that."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539974801, "post_id": 52897467, "comment_id": 92708957, "body": "@JoL I&#39;ll be honest, none of what you describe in your edit sounds like it needs type equality checks at all. I think you should consider describing what you&#39;re trying to accomplish in more detail (in a new question) -- it sounds to me like a bog-standard parser-combinator-like approach is going to be right up your alley, and doesn&#39;t require any fancy type shenanigans."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539979192, "post_id": 52897467, "comment_id": 92710678, "body": "Sounds interesting. I figured learning how to do things this way (conditionalizing on a type) would also be generally useful. Maybe later I&#39;ll post a question that&#39;s more specific to my scenario to learn of alternative ways of doing subforms. For now, would you, by chance, know of an alternative that doesn&#39;t depend on <code>Type.Reflection</code>? Turns out the project I&#39;m working on is using <code>base-4.9.1.0</code> from stack&#39;s <code>lts-9.6</code> and <code>Type.Reflection</code> doesn&#39;t appear until <code>4.10.0.0</code>."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539997206, "post_id": 52897467, "comment_id": 92715071, "body": "Got it. I just had to replace <code>testEquality (typeRep @a) (typeRep @b)</code> with <code>eqT @a @b</code>, where <code>eqT</code> is from <code>Data.Typeable</code>. This is great."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1539970821, "creation_date": 1539970821, "answer_id": 52897467, "question_id": 52896768, "link": "https://stackoverflow.com/questions/52896768/how-to-chose-a-value-of-a-constant-type-based-on-an-unrelated-type/52897467#52897467", "title": "How to chose a value of a constant type based on an unrelated type?", "body": "<p>I don't understand what your <code>T</code> class is for. It doesn't appear to actually be used in an interesting/relevant way. But your <code>f</code> can be implemented using equality checks on <code>TypeRep</code>s. For example:</p>\n\n<pre><code>{-# LANGUAGE AllowAmbiguousTypes #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeApplications #-}\n\nimport Data.Type.Equality\nimport Type.Reflection\n\ndata C = C\ndata D = D\n\nf :: forall a b. (Typeable a, Typeable b) =&gt; String\nf = case testEquality (typeRep @a) (typeRep @b) of\n    Just Refl -&gt; \"matched\"\n    _ -&gt; \"didn't match\"\n\ng :: forall a. Typeable a =&gt; IO ()\ng = do\n    putStrLn (f @C @a)\n    putStrLn (f @D @a)\n\nmain = g @D\n</code></pre>\n\n<p>You can of course use proxies in the usual way to avoid ScopedTypeVariables and AllowAmbiguousTypes if that's your preferred way. I've used the new fancy-typed version of <code>Typeable</code>: although we didn't use it above, in the <code>\"matched\"</code> branch of <code>f</code>, not just us but also the typechecker knows that <code>a ~ b</code>.</p>\n"}], "owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 52897467, "answer_count": 2, "score": 0, "last_activity_date": 1539972897, "creation_date": 1539967756, "last_edit_date": 1539972897, "question_id": 52896768, "link": "https://stackoverflow.com/questions/52896768/how-to-chose-a-value-of-a-constant-type-based-on-an-unrelated-type", "title": "How to chose a value of a constant type based on an unrelated type?", "body": "<p>Ok, so I got the following simplified working example before the change I want to make:</p>\n\n<pre><code>data D = D\ndata C = C\n\nclass T a where\n  t :: a\n\ninstance T D where\n  t = D\n\ninstance T C where\n  t = C\n\ng :: T a =&gt; IO a\ng = do\n  return t\n\nmain = (g :: IO D) &gt;&gt; return ()\n</code></pre>\n\n<p>So the problem is that, inside <code>g</code>, I want values of types unrelated <code>a</code> to be chosen based on <code>a</code>. In other words, I want to express that if <code>a</code> is <code>C</code> then some value of yet unmentioned type <code>e</code> will be chosen and if it's not then another value of type <code>e</code> will be chosen. It's basically conditionalizing on arbitrary type equality, like pseudocode <code>if a ~ Bool then \"foo\" else \"bar\"</code>. I tried this like so (using <code>String</code> for the type <code>e</code> in this example):</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE AllowAmbiguousTypes #-}\nimport Data.Proxy\n\nclass F sub1 sub2 where\n  f :: Proxy (sub1, sub2) -&gt; String\n\ninstance {-# OVERLAPPABLE #-} F a b where\n  f _ = \"did not match types\"\n\ninstance {-# OVERLAPPING #-} F a a where\n  f _ = \"matched types\"\n\ndata D = D\ndata C = C\n\nclass T a where\n  t :: a\n\ninstance T D where\n  t = D\n\ninstance T C where\n  t = C\n\ng :: forall a b. (T a, F b a) =&gt; IO a\ng = do\n  putStrLn $ f (Proxy :: Proxy (D, a))\n  putStrLn $ f (Proxy :: Proxy (C, a))\n  return t\n\nmain = (g :: IO D) &gt;&gt; return ()\n</code></pre>\n\n<p>I get the following errors, though:</p>\n\n<pre><code>y.hs:30:14: error:\n    \u2022 Overlapping instances for F D a arising from a use of \u2018f\u2019\n      Matching instances:\n        instance [overlappable] F a b -- Defined at y.hs:10:31\n        instance [overlapping] F a a -- Defined at y.hs:13:30\n      (The choice depends on the instantiation of \u2018a\u2019\n       To pick the first instance above, use IncoherentInstances\n       when compiling the other instance declarations)\n    \u2022 In the second argument of \u2018($)\u2019, namely\n        \u2018f (Proxy :: Proxy (D, a))\u2019\n      In a stmt of a 'do' block: putStrLn $ f (Proxy :: Proxy (D, a))\n      In the expression:\n        do putStrLn $ f (Proxy :: Proxy (D, a))\n           putStrLn $ f (Proxy :: Proxy (C, a))\n           return t\n   |\n30 |   putStrLn $ f (Proxy :: Proxy (D, a))\n   |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n\ny.hs:31:14: error:\n    \u2022 Overlapping instances for F C a arising from a use of \u2018f\u2019\n      Matching instances:\n        instance [overlappable] F a b -- Defined at y.hs:10:31\n        instance [overlapping] F a a -- Defined at y.hs:13:30\n      (The choice depends on the instantiation of \u2018a\u2019\n       To pick the first instance above, use IncoherentInstances\n       when compiling the other instance declarations)\n    \u2022 In the second argument of \u2018($)\u2019, namely\n        \u2018f (Proxy :: Proxy (C, a))\u2019\n      In a stmt of a 'do' block: putStrLn $ f (Proxy :: Proxy (C, a))\n      In the expression:\n        do putStrLn $ f (Proxy :: Proxy (D, a))\n           putStrLn $ f (Proxy :: Proxy (C, a))\n           return t\n   |\n31 |   putStrLn $ f (Proxy :: Proxy (C, a))\n   |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n\ny.hs:34:9: error:\n    \u2022 Overlapping instances for F b0 D arising from a use of \u2018g\u2019\n      Matching instances:\n        instance [overlappable] F a b -- Defined at y.hs:10:31\n        instance [overlapping] F a a -- Defined at y.hs:13:30\n      (The choice depends on the instantiation of \u2018b0\u2019\n       To pick the first instance above, use IncoherentInstances\n       when compiling the other instance declarations)\n    \u2022 In the first argument of \u2018(&gt;&gt;)\u2019, namely \u2018(g :: IO D)\u2019\n      In the expression: (g :: IO D) &gt;&gt; return ()\n      In an equation for \u2018main\u2019: main = (g :: IO D) &gt;&gt; return ()\n   |\n34 | main = (g :: IO D) &gt;&gt; return ()\n   |         ^\n</code></pre>\n\n<p>The errors suggest <code>IncoherentInstances</code> but it doesn't seem like it would chose the correct instance. I've yet to come up with something new to try.</p>\n\n<p>EDIT: Just for the sake of seeing what would happen, I activated <code>IncoherentInstances</code>, but it results in the same errors.</p>\n\n<p>EDIT 2: I'll explain how the example is linked to my practical, actual scenario. <code>g</code> represents an HTML form. This form can return different types represented by <code>T</code>. These different types use different subsets of the fields in the form. The lines in <code>g</code> that have <code>putStrLn</code> and <code>f</code> represent the definitions of the fields in the form. <code>f</code> represents deciding whether or not to validate a field depending on if the form is returning a type that depends on it.</p>\n\n<p>As an example, the form might return a type <code>DocSectionA</code> or <code>DocSectionB</code>. A field might be type <code>Text</code>, and we want to express that a particular field should only be validated when the form is returning a <code>DocSectionA</code>, and another field should only be validated when the form is returning a <code>DocSectionB</code>.</p>\n\n<p>I hope this helps.</p>\n"}, {"tags": ["haskell", "inheritance"], "answers": [{"comments": [{"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1539965764, "post_id": 52896185, "comment_id": 92705044, "body": "The <code>p</code> in <code>One { p :: Particle}</code> and <code>Two { p :: Particle}</code> cannot be identical, right?"}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1539965895, "post_id": 52896185, "comment_id": 92705099, "body": "But this means there is no easy way to extract for example the velocity of data One? With inheritance in C# for example you could just pretend like velocity sat inside One, but here you seem to first have to extract the particle and then the velocity?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 1, "creation_date": 1539965974, "post_id": 52896185, "comment_id": 92705137, "body": "There&#39;s an extension you can enable in newer versions (8 or later?) to allow duplicate record fields, but since I&#39;m not that familiar with it (I can&#39;t even remember  its name), I&#39;ll just fix it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 1, "creation_date": 1539966104, "post_id": 52896185, "comment_id": 92705191, "body": "Like I said, Haskell doesn&#39;t support inheritance; using composition, you get the velocity of the particle contained in the value, not the velocity of the value itself. The second one may be closer, as the specific constructor used for the <code>properties</code> fields is somewhat analogous to a &quot;subclass&quot; of <code>Particle</code>."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1539966473, "post_id": 52896185, "comment_id": 92705358, "body": "The extension is <a href=\"https://downloads.haskell.org/~ghc/master/users-guide/glasgow_exts.html#duplicate-record-fields\" rel=\"nofollow noreferrer\">DuplicateRecordFields</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1539967263, "post_id": 52896185, "comment_id": 92705715, "body": "@4castle yes, but I dispute that it makes sense to use it, certainly not here."}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1539968196, "post_id": 52896185, "comment_id": 92706115, "body": "@leftaroundabout Why do you dispute its use here?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1539968547, "post_id": 52896185, "comment_id": 92706277, "body": "<code>DuplicateRecordFields</code> just hacks around the limitations of traditional Haskell records, without really addressing the fundamental reason for these limitations. The proposal that does it properly is <a href=\"https://github.com/adamgundry/ghc-proposals/blob/overloaded-record-fields/proposals/0000-overloaded-record-fields.rst\" rel=\"nofollow noreferrer\"><code>OverloadedRecordFields</code></a> (still experimental?); IMO use either that or stick to Haskell98 ways of dealing with records (i.e. avoid duplicate field names in the first place)."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1540018767, "post_id": 52896185, "comment_id": 92717685, "body": "For the first solution, you can also define a typeclass <code>HasParticle</code> and then functions to get velocity and position in its terms, which will work for all of <code>One</code>, <code>Two</code> and <code>Three</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1539968023, "last_edit_date": 1539968023, "creation_date": 1539965330, "answer_id": 52896185, "question_id": 52896071, "link": "https://stackoverflow.com/questions/52896071/haskell-inheritance-data-constructors/52896185#52896185", "title": "Haskell inheritance, data, constructors", "body": "<p>There is no inheritance in Haskell (at least, not the kind you associate with object-oriented classes). You just want composition of data types.</p>\n\n<pre><code>data Particle = Particle { velocity :: Velocity\n                         , position :: Position \n                         }\n\n-- Exercise for the reader: research the GHC extension that\n-- allows all three of these types to use the same name `p`\n-- for the particle field.\ndata One = One { p1 :: Particle\n               , ... }\ndata Two = Two { p2 :: Particle\n               , ... }\ndata Three = Three { p3 :: Particle\n                   , ... }\n</code></pre>\n\n<p>Or, you can define a type that encapsulates the other properties, and let those be added to different kinds of <code>Particle</code>s.</p>\n\n<pre><code>data Properties = One { ... } \n                | Two { ... }\n                | Three { ... }\n\ndata Particle = Particle { velocity :: Velocity\n                         , position :: Position\n                         , properties :: Properties\n                         } \n</code></pre>\n\n<p>(Or see <a href=\"https://stackoverflow.com/a/52896589/1126841\">@leftaroundabout's answer</a>, which is a nicer way of handling this approach.)</p>\n"}, {"comments": [{"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 1, "creation_date": 1539967614, "post_id": 52896589, "comment_id": 92705866, "body": "<code>asteroid :: MovingObj AsteroidSpecifics</code>, you mean that you create a function asteroid that you give a MovingObj instance and you get an AsteroidSpecifics data type in return?  So say the size of the asteroid is saved in AsteroidSpecifics, to get this I would do:   <code>size (asteroid movingObjInstance)</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 1, "creation_date": 1539968198, "post_id": 52896589, "comment_id": 92706117, "body": "@TheCodingWombat there are no instances involved, and <code>asteriod</code> is just a value, not a function, but yeah, you&#39;d store the size in <code>AsteroidSpecifics</code>."}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1540033826, "post_id": 52896589, "comment_id": 92720864, "body": "So AsteroidSpecifics would be another data type?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 1, "creation_date": 1540034446, "post_id": 52896589, "comment_id": 92721022, "body": "Yes, one of three type each of which contains what&#39;s needed for an asteriod and for the other object flavours, respectively."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 10, "last_activity_date": 1539967006, "creation_date": 1539967006, "answer_id": 52896589, "question_id": 52896071, "link": "https://stackoverflow.com/questions/52896071/haskell-inheritance-data-constructors/52896589#52896589", "title": "Haskell inheritance, data, constructors", "body": "<p>You should probably use just a single data type for all of these, but <em>parameterised</em> on the specific details:</p>\n\n<pre><code>data MovingObj s = MovingObj\n        { velocity :: Velocity\n        , position :: Position\n        , specifics :: s }\n</code></pre>\n\n<p>Then you can create e.g. <code>asteroid :: MovingObj AsteroidSpecifics</code>, but you can also write functions that work with any such moving object like</p>\n\n<pre><code>advance :: TimeStep -&gt; MovingObj s -&gt; MovingObj s\nadvance h (MovingObj v p s) = MovingObj v (p .+^ h*^v) s\n</code></pre>\n"}], "owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 52896589, "answer_count": 2, "score": 4, "last_activity_date": 1539968023, "creation_date": 1539964895, "question_id": 52896071, "link": "https://stackoverflow.com/questions/52896071/haskell-inheritance-data-constructors", "title": "Haskell inheritance, data, constructors", "body": "<p>So I want to define multiple data classes for my Asteroids game/assignment:</p>\n\n<pre><code>data One = One {oneVelocity :: Velocity, onePosition :: Position, (((other properties unique to One)))}\ndata Two = Two {twoVelocity :: Velocity, twoPosition :: Position, (((other properties unique to Two)))}\ndata Three = Three {threeVelocity :: Velocity, threePosition :: Position, (((other properties unique to Three)))}\n</code></pre>\n\n<p>As you can see I have multiple data classes with some overlapping properties (velocity, position). That also meant that I had to give them different names per data class (\"oneVelocity\", \"twoVelocity\", ...).</p>\n\n<p><strong>Is there a way I can let these types of data extend something?</strong> I thought of using one datatype with multiple constructors, but some of these current data classes are very different and I don't thing they should reside in one data class with multiple constructors.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1539966519, "post_id": 52895704, "comment_id": 92705376, "body": "What failed when you tried the obvious?  <code>class (Show (Msg h)) =&gt; Handler h  where ...</code>?"}, {"owner": {"reputation": 249, "user_id": 1722399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e98942645afd09fdd8e00853bff4f2?s=128&d=identicon&r=PG", "display_name": "xafizoff", "link": "https://stackoverflow.com/users/1722399/xafizoff"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1539966978, "post_id": 52895704, "comment_id": 92705602, "body": "I&#39;ve thied this for sure. But something went wrong... Probably my stupid mistake. Now that works. Thank you!"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1539967089, "post_id": 52895704, "comment_id": 92705647, "body": "Then add your own answer!"}], "answers": [{"tags": [], "owner": {"reputation": 249, "user_id": 1722399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e98942645afd09fdd8e00853bff4f2?s=128&d=identicon&r=PG", "display_name": "xafizoff", "link": "https://stackoverflow.com/users/1722399/xafizoff"}, "is_accepted": false, "score": 2, "last_activity_date": 1539968066, "creation_date": 1539968066, "answer_id": 52896827, "question_id": 52895704, "link": "https://stackoverflow.com/questions/52895704/constraint-on-associated-type-in-haskell/52896827#52896827", "title": "Constraint on associated type in Haskell", "body": "<p>As @Carl is pointed out, it's pretty obvious:</p>\n\n<pre><code>class (Show (Msg h)) =&gt; Handler h where\n</code></pre>\n\n<p>It was my silly mistake... Just had to enable <code>FlexibleContexts</code>.</p>\n"}], "owner": {"reputation": 249, "user_id": 1722399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e98942645afd09fdd8e00853bff4f2?s=128&d=identicon&r=PG", "display_name": "xafizoff", "link": "https://stackoverflow.com/users/1722399/xafizoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1539968066, "creation_date": 1539963509, "last_edit_date": 1539965234, "question_id": 52895704, "link": "https://stackoverflow.com/questions/52895704/constraint-on-associated-type-in-haskell", "title": "Constraint on associated type in Haskell", "body": "<p>I would like to associate my typeclass with the type, which is an instance of the certain typeclass (<code>Show</code> for example).</p>\n\n<p>Solution with the fundeps:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, FunctionalDependencies #-}\n\nclass (Show msg) =&gt; Handler msg h | h -&gt; msg where\n   handle :: h -&gt; msg -&gt; String\n</code></pre>\n\n<p>So I can implement the <code>Handler</code>, which will handle only data of associated type.</p>\n\n<pre><code>data IntHandler = IntHandler\ninstance Handler Int IntHandler where -- OK.\n   handle _ x = show x    data Foo = Foo\n\nhandle IntHandler 1   -- OK.\nhandle IntHandler \"1\" -- Fail.\n\ndata Foo = Foo\ndata FooHandler = FooHandler\ninstance Handler Foo FooHandler where  -- Fails to typecheck, Foo is not an instance of Show\n   handle _ _ = \"failed\"\n</code></pre>\n\n<p><strong>The question</strong>: how to achieve the same functionality with the type families?</p>\n\n<p>Let's try and declare the <code>Handler'</code> class and its implementation for <code>IntHandler'</code> type:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\nclass Handler' h where\n    type Msg h\n    handle' :: h -&gt; Msg h -&gt; String\n\ndata IntHandler' = IntHandler'\ninstance Handler' IntHandler' where\n    type Msg IntHandler' = Int\n    handle' _ x = show x\n</code></pre>\n\n<p>Good, this type checks. Now let's create implementation for the <code>Foo</code> type:</p>\n\n<pre><code>data Foo = Foo\ndata FooHandler' = FooHandler'\ninstance Handler' FooHandler where\n    type Msg FooHanler' = Foo\n    handle' _ _ = \"this won't fail\"\n</code></pre>\n\n<p>But it also typechecks, but I want to prevent it to type check. So, how to constrain the result of the type function <code>Msg</code>?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 2, "creation_date": 1539950332, "post_id": 52891751, "comment_id": 92696345, "body": "What is the compilation error?"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1540040970, "post_id": 52891751, "comment_id": 92722644, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27041993/edited-how-to-get-random-number-in-haskell-without-io\">(Edited) How to get random number in Haskell without IO</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 9, "last_activity_date": 1539950431, "creation_date": 1539950431, "answer_id": 52891940, "question_id": 52891751, "link": "https://stackoverflow.com/questions/52891751/picking-a-random-element-from-a-list/52891940#52891940", "title": "picking a random element from a list", "body": "<p>A working code example</p>\n\n<pre><code>import System.Random\n\nseed::Int\nseed = 40\n\ngiveList :: [Int]\ngiveList = [8,9,4,5,2]\n\ngenerator = mkStdGen seed\n\ngiveRandomElement :: Int\ngiveRandomElement = giveList !! rand where\n  n = length giveList\n  (rand, _) = randomR (0,(n-1)) generator\n</code></pre>\n\n<p>But that probably doesn't do, what you want.</p>\n\n<p><code>giveRandomElement</code> will always yield the same result. It is a pure function without any inputs, so what should it do? It can only be constant.</p>\n\n<p>You either need to use <code>IO</code> or you need to thread your generator through your code and keep track of it somewhere.</p>\n\n<p>The compiler error you got:</p>\n\n<pre><code>test.hs:14:23: error:\n    \u2022 Ambiguous type variable \u2018g0\u2019 arising from a use of \u2018randomR\u2019\n      prevents the constraint \u2018(RandomGen g0)\u2019 from being solved.\n      Relevant bindings include generator :: g0 (bound at test.hs:14:10)\n      Probable fix: use a type annotation to specify what \u2018g0\u2019 should be.\n      These potential instance exist:\n        instance RandomGen StdGen -- Defined in \u2018System.Random\u2019\n    \u2022 In the expression: randomR (0, (n - 1)) generator\n      In a pattern binding:\n        (rand, generator) = randomR (0, (n - 1)) generator\n      In an equation for \u2018giveRandomElement\u2019:\n          giveRandomElement\n            = giveList !! rand\n            where\n                n = length giveList\n                (rand, generator) = randomR (0, (n - 1)) generator\n   |\n14 |   (rand, generator) = randomR (0,(n-1)) generator\n   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>was because you defined the symbol <code>generator</code> in <code>giveRandomElement</code> in terms\nof it self and so the compiler couldn't deduce its type. (The top level declaration <code>generator</code> wasn't used in that case, because <code>(rand, generator) =</code> already shadowed the symbol after the equal sign.</p>\n"}, {"tags": [], "owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "is_accepted": false, "score": 5, "last_activity_date": 1540042751, "creation_date": 1540042751, "answer_id": 52906279, "question_id": 52891751, "link": "https://stackoverflow.com/questions/52891751/picking-a-random-element-from-a-list/52906279#52906279", "title": "picking a random element from a list", "body": "<blockquote>\n  <p>I would like to keep the generator as a global variable so I don't have to keep giving it to functions. I also don't want to deal with IO wrappers, so in what way can I do this ?</p>\n</blockquote>\n\n<p>Sorry, a function <code>giveRandomElement :: Int</code> that returns a different random number every time you call it <strong>isn't <a href=\"https://wiki.haskell.org/Referential_transparency\" rel=\"noreferrer\">referentially transparent</a></strong>, so Haskell's purity does <em>not</em> allow you to do what you'd like.</p>\n\n<p>I think working with random values is a great opportunity to learn about monads. <a href=\"https://stackoverflow.com/questions/9266765/how-to-use-monadrandom\">MonadRandom</a> has a very flexible interface for writing functions whose results are random:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>die :: (MonadRandom m) =&gt; m Int\ndie = getRandomR (1, 6)\n\nrollDice :: (MonadRandom m) =&gt; m (Int, Int)\nrollDice = do\n    x &lt;- die\n    y &lt;- die\n    return (x, y)\n\n-- Your example\ngiveRandomElement :: (MonadRandom m) =&gt; m Int\ngiveRandomElement = do\n    let n = length tetrominoes\n    i &lt;- getRandomR (0, n-1)\n    return (giveList !! i)\n</code></pre>\n\n<p>The implementations of this monad will thread the randomness state through your random functions for you. There's even an <code>instance MonadRandom IO</code>, which lets you write</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>main :: IO ()\nmain = do\n    x &lt;- giveRandomElement\n    print x\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 9715006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb905e7fb1642526f814464beb1755c?s=128&d=identicon&r=PG&f=1", "display_name": "swaffelay", "link": "https://stackoverflow.com/users/9715006/swaffelay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2601, "favorite_count": 0, "accepted_answer_id": 52891940, "answer_count": 2, "score": 1, "last_activity_date": 1540042751, "creation_date": 1539949666, "last_edit_date": 1539952979, "question_id": 52891751, "link": "https://stackoverflow.com/questions/52891751/picking-a-random-element-from-a-list", "title": "picking a random element from a list", "body": "<p>So in a project of my I have a constant function that returns an array :</p>\n\n<pre><code>import System.Random\n\ngiveList :: [Int]\ngiveList = [8,9,4,5,2]\n</code></pre>\n\n<p>and I would like to randomly select an element from that list like this:</p>\n\n<pre><code>seed::Int\nseed = 40\n\ngenerator = mkStdGen seed\n\ngiveRandomElement :: Int\ngiveRandomElement = giveList !! rand where\n    n = length tetrominoes\n    (rand,generator) = randomR (0,(n-1)) generator\n</code></pre>\n\n<p>However, this does not compile because of the generator, I would like to keep the generator as a global variable so I don't have to keep giving it to functions.\nI also don't want to deal with IO wrappers, so in what way can I do this ?</p>\n\n<p>Thx for the help :-)</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1539957202, "post_id": 52891399, "comment_id": 92700207, "body": "There&#39;s also the type-application option <code>Stack&#39; ([] @Int)</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1539958452, "post_id": 52891399, "comment_id": 92701000, "body": "Ooh, that&#39;s better anyway. I didn&#39;t think to apply <code>Stack&#39;</code> itself to <code>@Int</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1539957780, "last_edit_date": 1539957780, "creation_date": 1539948118, "answer_id": 52891399, "question_id": 52891362, "link": "https://stackoverflow.com/questions/52891362/empty-list-of-specific-type-in-haskell/52891399#52891399", "title": "Empty List of specific type in Haskell", "body": "<h1>Specifying an explicit type</h1>\n\n<p>You can set the type after double colons (<code>::</code>), like:</p>\n\n<pre><code>main = print (\"MyName\", \" \", Stack' [] <b>:: Stack' Int</b>)</code></pre>\n\n<p>here we thus set that the type of the third parameter of the 3-tuple is an object with type <code>Stack' Int</code>.</p>\n\n<p>or here you can also set the type at the list level (but these are equivalent):</p>\n\n<pre><code>main = print (\"MyName\", \" \", Stack' ([] <b>:: [Int]</b>))</code></pre>\n\n<p>or more canonical:</p>\n\n<pre><code>main = print (\"MyName\", \" \", Stack' ([] <b>:: [] Int</b>))</code></pre>\n\n<p>Here we thus specify \"<em>An empty list of type <code>[Int]</code></em>\".</p>\n\n<p>Note that this will print a the value <em>with</em> the parenthesis and commas of the 3-tuple:</p>\n\n<pre><code>Prelude&gt; print (\"MyName\", \" \", Stack' [] :: Stack' Int)\n(\"MyName\",\" \",Stack' []) \n</code></pre>\n\n<p>If you want to print this without the \"3-tuple noise\", you should construct a string, for example by using <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:show\" rel=\"nofollow noreferrer\"><strong><code>show :: Show a =&gt; a -&gt; String</code></strong></a>:</p>\n\n<pre><code>main = putStrLn (\"MyName \" ++ show (Stack' [] :: Stack' Int))</code></pre>\n\n<p>This then yields:</p>\n\n<pre><code>Prelude&gt; putStrLn (\"MyName \" ++ show (Stack' [] :: Stack' Int))\nMyName Stack' []\n</code></pre>\n\n<h1>Type applications</h1>\n\n<p>We can also make use of a <em>GHC extension</em>: <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#extension-TypeApplications\" rel=\"nofollow noreferrer\"><strong><code>TypeApplication</code></strong></a>.</p>\n\n<p>In that case we need to compile with the <code>-XTypeApplication</code> flag, or write <code>{-# LANGUAGE TypeApplication #-}</code> in the head of the file.</p>\n\n<p>We can then specify the type of the type parameter <code>a</code> with the <code>@Type</code> notation, like:</p>\n\n<pre><code>main = print (\"MyName\", \" \", Stack' <b>@Int</b> [])</code></pre>\n"}], "owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 52891399, "answer_count": 1, "score": 2, "last_activity_date": 1539959313, "creation_date": 1539947962, "last_edit_date": 1539959313, "question_id": 52891362, "link": "https://stackoverflow.com/questions/52891362/empty-list-of-specific-type-in-haskell", "title": "Empty List of specific type in Haskell", "body": "<p>I need to create an empty list of specific type. <br>\nI am creating a stack which in internally a list. To create empty stack I need to pass empty list. But how can I pass a empty list of specific type. </p>\n\n<pre><code>data Stack' a = Stack' [a] deriving (Show)\nmain = print(\"MyName\", \" \", Stack' Int [])\n</code></pre>\n\n<p>Instead of <code>Int []</code>, I have tried <code>[]::Int</code> and various other combination with brackets. But no success. Currently I have settled with </p>\n\n<pre><code>ls :: [Int]\nls = []\nStack' ls\n</code></pre>\n"}, {"tags": ["c", "haskell", "build", "ffi", "haskell-stack"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1539931294, "post_id": 52887011, "comment_id": 92686998, "body": "maybe you want to pass the path to the include files as an argument to your favourite compiler?"}, {"owner": {"reputation": 13, "user_id": 6812629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba3f3231d425f37a19d4b3467ad11603?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Hsuan-Ju Chen", "link": "https://stackoverflow.com/users/6812629/henry-hsuan-ju-chen"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1539931549, "post_id": 52887011, "comment_id": 92687101, "body": "But the include path may vary if my project is moved to another path. This may happen, for example, when &#39;git clone&#39;-ed by another one."}, {"owner": {"reputation": 13, "user_id": 6812629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba3f3231d425f37a19d4b3467ad11603?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Hsuan-Ju Chen", "link": "https://stackoverflow.com/users/6812629/henry-hsuan-ju-chen"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1539937739, "post_id": 52887011, "comment_id": 92689940, "body": "@arrowd I just drop the <code>main.c</code> file in the <code>app&#47;</code>, and then edit the <code>package.yaml</code> to have the entries like <code>main: main.c</code>. And Stack manages to build <code>main.c</code> for me. I didn&#39;t think too much."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6812629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba3f3231d425f37a19d4b3467ad11603?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Hsuan-Ju Chen", "link": "https://stackoverflow.com/users/6812629/henry-hsuan-ju-chen"}, "edited": false, "score": 0, "creation_date": 1540176156, "post_id": 52891604, "comment_id": 92752771, "body": "Thanks. This is clever and convenient enough. But when I <code>git clone</code> the project from an ubuntu to a mac, I have to set this symbolic link again because it won&#39;t be a <code>x86_64-linux</code> any more. Just wondering if there is any <code>auto-variable</code> for Stack to refer to its <code>build&#47;</code> path."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1539949029, "creation_date": 1539949029, "answer_id": 52891604, "question_id": 52887011, "link": "https://stackoverflow.com/questions/52887011/how-to-include-the-xxx-stub-h-file-generated-from-a-haskell-source-file-when-b/52891604#52891604", "title": "How to include the &#39;xxx_stub.h&#39; file generated from a haskell source file when building with Stack", "body": "<p>I'd really like it if Stack had some proper way of doing this, but AFAIK it doesn't.</p>\n\n<p>What I currently do in a project with similar requirements is, instead of <em>copying</em> the <code>_stub.h</code> file to a more convenient location, I <em>symlink</em> it. This only needs to be done once, the symlink can be put under version control, and then updates to the <code>LONG_PATH/....h</code> file will automatically show up in the convenience one.</p>\n\n<pre><code>$ ln -s dist/build/bla/bla/long/path/MyLib_stub.h app/MyLib_stub.h\n$ git add app/MyLib_stub.h\n</code></pre>\n\n<p>I'm afraid this will not work on Windows, but there's probably a similar alternative for that.</p>\n"}], "owner": {"reputation": 13, "user_id": 6812629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba3f3231d425f37a19d4b3467ad11603?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Hsuan-Ju Chen", "link": "https://stackoverflow.com/users/6812629/henry-hsuan-ju-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 52891604, "answer_count": 1, "score": 1, "last_activity_date": 1539963726, "creation_date": 1539931148, "last_edit_date": 1539963726, "question_id": 52887011, "link": "https://stackoverflow.com/questions/52887011/how-to-include-the-xxx-stub-h-file-generated-from-a-haskell-source-file-when-b", "title": "How to include the &#39;xxx_stub.h&#39; file generated from a haskell source file when building with Stack", "body": "<p>Building with Stack, I have a <code>lib.hs</code> in the <code>src/</code> and a <code>main.c</code> in the <code>app/</code>. When building, the <code>lib_stub.h</code> is generated under <code>.stack-work/dist/x86_64-linux/Cabal-2.2.0.1/build</code>.</p>\n\n<p>To include this file in <code>main.c</code>, I either write a complete absolute path behind the <code>#include</code> directive or, before a manual second pass, manually copy the <code>lib_stub.h</code> file to <code>app/</code>, which is kind of stupid.</p>\n\n<p>Is there a better way?</p>\n\n<p>More infomation:</p>\n\n<p>My <code>package.yaml</code> looks like</p>\n\n<pre><code>name:                mylib\nversion:             0.1.0.0\ngithub:              \"gituser/mylib\"\nlicense:             BSD3\nauthor:              \"Author name here\"\nmaintainer:          \"example@example.com\"\ncopyright:           \"2018 Author name here\"\n\nextra-source-files:\n- README.md\n- ChangeLog.md\n\n# Metadata used when publishing your package\n# synopsis:            Short description of your package\n# category:            Web\n\n# To avoid duplicated efforts in documentation and dealing with the\n# complications of embedding Haddock markup inside cabal files, it is\n# common to point users to the README.md file.\ndescription:         Please see the README on GitHub at &lt;https://github.com/gituser/mylib#readme&gt;\n\ndependencies:\n- base &gt;= 4.7 &amp;&amp; &lt; 5\n\nlibrary:\n  source-dirs: src\n  dependencies:\n  - free\n  - mtl\n\nexecutables:\n  cont-demo:\n    main:                main.c\n    source-dirs:         app\n    ghc-options:\n    - -threaded\n    # - -rtsopts\n    # - -with-rtsopts=-N\n    dependencies:\n    - mylib\n\ntests:\n  mylib-test:\n    main:                Spec.hs\n    source-dirs:         test\n    ghc-options:\n    - -threaded\n    - -rtsopts\n    - -with-rtsopts=-N\n    dependencies:\n    - mylib\n</code></pre>\n\n<p>And my path structure looks like</p>\n\n<pre><code>.\n\u251c\u2500\u2500 app\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 MyLib_stub.h\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.c\n\u251c\u2500\u2500 ChangeLog.md\n\u251c\u2500\u2500 mylib.cabal\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 package.yaml\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 Setup.hs\n\u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 MyLib.hs\n\u251c\u2500\u2500 stack.yaml\n\u2514\u2500\u2500 test\n    \u2514\u2500\u2500 Spec.hs\n</code></pre>\n\n<p>where <code>app/MyLib_stub.h</code> is manually copied, not automatically placed there.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "edited": false, "score": 1, "creation_date": 1539926712, "post_id": 52886221, "comment_id": 92685506, "body": "Omg, <code>sqDiff2</code> is ambiguous... :("}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1539928482, "post_id": 52886221, "comment_id": 92686024, "body": "And what&#39;s your problem? Any error message?"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1539928730, "post_id": 52886221, "comment_id": 92686102, "body": "do you want this: map (^2) (sqDiff1 xs)? The type signature of sqDiff2 have to modify as: sqDiff2::Real b=&gt;[b]-&gt;[b]"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1539955842, "post_id": 52886221, "comment_id": 92699368, "body": "Naming a function&#39;s parameter the same as that function is very confusing, and will be even worse if you try to recurse."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "edited": false, "score": 0, "creation_date": 1539959123, "post_id": 52886221, "comment_id": 92701367, "body": "@DannyuNDos It&#39;s not ambiguous, though I can see how it might be confusing. <code>sqDiff2</code> in the body of the function refers to the named parameter, which shadows the name of the function. It&#39;s very well defined."}], "answers": [{"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 1, "last_activity_date": 1539955935, "creation_date": 1539955935, "answer_id": 52893418, "question_id": 52886221, "link": "https://stackoverflow.com/questions/52886221/how-can-i-use-map-on-the-resulting-list-of-another-function/52893418#52893418", "title": "How can I use map on the resulting list of another function?", "body": "<p>If you want to square the differences from only that function, you don't need a function parameter:</p>\n\n<pre><code>sqDiff2 :: Real b =&gt; [b] -&gt; [b]\nsqDiff2 xs = map (^ 2) (sqDiff1 xs)\n</code></pre>\n\n<p>If you really intended to have a function parameter, pass the one you want to use:</p>\n\n<pre><code>*Main&gt; sqDiff2 sqDiff1 [1,2,3,4,5,6]\n[6.25,2.25,0.25,0.25,2.25,6.25]\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6669575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df689a83e4f53ca8c4f8fb29414d3d?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo H", "link": "https://stackoverflow.com/users/6669575/pablo-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 52893418, "answer_count": 1, "score": -1, "last_activity_date": 1539955935, "creation_date": 1539926064, "question_id": 52886221, "link": "https://stackoverflow.com/questions/52886221/how-can-i-use-map-on-the-resulting-list-of-another-function", "title": "How can I use map on the resulting list of another function?", "body": "<pre><code>mean :: (Real a, Fractional b) =&gt; [a] -&gt; b\nmean xs = (realToFrac(sum xs) / realToFrac(length xs))\n\nsqDiff1 :: (Fractional b, Real b) =&gt; [b] -&gt; [b]\nsqDiff1 xs = map(subtract (mean xs))xs\nsqDiff2 :: Num b =&gt; (t -&gt; [b]) -&gt; t -&gt; [b]\nsqDiff2 sqDiff2 xs = map(^ 2)(sqDiff2 xs)\n</code></pre>\n\n<p>sqDiff1 subtracts the mean of a list from each of the elements.</p>\n\n<p>Basically what I'm trying to do is square the elements of sqDiff1.</p>\n\n<p>How can I achieve this?</p>\n"}, {"tags": ["haskell", "tetris"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10527107, "user_type": "registered", "profile_image": "https://graph.facebook.com/2398111536884789/picture?type=large", "display_name": "Hugo Addobbati", "link": "https://stackoverflow.com/users/10527107/hugo-addobbati"}, "edited": false, "score": 0, "creation_date": 1539919500, "post_id": 52885453, "comment_id": 92683898, "body": "are there any ways of storing those integers in a variable?"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1539921150, "post_id": 52885453, "comment_id": 92684239, "body": "DO not use comments to ask a question. Please make another question."}], "tags": [], "owner": {"reputation": 91, "user_id": 9781192, "user_type": "registered", "profile_image": "https://graph.facebook.com/1420966161342500/picture?type=large", "display_name": "Saad Amrani", "link": "https://stackoverflow.com/users/9781192/saad-amrani"}, "is_accepted": false, "score": 1, "last_activity_date": 1539919362, "creation_date": 1539919362, "answer_id": 52885453, "question_id": 52885410, "link": "https://stackoverflow.com/questions/52885410/how-do-i-create-a-random-number-generator-function-for-haskell-tetris-game/52885453#52885453", "title": "How do i create a Random Number Generator Function for haskell tetris game", "body": "<p>You can do that using this : </p>\n\n<pre><code>import System.Random\nimport Control.Monad (replicateM)\n\nmain = replicateM 10 (randomIO :: IO Int) &gt;&gt;= print \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10527107, "user_type": "registered", "profile_image": "https://graph.facebook.com/2398111536884789/picture?type=large", "display_name": "Hugo Addobbati", "link": "https://stackoverflow.com/users/10527107/hugo-addobbati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539919888, "creation_date": 1539919043, "last_edit_date": 1539919888, "question_id": 52885410, "link": "https://stackoverflow.com/questions/52885410/how-do-i-create-a-random-number-generator-function-for-haskell-tetris-game", "title": "How do i create a Random Number Generator Function for haskell tetris game", "body": "<p>my question is very straight forward, i want to have a function in my haskell code that works as following: i invoke it and it returns me a random Integer. I use it to generate my tetrominoes based on the generated numbers, any ideas?</p>\n\n<p>EDIT, here's how my code that doenst works, looks right now\nthe codes would be something like:</p>\n\n<p>Point is a data struc that i've made by myself, it doesnt really matters.\nThe problem with using unsafePerform is that it repeats the same number everytime</p>\n\n<pre><code>getRandomInt :: Int\ngetRandomInt = unsafePerformIO (getStdRandom (randomR (1, 7)))\n\ngetRandomTetromino :: [Point]\ngetRandomTetromino = getRT getRandomInt\n\ngetRT :: Int -&gt; [Point]\ngetRT c\n    | c == 1 = [ Point 5 1 \"T\", Point 5 0 \"T\", Point 6 1 \"T\", Point 4 1 \"T\"]\n    | c == 2 = [ Point 5 1 \"Z\", Point 5 0 \"Z\", Point 4 1 \"Z\", Point 4 2 \"Z\"]\n    | c == 3 = [ Point 5 1 \"I\", Point 5 0 \"I\", Point 5 2 \"I\", Point 5 3 \"I\"]\n    | c == 4 = [ Point 5 1 \"L\", Point 6 1 \"L\", Point 4 1 \"L\", Point 6 0 \"L\"]\n    | c == 5 = [ Point 5 1 \"J\", Point 5 0 \"J\", Point 6 0 \"J\", Point 5 2 \"J\"]\n    | c == 6 = [ Point 5 1 \"S\", Point 5 0 \"S\", Point 6 0 \"S\", Point 4 1 \"S\"]\n    | c == 7 = [ Point 5 0 \"O\", Point 6 0 \"O\", Point 6 1 \"O\", Point 5 1 \"O\"]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1539933364, "post_id": 52884487, "comment_id": 92687884, "body": "You already asked the same problem in Prolog, <a href=\"https://stackoverflow.com/questions/52798641/find-all-expressions-of-four-10s\" title=\"find all expressions of four 10s\">stackoverflow.com/questions/52798641/&hellip;</a> please show some <i>effort</i> yourself."}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 6143707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c283985c88830c32ce094bfe91d2ebd7?s=128&d=identicon&r=PG&f=1", "display_name": "amlo", "link": "https://stackoverflow.com/users/6143707/amlo"}, "is_accepted": false, "score": 0, "last_activity_date": 1539917655, "creation_date": 1539917655, "answer_id": 52885260, "question_id": 52884487, "link": "https://stackoverflow.com/questions/52884487/find-all-expressions-of-four-10s-in-haskell/52885260#52885260", "title": "Find all expressions of four 10s In Haskell", "body": "<p>Reverse Polish Notation is a viable method to solve this problem. You can insert arithmetic (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>) operators somewhere between two 10s in the following quasi-RPN:  </p>\n\n<p><code>10 10 10 10</code></p>\n\n<p>After generating a possible RPN, convert it to infix notation. For example, <code>10 10 + 10 10 + /</code> is converted to <code>(10+10)/(10+10)</code>.</p>\n\n<p>However, not all permutations are legal. For example, the following RPN is illegal:  </p>\n\n<p><code>10 + 10 - 10 * 10 /</code></p>\n\n<p>You must ensure that every operator have enough operands. In the above example, the first <code>+</code> only has one 10 as its operand, so it's illegal.  </p>\n\n<p>You can simply hard-code all legal operator placing rules into the code.</p>\n"}], "owner": {"reputation": 19, "user_id": 9358191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d882029b98a39276a6562a2f0a2e8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer1010", "link": "https://stackoverflow.com/users/9358191/programmer1010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1539917655, "creation_date": 1539910589, "question_id": 52884487, "link": "https://stackoverflow.com/questions/52884487/find-all-expressions-of-four-10s-in-haskell", "title": "Find all expressions of four 10s In Haskell", "body": "<p>was challenged with a CS problem.</p>\n\n<p>The problem consists of recursively finding which expressions of the form ((10+10)/(10+10)) produces a number. For example, ((10+10)/(10+10)) produces 1. Find all the other expressions using the operators +, -, *, /, with 4 numbers of 10, and all the combinations of parentheses to enforce orders of operations.</p>\n\n<p>I was referred to the Reverse Polish Notation, but that relies on postfix notation, which isn\u2019t required to solve this problem.</p>\n\n<p>Some pseudocode I have is this. I know using recursion is the easiest way to solve this problem. But don't know how to make sure I get all combinations.</p>\n\n<pre><code>build([10,10,10,10], Expression) :-\n        Operator\n       /       \\\n    [10]     [10,10,10]\n              Operator\n               /     \\\n            [10]     [10,10]\n                     Operator\n                      /    \\\n                    [10]   [10]\n</code></pre>\n\n<p>This is a problem I am trying to solve in Haskell.</p>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1539917485, "post_id": 52885076, "comment_id": 92683446, "body": "Excellent answer."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1539950955, "post_id": 52885076, "comment_id": 92696628, "body": "The simplest option is not to use a parameter at all, <code>sprites :: Map ImageId IxValue</code>."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1539971943, "post_id": 52885076, "comment_id": 92707702, "body": "This is a very clear answer, and I learned a lot. One question I have, after playing around a bit with both suggestions: why not prefer <code>forall</code>? It seems like it less invasive as only one aspect of the code needs to be changed if this part of the API is changed again (well, hopefully only one part)."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1539985271, "post_id": 52885076, "comment_id": 92712720, "body": "@bbarker There are some things you can do with one that you cannot do with the other. If you only want the functionality they share, putting contexts on the functions is the simplest solution (fewer language extensions)."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 2, "last_activity_date": 1539916247, "creation_date": 1539916247, "answer_id": 52885076, "question_id": 52884414, "link": "https://stackoverflow.com/questions/52884414/how-to-specify-type-parameters-for-at-map-like-types-from-lens-in-haskell-type/52885076#52885076", "title": "How to specify type parameters for At (map-like types) from Lens in Haskell type signature?", "body": "<p><code>At m</code> provides <code>at :: Index m -&gt; Lens' m (Maybe (IxValue m))</code>. Notice that <code>Lens' m _</code> means that <code>m</code> is a concrete type like <code>Int</code> or <code>Map ImageId Sprite</code>, not a type constructor like <code>Map</code>. If you want to say that <code>m ImageId Sprite</code> is \"map-like\", then you need these 3 constraints:</p>\n\n<ul>\n<li><code>At (m ImageId Sprite)</code>: provides <code>at</code> for indexing and update.</li>\n<li><code>Index (m ImageId Sprite) ~ ImageId</code>: the keys used to index <code>m ImageId Sprite</code>s are <code>ImageId</code>s.</li>\n<li><code>IxValue (m ImageId Sprite) ~ Sprite</code>: the values in  a <code>m ImageId Sprite</code> are <code>Sprite</code>s.</li>\n</ul>\n\n<p>You may try to put this constraint in <code>Game</code> (though it's still wrong):</p>\n\n<pre><code>data Game m e = Game {\n  initial :: e,\n  -- ...\n  sprites :: (At (m ImageId Sprite),\n              Index (m ImageId Sprite) ~ ImageId,\n              IxValue (m ImageId Sprite) ~ Sprite) =&gt;\n             IO (m ImageId Sprite)\n}\n</code></pre>\n\n<p>Note that I'm saying <code>m ImageId Sprite</code> a bazillion times, but I don't apply <code>m</code> to other (or fewer) parameters. That's a clue that you don't actually need to abstract over <code>m :: * -&gt; * -&gt; *</code> (the kind of things like <code>Map</code>). You only need to abstract over <code>m :: *</code>.</p>\n\n<pre><code>-- still wrong, though\ntype IsSpriteMap m = (At m, Index m ~ ImageId, IxValue m ~ Sprite)\ndata Game m e = Game {\n  initial :: e,\n  -- ...\n  sprites :: IsSpriteMap m =&gt; IO m\n}\n</code></pre>\n\n<p>This is good: if you ever make a specialized map for this data structure, like</p>\n\n<pre><code>data SpriteMap\ninstance At SpriteMap\ntype instance Index SpriteMap = ImageId\ntype instance IxValue SpriteMap = IxValue\n</code></pre>\n\n<p>you would not be able to use it with the too-abstract <code>Game</code>, but it fits right into the less-abstract one as <code>Game SpriteMap e</code>.</p>\n\n<p>This is still wrong, though, because the constraint is in the wrong place. What you've done here is say this: if <em>you</em> have a <code>Game m e</code>, you can get a <code>m</code> if <em>you</em> prove that <code>m</code> is mappish. If I want to <em>create</em> a <code>Game m e</code>, I have no obligation to prove that <code>m</code> is mappish at all. If you don't get why, imagine if you could replace the <code>=&gt;</code> with a <code>-&gt;</code> above. The person who <em>calls</em> <code>sprites</code> is passing in a proof that <code>m</code> is like a map, but the <code>Game</code> doesn't contain a proof itself.</p>\n\n<p>If you want to keep <code>m</code> as a parameter to <code>Game</code>, you should simply write:</p>\n\n<pre><code>data Game m e = Game {\n  initial :: e,\n  -- ...\n  sprites :: IO m\n}\n</code></pre>\n\n<p>And write every function that needs to use <code>m</code> as a map like:</p>\n\n<pre><code>doSomething :: IsSpriteMap m =&gt; Game m e -&gt; IO ()\n</code></pre>\n\n<p>Or, you can use existential quantification:</p>\n\n<pre><code>data Game e = forall m. IsSpriteMap m =&gt; Game {\n  initial :: e,\n  -- ...\n  sprites :: IO m\n}\n</code></pre>\n\n<p>To construct a <code>Game e</code>, you can use anything of type <code>IO m</code> to fill <code>sprites</code>, as long as <code>IsSpriteMap m</code>. When you consume a <code>Game e</code> in a pattern match, the pattern match will bind a (unnamed) type variable (let's call it <code>m</code>), and then it'll give you a <code>IO m</code> and a proof for <code>IsSpriteMap m</code>.</p>\n\n<pre><code>doSomething :: Game e -&gt; IO ()\ndoSomething Game{..} = do sprites' &lt;- sprites\n                          imageId &lt;- _\n                          let sprite = sprites'^.at imageId\n                          _\n</code></pre>\n\n<p>You can also keep <code>m</code> as a parameter to <code>Game</code> but still keep the context in the <code>Game</code> constructor. However, I urge you to just go with the first option of putting a context on every function, unless you have a reason not to.</p>\n\n<p>(All code in this answer produces errors about language extensions. Keep sticking them in a <code>{-# LANGUAGE &lt;exts&gt; #-}</code> pragma at the top of your file until GHC is placated.)</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1540157046, "last_edit_date": 1540157046, "creation_date": 1540154921, "answer_id": 52919748, "question_id": 52884414, "link": "https://stackoverflow.com/questions/52884414/how-to-specify-type-parameters-for-at-map-like-types-from-lens-in-haskell-type/52919748#52919748", "title": "How to specify type parameters for At (map-like types) from Lens in Haskell type signature?", "body": "<p>I tried to solve this using <a href=\"https://wiki.haskell.org/Module_signature\" rel=\"nofollow noreferrer\">module signatures</a> and <a href=\"https://cabal.readthedocs.io/en/latest/developing-packages.html#pkg-field-mixins\" rel=\"nofollow noreferrer\">mixin modules</a>.</p>\n\n<p>First I <a href=\"https://cabal.readthedocs.io/en/latest/developing-packages.html?highlight=signatures#pkg-field-library-signatures\" rel=\"nofollow noreferrer\">declared</a> the following \"Mappy.hsig\" signature in the main library:</p>\n\n<pre><code>{-# language KindSignatures #-}\n{-# language RankNTypes #-}\nsignature Mappy where\n\nimport Control.Lens\nimport Data.Hashable\n\ndata Mappy :: * -&gt; * -&gt; *\n\nat' :: (Eq i, Ord i, Hashable i) =&gt; i -&gt; Lens' (Mappy i v) (Maybe v)\n</code></pre>\n\n<p>I could not use the <code>At</code> typeclass directly because of <a href=\"https://ghc.haskell.org/trac/ghc/ticket/8441\" rel=\"nofollow noreferrer\">this limitation</a>.</p>\n\n<p>Then I made the library code import the abstract signature instead of a concrete type:</p>\n\n<pre><code>{-# language DeriveGeneric #-}\n{-# language DeriveAnyClass #-}\nmodule Game where\n\nimport Data.Hashable\nimport GHC.Generics\nimport Mappy (Mappy,at')\n\ndata ImageId = ImageId deriving (Eq,Ord,Generic,Hashable)\n\ndata Sprite = Sprite\n\ndata Game e = Game {\n  initial :: e,\n  sprites :: IO (Mappy ImageId Sprite)\n}\n</code></pre>\n\n<p>The code in the library doesn't know what the concrete type of <code>Mappy</code> will be, but it knows the <code>at'</code> function is available when the key satisfies the constraints. Notice that <code>Game</code> is not parametrized with the map type. Instead, the <em>whole library</em> is made indefinite by having a signature that must be filled later by the users of the library.</p>\n\n<p>In an <a href=\"https://cabal.readthedocs.io/en/latest/developing-packages.html?highlight=internal%20library#sublibs\" rel=\"nofollow noreferrer\">internal convenience library</a> (or a wholly a separate package) I defined a implementation module with the same name as the signature:</p>\n\n<pre><code>{-# language RankNTypes #-}\nmodule Mappy where\n\nimport Data.Map.Strict\nimport Control.Lens\nimport Data.Hashable\n\ntype Mappy = Map \n\nat' :: (Eq i, Ord i, Hashable i) =&gt; i -&gt; Lens' (Mappy i v) (Maybe v)\nat' = at\n</code></pre>\n\n<p>The executable depends on both the main library and the implementation library. The signature \"hole\" in the main library gets automatically filled because there is a implementation module with the same name, and the declarations it contains satisfy the signature.</p>\n\n<pre><code>module Main where\n\nimport Game\nimport qualified Data.Map\n\ngame :: Game () \ngame = Game () (pure Data.Map.empty)\n</code></pre>\n\n<hr>\n\n<p>One disadvantage of this solution is that it requires a <code>Hashable</code> instance for key types even if\u2014as in the example\u2014the implementation doesn't make use of it. But you need it to allow \"filling in\" hash-based containers later, without modifying the signature or the code that imports it.</p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 52885076, "answer_count": 2, "score": 1, "last_activity_date": 1540157046, "creation_date": 1539909759, "question_id": 52884414, "link": "https://stackoverflow.com/questions/52884414/how-to-specify-type-parameters-for-at-map-like-types-from-lens-in-haskell-type", "title": "How to specify type parameters for At (map-like types) from Lens in Haskell type signature?", "body": "<p>I'd like to constrain the key type to be <code>ImageId</code> and the value type to be <code>Sprite</code> while leaving the concrete type of the map unconstrained, by way of the <a href=\"https://hackage.haskell.org/package/lens-4.3.3/docs/Control-Lens-At.html#g:1\" rel=\"nofollow noreferrer\">At typeclass</a>. Is this possible? I seem to get a kind mismatch and, based on the type signature, I don't see how to resolve it. My example:</p>\n\n<pre><code>data Game m e = Game {\n  initial :: e,\n  -- ...\n  sprites :: (At m) =&gt; IO (m ImageId Sprite)\n}\n</code></pre>\n\n<p>My error:</p>\n\n<pre><code>    * Expected kind `* -&gt; * -&gt; *', but `m' has kind `*'\n    * In the first argument of `IO', namely `(m ImageId Sprite)'\n      In the type `(At m) =&gt; IO (m ImageId Sprite)'\n      In the definition of data constructor `Game'\n   |\n64 |   sprites :: (At m) =&gt; IO (m ImageId Sprite)\n   |                            ^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539960938, "post_id": 52884045, "comment_id": 92702486, "body": "<code>Te2 :: [Int] -&gt; [T1] -&gt; T2</code>, so the error should be obvious. You could uncurry <code>Te2</code>, but it would still take a tuple of two lists, not a list of tuples as its argument."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539961141, "post_id": 52884045, "comment_id": 92702627, "body": "<code>tlist</code> itself is riddled with errors as well."}], "answers": [{"tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 0, "last_activity_date": 1539927597, "creation_date": 1539927597, "answer_id": 52886434, "question_id": 52884045, "link": "https://stackoverflow.com/questions/52884045/tuple-custom-data-type-comprehension-list/52886434#52886434", "title": "Tuple + custom data type Comprehension list", "body": "<p>I'm not entirely sure what you're asking, but it seems like you're trying to turn a list of <code>(Int, T1)</code> into a <code>T2</code> and running into a bit of difficulty?</p>\n\n<p>The first thing I'm going to do here is format your code a bit to make it easier for me to read. To do this I'm just adding some whitespace in a few places - I'm not changing any functionality. I'll also add a simple <code>main</code> function, because otherwise the GHC compiler refuses to run it:</p>\n\n<pre><code>data T1 = Te { tea  :: String\n             , tea1 :: String\n             }\n    deriving (Show, Eq, Read)\n\ndata T2 = Te2 { teanumber :: [Int]\n              , teabox    :: [T1]\n              }\n        | Other\n    deriving (Show, Eq, Read)\n\ntlist = [ (1, {Te tea::\"pepermint\" tea1::\"milk\"})    -- error 1\n        , (2, {Te tea::\"blacktea\" tea1::\"greentea\"})\n        ]\n\nputintothebox :: [(Int, T1)] -&gt; T2\nputintothebox [] = Other\n-- errors 2 and 3\nputintotheboxxs = Te2 [ tnumber, Te t t1 | (tnumber, (Te t t1)) &lt;- xs ]\n\nmain = print (putintothebox tlist)\n</code></pre>\n\n<p>Now, just looking at this I can see a few syntax errors, which I've marked with comments:</p>\n\n<ol>\n<li>This should really be <code>Te {tea=\"pepermint\", tea1=\"milk\"}</code>. The syntax <code>a :: b</code> operator means that you are declaring <code>a</code> to have type <code>b</code>, so it is not relevant here.</li>\n<li>You seem to want <code>xs</code> to be a parameter of the <code>putintothebox</code> function; this requires a space between the two names, so <code>putintothebox xs</code> and not <code>putintotheboxxs</code>.</li>\n<li>Instead of <code>Te2 [ tnumber, Te t t1 | (stuff) ]</code>, you should use the record construction syntax above and say <code>[ Te2 { teanumber = tnumber, teabox = (Te t t1) } | (tnumber, (Te t t1)) &lt;- xs ]</code>. In fact, you can actually simplify this even more to <code>[ Te2 { teanumber = tn, teabox = tb } | (tn, tb) &lt;- xs ]</code>.</li>\n</ol>\n\n<p>So the final program is:</p>\n\n<pre><code>data T1 = Te { tea  :: String\n             , tea1 :: String\n             }\n    deriving (Show, Eq, Read)\n\ndata T2 = Te2 { teanumber :: [Int]\n              , teabox    :: [T1]\n              }\n        | Other\n    deriving (Show, Eq, Read)\n\ntlist = [ (1, Te {tea = \"pepermint\", tea1 = \"milk\"})\n        , (2, Te {tea = \"blacktea\", tea1 = \"greentea\"})\n        ]\n\nputintothebox :: [(Int, T1)] -&gt; T2\nputintothebox [] = Other\nputintothebox xs = [ Te2 { teanumber = tn, teabox = tb } | (tn, tb) &lt;- xs ]\n\nmain = print (putintothebox tlist)\n</code></pre>\n\n<p>Except... this program isn't quite final. Because, if we try to run it, we get this nasty error:</p>\n\n<pre><code>Te.hs:18:20: error:\n    \u2022 Couldn't match expected type \u2018T2\u2019 with actual type \u2018[T2]\u2019\n    \u2022 In the expression:\n        [Te2 {teanumber = tn, teabox = tb} | (tn, tb) &lt;- xs]\n      In an equation for \u2018putintothebox\u2019:\n          putintothebox xs\n            = [Te2 {teanumber = tn, teabox = tb} | (tn, tb) &lt;- xs]\n   |\n18 | putintothebox xs = [ Te2 { teanumber = tn, teabox = tb } | (tn, tb) &lt;- xs ]\n   |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nTe.hs:18:40: error:\n    \u2022 Couldn't match expected type \u2018[Int]\u2019 with actual type \u2018Int\u2019\n    \u2022 In the \u2018teanumber\u2019 field of a record\n      In the expression: Te2 {teanumber = tn, teabox = tb}\n      In the expression:\n        [Te2 {teanumber = tn, teabox = tb} | (tn, tb) &lt;- xs]\n   |\n18 | putintothebox xs = [ Te2 { teanumber = tn, teabox = tb } | (tn, tb) &lt;- xs ]\n   |                                        ^^\n\nTe.hs:18:53: error:\n    \u2022 Couldn't match expected type \u2018[T1]\u2019 with actual type \u2018T1\u2019\n    \u2022 In the \u2018teabox\u2019 field of a record\n      In the expression: Te2 {teanumber = tn, teabox = tb}\n      In the expression:\n        [Te2 {teanumber = tn, teabox = tb} | (tn, tb) &lt;- xs]\n   |\n18 | putintothebox xs = [ Te2 { teanumber = tn, teabox = tb } | (tn, tb) &lt;- xs ]\n</code></pre>\n\n<p>The compiler is complaining about three problems:</p>\n\n<ol>\n<li>The whole <code>putintothebox</code> function is returning a list of <code>T2</code>s instead of only one <code>T2</code> like it's declared to.</li>\n<li><code>teanumber</code> is supposed to be a list of integers, but we're giving it only one integer.</li>\n<li>Similarly with the <code>teabox</code> field.</li>\n</ol>\n\n<p>So basically, we want a result like this:</p>\n\n<pre><code>T2 { teanumber = [1,2]\n   , teabox = [ Te {tea = \"pepermint\", tea1 = \"milk\"}\n              , Te {tea = \"blacktea\", tea1 = \"greentea\"}\n              ]\n   }\n</code></pre>\n\n<p>But in the program we're actually constructing a value like this:</p>\n\n<pre><code>[ T2 { teanumber = 1, teabox = Te {tea = \"pepermint\", tea1 = \"milk\"}}\n, T2 { teanumber = 2, teabox = Te {tea = \"blacktea\", tea1 = \"greentea\"}}\n]\n</code></pre>\n\n<p>And of course, you can't make this value, because <code>teanumber</code> and <code>teabox</code> are supposed to be lists - and that's what the compiler is complaining about.</p>\n\n<p>In a situation like this, the best thing to do is to start over again - in this case, we'll do this by replacing the <code>putintothebox xs</code> case with the following (everything else seems to be fine):</p>\n\n<pre><code>putintothebox xs = _result\n</code></pre>\n\n<p>The <code>_result</code> thing is called a <em>typed hole</em>; if we run the program with this, the compiler will show the type which should be there:</p>\n\n<pre><code>Te.hs:18:20: error:\n    \u2022 Found hole: _result :: T2\n      Or perhaps \u2018_result\u2019 is mis-spelled, or not in scope\n    \u2022 In the expression: _result\n      In an equation for \u2018putintothebox\u2019: putintothebox xs = _result\n    \u2022 Relevant bindings include\n        xs :: [(Int, T1)] (bound at Te.hs:18:15)\n        putintothebox :: [(Int, T1)] -&gt; T2 (bound at Te.hs:17:1)\n      Valid substitutions include\n        Other :: T2 (defined at Te.hs:9:11)\n        undefined :: forall (a :: TYPE r).\n                     GHC.Stack.Types.HasCallStack =&gt;\n                     a\n          (imported from \u2018Prelude\u2019 at Te.hs:1:1\n           (and originally defined in \u2018GHC.Err\u2019))\n   |\n18 | putintothebox xs = _result\n   |                    ^^^^^^^\n</code></pre>\n\n<p>So at the top it's saying <code>_result :: T2</code>, i.e. we need to replace this with something of type <code>T2</code>. We can do this via either the <code>Other</code> or the <code>Te2</code> constructor; we'll replace it with <code>Te2</code> and use typed holes to help again:</p>\n\n<pre><code>putintothebox xs = Te2 { teanumber = _num, teabox = _box }\n</code></pre>\n\n<p>Now when we run the program including this, we get the following error:</p>\n\n<pre><code>Te.hs:18:38: error:\n    \u2022 Found hole: _num :: [Int]\n      Or perhaps \u2018_num\u2019 is mis-spelled, or not in scope\n    \u2022 In the \u2018teanumber\u2019 field of a record\n      In the expression: Te2 {teanumber = _num, teabox = _box}\n      In an equation for \u2018putintothebox\u2019:\n          putintothebox xs = Te2 {teanumber = _num, teabox = _box}\n    \u2022 Relevant bindings include\n        xs :: [(Int, T1)] (bound at Te.hs:18:15)\n        putintothebox :: [(Int, T1)] -&gt; T2 (bound at Te.hs:17:1)\n      Valid substitutions include\n        mempty :: forall a. Monoid a =&gt; a\n          (imported from \u2018Prelude\u2019 at Te.hs:1:1\n           (and originally defined in \u2018GHC.Base\u2019))\n        undefined :: forall (a :: TYPE r).\n                     GHC.Stack.Types.HasCallStack =&gt;\n                     a\n          (imported from \u2018Prelude\u2019 at Te.hs:1:1\n           (and originally defined in \u2018GHC.Err\u2019))\n   |\n18 | putintothebox xs = Te2 { teanumber = _num, teabox = _box }\n   |                                      ^^^^\n\nTe.hs:18:53: error:\n    \u2022 Found hole: _box :: [T1]\n      Or perhaps \u2018_box\u2019 is mis-spelled, or not in scope\n    \u2022 In the \u2018teabox\u2019 field of a record\n      In the expression: Te2 {teanumber = _num, teabox = _box}\n      In an equation for \u2018putintothebox\u2019:\n          putintothebox xs = Te2 {teanumber = _num, teabox = _box}\n    \u2022 Relevant bindings include\n        xs :: [(Int, T1)] (bound at Te.hs:18:15)\n        putintothebox :: [(Int, T1)] -&gt; T2 (bound at Te.hs:17:1)\n      Valid substitutions include\n        mempty :: forall a. Monoid a =&gt; a\n          (imported from \u2018Prelude\u2019 at Te.hs:1:1\n           (and originally defined in \u2018GHC.Base\u2019))\n        undefined :: forall (a :: TYPE r).\n                     GHC.Stack.Types.HasCallStack =&gt;\n                     a\n          (imported from \u2018Prelude\u2019 at Te.hs:1:1\n           (and originally defined in \u2018GHC.Err\u2019))\n   |\n18 | putintothebox xs = Te2 { teanumber = _num, teabox = _box }\n   |                                                     ^^^^\n</code></pre>\n\n<p>So it's telling us we need to replace <code>_num</code> with a value of type <code>[Int]</code>, and <code>_box</code> with a value of type <code>[T1]</code>. As for how to get those values\n, I'll leave this as an exercise for you; it's fairly easy to do via list comprehensions.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1539962007, "last_edit_date": 1539962007, "creation_date": 1539961389, "answer_id": 52895093, "question_id": 52884045, "link": "https://stackoverflow.com/questions/52884045/tuple-custom-data-type-comprehension-list/52895093#52895093", "title": "Tuple + custom data type Comprehension list", "body": "<p>You need the <code>unzip</code> function to pull apart the list of tuples you defined.</p>\n\n<pre><code>&gt; tlist = [(1,Te {tea=\"pepermint\", tea1 = \"milk\"}), (2,Te {tea =\"blacktea\", tea1=\"greentea\"})]\n&gt; :t tlist\ntlist :: Num a =&gt; [(a, T1)]\n&gt; :t unzip\nunzip :: [(a, b)] -&gt; ([a], [b])\n&gt; :t unzip tlist\nunzip tlist :: Num a =&gt; ([a], [T1])\n&gt; unzip tlist\n([1,2],[Te {tea = \"pepermint\", tea1 = \"milk\"},Te {tea = \"blacktea\", tea1 = \"greentea\"}])\n</code></pre>\n\n<p>Once you have the tuple of lists, you can uncurry <code>Te2 :: [Int] -&gt; [T1] -&gt; T2</code> so that you can apply it to a tuple rather than two separate lists.</p>\n\n<pre><code>&gt; :t Te2\nTe2 :: [Int] -&gt; [T1] -&gt; T2\n&gt; :t uncurry Te2\nuncurry Te2 :: ([Int], [T1]) -&gt; T2\n&gt; uncurry Te2 $ unzip tlist\nTe2 {teanumber = [1,2], teabox = [Te {tea = \"pepermint\", tea1 = \"milk\"},Te {tea = \"blacktea\", tea1 = \"greentea\"}]}\n</code></pre>\n\n<p>Putting it together, the definition of <code>putintothebox</code> could simply be</p>\n\n<pre><code>putintothebox:: [(Int,T1)] -&gt; T2\nputintothebox [] = Other\nputintotheboxxs xs = uncurry Te2 $ unzip xs [  tnumber, Te t t1 | (tnumber, (Te t t1)) &lt;- xs ]\n</code></pre>\n\n<p>(It's unclear if you even need <code>Other</code>, which otherwise just stands in for <code>Te2 [] []</code>.)</p>\n"}], "owner": {"reputation": 13, "user_id": 9375305, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9375305", "link": "https://stackoverflow.com/users/9375305/user9375305"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 52886434, "answer_count": 2, "score": -2, "last_activity_date": 1539962007, "creation_date": 1539906493, "last_edit_date": 1539908603, "question_id": 52884045, "link": "https://stackoverflow.com/questions/52884045/tuple-custom-data-type-comprehension-list", "title": "Tuple + custom data type Comprehension list", "body": "<p>I wonder if I can do comprehension list with Tuple + custom data type. </p>\n\n<p>So my simple code is that </p>\n\n<pre><code>data T1 = Te {tea::String,tea1::String} deriving  (Show,Eq,Read)\ndata T2 = Te2 { teanumber::[Int], teabox::[T1]}| Other deriving (Show,Eq,Read)\n\ntlist = [(1,{Te tea::\"pepermint\" tea1::\"milk\"}), (2,{Te tea::\"blacktea\" tea1::\"greentea\"})]\n\n\n  putintothebox:: [(Int,T1)] -&gt; T2\n  putintothebox[] = Other\n  putintotheboxxs = Te2 [  tnumber, Te t t1 | (tnumber, (Te t t1)) &lt;- xs ]\n</code></pre>\n\n<p>I have got an error from   </p>\n\n<pre><code>&gt;&gt;     putintotheboxxs = Te2 [  tnumber, Te t t1 | (tnumber, (Te t t1)) &lt;- xs ]\n</code></pre>\n\n<p>WOuld you guys give me some advises ? </p>\n\n<p>so basically,  I expected like this list \nT2 { teanumber= [1,2], teabox=[Te {tea::\"pepermint\" tea1::\"milk\"},Te {tea::\"blacktea\" tea1::\"greentea\"}]}</p>\n"}, {"tags": ["haskell", "free-monad"], "answers": [{"comments": [{"owner": {"reputation": 938, "user_id": 474311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aad241f867909f119502ffbff53849af?s=128&d=identicon&r=PG", "display_name": "Dan Onea\u021b\u0103", "link": "https://stackoverflow.com/users/474311/dan-onea%c8%9b%c4%83"}, "edited": false, "score": 0, "creation_date": 1539970894, "post_id": 52883770, "comment_id": 92707229, "body": "Thank you very much for the answer! The suggested changes do indeed work as expected, but I&#39;m having some trouble understanding why they do. The two functions, <code>iterM</code> and <code>foldFree</code>, seem very related and I&#39;m not sure I grasp the differences \u2013 when should I prefer one over the other? For example, I could also implement <code>interpIO</code> in terms of <code>iterM</code>. Why does the current implementation of <code>interpIO</code>, which is based on <code>foldFree</code>, work?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 938, "user_id": 474311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aad241f867909f119502ffbff53849af?s=128&d=identicon&r=PG", "display_name": "Dan Onea\u021b\u0103", "link": "https://stackoverflow.com/users/474311/dan-onea%c8%9b%c4%83"}, "edited": false, "score": 1, "creation_date": 1539972587, "post_id": 52883770, "comment_id": 92708014, "body": "<code>local</code> modifies the environment in which to run a computation, that is given to it as an argument. With <code>foldFree</code> you do not have access to the computation you want to apply <code>local</code> to. In <code>foldFree :: ... =&gt; (forall x. f x -&gt; m x) -&gt; Free f a -&gt; m a</code>, that computation is hidden in the universally quantified <code>x</code>. In <code>iterM :: ... =&gt; (f (m a) -&gt; m a) -&gt; Free f a -&gt; m a</code> that computation is the <code>m a</code> inside <code>f</code>, so that gives you the opportunity to use <code>local</code>."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 938, "user_id": 474311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aad241f867909f119502ffbff53849af?s=128&d=identicon&r=PG", "display_name": "Dan Onea\u021b\u0103", "link": "https://stackoverflow.com/users/474311/dan-onea%c8%9b%c4%83"}, "edited": false, "score": 1, "creation_date": 1539972841, "post_id": 52883770, "comment_id": 92708143, "body": "There is no general rule to decide which one to use. Whatever you can do with <code>foldFree</code>, you can do with <code>iterM</code>, and at the lowest level you can just pattern match on the <code>Free</code> value. However the higher level of abstraction <code>foldFree</code> often makes programs easier to understand once you are familiar with free monads."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1539904069, "creation_date": 1539904069, "answer_id": 52883770, "question_id": 52883431, "link": "https://stackoverflow.com/questions/52883431/interpreting-the-teletype-free-monad-in-the-rws-monad/52883770#52883770", "title": "Interpreting the Teletype free monad in the RWS monad", "body": "<p>We can't use <code>foldFree</code>: it needs to be parametric in the continuation, so we can't apply <code>local</code> there. In contrast, <code>iterM</code> explicitly gives us the actual continuation without generalization, so this will work.</p>\n\n<pre><code>interpRWS = iterM lift where\n  lift (Put s a) = modify (\\t -&gt; t ++ [s]) &gt;&gt; a\n  lift (Get f)   = reader head &gt;&gt;= local tail . f\n</code></pre>\n"}], "owner": {"reputation": 938, "user_id": 474311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aad241f867909f119502ffbff53849af?s=128&d=identicon&r=PG", "display_name": "Dan Onea\u021b\u0103", "link": "https://stackoverflow.com/users/474311/dan-onea%c8%9b%c4%83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 52883770, "answer_count": 1, "score": 1, "last_activity_date": 1539904069, "creation_date": 1539901433, "question_id": 52883431, "link": "https://stackoverflow.com/questions/52883431/interpreting-the-teletype-free-monad-in-the-rws-monad", "title": "Interpreting the Teletype free monad in the RWS monad", "body": "<p>I'm currently learning about free monads and I was toying with probably the simplest and most common example out there \u2013 <code>Teletype</code>:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\nimport Control.Monad.Free\n\ndata TeletypeF a = Put String a\n                 | Get (String -&gt; a)\n    deriving Functor\n\ntype Teletype = Free TeletypeF\n</code></pre>\n\n<p>Many tutorials interpret <code>Teletype</code> programs in the <code>IO</code> monad. For example:</p>\n\n<pre><code>-- Utilities\nget   = liftF $ Get id\nput s = liftF $ Put s ()\n\n-- Sample programs\necho :: Teletype ()\necho = do word &lt;- get\n          if word == \"\\04\"  -- Ctrl-D\n          then return ()\n          else put word &gt;&gt; echo\n\nhello :: Teletype ()\nhello = do put \"What is your name?\"\n           name &lt;- get\n           put \"What is your age?\"\n           age &lt;- get\n           put (\"Hello, \" ++ name ++ \"!\")\n           put (\"You are \" ++ age ++ \" years old!\")\n\n-- Interpret to IO\ninterpIO :: Teletype a -&gt; IO a\ninterpIO = foldFree lift\n    where\n        lift (Put s a) = putStrLn s &gt;&gt; return a\n        lift (Get f)   = getLine &gt;&gt;= return . f\n</code></pre>\n\n<p>I was trying to interpret it in a different monad, namely the <a href=\"https://hackage.haskell.org/package/transformers/docs/Control-Monad-Trans-RWS-Lazy.html\" rel=\"nofollow noreferrer\">RWS</a> monad.\nThis idea was motivated by the last exercise from <a href=\"http://www.cs.uu.nl/docs/vakken/afp/assignment3.html\" rel=\"nofollow noreferrer\">this assignment</a>.\nI'm using the <code>RWS</code> datatype to fetch input from the <code>Reader</code> part and accumulate output in the <code>State</code> part.\nBut, unfortunately, I'm not able to get it working. Here is my attempt so far:</p>\n\n<pre><code>import Control.Monad.Trans.RWS.Lazy hiding (get, put)\n\ntype TeletypeRWS = RWS [String] () [String]\n\n-- Interpret to TeletypeRWS\ninterpRWS :: Teletype a -&gt; TeletypeRWS a\ninterpRWS = foldFree lift\n    where\n        lift (Put s a) = state (\\t -&gt; ((), t ++ [s])) &gt;&gt; return a\n        lift (Get f)   = reader head &gt;&gt;= local tail . return . f  -- This is wrong\n\nmockConsole :: Teletype a -&gt; [String] -&gt; (a, [String])\nmockConsole p inp = (a, s)\n    where\n        (a, s, _) = runRWS (interpRWS p) inp []\n</code></pre>\n\n<p>When running the <code>TeletypeRWS</code> \"programs\", the first value in the environment is not removed:</p>\n\n<pre><code>*Main&gt; mockConsole hello [\"john\", \"18\"]\n((),[\"What is your name?\",\"What is your age?\",\"Hello, john!\",\"You are john years old!\"])\n</code></pre>\n\n<p>I am a bit uneasy about updating the <code>Reader</code>, but I don't know how else I can access the next value in the list. The type of <code>TeletypeRWS</code> was chosen based on the exercise mentioned above \u2013 so I assume it should be possible to implement <code>interpRWS</code>.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 3, "creation_date": 1539898380, "post_id": 52882887, "comment_id": 92679214, "body": "Why does the <code>Score</code> data type have a type parameter <code>x</code> that it doesn&#39;t use?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 3, "creation_date": 1539898381, "post_id": 52882887, "comment_id": 92679215, "body": "What do you want the result to be if the score is <code>Blackjack</code> or <code>Bust</code>? PS: What&#39;s the point of your type parameter? It seems unnecessary."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539898495, "post_id": 52882887, "comment_id": 92679266, "body": "You do not use <code>x</code> anywhere in the data constructor definitions of <code>data Score</code>."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9396986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44cb71eac6fe9af92e0b396f2a16864e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Grebelski", "link": "https://stackoverflow.com/users/9396986/mario-grebelski"}, "edited": false, "score": 0, "creation_date": 1539900277, "post_id": 52883063, "comment_id": 92679866, "body": "Thank you for your answer, although I use a to specify Score Int when passing it into a function, for example   findOutcome :: Score Int -&gt; Score Int -&gt; [[Int]] -&gt; (Outcome, [[Int]])"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "reply_to_user": {"reputation": 25, "user_id": 9396986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44cb71eac6fe9af92e0b396f2a16864e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Grebelski", "link": "https://stackoverflow.com/users/9396986/mario-grebelski"}, "edited": false, "score": 0, "creation_date": 1539900385, "post_id": 52883063, "comment_id": 92679892, "body": "The values for the datatype don\u2019t use the type parameter so the code can\u2019t really care about what <code>a</code> is."}], "tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 3, "last_activity_date": 1539899141, "creation_date": 1539899141, "answer_id": 52883063, "question_id": 52882887, "link": "https://stackoverflow.com/questions/52882887/how-to-retrieve-int-from-this-data-type-in-haskell/52883063#52883063", "title": "How to retrieve Int from this data type in Haskell?", "body": "<p>What you wrote:</p>\n\n<pre><code>data Score x = Value Int | Blackjack | Bust deriving (Show, Ord, Eq)\n</code></pre>\n\n<p>Has defined some datatype <code>Score a</code> where you Gett to choose what type <code>a</code> is. But you don\u2019t use the type <code>a</code> at all. So let\u2019s try a simpler type:</p>\n\n<pre><code>data Score = Value Int | Blackjack | Bust deriving (Show, Ord, Eq)\n</code></pre>\n\n<p>Now let\u2019s write a score function. I\u2019m not really sure what this should return so I\u2019ll guess and you can change it:</p>\n\n<pre><code>score (Value x) = x\nscore Blackjack = 21\nscore Bust = 0\n</code></pre>\n\n<p>Or maybe you could do something else with this:</p>\n\n<pre><code>describe x = case x of\n   Value x   -&gt; \"You did OK.\"\n   Blackjack -&gt; \"You did great!\"\n   Bust      -&gt; \"You were just unlucky.\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9396986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44cb71eac6fe9af92e0b396f2a16864e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Grebelski", "link": "https://stackoverflow.com/users/9396986/mario-grebelski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 52883063, "answer_count": 1, "score": -2, "last_activity_date": 1539899141, "creation_date": 1539898249, "question_id": 52882887, "link": "https://stackoverflow.com/questions/52882887/how-to-retrieve-int-from-this-data-type-in-haskell", "title": "How to retrieve Int from this data type in Haskell?", "body": "<p>I have the following declaration of determining a score for cards in blackjack:</p>\n\n<pre><code>data Score x = Value Int | Blackjack | Bust deriving (Show, Ord, Eq)\n</code></pre>\n\n<p>which when passed into a function takes the type </p>\n\n<pre><code>Score Int\n</code></pre>\n\n<p>My question is if I have a Score Int how can I extract the Int from it?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1539892352, "post_id": 52881528, "comment_id": 92676627, "body": "Hint: use <code>replicate</code>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 3, "creation_date": 1539892451, "post_id": 52881528, "comment_id": 92676674, "body": "Yes, it is possible. I suggest you break this into smaller pieces. First, write a function <code>f :: (Int, a) -&gt; [a]</code> which does this for just a single tuple. Once you get that to work, then it will be easier to do it for an entire list of tuples."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1539895686, "post_id": 52882125, "comment_id": 92678176, "body": "The first argument to <code>concatMap</code> can also be spelled <code>uncurry replicate</code>."}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 3, "last_activity_date": 1539897409, "last_edit_date": 1539897409, "creation_date": 1539894803, "answer_id": 52882125, "question_id": 52881528, "link": "https://stackoverflow.com/questions/52881528/how-to-convert-a-polymorphic-data-type-to-a-single-list-of-elements/52882125#52882125", "title": "How to convert a polymorphic data type to a single list of elements", "body": "<p>Have you tried concatMap?</p>\n\n<p>Example list:</p>\n\n<pre><code>ls = [(2,True),(1,False),(4,True)]\n\nconcatMap (\\tp -&gt; replicate (fst tp) (snd tp)) ls\n</code></pre>\n\n<p>You map the function and then flat it so you got the final list: </p>\n\n<pre><code>=&gt; [True,True,False,True,True,True,True]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "is_accepted": false, "score": 4, "last_activity_date": 1539896929, "last_edit_date": 1539896929, "creation_date": 1539896627, "answer_id": 52882546, "question_id": 52881528, "link": "https://stackoverflow.com/questions/52881528/how-to-convert-a-polymorphic-data-type-to-a-single-list-of-elements/52882546#52882546", "title": "How to convert a polymorphic data type to a single list of elements", "body": "<p>If you're learning the very basics and are supposed to be building the basic functions yourself, there are two parts to this problem:</p>\n\n<ol>\n<li>Handle each of the tuples, one after the other.</li>\n<li>Handle just one tuple (<em>e</em>.<em>g</em>., <code>(2, 'a')</code>) properly.</li>\n</ol>\n\n<p>You can break it into two functions. The one that handles all of the tuples would call the one that handles just one tuple for each tuple that it gets.</p>\n\n<p>Try to solve it on your own first, but if you get stuck, the following is a spoiler for the basic structure of the code (including the base and recursive case patterns for the two functions), but it isn't the finished code itself:</p>\n\n<blockquote class=\"spoiler\">\n  <p><pre class=\"lang-hs prettyprint-override\"><code>repeatElements :: [(Int, a)] -> -- insert result type\nrepeatElements []          = -- insert result for empty list base case\nrepeatElements ((n, x):xs) = repeatAnElement n x -- insert part that recurses\n  where\n    repeatAnElement :: Int -> a -> -- insert result type\n    repeatAnElement 0 ch = -- insert result for zero-needed base case\n    repeatAnElement n ch = -- insert result for recursive case</code></pre></p>\n</blockquote>\n"}], "owner": {"reputation": 53, "user_id": 10525793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0438b36332a36aba2d10f6111619a482?s=128&d=identicon&r=PG&f=1", "display_name": "the_spiranian", "link": "https://stackoverflow.com/users/10525793/the-spiranian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1539897409, "creation_date": 1539892320, "last_edit_date": 1539892446, "question_id": 52881528, "link": "https://stackoverflow.com/questions/52881528/how-to-convert-a-polymorphic-data-type-to-a-single-list-of-elements", "title": "How to convert a polymorphic data type to a single list of elements", "body": "<p>I was wandering if it's possible to essentially convert a tuple which as its first element stores the number of occurrences of the second element into a single list of elements, for example:</p>\n\n<pre><code>[(2,'a'),(1,'b'),(4,'c')] ~&gt; ['a','a','b','c','c','c','c']\n</code></pre>\n\n<p>The definition for such a datatype is <code>[(Int, a)]</code> (I chose <code>a</code> to be a char in this example).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1539891977, "post_id": 52881365, "comment_id": 92676467, "body": "Suppose you were to bind a computation, which <code>Name</code> should the output <code>Computation</code> have? What name should a <code>Computation</code> produced with <code>return</code> have?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539892083, "post_id": 52881365, "comment_id": 92676513, "body": "<code>Computation</code> just looks like it binds a name to the result of some anonymous computation, rather than representing any computation itself."}], "answers": [{"tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": true, "score": 2, "last_activity_date": 1539893721, "creation_date": 1539893721, "answer_id": 52881861, "question_id": 52881365, "link": "https://stackoverflow.com/questions/52881365/binding-to-a-monad-that-is-inside-a-data-structure-in-haskell/52881861#52881861", "title": "Binding to a monad that is inside a data structure in Haskell", "body": "<p>No you probably can't define any useful <code>instance Monad Computation</code>, since you cannot define <code>pure :: a -&gt; Computation a</code> from the <code>Applicative</code> class (which is a superclass of <code>Monad</code>); how would you instantiate the <code>Name</code> given just a value of type <code>a</code>?</p>\n\n<p>It is a <code>Functor</code> though (and you can derive it automatically). With more context there might be a different abstraction that would be more useful.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 2, "last_activity_date": 1539899649, "creation_date": 1539899649, "answer_id": 52883146, "question_id": 52881365, "link": "https://stackoverflow.com/questions/52881365/binding-to-a-monad-that-is-inside-a-data-structure-in-haskell/52883146#52883146", "title": "Binding to a monad that is inside a data structure in Haskell", "body": "<p><em>TW <a href=\"http://book.realworldhaskell.org/read/monad-transformers.html\" rel=\"nofollow noreferrer\">monad transformers</a></em></p>\n\n<p>I think you may want</p>\n\n<pre><code>type Computation = ExceptT Error (Writer Name)\n\n-- in familiar types:\n-- Computation a \u22cd (Either Error a, Name)\n</code></pre>\n\n<p>Notice that <code>Name</code> has to be a <code>Monoid</code> now.  That makes sense, since</p>\n\n<pre><code>liftA2 (+) comp1 comp2\n</code></pre>\n\n<p>, which adds the results of two sub-computations, needs to also have a name.  What the <code>Writer</code> component does is concatenates (with the monoid's <code>&lt;&gt;</code> -- so not necessarily just string concatenation) the names of the two sub-computations.  Perhaps you would use, for example:</p>\n\n<pre><code>newtype Name = Name [String]\n    deriving (Semigroup, Monoid)\n</code></pre>\n\n<p>You would probably also want a way to define the name of some computation:</p>\n\n<pre><code>name :: String -&gt; Computation a -&gt; Computation a\nname n = mapExceptT (censor (const (Name [n])))\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>two :: Computation Int\ntwo = name \"two\" $ pure 2\n\nsomeComp :: Computation Int\nsomeComp = name \"two plus two\" $ liftA2 (+) two two\n</code></pre>\n"}], "owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 52881861, "answer_count": 2, "score": 3, "last_activity_date": 1539899649, "creation_date": 1539891670, "question_id": 52881365, "link": "https://stackoverflow.com/questions/52881365/binding-to-a-monad-that-is-inside-a-data-structure-in-haskell", "title": "Binding to a monad that is inside a data structure in Haskell", "body": "<p>Is there a way to define bind that only affects a part of a data structure?</p>\n\n<p>For example, say we have a mock Computation data type that has a Name and a Result.</p>\n\n<pre><code>type Name          = String\ndata Error         = TimeOut | NotEnoughMemory | DivByZero\ntype Result a      = Either Error a\ndata Computation a = Computation Name (Result a)\n</code></pre>\n\n<p>Since the computation could fail but we might still be interested in its name, it can't be part of Result and must be part of Computation. On the other hand it would be also convenient to bind and validate results of Computations directly like you would do with a regular Either type. Is there a way to do that?</p>\n"}, {"tags": ["parsing", "haskell", "parsec"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539884608, "post_id": 52879635, "comment_id": 92672786, "body": "Please provide an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> with all the imports, extensions, etc. you are using."}, {"owner": {"reputation": 31, "user_id": 10470847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e013f8be6a9a49920bb9cf49d390a3b8?s=128&d=identicon&r=PG&f=1", "display_name": "DavidWebb", "link": "https://stackoverflow.com/users/10470847/davidwebb"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539885022, "post_id": 52879635, "comment_id": 92673003, "body": "Apologies, added the import to the code above. I am running this on ghci"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1539885672, "post_id": 52879635, "comment_id": 92673328, "body": "Thank you. I ran this on <code>stack ghci</code> and it worked fine. I also tried <code>parseCSV &quot;test\\n&quot;</code> which correctly produced <code>Right [[&quot;test&quot;]]</code>. I&#39;m using GHCi 8.4.3, but I don&#39;t think it should matter much. I wonder what could go wrong for you, but your code looks fine here."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1539885674, "post_id": 52879635, "comment_id": 92673329, "body": "I don&#39;t get any problems when putting this in a file like <code>tmp.hs</code> and running <code>:l tmp</code> in GHCi (version 8.0.2). Possibly a monomorphism restriction issue, depending on how you are actually entering this in GHCi, due to the lack of explicit type signatures for the combinators."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539885882, "post_id": 52879635, "comment_id": 92673434, "body": "A minimal example: <code>eol = char &#39;\\n&#39;</code> produces the error, but <code>:t char &#39;\\n&#39;</code> can return a (constrained) type."}], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 1, "last_activity_date": 1539888558, "creation_date": 1539888558, "answer_id": 52880668, "question_id": 52879635, "link": "https://stackoverflow.com/questions/52879635/parse-a-string-using-parsec/52880668#52880668", "title": "Parse a String using Parsec?", "body": "<p>The error I see when entering <code>char '\\n'</code> in ghci is:</p>\n\n<pre><code>&lt;interactive&gt;:4:1: error:\n\u2022 Non type-variable argument\n    in the constraint: Text.Parsec.Prim.Stream s m Char\n  (Use FlexibleContexts to permit this)\n\u2022 When checking the inferred type\n    it :: forall s (m :: * -&gt; *) u.\n          Text.Parsec.Prim.Stream s m Char =&gt;\n          Text.Parsec.Prim.ParsecT s u m Char\n</code></pre>\n\n<p>The advice about <code>FlexibleContexts</code> is accurate.  You can turn on <code>FlexibleContexts</code> like so:</p>\n\n<pre><code>*Main&gt; :set -XFlexibleContexts\n</code></pre>\n\n<p>Unfortunately, the next error is <code>\u2022 No instance for (Show (Text.Parsec.Prim.ParsecT s0 u0 m0 Char))</code> (basically, we can't print a function) so you'll still need to apply the parser to some input to actually run it.</p>\n\n<p>Like commenters, I find that <code>parseCSV</code> can be used without any language extensions.</p>\n\n<p>There are a few things going on here:</p>\n\n<ul>\n<li><p>In the context of the whole program, the type of <code>eol</code> is constrained by the type signature on <code>parseCSV</code>.  That doesn't happen when typing <code>eol = char '\\n'</code> into GHCi.</p></li>\n<li><p>GHCi's <code>:t</code> is permissive - it's willing to print some types that use language features that aren't turned on.</p></li>\n<li><p>GHC has grown by adding a large number of <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html\" rel=\"nofollow noreferrer\">language extensions</a>, which can be turned on by the programmer on a per-module basis.  Some are widely used by production-ready libraries, others are new &amp; experimental.</p></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 10470847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e013f8be6a9a49920bb9cf49d390a3b8?s=128&d=identicon&r=PG&f=1", "display_name": "DavidWebb", "link": "https://stackoverflow.com/users/10470847/davidwebb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539888558, "creation_date": 1539884212, "last_edit_date": 1539884975, "question_id": 52879635, "link": "https://stackoverflow.com/questions/52879635/parse-a-string-using-parsec", "title": "Parse a String using Parsec?", "body": "<p>I am trying to parse a String using parsec in Haskell, however every attempt throws another type of error. </p>\n\n<pre><code>import Text.ParserCombinators.Parsec\ncsvFile = endBy line eol\nline = sepBy cell (char ',')\ncell = many (noneOf \",\\n\")\neol = char '\\n'\n\nparseCSV :: String -&gt; Either ParseError [[String]]\nparseCSV input = parse csvFile \"(unknown)\" input\n</code></pre>\n\n<p>This code, when run through stack ghci produces an error saying \"non type-variable argument in the constraint: Text.Parsec.Prim.Stream\"</p>\n\n<p>Basically, I am wondering what the most straight forward way to parse a String into tokens based on commas is in Haskell. It seems like a very straightforward concept and I assumed that it would be a great learning experience, but so far it has produced nothing but errors.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 0, "creation_date": 1539885598, "post_id": 52879792, "comment_id": 92673290, "body": "Ohhhhh. So if I had bumped the version of html-conduit in my fork, and had referenced the new version in my library&#39;s cabal file and in my app, Stack could have figured it out?"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 1, "creation_date": 1539887244, "post_id": 52879792, "comment_id": 92674123, "body": "If I understand the scenario, you would have gotten an error in that case.  The version of <code>http-conduit</code> specified by your app<code>s </code>stack.yaml` (by way of the Stackage snapshot) wouldn&#39;t match the lower bound in your library&#39;s <code>.cabal</code>.  You&#39;d still need to add the <code>extra-dep</code> to your app&#39;s <code>stack.yaml.</code> . My last paragraph was just to contrast the way <code>stack</code> treats the two files, because I think the difference confuses people."}, {"owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 0, "creation_date": 1539889517, "post_id": 52879792, "comment_id": 92675316, "body": "Ah, okay. Thank you for the great answer!"}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 2, "last_activity_date": 1539884882, "creation_date": 1539884882, "answer_id": 52879792, "question_id": 52878734, "link": "https://stackoverflow.com/questions/52878734/how-does-stack-decide-on-dependencies/52879792#52879792", "title": "How does Stack decide on dependencies?", "body": "<p>Any <code>stack</code> command only references a single <code>stack.yaml</code> file - the one that's in the current directory, or maybe some parent directory.  Libraries you depend on don't need to have a <code>stack.yaml</code> file, and it's ignored if it exists. </p>\n\n<p>This keeps the version specification simple.  There are no rules for handling the case where two <code>stack.yaml</code> files ask for different versions of the same library, because no build ever consults two <code>stack.yaml</code> files.</p>\n\n<p>On the other hand, the <code>.cabal</code> file for each library is consulted, so you will get an error early in the build if some <code>.cabal</code> file requires a library for which the <code>stack.yaml</code> doesn't specify a version, or if the version bounds in a <code>.cabal</code> don't match the specific version in <code>stack.yaml</code>.</p>\n"}], "owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 52879792, "answer_count": 1, "score": 0, "last_activity_date": 1539884882, "creation_date": 1539880590, "question_id": 52878734, "link": "https://stackoverflow.com/questions/52878734/how-does-stack-decide-on-dependencies", "title": "How does Stack decide on dependencies?", "body": "<p>I just made <a href=\"https://github.com/emhoracek/xml/commit/3e1bd12882d7c452d76e39e1db1b95577f38d4d7\" rel=\"nofollow noreferrer\">a fork</a> to fix a bug in html-conduit, which my templating library depended on. I maintain an app that depends on that templating library.</p>\n\n<p>So, I <a href=\"https://github.com/positiondev/larceny/pull/64\" rel=\"nofollow noreferrer\">updated my library's <code>stack.yaml</code></a> to point to the fork:</p>\n\n<pre><code>extra-deps:\n  [...]\n  - git: https://github.com/emhoracek/xml.git\n    commit: 3e1bd12882d7c452d76e39e1db1b95577f38d4d7\n    subdirs:\n       - xml-conduit\n       - html-conduit\n</code></pre>\n\n<p>And wrote a test to make sure that updating that dependency fixed the bug. It did! Yay.</p>\n\n<p>Then I updated my app to point to the updated templating library:</p>\n\n<pre><code>packages:\n  [...]\n  - location:\n      git: https://github.com/positiondev/larceny\n      commit: ba743c58ff4ac2606f67336e5e557deacb416ed8\n    extra-dep: true\n</code></pre>\n\n<p>I checked to make sure that this fixed the bug in my app, but it <em>didn't</em>. Until I added my fork of <code>html-conduit</code> to my app's extra-deps, it still had the bug.</p>\n\n<p>What's going on? Why doesn't Stack use the version of <code>html-conduit</code> I specified in my library's <code>stack.yaml</code> when it's deciding what version my app should use?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 6, "creation_date": 1539877327, "post_id": 52877587, "comment_id": 92668995, "body": "It doesn&#39;t throw an exception. It gives you a type error. In a typed language, those are <i>very</i> different."}], "answers": [{"tags": [], "owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "is_accepted": false, "score": 6, "last_activity_date": 1539877018, "creation_date": 1539877018, "answer_id": 52877688, "question_id": 52877587, "link": "https://stackoverflow.com/questions/52877587/in-haskell-why-cant-we-compose-show-and-fst/52877688#52877688", "title": "In Haskell why can&#39;t we compose show and fst", "body": "<p>Because <code>.</code> has lower precedence than function application, <code>show.fst (1,2)</code> is equivalent to <code>show . (fst (1,2))</code>, which equals <code>show . 1</code>, which doesn't make much sense as <code>1</code> isn't a function.</p>\n"}, {"tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": true, "score": 10, "last_activity_date": 1539877041, "creation_date": 1539877041, "answer_id": 52877695, "question_id": 52877587, "link": "https://stackoverflow.com/questions/52877587/in-haskell-why-cant-we-compose-show-and-fst/52877695#52877695", "title": "In Haskell why can&#39;t we compose show and fst", "body": "<p>In Haskell, function application has higher priority than any operators, so</p>\n\n<pre><code>show . fst (1,2)\n</code></pre>\n\n<p>is parsed as</p>\n\n<pre><code>show . (fst (1,2))\n</code></pre>\n\n<p>And, since <code>fst (1,2) == 1</code> is not a function, it is hard to compose it with anything.</p>\n\n<hr>\n\n<p>The <code>$</code> operator is actually just function application, but with a very low priority. This means that, in contrast, this</p>\n\n<pre><code>show . fst $ (1,2)\n</code></pre>\n\n<p>if parsed as</p>\n\n<pre><code>(show . fst) $ (1,2)\n</code></pre>\n\n<p>which seems to be what you want.</p>\n"}], "owner": {"reputation": 1141, "user_id": 1367497, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1ab83696683e53a9940cd2a8c480894?s=128&d=identicon&r=PG", "display_name": "peeyush singh", "link": "https://stackoverflow.com/users/1367497/peeyush-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 52877695, "answer_count": 2, "score": 0, "last_activity_date": 1539877041, "creation_date": 1539876678, "last_edit_date": 1539876955, "question_id": 52877587, "link": "https://stackoverflow.com/questions/52877587/in-haskell-why-cant-we-compose-show-and-fst", "title": "In Haskell why can&#39;t we compose show and fst", "body": "<p>I was expecting for <code>show.fst (1,2)</code> to work. But am surprised to see it give an exception.</p>\n\n<p>On running individual <code>fst (1,2)</code> returns <code>1::Num a =&gt; a</code> and <code>show 1</code> prints out 1 as string</p>\n\n<pre><code>show.fst $ (1,2)\n</code></pre>\n\n<p>works fine. Which is even more confusing as I do not see how the tuple can be reduced further (from what I understand the $ operator is used when we want the right part of expression to be evaluated.</p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1539898359, "post_id": 52877033, "comment_id": 92679204, "body": "This doesn&#39;t look like a duplicate of the indicated question to me. An answer to &quot;can you use constructor wildcards&quot; is not an answer to &quot;are there any other constructs for pattern matching&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 2, "last_activity_date": 1539876844, "creation_date": 1539876844, "answer_id": 52877632, "question_id": 52877033, "link": "https://stackoverflow.com/questions/52877033/is-there-any-other-way-to-pattern-match-writing-less-code/52877632#52877632", "title": "Is there any other way to pattern match writing less code?", "body": "<p>Pattern matching is the primary way to do this, and anything else will be defined in terms of the pattern matching approach.  In general, the text <code>A</code> won't be around at runtime, so normal code can't treat it like a string.</p>\n\n<p>I can't give specific style recommendations since you've said that the example above is not the actual code you are working on.  Personally, I have lots of simple functions like <code>getType</code>.  It's only when I have hundreds of lines like that, or on types that change often, that I start looking for other approaches.</p>\n\n<p>Haskell also has a rich collection of features for compile-time code generation.  <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/GHC-Generics.html\" rel=\"nofollow noreferrer\">GHC Generics</a> and <a href=\"https://hackage.haskell.org/package/template-haskell\" rel=\"nofollow noreferrer\">Template Haskell</a> are two powerful &amp; widely-used ways.  Both can be used to reduce boilerplate.  For example, the <a href=\"https://hackage.haskell.org/package/aeson\" rel=\"nofollow noreferrer\">aeson</a> library can generate <code>toJSON</code> and <code>fromJSON</code> functions using the names of the data constructors and fields.  (It actually provides two implementations, one with GHC Generics, and one with Template Haskell.) In either case, the generated code will use pattern matching, just like your example above.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1539876929, "accepted_answer_id": 52877632, "answer_count": 1, "score": -1, "last_activity_date": 1539877636, "creation_date": 1539874952, "last_edit_date": 1539877636, "question_id": 52877033, "link": "https://stackoverflow.com/questions/52877033/is-there-any-other-way-to-pattern-match-writing-less-code", "closed_reason": "Duplicate", "title": "Is there any other way to pattern match writing less code?", "body": "<p>Hello i am asking if there is any other way to pattern match against a type besides <code>case</code> or <code>left-hand-side</code> pattern match.</p>\n\n<p><code>data T=A Int | B Int |C Int | D Int</code>....//many cases</p>\n\n<p><strong>Method 1</strong></p>\n\n<pre><code>getType::T-&gt;Char\ngetType A _ = 'a'\ngetType B _ ='b'\n...............\n</code></pre>\n\n<p><strong>Method 2:</strong></p>\n\n<pre><code>getType::T-&gt;Char\ngetType x=case x of \n          A _ -&gt; 'a'\n          B _  -&gt; 'b'\n          ...........\n</code></pre>\n\n<p>My example above is just an example for its sake ..i assume there are some easy ways if i just want to associate the \"reflected'\"name of the data constructor with its <code>lower-case-char</code>.</p>\n\n<p>I am more like curious if there are any other ways / constructs in haskell when you want to achive pattern matching.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 1281, "user_id": 5600363, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d820760191b1bb057846d5a06c2bf5b6?s=128&d=identicon&r=PG", "display_name": "hkBst", "link": "https://stackoverflow.com/users/5600363/hkbst"}, "edited": false, "score": 0, "creation_date": 1539873387, "post_id": 52875935, "comment_id": 92666434, "body": "Which constant do you want to add to what?"}], "answers": [{"comments": [{"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1539874927, "post_id": 52876042, "comment_id": 92667480, "body": "Another option is <code>[(x, y) | (c,d) &lt;- list, let x = a+c, let y = b+d]</code>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1539875161, "last_edit_date": 1539875161, "creation_date": 1539872048, "answer_id": 52876042, "question_id": 52875935, "link": "https://stackoverflow.com/questions/52875935/adding-a-constant-to-tuple-list/52876042#52876042", "title": "adding a constant to tuple list", "body": "<p>Your <code>where</code> is scoped <em>outside</em> the list comprehension. Outside the list comprehension <code>c</code> and <code>d</code> are indeed <em>not</em> defined.</p>\n\n<p>But I think you make this problem too compilcated. You can simply put the addition in the head of the list comprehension:</p>\n\n<pre><code>convertingList :: (Int,Int) -&gt; [(Int,Int)] -&gt; [(Int,Int)]\nconvertingList (a,b) list = [(<b>a + c</b>, <b>b + d</b>) | (c,d) &lt;- list]</code></pre>\n\n<p>or you could use a <code>let</code> expression:</p>\n\n<pre><code>convertingList :: (Int,Int) -&gt; [(Int,Int)] -&gt; [(Int,Int)]\nconvertingList (a,b) list = [<b>let</b> x = a+c; y = b+d in (x, y) | (c,d) &lt;- list]</code></pre>\n\n<p>or like <a href=\"https://stackoverflow.com/questions/52875935/adding-a-constant-to-tuple-list/52876042?noredirect=1#comment92667480_52876042\">@M.Aroosi</a> says, we can move the <code>let</code>s (without <code>in</code>!) to the body part of the list comprehension:</p>\n\n<pre><code>convertingList :: (Int,Int) -&gt; [(Int,Int)] -&gt; [(Int,Int)]\nconvertingList (a,b) list = [ (x, y) | (c,d) &lt;- list, <b>let</b> x = a+c, <b>let</b> y = b+d]</code></pre>\n\n<p>An alterantive could be to define a mapping function that adds <code>a</code> and <code>b</code> to the elements, like:</p>\n\n<pre><code>convertingList :: (Int,Int) -&gt; [(Int,Int)] -&gt; [(Int,Int)]\nconvertingList (a,b) = map f\n    where f (c, d) = (a+c, b+d)</code></pre>\n\n<p>or with <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Arrow.html#v:-42--42--42-\" rel=\"nofollow noreferrer\"><strong><code>(***) :: Arrow a =&gt; a b c -&gt; a b' c' -&gt; a (b, b') (c, c')</code></strong></a>:</p>\n\n<pre><code>import Control.Arrow((***))\n\nconvertingList :: (Int,Int) -&gt; [(Int,Int)] -&gt; [(Int,Int)]\nconvertingList (a,b) = map ((***) (a+) (b+))</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 9715006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb905e7fb1642526f814464beb1755c?s=128&d=identicon&r=PG&f=1", "display_name": "swaffelay", "link": "https://stackoverflow.com/users/9715006/swaffelay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 52876042, "answer_count": 1, "score": 1, "last_activity_date": 1539875161, "creation_date": 1539871768, "last_edit_date": 1539871823, "question_id": 52875935, "link": "https://stackoverflow.com/questions/52875935/adding-a-constant-to-tuple-list", "title": "adding a constant to tuple list", "body": "<p>So I have a list of tuples and would like to do a for each over the list of tuple and add the constant to the list</p>\n\n<p>something like this </p>\n\n<pre><code>convertingList :: (Int,Int)-&gt;[(Int,Int)] -&gt; [(Int,Int)]\nconvertingList (a,b) list = [(x,y) | (c,d) &lt;- list] where x = a + c   y = b + d\n</code></pre>\n\n<p>and i get the error c and d are not in scope , how can i solve this problem?\nVariable not in scope: c :: Int\nVariable not in scope: d :: Int</p>\n\n<p>Is there a better function I can use, maybe with map ?\nThx for the help</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "edited": false, "score": 0, "creation_date": 1539865109, "post_id": 52873692, "comment_id": 92661077, "body": "I don&#39;t really understand why you use False = undefined, it&#39;s something like"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "edited": false, "score": 0, "creation_date": 1539865300, "post_id": 52873692, "comment_id": 92661190, "body": "@Tikotakatok <code>False</code> is used to avoid actually evaluating <code>undefined</code>. The whole line is equivalent to <code>collatz n | False = 1234</code>, except that it prints the debug info. Since the guard is false, <code>1234</code> will never be returned -- it is unreachable. Because of that, <code>undefined</code> is used instead of an arbitrary number to document that such case is indeed unreachable."}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "edited": false, "score": 0, "creation_date": 1539865886, "post_id": 52873692, "comment_id": 92661559, "body": "Thank you very much :))"}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "edited": false, "score": 0, "creation_date": 1539866233, "post_id": 52873692, "comment_id": 92661775, "body": "Can I also use something like True = n?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "edited": false, "score": 0, "creation_date": 1539866881, "post_id": 52873692, "comment_id": 92662148, "body": "@Tikotakatok If you use <code>True</code> the branch will be taken. That is, adding <code>collatz n | True = n</code> at the top will make <code>collatz</code> to always return <code>n</code>, and disregard the next lines, which become unreachable. If you add <code>trace</code> to that you will get debug info, but you are essentially modifying the semantics of the function, so that&#39;s a bad idea, in general. You can use <code>collatz n | False = n</code>, if you want, and still preserve the semantics."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1539864614, "creation_date": 1539864614, "answer_id": 52873692, "question_id": 52873633, "link": "https://stackoverflow.com/questions/52873633/how-to-use-trace-in-a-code-to-show-the-interim-results/52873692#52873692", "title": "How to use trace in a code to show the interim results", "body": "<p>Add a line at the top of the definition as follows:</p>\n\n<pre><code>import Debug.Trace\n\ncollatz n | trace (\"collatz called with \" ++ show n) False = undefined\ncollatz 1 = 1\ncollatz n = if even n\n              then  collatz (n `div` 2)\n              else  collatz (3*n+1)\n</code></pre>\n\n<p>This technique (adding the first line above) is universal -- it works with any function definition, and does not require to touch the remaining code.</p>\n\n<p>(Unrelated: I'd also recommend you also add a type signature for <code>collatz</code>. It's a good practice to do so before starting to write any function.)</p>\n"}], "owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52873692, "answer_count": 1, "score": -2, "last_activity_date": 1539864701, "creation_date": 1539864434, "last_edit_date": 1539864581, "question_id": 52873633, "link": "https://stackoverflow.com/questions/52873633/how-to-use-trace-in-a-code-to-show-the-interim-results", "title": "How to use trace in a code to show the interim results", "body": "<pre><code>import Debug.Trace\n\ncollatz 1 = 1\ncollatz n = if even n\n              then  collatz (n `div` 2)\n              else  collatz (3*n+1)\n</code></pre>\n\n<p>I have to use Trace and Show to see n's interim results but I really don't know how. It would be amazing if someone can help me debugging my code.</p>\n"}, {"tags": ["haskell", "input", "gloss"], "comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1539857393, "post_id": 52871673, "comment_id": 92656909, "body": "Just keep track of pressed keys in AsteroidGame? I presume the EventKey tell you wether the key was pressed or released."}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1539869163, "post_id": 52871673, "comment_id": 92663656, "body": "As @Krom says, check for <code>Down</code> events and <code>Up</code> events. Depending on your environment, you should be seeing repeating <code>Down</code> events until the key is released, which should show as an <code>Up</code> event."}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1539944465, "post_id": 52871673, "comment_id": 92693405, "body": "@BobDalgleish I think the Down event only is triggered upon pressing the key, not again and again when it is already pressed. So it doesn&#39;t work. I do not know how to confirm that there aren&#39;t any more events, i.e. I don&#39;t know how to print some debug info in the middle of other code in Haskell"}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1539958418, "post_id": 52871673, "comment_id": 92700978, "body": "You can use the <code>Debug.Trace</code> package to insert <code>trace</code> statements. Normally, the event system should issue an event when the key starts auto-repeating. Any text editor, for instance, will record each character when you hold the character key down. Check the documentation to see if something isn&#39;t filtering auto-repeating characters."}, {"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1541955801, "post_id": 52871673, "comment_id": 93386942, "body": "@BobDalgleish I can now confirm that there is only an event upon pressing the button, no more events while the button is pressed, so I still do not have a solution."}], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": false, "score": 2, "last_activity_date": 1544098031, "last_edit_date": 1544098031, "creation_date": 1544096964, "answer_id": 53650814, "question_id": 52871673, "link": "https://stackoverflow.com/questions/52871673/haskell-gloss-do-something-every-frame-key-is-pressed/53650814#53650814", "title": "Haskell Gloss - Do something every frame key is pressed", "body": "<p>As OP correctly deduced, gloss gives you input events (\"key was just pressed\", \"mouse was just moved\"), rather than input state (\"key is currently pressed\", \"mouse is at x,y\"). There doesn't seem to be a built-in way to see input state on each frame, so we'll have to make our own workaround. Thankfully, this isn't too difficult!</p>\n\n<p>For a simple working example, we'll make an incredibly fun \"game\" where you can watch a counter count upwards while the space bar is pressed. Riveting. This approach generalises to handling any key presses, so it'll be easy to extend to your case.</p>\n\n<p>The first thing we need is our game state:</p>\n\n<pre><code>import qualified Data.Set as S\n\ndata World = World\n    { keys :: S.Set Key\n    , counter :: Int }\n</code></pre>\n\n<p>We keep track of our specific game state (in this case just a counter), as well as state for our workaround (a set of pressed keys).</p>\n\n<p>Handling input events just involves either adding a key to our set of currently pressed keys or removing it:</p>\n\n<pre><code>handleInput :: Event -&gt; World -&gt; World\nhandleInput (EventKey k Down _ _) world = world { keys = S.insert k (keys world)}\nhandleInput (EventKey k Up _ _) world = world { keys = S.delete k (keys world)}\nhandleInput _ world = world -- Ignore non-keypresses for simplicity\n</code></pre>\n\n<p>This can easily be extended to handle eg. mouse movement, by changing our <code>World</code> type to keep track of the last known coordinates of the cursor, and setting it in this function whenever we see an <code>EventMotion</code> event.</p>\n\n<p>Our frame-to-frame world update function then uses the input state to update the specific game state:</p>\n\n<pre><code>update :: Float -&gt; World -&gt; World\nupdate _ world\n    | S.member (SpecialKey KeySpace) (keys world) = world { counter = 1 + counter world }\n    | otherwise = world { counter = 0 }\n</code></pre>\n\n<p>If the spacebar is currently pressed (<code>S.member (SpecialKey KeySpace) (keys world)</code>), increment the counter - otherwise, reset it to 0. We don't care about how much time as elapsed between frames so we ignore the float argument.</p>\n\n<p>Finally we can render our game and play it:</p>\n\n<pre><code>render :: World -&gt; Picture\nrender = color white . text . show . counter\n\nmain :: IO ()\nmain = play display black 30 initWorld render handleInput update\n    where\n        display = InWindow \"test\" (800, 600) (0, 0)\n        initWorld = World S.empty 0\n</code></pre>\n"}], "owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1333, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1544098031, "creation_date": 1539857273, "question_id": 52871673, "link": "https://stackoverflow.com/questions/52871673/haskell-gloss-do-something-every-frame-key-is-pressed", "title": "Haskell Gloss - Do something every frame key is pressed", "body": "<p>I want to move an object in Haskell Gloss every frame a key is pressed, not just the one frame that the key is started being pressed. (Example: While 'w' key is pressed, accelerate object every frame)</p>\n\n<p>Edit: I tried using the second parameter of EventKey but to no avail.</p>\n\n<p>My code:</p>\n\n<pre><code>--TODO - Holding keys doesn't work yet\nhandleKeys :: Event -&gt; AsteroidsGame -&gt; AsteroidsGame\nhandleKeys (EventKey (Char char) _ _ _) game \n        | char == 'w' = move   0   1\n        | char == 'a' = move (-1)  0\n        | char == 's' = move   0 (-1)\n        | char == 'd' = move   1   0\n    where move x y = game {player = accelerateObject (player game) x y}\nhandleKeys _ game = game\n\naccelerateObject :: Object -&gt; Float -&gt; Float -&gt; Object\naccelerateObject obj hor ver = obj {vel = (vx + hor, vy + ver)}\n    where (vx, vy) = vel obj\n</code></pre>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539857127, "post_id": 52871593, "comment_id": 92656742, "body": "You add an extra parameter: the recursion depth. But the question is more: &quot;what do you want to return in that case&quot;?"}, {"owner": {"reputation": 3719, "user_id": 2550406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GhBMm.png?s=128&g=1", "display_name": "lucidbrot", "link": "https://stackoverflow.com/users/2550406/lucidbrot"}, "edited": false, "score": 0, "creation_date": 1539857165, "post_id": 52871593, "comment_id": 92656763, "body": "Do I understand correctly that you don&#39;t want to modify the type of binf (<code>Double -&gt; [Int]</code>) but can modify the content of it? If yes, you can add an enclosed function that takes the depth as additional parameter and thus hide that away from the caller"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1539857213, "post_id": 52871593, "comment_id": 92656790, "body": "Here however you can use <code>take 23 (binf some_x)</code>, since due to Haskell&#39;s laziness, you will then stop calling the <code>binf</code>."}, {"owner": {"reputation": 11, "user_id": 7894788, "user_type": "registered", "profile_image": "https://graph.facebook.com/1895674917318323/picture?type=large", "display_name": "Arsenij Pertsov", "link": "https://stackoverflow.com/users/7894788/arsenij-pertsov"}, "edited": false, "score": 0, "creation_date": 1539858208, "post_id": 52871593, "comment_id": 92657286, "body": "Thank you, take 23 worked perfectly!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1539876230, "post_id": 52871593, "comment_id": 92668355, "body": "The second case can be simplified: <code>binf x = truncate x : binf (x*2 - fromIntegral (truncate x*2))</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3719, "user_id": 2550406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GhBMm.png?s=128&g=1", "display_name": "lucidbrot", "link": "https://stackoverflow.com/users/2550406/lucidbrot"}, "is_accepted": true, "score": 3, "last_activity_date": 1539859262, "creation_date": 1539859262, "answer_id": 52872210, "question_id": 52871593, "link": "https://stackoverflow.com/questions/52871593/limiting-the-depth-of-recursion-haskell/52872210#52872210", "title": "Limiting the depth of recursion Haskell", "body": "<p><strong>In General</strong><br>\nYou can wrap the recursion within an inner function. For example this function returns a list of descending numbers, starting with the input number <code>x</code>.</p>\n\n<pre><code>binf :: Int -&gt; [Int]\nbinf x = go x 23\n    where\n        go :: Int -&gt; Int -&gt; [Int]\n        go 0 _ = []\n        go _ 0 = []\n        go y rec = [y] ++ (go (y-1) (rec-1))\n</code></pre>\n\n<p>Here, <code>rec</code> is a recursion counter and the recursion ends when it reaches 0 or when the recursion ended naturally by the input being 0.<br>\nIf you run <code>binf 50</code>, you will get a result <code>[50, 49, ... , 28]</code>, which has a length of 23 - the number specified as initial <code>rec</code>.</p>\n\n<p><strong>In your case</strong><br>\nSince your recursion is just appending to a list, and haskell features lazy evaluation, you can solve this differently:  </p>\n\n<blockquote>\n  <p>Here however you can use <code>take 23 (binf some_x)</code>, since due to Haskell's\n  laziness, you will then stop calling the binf.<br>\n  - <a href=\"https://stackoverflow.com/users/67579/willem-van-onsem\">Willem Van Onsem</a> (<a href=\"https://stackoverflow.com/questions/52871593/limiting-the-depth-of-recursion-haskell#comment92656790_52871593\">comment link</a>)</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 7894788, "user_type": "registered", "profile_image": "https://graph.facebook.com/1895674917318323/picture?type=large", "display_name": "Arsenij Pertsov", "link": "https://stackoverflow.com/users/7894788/arsenij-pertsov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 52872210, "answer_count": 1, "score": 0, "last_activity_date": 1539876111, "creation_date": 1539856957, "last_edit_date": 1539876111, "question_id": 52871593, "link": "https://stackoverflow.com/questions/52871593/limiting-the-depth-of-recursion-haskell", "title": "Limiting the depth of recursion Haskell", "body": "<p>How can I limit this recursion function, so it will just stop recalling after maximum 23 times? However, I wouldn't like to modify the definition of the function binf. </p>\n\n<pre><code>binf :: Double -&gt; [Int]\nbinf 0 = []\nbinf x =\n  [fromIntegral(truncate x)] ++\n  binf(x*2-fromIntegral(truncate x*2))\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 402, "user_id": 9009630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920657e98e40c2206e2166bba183551d?s=128&d=identicon&r=PG&f=1", "display_name": "jhu", "link": "https://stackoverflow.com/users/9009630/jhu"}, "edited": false, "score": 0, "creation_date": 1539859892, "post_id": 52871644, "comment_id": 92658203, "body": "I understand that it does not work, but I also understand now that my question was badly formulated and did not reflect my real life problem. I have a cutoff condition for the processed infinite data, and the real question is how to incorporate this condition into processing."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "reply_to_user": {"reputation": 402, "user_id": 9009630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920657e98e40c2206e2166bba183551d?s=128&d=identicon&r=PG&f=1", "display_name": "jhu", "link": "https://stackoverflow.com/users/9009630/jhu"}, "edited": false, "score": 0, "creation_date": 1539860493, "post_id": 52871644, "comment_id": 92658515, "body": "Even if you short circuite on the error, how to determine, there is no error? So that the data constructor will be <code>Right</code>? You will have to look at each element of the infinite list."}, {"owner": {"reputation": 402, "user_id": 9009630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920657e98e40c2206e2166bba183551d?s=128&d=identicon&r=PG&f=1", "display_name": "jhu", "link": "https://stackoverflow.com/users/9009630/jhu"}, "edited": false, "score": 0, "creation_date": 1539861399, "post_id": 52871644, "comment_id": 92659009, "body": "Sure, but that does not address the new question. Given that two <code>traverse</code>s are such a convenient way to handle error propagation, at which point and how do I need to &quot;intercept&quot; the infinite list?"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "reply_to_user": {"reputation": 402, "user_id": 9009630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920657e98e40c2206e2166bba183551d?s=128&d=identicon&r=PG&f=1", "display_name": "jhu", "link": "https://stackoverflow.com/users/9009630/jhu"}, "edited": false, "score": 0, "creation_date": 1539861805, "post_id": 52871644, "comment_id": 92659212, "body": "I updated my answer. you can&#39;t retroactively make <code>traverse</code> work on a finite number of elements, that would change the semantics of the value."}], "tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": false, "score": 1, "last_activity_date": 1539870562, "last_edit_date": 1539870562, "creation_date": 1539857146, "answer_id": 52871644, "question_id": 52871432, "link": "https://stackoverflow.com/questions/52871432/how-to-handle-error-propagation-and-cutoff-condition-in-infinite-lists/52871644#52871644", "title": "How to handle error propagation and cutoff condition in infinite lists?", "body": "<p>That is not possible.</p>\n\n<p>To determine, wether <code>resultInf</code> is <code>Left</code> or <code>Right</code> the whole infinite list needs to be processed.</p>\n\n<p>And you need to determine, wether <code>resultInf</code> is <code>Left</code> or <code>Right</code>, as soon as you try to use it in a nontrivial way.</p>\n\n<p>Here it tries to determine wether it is <code>Left</code> or <code>Right</code> to print it.</p>\n\n<p>If you try to use that value, you will probably try to pattern match on it, which will try to put it into WHNF, which means, the value will be computed to the first data constructor, which is the <code>Left</code> or <code>Right</code>.</p>\n\n<p>Let's look at a simplified example:</p>\n\n<pre><code>infiniteList = [0..]\ndataInf = traverse fun infiniteList\n</code></pre>\n\n<p>using <code>dataInf</code> in some nontrivial way will already hang, because the <code>traverse fun</code> part asks, wether every element in the list is non negative and to answer this question one has to look at every element of the list.</p>\n\n<pre><code>take 4 &lt;$&gt; dataInf\n</code></pre>\n\n<p>is asking for the first 4 elements of the list, if every element of the infinite list was non negative, otherwise for the error which occurred while checking the infinite list.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1539878897, "creation_date": 1539878897, "answer_id": 52878257, "question_id": 52871432, "link": "https://stackoverflow.com/questions/52871432/how-to-handle-error-propagation-and-cutoff-condition-in-infinite-lists/52878257#52878257", "title": "How to handle error propagation and cutoff condition in infinite lists?", "body": "<p>Let's take a step back. You're working with something of the shape</p>\n\n<pre><code>type Result e a = Either e [a]\n</code></pre>\n\n<p>Representing either an error condition or a (possibly infinite) list of elements. As you've seen, this is not the right shape for what you're trying to do. What you want, rather, is a list of elements that ends either successfully or not.</p>\n\n<pre><code>data SuccessStream e a\n  = Cons a (SuccessStream e a)\n  | Succeeded\n  | Failed\n</code></pre>\n\n<p>There are several idiomatic ways to express this using common packages. Here's one option, using <code>streaming</code>.</p>\n\n<pre><code>import Streaming\n\ntype Result' e a = Stream (Of a) (Either e) ()\n</code></pre>\n\n<p>This gives you an easy \"upgrade path\" to streams with more interesting effects. For example:</p>\n\n<pre><code>import Control.Monad.Trans.Except\n\ntype Result'' e a = Stream (Of a) (ExceptT e IO) ()\n</code></pre>\n\n<p>And also to streams that return some final result.</p>\n"}, {"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 1, "last_activity_date": 1539890361, "last_edit_date": 1539890361, "creation_date": 1539885194, "answer_id": 52879857, "question_id": 52871432, "link": "https://stackoverflow.com/questions/52871432/how-to-handle-error-propagation-and-cutoff-condition-in-infinite-lists/52879857#52879857", "title": "How to handle error propagation and cutoff condition in infinite lists?", "body": "<p>Just combine the traverse and takeWhile function to create a new function traverseWhile as below</p>\n\n<pre><code>traverseWhile::Monad m =&gt;(a-&gt;Bool)-&gt;(a-&gt;m a)-&gt;[a]-&gt;m [a]\ntraverseWhile _ _ [] = pure []\ntraverseWhile p h (x:xs) = (h x) &gt;&gt;= loop xs\n    where loop ys y | p y       = (:) &lt;$&gt; pure y &lt;*&gt; traverseWhile p h ys\n                    | otherwise = pure []\n</code></pre>\n\n<p>As the takeWhile function, this function stop to construct the list when the condition is false. Other than this, the behavior same as traverse function but only for Monad and list.</p>\n\n<p>Modify the ns function add new parameter (Int->Bool) as condition, replace the second traverse function by traverseWhile as</p>\n\n<pre><code>ns :: Either String [[Int]]\n      -&gt; (Int -&gt; Bool)\n      -&gt; (Int -&gt; Either String Int)\n      -&gt; Either String [[Int]]\nns l c f = l &gt;&gt;= traverse (traverseWhile c f)\n</code></pre>\n\n<p>and resultFin, resultInf as</p>\n\n<pre><code>resultFin :: (Int-&gt;Bool)-&gt;Either String [[Int]]\nresultFin c = ns dataFin c fun\n\nresultInf :: (Int-&gt;Bool)-&gt;Either String [[Int]]\nresultInf c = ns dataInf c fun\n</code></pre>\n\n<p>Now the resultInf behave as your temporary solution.</p>\n\n<p>Furthermore, if negative number in the list after 5 as</p>\n\n<pre><code>ns (Right $ [[1..10] ++ [-1] ++ [1..]]) con fun\n</code></pre>\n\n<p>gives</p>\n\n<blockquote>\n  <p>Right [[2,3,4]]</p>\n</blockquote>\n\n<p>before 5</p>\n\n<pre><code>ns (Right $ [[1..2] ++ [-1] ++ [1..]]) con fun\n</code></pre>\n\n<p>gives </p>\n\n<blockquote>\n  <p>Left \"error\"</p>\n</blockquote>\n"}], "owner": {"reputation": 402, "user_id": 9009630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920657e98e40c2206e2166bba183551d?s=128&d=identicon&r=PG&f=1", "display_name": "jhu", "link": "https://stackoverflow.com/users/9009630/jhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1539890361, "creation_date": 1539856355, "last_edit_date": 1539865824, "question_id": 52871432, "link": "https://stackoverflow.com/questions/52871432/how-to-handle-error-propagation-and-cutoff-condition-in-infinite-lists", "title": "How to handle error propagation and cutoff condition in infinite lists?", "body": "<p>Given the following definitions</p>\n\n<pre><code>-- data, finite\ndataFin :: Either String [[Int]]\ndataFin = Right [[1..10]]\n\n-- data, infinite\ndataInf :: Either String [[Int]]\ndataInf = Right [[1..]]\n\n-- function applied to data\nfun :: Int -&gt; Either String Int\nfun x = if x &lt; 0 then Left \"error\" else Right $ x+1\n\n-- next stage of processing, short circuiting on error\nns :: Either String [[Int]] -&gt; (Int -&gt; Either String Int) -&gt; Either String [[Int]]\nns l f = l &gt;&gt;= traverse (traverse f)\n\n-- condition for data cutoff\ncon :: Int -&gt; Bool\ncon = (&lt; 5)\n\n-- results of processing\nresultFin :: Either String [[Int]]\nresultFin = ns dataFin fun\n\nresultInf :: Either String [[Int]]\nresultInf = ns dataInf fun\n</code></pre>\n\n<p>I can readily apply the cutoff condition to  elements of the finite result</p>\n\n<pre><code>\u03bb&gt; (fmap . fmap) (takeWhile con) resultFin\nRight [[2,3,4]]\n</code></pre>\n\n<p>But for infinite data this hangs:</p>\n\n<pre><code>\u03bb&gt; (fmap . fmap) (takeWhile con) resultInf\n</code></pre>\n\n<p>How should this be done correctly for infinite data given Haskell's lazy nature? In particular, given that the condition <code>con</code> is applied to processed data, where and how should I incorporate it?</p>\n\n<p>EDIT.</p>\n\n<p>I was able to develop a (temporary) solution, but I am still very much interested in what would be a \"correct\" way of doing this. Here is the current version. Defining a \"next stage\" function that incorporates the cutoff condition</p>\n\n<pre><code>nsCond :: Either String [[Int]]\n  -&gt; (Int -&gt; Either String Int)\n  -&gt; (Int -&gt; Bool)\n  -&gt; Either String [[Int]]\nnsCond d f c =\n  d &gt;&gt;= (\\ls -&gt;\n           let\n             pls = (fmap . fmap) f ls :: [[Either String Int]] \n             wpls = fmap (takeWhile (\\v -&gt; case v of\n                                            Left _ -&gt; True\n                                            Right x -&gt; c x)) pls :: [[Either String Int]]\n           in\n             traverse sequence wpls)\n</code></pre>\n\n<p>we have, for the infinite data</p>\n\n<pre><code>\u03bb&gt; nsCond dataInf fun con\nRight [[2,3,4]]\n</code></pre>\n"}, {"tags": ["haskell", "pointfree", "partial-application"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1539856033, "post_id": 52871288, "comment_id": 92656113, "body": "You can use <code>flip</code> for this: <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:flip\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539866382, "post_id": 52871288, "comment_id": 92661865, "body": "Define <code>filterText :: [Char] -&gt; Text -&gt; Text</code>, problem solved. For the same reason, <code>filter</code> takes the predicate, not the list to be filtered, as its first argument. The filter condition is more intimately tied to the filter process than the thing being filtered, so it is <i>the</i> argument to the function."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1539866505, "post_id": 52871288, "comment_id": 92661939, "body": "Put another way, the condition defines the filter: given the <code>[Char]</code>, you get back a function of type <code>Text -&gt; Text</code> that filters its input."}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": false, "score": 2, "last_activity_date": 1539856137, "creation_date": 1539856137, "answer_id": 52871373, "question_id": 52871288, "link": "https://stackoverflow.com/questions/52871288/partial-application-to-a-specific-parameter-slot/52871373#52871373", "title": "Partial application to a specific parameter slot", "body": "<p><a href=\"http://pointfree.io/\" rel=\"nofollow noreferrer\">pointfree.io</a> will help with all of this, for example, when\nasked for</p>\n\n<pre><code>\\x -&gt; method x par2\n</code></pre>\n\n<p>it yields</p>\n\n<pre><code>flip method par2\n</code></pre>\n\n<p>and for</p>\n\n<pre><code>\\x y z -&gt; f x y z value\n</code></pre>\n\n<p>it yields</p>\n\n<pre><code>flip flip value . (flip .) . f\n</code></pre>\n\n<p>readability is something different though in my opinion.</p>\n"}, {"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1539861847, "post_id": 52871375, "comment_id": 92659231, "body": "Thank you for your answer ,indeed it solves my current problem but , i was asking in more broader terms.In the current case the parameter that i want to partial apply is the second one..but give <code>1...N</code> parameters and you want to partial apply <code>P</code> parameters anywhere in the argument positions of <code>1 to N</code> can you do that?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1539861890, "post_id": 52871375, "comment_id": 92659258, "body": "@BercoviciAdrian: you write a lambda-expression, like <code>\\foo bar -&gt; someFunc foo bar &quot;data&quot;</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1539856144, "creation_date": 1539856144, "answer_id": 52871375, "question_id": 52871288, "link": "https://stackoverflow.com/questions/52871288/partial-application-to-a-specific-parameter-slot/52871375#52871375", "title": "Partial application to a specific parameter slot", "body": "<p>You can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:flip\" rel=\"nofollow noreferrer\"><strong><code>flip :: (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c</code></strong></a> for this: with <code>flip</code> you take a function, and thus \"flip\" the parameters. You can then partially apply one parameter: the second one.</p>\n\n<p>So in this specific case you can use:</p>\n\n<pre><code>foo :: Text -&gt; Text\nfoo = flip filterText \"astr\"\n</code></pre>\n\n<p>You can improve the <code>filterText</code> as well:</p>\n\n<pre><code>filterText::Text -&gt; [Char] -&gt; Text\nfilterText tx chars = Data.Text.filter (`notElem` chars) tx\n</code></pre>\n\n<p>or even:</p>\n\n<pre><code>filterText::Text -&gt; [Char] -&gt; Text\nfilterText = flip (Data.Text.filter . flip notElem)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1539861584, "last_edit_date": 1539861584, "creation_date": 1539860689, "answer_id": 52872556, "question_id": 52871288, "link": "https://stackoverflow.com/questions/52871288/partial-application-to-a-specific-parameter-slot/52872556#52872556", "title": "Partial application to a specific parameter slot", "body": "<p>I would avoid <code>flip</code> as a general rule, however <em>providing only the second argument</em> can for a named function be done easily by treating it as an infix operator and sectioning that:</p>\n\n<pre><code>    (`filterText` \"astr\")\n</code></pre>\n\n<p>Likewise the lambda in that function can be reduced to</p>\n\n<pre><code>      (not . (`elem` chars))\n</code></pre>\n\n<p>(or further to <code>(`notElem` chars)</code>).</p>\n\n<p>But often when you find yourself in such a situation, it's worth thinking whether the function should better be defined with flipped parameters in the first place.</p>\n\n<pre><code>filterText :: [Char] -&gt; Text -&gt; Text\nfilterText chars = Data.Text.filter (`notElem` chars)\n</code></pre>\n\n<p>Notice that I could \u03b7-reduce away the <code>tx</code> parameter for free, and now you can just write <code>filterText \"astr\"</code>.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 52872556, "answer_count": 3, "score": 1, "last_activity_date": 1539861584, "creation_date": 1539855830, "question_id": 52871288, "link": "https://stackoverflow.com/questions/52871288/partial-application-to-a-specific-parameter-slot", "title": "Partial application to a specific parameter slot", "body": "<p>Hello i want to know if it is possible to provide a parameter to a method at a specific position for further using <code>point-free-notation</code>:</p>\n\n<pre><code> readData::Text-&gt;[Int]\n    readData =catMaybes . maybeValues where\n        maybeValues=mvalues.split.filterText\n\n filterText::Text-&gt;[Char]-&gt;Text\n    filterText tx chars=Data.Text.filter (\\x -&gt; not (x `elem` chars)) tx\n</code></pre>\n\n<p>How can i provide to <code>filterText</code> only the <code>2</code>-nd parameter? like this:</p>\n\n<p><code>filterText \"astr\"</code> where <code>astr</code> is the <code>[Char]</code> argument (second position).<br>Generally speaking when having a method <code>mymethod par1 par2 par3</code> can i use it :<br> <code>mymethod par2</code> and somehow to bind the second argument not the first.</p>\n"}, {"tags": ["haskell", "ghc", "yesod", "yesod-forms"], "answers": [{"comments": [{"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539876281, "post_id": 52873000, "comment_id": 92668386, "body": "Thank you, now it makes perfect sense. The function <code>fieldView</code> extracts a function value that only uses <code>m</code> for resolving <code>HandlerSite m</code> and that&#39;s what makes it potentially different from <code>textField</code>&#39;s <code>m</code>. I imagine that if the return value of that function were <code>WidgetT (HandlerSite m) m ()</code> instead of the <code>WidgetT (HandlerSite m) IO ()</code> that it is, then this wouldn&#39;t have happened. The change you proposed worked after activating <code>TypeApplications</code> and <code>ScopedTypeVariables</code>. I only needed to add parentheses around the first application to avoid syntax error with an unexpected <code>{</code>."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 1, "creation_date": 1539877164, "post_id": 52873000, "comment_id": 92668912, "body": "I just noticed that another way to solve this is by using just <code>ScopedTypeVariables</code> like I was trying to originally in the question. I was only missing adding a <code>forall m.</code> to <code>textField</code>&#39;s type signature, which I didn&#39;t realize was necessary to add the variable to the scope. Still, <code>TypeApplications</code> seems very cool."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539877830, "post_id": 52873000, "comment_id": 92669260, "body": "Also, either way, linking the <code>m</code>&#39;s of the first mention of <code>I.textField</code> is not necessary because it uses <code>m</code> in another manner besides passing it as argument to a type family, and that causes it to be well linked already. I&#39;m making these comments to the benefit of future readers."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539878630, "post_id": 52873000, "comment_id": 92669746, "body": "@JoL Note that you can answer your own question with the solution you ended up with. SO&#39;s policy allows that, precisely for the benefit of future readers."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1539879264, "post_id": 52873000, "comment_id": 92670083, "body": "Well, the point of this question was to understand what was going on rather than finding a solution, since I had already found a workaround, albeit without understanding why it worked, when I asked the question. I don&#39;t think I can explain what happened better than you did right here."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1539862313, "creation_date": 1539862313, "answer_id": 52873000, "question_id": 52867795, "link": "https://stackoverflow.com/questions/52867795/couldnt-match-type-handlersite-m0-with-handlersite-m-when-modifying-field/52873000#52873000", "title": "Couldn&#39;t match type \u2018HandlerSite m0\u2019 with \u2018HandlerSite m\u2019 when &quot;modifying&quot; field with same value", "body": "<blockquote>\n  <p>And it failed, so I guess the problem is related with mentioning I.textField twice. This is weird.</p>\n</blockquote>\n\n<p>Actually, this is quite common when type families are involved. Let me show the issue in a simpler case. Suppose we have a type family as follows</p>\n\n<pre><code>type family F a\ntype instance F Int  = String\ntype instance F Bool = String\n</code></pre>\n\n<p>Note how <code>F Int</code> and <code>F Bool</code> are actually the same type, i.e. <code>String</code>. This is possible since <code>F</code> can be a non-injective function.</p>\n\n<p>Now, if we have at hand the following function</p>\n\n<pre><code>foo :: F a -&gt; SomeResultType\n</code></pre>\n\n<p>we discover that we can not, in general, call it as</p>\n\n<pre><code>foo \"some string\"\n</code></pre>\n\n<p>Why? Well, the compiler can not determine what type to use for <code>a</code>: it could be <code>Int</code> or <code>Bool</code>, since both would make <code>F a</code> to be <code>String</code>. The call is ambiguous, so it raises a type error.</p>\n\n<p>Even worse, if we used <em>twice</em> that call in our code, e.g.</p>\n\n<pre><code>bar (foo \"string\") (foo \"string\")\n</code></pre>\n\n<p>it would be even possible to choose <code>a = Int</code> for the first call, and <code>a = Bool</code> for the second call!</p>\n\n<p>Moreover, consider what would happen if we have a polymorphic value which can produce <em>any</em> <code>F a</code>.</p>\n\n<pre><code>x :: forall a . F a\n</code></pre>\n\n<p>Then, we might be tempted to call <code>foo x</code>. After all, <code>foo</code> takes <code>F a</code> and <code>x</code> can produce <code>F a</code> for any <code>a</code>. It looks fine, but it is once again ambiguous. Indeed, what should be chosen for <code>a</code>? Many choices apply. We might try to fix this with a type signature</p>\n\n<pre><code>foo (x :: F Int)\n</code></pre>\n\n<p>but this is completely equivalent to any of</p>\n\n<pre><code>foo (x :: String)\nfoo (x :: F Bool)\n</code></pre>\n\n<p>so it does really choose the type <code>a</code>!</p>\n\n<p>In your code, a similar problem happens. Let's dissect the type error:</p>\n\n<pre><code>Couldn't match type \u2018HandlerSite m0\u2019 with \u2018HandlerSite m\u2019\n    Expected type: FieldViewFunc m Text\n    Actual type:   FieldViewFunc m0 Text\nNB: \u2018HandlerSite\u2019 is a type function, and may not be injective\n</code></pre>\n\n<p>This is telling us that at some point we need to specify a <code>FieldViewFunc m Text</code>. This type involves a type family <code>HandlerSite m</code>, which due to non-injectivity, could be the same type as <code>HandlerSite m0</code> for some other monad <code>m0</code>. </p>\n\n<p>Now, <code>I.textField</code> can produce a value \"for any <code>m</code>\". Hence, using it is somehow similar to using <code>foo x</code> above. Your code is more peculiar, since if we use the \"same\" call to <code>I.textField</code>, the compiler is able to infer that we indeed want the \"right\" <code>m</code>. Here, \"same\" call means defining some identifier like your <code>f</code> to <code>I.textField</code>, and use <code>f</code> twice. Instead, making two calls to <code>I.textField</code> allows GHC to choose two distinct <code>m</code>s, one for each call, and ambiguity arises.</p>\n\n<p>If you are confused, don't worry -- it is a bit tricky to understand, especially on a relatively real-world framework like Yesod.</p>\n\n<p>How to solve this? There are many ways, but in my opinion, the best, modern way to resolve such ambiguities is to turn on the <code>TypeApplications</code> extension (beyond <code>ScopedTypeVariables</code>) and then specify that we really want to choose <code>m</code> as the outer <code>m</code>, as follows:</p>\n\n<pre><code>textField :: forall m . \n     ( Monad m\n     , RenderMessage (HandlerSite m) FormMessage\n     )\n     =&gt; Field m Text\ntextField = I.textField @ m\n    { fieldView = fieldView (I.textField @ m)\n    }\n</code></pre>\n\n<p>The <code>@ m</code> syntax is used to choose the type, overriding the type inference engine. It has a similar effect as writing a type annotation in many cases, but works even in \"ambiguous\" cases where type annotations do not. For instance <code>foo (x @ Int)</code> would have worked in the simpler example above.</p>\n\n<p>(I'm not familiar with Yesod so the above might not work if <code>I.textField</code> is also parametrized by other type variables, in which case we need more <code>@ type</code> applications e.g. <code>I.textField @type @type2 ...</code> one of which is <code>@m</code>.)</p>\n"}], "owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 52873000, "answer_count": 1, "score": 1, "last_activity_date": 1539862313, "creation_date": 1539842032, "last_edit_date": 1539843872, "question_id": 52867795, "link": "https://stackoverflow.com/questions/52867795/couldnt-match-type-handlersite-m0-with-handlersite-m-when-modifying-field", "title": "Couldn&#39;t match type \u2018HandlerSite m0\u2019 with \u2018HandlerSite m\u2019 when &quot;modifying&quot; field with same value", "body": "<p>I'm working on a Yesod app and wanted to have an alternative <code>textField</code> with a modified <code>fieldView</code>. To start, I tried this:</p>\n\n<pre><code>textField\n  :: ( Monad m\n     , RenderMessage (HandlerSite m) FormMessage\n     )\n  =&gt; Field m Text\ntextField = I.textField\n    { fieldView = fieldView I.textField\n    }\n</code></pre>\n\n<p>As far as I can see, this <code>textField</code> should be identical to <code>I.textField</code>. However, I get the following error:</p>\n\n<pre><code>Foo.hs:37:19: error:\n    \u2022 Couldn't match type \u2018HandlerSite m0\u2019 with \u2018HandlerSite m\u2019\n      Expected type: FieldViewFunc m Text\n        Actual type: FieldViewFunc m0 Text\n      NB: \u2018HandlerSite\u2019 is a type function, and may not be injective\n      The type variable \u2018m0\u2019 is ambiguous\n    \u2022 In the \u2018fieldView\u2019 field of a record\n      In the expression: I.textField {fieldView = fieldView I.textField}\n      In an equation for \u2018textField\u2019:\n          textField = I.textField {fieldView = fieldView I.textField}\n    \u2022 Relevant bindings include\n        textField :: Field m Text\n          (bound at Foo.hs:36:1)\n</code></pre>\n\n<p>Interestingly, this alternative way of writing this works just fine:</p>\n\n<pre><code>textField\n  :: ( Monad m\n     , RenderMessage (HandlerSite m) FormMessage\n     )\n  =&gt; Field m Text\ntextField = f\n    { fieldView = fieldView\n    }\n  where\n    f@Field {..} = I.textField\n</code></pre>\n\n<p>Is the problem in using <code>fieldView</code> as a function? I'm quite stumped right now. I tried using <code>ScopedTypeVariables</code> to link <code>m</code> to <code>m0</code>, but it didn't work and I don't see why it would even be needed. What's stopping <code>m</code> from matching with <code>m0</code>?</p>\n\n<p>EDIT: I just tried:</p>\n\n<pre><code>textField\n  :: ( Monad m\n     , RenderMessage (HandlerSite m) FormMessage\n     )\n  =&gt; Field m Text\ntextField = I.textField\n    { fieldView = fieldView\n    }\n  where\n    Field {..} = I.textField\n</code></pre>\n\n<p>And it failed, so I guess the problem is related with mentioning <code>I.textField</code> twice. This is weird. It's not like <code>I.textField</code> is a type-class member with multiple definitions to select from, and, even if it were, I don't see what's stopping ghc from deducing that <code>m</code> and <code>m0</code> are the same.... ok <code>HandlerSite</code> is a type family, so I guess from the type checker's point of view it could lead to different instances of <code>RenderMessage</code> and so different definitions of code that's somehow linked to <code>I.textField</code>. I think I'm starting to see the light.</p>\n\n<p>EDIT 2: I thought I could link them like this:</p>\n\n<pre><code>textField\n  :: ( Monad m\n     , RenderMessage (HandlerSite m) FormMessage\n     )\n  =&gt; Field m Text\ntextField = (I.textField :: Field m Text)\n    { fieldView = fieldView (I.textField :: Field m Text)\n    }\n</code></pre>\n\n<p>with <code>ScopedTypeVariables</code> on, but apparently not.</p>\n\n<p>EDIT 3: Following the logic, this works:</p>\n\n<pre><code>textField\n  :: ( Monad m\n     , RenderMessage (HandlerSite m) FormMessage\n     )\n  =&gt; Field m Text\ntextField = f\n    { fieldView = fieldView f\n    }\n  where\n    f = I.textField\n</code></pre>\n\n<p>So I guess this has something to do with top-level vs local bindings?</p>\n"}, {"tags": ["function", "haskell", "types"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1539832082, "post_id": 52866334, "comment_id": 92646621, "body": "What error are you getting?"}, {"owner": {"reputation": 85, "user_id": 8742634, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g78O90RGcI0/AAAAAAAAAAI/AAAAAAAAADI/i9Q-VoFcpl0/photo.jpg?sz=128", "display_name": "Horsy", "link": "https://stackoverflow.com/users/8742634/horsy"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1539832728, "post_id": 52866334, "comment_id": 92646743, "body": "It suggested me to use ord? updated with error :)"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1539832977, "post_id": 52866334, "comment_id": 92646785, "body": "Have you tried following the advice of the compiler?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539833074, "post_id": 52866334, "comment_id": 92646805, "body": "<code>&gt;=</code> is not applicable to all numbers, what about complex ones. Hence Num and Ord are separate independent things in Haskell."}, {"owner": {"reputation": 85, "user_id": 8742634, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g78O90RGcI0/AAAAAAAAAAI/AAAAAAAAADI/i9Q-VoFcpl0/photo.jpg?sz=128", "display_name": "Horsy", "link": "https://stackoverflow.com/users/8742634/horsy"}, "edited": false, "score": 0, "creation_date": 1539833126, "post_id": 52866334, "comment_id": 92646811, "body": "Update: I finally manage to solve it!!!! I use         offSetter :: (Num a, Ord a) =&gt; a -&gt; a -&gt; a .. So Ord is used because there are elements like Strings that is not applicable to Num?"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1539833216, "post_id": 52866334, "comment_id": 92646831, "body": "Put the answer in the answer section for the next learner. Good job!"}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1539834133, "post_id": 52866589, "comment_id": 92647023, "body": "That&#39;s perfect. You have to do this because although (as far as I know) there are no stdlib types that implement <code>Num</code> and not <code>Ord</code>, it&#39;s not outside of the realm of possibility that there would be something <code>Num</code>y that&#39;s not orderable."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 4, "creation_date": 1539840573, "post_id": 52866589, "comment_id": 92648564, "body": "@AdamSmith <code>Complex</code> is in the standard library and implements <code>Num</code> but not <code>Ord</code>. (This is because it is not possible to make an <code>Ord</code> instance that has the property that if <code>a &lt;= b</code> and <code>c &lt;= d</code> then <code>a+c &lt;= b+d</code>; I think it&#39;s a bad reason, but that&#39;s the reason.)"}, {"owner": {"reputation": 403, "user_id": 3554119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79421d48f8e4e753ab9ec19b3a964b7?s=128&d=identicon&r=PG&f=1", "display_name": "dirkt", "link": "https://stackoverflow.com/users/3554119/dirkt"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1539851835, "post_id": 52866589, "comment_id": 92653743, "body": "@DanielWagner <code>Ord</code> codifies a <a href=\"https://en.wikipedia.org/wiki/Total_order\" rel=\"nofollow noreferrer\">total order</a>, and there&#39;s no &quot;sensible&quot; total order on the complex numbers. Yours is a <a href=\"https://en.wikipedia.org/wiki/Partially_ordered_set\" rel=\"nofollow noreferrer\">partial order</a>. One could generalize <code>offSetter</code> e.g. by using <code>abs number1 &gt;= abs offSet</code> instead of <code>number1 - offset &gt;= 0</code>, then it doesn&#39;t need a total ordering."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 403, "user_id": 3554119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79421d48f8e4e753ab9ec19b3a964b7?s=128&d=identicon&r=PG&f=1", "display_name": "dirkt", "link": "https://stackoverflow.com/users/3554119/dirkt"}, "edited": false, "score": 0, "creation_date": 1539874333, "post_id": 52866589, "comment_id": 92667050, "body": "@dirkt You say &quot;Yours is a partial order.&quot;. But I didn&#39;t say what mine was. So how can you know that? You say &quot;There&#39;s no &#39;sensible&#39; total order on the complex numbers.&quot;. What does &quot;sensible&quot; mean? I assume you mean &quot;that has the property that if <code>a &lt;= b</code> and <code>c &lt;= d</code> then <code>a+c &lt;= b+d</code>&quot;; if so, I&#39;m well aware that no total order has that property, as you can see from my previous comment where I myself point that out. But I don&#39;t think that&#39;s an important property for an <code>Ord</code> instance to have -- and it certainly isn&#39;t promised by the documentation for <code>Ord</code>!"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1539874425, "post_id": 52866589, "comment_id": 92667116, "body": "@DanielWagner dirkt is talking about the properties of complex numbers, not the properties of total orders. There is no total order defined for complex numbers. This comes straight from the mathematics and has nothing to do with Haskell, per se. See <a href=\"https://en.wikipedia.org/wiki/Total_order\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Total_order</a> for more information about what we mean by &quot;total order&quot;. The <code>Ord</code> class in Haskell implements the mathematical properties of a total order."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1539874540, "post_id": 52866589, "comment_id": 92667200, "body": "@Code-Apprentice That is not correct. There&#39;s many perfectly good total orders on complex numbers, provided the wrapped type itself has a total order. <code>compare (a :+ b) (c :+ d) = compare (a, b) (c, d)</code> is one."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1539874770, "post_id": 52866589, "comment_id": 92667347, "body": "@DanielWagner Okay, I spoke too quickly. Still if there are &quot;many good total orders&quot; on complex numbers how do you choose one of these as the canonical one?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1539874850, "post_id": 52866589, "comment_id": 92667413, "body": "@Code-Apprentice There are also many good total orders on tuples. Should we avoid defining <code>instance (Ord a, Ord b) =&gt; Ord (a, b)</code>?"}], "tags": [], "owner": {"reputation": 85, "user_id": 8742634, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g78O90RGcI0/AAAAAAAAAAI/AAAAAAAAADI/i9Q-VoFcpl0/photo.jpg?sz=128", "display_name": "Horsy", "link": "https://stackoverflow.com/users/8742634/horsy"}, "is_accepted": false, "score": 5, "last_activity_date": 1539833541, "last_edit_date": 1539833541, "creation_date": 1539833355, "answer_id": 52866589, "question_id": 52866334, "link": "https://stackoverflow.com/questions/52866334/haskell-generic-type/52866589#52866589", "title": "Haskell Generic Type", "body": "<p>Solved it by adding Ord a:</p>\n\n<pre><code>offSetter :: (Num a, Ord a) =&gt; a -&gt; a -&gt; a\noffSetter number1 offSet\n    | number1 - offSet &gt;= 0 = number1 - offSet\n    | otherwise = 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": false, "score": 4, "last_activity_date": 1539833821, "creation_date": 1539833821, "answer_id": 52866644, "question_id": 52866334, "link": "https://stackoverflow.com/questions/52866334/haskell-generic-type/52866644#52866644", "title": "Haskell Generic Type", "body": "<p>As you discovered, you need to add the type class <code>Ord</code> as a constraint to the type <code>a</code> with the following type signature:</p>\n\n<pre><code>offSetter :: (Num a, Ord a) =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>This is because <code>Ord</code> is the typeclass with comparison operators like <code>(&gt;=)</code>.</p>\n\n<blockquote>\n  <p>So Ord is used because there are elements like Strings that is not applicable to Num?</p>\n</blockquote>\n\n<p>No, since <code>String</code> is not a member of the <code>Num</code> typeclass, the original declaration already excludes it as a possible candidate for the type <code>a</code>. As I stated earlier, you need to use <code>Ord</code> in order to guarantee that the type <code>a</code> has the operator <code>(&gt;=)</code> available.</p>\n"}], "owner": {"reputation": 85, "user_id": 8742634, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g78O90RGcI0/AAAAAAAAAAI/AAAAAAAAADI/i9Q-VoFcpl0/photo.jpg?sz=128", "display_name": "Horsy", "link": "https://stackoverflow.com/users/8742634/horsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1539833821, "creation_date": 1539831512, "last_edit_date": 1539833451, "question_id": 52866334, "link": "https://stackoverflow.com/questions/52866334/haskell-generic-type", "title": "Haskell Generic Type", "body": "<p>So I just started learning Haskell and I have been stuck on this for quite some time already. So I have a function that calculates a number after an offset has been minus (minimum value is 0). I managed to do this function with the types explicitly shown.</p>\n\n<pre><code>offSetter :: Int -&gt; Int -&gt; Int\noffSetter number offset\n    | number - offset &gt;= 0 = number - offset\n    | otherwise = 0\n</code></pre>\n\n<p>But when I tried to change it to use generic types as below, it keeps giving me an error. Am I doing it wrong?</p>\n\n<pre><code>offSetter :: Num a =&gt; a -&gt; a -&gt; a\noffSetter number offset\n    | number - offset &gt;= 0 = number - offset\n    | otherwise = 0\n</code></pre>\n\n<p>The error I'm getting:</p>\n\n<pre><code>* Could not deduce (Ord a) arising from a use of '&gt;='\n      from the context: Num a\n        bound by the type signature for:\n                   offSetter :: forall a. Num a =&gt; a -&gt; a -&gt; a\n        at src\\test.hs:57:1-33\n      Possible fix:\n        add (Ord a) to the context of\n          the type signature for:\n            offSetter :: forall a. Num a =&gt; a -&gt; a -&gt; a\n    * In the expression: number - offset &gt;= 0\n      In a stmt of a pattern guard for\n                     an equation for `offSetter':\n        number - offset &gt;= 0\n</code></pre>\n"}]