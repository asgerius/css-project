[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 6, "creation_date": 1538594573, "post_id": 52634149, "comment_id": 92201847, "body": "AFAIK that text should be prefixed by  <code>Warning:</code> which tells you that <i>this is not an error</i>. The code is compiling fine. Your problem is similar to <a href=\"https://stackoverflow.com/questions/21892249/avoid-warning-defaulting-the-following-constraints-to-type-integer\">this question</a>. You could fix it by adding type signatures on the relevant functions/variables."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1538595641, "post_id": 52634149, "comment_id": 92202328, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21892249/avoid-warning-defaulting-the-following-constraints-to-type-integer\">Avoid warning Defaulting the following constraint(s) to type `Integer&#39;</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1538595974, "post_id": 52634149, "comment_id": 92202482, "body": "N.B. you aren&#39;t using <code>differenceInDays</code> at all. Assuming you intended to use it in your <code>if</code> condition, though, there&#39;s no reason to call <code>floor</code> anyway: <code>floor x &gt;= 0 &amp;&amp; floor x &lt;= 16</code> is the same as <code>x &gt;= 0 &amp;&amp; x &lt; 17</code> for any sensible type."}], "owner": {"reputation": 11, "user_id": 8077066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ErFZpNV8j6s/AAAAAAAAAAI/AAAAAAAAAjA/C-JGpUL5xW0/photo.jpg?sz=128", "display_name": "MixFix Chanel", "link": "https://stackoverflow.com/users/8077066/mixfix-chanel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538596659, "creation_date": 1538593926, "last_edit_date": 1538596659, "question_id": 52634149, "link": "https://stackoverflow.com/questions/52634149/why-cant-i-use-the-function-floor", "title": "Why can&#39;t I use the function floor?", "body": "<p>My code: </p>\n\n<pre><code>getDateFromUser :: IO (Either UserError UTCTime)\ngetDateFromUser = do\n  Prelude.putStrLn \"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0434\u043b\u044f \u043f\u0440\u043e\u0433\u043d\u043e\u0437\u0430 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u0413\u0413\u0413\u0413-\u041c\u041c-\u0414\u0414:\"\n  currentTime &lt;- getCurrentTime\n  date        &lt;- Prelude.getLine\n  let dayFromUser = parseTimeM True defaultTimeLocale \"%Y-%-m-%-d\" date :: Maybe UTCTime\n  case dayFromUser of\n    Nothing -&gt; return $ Left InvalidDate\n    Just validDay -&gt; do\n       let differenceInNominalDiffTime = diffUTCTime validDay currentTime\n           differenceInDays            = floor $ differenceInNominalDiffTime / nominalDay\n       if  differenceInNominalDiffTime &gt;= 0 &amp;&amp; differenceInNominalDiffTime &lt;= 16\n           then return $ Right validDay\n           else return $ Left InvalidDate\n</code></pre>\n\n<p>Without <code>floor</code> this code is compiled. But but with <code>floor</code> i get this error</p>\n\n<pre><code>Defaulting the following constraint to type \u2018Integer\u2019\n    Integral b0 arising from a use of \u2018floor\u2019\n\u2022 In the expression:\n    floor $ differenceInNominalDiffTime / nominalDay\n  In an equation for \u2018differenceInDays\u2019:\n      differenceInDays = floor $ differenceInNominalDiffTime / nominalDay\n  In the expression:\n    do let differenceInNominalDiffTime\n             = diffUTCTime validDay currentTime\n           differenceInDays = floor $ differenceInNominalDiffTime / nominalDay\n       if differenceInNominalDiffTime &gt;= 0\n            &amp;&amp; differenceInNominalDiffTime &lt;= 16 then\n           return $ Right validDay\n       else\n           return $ Left InvalidDate \n</code></pre>\n\n<p><code>37 |            differenceInDays            = floor $ differenceInNominalDiffTime / nominalDay</code></p>\n\n<p>What is this error and how to fix it?</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1538598975, "post_id": 52634900, "comment_id": 92203824, "body": "The #1 blocker is Template Haskell for me, actually. Unfortunately it also prevents the use of <code>makeLenses</code>. We can only hope this restriction gets lifted someday."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1538599153, "post_id": 52634900, "comment_id": 92203899, "body": "It can&#39;t be lifted, without giving up on the guaranty that a safe module can only use symbols other modules willingly exported. TH can be used to circumvent that, the ghc manual claims. (I am not a TH user much and doesn&#39;t know, how that &quot;circumvention&quot; would work.)"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 2, "creation_date": 1538615466, "post_id": 52634900, "comment_id": 92208198, "body": "I&#39;ve edited the answer for clarity, but I&#39;d like to add (and I didn&#39;t edit this in because I think it&#39;s a substantial change in meaning) that, while letting <code>Safe</code> and <code>Unsafe</code> be inferred is usually fine, some libraries should declare themselves <code>Trustworthy</code>. When used in a library, <code>Safe</code> and <code>Unsafe</code> mean &quot;the API exported by this module is safe/unsafe.&quot; <code>Trustworthy</code> means &quot;the API exported is safe, but the implementation isn&#39;t.&quot; A library may not directly be used in a <code>Safe</code> context, but its users might be, so it should be nice and mark its safe API as such to let those users use it."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1538629146, "post_id": 52634900, "comment_id": 92211068, "body": "@HTNW: Your right, I should add this. Will do, when I am back from work."}], "tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 6, "last_activity_date": 1538773154, "last_edit_date": 1538773154, "creation_date": 1538597216, "answer_id": 52634900, "question_id": 52633292, "link": "https://stackoverflow.com/questions/52633292/should-i-make-my-haskell-modules-safe-by-default/52634900#52634900", "title": "Should I make my Haskell modules Safe by default?", "body": "<p>As you can read in the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/safe_haskell.html#safe-language\" rel=\"nofollow noreferrer\">GHC user manual</a>, if you mark your modules <code>Safe</code>, you are restricted to a certain \"safe\" subset of the Haskell language.</p>\n\n<ol>\n<li>You can only import modules which are also marked <code>Safe</code> (which rules out functions like <code>unsafeCoerce</code> or <code>unsafePerformIO</code>).</li>\n<li>You can't use Template Haskell.</li>\n<li>You can't use FFI outside of <code>IO</code>.</li>\n<li>You can't use <code>GeneralisedNewtypeDeriving</code>.</li>\n<li>You can't manually implement the <code>Generic</code> typeclass for the types you define in your module.</li>\n<li>etc.</li>\n</ol>\n\n<p>In exchange, the users of the module gain a bunch of guarantees (quoting from the manual):</p>\n\n<blockquote>\n  <ul>\n  <li>Referential transparency \u2014 The types can be trusted. Any pure function, is guaranteed to be pure. Evaluating them is deterministic\n  and won\u2019t cause any side effects. Functions in the <code>IO</code> monad are still\n  allowed and behave as usual. So, for example, the <code>unsafePerformIO ::\n  IO a -&gt; a</code> function is disallowed in the safe language to enforce this\n  property.</li>\n  <li>Module boundary control \u2014 Only symbols that are publicly available through other module export lists can be accessed in the safe\n  language. Values using data constructors not exported by the defining\n  module, cannot be examined or created. As such, if a module <code>M</code>\n  establishes some invariants through careful use of its export list,\n  then code written in the safe language that imports <code>M</code> is guaranteed to\n  respect those invariants.</li>\n  <li>Semantic consistency \u2014 For any module that imports a module written in the safe language, expressions that compile both with and without\n  the safe import have the same meaning in both cases. That is,\n  importing a module written in the safe language cannot change the\n  meaning of existing code that isn\u2019t dependent on that module. So, for\n  example, there are some restrictions placed on the use of\n  <code>OverlappingInstances</code>, as these can violate this property.</li>\n  <li>Strict subset \u2014 The safe language is strictly a subset of Haskell as implemented by GHC. Any expression that compiles in the safe language\n  has the same meaning as it does when compiled in normal Haskell.</li>\n  </ul>\n</blockquote>\n\n<p>Note that safety is inferred. If your module is not marked with any of <code>Safe</code>, <code>Trustworthy</code>, or <code>Unsafe</code>, GHC will infer the safety of the module to <code>Safe</code> or <code>Unsafe</code>. When you set the <code>Safe</code> flag, then GHC will issue an error if it decides the module is not actually safe. You can also set <code>-Wunsafe</code>, which emits a warning if a module is inferred to be unsafe. If you let it be inferred, your module will continue to compile even if your dependencies' safety statuses change. If you write it out, you promise to your users that the safety status is stable and dependable.</p>\n\n<p>One use case described in the manual refers to running \"untrusted\" code. If you provide extension points of any kind in your product and you want to make sure that those capabilities aren't used to attack your product, you can require the code for the extension points to be marked <code>Safe</code>.</p>\n\n<p>You can mark your module <code>Trustworthy</code> and this doesn't restrict you in any way while implementing your module. Your module might be used from <code>Safe</code> code then and it is your responsibility to not violate the guaranties, that should be given by <code>Safe</code> code. So this is a promise, you the author of said module, give. You can use the flag <code>-fpackage-trust</code> to enable extra checks while compiling modules marked as <code>Trustworthy</code> described <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/safe_haskell.html#safe-trust\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>So, if you write normal libraries and don't have a good reason to care about Safe Haskell, then you probably shouldn't care. If your modules are safe, thats fine and can be inferred. If not, then this is probably for a reason, like because you used <code>unsafePerformIO</code>, which is also fine. If you know your module will be used in a way that requires it to compile under <code>-XSafe</code> (e.g. plugins, as above), you should do it. In all other cases, don't bother.</p>\n"}], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 52634900, "answer_count": 1, "score": 5, "last_activity_date": 1538773154, "creation_date": 1538590330, "question_id": 52633292, "link": "https://stackoverflow.com/questions/52633292/should-i-make-my-haskell-modules-safe-by-default", "title": "Should I make my Haskell modules Safe by default?", "body": "<p>Is there any downside to marking the modules <code>Safe</code>? Should it be the assumed default?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 1, "creation_date": 1538589297, "post_id": 52632360, "comment_id": 92199252, "body": "I suspect there is no tool for it. Why do you need something like this?"}, {"owner": {"reputation": 132, "user_id": 4614475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4d6a64b3933ddea2ef5c18a82c88019?s=128&d=identicon&r=PG&f=1", "display_name": "user4614475", "link": "https://stackoverflow.com/users/4614475/user4614475"}, "reply_to_user": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1538590471, "post_id": 52632360, "comment_id": 92199865, "body": "@radrow I&#39;m working with a tool that consumes haskell code and the output with typeclass-heavy code is ugly/difficult/impossible to work with."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1538597437, "post_id": 52632360, "comment_id": 92203144, "body": "There&#39;s no way to completely remove type classes in the general case: in <code>bar :: C a =&gt; a -&gt; a ; bar x = foo (foo x)</code> we can&#39;t replace <code>foo</code> with anything."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1539058747, "post_id": 52712529, "comment_id": 92352249, "body": "I don&#39;t think <code>-ddump-spec</code> goes far enough. Lots of specialization is done afterwards by the simplifier using specialization rules. But maybe that gets you the first round?"}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 0, "last_activity_date": 1539052306, "creation_date": 1539052306, "answer_id": 52712529, "question_id": 52632360, "link": "https://stackoverflow.com/questions/52632360/inlining-functions-within-haskell-source-code/52712529#52712529", "title": "inlining functions within haskell source code", "body": "<p>With the argument <code>-ddump-spec</code>, GHC will print the Core program after specializing polymorphic functions.  Core isn't quite Haskell; depending what you're doing, it might be easier or harder to work with.  This and related options are documented in <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/debugging.html#core-representation-and-simplification\" rel=\"nofollow noreferrer\">the GHC manual</a></p>\n\n<p>As noted in the comments, not every type-class constrained function is specialized during compilation.  Some dictionaries are passed at runtime.</p>\n"}], "owner": {"reputation": 132, "user_id": 4614475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4d6a64b3933ddea2ef5c18a82c88019?s=128&d=identicon&r=PG&f=1", "display_name": "user4614475", "link": "https://stackoverflow.com/users/4614475/user4614475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539052306, "creation_date": 1538586776, "question_id": 52632360, "link": "https://stackoverflow.com/questions/52632360/inlining-functions-within-haskell-source-code", "title": "inlining functions within haskell source code", "body": "<p>Is there a way to produce a haskell source file with inlined definitions from an existing haskell source file?  Specifically, I'm interested in taking something like the following:</p>\n\n<pre><code>class C a where\n    foo :: a -&gt; a\n\ninstance  C Bool where\n    foo = not\n\nbar :: Bool -&gt; Bool\nbar x = foo (foo x)\n</code></pre>\n\n<p>and removing references to the typeclass to produce this:</p>\n\n<pre><code>bar :: Bool -&gt; Bool\nbar x = not (not x)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1538586804, "post_id": 52632193, "comment_id": 92197969, "body": "What particular problem are you having in writing such a function?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538587683, "post_id": 52632193, "comment_id": 92198429, "body": "i wrote this : extractFirst :: (a, b, c) -&gt; a extractFirst (a,<i>,</i>) = a  extractSirst :: (a, b, c) -&gt; a extractSirst (<i>,a,</i>) = a  extractTirst :: (a, b, c) -&gt; a extractTirst (<i>,</i>,a) = a  sumTriplos :: (Num a, Num b, Num c) =&gt; [(a,b,c)] -&gt; (a,b,c) sumTriplos [(a,b,c)] = (a,b,c) sumTriplos (h:a:t) = sumTriplos ((extractFirst h)+(extractFirst a),(extractSirst h)+(extractSirst a),(extractTirst h)+(extractTirst a)) t"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538587767, "post_id": 52632193, "comment_id": 92198471, "body": "Please add the code to the question, not in a comment."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538588142, "post_id": 52632193, "comment_id": 92198669, "body": "extractFirst :: (a, b, c) -&gt; a extractFirst (a,,) = a extractSirst :: (a, b, c) -&gt; a extractSirst (,a,) = a extractTirst :: (a, b, c) -&gt; a extractTirst (,,a) = a sumTriplos :: (Num a, Num b, Num c) =&gt; [(a,b,c)] -&gt; (a,b,c) sumTriplos [(a,b,c)] = (a,b,c) sumTriplos (h:a:t) = sumTriplos ((extractFirst h)+(extractFirst a),(extractSirst h)+(extractSirst a),(extractTirst h)+(extractTirst a)) t"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538588437, "post_id": 52632193, "comment_id": 92198811, "body": "im sry i paste the wrong code but now is wright."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538588495, "post_id": 52632193, "comment_id": 92198844, "body": "Again, edit your <i>question</i> with your code; don&#39;t put it in a comment, where it is barely readable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538588796, "post_id": 52632193, "comment_id": 92198996, "body": "i dont know ho to do it"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538589090, "post_id": 52632193, "comment_id": 92199127, "body": "There should be an &quot;edit&quot; link you can click just below the question."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "edited": false, "score": 0, "creation_date": 1538587829, "post_id": 52632594, "comment_id": 92198491, "body": "yeah but i want to sum a list of triples not just two"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1538587901, "post_id": 52632594, "comment_id": 92198527, "body": "did you try with your list input?  <code>sumTriplos [(...</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538588326, "post_id": 52632594, "comment_id": 92198761, "body": "@PedroNovais That&#39;s what <code>foldr</code> does. It starts with a current answer of <code>(0,0,0)</code>, then applies <code>sumt</code> to a list item and the current answer to get a new answer, until it was consumed the entire list, at which point the current answer is the final answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "edited": false, "score": 0, "creation_date": 1538588393, "post_id": 52632594, "comment_id": 92198786, "body": "yeah but this is one of the questions for my test and i cant use foldr"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "edited": false, "score": 0, "creation_date": 1538588782, "post_id": 52632594, "comment_id": 92198987, "body": "no ahah i have this questions to prepare for my test"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1538591491, "post_id": 52632594, "comment_id": 92200309, "body": "Then, you have to write your own recursive <code>fold</code> function to iterate over the list and add the elements to the running sum."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1538587693, "creation_date": 1538587693, "answer_id": 52632594, "question_id": 52632193, "link": "https://stackoverflow.com/questions/52632193/haskell-lists-sum-triples/52632594#52632594", "title": "Haskell lists sum triples", "body": "<p>a simple fold?</p>\n\n<pre><code>sumTriplos = foldr sumt (0,0,0) \n   where sumt (x,y,z) (a,b,c) = (x+a,y+b,z+c)\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "edited": false, "score": 0, "creation_date": 1538596400, "post_id": 52633973, "comment_id": 92202670, "body": "terminal : (*** Exception: fichas.hs:(149,1)-(150,26): Non-exhaustive patterns in function sumTriplos)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1538593142, "creation_date": 1538593142, "answer_id": 52633973, "question_id": 52632193, "link": "https://stackoverflow.com/questions/52632193/haskell-lists-sum-triples/52633973#52633973", "title": "Haskell lists sum triples", "body": "<p><code>sumTriplos</code> takes a single argument, a list. Your recursive call, though, is given <em>two</em> arguments, the sum of the first two tuples and the remaining tuples. You want to add the first tuple to the <em>result</em> of the recursive call on the remaining tuples.</p>\n\n<p>Instead of (with the <code>extract*</code> functions abbreviated)</p>\n\n<pre><code>sumTriplos (h:a:t) = sumTriplos ((ef h + ef a), (es h + es a), (et h + et a)) t\n</code></pre>\n\n<p>you want something like</p>\n\n<pre><code>sumTriplos (h:t) = (ef h + ef r, es h + es r, et h + et r)\n    where r = sumTriplos t\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 52633973, "answer_count": 2, "score": -5, "last_activity_date": 1538593142, "creation_date": 1538586096, "last_edit_date": 1538590997, "question_id": 52632193, "link": "https://stackoverflow.com/questions/52632193/haskell-lists-sum-triples", "title": "Haskell lists sum triples", "body": "<pre><code>sumTriplos :: (Num a, Num b, Num c) =&gt; [(a,b,c)] -&gt; (a,b,c)\n</code></pre>\n\n<p>I want a function that sums all the triples in a list and returns one with all the sums like this : </p>\n\n<pre><code>sumTriplos [(2,4,11), (3,1,-5), (10,-3,6)] = (15,2,12)\n</code></pre>\n\n<p>code : </p>\n\n<pre><code>extractFirst :: (a, b, c) -&gt; a \nextractFirst (a,,) = a \n\nextractSirst :: (a, b, c) -&gt; a \nextractSirst (,a,) = a \n\nextractTirst :: (a, b, c) -&gt; a \nextractTirst (,,a) = a \n\nsumTriplos :: (Num a, Num b, Num c) =&gt; [(a,b,c)] -&gt; (a,b,c) \nsumTriplos [(a,b,c)] = (a,b,c) \nsumTriplos (h:a:t) = sumTriplos ((extractFirst h)+(extractFirst a),(extractSirst h)+(extractSirst a),(extractTirst h)+(extractTirst a)) t \n</code></pre>\n"}, {"tags": ["haskell", "recursion", "specifications"], "comments": [{"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 1, "creation_date": 1538585966, "post_id": 52631881, "comment_id": 92197547, "body": "Is this homework, or what&#39;s the context..? Maybe this is a better fit for <a href=\"http://codereview.stackexchange.com\">codereview.stackexchange.com</a>, but hard to tell..."}, {"owner": {"reputation": 203, "user_id": 9952780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2469a9716383b916f6db1205853858?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Browne", "link": "https://stackoverflow.com/users/9952780/patrick-browne"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1538586258, "post_id": 52631881, "comment_id": 92197699, "body": "@mb21 Definitely not homework. I am a Phd student studying the effectiveness of Haskell as an algebraic specification language as claimed in the cited <a href=\"https://www.researchgate.net/publication/225122360_An_Image-Schematic_Account_of_Spatial_Categories\" rel=\"nofollow noreferrer\">paper</a>."}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1538588046, "post_id": 52631881, "comment_id": 92198606, "body": "well, the paper is 11 years old and recommends hugs, which AFAIK is no longer recommended... but yeah, if the question is can some kinds of rooms, houses and people be modelled in Haskell, that&#39;s something a programmer could work with ;)"}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 9952780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2469a9716383b916f6db1205853858?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Browne", "link": "https://stackoverflow.com/users/9952780/patrick-browne"}, "edited": false, "score": 0, "creation_date": 1538590515, "post_id": 52633042, "comment_id": 92199879, "body": "So despite my misgivings 1) and 2), my code actually seems to satisfies the Textual Description."}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "reply_to_user": {"reputation": 203, "user_id": 9952780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2469a9716383b916f6db1205853858?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Browne", "link": "https://stackoverflow.com/users/9952780/patrick-browne"}, "edited": false, "score": 0, "creation_date": 1538591010, "post_id": 52633042, "comment_id": 92200088, "body": "@PatrickBrowne so, it <i>does</i> answer your question then? :) I&#39;ve only skimmed the paper... but personally, I&#39;m highly skeptical of modelling general human semantics in <i>any</i> formal language... see e.g. <a href=\"https://web.archive.org/web/20150626063921/http://www.betaversion.org/~stefano/linotype/news/431/\" rel=\"nofollow noreferrer\">web.archive.org/web/20150626063921/http://www.betaversion.or&zwnj;&#8203;g/&hellip;</a>"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "reply_to_user": {"reputation": 203, "user_id": 9952780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2469a9716383b916f6db1205853858?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Browne", "link": "https://stackoverflow.com/users/9952780/patrick-browne"}, "edited": false, "score": 0, "creation_date": 1538636363, "post_id": 52633042, "comment_id": 92213987, "body": "@PatrickBrowne feel free to accept the answer then, or clarify your question."}, {"owner": {"reputation": 203, "user_id": 9952780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2469a9716383b916f6db1205853858?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Browne", "link": "https://stackoverflow.com/users/9952780/patrick-browne"}, "edited": false, "score": 0, "creation_date": 1538637522, "post_id": 52633042, "comment_id": 92214579, "body": "I think that your solution has the same issues 1),2), and 3) (just added) as my own attempt. I could be wrong, any clarification would be welcome."}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "reply_to_user": {"reputation": 203, "user_id": 9952780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2469a9716383b916f6db1205853858?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Browne", "link": "https://stackoverflow.com/users/9952780/patrick-browne"}, "edited": false, "score": 0, "creation_date": 1538657825, "post_id": 52633042, "comment_id": 92226396, "body": "well, about 1.) that &quot;specification&quot; is very ambiguous, so not sure what you want us to do here... clarify the specification? that wouldn&#39;t be a good fit for stackoverflow... I added a few sentences addressing 2.) Finally, 3.): you&#39;re free to redefine identity (i.e. <code>Eq</code>) in any way you see fit..."}, {"owner": {"reputation": 203, "user_id": 9952780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2469a9716383b916f6db1205853858?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Browne", "link": "https://stackoverflow.com/users/9952780/patrick-browne"}, "edited": false, "score": 0, "creation_date": 1538667223, "post_id": 52633042, "comment_id": 92232913, "body": "Yes, given the errors and ambiguity,I think the solution is about as near as possible to the specification. Thanks for your help."}], "tags": [], "owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "is_accepted": false, "score": 1, "last_activity_date": 1538597737, "last_edit_date": 1538597737, "creation_date": 1538589409, "answer_id": 52633042, "question_id": 52631881, "link": "https://stackoverflow.com/questions/52631881/to-what-degree-does-this-haskell-code-satisfy-this-specification/52633042#52633042", "title": "To what degree does this Haskell code satisfy this specification?", "body": "<p>With some minimal changes, at least it compiles in GHC:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n\ndata Room  = Room Int deriving (Show,Eq)\ndata Rooms = Rooms [Room] deriving (Show,Eq)\n\ndata House  =  House Int Rooms deriving (Show,Eq)\ndata Person = Person {container :: House }  deriving (Show,Eq)\n\ngetRooms :: House -&gt; Rooms\ngetRooms (House n rooms) = rooms\n\ngetHouse :: Person -&gt; House\ngetHouse p = container p \n\ngetRoom :: House -&gt; Room\ngetRoom (House n (Rooms (x:xs)))  = x\n\nclass Containment c f where\n isIn :: f -&gt; c -&gt; Bool\n\ninstance Containment House  Person where\n isIn person (House n (Rooms rooms)) = (container person) ==  (House n (Rooms rooms)) || isIn person (getRooms (House n (Rooms rooms)))\n\ninstance Containment Rooms Person where\n isIn person (Rooms []) = False\n isIn person (Rooms (room:rooms)) = (room == getRoom(getHouse(person))) ||  isIn person (Rooms rooms)\n\nr1 = Room 1\nr2 = Room 2\nh1 = House 1 (Rooms [])\nh2 = House 2 (Rooms [r1])\nh3 = House 3 (Rooms [r1,r2])\np1 = Person {container = h1}\np2 = Person {container = h2}\np3 = Person {container = h3}\npersonInHoseNoRooms      = isIn p1 h1\npersonInHoseNoRoomsNotIn = isIn p1 h2\npersonInRoomInHouse      = isIn p2 h2\npersonIn2ndRoomInHouse   = isIn p3 h3\n</code></pre>\n\n<p>So regarding your question, yes it can be implemented in Haskell.</p>\n\n<p>Regarding the statement:</p>\n\n<blockquote>\n  <p>if the house contains her or, recursively, if the house contains a container (e.g., a room) containing her.</p>\n</blockquote>\n\n<p>I agree with you that <code>recursively</code> is not the right word, it should be <code>transitively</code>.</p>\n"}], "owner": {"reputation": 203, "user_id": 9952780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2469a9716383b916f6db1205853858?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Browne", "link": "https://stackoverflow.com/users/9952780/patrick-browne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545564717, "creation_date": 1538584863, "last_edit_date": 1545564717, "question_id": 52631881, "link": "https://stackoverflow.com/questions/52631881/to-what-degree-does-this-haskell-code-satisfy-this-specification", "title": "To what degree does this Haskell code satisfy this specification?", "body": "<p><strong>Listing 1</strong> is a Haskell class signature and instance from a <a href=\"https://www.researchgate.net/publication/225122360_An_Image-Schematic_Account_of_Spatial_Categories\" rel=\"nofollow noreferrer\">paper</a>.\nThe <code>isIn person house</code> function is supposed to return true if a person is in a given house or a given room.</p>\n\n<p><strong>Listing 1</strong></p>\n\n<pre><code>class CONTAINMENT container for where\n isIn :: for -&gt; container -&gt; Bool\n\n\ninstance CONTAINMENT House Person where\n isIn person house =\n         (container person = house) || isIn (container person) house\n</code></pre>\n\n<p>There are errors in the definition of <code>isIn person house</code>, which I wish to ignore for this post. </p>\n\n<p>Instead I wish to consider <strong>Listing 1</strong> together with the <strong>Textual Description</strong> below  (from the <a href=\"https://www.researchgate.net/publication/225122360_An_Image-Schematic_Account_of_Spatial_Categories\" rel=\"nofollow noreferrer\">paper</a>) as a <strong>Specification</strong> (i.e. a reasonable representation of the specifiers intention).</p>\n\n<p><strong>Textual Description</strong></p>\n\n<blockquote>\n  <p>The axiom for isIn uses variables for individuals of type Person\n  (person) and House (house) and states that the person is in the house\n  if the house contains her or, recursively, if the house contains a\n  container (e.g., a room) containing her. To state this, I use a\n  representation of state as a labeled field container, here assumed to\n  be defined for person types.</p>\n</blockquote>\n\n<p>From the <strong>Specification</strong> it seems that:</p>\n\n<ul>\n<li>A person may be in a room. </li>\n<li>A room may be in a house. </li>\n<li>A person may be directly in a house, without any room information.</li>\n<li>A person may be in a room that is in a house and thus may be deemed to be in the house.</li>\n<li>To be useful, the room needs information about the house containing it.</li>\n<li>The person contains information about their location. Can a person be both in a room and in the house containing the room? In other words do we have an inclusive or exclusive or in <code>isIn</code>?</li>\n<li><p>From the real world domain: every room must be in a house, it is impossible to be in a room that is not in a house.</p>\n\n<p><strong>Listing 2</strong> is my attempt to write Haskell code to implement the <strong>Specification</strong>. I added helper functions (<code>getHouse</code>,<code>getRoom</code>,<code>getRooms</code>) and a <code>CONTAINER</code> instance for <code>Room</code> giving an overloaded <code>isIn</code> for both <code>House</code> and <code>Room</code>.I also added data types for \n<code>House</code>, <code>Room</code>, and <code>Person</code>.</p></li>\n</ul>\n\n<p><strong>Listing 2</strong></p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n    data Room  = Room Int deriving (Show,Eq)\n    data Rooms = Rooms  [Room]  deriving (Show,Eq)\n\n    data House  =  House Int Rooms deriving (Show,Eq)\n    data Person = Person {container :: House }  deriving (Show,Eq)\n\n    getRooms::House-&gt;Rooms\n    getRooms (House n rooms) = rooms\n\n    getHouse::Person-&gt;House\n    getHouse p = container p \n\n\n    getRoom::House-&gt;Room\n    getRoom (House n (Rooms (x:xs)))  = x\n\n\n    class CONTAINMENT container for where\n     isIn :: for -&gt; container -&gt; Bool\n\n    instance CONTAINMENT House  Person where\n     isIn  person   (House n (Rooms rooms)) = (container person) ==  (House n (Rooms rooms)) ||  isIn  person  (getRooms (House n (Rooms rooms)))\n\n    instance CONTAINMENT Rooms Person where\n     isIn person (Rooms []) = False\n     isIn person (Rooms (room:rooms)) = (room == getRoom(getHouse(person))) ||  isIn person (Rooms rooms)\n\n    r1 = Room 1\n    r2 = Room 2\n    h1 = House 1 (Rooms [])\n    h2 = House 2 (Rooms [r1])\n    h3 = House 3 (Rooms [r1,r2])\n    p1 = Person {container = h1}\n    p2 = Person  {container = h2}\n    p3 = Person  {container = h3}\n    personInHoseNoRooms = isIn p1 h1\n    personInHoseNoRoomsNotIn = isIn p1 h2\n    personInRoomInHouse = isIn p2 h2\n    personIn2ndRoomInHouse = isIn p3 h3\n</code></pre>\n\n<p>This code seems to be broadly consistent with the <strong>Specification</strong> . However, I see some problems:</p>\n\n<ol>\n<li>If the first argument of the disjunct in <code>isIn</code> is false and the second argument is true then we have information that a person is in a room but not in the house containing the room. This appears to me to be a logical contradiction, a person is not in house A, but is in a room that is in house A. This could be a error in my understanding of the specification or my coding.</li>\n<li>The word <em>recursive</em> usually is usually applied to single date type, yet above the overloaded <code>isIn</code> to apply to <code>House</code> and <code>Rooms</code>, where the <code>House</code> structure contains a list of <code>Rooms</code>.  Again this could be an error on my part.</li>\n<li>As it stands there is no mention of globally unique room identifiers. It may be possible that the same room number occurs in different houses which may produce ambiguous results. I think that there is some deeper problem with the <code>Room-House-Person</code> relationships that I cannot clearly articulate.</li>\n</ol>\n\n<p><strong>Questions</strong></p>\n\n<ol>\n<li>Any coding suggestions on how I could overcome the issues mentioned above. </li>\n<li>Alternatively, is it actually possible to implement the <strong>Specification</strong>? </li>\n</ol>\n"}, {"tags": ["haskell", "conduit", "haskell-pipes", "network-conduit", "zip-conduit"], "comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1538772751, "post_id": 52628155, "comment_id": 92275998, "body": "Wouldn&#39;t just using <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Foldable.html#v:sequence_\" rel=\"nofollow noreferrer\"><code>sequence_</code></a> work?"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1538725695, "creation_date": 1538573357, "last_edit_date": 1538725695, "question_id": 52628155, "link": "https://stackoverflow.com/questions/52628155/serialize-sources-with-conduit", "title": "Serialize Sources with conduit", "body": "<p>I'm looking for a function that could have this signature :</p>\n\n<pre><code>serializeSources :: Monad m =&gt; [Source m a] -&gt; Source m a\n</code></pre>\n\n<p>Having x sources with the same value produced that are serialized into 1 stream...First produced first received by downstream components... ZipSources would be the closest that I have found but I don't want the \"zipList\" behaviour as you can imagine in my context ...</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "esqueleto"], "answers": [{"tags": [], "owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1538566781, "creation_date": 1538566781, "answer_id": 52626239, "question_id": 52625391, "link": "https://stackoverflow.com/questions/52625391/join-on-result-of-subquery-in-esqueleto/52626239#52626239", "title": "Join on result of subquery in Esqueleto", "body": "<p>Ended up solving it with this:</p>\n\n<pre><code>query :: Maybe Location -&gt; DB [(Entity Company, Entity Officer)]\nquery mLocation = E.select $ E.from $ \\(c' `E.InnerJoin` o) -&gt; do\n  let sub = E.subList_select $ E.from\n            $ \\(c `E.LeftOuterJoin` cc `E.LeftOuterJoin` l) -&gt; do\n              E.distinctOn [ E.don (c E.^. CompanyNumber) ] $ do\n                E.on $ c E.^. CompanyPostcode E.==. l E.^. LocationPostcode\n                E.on $ c E.^. CompanyId E.==. cc E.^. CompanyCategoryCompany\n                whereRegisteredFrom c (queryFilterFromDate qf)\n                whereRegisteredTo c (queryFilterToDate qf)\n                whereLikeTerm c (queryFilterSearchTerm qf)\n                whereVisible c\n                whereWithinRadiusOf (queryFilterRadius qf) mLocation\n\n                let categories' = map (\\(QueryCategory a) -&gt; a) (fromMaybe [] $ queryFilterCategories qf)\n                    subQuery = E.subList_select $ E.from $ \\cat -&gt; do\n                               E.where_ $ cat E.^. CategoryCode `E.in_` E.valList categories'\n                               return $ cat E.^. CategoryId\n\n                when (isJust (queryFilterCategories qf))\n                  (E.where_ $ cc E.^. CompanyCategoryCategory `E.in_` subQuery)\n\n                E.limit (fromInteger limit)\n                E.offset $ (fromInteger page - 1) * (fromInteger limit)\n                E.orderBy [ E.desc (c E.^. CompanyNumber) ]\n                return $ c E.^. CompanyId\n  E.on $ c' E.^. CompanyId E.==. o E.^. OfficerCompanyId\n  E.where_ $ c' E.^. CompanyId `E.in_` sub\n  return (c', o)\n</code></pre>\n"}], "owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538566781, "creation_date": 1538563692, "question_id": 52625391, "link": "https://stackoverflow.com/questions/52625391/join-on-result-of-subquery-in-esqueleto", "title": "Join on result of subquery in Esqueleto", "body": "<p>The essential part of the query I'm trying to translate is like this:</p>\n\n<pre><code>SELECT c.id, c.name, officer.id, officer.name\nFROM (\n  SELECT DISTINCT ON (company.number) company.id, company.name\n  FROM company\n  ORDER BY company.number DESC\n  LIMIT 15\n) AS c\nINNER JOIN officer ON c.id = officer.company_id;\n</code></pre>\n\n<p>The Esqueleto that I'm trying (which doesn't compile) is like this:</p>\n\n<pre><code>query mLocation = E.select $ E.from $\n  \\o -&gt; do\n    let sub = E.subList_select\n              $ E.from\n              $ \\(c `E.LeftOuterJoin` cc `E.LeftOuterJoin` l) -&gt; do\n                E.distinctOn [ E.don (c E.^. CompanyNumber) ] $ do\n                  E.on $ c E.^. CompanyPostcode E.==. l E.^. LocationPostcode\n                  E.on $ c E.^. CompanyId E.==. cc E.^. CompanyCategoryCompany\n                  whereRegisteredFrom c (queryFilterFromDate qf)\n                  whereRegisteredTo c (queryFilterToDate qf)\n                  whereLikeTerm c (queryFilterSearchTerm qf)\n                  whereVisible c\n                  whereWithinRadiusOf (queryFilterRadius qf) mLocation\n\n                  let categories' = map (\\(QueryCategory a) -&gt; a) (fromMaybe [] $ queryFilterCategories qf)\n                      subQuery = E.subList_select $ E.from $ \\cat -&gt; do\n                                 E.where_ $ cat E.^. CategoryCode `E.in_` E.valList categories'\n                                 return $ cat E.^. CategoryId\n\n                  when (isJust (queryFilterCategories qf))\n                    (E.where_ $ cc E.^. CompanyCategoryCategory `E.in_` subQuery)\n\n                  E.limit (fromInteger limit)\n                  E.offset $ (fromInteger page - 1) * (fromInteger limit)\n                  E.orderBy [ E.desc (c E.^. CompanyNumber) ]\n                  return c\n    E.on $ sub E.^. CompanyId E.==. o E.^. OfficerCompanyId\n    return (sub, o)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1538546999, "post_id": 52620686, "comment_id": 92175054, "body": "Using <code>filter</code> and <code>last</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538547686, "post_id": 52620686, "comment_id": 92175323, "body": "As for <code>func3</code>, this will not work, since <code>return</code> does <i>not</i> terminate the control flow."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1538556913, "post_id": 52620686, "comment_id": 92179976, "body": "You can&#39;t write <code>list . takeWhile condition</code>, since lists are not functions and can not be composed. Use instead basic application <code>takeWhile condition list</code>. Also, you can&#39;t <code>foldl</code> on an infinite list -- that will diverge. You probably want <code>scanl</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1538547928, "last_edit_date": 1538547928, "creation_date": 1538547553, "answer_id": 52620815, "question_id": 52620686, "link": "https://stackoverflow.com/questions/52620686/find-the-largest-n-such-that-n-k-in-haskell-using-foldl-and-an-infinite-seri/52620815#52620815", "title": "Find the largest n such that n! &lt; k in Haskell, using foldl and an infinite series", "body": "<p><strong>Short answer</strong>: divide your program in functions that each perform a dedicated task.</p>\n\n<p>We can first define a function to calculate the factorial:</p>\n\n<pre><code>fact :: (Num a, Enum a) =&gt; a -&gt; a\nfact x = foldl (*) 1 [1..x]\n</code></pre>\n\n<p>Now we can generate a list of 2-tuples where the first item is the <code>i</code>, and the second the <code>i!</code>:</p>\n\n<pre><code>facts :: (Num a, Enum a) =&gt; [(a, a)]\nfacts = map (\\i -&gt; (i, fact i)) [1..]\n</code></pre>\n\n<p>Now we can use a <code>takeWhile</code> to filter this list to only return the tuples for which the second item (the <code>i!</code> thus), is smaller than <code>n</code>:</p>\n\n<pre><code>factsless :: (Num a, Enum a) =&gt; a -&gt; [(a, a)]\nfactsless n = takeWhile (\\(_, fi) -&gt; fi &lt; n) facts\n</code></pre>\n\n<p>Now we can use the <code>last</code> to obtain the <em>last</em> tuple of this list, and then use <code>fst</code> to obtain the corresponding <code>i</code>:</p>\n\n<pre><code>solution :: (Num a, Enum a) =&gt; a -&gt; a\nsolution n = fst (last (factsless n))\n</code></pre>\n\n<p>Given <code>n</code> is large, only an <code>Integer</code> can represent that number. So it is probably safer to use an <code>Integer</code> for <code>a</code>, since otherwise it is possible the less than check will never fail, hence overflow will occur.</p>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; solution 2\n1\nPrelude&gt; solution 3\n2\nPrelude&gt; solution 4\n2\nPrelude&gt; solution 5\n2\nPrelude&gt; solution 6\n2\nPrelude&gt; solution 7\n3\nPrelude&gt; solution 10\n3\nPrelude&gt; solution 100\n4\nPrelude&gt; solution 10000\n7 \nPrelude&gt; solution (10^100)\n69 \n</code></pre>\n\n<p>Since factorials are <em>integrals</em>, it is better to avoid floating point numbers, normally integers will be more precide, compact and efficient.</p>\n\n<p><strong>Optimizations</strong>:</p>\n\n<p>we can boost performance of a calculating the factorials, by generating an infinite list, for example with <code>scanl</code>:</p>\n\n<pre><code>facts :: (Num a, Enum a, Num b, Enum b) =&gt; [(a, b)]\nfacts = zip [1..] (scanl (*) 1 [2..])\n</code></pre>\n\n<p>Other optimizations are possible, but I leave this as an exercise.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1538557078, "post_id": 52621120, "comment_id": 92180060, "body": "Isn&#39;t <code>fst . last . zip [0..]</code> equivalent to <code>pred . length</code> ? (at least when defined)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1538581217, "post_id": 52621120, "comment_id": 92195035, "body": "@chi nice observation. of course the <code>fst</code> snippet follows the specs <i>self-evidently</i>; <code>length</code> not quite. I guess what&#39;s warranted in such cases is to use the second, while leaving the first as a comment. thanks!"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1538582912, "post_id": 52621120, "comment_id": 92196016, "body": "@Will Ness Does this type check..? I had to change the signature to <code>factProblem :: Integer -&gt; Int</code> on ghci."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1538583332, "last_edit_date": 1538583332, "creation_date": 1538548905, "answer_id": 52621120, "question_id": 52620686, "link": "https://stackoverflow.com/questions/52620686/find-the-largest-n-such-that-n-k-in-haskell-using-foldl-and-an-infinite-seri/52621120#52621120", "title": "Find the largest n such that n! &lt; k in Haskell, using foldl and an infinite series", "body": "<p>Replace the fold with a scan, and put <em>its</em> result through <code>takeWhile ...</code>. And then index it and take a <code>last</code>!</p>\n\n<p>But first untangle the <code>read</code>, to turn it into a plain argument value. It doesn't matter where it comes from, for the algorithm that you're implementing. Thus</p>\n\n<pre><code>factProblem :: Integer -&gt; Int\nfactProblem k = -- fst . last . zip [0..] \n                pred . length\n                   . takeWhile (&lt; k) . scanl (*) 1 $ [1..]\n\nmain :: IO ()\nmain = getLine &gt;&gt;= print . factProblem . read\n</code></pre>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 52620815, "answer_count": 2, "score": 1, "last_activity_date": 1538583332, "creation_date": 1538546924, "question_id": 52620686, "link": "https://stackoverflow.com/questions/52620686/find-the-largest-n-such-that-n-k-in-haskell-using-foldl-and-an-infinite-seri", "title": "Find the largest n such that n! &lt; k in Haskell, using foldl and an infinite series", "body": "<p>This seems very simple to state in the title, but I'm having difficulty coding it up.  I'm looking for the largest n such that n! &lt; a given k.  </p>\n\n<p>Here's what I've tried:</p>\n\n<pre><code>func1 = foldl (*) 1 [1..] . takeWhile (\\x -&gt; x &lt; (read \"1e100\" :: Scientific ))\n\nfunc2 = (\\x -&gt; foldl (*) 1 [1..x] . takeWhile (x &lt; (read \"1e100\" :: Scientific )))\n\nfunc3 = do\n        forM_ [1..] $ \\x -&gt; do\n            let y = foldl (*) 1 [1..x]\n            when y &gt;= (read \"1e100\" :: Scientific ) $\n                putStrLn x\n                return ()\n\nfunc4 k = let nfac = foldl (*) 1 [1..n]\n              where nfac &gt; k\n-- func4 (read \"1e100\" :: Scientific )\n</code></pre>\n\n<p>I'm using the Data.Scientific library as k will usually be large.</p>\n\n<p>What's an idiomatic way to phrase this correctly?</p>\n"}, {"tags": ["haskell", "casting"], "answers": [{"tags": [], "owner": {"reputation": 14609, "user_id": 667648, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mTpbt.jpg?s=128&g=1", "display_name": "Dair", "link": "https://stackoverflow.com/users/667648/dair"}, "is_accepted": true, "score": 1, "last_activity_date": 1538546523, "creation_date": 1538546523, "answer_id": 52620603, "question_id": 52620391, "link": "https://stackoverflow.com/questions/52620391/enter-number-in-scientific-notation-convert-to-integral-in-haskell/52620603#52620603", "title": "Enter number in scientific notation, convert to Integral in Haskell", "body": "<p>You want to use <code>toUnboundedInteger</code> (or maybe <code>toBoundedInteger</code>, I not sure what the bound <code>10^e</code> is referring to). The signature is:</p>\n\n<pre><code>toUnboundedInteger :: Scientific -&gt; Maybe Integer\n</code></pre>\n\n<p>So, informally, the function checks checks if the <code>Scientific</code> parameters is actually an integer (for instance it could be a float). If it is a float the result returned is <code>Nothing</code> otherwise it is <code>Just</code> the integer you expect.</p>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 52620603, "answer_count": 1, "score": 0, "last_activity_date": 1538546523, "creation_date": 1538545456, "question_id": 52620391, "link": "https://stackoverflow.com/questions/52620391/enter-number-in-scientific-notation-convert-to-integral-in-haskell", "title": "Enter number in scientific notation, convert to Integral in Haskell", "body": "<p>Looking here:\n<a href=\"https://hackage.haskell.org/package/scientific\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/scientific</a></p>\n\n<p>And here:\n<a href=\"https://wiki.haskell.org/Converting_numbers\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Converting_numbers</a></p>\n\n<p>I would expect to be able to enter a number as a string in Scientific notation</p>\n\n<pre><code>Prelude Data.Scientific&gt; read \"1e100\" :: Scientific\n1.0e100\n</code></pre>\n\n<p>And convert into integer like so:</p>\n\n<pre><code>Prelude Data.Scientific&gt; (read \"1e100\" :: Scientific ) :: Int\n\n&lt;interactive&gt;:7:2: error:\n    \u2022 Couldn't match expected type \u2018Int\u2019 with actual type \u2018Scientific\u2019\n    \u2022 In the expression: (read \"1e100\" :: Scientific) :: Int\n      In an equation for \u2018it\u2019: it = (read \"1e100\" :: Scientific) :: Int\n</code></pre>\n\n<p>This does not seem to work.  How can I convert my Scientific type into an integer?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1538515013, "post_id": 52616460, "comment_id": 92167242, "body": "those are tuples in the list."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1538515127, "post_id": 52616460, "comment_id": 92167284, "body": "It&#39;s a list of 3-tuples, not a list of lists."}, {"owner": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "edited": false, "score": 0, "creation_date": 1538515209, "post_id": 52616460, "comment_id": 92167319, "body": "Thank you for clarifying, I&#39;ve edited my post to reflect my mistake"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1538515283, "post_id": 52616460, "comment_id": 92167337, "body": "What resource are you using to learn Haskell? I would recommend reading about pattern matching on lists and recursion. Then you can try using e.g. map or mapM, then you might try implementing those two functions yourself"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 5, "creation_date": 1538515617, "post_id": 52616460, "comment_id": 92167472, "body": "How about <code>mapM_ print [(1,2,4),(4,1,4),(3,7,2),(4,2,5),(1,5,9)]</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1538534295, "post_id": 52616460, "comment_id": 92171957, "body": "<code>(!!)</code> isn&#39;t needed that often in Haskell. If you need to pick and choose specific elements of a list, it&#39;s a good sign you should be using a product type instead of a list."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1538718529, "post_id": 52621247, "comment_id": 92248475, "body": "<code>mapM_</code> can also be replaced with <code>traverse_ print xs</code>\u2014or its flipped cousin, <code>for_ xs print</code>\u2014which can be used in more places because they only require an <code>Applicative</code> constraint instead of <code>Monad</code>. Same goes for the versions of these functions without <code>_</code>, which accumulate results. <code>mapM</code> is a historical artifact from before <code>Applicative</code> was made a superclass of <code>Monad</code>."}, {"owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1539006587, "post_id": 52621247, "comment_id": 92334057, "body": "You&#39;re right of course, though should I replace sequence_ by sequenceA_ ? I would probably still give the list version of those functions (just adding a remark to the effect that those functions work with some other &quot;containers&quot;)"}], "tags": [], "owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "is_accepted": true, "score": 3, "last_activity_date": 1538550618, "last_edit_date": 1538550618, "creation_date": 1538549455, "answer_id": 52621247, "question_id": 52616460, "link": "https://stackoverflow.com/questions/52616460/iterating-through-a-list-of-tuples-with-haskell/52621247#52621247", "title": "Iterating through a list of tuples with Haskell", "body": "<p>Your question isn't specific to lists of <em>tuples</em>, what you need is knowing how to iterate through a list of anything.</p>\n\n<p>Traditionally, since you don't have loops, \"iterating\" in functional languages is done through recursion so a reasonable first solution would look like :</p>\n\n<pre><code>printAList [] = return ()\nprintAList (x:xs) = do\n  print x\n  printAList xs\n</code></pre>\n\n<p>but of course, writing a recursion every time you want to go through a list is silly so all functional languages contain <em>higher order functions</em> that takes a function in parameter to indicate what to do with each element of a list and how to combine the results. Such a function that is often seen is <code>map</code> which create a new list with the results of the passed function on each element :</p>\n\n<pre><code>map f [] = []\nmap f (x:xs) = f x : map f xs\n</code></pre>\n\n<p>So here you might think to do <code>map print yourList</code>. Unfortunately, <code>print</code> doesn't really show its argument, it is a function that creates an IO action that, when executed, would show the argument. So you'll get a list of actions with your map and to execute it, you'll have to use the function that executes a list of actions : <code>sequence_</code> (the _ indicates we don't care about the returns of each action)</p>\n\n<pre><code>sequence_ [] = return ()\nsequence_ (act : acts) = do\n  act\n  sequence_ acts\n</code></pre>\n\n<p>So your final code would be <code>sequence_ (map print yourList)</code>. Of course, applying an action creating function to the element of a list and executing them is a sufficiently frequent need that you have a dedicated function for that : <code>mapM_</code> (the M indicates that this is the \"monadic\" version of map and the _ that we throw out the results after execution).</p>\n\n<pre><code>mapM_ f xs = sequence_ (map f xs)\n</code></pre>\n\n<p>TL:DR So to show each of your tuple you just have to write <code>mapM_ print yourList</code>.</p>\n"}], "owner": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2641, "favorite_count": 0, "accepted_answer_id": 52621247, "answer_count": 1, "score": 0, "last_activity_date": 1538550618, "creation_date": 1538514707, "last_edit_date": 1538515193, "question_id": 52616460, "link": "https://stackoverflow.com/questions/52616460/iterating-through-a-list-of-tuples-with-haskell", "title": "Iterating through a list of tuples with Haskell", "body": "<p>I have a list of tuples</p>\n\n<pre><code>   list =  [(1,2,4),(4,1,4),(3,7,2),(4,2,5),(1,5,9)]\n</code></pre>\n\n<p>I'd like to iterate through the list and get each tuple by itself. \nFor ex, maybe print</p>\n\n<pre><code>(1,2,3)\n\n(4,1,4)\n\n(3,7,2)\n</code></pre>\n\n<p>and so on.</p>\n\n<p>I'm having trouble accessing the items in the list because if I were to do <code>list!!1</code>, I can't access all the other elements after if I try <code>list!!3</code>.</p>\n\n<p>How would one approach iterating through a list of tuples with haskell?</p>\n"}, {"tags": ["function", "haskell", "matrix", "types", "constructor"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1538511482, "post_id": 52615758, "comment_id": 92165817, "body": "You can not <i>override</i> in Haskell, only implement a type class, like the <code>Num</code> typeclass: <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#typeclasses-102\" rel=\"nofollow noreferrer\">learnyouahaskell.com/&hellip;</a>"}, {"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1538512584, "post_id": 52615758, "comment_id": 92166343, "body": "And frankly, making <code>Matrix</code> an instance of <code>Num</code> doesn&#39;t make sense. (You <i>could</i>, if you really wanted to...but what&#39;s the sign of a matrix? What matrix should <code>fromInteger 3</code> evaluate to?)"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1538512707, "post_id": 52615758, "comment_id": 92166399, "body": "Be sure to read error messages carefully &quot;...The function \u2018Matrix\u2019 is applied to four arguments but it&#39;s type has only one, in the expression <code>Matrix zipWith (\\ a b -&gt; zipWith (Prelude.+) a b) x y</code>...&quot; . You are missing parens"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1538519409, "last_edit_date": 1538519409, "creation_date": 1538512570, "answer_id": 52616039, "question_id": 52615758, "link": "https://stackoverflow.com/questions/52615758/overriding-in-haskell/52616039#52616039", "title": "Overriding + in Haskell", "body": "<p>First of all, the type</p>\n\n<pre><code>(+) :: (Num a, Num b, Num c) =&gt; Matrix [[a]] -&gt; Matrix [[b]] -&gt; Matrix [[c]]\n</code></pre>\n\n<p>is too much general. It states that you can sum any numeric matrix with any other numeric matrix, even if the element types are different, to produce a matrix of a third numeric type (potentially distinct from the first two). That is, in particular a matrix of floats can be summed to a matrix of doubles to produce a matrix of ints.</p>\n\n<p>You want instead</p>\n\n<pre><code>(+) :: Num a =&gt; Matrix [[a]] -&gt; Matrix [[a]] -&gt; Matrix [[a]]\n</code></pre>\n\n<p>I would recommend to move the \"list of list\" type inside the newtype</p>\n\n<pre><code>newtype Matrix a = Matrix [[a]]\n</code></pre>\n\n<p>reflecting that the list of lists implements the <code>Matrix</code> concept. That gives the type signature</p>\n\n<pre><code>(+) :: Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a\n</code></pre>\n\n<p>To \"override\" <code>(+)</code>: there's no overriding/overloading in Haskell. The closest options are:</p>\n\n<ol>\n<li><p>define a module-local function <code>(+)</code>. This will clash with <code>Prelude.(+)</code>, so that every <code>+</code> will now need to be qualified to remove the ambiguity. We can not write <code>x + y</code>, but we need <code>x Prelude.+ y</code> or <code>x MyModuleName.+ y</code>.</p></li>\n<li><p>implement a <code>Num</code> instance for <code>Matrix a</code>. This is not a great idea since a matrix is not exactly a number, but we can try anyway.</p>\n\n<pre><code>instance Num a =&gt; Num (Matrix a) where\n   Matrix xs + Matrix ys = Matrix (zipWith (zipWith (+)) xs ys)\n   -- other Num operators here\n  (*) = error \"not implemented\" -- We can't match dimension\n  negate (Matrix xs) = Matrix (map (map negate) xs)\n  abs = error \"not implemented\"\n  signum = error \"not implemented\"\n  fromInteger = error \"not implemented\"\n</code></pre>\n\n<p>This is very similar to your code, which lacks some parentheses. Not all the other methods can be implemented in a completely meaningful way, since <code>Num</code> is for numbers, not matrices.</p></li>\n<li><p>use a different operator, e.g. <code>(^+)</code> or whatever</p></li>\n</ol>\n"}], "owner": {"reputation": 29, "user_id": 2740926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836c3c937971638d447b7e7babd1622c?s=128&d=identicon&r=PG&f=1", "display_name": "Hunter Vallejos", "link": "https://stackoverflow.com/users/2740926/hunter-vallejos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "closed_date": 1538530196, "accepted_answer_id": 52616039, "answer_count": 1, "score": -1, "last_activity_date": 1538519409, "creation_date": 1538511254, "question_id": 52615758, "link": "https://stackoverflow.com/questions/52615758/overriding-in-haskell", "closed_reason": "Duplicate", "title": "Overriding + in Haskell", "body": "<p>I am trying to override the + symbol in an effort to learn how to define my own types. I am very new to Haskell, and I cannot seem to get past this error.</p>\n\n<p>Here is my simple new type:</p>\n\n<pre><code>newtype Matrix x = Matrix x\n(+):: (Num a, Num b, Num c) =&gt; Matrix [[a]] -&gt; Matrix [[b]] -&gt; Matrix [[c]]\nx + y = Matrix zipWith (\\ a b -&gt; zipWith (+) a b) x y\n</code></pre>\n\n<p>When I try to load this into ghci, I  get the error</p>\n\n<pre><code>linear_algebra.hs:9:42:\n    Ambiguous occurrence \u2018+\u2019\n    It could refer to either \u2018Main.+\u2019, defined at linear_algebra.hs:9:3\n                          or \u2018Prelude.+\u2019,\n                             imported from \u2018Prelude\u2019 at linear_algebra.hs:1:1\n                             (and originally defined in \u2018GHC.Num\u2019)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Replacing my last line of code with </p>\n\n<pre><code>x + y = Matrix zipWith (\\ a b -&gt; zipWith (Prelude.+) a b) x y\n</code></pre>\n\n<p>gives me the error</p>\n\n<pre><code>    Couldn't match expected type \u2018([Integer] -&gt; [Integer] -&gt; [Integer])\n                                  -&gt; Matrix [[a]] -&gt; Matrix [[b]] -&gt; Matrix [[c]]\u2019\n                with actual type \u2018Matrix\n                                    ((a0 -&gt; b0 -&gt; c0) -&gt; [a0] -&gt; [b0] -&gt; [c0])\u2019\n    Relevant bindings include\n      y :: Matrix [[b]] (bound at linear_algebra.hs:9:5)\n      x :: Matrix [[a]] (bound at linear_algebra.hs:9:1)\n      (+) :: Matrix [[a]] -&gt; Matrix [[b]] -&gt; Matrix [[c]]\n        (bound at linear_algebra.hs:9:1)\n    The function \u2018Matrix\u2019 is applied to four arguments,\n    but its type \u2018((a0 -&gt; b0 -&gt; c0) -&gt; [a0] -&gt; [b0] -&gt; [c0])\n                  -&gt; Matrix ((a0 -&gt; b0 -&gt; c0) -&gt; [a0] -&gt; [b0] -&gt; [c0])\u2019\n    has only one\n    In the expression:\n      Matrix zipWith (\\ a b -&gt; zipWith (Prelude.+) a b) x y\n    In an equation for \u2018+\u2019:\n        x + y = Matrix zipWith (\\ a b -&gt; zipWith (Prelude.+) a b) x y\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Can you please help me understand what the error is? I would really appreciate it. Thanks!</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "edited": false, "score": 0, "creation_date": 1538512414, "post_id": 52615843, "comment_id": 92166266, "body": "If the requirement is to have a function <code>foo:: ([(Int, Int, Int)], Int, Int) -&gt; [[(Int, Int, Int)]]</code> would the method you provided still be correct?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "edited": false, "score": 0, "creation_date": 1538512572, "post_id": 52615843, "comment_id": 92166337, "body": "@user1692517: it is a beginning to implement the funtion, but the type itself does not really makes much sense, since you wrap it twice in a list? Furthermore you will need to do some mapping."}, {"owner": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "edited": false, "score": 0, "creation_date": 1538512645, "post_id": 52615843, "comment_id": 92166369, "body": "Nvm i figured out how to keep the same function type. Thank you very much,"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "edited": false, "score": 0, "creation_date": 1538512656, "post_id": 52615843, "comment_id": 92166377, "body": "@user1692517: if you want to replicate things, this is the part to extact the first item yes. What you then have to do with the rest is of course another issue/aspect :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1538511661, "creation_date": 1538511661, "answer_id": 52615843, "question_id": 52615752, "link": "https://stackoverflow.com/questions/52615752/having-trouble-getting-the-first-value-from-a-haskell-tuple/52615843#52615843", "title": "Having trouble getting the first value from a Haskell Tuple", "body": "<p>Like the signature specifies, <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fst\" rel=\"nofollow noreferrer\"><strong><code>fst :: (a, b) -&gt; a</code></strong></a> returns the <em>first</em> item of a <strong>2</strong>-tuple. So not a 3-tuple (or any <em>n</em>-tuple with <em>n &ne; 2</em>).</p>\n\n<p>For 3-tuples (and higher), one typically uses pattern matching (for example in lambda-expressions). For example:</p>\n\n<pre><code>\\(x, _, _) -&gt; x\n</code></pre>\n\n<p>is a lambda-expression that obtain the first item of a 3-tuple.</p>\n\n<p>Or you can define a function that does this pattern matching, for example:</p>\n\n<pre><code>fst3 :: (a, b, c) -&gt; a\nfst3 (x, _, _) = x\n</code></pre>\n"}], "owner": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 769, "favorite_count": 0, "accepted_answer_id": 52615843, "answer_count": 1, "score": 0, "last_activity_date": 1538511661, "creation_date": 1538511231, "question_id": 52615752, "link": "https://stackoverflow.com/questions/52615752/having-trouble-getting-the-first-value-from-a-haskell-tuple", "title": "Having trouble getting the first value from a Haskell Tuple", "body": "<p>I have a value that is in the form of <code>([(Int, Int, Int)], Int, Int)</code></p>\n\n<p>I need a function that would take data in the form of <code>([(Int, Int, Int)], Int, Int)</code> and return <code>[[(Int, Int, Int)]]</code></p>\n\n<p>So let's say my list is named <code>it</code>.\nWhen I run <code>fst it</code></p>\n\n<p>I get this error</p>\n\n<pre><code> * Couldn't match expected type `(a, b0)'\n                  with actual type `([(Int, Int, Int)], Int, Int)'\n    * In the first argument of `fst', namely `it'\n      In the expression: fst it\n      In an equation for `it': it = fst it\n    * Relevant bindings include it :: a (bound at &lt;interactive&gt;:9:1)\n</code></pre>\n\n<p>I'm having trouble understanding what I'm doing wrong. Can someone help me out. I want to get the first value of <code>it</code> which is a list of lists.</p>\n"}, {"tags": ["haskell", "winghci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1538510711, "post_id": 52615597, "comment_id": 92165496, "body": "What is the <code>()</code> doing here?"}, {"owner": {"reputation": 1657, "user_id": 784923, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fb67cbf11232c7c912e9b69d9f5284bd?s=128&d=identicon&r=PG", "display_name": "VirtualProdigy", "link": "https://stackoverflow.com/users/784923/virtualprodigy"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538510871, "post_id": 52615597, "comment_id": 92165559, "body": "I read that the <code>()-&gt;</code> can be added in a function declaration to specify no parameters received. The value following the <code>-&gt;</code> is the return type. Is this not the case for Haskell?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1538510973, "post_id": 52615597, "comment_id": 92165598, "body": "No, here there is no parameter at all in your function declaration. <code>()</code> is the <i>unit type</i>."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1538511598, "post_id": 52615597, "comment_id": 92165881, "body": "The code you posted certainly has incorrect indentation (it also contains a fragment of an error message), but it&#39;s impossible to help you until you clean up the markdown in your question"}, {"owner": {"reputation": 1657, "user_id": 784923, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fb67cbf11232c7c912e9b69d9f5284bd?s=128&d=identicon&r=PG", "display_name": "VirtualProdigy", "link": "https://stackoverflow.com/users/784923/virtualprodigy"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1538512146, "post_id": 52615597, "comment_id": 92166160, "body": "@jberryman I updated the markdown and fixed the spacing. The code now looks exact like my .hs file."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1538512520, "post_id": 52615597, "comment_id": 92166312, "body": "Your immediate problem is <code>let</code>. It doesn&#39;t work the way you think it works. When you solve this, <code>()</code> should go. Perhaps together with <code>printCar</code>, as it&#39;s exactly the same as <code>civicNinetyOne</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1657, "user_id": 784923, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fb67cbf11232c7c912e9b69d9f5284bd?s=128&d=identicon&r=PG", "display_name": "VirtualProdigy", "link": "https://stackoverflow.com/users/784923/virtualprodigy"}, "edited": false, "score": 0, "creation_date": 1538512612, "post_id": 52615986, "comment_id": 92166356, "body": "That\u2019s definitely a mistake on my part then. I don\u2019t want any paramters to be passed.  Once I get home I\u2019ll update the code to remove the ()-&gt; so it doesn\u2019t accept any values"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 1657, "user_id": 784923, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fb67cbf11232c7c912e9b69d9f5284bd?s=128&d=identicon&r=PG", "display_name": "VirtualProdigy", "link": "https://stackoverflow.com/users/784923/virtualprodigy"}, "edited": false, "score": 1, "creation_date": 1538514147, "post_id": 52615986, "comment_id": 92166943, "body": "There&#39;s no such thing as a zero-argument function in Haskell; <code>printCar :: Car</code> would just be a value, like <code>civicNinetyOne</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1538526730, "last_edit_date": 1538526730, "creation_date": 1538512332, "answer_id": 52615986, "question_id": 52615597, "link": "https://stackoverflow.com/questions/52615597/haskell-printing-a-hardcoded-value-from-a-function/52615986#52615986", "title": "Haskell Printing a hardcoded value from a function", "body": "<p><code>printCar</code> takes an argument like any other function; it's argument type is <code>()</code>, which means there is only one value (also spelled <code>()</code>) that can be used to call it.</p>\n\n<p><code>civicNinetyOne</code>, on the other hand, is a value with type <code>Car</code>, not a function of type <code>() -&gt; Car</code>, so cannot itself be assigned to <code>printCar</code>.</p>\n\n<p>The correct definition is</p>\n\n<pre><code>printCar :: () -&gt; Car\nprintCar () = civicNinetyOne\n</code></pre>\n\n<p>and it would be called as</p>\n\n<pre><code>&gt; printCar ()\nCar {gears = [\"gear1\",\"gear2\",\"gear3\",\"gear4\",\"gear5\"], currentGear = \"gear1\", brokeGears = [\"gear4\"], shiftStroke = [(\"gear1\",\"pull\",\"gear\"),(\"gear2\",\"push\",\"gear3\"),(\"gear3\",\"skipShift\",\"gear5\")]}   \n</code></pre>\n\n<hr>\n\n<p>For completeness, the <code>let</code> (as pointed out in the comments) is optional in recent versions of GHCi and required in older versions of GHCi, but it is <em>forbidden</em> in a module. (The interactive interpreter behaves somewhat like an implied <code>do</code> block.)</p>\n"}], "owner": {"reputation": 1657, "user_id": 784923, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fb67cbf11232c7c912e9b69d9f5284bd?s=128&d=identicon&r=PG", "display_name": "VirtualProdigy", "link": "https://stackoverflow.com/users/784923/virtualprodigy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 52615986, "answer_count": 1, "score": 1, "last_activity_date": 1538526730, "creation_date": 1538510594, "last_edit_date": 1538512095, "question_id": 52615597, "link": "https://stackoverflow.com/questions/52615597/haskell-printing-a-hardcoded-value-from-a-function", "title": "Haskell Printing a hardcoded value from a function", "body": "<p>I'm beginning my first exploration of functional programming with <code>Haskell</code>. I'm struggling a bit with printing a hardcoded value. I created a model representing a car and the gears it can go to. What I want to do is simply print my hardcoded <code>civicNinetyOne</code> when I call <code>printCar.</code> But I keep getting an error when I load the file. I posted the error below, it's an indentation error but from what I've read here at <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">LearnYouAHaskell</a> that call function declaration is correct. Can someone point me to the cause of this issue? Thank you</p>\n\n<p><strong>Error</strong></p>\n\n<pre><code>first_program.hs:10:1: error:\n    parse error (possibly incorrect indentation or mismatched brackets)\n   |\n10 | printCar:: () -&gt; Car    | ^\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>data Car = Car{\n   gears :: [String],\n   currentGear :: String,\n   brokeGears :: [String],\n   shiftStroke:: Strokes\n  }  \n\nlet civicNinetyOne = Car [\"gear1\", \"gear2\", \"gear3\", \"gear4\", \"gear5\"] \"gear1\" [\"gear4\"] [(\"gear1\",\"pull\", \"gear2\"), (\"gear2\",\"push\", \"gear3\"), (\"gear3\",\"skipShift\", \"gear5\")] \n\nprintCar:: () -&gt; Car\nprintCar = civicNinetyOne\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1538505806, "post_id": 52614478, "comment_id": 92163338, "body": "Why do you post a complete duplicate of your earlier question? <a href=\"https://stackoverflow.com/questions/52611655/circular-prime-numbers-in-haskell\" title=\"circular prime numbers in haskell\">stackoverflow.com/questions/52611655/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1538511727, "creation_date": 1538511727, "answer_id": 52615860, "question_id": 52614478, "link": "https://stackoverflow.com/questions/52614478/circular-prime-number-in-haskell/52615860#52615860", "title": "Circular Prime number in Haskell", "body": "<p>you need to create the circular rotations, easier to work with lists instead of numbers</p>\n\n<pre><code>rotate [] = []\nrotate (x:xs) = xs ++ [x]\n</code></pre>\n\n<p>well, you need as many as number of digits (although some may not be unique)</p>\n\n<pre><code>rotations n = take (length n) $ iterate rotate n\n</code></pre>\n\n<p>using <code>length</code> can be avoided but in this domain should be fine</p>\n\n<p>now you need to convert the integer to list and back, using <code>read/show</code></p>\n\n<pre><code>map (read :: String-&gt;Integer) $ rotations $ show 123\n[123,231,312]\n</code></pre>\n\n<p>what remains is calling <code>prime</code> for each element</p>\n"}], "owner": {"reputation": 97, "user_id": 7350169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03a29f39ab44dae8f625feb700571db4?s=128&d=identicon&r=PG&f=1", "display_name": "Aashray Adhikari", "link": "https://stackoverflow.com/users/7350169/aashray-adhikari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1538679091, "creation_date": 1538505701, "last_edit_date": 1538679091, "question_id": 52614478, "link": "https://stackoverflow.com/questions/52614478/circular-prime-number-in-haskell", "title": "Circular Prime number in Haskell", "body": "<p>I am trying to write a haskell code that takes in a number and determines if it is a circular prime or not. A circular prime is a prime number that is prime even if it is arranged in different order. I have written the following code:</p>\n\n<p>Edit: </p>\n\n<pre><code>prime :: Integer -&gt; Bool\nprime a\n   |factor a == [1] = True\n   |factor a == [a] = True\n   |otherwise         = False\n\nfactor :: Integer -&gt; [Integer]\nfactor a = [x | x &lt;- [1..a], mod a x == 0]\n</code></pre>\n\n<p>The code should print the following when filter function is applied to it:</p>\n\n<pre><code>&gt; filter circprime [2..100]\n[2,3,5,7,11,13,17,31,37,71,73,79,97]\n</code></pre>\n\n<p>But it only prints <code>False</code> and that:</p>\n\n<pre><code> &gt; filter circprime [2..100]\n    []\n</code></pre>\n\n<p>Can you help me with this please.</p>\n"}, {"tags": ["haskell", "fold"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1538500556, "post_id": 52613180, "comment_id": 92160910, "body": "The &quot;flipping&quot; of the arguments is actually logical: you can see it as a &quot;hint&quot; to how the folding happens."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 5, "creation_date": 1538500658, "post_id": 52613180, "comment_id": 92160950, "body": "Plus, you get an error if you use the wrong version accidentally."}], "answers": [{"comments": [{"owner": {"reputation": 484, "user_id": 5587299, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/68b696bfe3bdb63c600cdf67bf2983e6?s=128&d=identicon&r=PG", "display_name": "aryndin", "link": "https://stackoverflow.com/users/5587299/aryndin"}, "edited": false, "score": 0, "creation_date": 1538503363, "post_id": 52613785, "comment_id": 92162159, "body": "Doesn&#39;t look different to me: <code>myfoldl (+) z [a, b, c] = (c + (b + (a + z)))</code>"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 484, "user_id": 5587299, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/68b696bfe3bdb63c600cdf67bf2983e6?s=128&d=identicon&r=PG", "display_name": "aryndin", "link": "https://stackoverflow.com/users/5587299/aryndin"}, "edited": false, "score": 3, "creation_date": 1538503608, "post_id": 52613785, "comment_id": 92162263, "body": "@aryndin that&#39;s not either of the things listed in the post. It might look like it because <code>(+)</code> is commutative, but most operations are not."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1538508813, "post_id": 52613785, "comment_id": 92164683, "body": "you need to remember to reverse the list though, it&#39;s just one bit of knowledge but still one more than the status quo."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 4, "last_activity_date": 1538502806, "creation_date": 1538502806, "answer_id": 52613785, "question_id": 52613180, "link": "https://stackoverflow.com/questions/52613180/is-there-any-reason-why-foldr-type-signature-differs-from-foldl-one/52613785#52613785", "title": "Is there any reason why foldr type signature differs from foldl one?", "body": "<p>You get the following nice equational properties with that order:</p>\n\n<pre><code>foldl (+) z [a, b, c] = (((z + a) + b) + c)\nfoldr (+) z [a, b, c] = a + (b + (c + z))\n</code></pre>\n"}], "owner": {"reputation": 484, "user_id": 5587299, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/68b696bfe3bdb63c600cdf67bf2983e6?s=128&d=identicon&r=PG", "display_name": "aryndin", "link": "https://stackoverflow.com/users/5587299/aryndin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1538502806, "creation_date": 1538500232, "last_edit_date": 1538500552, "question_id": 52613180, "link": "https://stackoverflow.com/questions/52613180/is-there-any-reason-why-foldr-type-signature-differs-from-foldl-one", "title": "Is there any reason why foldr type signature differs from foldl one?", "body": "<p>I'm a little confused in how foldl defined comparing to foldr. Foldr differs from foldl not only in associativity, but also in folding function argument order:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\n</code></pre>\n\n<p>I don't see any reasons why foldl couldn't be defined like that:</p>\n\n<pre><code>foldl :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldl f acc [] = acc\nfoldl f acc (x:xs) = foldl f (f x acc) xs\n</code></pre>\n\n<p>So foldl can be appliend to non-commutative folding functions as well as \nfoldr:</p>\n\n<pre><code>Prelude&gt; foldr (:) [] [1..5]\n[1,2,3,4,5]\nPrelude&gt; foldl (:) [] [1..5]\n&lt;interactive&gt;:4:7: error:\n&lt;...&gt;\nPrelude&gt; myfoldl (:) [] [1..5]\n[5,4,3,2,1]\n</code></pre>\n\n<p>With standard foldl definition we need use <code>flip</code> to get same behavior as with <code>foldr</code></p>\n"}, {"tags": ["haskell", "lazylist"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1538494540, "post_id": 52611023, "comment_id": 92157746, "body": "<code>adding xs n = zipWith (+) xs [n..] = [x+i | (x,i) &lt;- zip xs [n..]]</code>. is this what you meant?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5622765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda4c7dcf80913a9b2032f729fe5cdd2?s=128&d=identicon&r=PG&f=1", "display_name": "estike", "link": "https://stackoverflow.com/users/5622765/estike"}, "edited": false, "score": 0, "creation_date": 1538493572, "post_id": 52611260, "comment_id": 92157159, "body": "I cant use any modules i can only use the first 2 chapters of the &quot; Learn You a Haskell for Great Good!&quot;"}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1538493367, "last_edit_date": 1538493367, "creation_date": 1538493067, "answer_id": 52611260, "question_id": 52611023, "link": "https://stackoverflow.com/questions/52611023/how-to-sum-a-number-in-a-list/52611260#52611260", "title": "How to sum a number in a list", "body": "<p>You may use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:mapAccumL\" rel=\"nofollow noreferrer\"><code>Data.List.mapAccumL</code></a> (<code>mapAccumL :: Traversable t =&gt; (a -&gt; b -&gt; (a, c)) -&gt; a -&gt; t b -&gt; (a, t c)</code>) to achieve this task.</p>\n\n<p>The first parameter is a function which takes two parameters <code>a</code> (accumulator) and <code>n</code> (the list item) and returns a tuple. In our case we increment <code>a</code> (the accumulator) by 1 and map the current element <code>n</code> by adding the accumulator. The result is a tuple in which the first item is the final state of the accumulator and the second is the final state of the list. We extract the second item by <code>snd</code>.</p>\n\n<pre><code>Prelude&gt; snd $ Data.List.mapAccumL (\\a n -&gt; (a+1,n+a)) 3 [1,3,4]\n[4,7,9]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1538499738, "last_edit_date": 1538499738, "creation_date": 1538499316, "answer_id": 52612972, "question_id": 52611023, "link": "https://stackoverflow.com/questions/52611023/how-to-sum-a-number-in-a-list/52612972#52612972", "title": "How to sum a number in a list", "body": "<p>Approach the problem recursively. Add a number to the <em>first</em> element of the list, then recurse on the <em>tail</em> of the list with the next larger number. Repeat until you are out of numbers. Instead of incrementing <code>b</code>, you start a new function call in which <code>b</code> has a larger value.</p>\n\n<pre><code>adding [] _ = []\nadding (x:xs) b = x + b : adding xs (b+1)\n</code></pre>\n\n<p>As an example, consider</p>\n\n<pre><code>adding [7, 10, 7, 5] 0 == 7 + 0 : adding [10, 7, 5] 1\n                       == 7     : (10 + 1 : adding [7, 5] 2)\n                       == 7     : 11      : (7 + 2 : adding [5] 3)\n                       == 7     : 11      : 9      : (5 + 3 : adding [] 4)\n                       == 7     : 11      : 9      : 8      : []\n                       == [7, 11, 9, 8]\n</code></pre>\n\n<p>You can replace <code>0</code> with any starting value <code>n</code> in the initial call; the recursive call always increments it.</p>\n"}], "owner": {"reputation": 15, "user_id": 5622765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda4c7dcf80913a9b2032f729fe5cdd2?s=128&d=identicon&r=PG&f=1", "display_name": "estike", "link": "https://stackoverflow.com/users/5622765/estike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1538499738, "creation_date": 1538492241, "last_edit_date": 1538494382, "question_id": 52611023, "link": "https://stackoverflow.com/questions/52611023/how-to-sum-a-number-in-a-list", "title": "How to sum a number in a list", "body": "<p>My question is : </p>\n\n<p>I have a list and a number and I want to sum the number to the list so I can do this</p>\n\n<pre><code>Adding ls n = [x+n| x&lt;-ls] \n</code></pre>\n\n<p>and it works.</p>\n\n<p>My question is I want to add <code>n+1</code>, <code>n+2</code>, <code>n+3</code> depending of the  length of the list.</p>\n\n<p>If I do </p>\n\n<pre><code>let b = 0\nAdding\u00b4 ls n = [x+adder n b| x&lt;-ls] where adder n b= n+b,b++\n</code></pre>\n\n<p>it doesn't work because the <code>b</code> doesn't advance, so if I have <code>Adding\u00b4 [1,3,4] 3 = [4,7,9]</code> .</p>\n"}, {"tags": ["haskell", "time", "haskell-stack"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538484655, "post_id": 52608452, "comment_id": 92151444, "body": "In <i>full</i> days, or as some floating point (that takes remaining hours, etc. into account)?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1538484856, "post_id": 52608452, "comment_id": 92151547, "body": "What type would you prefer over <code>NominalDiffTime</code> or <code>nominalDiffTimeToSeconds</code>&#39;s <code>Pico</code>? (...and why?)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538485016, "post_id": 52608452, "comment_id": 92151648, "body": "Are we furthermore talking about <i>solar days</i>, or <i>sidereal days</i>?"}, {"owner": {"reputation": 31, "user_id": 8109702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d46bbf7a408772a1409342f01f864d00?s=128&d=identicon&r=PG&f=1", "display_name": "Ashot Bes", "link": "https://stackoverflow.com/users/8109702/ashot-bes"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538495380, "post_id": 52608452, "comment_id": 92158298, "body": "@WillemVanOnsem I just need to get the difference in days. In my code, I take the current date from the date the user entered. Example: // &quot;Pls Enter Date&quot; 2018-10-06 and from this date I take away the current and get the difference in days That is, this number is 4"}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 4, "last_activity_date": 1538486162, "creation_date": 1538486162, "answer_id": 52609153, "question_id": 52608452, "link": "https://stackoverflow.com/questions/52608452/how-to-compare-two-utctime-values-and-get-the-difference-in-days/52609153#52609153", "title": "How to compare two UTCTime values and get the difference in days?", "body": "<p><code>NominalDiffTime</code> is, among others, a <code>Fractional</code>, so you can divide your result with <code>nominalDay</code>:</p>\n\n<pre><code>Prelude Data.Time.Clock&gt; myDiffTime / nominalDay\n2.314814814814s\n</code></pre>\n\n<p>You can use its <code>RealFrac</code> instance to <code>round</code>, <code>floor</code>, etc. it:</p>\n\n<pre><code>Prelude Data.Time.Clock&gt; round $ myDiffTime / nominalDay\n2\nPrelude Data.Time.Clock&gt; truncate $ myDiffTime / nominalDay\n2\nPrelude Data.Time.Clock&gt; floor $ myDiffTime / nominalDay\n2\nPrelude Data.Time.Clock&gt; ceiling $ myDiffTime / nominalDay\n3\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8109702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d46bbf7a408772a1409342f01f864d00?s=128&d=identicon&r=PG&f=1", "display_name": "Ashot Bes", "link": "https://stackoverflow.com/users/8109702/ashot-bes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 52609153, "answer_count": 1, "score": 2, "last_activity_date": 1588275704, "creation_date": 1538483666, "last_edit_date": 1588275704, "question_id": 52608452, "link": "https://stackoverflow.com/questions/52608452/how-to-compare-two-utctime-values-and-get-the-difference-in-days", "title": "How to compare two UTCTime values and get the difference in days?", "body": "<p>I want to take away from UTCTime - UTCTime. I found the following function:</p>\n\n<p><code>diffUTCTime :: UTCTime -&gt; UTCTime -&gt; NominalDiffTime</code></p>\n\n<p>But I get the difference in <code>NominalDiffTime</code>, and I need to get the difference in days</p>\n\n<p>Is there any function for this?</p>\n\n<p>Something other than <code>nominalDiffTimeToSeconds</code>?!</p>\n"}, {"tags": ["haskell", "typeclass", "coercion", "phantom-types"], "answers": [{"comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 1, "creation_date": 1538494772, "post_id": 52610759, "comment_id": 92157864, "body": "You are absolutely right, I don\u2019t know why I didn\u2019t notice. Such a stupid mistake. Thank you!"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 1, "last_activity_date": 1538491352, "creation_date": 1538491352, "answer_id": 52610759, "question_id": 52607152, "link": "https://stackoverflow.com/questions/52607152/coercion-of-typeclass-instances-with-phantom-parameter/52610759#52610759", "title": "Coercion of typeclass instances with phantom parameter", "body": "<p>Actually, <code>g</code> and <code>h</code> don't typecheck because the type of <code>imap f</code> is ambiguous.</p>\n\n<pre><code>imap :: IFunctor f =&gt; (a ~&gt; b) -&gt; (f a ~&gt; f b)\n</code></pre>\n\n<p>For example, in <code>h</code>, <code>imap f</code> gets inferred the following type, with free unification variables <code>?f0</code>, <code>?f1</code>, <code>?i0</code>:</p>\n\n<pre><code>h = coerce . (imap f :: ?f0 (IFix ?f1) ?i0 -&gt; ?f0 (IFix ?f1) ?i0) . coerce\n</code></pre>\n\n<p>Usually the context allows us to instantiate these variables, but here the context is:</p>\n\n<pre><code>coerce . _ . coerce\n</code></pre>\n\n<p>note the type of <code>coerce :: Coercible a b =&gt; a -&gt; b</code>, which entirely decouples the input and output types, as far as type inference is concerned.</p>\n\n<p>We can use the extension <code>ScopedTypeVariables</code> to annotate <code>imap f</code>:</p>\n\n<pre><code>h :: forall f i. IFunctor f =&gt; IFix f i -&gt; IFix f i\nh = coerce . (imap f :: f (IFix f) i -&gt; f (IFix f) i) . coerce\n</code></pre>\n\n<p>or specialize <code>coerce</code> to restrict its shape:</p>\n\n<pre><code>type E a = a -&gt; a\n\ni :: IFunctor f =&gt; IFix f i -&gt; IFix f i\ni = (coerce :: E (f (IFix f) i) -&gt; E (IFix f i)) (imap f)\n</code></pre>\n\n<p><code>coerce</code> on its own is too general, so it's common to have to add such annotations. It might be worth having a library of common specializations.</p>\n"}], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 52610759, "answer_count": 1, "score": 1, "last_activity_date": 1538491352, "creation_date": 1538478581, "question_id": 52607152, "link": "https://stackoverflow.com/questions/52607152/coercion-of-typeclass-instances-with-phantom-parameter", "title": "Coercion of typeclass instances with phantom parameter", "body": "<p>I have</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, TypeInType #-}\n\nimport Data.Coerce\nimport Data.Kind\n\nnewtype IFix f i = IFix { unIFix :: f (IFix f) i }\n\nclass IFunctor (f :: (i -&gt; Type) -&gt; i -&gt; Type) where\n  imap :: (forall i'. a i' -&gt; b i') -&gt; (forall i'. f a i' -&gt; f b i')\n\nf :: IFunctor f =&gt; forall i. IFix f i -&gt; IFix f i\nf = undefined\n\ng :: IFunctor f =&gt; forall i. IFix f i -&gt; IFix f i\ng = IFix . imap f . unIFix\n\nh :: IFunctor f =&gt; forall i. IFix f i -&gt; IFix f i\nh = coerce . imap f . coerce\n\ni :: IFunctor f =&gt; forall i. IFix f i -&gt; IFix f i\ni = coerce (imap f)\n</code></pre>\n\n<p>where <code>IFix</code> is a type-level fixpoint of indexed type constructors, <code>i</code> is the index (a phantom parameter), <code>IFunctor</code> is the class of such indexed type constructors that are actually functors, <code>f</code> is just a random function, <code>g</code>, <code>h</code>, <code>i</code> try to propagate <code>f</code> under the <code>IFix</code> wrapper. A side note: this is a simplified example and I actually often run into similar problems in other settings where manual rewrapping becames a bit tedious (for one I would like to avoid mapping the unwrap-rewrap function over lists or other structures).</p>\n\n<pre><code>input:18:5: error:\n    \u2022 Couldn't match representation of type \u2018f (IFix f) i\u2019\n                               with that of \u2018f0 (IFix f1) i0\u2019\n        arising from a use of \u2018coerce\u2019\n   |\n18 | h = coerce . imap f . coerce\n   |     ^^^^^^\n\ninput:21:5: error:\n    \u2022 Couldn't match representation of type \u2018f (IFix f) i\u2019\n                               with that of \u2018f2 (IFix f3) i1\u2019\n        arising from a use of \u2018coerce\u2019\n   |\n21 | i = coerce (imap f)\n   |     ^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>and honestly I am not really surprised, but since I do not see under the hood of coercions I wonder, is there a way to modify my definitions, so that <code>coerce</code> can be applied? I tried <code>RoleAnnotations</code> but</p>\n\n<ol>\n<li><code>type role IFix nominal phantom</code> is invalid</li>\n<li>I have no idea how to require type roles for the type class (and I fear there is no way, since the doc mentions typeclasses assume parameters to be nominal)</li>\n</ol>\n\n<p>So my question is, is there a way to make coerce work in this setting and if not, are there any deep reasons why not or is it just the limitation of the current role inference implementation. My naive view leads me to believe a typeclass could impose constraints on roles of arguments and instances would have to satisfy the constraint. Is there maybe a good source on some useful coercion tricks?</p>\n"}, {"tags": ["haskell", "operators", "operator-precedence"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1538461090, "post_id": 52602610, "comment_id": 92139898, "body": "What are <code>add</code> and <code>subtract</code>? How are they defined?"}, {"owner": {"reputation": 1656, "user_id": 125674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691a140e7bb7b5967b0f0953e77ff00f?s=128&d=identicon&r=PG", "display_name": "dereli", "link": "https://stackoverflow.com/users/125674/dereli"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1538462169, "post_id": 52602610, "comment_id": 92140295, "body": "Not sure that matters, but for this case <code>add = (+)</code> and <code>subtract = flip (-)</code>."}, {"owner": {"reputation": 403, "user_id": 3554119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b79421d48f8e4e753ab9ec19b3a964b7?s=128&d=identicon&r=PG&f=1", "display_name": "dirkt", "link": "https://stackoverflow.com/users/3554119/dirkt"}, "edited": false, "score": 7, "creation_date": 1538464896, "post_id": 52602610, "comment_id": 92141434, "body": "Note that <code>$</code> and <code>.</code> are not necessarily meant to remove parentheses in all cases. The most important use is to make a <i>chain</i> of applications <code>f1 (f2 (f3 (f4 x)))</code> more readable by transforming it into a form of &quot;pipe&quot; <code>f1 $ f2 $ f3 $ f4 $ x</code> or <code>(f1 . f2 . f3 . f4) x</code>. This doesn&#39;t work with functions that take more than one argument."}, {"owner": {"reputation": 1656, "user_id": 125674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691a140e7bb7b5967b0f0953e77ff00f?s=128&d=identicon&r=PG", "display_name": "dereli", "link": "https://stackoverflow.com/users/125674/dereli"}, "edited": false, "score": 0, "creation_date": 1538464974, "post_id": 52602610, "comment_id": 92141464, "body": "well that&#39;s clear, thanks. I want to make sure this is not possible or how if possible."}], "answers": [{"comments": [{"owner": {"reputation": 1656, "user_id": 125674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691a140e7bb7b5967b0f0953e77ff00f?s=128&d=identicon&r=PG", "display_name": "dereli", "link": "https://stackoverflow.com/users/125674/dereli"}, "edited": false, "score": 0, "creation_date": 1538463487, "post_id": 52603219, "comment_id": 92140823, "body": "The reason of using <code>add</code> and <code>subtract</code> is to make it work with prefix. Eventually, I am not trying to solve anything, just trying to figure out ways to use <code>$</code> oparetor."}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "reply_to_user": {"reputation": 1656, "user_id": 125674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691a140e7bb7b5967b0f0953e77ff00f?s=128&d=identicon&r=PG", "display_name": "dereli", "link": "https://stackoverflow.com/users/125674/dereli"}, "edited": false, "score": 0, "creation_date": 1538463583, "post_id": 52603219, "comment_id": 92140861, "body": "You can use prefix <code>+</code> for example <code>(+) 1 2</code>."}, {"owner": {"reputation": 1656, "user_id": 125674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691a140e7bb7b5967b0f0953e77ff00f?s=128&d=identicon&r=PG", "display_name": "dereli", "link": "https://stackoverflow.com/users/125674/dereli"}, "edited": false, "score": 0, "creation_date": 1538464048, "post_id": 52603219, "comment_id": 92141056, "body": "yes, I know but still it won&#39;t work with the expression in the question."}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "reply_to_user": {"reputation": 1656, "user_id": 125674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691a140e7bb7b5967b0f0953e77ff00f?s=128&d=identicon&r=PG", "display_name": "dereli", "link": "https://stackoverflow.com/users/125674/dereli"}, "edited": false, "score": 0, "creation_date": 1538464133, "post_id": 52603219, "comment_id": 92141109, "body": "Yes. There is no way it will work without parenthesis."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538484081, "post_id": 52603219, "comment_id": 92151106, "body": "How exactly are you supposed to apply your <code>pure&#39;</code>/<code>(.$.)</code> pair to the original problem?"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538532496, "post_id": 52603219, "comment_id": 92171589, "body": "@chepner you can write that expression without parentheses <code>add 1 $ w $ pure&#39; add .$. subtract 2 4 .$. subtract 8 16</code>"}], "tags": [], "owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "is_accepted": false, "score": 3, "last_activity_date": 1538466530, "last_edit_date": 1538466530, "creation_date": 1538462768, "answer_id": 52603219, "question_id": 52602610, "link": "https://stackoverflow.com/questions/52602610/haskell-operator-in-practical-use/52603219#52603219", "title": "Haskell $ operator in practical use", "body": "<p>You can try infix form</p>\n\n<pre><code>add 1 $ subtract 2 4 `add` subtract 8 16\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>There is other way. </p>\n\n<p>Lets define:</p>\n\n<pre><code>newtype W a = W { w :: a } \n\npure' = W\n\n(.$.) :: W (a -&gt; b) -&gt; a -&gt; W b\n(.$.) (W a) b = W $ a b\n</code></pre>\n\n<p>and operation to use for example</p>\n\n<pre><code>plus :: Int -&gt; Int -&gt; Int\nplus = (+)\n</code></pre>\n\n<p>Then we can do next</p>\n\n<pre><code>foo :: Int\nfoo = w $ pure' plus .$. plus 1 2  .$.  2 \n</code></pre>\n\n<p>It is basically applicative functor (you can google it for examples) just with different names.</p>\n\n<p>You prefix your operation with <code>w $ pure'</code> and separate arguments with <code>.$.</code>.</p>\n"}], "owner": {"reputation": 1656, "user_id": 125674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691a140e7bb7b5967b0f0953e77ff00f?s=128&d=identicon&r=PG", "display_name": "dereli", "link": "https://stackoverflow.com/users/125674/dereli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1538466530, "creation_date": 1538459052, "question_id": 52602610, "link": "https://stackoverflow.com/questions/52602610/haskell-operator-in-practical-use", "title": "Haskell $ operator in practical use", "body": "<p>I am trying to get my head around in Haskell expressions using <code>$</code> operator. Specifically on how to write this in Haskell using <code>$</code> operator or another if required:</p>\n\n<pre><code>add 1 (add (subtract 2 4) (subtract 8 16))\n</code></pre>\n\n<p>I managed to remove two paren groups as in:</p>\n\n<pre><code>add 1 $ add (subtract 2 4) $ subtract 8 16\n</code></pre>\n\n<p>But still need to remove the last pair.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell", "combinations", "combinatorics"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1538482090, "post_id": 52602474, "comment_id": 92150040, "body": "Can the original list have any duplicates?"}], "answers": [{"comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1577044232, "post_id": 52602906, "comment_id": 105077662, "body": "It&#39;s interesting to note that if the order of appearance of  <code>subsets 0 _ = [[]]</code> and <code>subsets _ [] = []</code> changes it breaks."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 12, "last_activity_date": 1538460923, "creation_date": 1538460923, "answer_id": 52602906, "question_id": 52602474, "link": "https://stackoverflow.com/questions/52602474/function-to-generate-the-unique-combinations-of-a-list-in-haskell/52602906#52602906", "title": "Function to generate the unique combinations of a list in Haskell", "body": "<p>I don't know a predefined function either, but it's pretty easy to write yourself:</p>\n\n<pre><code>-- Every set contains a unique empty subset.\nsubsets 0 _ = [[]]\n\n-- Empty sets don't have any (non-empty) subsets.\nsubsets _ [] = []\n\n-- Otherwise we're dealing with non-empty subsets of a non-empty set.\n-- If the first element of the set is x, we can get subsets of size n by either:\n--   - getting subsets of size n-1 of the remaining set xs and adding x to each of them\n--     (those are all subsets containing x), or\n--   - getting subsets of size n of the remaining set xs\n--     (those are all subsets not containing x)\nsubsets n (x : xs) = map (x :) (subsets (n - 1) xs) ++ subsets n xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "is_accepted": false, "score": 2, "last_activity_date": 1538462100, "creation_date": 1538462100, "answer_id": 52603107, "question_id": 52602474, "link": "https://stackoverflow.com/questions/52602474/function-to-generate-the-unique-combinations-of-a-list-in-haskell/52603107#52603107", "title": "Function to generate the unique combinations of a list in Haskell", "body": "<p>There is no such operation in lib, but you can easily implement it yourself:</p>\n\n<pre><code>import Data.List\n\nmain = putStrLn $ show $ myOp 2 [1, 2, 3]\n\nmyOp :: Int -&gt; [a] -&gt; [[a]]\nmyOp 0 _ = []\nmyOp 1 l = map (:[]) l\nmyOp c l = concat $ map f $ tails l\n    where\n        f :: [a] -&gt; [[a]]\n        f []     = []\n        f (x:xs) = map (x:) $ myOp (c - 1) xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "edited": false, "score": 2, "creation_date": 1595162483, "post_id": 52605612, "comment_id": 111372954, "body": "<a href=\"http://pointfree.io/\" rel=\"nofollow noreferrer\">Pointfree</a>: <code>combinations = (. subsequences) . filter . (. length) . (==)</code>"}], "tags": [], "owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "is_accepted": false, "score": 5, "last_activity_date": 1571709055, "last_edit_date": 1571709055, "creation_date": 1538472441, "answer_id": 52605612, "question_id": 52602474, "link": "https://stackoverflow.com/questions/52602474/function-to-generate-the-unique-combinations-of-a-list-in-haskell/52605612#52605612", "title": "Function to generate the unique combinations of a list in Haskell", "body": "<p>Using <code>Data.List</code>:</p>\n\n<pre><code>import Data.List\ncombinations k ns = filter ((k==).length) $ subsequences ns\n</code></pre>\n\n<p>Reference: <a href=\"https://wiki.haskell.org/99_questions/Solutions/26\" rel=\"nofollow noreferrer\">99 Haskell Problems</a></p>\n\n<p>There are quite a few interesting solutions in the reference, I just picked a concise one.</p>\n"}, {"tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": false, "score": 3, "last_activity_date": 1608720784, "last_edit_date": 1608720784, "creation_date": 1571776152, "answer_id": 58511843, "question_id": 52602474, "link": "https://stackoverflow.com/questions/52602474/function-to-generate-the-unique-combinations-of-a-list-in-haskell/58511843#58511843", "title": "Function to generate the unique combinations of a list in Haskell", "body": "<p>It is not clear to me how concerned you would be about performance.</p>\n<p>If it can be of any use, back in 2014, somebody posted some sort of <a href=\"https://stackoverflow.com/questions/26727673/haskell-comparison-of-techniques-for-generating-combinations\">performance contest</a> of various Haskell combinations generating algorithms.</p>\n<p>For combinations of 13 items out of 26, execution times varied from 3 to 167 seconds ! The fastest entry was provided by <a href=\"https://stackoverflow.com/questions/21265454/subsequences-of-length-n-from-list-performance/21288092#21288092\">Bergi</a>. Here is the non-obvious (for me at least) source code:</p>\n<pre><code>subsequencesOfSize :: Int -&gt; [a] -&gt; [[a]]\nsubsequencesOfSize n xs = let l = length xs\n                          in if (n &gt; l) then []\n                             else subsequencesBySize xs !! (l-n)\n where\n   subsequencesBySize [] = [[[]]]\n   subsequencesBySize (x:xs) = let next = subsequencesBySize xs\n                               in zipWith (++)\n                                    ([]:next)\n                                    ( map (map (x:)) next ++ [[]] )                 \n</code></pre>\n<p>More recently, the question has been <a href=\"https://stackoverflow.com/questions/58262463/filter-subsets-based-on-length\">revisited</a>, in the specific context of picking a few elements from a large list (5 out of 100). In that case, you cannot use something like <code>subsequences [1 .. 100]</code> because that refers to a list whose length is 2<sup>100</sup> \u2243 1.26*10<sup>30</sup>. I submitted a state machine based <a href=\"https://stackoverflow.com/a/58368298/11282404\">algorithm</a> which is not as Haskell-idiomatic as I would like, but is reasonably efficient for that sort of situations, something around 30 clock cycles per output item.</p>\n<h2>Side note: Using <em>multisets</em> to generate combinations ?</h2>\n<p>Also, there is a <a href=\"http://hackage.haskell.org/package/multiset-comb\" rel=\"nofollow noreferrer\">Math.Combinatorics.Multiset</a> package available. Here is the <a href=\"https://hackage.haskell.org/package/multiset-comb-0.2.4.1/docs/Math-Combinatorics-Multiset.html\" rel=\"nofollow noreferrer\">documentation</a>. I have only briefly tested it, but it can be used to generate combinations.</p>\n<p>For example, the set of all combinations of 3 elements out of 8 are just like the &quot;permutations&quot; of a <a href=\"https://en.wikipedia.org/wiki/Multiset\" rel=\"nofollow noreferrer\">multiset</a> with two elements (Present and Absent) with respective multiplicities of 3 and (8-3)=5.</p>\n<p>Let us use the idea to generate all combinations of 3 elements out of 8. There are (8<em>7</em>6)/(3<em>2</em>1) = 336/6 = 56 of them.</p>\n<pre><code>*L M Mb T MS&gt; import qualified Math.Combinatorics.Multiset as MS\n*Math.Combinatorics.Multiset L M Mb T MS&gt; pms = MS.permutations\n*Math.Combinatorics.Multiset L M Mb T MS&gt; :set prompt &quot;\u03bb&gt; &quot;\n\u03bb&gt; \n\u03bb&gt; pms38 = pms $ MS.fromCounts [(True, 3), (False,5)]\n\u03bb&gt; \n\u03bb&gt; length pms38\n56\n\u03bb&gt;\n\u03bb&gt; take 3 pms38\n[[True,True,True,False,False,False,False,False],[True,True,False,False,False,False,False,True],[True,True,False,False,False,False,True,False]]\n\u03bb&gt; \n\u03bb&gt; str = &quot;ABCDEFGH&quot;\n\u03bb&gt; combis38 = L.map fn pms38 where fn mask = L.map fst $ L.filter snd (zip str mask)\n\u03bb&gt; \n\u03bb&gt; sort combis38\n[&quot;ABC&quot;,&quot;ABD&quot;,&quot;ABE&quot;,&quot;ABF&quot;,&quot;ABG&quot;,&quot;ABH&quot;,&quot;ACD&quot;,&quot;ACE&quot;,&quot;ACF&quot;,&quot;ACG&quot;,&quot;ACH&quot;,&quot;ADE&quot;,&quot;ADF&quot;,&quot;ADG&quot;,&quot;ADH&quot;,&quot;AEF&quot;,&quot;AEG&quot;,&quot;AEH&quot;,&quot;AFG&quot;,&quot;AFH&quot;,&quot;AGH&quot;,&quot;BCD&quot;,&quot;BCE&quot;,&quot;BCF&quot;,&quot;BCG&quot;,&quot;BCH&quot;,&quot;BDE&quot;,&quot;BDF&quot;,&quot;BDG&quot;,&quot;BDH&quot;,&quot;BEF&quot;,&quot;BEG&quot;,&quot;BEH&quot;,&quot;BFG&quot;,&quot;BFH&quot;,&quot;BGH&quot;,&quot;CDE&quot;,&quot;CDF&quot;,&quot;CDG&quot;,&quot;CDH&quot;,&quot;CEF&quot;,&quot;CEG&quot;,&quot;CEH&quot;,&quot;CFG&quot;,&quot;CFH&quot;,&quot;CGH&quot;,&quot;DEF&quot;,&quot;DEG&quot;,&quot;DEH&quot;,&quot;DFG&quot;,&quot;DFH&quot;,&quot;DGH&quot;,&quot;EFG&quot;,&quot;EFH&quot;,&quot;EGH&quot;,&quot;FGH&quot;]\n\u03bb&gt;\n\u03bb&gt; length combis38\n56\n\u03bb&gt;\n</code></pre>\n<p>So functionally at least, the idea of using multisets to generate combinations works.</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 2, "last_activity_date": 1580131828, "last_edit_date": 1580131828, "creation_date": 1578754003, "answer_id": 59695480, "question_id": 52602474, "link": "https://stackoverflow.com/questions/52602474/function-to-generate-the-unique-combinations-of-a-list-in-haskell/59695480#59695480", "title": "Function to generate the unique combinations of a list in Haskell", "body": "<p>@melpomene's answer is generic and very concise. That's probably what you see in many places over the internet where a <code>combinationsOf</code> function is required.</p>\n\n<p>However hidden behind the double recursion it does tons of needless recursive calls those can be avoided, yielding a much efficient code. i.e we don't need to make any calls if the length of the list is shorter than <code>k</code>.</p>\n\n<p>I would propose a double termination check.</p>\n\n<pre><code>combinationsOf :: Int -&gt; [a] -&gt; [[a]]\ncombinationsOf k xs = runner n k xs\n                      where\n                      n = length xs\n                      runner :: Int -&gt; Int -&gt; [a] -&gt; [[a]]\n                      runner n' k' xs'@(y:ys) = if k' &lt; n'      -- k' &lt; length of the list\n                                                then if k' == 1\n                                                     then map pure xs'\n                                                     else map (y:) (runner (n'-1) (k'-1) ys) ++ runner (n'-1) k' ys\n                                                else pure xs'   -- k' == length of the list.\n\n\u03bb&gt; length $ subsets 10 [0..19] -- taken from https://stackoverflow.com/a/52602906/4543207\n184756\n(1.32 secs, 615,926,240 bytes)\n\n\u03bb&gt; length $ combinationsOf 10 [0..19]\n184756\n(0.45 secs, 326,960,528 bytes)\n</code></pre>\n\n<p>So the above code, while optimized as much as possible, is still inefficient mainly due to double recursion from within. As a rule of thumb, in any algorithm a double recursions should best be avoided or be considered under very careful inspection.</p>\n\n<p>The following algorithm on the other hand, is a very efficient way of doing this job both on speed and memory consumption.</p>\n\n<pre><code>combinationsOf :: Int -&gt; [a] -&gt; [[a]]\ncombinationsOf 1 as        = map pure as\ncombinationsOf k as@(x:xs) = run (l-1) (k-1) as $ combinationsOf (k-1) xs\n                             where\n                             l = length as\n\n                             run :: Int -&gt; Int -&gt; [a] -&gt; [[a]] -&gt; [[a]]\n                             run n k ys cs | n == k    = map (ys ++) cs\n                                           | otherwise = map (q:) cs ++ run (n-1) k qs (drop dc cs)\n                                           where\n                                           (q:qs) = take (n-k+1) ys\n                                           dc     = product [(n-k+1)..(n-1)] `div` product [1..(k-1)]\n\n\u03bb&gt; length $ combinationsOf 10 [0..19]\n184756\n(0.09 secs, 51,126,448 bytes)\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 10394930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5fc94932382e087ae14e58bade83cbc?s=128&d=identicon&r=PG&f=1", "display_name": "newb346", "link": "https://stackoverflow.com/users/10394930/newb346"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4856, "favorite_count": 0, "answer_count": 5, "score": 3, "last_activity_date": 1608720784, "creation_date": 1538457990, "last_edit_date": 1571781815, "question_id": 52602474, "link": "https://stackoverflow.com/questions/52602474/function-to-generate-the-unique-combinations-of-a-list-in-haskell", "title": "Function to generate the unique combinations of a list in Haskell", "body": "<p>Is there a Haskell function that generates all the unique combinations of a given length from a list?</p>\n\n<pre><code>Source = [1,2,3]\n\nuniqueCombos 2 Source = [[1,2],[1,3],[2,3]]\n</code></pre>\n\n<p>I tried looking in Hoogle but could not find a function that did this specifically. Permutations does not give the desired result.</p>\n\n<p>Has anybody used a similar function before?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1538453348, "post_id": 52601129, "comment_id": 92137959, "body": "Somebody has probably written <code>deriving Functor</code> using template haskell, which might get you there (maybe it needs a mod).  In fact I think I have one <a href=\"http://hackage.haskell.org/package/deriving-compat\" rel=\"nofollow noreferrer\">right here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "edited": false, "score": 1, "creation_date": 1538928709, "post_id": 52686259, "comment_id": 92307651, "body": "This is good enough for my use case since if I want to restrict the scope of this I can split the type and its instances into a separate Haskell module and then add either  <code>{-# OPTIONS_GHC -fexpose-all-unfoldings #-}</code> or <code>{-# OPTIONS_GHC -fspecialise-aggressively #-}</code> to the top of the module"}, {"owner": {"reputation": 521, "user_id": 1710649, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/6fs5k.png?s=128&g=1", "display_name": "Aearnus", "link": "https://stackoverflow.com/users/1710649/aearnus"}, "reply_to_user": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "edited": false, "score": 0, "creation_date": 1538948925, "post_id": 52686259, "comment_id": 92313170, "body": "@GabrielGonzalez those annotations are news to me. Thanks for that! Also, a note: you can still mark large functions <code>NOINLINE</code> to ensure that they don&#39;t get inlined and destroy the filesize."}], "tags": [], "owner": {"reputation": 521, "user_id": 1710649, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/6fs5k.png?s=128&g=1", "display_name": "Aearnus", "link": "https://stackoverflow.com/users/1710649/aearnus"}, "is_accepted": true, "score": 4, "last_activity_date": 1538896148, "creation_date": 1538896148, "answer_id": 52686259, "question_id": 52601129, "link": "https://stackoverflow.com/questions/52601129/inlining-derived-typeclass-methods/52686259#52686259", "title": "Inlining derived typeclass methods", "body": "<p>Though you cannot \"reopen\" instances in Haskell like you could with classes in dynamic languages, there are ways to ensure that functions will be aggressively inlined whenever possible by passing certain flags to GHC.</p>\n\n<blockquote>\n  <p><code>-fspecialise-aggressively</code> removes the restrictions about which functions are specialisable. Any overloaded function will be\n  specialised with this flag. This can potentially create lots of\n  additional code.</p>\n  \n  <p><code>-fexpose-all-unfoldings</code> will include the (optimised) unfoldings of all functions in interface files so that they can be inlined and\n  specialised across modules.</p>\n  \n  <p>Using these two flags in conjunction will have nearly the same effect\n  as marking every definition as <code>INLINABLE</code> apart from the fact that the\n  unfoldings for <code>INLINABLE</code> definitions are not optimised.</p>\n</blockquote>\n\n<p>(Source: <a href=\"https://wiki.haskell.org/Inlining_and_Specialisation#Which_flags_can_I_use_to_control_the_simplifier_and_inliner.3F\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Inlining_and_Specialisation#Which_flags_can_I_use_to_control_the_simplifier_and_inliner.3F</a>)</p>\n\n<p>These options will allow the GHC compiler to inline <code>fmap</code>. The <code>-fexpose-all-unfoldings</code> option, in particular, allows the compiler to expose the internals of <code>Data.Functor</code> to the rest of the program for inlining purposes (and it seems to provide the largest performance benefit). Here's a quick &amp; dumb benchmark I threw together:</p>\n\n<p><code>functor.hs</code> contains this code:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n{-# LANGUAGE Strict #-}\n\ndata Foo a = MakeFoo a a deriving (Functor)\n\none_fmap foo = fmap (+1) foo\n\nmain = sequence (fmap (\\n -&gt; return $ one_fmap $ MakeFoo n n) [1..10000000])\n</code></pre>\n\n<p>Compiled with no arguments:</p>\n\n<pre><code>$ time ./functor \n\nreal    0m4.036s\nuser    0m3.550s\nsys 0m0.485s\n</code></pre>\n\n<p>Compiled with <code>-fexpose-all-unfoldings</code>:</p>\n\n<pre><code>$ time ./functor\n\nreal    0m3.662s\nuser    0m3.258s\nsys 0m0.404s\n</code></pre>\n\n<p>Here's the <code>.prof</code> file from this compile, to show that the call to <code>fmap</code> is indeed getting inlined:</p>\n\n<pre><code>    Sun Oct  7 00:06 2018 Time and Allocation Profiling Report  (Final)\n\n       functor +RTS -p -RTS\n\n    total time  =        1.95 secs   (1952 ticks @ 1000 us, 1 processor)\n    total alloc = 4,240,039,224 bytes  (excludes profiling overheads)\n\nCOST CENTRE MODULE SRC              %time %alloc\n\nCAF         Main   &lt;entire-module&gt;  100.0  100.0\n\n\n                                                                     individual      inherited\nCOST CENTRE MODULE                SRC             no.     entries  %time %alloc   %time %alloc\n\nMAIN        MAIN                  &lt;built-in&gt;       44          0    0.0    0.0   100.0  100.0\n CAF        Main                  &lt;entire-module&gt;  87          0  100.0  100.0   100.0  100.0\n CAF        GHC.IO.Handle.FD      &lt;entire-module&gt;  84          0    0.0    0.0     0.0    0.0\n CAF        GHC.IO.Encoding       &lt;entire-module&gt;  77          0    0.0    0.0     0.0    0.0\n CAF        GHC.Conc.Signal       &lt;entire-module&gt;  71          0    0.0    0.0     0.0    0.0\n CAF        GHC.IO.Encoding.Iconv &lt;entire-module&gt;  58          0    0.0    0.0     0.0    0.0\n</code></pre>\n\n<p>Compiled with <code>-fspecialise-aggressively</code>:</p>\n\n<pre><code>$ time ./functor\n\nreal    0m3.761s\nuser    0m3.300s\nsys 0m0.460s\n</code></pre>\n\n<p>Compiled with both flags:</p>\n\n<pre><code>$ time ./functor\n\nreal    0m3.665s\nuser    0m3.213s\nsys 0m0.452s\n</code></pre>\n\n<p>These little benchmarks are by no means representative of what the performance (or filesize) will like in real code, but it definitely shows that you can force the GHC compiler to inline <code>fmap</code> (and that it really can have non-negligible effects on performance).</p>\n"}], "owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 4, "accepted_answer_id": 52686259, "answer_count": 1, "score": 21, "last_activity_date": 1538896148, "creation_date": 1538446251, "question_id": 52601129, "link": "https://stackoverflow.com/questions/52601129/inlining-derived-typeclass-methods", "title": "Inlining derived typeclass methods", "body": "<p>Haskell lets you derive typeclass instances, such as:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\ndata Foo a = MakeFoo a a deriving (Functor)\n</code></pre>\n\n<p>... but sometimes benchmarks show that performance improves if you manually implement the typeclass instance and annotate the type class method(s) with <code>INLINE</code>, like this:</p>\n\n<pre><code>data Foo a = MakeFoo a a\n\ninstance Functor Foo where\n    fmap f (MakeFoo x y) = MakeFoo (f x) (f y)\n    {-# INLINE fmap #-}\n</code></pre>\n\n<p>Is there a way to get the best of both worlds?  In other words, is there a way to derive the typeclass instance and also annotate the derived typeclass methods with <code>INLINE</code>?</p>\n"}, {"tags": ["haskell", "travis-ci", "cabal", "stackage"], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1538423212, "post_id": 52597788, "comment_id": 92130379, "body": "Won&#39;t that add MissingH-1.4.0.1 each of the builds listed in my <code>stack.yaml</code>? The problem is that doing that for the (current) <code>nightly</code> appears to be essential; but doing it for any (currently) older LTS will be wrong (since it won&#39;t really be building against that LTS anymore)."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1538424357, "post_id": 52597788, "comment_id": 92130921, "body": "I see, that&#39;s an extra-dep only for the new nightly. You can change the travis script to add the extra-dep only in that case, for example by checking in a custom <code>stack-ghc-8.6.yaml</code> and pointing stack to it with the <code>--stack-yaml</code> command line option."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1538428436, "post_id": 52597788, "comment_id": 92132635, "body": "But that needs to be in the <code>.cabal</code> for it to correctly describe how the package will build in the presence of each LTS, right? Perhaps what I need is <a href=\"https://stackoverflow.com/a/35662514/656912\">something conditional in the <code>.cabal</code></a>, but I&#39;m not sure how to express it."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1538428801, "post_id": 52597788, "comment_id": 92132743, "body": "The problem here is that <code>MissingH</code> is not in a snapshot you&#39;re using. This is irrelevant to <code>*.cabal</code>."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1538429324, "post_id": 52597788, "comment_id": 92132926, "body": "I\u2019m using several snapshots, but can only have 1 cabal file which needs to work with all of them, as is (not by adding something externally)."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1538429955, "post_id": 52597788, "comment_id": 92133113, "body": "Sure, that&#39;s how it works, and there is generally no need to tweak the cabal file. &quot;how the package will build in the presence of each LTS&quot; - that is not what the cabal file is meant to describe. All you need is to setup travis to use a different <code>stack.yaml</code> for <code>nightly-2018-10-01</code>. This shouldn&#39;t affect the cabal file."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1538516770, "post_id": 52597788, "comment_id": 92167904, "body": "My <code>stack.yaml</code> isn&#39;t used at all by Travis (is it?). What I need is a conditional way of adding <code>MissingH</code> to the packages provided in LTS, but only when GHC &gt;= 8.6.1, in my <code>travis.yaml</code>."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1538517355, "post_id": 52597788, "comment_id": 92168087, "body": "Travis does use <code>stack.yaml</code>, <code>stack</code>&#39;s <code>--resolver</code> option only overrides the <code>resolver:</code> field but not the others. I have already mentioned you can create a separate yaml file for the latest nightly resolver that includes <code>MissingH</code> and change the travis script to use it."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1538518602, "post_id": 52597788, "comment_id": 92168453, "body": "Got it (finally, sorry). So the crux of the answer then needs to be: how to get the <code>travis.yaml</code> to use a different <code>stack.yaml</code> depending on the value of  <code>$RESOLVER</code> (whether or not its in a list of possible values)."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1538518756, "post_id": 52597788, "comment_id": 92168511, "body": "BTW, when I do add the extra-dip, the <a href=\"https://travis-ci.org/orome/crypto-enigma-hs/jobs/436372956\" rel=\"nofollow noreferrer\">relevant build</a> still gives and error: <code>Could not find module \u2018Data.String.Utils\u2019</code>"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 1, "creation_date": 1538522047, "post_id": 52597788, "comment_id": 92169418, "body": "This conditional is making it so that the package doesn&#39;t depend at all on <code>MissingH</code> with GHC 8.6. You do not need a conditional here at all. I will update my answer to give more details about configuring Travis."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 3, "last_activity_date": 1538523279, "last_edit_date": 1538523279, "creation_date": 1538422835, "answer_id": 52597788, "question_id": 52596621, "link": "https://stackoverflow.com/questions/52596621/what-does-no-specified-version-mean-in-my-cabal-build/52597788#52597788", "title": "What does &#39;no specified version&#39; mean in my Cabal build?", "body": "<p>You need to add <code>MissingH</code> to <code>stack.yaml</code>.</p>\n\n<pre><code>extra-deps:\n  - 'MissingH-1.4.0.1'\n</code></pre>\n\n<ul>\n<li><p>Your package's <code>*.cabal</code> file says what versions of dependencies are compatible with your package. It is a loose specification, not all combinations may actually work (because they may have conflicting bounds on transitive dependencies, or there is some unforeseen breakage with a particular version you haven't tested with).</p></li>\n<li><p>In contrast, <code>stack.yaml</code> describes a particular <em>snapshot</em> of packages, pinned to specific versions. This precisely says \"my package is known to work with those versions\". Of course, it is tedious to maintain the version of every dependency, and for that the Stackage team maintains a \"resolver\", a curated set of package versions known to work together, that you can use to specify the version of many packages at once, by setting the <code>resolver:</code> field of <code>stack.yaml</code> appropriately. A resolver only lists a subset of packages on Hackage, so when one of your dependencies is not in there, you need to add it to your <code>stack.yaml</code> as an <code>extra-dep</code>.</p></li>\n</ul>\n\n<hr>\n\n<p>Update: following the discussion, some more details about configuring travis are necessary.</p>\n\n<p>First, my current preferred solution for CI of Haskell projects is to not bother with stack and use instead <a href=\"https://github.com/haskell-CI/haskell-ci\" rel=\"nofollow noreferrer\">https://github.com/haskell-CI/haskell-ci</a> which generates a travis script using cabal-install.</p>\n\n<p>Now for a less radical solution.</p>\n\n<p>Currently the <a href=\"https://github.com/orome/crypto-enigma-hs/blob/92f478f09e9a302f057e83e7c13da8a5cca949a5/.travis.yml#L21\" rel=\"nofollow noreferrer\">travis script</a> is only varying the <code>--resolver</code> option, but as far as I can tell there is no command line option to add an extra-dep. It seems <code>stack.yaml</code> files are the only way for that. Furthermore, we only want to specify <code>MissingH</code> as an extra-dep for the latest nightlies, because LTS'es already include it.</p>\n\n<p>Thus I suggest the following:</p>\n\n<ol>\n<li><p>Create a separate <code>stack.yaml</code> for the nightly resolver only, call it something else since you already have one, for example <code>stack-nightly.yaml</code></p>\n\n<pre><code>packages:\n- .\nextra-deps:\n- 'MissingH-1.4.0.1'\n</code></pre></li>\n<li><p>Set an environment variable to point to <code>stack-nightly.yaml</code> when the resolver is a nightly, maybe:</p>\n\n<pre><code>env:\n...\n- $RESOLVER=nightly STACK_YAML=stack-nightly.yaml\n# Not sure of the syntax.\n</code></pre>\n\n<p>Otherwise you can use the <code>--stack-yaml</code> command line option.</p></li>\n</ol>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2266, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1538523279, "creation_date": 1538417565, "last_edit_date": 1538417990, "question_id": 52596621, "link": "https://stackoverflow.com/questions/52596621/what-does-no-specified-version-mean-in-my-cabal-build", "title": "What does &#39;no specified version&#39; mean in my Cabal build?", "body": "<p>The recent <a href=\"https://github.com/orome/crypto-enigma-hs/blob/develop/.travis.yml\" rel=\"nofollow noreferrer\">Travis CI build</a> of the <a href=\"https://github.com/orome/crypto-enigma-hs/tree/develop\" rel=\"nofollow noreferrer\">development version</a> of <a href=\"https://hackage.haskell.org/package/crypto-enigma\" rel=\"nofollow noreferrer\">my Haskell package</a> reports the error </p>\n\n<blockquote>\n  <p>MissingH must match >=1.3.0.1, but the stack configuration has no specified version (latest matching version is 1.4.0.1)</p>\n</blockquote>\n\n<p><a href=\"https://travis-ci.org/orome/crypto-enigma-hs/jobs/435736808\" rel=\"nofollow noreferrer\">when building for GHC 8.6.1</a>, even though I have </p>\n\n<pre><code>MissingH &gt;=1.3.0.1 \n</code></pre>\n\n<p><a href=\"https://github.com/orome/crypto-enigma-hs/blob/develop/crypto-enigma.cabal\" rel=\"nofollow noreferrer\">in my</a> <code>build-depends</code>.</p>\n\n<p>I don't understand this error: it seems contradictory. I have no upper limit on MissingH, so why is it erroring and not using the latest?</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "edited": false, "score": 0, "creation_date": 1538436688, "post_id": 52594418, "comment_id": 92134827, "body": "Thank you for the answer. I have one more question, can you elaborate on what polymorphic function will the compiler pass into &quot;bar&quot; function in the call-site."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "edited": false, "score": 1, "creation_date": 1538465344, "post_id": 52594418, "comment_id": 92141617, "body": "@zeronone An instance <code>instance Colored a =&gt; Colored [a]</code> essentially describe how to implement the methods for <code>[a]</code>, given those for <code>a</code>, for all possible types <code>a</code>. This is, essentially, the polymorphic function between the two dictionaries"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 11, "last_activity_date": 1538412991, "last_edit_date": 1538412991, "creation_date": 1538408004, "answer_id": 52594418, "question_id": 52593423, "link": "https://stackoverflow.com/questions/52593423/how-are-quantifiedconstraints-translated-into-dictionary-passing-style/52594418#52594418", "title": "How are QuantifiedConstraints translated into dictionary passing style?", "body": "<p>For regular constraints, the translation maps</p>\n\n<pre><code>class Colored a where\n   isRed :: a -&gt; Bool\n\nfoo :: Colored a =&gt; T\n</code></pre>\n\n<p>to</p>\n\n<pre><code>newtype ColoredDict a = CD (a -&gt; Bool)\n\nfoo :: ColoredDict a -&gt; T\n</code></pre>\n\n<p>Similarly,</p>\n\n<pre><code>bar :: (forall a. Colored a =&gt; Colored [a]) =&gt; U\n</code></pre>\n\n<p>can be translated as</p>\n\n<pre><code>bar :: (forall a. ColoredDict a -&gt; ColoredDict [a]) -&gt; U\n</code></pre>\n\n<blockquote>\n  <p>2) A predicate corresponds to passing a dictionary transformer to the \n  function.</p>\n</blockquote>\n\n<p>The first argument of <code>bar</code> is the \"dictionary transformer\" the OP mentions.</p>\n\n<p><code>bar</code> involves a rank-2 type, but Haskell has been using these for a long time.</p>\n\n<blockquote>\n  <p>1) Reduce the predicate <code>Binary (f (GRose f a))</code> to just  <code>Binary\n  (GRose f a)</code></p>\n</blockquote>\n\n<p>The point is: every time <code>bar</code> need to resolve a constraint <code>Colored [t]</code>, it can exploit the quantified constraint and instead try to resolve the simpler constraint <code>Colored a</code>.</p>\n"}], "owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 2, "accepted_answer_id": 52594418, "answer_count": 1, "score": 10, "last_activity_date": 1538490292, "creation_date": 1538404470, "last_edit_date": 1538490292, "question_id": 52593423, "link": "https://stackoverflow.com/questions/52593423/how-are-quantifiedconstraints-translated-into-dictionary-passing-style", "title": "How are QuantifiedConstraints translated into dictionary passing style?", "body": "<p><code>QuantifiedConstraints</code><sup><a href=\"https://ghc.haskell.org/trac/ghc/wiki/QuantifiedConstraints\" rel=\"noreferrer\">1</a></sup> has landed in GHC 8.6, I am reading Deriving Type Classes (section 7)<sup><a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2000/09/derive.pdf\" rel=\"noreferrer\">2</a></sup> where it was first suggested. However I can't understand, in operational terms, how <code>QuantifiedConstraints</code> are translated into dictionaries. Following is the excerpt from the paper.</p>\n\n<blockquote>\n  <p>What we need is a way to simplify the predicate\n  <code>f (GRose f a)</code>. The trick is to take the \"constant\" instance\n  declaration that we assumed for <code>Binary (List a)</code> above, and\n  abstract over it:</p>\n</blockquote>\n\n<pre><code>instance (Binary a,\n          forall b. (Binary b) =&gt; Binary (f b)\n         ) =&gt; Binary (GRose f a) where\n  showBin (GBranch x ts ) = showBin x ++ showBin ts\n</code></pre>\n\n<blockquote>\n  <p>Now, as well as <code>(Binary a)</code>, the context also contains\n  a polymorphic predicate. This predicate an be used to\n  reduce the predicate <code>Binary (f (GRose f a))</code> to just\n  <code>Binary (GRose f a)</code>, and we have an instance declaration\n  for that.</p>\n  \n  <p>Viewed in operational terms, the predicate <code>(Binary a)</code>\n  in a context corresponds to passing a dictionary for class\n  <code>Binary</code>. A predicate <code>forall b. Binary b =&gt; Binary (f b)</code> corresponds\n  to passing a dictionary transformer to the function.</p>\n</blockquote>\n\n<p>In particular I can't grok the following:</p>\n\n<p>1) Reduce the predicate <code>Binary (f (GRose f a))</code> to just  <code>Binary (GRose f a)</code></p>\n\n<p>2) A predicate corresponds to passing a dictionary transformer to the function.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1538398969, "post_id": 52591336, "comment_id": 92118182, "body": "Did you consider using <code>catchError</code> instead?"}], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 8, "last_activity_date": 1538399344, "last_edit_date": 1538399344, "creation_date": 1538398985, "answer_id": 52591798, "question_id": 52591336, "link": "https://stackoverflow.com/questions/52591336/can-i-escape-the-io-in-catch/52591798#52591798", "title": "Can I escape the `IO` in `catch`", "body": "<pre><code>-- Note that MonadError e io is unnecessary.\ncatchM :: (Exception e, MonadIO io) =&gt; IO a -&gt; (e -&gt; io a) -&gt; io a\ncatchM m h = do\n  r &lt;- liftIO (try m)\n  case r of\n    Left e -&gt; h e\n    Right a -&gt; pure a\n</code></pre>\n"}], "owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 52591798, "answer_count": 1, "score": 2, "last_activity_date": 1538399344, "creation_date": 1538397483, "question_id": 52591336, "link": "https://stackoverflow.com/questions/52591336/can-i-escape-the-io-in-catch", "title": "Can I escape the `IO` in `catch`", "body": "<p>Here's a type-puzzle for you. So we have</p>\n\n<pre><code>catch\n  :: Exception e\n  =&gt; IO a\n  -&gt; (e -&gt; IO a)\n  -&gt; IO a\n</code></pre>\n\n<p>Is it possible for me to safely escape <code>IO</code> in the handler. I'm interested in a function with a signature similar to the following:</p>\n\n<pre><code>catchM\n  :: Exception e\n  =&gt; MonadIO io\n  =&gt; MonadError e io\n  =&gt; IO a\n  -&gt; (e -&gt; io a)\n  -&gt; io a\n</code></pre>\n\n<p>Is this sensible or am I looking at this wrong?</p>\n\n<p>Some additional context: My problem is that I'm using a library that throws exceptions in <code>IO</code>. I've wrapped some of these functions and lifted them into my own monad (using <code>liftIO</code>). I want to be able to catch some of the functions that this library can throw in the places where I call the lifted version that I've provided. Also, when I catch the exceptions, I would like to re-throw them inside my own error-handling framework.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1538364032, "post_id": 52584167, "comment_id": 92103212, "body": "To test my understanding of what you&#39;ve said: Rather than &quot;untyped&quot; would it be correct to call it &quot;not yet typed&quot;?"}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 1, "creation_date": 1538364132, "post_id": 52584167, "comment_id": 92103229, "body": "Rather, it would be &quot;taking a type variable&quot;. When you see a type declaration that has type variables in it, you can think of it as a function that takes types (as many as there are type variables), and returns a concrete type. so a declaration of the form <code>foo :: a -&gt; a</code> is really sort of like <code>foo :: (a :: Type) -&gt; a -&gt; a</code>."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 1, "creation_date": 1538364307, "post_id": 52584167, "comment_id": 92103277, "body": "@Addem No, it wouldn&#39;t. It is always &quot;typed&quot;, it&#39;s just that sometimes types can be &quot;variable&quot; - i.e. they can vary. I have updated the answer in that part."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1538364563, "post_id": 52584167, "comment_id": 92103326, "body": "@M.Aroosi I think that is way too complicated for the OP. Will only serve to confuse."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1538400411, "post_id": 52584167, "comment_id": 92119060, "body": "@Addem It&#39;s typed, because <code>a -&gt; a</code> still tracks types: the return type <i>must</i> match the argument type. Functions with unconstrained types exhibit <i>parametric polymorphism</i>, as opposed to functions with types like <code>Num a =&gt; a -&gt; a</code>, where <code>a</code> doesn&#39;t have to allow <i>any</i> type, just those that fulfill the constraint by having an instance of <code>Num</code> (referred to as <i>ad hoc</i> polymorphism, since each such instance can decide for itself how the function will work; there is no global definition that they must all support)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1538400464, "post_id": 52584167, "comment_id": 92119101, "body": "Regarding &quot;case&quot; vs &quot;constructor&quot;, <code>Null</code> and <code>Container</code> are constructors; each one (or use of one) is typically matched in a separate case of a <code>case</code> statement, but are not themselves cases."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 11, "last_activity_date": 1538364287, "last_edit_date": 1538364287, "creation_date": 1538363934, "answer_id": 52584167, "question_id": 52584050, "link": "https://stackoverflow.com/questions/52584050/how-does-haskell-know-whether-a-data-type-declaration-is-a-variable-or-a-named-t/52584167#52584167", "title": "How does Haskell know whether a data type declaration is a variable or a named type?", "body": "<p>First of all, terminology: \"flavors\" are called \"cases\" or \"constructors\". Your type has two cases - <code>Null</code> and <code>Container</code>.</p>\n\n<hr>\n\n<p>Second, what you call \"untyped\" is not really \"untyped\". That's not the right way to think about it. The <code>a</code> in declaration <code>func :: a -&gt; a</code> does not mean \"untyped\" the same way variables are \"untyped\" in JavaScript or Python (though even that is not really true), but rather \"whoever calls this function chooses the type\". So if I call <code>func \"abc\"</code>, then I have chosen <code>a</code> to be <code>String</code>, and now the compiler knows that the result of this call must also be <code>String</code>, since that's what the <code>func</code>'s signature says - \"I take any type you choose, and I return the same type\". The proper term for this is \"<em>generic</em>\".</p>\n\n<p>The difference between \"untyped\" and \"generic\" is that \"untyped\" is free-for-all, the type will only be known at runtime, no guarantees whatsoever; whereas generic types, even though not precisely known yet, still have some sort of relationship between them. For example, your <code>func</code> says that it returns the same type it takes, and not something random. Or for another example:</p>\n\n<pre><code>mkList :: a -&gt; [a]\nmkList a = [a]\n</code></pre>\n\n<p>This function says \"I take some type that you choose, and I will return a list of that same type - never a list of something else\".</p>\n\n<hr>\n\n<p>Finally, your <code>myType</code> declaration is actually illegal. In Haskell, concrete types have to be <code>Capitalized</code>, while values and type variables are <code>javaCase</code>. So first, you have to change the name of the type to satisfy this:</p>\n\n<pre><code>data MyType = Null | Container TypeA v\n</code></pre>\n\n<p>If you try to compile this now, you'll still get an error saying that \"Type variable <code>v</code> is unknown\". See, Haskell has decided that <code>v</code> must be a type variable, and not a concrete type, because it's lower case. That simple.</p>\n\n<p>If you want to use a type variable, you have to declare it somewhere. In function declaration, type variables can just sort of \"appear\" out of nowhere, and the compiler will consider them \"declared\". But in a type declaration you have to declare your type variables explicitly, e.g.:</p>\n\n<pre><code>data MyType v = Null | Container TypeA v\n</code></pre>\n\n<p>This requirement exist to avoid confusion and ambiguity in cases where you have several type variables, or when type variables come from another context, such as a type class instance.</p>\n\n<p>Declared this way, you'll have to specify something in place of <code>v</code> every time you use <code>MyType</code>, for example:</p>\n\n<pre><code>n :: MyType Int\nn = Null\n\nmkStringContainer :: TypeA -&gt; String -&gt; MyType String\nmkStringContainer ta s = Container ta s\n\n-- Or make the function generic\nmkContainer :: TypeA -&gt; a -&gt; MyType a\nmkContainer ta a = Container ta a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 9, "last_activity_date": 1538364663, "creation_date": 1538364663, "answer_id": 52584231, "question_id": 52584050, "link": "https://stackoverflow.com/questions/52584050/how-does-haskell-know-whether-a-data-type-declaration-is-a-variable-or-a-named-t/52584231#52584231", "title": "How does Haskell know whether a data type declaration is a variable or a named type?", "body": "<p>Haskell uses a critically important distinction between <strong>variables</strong> and <strong>constructors</strong>. Variables begin with a lower-case letter; constructors begin with an upper-case letter<sup>1</sup>.</p>\n\n<p>So <code>data myType = Null | Container TypeA v</code> is actually incorrect; the first symbol after the <code>data</code> keyword is the name of the new type constructor you're introducing, so it <em>must</em> start with a capital letter.</p>\n\n<p>Assuming you've fixed that to <code>data MyType = Null | Container TypeA v</code>, then each of the alternatives separated by <code>|</code> is required to consist of a data constructor name (here you've chosen <code>Null</code> and <code>Container</code>) followed by a type expression for each of the fields of that constructor.</p>\n\n<p>The <code>Null</code> constructor has no fields. The <code>Container</code> constructor has two fields:</p>\n\n<ol>\n<li><code>TypeA</code>, which starts with a capital letter so it must be a type constructor; therefore the field is of that concrete type.</li>\n<li><code>v</code>, which starts with a lowercase letter and is therefore a type variable. Normally this variable would be defined as a type parameter on the <code>MyType</code> type being defined, like <code>data MyType v = Null | Container TypeA v</code>. You cannot normally use free variables, so this was another error in your original example.<sup>2</sup></li>\n</ol>\n\n<p>Your data declaration showed how the distinction between constructors and variables matters at the type level. This distinction between variables and constructors is also present at the value level. It's how the compiler can tell (when you're writing pattern matches) which terms are patterns it should be checking the data against, and which terms are variables that should be bound to whatever the data contains. For example:</p>\n\n<pre><code>lookAtMaybe :: Show a =&gt; Maybe a -&gt; String\nlookAtMaybe Nothing = \"Nothing to see here\"\nlookAtMaybe (Just x) = \"I found: \" ++ show x\n</code></pre>\n\n<p>If Haskell didn't have the first-letter rule, then there would be two possible interpretations of the first clause of the function:</p>\n\n<ol>\n<li><code>Nothing</code> could be a <em>reference</em> to the externally-defined <code>Nothing</code> constructor, saying I want this function rule to apply when the argument matches that constructor. This is the interpretation the first-letter rule mandates.</li>\n<li><code>Nothing</code> could be a <em>definition</em> of an (unused) variable, representing the function's argument. This would be the equivalent of <code>lookAtMaybe x = \"Nothing to see here\"</code></li>\n</ol>\n\n<p>Both of those interpretations are valid Haskell code producing different behaviour (try changing the capital <code>N</code> to a lower case <code>n</code> and see what the function does). So Haskell needs a rule to choose between them. The designers chose the first-letter rule as a way of simply disambiguating constructors from variables (that is simple to both the compiler and to human readers) without requiring any additional syntactic noise.</p>\n\n<hr>\n\n<p><sup>1</sup> The rule about the case of the first letter applies to alphanumeric names, which can only consist of letters, numbers, and underscores. Haskell also has symbolic names, which consists only of symbol characters like <code>+</code>, <code>*</code>, <code>:</code>, etc. For these, the rule is that names beginning with the <code>:</code> character are constructors, while names beginning with another character are variables. This is how the list constructor <code>:</code> is distinguished from a function name like <code>+</code>. </p>\n\n<p><sup>2</sup> With the <code>ExistentialQuantification</code> extension turned on it is possible to write <code>data MyType = Null | forall v. Container TypeA v</code>, so that the the constructor has a field with a variable type and the variable does <em>not</em> appear as a parameter to the overall type. I'm not going to explain how this works here; it's generally considered an advanced feature, and isn't part of standard Haskell code (which is why it requires an extension)</p>\n"}], "owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 52584167, "answer_count": 2, "score": 7, "last_activity_date": 1538364663, "creation_date": 1538362434, "question_id": 52584050, "link": "https://stackoverflow.com/questions/52584050/how-does-haskell-know-whether-a-data-type-declaration-is-a-variable-or-a-named-t", "title": "How does Haskell know whether a data type declaration is a variable or a named type?", "body": "<p>Take a data type declaration like </p>\n\n<pre><code>data myType = Null | Container TypeA v \n</code></pre>\n\n<p>As I understand it, Haskell would read this as <code>myType</code> coming in two different flavors.  One of them is <code>Null</code> which Haskell interprets just as some name of a ... I guess you'd call it an instance of the type?  Or a subtype?  Factor?  Level?  Anyway, if we changed <code>Null</code> to <code>Nubb</code> it would behave in basically the same way--Haskell doesn't really know anything about null values.  </p>\n\n<p>The other flavor is <code>Container</code> and I would expect Haskell to read this as saying that the <code>Container</code> flavor takes two fields, <code>TypeA</code> and <code>v</code>.  I expect this is because, when making this type definition, the first word is always read as the name of the flavor and everything that follows is another field.  </p>\n\n<p>My question (besides: did I get any of that wrong?) is, how does Haskell know that <code>TypeA</code> is a specific named type rather than an un-typed variable?  Am I wrong to assume that it reads <code>v</code> as an un-typed variable, and if that's right, is it because of the lower-case initial letter?</p>\n\n<p>By un-typed I mean how the types appear in the following type-declaration for a function:</p>\n\n<pre><code>func :: a -&gt; a \nfunc a = a\n</code></pre>\n"}, {"tags": ["haskell", "types"], "answers": [{"comments": [{"owner": {"reputation": 5649, "user_id": 49733, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/46d6184d8f4347ca961b6a9479a8cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Ryan Tolmasky I", "link": "https://stackoverflow.com/users/49733/francisco-ryan-tolmasky-i"}, "edited": false, "score": 0, "creation_date": 1538408092, "post_id": 52588731, "comment_id": 92123669, "body": "Thanks this is a great answer! I am going to try the more generic Node definition you provided."}], "tags": [], "owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "is_accepted": true, "score": 1, "last_activity_date": 1538388194, "creation_date": 1538388194, "answer_id": 52588731, "question_id": 52583315, "link": "https://stackoverflow.com/questions/52583315/pattern-for-constraining-a-type-to-another-type/52588731#52588731", "title": "Pattern for constraining a type to another type", "body": "<p>If you have a single hashmap it's going to be difficult to statically guarantee that tests are not mapped to suite-failures or vice versa. \nThe ideas you already have are pretty much what you can do unless you want to have two different ID-types and require each lookup to specify if a test or suite is being queried for status. </p>\n\n<p>If I may suggest a more drastic change: How about getting rid of the hashtable and storing the tests and statuses in the same structure?</p>\n\n<p>Something like:</p>\n\n<pre><code>-- s is suite data, t is test data\ndata Node s t =\n    Suite { metadata :: Metadata, children :: [Node s t], suiteStuff :: s }\n    Test { metadata :: Metadata, testStuff :: t } \n\nStatus f =\n   Waiting |\n   Skipped { dueTo :: Id } |\n   Failure { failStuff :: f } |\n   Success { duration :: int }\n\n-- Like the old node type, containing test cases\ntype TestTree = Node Config String\n\n-- A status tree contains IO actions for retrieving the current status of tests/testsuites\ntype StatusTree = Node (IO (Status [Id])) (IO (Status Reason))\n\n-- Running tests\nstartRunning :: TestTree -&gt; IO StatusTree\n</code></pre>\n\n<p>Depending on how you typically traverse the statuses, this could work quite nicely. Of course you can still have a HashMap (or two hashmaps) underneath it all if you want (e.g. <code>Table Id (Status (Either [ID] Reason))</code>) and the IO-actions in the tree are just lookups. Or you could just have an <code>IORef</code> for each suite/test.</p>\n\n<p>Writing or deriving a <code>Functor</code> instance for <code>Node</code> may be very useful. </p>\n"}], "owner": {"reputation": 5649, "user_id": 49733, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/46d6184d8f4347ca961b6a9479a8cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Ryan Tolmasky I", "link": "https://stackoverflow.com/users/49733/francisco-ryan-tolmasky-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 52588731, "answer_count": 1, "score": 4, "last_activity_date": 1538388194, "creation_date": 1538354305, "question_id": 52583315, "link": "https://stackoverflow.com/questions/52583315/pattern-for-constraining-a-type-to-another-type", "title": "Pattern for constraining a type to another type", "body": "<p>I know the title isn't great, so I want to just give a specific example. I have a tree-like structure, modeling a test suite:</p>\n\n<pre><code>data Metadata = Metadata { id :: Id, disabled :: Bool }\ndata Node =\n    Suite { metadata :: Metadata, config :: Config, children :: [Node] }\n    Test { metadata :: Metadata, code :: string } \n</code></pre>\n\n<p>So basically, we have <code>Suite</code>s, which themselves could own other test <code>Suite</code>s, or <code>Test</code>s. This is really quite similar to a <code>Tree</code> definition (with parent <code>Tree</code>s and terminal <code>Leaf</code>s). So far nothing too crazy, except for I've left out other details from the constructors (I used a hypothetical <code>Config</code> type for the <code>Suite</code> constructor, since the details of that aren't pertinent to this question, except to demonstrate that the two constructors are actually significantly different so you wouldn't want a directly recursive structure <code>Node = Node { stuff :: Stuff, children: Maybe [Node] }</code></p>\n\n<p>Now, I have a type that <em>relates</em> to this type. Specifically, as the tests are running, I keep track of their respective statuses:</p>\n\n<pre><code>Status =\n   Waiting |\n   Skipped { dueTo :: Id } |\n   Failure { reason :: Reason } |\n   Success { duration :: int }\n</code></pre>\n\n<p>The <code>Test</code>s (and <code>Suite</code>s) could at any given moment be in any one of these states (there are more statuses left out since I do not believe them to be relevant). . I store the states in a hash table of sorts from <code>Id</code> to <code>Status</code>: <code>Table Id Status</code>.</p>\n\n<p>The problem arrises that, while <code>Skipped</code> and <code>Waiting</code> are actually totally fine for both <code>Suite</code> and <code>Test</code>, <code>Failure</code> and <code>Success</code> actually want to store slightly different data depending on for which they are. Without getting into the weeds of the specific information, say we want the <code>Failure</code> for <code>Suites</code> to store the failed child <code>Id</code>'s to avoid repeatedly re-calculating this (in our case there is actual non-generative data stored). One option is to just break it up into two <code>Status</code>es:</p>\n\n<pre><code>   ...\n   TestFailure { reason :: Reason } |\n   SuiteFailure { failedChildren :: [Id] } |\n   ...\n</code></pre>\n\n<p>This isn't great though because you need something like <code>isFailure = Status -&gt; Bool</code> since there are TWO failures, and because we can't guarantee that <code>TestFailure</code>s will be associated with <code>Test</code>s in our hash table. We can solve the first problem by splitting out the internal info into a separate type:</p>\n\n<pre><code>data FailureInfo =\n   TestInfo { reason :: Reason } |\n   SuiteInfo { failedChildren :: [Id], otherStuff :: Whatever }\n\ndata Status =\n   ...\n   Failure { info :: FailureInfo }\n   ...\n</code></pre>\n\n<p>This is certainly better, but there is still the issue that I can't guarantee that a <code>Failure { TestInfo }</code> is only associated with a <code>Test</code>. This is the crux of my question: given a type with multiple constructors, how can a variate a supporting type on those constructors in a way that I get the maximum support from the compiler.</p>\n\n<p>If you imagine temporarily that <code>Suite</code> and <code>Test</code> were actually distinct types (instead of merely constructors of one type), I would maybe want a type parameter <code>Status a</code>, and a hash table mapping from <code>a</code> to <code>Status a</code> (but this would also not completely answer the question).</p>\n"}, {"tags": ["haskell", "functor", "dependent-type", "applicative", "category-theory"], "owner": {"reputation": 938, "user_id": 474311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aad241f867909f119502ffbff53849af?s=128&d=identicon&r=PG", "display_name": "Dan Onea\u021b\u0103", "link": "https://stackoverflow.com/users/474311/dan-onea%c8%9b%c4%83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 3, "answer_count": 0, "score": 6, "last_activity_date": 1538377343, "creation_date": 1538337651, "last_edit_date": 1538377343, "question_id": 52581642, "link": "https://stackoverflow.com/questions/52581642/a-categorical-view-on-applicative-containers", "title": "A categorical view on applicative containers", "body": "<p><a href=\"https://stackoverflow.com/a/50717675/474311\">This answer</a> from Conor McBride (pigworker) discusses <code>Applicative</code> functors that are also <a href=\"https://www.sciencedirect.com/science/article/pii/S0304397505003373?via%3Dihub\" rel=\"noreferrer\"><em>containers</em></a> (data types given by a set of shapes and a family of positions).\nAmong other things, he mentions that:</p>\n\n<ul>\n<li>A polymorphic function between two containers has two components: one acting on shapes and one on positions.</li>\n<li>The shape of applicative containers form a monoid under an operation related to the application operation, <code>&lt;*&gt;</code>.</li>\n</ul>\n\n<p>I was wondering if a similar analysis can be carried in a categorical setting and if I could reach the same conclusions using category theory (mainly because I feel more at ease with category theory than with dependent type theory).</p>\n\n<p>I know that <code>Applicative</code> functors are <a href=\"https://en.wikipedia.org/wiki/Monoidal_functor\" rel=\"noreferrer\">monoidal functors</a> (from <code>(Set, \u00d7, 1)</code> to <code>(Set, \u00d7, 1)</code>) and I believe that containers can be regarded as <a href=\"http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.30.2179&amp;rep=rep1&amp;type=pdf\" rel=\"noreferrer\">functors shapely over lists</a> (as suggested <a href=\"https://www.fceia.unr.edu.ar/~mauro/pubs/TraverseLaws.pdf\" rel=\"noreferrer\">here</a> or <a href=\"https://www.cs.ox.ac.uk/jeremy.gibbons/publications/uitbaf.pdf\" rel=\"noreferrer\">here</a>) \u2013 but I'm not very comfortable with this concept or this assertion.\nIs this the right way of thinking about applicative containers, as monoidal functors that are shapely over lists?</p>\n\n<p>P.S.: Let me know if you feel that stackoverflow is not the appropriate place to ask this sort of question.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1538335634, "post_id": 52580526, "comment_id": 92097881, "body": "List comprehensions produce <i>lists</i>, not single <code>Int</code> values. A list comprehension by itself won&#39;t do what you want. (It&#39;s possible to create a list with a single element whose value is the one you want, but then the list comprehension itself isn&#39;t actually doing any of the real work.)"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 10321338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/20Pz7.jpg?s=128&g=1", "display_name": "OnlyDavies", "link": "https://stackoverflow.com/users/10321338/onlydavies"}, "edited": false, "score": 0, "creation_date": 1538338912, "post_id": 52580563, "comment_id": 92098739, "body": "Very useful, I could finally get solved it thanks to you, but I changed one thing, in the zip [0..] bin I used zip [(length (bin)-1), (length (bin) -2) ..] bin] because I wanted to change the positions"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1538329854, "creation_date": 1538329854, "answer_id": 52580563, "question_id": 52580526, "link": "https://stackoverflow.com/questions/52580526/transform-a-binary-number-into-a-decimal-without-recursivity-haskell/52580563#52580563", "title": "Transform a Binary Number into a Decimal without recursivity [HASKELL]", "body": "<blockquote>\n  <p>The problem it is, when I need to know the position of the digit for apply the transform because I can't save the position in the list of comprehension.</p>\n</blockquote>\n\n<p>You can, by using <code>zip</code> and a range, you generate 2-tuples that carry the index, like:</p>\n\n<pre><code>[(idx, val) | (idx, val) &lt;- zip [0..] bin]\n</code></pre>\n\n<p>will produce a list of 2-tuples: the first element containing the element, and the second the element of <code>data</code> at that position.</p>\n\n<p>So if <code>bin = [0,1,0]</code>, then the above list comprehension will result in:</p>\n\n<pre><code>Prelude&gt; [(idx, val) | (idx, val) &lt;- zip [0..] bin]\n[(0,0),(1,1),(2,0)]\n</code></pre>\n\n<p>Since this seems to be the \"core problem\", I propose that you aim to solve the rest of the problem with the above strategy, or ask a question (edit this one, or ask a new one) if you encouter other problems.</p>\n"}], "owner": {"reputation": 123, "user_id": 10321338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/20Pz7.jpg?s=128&g=1", "display_name": "OnlyDavies", "link": "https://stackoverflow.com/users/10321338/onlydavies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 52580563, "answer_count": 1, "score": 0, "last_activity_date": 1538329854, "creation_date": 1538329618, "last_edit_date": 1538329730, "question_id": 52580526, "link": "https://stackoverflow.com/questions/52580526/transform-a-binary-number-into-a-decimal-without-recursivity-haskell", "title": "Transform a Binary Number into a Decimal without recursivity [HASKELL]", "body": "<p>I haven't found a way to solve this. I have a list of integer, where which element of the list is a binary digit (0 or 1) so I need to design a function which transforms this list of integers into the proper decimal number.</p>\n\n<p>Example: </p>\n\n<p>Input: <code>[0,1,0]</code>\nOutput: <code>2</code></p>\n\n<p>But there is a specific condition, it is neccesary to use list of comprehension and you can't use recursivity.</p>\n\n<p>The problem it is, when I need to know the position of the digit for apply the transform because I can't save the position in the list of comprehension.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["haskell", "haskell-stack", "quickcheck"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1538310275, "post_id": 52577833, "comment_id": 92090861, "body": "This is a different package: <a href=\"http://hackage.haskell.org/package/tasty-quickcheck\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/tasty-quickcheck</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1538347583, "post_id": 52577833, "comment_id": 92100530, "body": "Tasty is an &quot;umbrella&quot; framework that unifies a few different approaches to testing.  Quickcheck is one such approach.  <code>Test.Tasty.QuickCheck</code> is the module that ties tasty and quickcheck together."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1538351142, "post_id": 52577833, "comment_id": 92101135, "body": "You also have <code>import Test.Tasty</code> somewhere, do you?"}], "answers": [{"tags": [], "owner": {"reputation": 186, "user_id": 3768043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac2549a3109b6cb7912d125672e15cf7?s=128&d=identicon&r=PG&f=1", "display_name": "jonas-schulze", "link": "https://stackoverflow.com/users/3768043/jonas-schulze"}, "is_accepted": false, "score": 0, "last_activity_date": 1575920475, "creation_date": 1575920475, "answer_id": 59255544, "question_id": 52577833, "link": "https://stackoverflow.com/questions/52577833/whats-the-difference-between-test-quickcheck-and-test-tasty-quickcheck/59255544#59255544", "title": "what&#39;s the difference between Test.QuickCheck and Test.Tasty.QuickCheck?", "body": "<p>In case you are using <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">stack</a>, you need to build that package:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>stack build tasty\nstack build tasty-quickcheck\n</code></pre>\n\n<p>After that, <code>stack ghc ...</code> and <code>stack ghci</code> will be able to find the module <code>Test.Tasty.QuickCheck</code>.</p>\n"}], "owner": {"reputation": 101, "user_id": 10429975, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D-E2-UHsaOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWNBrMIBj8VPPmGT-WHLnDQWGC0Wg/mo/photo.jpg?sz=128", "display_name": "Yellowsgg", "link": "https://stackoverflow.com/users/10429975/yellowsgg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1575920475, "creation_date": 1538310229, "question_id": 52577833, "link": "https://stackoverflow.com/questions/52577833/whats-the-difference-between-test-quickcheck-and-test-tasty-quickcheck", "title": "what&#39;s the difference between Test.QuickCheck and Test.Tasty.QuickCheck?", "body": "<p>I am new to Quickcheck, and in my program,\n    import Test.QuickCheck works, but\n    import Test.Tasty.QuickCheck will report \"Could not find module \u2018Test.Tasty\u2019\"</p>\n"}, {"tags": ["haskell", "typeclass"], "owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "closed_date": 1538343272, "answer_count": 0, "score": 2, "locked_date": 1538343291, "last_activity_date": 1538326968, "creation_date": 1538308057, "last_edit_date": 1538308485, "question_id": 52577583, "link": "https://stackoverflow.com/questions/52577583/why-instance-resolution-in-haskell-doesnt-consider-constraints", "closed_reason": "Duplicate", "title": "Why instance resolution in Haskell doesn&#39;t consider constraints?", "body": "<p>AFAIK, instance resolution in Haskell only looks at the instance head and doesn't backtrack to look for more potential instances (find best match?) (<a href=\"https://chrisdone.com/posts/haskell-constraint-trick\" rel=\"nofollow noreferrer\">as explained here</a>). Is there any reason for that?</p>\n\n<p>In other words, why are constraints not considered during instance resolution? Is it to avoid recompiling packages, in case new instance declarations become available (as it can effect instance resolution)?</p>\n"}, {"tags": ["haskell", "sdl", "sdl-2"], "answers": [{"tags": [], "owner": {"reputation": 974, "user_id": 3829232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d2de116df80bc024b799e84dcdbc97?s=128&d=identicon&r=PG", "display_name": "soupi", "link": "https://stackoverflow.com/users/3829232/soupi"}, "is_accepted": true, "score": 1, "last_activity_date": 1538301822, "creation_date": 1538301822, "answer_id": 52576846, "question_id": 52576400, "link": "https://stackoverflow.com/questions/52576400/how-to-create-a-gradually-faded-image-via-sdl2/52576846#52576846", "title": "How to create a gradually faded image via sdl2?", "body": "<p>I suggest using <code>Renderer</code> and <code>Texture</code>s instead of <code>Surface</code> (<a href=\"https://stackoverflow.com/questions/21392755/difference-between-surface-and-texture-sdl-general#26113388\">reason</a>). Using <code>Texture</code>, you can set the alpha mode this way:</p>\n\n<pre><code>textureBlendMode texture $= BlendAlphaBlend\ntextureAlphaMod  texture $= 255 - fadednum\n</code></pre>\n\n<p>Note that these are global variables so you probably would like to set <code>textureAlphaMod</code> back to 255 after <code>copy</code>.</p>\n\n<p>A simplified version of the code you wrote converted to use <code>Renderer</code> and <code>Texture</code> will look like this:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Main (main) where\n\nimport Control.Concurrent (threadDelay)\nimport Foreign.C.Types\nimport Data.Word\nimport SDL.Vect\nimport qualified SDL\n\nscreenWidth, screenHeight :: CInt\n(screenWidth, screenHeight) = (960, 720)\n\nfadednum :: Word8\nfadednum = 0\n\ngetDataFileName :: FilePath -&gt; IO FilePath\ngetDataFileName = return\n\nmain :: IO ()\nmain = do\n  SDL.initialize [SDL.InitVideo]\n  window &lt;- SDL.createWindow \"our super mario\" SDL.defaultWindow { SDL.windowInitialSize = V2 screenWidth screenHeight }\n  SDL.showWindow window\n\n  renderer &lt;- SDL.createRenderer window (-1) SDL.defaultRenderer\n\n  bmp &lt;- getDataFileName \"Entry.bmp\" &gt;&gt;= SDL.loadBMP\n  helloWorld &lt;- SDL.createTextureFromSurface renderer bmp\n  SDL.freeSurface bmp\n\n  myFaded fadednum helloWorld renderer window\n\n  SDL.destroyWindow window\n  SDL.destroyTexture helloWorld\n  SDL.quit\n\nmyFaded :: Word8 -&gt; SDL.Texture -&gt; SDL.Renderer -&gt; SDL.Window -&gt; IO ()\nmyFaded fadednum texture renderer window\n      | fadednum == 255 = return ()\n      | otherwise = do\n          SDL.clear renderer \n\n          SDL.textureBlendMode texture SDL.$= SDL.BlendAlphaBlend\n          SDL.textureAlphaMod  texture SDL.$= 255 - fadednum\n          SDL.copy renderer texture Nothing Nothing\n\n          SDL.textureAlphaMod  texture SDL.$= 255\n\n          SDL.present renderer\n\n          threadDelay 10000\n\n          myFaded (fadednum + 1) texture renderer window\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8933019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87b357d67c754d75ade9fe485c3ce492?s=128&d=identicon&r=PG&f=1", "display_name": "zhengqi gao", "link": "https://stackoverflow.com/users/8933019/zhengqi-gao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 52576846, "answer_count": 1, "score": 0, "last_activity_date": 1538301822, "creation_date": 1538298275, "question_id": 52576400, "link": "https://stackoverflow.com/questions/52576400/how-to-create-a-gradually-faded-image-via-sdl2", "title": "How to create a gradually faded image via sdl2?", "body": "<p>System : MacOS, ghc with sdl2 installed.</p>\n\n<p>As stated in the title, how can I create a gradually faded image via sdl2? (Note that the figure is given by a .bmp file located somewhere in the PC.)</p>\n\n<p>I have already written the code below. <code>myFaded</code> is actually the function I need. However, currently haskell will complain that there is no <code>setSurfaceAlphamod</code>.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Main (main) where\n\nimport Control.Concurrent (threadDelay)\nimport Foreign.C.Types\nimport SDL.Vect\nimport SDL.Raw.Video\nimport qualified SDL\n\nscreenWidth, screenHeight :: CInt\n(screenWidth, screenHeight) = (960, 720)\n\nfadedtime, fadednum :: Int\n(fadedtime, fadednum) = (2000000, 10)\n\ngetDataFileName :: FilePath -&gt; IO FilePath\ngetDataFileName = return\n\n\n\nmyFaded :: Int -&gt; Int -&gt; SDL.Surface -&gt; SDL.Surface -&gt; SDL.Window -&gt; IO ()\nmyFaded fadedtime fadednum surface screenSurface window\n      | fadednum &lt;= 0 = return ()\n      | otherwise = do \n          SDL.surfaceBlit surface Nothing screenSurface Nothing\n          SDL.updateWindowSurface window\n          threadDelay holdtime\n          newsurface &lt;- SDL.setSurfaceAlphaMod surface alpha\n          myFaded (fadedtime - holdtime) (fadednum - 1)  newsurface screenSurface window\n          where alpha = 2\n                holdtime = round $ fromIntegral $ fadedtime `div` fadednum\n\n\n\n\nmain :: IO ()\nmain = do\n  SDL.initialize [SDL.InitVideo]\n  window &lt;- SDL.createWindow \"our super mario\" SDL.defaultWindow { SDL.windowInitialSize = V2 screenWidth screenHeight }\n  SDL.showWindow window\n  screenSurface &lt;- SDL.getWindowSurface window\n\n  helloWorld &lt;- getDataFileName \"figs/Entry.bmp\" &gt;&gt;= SDL.loadBMP\n  --SDL.surfaceBlit helloWorld Nothing screenSurface Nothing\n  --SDL.updateWindowSurface window\n  myFaded fadedtime fadednum helloWorld screenSurface window\n\n\n  --SDL.updateWindowSurface window\n\n  --threadDelay 2000000\n\n  SDL.destroyWindow window\n  SDL.freeSurface helloWorld\n  SDL.quit\n</code></pre>\n"}, {"tags": ["string", "haskell", "integer"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1538263936, "post_id": 52573366, "comment_id": 92083012, "body": "This is not a good question for Stackoverflow. If you want a pointer on this, however, look at <a href=\"https://en.wikipedia.org/wiki/G%C3%B6del_numbering\" rel=\"nofollow noreferrer\">g&#246;del numbering</a>."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 2, "creation_date": 1538264569, "post_id": 52573366, "comment_id": 92083100, "body": "I guess the prevailing question is going to be <i>why</i> you think you need to do that?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1538264747, "post_id": 52573366, "comment_id": 92083114, "body": "@AdamSmith This is a probably an exercise."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1538264887, "post_id": 52573366, "comment_id": 92083131, "body": "@AJFarmar kind of a strange exercise. &quot;Use haskell to turn a string into a unique number?&quot; Hrm. Maybe &quot;Turn a string into a series of bytes&quot; or &quot;serialize a string&quot; or even &quot;using any language, design an algorithm that turns a sequence of characters into a unique number,&quot; but this specific thing seems like an XY problem."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1538266380, "post_id": 52573366, "comment_id": 92083319, "body": "@AdamSmith Can you say carefully what you see as the difference, in principle, between &quot;turn a string into a unique number&quot; and &quot;serialize a string&quot;?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1538278034, "post_id": 52573366, "comment_id": 92084719, "body": "@DanielWagner The way an instructor might explain it to a student who doesn&#39;t know how to approach the problem :)"}, {"owner": {"reputation": 7, "user_id": 8864342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62de9f5ad452684eaa33de1ef9c1ba6?s=128&d=identicon&r=PG&f=1", "display_name": "XanXan", "link": "https://stackoverflow.com/users/8864342/xanxan"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1538297738, "post_id": 52573366, "comment_id": 92087983, "body": "@AJFarmar It&#39;s correct that I taking a class in functional programming at the moment, however this is not part of one of the exercises. In math class we spent half a lecture talking about RSA encryption, and as an exercise for myself I wanted to implement the algorithm in Haskell. But for that to work I needed a way to represent a message (a string) as a number."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 7, "last_activity_date": 1538267313, "last_edit_date": 1538267313, "creation_date": 1538266556, "answer_id": 52573572, "question_id": 52573366, "link": "https://stackoverflow.com/questions/52573366/haskell-non-numeric-string-as-integer/52573572#52573572", "title": "Haskell - non-numeric string as integer", "body": "<p>You may use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Numeric.html#v:readInt\" rel=\"noreferrer\"><code>readInt</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Numeric.html#v:showIntAtBase\" rel=\"noreferrer\"><code>showIntAtBase</code></a>, included in the standard library that ships with GHC, for this task.</p>\n\n<pre><code>Numeric&gt; base = toInteger (fromEnum (maxBound :: Char)) + 1\nNumeric&gt; readInt base (const True) fromEnum \"Hello, world!\"\n[(263317223602531232689798224281528500955719219481801413146983858530815311905,\"\")]\nNumeric&gt; showIntAtBase base toEnum 263317223602531232689798224281528500955719219481801413146983858530815311905 \"\"\n\"Hello, world!\"\n</code></pre>\n\n<p>There is one small caveat: you'll want to write a wrapper that handles the empty string somehow -- perhaps map it to <code>-1</code>, or bump all the other answers up by <code>1</code> or something. On the up side, though, this particular pair of functions has a nice property you didn't demand, namely, every (non-negative) integer corresponds to a unique string.</p>\n"}], "owner": {"reputation": 7, "user_id": 8864342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62de9f5ad452684eaa33de1ef9c1ba6?s=128&d=identicon&r=PG&f=1", "display_name": "XanXan", "link": "https://stackoverflow.com/users/8864342/xanxan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1538267313, "creation_date": 1538263853, "question_id": 52573366, "link": "https://stackoverflow.com/questions/52573366/haskell-non-numeric-string-as-integer", "title": "Haskell - non-numeric string as integer", "body": "<p>I'm trying to convert a non-numeric string to an integer, and back again. That is, I need a way to represent a string, for example \"Hello world!\" as a unique integer, which then can be converted back into the same string. However, I have no idea how to do this, especially not in Haskell which is a language I only been using for a couple of weeks.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1538267683, "post_id": 52573273, "comment_id": 92083484, "body": "Probably a duplicate. Anyway the linked question mentions (in the question itself) an answer to this question. <a href=\"https://stackoverflow.com/q/12398458/791604\">How to group similar items in a list using Haskell?</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1538386189, "post_id": 52573273, "comment_id": 92111179, "body": "near dup: <a href=\"https://stackoverflow.com/questions/48669774/run-length-encoding-in-haskell\" title=\"run length encoding in haskell\">stackoverflow.com/questions/48669774/&hellip;</a>"}, {"owner": {"reputation": 149, "user_id": 1988340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/17ff0f97b23b42a2915cfe5e40d7c619?s=128&d=identicon&r=PG", "display_name": "Breno Santos", "link": "https://stackoverflow.com/users/1988340/breno-santos"}, "edited": false, "score": 0, "creation_date": 1538444726, "post_id": 52573273, "comment_id": 92136305, "body": "EDIT: Thanks everyone for the help. More then 1 answer solves the problem. I up-voted all good answers."}], "answers": [{"comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 2, "creation_date": 1538263271, "post_id": 52573305, "comment_id": 92082923, "body": "Should be <code>(length x, head x)</code> from the OP&#39;s description, and you should add some explanation (or at the very least, pointers to docs on list comprehensions and the group function) (downvote&#39;s not mine, with small improvements this can be a good answer)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1538302539, "post_id": 52573305, "comment_id": 92089083, "body": "this <i>was</i> a good answer even in its first version. the swapping of the tuple is not important, and even good to cause the OP to pay attention. (-2) for <i>that</i>?? I don&#39;t understand this. ---- BTW another way of writing it is <code>map (length &amp;&amp;&amp; head) . group</code>, which <i>is</i> all there is to it."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1538328288, "post_id": 52573305, "comment_id": 92095782, "body": "@Will Ness is always very good at beautifully cutting right into the moral of the story. My take would be the applicative way. Here is another one. <code>(,) &lt;$&gt; length &lt;*&gt; head &lt;$&gt; group</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1538330412, "post_id": 52573305, "comment_id": 92096448, "body": "@Redu almost. :) but first: for me, <code>.</code> is immediately clear, but with <code>&lt;$&gt;</code> I need to think it over to understand which instance it is... and here too you might have thought it&#39;s <code>map</code> (I did, at first, before I checked the type), but it&#39;s actually <code>.</code>. your code is equivalent to <code>liftA2 (,) length head . group :: Eq b =&gt; [b] -&gt; [(Int, b)]</code> but we need <code>map (liftA2 (,) length head) . group :: Eq b =&gt; [b] -&gt; [(Int, b)]</code>. writing it as <code>(liftA2 (,) length head &lt;$&gt;) &lt;$&gt; group</code> would only be an extreme obfuscation, IMO. :)"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1538332593, "post_id": 52573305, "comment_id": 92097117, "body": "@Will Ness Well if you think <code>group</code> as an applicative functor it should all be clear (at least not an extreme obfuscation). So <code>(,) &lt;$&gt; length &lt;*&gt; head</code> is applied to the contained value (result) of the <code>group</code> function. At the end of the day the Functor instance for <code>(-&gt;) r</code> defines <code>fmap</code> to be function composition (<code>.</code>). I said i would be taking the applicative way :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1538334280, "post_id": 52573305, "comment_id": 92097544, "body": "@Redu I had a typo there, which thwarted the whole point of my remark. your code&#39;s type is <code>Eq b =&gt; [b] -&gt; (Int, [b])</code> (I copied the wrong thing from the GHCi window). It calculates an entirely different result."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1538342865, "post_id": 52573305, "comment_id": 92099659, "body": "@Will Ness Yes i&#39;ve got your point. It should be like <code>((,) &lt;$&gt; length &lt;*&gt; head &lt;$&gt;) &lt;$&gt; group</code> due to the nested functures. Thanks for correcting."}], "tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": false, "score": 2, "last_activity_date": 1538310051, "last_edit_date": 1538310051, "creation_date": 1538262991, "answer_id": 52573305, "question_id": 52573273, "link": "https://stackoverflow.com/questions/52573273/count-elements-on-ordered-list/52573305#52573305", "title": "Count elements on ordered list", "body": "<p>What you want can be done by a one-liner</p>\n\n<pre><code>Prelude&gt; import Data.List\nPrelude Data.List&gt; ls = [\"a\", \"a\", \"b\", \"c\", \"c\", \"c\", \"d\"]\nPrelude Data.List&gt; [(length x, head x) | x &lt;- group ls]\n[(2,\"a\"),(1,\"b\"),(3,\"c\"),(1,\"d\")]\n</code></pre>\n\n<p>I mix list comprehension with the <code>group</code> function. Basic concepts you can make yourselves familiar with. </p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 1988340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/17ff0f97b23b42a2915cfe5e40d7c619?s=128&d=identicon&r=PG", "display_name": "Breno Santos", "link": "https://stackoverflow.com/users/1988340/breno-santos"}, "edited": false, "score": 0, "creation_date": 1538444606, "post_id": 52573339, "comment_id": 92136284, "body": "Thanks. This answer is the most complete one."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1538263435, "creation_date": 1538263435, "answer_id": 52573339, "question_id": 52573273, "link": "https://stackoverflow.com/questions/52573273/count-elements-on-ordered-list/52573339#52573339", "title": "Count elements on ordered list", "body": "<p>There are some syntactical problems as well as problems with the types. The first line looks like:</p>\n\n<pre><code>contaOcs [] = [_,_]\n</code></pre>\n\n<p>But an underscore (<code>_</code>) in the result does not makes any sense, you can only construct lists with values in it. When we count the number of occurences of an empty list, the result will be an empty list, so <code>contaOcs [] = []</code>.</p>\n\n<p>As for the second:</p>\n\n<pre><code>   contaOcs [x] = [1,x]\n</code></pre>\n\n<p>Here you aim to return a list with two elements: a <code>1</code> and an <code>x</code> (which is a <code>String</code>). In Haskell the elements of a list all have the <em>same</em> type. What you can do is return a list of 2-tuples with the first item an <code>Int</code>, and the second a <code>String</code>, like the signature suggests, but then you need to wrap the values in a 2-tuple, like <code>contaOcs [x] = [(1,x)]</code>.</p>\n\n<p>In your last clause, you write:</p>\n\n<pre><code>contaOcs (i, x1:x2:xs) = ...\n</code></pre>\n\n<p>which does not make much sense: the input type is a list (here of <code>String</code>s), not a 2-tuple with an <code>Int</code>, and a list of strings.</p>\n\n<p>So the input will look like:</p>\n\n<pre><code>contaOcs (x1:x2:xs) = ...\n</code></pre>\n\n<p>The output, like <code>(i+1,(x2:xs))</code> also is not in \"harmony\" with the proposed output type in the signature, this looks like a 2-tuple with an <code>Int</code>, and a list of <code>String</code>s, so <code>(Int, [String])</code>, not <code>[(Int, String)]</code>.</p>\n\n<p>Based on the above comments, we have derived something like:</p>\n\n<pre><code>contaOcs :: [String] -&gt; [(Int, String)]\ncontaOcs [] = []\ncontaOcs [x] = [(1,x)]\ncontaOcs (x1:x2:xs)\n     | x1 == x2 =  -- ...\n     | otherwise = -- ...\n</code></pre>\n\n<p>So now there are two parts to fill in. In case <code>x1</code> and <code>x2</code> are <em>not</em> equal, that means that we can first yield a tuple <code>(1, x1)</code> in the list, followed by the result of <code>contaOcs</code> on the rest of the list (<code>x2</code> included), so:</p>\n\n<pre><code>(1, x1) : contaOcs (x2:xs)\n</code></pre>\n\n<p>In the latter case, it means that we first make a recursive call to <code>contaOcs</code> with <code>(x2:xs)</code>, and then <em>increment</em> the counter of the first item of that list. We are sure such element exists, since we make a recursive call with a list containing <em>at least</em> one element, and by induction, that means the result contains at least one element as well, since the base case contains one element, and the recursive case either prepends elements to the result, or updates these.</p>\n\n<p>So we can use a pattern guard, and maniplate the result, like:</p>\n\n<pre><code>contaOcs :: [String] -&gt; [(Int, String)]\ncontaOcs [] = []\ncontaOcs [x] = [(1,x)]\ncontaOcs (x1:x2:xs)\n     | x1 == x2, ((yi, yv):ys) &lt;- contaOcs (x2:xs) = (yi+1, yv) : ys\n     | otherwise = (1, x1) : contaOcs (x2:xs)\n</code></pre>\n\n<p>We can also use an \"<em>as-pattern</em>\": we only need a reference to the tail of the list starting with <code>x2</code>, not <code>xs</code>:</p>\n\n<pre><code>contaOcs :: [String] -&gt; [(Int, String)]\ncontaOcs [] = []\ncontaOcs [x] = [(1,x)]\ncontaOcs (x1:xs@(x2:_))\n     | x1 == x2, ((yi, yv):ys) &lt;- contaOcs xs = (yi+1, yv) : ys\n     | otherwise = (1, x1) : contaOcs xs\n</code></pre>\n\n<p>The above is however not very elegantly. It might be better to use an <em>accumulator</em> here, I leave this as an exercise.</p>\n"}, {"tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": false, "score": 4, "last_activity_date": 1538264081, "creation_date": 1538264081, "answer_id": 52573386, "question_id": 52573273, "link": "https://stackoverflow.com/questions/52573273/count-elements-on-ordered-list/52573386#52573386", "title": "Count elements on ordered list", "body": "<p>Let's look at some of the errors mentioned by ghc. Always pay close attention to when GHC talks about Expected and Actual types, as these messages are always illuminating. <code>Expected</code> indicates what GHC <em>thinks</em> you should write.  <code>Actual</code> indicates what you wrote. You either need to change what you wrote (read: change your code), or change what GHC thinks you should write (read: change your type annotations). In this case it's mostly the former.</p>\n\n<pre><code>hw.hs:2:16: error:\n    \u2022 Found hole: _ :: (Int, String)\n    \u2022 In the expression: _\n      In the expression: [_, _]\n      In an equation for \u2018contaOcs\u2019: contaOcs [] = [_, _]\n    \u2022 Relevant bindings include\n        contaOcs :: [String] -&gt; [(Int, String)] (bound at hw.hs:2:1)\n  |\n2 | contaOcs [] = [_,_]\n  |                ^\n\nhw.hs:2:18: error:\n    \u2022 Found hole: _ :: (Int, String)\n    \u2022 In the expression: _\n      In the expression: [_, _]\n      In an equation for \u2018contaOcs\u2019: contaOcs [] = [_, _]\n    \u2022 Relevant bindings include\n        contaOcs :: [String] -&gt; [(Int, String)] (bound at hw.hs:2:1)\n  |\n2 | contaOcs [] = [_,_]\n  |                  ^\n</code></pre>\n\n<p>The underscore is used as a placeholder (or \"hole\"), to be filled in later. GHC is telling you that you should figure out something to put in these holes.</p>\n\n<pre><code>hw.hs:3:19: error:\n    \u2022 Couldn't match type \u2018[Char]\u2019 with \u2018(Int, String)\u2019\n      Expected type: (Int, String)\n        Actual type: String\n    \u2022 In the expression: x\n      In the expression: [1, x]\n      In an equation for \u2018contaOcs\u2019: contaOcs [x] = [1, x]\n  |\n3 | contaOcs [x] = [1,x]\n  |\n</code></pre>\n\n<p>You have declared that the return type of the function is <code>[(Int, String)]</code>, in other words, a List, where each element of the list is a Tuple of <code>Int</code> and <code>String</code>.</p>\n\n<p>Therefore, each element in the list should be a Tuple. The syntax <code>[1,x]</code> means a list with two elements: <code>1</code> and <code>x</code>. GHC has noticed that <code>x</code>, however, is known to be a <code>String</code>, which is not a Tuple. (GHC failed to notice that 1 is not a tuple, for... reasons. Numbers in Haskell are a little weird and GHC is not so helpful with those.)</p>\n\n<p>Perhaps you meant to write <code>(1, x)</code>, which is a tuple of 1 (an <code>Int</code>) and x (a <code>String</code>). However, don't forget to <em>also</em> put that tuple into a list somehow, since your return type is a <em>list</em> of tuples.</p>\n\n<pre><code>hw.hs:4:10: error:\n    \u2022 Couldn't match expected type \u2018[String]\u2019\n                  with actual type \u2018(Integer, [a0])\u2019\n    \u2022 In the pattern: (i, x1 : x2 : xs)\n      In an equation for \u2018contaOcs\u2019:\n          contaOcs (i, x1 : x2 : xs)\n            | x1 == x2 = (i + 1, (x2 : xs))\n            | otherwise = (0, (x2 : xs))\n  |\n4 | contaOcs (i, x1:x2:xs)\n  |          ^^^^^^^^^^^^^\n</code></pre>\n\n<p>GHC is again reminding you that it expects a list of tuples, but in this case, you gave it just one tuple.</p>\n\n<p>The errors are mostly the same as this.</p>\n"}, {"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1538264417, "creation_date": 1538264417, "answer_id": 52573413, "question_id": 52573273, "link": "https://stackoverflow.com/questions/52573273/count-elements-on-ordered-list/52573413#52573413", "title": "Count elements on ordered list", "body": "<p>This is a good example of when a co-recursive function is helpful.</p>\n\n<pre><code>contaOcs :: [String] -&gt; [(Int, String)]\n</code></pre>\n\n<p>We'll define <code>contaOcs</code> as the outer function that takes the list of strings and returns the tuples. First let's look at the trivial cases:</p>\n\n<pre><code>contaOcs [] = []\ncontaOcs [x] = [(1,x)]\n</code></pre>\n\n<p>Pass an empty list, and you should get back an empty list. Pass a single element list, and you should get back a list with one element: <code>(1, x)</code>. Now we can guarantee that any other list is 2+ elements long.</p>\n\n<pre><code>contaOcs (x:xs) = go x xs\n</code></pre>\n\n<p><code>go</code>? What is <code>go</code> you might ask? Well let's define it in the <code>where</code> clause:</p>\n\n<pre><code>  where\n  go cur xs = let (this, rest) = span (==x) xs\n              in (succ . length $ this, cur) : contaOcs diff\n</code></pre>\n\n<p>That's kind of a lot, so let's unpack. <code>go</code> is an idiomatic term for a function helper (this could as easily be named <code>f</code> or <code>frobnicator</code>, it doesn't matter). It takes the character we're counting, which is split separately from the rest of its list, and calls it <code>x</code>. It runs a <code>span (==x)</code> against the rest of the list, which splits it into a tuple <code>(longestPrefixThatMatches, rest)</code>. We return the length of that longest prefix (plus one, since we've stripped off the front character) paired with the character itself in a tuple, then cons that with the recursive case -- handing the rest of the list back to the outer function to handle.</p>\n"}, {"comments": [{"owner": {"reputation": 7404, "user_id": 491497, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e4aab95d9512cd6cd431b60fe00d974c?s=128&d=identicon&r=PG", "display_name": "Sagi", "link": "https://stackoverflow.com/users/491497/sagi"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1538488281, "post_id": 52573590, "comment_id": 92153842, "body": "removed the [x] case"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1538493298, "post_id": 52573590, "comment_id": 92157009, "body": "does <code>take 2 . contaOcs $ [&quot;a&quot;,&quot;b&quot;] ++ repeat &quot;c&quot;</code> work? :)"}], "tags": [], "owner": {"reputation": 7404, "user_id": 491497, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e4aab95d9512cd6cd431b60fe00d974c?s=128&d=identicon&r=PG", "display_name": "Sagi", "link": "https://stackoverflow.com/users/491497/sagi"}, "is_accepted": false, "score": 1, "last_activity_date": 1538488569, "last_edit_date": 1538488569, "creation_date": 1538266714, "answer_id": 52573590, "question_id": 52573273, "link": "https://stackoverflow.com/questions/52573273/count-elements-on-ordered-list/52573590#52573590", "title": "Count elements on ordered list", "body": "<pre><code>contaOcs :: [String] -&gt; [(Int, String)]\ncontaOcs xs = foldr foldContaOcs [] xs\n              where foldContaOcs s [] = (1, s):[]\n                    foldContaOcs s ((n, ch):xs) = if ch == s then (n + 1, s) : xs \n                                                  else (1, s): (n, ch): xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 893, "user_id": 6248287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPegr.jpg?s=128&g=1", "display_name": "\u019b\u019b\u019b", "link": "https://stackoverflow.com/users/6248287/%c6%9b%c6%9b%c6%9b"}, "is_accepted": false, "score": 4, "last_activity_date": 1538341338, "creation_date": 1538341338, "answer_id": 52582141, "question_id": 52573273, "link": "https://stackoverflow.com/questions/52573273/count-elements-on-ordered-list/52582141#52582141", "title": "Count elements on ordered list", "body": "<pre><code>contaOcs ::  [String] -&gt; [(Int, String)]\n</code></pre>\n\n<p><code>contaOcs</code> consumes a list of strings: <code>xss</code>, for each unique string: <code>xs</code> in <code>xss</code>, we produce a pair: <code>p</code>, whose first element represents the number of occurrences of <code>xs</code> in <code>xss</code>, and the second element of <code>p</code> is that <code>xs</code> itself. </p>\n\n<p>We know we need to group strings by their uniqueness and count each unique string's total occurrences. You can follow this idea and implement the rest yourself. <code>contaOcs</code> takes a list and produces a new list so list comprehension should give you what you want. You're transforming one list to another, so fmap a function that accumulates should work. You can also just use natural recursion or accumulator. Here is one way to write <code>contaOcs</code>: </p>\n\n<pre><code>contaOcs = (return . liftA2 (,) length head =&lt;&lt;) . group  \n</code></pre>\n\n<p>Write down the signature, purpose statement, some sample data and test cases first, then it's just a matter of finding the solutions that best fit your need. </p>\n"}], "owner": {"reputation": 149, "user_id": 1988340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/17ff0f97b23b42a2915cfe5e40d7c619?s=128&d=identicon&r=PG", "display_name": "Breno Santos", "link": "https://stackoverflow.com/users/1988340/breno-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 1, "accepted_answer_id": 52573339, "answer_count": 6, "score": 4, "last_activity_date": 1538488569, "creation_date": 1538262508, "last_edit_date": 1538315323, "question_id": 52573273, "link": "https://stackoverflow.com/questions/52573273/count-elements-on-ordered-list", "title": "Count elements on ordered list", "body": "<p>I want to do a Haskell function where the input (a list of Strings) is ordered (always. input is valid only if is ordered) and I want to get the number of occurrences of each different string.</p>\n\n<p>Example:</p>\n\n<pre><code>ContaOcs[\"a\", \"a\", \"b\", \"c\", \"c\", \"c\", \"d\"]\n</code></pre>\n\n<p>Should return:</p>\n\n<pre><code>[(2,\"a\"), (1,\"b\"), (3,\"c\"), (1,\"d\")]\n</code></pre>\n\n<p>Here is What I'm trying to do:</p>\n\n<pre><code>module Main where\n\ncontaOcs :: [String] -&gt; [(Int, String)]\ncontaOcs [] = [_,_]\ncontaOcs [x] = [1,x]\ncontaOcs (i, x1:x2:xs)\n | x1 == x2 =  (i+1,(x2:xs))\n | otherwise = (0, (x2:xs))\n</code></pre>\n\n<p>But this code have some errors and I'm not so sure how I should do to accomplish this\nI'm new to functional programing and Haskell. Can anyone help me with some information?</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1538258137, "post_id": 52572836, "comment_id": 92082139, "body": "This is a misunderstanding of Haskell type annotation for functions. This is considered basic Haskell. See: <a href=\"https://wiki.haskell.org/Currying\" rel=\"nofollow noreferrer\">currying</a>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1538258301, "post_id": 52572836, "comment_id": 92082177, "body": "In a nutshell, <a href=\"https://stackoverflow.com/a/43256681/2751851\">all Haskell functions take just one argument</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1538261566, "post_id": 52572836, "comment_id": 92082685, "body": "Personally, I also dislike that confusing mismatch between the type signature and the formal arguments. In such cases I prefer the style <code>evalPair sa sb = \\ (a,b) -&gt; ...</code> which is completely equivalent, but matches the signature more faithfully. (Even better, if we later on turn <code>Strategy</code> into a newtype, it&#39;s easier to add the wrappers.)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1538264444, "post_id": 52572836, "comment_id": 92083082, "body": "@chi It&#39;s nice to know I&#39;m not alone in that :)"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1538276133, "post_id": 52572836, "comment_id": 92084524, "body": "@chi: This is a good rule of thumb for clarity. It only makes a difference in a couple of rare cases\u20141. if the monomorphism restriction is enabled, using <code>f x = \u2026</code> is a hint that you want a polymorphic function, while <code>f = \\ x \u2192 \u2026</code> will be a monomorphised value; and 2. GHC internally uncurries functions, and uses the number of parameters in the definition as a heuristic for inlining and when to allocate a closure for a partially applied function, which can affect performance."}], "answers": [{"comments": [{"owner": {"reputation": 1409, "user_id": 7518695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dT38T.jpg?s=128&g=1", "display_name": "GrayCat", "link": "https://stackoverflow.com/users/7518695/graycat"}, "edited": false, "score": 0, "creation_date": 1538259098, "post_id": 52572900, "comment_id": 92082323, "body": "Thank you, I missed the part about type synonym being completely interchangeable. Are we eligible to leave off brackets in Strategy (a,b) (in (a,b) -&gt; Eval (a,b) form) strictly because it is a last argument to the function?"}, {"owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "reply_to_user": {"reputation": 1409, "user_id": 7518695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dT38T.jpg?s=128&g=1", "display_name": "GrayCat", "link": "https://stackoverflow.com/users/7518695/graycat"}, "edited": false, "score": 2, "creation_date": 1538260107, "post_id": 52572900, "comment_id": 92082464, "body": "Haskell Report says: &quot;A function type has the form t1 -&gt; t2, which is equivalent to the type (-&gt;) t1 t2. Function arrows associate to the right. For example, Int -&gt; Int -&gt; Float means Int -&gt; (Int -&gt; Float).&quot; <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-650004.1.2\" rel=\"nofollow noreferrer\">haskell.org/onlinereport/haskell2010/&hellip;</a> So, whenever you see multiple arrows in a type, they &quot;associate to the right&quot;, which means <code>a -&gt; b -&gt; c -&gt; d</code> is equivalent to <code>a -&gt; (b -&gt; (c -&gt; d))</code>. @AJFarmar&#39;s answer explains this in a little more depth."}], "tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": true, "score": 4, "last_activity_date": 1538258545, "creation_date": 1538258545, "answer_id": 52572900, "question_id": 52572836, "link": "https://stackoverflow.com/questions/52572836/type-synonyms-unwrapping-in-functions/52572900#52572900", "title": "Type synonyms unwrapping in functions?", "body": "<p>Given the type synonym</p>\n\n<pre><code>type Strategy a = a -&gt; Eval a\n</code></pre>\n\n<p>And the type</p>\n\n<pre><code>Strategy a -&gt; Strategy b -&gt; Strategy (a,b)\n</code></pre>\n\n<p>We can \"desugar\" the type by replacing each use of the synonym with its definition:</p>\n\n<pre><code>(a -&gt; Eval a) -&gt; (b -&gt; Eval b) -&gt; ((a,b) -&gt; Eval (a,b))\n</code></pre>\n\n<p>Note that the parens are necessary here to clarify what's going on. The function <code>evalPair</code> still takes two arguments. Its two arguments are two <em>functions</em>. This may be clearer if I visually align the types with their corresponding arguments like so:</p>\n\n<pre><code>evalPair :: (a -&gt; Eval a) -&gt; (b -&gt; Eval b) -&gt; (a,b) -&gt; Eval (a,b)\nevalPair    sa               sb               (a,b)  = ...\n</code></pre>\n\n<p>Therefore the type of <code>sa</code> is <code>a -&gt; Eval a</code>, and the type of <code>sb</code> is <code>b -&gt; Eval b</code>.</p>\n\n<p>Note that the Haskell Report states:</p>\n\n<blockquote>\n  <p>Type synonyms are a convenient, but strictly syntactic, mechanism to make type signatures more readable. A synonym and its definition are completely interchangeable</p>\n</blockquote>\n\n<p>Therefore, the compiler may freely \"wrap\" or \"unwrap\" type synonyms, as they are \"completely interchangeable\".</p>\n\n<p>You can read about Type Synonyms in the Haskell Report, section 4.2.2:\n<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-730004.2.2\" rel=\"nofollow noreferrer\">https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-730004.2.2</a></p>\n"}, {"comments": [{"owner": {"reputation": 1409, "user_id": 7518695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dT38T.jpg?s=128&g=1", "display_name": "GrayCat", "link": "https://stackoverflow.com/users/7518695/graycat"}, "edited": false, "score": 0, "creation_date": 1538260541, "post_id": 52572905, "comment_id": 92082536, "body": "Thank you. Along with Dan Burton&#39;s abstract from Haskell Report now I understand what I missed."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 4, "last_activity_date": 1538258570, "creation_date": 1538258570, "answer_id": 52572905, "question_id": 52572836, "link": "https://stackoverflow.com/questions/52572836/type-synonyms-unwrapping-in-functions/52572905#52572905", "title": "Type synonyms unwrapping in functions?", "body": "<p>You are misunderstanding how Haskell functions work.</p>\n\n<p>All Haskell functions have <strong>only one argument</strong>. If a function <code>f</code> takes a value of type <code>A</code>, and returns something of type <code>B</code>, we write <code>f :: A -&gt; B</code>.</p>\n\n<p>However, of course, we can write functions with multiple arguments, but in a clever way, called <a href=\"https://wiki.haskell.org/Currying\" rel=\"nofollow noreferrer\">currying</a>. If we want a function <code>g</code> that takes an <code>A</code> and a <code>B</code>, and produces a <code>C</code>, we actually write a function that takes an <code>A</code>, and then returns a function that takes a <code>B</code> and returns a <code>C</code>. </p>\n\n<p>We write this as <code>g :: A -&gt; (B -&gt; C)</code>. However, since this is what we usually want to do with functions, the Haskell compiler will read the signature <code>g :: A -&gt; B -&gt; C</code> as the same thing. </p>\n\n<p>This means that when we write <code>A -&gt; B -&gt; C -&gt; ... -&gt; Z</code>, we really mean <code>A -&gt; (B -&gt; (C -&gt; (... -&gt; Z...)))</code>.</p>\n\n<p>However, if we write <code>g :: (A -&gt; B) -&gt; C</code>, <strong>this is not the same thing! Brackets matter!</strong> <code>g</code> is now a function that takes a function and produces a <code>C</code>.</p>\n\n<p>Now, let's inspect this specific example:</p>\n\n<pre><code> evalPair :: (a -&gt; Eval a) -&gt; (b -&gt; Eval b) -&gt; (a,b) -&gt; Eval (a,b)\n</code></pre>\n\n<p>I read this as:</p>\n\n<blockquote>\n  <p>The function <code>evalPair</code> takes the following:</p>\n  \n  <ul>\n  <li>Something of type <code>a -&gt; Eval a</code></li>\n  <li>Something of type <code>b -&gt; Eval b</code></li>\n  <li>Something of type <code>(a,b)</code></li>\n  </ul>\n  \n  <p>And produces something of type <code>Eval (a,b)</code>.</p>\n</blockquote>\n\n<p>So the declaration would naturally look something like</p>\n\n<pre><code>evalPair first_arg second_arg third_arg = -- ...\n</code></pre>\n\n<p>Writing <code>evalPair a sa a sb (a,b) = -- ...</code> is nonsensical, since that takes 5 arguments, and thus <code>evalPair</code> would have a type of the form <code>a -&gt; b -&gt; c -&gt; (d, e) -&gt; f</code>, which is completely different to what we expect.</p>\n"}], "owner": {"reputation": 1409, "user_id": 7518695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dT38T.jpg?s=128&g=1", "display_name": "GrayCat", "link": "https://stackoverflow.com/users/7518695/graycat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 52572900, "answer_count": 2, "score": 4, "last_activity_date": 1538258570, "creation_date": 1538257828, "question_id": 52572836, "link": "https://stackoverflow.com/questions/52572836/type-synonyms-unwrapping-in-functions", "title": "Type synonyms unwrapping in functions?", "body": "<p>Reading book by Simon Marlow \"<em><a href=\"https://web.archive.org/web20171204024223/http://chimera.labs.oreilly.com:80/web20171204024223/http://chimera.labs.oreilly.com:80/web20171204024223/http://chimera.labs.oreilly.com:80/web20171204024223/http://chimera.labs.oreilly.com:80/web20171204024223/http://chimera.labs.oreilly.com:80/web20171204024223/http://chimera.labs.oreilly.com:80/web20171204024223/http://chimera.labs.oreilly.com:80/web20171204024223/http://chimera.labs.oreilly.com:80/web20171204024223/http://chimera.labs.oreilly.com:80/web20171204024223/http://chimera.labs.oreilly.com:80/web20171204024223/http://chimera.labs.oreilly.com:80/web20171204024223/http://chimera.labs.oreilly.com:80/web/20180123022957/http://chimera.labs.oreilly.com:80/books/1230000000929/ch03.html\" rel=\"nofollow noreferrer\">Parallel and Concurrent Programming in Haskell</a></em>\" I encountered a thing I am not sure about why it works the way GHC sees it. Namely:</p>\n\n<pre><code>evalPair :: Strategy a -&gt; Strategy b -&gt; Strategy (a,b)\nevalPair sa sb (a,b) = do\n  a' &lt;- sa a\n  b' &lt;- sb b\n  return (a',b')\n</code></pre>\n\n<p>Has two input arguments (the way I see it <code>Strategy a</code> and <code>Strategy b</code>) on type level and one output - <code>Strategy (a,b)</code>.\nBut line under there are three arguments: <code>sa</code>, <code>sb</code> and <code>(a,b)</code>. It is confusing.</p>\n\n<p>But since <code>Strategy</code> is type synonym:</p>\n\n<pre><code>type Strategy a = a -&gt; Eval a\n</code></pre>\n\n<p>I thought that maybe if I unroll Strategies to (a -> Eval a) it will be clearer. So:</p>\n\n<pre><code>evalPair :: (a -&gt; Eval a) -&gt; (b -&gt; Eval b) -&gt; (a,b) -&gt; Eval (a,b)\n</code></pre>\n\n<p>and (brackets added on the end)</p>\n\n<pre><code>evalPair :: (a -&gt; Eval a) -&gt; (b -&gt; Eval b) -&gt; ((a,b) -&gt; Eval (a,b))\n</code></pre>\n\n<p>both compile.</p>\n\n<p>Then I wrote it this way and thanks to Stack tooltips found that what is returned from function evalPair (went back to Strategy on purpose to make it more confusing) is not <strong><code>Strategy (a,b)</code></strong> but <strong><code>Eval (a,b)</code></strong>.</p>\n\n<pre><code>evalPair :: Strategy a -&gt; Strategy b -&gt; Strategy (a,b)\nevalPair sa sb (a,b) = \nlet res = do\n          a' &lt;- sa a\n          b' &lt;- sb b\n          return (a', b')\nin res\n</code></pre>\n\n<p>So clearly compiler unwrapped last argument from its type synonym, but only the last one - since we do not need to provide values for <code>Strategy a</code>\nand <code>Strategy b</code></p>\n\n<p><strong>Here are my questions:</strong></p>\n\n<ol>\n<li><p>Where can I get more information on this behaviour of the compiler? Why the function returns <code>Eval a</code> even though it says that it returns <code>Strategy a</code></p></li>\n<li><p>If unwrapping happens, then why don't I need (and can't in fact) provide values for <code>Strategy a</code> and <code>Strategy b</code> like so:</p>\n\n<pre><code>evalPair :: Strategy a -&gt; Strategy b -&gt; Strategy (a,b)\nevalPair a sa a sb (a,b) = do\n  a' &lt;- sa a\n  b' &lt;- sb b\n  return (a',b')\n</code></pre></li>\n</ol>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1538250809, "post_id": 52571995, "comment_id": 92080505, "body": "Yes, this is <i>eta conversion</i>: <a href=\"https://wiki.haskell.org/Eta_conversion\" rel=\"nofollow noreferrer\">wiki.haskell.org/Eta_conversion</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "is_accepted": false, "score": 3, "last_activity_date": 1538251012, "last_edit_date": 1538251012, "creation_date": 1538250863, "answer_id": 52572024, "question_id": 52571995, "link": "https://stackoverflow.com/questions/52571995/how-function-reduction-in-haskell-works/52572024#52572024", "title": "How function reduction in Haskell works?", "body": "<p>It's called <a href=\"https://wiki.haskell.org/Eta_conversion\" rel=\"nofollow noreferrer\">eta</a> <a href=\"https://en.wikipedia.org/wiki/Lambda_calculus#.CE.B7-conversion\" rel=\"nofollow noreferrer\">reduction</a>.</p>\n\n<p>You might also think about it in terms of partial application.</p>\n\n<pre><code>&gt; calculate :: Integer -&gt; Integer -&gt; Integer\n&gt; f :: Integer -&gt; Integer -&gt; Integer -&gt; Integer\n&gt; (f 1) :: Integer -&gt; Integer -&gt; Integer\n</code></pre>\n\n<p>Similar question - <a href=\"https://stackoverflow.com/questions/5793843/what-does-eta-reduce-mean-in-the-context-of-hlint\">What does eta reduce mean in the context of HLint</a></p>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 5556147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ndlV.jpg?s=128&g=1", "display_name": "Mantas Savaniakas", "link": "https://stackoverflow.com/users/5556147/mantas-savaniakas"}, "edited": false, "score": 1, "creation_date": 1538257048, "post_id": 52572090, "comment_id": 92081933, "body": "Really appreciate for your detailed answer, it couldn&#39;t have been any simpler explained when that :)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1538401300, "post_id": 52572090, "comment_id": 92119585, "body": "It&#39;s probably helpful to note as well that a definition like <code>foo a b = a + b</code> is really just syntactic sugar for <code>foo = \\a -&gt; \\b -&gt; a + b</code>: just a named assigned to an otherwise anonymous function defined by a lambda expression."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538402840, "post_id": 52572090, "comment_id": 92120535, "body": "@chepner: good idea! I&#39;ve added this at the end of the answer."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1538402815, "last_edit_date": 1538402815, "creation_date": 1538251332, "answer_id": 52572090, "question_id": 52571995, "link": "https://stackoverflow.com/questions/52571995/how-function-reduction-in-haskell-works/52572090#52572090", "title": "How function reduction in Haskell works?", "body": "<p>In Haskell there are <em>no</em> functions that take more than one parameter. All functions take <em>exactly</em> one parameter.</p>\n\n<p>So if you have a function like <code>add :: Int -&gt; Int -&gt; Int</code>, then this is actually short for <code>add :: Int -&gt; (Int -&gt; Int)</code>.</p>\n\n<p>Why are the brackets important? Because they show how this concept works. If we have this function <code>add</code>, then we can make a function application with for example <code>14</code>, then we construct a <em>new</em> function, like:</p>\n\n<pre><code>add14 :: Int -&gt; Int\nadd14 = add 14\n</code></pre>\n\n<p>so that means that we now have a function that takes again <em>one</em> parameter (here an <code>Int</code>), and now it will produce another <code>Int</code>, it does that by adding 14 to it, so <code>add14 25</code> will result in <code>39</code>.</p>\n\n<p>If you write <code>add 14 25</code>, this thus is <em>not</em> a function application with two parameters, what you actually wrote is:</p>\n\n<pre><code>-- add 14 25 is equivalent to\n(add 14) 25\n</code></pre>\n\n<p>You thus first make a call with <code>14</code>, and the you make a call with the function that comes out of this, and <code>25</code> as the parameter.</p>\n\n<p>Why is this important? Because it means that if you thus write</p>\n\n<pre><code>calculate = f 1\n</code></pre>\n\n<p>it means that your <code>f 1</code>, constructs a function, a function with signature <code>Int -&gt; (Int -&gt; Int)</code>. Creating parameters in the head of <code>calculate</code>, and adding these to the end of <code>f 1</code>, thus makes no sense: you already constructed a function that takes such parameters anyway. So it only introduces noise.</p>\n\n<p>In <em>lambda calculus</em>, the rewrite rule where one rewrites <em>&lambda; x . f x</em> to just <em>f</em> is (and vice versa) is called <a href=\"https://en.wikipedia.org/wiki/Lambda_calculus#%CE%B7-conversion\" rel=\"nofollow noreferrer\"><em>&eta;-conversion</em> [wiki]</a>. In Haskell it comes down to rewriting:</p>\n\n<pre><code>f x = g x\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>f = g\n</code></pre>\n\n<p>Operators are no different. In fact if you write <code>a + b</code> in Haskell, you wrote <code>(+) a b</code>, with <code>(+)</code> a function, or more verbose <code>((+) a) b</code>.</p>\n\n<p>The <code>f</code> in the where clause:</p>\n\n<pre><code>f a b c = a + b\n</code></pre>\n\n<p>can for example get converted to:</p>\n\n<pre><code>f = (.) ((.) const) (+)\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 5556147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ndlV.jpg?s=128&g=1", "display_name": "Mantas Savaniakas", "link": "https://stackoverflow.com/users/5556147/mantas-savaniakas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 1, "accepted_answer_id": 52572090, "answer_count": 2, "score": 6, "last_activity_date": 1538402815, "creation_date": 1538250657, "last_edit_date": 1538250768, "question_id": 52571995, "link": "https://stackoverflow.com/questions/52571995/how-function-reduction-in-haskell-works", "title": "How function reduction in Haskell works?", "body": "<p>Why it's possible to reduce function in Haskell:</p>\n\n<pre><code>calculate :: Integer -&gt; Integer -&gt; Integer\ncalculate a b = f 1 a b\n  where\n     f :: Integer -&gt; Integer -&gt; Integer -&gt; Integer\n     f a b c = a + b\n</code></pre>\n\n<p>into something:</p>\n\n<pre><code>calculate :: Integer -&gt; Integer -&gt; Integer\ncalculate = f 1\n  where\n     f :: Integer -&gt; Integer -&gt; Integer -&gt; Integer\n     f a b c = a + b\n</code></pre>\n\n<p>I just need some guidance, any resources where I can find the answer and read more about it would be really helpful.</p>\n"}, {"tags": ["haskell", "xmonad"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1538248496, "post_id": 52571664, "comment_id": 92079924, "body": "Is it strictly necessary? What happens if you remove the <code>deriving</code> clause and <i>recompile</i>? Some programmers just add some <code>deriving</code> statements such that later, it is easy to use these."}], "answers": [{"comments": [{"owner": {"reputation": 410, "user_id": 2805751, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/22fc46808863bebbaf410616ea630332?s=128&d=identicon&r=PG&f=1", "display_name": "user2805751", "link": "https://stackoverflow.com/users/2805751/user2805751"}, "edited": false, "score": 1, "creation_date": 1555008629, "post_id": 52573010, "comment_id": 97969488, "body": "As of ghc 7.8, you can&#39;t define such instances by hand."}], "tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": false, "score": 1, "last_activity_date": 1538259568, "creation_date": 1538259568, "answer_id": 52573010, "question_id": 52571664, "link": "https://stackoverflow.com/questions/52571664/why-derive-typeable-for-this-type/52573010#52573010", "title": "Why derive Typeable for this type", "body": "<p>Typeable can always be derived for all types, so... why not? The xmonad code may not make use of the <code>Typeable</code> instance, but users might want to.</p>\n\n<p>Note that <code>Typeable</code> is a class whose instances should generally <em>not</em> be defined by hand.</p>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 1, "last_activity_date": 1538260948, "creation_date": 1538260948, "answer_id": 52573139, "question_id": 52571664, "link": "https://stackoverflow.com/questions/52571664/why-derive-typeable-for-this-type/52573139#52573139", "title": "Why derive Typeable for this type", "body": "<p>It's a remnant of older versions of GHC. Nowadays <code>Typeable</code> is derived for all types automatically and <code>deriving Typeable</code> does nothing but is allowed for backwards compatibility.</p>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 52573139, "answer_count": 2, "score": 1, "last_activity_date": 1538260948, "creation_date": 1538248419, "question_id": 52571664, "link": "https://stackoverflow.com/questions/52571664/why-derive-typeable-for-this-type", "title": "Why derive Typeable for this type", "body": "<p>In <code>xmonad</code> source code, I find:</p>\n\n<pre><code>data Resize     = Shrink | Expand   deriving Typeable\n</code></pre>\n\n<p>I can't figure out why this needs to derive from <code>Typeable</code></p>\n\n<p>I saw a famous <a href=\"https://chrisdone.com/posts/data-typeable\" rel=\"nofollow noreferrer\">blog post</a> by Chrisdone which explains the various usages of Typeable. But I can't find any of the scenarios in <code>xmonad</code> source code.</p>\n\n<p>Any hint?</p>\n"}, {"tags": ["function", "haskell", "tic-tac-toe"], "comments": [{"owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "edited": false, "score": 1, "creation_date": 1538288018, "post_id": 52570686, "comment_id": 92085923, "body": "There are three types of combinations that make a player win - row, column and diagonal. Maybe start with generalizing each and combining them together?"}], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 0, "last_activity_date": 1538399731, "creation_date": 1538399731, "answer_id": 52592018, "question_id": 52570686, "link": "https://stackoverflow.com/questions/52570686/haskell-tictactoe-game/52592018#52592018", "title": "haskell TicTacToe game", "body": "<blockquote>\n  <p>Here is the code:</p>\n</blockquote>\n\n<p>Here's my take at it:</p>\n\n<p>Let's define <em>proper</em> data types first:</p>\n\n<pre><code>data Player = Black | White deriving (Eq, Show)\ndata Position = Position Int Int deriving (Eq, Show)\ndata Move = Move { position :: Position, player :: Player } deriving (Eq, Show)\n</code></pre>\n\n<p>Now the actual function just counts the lines that qualify for winning</p>\n\n<pre><code>hasWon :: Player -&gt; [Move] -&gt; Bool\nhasWon p ms = (length $ winningLines p ms) &gt; 0\n</code></pre>\n\n<p>The winning lines generation is one big comprehension:</p>\n\n<pre><code>winningLines p ms = [(x,y,z) | x &lt;- ms,\n                               y &lt;- ms,\n                               z &lt;- ms,\n                               oneLine (position x) (position y) (position z),\n                               samePlayer (player x) (player y) (player z),\n                               x /= y,\n                               y /= z,\n                               x /= z\n                     ]\n\nsamePlayer px py pz = px == py &amp;&amp; py == pz\n\noneLine (Position x1 y1) (Position x2 y2) (Position x3 y3) = sameRow || sameCol\n    where\n        sameRow = (y1 == y2 &amp;&amp; y2 == y3)\n        sameCol = (x1 == x2 &amp;&amp; x2 == x3)\n</code></pre>\n\n<p>And finally some testing:</p>\n\n<pre><code>moves = [\n    Move (Position 1 1) White,\n    Move (Position 2 1) White,\n    Move (Position 3 1) White\n    ]\n\nmain :: IO ()\nmain = do\n    print $ hasWon White moves\n    print $ winningLines White moves\n</code></pre>\n\n<p>The solution is only using the basics, so you should be able to understand it quite easily and add your own fixes; it's still missing diagonals (easy to add), and it's counting all the lines 6 times (because it's taking all permutations into account; easy to fix with <code>Ord</code> instance for position and only taking a \"sorted triple\" into account).</p>\n\n<p>Of course this is not the only way to do it; one notable alternative would be to put it into an array in-place, and then find the solution iteratively. I think the Prolog-esque declarative style just fits Haskell better, though.</p>\n"}], "owner": {"reputation": 57, "user_id": 10408948, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102103916621870/picture?type=large", "display_name": "Andrei Bercea", "link": "https://stackoverflow.com/users/10408948/andrei-bercea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 600, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1538399731, "creation_date": 1538241085, "last_edit_date": 1538249652, "question_id": 52570686, "link": "https://stackoverflow.com/questions/52570686/haskell-tictactoe-game", "title": "haskell TicTacToe game", "body": "<p>I am trying to build a tic tac toe game in haskell and I am having trouble with a function <code>haswon</code>. The function should return <code>True</code> if for a given player <code>p</code> and the game board <code>bs</code>, he has already won the game, and <code>False</code> otherwise.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Int -&gt; [((Int,Int),Int)] -&gt; Bool\nhaswon p [((a,d), x), ((b,e), y), ((c,f), z)] = (x == y &amp;&amp; y == z &amp;&amp; x == p) &amp;&amp; ( ((a == b) &amp;&amp; (b == c)) || ((d == e) &amp;&amp; (e == f)) || ( (a == d) &amp;&amp; (b == e) &amp;&amp; (c == f) &amp;&amp; (a /= b) &amp;&amp; (b /= c)) || ( (a == f) &amp;&amp; (c == d) &amp;&amp; (b==e)&amp;&amp;(a/=b)&amp;&amp;(b/=c)) )\n</code></pre>\n\n<p>Could you please tell me how can I generalize this for an input list that is bigger than 3 elements?\nFor instance, the input could be : <code>[((1,1),1), ((1,2),1), ((2,1),2), ((2,2),2), ((3,1),1), ((3,2),1), ((3,3),2)]</code>.\nThank you.</p>\n"}, {"tags": ["haskell", "fibonacci"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1538235380, "post_id": 52569863, "comment_id": 92076582, "body": "Please don&#39;t post &quot;there&#39;s an error&quot; questions without posting the full error. Your code above looks fine to me, even if the implementation of <code>fib</code> is extremely inefficient (requiring exponential time), so in practice it will hardly produce more than a few elements."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1538238018, "post_id": 52569863, "comment_id": 92077220, "body": "I&#39;ve run this code and there is no error. Please tell us exactly what&#39;s going wrong."}, {"owner": {"reputation": 814, "user_id": 2352665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b7eaa37741dcbba9e1e8afcec8ef49b2?s=128&d=identicon&r=PG", "display_name": "Alejandro Caro", "link": "https://stackoverflow.com/users/2352665/alejandro-caro"}, "edited": false, "score": 1, "creation_date": 1538238559, "post_id": 52569863, "comment_id": 92077377, "body": "The error appears when I execute it, not when I drop the program. For example I put fibonacci 8 and there the error occurs"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1538239293, "post_id": 52569863, "comment_id": 92077545, "body": "<code>fibonacci 8</code> doesn&#39;t work because <code>fibonacci</code> is a list, not a function."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1538240480, "post_id": 52569863, "comment_id": 92077834, "body": "@AlejandroCaro Please edit your question to reflect this addition - don&#39;t just write important information in the comments."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 5, "last_activity_date": 1538239964, "creation_date": 1538239964, "answer_id": 52570527, "question_id": 52569863, "link": "https://stackoverflow.com/questions/52569863/fibonacci-secuence-couldnt-match-expected-type-a0-t-with-actual-type-int/52570527#52570527", "title": "Fibonacci secuence Couldn&#39;t match expected type \u2018a0 -&gt; t\u2019 with actual type \u2018[Integer]\u2019", "body": "<p>When you use <code>fibonacci</code>, you're writing:</p>\n\n<pre><code>&gt; fibonacci 8\n(error)\n</code></pre>\n\n<p>But, <code>fibonacci :: [Integer]</code> - <strong><code>fibonacci</code> isn't a function</strong> and you can't call it! <strong><code>fibonacci</code> is an infinite list,</strong> so you must use list-based operations to get specific numbers.</p>\n\n<p>The list indexing operator is <code>(!!) :: [a] -&gt; Integer -&gt; a</code>, so use that:</p>\n\n<pre><code>&gt; fibonacci !! 8\n21\n</code></pre>\n\n<p>You could also use <code>take :: Integer -&gt; [a] -&gt; [a]</code> to get the first <em>n</em> numbers:</p>\n\n<pre><code>&gt; take 8 fibonacci\n[0,1,1,2,3,5,8,13]\n</code></pre>\n\n<p>You can, however do this:</p>\n\n<pre><code>&gt; fib 8\n21\n</code></pre>\n\n<p>Because <code>fib :: Integer -&gt; Integer</code> <em>is</em> a function.</p>\n"}], "owner": {"reputation": 814, "user_id": 2352665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b7eaa37741dcbba9e1e8afcec8ef49b2?s=128&d=identicon&r=PG", "display_name": "Alejandro Caro", "link": "https://stackoverflow.com/users/2352665/alejandro-caro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1538256784, "creation_date": 1538235081, "last_edit_date": 1538256784, "question_id": 52569863, "link": "https://stackoverflow.com/questions/52569863/fibonacci-secuence-couldnt-match-expected-type-a0-t-with-actual-type-int", "title": "Fibonacci secuence Couldn&#39;t match expected type \u2018a0 -&gt; t\u2019 with actual type \u2018[Integer]\u2019", "body": "<p>Down two functions. One that calculates fibonacci of a certain number and the other that tries to show the fibonacci sequence up to a certain number using map.\nThe error occurs when I type fibonacci and a number, for example fibonacci 8\nand throws error. What am I doing wrong?</p>\n\n<pre><code>fib :: Integer -&gt; Integer\nfib 0 = 0\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n\nfibonacci :: [Integer]\nfibonacci = map fib [0..]\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 0, "creation_date": 1538233225, "post_id": 52568944, "comment_id": 92076024, "body": "What does your .cabal file look like?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1538238230, "post_id": 52568944, "comment_id": 92077266, "body": "If you have any cabal file, try removing it and running the build again."}], "answers": [{"tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": false, "score": 1, "last_activity_date": 1538257086, "creation_date": 1538257086, "answer_id": 52572767, "question_id": 52568944, "link": "https://stackoverflow.com/questions/52568944/stack-downloading-package-but-sill-can-not-use-it/52572767#52572767", "title": "Stack downloading package but sill can not use it", "body": "<p>First, ensure the package.yaml buffer is saved to disk.</p>\n\n<p>Second, assuming you are using <code>stack</code>, ensure that you are not seeing the following warning:</p>\n\n<pre><code>Warning: /Users/dan/scratch/foo/foo.cabal was modified manually. Ignoring\n         /Users/dan/scratch/foo/package.yaml in favor of the cabal file. If you\n         want to use the package.yaml file instead of the cabal file, then\n         please delete the cabal file.\n```\n</code></pre>\n\n<p>If you <em>are</em> seeing this warning, check your <code>foo.cabal</code> file for anything you may want to keep, and port it over to your <code>package.yaml</code> file, and then delete the <code>foo.cabal</code> file so that hpack can generate a fresh one.</p>\n\n<p>Third, ensure that this <code>dependencies</code> section pertains to the particular target you are currently trying to build. For example, if these are listed in the library dependencies, but not for the test suite dependencies, then the corresponding modules will <em>not</em> be available to the test suite. If the dependencies are specified at the top level, then they should in fact be available for all build targets.</p>\n"}], "owner": {"reputation": 9, "user_id": 7307451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13bc51fd2cec089fddd4065f0caf7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Hampus Weslien", "link": "https://stackoverflow.com/users/7307451/hampus-weslien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538257086, "creation_date": 1538228689, "question_id": 52568944, "link": "https://stackoverflow.com/questions/52568944/stack-downloading-package-but-sill-can-not-use-it", "title": "Stack downloading package but sill can not use it", "body": "<p>These are my dependencies in package.yaml:</p>\n\n<pre><code>dependencies:\n- weasel\n- network\n- HTTP\n- bytestring\n</code></pre>\n\n<p>but I still get the error</p>\n\n<pre><code>   Could not find module \u2018Network.HTTP.Base\u2019\n   Use -v to see a list of the files searched for.\n\n   import Network.HTTP.Base\n</code></pre>\n\n<p>when importing</p>\n"}, {"tags": ["haskell", "io", "monads"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 4, "creation_date": 1538227135, "post_id": 52568702, "comment_id": 92074499, "body": "But that&#39;s what we do...? <a href=\"https://www.haskell.org/hoogle/?hoogle=MonadIO\" rel=\"nofollow noreferrer\"><code>MonadIO</code> is just a typeclass</a> which groups all such &#39;custom monads&#39; together. It just so happens that a lot of useful monads can be expressed as monad transformer stacks. Are you sure you&#39;re clear about what you&#39;re asking here?"}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1538227485, "post_id": 52568702, "comment_id": 92074593, "body": "Suppose I give you my library that does some useful things but all are in <code>MonadIO</code>. Would you use it without worrying about library writing files, using network or forking threads? Would you use a newer version of it without inspecting source code what those <code>IO</code> actions actually do?"}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1538227659, "post_id": 52568702, "comment_id": 92074626, "body": "I honestly don&#39;t understand why it&#39;s being marked as a bad question."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1538229115, "post_id": 52568702, "comment_id": 92075017, "body": "What do you mean by &quot;<i>but</i> are all in <code>MonadIO</code>&quot;? Are you saying that we can&#39;t know what goes on in an <code>IO</code> action? Having monad transformers <i>helps</i> us understand that, not hinders. I&#39;m still not clear on what your question is. I&#39;d recommend making a concrete example."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1538229762, "post_id": 52568702, "comment_id": 92075163, "body": "@AJFarmar sevo seems to be asking why don&#39;t we use a fine-grained effect system of some sort everywhere. Cf. suggestions like <a href=\"https://stackoverflow.com/q/20318936/2751851\"><i>Delimiting the IO monad</i></a> and <a href=\"https://chrispenner.ca/posts/monadio-considered-harmful\" rel=\"nofollow noreferrer\">chrispenner.ca/posts/monadio-considered-harmful</a>"}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1538232019, "post_id": 52568702, "comment_id": 92075709, "body": "@duplode thank you - these confirm my concerns about MonadIO even I don&#39;t have experience to state exactly how I see this as a problem. I think it boils down to consumer/producer of the API where consumer should not be forced to use MonadIO but provide an instance of some MonadEffect instead."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 1, "creation_date": 1538232067, "post_id": 52568702, "comment_id": 92075716, "body": "Related: <a href=\"https://github.com/fpco/unliftio/tree/master/unliftio#readme\" rel=\"nofollow noreferrer\">github.com/fpco/unliftio/tree/master/unliftio#readme</a>"}], "answers": [{"tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": false, "score": 2, "last_activity_date": 1538257750, "creation_date": 1538257750, "answer_id": 52572827, "question_id": 52568702, "link": "https://stackoverflow.com/questions/52568702/are-there-valid-reasons-to-build-monad-transformer-stacks-on-top-of-io/52572827#52572827", "title": "Are there valid reasons to build monad transformer stacks on top of IO?", "body": "<p>It's a common approach these days to use <a href=\"https://www.fpcomplete.com/blog/2017/06/readert-design-pattern\" rel=\"nofollow noreferrer\">the ReaderT design pattern</a>.</p>\n\n<p>You are correct to be wary of putting other transformers on top of IO, and the above linked blog post explains some of those reasons.</p>\n\n<p>However, ReaderT provides a nice little convenience when it comes to passing \"common app config\" around to all of your functions.</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1538296205, "last_edit_date": 1538296205, "creation_date": 1538295880, "answer_id": 52576096, "question_id": 52568702, "link": "https://stackoverflow.com/questions/52568702/are-there-valid-reasons-to-build-monad-transformer-stacks-on-top-of-io/52576096#52576096", "title": "Are there valid reasons to build monad transformer stacks on top of IO?", "body": "<blockquote>\n  <p>what is the value of building monadic stacks on top of such shaky\n  foundations?</p>\n</blockquote>\n\n<p>Transformers on top of <code>IO</code> might let you talk more conveniently about sequences of repeated actions (hence the <a href=\"http://hackage.haskell.org/package/conduit\" rel=\"nofollow noreferrer\">various</a> <a href=\"http://hackage.haskell.org/package/streaming\" rel=\"nofollow noreferrer\">streaming</a> <a href=\"http://hackage.haskell.org/package/pipes\" rel=\"nofollow noreferrer\">libraries</a>).</p>\n\n<p>They might also help with the required bookkeeping of <a href=\"http://hackage.haskell.org/package/resourcet\" rel=\"nofollow noreferrer\">externally allocated resources</a>.</p>\n\n<p>The \"wildness\" of <code>IO</code> is not a general objection to stacking transformers on top of it, since they can help you to avoid repetitive code and make the essential logic clearer.</p>\n\n<p>Rather, the <a href=\"https://www.youtube.com/watch?v=KZIN9f9rI34\" rel=\"nofollow noreferrer\">argument</a> is that <code>IO</code> already provides some built-in functionality for handling errors (<a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html\" rel=\"nofollow noreferrer\">exceptions</a>) and mutable references (<a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-IORef.html\" rel=\"nofollow noreferrer\"><code>IORef</code></a>s, <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Concurrent-MVar.html\" rel=\"nofollow noreferrer\"><code>MVars</code></a>...) so adding transformers for that already existing functionality might be overkill.</p>\n\n<p>One argument for mutable references in particular is that state maintained by \"pure\" means vanishes when an exception pops up, and that might not be what you want. You can also access mutable references from multiple threads.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1538336615, "creation_date": 1538336615, "answer_id": 52581517, "question_id": 52568702, "link": "https://stackoverflow.com/questions/52568702/are-there-valid-reasons-to-build-monad-transformer-stacks-on-top-of-io/52581517#52581517", "title": "Are there valid reasons to build monad transformer stacks on top of IO?", "body": "<p><code>MonadIO</code> can be useful when implementing functions for a type that is <em>not</em> an instance of <code>MonadIO</code>.</p>\n\n<pre><code>newtype FooMonad a\n  = FooMonad (StateT Int IO a)\n  deriving (Functor, Applicative, Monad)\n\ndoFoo :: FooMonad String\ndoFoo = FooMonad $ liftIO getLine\n</code></pre>\n\n<p>You can use the <code>MonadIO</code> instances of <code>StateT Int</code> and <code>IO</code> to define \"primitive\" <code>FooMonad</code> actions conveniently. Others using your module are limited to just the primitives you choose to export.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1538336615, "creation_date": 1538226817, "question_id": 52568702, "link": "https://stackoverflow.com/questions/52568702/are-there-valid-reasons-to-build-monad-transformer-stacks-on-top-of-io", "title": "Are there valid reasons to build monad transformer stacks on top of IO?", "body": "<p><code>IO</code> is tricky in Haskell. Threads, FFI, async exceptions, laziness, you name it.</p>\n\n<p>And then we have <code>MonadIO</code> which allows layering monadic stacks with <code>IO</code> at the bottom. Since <code>IO</code> actions can do arbitrary things, what is the value of building monadic stacks on top of such shaky foundations?</p>\n\n<p>Why does it exist? Why not build a custom monad <code>IO</code> if you really need to perform arbitrary side effects?</p>\n"}, {"tags": ["json", "haskell"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 1, "creation_date": 1538219875, "post_id": 52567362, "comment_id": 92072642, "body": "It&#39;s frowned upon to edit your question and completely change the error that you&#39;re asking about - people can end up writing answers that become outdated, as here (@Krom). Instead, delete your question or post a quick answer to your own question detailing how you fixed it, and then post a <b>new question</b> with the new error. Remember this is a Q/A site, not a forum."}], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": false, "score": 1, "last_activity_date": 1538219589, "creation_date": 1538219589, "answer_id": 52567803, "question_id": 52567362, "link": "https://stackoverflow.com/questions/52567362/parsing-a-json-config-file-with-aeson-in-haskell/52567803#52567803", "title": "Parsing a JSON config file with Aeson in Haskell", "body": "<p>Looks like an error in your input, rather than in the code. The <code>\\\"</code> at the end of your string looks suspicious, the contents of that string would look like:</p>\n\n<pre><code>{ \"database\": { \"host\": \"db\", ... } }\"\n</code></pre>\n\n<p>Where the trailing <code>\"</code> is causing a parse error.</p>\n"}, {"tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 2, "last_activity_date": 1538219808, "creation_date": 1538219808, "answer_id": 52567832, "question_id": 52567362, "link": "https://stackoverflow.com/questions/52567362/parsing-a-json-config-file-with-aeson-in-haskell/52567832#52567832", "title": "Parsing a JSON config file with Aeson in Haskell", "body": "<p>If you look at the type signature of <code>pack</code> from <code>Data.ByteString</code></p>\n\n<pre><code>pack :: [Word8] -&gt; ByteString\n</code></pre>\n\n<p>you see, that it doesn't take a <code>String</code> or some type implementing <code>IsString</code> typeclass, but a list of bytes. Let's fix that by using <code>Data.ByteString.Char8</code> instead of <code>Data.ByteString</code>.</p>\n\n<p>Now, the following error ensues:</p>\n\n<pre><code>test.hs:36:12: error:\n    \u2022 Couldn't match type \u2018Either String\u2019 with \u2018IO\u2019\n      Expected type: IO (Either [Char] String)\n        Actual type: Either String (Either [Char] String)\n    \u2022 In a stmt of a 'do' block: cfg &lt;- (eitherDecode config)\n      In the expression:\n        do cfg &lt;- (eitherDecode config)\n           case cfg of\n             Left err -&gt; fail $ \"error: \" ++ err\n             Right ps -&gt; putStrLn $ ps\n      In an equation for \u2018main\u2019:\n          main\n            = do cfg &lt;- (eitherDecode config)\n                 case cfg of\n                   Left err -&gt; fail $ \"error: \" ++ err\n                   Right ps -&gt; putStrLn $ ps\n   |\n36 |   cfg &lt;-  (eitherDecode config)\n   |            ^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>That's because <code>eitherDecode config</code> doesn't result in a value of type <code>IO a</code> for some type <code>a</code>, but in a value of type <code>Either String a</code>. So let's fix that.</p>\n\n<p>Now the following error ensues:</p>\n\n<pre><code> test.hs:36:27: error:\n    \u2022 Couldn't match expected type \u2018Data.ByteString.Lazy.Internal.ByteString\u2019\n                  with actual type \u2018ByteString\u2019\n      NB: \u2018ByteString\u2019 is defined in \u2018Data.ByteString.Internal\u2019\n          \u2018Data.ByteString.Lazy.Internal.ByteString\u2019\n            is defined in \u2018Data.ByteString.Lazy.Internal\u2019\n    \u2022 In the first argument of \u2018eitherDecode\u2019, namely \u2018config\u2019\n      In the expression: (eitherDecode config)\n      In an equation for \u2018cfg\u2019: cfg = (eitherDecode config)\n   |\n36 |   let cfg = (eitherDecode config)\n   |                           ^^^^^^\n</code></pre>\n\n<p>Obviously we picked the wrong <code>ByteString</code> type. <code>ByteString</code> from <code>Data.ByteString.Char8</code> is strict, but aeson expects lazy bytestrings. So let's fix that by using <code>Data.ByteString.Lazy.Char8</code>.</p>\n\n<p>Now it compiles and running the program gives the following error:</p>\n\n<pre><code>[nix-shell:~/tmp]$ ./test\ntest: user error (error: Error in $: endOfInput)\n</code></pre>\n\n<p>That's because your JSON in your string literal is wrong. It reads</p>\n\n<pre><code>\"{ \\\"database\\\": { \\\"host\\\": \\\"db\\\", \\\"port\\\": 1234, \\\"username\\\": \\\"ledger\\\",  \\\"password\\\": \\\"ledger\\\", \\\"database_name\\\": \\\"ledger\\\" } }\\\"\"\n</code></pre>\n\n<p>It should read:</p>\n\n<pre><code>\"{ \\\"database\\\": { \\\"host\\\": \\\"db\\\", \\\"port\\\": 1234, \\\"username\\\": \\\"ledger\\\",  \\\"password\\\": \\\"ledger\\\", \\\"database_name\\\": \\\"ledger\\\" } }\"\n</code></pre>\n\n<p>recompiling and running test now results in the following error:</p>\n\n<pre><code>[nix-shell:~/tmp]$ ./test\ntest: user error (error: Error in $: expected String, encountered Object)\n</code></pre>\n\n<p>So obviously aeson thought it should decode a json string value, but encountered an object. If you look at the following lines</p>\n\n<pre><code>let cfg = (eitherDecode config)\ncase cfg of\n   Left err -&gt; fail $ \"error: \" ++ err\n   Right ps -&gt; putStrLn $ ps\n</code></pre>\n\n<p>you see, that <code>ps</code> gets typed as <code>String</code> because it is used as an argument to <code>putStrLn</code>, what explains the observed behaviour. If we just changed <code>putStrLn $ ps</code> to <code>putStrLn $ show ps</code> the compiler doesn't know at all, what type <code>ps</code> could be, so let's help him with a type annotation.</p>\n\n<p>recompiling and running test now results in the following error:</p>\n\n<pre><code>[nix-shell:~/tmp]$ ./test\ntest: user error (error: Error in $.database: key \"databaseName\" not present)\n</code></pre>\n\n<p>So your program expects <code>databaseName</code> as key in the json object, not <code>database_name</code>. Fix the <code>FromJSON</code> instance to fix that.</p>\n\n<p>Now it outputs:</p>\n\n<pre><code>[nix-shell:~/tmp]$ ./test\nAppConfig {database = DatabaseConfig {host = \"db\", port = 1234, username = \"ledger\", password = \"ledger\", databaseName = \"ledger\"}}\n</code></pre>\n\n<p>The final program reads now:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.Aeson\nimport Data.Word (Word16)\nimport Data.ByteString.Lazy.Char8 (pack,ByteString)\n\ndata AppConfig = AppConfig {\n    database :: DatabaseConfig\n} deriving (Show)\n\ndata DatabaseConfig = DatabaseConfig {\n    host :: String,\n    port :: Word,\n    username :: String,\n    password :: String,\n    databaseName :: String\n} deriving (Show)\n\ninstance FromJSON DatabaseConfig where\n    parseJSON (Object obj) = DatabaseConfig\n                &lt;$&gt; obj .: \"host\"\n                &lt;*&gt; obj .: \"port\"\n                &lt;*&gt; obj .: \"username\"\n                &lt;*&gt; obj .: \"password\"\n                &lt;*&gt; obj .: \"database_name\"\n    parseJSON obj = fail $ show obj\n\ninstance FromJSON AppConfig where\n    parseJSON (Object obj) = AppConfig &lt;$&gt; obj .: \"database\"\n    parseJSON obj = fail $ show obj\n\nconfig = pack \"{ \\\"database\\\": { \\\"host\\\": \\\"db\\\", \\\"port\\\": 1234, \\\"username\\\": \\\"ledger\\\",  \\\"password\\\": \\\"ledger\\\", \\\"database_name\\\": \\\"ledger\\\" } }\"\n\nmain :: IO ()\nmain = do\n  let cfg = (eitherDecode config) :: Either String AppConfig\n  case cfg of\n    Left err -&gt; fail $ \"error: \" ++ err\n    Right ps -&gt; putStrLn $ show ps\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1538220900, "post_id": 52567925, "comment_id": 92072892, "body": "You probably should provide a way to read the json key <code>database_name</code>. You can either change <code>DatabaseConfig</code> or use <code>genericParseJSON</code> and change the <code>fieldLabelModifier</code>. Maybe the op can&#39;t control the json he needs to read?"}, {"owner": {"reputation": 1, "user_id": 13099126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d0a67a14480f5f1a37ea50421eca0d?s=128&d=identicon&r=PG&f=1", "display_name": "zeme", "link": "https://stackoverflow.com/users/13099126/zeme"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1538221241, "post_id": 52567925, "comment_id": 92072992, "body": "Indeed if the config file is outside of OP jurisdiction then this code would not work. It works only for the best-case scenario where OP provides the config file and is happy to rename database_name into databaseName."}], "tags": [], "owner": {"reputation": 1, "user_id": 13099126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d0a67a14480f5f1a37ea50421eca0d?s=128&d=identicon&r=PG&f=1", "display_name": "zeme", "link": "https://stackoverflow.com/users/13099126/zeme"}, "is_accepted": false, "score": 0, "last_activity_date": 1538220631, "creation_date": 1538220631, "answer_id": 52567925, "question_id": 52567362, "link": "https://stackoverflow.com/questions/52567362/parsing-a-json-config-file-with-aeson-in-haskell/52567925#52567925", "title": "Parsing a JSON config file with Aeson in Haskell", "body": "<p>hnefati and Krom have provided an answer already (You had an extra \\\" character, you needed to add a type annotation in your decode function, and needed to match database_name with databaseName). For this particular example, if you are happy using a couple of language extensions, your code could be simplified as such:</p>\n\n<pre><code>{-# LANGUAGE DeriveAnyClass    #-}\n{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nmodule SO where\n\nimport Data.Aeson\nimport Data.ByteString.Char8 ()\nimport GHC.Generics          (Generic)\n\ndata AppConfig = AppConfig {\n    database :: DatabaseConfig\n} deriving (Show, Generic, FromJSON)\n\ndata DatabaseConfig = DatabaseConfig {\n    host         :: String,\n    port         :: Word,\n    username     :: String,\n    password     :: String,\n    databaseName :: String\n} deriving (Show, Generic, FromJSON)\n\nconfig = \"{ \\\"database\\\": { \\\"host\\\": \\\"db\\\", \\\"port\\\": 1234, \\\"username\\\": \\\"ledger\\\",  \\\"password\\\": \\\"ledger\\\", \\\"databaseName\\\": \\\"ledger\\\" } }\"\n\nmain :: IO ()\nmain = do\n  let cfg = eitherDecode config\n  case cfg of\n    Left err -&gt; fail $ \"error: \" ++ err\n    Right ps -&gt; putStrLn $ show $ (ps :: AppConfig)\n</code></pre>\n"}], "owner": {"reputation": 1748, "user_id": 936652, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Uwfmf.jpg?s=128&g=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/936652/christophe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 52567832, "answer_count": 3, "score": -1, "last_activity_date": 1538220631, "creation_date": 1538216182, "last_edit_date": 1538219085, "question_id": 52567362, "link": "https://stackoverflow.com/questions/52567362/parsing-a-json-config-file-with-aeson-in-haskell", "title": "Parsing a JSON config file with Aeson in Haskell", "body": "<p>I am trying to parse JSON in Haskell, but I cannot find any useful documentation about this task. I was not able to make the following little program work:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.Aeson\nimport Data.Word (Word16)\nimport Data.ByteString.Lazy (pack, ByteString)\nimport Data.ByteString.Char8 ()\n\ndata AppConfig = AppConfig {\n    database :: DatabaseConfig\n} deriving (Show)\n\ndata DatabaseConfig = DatabaseConfig {\n    host :: String,\n    port :: Word,\n    username :: String,\n    password :: String,\n    databaseName :: String\n} deriving (Show)\n\ninstance FromJSON DatabaseConfig where\n    parseJSON (Object obj) = DatabaseConfig\n                &lt;$&gt; obj .: \"host\"\n                &lt;*&gt; obj .: \"port\"\n                &lt;*&gt; obj .: \"username\"\n                &lt;*&gt; obj .: \"password\"\n                &lt;*&gt; obj .: \"databaseName\"\n    parseJSON obj = fail $ show obj\n\ninstance FromJSON AppConfig where\n    parseJSON (Object obj) = AppConfig &lt;$&gt; obj .: \"database\"\n    parseJSON obj = fail $ show obj\n\nconfig = \"{ \\\"database\\\": { \\\"host\\\": \\\"db\\\", \\\"port\\\": 1234, \\\"username\\\": \\\"ledger\\\",  \\\"password\\\": \\\"ledger\\\", \\\"database_name\\\": \\\"ledger\\\" } }\\\"\"\n\nmain :: IO ()\nmain = do\n  let cfg = eitherDecode config\n  case cfg of\n    Left err -&gt; fail $ \"error: \" ++ err\n    Right ps -&gt; putStrLn $ ps\n</code></pre>\n\n<p>The error message makes absolutely no sense at all:</p>\n\n<blockquote>\n  <p>user error (error: Error in $: endOfInput)</p>\n</blockquote>\n\n<p>So what is wrong with the code?</p>\n"}, {"tags": ["list", "haskell", "syntax-error"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538215013, "post_id": 52567206, "comment_id": 92071577, "body": "So the list will always contain <i>three</i> elements? Wouldn&#39;t in that case a <i>tuple</i> make more sense, since then, the typesystem will <i>guarantee</i> that you nver enter something with less or more elements."}, {"owner": {"reputation": 57, "user_id": 10408948, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102103916621870/picture?type=large", "display_name": "Andrei Bercea", "link": "https://stackoverflow.com/users/10408948/andrei-bercea"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538215186, "post_id": 52567206, "comment_id": 92071621, "body": "the type is already given to me and i have to build the function on it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1538215205, "post_id": 52567206, "comment_id": 92071625, "body": "<code>wcheck :: Int -&gt; [((Int,Int),Int)] -&gt; Bool</code> is a function with two arguments, an int and a list. Where&#39;s the int argument in your code? What&#39;s its purpose?"}, {"owner": {"reputation": 57, "user_id": 10408948, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102103916621870/picture?type=large", "display_name": "Andrei Bercea", "link": "https://stackoverflow.com/users/10408948/andrei-bercea"}, "edited": false, "score": 0, "creation_date": 1538215307, "post_id": 52567206, "comment_id": 92071643, "body": "my mistake. I edited the type to the correct form."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538215684, "post_id": 52567206, "comment_id": 92071724, "body": "Well if <code>bc</code> is a list then <code>fst bc</code>, and <code>snd bc</code> does not make sense, since <code>fst</code> works over a 2-tuple, not a list (regardless whether these contain 2-tuples)."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10408948, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102103916621870/picture?type=large", "display_name": "Andrei Bercea", "link": "https://stackoverflow.com/users/10408948/andrei-bercea"}, "edited": false, "score": 0, "creation_date": 1538216558, "post_id": 52567327, "comment_id": 92071885, "body": "Thank you. Though the pattern is ( ( _ , _ ) , x ), it works. Don&#39;t know why it didn&#39;t came to me. Maybe I was just too focused on using list comprehension."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 57, "user_id": 10408948, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102103916621870/picture?type=large", "display_name": "Andrei Bercea", "link": "https://stackoverflow.com/users/10408948/andrei-bercea"}, "edited": false, "score": 0, "creation_date": 1538216606, "post_id": 52567327, "comment_id": 92071896, "body": "@AndreiBercea: but in your qustion you say &quot;second&quot; value of the tuple, or do you mean the outer tuple."}, {"owner": {"reputation": 57, "user_id": 10408948, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102103916621870/picture?type=large", "display_name": "Andrei Bercea", "link": "https://stackoverflow.com/users/10408948/andrei-bercea"}, "edited": false, "score": 1, "creation_date": 1538217226, "post_id": 52567327, "comment_id": 92072035, "body": "I use the function to check if a row in a 3x3 matrix is filled with the same element ( I have to build a Tic-Tac-Toe game )."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1538216693, "last_edit_date": 1538216693, "creation_date": 1538215907, "answer_id": 52567327, "question_id": 52567206, "link": "https://stackoverflow.com/questions/52567206/haskell-error-when-trying-to-get-the-last-element/52567327#52567327", "title": "Haskell error when trying to get the last element", "body": "<p>It will probably be easier if we perform simple <strong>pattern matching</strong> instead of using <code>fst :: (a, b) -&gt; a</code>, etc.</p>\n\n<h1>Second item of the first item of the tuple</h1>\n\n<p>We can use a pattern <code>((_, x), _)</code> to obtain the second element from such 2-tuple wrapped in a 2-tuple.</p>\n\n<p>So we can use pattern matching like:</p>\n\n<pre><code>wcheck :: [((Int,Int),Int)] -&gt; Bool\nwcheck [((_, x), _), ((_, y), _), ((_, z), _)] = x == y &amp;&amp; y == z\nwcheck _ = False\n</code></pre>\n\n<p>So here if the list contains three elements, we unpack the elements, and then check if the \"second item\"s are equal to each other. In case the pattern does not match (for a list with too few, or too much elements), we just return <code>False</code>.</p>\n\n<p>But a \"list of three elements\" does not make much sense. In case the number of elements is known at compile time, it is better to use a tuple, since in that way, the compiler can verify that you can only provide 3-tuples to that function.</p>\n\n<h1>Second item of the tuple</h1>\n\n<p>In case we are interested in the <em>second</em> item of the tuple, we can use <code>(_, x)</code> as pattern (we are not interested in the first item whatsoever):</p>\n\n<pre><code>wcheck :: [((Int,Int),Int)] -&gt; Bool\nwcheck [(_, x), (_, y), (_, z)] = x == y &amp;&amp; y == z\nwcheck _ = False\n</code></pre>\n\n<p>Note that we can generalize the signature with:</p>\n\n<pre><code>wcheck :: Eq c =&gt; [((a, b), c)] -&gt; Bool\nwcheck [(_, x), (_, y), (_, z)] = x == y &amp;&amp; y == z\nwcheck _ = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": false, "score": 2, "last_activity_date": 1538215967, "creation_date": 1538215967, "answer_id": 52567338, "question_id": 52567206, "link": "https://stackoverflow.com/questions/52567206/haskell-error-when-trying-to-get-the-last-element/52567338#52567338", "title": "Haskell error when trying to get the last element", "body": "<p><code>fst</code> and <code>snd</code> are not very nice in this situation. We can extract the bit we care about by doing a pattern match:</p>\n\n<pre><code>let (_,y) = x in ...\n</code></pre>\n\n<p>Now you want to do that to each element of your list (to check that every element has the same second value):</p>\n\n<pre><code>map (\\(_,x) -&gt; x)\n</code></pre>\n\n<p>And then you want to check that they are all equal:</p>\n\n<pre><code>allEqual :: Eq a =&gt; [a] -&gt; Bool\nallEqual [] = True\nallEqual (x:xs) = all (\\y-&gt;x==y) xs\n</code></pre>\n\n<p>This gets the first element, <code>x</code>, from a list (if it exists) and checks that ever other item <code>y</code> satisfies the test that <code>x==y</code></p>\n\n<p>So we can now write your function:</p>\n\n<pre><code>wcheck xs = allEqual (map (\\(_,y) -&gt; y) xs)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 402, "user_id": 9009630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920657e98e40c2206e2166bba183551d?s=128&d=identicon&r=PG&f=1", "display_name": "jhu", "link": "https://stackoverflow.com/users/9009630/jhu"}, "is_accepted": false, "score": 0, "last_activity_date": 1538219786, "last_edit_date": 1538219786, "creation_date": 1538219434, "answer_id": 52567785, "question_id": 52567206, "link": "https://stackoverflow.com/questions/52567206/haskell-error-when-trying-to-get-the-last-element/52567785#52567785", "title": "Haskell error when trying to get the last element", "body": "<p>Given that you want to test the equality of the second element of the outer pair, there are so many ways to do this, including the following.</p>\n\n<p>First, fmapping <code>snd</code> gives you these elements:</p>\n\n<pre><code>\u03bb&gt; fmap snd [((1,2),7),((5,3),7),((1,9),7)]\n[7,7,7]\n</code></pre>\n\n<p>Now you can group them to lists of consecutive equal numbers:</p>\n\n<pre><code>\u03bb&gt; import Data.List\n\u03bb&gt; (group . fmap snd) [((1,2),7),((5,3),7),((1,9),7)]\n[[7,7,7]]\n</code></pre>\n\n<p>The values are equal if the length of this list of lists is at most one (assuming an empty list of such pairs is defined to have equal second elements):</p>\n\n<pre><code>\u03bb&gt; (length . group . fmap snd) [((1,2),7),((5,3),7),((1,9),7)]\n1\n</code></pre>\n\n<p>Putting these together we can define</p>\n\n<pre><code>import Data.List\n\nequalSnds :: Eq a =&gt; [(b, a)] -&gt; Bool\nequalSnds xs = (length . group . fmap snd) xs &lt;= 1\n</code></pre>\n\n<p>So that </p>\n\n<pre><code>\u03bb&gt; equalSnds [((1,2),7),((5,3),7),((1,9),7)]\nTrue\n\u03bb&gt; equalSnds [((1,2),3),((5,3),3),((1,9),5)]\nFalse\n</code></pre>\n\n<p>If you want to also test for the length of the list, you can do it separately:</p>\n\n<pre><code>wcheck :: [((Int,Int),Int)] -&gt; Bool\nwcheck xs = length xs == 3 &amp;&amp; equalSnds xs\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10408948, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102103916621870/picture?type=large", "display_name": "Andrei Bercea", "link": "https://stackoverflow.com/users/10408948/andrei-bercea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 52567327, "answer_count": 3, "score": 2, "last_activity_date": 1538219786, "creation_date": 1538214894, "last_edit_date": 1538215292, "question_id": 52567206, "link": "https://stackoverflow.com/questions/52567206/haskell-error-when-trying-to-get-the-last-element", "title": "Haskell error when trying to get the last element", "body": "<p>So, I am trying to implement a function that, given a list of 3 elements <code>((Int,Int),Int)</code>, returns <code>True</code> when on the second position is the same value for all 3 and <code>False</code> otherwise.</p>\n\n<p>For instance, <code>[((1,2),7),((5,3),7),((1,9),7)]</code> should return <code>True</code> and <code>[((1,2),3),((5,3),3),((1,9),5)]</code> should return <code>False</code>.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>bc :: [((Int,Int),Int)]\nwcheck :: [((Int,Int),Int)] -&gt; Bool\nwcheck bc\n   | (( fst(fst bc) == fst(snd bc) ) &amp;&amp; ( fst(snd bc) == fst(last bc) )) = True\n   | otherwise                                                           = False\n</code></pre>\n\n<p>And the error that I get:</p>\n\n<pre><code>E:\\\\study related\\Module1\\week 4\\ttt.hs:55:65: error:\n* Couldn't match expected type `[(a, b0)]'\n              with actual type `((a, b), (a, b1))'\n* In the first argument of `last', namely `bc'\n  In the first argument of `fst', namely `(last bc)'\n  In the second argument of `(==)', namely `fst (last bc)'\n* Relevant bindings include\n    bc :: ((a, b), (a, b1))\n      (bound at E:\\\\study related\\Module1\\week 4\\ttt.hs:54:8)\n    wcheck :: ((a, b), (a, b1)) -&gt; Bool\n      (bound at E:\\\\study related\\Module1\\week 4\\ttt.hs:54:1)\n   |\n55 |  | (( fst(fst bc) == fst(snd bc) ) &amp;&amp; ( fst(snd bc) == fst(last bc) )) = True\n   |\n</code></pre>\n\n<p>Could you please tell me why I get this error and a way to fix it? Thank you.</p>\n"}, {"tags": ["haskell", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 10432827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f06a199fb70ed55cdbbf90893882d1?s=128&d=identicon&r=PG&f=1", "display_name": "sf1", "link": "https://stackoverflow.com/users/10432827/sf1"}, "edited": false, "score": 0, "creation_date": 1538216214, "post_id": 52566967, "comment_id": 92071819, "body": "Since the Fibonacci example works, this means that Array has the right lazyness properties. Then the problem should be fixed if I replace UArray by Array in my code sample (and import Data.Array). Unfortunately, the modified code still produces a loop error at runtime."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 135, "user_id": 10432827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f06a199fb70ed55cdbbf90893882d1?s=128&d=identicon&r=PG&f=1", "display_name": "sf1", "link": "https://stackoverflow.com/users/10432827/sf1"}, "edited": false, "score": 0, "creation_date": 1538224034, "post_id": 52566967, "comment_id": 92073706, "body": "@sf1 See my last edit. It was much more subtle than I thought."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1538223858, "last_edit_date": 1538223858, "creation_date": 1538213023, "answer_id": 52566967, "question_id": 52566786, "link": "https://stackoverflow.com/questions/52566786/which-recursive-calls-are-allowed-in-haskell-array-creation/52566967#52566967", "title": "Which recursive calls are allowed in Haskell array creation?", "body": "<p>Update: I think I finally understood what's going on. <code>array</code> is lazy on the list elements, but is unnecessarily <em>strict</em> on its spine!</p>\n\n<p>This causes a <code>&lt;&lt;loop&gt;&gt;</code> exception, for instance</p>\n\n<pre><code>test :: Array Int Int\ntest = array (1,2) ((1,1) : if test!1 == 1 then [(2,2)] else [(2,100)])\n</code></pre>\n\n<p>unlike</p>\n\n<pre><code>test :: Array Int Int\ntest = array (1,2) ((1,1) : [(2, if test!1 == 1 then 2 else 100)])\n</code></pre>\n\n<p>So, recursion works as long as it only affects the values.</p>\n\n<p>A working version:</p>\n\n<pre><code>main :: IO ()\nmain = do\n   putStrLn $ show $ (primes 500)!500 --arbitrary example\n\n-- A spine-lazy version of array\n-- Assumes the list carries indices lo..hi\narraySpineLazy :: (Int, Int) -&gt; [(Int, a)] -&gt; Array Int a\narraySpineLazy (lo,hi) xs = array (lo,hi) $ go lo xs\n   where\n   go i _ | i &gt; hi = []\n   go i ~((_,e):ys) = (i, e) : go (succ i) ys\n\nprimes :: Int -&gt; Array Int Int\nprimes n = a\n  where\n    a :: Array Int Int\n    a = arraySpineLazy (1,n) $ primelist 1 (2: [3,5..])\n    primelist :: Int -&gt; [Int] -&gt; [(Int, Int)]\n    primelist i _ | i &gt; n = []\n    primelist _ [] = [] -- remove warnings\n    primelist i (m:ms) =\n      if all (not . divides m) [ a!j | j &lt;- [1..(i-1)]]\n      then (i ,m) : primelist (succ i) ms\n      else primelist i ms\n    divides m k = m `mod` k == 0\n</code></pre>\n\n<p>Arguably, we should instead write a lazier variant of <code>listArray</code> instead, since our <code>array</code> variant discard the first components of the pair.</p>\n\n<hr>\n\n<p>This is a strictness issue: you can't generate <em>unboxed</em> arrays recursively, only boxed (regular) ones, since only boxed ones have a lazy semantics.</p>\n\n<p>Forget arrays, and consider the following recursive pair definition</p>\n\n<pre><code>let (x,y) = (0,x)\n</code></pre>\n\n<p>This defines <code>x=0 ; y=0</code>, recursively. However, for the recursion to work, it is necessary that the pair is lazy. Otherwise, it generates an infinite recursion, much as the following would do:</p>\n\n<pre><code>let p = case p of (x,y) -&gt; (0,x)\n</code></pre>\n\n<p>Above, <code>p</code> evaluates itself before it can expose the <code>(,)</code> pair constructor, so an infinite loop arises. By comparison,</p>\n\n<pre><code>let p = (0, case p of (x,y) -&gt; x)\n</code></pre>\n\n<p>would work, since <code>p</code> produces the <code>(,)</code> before calling itself. Note however that this relies on the constructor <code>(,)</code> not evaluating the components before returning -- it has to be lazy, and return immediately leaving the components to be evaluated later.</p>\n\n<p>Operationally, a pair is constructed having inside tho <em>thunks</em>: two pointers to code, which will evaluate the result later on. Hence the pair is not really a pair of integers, but a pair of indirections-to-integer. This is called \"boxing\", and is needed to achieve laziness, even if it carries a little computational cost.</p>\n\n<p>By definition, unboxed data structures, like unboxed arrays, avoid boxing, so they are strict, not lazy, and they can not support the same recursion approaches.</p>\n"}], "owner": {"reputation": 135, "user_id": 10432827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f06a199fb70ed55cdbbf90893882d1?s=128&d=identicon&r=PG&f=1", "display_name": "sf1", "link": "https://stackoverflow.com/users/10432827/sf1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "accepted_answer_id": 52566967, "answer_count": 1, "score": 3, "last_activity_date": 1538223858, "creation_date": 1538211550, "question_id": 52566786, "link": "https://stackoverflow.com/questions/52566786/which-recursive-calls-are-allowed-in-haskell-array-creation", "title": "Which recursive calls are allowed in Haskell array creation?", "body": "<p>As a short exercise in using Haskell arrays I wanted to implement a function giving the first n (odd) prime numbers. The code below (compiled with GHC 7.10.3) produces a loop error at runtime. \"A Gentle Introduction to Haskell\" uses recursive calls in array creation to compute Fibonacci numbers (<a href=\"https://www.haskell.org/tutorial/arrays.html\" rel=\"nofollow noreferrer\">https://www.haskell.org/tutorial/arrays.html</a>, 13.2, code below for reference), which works just fine. My question is:</p>\n\n<p>Where is the difference between the two ways of recursive creation? Which recursive calls are generally allowed when creating arrays?</p>\n\n<p>My code:</p>\n\n<pre><code>import Data.Array.Unboxed\n\nmain = putStrLn $ show $ (primes 500)!500 --arbitrary example\n\n\nprimes :: Int -&gt; UArray Int Int\nprimes n = a\n  where\n    a = array (1,n) $ primelist 1 [3,5..]\n    primelist i (m:ms) =\n      if   all (not . divides m) [ a!j | j &lt;- [1..(i-1)]]\n      then (i ,m) : primelist (succ i) ms\n      else primelist i ms\n    divides m k = m `mod` k == 0\n</code></pre>\n\n<p>Code from \"A Gentle Introduction to Haskell\":</p>\n\n<pre><code>fibs    :: Int -&gt; Array Int Int\nfibs n  =  a  where a = array (0,n) ([(0, 1), (1, 1)] ++ \n                                     [(i, a!(i-2) + a!(i-1)) | i &lt;- [2..n]])\n</code></pre>\n\n<p>Thanks in advance for any answers!</p>\n"}, {"tags": ["haskell", "testing", "io", "stdin", "doctest"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 1, "creation_date": 1538218640, "post_id": 52565746, "comment_id": 92072380, "body": "Looks like you can&#39;t provide input to <code>doctest</code>. Probably worth opening an issue on the github repository: <a href=\"https://github.com/sol/doctest/issues\" rel=\"nofollow noreferrer\">github.com/sol/doctest/issues</a>"}], "owner": {"reputation": 3245, "user_id": 955091, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b3c5026fee43baef3b15d7fef166a7e?s=128&d=identicon&r=PG", "display_name": "Yang Bo", "link": "https://stackoverflow.com/users/955091/yang-bo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1538202367, "creation_date": 1538202367, "question_id": 52565746, "link": "https://stackoverflow.com/questions/52565746/how-to-provide-stdin-for-doctests", "title": "How to provide stdin for doctests?", "body": "<p>I want to create an example in doctest for using <code>getLine</code>. However, when I run the test, it does not terminate:</p>\n\n<pre><code>{- |\n&gt;&gt;&gt; getLine\n&gt;&gt;&gt; Hello, World!\n\"Hello, World!\"\n-}\nmodule MyModule where\n</code></pre>\n\n<p>How to provide custom input for doctest?</p>\n"}, {"tags": ["haskell", "types", "compiler-errors", "fold"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1538195184, "post_id": 52564838, "comment_id": 92068067, "body": "<code>pipe = appEndo . foldMap Endo</code>"}, {"owner": {"reputation": 402, "user_id": 9009630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920657e98e40c2206e2166bba183551d?s=128&d=identicon&r=PG&f=1", "display_name": "jhu", "link": "https://stackoverflow.com/users/9009630/jhu"}, "edited": false, "score": 0, "creation_date": 1538196022, "post_id": 52564838, "comment_id": 92068165, "body": "See <a href=\"https://stackoverflow.com/questions/4342013/the-composition-of-functions-in-a-list-of-functions\" title=\"the composition of functions in a list of functions\">stackoverflow.com/questions/4342013/&hellip;</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1538225311, "post_id": 52564838, "comment_id": 92074013, "body": "<code>pipe fs x = foldr f x fs</code> with the same <code>f</code> as you have. it can also be written as <code>f a x = a x = a $ x = ($) a x</code> so we can just write <code>($)</code> instead of <code>f</code> in the definition of <code>pipe</code>."}], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 10079777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iGSVP.jpg?s=128&g=1", "display_name": "Yaokun Xu", "link": "https://stackoverflow.com/users/10079777/yaokun-xu"}, "edited": false, "score": 0, "creation_date": 1538202255, "post_id": 52564936, "comment_id": 92069059, "body": "But I still wonder why this will give me a infinite type error, is it because I pass in function as parameter?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1538224435, "post_id": 52564936, "comment_id": 92073781, "body": "the 1st and 3rd definitions are the same, and both are wrong. interestingly, both <code>foldr (.) id</code> and <code>foldl (.) id</code> produce the same result, because <code>(.)</code> is associative and <code>id</code> is <code>(.)</code>&#39;s zero (IOW <code>(.)</code> and <code>id</code> form a monoid, which is the basis of <a href=\"https://stackoverflow.com/questions/52564838/occurs-check-cannot-construct-the-infinite-type#comment92068067_52564838\">this comment</a> by Daniel Wagner). Using <code>flip (.)</code> instead again produces <i>the same result</i> with <i>both</i> <code>foldr</code> and <code>foldl</code>, the result being the <i>reversed</i> composition of the list of functions."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1538225271, "post_id": 52564936, "comment_id": 92074003, "body": "(+1) and (*2) are not commutative. <code>take 1</code> and <code>drop 1</code> are not commutative. not many functions are, and it goes to the choice between <code>(.)</code> and <code>flip (.)</code>, not between left and right fold."}, {"owner": {"reputation": 479, "user_id": 1050182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/bfgX0.jpg?s=128&g=1", "display_name": "Yuan Wang", "link": "https://stackoverflow.com/users/1050182/yuan-wang"}, "edited": false, "score": 0, "creation_date": 1538241922, "post_id": 52564936, "comment_id": 92078246, "body": "I think both foldr vs foldl and flip (.) vs (.) matters in this case: (foldr (flip (.)) id) [(/2), (+1)] 10 == 6.0, (foldl  (.) id) [(/2), (+1)] 10 == 5.5.  (foldr (flip (.)) id) should be the correct solution in this case"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1538383581, "post_id": 52564936, "comment_id": 92109911, "body": "no, they <i>both</i> are correct, with foldr and foldl alike. just try <i>all four</i> combinations and see the results. flip (.) gives <i>reversed</i> composition. <code>foldr (.) id [f,g] = foldl (.) id [f,g] = f . g</code>, <code>foldr (flip (.)) id [f,g] = foldl (flip (.)) id [f,g] = g . f</code>."}], "tags": [], "owner": {"reputation": 479, "user_id": 1050182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/bfgX0.jpg?s=128&g=1", "display_name": "Yuan Wang", "link": "https://stackoverflow.com/users/1050182/yuan-wang"}, "is_accepted": false, "score": 1, "last_activity_date": 1538210498, "last_edit_date": 1538210498, "creation_date": 1538192934, "answer_id": 52564936, "question_id": 52564838, "link": "https://stackoverflow.com/questions/52564838/occurs-check-cannot-construct-the-infinite-type/52564936#52564936", "title": "Occurs check: cannot construct the infinite type", "body": "<p>You could do</p>\n\n<pre><code>pipe :: [a -&gt; a] -&gt; (a -&gt; a)\npipe = foldr (flip (.)) id\n</code></pre>\n\n<p>There is a difference between <code>foldr</code> and <code>foldl</code>. </p>\n\n<p>Your <code>base</code> function is equivalent to <code>id</code>.</p>\n\n<p>In your version, the definition of <code>f</code> is incorrect. It should take two functions and return a new function.</p>\n\n<p>You could write it as</p>\n\n<pre><code>pipe :: [(a -&gt; a)] -&gt; (a -&gt; a)\npipe fs   = foldl f id fs\n  where\n    f g h = g . h\n    base  = (\\x -&gt; x)\n</code></pre>\n\n<p>or </p>\n\n<pre><code>pipe :: [(a -&gt; a)] -&gt; (a -&gt; a)\npipe fs   = foldl f id fs\n  where\n    f g h a = h (g a)\n    base  = (\\x -&gt; x)\n</code></pre>\n\n<p>If all functions are commutative, using <code>foldr</code> or <code>foldl</code> makes no difference, otherwise you need to choose <code>foldr</code> or <code>foldl</code> correctly.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1538209160, "creation_date": 1538209160, "answer_id": 52566532, "question_id": 52564838, "link": "https://stackoverflow.com/questions/52564838/occurs-check-cannot-construct-the-infinite-type/52566532#52566532", "title": "Occurs check: cannot construct the infinite type", "body": "<p>I'll explain why your code is not working. Let's compute <code>pipe [g,h] x</code>. We expect this to be <code>g(h x)</code>.</p>\n\n<p>I will ignore the types, and simply compute according to the definitions:</p>\n\n<pre><code>pipe [g,h] x\n= foldl' f base [g,h] x\n= foldl' f (f base g) [h] x\n= foldl' f (f (f base g) h) [] x\n= f (f base g) h x\n= (f base g) h x\n= base g h x\n= g h x\n</code></pre>\n\n<p>So, in the last line we can see that <code>g</code> is called with two arguments, <code>h</code> and <code>x</code>, while we expected to have <code>g (h x)</code> instead.</p>\n\n<p>The mistake is that <code>f</code> uses application <code>f a x = a x</code> instead of composition <code>f a x = a . x</code>. Using the latter we would get</p>\n\n<pre><code>... \n= ((base . g) . h) x\n= base (g (h x))\n= g (h x)\n</code></pre>\n"}], "owner": {"reputation": 56, "user_id": 10079777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iGSVP.jpg?s=128&g=1", "display_name": "Yaokun Xu", "link": "https://stackoverflow.com/users/10079777/yaokun-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1538210498, "creation_date": 1538191621, "last_edit_date": 1538210205, "question_id": 52564838, "link": "https://stackoverflow.com/questions/52564838/occurs-check-cannot-construct-the-infinite-type", "title": "Occurs check: cannot construct the infinite type", "body": "<p>The task I want to handle is described as below:</p>\n\n<blockquote>\n  <p><code>pipe [f1,...,fn] x</code> should return <code>f1(f2(...(fn x)))</code></p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>pipe :: [(a -&gt; a)] -&gt; (a -&gt; a)\npipe fs   = foldl' f base fs\n  where\n    f a x = a (x)\n    base  = (\\x -&gt; x)\n</code></pre>\n\n<p>I think this makes sense as it iterates through the function list, however, the compiler tells me:</p>\n\n<pre><code>tutorial.hs:45:20: error:\n    \u2022 Occurs check: cannot construct the infinite type: a ~ a -&gt; a\n      Expected type: (a -&gt; a) -&gt; (a -&gt; a) -&gt; a -&gt; a\n      Actual type: ((a -&gt; a) -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; a -&gt; a\n    \u2022 In the first argument of \u2018foldl'\u2019, namely \u2018f\u2019\n      In the expression: foldl' f base fs\n      In an equation for \u2018pipe\u2019:\n         pipe fs\n            = foldl' f base fs\n            where\n                f a x = a (x)\n                base = (\\ x -&gt; x)\n    \u2022 Relevant bindings include\n        fs :: [a -&gt; a] (bound at tutorial.hs:45:6)\n        pipe :: [a -&gt; a] -&gt; a -&gt; a (bound at tutorial.hs:45:1)\n   |\n45 | pipe fs   = foldl' f base fs\n   |                    ^\nFailed, no modules loaded.\n</code></pre>\n\n<p>I am a newcomer to Haskell, and Thanks for your help in advance:)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10431542"}, "edited": false, "score": 0, "creation_date": 1538350591, "post_id": 52563906, "comment_id": 92101042, "body": "hey I tried what you said and got the error: parse error on input \u2018where\u2019"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10431542"}, "edited": false, "score": 0, "creation_date": 1538352962, "post_id": 52563906, "comment_id": 92101429, "body": "the error is now: Perhaps you need a &#39;let&#39; in a &#39;do&#39; block? e.g. &#39;let x = 5&#39; instead of &#39;x = 5&#39;"}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1538353248, "post_id": 52563906, "comment_id": 92101469, "body": "<code>cubicS</code>, <code>cubicT</code>, <code>root</code>, and <code>cubicDisc</code> have not been defined. The compiler is complaining that you need to define them. I&#39;d recommend defining them in the <code>where</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10431542"}, "reply_to_user": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 1, "creation_date": 1538353839, "post_id": 52563906, "comment_id": 92101559, "body": "@DavOS I have edited everything again and I have a new error, which I have stated above the code"}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1538354255, "post_id": 52563906, "comment_id": 92101626, "body": "<code>cubicDisc</code> should be defined: <code>cubicDisc :: Double -&gt; Double</code> and implemented as such: <code>cubicDisc r = cubicQ^3 + r^^2</code>. You&#39;ll still have errors because you are using un-applied functions <code>cubicS</code>,<code>cubicT</code> in <code>where</code>. Each needs two parameters <code>q</code> and <code>r</code> as you defined."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10431542"}, "reply_to_user": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1538355243, "post_id": 52563906, "comment_id": 92101803, "body": "@DavOS I don&#39;t get how I am supposed to apply them, can you please help me"}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1538356715, "post_id": 52563906, "comment_id": 92102059, "body": "&quot;Function application is calling a function by putting a space after it and then typing out the parameters.&quot; Please read <a href=\"http://learnyouahaskell.com/starting-out\" rel=\"nofollow noreferrer\">LYAH</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10431542"}, "reply_to_user": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1538357750, "post_id": 52563906, "comment_id": 92102204, "body": "@DavOS I keep getting parse error on input \u2018where&#39;"}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1538364907, "post_id": 52563906, "comment_id": 92103384, "body": "<code>cubicDisc</code>, <code>root</code>, <code>cubicS</code>, and <code>cubicT</code> should all have type <code>Double</code>. If you really want them to be a function, which is probably unnecessary, then you need to apply them with parameters. But for simplicity, just make them <code>Double</code>s"}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1538392546, "post_id": 52563906, "comment_id": 92114480, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52484370/haskell-use-multiple-functions-inside-of-another-function\">Haskell use multiple functions inside of another function</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10431542"}, "edited": false, "score": 0, "creation_date": 1538350666, "post_id": 52565667, "comment_id": 92101050, "body": "hey I tried what you said and got the error: parse error on input \u2018where\u2019"}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1538351292, "post_id": 52565667, "comment_id": 92101159, "body": "@hesamhlors Double check your indentation is correct. Only use spaces and <code>where</code> should be two spaces from the left, each line under <code>where</code> should be another two spaces from the left, total four spaces from left margin. Don&#39;t leave <code>...</code> in the code, <code>...</code> indicates that code needs to be added there. You can also edit your original question with what you have so far and please add the exact error you are receiving in code blocks. I&#39;d be more than happy to troubleshoot your updated code!"}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1538353376, "post_id": 52565667, "comment_id": 92101489, "body": "@hesamhlors I&#39;ve edited my answer to define <code>cubicDisc</code>"}], "tags": [], "owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "is_accepted": false, "score": 1, "last_activity_date": 1538364799, "last_edit_date": 1538364799, "creation_date": 1538201613, "answer_id": 52565667, "question_id": 52563906, "link": "https://stackoverflow.com/questions/52563906/haskell-program-for-calculating-3rd-roots/52565667#52565667", "title": "Haskell program for calculating 3rd roots", "body": "<p>Syntactically, your program does not make sense, that's what the compiler is complaining about. First, the <code>if</code> statement is just floating around; its not in the same scope as <code>cubicRealSolutions</code>. I would recommend revising and reading through some Haskell documentation on <code>let</code>, <code>if</code>, and function syntax . For now, if I were you I would clean up the code as follows:</p>\n\n<pre><code>cubicRealSolutions :: Double -&gt; Double -&gt; Double -&gt; Double -&gt; [Double]\ncubicRealSolutions a b c d = if cubicDisc &gt; 0 || root == 0\n                             then [rootOne,rootTwo,rootThree]\n                             else []\n  where \n    root = 0\n    rootOne= (cubicS + cubicT) - b/(3*a)\n    rootTwo = (cubicS+cubicT)/2 -(b)/(3*a) + sqrt(3)/2*(cubicS-cubicT)\n    rootThree = (cubicS+cubicT)/2 -(b)/(3*a) + sqrt(3)/2*(cubicS-cubicT)\n    cubicDisc = 18*a*b*c*d - 4*(b^3)*d + (b^2)*(c^2) - 4*a*c^3 - 27*(a^2)*(d^2)\n    cubicS    = 0.1\n    cubicT    = 0.2\n</code></pre>\n\n<p>However, there are still major issues with this code and it <strong>will not compile</strong> because <code>root</code>,<code>cubicDisc</code>, <code>cubicS</code>, <code>cubicT</code> are not defined. Also, you never use the parameters <code>c</code> or <code>d</code> which I find odd, as you probably want to use them. Finally, <code>if</code> statements <strong>must</strong> evaluate to the same type, hence the <code>else</code> evaluates to an empty list instead of a string. Even my revision is not \"good\" style. There are too many statements in the <code>where</code> clause. If this happens its best to break the function down into smaller parts to avoid run-on <code>where</code> clauses. I've used <code>...</code> to indicate what you need to define for the compiler.</p>\n\n<p>References: <a href=\"http://learnyouahaskell.com/syntax-in-functions#where\" rel=\"nofollow noreferrer\">LYAH</a></p>\n\n<p>PS: Personally, I find <code>where</code> syntax to be easier to understand than <code>let</code> but that is up to personal style choices. Although, <code>let</code> is a bit more flexible than <code>where</code>.</p>\n\n<p>EDIT: I have defined <code>root</code>, <code>cubicS</code>, and <code>cubicT</code> with placeholder values to illustrate that they must evaluate to a <code>Double</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10431542"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1538418673, "creation_date": 1538179490, "last_edit_date": 1538418673, "question_id": 52563906, "link": "https://stackoverflow.com/questions/52563906/haskell-program-for-calculating-3rd-roots", "title": "Haskell program for calculating 3rd roots", "body": "<pre><code>The error now iCouldn't match expected type \u2018Double\u2019\n          with actual type \u2018Double -&gt; Double -&gt; Double -&gt; Double\u2019 , Probable cause: \u2018(+)\u2019 is applied to too few arguments\n</code></pre>\n\n<p>In the expression: cubicQ ^ 3 + r ^^ 2\n  In an equation for \u2018cubicDisc\u2019: cubicDisc q r = cubicQ ^ 3 + r ^^ 2</p>\n\n<pre><code> cubicR :: Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double\ncubicR a b c d = (9*a*b*c-27*a^^2*d-2*b^^3)/(54*a^^3)\n\ncubicQ :: Double -&gt; Double -&gt; Double -&gt; Double\ncubicQ a b c = (3*a*c-b^^2)/(9*a^^2)\ncubicDisc :: Double -&gt; Double -&gt; Double\ncubicDisc q r  = cubicQ^3 + r^^2\ncubicS :: Double -&gt; Double -&gt; Double\ncubicS q r = (r + sqrt(q^^3+r^^2))**(1/3)\ncubicT :: Double -&gt; Double -&gt; Double\ncubicT q r = (r - sqrt(q^^3+r^^2))**(1/3)\n\ncubicRealSolutions :: Double -&gt; Double -&gt; Double -&gt; Double -&gt; [Double]\ncubicRealSolutions a b c d = if cubicDisc &gt; 0 || root == 0\n                             then [rootOne,rootTwo,rootThree]\n                             else []\n  where \n\n    rootOne= (cubicS + cubicT) - b/(3*a)\n    rootTwo = (cubicS+cubicT)/2 -(b)/(3*a) + sqrt(3)/2*(cubicS-cubicT)\n    rootThree = (cubicS+cubicT)/2 -(b)/(3*a) + sqrt(3)/2*(cubicS-cubicT)\n</code></pre>\n"}, {"tags": ["haskell", "pattern-matching", "gadt"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1538199398, "post_id": 52563874, "comment_id": 92068616, "body": "Typeclasses are <i>open</i>, that means that there is nothing preventing somebody else, in another module, from adding an <code>instance PhantomConstraint &#39;B</code>, thus making <code>someFunc</code>&#39;s patterns inexhaustive.  There are probably ways to do what you want, but maybe some more details about your problem will help guide to a good solution."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1538208085, "creation_date": 1538208085, "answer_id": 52566405, "question_id": 52563874, "link": "https://stackoverflow.com/questions/52563874/haskell-gadts-pattern-match-with-class-constraints/52566405#52566405", "title": "Haskell - GADTs pattern match with class constraints", "body": "<p>I can't reproduce the issue. This loads without warnings or errors in GHCi 8.4.3.</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, KindSignatures #-}\n{-# OPTIONS -Wall #-}\nmodule GADTwarning2 where\n\ndata Phantom = A | B\n\ndata Foo (a :: Phantom) where\n  FooA :: Foo 'A\n  FooB :: Foo 'B\n\nclass PhantomConstraint (a :: Phantom)\n\ninstance PhantomConstraint 'A -- Note: No instance for 'B\n\nsomeFunc :: PhantomConstraint a =&gt; Foo a -&gt; ()\nsomeFunc FooA = ()\nsomeFunc FooB = ()\n</code></pre>\n\n<p>As luqui explained in a comment, we can't avoid the <code>FooB</code> case, since type classes are open, and another instance could be added later on by another module, making the pattern match non exhaustive.</p>\n\n<p>If you are absolutely sure you don't need any other instances except the one for <code>A</code>, you can try to use</p>\n\n<pre><code>class a ~ 'A =&gt; PhantomConstraint (a :: Phantom)\n</code></pre>\n\n<p>Or, if the index <code>a</code> can be <code>'A</code> or <code>'B</code>, but never a third constructor <code>'C</code>, then we can try to reify this fact:</p>\n\n<pre><code>class PhantomConstraint (a :: Phantom) where\n   aIsAOrB :: Either (a :~: 'A) (a :~: 'B)\n</code></pre>\n\n<p>and then exploit this member later on.</p>\n"}], "owner": {"reputation": 21, "user_id": 5390625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lJGbK.jpg?s=128&g=1", "display_name": "CaptJakk", "link": "https://stackoverflow.com/users/5390625/captjakk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1538339875, "creation_date": 1538179154, "last_edit_date": 1538339875, "question_id": 52563874, "link": "https://stackoverflow.com/questions/52563874/haskell-gadts-pattern-match-with-class-constraints", "title": "Haskell - GADTs pattern match with class constraints", "body": "<p>Consider the following example</p>\n\n<pre><code>{-# LANGUAGE DataKinds, GADTs #-}\ndata Phantom = A | B\ndata Foo (a :: Phantom) where\n  FooA :: Foo 'A\n  FooB :: Foo 'B\nclass PhantomConstraint (a :: Phantom)\ninstance PhantomConstraint 'A -- Note: No instance for 'B\nsomeFunc :: PhantomConstraint a =&gt; Foo a -&gt; ()\nsomeFunc FooA = ()\n</code></pre>\n\n<p>If I do something like this GHC complains that the pattern matches are inexhaustive for <code>someFunc</code>, however, if I do try and include the case for FooB (which I don't want to do for domain specific reasons) it complains that it can't deduce the instance of <code>PhantomConstraint</code> for <code>Foo 'B</code></p>\n\n<p>Is there any way to make GADT pattern matching aware of typeclass constraints such that it eliminates required arms of pattern matching?</p>\n\n<p>EDIT: More details around what I want to do. I have a bucket of types that are all somewhat related but have different properties. In the OO world this is what people use subtyping and inheritance for. However in the FP community, the consensus seems to be that there is no real good way to do subtyping, so in this case I need to hack around it. As such I have a GADT that unifies all of the types, but with different parameters on that type. I then proceed to write different typeclasses and typeclass instances on the type parameters (enabled by datakinds, no term representation). I want to be able to express that some of these types from the datakinds have a property that others don't, but they all do share certain common properties so I don't really want to break up the type. The only other option I can foresee is to create a taxonomy on the type part, but then the DataKinds types get messed up.</p>\n"}, {"tags": ["haskell", "fold"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1538169679, "post_id": 52562752, "comment_id": 92064051, "body": "It is worth thinking about what the specialized type of <code>foldr</code> is.  That is, <code>foldr :: (x -&gt; y -&gt; y) -&gt; y -&gt; [x] -&gt; y</code> ; what are the types <code>x</code> and <code>y</code> here?  (For example <code>const z</code> has type <code>y</code>, so <code>y</code> must actually be a function type...)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538169916, "post_id": 52562752, "comment_id": 92064126, "body": "The <code>foldr</code> itself does <i>not</i> create the elements, it creates a function, like the <code>State</code> does as well, and then calls it with <code>0</code> as parameter, and (more or less like <code>State</code>), it updates the state (although here that is done implicitly)."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1538170161, "post_id": 52562752, "comment_id": 92064216, "body": "Yes, I can see that the result of the fold is a function, but I have trouble seeing how could this match the usual behavior of foldr where step function is the outer expression."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1538174093, "last_edit_date": 1538174093, "creation_date": 1538173366, "answer_id": 52563319, "question_id": 52562752, "link": "https://stackoverflow.com/questions/52562752/how-does-indexed-foldr-work-operationally/52563319#52563319", "title": "How does indexed foldr work operationally?", "body": "<p><strong>In short</strong>: the <code>foldr</code> produces a <em>function</em> (not a list of values), and that function will then generate that list.</p>\n\n<p>Let us first ignore the <code>foldr</code> for a while, and concentrate on the function used in the foldr, let us call this function <code>eval</code>:</p>\n\n<pre><code>eval x g i = seq i (f i x (g (i+1))))\n</code></pre>\n\n<p>We will ignore the <code>seq</code> here: yes it has some semantics: evaluating (to <em>weak head normal form</em>) the <code>i</code> and checking if <code>i</code> is bottom, but let us assume that this will not introduce a bottom. So <code>eval</code> is - more or less - equivalent to:</p>\n\n<pre><code>eval x g i = f i x (g (i+1))\n</code></pre>\n\n<p>Now we can take the <code>foldr</code> context back into account:</p>\n\n<pre><code>ifoldr f = foldr eval (const z) xs 0\n    where eval x g i = f i x (g (i+1))\n</code></pre>\n\n<p>Now <code>foldr</code> is defined (for lists, but let us keep things simple here), as:</p>\n\n<pre><code>foldr _ z [] = z\nfoldr f z (x:xs) = f x (foldr f z xs)\n</code></pre>\n\n<p>For a list with three elements <code>[x1, x2, x3]</code>, this thus means that:</p>\n\n<pre><code>foldr eval (const z) [x1, x2, x3]\n</code></pre>\n\n<p>looks like:</p>\n\n<pre><code>-- foldr eval (const z) [x1, x2, x3] is equivalent to\neval x1 (eval x2 (eval x3 (const z)))\n</code></pre>\n\n<p>Since <code>eval</code> is defined as above, that means that we can specialize it to:</p>\n\n<pre><code>\\i1 -&gt; f i1 x1 ((\\i2 -&gt; f i2 x2 (\\i3 -&gt; f i3 x3 (const z)) (i2 + 1)) (i1 + 1))\n</code></pre>\n\n<p>Or perhaps in a way that makes the structure more clear:</p>\n\n<pre><code>\\i1 -&gt; (\n    f i1 x1\n    \\i2 -&gt; (\n        f i2 x2\n        \\i3 -&gt; (\n            f i3 x3\n            (const z) (i3+1)\n        ) (i2+1)\n    ) (i1+1)\n)\n</code></pre>\n\n<p>So as you can see the outer function takes a parameter (here <code>i1</code>), and makes a call to <code>f</code> with <code>i1</code> (the index), <code>x1</code> (the first item), and as last item the result of a call that is the \"fold\" of the remaining list. We thus make a call with <code>i2</code> as parameter, but that <code>i2</code> is bound with <code>i1+1</code>.</p>\n\n<p>So if we perform substitution (substuting <code>i3</code> with <code>i2 + 1</code>), which is how lambda calculus works, we obtain:</p>\n\n<pre><code>\\i1 -&gt; (\n    f i1 x1\n    \\i2 -&gt; (\n        f i2 x2\n        (\n            f (i2+1) x3\n            (const z) (i2+1+1)\n        )\n    ) (i1+1)\n)\n</code></pre>\n\n<p>and furthermore we can substitute <code>i2</code> with <code>i1+1</code>:</p>\n\n<pre><code>\\i1 -&gt; (\n    f i1 x1\n    (\n        f (i1+1) x2\n        (\n            f (i2+1) x3\n            (const z) (i1+1+1+1)\n        )\n)\n</code></pre>\n\n<p>Since <code>(const z)</code> maps to <code>z</code>, regardless what the parameter is, we can substitute <code>(const z) (i1+1+1+1)</code> with <code>z</code>, so:</p>\n\n<pre><code>\\i1 -&gt; (\n    f i1 x1\n    (\n        f (i1+1) x2\n        (\n            f (i1+1+1) x3\n            z\n        )\n)\n</code></pre>\n\n<p>So now we know what <code>foldr eval (const z) [x1, x2, x3]</code> maps to, but there is a final fuction application: the <code>0</code> at the end.</p>\n\n<p>So that means that we make a call to the above defined lambda-expression with <code>0</code>, so this collapses to:</p>\n\n<pre><code>\\i1 -&gt; (\n    f i1 x1\n    (\n        f (i1+1) x2\n        (\n            f (i1+1+1) x3\n            z\n        )\n) 0\n</code></pre>\n\n<p>and thus:</p>\n\n<pre><code>(\n    f 0 x1\n    (\n        f (0+1) x2\n        (\n            f (0+1+1) x3\n            z\n        )\n)\n</code></pre>\n\n<p>or in a compact form:</p>\n\n<pre><code>(f 0 x1 (f 1 x2 (f 2 x3 z)))\n</code></pre>\n\n<p>So we managed to inject indices in our solution.</p>\n\n<p>Now the <code>seq</code> of course has a function: it will prevent making huge (left-recursive) expression trees for the index, instead of <code>((((1+1)+1)+1)+1)+1</code>, it will ensure that each time we increment it, it is immediately evaluated, so that we will never obtain <code>1+1+1</code>, but always <code>2+1</code>, and immidiately resolve it to <code>3</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1538239422, "last_edit_date": 1538239422, "creation_date": 1538185983, "answer_id": 52564390, "question_id": 52562752, "link": "https://stackoverflow.com/questions/52562752/how-does-indexed-foldr-work-operationally/52564390#52564390", "title": "How does indexed foldr work operationally?", "body": "<p>If <sup>(as indeed it is)</sup></p>\n\n<pre><code>foldr c n (x:xs) = c x (foldr c n xs)  :: t\n\nc x r = ...    -- r: mnemonic: recursive result\n\nc x r :: t , r :: t , n :: t          -- same t\n</code></pre>\n\n<p>then <a href=\"https://stackoverflow.com/questions/235148/implement-zip-using-foldr/26285107#26285107\">surely</a> <sup>(by eta-expansion)</sup></p>\n\n<pre><code>foldr c n (x:xs) i = c x (foldr c n xs) i  :: t\n\nc x r i = ...   -- c = (\\ x r i -&gt; ... )\n\nc x r i :: t , r i :: t , n i :: t        -- same t\n</code></pre>\n\n<p>and so we can have</p>\n\n<pre><code>ifoldr f n (x:xs) = foldr c n (x:xs) i = c x (foldr c n xs) i    :: t\n                                       = f i x (foldr c n xs i')  :: t\n\nc x r i = f i x (r i') \n\nc x r i :: t , r i :: t , n i :: t , f i x :: t -&gt; t\n</code></pre>\n\n<p>and that's exactly what you got there.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 52563319, "answer_count": 2, "score": 4, "last_activity_date": 1538239422, "creation_date": 1538169375, "question_id": 52562752, "link": "https://stackoverflow.com/questions/52562752/how-does-indexed-foldr-work-operationally", "title": "How does indexed foldr work operationally?", "body": "<p>I'm having trouble comprehending the definition:</p>\n\n<pre><code>ifoldr :: Foldable f =&gt; (Int -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; f a -&gt; b\nifoldr f z xs = foldr (\\ x g i -&gt; i `seq` f i x (g (i+1))) (const z) xs 0\n</code></pre>\n\n<p>In particular, it seems to avoid space leaks by avoiding <code>zip [1..]</code> and at the same time it seems to derive a new fold \"step function\" that is given additional argument to front, but this argument is passed last in <code>\\ x g i</code>!</p>\n\n<p>Is this equivalent to <code>f' x (foldr f' z xs)</code> for some definition <code>f' = _unknown_ f</code> with retaining non-strictness properties?</p>\n"}, {"tags": ["haskell", "rounding"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1538161066, "post_id": 52561190, "comment_id": 92061018, "body": "What about <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:floor\" rel=\"nofollow noreferrer\">floor</a> or <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:ceiling\" rel=\"nofollow noreferrer\"><code>ceiling</code></a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1538164984, "post_id": 52561190, "comment_id": 92062538, "body": "What is &quot;rounding rounding&quot;?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1538165014, "post_id": 52561190, "comment_id": 92062545, "body": "Notice Haskell&#39;s <code>round</code> function is round-to-even (aka Banker&#39;s Rounding)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1562596520, "post_id": 52561190, "comment_id": 100414667, "body": "What does &quot;count the numbers of a number&quot; mean? What does any of this have to do with the number of digits?"}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1538164913, "post_id": 52561479, "comment_id": 92062517, "body": "<code>ceiling</code> is not a keyword, just a function."}], "tags": [], "owner": {"reputation": 814, "user_id": 2352665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b7eaa37741dcbba9e1e8afcec8ef49b2?s=128&d=identicon&r=PG", "display_name": "Alejandro Caro", "link": "https://stackoverflow.com/users/2352665/alejandro-caro"}, "is_accepted": false, "score": 0, "last_activity_date": 1562552249, "last_edit_date": 1562552249, "creation_date": 1538162379, "answer_id": 52561479, "question_id": 52561190, "link": "https://stackoverflow.com/questions/52561190/rounding-the-largest-integer-in-haskell/52561479#52561479", "title": "Rounding the largest integer in Haskell", "body": "<p>One of the ways is to use ceiling function.\nThus:</p>\n\n<pre><code>round_larg :: Float -&gt; Int\nround_larg a = ceiling (a)\n</code></pre>\n"}], "owner": {"reputation": 814, "user_id": 2352665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b7eaa37741dcbba9e1e8afcec8ef49b2?s=128&d=identicon&r=PG", "display_name": "Alejandro Caro", "link": "https://stackoverflow.com/users/2352665/alejandro-caro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1562553183, "creation_date": 1538160867, "last_edit_date": 1562553183, "question_id": 52561190, "link": "https://stackoverflow.com/questions/52561190/rounding-the-largest-integer-in-haskell", "title": "Rounding the largest integer in Haskell", "body": "<p>I have this function that tries to count the numbers of a number entered.</p>\n\n<pre><code>round_larg :: Float -&gt; Int\nround_larg a = (round(round(a)+0.5))\n</code></pre>\n\n<p>The funtion have to round to the largest of a number gives the number of digits that number has.</p>\n\n<p>Then it occurred to me to do rounding rounding but I do not know how to do this in haskell.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 479, "user_id": 1050182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/bfgX0.jpg?s=128&g=1", "display_name": "Yuan Wang", "link": "https://stackoverflow.com/users/1050182/yuan-wang"}, "edited": false, "score": 0, "creation_date": 1538161616, "post_id": 52561155, "comment_id": 92061223, "body": "What is your <code>stack --version</code> output?, and what is your package.yaml? I did stack build stack-run using 1.7.1 on macos, it worked"}, {"owner": {"reputation": 5095, "user_id": 2022518, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9366c006da5aca3fa94f7be13677042d?s=128&d=identicon&r=PG", "display_name": "LetMeSOThat4U", "link": "https://stackoverflow.com/users/2022518/letmesothat4u"}, "reply_to_user": {"reputation": 479, "user_id": 1050182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/bfgX0.jpg?s=128&g=1", "display_name": "Yuan Wang", "link": "https://stackoverflow.com/users/1050182/yuan-wang"}, "edited": false, "score": 0, "creation_date": 1538172709, "post_id": 52561155, "comment_id": 92064901, "body": "@YuanWang added the info"}, {"owner": {"reputation": 479, "user_id": 1050182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/bfgX0.jpg?s=128&g=1", "display_name": "Yuan Wang", "link": "https://stackoverflow.com/users/1050182/yuan-wang"}, "edited": false, "score": 0, "creation_date": 1538187842, "post_id": 52561155, "comment_id": 92067211, "body": "It seems you haven\u2019t changed the package.yaml. What about stack.yaml or cabal file?  Which libraries you intent to use?"}], "answers": [{"comments": [{"owner": {"reputation": 5095, "user_id": 2022518, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9366c006da5aca3fa94f7be13677042d?s=128&d=identicon&r=PG", "display_name": "LetMeSOThat4U", "link": "https://stackoverflow.com/users/2022518/letmesothat4u"}, "edited": false, "score": 2, "creation_date": 1538588610, "post_id": 52573173, "comment_id": 92198902, "body": "Just great... Haskelly extension page requires me explicitly to install <code>stack-run</code>: <a href=\"https://marketplace.visualstudio.com/items?itemName=UCL.haskelly\" rel=\"nofollow noreferrer\">marketplace.visualstudio.com/items?itemName=UCL.haskelly</a> I&#39;m not even sure at this point if I really need it for that extension to work."}, {"owner": {"reputation": 2645, "user_id": 4132182, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-59916dy2-H4/AAAAAAAAAAI/AAAAAAAAABY/YMB0casZvfc/photo.jpg?sz=128", "display_name": "ZenVentzi", "link": "https://stackoverflow.com/users/4132182/zenventzi"}, "reply_to_user": {"reputation": 5095, "user_id": 2022518, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9366c006da5aca3fa94f7be13677042d?s=128&d=identicon&r=PG", "display_name": "LetMeSOThat4U", "link": "https://stackoverflow.com/users/2022518/letmesothat4u"}, "edited": false, "score": 0, "creation_date": 1567100535, "post_id": 52573173, "comment_id": 101872596, "body": "@LetMeSOThat4U coming from Haskelly steps to here. Any updates? Did you find a soltution?"}], "tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": true, "score": 2, "last_activity_date": 1538261348, "creation_date": 1538261348, "answer_id": 52573173, "question_id": 52561155, "link": "https://stackoverflow.com/questions/52561155/cannot-install-stack-run/52573173#52573173", "title": "Cannot install stack-run", "body": "<p>The main problem is indicated here:</p>\n\n<pre><code>    Could not find module \u2018Distribution.PackageDescription.Parse\u2019\n</code></pre>\n\n<p><code>stack-run</code> has not been updated to support being built against modern versions of <code>Cabal</code>. That module was removed as of Cabal 2.2.</p>\n\n<p>There is an open PR on the <code>stack-run</code> repo which addresses this issue:</p>\n\n<p><a href=\"https://github.com/yamadapc/stack-run/pull/15/files#diff-f8f3412da88cd4806f23d59fe59ebc3bR19\" rel=\"nofollow noreferrer\">https://github.com/yamadapc/stack-run/pull/15/files#diff-f8f3412da88cd4806f23d59fe59ebc3bR19</a></p>\n"}], "owner": {"reputation": 5095, "user_id": 2022518, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9366c006da5aca3fa94f7be13677042d?s=128&d=identicon&r=PG", "display_name": "LetMeSOThat4U", "link": "https://stackoverflow.com/users/2022518/letmesothat4u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 603, "favorite_count": 0, "accepted_answer_id": 52573173, "answer_count": 1, "score": 1, "last_activity_date": 1538261348, "creation_date": 1538160663, "last_edit_date": 1538172629, "question_id": 52561155, "link": "https://stackoverflow.com/questions/52561155/cannot-install-stack-run", "title": "Cannot install stack-run", "body": "<p>Per instructions on page <a href=\"https://marketplace.visualstudio.com/items?itemName=UCL.haskelly\" rel=\"nofollow noreferrer\">https://marketplace.visualstudio.com/items?itemName=UCL.haskelly</a> , I'm  trying:</p>\n\n<pre><code>% stack build stack-run\nstack-run-0.1.1.4: configure\nstack-run-0.1.1.4: build\n\n--  While building custom Setup.hs for package stack-run-0.1.1.4 using:\n      /home/mark/.stack/setup-exe-cache/x86_64-linux/Cabal-simple_mPHDZzAJ_2.2.0.1_ghc-8.4.3 --builddir=.stack-work/dist/x86_64-linux/Cabal-2.2.0.1 build --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /home/mark/haskell/hl1/.stack-work/logs/stack-run-0.1.1.4.log\n\n    Configuring stack-run-0.1.1.4...\n    Preprocessing executable 'stack-run' for stack-run-0.1.1.4..\n    Building executable 'stack-run' for stack-run-0.1.1.4..\n\n    /tmp/stack2483/stack-run-0.1.1.4/unix/System/Console/Questioner.hs:4:14: warning:\n        -XOverlappingInstances is deprecated: instead use per-instance pragmas OVERLAPPING/OVERLAPPABLE/OVERLAPS\n      |\n    4 | {-# LANGUAGE OverlappingInstances  #-}\n      |              ^^^^^^^^^^^^^^^^^^^^\n    [1 of 5] Compiling System.Console.Questioner.Autocomplete ( unix/System/Console/Questioner/Autocomplete.hs, .stack-work/dist/x86_64-linux/Cabal-2.2.0.1/build/stack-run/stack-run-tmp/System/Console/Questioner/Autocomplete.o )\n    [2 of 5] Compiling System.Console.Questioner.Util ( unix/System/Console/Questioner/Util.hs, .stack-work/dist/x86_64-linux/Cabal-2.2.0.1/build/stack-run/stack-run-tmp/System/Console/Questioner/Util.o )\n    [3 of 5] Compiling System.Console.Questioner.ProgressIndicators ( unix/System/Console/Questioner/ProgressIndicators.hs, .stack-work/dist/x86_64-linux/Cabal-2.2.0.1/build/stack-run/stack-run-tmp/System/Console/Questioner/ProgressIndicators.o )\n    [4 of 5] Compiling System.Console.Questioner ( unix/System/Console/Questioner.hs, .stack-work/dist/x86_64-linux/Cabal-2.2.0.1/build/stack-run/stack-run-tmp/System/Console/Questioner.o )\n    [5 of 5] Compiling Main             ( src/Main.hs, .stack-work/dist/x86_64-linux/Cabal-2.2.0.1/build/stack-run/stack-run-tmp/Main.o )\n\n    /tmp/stack2483/stack-run-0.1.1.4/src/Main.hs:18:1: error:\n        Could not find module \u2018Distribution.PackageDescription.Parse\u2019\n        Perhaps you meant\n          Distribution.PackageDescription.Parsec (from Cabal-2.2.0.1)\n          Distribution.PackageDescription.Check (from Cabal-2.2.0.1)\n          Distribution.PackageDescription.Quirks (from Cabal-2.2.0.1)\n        Use -v to see a list of the files searched for.\n       |\n    18 | import           Distribution.PackageDescription.Parse\n       | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>OS: Debian 9 x64</p>\n\n<p>I just installed <code>stack</code> today and created new project.</p>\n\n<p><code>stack</code> complained about some packages, so per Recommended actions I added following to <code>stack.yaml</code>:</p>\n\n<pre><code>extra-deps: [conduit-1.2.13.1, conduit-extra-1.1.17, resourcet-1.1.11, streaming-commons-0.1.19]\n</code></pre>\n\n<p>Stack version:</p>\n\n<pre><code>% stack --version\nVersion 1.7.1, Git revision 681c800873816c022739ca7ed14755e85a579565 (5807 commits) x86_64 hpack-0.28.2\n\n\n\n\n\nname:                hl1\nversion:             0.1.0.0\ngithub:              \"githubuser/hl1\"\nlicense:             BSD3\nauthor:              \"Author name here\"\nmaintainer:          \"example@example.com\"\ncopyright:           \"2018 Author name here\"\n\nextra-source-files:\n- README.md\n- ChangeLog.md\n\n# Metadata used when publishing your package\n# synopsis:            Short description of your package\n# category:            Web\n\n# To avoid duplicated efforts in documentation and dealing with the\n# complications of embedding Haddock markup inside cabal files, it is\n# common to point users to the README.md file.\ndescription:         Please see the README on GitHub at &lt;https://github.com/githubuser/hl1#readme&gt;\n\ndependencies:\n- base &gt;= 4.7 &amp;&amp; &lt; 5\n\nlibrary:\n  source-dirs: src\n\nexecutables:\n  hl1-exe:\n    main:                Main.hs\n    source-dirs:         app\n    ghc-options:\n    - -threaded\n    - -rtsopts\n    - -with-rtsopts=-N\n    dependencies:\n    - hl1\n\ntests:\n  hl1-test:\n    main:                Spec.hs\n    source-dirs:         test\n    ghc-options:\n    - -threaded\n    - -rtsopts\n    - -with-rtsopts=-N\n    dependencies:\n    - hl1\n</code></pre>\n"}, {"tags": ["haskell", "minimax"], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 8843385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36b066e6fbd3997a82d7ea39d665603?s=128&d=identicon&r=PG&f=1", "display_name": "ramon abacherli", "link": "https://stackoverflow.com/users/8843385/ramon-abacherli"}, "is_accepted": false, "score": 1, "last_activity_date": 1538158010, "creation_date": 1538158010, "answer_id": 52560656, "question_id": 52560126, "link": "https://stackoverflow.com/questions/52560126/how-to-create-function-minimax-in-haskell/52560656#52560656", "title": "How to create function minimax in Haskell?", "body": "<p>I actually found another post discussing the same problem I have here: <a href=\"https://stackoverflow.com/questions/39798342/haskell-recursive-minimax-tree\">Haskell Recursive Minimax Tree</a> </p>\n\n<p>The answer was the following: </p>\n\n<pre><code>minimax :: Player -&gt; Rose Board -&gt; Rose Int\nminimax p (r :&gt; [])   | hasWinner r == Just P1 = 1    :&gt; []\n                      | hasWinner r == Just P2 = (-1) :&gt; []\n                      | otherwise              = 0    :&gt; []\nminimax P1 (r :&gt; rs) = maximum (map root xs) :&gt; xs\n    where xs = map (minimax (nextPlayer P1)) rs\n\nminimax P2 (r :&gt; rs) = minimum (map root xs) :&gt; xs\n    where xs = map (minimax (nextPlayer P2)) rs\n</code></pre>\n\n<p>I hope at least this could help someone else in the future.\nThe functions that were used in this answer are: </p>\n\n<pre><code>root :: Rose a -&gt; a\nroot (a :&gt; bs) = a \n\nnextPlayer :: Player -&gt; Player\nnextPlayer P1 = P2\nnextPlayer P2 = P1\n\nhasWinner :: Board -&gt; Maybe Player\n\nminimum :: Ord a =&gt; [a] -&gt; a\nmaximum :: Ord a =&gt; [a] -&gt; a\n</code></pre>\n\n<p>cheers!</p>\n"}], "owner": {"reputation": 175, "user_id": 8843385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36b066e6fbd3997a82d7ea39d665603?s=128&d=identicon&r=PG&f=1", "display_name": "ramon abacherli", "link": "https://stackoverflow.com/users/8843385/ramon-abacherli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1476, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1538158010, "creation_date": 1538155452, "question_id": 52560126, "link": "https://stackoverflow.com/questions/52560126/how-to-create-function-minimax-in-haskell", "title": "How to create function minimax in Haskell?", "body": "<p>I have been struggeling with creating a minimax function in Haskell and couldn't find any great alternatives on SO, hence why I am asking:</p>\n\n<p>I want to create the following function:</p>\n\n<pre><code>minimax :: Player -&gt; Rose Board -&gt; Rose Int\n</code></pre>\n\n<p>I want to get a RoseTree of Integers, those have to be either 1, 0 or -1 (a move can either be good, neutral or bad for the player that has the turn.</p>\n\n<pre><code>(root :&gt; leaves)               -- constructor of a Rose\n(board :&gt; boards)              -- constructor of a Rose Board\n(Int :&gt; Ints)                  -- constructor of a Rose Int\n</code></pre>\n\n<p>I have written the function hasWinner, minimum' and maximum' to make things easier:</p>\n\n<pre><code>hasWinner :: Board -&gt; Maybe Player\n\nminimum' :: [Int] -&gt; Int\nminimum' (x:xs) | x == -1 = -1\n                | otherwise = minimum' xs\n\nmaximum' :: [Int] -&gt; Int\nmaximum' (x:xs) | x == 1 = 1\n                | otherwise = maximum' xs\n</code></pre>\n\n<p>Further I think my base case is the following: </p>\n\n<pre><code>minimax player (board :&gt; []) = (0 :&gt; [])\n</code></pre>\n\n<p>At the moment this is where I am at:</p>\n\n<pre><code>minimax player (board :&gt; boards)| maximum' [(isWinner player b (minimax' player)) | (b :&gt; bs) &lt;- boards] == 1 = _\n                                | minimum' [(isWinner player b (minimax' player)) | (b :&gt; bs) &lt;- boards] == -1 = _\n                                | otherwise = _\n                 where   minimax' player     | player == P1 = P2\n                                             | otherwise = P1\n                         isWinner p1 board p2    | hasWinner board == Just p1 = 1\n                                                 | hasWinner board == Just p2 = -1\n                                                 | otherwise = 0\n</code></pre>\n\n<p>I just can't seem to figure out what should happen when I found a board that is either won, lost or has no consequences. So how would I call the minimax function again with the right Rose Board?</p>\n\n<p>Any help is greatly appreciated!</p>\n\n<p>Ramon</p>\n"}, {"tags": ["haskell", "monads", "state-monad"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1538145911, "post_id": 52557630, "comment_id": 92054056, "body": "Well proving something somehow will mean (formal) deduction (or by contradiction) of another mathematical technique. Without it, you can generate a lot of <i>empirical</i> evidence, but that is not a &quot;proof&quot;. There are however some automated proof systems (&quot;code contracts&quot;) that might (or might not) do the trick."}], "answers": [{"tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": false, "score": 4, "last_activity_date": 1538145788, "creation_date": 1538145788, "answer_id": 52557714, "question_id": 52557630, "link": "https://stackoverflow.com/questions/52557630/haskell-how-to-provetest-whether-a-self-defined-monad-instance-follow-monad-l/52557714#52557714", "title": "Haskell: How to prove(test) whether a self-defined Monad instance follow Monad laws?", "body": "<p>I suppose you know what Monad laws are, but I'll <a href=\"https://wiki.haskell.org/Monad_laws\" rel=\"nofollow noreferrer\">link them</a> for the sake of completeness.</p>\n\n<p>Since you explicitly mentioned testing as opposed to formal proving, you can use one of the automated testing frameworks for Haskell, e.g. <a href=\"http://hackage.haskell.org/package/QuickCheck\" rel=\"nofollow noreferrer\">QuickCheck</a> or <a href=\"https://hspec.github.io/\" rel=\"nofollow noreferrer\">Hspec</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1538147970, "post_id": 52557785, "comment_id": 92055213, "body": "Sure, but that&#39;s not a proof, that&#39;s just empirical evidence"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 4, "creation_date": 1538150791, "post_id": 52557785, "comment_id": 92056691, "body": "@Cubic The OP uses both terms (prove and test), but appears to be interested in testing, not proving."}, {"owner": {"reputation": 101, "user_id": 10429975, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D-E2-UHsaOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWNBrMIBj8VPPmGT-WHLnDQWGC0Wg/mo/photo.jpg?sz=128", "display_name": "Yellowsgg", "link": "https://stackoverflow.com/users/10429975/yellowsgg"}, "edited": false, "score": 0, "creation_date": 1538315850, "post_id": 52557785, "comment_id": 92092151, "body": "Sorry for asking for so details, but how can I make this work?"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 101, "user_id": 10429975, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D-E2-UHsaOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWNBrMIBj8VPPmGT-WHLnDQWGC0Wg/mo/photo.jpg?sz=128", "display_name": "Yellowsgg", "link": "https://stackoverflow.com/users/10429975/yellowsgg"}, "edited": false, "score": 0, "creation_date": 1538321236, "post_id": 52557785, "comment_id": 92093640, "body": "@Yellowsgg The code posted here shows three inlined properties, written in <a href=\"http://blog.ploeh.dk/2018/05/07/inlined-hunit-test-lists\" rel=\"nofollow noreferrer\">a style I&#39;ve described in an article</a>. For a general overview of my approach to testing in Haskell, you could refer to my article <a href=\"http://blog.ploeh.dk/2018/07/09/typing-and-testing-problem-23\" rel=\"nofollow noreferrer\">Typing and testing problem 23</a>."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 6, "last_activity_date": 1538146021, "creation_date": 1538146021, "answer_id": 52557785, "question_id": 52557630, "link": "https://stackoverflow.com/questions/52557630/haskell-how-to-provetest-whether-a-self-defined-monad-instance-follow-monad-l/52557785#52557785", "title": "Haskell: How to prove(test) whether a self-defined Monad instance follow Monad laws?", "body": "<p>FWIW, here's a set of QuickCheck properties I recently wrote that tests the Monad laws for a Maybe implementation derived from its F-Algebra:</p>\n\n<pre><code>testProperty \"Monad left identity law\" $ do\n  a :: String &lt;- arbitrary\n  k :: String -&gt; MaybeFix Integer &lt;- (fromMaybe .) &lt;$&gt; arbitrary\n\n  let left = return a &gt;&gt;= k\n  let right = k a\n\n  return $ left == right\n,\ntestProperty \"Monad right identity law\" $ do\n  m :: MaybeFix Integer &lt;- fromMaybe &lt;$&gt; arbitrary\n\n  let left = m &gt;&gt;= return\n  let right = m\n\n  return $ left == right\n,\ntestProperty \"Monad associativity law\" $ do\n  m :: MaybeFix String &lt;- fromMaybe &lt;$&gt; arbitrary\n  k :: String -&gt; MaybeFix Integer &lt;- (fromMaybe .) &lt;$&gt; arbitrary\n  h :: Integer -&gt; MaybeFix Ordering &lt;- (fromMaybe .) &lt;$&gt; arbitrary\n\n  let left = m &gt;&gt;= (\\x -&gt; k x &gt;&gt;= h)\n  let right = (m &gt;&gt;= k) &gt;&gt;= h\n\n  return $ left == right\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": false, "score": 0, "last_activity_date": 1538262276, "creation_date": 1538262276, "answer_id": 52573253, "question_id": 52557630, "link": "https://stackoverflow.com/questions/52557630/haskell-how-to-provetest-whether-a-self-defined-monad-instance-follow-monad-l/52573253#52573253", "title": "Haskell: How to prove(test) whether a self-defined Monad instance follow Monad laws?", "body": "<p>This may be a bit over the top, but you can try <a href=\"https://github.com/antalsz/hs-to-coq\" rel=\"nofollow noreferrer\">hs-to-coq</a>, which might be able to convert your hs code to Coq code, which you can then prove things about using <a href=\"https://coq.inria.fr/\" rel=\"nofollow noreferrer\">Coq (a Proof Assistant)</a>.</p>\n\n<p>For an example of proving monad laws using Coq (though this was not using hs-to-coq), see:\n<a href=\"https://github.com/jwiegley/coq-pipes#laws-proven\" rel=\"nofollow noreferrer\">https://github.com/jwiegley/coq-pipes#laws-proven</a></p>\n"}], "owner": {"reputation": 101, "user_id": 10429975, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D-E2-UHsaOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWNBrMIBj8VPPmGT-WHLnDQWGC0Wg/mo/photo.jpg?sz=128", "display_name": "Yellowsgg", "link": "https://stackoverflow.com/users/10429975/yellowsgg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1538262276, "creation_date": 1538145475, "last_edit_date": 1538146063, "question_id": 52557630, "link": "https://stackoverflow.com/questions/52557630/haskell-how-to-provetest-whether-a-self-defined-monad-instance-follow-monad-l", "title": "Haskell: How to prove(test) whether a self-defined Monad instance follow Monad laws?", "body": "<p>Not using formal deduction, how can I test whether a self-defined <code>Monad</code> instance follows the Monad laws?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538151022, "post_id": 52557535, "comment_id": 92056802, "body": "It&#39;s not clear what <code>addb</code> is supposed to be doing. Neither 75 + 98 or 57 + 89 is either 169 or 961."}, {"owner": {"reputation": 53, "user_id": 10429855, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W_igRWf4x3s/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4trEcL4TtM1k3bD1zAi529BmJoQ/mo/photo.jpg?sz=128", "display_name": "Thierno Diallo", "link": "https://stackoverflow.com/users/10429855/thierno-diallo"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538151396, "post_id": 52557535, "comment_id": 92056987, "body": "@chepner I\u2019m sorry for the lack of clarity and my bad math. addb is just taking the two lists provided, reverse them, and then have it them changed into an int. The two ints are added together and the total is put into a list digit by digit in reverse."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1538151700, "post_id": 52557535, "comment_id": 92057167, "body": "I&#39;d say the intent of the assignment (given the <code>Digit</code> argument, which looks like a carry) is to perform the addition <i>without</i> first converting to and from an <code>Int</code>. For example, it looks like <code>addb [5, 7] [8, 9] 0</code> should return a list built using a recursive call, like <code>3 : addb [7] [9] 1</code>. I leave it as an exercise to figure out where the <code>3</code> and the argument <code>1</code> come from , as well as what happened to <code>5</code> and <code>8</code> from the original inputs."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538161092, "post_id": 52560399, "comment_id": 92061036, "body": "There might a performance hit, but you can get away with a single base case <code>addb [] [] c = c</code>, two trivial recursive cases <code>addb xs [] c = addb xs [0] c</code> and <code>addb [] ys c = addb [0] ys c</code>, and the same main recursive case."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538164572, "post_id": 52560399, "comment_id": 92062381, "body": "Yes, perhaps.  I wish there was a way to signal commutative property to reduce the cases by half."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": -1, "last_activity_date": 1538156792, "creation_date": 1538156792, "answer_id": 52560399, "question_id": 52557535, "link": "https://stackoverflow.com/questions/52557535/haskell-recursion-assignment/52560399#52560399", "title": "Haskell Recursion assignment", "body": "<p>you're implementing decimal full adder</p>\n\n<pre><code>Prelude&gt; let addb [] ys 0 = ys\nPrelude|     addb xs [] 0 = xs\nPrelude|     addb [] ys 1 = addb ys [1] 0\nPrelude|     addb xs [] 1 = addb xs [1] 0\nPrelude|     addb (x:xs) (y:ys) b = s: addb xs ys r\nPrelude|                where (r,s) = divMod (x+y+b) 10\nPrelude|\n\nPrelude&gt; addb [5,7] [8,9] 0\n[3,7,1]\n</code></pre>\n\n<p>not sure it can be simplified further</p>\n"}], "owner": {"reputation": 53, "user_id": 10429855, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W_igRWf4x3s/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4trEcL4TtM1k3bD1zAi529BmJoQ/mo/photo.jpg?sz=128", "display_name": "Thierno Diallo", "link": "https://stackoverflow.com/users/10429855/thierno-diallo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 52560399, "answer_count": 1, "score": -3, "last_activity_date": 1538156792, "creation_date": 1538145087, "last_edit_date": 1538151601, "question_id": 52557535, "link": "https://stackoverflow.com/questions/52557535/haskell-recursion-assignment", "title": "Haskell Recursion assignment", "body": "<p>I'm currently working on an assignment that focuses on recursive programming. I'm having trouble with two specific functions that use unique types. Number is a reverse list of a number and digit is the digit from Number.</p>\n\n<pre><code>Example of Number = [7,5] 57\nExample of Digit [1]\n</code></pre>\n\n<p>addb is taking tge two lists provided, reverse them, and then have it changed into an int. The two ints are added together and the total is put into a list digit by digit in reverse.\nExample: </p>\n\n<pre><code>&gt;&gt;&gt; addb [5,7] [8,9] 0\n[3,7,1] \n</code></pre>\n\n<p>convertNumList is meant to take a number and create a Number list.\nExample:</p>\n\n<pre><code>&gt;&gt;&gt; convertNumList 75\n[5,7]\n</code></pre>\n\n<p>I was able to find a solution for convertNumList but it's not a recursive one. And my ideas for addb is along the same line for addb but im having trouble on how I should add the two lists recursively.  Apologies on my formatting this is my first time posting a question.</p>\n\n<pre><code>addb :: Number -&gt; Number -&gt; Digit -&gt; Number\n-- Fill in your code here\naddb xs ys c\n= [0,0,1]\n\nconvertNumList :: Int -&gt; Number\nconverNumList 0 = []\nconvertNumList n =[n `mod` 10 ,n`div`10]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1538141877, "post_id": 52556531, "comment_id": 92051737, "body": "Hypothesis: you reach for <code>break</code> because you are used to other languages where doing real parsing into a proper data type is a pain. But Haskell makes defining custom-tailored data types a single-line pleasantry, and with parser combinator libraries, the programmer burden of proper parsing is very light -- lighter than the burden of consuming the unstructured types you get from <code>break</code> and friends. Consider adjusting your habits accordingly."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1538146322, "post_id": 52557002, "comment_id": 92054289, "body": "And if you compare the result of <code>breakAfterDash &quot;look ma, no dash!&quot;</code> (wrong answer, and throws an exception that can&#39;t be caught in pure code) to the result of <code>readP_to_S parseOnDash &quot;look ma, no dash!&quot;</code> (error reported by returning zero results) you&#39;ll start to see why <code>break</code> maybe isn&#39;t so convenient after all..."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 1, "last_activity_date": 1538144115, "last_edit_date": 1538144115, "creation_date": 1538143161, "answer_id": 52557002, "question_id": 52556531, "link": "https://stackoverflow.com/questions/52556531/looking-for-a-function-like-break-that-include-the-last-element/52557002#52557002", "title": "looking for a function like break that include the last element", "body": "<p>Not as elegant as anything Daniel Wagner has in mind, but something like this might do in a pinch:</p>\n\n<pre><code>import Data.Bifunctor\n\nbreakAfterDash :: String -&gt; (String, String)\nbreakAfterDash x = bimap (++ \"-\") tail $ break (== '-') x\n</code></pre>\n\n<p>Demo:</p>\n\n<pre><code>&gt; breakAfterDash \"0@workspace_command-7a86cb8b-0987-fe40-61f2-42b0f6fc3e1c\"\n(\"0@workspace_command-\",\"7a86cb8b-0987-fe40-61f2-42b0f6fc3e1c\")\n</code></pre>\n\n<hr>\n\n<p>But then, Daniel Wagner does have a point, so alternatively, something like might get you started on the built-in parser combinator library:</p>\n\n<pre><code>import Text.ParserCombinators.ReadP\n\nparseOnDash :: ReadP String\nparseOnDash = (++) &lt;$&gt; munch (/= '-') &lt;*&gt; string \"-\"\n</code></pre>\n\n<p>This is a parser that parses any character that's <em>not</em> <code>'-'</code>, then it 'parses' the string <code>\"-\"</code>.</p>\n\n<p>Using it might be as simple as this:</p>\n\n<pre><code>&gt; readP_to_S parseOnDash \"0@workspace_command-7a86cb8b-0987-fe40-61f2-42b0f6fc3e1c\"\n[(\"0@workspace_command-\",\"7a86cb8b-0987-fe40-61f2-42b0f6fc3e1c\")]\n</code></pre>\n\n<p>Notice that <code>readP_to_S</code> returns a list of results, because parsing could fail, or return more than a single match. It's up to you to determine how you want to deal with ambiguous results.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1558118929, "last_edit_date": 1558118929, "creation_date": 1538147821, "answer_id": 52558307, "question_id": 52556531, "link": "https://stackoverflow.com/questions/52556531/looking-for-a-function-like-break-that-include-the-last-element/52558307#52558307", "title": "looking for a function like break that include the last element", "body": "<p>Here is an example of the kind of approach I advocate in my comment above, to show how lightweight it can be. I'll use <a href=\"http://hackage.haskell.org/package/regex-applicative\" rel=\"nofollow noreferrer\">regex-applicative</a> for my parser combinators; a similar approach (with some tweaks) will work with other combinator libraries. I'll also use the <a href=\"http://hackage.haskell.org/package/uuid\" rel=\"nofollow noreferrer\">uuid</a> package. So, the boilerplate:</p>\n\n<pre><code>import Data.List\nimport Data.UUID\nimport Text.Regex.Applicative\nimport Text.Regex.Applicative.Common\n</code></pre>\n\n<p>A custom-tailored type (I picked a name without really knowing what these are for):</p>\n\n<pre><code>data IndexedCmd = IndexedCmd\n    { index :: Int\n    , command :: String\n    , uuid :: UUID\n    } deriving (Eq, Ord, Read, Show)\n</code></pre>\n\n<p>If we can get our hands on one of these, it offers a lot of features that your <code>break</code> version doesn't, and didn't require much code to cook up. Here's how we build one. We need to build a parser for <code>UUID</code>s first:</p>\n\n<pre><code>hexDigitAsChar :: RE Char Char\nhexDigitAsChar = psym $ \\c -&gt; or\n    [ '0' &lt;= c &amp;&amp; c &lt;= '9'\n    , 'a' &lt;= c &amp;&amp; c &lt;= 'f'\n    , 'A' &lt;= c &amp;&amp; c &lt;= 'F'\n    ]\n\nparseUUID :: RE Char UUID\nparseUUID = id\n    . fmap read\n    . sequenceA\n    . intercalate [sym '-']\n    $ [replicate n hexDigitAsChar | n &lt;- [8,4,4,4,12]]\n</code></pre>\n\n<p>Once we have that in place, our parser for <code>IndexedCmd</code>s is short and sweet:</p>\n\n<pre><code>parseIndexedCmd :: RE Char IndexedCmd\nparseIndexedCmd = pure IndexedCmd\n    &lt;*&gt; decimal &lt;* sym '@'\n    &lt;*&gt; many anySym &lt;* sym '-'\n    &lt;*&gt; parseUUID\n</code></pre>\n\n<p>That's the whole development. It's a bit longer than the other answers, but it also does a lot more, including a lot of work that you would probably want to do anyway even if you had the exact variant of <code>break</code> that you want. For example, it extracts a structured representation of the <code>0@workspace_command-</code> prefix; and it checks that the UUID is in the right format, a task that is so annoying to do with bare <code>Data.List</code> functions that I would probably tire of writing the code and skip it entirely if I were doing this without parser combinators.</p>\n\n<p>We can now use <code>match</code> to parse a single string if we want:</p>\n\n<pre><code>&gt; match parseIndexedCmd \"0@workspace_command-7a86cb8b-0987-fe40-61f2-42b0f6fc3e1c\"\nJust (IndexedCmd {index = 0, command = \"workspace_command\", uuid = 7a86cb8b-0987-fe40-61f2-42b0f6fc3e1c})\n</code></pre>\n\n<p>As a side bonus, we can now even handle commands which have dashes in them, an effect that would be very tedious indeed to replicate using <code>break</code> as our primitive:</p>\n\n<pre><code>&gt; match parseIndexedCmd \"0@workspace-command-7a86cb8b-0987-fe40-61f2-42b0f6fc3e1c\"\nJust (IndexedCmd {index = 0, command = \"workspace-command\", uuid = 7a86cb8b-0987-fe40-61f2-42b0f6fc3e1c})\n</code></pre>\n\n<p>We can also continue our development and embed this parser in a larger one for entire files full of these strings or as part of some other structured file format.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 52558307, "answer_count": 2, "score": 1, "last_activity_date": 1558118929, "creation_date": 1538141492, "last_edit_date": 1538143182, "question_id": 52556531, "link": "https://stackoverflow.com/questions/52556531/looking-for-a-function-like-break-that-include-the-last-element", "title": "looking for a function like break that include the last element", "body": "<p>Something that should be easy but somehow I don't find how to do it... let's have the following string: <code>\"0@workspace_command-7a86cb8b-0987-fe40-61f2-42b0f6fc3e1c\"</code></p>\n\n<p>the section <code>0@workspace_command</code> can be something else but will never contain a '-',  I want a function that returns the following result : <code>[\"0@workspace_command-\",\"7a86cb8b-0987-fe40-61f2-42b0f6fc3e1c\"]</code> , all the functions that I have found give me the following result : <code>[\"0@workspace_command\",\"-7a86cb8b-0987-fe40-61f2-42b0f6fc3e1c\"]</code>...</p>\n"}, {"tags": ["haskell", "haskell-lens", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1538140155, "post_id": 52555564, "comment_id": 92050674, "body": "would you be kind enough to explain the difference between <code>iconcatMap</code> and <code>iconcatMapOf</code>?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1538140971, "post_id": 52555564, "comment_id": 92051164, "body": "@SaurabhNanda <code>iconcatMap</code> folds over a data structure using the <code>FoldableWithIndex</code> instance. <code>iconcatMapOf</code> folds over a structure, but you can  additionally specify the way of folding, using an indexed traversal (a getter here concretely). So, using <code>iconcatMapOf</code>, you can fold in reversed order, or any order, or just some elements, by giving specifying a different traversal, while with <code>iconcatMap</code>, you can only fold in the default way (given by the class instance)."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1538141128, "post_id": 52555564, "comment_id": 92051251, "body": "In this case, <code>Object</code> and <code>Value</code> don&#39;t have <code>FoldableWithIndex</code> instances, (they don&#39;t have the right kind to begin with), so you can only fold them with a custom fold."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 3, "last_activity_date": 1538251183, "last_edit_date": 1538251183, "creation_date": 1538138431, "answer_id": 52555564, "question_id": 52553510, "link": "https://stackoverflow.com/questions/52553510/how-to-concatmap-over-all-key-value-pairs-in-an-aeson-object-using-lenses/52555564#52555564", "title": "How to concatMap over all key/value pairs in an Aeson.Object using lenses", "body": "<p>The desired function is <a href=\"http://hackage.haskell.org/package/lens-4.17/docs/Control-Lens-Fold.html#g:6\" rel=\"nofollow noreferrer\"><code>iconcatMapOf</code></a>. Also, note that <code>members</code> traverses types with <code>AsValue</code> instance, and there's no such instance for <code>Object</code>, so we need to wrap it to <code>Value</code>. </p>\n\n<pre><code>import qualified Data.Aeson as Aeson\nimport Control.Lens\nimport Data.Aeson.Lens\nimport Data.Text\n\nfunc :: Aeson.Object -&gt; (Text -&gt; Aeson.Value -&gt; [a]) -&gt; [a]\nfunc obj f = iconcatMapOf members f (Aeson.Object obj)\n</code></pre>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 52555564, "answer_count": 1, "score": 1, "last_activity_date": 1538251183, "creation_date": 1538130942, "question_id": 52553510, "link": "https://stackoverflow.com/questions/52553510/how-to-concatmap-over-all-key-value-pairs-in-an-aeson-object-using-lenses", "title": "How to concatMap over all key/value pairs in an Aeson.Object using lenses", "body": "<p>I've been fooling around with the combinators in Control.Lens.Indexed, especially <a href=\"http://hackage.haskell.org/package/lens-4.17/docs/Control-Lens-Indexed.html#v:iconcatMap\" rel=\"nofollow noreferrer\"><code>iconcatMap</code></a>, but I haven't been able to come-up with a function with the following type-sig using the <a href=\"https://www.stackage.org/haddock/lts-12.1/lens-aeson-1.0.2/Data-Aeson-Lens.html#v:members\" rel=\"nofollow noreferrer\"><code>Data.Aeson.Lens.members</code></a> lens:</p>\n\n<pre><code>func \n\n  -- list of key/value pairs, essentially\n  :: Aeson.Object                  \n\n  -- function for the concatMap operation to which the \n  -- key (Text) and value is passed\n  -&gt; (Text -&gt; Aeson.Value -&gt; [a])  \n\n  -- resultant concatenated list\n  -&gt; [a]\n</code></pre>\n"}, {"tags": ["unit-testing", "haskell", "hunit"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538128304, "post_id": 52552604, "comment_id": 92044176, "body": "Related: <a href=\"https://stackoverflow.com/a/35600656/67579\">stackoverflow.com/a/35600656/67579</a>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1538128568, "post_id": 52552604, "comment_id": 92044336, "body": "But personally I do not like the idea in general to raise errors. In Haskell, one usually returns a <code>Maybe Resistor</code> in that case, or <code>Either String Resistor</code>."}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538128750, "post_id": 52552604, "comment_id": 92044450, "body": "@WillemVanOnsem : yes, I was wondering if what is described is conform with the general &quot;way of solving issue&quot; of FP. Obviously you think it is not."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1538129715, "post_id": 52552604, "comment_id": 92044973, "body": "well of course this is a bit opinion based, but the problem I have with exceptions, is that these are not explicit in the signature. That means that if you would define something like <code>f = metalResistor</code>, then if you export <code>f</code>, without documentation, I have no hint at all that <code>f</code> does that (by only looking at the implementation of <code>f</code>, and its signature). This also makes it easy to pass <code>f</code> as a generic function to all kinds of function that do not expect an exception (and thus do not handle it accordingly)."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538146025, "post_id": 52552604, "comment_id": 92054121, "body": "As @WillemVanOnsem said it is best to use Maybe or Either String. One reason, is that it makes your test easier ;-). The other it is easier to transform a function returing a Maybe to the assert version that the other way around. The last (but not the last) is you might want to parse a file which contains many resistors, and don&#39;t want to fail on the first one, but read them all and displays all the errors. You do that easily with Maybe but not by throwing exception ... unless you are planning to catch them. In that case use Maye, Exception should be exceptional (and not used as control flow)"}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1538164461, "post_id": 52552604, "comment_id": 92062354, "body": "@mb14 : the first reason is very convincing indeed. I will rewrite my code using Either as I can always assert it after. It&#39; s not easy for a beginner in Haskell to assess if a resource is good or not. This one is on the Haskell wiki but obviously it does not mean it should be taken for granted."}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538127983, "creation_date": 1538127983, "question_id": 52552604, "link": "https://stackoverflow.com/questions/52552604/how-to-unit-test-smart-constructor-that-throw-when-construction-is-impossible", "title": "How to unit test smart constructor that throw when construction is impossible?", "body": "<p>I am implementing \"smart\" constructor performing runtime checking as described here \n<a href=\"https://wiki.haskell.org/Smart_constructors#Smart.28er.29_constructors\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Smart_constructors#Smart.28er.29_constructors</a></p>\n\n<p>My first question is : how to unit test that invalid argument throws ? </p>\n\n<p>Here is what I have tried</p>\n\n<pre><code>import Control.Exception\nimport Test.HUnit\n\nmetalResistor :: Bands -&gt; Resistor\nmetalResistor n = Control.Exception.assert (n &gt;= 4 &amp;&amp; n &lt;= 8) $ Metal n\n\nm0 = metalResistor 0\ntest1 = TestCase ( assertBool  (show mo) False)\ntests = TestList [TestLabel \"test1\" test1]\n</code></pre>\n\n<p>Results is </p>\n\n<pre><code>*Main&gt; runTestTT  tests\n### Error in:   0:test1\nAssertion failed\nCallStack (from HasCallStack):\n  assert, called at test.hs:42:19 in main:Main\nCases: 1  Tried: 1  Errors: 1  Failures: 0\nCounts {cases = 1, tried = 1, errors = 1, failures = 0}\n</code></pre>\n\n<p>My expectation is to catch the exception in the unit test (assertThrow ?) and that the test succeed.</p>\n\n<p>My second question is maybe more opinion base, but I am unsure which approach to take for smart constructor : the one with error or the one with Conntrol.Exception.assert</p>\n\n<p>In the long run, I feel better to use the error solution ; for sake of clarity and for code maintenance and bug tracking, plus that tedious to write one time is better that tedious to read 1000 times. </p>\n"}, {"tags": ["haskell", "higher-order-functions"], "answers": [{"tags": [], "owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "is_accepted": false, "score": 1, "last_activity_date": 1538108166, "creation_date": 1538108166, "answer_id": 52548199, "question_id": 52547909, "link": "https://stackoverflow.com/questions/52547909/custom-higher-order-function-invocation-gives-non-type-variable-argument-in-the/52548199#52548199", "title": "custom higher order function invocation gives Non type-variable argument in the constraint error", "body": "<p>Your <code>mapThenComputeV1</code> have type <code>(a -&gt; b) -&gt; (Int -&gt; a) -&gt; Int -&gt; b</code> (Or something similar).</p>\n\n<p>You try to apply it to <code>fn times3 4</code>.</p>\n\n<pre><code>fn :: (Int -&gt; a) -&gt; Int -&gt; a\n</code></pre>\n\n<p>so haskell try to apply <code>mapThenComputeV1</code> to <code>fn</code>, but see that types doesn't matches. <code>Int</code> no way can be inferred to <code>(Int -&gt; a)</code>.</p>\n\n<p><strong>PS</strong>: Try to add explicit types to your definitions. It usually help me to find a problem.</p>\n\n<p><strong>PPS</strong>: If you explain what you want to achieve with <code>mapThenComputeV1</code> we can help you to fix your example.</p>\n"}, {"comments": [{"owner": {"reputation": 54, "user_id": 5685250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d91de533dfde3fea2cefa9a7c53b55?s=128&d=identicon&r=PG&f=1", "display_name": "user5685250", "link": "https://stackoverflow.com/users/5685250/user5685250"}, "edited": false, "score": 0, "creation_date": 1538366356, "post_id": 52548234, "comment_id": 92103650, "body": "I got it, however from error message I could not figure out the actual problem. I still don&#39;t understand what the error message says, is there any way to get a readable stack trace to understand this kind of problem?"}], "tags": [], "owner": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "is_accepted": true, "score": 3, "last_activity_date": 1538108457, "creation_date": 1538108457, "answer_id": 52548234, "question_id": 52547909, "link": "https://stackoverflow.com/questions/52547909/custom-higher-order-function-invocation-gives-non-type-variable-argument-in-the/52548234#52548234", "title": "custom higher order function invocation gives Non type-variable argument in the constraint error", "body": "<p>Argument <code>f</code> in <code>mapThenComputeV1</code> is a function that you are going to apply. You are passing <code>fn</code> that accepts two arguments, but you have extra parenthesis in <code>mapThenComputeV1</code> body.\nTry this:</p>\n\n<pre><code>mapThenComputeV1 f f1 x = f f1 (transform (x))\noutput&gt; 36\n</code></pre>\n\n<p>But I'm not sure if it is what you expect to achieve.</p>\n"}], "owner": {"reputation": 54, "user_id": 5685250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d91de533dfde3fea2cefa9a7c53b55?s=128&d=identicon&r=PG&f=1", "display_name": "user5685250", "link": "https://stackoverflow.com/users/5685250/user5685250"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 52548234, "answer_count": 2, "score": 1, "last_activity_date": 1538108457, "creation_date": 1538105680, "question_id": 52547909, "link": "https://stackoverflow.com/questions/52547909/custom-higher-order-function-invocation-gives-non-type-variable-argument-in-the", "title": "custom higher order function invocation gives Non type-variable argument in the constraint error", "body": "<p>I am new to Haskell, I was trying to figure out higher order function fundament. So I created this example </p>\n\n<pre><code>times3 x = x * 3\nfn f x = f (x+3)\ntransform x = x+5\nmapThenComputeV1 f f1 x = f (f1 (transform (x)))\n</code></pre>\n\n<p>upon calling </p>\n\n<pre><code>mapThenComputeV1 fn times3 4\n</code></pre>\n\n<p>I am getting this exception</p>\n\n<pre><code>*Main&gt; mapThenComputeV1 fn times3 4\n\n&lt;interactive&gt;:2:1: error:\n    * Non type-variable argument in the constraint: Num (t1 -&gt; t2)\n      (Use FlexibleContexts to permit this)\n    * When checking the inferred type\n        it :: forall t1 t2. (Num t1, Num (t1 -&gt; t2)) =&gt; t1 -&gt; t2\n</code></pre>\n\n<p>I am completely clueless, please help me to understand what I am doing wrong.</p>\n"}, {"tags": ["haskell", "type-families", "injective-function"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1538164312, "post_id": 52547946, "comment_id": 92062291, "body": "I only want to add that, in my limited experience, injective type families never solved any problem I expected them to solve ;-). Perhaps the OP&#39;s is one of those cases where they work. I recall that some trivial examples like <code>f :: F a ~ F b =&gt; a -&gt; b ; f x = x</code> surprisingly fail to work since injectivity is not fully exploited during type checking."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1538186335, "post_id": 52547946, "comment_id": 92067063, "body": "@chi Unfortunately, you&#39;re right that it seems GHC still doesn&#39;t accept my type as injective even with an explicit annotation. However, this does answer my question, so thank you both for the help! :)"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 4, "last_activity_date": 1538106004, "creation_date": 1538106004, "answer_id": 52547946, "question_id": 52547887, "link": "https://stackoverflow.com/questions/52547887/non-injective-closed-type-family/52547946#52547946", "title": "Non-Injective Closed Type Family", "body": "<p><a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#extension-TypeFamilyDependencies\" rel=\"nofollow noreferrer\">Injective type families</a> are a separate extension on top of type families, and you need special syntax to declare a type family as one. Injectivity does not get inferred.</p>\n"}], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 52547946, "answer_count": 1, "score": 2, "last_activity_date": 1538106004, "creation_date": 1538105536, "question_id": 52547887, "link": "https://stackoverflow.com/questions/52547887/non-injective-closed-type-family", "title": "Non-Injective Closed Type Family", "body": "<p>I have this admittedly contrived chunk of code</p>\n\n<pre><code>{-# LANGUAGE DataKinds, TypeFamilies #-}\n\ndata Foo = Foo\n\ntype family Id (n :: Foo) a where\n    Id 'Foo a = a\n\ndata Bar (n :: Foo) = Bar\n\nclass Dispatch (n :: Foo) where\n    consume :: Id n a -&gt; Bar n -&gt; a\n\nconsume' :: Dispatch n =&gt; Id n [Bool] -&gt; Bar n -&gt; [Bool]\nconsume' = consume\n\nconsume'' :: Dispatch n =&gt; Id n [Bool] -&gt; Bar n -&gt; Bool\nconsume'' g x = and (consume' g x)\n</code></pre>\n\n<p>This compiles and works fine. However, if I replace the final <code>consume''</code> definition with</p>\n\n<pre><code>consume'' :: Dispatch n =&gt; Id n [Bool] -&gt; Bar n -&gt; Bool\nconsume'' g x = and (consume g x)\n</code></pre>\n\n<p>(Note the <code>consume</code> rather than <code>consume'</code>), then I get an error</p>\n\n<pre><code>noinject.hs:17:30: error:\n    \u2022 Couldn't match expected type \u2018Id n (t0 Bool)\u2019\n                  with actual type \u2018Id n [Bool]\u2019\n      NB: \u2018Id\u2019 is a non-injective type family\n      The type variable \u2018t0\u2019 is ambiguous\n    \u2022 In the first argument of \u2018consume\u2019, namely \u2018g\u2019\n      In the first argument of \u2018and\u2019, namely \u2018(consume g x)\u2019\n      In the expression: and (consume g x)\n    \u2022 Relevant bindings include\n        x :: Bar n (bound at noinject.hs:17:13)\n        g :: Id n [Bool] (bound at noinject.hs:17:11)\n        consume'' :: Id n [Bool] -&gt; Bar n -&gt; Bool\n          (bound at noinject.hs:17:1)\n   |\n17 | consume'' g x = and (consume g x)\n   |                              ^\nFailed, no modules loaded.\n</code></pre>\n\n<p>If we assume <code>Id</code> is non-injective, then the error occurs because <code>consume</code> could feasibly specialize to <code>consume :: Id n (t0 Bool) -&gt; Bar n -&gt; t0 Bool</code>, for some foldable <code>t0</code> that isn't <code>[]</code>. I understand that much. My question is: why is <code>Id</code> <em>not</em> actually injective. It takes two arguments: there's only one valid value for the first argument, and <code>Id</code> is pretty clearly injective in its second argument, so why does GHC think this is a non-injective family?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1538084886, "post_id": 52545556, "comment_id": 92031039, "body": "You shouldn&#39;t have brackets around <code>(increase(counter) s)</code>. The error should say this."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 1, "creation_date": 1538085803, "post_id": 52545556, "comment_id": 92031289, "body": "<code>zip [1 ..] list</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 2, "last_activity_date": 1538085108, "creation_date": 1538085108, "answer_id": 52545632, "question_id": 52545556, "link": "https://stackoverflow.com/questions/52545556/how-to-travel-into-a-list-and-show-its-elements-and-order-position-haskell/52545632#52545632", "title": "How to travel into a list and show it&#39;s elements and order position (HASKELL)?", "body": "<p>This line has a problem:</p>\n\n<pre><code>firstApearAux counter (ls:s) = [(ls, counter)] ++  firstApearAux (increase(counter) s)\n</code></pre>\n\n<p>You shouldn't have brackets around <code>increase(counter) s</code>. This looks to the compiler like you're trying to apply the function <code>increase</code> to <code>counter</code> and <code>s</code>.</p>\n\n<p>In fact, if you look at the error message, it tells you this:</p>\n\n<blockquote>\n  <p><code>main.hs:13:67: error: \n     \u2022 Couldn't match expected type \u2018[Integer] -> Integer\u2019\n                   with actual type \u2018Integer\u2019\n     \u2022 <strong>The function \u2018increase\u2019 is applied to two arguments,</strong>\n        <strong>but its type \u2018Integer -> Integer\u2019 has only one</strong>\n        In the first argument of \u2018firstApearAux\u2019, namely\n          \u2018(increase (counter) s)\u2019\n        In the second argument of \u2018(++)\u2019, namely\n          \u2018firstApearAux (increase (counter) s)\u2019M</code></p>\n</blockquote>\n\n<p>Here's the corrected version. Also, I'm going to clean it up a bit, and get rid of the useless <code>increase</code> function. <em>(Sidenote: <code>increase</code> already exists in a far more useful and general form in <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:succ\" rel=\"nofollow noreferrer\"><code>succ</code></a>)</em></p>\n\n<pre><code>firstApearAux counter (ls:s) = (ls, counter) : firstApearAux (counter + 1) s\n</code></pre>\n\n<p>The rest of your code is fine.</p>\n"}], "owner": {"reputation": 123, "user_id": 10321338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/20Pz7.jpg?s=128&g=1", "display_name": "OnlyDavies", "link": "https://stackoverflow.com/users/10321338/onlydavies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1538085108, "creation_date": 1538084601, "question_id": 52545556, "link": "https://stackoverflow.com/questions/52545556/how-to-travel-into-a-list-and-show-its-elements-and-order-position-haskell", "title": "How to travel into a list and show it&#39;s elements and order position (HASKELL)?", "body": "<p>I have a list like [1,2,3] and I want to travel by it, show it's items and the order by their position.</p>\n\n<p>A result for the list [1,2,3] would be: [(1,0), (2,1), (3,2)]</p>\n\n<p>I have this code:</p>\n\n<pre><code>increase:: Integer -&gt; Integer\n\nincrease x = x + 1\n\nfirstApear:: [Integer] -&gt; [(Integer, Integer)]\n\nfirstApear ls = firstApearAux 0 ls\n\nfirstApearAux:: Integer -&gt; [Integer] -&gt; [(Integer, Integer)]\n\nfirstApearAux _ [] = []\n\nfirstApearAux counter (ls:s) = [(ls, counter)] ++  firstApearAux (increase(counter) s)\n</code></pre>\n\n<p>I'm trying to do it recursively because I don't know other way. </p>\n\n<p>Thank you</p>\n"}, {"tags": ["arrays", "haskell", "math"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538079243, "post_id": 52544450, "comment_id": 92028760, "body": "You second example does not look correct, since <code>i</code> and <code>j</code> are always the same. Furthermore it is not clear to me what to do in case the limit is less than the number of elements: which elements should be generated in that case? The smallest lexicographically?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1538079520, "post_id": 52544450, "comment_id": 92028907, "body": "Are you <i>sure</i> &quot;Cartesian product&quot; is the right term for what you want? I can&#39;t match my understanding of &quot;Cartesian product&quot; with your input/output examples. (I also can&#39;t understand the logic behind your input/output examples.)"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1538079825, "post_id": 52544450, "comment_id": 92029040, "body": "In your second example the tuples are still size 2, not 100."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1538080036, "post_id": 52544450, "comment_id": 92029106, "body": "Why are the values wrapped in a 2-tuple? If the length depends on a parameter, normally this should be a list."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1538080417, "post_id": 52544450, "comment_id": 92029292, "body": "What do you mean &quot;by fixed array size of 2&quot;?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1538081919, "post_id": 52544450, "comment_id": 92029958, "body": "<code>f x y = replicateM y [1 .. x]</code>"}, {"owner": {"reputation": 17, "user_id": 10423296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6edd1770dd08913f2908ef225f113f65?s=128&d=identicon&r=PG&f=1", "display_name": "funcylambda", "link": "https://stackoverflow.com/users/10423296/funcylambda"}, "edited": false, "score": 0, "creation_date": 1538081920, "post_id": 52544450, "comment_id": 92029959, "body": "I wrote the question while still thinking about it and therefore made a load of mistakes, I&#39;ve now re-written the question and believe it is all there."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1538081967, "post_id": 52544450, "comment_id": 92029971, "body": "Thanks for the improved example"}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1538082215, "post_id": 52544450, "comment_id": 92030080, "body": "Can you clarify your meaning of &quot;array&quot;? Your example is a three integer tuple, but you called it an array? Just wonderin&#39; cuz tuples, arrays, and lists have very different meanings in Haskell. i.e. <code>[i,j,k]</code> is not the same as <code>(i,j,k)</code>"}, {"owner": {"reputation": 17, "user_id": 10423296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6edd1770dd08913f2908ef225f113f65?s=128&d=identicon&r=PG&f=1", "display_name": "funcylambda", "link": "https://stackoverflow.com/users/10423296/funcylambda"}, "reply_to_user": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 1, "creation_date": 1538083972, "post_id": 52544450, "comment_id": 92030765, "body": "@DavOS - I don&#39;t think it really matters which one is used, but I meant array with my C# hat on - a list, a collection, something I can later iterate over and that&#39;s it. Can you think of a reason this might matter? I&#39;d be interested to know!"}, {"owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "edited": false, "score": 2, "creation_date": 1538092556, "post_id": 52544450, "comment_id": 92032761, "body": "StackOverflow is not a service to get people to write your code - it&#39;s a way to ask for help with a specific problem. Can you provide an example of what you&#39;ve already tried, and why it isn&#39;t working?"}, {"owner": {"reputation": 17, "user_id": 10423296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6edd1770dd08913f2908ef225f113f65?s=128&d=identicon&r=PG&f=1", "display_name": "funcylambda", "link": "https://stackoverflow.com/users/10423296/funcylambda"}, "reply_to_user": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "edited": false, "score": 0, "creation_date": 1538118246, "post_id": 52544450, "comment_id": 92038947, "body": "@IsaacvanBakel - I originally provided my attempt of a solution by framing the question from where I was but found this led to too much confusion (there were almost 15 more comments than what you&#39;re seeing now)."}], "answers": [{"tags": [], "owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "is_accepted": false, "score": 1, "last_activity_date": 1538632473, "last_edit_date": 1538632473, "creation_date": 1538098294, "answer_id": 52547109, "question_id": 52544450, "link": "https://stackoverflow.com/questions/52544450/how-to-find-all-unique-values-of-arrays-of-integers-where-the-array-length-and-m/52547109#52547109", "title": "How to find all unique values of arrays of integers where the array length and maximum integer value are set", "body": "<p>There are <code>P=Max**Len</code> arrays for <code>F(Max, Len)</code>, and there is bijection between numbers in range <code>0..P-1</code> and arrays. </p>\n\n<p>So you can just walk  in the loop through all numbers in that range and represent loop counter in M-ric numeral system (counter 4(dec) corresponds to (1, 2, 1) in your first example)</p>\n\n<p>Alternate way - use array as multidigit counter (like old electrical meter display with rotating cylinders). When some digit becomes Max and should be incremented, it is reset to 1 and the next digit is incremented (<code>(1, 1, 4) =&gt; (1, 2, 1)</code> in your example).</p>\n"}], "owner": {"reputation": 17, "user_id": 10423296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6edd1770dd08913f2908ef225f113f65?s=128&d=identicon&r=PG&f=1", "display_name": "funcylambda", "link": "https://stackoverflow.com/users/10423296/funcylambda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1538632473, "creation_date": 1538079093, "last_edit_date": 1538081735, "question_id": 52544450, "link": "https://stackoverflow.com/questions/52544450/how-to-find-all-unique-values-of-arrays-of-integers-where-the-array-length-and-m", "title": "How to find all unique values of arrays of integers where the array length and maximum integer value are set", "body": "<p>I am trying to write a function which generates all unique combinations of arrays for values up to a certain number.</p>\n\n<p>The function has two parameters, one parameter is the length of the array and the other is the maximum size of the integer.</p>\n\n<p><code>F(4, 3)</code> is a function that will generate all possible unique combinations of positive integers less than or equal to 4 in a three integer array. <code>F(10, 100)</code> will generate all possible unique combinations of positive integers less than or equal to 10 in a 100 integer array.</p>\n\n<p>The result for <code>F(4, 3)</code> would start like this:</p>\n\n<p><code>(1, 1, 1), (1, 1, 2), (1, 1, 3), (1, 1, 4), (1, 2, 1), (1, 2, 2) ... (4, 4, 4)</code></p>\n\n<p><code>F(10, 10)</code> would start like this:</p>\n\n<p><code>(1, 1, 1, 1, 1, 1, 1, 1, 1, 1), (1, 1, 1, 1, 1, 1, 1, 1, 1, 2), ... \n (10, 10, 10, 10, 10, 10, 10, 10, 10, 10)</code></p>\n"}, {"tags": ["haskell", "functional-programming", "tree"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1538075090, "post_id": 52543162, "comment_id": 92026946, "body": "What should happen if the trees have different shapes?  e.g. <code>a :&gt; [a :&gt; [], a :&gt; []]</code> with <code>b  :&gt; [b :&gt; [b :&gt; []]]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": true, "score": 5, "last_activity_date": 1538073775, "creation_date": 1538073775, "answer_id": 52543293, "question_id": 52543162, "link": "https://stackoverflow.com/questions/52543162/how-to-zip-rose-trees-in-haskell/52543293#52543293", "title": "How to zip Rose Trees in Haskell", "body": "<p><code>chib</code> and <code>chii</code> are lists of trees, not trees themselves. You can't just call <code>zipTrees</code> on them. You will need to either recurse</p>\n\n<pre><code>zipTrees :: Rose Board -&gt; Rose Int -&gt; Rose (Board, Int)\nzipTrees (b :&gt; [])       (i :&gt; _)        = \u2026\nzipTrees (b :&gt; _)        (i :&gt; [])       = \u2026\nzipTrees (b :&gt; (cb:cbs)) (i :&gt; (ci:cis)) = \u2026\n</code></pre>\n\n<p>or just use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:zipWith\" rel=\"noreferrer\"><code>zipWith</code></a></p>\n\n<pre><code>zipTrees :: Rose Board -&gt; Rose Int -&gt; Rose (Board, Int)\nzipTrees (b :&gt; chib) (i :&gt; chii) = (b, i) :&gt; zipWith zipTrees chib chii\n--                                           ^^^^^^^\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10425903, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GIBJNjmjqBA/AAAAAAAAAAI/AAAAAAAACNQ/wyjGlg1f40s/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/10425903/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 52543293, "answer_count": 1, "score": 0, "last_activity_date": 1538085397, "creation_date": 1538073180, "last_edit_date": 1538085397, "question_id": 52543162, "link": "https://stackoverflow.com/questions/52543162/how-to-zip-rose-trees-in-haskell", "title": "How to zip Rose Trees in Haskell", "body": "<p>For a Haskell Tic Tac Toe game, I am trying to zip two Rose Trees. I have defined the rose tree as</p>\n\n<pre><code>data Rose a = a :&gt; [Rose a]\n</code></pre>\n\n<p>I have tried the following:</p>\n\n<pre><code>zipTrees :: Rose Board -&gt; Rose Int -&gt; Rose (Board, Int)\nzipTrees (b :&gt; []) (i :&gt; []) = (b,i) :&gt; []\nzipTrees (b :&gt; chib) (i :&gt; chii) = (b, i) :&gt; zipTrees chib chii\n</code></pre>\n\n<p>but an error occurs, because it couldn't match expected type <code>Rose Int</code> and <code>Rose Board</code> with <code>[Rose Int]</code> and <code>[Rose Board]</code> respectively. I am clueless about how to zip the trees in any other way.</p>\n\n<p>To illustrate further, if I wanted to zip the trees</p>\n\n<pre><code>a :&gt; [a :&gt; [a :&gt; []], a :&gt; []]\n</code></pre>\n\n<p>and <code>b :&gt; [b :&gt; [b :&gt; []], b :&gt; []]</code>, I want to return the tree</p>\n\n<pre><code>(a, b) :&gt; [(a, b) :&gt; [(a, b) :&gt; []], (a,b) :&gt; []]\n</code></pre>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "edited": false, "score": 0, "creation_date": 1610796057, "post_id": 52542536, "comment_id": 116247946, "body": "Could you do an example? (or an syntactic example of the solution)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1538070461, "creation_date": 1538070461, "answer_id": 52542536, "question_id": 52541770, "link": "https://stackoverflow.com/questions/52541770/recreating-failing-input-value-for-quickcheck-from-a-seed/52542536#52542536", "title": "Recreating failing input value for QuickCheck from a seed", "body": "<p>You should use <a href=\"https://hackage.haskell.org/package/QuickCheck-2.12.4/docs/Test-QuickCheck.html#v:quickCheckResult\" rel=\"nofollow noreferrer\"><code>quickCheckResult</code></a> (or <code>quickCheckWithResult</code>) to run your tests. In case it returns a <code>Failure</code>, the <code>usedSeed</code> and <code>usedSize</code> fields have the <code>QCGen</code> and <code>Int</code> values you need to pass in the <code>Args</code> to <code>quickCheckWith</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 1, "last_activity_date": 1538073051, "creation_date": 1538073051, "answer_id": 52543138, "question_id": 52541770, "link": "https://stackoverflow.com/questions/52541770/recreating-failing-input-value-for-quickcheck-from-a-seed/52543138#52543138", "title": "Recreating failing input value for QuickCheck from a seed", "body": "<p>There is also a package <a href=\"https://hackage.haskell.org/package/quickcheck-with-counterexamples\" rel=\"nofollow noreferrer\">quickcheck-with-counterexamples</a> where properties can capture generated values for further inspection if a test fails.</p>\n"}], "owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 1, "accepted_answer_id": 52542536, "answer_count": 2, "score": 2, "last_activity_date": 1538073051, "creation_date": 1538067118, "question_id": 52541770, "link": "https://stackoverflow.com/questions/52541770/recreating-failing-input-value-for-quickcheck-from-a-seed", "title": "Recreating failing input value for QuickCheck from a seed", "body": "<p>When a QuickCheck test fails, sometimes I need to walk through the code in ghci (or stack repl) to analyse the problem. So the first thing I do is recreate the failing input. Now QuickCheck prints out the failing input (using <code>Show</code>), but sometimes re-creating the input from this is difficult or impossible. For example, the type in question might not implement <code>Read</code>. Or it might be a really complex type which requires lots of types in order to recreate it, and tracking down the modules that export those types, and manually importing them into the repl is a hassle.</p>\n\n<p><strong>So I'd like to be able to recreate the failing input from the seed</strong>, which is also reported by QuickCheck. It looks like <code>unGen</code> in Test.QuickCheck.Gen is designed for this.</p>\n\n<blockquote>\n<pre><code>unGen :: QCGen -&gt; Int -&gt; a\n</code></pre>\n  \n  <p>Run the generator on a particular seed. If you just want to get a\n  random value out, consider using generate.</p>\n</blockquote>\n\n<p>But <code>unGen</code> takes two input parameters. I'm guessing the second one is the seed. How do I recreate the <code>QCGen</code> parameter? Here's an example I tried where the seed was -4346962096583255693. <code>unGen</code> doesn't seem to like a negative seed, so I must be doing something wrong.</p>\n\n<pre><code>\u03bb&gt; (unGen arbitrary) (mkQCGen 0) (-4346962096583255693) :: ImprintEmptyBrainTestData \nImprintEmptyBrainTestData (*** Exception: Negative exponent\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 2, "creation_date": 1538066665, "post_id": 52541536, "comment_id": 92023138, "body": "Nothing is casted here, the type of <code>WS.receiveData conn</code> is polymorphic in its return type. The equivalent in Java would be a generic method and in C++ it&#39;d be a template. The difference is that neither Java nor C++ can infer type arguments that are only used as the return type, so in Java or C++ you&#39;d have to explicitly write <code>receiveData&lt;Text&gt;(conn)</code> to get a <code>Text</code> or <code>receiveData&lt;ByteString&gt;(conn)</code> to get a <code>ByteString</code>. Haskell is smart enough to infer this based on what you do with the result, but if you use it as both a <code>ByteString</code> <i>and</i> a <code>Text</code>, that no longer works."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1538066688, "post_id": 52541536, "comment_id": 92023153, "body": "A <code>ByteString</code> is a sequence of bytes, while a <code>Text</code> is a sequence of characters. You can turn a <code>ByteString</code> into a <code>Text</code> only if you know that the bytes are indeed text, and which <i>encoding</i> is being used. For instance, you can use <code>decodeUtf8 :: ByteString -&gt; Text</code> from <code>Data.Text.Encoding</code>"}, {"owner": {"reputation": 965, "user_id": 3052692, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/abxME.jpg?s=128&g=1", "display_name": "rjmurt", "link": "https://stackoverflow.com/users/3052692/rjmurt"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1538132602, "post_id": 52541536, "comment_id": 92046538, "body": "Thanks @sepp2k, @ chi, thats really helpful, think I understand it all now, and summed it up in my extra answer"}], "answers": [{"comments": [{"owner": {"reputation": 965, "user_id": 3052692, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/abxME.jpg?s=128&g=1", "display_name": "rjmurt", "link": "https://stackoverflow.com/users/3052692/rjmurt"}, "edited": false, "score": 1, "creation_date": 1538132510, "post_id": 52541877, "comment_id": 92046494, "body": "Thanks Kostiantyn, really helpful. Just for posterity I summed up my understanding of that below. Much appreciated"}], "tags": [], "owner": {"reputation": 2277, "user_id": 540810, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6ac4c55425d6f9d28db9068dbb49e09?s=128&d=identicon&r=PG", "display_name": "Konstantine Rybnikov", "link": "https://stackoverflow.com/users/540810/konstantine-rybnikov"}, "is_accepted": true, "score": 3, "last_activity_date": 1538067516, "creation_date": 1538067516, "answer_id": 52541877, "question_id": 52541536, "link": "https://stackoverflow.com/questions/52541536/haskell-type-error-occurs-when-compiling-two-code-snippets-together-that-separat/52541877#52541877", "title": "Haskell type error occurs when compiling two code snippets together that separately raise no error", "body": "<p>This is because <code>WS.receiveData</code> is polymorphic on its return type:</p>\n\n<pre><code>receiveData :: WebSocketsData a =&gt; Connection -&gt; IO a\n</code></pre>\n\n<p>it only needs to be <code>WebSocketsData a</code> instance, which both <code>Text</code> and <code>ByteString</code> are. So the compiler just infers the type.</p>\n\n<p>I suggest you just assume it's a <code>ByteString</code>, and convert in <code>Text</code> upon the <code>putStrLn</code> usage.</p>\n"}, {"comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1538141274, "post_id": 52553908, "comment_id": 92051331, "body": "That&#39;s not quite it. Values <i>can</i> be polymorphic, but only if they&#39;re let-bound (and the monomorphism restriction is disabled or you provide an explicit type signature). In that case, you will actually be able to use the same value as different types and it will never settle on a type. In your case <code>msg</code> does not have a polymorphic type because it&#39;s bound by <code>&lt;-</code>, which desugars to <code>&gt;&gt;=</code> with a lambda. So <code>msg</code> needs a monomorphic type, which the compiler infers by looking at how <code>msg</code> is used in the rest of its scope. In cases where the compiler can&#39;t infer this, ..."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1538141279, "post_id": 52553908, "comment_id": 92051338, "body": "... you&#39;ll have to provide an explicit type signature."}], "tags": [], "owner": {"reputation": 965, "user_id": 3052692, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/abxME.jpg?s=128&g=1", "display_name": "rjmurt", "link": "https://stackoverflow.com/users/3052692/rjmurt"}, "is_accepted": false, "score": 0, "last_activity_date": 1538132413, "creation_date": 1538132413, "answer_id": 52553908, "question_id": 52541536, "link": "https://stackoverflow.com/questions/52541536/haskell-type-error-occurs-when-compiling-two-code-snippets-together-that-separat/52553908#52553908", "title": "Haskell type error occurs when compiling two code snippets together that separately raise no error", "body": "<p>Thanks to everyone for their advice. My final understanding is that any value in Haskell can be polymorphic until you force it to settle on a type, at which point it can't be any other type (stupid, but I hadn't seen a clear example of that before).</p>\n\n<p>In my example, <a href=\"http://hackage.haskell.org/package/websockets-0.12.5.2/docs/Network-WebSockets.html\" rel=\"nofollow noreferrer\">WS.receiveData</a> returns polymorphic <code>IO a</code> where <code>a</code> is an instance of class <a href=\"http://hackage.haskell.org/package/websockets-0.12.5.2/docs/Network-WebSockets.html#t:WebSocketsData\" rel=\"nofollow noreferrer\">WebsocketData</a> which itself is parameterised by a type which can be either <code>Text</code> or <code>Bytestring</code>.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/aeson-1.4.1.0/docs/Data-Aeson.html#v:decode\" rel=\"nofollow noreferrer\">Aeson decode</a> expects a (lazy) <code>Bytestring</code>. Assuming that we settle on (lazy) <code>Bytestring</code> for our <code>a</code>, this means the first line that I mentioned before needs to become:</p>\n\n<pre><code>T.putStrLn $ toStrict $ decodeUtf8 msg\n</code></pre>\n\n<p>to convert the lazy <code>ByteString</code> to a strict <code>Text</code>. I can do this so long as I know the incoming websocket message is UTF8 encoded.</p>\n\n<p>I may have got some wording wrong there, but think that's basically it.</p>\n"}], "owner": {"reputation": 965, "user_id": 3052692, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/abxME.jpg?s=128&g=1", "display_name": "rjmurt", "link": "https://stackoverflow.com/users/3052692/rjmurt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 52541877, "answer_count": 2, "score": 0, "last_activity_date": 1538132413, "creation_date": 1538066190, "question_id": 52541536, "link": "https://stackoverflow.com/questions/52541536/haskell-type-error-occurs-when-compiling-two-code-snippets-together-that-separat", "title": "Haskell type error occurs when compiling two code snippets together that separately raise no error", "body": "<p>I am having a type issue with Haskell, the program below throws the compile time error:</p>\n\n<pre><code>Couldn't match expected type \u2018bytestring-0.10.8.2:Data.ByteString.Lazy.Internal.ByteString\u2019 with actual type \u2018Text\u2019\n</code></pre>\n\n<p>Program is:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Main where\n\n...\n\nimport Control.Concurrent (MVar, newMVar, modifyMVar_, modifyMVar, readMVar)\nimport qualified Data.Text as T\nimport qualified Data.Text.IO as T\nimport qualified Network.WebSockets as WS\nimport Data.Map (Map)\nimport Data.Aeson (decode)\n\n...\n\napplication :: MVar ServerState -&gt; WS.ServerApp\napplication state pending = do\n    conn &lt;- WS.acceptRequest pending\n    msg &lt;- WS.receiveData conn\n    -- EITHER this line can be included\n    T.putStrLn msg\n    -- OR these two lines, but not both\n    decodedObject &lt;- return (decode msg :: Maybe (Map String Int))\n    print decodedObject\n\n...\n</code></pre>\n\n<p>It seems to me that the basic issue is that <a href=\"http://hackage.haskell.org/package/text-1.2.3.1/docs/Data-Text-IO.html\" rel=\"nofollow noreferrer\">putStrLn</a> expects <code>Text</code> whereas <a href=\"http://hackage.haskell.org/package/aeson-1.4.1.0/docs/Data-Aeson.html\" rel=\"nofollow noreferrer\">decode</a> expects <code>Bytetring</code>.</p>\n\n<p>What I don't get is why I can run this section of the code:</p>\n\n<pre><code>T.putStrLn msg\n</code></pre>\n\n<p>Or I can run this section of the code:</p>\n\n<pre><code>decodedObject &lt;- return (decode msg :: Maybe (Map String Int))\nprint decodedObject\n</code></pre>\n\n<p>But not both together.</p>\n\n<p>What is the proper way to resolve this issue in the program?</p>\n\n<p>I guess this is something like Type Coercion, or Type Inference, or what would be Casting in other languages. The problem is I don't know how to phrase the problem clearly enough to look it up.</p>\n\n<p>It's as if <code>msg</code> can be one of a number of Types, but as soon as it is forced to be one Type, it can't then be another...</p>\n\n<p>I'm also not sure if this overlaps with Overloaded strings. I have the pragma and am compiling with <code>-XOverloadedStrings</code></p>\n\n<p>I'm quite a newbie, so hope this is a reasonable question.</p>\n\n<p>Any advice gratefully received! Thanks</p>\n"}, {"tags": ["haskell", "concurrency", "haskell-pipes"], "comments": [{"owner": {"reputation": 2277, "user_id": 540810, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6ac4c55425d6f9d28db9068dbb49e09?s=128&d=identicon&r=PG", "display_name": "Konstantine Rybnikov", "link": "https://stackoverflow.com/users/540810/konstantine-rybnikov"}, "edited": false, "score": 3, "creation_date": 1538068001, "post_id": 52540672, "comment_id": 92023778, "body": "Slightly offtopic: it would be nice if you would provide a fully executable code as a script which includes imports <a href=\"https://haskell-scripting.readthedocs.io/en/latest/usage/simple_scripts.html\" rel=\"nofollow noreferrer\">as shown here</a>. Thank you!"}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "reply_to_user": {"reputation": 2277, "user_id": 540810, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6ac4c55425d6f9d28db9068dbb49e09?s=128&d=identicon&r=PG", "display_name": "Konstantine Rybnikov", "link": "https://stackoverflow.com/users/540810/konstantine-rybnikov"}, "edited": false, "score": 1, "creation_date": 1538363017, "post_id": 52540672, "comment_id": 92103050, "body": "@KostiantynRybnikov the fully executable code is at this link: <a href=\"https://gist.github.com/binq/360a545cdf9b5b514f1ce420531070a6\" rel=\"nofollow noreferrer\">gist.github.com/binq/360a545cdf9b5b514f1ce420531070a6</a>"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1538421165, "post_id": 52540672, "comment_id": 92129484, "body": "Is there a reason why you repeatedly spawn new <code>(i, o)</code> inside <code>withTimeout</code> instead of sending timeouts to the <code>i</code> generated in <code>main</code>?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1538421561, "post_id": 52540672, "comment_id": 92129669, "body": "You call <code>launchTimeout</code> again just after killing the timeout thread, but the only consumer is <code>ceRecv</code>, which is only going to remove the event that <code>factorTimeout</code> just sent. When the second timeout thread tries to send the timeout, the other end may have been GCed, so the output is sealed and you get the error."}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1538438183, "post_id": 52540672, "comment_id": 92135135, "body": "@Li-yaoXia, I corrected my code to fix the problems that you pointed out.  The function still does not work, but it fails in a different way.  Please see my updated post.  Thanks!"}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1538446344, "post_id": 52540672, "comment_id": 92136604, "body": "@Li-yaoXia I&#39;m repeatedly spawn new (i, o) inside withTimeout because I want it to be entirely self contained.  Is not that possible?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1538448097, "post_id": 52540672, "comment_id": 92136960, "body": "What should be self contained? This indirection seems a superfluous source of complexity waiting for a bug to happen. Is it actually a minimized excerpt of an application where that architecture is required? And why does the updated code still call launchTimeout twice in an iteration?"}], "answers": [{"tags": [], "owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "is_accepted": true, "score": 2, "last_activity_date": 1539026237, "last_edit_date": 1539026237, "creation_date": 1539016611, "answer_id": 52706632, "question_id": 52540672, "link": "https://stackoverflow.com/questions/52540672/how-would-i-pipe-with-a-timeout-that-resets-with-each-incoming/52706632#52706632", "title": "How would I pipe with a timeout that resets with each incoming?", "body": "<p>It seems like a <code>Pipe</code> will only allow one <code>yield</code> per <code>await</code>.  This means that a <code>CeTimeout</code> can not arbitrarily be sent down the pipe because nothing came into the pipe to cause the flow.  I will have to go through the source to confirm this; in the meantime this function has been refactored to return a <code>Pipe</code> and a <code>Producer</code> instead of just a <code>Pipe</code>.  The <code>Producer</code> can then be joined back in the calling function. The initial plan was to return just a <code>Pipe</code> so that the calling function would not have to do any additional work to make timeouts work.  That would have been a more self contained solution.  This alternative is nice in that it is more explicit.  The timeouts won't look like they are appearing out of thin air to someone that is not familiar with the pipeline.</p>\n\n<pre><code>withTimeout :: (MonadIO t) =&gt; Int -&gt; IO (Pipe ConsoleEvent ConsoleEvent t (), Producer ConsoleEvent t ())\nwithTimeout ((* 1000000) -&gt; s) =\n  do\n    (oTimeout, iTimeout) &lt;- spawn $ bounded 1\n    vTid &lt;- launchTimeout oTimeout &gt;&gt;= newMVar\n\n    return (factorTimeout vTid oTimeout, fromInput iTimeout)\n  where\n    launchTimeout :: Output ConsoleEvent -&gt; IO ThreadId\n    launchTimeout o =\n      forkIO . forever $ do\n        threadDelay $ s\n        (atomically $ send o CeTimeout) &gt;&gt;= \\case\n          True -&gt; return ()\n          otherwise -&gt; die \"withTimeout can not send timeout\"\n\n    relaunchTimeout :: Output ConsoleEvent -&gt; ThreadId -&gt; IO ThreadId\n    relaunchTimeout o oldTid = \n      do\n        tid &lt;- launchTimeout o\n        killThread oldTid\n        return tid\n\n    factorTimeout :: (MonadIO t) =&gt; MVar ThreadId -&gt; Output ConsoleEvent -&gt; Pipe ConsoleEvent ConsoleEvent t ()\n    factorTimeout v o =\n      do\n        ce &lt;- await\n        liftIO . modifyMVar_ v $ relaunchTimeout o\n        yield ce\n\nmain :: IO ()\nmain =\n  do\n    hSetBuffering stdin NoBuffering\n    hSetEcho stdin False\n\n    exitSemaphore &lt;- newEmptyMVar\n    (o1, i1) &lt;- spawn $ bounded 1\n    (o2, i2) &lt;- spawn $ bounded 1\n\n    (timeoutTrap, timeoutRender) &lt;- withTimeout 2\n\n    runEffect $ yield CeBegan &gt;-&gt; toOutput o1\n\n    forkIO $ do\n      runEffect . forever $ chars &gt;-&gt; toOutput o1\n      putMVar exitSemaphore ()\n\n    -- other inputs would be piped to o1 here\n\n    forkIO $ do\n      runEffect . forever $ fromInput i1 &gt;-&gt; timeoutTrap &gt;-&gt; toOutput o2\n      putMVar exitSemaphore ()\n\n    forkIO $ do\n      runEffect . forever $ timeoutRender &gt;-&gt; toOutput o2\n      putMVar exitSemaphore ()\n\n    forkIO $ do\n      -- logic would be done before dumpPipe\n      runEffect . forever $ fromInput i2 &gt;-&gt; dumpPipe &gt;-&gt; (await &gt;&gt; return ())\n      putMVar exitSemaphore ()\n\n    takeMVar exitSemaphore\n</code></pre>\n\n<p>Here is a fully executable <a href=\"https://gist.github.com/binq/360a545cdf9b5b514f1ce420531070a6\" rel=\"nofollow noreferrer\">script</a>.</p>\n"}], "owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 52706632, "answer_count": 1, "score": 6, "last_activity_date": 1539026237, "creation_date": 1538063046, "last_edit_date": 1538437605, "question_id": 52540672, "link": "https://stackoverflow.com/questions/52540672/how-would-i-pipe-with-a-timeout-that-resets-with-each-incoming", "title": "How would I pipe with a timeout that resets with each incoming?", "body": "<p>The <code>withTimeout</code> function is suppose to pipe <code>ConsoleEvent</code> with a <code>CeTimeout</code> sent every <code>s :: Int</code> seconds if nothing has been received. Instead it fails to send the <code>CeTimeout</code> events at the appropriate times.  One <code>CeTimeout</code> event is replaced for other events if greater than <code>s</code> seconds have passed with the original event being lost. Also instead of one <code>CeTimeout</code> event, it should be <code>n*s</code> <code>CeTimeout</code> events with <code>n</code> counting for each <code>s</code> second period that has passed.  Where is the mistake, and what would be the correction?  Thanks!</p>\n\n<pre><code>withTimeout :: (MonadIO t) =&gt; Int -&gt; Pipe ConsoleEvent ConsoleEvent t ()\nwithTimeout ((* 1000000) -&gt; s) = join . liftIO $ work\n  where\n    work :: (MonadIO t) =&gt; IO (Pipe ConsoleEvent ConsoleEvent t ()) \n    work =\n      do\n        (oSent, iKept) &lt;- spawn $ bounded 1\n        (oKept, iSent) &lt;- spawn $ unbounded\n        (oTimeout, iTimeout) &lt;- spawn $ bounded 1\n\n        tid &lt;- launchTimeout oTimeout &gt;&gt;= newMVar\n\n        forkIO $ do\n          runEffect . forever $ fromInput iKept &gt;-&gt; factorTimeout tid oTimeout &gt;-&gt; toOutput oKept\n\n        forkIO $ do\n          runEffect . forever $ fromInput iTimeout &gt;-&gt; toOutput oKept\n\n        return $ do\n          await &gt;&gt;= (liftIO . guardedSend oSent)\n          (liftIO . guardedRecv $ iSent) &gt;&gt;= yield\n\n    guardedSend :: Output ConsoleEvent -&gt; ConsoleEvent -&gt; IO ()\n    guardedSend o ce =\n      (atomically $ send o ce) &gt;&gt;= \\case\n        True -&gt; return ()\n        otherwise -&gt; die $ \"withTimeout can not send\"\n\n    guardedRecv :: Input ConsoleEvent -&gt; IO ConsoleEvent\n    guardedRecv i =\n      (atomically $ recv i) &gt;&gt;= \\case\n        Just a -&gt; return a\n        otherwise -&gt; die $ \"withTimeout can not recv\"\n\n    launchTimeout :: Output ConsoleEvent -&gt; IO ThreadId\n    launchTimeout o =\n      forkIO . forever $ do\n        threadDelay $ s\n        (atomically $ send o CeTimeout) &gt;&gt;= \\case\n          True -&gt; return ()\n          otherwise -&gt; die \"withTimeout can not send timeout\"\n\n    relaunchTimeout :: Output ConsoleEvent -&gt; ThreadId -&gt; IO ThreadId\n    relaunchTimeout o oldTid = \n      do\n        tid &lt;- launchTimeout o\n        killThread oldTid\n        return tid\n\n    factorTimeout :: MVar ThreadId -&gt; Output ConsoleEvent -&gt; Pipe ConsoleEvent ConsoleEvent IO ()\n    factorTimeout v o =\n      do\n        ce &lt;- await\n        liftIO . modifyMVar_ v $ relaunchTimeout o\n        yield ce\n</code></pre>\n\n<p>Here is a fully executable <a href=\"https://gist.github.com/binq/360a545cdf9b5b514f1ce420531070a6\" rel=\"nofollow noreferrer\">script</a>.</p>\n"}, {"tags": ["haskell", "algebraic-data-types"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1538057616, "post_id": 52538965, "comment_id": 92017561, "body": "How are you <i>currently</i> trying to use the data type? Edit your question to add what you&#39;ve got so far. Also, indent code snippet by 4 spaces to get code highlighting."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1538057760, "post_id": 52538965, "comment_id": 92017664, "body": "Can you share what is not working with the current attempt?"}, {"owner": {"reputation": 3, "user_id": 10424661, "user_type": "registered", "profile_image": "https://graph.facebook.com/2221917654499479/picture?type=large", "display_name": "Miguel Silva", "link": "https://stackoverflow.com/users/10424661/miguel-silva"}, "edited": false, "score": 0, "creation_date": 1538057941, "post_id": 52538965, "comment_id": 92017788, "body": "I have one class about haskell and I was doing homework and I don&#39;t know how to use this kind of data with multiple definion, I don&#39;t want to someone to do it for me just a quick explanation how to use this right!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1538060735, "post_id": 52538965, "comment_id": 92019739, "body": "Do you know how you would write the function if the definition were simply <code>data Ponto = Cartesiano Double Double</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1538060857, "creation_date": 1538060857, "answer_id": 52540076, "question_id": 52538965, "link": "https://stackoverflow.com/questions/52538965/unsure-how-to-use-a-given-data-type/52540076#52540076", "title": "Unsure how to use a given data type", "body": "<p>You just need to define the function piecewise for each data constructor available for the type:</p>\n\n<pre><code>yourFunction :: Numa a =&gt; Ponto -&gt; a\nyourFunction (Cartesiano x y) = ...\nyourFunction (Polar r th) = ...\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10424661, "user_type": "registered", "profile_image": "https://graph.facebook.com/2221917654499479/picture?type=large", "display_name": "Miguel Silva", "link": "https://stackoverflow.com/users/10424661/miguel-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52540076, "answer_count": 1, "score": -3, "last_activity_date": 1538060857, "creation_date": 1538057220, "last_edit_date": 1538057738, "question_id": 52538965, "link": "https://stackoverflow.com/questions/52538965/unsure-how-to-use-a-given-data-type", "title": "Unsure how to use a given data type", "body": "<p>I'm doing some homework and I have to use the following definition:</p>\n\n<pre><code>data Ponto = Cartesiano Double Double | Polar Double Double deriving (Show,Eq)\n</code></pre>\n\n<p>to write a function that calculates the distance of a point to the vertical axis, the coordinates can be as x and y or r and angle using the data type above.</p>\n\n<p>Can you help me understand how I should use this type of definition in Haskell?</p>\n"}, {"tags": ["haskell", "typeclass", "type-families", "haskell-backpack"], "comments": [{"owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "edited": false, "score": 1, "creation_date": 1538059941, "post_id": 52538213, "comment_id": 92019207, "body": "Have you already read the Motivation section of the Backpack spec (<a href=\"https://github.com/ezyang/ghc-proposals/blob/backpack/proposals/0000-backpack.rst#motivation\" rel=\"nofollow noreferrer\">github.com/ezyang/ghc-proposals/blob/backpack/proposals/&hellip;</a>)?"}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "reply_to_user": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "edited": false, "score": 1, "creation_date": 1538061889, "post_id": 52538213, "comment_id": 92020528, "body": "No, I haven&#39;t. I&#39;m going to take a look at it. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 4, "last_activity_date": 1561688945, "creation_date": 1561688945, "answer_id": 56800253, "question_id": 52538213, "link": "https://stackoverflow.com/questions/52538213/example-on-the-use-of-backpack/56800253#56800253", "title": "Example on the use of backpack", "body": "<p>Main benefits of Backpack:</p>\n\n<ol>\n<li>Guaranteed absence of performance overhead (using typeclasses can have performance overhead due to how they are implemented in Haskell). This is extremely important when working with string data types, parsers, containers, etc.</li>\n<li>Cleaner and nicer code compared to usages of typeclasses or type families.</li>\n</ol>\n\n<p>I wrote a blog post about one particular usage of Backpack: implementing a polymorphic interface for containers data structures:</p>\n\n<ul>\n<li><a href=\"https://kowainik.github.io/posts/2018-08-19-picnic-put-containers-into-a-backpack\" rel=\"nofollow noreferrer\">Picnic: put containers into a backpack</a></li>\n</ul>\n\n<p>Having such an interface for containers allows to:</p>\n\n<ol>\n<li>Write polymorphic functions that work with any container (e.g. <code>Map</code>, <code>HashMap</code> and <code>IntMap</code>).</li>\n<li>Write single test-suite for properties of containers and use it in every package without code duplication.</li>\n<li>Write a single benchmark and use with every containers data structure without performance overhead.</li>\n</ol>\n\n<p>If terms of making code cleaner. This is the signature of the <code>groupBy</code> function implemented using Backpack:</p>\n\n<pre><code>groupBy :: forall k f a . (Foldable f, Key k) =&gt; (a -&gt; k) -&gt; f a -&gt; Map k (NonEmpty a)\n</code></pre>\n\n<p>It's clear, and it's just a plain Haskell. If you implement an interface for containers using typeclasses and type families (this is <a href=\"https://github.com/kowainik/relude/blob/559ed98a1d3e2c15f2ec36a1c94e3b9b4e9484a1/src/Relude/Extra/Group.hs#L27-L28\" rel=\"nofollow noreferrer\">done in <code>relude</code></a>, this signature will look like this:</p>\n\n<pre><code>groupBy\n    :: forall f t a . (Foldable f, DynamicMap t, Val t ~ NonEmpty a, Monoid t)\n    =&gt; (a -&gt; Key t) -&gt; f a -&gt; t\n</code></pre>\n\n<p>Much harder to read and understand.</p>\n\n<p>Also <a href=\"https://www.reddit.com/r/haskell/comments/c64hbr/tweag_io_cpp_considered_harmful/es6rywm/\" rel=\"nofollow noreferrer\">it was discussed recently</a> that Backpack can help with avoiding CPP when you need to compile Haskell code targetting different platforms (aka conditional compilation).</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 1, "accepted_answer_id": 56800253, "answer_count": 1, "score": 9, "last_activity_date": 1561688945, "creation_date": 1538054987, "question_id": 52538213, "link": "https://stackoverflow.com/questions/52538213/example-on-the-use-of-backpack", "title": "Example on the use of backpack", "body": "<p>I'm looking at the references at the <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Backpack\" rel=\"noreferrer\"><code>backpack</code> wiki</a>  trying to understand in which cases the use of <code>backpack</code> would be considered appropriate over other Haskell features like type-classes and type-families.</p>\n\n<p>In particular, in <a href=\"http://blog.ezyang.com/2016/10/try-backpack-ghc-backpack/\" rel=\"noreferrer\">this blog-post</a> by the author of <code>backpack</code>, an example is presented that implements a simple matcher for regular expressions. However as far as I understand, the same module could have been coded using type families.</p>\n\n<p>Are there any examples that concisely show the advantages of backpack over more traditional Haskell features? If the example I referred above is a good one, do you know why a solution that uses type families would be subpar?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1538054378, "creation_date": 1538054378, "answer_id": 52537987, "question_id": 52537287, "link": "https://stackoverflow.com/questions/52537287/type-defaults-in-floor-sqrt/52537987#52537987", "title": "Type defaults in `floor . sqrt`", "body": "<p>There are three types to choose (the input type, the intermediate floating-point type used internally, and the result type), and you have to somehow tell the compiler about all three. There's lots of combinations for fixing them each, but you can't get shorter than three.</p>\n\n<p>I think <code>TypeApplications</code> are a particularly convenient way to specify these types. Here's one way to start from your original, which had two annotations, and add just one to avoid defaulting:</p>\n\n<pre><code>&gt; :set -XTypeApplications -Wtype-defaults\n&gt; (floor . sqrt @Double . fromIntegral) (10 :: Int) :: Int\n3\n</code></pre>\n\n<p>Here's another that might be more ergonomical (because it is more flexible about exactly where parentheses go):</p>\n\n<pre><code>&gt; (floor . sqrt . fromIntegral @Int @Double) 10 :: Int\n3\n</code></pre>\n\n<p>I like the idea of your third example, which is to modify your second example so that you don't have to repeat <code>Int</code>, and therefore avoid a potential point of fragility. You can achieve this in a slightly less cumbersome way with type applications by making use of the special <code>_</code> type application, which lets the compiler use the usual inference procedure for one of the type variables:</p>\n\n<pre><code>&gt; (floor . sqrt . fromIntegral @_ @Double) (10 :: Int) :: Int\n3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1538055420, "post_id": 52538150, "comment_id": 92016010, "body": "Nice. I answered &quot;how should I specify types in my program&quot;, but this question answers &quot;what code should I put in my program&quot; -- arguably the more important thing to talk about."}, {"owner": {"reputation": 402, "user_id": 9009630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920657e98e40c2206e2166bba183551d?s=128&d=identicon&r=PG&f=1", "display_name": "jhu", "link": "https://stackoverflow.com/users/9009630/jhu"}, "edited": false, "score": 0, "creation_date": 1538064116, "post_id": 52538150, "comment_id": 92021819, "body": "Very good point. The context of the situation is illustrating the expressive power of Haskell to absolute beginners. I would therefore like to avoid libraries and extensions. Given I had two questions in my question, I was asking for trouble since I can only select one to be the correct one. Because Daniel&#39;s answer also addresses the use of default language features and libraries (by verifying that three types have to be specified), I chose that as the correct one. This one was upvoted too, naturally. The <i>arithmoi</i> library seems to be actively maintained, which is a good sign."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1538055479, "last_edit_date": 1538055479, "creation_date": 1538054818, "answer_id": 52538150, "question_id": 52537287, "link": "https://stackoverflow.com/questions/52537287/type-defaults-in-floor-sqrt/52538150#52538150", "title": "Type defaults in `floor . sqrt`", "body": "<blockquote>\n  <p>Is this the right way to calculate the value of this composite function (floor of square root) in Haskell? Having to use <code>fromIntegral</code> and having to specify the intermediate type reminds me of the proverb \"simple things are difficult.\"</p>\n</blockquote>\n\n<p>You are ultimately calculating an integer square root, so ideally you'd want to avoid routing your calculation through <code>sqrt :: Floating a =&gt; a -&gt; a</code>. You might. for instance, use <a href=\"https://hackage.haskell.org/package/arithmoi-0.8.0.0/docs/Math-NumberTheory-Powers.html#v:integerSquareRoot\" rel=\"nofollow noreferrer\"><code>integerSquareRoot :: Integral a =&gt; a -&gt; a</code></a> from the <em>arithmoi</em> library.</p>\n\n<p>As for your first question, I second <a href=\"https://stackoverflow.com/a/52537987/2751851\">Daniel Wagner's suggestion</a> of using the <code>TypeApplications</code> extension to specify the intermediate type.</p>\n"}], "owner": {"reputation": 402, "user_id": 9009630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920657e98e40c2206e2166bba183551d?s=128&d=identicon&r=PG&f=1", "display_name": "jhu", "link": "https://stackoverflow.com/users/9009630/jhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 52537987, "answer_count": 2, "score": 3, "last_activity_date": 1538055479, "creation_date": 1538052001, "question_id": 52537287, "link": "https://stackoverflow.com/questions/52537287/type-defaults-in-floor-sqrt", "title": "Type defaults in `floor . sqrt`", "body": "<p>With <code>-Wtype-defaults</code> (comes with <code>-Wall</code>), <code>floor . sqrt . fromIntegral</code> gives me a hefty set of warnings even when I specify the type of the argument and the result:</p>\n\n<pre><code>\u03bb&gt; (floor . sqrt . fromIntegral) (10 :: Int) :: Int\n\n&lt;interactive&gt;:356:2-6: warning: [-Wtype-defaults]\n    \u2022 Defaulting the following constraints to type \u2018Double\u2019\n        (RealFrac a0)\n          arising from a use of \u2018floor\u2019 at &lt;interactive&gt;:356:2-6\n        (Floating a0)\n          arising from a use of \u2018sqrt\u2019 at &lt;interactive&gt;:356:10-13\n        (Num a0)\n          arising from a use of \u2018fromIntegral\u2019 at &lt;interactive&gt;:356:17-28\n    \u2022 In the first argument of \u2018(.)\u2019, namely \u2018floor\u2019\n      In the expression: floor . sqrt . fromIntegral\n      In the expression: (floor . sqrt . fromIntegral) (10 :: Int) :: Int\n\n&lt;interactive&gt;:356:2-6: warning: [-Wtype-defaults]\n    \u2022 Defaulting the following constraints to type \u2018Double\u2019\n        (RealFrac a0)\n          arising from a use of \u2018floor\u2019 at &lt;interactive&gt;:356:2-6\n        (Floating a0)\n          arising from a use of \u2018sqrt\u2019 at &lt;interactive&gt;:356:10-13\n        (Num a0)\n          arising from a use of \u2018fromIntegral\u2019 at &lt;interactive&gt;:356:17-28\n    \u2022 In the first argument of \u2018(.)\u2019, namely \u2018floor\u2019\n      In the expression: floor . sqrt . fromIntegral\n      In the expression: (floor . sqrt . fromIntegral) (10 :: Int) :: Int\n3\n</code></pre>\n\n<p>I was able to get around this by specifying a nonpolymorphic type for <code>fromIntegral</code>:</p>\n\n<pre><code>\u03bb&gt; (floor . sqrt . (fromIntegral :: Int -&gt; Double)) (10 :: Int) :: Int\n3\n</code></pre>\n\n<p>The following also works, but is even more cumbersome:</p>\n\n<pre><code>\u03bb&gt; (floor . sqrt . (fromIntegral :: (Integral a) =&gt; a -&gt; Double)) (10 :: Int) :: Int\n3\n</code></pre>\n\n<p>My questions are:</p>\n\n<ul>\n<li>Is there an easier way around the type default warnings? (Turning off <code>-Wtype-defaults</code> does not qualify.)</li>\n<li>Is this the right way to calculate the value of this composite function (floor of square root) in Haskell? Having to use <code>fromIntegral</code> and having to specify the intermediate type reminds me of the proverb \"simple things are difficult.\"</li>\n</ul>\n"}, {"tags": ["haskell", "accelerate-haskell"], "comments": [{"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 1, "creation_date": 1538047038, "post_id": 52535262, "comment_id": 92010751, "body": "There is no guarantee that <code>expand</code> returns a vector of the same length on different argument, right? So, mapping such a function over a vector would create a jagged array, which I believe, accelerate does not support. For that reason you can&#39;t map a function over an array that produces another array for each element."}, {"owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "reply_to_user": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1538047694, "post_id": 52535262, "comment_id": 92011170, "body": "@AlexeyKuleshevich There is no type-level guarantee. The library usually has a way of dealing with this problem --- <code>zip</code>s, as the simplest example are only the extent of the smallest input array. Similar solutions exist for <code>permute</code>s and <code>stencil</code>s. In the situation explained in the post, a sensible approach would be specify to fill the target array using a specified value if the vector from <code>expand</code> is too short, or to drop values if it&#39;s too long. Filling a <code>N</code>-dimensional array by <code>N-1</code> dimensional arrays at a time seems like a necessary use case."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 1, "creation_date": 1538048180, "post_id": 52535262, "comment_id": 92011470, "body": "There is a big difference from the functions you have mentioned. You know the size of the source arrays that are passed to <code>zip</code>, <code>permute</code>, <code>stencil</code>, so you can compute the size of the result array, hence you can allocate it. With a function you want, the end size of the array would depend on the content of the source array (the one you are mapping over), so you can&#39;t calculate how much memory you need to allocate ahead of time. You could potentially create a partial function that would expect a set size and throw an error if contract is broken, but that&#39;s not nice :)"}, {"owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "reply_to_user": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1538048746, "post_id": 52535262, "comment_id": 92011819, "body": "@AlexeyKuleshevich In the example, that problem is explicitly dealt with by populating a pre-allocated array (<code>arr</code>) of known shape. It could also be dealt with by specifying the shape (and, as said, a default value or matrix) upfront. I really don&#39;t see any problem there. You could even make it simpler by throwing an error if the vector from <code>expand</code> is too short, and dropping values if its too long. That&#39;s what <code>fromList</code> does if the source list is too long or short compared to the specified array shape."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1538049301, "post_id": 52535262, "comment_id": 92012158, "body": "You can&#39;t &quot;populating a pre-allocated array&quot; with accelerate, there is no mutable interface, so you can&#39;t change it&#39;s values once it has been created."}, {"owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "reply_to_user": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1538049774, "post_id": 52535262, "comment_id": 92012449, "body": "@AlexeyKuleshevich You can, using <code>permute</code>. The problem outlined in the original post is even solvable using <code>permute</code>, if <code>expand</code> returns a prelude list (still of a length unknown to the type-system) instead of a vector."}], "owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538045328, "creation_date": 1538045328, "question_id": 52535262, "link": "https://stackoverflow.com/questions/52535262/filling-a-2d-accelerate-array-one-row-at-a-time", "title": "Filling a 2D accelerate array one row at a time", "body": "<pre><code>\u03bb&gt; import Data.Array.Accelerate\n\u03bb&gt; import Data.Array.Accelerate.Interpreter (run)\n</code></pre>\n\n<p>Say you have a a 2D accelerate array:</p>\n\n<pre><code>\u03bb&gt; :t arr\narr :: Acc (Array DIM2 Int)\n\u03bb&gt; run $ unit $ shape arr\nScalar Z [Z :. 4 :. 3]\n</code></pre>\n\n<p>and a 1D accelerate vector of length 4 (the same as the number of colums of <code>arr</code>):</p>\n\n<pre><code>\u03bb&gt; :t vec\nvec :: Acc (Array DIM1 Int)\n\u03bb&gt; run $ unit $ shape vec\nScalar Z [Z :. 4]\n</code></pre>\n\n<p>and a function from a scalar to a vector of length 3:</p>\n\n<pre><code>expand :: Exp Int -&gt; Acc (Array DIM1 Int)\n</code></pre>\n\n<p>How can you populate <code>arr</code> by mapping <code>expand</code> on <code>vec</code>?</p>\n\n<p>The regular <code>map</code> from <code>Prelude</code> does not work on accelerate arrays. The <code>map</code> from <code>Data.Array.Accelerate</code> only maps from element to element. </p>\n"}, {"tags": ["haskell", "opengl", "haskell-stack", "freeglut", "nixos"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1538041657, "post_id": 52534037, "comment_id": 92007338, "body": "I&#39;d do it step by step, since there are so many abstractions at play here. Can you run some OGL diag and verify that the OpenGL actually works (with e.g. <code>glxgears</code>)? Once you confirm that, try running a freeglut example. Once that works, move to Haskell. Well, that&#39;s what I&#39;d do, anyway."}, {"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1538041850, "post_id": 52534037, "comment_id": 92007466, "body": "@BartekBanachewicz, I don&#39;t code in C."}, {"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1538041892, "post_id": 52534037, "comment_id": 92007497, "body": "@BartekBanachewicz, <code>glxgears</code> works as expected. (Installed as a package, not compiled from source)"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1538042175, "post_id": 52534037, "comment_id": 92007686, "body": "Doesn&#39;t matter how it&#39;s installed, if it works at least your driver/device is fine. Next step would be freeglut; again, I&#39;d recommend building some simple test program <a href=\"https://www.badprog.com/c-opengl-checking-the-freeglut-glew-and-opengl-version\" rel=\"nofollow noreferrer\">like this one</a> and running it."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1538050630, "post_id": 52534037, "comment_id": 92012960, "body": "Are you using NixOS or Nix with some other distribution? If you are using Nix with some other distribution, you can&#39;t really run things, that are hardware accelerated, without some hackery. (Nix tries to bring its own graphics driver, which isn&#39;t compatible with your kernel and or X server)."}, {"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1538054693, "post_id": 52534037, "comment_id": 92015499, "body": "@Krom, NixOS. But that&#39;s also interesting to know. How would someone with nix on a different distribution solve this?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1538054864, "post_id": 52534037, "comment_id": 92015637, "body": "Please include enough information in the question itself (not offsite resources) to reproduce your issue."}, {"owner": {"reputation": 160, "user_id": 5539934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f988622fe10024b8d52cc99a3bab343a?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaum", "link": "https://stackoverflow.com/users/5539934/guillaum"}, "edited": false, "score": 2, "creation_date": 1538055152, "post_id": 52534037, "comment_id": 92015827, "body": "You can use <a href=\"http://github.com/guibou/nixGL\" rel=\"nofollow noreferrer\">github.com/guibou/nixGL</a> to run any nix OpenGL application on a distribution which is not nixos."}, {"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1538058893, "post_id": 52534037, "comment_id": 92018460, "body": "@DanielWagner, I&#39;m trying, but I&#39;m running into (separate) stack problems right now, see <a href=\"https://github.com/commercialhaskell/stack/issues/4322\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/4322</a>."}, {"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1538061268, "post_id": 52534037, "comment_id": 92020099, "body": "@DanielWagner, now I have a MWE."}], "answers": [{"tags": [], "owner": {"reputation": 160, "user_id": 5539934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f988622fe10024b8d52cc99a3bab343a?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaum", "link": "https://stackoverflow.com/users/5539934/guillaum"}, "is_accepted": false, "score": 1, "last_activity_date": 1538057380, "last_edit_date": 1538057380, "creation_date": 1538056755, "answer_id": 52538807, "question_id": 52534037, "link": "https://stackoverflow.com/questions/52534037/nixos-haskell-stack-opengl-freeglut/52538807#52538807", "title": "nixOS + Haskell + stack + OpenGL + freeglut", "body": "<p>(This solution is deprecated in favor of my other solution which uses <code>nixGL</code>)</p>\n\n<p>The issue is that <code>stack</code> is overriding the <code>LD_LIBRARY_PATH</code> of your nixos installation. by default it contains something such as <code>/run/opengl-driver/lib:/run/opengl-driver-32/lib</code> and it is override by stack with the path to the library provided by stack, for me it contains: <code>/nix/store/v1d3fmjjqzd1wh84w8dmy4i3hxzgaybf-libGL-1.0.0/lib:/nix/store/y9s4bbn6j54flhpggccrmjd7cv3nkw60-glu-9.0.0/lib:/nix/store/jx7018a4yvd0x79qwp8ad15h5isy1ny3-freeglut-3.0.0/lib:/nix/store/5z8gx1bjw5s0q96n191k0a8caqr4r580-ghc-8.4.3/lib:/nix/store/yypprmw8hrmvwyhhz23w8z25yjvdhnxb-git-2.18.0/lib:/nix/store/iw94llkj05wgaz268mlzvgx8jkbi1ss0-gcc-wrapper-7.3.0/lib:/nix/store/rxaclc3vhxbzgfllv7601i85z854h48a-gmp-6.1.2/lib</code></p>\n\n<p>I don't have an easy solution, that's actually painful that stack does not change the <code>rpath</code> of your binary and instead override <code>LD_LIBRARY_PATH</code>.</p>\n\n<p>My quick and dirty solution:</p>\n\n<ul>\n<li>a) Get the <code>LD_LIBRARY_PATH</code> from inside stack:</li>\n</ul>\n\n<p><code>stack exec -- env | grep LD_LIBRARY_PATH\nLD_LIBRARY_PATH=/nix/store/v1d3fmjjqzd1wh84w8dmy4i3hxzgaybf-libGL-1.0.0/lib:/nix/store/y9s4bbn6j54flhpggccrmjd7cv3nkw60-glu-9.0.0/lib:/nix/store/jx7018a4yvd0x79qwp8ad15h5isy1ny3-freeglut-3.0.0/lib:/nix/store/5z8gx1bjw5s0q96n191k0a8caqr4r580-ghc-8.4.3/lib:/nix/store/yypprmw8hrmvwyhhz23w8z25yjvdhnxb-git-2.18.0/lib:/nix/store/iw94llkj05wgaz268mlzvgx8jkbi1ss0-gcc-wrapper-7.3.0/lib:/nix/store/rxaclc3vhxbzgfllv7601i85z854h48a-gmp-6.1.2/lib\n</code></p>\n\n<ul>\n<li>b) get your current <code>LD_LIBRARY_PATH</code>:</li>\n</ul>\n\n<p><code>$ echo $LD_LIBRARY_PATH\n/run/opengl-driver/lib:/run/opengl-driver-32/lib\n</code></p>\n\n<ul>\n<li>c) get the real path of your executable</li>\n</ul>\n\n<p><code>$ stack exec --no-nix-pure which rhine-gloss-gears\n/tmp/rhine/rhine-gloss/.stack-work/install/x86_64-linux-nix/nightly-2018-09-26/8.4.3/bin/rhine-gloss-gears\n</code></p>\n\n<p>here, <code>--no-nix-pure</code> allows <code>stack</code> to see <code>which</code> which should be available in your current environment.</p>\n\n<p>d) concatenate all of that, using:</p>\n\n<p><code>LD_LIBRARY_PATH=yourLD_LIBRARY_PATH:theOneFromStack the_executable_path\n</code></p>\n\n<p>Exemple:</p>\n\n<p><code>LD_LIBRARY_PATH=/run/opengl-driver/lib:/run/opengl-driver-32/lib:/nix/store/v1d3fmjjqzd1wh84w8dmy4i3hxzgaybf-libGL-1.0.0/lib:/nix/store/y9s4bbn6j54flhpggccrmjd7cv3nkw60-glu-9.0.0/lib:/nix/store/jx7018a4yvd0x79qwp8ad15h5isy1ny3-freeglut-3.0.0/lib:/nix/store/5z8gx1bjw5s0q96n191k0a8caqr4r580-ghc-8.4.3/lib:/nix/store/yypprmw8hrmvwyhhz23w8z25yjvdhnxb-git-2.18.0/lib:/nix/store/iw94llkj05wgaz268mlzvgx8jkbi1ss0-gcc-wrapper-7.3.0/lib:/nix/store/rxaclc3vhxbzgfllv7601i85z854h48a-gmp-6.1.2/lib /tmp/rhine/rhine-gloss/.stack-work/install/x86_64-linux-nix/nightly-2018-09-26/8.4.3/bin/rhine-gloss-gears\n</code></p>\n"}, {"comments": [{"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "edited": false, "score": 0, "creation_date": 1538057401, "post_id": 52539009, "comment_id": 92017432, "body": "Why is nixGL not part of nixpkgs? Or rather, why isn&#39;t the fix from nixGL in nixpkgs?"}, {"owner": {"reputation": 160, "user_id": 5539934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f988622fe10024b8d52cc99a3bab343a?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaum", "link": "https://stackoverflow.com/users/5539934/guillaum"}, "reply_to_user": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "edited": false, "score": 0, "creation_date": 1538478336, "post_id": 52539009, "comment_id": 92148139, "body": "Well, I should definitely submit it as a <code>nixpkgs</code> package. However that&#39;s not trivial to fix everything because it depends on the hardware AND the version of <code>nixpkgs</code> an application is built with. For example, if you have a clone of <code>nixpkgs</code> from last week and a nvidia driver, you&#39;ll need a different build of <code>nixGL</code> than me, who use a more recent clone of <code>nixpkgs</code> and an intel driver."}], "tags": [], "owner": {"reputation": 160, "user_id": 5539934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f988622fe10024b8d52cc99a3bab343a?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaum", "link": "https://stackoverflow.com/users/5539934/guillaum"}, "is_accepted": false, "score": 0, "last_activity_date": 1538057348, "creation_date": 1538057348, "answer_id": 52539009, "question_id": 52534037, "link": "https://stackoverflow.com/questions/52534037/nixos-haskell-stack-opengl-freeglut/52539009#52539009", "title": "nixOS + Haskell + stack + OpenGL + freeglut", "body": "<p>I'm just pushed a new version of <code>nixGL</code>: <a href=\"http://github.com/guibou/nixgl\" rel=\"nofollow noreferrer\">http://github.com/guibou/nixgl</a>` which allows you to run your program as:</p>\n\n<p><code>stack exec --no-nix-pure nixGLIntel rhine-gloss-gears</code></p>\n\n<p>(replace <code>nixGLIntel</code> by <code>nixGLNvidia</code> or <code>nixGLNvidiaBumblebee</code> if needed).</p>\n"}], "owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 625, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1538061255, "creation_date": 1538041451, "last_edit_date": 1538061255, "question_id": 52534037, "link": "https://stackoverflow.com/questions/52534037/nixos-haskell-stack-opengl-freeglut", "title": "nixOS + Haskell + stack + OpenGL + freeglut", "body": "<p>I have read <a href=\"https://stackoverflow.com/questions/41527061/nixos-haskell-opengl-problems-with-building-and-running-opengl-programs\">NixOS, Haskell, opengl : problems with building and running openGL programs</a> and all the other corresponding issues, but I can't get a simple Haskell gloss project (that used to work a few months ago) to work.</p>\n\n<h2>Using a github project</h2>\n\n<p>Try the following:</p>\n\n<pre><code>$ git clone https://www.github.com/turion/rhine\n$ cd rhine/\n$ cd rhine-gloss/\n$ stack build\n$ stack exec rhine-gloss-gears \nfreeglut (rhine-gloss-gears):  ERROR:  Internal error &lt;FBConfig with necessary capabilities not found&gt; in function fgOpenWindow\n</code></pre>\n\n<p>This project uses the stack nix integration as explained in <a href=\"https://stackoverflow.com/a/41588628/562583\">this answer</a>, but since <code>mesa</code> has been renamed recently, the relevant part in <code>stack.yaml</code> is now:</p>\n\n<pre><code>nix:\n  enable: true\n  packages: [libGL libGLU freeglut]\n</code></pre>\n\n<h2>From scratch</h2>\n\n<p>Make sure you have cabal, stack and nix installed. Then follow these commands:</p>\n\n<pre><code>$ mkdir tempgloss\n$ cd tempgloss\n</code></pre>\n\n<p>Create two files with these contents:</p>\n\n<pre><code>$ cat Main.hs \nimport Graphics.Gloss\nmain = display (InWindow \"Nice Window\" (200, 200) (10, 10)) white (Circle 80)\n\n$ cat stack.yaml \nresolver: lts-12.10\nnix:\n  enable: true\n  packages: [libGL libGLU freeglut]\n</code></pre>\n\n<p>Now execute:</p>\n\n<pre><code>$ cabal init --is-executable -n --main-is=Main.hs -d gloss -d base -l MIT\n[...]\n$ stack build\n[...]\n$ stack exec tempgloss \n</code></pre>\n\n<p>What's wrong here?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1538055272, "post_id": 52529801, "comment_id": 92015909, "body": "I agree that <code>[x] ++ xs</code> is harder to read here than <code>x:xs</code>, but it isn&#39;t more expensive: with optimizations on, GHC is smart enough to compile them both to the exact same code. I agree with the refactoring here, but I mention it because another common place you see this is <code>prefix ++ [val] ++ suffix</code>, and in that situation I think that is more readable than <code>prefix ++ val:suffix</code> because the former is more symmetric and does not depend on operator precedence. (Upvoted, though. This answer covers a lot of ground in an excellent way. Nice work!)"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1538066544, "post_id": 52529801, "comment_id": 92023072, "body": "You might cover <code>interact</code> as well. <code>do {in &lt;- getContents; print (f in)}</code> is more easily written as <code>interact (show . f)</code>. Thus, <code>main = interact $ show . destutter . map read . lines</code>"}], "tags": [], "owner": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "is_accepted": true, "score": 5, "last_activity_date": 1538024924, "creation_date": 1538024924, "answer_id": 52529801, "question_id": 52528547, "link": "https://stackoverflow.com/questions/52528547/read-list-of-numbers-in-haskell/52529801#52529801", "title": "Read list of numbers in haskell", "body": "<p>Use <code>getContents</code> to get <strong>all</strong> input from <code>stdin</code>. It does so lazily, so don't worry about running out of memory.</p>\n\n<p>Then separate it into lines with <code>lines</code> (or write your own function to divide it into lines for practice). This makes a <code>[String]</code> with each list element being a line in the input.</p>\n\n<p>Then <code>map</code> <code>read</code> over each element (or write your own <code>map</code> and <code>read</code> functions for practice) to turn each element from a <code>String</code> into an <code>Integer</code>.</p>\n\n<p>Now you have an <code>[Integer]</code> that you can <code>destutter</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>destutter::[Integer] -&gt; [Integer]\ndestutter [] = []\ndestutter (fst:snd:t) | fst == snd = destutter (snd : t)\ndestutter (h:t) = [h] ++ (destutter t)\n\nmain :: IO ()\nmain = do\n  userInput &lt;- getContents\n  let numbers = map read (lines userInput) :: [Integer]\n  print $ destutter numbers\n</code></pre>\n\n<h3>A few notes on improving <code>destutter</code> a little and a lot</h3>\n\n<p>You shouldn't use this if you're writing an assignment for school (your <code>destutter</code> definitely works), but as far as <code>destutter</code> goes, there are a few things to help your learning.</p>\n\n<p>A minor stylistic issue is that <code>x</code> and <code>xs</code> (or <code>y</code> and <code>ys</code> or anything of that pattern) are used for head and tail rather than <code>h</code> and <code>t</code>.</p>\n\n<p><code>[x] ++ xs</code> is harder to read (and more expensive) than <code>x:xs</code>, so your third pattern for <code>destutter</code> can be done like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>destutter (x:xs) = x:destutter xs\n</code></pre>\n\n<p><code>(:)</code> is useful for detaching elements from the front of a list in patterns <strong>and</strong> for attaching elements to the front of a list outside of patterns.</p>\n\n<hr>\n\n<p>Don't worry about this so much now, but later on, after you get the hang of writing functions from scratch, you'll begin to use prewritten functions like <code>Data.List.group</code>, which is quite similar to <code>destutter</code> as it groups equal neighbors in a list into their own sublist. If you take the first element (<code>head</code>) of each sublist (they're all equal, so one's as good as another), it does <code>destutter</code>:</p>\n\n<pre><code>import Data.List (group)\n\ndestutter :: Eq a =&gt; [a] -&gt; [a]\ndestutter xs = map head (group xs)\n</code></pre>\n\n<p>So, basically, it turns <code>[1, 2, 2, 3]</code> into <code>[[1], [2, 2], [3]]</code>, then it takes the first element of each sublist to get <code>[1, 2, 3]</code>.</p>\n\n<p>One thing to take from that is that you already know how to write a function (<code>destutter</code>) quite similar to those that they include with Haskell.</p>\n"}], "owner": {"reputation": 611, "user_id": 4534466, "user_type": "registered", "accept_rate": 31, "profile_image": "https://graph.facebook.com/908092385875713/picture?type=large", "display_name": "Jo&#227;o Areias", "link": "https://stackoverflow.com/users/4534466/jo%c3%a3o-areias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2024, "favorite_count": 1, "accepted_answer_id": 52529801, "answer_count": 1, "score": 4, "last_activity_date": 1538024924, "creation_date": 1538015402, "question_id": 52528547, "link": "https://stackoverflow.com/questions/52528547/read-list-of-numbers-in-haskell", "title": "Read list of numbers in haskell", "body": "<p>I'm learning Haskell and I was working in a problem where I had to remove repeated consecutive numbers from a list, so I wrote this program.</p>\n\n<pre><code>destutter::[Integer] -&gt; [Integer]\ndestutter [] = []\ndestutter (fst:snd:t) | fst == snd = destutter (snd : t)\ndestutter (h:t) = [h] ++ (destutter t)\n</code></pre>\n\n<p>It works fine for the input test that I had which was a list</p>\n\n<pre><code>input = [200, 271, 305, 305, 180]\n</code></pre>\n\n<p>now I have a text file with a lot of inputs and I need to use my function on it, if it was in C++ I would do something like:</p>\n\n<pre><code>while(cin&gt;&gt; x)\n    v.push_back(x);\ndestutter(x);\n</code></pre>\n\n<p>But I'm completely new to Haskell and I have no idea how I would do that on this language. I found <a href=\"https://stackoverflow.com/questions/9754794/read-until-end-of-stream-in-haskell\">this</a> answer on stack overflow but was not able to modify the code for my use, so if someone could give a noob a hand I would be very thankful. My text file has the following structure:</p>\n\n<pre><code>260\n221\n235\n268\n...\n</code></pre>\n"}]