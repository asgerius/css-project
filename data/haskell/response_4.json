[{"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1423087422, "post_id": 28332331, "comment_id": 45011756, "body": "Are you wanting the reminder during pattern matching, or when looking at the type?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1423087572, "post_id": 28332331, "comment_id": 45011841, "body": "Phantom types?  <code>data L; data R; data Tree side a = Leaf a | Branch (Tree L a) (Tree R a)</code>? Not sure if this really helps."}, {"owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1423087587, "post_id": 28332331, "comment_id": 45011852, "body": "@bheklilr I&#39;m completely new to Haskell, and it&#39;s not clear to me how I would define a type in a way that disagreed with pattern matching. So I don&#39;t really know how to answer you."}, {"owner": {"reputation": 12426, "user_id": 570682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9d9bb1af07214310ce8bd601760492a?s=128&d=identicon&r=PG", "display_name": "Lambdageek", "link": "https://stackoverflow.com/users/570682/lambdageek"}, "edited": false, "score": 2, "creation_date": 1423089262, "post_id": 28332331, "comment_id": 45012595, "body": "<code>data Tree a = TrLeaf a | TrBranch (Branch a) ; data Branch a = Branch { leftBranch :: Tree a, rightBranch :: Tree a }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 10655, "user_id": 4529124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4P3eZ.png?s=128&g=1", "display_name": "Chris Emerson", "link": "https://stackoverflow.com/users/4529124/chris-emerson"}, "is_accepted": true, "score": 4, "last_activity_date": 1423094284, "creation_date": 1423094284, "answer_id": 28333857, "question_id": 28332331, "link": "https://stackoverflow.com/questions/28332331/in-a-data-type-definition-how-can-i-name-similar-references/28333857#28333857", "title": "In a data type definition, how can I &#39;name&#39; similar references?", "body": "<p>It sounds like you want a record:</p>\n\n<pre><code>data Tree a = Leaf a | Branch { l :: Tree a, r :: Tree a}\n</code></pre>\n\n<p>Then you can have a </p>\n\n<pre><code>Leaf 3\n</code></pre>\n\n<p>or a</p>\n\n<pre><code>Branch { l=Leaf 4, r=... }\n</code></pre>\n"}], "owner": {"reputation": 21877, "user_id": 131227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/60e3c03e227b84e2898c29fd711cae5b?s=128&d=identicon&r=PG", "display_name": "z5h", "link": "https://stackoverflow.com/users/131227/z5h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 28333857, "answer_count": 1, "score": 0, "last_activity_date": 1423094284, "creation_date": 1423087321, "question_id": 28332331, "link": "https://stackoverflow.com/questions/28332331/in-a-data-type-definition-how-can-i-name-similar-references", "title": "In a data type definition, how can I &#39;name&#39; similar references?", "body": "<p>I can define a tree like so:</p>\n\n<p><code>data Tree a = Leaf a | Branch (Tree a) (Tree a)</code></p>\n\n<p>Let's say I want to remind myself that the first tree is the left tree, and the second is the right tree.</p>\n\n<p>I tried</p>\n\n<p><code>data Tree a = Leaf a | Branch (L (Tree a)) (R(Tree a))</code></p>\n\n<p>which failed. So Haskell knew <code>Branch</code> was a constructor, but couldn't do the same for <code>L</code> or <code>R</code> given this statement.</p>\n\n<p>I tried to help with:</p>\n\n<pre><code>data L a = L a\n           deriving (Show)\n\ndata R a = R a\n           deriving (Show)\n\ndata Tree a =\n  Leaf a | Branch (L (Tree a)) (R (Tree a))\n  deriving (Show)\n</code></pre>\n\n<p>This works, but now I can have an <code>L \"whatever\"</code> without it being a left branch. And more code than it seems I need to remind myself that the first tree is the 'left' and the 2nd is the 'right'.</p>\n\n<p>Is there a nicer way of doing this?</p>\n"}, {"tags": ["haskell", "io"], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 9, "last_activity_date": 1423087064, "creation_date": 1423087064, "answer_id": 28332265, "question_id": 28332207, "link": "https://stackoverflow.com/questions/28332207/how-can-i-write-an-io-string-to-stdout/28332265#28332265", "title": "How can I write an IO [String] to stdout?", "body": "<p><code>IO [String]</code> is an action that will get you strings.  If you wish to perform the action and print the results then consider:</p>\n\n<pre><code>printIOString io = putStrLn . unlines =&lt;&lt; io\n</code></pre>\n\n<p>Or with some additional notation, if you prefer:</p>\n\n<pre><code>printIOString io =\n  do strs &lt;- io\n     let rendered = unlines strs\n     putStrLn rendered\n</code></pre>\n"}], "owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 28332265, "answer_count": 1, "score": 1, "last_activity_date": 1423087064, "creation_date": 1423086821, "question_id": 28332207, "link": "https://stackoverflow.com/questions/28332207/how-can-i-write-an-io-string-to-stdout", "title": "How can I write an IO [String] to stdout?", "body": "<p>I have an <code>IO [String]</code> in <code>main</code>, which I want to write (as lines) to stdout. How?</p>\n\n<p>--newbie</p>\n"}, {"tags": ["haskell", "math", "factorial"], "comments": [{"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1423085129, "post_id": 28330687, "comment_id": 45010561, "body": "What makes you think Haskell is &quot;more powerful mathematically&quot; than C# or anything else?  That&#39;s a naive way of calculating factorial.  Look into lngamma function for a better idea."}, {"owner": {"reputation": 3901, "user_id": 465323, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/48486463225c6705e51463adcafbb240?s=128&d=identicon&r=PG", "display_name": "Z&#233;ychin", "link": "https://stackoverflow.com/users/465323/z%c3%a9ychin"}, "edited": false, "score": 0, "creation_date": 1423085676, "post_id": 28330687, "comment_id": 45010850, "body": "Why <code>lngamma</code> over <code>gamma</code>? OP doesn&#39;t want the natural logarithm of the factorial."}, {"owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 0, "creation_date": 1423100528, "post_id": 28330687, "comment_id": 45016085, "body": "Duffymo, I understand C# can be mathematically powerful as well, but from what I&#39;ve seen it takes less Haskell knowledge to make efficient code for what I need than in C#; since I&#39;m dealing with factorials, numbers grow very much very quick, in C# I had it use Biginteger to handle that, and I wasn&#39;t very comfortable with it. Basically my final code does factorials and square roots. It checks for the existence of pairs of numbers where the first factorial +1 is the second squared. [4,5], 4!=24; 24+1=25; sqrt(25)=5."}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1423150180, "post_id": 28330687, "comment_id": 45039746, "body": "Use lngamma because it defers overflow issues and it&#39;s natural for evaluating permutation and combination formulas."}, {"owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 1, "creation_date": 1423219847, "post_id": 28330687, "comment_id": 45069692, "body": "Duffymo, English isn&#39;t my native language, I&#39;m sorry if I lack the technical terms you find appropriate. I&#39;ll try to shape my vocabulary to what you find fit"}, {"owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 0, "creation_date": 1423225939, "post_id": 28330687, "comment_id": 45072807, "body": "Also, I did some small lookup on the lngamma right now (didn&#39;t go further because I&#39;m in class) and I have to say I&#39;m lost on its function. Could you provide an example of how to calculate factorials with it? Is lngamma(n)=(n-1)!?"}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 9, "last_activity_date": 1423081278, "creation_date": 1423081278, "answer_id": 28330707, "question_id": 28330687, "link": "https://stackoverflow.com/questions/28330687/haskell-print-factorial/28330707#28330707", "title": "Haskell print factorial", "body": "<p>You need parentheses:</p>\n\n<pre><code>main = do\n    print (fact 4)\n</code></pre>\n\n<p>What GHC is seeing is <code>fact</code> and <code>4</code> being passed as separate arguments to <code>print</code>, but what you want is to apply <code>4</code> to <code>fact</code>, then apply that result to <code>print</code>.  You could also use</p>\n\n<pre><code>main = do\n    print $ fact 4\n</code></pre>\n\n<p>The <code>$</code> operator doesn't do anything in itself, but it has a very low precedence, like how <code>+</code> is lower precedence than <code>*</code>, and it associates to the right, so you can write something like</p>\n\n<pre><code>f $ g . h $ m 1 $ 2 + 3\n</code></pre>\n\n<p>Instead of</p>\n\n<pre><code>f ((g . h) (m 1 (2 + 3)))\n</code></pre>\n"}], "owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 28330707, "answer_count": 1, "score": 0, "last_activity_date": 1423081278, "creation_date": 1423081196, "question_id": 28330687, "link": "https://stackoverflow.com/questions/28330687/haskell-print-factorial", "title": "Haskell print factorial", "body": "<p>I've just started programming Haskell, basically because I was looking for a more mathematically powerful language then C#, and right now I'm very confused. </p>\n\n<p>Right now I'm trying to simply find the the factorial of 4 and print that, this is what I wrote so far:</p>\n\n<pre><code>fact n = product [1..n]\nmain = do\n   print fact 4\n</code></pre>\n\n<p>When I try to debug it i get </p>\n\n<blockquote>\n  <p>Error:(3, 8) ghc: Couldn't match expected type <code>a1 -&gt; t0' with actual type</code>IO ()'\n      The function <code>print' is applied to two arguments,\n      but its type</code>(a0 -> a0) -> IO ()' has only one\n      In a stmt of a 'do' block: print fact 4\n      In the expression: do { print fact 4 }</p>\n</blockquote>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["loops", "haskell", "list-comprehension"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4521643"}, "edited": false, "score": 0, "creation_date": 1423080446, "post_id": 28330464, "comment_id": 45008070, "body": "The input for the second code would look like: applyToList [&quot;salad&quot;,&quot;bar&quot;] bar_stuff) and output: [&quot;bar&quot;, &quot;mitzva&quot;, &quot;stool&quot;, &quot;tender&quot;, &quot;keeper&quot;]"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 1, "creation_date": 1423080973, "post_id": 28330464, "comment_id": 45008396, "body": "Your code should work if you add the <code>Eq k</code> constraint to <code>applyToList</code>. You also don&#39;t need the first clause."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 1, "last_activity_date": 1423081141, "creation_date": 1423081141, "answer_id": 28330671, "question_id": 28330464, "link": "https://stackoverflow.com/questions/28330464/iterate-two-lists-haskell/28330671#28330671", "title": "Iterate two lists Haskell", "body": "<p>Your code already works if you add the <code>Eq k</code> constraint to <code>applyToList</code>:</p>\n\n<pre><code>applyToList :: Eq k =&gt; [k] -&gt; BinaryRelation k v -&gt; [v]\napplyToList keys list = do\n    key &lt;- keys\n    applyRel key list\n</code></pre>\n\n<p>You can also leave out the pattern match on <code>[]</code>.  Example of it working:</p>\n\n<pre><code>&gt; let bar_stuff = [(\"bar\", \"mitzva\"), (\"bar\", \"stool\"), (\"bar\", \"tender\"), (\"bar\", \"keeper\"), (\"salad\", \"bar\"), (\"foo\", \"bar\")]\n&gt; applyToList [\"salad\", \"bar\"] bar_stuff\n[\"bar\",\"mitzva\",\"stool\",\"tender\",\"keeper\"]\n</code></pre>\n\n<p>Or you could just use <code>concatMap</code>, which is used in the instance of <code>Monad</code> for lists anyway:</p>\n\n<pre><code>applyToList :: Eq k =&gt; [k] -&gt; BinaryRelation k v -&gt; [v]\napplyToList keys list = concatMap (flip applyRel list) keys\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4521643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 28330671, "answer_count": 1, "score": -1, "last_activity_date": 1423081141, "creation_date": 1423080366, "question_id": 28330464, "link": "https://stackoverflow.com/questions/28330464/iterate-two-lists-haskell", "title": "Iterate two lists Haskell", "body": "<p>I have this function:</p>\n\n<pre><code>applyRel :: (Eq k) =&gt; k -&gt; (BinaryRelation k v) -&gt; [v] \napplyRel key list = [ v | (k,v)&lt;-list, key==k]\n</code></pre>\n\n<p>and it takes a string, k and returns all v's with the given k:</p>\n\n<blockquote>\n  <p>applyRel \"bar\" bar_stuff</p>\n</blockquote>\n\n<p>would output</p>\n\n<blockquote>\n  <p>[\"mitzva\", \"stool\", \"tender\", \"keeper\"]</p>\n</blockquote>\n\n<p>And it works, but what if it takes in a list of strings and another list.\nCan I do something like a list recursion the iterates through a list and for each item iterates through the second list. Kinda of like a double for loop in C.</p>\n\n<p>This is what I'm kind of going towards:</p>\n\n<pre><code>applyToList :: [k] -&gt; (BinaryRelation k v) -&gt; [v]\napplyToList [] list = []\napplyToList keys list = \n     do key &lt;- keys\n        applyRel key list\n</code></pre>\n"}, {"tags": ["haskell", "types", "lazy-evaluation"], "answers": [{"comments": [{"owner": {"reputation": 1679, "user_id": 1722752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef35ad86b627ba3176b6aea8a184f51c?s=128&d=identicon&r=PG", "display_name": "MigMit", "link": "https://stackoverflow.com/users/1722752/migmit"}, "edited": false, "score": 1, "creation_date": 1423081242, "post_id": 28329695, "comment_id": 45008531, "body": "I would suggest using <code>newtype</code> instead of <code>data</code>."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 3, "last_activity_date": 1423081982, "last_edit_date": 1423081982, "creation_date": 1423077943, "answer_id": 28329695, "question_id": 28329518, "link": "https://stackoverflow.com/questions/28329518/in-haskell-how-to-represent-infinite-data-which-is-newly-defined/28329695#28329695", "title": "in haskell, how to represent infinite data which is newly defined", "body": "<p>You need <a href=\"https://wiki.haskell.org/Lazy_pattern_match\" rel=\"nofollow\">tilda</a>:</p>\n\n<pre><code>(&gt;/&gt;) :: Try -&gt; Try -&gt; Try\nT []    &gt;/&gt;     i       = i \nT ts    &gt;/&gt;     ~(T qs)    = T (ts ++ qs )\n</code></pre>\n\n<p>Also you don't need the first clause, so <code>(&gt;/&gt;)</code> can be defined as</p>\n\n<pre><code>(&gt;/&gt;) :: Try -&gt; Try -&gt; Try\n~(T ts) &gt;/&gt; ~(T qs) = T (ts ++ qs)\n</code></pre>\n\n<p>The definition of <code>(&gt;*&gt;)</code> is lazy, because there is no pattern-matching on the second argument.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>As suggested by @MigMit you can just use <code>newtype</code>, and your original definition of <code>(&gt;/&gt;)</code> will work. Have a look at the <code>2 The messy bits</code> section of <a href=\"https://wiki.haskell.org/Newtype\" rel=\"nofollow\">https://wiki.haskell.org/Newtype</a></p>\n"}, {"tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": false, "score": 4, "last_activity_date": 1423249964, "last_edit_date": 1423249964, "creation_date": 1423121540, "answer_id": 28338471, "question_id": 28329518, "link": "https://stackoverflow.com/questions/28329518/in-haskell-how-to-represent-infinite-data-which-is-newly-defined/28338471#28338471", "title": "in haskell, how to represent infinite data which is newly defined", "body": "<p>The other answer is correct in saying that one proper fix is to use a <code>~</code>-pattern (also called irrefutable pattern or lazy pattern) or a newtype, but let's look at the <em>why</em> ...</p>\n\n<p>Here are your definitions again for reference:</p>\n\n<pre><code>(&gt;/&gt;) :: Try -&gt; Try -&gt; Try\nT []    &gt;/&gt;     i       = i \nT ts    &gt;/&gt;     T qs    = T (ts ++ qs)\n\ninfi2 r = T [r] &gt;/&gt; infi2 r -- I've omitted unnecessary parentheses\n</code></pre>\n\n<p>Now, if you call <code>infi2 1</code>, the following reduction happens:</p>\n\n<pre><code>   infi2 1\n\n=    { expanding the definition of infi2 }\n\n   T [1] &gt;/&gt; infi2 1\n</code></pre>\n\n<p>Now this is the important point. We want to reduce the outermost function,\nwhich is <code>&gt;/&gt;</code>. But we have to decide which of the cases applies. It's easy\nto see that the first one does not, because <code>T [1]</code> does not match <code>T []</code>. The second case, however, requires the second argument of <code>&gt;/&gt;</code> to be of shape <code>T qs</code>, and we have <code>infi2 1</code>. Even though <code>Try</code> has only one constructor, GHC/Haskell will not make such a leap of faith. Instead, it will evaluate <code>infi2 1</code> further until it learns its outermost constructor. So the next reduction step is</p>\n\n<pre><code>   T [1] &gt;/&gt; infi2 1\n\n=    { expanding the definition of infi2 }\n\n   T [1] &gt;/&gt; (T [1] &gt;/&gt; infi2 1)\n</code></pre>\n\n<p>Now we're in exactly the same situation again. We can still not reduce the outermost <code>&gt;/&gt;</code> because we don't know the constructor of the right argument; so we have to reduce that further. But there, again, we need to reduce the\nright argument further to learn about the constructor of the right argument of the inner <code>&gt;/&gt;</code>:</p>\n\n<pre><code>   T [1] &gt;/&gt; (T [1] &gt;/&gt; infi2 1)\n\n=    { expanding the definition of infi2 }\n\n   T [1] &gt;/&gt; (T [1] &gt;/&gt; infi2 1)\n\n=    { expanding the definition of infi2 }\n\n   T [1] &gt;/&gt; (T [1] &gt;/&gt; (T [1] &gt;/&gt; infi2 1))\n\n=    ...\n</code></pre>\n\n<p>This will continue indefinitely until memory fills up. We can never make any\nreal progress.</p>\n\n<p>Looking back at the original definitions once more, it's (with a bit of practice) actually possible to see this without doing the entire expansion:</p>\n\n<pre><code>(&gt;/&gt;) :: Try -&gt; Try -&gt; Try\nT []    &gt;/&gt;     i       = i \nT ts    &gt;/&gt;     T qs    = T (ts ++ qs)\n\ninfi2 r = T [r] &gt;/&gt; infi2 r\n</code></pre>\n\n<p>In the second case of the definition of <code>&gt;/&gt;</code>, we produce a <code>T</code> only <em>after</em> we know that both arguments are <code>T</code>s. So in <code>infi2 r</code>, we can only reduce the outer <code>&gt;/&gt;</code> after <code>infi2 r</code> returns, but that's a recursive call ...</p>\n\n<p>Now about the solutions that address this:</p>\n\n<h3>Use an newtype</h3>\n\n<p>With</p>\n\n<pre><code>newtype Try = T [Int]\n  deriving (Show)\n</code></pre>\n\n<p>instead of <code>data</code>, pattern matching on <code>T</code> becomes a no-op. A newtype is guaranteed to have the same runtime representation as the underlying type (here <code>[Int]</code>), and applying the constructor <code>T</code> or pattern matching has an effect on converting the types, but no effect at runtime.</p>\n\n<p>Therefore, once we have</p>\n\n<pre><code>T [1] &gt;/&gt; infi2 1\n</code></pre>\n\n<p>in order to make a decision for one of the cases, we now only see that the first list is nonempty, so the first case cannot apply. The second case has left hand side</p>\n\n<pre><code>T ts &gt;/&gt; T qs = ...\n</code></pre>\n\n<p>which under the assumption that pattern matching on <code>T</code> is a noop is trivially true and can immediately be reduced.</p>\n\n<h3>Using a <code>~</code>-pattern</h3>\n\n<p>Similarly, if we keep using <code>data</code>, but write</p>\n\n<pre><code>T ts &gt;/&gt; ~(T qs) = ...\n</code></pre>\n\n<p>we change the behaviour of GHC/Haskell to actually make the \"leap of faith\" I talked about above. An irrefutable pattern match succeeds automatically, so it never causes further evaluation. In the case of single-constructor datatypes such as <code>Try</code>, this is essentially safe to do. However, if you do such a lazy pattern match on a multi-constructor datatype and it turns out that the value you're matching against is not of the constructor appearing in your pattern, the match will still succeed, and you'll get a runtime exception once you try to use values from inside the pattern.</p>\n\n<h3>Explicitly extracting</h3>\n\n<p>A third option is to write an extraction function</p>\n\n<pre><code>unT :: Try -&gt; [Int]\nunT (T ts) = ts\n</code></pre>\n\n<p>and then say</p>\n\n<pre><code>(&gt;/&gt;) :: Try -&gt; Try -&gt; Try\nT []    &gt;/&gt;     i       = i \nT ts    &gt;/&gt;     qs      = T (ts ++ unT qs)\n</code></pre>\n\n<p>This makes it obvious that we don't expect anything of the second argument\nat the time of the pattern match. This version very much corresponds to what the <code>~</code>-pattern-version will compile to.</p>\n\n<p>To conclude, let's look at the reduction now:</p>\n\n<pre><code>   infi2 1\n\n=    { expanding the definition of infi2 }\n\n   T [1] &gt;/&gt; infi2 1\n\n=    { expanding the definition of &gt;/&gt; }\n\n   T ([1] ++ unT (infi2 1))\n</code></pre>\n\n<p>Assuming we want to print the result and a full reduction, let's continue from here for a bit:</p>\n\n<pre><code>   T ([1] ++ unT (infi2 1))\n\n=    { expanding the definition of ++ }\n\n   T (1 : unT (infi2 1))\n\n=    { expanding the definition of infi2 }\n\n   T (1 : unT (T [1] &gt;/&gt; infi2 1))\n\n=    { expanding the definition of &gt;/&gt; }\n\n   T (1 : unT (T ([1] ++ unT (infi2 1))))\n\n=    { expanding the definition of the outer unT }\n\n   T (1 : ([1] ++ unT (infi2 1)))\n</code></pre>\n\n<p>At this point, it should be obvious that we indeed get the infinite list incrementally.</p>\n"}], "owner": {"reputation": 97, "user_id": 4451068, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100006580601533/picture?type=large", "display_name": "Troy  Yao", "link": "https://stackoverflow.com/users/4451068/troy-yao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 28329695, "answer_count": 2, "score": 2, "last_activity_date": 1423249964, "creation_date": 1423077284, "question_id": 28329518, "link": "https://stackoverflow.com/questions/28329518/in-haskell-how-to-represent-infinite-data-which-is-newly-defined", "title": "in haskell, how to represent infinite data which is newly defined", "body": "<p>I defined a new data type in Haskell in the following way:</p>\n\n<pre><code>data Pro = P Int Pro | Idle\n              deriving Show\n</code></pre>\n\n<p>Then I defined a operator which works for this new data type:</p>\n\n<pre><code>(&gt;*&gt;) :: Pro -&gt; Pro -&gt; Pro\nIdle        &gt;*&gt;   ps  = ps\nP i ps      &gt;*&gt;   qs  = P i (ps &gt;*&gt; qs)\n</code></pre>\n\n<p>So, <code>infi r = P r Idle &gt;*&gt; (infi (r+1))</code> could represent the infinite data and if I type the infi4 1 in the terminal, it will print infinitely.</p>\n\n<p>Later, I realized that this new data type definition could be modified to:</p>\n\n<pre><code>data Try = T [Int] \n     deriving Show\n</code></pre>\n\n<p>They are quite similar and the later one is kind of list, which seems easier.\nBut when I defined the following infinite data:</p>\n\n<pre><code>(&gt;/&gt;) :: Try -&gt; Try -&gt; Try\nT []    &gt;/&gt;     i       = i \nT ts    &gt;/&gt;     T qs    = T (ts ++ qs )\n\ninfi2 r = (T [r]) &gt;/&gt; (infi2 r)\n</code></pre>\n\n<p>and tried to print it in the terminal, it showed that :</p>\n\n<pre><code>Exception: stack overflow\n</code></pre>\n\n<p>It seems that the lazy property of Haskell will not works on this new data type. Dose anyone could tell me the reason and how to print the infinite data by the second data type.</p>\n"}, {"tags": ["haskell", "eclipse-plugin"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1423078727, "post_id": 28329460, "comment_id": 45007149, "body": "If I remember correctly, eclipseFP uses cabal to build projects. If this is the case, you should put your language options (and other options) in your cabal file, like normal."}, {"owner": {"reputation": 293, "user_id": 4530052, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/67c7db4146b0cff401bf789ce8ed8fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Oxy", "link": "https://stackoverflow.com/users/4530052/oxy"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1423080970, "post_id": 28329460, "comment_id": 45008391, "body": "I already have the extensions in the cabal file. I am not sure if eclipseFP is using the cabal file since it&#39;s built fine from the command line."}, {"owner": {"reputation": 967, "user_id": 851370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yVAnU.jpg?s=128&g=1", "display_name": "Nick Dickinson-Wilde", "link": "https://stackoverflow.com/users/851370/nick-dickinson-wilde"}, "edited": false, "score": 0, "creation_date": 1423082840, "post_id": 28329460, "comment_id": 45009383, "body": "Did you test it to see if it works?"}, {"owner": {"reputation": 293, "user_id": 4530052, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/67c7db4146b0cff401bf789ce8ed8fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Oxy", "link": "https://stackoverflow.com/users/4530052/oxy"}, "reply_to_user": {"reputation": 967, "user_id": 851370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yVAnU.jpg?s=128&g=1", "display_name": "Nick Dickinson-Wilde", "link": "https://stackoverflow.com/users/851370/nick-dickinson-wilde"}, "edited": false, "score": 0, "creation_date": 1423086155, "post_id": 28329460, "comment_id": 45011108, "body": "@NickWilde: As I said, it works fine when I compile it from the command line using cabal. But eclipsePF shows lots of errors about the language extensions in my source files. If I add <code>{-# LANGUAGE ...}</code> directive on top of a source file, the errors go away, only in that file. Of course I can repeat the same thing in all files to get rid of errors. But I wonder if I can tell eclipsePF to use these extensions globally. In cabal, it it as simple as listing them under <code>extension:</code> tag, but why eclipsePF does not recognize the extensions listed in the cabal file?"}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 4530052, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/67c7db4146b0cff401bf789ce8ed8fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Oxy", "link": "https://stackoverflow.com/users/4530052/oxy"}, "edited": false, "score": 0, "creation_date": 1423161278, "post_id": 28346094, "comment_id": 45046636, "body": "It is. And it shows <code>[proj-name built_script]</code> beside the project name."}], "tags": [], "owner": {"reputation": 1, "user_id": 4533262, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/ff27aceb096e17ddf3b8e3665b1e02c0?s=128&d=identicon&r=PG", "display_name": "user4533262", "link": "https://stackoverflow.com/users/4533262/user4533262"}, "is_accepted": false, "score": 0, "last_activity_date": 1423145337, "creation_date": 1423145337, "answer_id": 28346094, "question_id": 28329460, "link": "https://stackoverflow.com/questions/28329460/language-extensions-for-haskell-in-eclipsefp/28346094#28346094", "title": "Language extensions for Haskell in EclipseFP", "body": "<p>Make sure the name of cabal file is the same as the name of Eclipse project.</p>\n"}], "owner": {"reputation": 293, "user_id": 4530052, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/67c7db4146b0cff401bf789ce8ed8fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Oxy", "link": "https://stackoverflow.com/users/4530052/oxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423145337, "creation_date": 1423077065, "question_id": 28329460, "link": "https://stackoverflow.com/questions/28329460/language-extensions-for-haskell-in-eclipsefp", "title": "Language extensions for Haskell in EclipseFP", "body": "<p>I recently started using eclipseFP and imported an existing project that I used to build with cabal. I have some language extensions in my cabal file to avoid repeating <code>{-# LANGUAGE ...}</code> in each source file. But I have no idea how to do the same thing with eclipseFP. Could somebody tell me how can I specify for eclipseFP what language extensions to use when building the project?</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 1133001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c93fe316c9194850a854fa05a2bf682?s=128&d=identicon&r=PG", "display_name": "Colin McEnearney", "link": "https://stackoverflow.com/users/1133001/colin-mcenearney"}, "edited": false, "score": 0, "creation_date": 1423077861, "post_id": 28329377, "comment_id": 45006696, "body": "Thanks!  My issue before was actually in my property"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 7, "last_activity_date": 1423077056, "last_edit_date": 1423077056, "creation_date": 1423076753, "answer_id": 28329377, "question_id": 28329303, "link": "https://stackoverflow.com/questions/28329303/how-can-i-constrain-a-quickcheck-parameter-to-a-list-of-non-empty-strings/28329377#28329377", "title": "How can I constrain a QuickCheck parameter to a list of non-empty Strings?", "body": "<p>You use <a href=\"http://hackage.haskell.org/package/QuickCheck-2.7.6/docs/Test-QuickCheck.html#v:forAll\" rel=\"noreferrer\"><code>forAll</code></a> together with <a href=\"http://hackage.haskell.org/package/QuickCheck-2.7.6/docs/Test-QuickCheck.html#v:listOf\" rel=\"noreferrer\"><code>listOf</code></a> (which generates lists) and <a href=\"http://hackage.haskell.org/package/QuickCheck-2.7.6/docs/Test-QuickCheck.html#v:listOf1\" rel=\"noreferrer\"><code>listOf1</code></a> (which generates non-empty lists).</p>\n\n<h3>Examples</h3>\n\n<pre><code>quickCheck $ forAll (listOf $ listOf1 arbitrary) $ myProp\n</code></pre>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- more verbose alternative to make things clear\nnonEmptyString :: Gen String\nnonEmptyString = listOf1 arbitrary\n\nquickCheck $ forAll (listOf nonEmptyString) $ myProp\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "is_accepted": false, "score": 2, "last_activity_date": 1423085847, "creation_date": 1423085847, "answer_id": 28331941, "question_id": 28329303, "link": "https://stackoverflow.com/questions/28329303/how-can-i-constrain-a-quickcheck-parameter-to-a-list-of-non-empty-strings/28331941#28331941", "title": "How can I constrain a QuickCheck parameter to a list of non-empty Strings?", "body": "<p>Or, from first principles (no library functions):</p>\n\n<pre><code>quickCheck $ \\ h t -&gt; let {s :: String ; s = h : t } in length s &gt; 0\n</code></pre>\n\n<p>here <code>s</code> runs through all non-empty values. </p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471713024, "post_id": 39043269, "comment_id": 65462671, "body": "Sorry... I should have explained my edit. I just liked your approach a lot and figured the code should be fixed to do what the OP requested."}, {"owner": {"reputation": 4681, "user_id": 1264328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/786f8275d9fa334bc27630e0fc7f0d22?s=128&d=identicon&r=PG", "display_name": "bwroga", "link": "https://stackoverflow.com/users/1264328/bwroga"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1471717886, "post_id": 39043269, "comment_id": 65464276, "body": "@dfeuer No problem. I didn&#39;t read the OP&#39;s question very carefully, and didn&#39;t understand your edit at first. Thanks for the fix."}], "tags": [], "owner": {"reputation": 4681, "user_id": 1264328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/786f8275d9fa334bc27630e0fc7f0d22?s=128&d=identicon&r=PG", "display_name": "bwroga", "link": "https://stackoverflow.com/users/1264328/bwroga"}, "is_accepted": false, "score": 3, "last_activity_date": 1471705822, "last_edit_date": 1471705822, "creation_date": 1471622101, "answer_id": 39043269, "question_id": 28329303, "link": "https://stackoverflow.com/questions/28329303/how-can-i-constrain-a-quickcheck-parameter-to-a-list-of-non-empty-strings/39043269#39043269", "title": "How can I constrain a QuickCheck parameter to a list of non-empty Strings?", "body": "<pre><code>import Test.QuickCheck.Modifiers (NonEmptyList (..))\n\nmyProp :: [NonEmptyList Char] -&gt; Bool\nmyProp xs0 =\n  let xs = map getNonEmpty xs0\n  in ...\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 1133001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c93fe316c9194850a854fa05a2bf682?s=128&d=identicon&r=PG", "display_name": "Colin McEnearney", "link": "https://stackoverflow.com/users/1133001/colin-mcenearney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1342, "favorite_count": 2, "accepted_answer_id": 28329377, "answer_count": 3, "score": 5, "last_activity_date": 1471705822, "creation_date": 1423076494, "question_id": 28329303, "link": "https://stackoverflow.com/questions/28329303/how-can-i-constrain-a-quickcheck-parameter-to-a-list-of-non-empty-strings", "title": "How can I constrain a QuickCheck parameter to a list of non-empty Strings?", "body": "<p>I have a property that takes a list of Strings:</p>\n\n<p><code>myProp :: [String] -&gt; Bool</code></p>\n\n<p>I need to constrain the inputs that QuickCheck generates so that only non-empty strings are in the list.</p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1423070743, "post_id": 28327491, "comment_id": 45002773, "body": "a) don&#39;t update cabal on windows via that - use a separate binary downloaded from cabal website, run that instead in its own folder and update the global instance b) use <code>-v</code>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1423071677, "post_id": 28327491, "comment_id": 45003313, "body": "Does your username include any spaces?"}], "answers": [{"tags": [], "owner": {"reputation": 1057, "user_id": 2979439, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8650f211424be695c8abb2cd364c9e97?s=128&d=identicon&r=PG&f=1", "display_name": "dev1223", "link": "https://stackoverflow.com/users/2979439/dev1223"}, "is_accepted": false, "score": 1, "last_activity_date": 1423089659, "creation_date": 1423089659, "answer_id": 28332943, "question_id": 28327491, "link": "https://stackoverflow.com/questions/28327491/cabal-does-not-exists-message-in-windows-7/28332943#28332943", "title": "Cabal: Does not exists message in windows 7", "body": "<p>Everithing is right now. I removed Mingw which I have installed previousli. GHC uses LD which isn't come with it, and that's caused that error.</p>\n"}], "owner": {"reputation": 1057, "user_id": 2979439, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8650f211424be695c8abb2cd364c9e97?s=128&d=identicon&r=PG&f=1", "display_name": "dev1223", "link": "https://stackoverflow.com/users/2979439/dev1223"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423089659, "creation_date": 1423070364, "last_edit_date": 1423071939, "question_id": 28327491, "link": "https://stackoverflow.com/questions/28327491/cabal-does-not-exists-message-in-windows-7", "title": "Cabal: Does not exists message in windows 7", "body": "<p>When I try to update cabal, I get this.</p>\n\n<pre><code>Resolving dependencies...\nConfiguring cabal-install-1.22.0.0...\ncabal: does not exist\nFailed to install cabal-install-1.22.0.0\ncabal: Error: some packages failed to install:\ncabal-install-1.22.0.0 failed during the configure step. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>Content of my PATH variable is</p>\n\n<pre><code>C:\\Users\\.....\\AppData\\Roaming\\cabal\\bin;C:\\opt\\gtk\\bin\n</code></pre>\n\n<p>What to do now?</p>\n\n<p>EDIT: It's not only problem of cabal-install it's a problem of all packages ...</p>\n\n<p>EDIT: My username not include any spaces </p>\n"}, {"tags": ["haskell", "layout", "rules"], "comments": [{"owner": {"reputation": 12675, "user_id": 636009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IIQJV.jpg?s=128&g=1", "display_name": "David Conrad", "link": "https://stackoverflow.com/users/636009/david-conrad"}, "edited": false, "score": 0, "creation_date": 1423079354, "post_id": 28322698, "comment_id": 45007467, "body": "I&#39;m not sure I&#39;ve ever seen a question this well researched. Kudos."}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 4528300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tIipu.png?s=128&g=1", "display_name": "memexor", "link": "https://stackoverflow.com/users/4528300/memexor"}, "edited": false, "score": 0, "creation_date": 1423063731, "post_id": 28324460, "comment_id": 44997842, "body": "Excellent answer!  Thanks!  Questions 1 through 4 are now accounted for, but Question 5 still remains if anyone can answer it (admittedly, Question 5 is no longer all that crucial to me now, but I&#39;d still be interested in an answer to it if someone had one)."}, {"owner": {"reputation": 323, "user_id": 4528300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tIipu.png?s=128&g=1", "display_name": "memexor", "link": "https://stackoverflow.com/users/4528300/memexor"}, "edited": false, "score": 1, "creation_date": 1423065017, "post_id": 28324460, "comment_id": 44998730, "body": "Great suggestion about using the -ddump-parsed flag ... I&#39;ll be sure to keep it in mind!"}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 26, "last_activity_date": 1423074023, "last_edit_date": 1423074023, "creation_date": 1423061975, "answer_id": 28324460, "question_id": 28322698, "link": "https://stackoverflow.com/questions/28322698/perplexed-by-how-this-code-is-processed-by-haskells-layout-facility/28324460#28324460", "title": "Perplexed by how this code is processed by Haskell&#39;s Layout facility", "body": "<p>This is a <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/bugs-and-infelicities.html#infelicities-syntax\" rel=\"noreferrer\">known and documented deviation</a> of GHC from the Haskell standard in default or Haskell 98 mode.</p>\n\n<p>GHC has a language extension called <code>NondecreasingIndentation</code> that can be used to trigger this behaviour. If enabled, a <code>do</code> keyword introduces a new block even if the next token starts at the same indentation level as the surrounding block.</p>\n\n<p>If you don't want this, say either <code>-XNoNondecreasingIndentation</code> or <code>-XHaskell2010</code> (or use language pragmas accordingly).</p>\n\n<p>You can view a pretty-printed version of the code that GHC parsed by passing the <code>-ddump-parsed</code> flag to GHC. This will only partially remove layout (it does so for do-blocks, but e.g. not for let), but might still provide clues.</p>\n"}], "owner": {"reputation": 323, "user_id": 4528300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tIipu.png?s=128&g=1", "display_name": "memexor", "link": "https://stackoverflow.com/users/4528300/memexor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "accepted_answer_id": 28324460, "answer_count": 1, "score": 32, "last_activity_date": 1423074023, "creation_date": 1423056671, "last_edit_date": 1423057017, "question_id": 28322698, "link": "https://stackoverflow.com/questions/28322698/perplexed-by-how-this-code-is-processed-by-haskells-layout-facility", "title": "Perplexed by how this code is processed by Haskell&#39;s Layout facility", "body": "<p>Whilst browsing <a href=\"https://wiki.haskell.org/IO_inside\">https://wiki.haskell.org/IO_inside</a>, I encountered the following commentary and code ...</p>\n\n<blockquote>\n  <p>\"Moreover, Haskell layout rules allow us to use the following layout: </p>\n\n<pre><code>main = do a &lt;- readLn\n          if (a&gt;=0) then return ()\n            else do\n          print \"a is negative\"\n          ...\n</code></pre>\n  \n  <p>that may be useful for escaping from the middle of a longish 'do' statement.\"</p>\n</blockquote>\n\n<p>Hereafter, I'll use the symbol C* to refer to the above code.</p>\n\n<p>I presume that the intention of C* is to read in a number, and then:<br>\n(i) If it's non-negative, do nothing.<br>\n(ii) If it's negative, display output stating that it is.</p>\n\n<p>My initial reaction was to think that C* would either not parse correctly, or would not behave as expected.</p>\n\n<p>I thought that Layout would insert an empty set of braces and a semicolon immediately following the second 'do' because the lexeme 'print' is not indented more than the indentation level of the current layout context established by the 'a' in \"a &lt;- readLn\".</p>\n\n<p>That is, my prediction for the layout-insensitive code (hereafter, referred to as C') generated by Layout would be something like:</p>\n\n<pre><code>main = do {\n          a &lt;- readLn;\n          if (a&gt;=0) then return ()\n            else do {};\n          print \"a is negative\"\n          ...\n          }\n</code></pre>\n\n<p>That I thought this would be the case, was based on the following sentence contained in section 2.7 ('Lexical Structure' : 'Layout') of Part 1 of the Haskell 2010 Language Report (<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellpa1.html\">https://www.haskell.org/onlinereport/haskell2010/haskellpa1.html</a>):</p>\n\n<p>\"If the indentation of the non-brace lexeme immediately following a where, let, do or of is less than or equal to the current indentation level, then instead of starting a layout, an empty list \u201c{}\u201d is inserted, and layout processing occurs for the current level (i.e. insert a semicolon or close brace).\"</p>\n\n<p>A more detailed account of the Layout rules is given in section 10.3 ('Syntax Reference' : 'Layout') of Part 1 (URL given above) of the Haskell 2010 Language Report.</p>\n\n<p>On reading this more detailed account, I felt reassured that my prediction for the layout-insensitive code generated by Layout (i.e. C') was correct.</p>\n\n<p>However, to my surprise, when I tried the original code stipulated above (i.e. C*) in GHCi, it worked (parsed correctly and behaved as expected).</p>\n\n<p>Questions ...</p>\n\n<ol>\n<li><p>Is the sentence I quoted above (from section 2.7) accurate?</p></li>\n<li><p>Is the detailed account of the Layout rules mentioned above (from section 10.3) accurate?</p></li>\n<li><p>What are the flaw(s) in the reasoning I employed to arrive at my prediction for the layout-insensitive code (i.e. C') generated by Layout for the original code C* ?</p></li>\n<li><p>What is the layout-insensitive code produced by Layout for the original code stipulated above (i.e. for C*), and what are the rules / principles that explain it?</p></li>\n<li><p>In general, is there a way that I can view the layout-insensitive code generated by Layout?  If so, what is it (please detail /explain the technique at a level suitable for someone new to Haskell, like me)?</p></li>\n</ol>\n"}, {"tags": ["haskell", "bootstrapping", "happy", "alex"], "answers": [{"comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1423019907, "post_id": 28312828, "comment_id": 44976091, "body": "Ah ok. Someone had given me a source ball for the haskell platform, and the version they&#39;d grabbed, for some reason, didn&#39;t have the generated sources in it. I was wondering why it didn&#39;t build on my system, and now I know."}], "tags": [], "owner": {"reputation": 1650, "user_id": 1292223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98458fe74447603906e51a6f74039c4a?s=128&d=identicon&r=PG", "display_name": "kini", "link": "https://stackoverflow.com/users/1292223/kini"}, "is_accepted": true, "score": 10, "last_activity_date": 1423019062, "creation_date": 1423019062, "answer_id": 28312828, "question_id": 28312759, "link": "https://stackoverflow.com/questions/28312759/how-do-happy-and-alex-bootstrap-themselves-into-being/28312828#28312828", "title": "How do Happy and Alex bootstrap themselves into being?", "body": "<p>I see that you are looking at the source tree of the darcs repositories for these packages on darcs.haskell.org. If you look at the actual tarballs on Hackage, you'll see something a bit different:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/alex-3.1.4/src/dist/build/alex/alex-tmp/\" rel=\"noreferrer\">https://hackage.haskell.org/package/alex-3.1.4/src/dist/build/alex/alex-tmp/</a></p>\n\n<p><a href=\"https://hackage.haskell.org/package/happy-1.19.5/src/dist/build/happy/happy-tmp/\" rel=\"noreferrer\">https://hackage.haskell.org/package/happy-1.19.5/src/dist/build/happy/happy-tmp/</a></p>\n\n<p>So basically the build artifacts necessary are shipped with the Hackage tarball.  Cabal then just uses the build artifacts during the build process, thus avoiding the need to bootstrap locally.  Cabal also knows how to preserve such build artifacts when you run <code>cabal sdist</code> for your own packages which you want not to depend on happy or alex, but last I checked this doesn't interoperate well with sandboxes, fwiw.</p>\n\n<p>By the way, alex and happy development has moved to github:</p>\n\n<p><a href=\"https://github.com/simonmar/alex/\" rel=\"noreferrer\">https://github.com/simonmar/alex/</a></p>\n\n<p><a href=\"https://github.com/simonmar/happy/\" rel=\"noreferrer\">https://github.com/simonmar/happy/</a></p>\n"}], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 28312828, "answer_count": 1, "score": 10, "last_activity_date": 1423078455, "creation_date": 1423018533, "last_edit_date": 1423078455, "question_id": 28312759, "link": "https://stackoverflow.com/questions/28312759/how-do-happy-and-alex-bootstrap-themselves-into-being", "title": "How do Happy and Alex bootstrap themselves into being?", "body": "<p>The source tree for <code>happy</code> contains <a href=\"http://darcs.haskell.org/happy/src/AttrGrammarParser.ly\"><code>AttrGrammarParser.ly</code></a> and <a href=\"http://darcs.haskell.org/happy/src/Parser.ly\"><code>Parser.ly</code></a> and the source tree for <code>alex</code> contains <a href=\"http://darcs.haskell.org/alex/src/Scan.x\"><code>Scan.x</code></a>. Yet, as far as I can tell in order to compile <code>happy</code>, we need to transform the <code>.ly</code> files into <code>.lhs</code> files using... <code>happy</code>, and in order to compile <code>alex</code> we need to transform the <code>.x</code> files into <code>.hs</code> files using... <code>alex</code>.</p>\n\n<p>So it seems like there must be some bootstrapping going on here in order to compile either tool.</p>\n\n<p>The <code>Setup.lhs</code> files for each project contain some template expansion, but, as far as I can tell, don't do anything in particular to do the bootstrapping.</p>\n\n<p>How and where is the bootstrapping done?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1423017940, "post_id": 28312167, "comment_id": 44975589, "body": "Gabriel Gonzalez&#39;s <a href=\"http://www.haskellforall.com/2012/08/the-category-design-pattern.html\" rel=\"nofollow noreferrer\">series</a> <a href=\"http://www.haskellforall.com/2014/04/scalable-program-architectures.html\" rel=\"nofollow noreferrer\">of</a> <a href=\"http://www.haskellforall.com/2014/04/model-view-controller-haskell-style.html\" rel=\"nofollow noreferrer\">articles</a> on <code>Monoid</code>s demonstrates <a href=\"http://www.haskellforall.com/2014/07/equational-reasoning-at-scale.html\" rel=\"nofollow noreferrer\">very useful properties of <code>Applicative</code>s</a>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1423027207, "post_id": 28312167, "comment_id": 44977865, "body": "One common idiom is <a href=\"https://github.com/pcapriotti/optparse-applicative\" rel=\"nofollow noreferrer\">applicative parsing</a>."}, {"owner": {"reputation": 40039, "user_id": 699224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4feb08afcd7c57acb72bd49fc2bf834d?s=128&d=identicon&r=PG", "display_name": "DNA", "link": "https://stackoverflow.com/users/699224/dna"}, "edited": false, "score": 0, "creation_date": 1423047752, "post_id": 28312167, "comment_id": 44988008, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/7103864/what-are-practical-uses-of-applicative-style\">What are practical uses of applicative style?</a>"}, {"owner": {"reputation": 15873, "user_id": 139667, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e083e1865879535bb75306472b4ba5d0?s=128&d=identicon&r=PG&f=1", "display_name": "Trident D&#39;Gao", "link": "https://stackoverflow.com/users/139667/trident-dgao"}, "edited": false, "score": 1, "creation_date": 1423059049, "post_id": 28312167, "comment_id": 44994698, "body": "yeah, might be, too bad we got some nice answers here already"}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 1, "creation_date": 1423071139, "post_id": 28312167, "comment_id": 45003013, "body": "Partial application! I use <code>(&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b</code> with infix <code>fmap</code>, <code>(&lt;$&gt;) :: (a -&gt; b) -&gt; f a -&gt; f b</code> so that if <code>f :: a -&gt; b -&gt; c -&gt; d</code> and <code>fa :: f a</code> etc then <code>f &lt;$&gt; fa &lt;*&gt; fb &lt;*&gt; fc :: f d</code>. Notice that <code>f &lt;$&gt; fa :: f (b -&gt; c -&gt; d)</code> and <code>f &lt;$&gt; fa &lt;*&gt; fb :: f (c -&gt; d)</code> so that finally <code>f &lt;$&gt; fa &lt;*&gt; fb &lt;*&gt; fc :: f d</code>. I almost never use <code>&lt;*&gt;</code> without <code>&lt;$&gt;</code>. Your question arises because you don&#39;t usually think to make things of type <code>f (a -&gt; b)</code>, but these exist as intermediate values. I could have <code>(+) &lt;$&gt; readLn :: IO (Int -&gt; Int)</code> so that <code>(+) &lt;$&gt; readLn &lt;$&gt; readLn :: IO Int</code>"}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 7, "last_activity_date": 1423015710, "creation_date": 1423015710, "answer_id": 28312333, "question_id": 28312167, "link": "https://stackoverflow.com/questions/28312167/what-is-the-purpose-of-an-applicative-functor/28312333#28312333", "title": "What is the purpose of an applicative functor?", "body": "<p>Applicatives can be used for lots of stuff that you might also do with a monad, but that don't really need the stronger features of that class. (More precisely, whenever <em>the &ldquo;shape&rdquo; of the functor doesn't depend on values within</em>, then <code>Applicative</code> is sufficient.) For instance, an action like</p>\n\n<pre><code>foobar :: IO [String]\nfoobar = do\n   fooTxt &lt;- readFile \"foo.txt\"\n   barTxt &lt;- readFile \"bar.txt\"\n   return $ zip (lines fooTxt) (lines barTxt)\n</code></pre>\n\n<p>could as well be written</p>\n\n<pre><code>foobar = zip &lt;$&gt; (lines &lt;$&gt; readFile \"foo.txt\")\n             &lt;*&gt; (lines &lt;$&gt; readFile \"bar.txt\")\n</code></pre>\n\n<p>In this case, that makes it merely a tad shorter, but in other cases it may also improve performance (because <code>Applicative</code> is less general, more optimisations are possible) or allow you to make code more generic than when you use the <code>Monad</code> interface.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1423030475, "post_id": 28312353, "comment_id": 44978943, "body": "It also seems to me that the <code>Applicative</code> laws are easier to express and at least somewhat more intuitive using <code>&lt;*&gt;</code> than using <code>liftA2</code>."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1423034696, "post_id": 28312353, "comment_id": 44980677, "body": "@dfeuer: But perhaps even easier if we used <code>&lt;,&gt; :: Applicative f -&gt; f a -&gt; f b -&gt; f (a, b)</code> as the basic operator instead. The associative law becomes <code>(x &lt;,&gt; y) &lt;,&gt; z == x &lt;,&gt; (y &lt;,&gt; z)</code>.  But the problem with that is that we don&#39;t want <code>Applicative</code> instances allocating useless pairs at runtime..."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 3, "last_activity_date": 1423016586, "last_edit_date": 1423016586, "creation_date": 1423015833, "answer_id": 28312353, "question_id": 28312167, "link": "https://stackoverflow.com/questions/28312167/what-is-the-purpose-of-an-applicative-functor/28312353#28312353", "title": "What is the purpose of an applicative functor?", "body": "<p>It's the basic building block (along with <code>pure</code>) for other very useful functions like <code>liftA2</code> (which you could think of as \"<code>fmap</code> over two containers\" and not be too far off the mark):</p>\n\n<pre><code>liftA2 :: Applicative f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\nliftA2 f fa fb = pure f &lt;*&gt; fa &lt;*&gt; fb\n</code></pre>\n\n<p>So suppose you want to add all combinations of values of two lists <code>xs, ys :: [Integer]</code>, you could do it this way:</p>\n\n<pre><code>liftA2 (+) xs ys\n</code></pre>\n\n<p>Though more commonly we write this:</p>\n\n<pre><code>(+) &lt;$&gt; xs &lt;*&gt; ys\n</code></pre>\n\n<p>You are right to be puzzled why would somebody ever write <code>[(+),(*)] &lt;*&gt; [1,2] &lt;*&gt; [3,4]</code>\u2014I think it's a very artificial example.  99% of the time, <code>Applicative</code> is used, you fundamentally have <em>one</em> function that takes two or more arguments, and are looking to apply it to the values inside a functor that implements <code>Applicative</code>.</p>\n\n<p>One way of looking at it is that we could alternatively define <code>Applicative</code> and associated functions like this:</p>\n\n<pre><code>-- Not the real definition\nclass Functor f =&gt; Applicative f where\n    pure :: a -&gt; f a\n\n    -- Like `fmap` but for two-argument functions:\n    liftA2 :: (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\n\n-- `&lt;*&gt;` and `liftA2` are interdefinable, as shown further up and just here:\n(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\nff &lt;*&gt; fa = liftA2 ($) ff fa\n</code></pre>\n\n<p>But the reason <code>&lt;*&gt;</code> is picked as the class method is that it makes it very easy to write <code>liftA2</code>, <code>liftA3</code>, etc.:</p>\n\n<pre><code>liftA2 :: Applicative f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\nliftA2 f fa fb = pure f &lt;*&gt; fa &lt;*&gt; fb\n\nliftA3 :: Applicative f =&gt; (a -&gt; b -&gt; c -&gt; d) -&gt; f a -&gt; f b -&gt; f c -&gt; f d\nliftA3 f fa fb fc = pure f &lt;*&gt; fa &lt;*&gt; fb &lt;*&gt; fc\n\nliftA4 :: Applicative f =&gt; (a -&gt; b -&gt; c -&gt; d -&gt; e) -&gt; f a -&gt; f b -&gt; f c -&gt; f d -&gt; f e\nliftA4 f fa fb fc fd = pure f &lt;*&gt; fa &lt;*&gt; fb &lt;*&gt; fc &lt;*&gt; fd\n</code></pre>\n\n<p>The <code>Applicative</code> class is very nearly the minimum functionality needed to support this \"map with a function of multiple arguments\" pattern, which is a useful thing in tons of cases.</p>\n"}, {"tags": [], "owner": {"reputation": 1435, "user_id": 3792504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e1e342dc9ed03c2039e7cde0dab4214e?s=128&d=identicon&r=PG&f=1", "display_name": "TheCriticalImperitive", "link": "https://stackoverflow.com/users/3792504/thecriticalimperitive"}, "is_accepted": false, "score": 6, "last_activity_date": 1423027881, "last_edit_date": 1423027881, "creation_date": 1423027328, "answer_id": 28314046, "question_id": 28312167, "link": "https://stackoverflow.com/questions/28312167/what-is-the-purpose-of-an-applicative-functor/28314046#28314046", "title": "What is the purpose of an applicative functor?", "body": "<p>The most common use I have of it is to use multiple Monadic (or in this case Applicative) values for a function. A really common way I use it is for constructors.</p>\n\n<p>Consider:</p>\n\n<pre><code>randomAge :: Rand StdGen Int\nrandomHeight :: Rand StdGen Double\nrandomWeight :: Rand StdGen Double\n\ndata Person = Person { age :: Int, height :: Double, weight :: Double }\n\nrandomPerson :: Rand StdGen Person\nrandomPerson = Person &lt;$&gt; randomAge &lt;*&gt; randomHeight &lt;*&gt; randomWeight\n\n-- If we only had Monads...\nrandomPerson' :: Rand StdGen Person\nrandomPerson' = liftM3 Person randomAge randomHeight randomWeight\n-- or worse...\nrandomPerson'' = randomAge &gt;&gt;= \\ra -&gt; randomHeight &gt;&gt;= \\rh -&gt; randomWeight &gt;&gt;= \\rw -&gt; return $ Person ra rh rw\n</code></pre>\n\n<p>Or this example from <a href=\"https://www.fpcomplete.com/school/starting-with-haskell/libraries-and-frameworks/text-manipulation/json\" rel=\"noreferrer\">FPComplete's tutorial on the JSON parser Aeson</a>:</p>\n\n<pre><code>instance FromJSON Person where\n parseJSON (Object v) =\n    Person &lt;$&gt; v .: \"firstName\"\n           &lt;*&gt; v .: \"lastName\"\n           &lt;*&gt; v .: \"age\"\n           &lt;*&gt; v .: \"likesPizza\"\n parseJSON _ = mzero\n</code></pre>\n\n<p>Or this example from the <a href=\"http://book.realworldhaskell.org/read/using-parsec.html\" rel=\"noreferrer\">Real World Haskell chapter on Parser Combinators</a>:</p>\n\n<pre><code>ghci&gt; let parser = (++) &lt;$&gt; string \"HT\" &lt;*&gt; (string \"TP\" &lt;|&gt; string \"ML\")\n</code></pre>\n\n<p>For the most part Applicatives are useful when you have <code>f :: a -&gt; b -&gt; c</code> and you have <code>m a</code> and <code>m b</code> and you want an <code>m c</code>.</p>\n\n<p>Edit: That said there are other uses. For example, Applicative can be used as a really good way to modify traversable data structures. E.g. applying a tree to a value, by having a tree of functions, thereby turning a value into a tree. Or doing non-deterministic list operations without list comprehension syntax.</p>\n\n<p>It can have some unexpected applications. For example, using the <code>-&gt;</code> Monad:</p>\n\n<pre><code>&gt; (&lt;*&gt;) (+) (+1) 2\n5\n</code></pre>\n\n<p>That last one was a bit more esoteric and isn't likely to be used in a practical circumstance but it shows that you can use Applicatives in many ways.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1423031052, "creation_date": 1423031052, "answer_id": 28314772, "question_id": 28312167, "link": "https://stackoverflow.com/questions/28312167/what-is-the-purpose-of-an-applicative-functor/28314772#28314772", "title": "What is the purpose of an applicative functor?", "body": "<p>As leftaroundabout mentioned, whenever the \"shape\" of each \"action\" doesn't depend on the values \"produced\" by the previous one, <code>Applicative</code> is sufficient.</p>\n\n<p>This may be a shape in a very literal way. For example, one context for <code>&gt;&gt;=</code> is that <code>t &gt;&gt;= f</code> takes values stored in the leaves of a tree <code>t</code>, applies <code>f</code> to each value to produce a new subtree, and grafts each subtree onto the tree in place of its corresponding leaf. This operation, however, doesn't work for a <em>balanced</em> tree, because there's no telling how large/deep a tree <code>f</code> will produce each time. However, <code>&lt;*&gt;</code> may still make sense, because the grafted trees will all have the same shape, maintaining balance.</p>\n"}], "owner": {"reputation": 15873, "user_id": 139667, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e083e1865879535bb75306472b4ba5d0?s=128&d=identicon&r=PG&f=1", "display_name": "Trident D&#39;Gao", "link": "https://stackoverflow.com/users/139667/trident-dgao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 1, "answer_count": 4, "score": 4, "last_activity_date": 1423031052, "creation_date": 1423014621, "last_edit_date": 1423015164, "question_id": 28312167, "link": "https://stackoverflow.com/questions/28312167/what-is-the-purpose-of-an-applicative-functor", "title": "What is the purpose of an applicative functor?", "body": "<p>Can anyone share a good real life situation when a function with the following signature would be useful? </p>\n\n<pre><code>f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>I can't really see where I would need something like the schoolbook examples from <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids\" rel=\"nofollow\">learn-you-a-haskell</a> <code>[(+),(*)] &lt;*&gt; [1,2] &lt;*&gt; [3,4]</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 8, "creation_date": 1423001591, "post_id": 28309715, "comment_id": 44970510, "body": "Your question is a bit scattered and hard to follow.  Can you provide a minimal example of what exactly you&#39;re wanting to do with the expected output and any compiler errors you&#39;ve encountered?  Also, you might be looking for something along the lines of <code>any (== 5) [1, 2, 3, 4, 5]</code>, which would compile, but <code>if any ( 5== ) Recipe</code> isn&#39;t correct syntax since <code>if</code> must have <code>then</code> and <code>else</code>, and <code>Recipe</code> is a type, not a value."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1423004711, "post_id": 28309715, "comment_id": 44971813, "body": "It seems like &quot;rules&quot; should be predicates on recipes (ie, of type <code>Recipe -&gt; Bool</code>). For example, you can write rule 2 (this recipe does not have both peppers and onions) as <code>\\r -&gt; not (pepper `elem` r &amp;&amp; onion `elem` r)</code>. Is this what you are looking for? It is unclear what &#39;legal&#39; should do; the comment refers to the conjunction of rules but your code does nothing of the sort."}, {"owner": {"reputation": 107, "user_id": 2986465, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/bkuGM.jpg?s=128&g=1", "display_name": "drocktapiff", "link": "https://stackoverflow.com/users/2986465/drocktapiff"}, "edited": false, "score": 0, "creation_date": 1423014434, "post_id": 28309715, "comment_id": 44974679, "body": "Sorry, let me fix my question, i was given code by my teacher, and it&#39;s supposed to be broken code. It compiles and runs but does not operate as it should. There are many commented &quot;rules&quot; now, these rules are supposed to essentially return a bool, example: &quot; if truffles, then precisely truffles&quot;, im trying to search through each list of recipe and see if it abides by the rule.. if that makes any sense.."}], "answers": [{"tags": [], "owner": {"reputation": 52258, "user_id": 375232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h3OwD.png?s=128&g=1", "display_name": "Landei", "link": "https://stackoverflow.com/users/375232/landei"}, "is_accepted": false, "score": 2, "last_activity_date": 1423216120, "creation_date": 1423216120, "answer_id": 28362874, "question_id": 28309715, "link": "https://stackoverflow.com/questions/28309715/how-to-search-through-a-list-of-integers-in-haskell/28362874#28362874", "title": "How to Search through a list of Integers in Haskell", "body": "<p>Don't work with numbers but use your own data type, e.g. </p>\n\n<pre><code>data Ingredient = Bacon \n                | Peppers \n                | Ham \n                | Mushrooms \n                | Sausage\n                | Onions \n                | Garlic\n                | Truffles \n                | Cream \n                deriving (Eq, Ord, Bounded, Enum) \n</code></pre>\n\n<p>You get a range of ingredients by using functions like <code>enumFromTo</code></p>\n\n<p>Then you can write things like</p>\n\n<pre><code>rule2 receipt = not ((Peppers `elem` receipt) &amp;&amp; (Onions `elem` receipt))\n</code></pre>\n\n<p>And you can test if all rules apply using</p>\n\n<pre><code>legal receipt = all ($ receipt)  ruleset \n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2986465, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/bkuGM.jpg?s=128&g=1", "display_name": "drocktapiff", "link": "https://stackoverflow.com/users/2986465/drocktapiff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423216120, "creation_date": 1423001329, "last_edit_date": 1423001456, "question_id": 28309715, "link": "https://stackoverflow.com/questions/28309715/how-to-search-through-a-list-of-integers-in-haskell", "title": "How to Search through a list of Integers in Haskell", "body": "<p>Okay so I'm extremely new to Haskell, and i know there's a lot of info on this stuff but i just don't understand it. If someone could help explain and show me what I'm doing wrong that would be greatly appreciated,</p>\n\n<p>here's some of the code:</p>\n\n<pre><code>n = 8                     -- number of ingredients (excluding cream)\n\ntype Recipe = [Integer]   -- some ingredients\n\n-- list all recipes with k of n ingredients\n\nchoose :: Integer -&gt; Integer -&gt; [Recipe]\nchoose n k\n  | k == 0    = [[]]      -- only recipe with no ingredients\n\n  | n == k    = [[1..n]]  -- only recipe with all ingredients\n\n  | otherwise = choose (n-1) k ++ map (++ [n])(reverse (choose (n-1) (k-1)))\n\n-- omlette legality (rules must hold conjunctively)\n\nlegal r = head $ map (\\rule -&gt; False) ruleset\n\nruleset = [rule0, rule1, rule2, rule3, rule4, rule5, rule6, rule7]\n\n\n-- Rule 0: If truffles, then precisely truffles.\nrule0 r = False\n\n-- Rule 1: Either truffles, garlic, cream, or precisely one meat.\nrule1 r = False \n\n\n-- Rule 2: Not both peppers and onions.\nrule2 r = False \n</code></pre>\n\n<p>and Here are the ingredients</p>\n\n<pre><code>bacon     = elem 1\npeppers   = elem 2\nham       = elem 3\nmushrooms = elem 4\nsausage   = elem 5\nonions    = elem 6\ngarlic    = elem 7\ntruffles  = elem 8\ncream     = elem 9\n</code></pre>\n\n<p>Now I'm trying to change the Rules to make them meet the commented out requirements, essentially searching through the list of ingredients,\nI've tried something along the lines of</p>\n\n<pre><code>r = if any ( 5== ) Recipe\n</code></pre>\n\n<p>but obviously it's not working, could someone elaborate on what I'm doing wrong</p>\n"}, {"tags": ["haskell", "ghc", "gtk2hs"], "answers": [{"tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": false, "score": 6, "last_activity_date": 1423039151, "last_edit_date": 1423039151, "creation_date": 1422999839, "answer_id": 28309342, "question_id": 28308930, "link": "https://stackoverflow.com/questions/28308930/couldnt-match-expected-type-with-actual-type-int/28309342#28309342", "title": "Couldn&#39;t match expected type `()&#39; with actual type `Int&#39;", "body": "<p>As you state yourself, <code>entryCursorPosition</code> is a <code>ReadAttr</code>, which means it cannot be written. Internally,</p>\n\n<pre><code>type ReadAttr o a = ReadWriteAttr o a ()\n</code></pre>\n\n<p>So a <code>ReadAttr</code> is implemented as an attribute that has \"read type\" <code>a</code>, and \"write type\" <code>()</code>. This explains the error message you see, because you try to set it to an <code>Int</code> instead of a <code>()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "is_accepted": true, "score": 0, "last_activity_date": 1423076772, "creation_date": 1423076772, "answer_id": 28329383, "question_id": 28308930, "link": "https://stackoverflow.com/questions/28308930/couldnt-match-expected-type-with-actual-type-int/28329383#28329383", "title": "Couldn&#39;t match expected type `()&#39; with actual type `Int&#39;", "body": "<p>I made a mistake <code>entryCursorPosition</code> is a <strong>read only</strong> attribut and can't be set.</p>\n\n<p>The correct function to set the cursor position in a entry is :</p>\n\n<pre><code>editableSetPosition entry (-1)\n</code></pre>\n\n<p>Hoping it will be helpfull</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 28329383, "answer_count": 2, "score": 2, "last_activity_date": 1423076772, "creation_date": 1422998283, "question_id": 28308930, "link": "https://stackoverflow.com/questions/28308930/couldnt-match-expected-type-with-actual-type-int", "title": "Couldn&#39;t match expected type `()&#39; with actual type `Int&#39;", "body": "<p>I have a strange error with Haskell and Gtk2Hs.</p>\n\n<p>I try to set the cursor position in a text entry with   </p>\n\n<pre><code>set entree [entryCursorPosition := 5 ]\n</code></pre>\n\n<p>which correspond to the Type </p>\n\n<pre><code>entryCursorPosition :: EntryClass self =&gt; ReadAttr self Int\n</code></pre>\n\n<p>and I have the following error : </p>\n\n<pre><code>Couldn't match expected type `()' with actual type `Int'\n</code></pre>\n\n<p>Do you think it's a bug ? Do you know how to solve it?</p>\n\n<p>I'm using Gtk2Hs 0.12.3 on my Debian Wheezy with GHC 7.4.1. </p>\n\n<p>Best Regards.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 4, "last_activity_date": 1422994631, "creation_date": 1422994631, "answer_id": 28307954, "question_id": 28307868, "link": "https://stackoverflow.com/questions/28307868/pythagoras-check-haskell/28307954#28307954", "title": "Pythagoras check Haskell", "body": "<p>You are making some syntax error. A correct version of your <code>pyth</code> function will look like this:</p>\n\n<pre><code>pyth :: Int -&gt; Int -&gt; Int -&gt; Bool\npyth a b c = a' + b' == c'\n    where\n      a' = square a  \n      b' = square b \n      c' = square c\n</code></pre>\n\n<p>Note that I have changed the variable names and have added a <code>where</code> block where you store the squared values. In the main function body (<code>a' + b' == c'</code>), you do the actual check for the Pythagoras theorem.</p>\n"}, {"comments": [{"owner": {"reputation": 2133, "user_id": 2494576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69dcf21a7cf379c1f25476d80a73338f?s=128&d=identicon&r=PG", "display_name": "felix-eku", "link": "https://stackoverflow.com/users/2494576/felix-eku"}, "edited": false, "score": 1, "creation_date": 1422999522, "post_id": 28308237, "comment_id": 44969548, "body": "The code of the first and third definition of <code>pyth</code> is wrong (missing &#39; in the comparison)"}], "tags": [], "owner": {"reputation": 744, "user_id": 4515613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b0c9d0de9cd97f65114aaf87f6eae3?s=128&d=identicon&r=PG&f=1", "display_name": "sonologico", "link": "https://stackoverflow.com/users/4515613/sonologico"}, "is_accepted": true, "score": 5, "last_activity_date": 1423003737, "last_edit_date": 1423003737, "creation_date": 1422995706, "answer_id": 28308237, "question_id": 28307868, "link": "https://stackoverflow.com/questions/28307868/pythagoras-check-haskell/28308237#28308237", "title": "Pythagoras check Haskell", "body": "<p>Your question doesn't really contain any question, but from what you wrote, it's clear that you're struggling with Haskell's syntax.</p>\n\n<p>My guess from looking at your code is that you're mixing up Haskell's pattern matching syntax with a sequence of statements typical of an imperative language.\nWhat you're trying to achieve can be done in the following way:</p>\n\n<pre><code>square :: Int -&gt; Int\nsquare x = x*x \n\npyth :: Int -&gt; Int -&gt; Int -&gt; Bool\npyth a b c = a' + b' == c'\n     where a' = square a  \n           b' = square b \n           c' = square c\n</code></pre>\n\n<p>Note that <code>a'</code> is a regular variable in Haskell, <code>'</code> being a valid character in identifiers. This example is the same as having written the function as:</p>\n\n<pre><code>pyth :: Int -&gt; Int -&gt; Int -&gt; Bool\npyth a b c = (square a) + (square b) == (square c)\n</code></pre>\n\n<p>As you can see, there is no sequence of statements and the function is a single expression. We use <code>where</code> to extract subexpressions from the expression we are writing and give them a name for readability or to avoid repetition, for example, but it does not mean that they will be evaluated in order or that one of them is the result. Even if you had written it like this:</p>\n\n<pre><code>pyth :: Int -&gt; Int -&gt; Int -&gt; Bool\npyth a b c = result\n    where a' = square a\n          b' = square b\n          c' = square c\n          result = a' + b' == c'\n</code></pre>\n\n<p>It's all a single expression and it could have been written in any order. Like the following:</p>\n\n<pre><code>pyth :: Int -&gt; Int -&gt; Int -&gt; Bool\npyth a b c = result\n    where result = a' + b' == c'\n          a' = square a\n          b' = square b\n          c' = square c\n</code></pre>\n\n<p>I suggest going through <a href=\"http://www.learnyouahaskell.com\" rel=\"nofollow\">Learn you a haskell</a>. It's a very good resource for a beginner.</p>\n"}], "owner": {"reputation": 173, "user_id": 3078305, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/99e1f4be17e17732a44d0103017933eb?s=128&d=identicon&r=PG&f=1", "display_name": "user202051", "link": "https://stackoverflow.com/users/3078305/user202051"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 0, "accepted_answer_id": 28308237, "answer_count": 2, "score": 0, "last_activity_date": 1423003737, "creation_date": 1422994341, "question_id": 28307868, "link": "https://stackoverflow.com/questions/28307868/pythagoras-check-haskell", "title": "Pythagoras check Haskell", "body": "<p>Started using Haskell recently and I'm having a problem with a couple of the basics. </p>\n\n<p>I wrote a simple program to square a variable called 'square'. Now I'm trying to write a program called pyth that takes 3 variables inputs them all in square and then adds a squared to b squared to see if it is equal to c squared to determine if they form a Pythagoras triple.</p>\n\n<pre><code>square :: Int -&gt; Int\nsquare x = x*x\n\npyth :: Int -&gt; Int -&gt; Int -&gt; Bool\npyth a b c\na = square a  \nb = square b \nc = square c\na+b == c = True\n</code></pre>\n"}, {"tags": ["haskell", "stackage"], "answers": [{"comments": [{"owner": {"reputation": 1030, "user_id": 521806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PaOw7.jpg?s=128&g=1", "display_name": "Juan Pablo Santos", "link": "https://stackoverflow.com/users/521806/juan-pablo-santos"}, "edited": false, "score": 0, "creation_date": 1423007737, "post_id": 28307850, "comment_id": 44972915, "body": "Follow up, so should I add Stackage-compatible constraints to my .cabal file?"}, {"owner": {"reputation": 61, "user_id": 2749546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1751e83b850bf0ced44247df2f800cad?s=128&d=identicon&r=PG&f=1", "display_name": "kdkeyser", "link": "https://stackoverflow.com/users/2749546/kdkeyser"}, "reply_to_user": {"reputation": 1030, "user_id": 521806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PaOw7.jpg?s=128&g=1", "display_name": "Juan Pablo Santos", "link": "https://stackoverflow.com/users/521806/juan-pablo-santos"}, "edited": false, "score": 0, "creation_date": 1423039648, "post_id": 28307850, "comment_id": 44983041, "body": "If you are only going to be building against Stackage, I don&#39;t see the point of adding constraints to your .cabal files: the chosen Stackage snapshot provides the whole description of the package set and its constraints. If you want other people to be able to build your package against Hackage, it would make sense to keep the constraints based on the API&#39;s that you use of the packages."}], "tags": [], "owner": {"reputation": 61, "user_id": 2749546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1751e83b850bf0ced44247df2f800cad?s=128&d=identicon&r=PG&f=1", "display_name": "kdkeyser", "link": "https://stackoverflow.com/users/2749546/kdkeyser"}, "is_accepted": true, "score": 1, "last_activity_date": 1422994294, "creation_date": 1422994294, "answer_id": 28307850, "question_id": 28306633, "link": "https://stackoverflow.com/questions/28306633/stackage-inclusive-or-exclusive-usage/28307850#28307850", "title": "Stackage inclusive or exclusive usage", "body": "<p>Both options are available. The default option is what you did, and still goes to hackage to get the packages. You just added a filter to your cabal that prevents you from using any version of a package included in Stackage that was not tested to work together with all of the other packages.</p>\n\n<p>The other option is to simply point your cabal repo to a Stackage url, and then you will download packages directly from the Stackage server. That server will only serve packages that are known to work together, so there is no need for additional constraints in your cabal file. I actually prefer this way of working.</p>\n\n<p>In both cases, if you have additional constraints in your cabal file that are incompatible with the Stackage restrictions, your build will fail. If you use the first option, you will get dependency conflicts. When using the second option, the Stackage server will simply report that it does not have that specific package/version.</p>\n"}], "owner": {"reputation": 1030, "user_id": 521806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PaOw7.jpg?s=128&g=1", "display_name": "Juan Pablo Santos", "link": "https://stackoverflow.com/users/521806/juan-pablo-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 2, "accepted_answer_id": 28307850, "answer_count": 1, "score": 2, "last_activity_date": 1422994294, "creation_date": 1422989832, "question_id": 28306633, "link": "https://stackoverflow.com/questions/28306633/stackage-inclusive-or-exclusive-usage", "title": "Stackage inclusive or exclusive usage", "body": "<p>I'm attempting to start a new project using the Snap web framework. I used <code>snap init</code> to get my basic skeleton working. I also put <a href=\"http://www.stackage.org/lts/cabal.config\" rel=\"nofollow\">http://www.stackage.org/lts/cabal.config</a> next to my .cabal file. I didn't uncomment the line to use Stackage exclusively. So I tried to build and it failed and couldn't find the version of <code>lens</code> required by my .cabal file. The cabal.config file from Stackage specifies a version of lens that is not the same as the one in my .cabal file. So I deleted every constraint from my package list and did the usual <code>cabal install --only-dep -j8 --enable-test</code> and it worked!</p>\n\n<p>However, I have always been told that package versions should be constrained. So when working with Stackage is it okay to leave package versions unconstrained? Should I downgrade my packages to the ones available in Stackage instead?</p>\n\n<p>As far as I understand a cabal.config file specifies a set of dependencies with the specific versions that satisfy dependencies, so how does Stackage work? Is it just a subset of packages from Hackage that are proven to be compatible? Do they host their own packages or rely on Hackage for downloads?</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1422978493, "post_id": 28302972, "comment_id": 44957288, "body": "The second expansion you have would have a type error because you are multiplying a number and a list."}, {"owner": {"reputation": 159491, "user_id": 58808, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7cefc64f7b1b53513625bf3487ecd16d?s=128&d=identicon&r=PG", "display_name": "Ionu\u021b G. Stan", "link": "https://stackoverflow.com/users/58808/ionu%c8%9b-g-stan"}, "edited": false, "score": 0, "creation_date": 1422978508, "post_id": 28302972, "comment_id": 44957297, "body": "Not exactly a precise answer, but intuitively the most outer call to <code>doubleMe</code> will expand first, not the inner one."}, {"owner": {"reputation": 1147, "user_id": 3523379, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60d63603cea5cf4e45808eedab6cafae?s=128&d=identicon&r=PG&f=1", "display_name": "stackoverflowuser", "link": "https://stackoverflow.com/users/3523379/stackoverflowuser"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1422978881, "post_id": 28302972, "comment_id": 44957581, "body": "@DavidYoung Thanks, typo fixed."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1422979722, "post_id": 28302972, "comment_id": 44958250, "body": "I think you want to look at this in terms of <i>reducible expressions</i> (redex). <a href=\"http://www.cs.yale.edu/homes/hudak/CS201S08/lambda.pdf\" rel=\"nofollow noreferrer\">Here is a short introduction</a>. Basically a redex is anything which can be rewritten using a function (like <code>doubleMe (x:xs) -&gt; 2*x : doubleMe xs</code>) - and this is not special to lists. &quot;Lazy&quot; evaluation means precisely that you evaluate the outermost (sometimes called &quot;left-most&quot;) redex first, which is what you seem to intuitively perceive as &quot;lazy evaluation&quot;."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1422982397, "post_id": 28302972, "comment_id": 44959892, "body": "@stackoverflowuser Don&#39;t forget to surround <code>(x:xs)</code> in the second pattern."}, {"owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 1, "creation_date": 1422985342, "post_id": 28302972, "comment_id": 44961703, "body": "Thank you very much for writing such a well-formed question. I don&#39;t even know Haskell and found this (as well as the great answers) an interesting read."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1423046448, "post_id": 28302972, "comment_id": 44987223, "body": "@user2407038 <b>ARGH!!!</b> left-most is completely different from outermost! There are 4 &quot;canonical&quot; strategies to reduce a redex. They are left-outermost (used by Haskell, often called just outermost), right-outermost, left-innermost (used by most eager languages, often called just innermost) and right-innermost. The left/right direction is completely independent from the inner/outer direction. Inner/outer is about a redex being <i>inside</i> an other redex, while left/right is only about <i>sibling</i> redexes and their position in the string. So, outermost is <i>definitely not</i> called &quot;left-most&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 44, "last_activity_date": 1422999536, "last_edit_date": 1422999536, "creation_date": 1422980605, "answer_id": 28303816, "question_id": 28302972, "link": "https://stackoverflow.com/questions/28302972/how-does-haskells-laziness-work/28303816#28303816", "title": "How does Haskell&#39;s laziness work?", "body": "<p><code>doubleMe (doubleMe [a,b,c])</code> does not expand to <code>doubleMe ( (2*a):(doubleMe [b,c]) )</code>. It expands to:</p>\n\n<pre><code>case doubleMe [a,b,c] of\n  [] -&gt; []\n  (x:xs) -&gt; (2*x):(doubleMe xs)\n</code></pre>\n\n<p>That is the outer function call is expanded first. That's the main difference between a lazy language and a strict one: When expanding a function call, you don't first evaluate the argument - instead you replace the function call with its body and leave the argument as-is for now.</p>\n\n<p>Now the <code>doubleMe</code> needs to be expanded because the pattern matching needs to know the structure of its operand before it can be evaluated, so we get:</p>\n\n<pre><code>case (2*a):(doubleMe [b,c]) of\n  [] -&gt; []\n  (x:xs) -&gt; (2*x):(doubleMe xs)\n</code></pre>\n\n<p>Now the pattern matching can be replaced with the body of the second branch because we now know that the second branch is the one that matches. So we substitute <code>(2*a)</code> for <code>x</code> and <code>doubleMe [b, c]</code> for <code>xs</code>, giving us:</p>\n\n<pre><code>(2*(2*a)):(doubleMe (doubleMe [b,c]))\n</code></pre>\n\n<p>So that's how we arrive at that result.</p>\n"}, {"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1422988890, "post_id": 28303870, "comment_id": 44963631, "body": "Hm, this answer doesn&#39;t seem to focus on lazyness. The OP already knows that he can choose which terms to expand (and probably also knows why/that the order doesn&#39;t make a difference for the result). Now, what is lazyness? It&#39;s not throwing a dice, or the compiler finding an optimisation. It&#39;s a specific strategy."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 3, "last_activity_date": 1422981304, "last_edit_date": 1422981304, "creation_date": 1422980816, "answer_id": 28303870, "question_id": 28302972, "link": "https://stackoverflow.com/questions/28302972/how-does-haskells-laziness-work/28303870#28303870", "title": "How does Haskell&#39;s laziness work?", "body": "<p>This is a good time to pull out equational reasoning, which means we can substitute a function for its definition (modulo renaming things to not have clashes).  I'm going to rename <code>doubleMe</code> to <code>d</code> for brevity, though:</p>\n\n<pre><code>d [] = []                           -- Rule 1\nd (x:xs) = (2*x) : d xs             -- Rule 2\n\nd [1, 2, 3] = d (1:2:3:[])\n            = (2*1) : d (2:3:[])    -- Rule 2\n            = 2 : d (2:3:[])        -- Reduce\n            = 2 : (2*2) : d (3:[])  -- Rule 2\n            = 2 : 4 : d (3:[])      -- Reduce\n            = 2 : 4 : (2*3) : d []  -- Rule 2\n            = 2 : 4 : 6 : d []      -- Reduce\n            = 2 : 4 : 6 : []        -- Rule 1\n            = [2, 4, 6]\n</code></pre>\n\n<p>So now if we were to perform this with 2 layers of <code>doubleMe</code>/<code>d</code>:</p>\n\n<pre><code>d (d [1, 2, 3]) = d (d (1:2:3:[]))\n                = d ((2*1) : d (2:3:[]))    -- Rule 2 (inner)\n                = d (2 : d (2:3:[]))        -- Reduce\n                = (2*2) : d (d (2:3:[]))    -- Rule 2 (outer)\n                = 4 : d (d (2:3:[]))        -- Reduce\n                = 4 : d ((2*2) : d (3:[]))  -- Rule 2 (inner)\n                = 4 : d (4 : d (3:[]))      -- Reduce\n                = 4 : 8 : d (d (3:[]))      -- Rule 2 (outer) / Reduce\n                = 4 : 8 : d (6 : d [])      -- Rule 2 (inner) / Reduce\n                = 4 : 8 : 12 : d (d [])     -- Rule 2 (outer) / Reduce\n                = 4 : 8 : 12 : d []         -- Rule 1 (inner)\n                = 4 : 8 : 12 : []           -- Rule 1 (outer)\n                = [4, 8, 12]\n</code></pre>\n\n<p>Alternatively, you can choose to reduce at different points in time, resulting in</p>\n\n<pre><code>d (d [1, 2, 3]) = d (d (1:2:3:[]))\n                = d ((2*1) : d (2:3:[]))\n                = (2*(2*1)) : d (d (2:3:[]))\n                = -- Rest of the steps left as an exercise for the reader\n                = (2*(2*1)) : (2*(2*2)) : (2*(2*3)) : []\n                = (2*2) : (2*4) : (2*6) : []\n                = 4 : 6 : 12 : []\n                = [4, 6, 12]\n</code></pre>\n\n<p>These are two possible expansions for this computation, but it's not specific to lists.  You could apply it to a tree type:</p>\n\n<pre><code>data Tree a = Leaf a | Node a (Tree a) (Tree a)\n</code></pre>\n\n<p>Where pattern matching on <code>Leaf</code> and <code>Node</code> would be akin to matching on <code>[]</code> and <code>:</code> respectively, if you consider the list definition of</p>\n\n<pre><code>data [] a = [] | a : [a]\n</code></pre>\n\n<p>The reason why I say that these are two possible expansions is because the order in which it is expanded is up to the specific runtime and optimizations for the compiler you're using.  If it sees an optimization that would make your program execute much faster it can choose that optimization.  This is why laziness is often a boon, you don't have to think about the order in which things occurs as much because the compiler does that thinking for you.  This wouldn't be possible in a language without purity, such as C#/Java/Python/etc.  You can't rearrange computations since those computations might have side effects that depend on the order.  But when performing pure calculations you don't have side effects and so the compiler has an easier job at optimizing your code.</p>\n"}, {"tags": [], "owner": {"reputation": 5962, "user_id": 92601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c926671d6565f7a1070a2a25edc09881?s=128&d=identicon&r=PG", "display_name": "stonemetal", "link": "https://stackoverflow.com/users/92601/stonemetal"}, "is_accepted": false, "score": 1, "last_activity_date": 1422980835, "creation_date": 1422980835, "answer_id": 28303875, "question_id": 28302972, "link": "https://stackoverflow.com/questions/28302972/how-does-haskells-laziness-work/28303875#28303875", "title": "How does Haskell&#39;s laziness work?", "body": "<p>It does so because of how lists are defined and laziness. When you ask for the head of the list it evaluates that first element you asked for and saves the rest for later.  All list processing operations are built on the head:rest concept, so intermediate results never come up.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 6, "last_activity_date": 1422981277, "creation_date": 1422981277, "answer_id": 28304011, "question_id": 28302972, "link": "https://stackoverflow.com/questions/28302972/how-does-haskells-laziness-work/28304011#28304011", "title": "How does Haskell&#39;s laziness work?", "body": "<p>Your &ldquo;obvious&rdquo; first step isn't actually quite so obvious. In fact what happens is rather like this:</p>\n\n<pre><code>doubleMe (...)\ndoubleMe ( { [] | (_:_) }? )\ndoubleMe ( doubleMe (...)! )\n</code></pre>\n\n<p>and only at that point does it actually &ldquo;enter&rdquo; the inner function. So it proceeds</p>\n\n<pre><code>doubleMe ( doubleMe (...) )\ndoubleMe ( doubleMe( { [] | (_:_) }? ) )\ndoubleMe ( doubleMe( a:_ ! ) )\ndoubleMe ( (2*a) : doubleMe(_) )\ndoubleMe ( (2*a):_ ! )\n</code></pre>\n\n<p>now here the outer <code>doubleMe</code> function has the &ldquo;answer&rdquo; to it's <code>[] | (_:_)</code> question, which was the only reason anything in the inner function was evaluated at all.</p>\n\n<p>Actually, the next step is also not necessarily what you though: it depends on how you evaluate the outer result! For instance, if the whole expression was <code>tail $ doubleMe ( doubleMe [a,b,c] )</code>, then it would actually expand more like</p>\n\n<pre><code>tail( { [] | (_:_) }? )\ntail( doubleMe(...)! )\ntail( doubleMe ( { [] | (_:_) }? ) )\n...\ntail( doubleMe ( doubleMe( a:_ ! ) ) )\ntail( doubleMe ( _:_ ) )\ntail( _ : doubleMe ( _ ) )\ndoubleMe ( ... )\n</code></pre>\n\n<p>i.e. it would in fact never really get to <code>2*a</code>!</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4525358, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3cbc91fbfeb217cfbfd91e535db8b467?s=128&d=identicon&r=PG", "display_name": "user4525358", "link": "https://stackoverflow.com/users/4525358/user4525358"}, "is_accepted": false, "score": 2, "last_activity_date": 1422985471, "creation_date": 1422985471, "answer_id": 28305363, "question_id": 28302972, "link": "https://stackoverflow.com/questions/28302972/how-does-haskells-laziness-work/28305363#28305363", "title": "How does Haskell&#39;s laziness work?", "body": "<p>Write \\lambda y.m to denote the abstracted version of doubleMe, and t for the list [a,b,c].  Then the term you want to reduce is </p>\n\n<pre><code>\\y.m (\\y.m t)\n</code></pre>\n\n<p>In other words, there are two redex.  Haskell prefers to fire outermost redexes first since it is a normal order-ish language.  However, this isn't quite true.  doubleMe isn't really \\y.m, and only really has a redex when it's \"argument\" has the correct shape (that of a list).  Since this isn't yet a redex, and there are no redexes inside of (\\y.m) we move to the right of the application.  Since Haskell also would prefer to evaluate leftmost redexes first.  Now, t really does have the shape of a list, so the redex (\\y.m t) fires.  </p>\n\n<pre><code>\\y.m (a : (\\y.m t'))\n</code></pre>\n\n<p>And then we go back to the top, and do the whole thing again.  Except this time, the outermost term has a redex.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 3, "last_activity_date": 1422992738, "last_edit_date": 1422992738, "creation_date": 1422992026, "answer_id": 28307233, "question_id": 28302972, "link": "https://stackoverflow.com/questions/28302972/how-does-haskells-laziness-work/28307233#28307233", "title": "How does Haskell&#39;s laziness work?", "body": "<pre><code>doubleMe [] = []\ndoubleMe (x:xs) = (2*x):(doubleMe xs)\n\ndoubleMe (doubleMe [a,b,c])\n</code></pre>\n\n<p>I think different people expand these differently.  I don't meant that they produce different results or anything, just that among people who do it correctly there isn't really a standard notation.  Here's how I would do it:</p>\n\n<pre><code>-- Let's manually compute the result of *forcing* the following expression.\n-- (\"Forcing\" = demanding that the expression be evaluated only just enough\n-- to pattern match on its data constructor.)\ndoubleMe (doubleMe [a,b,c])\n\n    -- The argument to the outer `doubleMe` is not headed by a constructor,\n    -- so we must force the inner application of `doubleMe`.  To do that, \n    -- first force its argument to make it explicitly headed by a\n    -- constructor.\n    = doubleMe (doubleMe (a:[b,c]))\n\n    -- Now that the argument has been forced we can tell which of the two\n    -- `doubleMe` equations applies to it: the second one.  So we use that\n    -- to rewrite it.\n    = doubleMe (2*a : doubleMe [b,c])\n\n    -- Since the argument to the outer `doubleMe` in the previous expression\n    -- is headed by the list constructor `:`, we're done with forcing it.\n    -- Now we use the second `doubleMe` equation to rewrite the outer\n    -- function application. \n    = 2*2*a : doubleMe (doubleMe [b, c])\n\n    -- And now we've arrived at an expression whose outermost operator\n    -- is a data constructor (`:`).  This means that we've successfully \n    -- forced the expression, and can stop here.  There wouldn't be any\n    -- further evaluation unless some consumer tried to match either of \n    -- the two subexpressions of this result. \n</code></pre>\n\n<p>This is the same as sepp2k's and leftaroundabout's answers, just that they write it funny.  sepp2k's answer has a <code>case</code> expression appearing seemingly out of nowhere\u2014the multi-equational definition of <code>doubleMe</code> got implicitly rewritten as a single <code>case</code> expression.  leftaroundabout's answer has a <code>{ [] | (_:_) }?</code> thing in it which apparently is a notation for \"I have to force the argument until it looks like either <code>[]</code> or <code>(_:_)</code>\".  </p>\n\n<p>bhelkir's answer is similar to mine, but it's recursively forcing all of the subexpressions of the result as well, which wouldn't happen unless you have a consumer that demands it.</p>\n\n<p>So no disrespect to anybody, but I like mine better.  :-P</p>\n"}, {"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1422997907, "post_id": 28307694, "comment_id": 44968590, "body": "I&#39;d say that in most languages you&#39;re not even be able to declare such a pair :-)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1422999933, "post_id": 28307694, "comment_id": 44969719, "body": "@Bergi Indeed, most language follow an eager/strict semantics, where such a pair would just lead to an infinite loop. In that case, why adding the ability to define it, if it is practically useless?"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1423068308, "last_edit_date": 1423068308, "creation_date": 1422993711, "answer_id": 28307694, "question_id": 28302972, "link": "https://stackoverflow.com/questions/28302972/how-does-haskells-laziness-work/28307694#28307694", "title": "How does Haskell&#39;s laziness work?", "body": "<p>Others have already answered the general question. Let me add something on this specific point:</p>\n\n<blockquote>\n  <p>Is there something special about lists that causes this, or is the\n  idea more general than that just lists?</p>\n</blockquote>\n\n<p>No, lists are not special. Every <code>data</code> type in Haskell has a lazy semantics. Let's try a simple example using the pair type for integers <code>(Int, Int)</code>.</p>\n\n<pre><code>let pair :: (Int,Int)\n    pair = (1, fst pair)\n in snd pair\n</code></pre>\n\n<p>Above, <code>fst,snd</code> are the pair projections, returning the first/second component of a pair. Also note that <code>pair</code> is a recursively defined pair. Yes, in Haskell you can recursively define everything, not just functions.</p>\n\n<p>Under a lazy semantics, the above expression is roughly evaluated like this:</p>\n\n<pre><code>snd pair\n= -- definition of pair\nsnd (1, fst pair)\n= -- application of snd\nfst pair\n= -- definition of pair\nfst (1, fst pair)\n= -- application of fst\n1\n</code></pre>\n\n<p>By comparison, using an eager semantics, we would evaluate it like this:</p>\n\n<pre><code>snd pair\n= -- definition of pair\nsnd (1, fst pair)\n= -- must evaluate arguments before application, expand pair again\nsnd (1, fst (1, fst pair))\n= -- must evaluate arguments\nsnd (1, fst (1, fst (1, fst pair)))\n= -- must evaluate arguments\n...\n</code></pre>\n\n<p>In the eager evaluation, we insist on evaluating arguments before applying <code>fst/snd</code>, and we obtain a infinitely looping program. In some languages this will trigger a \"stack overflow\" error.</p>\n\n<p>In the lazy evaluation, we apply functions soon, even if the argument is not fully evaluated. This makes <code>snd (1, infiniteLoop)</code> return <code>1</code> immediately.</p>\n\n<p>So, lazy evaluation is not specific to lists. Anything is lazy in Haskell: trees, functions, tuples, records, user-defined <code>data</code> types, etc.</p>\n\n<p>(Nitpick: if the programmer really asks for them, it is possible to define types having strict / eagerly-evaluated components. This can be done using strictness annotations, or using extensions such as unboxed types. While sometimes these have their uses, they're are not commonly found in Haskell programs.)</p>\n"}], "owner": {"reputation": 1147, "user_id": 3523379, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60d63603cea5cf4e45808eedab6cafae?s=128&d=identicon&r=PG&f=1", "display_name": "stackoverflowuser", "link": "https://stackoverflow.com/users/3523379/stackoverflowuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2801, "favorite_count": 2, "accepted_answer_id": 28303816, "answer_count": 7, "score": 29, "last_activity_date": 1423162823, "creation_date": 1422978215, "last_edit_date": 1423162823, "question_id": 28302972, "link": "https://stackoverflow.com/questions/28302972/how-does-haskells-laziness-work", "title": "How does Haskell&#39;s laziness work?", "body": "<p>Consider this function that doubles all the elements in a list:</p>\n\n<pre><code>doubleMe [] = []\ndoubleMe (x:xs) = (2*x):(doubleMe xs)\n</code></pre>\n\n<p>Then consider the expression</p>\n\n<pre><code>doubleMe (doubleMe [a,b,c])\n</code></pre>\n\n<p>It seems obvious that, at runtime, this first expands to:</p>\n\n<pre><code>doubleMe ( (2*a):(doubleMe [b,c]) )\n</code></pre>\n\n<p>(It's obvious because no other possibilities exist as far as I can see).</p>\n\n<p>But my question is this: <strong>Why exactly</strong> does this now expand to</p>\n\n<pre><code>2*(2*a) : doubleMe( doubleMe [b,c] )\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>doubleMe( (2*a):( (2*b) : doubleMe [c] ) )\n</code></pre>\n\n<p>?</p>\n\n<p>Intuitively, I know the answer: Because Haskell is lazy. But can someone give me a more precise answer?</p>\n\n<p>Is there something special about lists that causes this, or is the idea more general than that just lists?</p>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1422976181, "post_id": 28294609, "comment_id": 44955652, "body": "What&#39;s wrong with <code>mkName &quot;[]&quot;</code>?"}, {"owner": {"reputation": 5412, "user_id": 1626632, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9a63a74d81c3e3abfb4a1ecb56fd3eff?s=128&d=identicon&r=PG", "display_name": "Helmut Grohne", "link": "https://stackoverflow.com/users/1626632/helmut-grohne"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1423124098, "post_id": 28294609, "comment_id": 45023446, "body": "Try <code>mkName &quot;[]&quot; == &#39;[]</code>. It gives <code>False</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5412, "user_id": 1626632, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9a63a74d81c3e3abfb4a1ecb56fd3eff?s=128&d=identicon&r=PG", "display_name": "Helmut Grohne", "link": "https://stackoverflow.com/users/1626632/helmut-grohne"}, "is_accepted": true, "score": 2, "last_activity_date": 1422954667, "creation_date": 1422954667, "answer_id": 28295096, "question_id": 28294609, "link": "https://stackoverflow.com/questions/28294609/obtaining-th-name-for-without-xtemplatehaskell/28295096#28295096", "title": "Obtaining TH.Name for &#39;[] without -XTemplateHaskell", "body": "<pre><code>import Language.Haskell.TH.Syntax\n\nnilName = mkNameG DataName \"ghc-prim\" \"GHC.Types\" \"[]\"\n</code></pre>\n\n<p>is an equivalent definition of <code>nilName</code>, even though it is ugly. It can be expanded to a form that admits to pattern matching yielding to</p>\n\n<pre><code>nilName = Name (OccName \"[]\") (NameG DataName (PkgName \"ghc-prim\") (ModName \"GHC.Types\"))\n</code></pre>\n\n<p>which is not nicer nor robust. It seems that the best route forward is a combination of the above <code>nilName</code> defined in a separate TH-enabled module together with <code>(== nilName)</code> instead of pattern matching.</p>\n"}], "owner": {"reputation": 5412, "user_id": 1626632, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9a63a74d81c3e3abfb4a1ecb56fd3eff?s=128&d=identicon&r=PG", "display_name": "Helmut Grohne", "link": "https://stackoverflow.com/users/1626632/helmut-grohne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 28295096, "answer_count": 1, "score": 1, "last_activity_date": 1422954667, "creation_date": 1422953025, "question_id": 28294609, "link": "https://stackoverflow.com/questions/28294609/obtaining-th-name-for-without-xtemplatehaskell", "title": "Obtaining TH.Name for &#39;[] without -XTemplateHaskell", "body": "<p>Is there a way to obtain (import from base modules or write expression) a value of type <code>Language.Haskell.TH.Name</code> that represents <code>'[]</code> without enabling <code>-XTemplateHaskell</code>?</p>\n\n<p>A good reason to do so is that tools like hlint do not play well with TH and being able to avoid it therefore has a benefit. Then I could put a definition</p>\n\n<pre><code>nilName :: Name\nnilName = '[]\n</code></pre>\n\n<p>in a separate file and import it, but this only makes sense if there is no standard name by which it can be imported or called. Furthermore, <code>nilName</code> cannot be used in pattern matches. Is there such a thing?</p>\n"}, {"tags": ["haskell", "ghc", "ffi"], "comments": [{"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 1, "creation_date": 1422952003, "post_id": 28294239, "comment_id": 44941260, "body": "It&#39;s possible that the GHC runtime is using signals that disrupt the <code>sleep</code>.     Have you checked the error code? Perhaps you should wrap it in a loop to restart it if it gets interrupted (in which case it&#39;s best to use <code>nanosleep</code> for higher precision)."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 1, "creation_date": 1422952058, "post_id": 28294239, "comment_id": 44941290, "body": "@Rufflewind: <code>sleep</code> doesn&#39;t return an error code, but the unslept amount in seconds :/. Haven&#39;t tried <code>nanosleep</code> yet, but <code>usleep</code> doesn&#39;t work either."}, {"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 0, "creation_date": 1422952253, "post_id": 28294239, "comment_id": 44941385, "body": "The error code is &quot;returned&quot; via the <code>errno</code> variable. Wrap <code>(c_sleep 10)</code> inside <code>throwErrnoIf (&#47;= 0) &quot;sleep&quot;</code> and you&#39;ll see that it&#39;s being interrupted."}, {"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 0, "creation_date": 1422952430, "post_id": 28294239, "comment_id": 44941468, "body": "See also <a href=\"https://ghc.haskell.org/trac/ghc/ticket/850\" rel=\"nofollow noreferrer\">this bug</a>. Not exactly related to this issue but it does say the RTS, even the single-threaded one, sends signals periodically, which will interrupt any <code>sleep</code> call."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 0, "creation_date": 1422952983, "post_id": 28294239, "comment_id": 44941743, "body": "@Rufflewind: Thanks. Jeez, why doesn&#39;t <code>man 3 sleep</code> mention the <code>errno</code> update? I guess I&#39;ll have too write a <code>void nanosleep_loop(uint32_t)</code>, since <code>nanosleep</code> gets affected too. The ticket probably answers this question, so feel free to add one."}, {"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 0, "creation_date": 1422953221, "post_id": 28294239, "comment_id": 44941870, "body": "Actually, you&#39;re right, the docs for <code>sleep</code> don&#39;t mention anything about <code>errno</code> at all (I was reading <code>nanosleep</code> instead).  However, it does say if the return value is nonzero, then it was due to interruption by a signal."}], "answers": [{"tags": [], "owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "is_accepted": true, "score": 12, "last_activity_date": 1422953943, "last_edit_date": 1422953943, "creation_date": 1422953589, "answer_id": 28294792, "question_id": 28294239, "link": "https://stackoverflow.com/questions/28294239/why-doesnt-sleep-work/28294792#28294792", "title": "Why doesn&#39;t sleep work?", "body": "<p>GHC's <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Signals\" rel=\"noreferrer\">RTS appears to use signals</a> for its <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Profiling\" rel=\"noreferrer\">own</a> <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Scheduler\" rel=\"noreferrer\">purposes</a>, which means it won't be long before a sleep gets interrupted by one of these signals.  I don't think it's a bug either, the runtime does <a href=\"https://ghc.haskell.org/trac/ghc/ticket/850\" rel=\"noreferrer\">come with its own territory</a>, so to speak.  The Haskellian approach would be to use <code>threadDelay</code> but it's not easy for a C program to access that without some trickery.</p>\n\n<p>The <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Signals#RTSAlarmSignalsandForeignLibraries\" rel=\"noreferrer\">proper way</a> is to repeatedly resume the sleep despite interruptions from other signals.  I recommend using <code>nanosleep</code> since <code>sleep</code> only has a precision of seconds and the signals appear to occur much more frequently than that.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;errno.h&gt;\n#include &lt;time.h&gt;\n\n/* same as 'sleep' except it doesn't get interrupted by signals */\nint keep_sleeping(unsigned long sec) {\n    struct timespec rem, req = { (time_t) sec, 0 }; /* warning: may overflow */\n    while ((rem.tv_sec || rem.tv_nsec) &amp;&amp; nanosleep(&amp;req, &amp;rem)) {\n        if (errno != EINTR) /* this check is probably unnecessary */\n            return -1;\n        req = rem;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1422977407, "post_id": 28299744, "comment_id": 44956496, "body": "While this is true, one wouldn&#39;t expect a valid <code>(u)sleep()</code> call that usually works well in its single thread C domain to get interrupted <i>immediately after the call</i>. Even more so if one didn&#39;t use <code>-threaded</code> and/or concurrency."}, {"owner": {"reputation": 5184, "user_id": 1935631, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0e4d0d6c5ce5e9350cacc818ee350347?s=128&d=identicon&r=PG", "display_name": "Sassa NF", "link": "https://stackoverflow.com/users/1935631/sassa-nf"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1422979777, "post_id": 28299744, "comment_id": 44958292, "body": "@Zeta The expectation is wrong then. No one ever specifies the reason for spurious wakeup - it is <i>spurious</i>; it doesn&#39;t say <code>&quot;may wake up *only* because the application interrupted itself&quot;</code>. I don&#39;t think it makes sense to code intuitively against unspecified behaviour - like we don&#39;t assume an uninitialized <code>int</code> is zero in C."}], "tags": [], "owner": {"reputation": 5184, "user_id": 1935631, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0e4d0d6c5ce5e9350cacc818ee350347?s=128&d=identicon&r=PG", "display_name": "Sassa NF", "link": "https://stackoverflow.com/users/1935631/sassa-nf"}, "is_accepted": false, "score": 1, "last_activity_date": 1422968918, "creation_date": 1422968918, "answer_id": 28299744, "question_id": 28294239, "link": "https://stackoverflow.com/questions/28294239/why-doesnt-sleep-work/28299744#28299744", "title": "Why doesn&#39;t sleep work?", "body": "<p>All concurrency primitives always have a clawback statement that they may block for less time than specified - they may return spuriously. This is nothing to do with the language, it is the nature of concurrency, so if you want to wait for exactly the specified amount of time, in any language you need to construct a loop checking the clock after the sleep.</p>\n"}], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 2, "accepted_answer_id": 28294792, "answer_count": 2, "score": 17, "last_activity_date": 1422968918, "creation_date": 1422951554, "question_id": 28294239, "link": "https://stackoverflow.com/questions/28294239/why-doesnt-sleep-work", "title": "Why doesn&#39;t sleep work?", "body": "<p>Why does <code>c_sleep</code> return immediately in the following code?</p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\nimport Foreign.C.Types\nimport Data.Time.Clock\nimport Control.Concurrent\n\nforeign import ccall unsafe \"unistd.h sleep\" \n    c_sleep :: CUInt -&gt; IO CUInt\n\nmain :: IO ()\nmain = do\n    getCurrentTime &gt;&gt;= print . utctDayTime\n    c_sleep 10     &gt;&gt;= print                -- this doesn't sleep\n    getCurrentTime &gt;&gt;= print . utctDayTime\n    threadDelay $ 10 * 1000 * 1000          -- this does sleep\n    getCurrentTime &gt;&gt;= print . utctDayTime\n</code></pre>\n\n<pre>$ ghc --make Sleep.hs && ./Sleep\n[1 of 1] Compiling Main             ( Sleep.hs, Sleep.o )\nLinking Sleep ...\n29448.191603s\n10\n29448.20158s\n29458.211402s\n\n$ ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 7.8.3\n\n$ cabal --version\ncabal-install version 1.20.0.3\nusing version 1.20.0.0 of the Cabal library \n</pre>\n\n<p><strong>Note:</strong> Actually, I would like to use <a href=\"http://man.cx/sleep%283%29\" rel=\"noreferrer\"><code>sleep</code></a> in C code to simulate some heavy computation in a function <code>func</code> and call <em>that</em> function in Haskell, but that doesn't work either, probably for the same reasons.</p>\n"}, {"tags": ["javascript", "haskell", "functional-programming", "reactive-programming", "monads"], "comments": [{"owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 1, "creation_date": 1422950596, "post_id": 28293831, "comment_id": 44940589, "body": "Arrow is more abstract concept related to FRP you should look it first and you see than monadic approach is less preferable <a href=\"https://www.haskell.org/arrows/\" rel=\"nofollow noreferrer\">haskell.org/arrows</a> <a href=\"https://wiki.haskell.org/Arrows-based_Functional_Reactive_Programming\" rel=\"nofollow noreferrer\">wiki.haskell.org/Arrows-based_Functional_Reactive_Programmin&zwnj;&#8203;g</a>  also &quot;Arrows, Robots, and Functional Reactive Programming&quot; <a href=\"http://haskell.cs.yale.edu/?post_type=publication&amp;p=175\" rel=\"nofollow noreferrer\">haskell.cs.yale.edu/?post_type=publication&amp;p=175</a>"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 0, "creation_date": 1422951099, "post_id": 28293831, "comment_id": 44940842, "body": "@Sigrlami I admit I haven&#39;t yet taken the time to understand arrows, but thanks for the links. I&#39;ll look into those."}, {"owner": {"reputation": 327, "user_id": 4935221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10204130414435783/picture?type=large", "display_name": "Alfred Young", "link": "https://stackoverflow.com/users/4935221/alfred-young"}, "edited": false, "score": 0, "creation_date": 1562651923, "post_id": 28293831, "comment_id": 100431626, "body": "in javascript, wouldn&#39;t a very simplistic definition of frp be that you treat all your data as streams? There is definitely a stream monad so isnt frp just programming with a specific (very powerful) monad?"}], "answers": [{"comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1422955095, "post_id": 28294240, "comment_id": 44942887, "body": "That talk was especially helpful for someone like me who doesn&#39;t have a fantastic grip on the intricacies of Haskell&#39;s higher-order abstractions. Thanks for the explanation!"}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 12, "last_activity_date": 1422951561, "last_edit_date": 1495541301, "creation_date": 1422951561, "answer_id": 28294240, "question_id": 28293831, "link": "https://stackoverflow.com/questions/28293831/can-functional-reactive-programming-frp-be-expressed-using-monads/28294240#28294240", "title": "Can functional reactive programming (FRP) be expressed using monads?", "body": "<p><em>Behaviors</em> could be given monad operations. After all <code>Behavior a</code> is semantically <code>Time -&gt; a</code>, which is <a href=\"https://hackage.haskell.org/package/mtl-1.1.0.2/docs/Control-Monad-Reader.html\" rel=\"nofollow noreferrer\"><code>Reader Time</code></a>.</p>\n\n<p>Also <em>Events</em> which are semantically <code>[(Time, a)]</code> could be given at least <code>Applicative</code> instance which would resemble <code>ZipList</code> structure.</p>\n\n<p>Yet, even these are theoretically possible and elegant, in practice they are hard to implement. You could check <a href=\"https://www.youtube.com/watch?v=Agu6jipKfYw\" rel=\"nofollow noreferrer\">\"Controlling Time and Space: understanding the many formulations of FRP\" by Evan Czaplicki</a> for more information.</p>\n\n<p>For example <a href=\"http://hackage.haskell.org/package/sodium-0.11.0.3\" rel=\"nofollow noreferrer\"><code>sodium</code></a> have <a href=\"http://hackage.haskell.org/package/sodium-0.11.0.3/docs/FRP-Sodium.html#v:switch\" rel=\"nofollow noreferrer\"><em>kind of</em> monadic bind for <code>Behaviors</code></a>: </p>\n\n<pre><code>switch :: Behavior (Behavior a) -&gt; Reactive (Behavior a)\n</code></pre>\n\n<p>but instead of working in the pure category, we work in Kleisli category of <code>Reactive</code> monad. Thus we can do a bit more.</p>\n\n<p>One exercise which highlights the difficulties, is to try to implement <a href=\"https://hackage.haskell.org/package/base-4.6.0.0/docs/Control-Arrow.html#t:ArrowApply\" rel=\"nofollow noreferrer\"><code>ArrowApply</code></a> for <a href=\"https://hackage.haskell.org/package/arrows-0.4.4.1/docs/Control-Arrow-Transformer-Automaton.html\" rel=\"nofollow noreferrer\"><code>Automaton</code></a>. <a href=\"https://stackoverflow.com/questions/27603108/what-is-wrong-with-this-instance-arrowapply-automaton/27610945#27610945\">SO provided spoiler</a></p>\n"}], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1152, "favorite_count": 3, "accepted_answer_id": 28294240, "answer_count": 1, "score": 13, "last_activity_date": 1549688018, "creation_date": 1422949840, "last_edit_date": 1549687694, "question_id": 28293831, "link": "https://stackoverflow.com/questions/28293831/can-functional-reactive-programming-frp-be-expressed-using-monads", "title": "Can functional reactive programming (FRP) be expressed using monads?", "body": "<p>I've been reading up on <a href=\"http://en.wikipedia.org/wiki/Functional_reactive_programming\" rel=\"nofollow noreferrer\">Functional Reactive Programming</a>, and though I have not used monads extensively in any language, I can't help but see them <em>everywhere</em> in the FRP design.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1028250/what-is-functional-reactive-programming\">This question's answers</a> have some fantastic descriptions of what functional reactive programming <em>is</em>, and I won't attempt to replicate that here. Basically, FRP creates relationships between values that change over time.</p>\n\n<p>So can't this be represented monadically? Encapsulate the code that requires the values that are modified over time in a monad, call it <code>Signal</code>, then use those signals like so (using Haskell do-notation for simplicity).</p>\n\n<pre><code>do\n  mx &lt;- mouseX\n  my &lt;- mouseY\n  wave &lt;- currentTime &gt;&gt;= liftM sin\n  -- do some stuff with these values\n</code></pre>\n\n<p>Or is there more to FRP than I'm understanding? Are there paradigms that prevent using such a simple representation using monads? Or is this a valid (if perhaps simplified) understanding of how FRP works?</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1422944361, "last_edit_date": 1592644375, "creation_date": 1422944361, "answer_id": 28292583, "question_id": 28292476, "link": "https://stackoverflow.com/questions/28292476/ghc-version-check-in-code/28292583#28292583", "title": "GHC version check in code", "body": "<p>Read the <a href=\"https://downloads.haskell.org/%7Eghc/7.0.2/docs/html/users_guide/options-phases.html#c-pre-processor\" rel=\"noreferrer\">fine documentation</a>:</p>\n<blockquote>\n<p>For version x.y.z of GHC, the value of <code>__GLASGOW_HASKELL__</code> is the integer xyy (if y is a single digit, then a leading zero is added, so for example in version 6.2 of GHC, <code>__GLASGOW_HASKELL__</code>==602). More information in Section 1.4, \u201cGHC version numbering policy\u201d.</p>\n<p>With any luck, <code>__GLASGOW_HASKELL__</code> will be undefined in all other implementations that support C-style pre-processing.</p>\n<p>(For reference: the comparable symbols for other systems are: <code>__HUGS__</code> for Hugs, <code>__NHC__</code> for nhc98, and <code>__HBC__</code> for hbc.)</p>\n<p>NB. This macro is set when pre-processing both Haskell source and C source, including the C source generated from a Haskell module (i.e. .hs, .lhs, .c and .hc files).</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "edited": false, "score": 0, "creation_date": 1422995067, "post_id": 28292585, "comment_id": 44966908, "body": "Should I check for version <code>706</code> or <code>707</code>. Since <code>7.6.0</code> didn&#39;t have the function."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "edited": false, "score": 0, "creation_date": 1422995142, "post_id": 28292585, "comment_id": 44966962, "body": "@chamini2 That seems unlikely. Minor version changes (the third number) should only fix bugs and are not supposed to change functionality otherwise (cf <a href=\"https://ghc.haskell.org/trac/ghc/ticket/8778#comment:24\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/8778#comment:24</a>). What is this function?"}, {"owner": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "edited": false, "score": 0, "creation_date": 1422997919, "post_id": 28292585, "comment_id": 44968595, "body": "Ok, I understand. <code>readMaybe</code> from <code>Text.Read</code>. <a href=\"https://downloads.haskell.org/~ghc/7.6.1/docs/html/users_guide/release-7-6-1.html\" rel=\"nofollow noreferrer\">here</a>, in bullet <i>1.5.3.2 base</i>. So <code>706</code> should be ok?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "edited": false, "score": 2, "creation_date": 1422998164, "post_id": 28292585, "comment_id": 44968756, "body": "@chamini2 If you want to depend on a version of base, you should do that instead of depending on a version of GHC. Use cabal&#39;s MIN_VERSION family of macros (again read the fine documentation to learn more about how they work)."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 15, "last_activity_date": 1467359602, "last_edit_date": 1467359602, "creation_date": 1422944369, "answer_id": 28292585, "question_id": 28292476, "link": "https://stackoverflow.com/questions/28292476/ghc-version-check-in-code/28292585#28292585", "title": "GHC version check in code", "body": "<p>That's described in <a href=\"https://downloads.haskell.org/~ghc/8.0-latest/docs/html/users_guide/phases.html#standard-cpp-macros\" rel=\"nofollow\">section 6.11.3.1</a> of GHC's users guide:</p>\n\n<blockquote>\n  <p>For version <code>x.y.z</code> of GHC, the value of <code>__GLASGOW_HASKELL__</code> is the integer \u27e8xyy\u27e9 (if \u27e8y\u27e9 is a single digit, then a leading zero is added, so for example in version 6.2 of GHC, <code>__GLASGOW_HASKELL__==602</code>). More information in <a href=\"https://downloads.haskell.org/~ghc/8.0-latest/docs/html/users_guide/intro.html#version-numbering\" rel=\"nofollow\">GHC version numbering policy</a>.</p>\n</blockquote>\n\n<p>So for <code>7.6.1</code>, you would check <code>__GLASGOW_HASKELL__ &gt;= 706</code>. The reason for this are versions like <code>7.10.x</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 6, "last_activity_date": 1499271847, "last_edit_date": 1499271847, "creation_date": 1423003748, "answer_id": 28310261, "question_id": 28292476, "link": "https://stackoverflow.com/questions/28292476/ghc-version-check-in-code/28310261#28310261", "title": "GHC version check in code", "body": "<p>As Daniel Wagner indicated, the most correct way to check for package version is usually to use a Cabal <code>MIN_VERSION</code> macro. For example, you could use</p>\n\n<pre><code>#if MIN_VERSION_base(4,6,0)\n</code></pre>\n\n<p>to determine if the <code>base</code> package is at least version 4.6.0, which is the earliest version with the function you seek.</p>\n\n<p>The <code>base</code> package is a little weird. It was used both by GHC and by the now-defunct Hugs and NHC implementations. Using the Cabal macro was then a more portable way to check the <code>base</code> version. These days, GHC is the only one using <code>base</code>, so the portability argument is a little less clear, but that approach also has the advantage of checking the major and minor version numbers.</p>\n\n<p>Since <code>base</code> versions are very tightly tied to GHC versions, you can define a reasonable fall-back form of <code>MIN_VERSION_base</code> for compiling without Cabal, using <code>__GLASGOW_HASKELL__</code> to estimate the <code>base</code> version. The current <code>containers</code> head conditionally defines such a fall-back.</p>\n\n<h3>Update</h3>\n\n<p>As of GHC 8, the compiler itself has taken over the job of defining <code>MIN_VERSION</code> macros. This is great, because you now get to use these macros whether or not you build with Cabal. No more ugly approximations!</p>\n"}], "owner": {"reputation": 2422, "user_id": 1276441, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a1ed120c8ab66ed191f289cafa0b58ee?s=128&d=identicon&r=PG", "display_name": "chamini2", "link": "https://stackoverflow.com/users/1276441/chamini2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2917, "favorite_count": 2, "accepted_answer_id": 28292585, "answer_count": 3, "score": 13, "last_activity_date": 1499271847, "creation_date": 1422943880, "last_edit_date": 1422994760, "question_id": 28292476, "link": "https://stackoverflow.com/questions/28292476/ghc-version-check-in-code", "title": "GHC version check in code", "body": "<p>I'm contributing to <a href=\"http://github.com/simonmar/alex\" rel=\"noreferrer\">Alex</a>, and it obviously depends on a lot of libraries and should compile for a lot of versions.</p>\n\n<p>I need to use a function that is only available from <em>GHC 7.6.1</em> to handle an error better. So I want to use an <code>#if ...</code> to import said function, else, I'll deal with the error differently.</p>\n\n<p>I've seen some:</p>\n\n<pre><code>#if __GLASGOW_HASKELL__ &gt;= 610\nimport Control.Exception ( bracketOnError )\n#endif\n</code></pre>\n\n<p>So I did:</p>\n\n<pre><code>#if __GLASGOW_HASKELL__ &gt;= 761\nimport Text.Read ( readMaybe )\n#endif\n</code></pre>\n\n<p>Thinking that <code>761</code> is an alias to GHC version <code>7.6.1</code>, when I build the cabal package and try it out, the function doesn't get imported, even though I use <em>The Glorious Glasgow Haskell Compilation System, <strong>version 7.8.4</em></strong>.</p>\n\n<p>So after using a program to try it out, I find out that <code>7.8.1</code> identifies in <code>__GLASGOW_HASKELL__</code> as <code>708</code>.</p>\n\n<pre><code>{-# LANGUAGE CPP #-}\nmodule Main where\n\n#if __GLASGOW_HASKELL__ == 708\nver = \"==708\"\n#else\nver = \"/=708\"\n#endif\n\nmain = putStrLn $ ver\n</code></pre>\n\n<p>And running it:</p>\n\n<pre><code>$ runhaskell if.hs\n==708\n</code></pre>\n\n<p>How can I know what value should I use for <code>7.6.1</code>, or is there a better way to deal with this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1422917414, "post_id": 28288118, "comment_id": 44930400, "body": "The easy way that doesn&#39;t involve much learning is to use <code>{-# LANGUAGE DeriveFoldable #-}</code> at the top of your file, then <code>import qualified Data.Foldable as F</code>, then <code>data TreeIrr a = No a [TreeIrr a] deriving (F.Foldable)</code>.  You can now do <code>F.maximum tree</code>.  If you want to learn some more, <a href=\"https://wiki.haskell.org/Foldable_and_Traversable#Foldable\" rel=\"nofollow noreferrer\">read the wiki</a> and then start googling around for more information on foldable and traversable.  They&#39;re very useful typeclasses."}, {"owner": {"reputation": 1089, "user_id": 3681109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d676ca6572e75e842ca0fa3e9e82d1bb?s=128&d=identicon&r=PG&f=1", "display_name": "genisage", "link": "https://stackoverflow.com/users/3681109/genisage"}, "edited": false, "score": 0, "creation_date": 1422917547, "post_id": 28288118, "comment_id": 44930451, "body": "A less easy way that might be a little bit more illuminating is to write your own <code>treeFold</code> function and then do something along the lines of <code>treeFold max t</code>"}, {"owner": {"reputation": 285, "user_id": 1536010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f56535dbaa6cec5a3bc7df07b08c84be?s=128&d=identicon&r=PG", "display_name": "skills", "link": "https://stackoverflow.com/users/1536010/skills"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422917553, "post_id": 28288118, "comment_id": 44930456, "body": "@bheklilr thank you very much for the tip, but i need to know how to do this manually.  i discovered now that they are called &quot;rose trees&quot;!"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1422917770, "post_id": 28288118, "comment_id": 44930537, "body": "Are you trying to find the maximum in your <code>maxi</code> function or convert it into a list so you can use <code>maximum</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 2, "last_activity_date": 1422918682, "last_edit_date": 1422918682, "creation_date": 1422917982, "answer_id": 28288449, "question_id": 28288118, "link": "https://stackoverflow.com/questions/28288118/how-to-know-maximum-at-an-irregular-tree/28288449#28288449", "title": "How to know maximum at an irregular tree?", "body": "<p>Just use a simple recursive dfs-like traversal:</p>\n\n<pre><code>data TreeIrr a = No a [TreeIrr a]\n\nfindMax :: Ord a =&gt; TreeIrr a -&gt; a\nfindMax (No x []) = x     -- For a tree without subtrees the maximum is it's value\nfindMax ( No x subtrees ) =\n    maximum ( x : map findMax subtrees)      -- For a tree with subtrees the maximum is the maximum among it's root value or the maximum of it's subtrees\n</code></pre>\n\n<p>and then </p>\n\n<pre><code>&gt;&gt; findMax (No 2 [No 3 [No 6 []], No 4 [No 7 [], No 8 []], No 5 []])\n8\n</code></pre>\n\n<p>Upd:\n After a little thinking, the base case is redundant here. So\njust </p>\n\n<pre><code>findMax :: Ord a =&gt; TreeIrr a -&gt; a\nfindMax ( No x subtrees ) = maximum ( x : map findMax subtrees)\n</code></pre>\n\n<p>will work fine</p>\n"}, {"comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1422918869, "post_id": 28288466, "comment_id": 44930957, "body": "<i>Technically</i> <code>concat . map</code> won&#39;t typecheck, so I&#39;d change it to &quot;And <code>concat . map f</code> is called <code>concatMap f</code> in the library.&quot; or &quot;And <code>\\f -&gt; concat . map f</code> is called <code>concatMap</code> in the library.&quot;, but it would be really pedantic and picky to bring up that point in the first place."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1422919737, "last_edit_date": 1422919737, "creation_date": 1422918043, "answer_id": 28288466, "question_id": 28288118, "link": "https://stackoverflow.com/questions/28288118/how-to-know-maximum-at-an-irregular-tree/28288466#28288466", "title": "How to know maximum at an irregular tree?", "body": "<p>Let's pretend we have a traversal function:</p>\n\n<pre><code>maxi :: ArvIrr a -&gt; [a]\n</code></pre>\n\n<p>How should we extend this to a <em>list</em> of trees?</p>\n\n<pre><code>maxiList :: [ArvIrr a] -&gt; [a]\n</code></pre>\n\n<p>Well, we could use a <code>map</code>:</p>\n\n<pre><code>maxiList l = map maxi l  -- WRONG type [[a]]\n</code></pre>\n\n<p>but we get a lists of lists instead of a single list. No problem, let's concatenate them all.</p>\n\n<pre><code>maxiList l = concat (map maxi l)\n</code></pre>\n\n<p>OK, now let's assume we have <code>maxiList</code> working, and build <code>maxi</code> in terms of it. This is quite simple:</p>\n\n<pre><code>maxi (No a l) = a : maxiList l\n</code></pre>\n\n<p>So, putting everything together:</p>\n\n<pre><code>maxi :: ArvIrr a -&gt; [a]\nmaxi (No a l) = a : maxiList l\nmaxiList :: [ArvIrr a] -&gt; [a]\nmaxiList l = concat (map maxi l)\n</code></pre>\n\n<p>We can further simplify it by removing <code>maxiList</code> and inlining it.</p>\n\n<pre><code>maxi :: ArvIrr a -&gt; [a]\nmaxi (No a l) = a : concat (map maxi l)\n</code></pre>\n\n<p>And <code>concat (map maxi l)</code> can be rewritten as <code>concatMap maxi l</code>,\nexploiting the <code>concatMap</code> library function.</p>\n\n<pre><code>maxi :: ArvIrr a -&gt; [a]\nmaxi (No a l) = a : concatMap maxi l\n</code></pre>\n\n<p>To compute the maximum, you can use</p>\n\n<pre><code>maxInTree :: Ord a =&gt; ArvIrr a -&gt; a\nmaxInTree t = maximum (maxi t)\n</code></pre>\n\n<p>If you want, you can further simplify this code so that the intermediate list is not even built, and the maximum is computed directly. This is probably a bit challenging for a Haskell beginner, but it might be fun. Start by replacing <code>concat</code> in the code above ...</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1423008699, "post_id": 28288711, "comment_id": 44973215, "body": "Pretty, and simple, and altogether nice."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 4, "last_activity_date": 1422919402, "creation_date": 1422919402, "answer_id": 28288711, "question_id": 28288118, "link": "https://stackoverflow.com/questions/28288118/how-to-know-maximum-at-an-irregular-tree/28288711#28288711", "title": "How to know maximum at an irregular tree?", "body": "<pre><code>data TreeIrr a = No a [TreeIrr a]\n</code></pre>\n\n<p>The maximum element of such a tree is the maximum of two values:</p>\n\n<ol>\n<li>The element at the root note.</li>\n<li>The maximum of the maximums of its children.</li>\n</ol>\n\n<p>Therefore:</p>\n\n<pre><code>treeMaximum :: Ord a =&gt; TreeIrr a -&gt; a\ntreeMaximum (No a []) = a\ntreeMaximum (No a children) = max a (maximum (map treeMaximum children))\n</code></pre>\n\n<p>Where <code>max :: Ord a =&gt; a -&gt; a -&gt; a</code>, and <code>maximum :: Ord a =&gt; [a] -&gt; a</code> are standard library functions.</p>\n"}], "owner": {"reputation": 285, "user_id": 1536010, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f56535dbaa6cec5a3bc7df07b08c84be?s=128&d=identicon&r=PG", "display_name": "skills", "link": "https://stackoverflow.com/users/1536010/skills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 28288449, "answer_count": 3, "score": 1, "last_activity_date": 1422919737, "creation_date": 1422916602, "question_id": 28288118, "link": "https://stackoverflow.com/questions/28288118/how-to-know-maximum-at-an-irregular-tree", "title": "How to know maximum at an irregular tree?", "body": "<p>I have an irregularly defined tree, how can i run through it and find the maximum value in it?</p>\n\n<p>My strategy was to build a list and take out the bigger value, my problem is, i only know binary trees, where i have the left and the right, like this: <code>Node x Empty Empty</code></p>\n\n<p>I have this structure now:</p>\n\n<pre><code>tree= No 2 [No 3 [No 6 []], No 4 [No 7 [], No 8 []], No 5 []]\n\ndata TreeIrr a = No a [TreeIrr a]\n</code></pre>\n\n<p>How is it supposed to be traversed?</p>\n\n<p>this is the best i could do:</p>\n\n<pre><code>maxi :: ArvIrr a -&gt; [a]\nmaxi (No a []) = [a]\nmaxi (No a l@((No b []):z)) = [a]++[b]++(maxis l)\n                    where\n                     maxis ((No x k):(No y z):ls) = [y]++maxis ls\nmaxi (No a [k]) = [a]++(maxi k)\n</code></pre>\n"}, {"tags": ["macos", "haskell", "ghc", "dynamic-linking"], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 3, "last_activity_date": 1423020228, "creation_date": 1423020228, "answer_id": 28312978, "question_id": 28288004, "link": "https://stackoverflow.com/questions/28288004/closure-and-info-symbols-in-ghc-dynamic-libraries/28312978#28312978", "title": "_closure and _info symbols in ghc dynamic libraries", "body": "<p>See this diagram of a closure from <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/HeapObjects\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/HeapObjects</a>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/NB7lO.png\" alt=\"layout of a closure\"></p>\n\n<p>Every ordinary (\"boxed\") Haskell value is represented in memory by an object called a closure. The first word of the closure is called the \"info pointer\" and identifies what sort of value it is, while the rest of the closure contains data that determines the specific value (for instance, the fields of an ADT). Most closures are dynamically allocated on the heap, but a compiled Haskell program can also contain so-called static closures in its data sections. The <code>_closure</code> symbols are these closures that live inside the object file, and the <code>_info</code> symbols are the pointers to the end of info tables and the start of entry code.</p>\n\n<p>For instance, if your program contains the source</p>\n\n<pre><code>x :: Integer\nx = 123\n</code></pre>\n\n<p>then it will be compiled into the core</p>\n\n<pre><code>x :: Integer\nx = S# 123#     -- S# is the \"small integer\" constructor for Integer,\n                -- and 123# is an unboxed Int# literal\n</code></pre>\n\n<p>and in the object file there will be a symbol with a name like <code>x_closure</code> which is two words long, whose first word points to <code>S#_info</code> (via an ELF relocation) and whose second word is the value 123. In this case, there is no need for an <code>x_info</code> because <code>x</code> is an <code>S#</code> value.</p>\n\n<p>For a function <code>f</code>, GHC will generate both an <code>f_info</code> which can be called directly when <code>f</code> is used in a context in which it is supplied enough arguments, and an <code>f_closure</code> with info pointer <code>f_info</code> which can be used otherwise (for example if <code>f</code> is used as an argument to a higher-order function). See <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/HeapObjects#FunctionClosures\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/HeapObjects#FunctionClosures</a>.</p>\n\n<p>As for your linker error, you probably have some interface files that are out of sync with their corresponding object files. There is no particular meaning to the name <code>findExecutable3</code>, it's just some auxiliary definition that got lifted to the top level when compiling <code>findExecutable</code>. I would guess that somewhere in the interface file for <code>System.Directory</code> (or a module which depends on it) you have some unfolding that refers to a function <code>findExecutable3</code>, but when <code>System.Directory</code> was compiled, <code>findExecutable3</code> actually ended up being some other sort of value.</p>\n"}], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1423020228, "creation_date": 1422916081, "question_id": 28288004, "link": "https://stackoverflow.com/questions/28288004/closure-and-info-symbols-in-ghc-dynamic-libraries", "title": "_closure and _info symbols in ghc dynamic libraries", "body": "<p>I'm wondering why some _closure symbols do not have corresponding _info symbols.</p>\n\n<p>On OSX I have installed ghc-7.8.3 via <a href=\"https://ghcformacosx.github.io/\" rel=\"nofollow\">https://ghcformacosx.github.io/</a></p>\n\n<p>If I run:</p>\n\n<pre><code>nm -gU /Applications/ghc-7.8.3.app/Contents/lib/ghc-7.8.3/bin/../directory-1.2.1.0/libHSdirectory-1.2.1.0-ghc7.8.3.dylib | grep findExecut\n</code></pre>\n\n<p>I get the following output:</p>\n\n<pre><code>0000000000010348 D _directoryzm1zi2zi1zi0_SystemziDirectory_findExecutable1_closure\n000000000000a3a8 T _directoryzm1zi2zi1zi0_SystemziDirectory_findExecutable1_info\n000000000000fe90 D _directoryzm1zi2zi1zi0_SystemziDirectory_findExecutable2_closure\n000000000000fe78 D _directoryzm1zi2zi1zi0_SystemziDirectory_findExecutable3_closure\n000000000000fe58 D _directoryzm1zi2zi1zi0_SystemziDirectory_findExecutable4_closure\n00000000000046c8 T _directoryzm1zi2zi1zi0_SystemziDirectory_findExecutable4_info\n00000000000105a8 D _directoryzm1zi2zi1zi0_SystemziDirectory_findExecutable_closure\n000000000000d6f0 T _directoryzm1zi2zi1zi0_SystemziDirectory_findExecutable_info\n0000000000010338 D _directoryzm1zi2zi1zi0_SystemziDirectory_findExecutablezuzdsa_closure\n000000000000a030 T _directoryzm1zi2zi1zi0_SystemziDirectory_findExecutablezuzdsa_info\n</code></pre>\n\n<p>Note that not all of the _closure symbols have corresponding _info symbols.</p>\n\n<p>I have a situation where tar-0.4.1.0 is referencing the findExecutable3_info symbol, and linking fails because it isn't found. But first I'd like to understand the why and wherefores of the _info symbols.</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 0, "creation_date": 1422915204, "post_id": 28287655, "comment_id": 44929412, "body": "sudo make me a sandwich?"}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 0, "creation_date": 1422915227, "post_id": 28287655, "comment_id": 44929425, "body": "@GradyPlayer: it looks like Windows to me. (<code>setup.exe</code>)"}, {"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 1, "creation_date": 1422915301, "post_id": 28287655, "comment_id": 44929461, "body": "oh yeah, <code>sudo.exe</code> :) ... shivers"}], "answers": [{"tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": false, "score": 5, "last_activity_date": 1422915803, "last_edit_date": 1422915803, "creation_date": 1422915234, "answer_id": 28287792, "question_id": 28287655, "link": "https://stackoverflow.com/questions/28287655/cabal-cannot-install-postgresql-libpq-0-9-0-2/28287792#28287792", "title": "Cabal cannot install postgresql-libpq-0.9.0.2", "body": "<p>It looks like you need the external program <code>pg_config</code> which presumably comes with postgres. Make sure that postgres is installed correctly and all of its binaries are in your path. </p>\n\n<p>I'm assuming you're on Windows, in which case install the postgres bindings is tricky. Take a look at instructions <a href=\"https://github.com/lpsmith/postgresql-simple/pull/66\" rel=\"nofollow\">here</a> and <a href=\"https://github.com/hdbc/hdbc-postgresql/wiki/WindowsInstall\" rel=\"nofollow\">here</a> which are for libraries that <em>depend</em> on <code>postgresql-libpq</code> and make sure that you followed all the relevant steps.</p>\n\n<p>The most relevant part to your current problem is updating your <code>Path</code> variable and adding something like <code>C:\\Program Files\\PostgreSQL\\9.2\\bin</code>, as detailed in the first link.</p>\n"}, {"comments": [{"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "edited": false, "score": 0, "creation_date": 1487925488, "post_id": 30821872, "comment_id": 72012576, "body": "This solved my issue.  I use Cygwin to run <b>fish shell</b>, and faced issue while building <code>postgresql-libpq</code>.  Installing both <code>libpq-devel</code> and <code>postgresql-devel</code> via Cygwin installer does not solved it.  After I have installed <b>PostgreSQL for Windows</b> the issue was resolved.  Thanks!"}, {"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "edited": false, "score": 0, "creation_date": 1488724516, "post_id": 30821872, "comment_id": 72348607, "body": "On dockerized Debian 8 Jessie I had to install <code>postgresql-server-9.4</code> among with <code>libpq-dev</code> to resolve same issue"}], "tags": [], "owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "is_accepted": false, "score": 2, "last_activity_date": 1434218514, "creation_date": 1434218514, "answer_id": 30821872, "question_id": 28287655, "link": "https://stackoverflow.com/questions/28287655/cabal-cannot-install-postgresql-libpq-0-9-0-2/30821872#30821872", "title": "Cabal cannot install postgresql-libpq-0.9.0.2", "body": "<p>What worked for me was to install postgres for the correct CPU architecture from: <a href=\"http://www.postgresql.org/download/windows/\" rel=\"nofollow\">http://www.postgresql.org/download/windows/</a> and after that adding the bin folder to the system path.</p>\n"}], "owner": {"reputation": 81, "user_id": 4521773, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHS2qY_W4TM/AAAAAAAAAAI/AAAAAAAAADw/E0oyRVdFT7g/photo.jpg?sz=128", "display_name": "antonniette sumatra", "link": "https://stackoverflow.com/users/4521773/antonniette-sumatra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1606, "favorite_count": 2, "answer_count": 2, "score": 8, "last_activity_date": 1434218514, "creation_date": 1422914654, "last_edit_date": 1422917720, "question_id": 28287655, "link": "https://stackoverflow.com/questions/28287655/cabal-cannot-install-postgresql-libpq-0-9-0-2", "title": "Cabal cannot install postgresql-libpq-0.9.0.2", "body": "<p>Both <code>cabal install postgresql-libpq-0.9.0.2</code> and \n<code>cabal install --reinstall postgresql-libpq-0.9.0.2</code> didnt work</p>\n\n<pre><code>Configuring postgresql-libpq-0.9.0.2...\nsetup.exe: The program pg_config is required but it could not be found.\ncabal: Error: some packages failed to install:\npostgresql-libpq-0.9.0.2 failed during the configure step. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>Note: I am on local</p>\n"}, {"tags": ["haskell", "ghc", "parsec"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1422916131, "post_id": 28287329, "comment_id": 44929832, "body": "I&#39;m guessing GHC has been changed to require the appropriate language extensions when an <i>inferred</i> type requires them. Currently, it will happily infer types with all sorts of exotic things like TypeFamilies and DataKinds without those things enabled in that module. I can&#39;t find any documentation of this change, however. The most general type of <code>prop</code> is <code>Stream s m Char =&gt; Char -&gt; [Char] -&gt; ParsecT s u m [Char]</code>, for which you would need FlexibleContexts to write."}], "answers": [{"comments": [{"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1436386931, "post_id": 28288103, "comment_id": 50595930, "body": "hmm perhaps I&#39;m doing it wrong but this would appear to be the issue in ghci (7.10.1) if you concat two simple strings, e.g. &quot;Has&quot; ++ &quot;kell&quot;. I have to say if I didn&#39;t know Haskell is the bees knees and was committed to learning it, an error on something simple like string concatenation might nope me the hell away from the language."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1436390699, "post_id": 28288103, "comment_id": 50597867, "body": "@engineerDave What is the error you&#39;re seeing?  The only possible extensions that might come into play are <code>OverloadedStrings</code> or <code>OverloadedLists</code>, neither of which are enabled by default."}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1436392254, "post_id": 28288103, "comment_id": 50598606, "body": "Umm. I think this may be an error introduced by a cabal package. Given the lunacy of not being able to concat two strings, I assumed PEKAC and I changed to a &quot;clean&quot; directory, i.e. no cabal sandbox and this error went away. So I guess red faced I have to crawl back into my hidey hole and thank you for your diligent response to my Haskell n00b comment"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 2, "creation_date": 1436392387, "post_id": 28288103, "comment_id": 50598663, "body": "@engineerDave Yeah, it can happen if you have <code>OverloadedStrings</code> turned on globally for your cabal project, then started ghci using <code>cabal repl</code>.  I&#39;ve run into that before too, it&#39;s not just a noob problem!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1458452690, "post_id": 28288103, "comment_id": 59862874, "body": "@bheklilr, this is one of the reasons most people avoid global cabal options and just live with verbosity."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 19, "last_activity_date": 1422916548, "creation_date": 1422916548, "answer_id": 28288103, "question_id": 28287329, "link": "https://stackoverflow.com/questions/28287329/ghc-7-10-non-type-variable-argument-use-flexiblecontexts-to-permit-this/28288103#28288103", "title": "ghc-7.10: Non type-variable argument (Use FlexibleContexts to permit this)", "body": "<p><a href=\"https://downloads.haskell.org/~ghc/7.10.1-rc1/docs/html/users_guide/release-7-10-1.html\">This was a change introduced in GHC 7.10.1-rc1</a>:</p>\n\n<blockquote>\n  <p>GHC now checks that all the language extensions required for the inferred type signatures are explicitly enabled. This means that if any of the type signatures inferred in your program requires some language extension you will need to enable it. The motivation is that adding a missing type signature inferred by GHC should yield a program that typechecks. Previously this was not the case.</p>\n  \n  <p>This is a breaking change. Code that used to compile in the past might fail with an error message requiring some particular language extension (most likely <code>-XTypeFamilies</code>, <code>-XGADTs</code> or <code>-XFlexibleContexts</code>).</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "is_accepted": false, "score": 0, "last_activity_date": 1458417574, "creation_date": 1458417574, "answer_id": 36106479, "question_id": 28287329, "link": "https://stackoverflow.com/questions/28287329/ghc-7-10-non-type-variable-argument-use-flexiblecontexts-to-permit-this/36106479#36106479", "title": "ghc-7.10: Non type-variable argument (Use FlexibleContexts to permit this)", "body": "<p>I got this error after setting up a barebone Snap application as described <a href=\"https://github.com/begriffs/heroku-buildpack-ghc\" rel=\"nofollow\">here</a>.</p>\n\n<p>String operations like <code>\"\" ++ \"\"</code> or <code>\"Haskell\" !! 2</code> were broken. When sourcing a Haskell file from GHCI, I got a variant of this error:</p>\n\n<blockquote>\n  <p>No instance for (Data.String.IsString [a0])\n        arising from the literal <code>\"my string\"'\n      The type variable</code>a0' is ambiguous\n      Relevant bindings include myString :: [a0] (bound at myFile.hs:11:1)\n      Note: there is a potential instance available:\n        instance Data.String.IsString [Char] -- Defined in <code>Data.String'\n      In the expression: \"my string\"\n      In an equation for</code>variable': variable = \"my string\"</p>\n</blockquote>\n\n<p><strong>Solution:</strong></p>\n\n<p>The way to fix this was to remove the line <code>:set -XOverloadedStrings</code> from the <code>.ghci</code> file in my project and restart GHCI.</p>\n"}, {"tags": [], "owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "is_accepted": false, "score": 1, "last_activity_date": 1461267508, "creation_date": 1461267508, "answer_id": 36778965, "question_id": 28287329, "link": "https://stackoverflow.com/questions/28287329/ghc-7-10-non-type-variable-argument-use-flexiblecontexts-to-permit-this/36778965#36778965", "title": "ghc-7.10: Non type-variable argument (Use FlexibleContexts to permit this)", "body": "<p>I'm having the same issue with my code, part of it that uses Parsec and part of it that doesn't. Most all of these point to functions without signatures in a <code>where</code> block.</p>\n\n<p>The solution that works for me is to add explicit signatures for the functions, where you can use the inferred type you get from the error for the most part, but rather than keeping types such as <code>ParsecT s u m [Char]</code> generic, I supply the <strong>concrete type</strong> I want, such as <code>Parsec String () [Char]</code>.</p>\n"}], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7158, "favorite_count": 1, "accepted_answer_id": 28288103, "answer_count": 3, "score": 14, "last_activity_date": 1461267508, "creation_date": 1422913430, "question_id": 28287329, "link": "https://stackoverflow.com/questions/28287329/ghc-7-10-non-type-variable-argument-use-flexiblecontexts-to-permit-this", "title": "ghc-7.10: Non type-variable argument (Use FlexibleContexts to permit this)", "body": "<p>I was trying to use ghc-7.10 (RC 2) and got this message in a number of cases, e.g.,</p>\n\n<pre><code>src/Text/Regex/XMLSchema/Generic/RegexParser.hs:439:5:\n    Non type-variable argument\n      in the constraint: Text.Parsec.Prim.Stream s m Char\n    (Use FlexibleContexts to permit this)\n    When checking that \u2018prop\u2019 has the inferred type\n      prop :: forall s u (m :: * -&gt; *) (t :: * -&gt; *).\n              (Foldable t, Text.Parsec.Prim.Stream s m Char) =&gt;\n              Char -&gt; t Char -&gt; Text.Parsec.Prim.ParsecT s u m [Char]\n    In an equation for \u2018isCategory'\u2019:\n        isCategory'\n          = (foldr1 (&lt;|&gt;) . map (uncurry prop)\n             $ [('L', \"ultmo\"), ('M', \"nce\"), ('N', \"dlo\"), ....])\n            &lt;?&gt; \"illegal Unicode character property\"\n          where\n              prop c1 cs2\n                = do { _ &lt;- char c1;\n                       .... }\nFailed to install hxt-regex-xmlschema-9.2.0\n</code></pre>\n\n<p>This must be something that is introduced by the new ghc, or the new base that comes with it, or the new parsec (3.1.8), since it worked before. </p>\n\n<p>source code snippet:</p>\n\n<pre><code>isCategory'     :: Parser String\nisCategory'\n    = ( foldr1 (&lt;|&gt;) . map (uncurry prop) $\n        [ ('L', \"ultmo\")\n        , ('M', \"nce\")\n        , ('N', \"dlo\")\n        , ('P', \"cdseifo\")\n        , ('Z', \"slp\")\n        , ('S', \"mcko\")\n        , ('C', \"cfon\")\n        ]\n      ) &lt;?&gt; \"illegal Unicode character property\"\n    where\n    prop c1 cs2\n        = do\n          _ &lt;- char c1\n          s2 &lt;- option \"\"\n                ( do\n                  c2 &lt;- satisfy (`elem` cs2)\n                  return [c2] )\n          return $ c1:s2\n</code></pre>\n\n<p>Note: I am not asking about this specific libray (hxt-*) since I observed this in other places also.</p>\n"}, {"tags": ["haskell", "data-structures", "recursive-datastructures"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1422911236, "post_id": 28286694, "comment_id": 44927467, "body": "I recommend the naive representation (your first one), plus a function <code>canonicalize :: Property a -&gt; Property a</code> that <a href=\"http://en.wikipedia.org/wiki/Canonical_normal_form\" rel=\"nofollow noreferrer\">picks one of the famous normal forms</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1422911430, "post_id": 28286694, "comment_id": 44927569, "body": "Another choice, with its own merits and demerits, is to jump straight to the denotation: <code>type Property a = (a -&gt; Bool) -&gt; Bool</code>. Whether that&#39;s reasonable depends a lot on what operations you want to be able to perform on a <code>Property a</code>... can you elaborate on that, please?"}, {"owner": {"reputation": 1131, "user_id": 2615160, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6c82d2b99325ea24eedae70d7ea24bc8?s=128&d=identicon&r=PG", "display_name": "Sergey Sosnin", "link": "https://stackoverflow.com/users/2615160/sergey-sosnin"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1422911777, "post_id": 28286694, "comment_id": 44927733, "body": "I work on query to query matching, so my first idea was to build logical trees, canonicalize it by any way and match two trees."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1422932455, "post_id": 28289584, "comment_id": 44934813, "body": "re: &quot;you should convince yourself...&quot;, the Wikipedia page you linked says, in part, &quot;ANF is a normal form, which means that two equivalent formulas will convert to the same ANF&quot;."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1422933384, "post_id": 28289584, "comment_id": 44934997, "body": "@DanielWagner A simple assertion, much less a simple uncited assertion in a Wikipedia article, is not enough to convince me. I have, so-far, failed to convince myself. Other Wikipedia articles on &quot;normal&quot; forms make similar claims, despite trivial counter examples. Both <code>(a \u2227 &#172;b) \u2228 (a \u2227 b)</code> and <code>a</code> are in &quot;disjunctive normal form&quot;, and both of them mean the same thing. Disjunctive normal form as described on Wikipedia isn&#39;t really a normal form. Only specific variants of it, such as full disjunctive normal form where every variable appears in every conjunction, are normal forms."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422934491, "post_id": 28289584, "comment_id": 44935238, "body": "Another interesting answer from Cirdec."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1422944170, "post_id": 28289584, "comment_id": 44938010, "body": "@Cirdec While I appreciate your skepticism, your criticism of Wikipedia looks unwarranted to me; the Wikipedia page for &quot;Disjunctive normal form&quot; is quite clear that only full disjunctive normal form is canonical, and the Wikipedia page for &quot;Canonical normal form&quot; looks likewise quite careful about what forms have the &quot;equivalent formulas have the same form&quot; property."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1422972815, "post_id": 28289584, "comment_id": 44953325, "body": "@phadej The question is explicitly about testing for tautological equivalence, starting with a structure very close to &quot;negation normal form&quot;. Testing for tautological equivalence is necessarily NP hard (testing if <code>f == const False</code> is the (un)satisfiability problem), but doesn&#39;t necessarily require exponential space."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 11, "last_activity_date": 1422970574, "last_edit_date": 1422970574, "creation_date": 1422924851, "answer_id": 28289584, "question_id": 28286694, "link": "https://stackoverflow.com/questions/28286694/a-data-structure-for-logical-expressions-in-haskell/28289584#28289584", "title": "A data structure for Logical Expressions in Haskell", "body": "<p>We're going to follow Daniel Wagner's excellent suggestion and use the \"naive representation (your first one), plus a function that picks one of the famous normal forms\". We are going to use <a href=\"http://en.wikipedia.org/wiki/Algebraic_normal_form\" rel=\"noreferrer\">algebraic normal form</a> for two reasons. The main reason is that algebraic normal form doesn't require enumerating all the possible values of the variable type held in a <code>Property</code>. Algebraic normal form is also fairly simple.</p>\n\n<h3>Algebraic Normal Form</h3>\n\n<p>We'll represent algebraic normal form with a <code>newtype ANF a = ANF [[a]]</code> that doesn't export its constructor. Each inner list is a conjunction (and-ing) of all of its predicates; if an inner list is empty it is always true. The outer list is an exclusive or-ing of all of its predicates; if it is empty it is false.</p>\n\n<pre><code>module Logic (\n    ANF (getANF),\n    anf,\n    ...\n)\n\nnewtype ANF a = ANF {getANF :: [[a]]}\n  deriving (Eq, Ord, Show)\n</code></pre>\n\n<p>We will make efforts so that any <code>ANF</code> we construct will be canonical. We will build <code>ANF</code>s so that the inner list is always sorted and unique. The outer list will also always be sorted. If there are two (or an even number of) identical items in the outer list we will remove them both. If there are an odd number of identical items in the outer list, we will remove all but one of them.</p>\n\n<p>Using functions from <a href=\"https://hackage.haskell.org/package/data-ordlist-0.4.7.0/docs/Data-List-Ordered.html\" rel=\"noreferrer\"><code>Data.List.Ordered</code></a> in the <a href=\"https://hackage.haskell.org/package/data-ordlist\" rel=\"noreferrer\">data-ordlist</a> package, we can clean up a list of lists representing the xor-ing of conjunctions into an <code>ANF</code> with the lists sorted and duplicates removed.</p>\n\n<pre><code>import qualified Data.List.Ordered as Ordered\n\nanf :: Ord a =&gt; [[a]] -&gt; ANF a\nanf = ANF . nubPairs . map Ordered.nubSort\n\nnubPairs :: Ord a =&gt; [a] -&gt; [a]\nnubPairs = removePairs . Ordered.sort\n    where\n        removePairs (x:y:zs)\n            | x == y    = removePairs zs\n            | otherwise = x:removePairs (y:zs)\n        removePairs xs = xs\n</code></pre>\n\n<p>Logical expressions form a <a href=\"http://en.wikipedia.org/wiki/Boolean_algebra_(structure)\" rel=\"noreferrer\">boolean algebra</a>, which is a bounded lattice with an additional distributive law and a complement (negation). Taking advantage of the existing <a href=\"https://hackage.haskell.org/package/lattices-1.2.1.1/docs/Algebra-Lattice.html#t:BoundedLattice\" rel=\"noreferrer\"><code>BoundedLattice</code></a> class in the <a href=\"https://hackage.haskell.org/package/lattices\" rel=\"noreferrer\">lattices</a> package, we can define the class of <code>BooleanAlgebra</code>s</p>\n\n<pre><code>import Algebra.Lattice\n\nclass (BoundedLattice a) =&gt; BooleanAlgebra a where\n    complement :: a -&gt; a\n    -- Additional Laws:\n    -- a `join` complement a == top\n    -- a `meet` complement a == bottom\n    -- a `join` (b `meet` c) == (a `join` b) `meet` (a `join` c)\n    -- a `meet` (b `join` c) == (a `meet` b) `join` (a `meet` c)\n</code></pre>\n\n<p><code>ANF a</code>s form a <code>BooleanAlgebra</code> whenever <code>a</code> has an <code>Ord</code> instance so that we can keep the <code>ANF</code> in canonical form.</p>\n\n<p>The <code>meet</code> of a boolean algebra is logical <code>and</code>. Logical <code>and</code> distributes across <code>xor</code>. We will take advantage of the fact that the inner lists are already sorted to quickly merge them together distinctly. </p>\n\n<pre><code>instance (Ord a) =&gt; MeetSemiLattice (ANF a) where\n    ANF xs `meet` ANF ys = ANF (nubPairs [Ordered.union x y | x &lt;- xs, y &lt;- ys])\n</code></pre>\n\n<p>Using <a href=\"http://en.wikipedia.org/wiki/De_Morgan%27s_laws\" rel=\"noreferrer\">De Morgan's laws</a>, the <code>join</code> or logical <code>or</code> can be written in terms of the <code>meet</code> or logical <code>and</code>.</p>\n\n<pre><code>instance (Ord a) =&gt; JoinSemiLattice (ANF a) where\n    xs `join` ys = complement (complement xs `meet` complement ys)\n</code></pre>\n\n<p>The <code>top</code> of the lattice is always true.</p>\n\n<pre><code>instance (Ord a) =&gt; BoundedMeetSemiLattice (ANF a) where\n    top = ANF [[]]\n</code></pre>\n\n<p>The <code>bottom</code> of the lattice is always false.</p>\n\n<pre><code>instance (Ord a) =&gt; BoundedJoinSemiLattice (ANF a) where\n    bottom = ANF []\n</code></pre>\n\n<p>Logical <code>and</code> and logical <code>or</code> satisfy the lattice absorption law, <code>a join (a meet b) == a meet (a join b) == a</code>.</p>\n\n<pre><code>instance (Ord a) =&gt; Lattice (ANF a)\ninstance (Ord a) =&gt; BoundedLattice (ANF a)\n</code></pre>\n\n<p>Finally the <code>complement</code> operation is negation, which can be accomplished by <code>xor</code>ing by true.</p>\n\n<pre><code>instance (Ord a) =&gt; BooleanAlgebra (ANF a) where\n    complement (ANF ([]:xs)) = ANF xs\n    complement (ANF xs)      = ANF ([]:xs)\n</code></pre>\n\n<p>Along with <a href=\"https://hackage.haskell.org/package/pointed-4.2/docs/Data-Pointed.html\" rel=\"noreferrer\"><code>Pointed</code></a> we can use <code>BooleanAlgebra</code> to define the class of things that hold logical expressions, <code>Logical</code>.</p>\n\n<pre><code>import Data.Pointed\n\nclass Logical f where\n    toLogic :: (Pointed g, BooleanAlgebra (g a)) =&gt; f a -&gt; g a\n</code></pre>\n\n<p>Algebraic normal form holds a logical expression.</p>\n\n<pre><code>xor :: BooleanAlgebra a =&gt; a -&gt; a -&gt; a\np `xor` q = (p `join` q) `meet` complement (p `meet` q)\n\ninstance Logical ANF where\n    toLogic = foldr xor bottom . map (foldr meet top . map point) . getANF\n</code></pre>\n\n<p>Algebraic normal form is also <code>Pointed</code>, and thus can be converted to using <code>toLogic</code>.</p>\n\n<pre><code>instance Pointed ANF where\n    point x = ANF [[x]]\n\ntoANF :: (Logical f, Ord a) =&gt; f a -&gt; ANF a\ntoANF = toLogic\n</code></pre>\n\n<p>We can test if anything <code>Logical</code> is logically equivalent by comparing to see if it is structurally equivalent when converted to canonical algebraic normal form.</p>\n\n<pre><code>equivalent :: (Logical f, Logical g, Ord a) =&gt; f a -&gt; g a -&gt; Bool\nequivalent a b = toANF a == toANF b\n</code></pre>\n\n<h3>Converting Property to ANF</h3>\n\n<p>Logical expressions should form a boolean algebra, which is a bounded lattice with an additional distributive law and a complement (negation). To make <code>Property</code> more closely parallel a boolean algebra, we need to add two more elements for the <code>top</code> and <code>bottom</code> bounds of the lattice. <code>top</code> is always <code>True</code>, and <code>bottom</code> is always <code>False</code>. I'm going to call these <code>Trivial</code> for properties that are always <code>True</code> and <code>Impossible</code> for properties that are always <code>False</code>.</p>\n\n<pre><code>data Property a\n    = And (Property a) (Property a)\n    | Or  (Property a) (Property a)\n    | Not (Property a)\n    | Property a\n    | Trivial\n    | Impossible\n  deriving (Eq, Ord, Read, Show)\n</code></pre>\n\n<p><code>Property</code> is an abstract syntax tree for a property. Its derived <code>Eq</code> and <code>Ord</code> instances are only structural equality.</p>\n\n<p>A <code>Property</code> is <code>Logical</code>, and we can convert it into any <code>Pointed</code> <code>BooleanAlgebra</code>.</p>\n\n<pre><code>instance Logical Property where\n    toLogic (And a b)    = (toLogic a) `meet` (toLogic b)\n    toLogic (Or  a b)    = (toLogic a) `join` (toLogic b)\n    toLogic (Not a)      = complement (toLogic a)\n    toLogic (Property a) = point a\n    toLogic Trivial      = top\n    toLogic Impossible   = bottom\n</code></pre>\n\n<p>Using <code>equivalent</code> from the previous section and our <code>Logical</code> instance, we can check to see if two properties are equivalent for some examples.</p>\n\n<pre><code>runExample :: (Ord a, Show a) =&gt; Property a -&gt; Property a -&gt; IO ()\nrunExample p q = \n    if p `equivalent` q\n    then putStrLn (show p ++ \" == \" ++ show q)\n    else putStrLn (show p ++ \" /= \" ++ show q)\n\nmain = do\n    runExample (point 'a' `meet` point 'b') (point 'b' `meet` point 'a')\n    runExample (point 'a' `meet` point 'b') (point 'b' `meet` point 'a' `meet` point 'a')\n    runExample (point 'a' `meet` point 'b') (point 'b' `meet` point 'a' `join` point 'a')\n    runExample (point 'a' `join` complement (point 'a')) (top)\n    runExample (point 'a' `meet` complement (point 'a')) (bottom)\n</code></pre>\n\n<p>This produces the following output.</p>\n\n<pre><code>And (Property 'a') (Property 'b') == And (Property 'b') (Property 'a')\nAnd (Property 'a') (Property 'b') == And (And (Property 'b') (Property 'a')) (Pr\noperty 'a')\nAnd (Property 'a') (Property 'b') /= Or (And (Property 'b') (Property 'a')) (Pro\nperty 'a')\nOr (Property 'a') (Not (Property 'a')) == Trivial\nAnd (Property 'a') (Not (Property 'a')) == Impossible\n</code></pre>\n\n<p>To use these examples as written, we also need <code>BooleanAlgebra</code> and <code>Pointed</code> instances for <code>Property</code>. The equivalence relation for the <code>BooleanAlgebra</code> laws is equivalent interpretations rather than the structural equality of <code>Property</code>.</p>\n\n<pre><code>instance MeetSemiLattice (Property a) where\n    meet = And\n\ninstance BoundedMeetSemiLattice (Property a) where\n    top = Trivial\n\ninstance JoinSemiLattice (Property a) where\n    join = Or\n\ninstance BoundedJoinSemiLattice (Property a) where\n    bottom = Impossible\n\ninstance Lattice (Property a)\ninstance BoundedLattice (Property a)\n\ninstance BooleanAlgebra (Property a) where\n    complement = Not\n\ninstance Pointed Property where\n    point = Property\n</code></pre>\n\n<h3>Proof</h3>\n\n<p>Every Boolean function, and thus every finite <code>Property</code>, has a <em>unique</em> representation in <code>ANF</code>. The <code>BooleanAlgebra</code> and <code>Pointed</code> instances for <code>ANF</code> demonstrated that everything <code>Logical a</code>, and thus every finite <code>Property a</code> and Boolean function indexed by <code>a</code>, has a representation in <code>ANF a</code>. Let <code>k</code> be the number of inhabitants of <code>a</code>. There are <code>2^(2^k)</code> possible Boolean functions of <code>k</code> Boolean variables. Each inner list of an <code>ANF</code> is a set of <code>a</code>s; there are <code>2^k</code> possible sets of <code>a</code>s and thus <code>2^k</code> possible inner lists. The outer list of an <code>ANF</code> is a set of inner lists; each inner list can occur at most once in the outer list. There are <code>2^(2^k)</code> possible <code>ANF a</code>s. Since every Boolean function has a representation in <code>ANF</code> and there are only as many possible inhabitants of <code>ANF</code> as there are Boolean functions, each Boolean function has a <em>unique</em> representation in <code>ANF</code>.</p>\n\n<h3>Disclaimer</h3>\n\n<p>The <code>Ord</code> instance for <code>ANF</code> is a structural order and, except for equality, has nothing to do with the partial orders induced by the lattice structure.</p>\n\n<p>Algebraic normal form can be exponentially larger than its input. The disjunction of a list of <code>n</code> variables has size <code>.5*n*2^n</code>. For example, <code>length . getANF . foldr join bottom . map point $ ['a'..'g']</code> is <code>127</code> and <code>foldr join bottom . map point $ ['a'..'g']</code> contains a total of <code>448</code> occurrences of the <code>7</code> different variables.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1422950577, "post_id": 28292867, "comment_id": 44940577, "body": "And which data structure reflects deMorgan&#39;s laws...? =P"}], "tags": [], "owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "is_accepted": false, "score": 0, "last_activity_date": 1422945710, "creation_date": 1422945710, "answer_id": 28292867, "question_id": 28286694, "link": "https://stackoverflow.com/questions/28286694/a-data-structure-for-logical-expressions-in-haskell/28292867#28292867", "title": "A data structure for Logical Expressions in Haskell", "body": "<p>If you want to reflect the associativity of logical connectives <em>and</em> (<code>&amp;&amp;</code>) and <em>or</em>, use a data structure that is associative, like list:</p>\n\n<pre><code>data Property a = And [Property a] | ...\n</code></pre>\n\n<p>If you also want commutativity (<code>A &amp;&amp; B == B &amp;&amp; A</code>), go with <a href=\"https://downloads.haskell.org/~ghc/6.12.2/docs/html/libraries/containers-0.3.0.0/Data-Set.html\" rel=\"nofollow\">Data.Set</a>.</p>\n\n<p>I remember this handy chart for which types to use if you want certain properties:</p>\n\n<pre><code>+-----------+-----------+----------+----------\n|Associative|Commutative|Idempotent|   type\n+-----------+-----------+----------+----------\n|(a+b)+c=   |  a+b=b+a  |  a+a=a   |\n|    a+(b+c)|           |          |\n+-----------+-----------+----------+----------\n|    no     |    no     |    no    |binary trees\n|    no     |   yes     |    no    | \u201cmobiles\u201d\n|   yes     |    no     |    no    |lists (arrays)\n|   yes     |   yes     |    no    |multisets (bags)\n|   yes     |   yes     |   yes    |sets\n+-----------+-----------+----------+----------\n</code></pre>\n\n<p>Page 51 of <a href=\"http://groups.csail.mit.edu/mac/users/gjs/6.945/readings/MITApril2009Steele.pdf\" rel=\"nofollow\">Guy Steele's Lecture</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1423011651, "post_id": 28311460, "comment_id": 44974002, "body": "There&#39;s no reason to restrict the problem to <code>Property Bool</code>. The type argument to <code>Property</code> isn&#39;t the type of the result, it&#39;s the type of the index for the variables. As long as it has an <code>Ord</code> or <code>Eq</code> instance, it can be converted to another index like <code>Int</code>s in <code>O(n*log n)</code> or <code>O(n^2)</code> time."}, {"owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1423013023, "post_id": 28311460, "comment_id": 44974352, "body": "Ah, quite right. If the &#39;a&#39; parameter is just indexing into variables, then indeed it would be easy to translate this to a SAT/SMT problem, and use an off-the-shelf solver to do the equivalence checking. Also note that the backend solver will return a counter-example model if the two formulas are not equivalent, which can then be used further. i.e.; the &quot;not-equal&quot; answer will be substantiated with a model that shows why the equivalence fails instead of a plain &quot;no&quot; answer."}], "tags": [], "owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "is_accepted": false, "score": 1, "last_activity_date": 1423017297, "last_edit_date": 1495540259, "creation_date": 1423010099, "answer_id": 28311460, "question_id": 28286694, "link": "https://stackoverflow.com/questions/28286694/a-data-structure-for-logical-expressions-in-haskell/28311460#28311460", "title": "A data structure for Logical Expressions in Haskell", "body": "<p>I'd recommend using a SAT/SMT solver for the equivalence check. In general, these sorts of checks can be very expensive (NP-complete), and any sort of translation to normal-forms can cause exponential blow-up in representation. SAT/SMT solvers have custom algorithms for dealing with such problems, and it might be best to use such a solver. It would be trivial to translate two instances of <code>Property</code> and ask if they are the same under all variable assignments. SBV library (<a href=\"https://hackage.haskell.org/package/sbv\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/sbv</a>) can be used to do the translation from high-level Haskell. The answer to the following question has some details on how to go about doing that: <a href=\"https://stackoverflow.com/questions/23233969/sat-solving-with-haskell-sbv-library-how-to-generate-a-predicate-from-a-parsed\">SAT solving with haskell SBV library: how to generate a predicate from a parsed string?</a></p>\n"}], "owner": {"reputation": 1131, "user_id": 2615160, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6c82d2b99325ea24eedae70d7ea24bc8?s=128&d=identicon&r=PG", "display_name": "Sergey Sosnin", "link": "https://stackoverflow.com/users/2615160/sergey-sosnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3768, "favorite_count": 0, "accepted_answer_id": 28289584, "answer_count": 3, "score": 7, "last_activity_date": 1423017297, "creation_date": 1422910998, "question_id": 28286694, "link": "https://stackoverflow.com/questions/28286694/a-data-structure-for-logical-expressions-in-haskell", "title": "A data structure for Logical Expressions in Haskell", "body": "<p>I try to create a data structure for working with logical expressions. At first glance, the logical expressions look like <code>Trees</code>, so it seems reasonable to make up it from trees: </p>\n\n<pre><code>data Property a = And (Property a) (Property a) |\n                 Or  (Property a) (Property a) |\n                 Not (Property a) | Property a   deriving (Show,Eq)\n</code></pre>\n\n<p>But it isn't a good idea, because really there is no difference between left and right branches of my tree, since <code>A &amp;&amp; B == B &amp;&amp; A</code> </p>\n\n<p>Well, maybe <code>List</code> is even better?</p>\n\n<pre><code>data Property a = Empty | And a (Property a) | Or a (Property a) | Not a (Property a)  deriving Show\n</code></pre>\n\n<p>But in this case, I can't really form a 'logic tree', only a 'logic list '.\nSo I need a data structure similar to <code>Tree</code> but without left and right \"branching\". </p>\n"}, {"tags": ["csv", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 919, "user_id": 1819186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/71b04413070a897f1c5c7055ae281f02?s=128&d=identicon&r=PG", "display_name": "Anthony W", "link": "https://stackoverflow.com/users/1819186/anthony-w"}, "edited": false, "score": 0, "creation_date": 1422911173, "post_id": 28286574, "comment_id": 44927424, "body": "So now the compiler gives me this: Couldn&#39;t match type <code>BL.ByteString&#39; with </code>[Char]&#39;     Expected type: String       Actual type: BL.ByteString     In the first argument of <code>processMyData&#39;, namely </code>csv&#39;     In the expression: processMyData csv     In an equation for `output&#39;: output = processMyData csv"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 919, "user_id": 1819186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/71b04413070a897f1c5c7055ae281f02?s=128&d=identicon&r=PG", "display_name": "Anthony W", "link": "https://stackoverflow.com/users/1819186/anthony-w"}, "edited": false, "score": 0, "creation_date": 1422911229, "post_id": 28286574, "comment_id": 44927460, "body": "@AnthonyW I&#39;m sorry for any mistakes I might have made. This should give you enough to get it to work, though"}, {"owner": {"reputation": 919, "user_id": 1819186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/71b04413070a897f1c5c7055ae281f02?s=128&d=identicon&r=PG", "display_name": "Anthony W", "link": "https://stackoverflow.com/users/1819186/anthony-w"}, "edited": false, "score": 1, "creation_date": 1422911869, "post_id": 28286574, "comment_id": 44927781, "body": "yep. the type of signature of processMyData is ByteString -&gt; String"}, {"owner": {"reputation": 919, "user_id": 1819186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/71b04413070a897f1c5c7055ae281f02?s=128&d=identicon&r=PG", "display_name": "Anthony W", "link": "https://stackoverflow.com/users/1819186/anthony-w"}, "edited": false, "score": 0, "creation_date": 1422912332, "post_id": 28286574, "comment_id": 44928010, "body": "and I&#39;d like to get ByteString -&gt; [(Int,Int)]"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 919, "user_id": 1819186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/71b04413070a897f1c5c7055ae281f02?s=128&d=identicon&r=PG", "display_name": "Anthony W", "link": "https://stackoverflow.com/users/1819186/anthony-w"}, "edited": false, "score": 0, "creation_date": 1422954084, "post_id": 28286574, "comment_id": 44942328, "body": "@AnthonyW <a href=\"https://www.haskell.org/hoogle/?hoogle=ByteString+-%3E+String\" rel=\"nofollow noreferrer\">You might find this useful</a>. Sorry for not being there to help you yesterday, I had just enough time to write the answer. If you&#39;ve managed (or manage to fix the problems in the future), edit my answer or add your own!"}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 3, "last_activity_date": 1422910915, "last_edit_date": 1495539812, "creation_date": 1422910577, "answer_id": 28286574, "question_id": 28286393, "link": "https://stackoverflow.com/questions/28286393/creating-a-list-when-parsing-a-file-using-cassava-in-haskell/28286574#28286574", "title": "Creating a list when parsing a file using Cassava in Haskell", "body": "<blockquote>\n  <p>I'm doing something hopelessly silly...</p>\n</blockquote>\n\n<p>Yes, but worry not!</p>\n\n<pre><code>loadMyData = BL.readFile \"mydata.csv\"\n\nprocessMyData :: String -&gt; String\nprocessMyData csvData = \n  case decodeByName csvData of\n        Left err -&gt; err \n        Right (_, v) -&gt; show $ V.toList $ V.map valuesToList v\n\nmain = do\n    csv &lt;- loadMyData\n    let output = processMyData csv\n    print output\n</code></pre>\n\n<p>This way you separate the pure, \"let\" part from the impure loading part. This isn't Code Review (if you asked there, I could probably elaborate more), but I'd type the processing as <code>String -&gt; Either String [Int, Int]</code> or something and keep the failure information in the type system.</p>\n\n<pre><code>processMyData csvData = \n  case decodeByName csvData of\n        Left err -&gt; Left err \n        Right (_, v) -&gt; Right $ V.toList $ V.map valuesToList v\n</code></pre>\n\n<p>And that in turn could simply be (pardon me if I make a mistake somewhere, I'm <em>doing it live</em>):</p>\n\n<pre><code>processMyData = fmap (V.toList . V.map valuesToList) . decodeByName\n</code></pre>\n\n<p>That should work because of <a href=\"https://stackoverflow.com/questions/5195254/understanding-how-either-is-an-instance-of-functor\">how the <code>Functor</code> instance for <code>Either</code></a> is constructed.</p>\n\n<hr>\n\n<p>Oh, and also use <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Control-Applicative.html\" rel=\"nofollow noreferrer\"><code>Control.Applicative</code></a> for bonus style points:</p>\n\n<pre><code>main = do\n    output &lt;- processMyData &lt;$&gt; loadMyData\n    print output\n</code></pre>\n\n<p>(in case you don't understand that example, <code>(&lt;$&gt;)</code> is infix <code>fmap</code>, but that's not stricly necessary; hence <em>bonus</em>)</p>\n"}], "owner": {"reputation": 919, "user_id": 1819186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/71b04413070a897f1c5c7055ae281f02?s=128&d=identicon&r=PG", "display_name": "Anthony W", "link": "https://stackoverflow.com/users/1819186/anthony-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 740, "favorite_count": 0, "accepted_answer_id": 28286574, "answer_count": 1, "score": 1, "last_activity_date": 1422910915, "creation_date": 1422909861, "question_id": 28286393, "link": "https://stackoverflow.com/questions/28286393/creating-a-list-when-parsing-a-file-using-cassava-in-haskell", "title": "Creating a list when parsing a file using Cassava in Haskell", "body": "<p>I'm able to parse my csv file using the following code from Data.Csv:</p>\n\n<pre><code>valuesToList :: Foo -&gt; (Int, Int)\nvaluesToList (Foo a b) = (a,b)\n\nloadMyData :: IO ()\nloadMyData = do\n  csvData &lt;- BL.readFile \"mydata.csv\"\n  case decodeByName csvData of\n        Left err -&gt; putStrLn err \n        Right (_, v) -&gt; print $ V.toList $ V.map valuesToList v\n</code></pre>\n\n<p>When I run this I get the correct output on the screen. The problem I have is I'm not clear how to create a pure function so I can consume the contents of the list, as in:</p>\n\n<pre><code>let l = loadMyData\n</code></pre>\n\n<p>Where l is of type <code>[Int,Int]</code> I'm guessing it's because I'm in the IO Monad and I'm doing something hopelessly silly...</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 407, "user_id": 4461782, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8acec654041feaf9adda1db7b11f1d72?s=128&d=identicon&r=PG&f=1", "display_name": "laker001", "link": "https://stackoverflow.com/users/4461782/laker001"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422905590, "post_id": 28285274, "comment_id": 44924609, "body": "@bheklilr yeah sorry!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1422906383, "post_id": 28285274, "comment_id": 44925035, "body": "What did you try? Can you share some attempt so that we can prod you in the right direction? Disclosing the solution is hardly useful..."}], "answers": [{"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 1, "last_activity_date": 1422905808, "creation_date": 1422905808, "answer_id": 28285390, "question_id": 28285274, "link": "https://stackoverflow.com/questions/28285274/replacing-foldr-with-foldl/28285390#28285390", "title": "Replacing foldr with foldl", "body": "<p>Just change the lambda's signature, since it should first take the accumulator and then the list element:</p>\n\n<pre><code>idOdd2 xs = foldl  (\\acc x -&gt; if odd x then x+acc else acc) 0 xs\n</code></pre>\n\n<p>Allways use <code>:t &lt;function&gt;</code> if you are unsure how to use <code>function</code></p>\n"}, {"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 4, "last_activity_date": 1422905823, "creation_date": 1422905823, "answer_id": 28285397, "question_id": 28285274, "link": "https://stackoverflow.com/questions/28285274/replacing-foldr-with-foldl/28285397#28285397", "title": "Replacing foldr with foldl", "body": "<p>In your case it's very easy, you can just swap the order of the arguments to get it to work correctly:</p>\n\n<pre><code>idOdd2 = foldl (\\acc x -&gt; if odd x then x + acc else acc) 0\n</code></pre>\n\n<p>This is primarily because your accumulator type is the same as your list element type, and because <code>+</code> is commutative and associative.  This is important due to how <code>foldl</code> and <code>foldr</code> reduce a list:</p>\n\n<pre><code>isOdd [1, 2, 3, 4, 5] = 1 + (3 + (5 + 0)) = 9\n\nisOdd2 [1, 2, 3, 4, 5] = ((0 + 1) + 3) + 5 = 9\n</code></pre>\n\n<p>In this case <code>1 + (3 + (5 + 0)) == ((0 + 1) + 3) + 5</code>, but this isn't true of all operators, such as <code>:</code> or <code>++</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 0, "last_activity_date": 1422907331, "creation_date": 1422907331, "answer_id": 28285769, "question_id": 28285274, "link": "https://stackoverflow.com/questions/28285274/replacing-foldr-with-foldl/28285769#28285769", "title": "Replacing foldr with foldl", "body": "<p>In general, you can implement foldr using foldl and vice versa.  For example:</p>\n\n<pre><code>foldr' f e xs = foldl (flip f) e (reverse xs)\n</code></pre>\n"}], "owner": {"reputation": 407, "user_id": 4461782, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8acec654041feaf9adda1db7b11f1d72?s=128&d=identicon&r=PG&f=1", "display_name": "laker001", "link": "https://stackoverflow.com/users/4461782/laker001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1483605909, "creation_date": 1422905432, "last_edit_date": 1483605909, "question_id": 28285274, "link": "https://stackoverflow.com/questions/28285274/replacing-foldr-with-foldl", "title": "Replacing foldr with foldl", "body": "<p>I have this function to sum the odd numbers on a list:</p>\n\n<pre><code>idOdd xs = foldr (\\x acc -&gt; if odd x then x+acc else acc) 0 xs\n</code></pre>\n\n<p>if i want to do it with foldl, how would it change?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1422903810, "post_id": 28284836, "comment_id": 44923639, "body": "Just use <code>[[1, 2, 3], [4, 5, 6]]</code>?  If <code>x = [1, 2, 3]</code> and <code>y = [4, 5, 6]</code>, then <code>[x, y]</code> is what you&#39;re looking for.  Keep in mind that the <code>[a, b, c]</code> syntax is just sugar for <code>a:b:c:[]</code>, so you could also write this as <code>[1, 2, 3] : [4, 5, 6] : []</code>."}, {"owner": {"reputation": 391, "user_id": 1475521, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b18ff2f3ed0705c16a276eb4f3c72d18?s=128&d=identicon&r=PG", "display_name": "Stumbleine75", "link": "https://stackoverflow.com/users/1475521/stumbleine75"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422904080, "post_id": 28284836, "comment_id": 44923774, "body": "To clarify I&#39;m looking for a function do this to an arbitrary number of lists and in the context of recursion."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1422904217, "post_id": 28284836, "comment_id": 44923848, "body": "Haskell&#39;s type system doesn&#39;t allow vararg functions (aside from some deep magic that allows the Text.Printf function to work), so what you&#39;re looking for can&#39;t exist and would be poor practice anyway."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1422904595, "post_id": 28284836, "comment_id": 44924046, "body": "Are you able to picture to yourself how would you like to use this functionality? If yes, show us."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 2, "creation_date": 1422904707, "post_id": 28284836, "comment_id": 44924095, "body": "According to your comment  you want to take a list of list and yield it a list of lists. So basically it sounds like you&#39;re looking for <code>id</code> specialized to <code>[[a]] -&gt; [[a]]</code>. Unless I misunderstood, you might want to re-identify the problem you&#39;re wanting to solve."}, {"owner": {"reputation": 391, "user_id": 1475521, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b18ff2f3ed0705c16a276eb4f3c72d18?s=128&d=identicon&r=PG", "display_name": "Stumbleine75", "link": "https://stackoverflow.com/users/1475521/stumbleine75"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1422904916, "post_id": 28284836, "comment_id": 44924224, "body": "@Silvio Mayolo Sorry I misspoke - I don&#39;t need a function to do this to an arbitrary number of lists, I just want to use it multiple times to create a list of an arbitrary number of lists. To make things absolutely clear, I&#39;m thinking of a function f taking in some [a], [b] and outputting [[a], [b]]."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 1, "creation_date": 1422904954, "post_id": 28284836, "comment_id": 44924249, "body": "@MasterMastic I just did an recursive implementation and found out that it was actually behaving like <code>id</code> after reading your comment. :)"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422905052, "post_id": 28284836, "comment_id": 44924305, "body": "@ThroatOfWinter57 Then you can do <code>[a]:[b]:[]</code> just like how @bheklilr said. Example: <code>[1,2,3]:[4,5,6]:[]</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1422905394, "post_id": 28284836, "comment_id": 44924507, "body": "Just to wrap it together: <code>conc a b = a:b:[]</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1422906174, "post_id": 28284836, "comment_id": 44924904, "body": "If you use <code>f x y = [x,y]</code> you have <code>f [a] [b] = [[a],[b]]</code>, but then you can not add a new list using <code>f</code>. E.g. <code>f [a] (f [b] [c])</code> will not work if <code>a,b,c</code> share their types. You have to do <code>[a] : f [b] [c]</code>, but then why not using <code>[a]:[b]:[c]:[]</code> or, on a recursive call <code>[a] : myRecCall (n-2)</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 6, "last_activity_date": 1422909983, "last_edit_date": 1422909983, "creation_date": 1422909045, "answer_id": 28286191, "question_id": 28284836, "link": "https://stackoverflow.com/questions/28284836/appending-lists-into-a-list-of-lists-in-haskell/28286191#28286191", "title": "Appending lists into a list of lists in Haskell?", "body": "<p>As mentioned in comments, a function to take two lists and combine them into a new list can be defined as:</p>\n\n<pre><code>combine :: [a] -&gt; [a] -&gt; [[a]]\ncombine xs ys = [xs,ys]\n</code></pre>\n\n<p>This function can't be applied multiple times to create a list of an arbitrary number of lists. Such a function would take a single list and a list of lists and it would add the single list to the list of lists, so it would have type:</p>\n\n<pre><code>push :: [a] -&gt; [[a]] -&gt; [[a]]\n</code></pre>\n\n<p>This is just <code>(:)</code>, though:</p>\n\n<pre><code>push = (:)\n</code></pre>\n\n<p>As also mentioned in the comments, the value <code>[x,y]</code> can also be written as <code>x : y : []</code>.<sup>1</sup> Since both cases can be done with <code>(:)</code>, I would guess that what you really want to use is <code>(:)</code>, sometimes consing onto <code>[]</code> and sometimes onto a non-empty list.</p>\n\n<hr>\n\n<p><sup>1</sup> In fact, <code>[x,y]</code> is just <a href=\"http://en.wikipedia.org/wiki/Syntactic_sugar\" rel=\"noreferrer\">syntactic sugar</a> for <code>x:y:[]</code>.</p>\n"}], "owner": {"reputation": 391, "user_id": 1475521, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b18ff2f3ed0705c16a276eb4f3c72d18?s=128&d=identicon&r=PG", "display_name": "Stumbleine75", "link": "https://stackoverflow.com/users/1475521/stumbleine75"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8515, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1422909983, "creation_date": 1422903705, "question_id": 28284836, "link": "https://stackoverflow.com/questions/28284836/appending-lists-into-a-list-of-lists-in-haskell", "title": "Appending lists into a list of lists in Haskell?", "body": "<p>All I've been able to find in the documentation that are relevant are ++ and concat. </p>\n\n<p>I thought at first doing the following would give me what I wanted: </p>\n\n<pre><code>  [1, 3, 4] ++ [4, 5, 6]\n</code></pre>\n\n<p>but as you know that just gives [1, 2, 3, 4, 5, 6].</p>\n\n<p>What would I need to do to take in [1, 2, 3] and [4, 5, 6] and get out [[1, 2, 3], [4, 5, 6]]?</p>\n"}, {"tags": ["haskell", "overriding", "default", "ghc", "nixos"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1422905186, "post_id": 28284270, "comment_id": 44924388, "body": "If you want to know from where <code>7.6.3</code> comes, you can use <code>which</code> command to find out it&#39;s path."}, {"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1423001011, "post_id": 28284270, "comment_id": 44970253, "body": "I&#39;m familiar with <code>which</code>, I meant that it is not listed in my configuration, but actually present in system (:"}], "answers": [{"comments": [{"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "edited": false, "score": 0, "creation_date": 1423001090, "post_id": 28295026, "comment_id": 44970277, "body": "Unfortunatelly, my NixOS vm crashed (because of host partition issue), I&#39;ll be able create new one in few days and recheck. Fortunatelly, I have my configs recovered."}, {"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "edited": false, "score": 0, "creation_date": 1423241092, "post_id": 28295026, "comment_id": 45081890, "body": "Hmmm. With minimal clean installation I can&#39;t reproduse this issue anymore."}], "tags": [], "owner": {"reputation": 1880, "user_id": 471622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1384132ace283798b6e1294f31ac62?s=128&d=identicon&r=PG", "display_name": "lethalman", "link": "https://stackoverflow.com/users/471622/lethalman"}, "is_accepted": false, "score": 0, "last_activity_date": 1422954423, "creation_date": 1422954423, "answer_id": 28295026, "question_id": 28284270, "link": "https://stackoverflow.com/questions/28284270/nixos-use-ghc-ver-7-8-3-system-wide/28295026#28295026", "title": "NixOS: use GHC ver 7.8.3 system wide", "body": "<p>Maybe you installed it in your user nix env? Try <code>nix-env -q</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 430, "user_id": 798647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195d94fe90489d9ba0737f8cb70b9461?s=128&d=identicon&r=PG", "display_name": "CoreyOConnor", "link": "https://stackoverflow.com/users/798647/coreyoconnor"}, "is_accepted": false, "score": 1, "last_activity_date": 1423359894, "creation_date": 1423359894, "answer_id": 28389658, "question_id": 28284270, "link": "https://stackoverflow.com/questions/28284270/nixos-use-ghc-ver-7-8-3-system-wide/28389658#28389658", "title": "NixOS: use GHC ver 7.8.3 system wide", "body": "<p>To use a specific GHC version system wide I use a module <a href=\"https://github.com/coreyoconnor/nix_configs/blob/master/haskell-dev.nix\" rel=\"nofollow\">like this one:</a></p>\n\n<p>Use <code>nixpkgs.config.packageOverrides</code> to rename <code>haskellPackages</code> to the desired version and add a haskell environment:</p>\n\n<pre><code>nixpkgs.config.cabal.libraryProfiling = true;\nnixpkgs.config.packageOverrides = in_pkgs : rec\n  { \n    haskellPackages = in_pkgs.haskellPackages_ghc784_profiling;\n    hsEnv = in_pkgs.haskellPackages_ghc784_profiling.ghcWithPackages hsPkgs;\n  }\n</code></pre>\n\n<p>Define <code>hsPkgs</code> to be a package list constructor:</p>\n\n<p>Add the <code>hsEnv</code> to the <code>environment.systemPackages</code>:</p>\n\n<pre><code>environment.systemPackages = [ hsEnv ];\n</code></pre>\n"}], "owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1423359894, "creation_date": 1422901579, "last_edit_date": 1423240218, "question_id": 28284270, "link": "https://stackoverflow.com/questions/28284270/nixos-use-ghc-ver-7-8-3-system-wide", "title": "NixOS: use GHC ver 7.8.3 system wide", "body": "<p>I want to have GHC 7.8.3 to be default system wide Haskell compiler, and I do not want to install entire platform; here is piece of my <code>configurarion.nix</code> file:</p>\n\n<pre class=\"lang-nix prettyprint-override\"><code>{\n    environment.systemPackages = with pkgs; [ \n        haskellPackages_ghc783_profiling.alex\n        haskellPackages_ghc783_profiling.happy \n        # ghc.ghc783 -- not sure about this one\n        haskellPackages_ghc783_profiling.ghc\n        haskellPackages_ghc783_profiling.cabalInstall\n    ];\n}\n</code></pre>\n\n<p>However, ver 7.6.3 show by default and I can't imagine where it comes from...</p>\n\n<pre><code>$ ghc --verion\n$ The Glorious Glasgow Haskell Compilation System, version 7.6.3\n</code></pre>\n\n<p>I've found some tips on <a href=\"https://nixos.org/wiki/Haskell\" rel=\"nofollow\">Wiki pages</a>:</p>\n\n<pre class=\"lang-nix prettyprint-override\"><code>pkgs : {\n   packageOverrides = self : rec {\n     hsEnv = self.haskellPackages.ghcWithPackages (self : [\n         self.haskellPlatform\n         # add more packages here\n         #\n         #   I tried to replace `self.haskellPlatform`\n         #   with `self:ghc783`, \n         #   with `self:haskellPackages.ghc_783_profiling.ghc`, and\n         #   with `self:ghc`, but all that produces errors.\n     ]);\n   };\n }\n</code></pre>\n\n<p>So, what is the right way to make version 7.8.3 to be default?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1422910987, "post_id": 28284218, "comment_id": 44927335, "body": "By chance, I just wrote <a href=\"http://stackoverflow.com/a/28101516/791604\">an answer to another question</a> that does just that."}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 2, "last_activity_date": 1422907984, "last_edit_date": 1422907984, "creation_date": 1422902170, "answer_id": 28284436, "question_id": 28284218, "link": "https://stackoverflow.com/questions/28284218/compute-next-element-of-list-based-on-previous-elements/28284436#28284436", "title": "Compute next element of list based on previous elements", "body": "<p>You can use <code>unfoldr</code>:</p>\n\n<pre><code>import Data.List\n\ngen :: ([a] -&gt; a) -&gt; a -&gt; [a]\ngen f init = unfoldr (\\l -&gt; let n = f (reverse l) in (Just (n, n:l))) [init]\n</code></pre>\n\n<p>note this has to reverse the input list each time. You could use <code>Data.Sequence</code> instead:</p>\n\n<pre><code>import Data.Sequence\n\ngenSeq :: (Seq a -&gt; a) -&gt; a -&gt; Seq a\ngenSeq f init = unfoldr (\\s -&gt; let n = f s in (Just (n, s |&gt; n))) (singleton init)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1422979640, "post_id": 28284801, "comment_id": 44958193, "body": "Note that in versions of GHC before 7.8.4, <code>inits</code> is incredibly slow, so your version would  be better. In 7.8.4 and above, <code>inits</code> works well."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 4, "last_activity_date": 1422904386, "last_edit_date": 1422904386, "creation_date": 1422903572, "answer_id": 28284801, "question_id": 28284218, "link": "https://stackoverflow.com/questions/28284218/compute-next-element-of-list-based-on-previous-elements/28284801#28284801", "title": "Compute next element of list based on previous elements", "body": "<p>As an alternative to the other answer, hopefully a little more readable but less laconic:</p>\n\n<pre><code>-- \"heads f\" will generate all of the the prefixes of the inflist\nheads f = map ( (flip take) (inflist f) ) [1..]\n-- inflist will generate the infinite list\ninflist f = ( f [] ) : map f (heads f)\n\n-- test function\nsum1 s = 1 + sum s\n\n-- test run\n&gt;&gt; take 5 (inflist sum1)\n[1,2,4,8,16]\n</code></pre>\n\n<p>Upd:\n As pointed above the <code>heads</code> function can be replaced with <code>inits</code>, which I wasn't aware of it's existence.</p>\n"}, {"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1422922334, "post_id": 28284959, "comment_id": 44932164, "body": "You don&#39;t actually need <code>f [] :</code> or <code>tail $</code>, because <code>inits xs</code> gives a first element <code>[]</code> without looking at <code>xs</code>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1422942406, "post_id": 28284959, "comment_id": 44937449, "body": "@&#216;rjan Johansen, ah, yes. Thanks."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 10, "last_activity_date": 1422942923, "last_edit_date": 1422942923, "creation_date": 1422904228, "answer_id": 28284959, "question_id": 28284218, "link": "https://stackoverflow.com/questions/28284218/compute-next-element-of-list-based-on-previous-elements/28284959#28284959", "title": "Compute next element of list based on previous elements", "body": "<pre><code>gen f = xs where xs = map f $ inits xs\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>gen f = fix $ map f . inits\n</code></pre>\n"}], "owner": {"reputation": 5734, "user_id": 394796, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aad9f3d17d0679d81841dc6d83a03ea3?s=128&d=identicon&r=PG", "display_name": "Cameron Martin", "link": "https://stackoverflow.com/users/394796/cameron-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 1, "accepted_answer_id": 28284959, "answer_count": 3, "score": 5, "last_activity_date": 1422942923, "creation_date": 1422901382, "question_id": 28284218, "link": "https://stackoverflow.com/questions/28284218/compute-next-element-of-list-based-on-previous-elements", "title": "Compute next element of list based on previous elements", "body": "<p>I want to define an infinite list where each element is a function of all the previous elements.</p>\n\n<p>So, the <code>n+1</code>th element of the list would be <code>f [x1, x2, ..., xn]</code>.</p>\n\n<p>This seems simple, but I cannot seem to get my head around how to do it. Can anyone help?</p>\n"}, {"tags": ["haskell", "types", "data-kinds"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1422901603, "post_id": 28284039, "comment_id": 44922484, "body": "Without dependent types, it seems unlikely. You could have at most <code>moneyOf :: Proxy c -&gt; Money c</code>, to be called as <code>moneyOf (Proxy :: Proxy USD)</code>, as far as I know."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1422904091, "post_id": 28284039, "comment_id": 44923779, "body": "The usual approach (without dependant types) is to create a singleton for <code>Currency</code>: <code>data SCurrency (c :: Currency) where SUSD :: SCurrency USD; SEUR :: SCurrency EUR; SYEN :: SCurrency Yen</code> and write the function <code>SCurrency c -&gt; Money c</code>. In this case, since you don&#39;t need to know anything about the type of currency (since it is a phantom type) you can get away with just using Proxy."}, {"owner": {"reputation": 669, "user_id": 3714434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a65866e8ef0ee97ab4cd4c4ffaadc6?s=128&d=identicon&r=PG&f=1", "display_name": "ibotty", "link": "https://stackoverflow.com/users/3714434/ibotty"}, "edited": false, "score": 0, "creation_date": 1422907752, "post_id": 28284039, "comment_id": 44925730, "body": "I assume you want <code>moneyOf</code> to be <code>Currency -&gt; Int -&gt; Money c</code> right?"}], "answers": [{"comments": [{"owner": {"reputation": 669, "user_id": 3714434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a65866e8ef0ee97ab4cd4c4ffaadc6?s=128&d=identicon&r=PG&f=1", "display_name": "ibotty", "link": "https://stackoverflow.com/users/3714434/ibotty"}, "edited": false, "score": 1, "creation_date": 1422958054, "post_id": 28284998, "comment_id": 44944731, "body": "Re Option 1, you can use <code>Proxy#</code> from <code>GHC.Prim</code> to get absolutely no runtime cost of passing the type information."}], "tags": [], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "is_accepted": true, "score": 9, "last_activity_date": 1422904389, "last_edit_date": 1495539812, "creation_date": 1422904389, "answer_id": 28284998, "question_id": 28284039, "link": "https://stackoverflow.com/questions/28284039/can-i-write-a-function-using-datakinds-that-returns-a-value-of-type-encoded-by-t/28284998#28284998", "title": "Can I write a function using DataKinds that returns a value of type encoded by the parameter?", "body": "<p>No, but there are workarounds.  As you saw, the type you'd need to write is something like <code>moneyOf :: (c :: Currency) -&gt; Int -&gt; Money c</code>, where <code>c</code> is bound both in the type <em>and</em> in the function implementation itself (<code>moneyOf _ amt = Money amt</code>).  This isn't something we can do in Haskell.  So what can we do instead?  There are two options, depending on how much you really want.</p>\n\n<p><strong>Option 1: Proxies.</strong>  Define a poly-kinded type</p>\n\n<pre><code>data Proxy (t :: k) = Proxy\n</code></pre>\n\n<p>The idea behind this type is that you can use <code>Proxy :: Proxy t</code> as a way of passing around a reified term-level representation of the type t.  So, for instance, we can define:</p>\n\n<pre><code>moneyOf :: Proxy c -&gt; Int -&gt; Money c\nmoneyOf _ = Money\n</code></pre>\n\n<p>Then, we can call it like <code>moneyOf (Proxy :: Proxy USD) 10</code> to get <code>Money 10 :: Money USD</code>.  A trick you can use is to instead give the function the type <code>proxy k -&gt; Int -&gt; Money c</code> instead (note the lowercase <code>proxy</code>!), so that <code>proxy</code> will unify with arbitrary function types.\u00b9  This is great for passing arguments to functions in order to fix their return types, but it doesn't really let you do anything beyond that.</p>\n\n<p><strong>As you've described your problem, I think proxies are probably the best fit for solving it.</strong>  (Assuming that plain type signatures, like <code>Money 10 :: Money USD</code>, don't work, that is \u2013 those are even simpler when you can use them!)</p>\n\n<p><strong>Option 2: Singleton types.</strong>  However, if you find that you need more generality (or if you're just curious), then another approach is to create a <em>singleton type</em> like the following:</p>\n\n<pre><code>data SingCurrency (c :: Currency) where\n  SUSD :: SingCurrency USD\n  SEUR :: SingCurrency EUR\n  SYEN :: SingCurrency YEN\n</code></pre>\n\n<p>This is called a \"singleton type\" because each <code>SingCurrency c</code> has only one member (<em>e.g.</em>, <code>SUSD</code> is the unique value of type <code>SingCurrency USD</code>).  Now, you can write</p>\n\n<pre><code>moneyOf :: SingCurrency c -&gt; Int -&gt; Money c\nmoneyOf _ = Money\n</code></pre>\n\n<p>Here, <code>moneyOf SUSD 10</code> evaluates to <code>Money 10 :: Money USD</code>.  But this alone doesn't buy you anything beyond using (except a bit less typing).  Singletons get particularly fun when you want to produce them:</p>\n\n<pre><code>class SingCurrencyI (c :: Currency) where\n  sing :: SingCurrency c\n\ninstance SingCurrencyI USD where scur = SUSD\ninstance SingCurrencyI EUR where scur = SEUR\ninstance SingCurrencyI YEN where scur = SYEN\n</code></pre>\n\n<p>Now, if you have a <code>SingCurrencyI c</code> constraint, you can automatically <em>produce</em> the corresponding <code>SingCurrency c</code> value with <code>sing</code>, thus allowing you to move from the type level to the term level.  (Note that, although all <code>Currency</code>s are instances of <code>SingCurrencyI</code>, you need to specify the constraint explicitly if you want it.\u00b2)  I can't think of any good examples of using this off the top of my head; I think my suggestion would be to <strong>use singletons only if you find yourself in a situation where you realize you can't accomplish what you need, and realize that the extra type-value synchronization of singletons would help you</strong> (and where you can't redesign yourself out of the situation).</p>\n\n<p>If you do find yourself using singletons, the machinery is all set up for you <a href=\"http://www.cis.upenn.edu/~eir/packages/singletons/README.html\" rel=\"nofollow noreferrer\">in the <code>singletons</code> package</a>, in more generality: there's <a href=\"http://hackage.haskell.org/package/singletons-1.1/docs/Data-Singletons.html#t:sing\" rel=\"nofollow noreferrer\">a data family <code>Sing :: k -&gt; *</code></a> that takes the place of <code>SingCurrency</code>; and there's have <a href=\"http://hackage.haskell.org/package/singletons-1.1/docs/Data-Singletons.html#t:SingI\" rel=\"nofollow noreferrer\">a type class <code>SingI :: k -&gt; Constraint</code></a> that takes the place of <code>SingCurrencyI</code>, which has the single member <a href=\"http://hackage.haskell.org/package/singletons-1.1/docs/Data-Singletons.html#v:sing\" rel=\"nofollow noreferrer\"><code>sing :: SingI a =&gt; Sing a</code></a>.  There's also <a href=\"http://hackage.haskell.org/package/singletons-1.1/docs/Data-Singletons.html#v:withSingI\" rel=\"nofollow noreferrer\">a function <code>withSingI :: Sing n -&gt; (SingI n =&gt; r) -&gt; r</code></a> which allows you to convert freely from <code>Sing n</code> into <code>SingI n</code> (the other direction is just <code>sing</code>).  (These are all provided in <a href=\"http://hackage.haskell.org/package/singletons-1.1/docs/Data-Singletons.html\" rel=\"nofollow noreferrer\"><code>Data.Singletons</code></a>.)  There's also some Template Haskell in <a href=\"http://hackage.haskell.org/package/singletons-1.1/docs/Data-Singletons-TH.html\" rel=\"nofollow noreferrer\"><code>Data.Singletons.TH</code></a> that allows you to write</p>\n\n<pre><code>singletons [d|data Currency = USD | EUR | YEN|]\n</code></pre>\n\n<p>at the top level of your program in order to define the <code>Currency</code> type along with the appropriate <code>Sing</code> and <code>SingI</code> instances.  (You need the following language extensions enabled, too: <code>KindSignatures</code>, <code>DataKinds</code>, <code>TypeFamilies</code>, <code>GADTs</code> or <code>ExistentialQuantification</code>, <code>ScopedTypeVariables</code>, and <code>TemplateHaskell</code>.)</p>\n\n<p>This is really powerful \u2013 it's almost like dependent types, if you squint \u2013 but it can be a massive pain to use.  Indeed, if you want more information, there's a paper talking about exactly that: <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/pub/hasochism.pdf\" rel=\"nofollow noreferrer\">\"Hasochism: The Pleasure and Pain of Dependently Typed Haskell Programming\"</a>, by Sam Lindley and <a href=\"https://stackoverflow.com/users/828361/pigworker\">Conor McBride</a>.  It's definitely readable by anybody who's thinking about these ideas already, although the material is sort of intrinsically tricky; be warned that their notation is slightly different, though.  I don't, unfortunately, know of any good blogpost or tutorial-style introductions to this stuff.</p>\n\n<hr>\n\n<p>\u00b9 I'm uncertain about the status of that type unification rule with type families, though\u2026.</p>\n\n<p>\u00b2 Otherwise, the run-time dictionary containing <code>sing</code> won't be passed in, so the value wouldn't be available at run-time.</p>\n"}, {"comments": [{"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1422940113, "post_id": 28286213, "comment_id": 44936752, "body": "Existentials and the type class are a bit orthogonal, but you&#39;re right \u2013 existentials can come in handy with this sort of thing."}, {"owner": {"reputation": 669, "user_id": 3714434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a65866e8ef0ee97ab4cd4c4ffaadc6?s=128&d=identicon&r=PG&f=1", "display_name": "ibotty", "link": "https://stackoverflow.com/users/3714434/ibotty"}, "reply_to_user": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 1, "creation_date": 1422958521, "post_id": 28286213, "comment_id": 44945021, "body": "I prefer existentials <i>iff</i> I get the <code>Currency</code> from runtime, i.e. a config file."}], "tags": [], "owner": {"reputation": 669, "user_id": 3714434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a65866e8ef0ee97ab4cd4c4ffaadc6?s=128&d=identicon&r=PG&f=1", "display_name": "ibotty", "link": "https://stackoverflow.com/users/3714434/ibotty"}, "is_accepted": false, "score": 1, "last_activity_date": 1422909142, "creation_date": 1422909142, "answer_id": 28286213, "question_id": 28284039, "link": "https://stackoverflow.com/questions/28284039/can-i-write-a-function-using-datakinds-that-returns-a-value-of-type-encoded-by-t/28286213#28286213", "title": "Can I write a function using DataKinds that returns a value of type encoded by the parameter?", "body": "<p>An alternative to option 2 of Antal S-Z's answer is the following.</p>\n\n<p>You keep the <code>Currency</code> singletons <code>SingCurrency</code>.</p>\n\n<pre><code>data SingCurrency (c :: Currency) where\n    SEUR :: SingCurrency EUR\n    SUSD :: SingCurrency USD\n    SYEN :: SingCurrency YEN\n</code></pre>\n\n<p>But instead of using a singleton instance class (<code>SingCurrencyI</code>) you can use an existential GADT.</p>\n\n<pre><code>data AnyCurrency where\n    AnyCurrency :: SingCurrency sc -&gt; AnyCurrency\n</code></pre>\n\n<p>with an auxiliary function that takes the place of the <code>SingCurrencyI</code> instances.</p>\n\n<pre><code>anyCurrency :: Currency -&gt; AnyCurrency\nanyCurrency EUR = AnyCurrency SEUR\nanyCurrency USD = AnyCurrency SUSD\nanyCurrency YEN = AnyCurrency SYEN\n</code></pre>\n\n<p>Using</p>\n\n<pre><code>money :: SingCurrency c -&gt; Int -&gt; Money c\nmoney = const Money\n</code></pre>\n\n<p>and an existential <code>Money</code></p>\n\n<pre><code>data AnyMoney where\n    AnyMoney :: Money c -&gt; AnyMoney\n</code></pre>\n\n<p>you can implement</p>\n\n<pre><code>moneyOf :: Currency -&gt; Int -&gt; AnyMoney\nmoneyOf c v = case anyCurrency c of\n                AnyCurrency sc -&gt; AnyMoney $ money sc v\n</code></pre>\n\n<p>Pattern matching on <code>AnyMoney</code> will let you use functions taking an argument of type <code>Money c</code>, i.e.</p>\n\n<pre><code>useMoney :: Money c -&gt; IO ()\nuseMoney = undefined\n</code></pre>\n\n<p>will finally get you</p>\n\n<pre><code>useUseMoney :: Currency -&gt; Int -&gt; IO ()\nuseUseMoney c v = case moneyOf c v of\n                    AnyMoney m -&gt; useMoney m\n</code></pre>\n"}], "owner": {"reputation": 2052, "user_id": 3949424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb2f4d411841f6c34bdee2d0769ef96e?s=128&d=identicon&r=PG&f=1", "display_name": "Ramith Jayatilleka", "link": "https://stackoverflow.com/users/3949424/ramith-jayatilleka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "accepted_answer_id": 28284998, "answer_count": 2, "score": 6, "last_activity_date": 1422909142, "creation_date": 1422900715, "question_id": 28284039, "link": "https://stackoverflow.com/questions/28284039/can-i-write-a-function-using-datakinds-that-returns-a-value-of-type-encoded-by-t", "title": "Can I write a function using DataKinds that returns a value of type encoded by the parameter?", "body": "<p>Let's say I have a Currency type:</p>\n\n<pre><code>data Currency = USD | EUR | YEN\n</code></pre>\n\n<p>and a Money type that stores an int, and is parameterized by a given Currency (Currency is promoted to a kind with the DataKinds extension).</p>\n\n<pre><code>data Money :: Currency -&gt; * where\n    Money :: Int -&gt; Money c\n</code></pre>\n\n<p>Is it possible to write a function, <code>moneyOf</code>, that takes as its parameter, a Currency value, and returns a Money value which is parameterized by the corresponding type of the Currency value? Such as <code>moneyOf :: Currency -&gt; Money c</code>, but we get a compile time guarantee that <code>c</code> is the type generated from the Currency value? </p>\n"}, {"tags": ["haskell", "hackage"], "comments": [{"owner": {"reputation": 4198, "user_id": 445762, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0dc3d3e6ede97a600e7b5e3d55f30eb4?s=128&d=identicon&r=PG", "display_name": "matcheek", "link": "https://stackoverflow.com/users/445762/matcheek"}, "edited": false, "score": 1, "creation_date": 1422891680, "post_id": 28281103, "comment_id": 44916665, "body": "If you don&#39;t find any other solution: rm -rf ~/.ghc ~/.cabal"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1422891800, "post_id": 28281103, "comment_id": 44916757, "body": "Welcome to <a href=\"https://www.google.com/search?q=cabal+hell\" rel=\"nofollow noreferrer\">cabal hell</a>."}, {"owner": {"reputation": 6881, "user_id": 477047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Qh2bO.gif?s=128&g=1", "display_name": "David Unric", "link": "https://stackoverflow.com/users/477047/david-unric"}, "edited": false, "score": 0, "creation_date": 1422892813, "post_id": 28281103, "comment_id": 44917462, "body": "Did you even tried add options cabal suggests ? For unlimited tries put <code>-1</code> to backjumps and see if it does help. Reorder goals is a recommended combination in such case. So install command would look like<code>cabal install --max-backjumps=-1 --reorder-goals &lt;pkg-name&gt;</code>"}, {"owner": {"reputation": 113, "user_id": 4513188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/609cd019a4304cc8d0bbb4b0fc6f4076?s=128&d=identicon&r=PG&f=1", "display_name": "haskell looks great", "link": "https://stackoverflow.com/users/4513188/haskell-looks-great"}, "edited": false, "score": 0, "creation_date": 1422894035, "post_id": 28281103, "comment_id": 44918315, "body": "Hi David, can you explain a bit more on &quot;--reorder-goals&quot;? I have minimal experience with cabal."}, {"owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 0, "creation_date": 1422894726, "post_id": 28281103, "comment_id": 44918785, "body": "you should use ssandboxes"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1422923196, "post_id": 28281103, "comment_id": 44932385, "body": "That library has been deprecated in favor of http-conduit and http-client. I&#39;d recommend trying those, which shouldn&#39;t have such issues."}], "answers": [{"tags": [], "owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "is_accepted": false, "score": 1, "last_activity_date": 1422903101, "creation_date": 1422903101, "answer_id": 28284685, "question_id": 28281103, "link": "https://stackoverflow.com/questions/28281103/cant-install-haskell-package-http-enumerator/28284685#28284685", "title": "Can&#39;t install haskell package http-enumerator", "body": "<p>In general, this sort of problem happens because you're trying to install package <code>A</code>, which depends (directly or indirectly) on package <code>B</code>. However, you already have package <code>C</code> installed, which also depends on package <code>B</code>, but the version of <code>B</code> that <code>C</code> was linked with won't work with <code>A</code>.</p>\n\n<p>In some cases you might be able to resolve this sort of problem using:</p>\n\n<pre><code>cabal install --max-backjumps=-1 --reorder-goals &lt;pkg-name&gt;\n</code></pre>\n\n<p>...but that only works sometimes. A cleaner way to address this sort of thing is to use <a href=\"https://www.haskell.org/cabal/users-guide/installing-packages.html#developing-with-sandboxes\" rel=\"nofollow\">sandboxes</a>. This will help if you don't need both <code>A</code> and <code>C</code> in the same sandbox, or you can re-link <code>C</code> with a different version of <code>B</code>. You can do what you want in the sandbox without messing up your main Haskell installation.</p>\n\n<p>If you've written <code>A</code> or <code>C</code> yourself, you may need to examine the dependencies of your packages and make adjustments. I'm going translate part of that output into English, to give you an example of how to diagnose dependency problems.</p>\n\n<pre><code>$ cabal install http-enumerator\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: http-enumerator-0.7.3.3 (user goal)\n</code></pre>\n\n<p>You requested <code>http-enumerator</code>. The latest version is 0.7.3.3, so I'll try to install that.</p>\n\n<pre><code>next goal: asn1-data (dependency of http-enumerator-0.7.3.3)\n</code></pre>\n\n<p>Now, <code>http-enumerator-0.7.3.3</code> requires the package <code>asn1-data</code>, so let me try to install that.</p>\n\n<pre><code>rejecting: asn1-data-0.7.1, 0.7.0 (conflict: http-enumerator =&gt;\nasn1-data&gt;=0.5.1 &amp;&amp; &lt;0.7)\n</code></pre>\n\n<p>The latest two versions of <code>asn1-data</code> are 0.7.1 and 0.7.0. But <code>http-enumerator-0.7.3.3</code> requires an earlier version of <code>asn1-data</code>. So let me try an older version of <code>asn1-data</code></p>\n\n<pre><code>trying: asn1-data-0.6.1.3\n</code></pre>\n\n<p>The next available version of <code>asn1-data</code> is 0.6.1.3.</p>\n\n<pre><code>next goal: text (dependency of asn1-data-0.6.1.3)\n</code></pre>\n\n<p>But that version of <code>asn1-data</code> requires <code>text</code>, so I need to install that first.</p>\n\n<pre><code>rejecting: text-1.2.0.0/installed-18f... (conflict: text =&gt;\nbytestring==0.10.4.0/installed-6da..., http-enumerator =&gt; bytestring&gt;=0.9.1.4\n&amp;&amp; &lt;0.10)\n</code></pre>\n\n<p>The latest version of <code>text</code> is 1.2.0.0, but that won't work because it needs a different version of <code>bytestring</code> than <code>http-enumerator</code> wants. So let me try an older version of <code>text</code>.</p>\n\n<pre><code>trying: text-1.2.0.4\nnext goal: certificate (dependency of http-enumerator-0.7.3.3)\n</code></pre>\n\n<p>Now, that version of <code>text</code> requires <code>certificate</code>, so I need to install that first.</p>\n\n<pre><code>rejecting: certificate-1.3.9, 1.3.8, 1.3.7, 1.3.6, 1.3.5, 1.3.3, 1.3.2, 1.3.1,\n1.3.0, 1.2.9, 1.2.8, 1.2.7, 1.2.6, 1.2.5, 1.2.4, 1.2.3, 1.2.2, 1.2.1, 1.2.0\n(conflict: http-enumerator =&gt; certificate&gt;=1.1 &amp;&amp; &lt;1.2)\n</code></pre>\n\n<p>But all these versions of <code>certificate</code> are incompatible with <code>http-enumerator</code>.</p>\n\n<pre><code>trying: certificate-1.1.1\n</code></pre>\n\n<p>Finally a bit of success. I can use <code>certificate-1.1.1</code>, and satisfy all of the dependencies of <code>asn1-data</code> <code>text</code>.</p>\n\n<pre><code>next goal: tls-extra (dependency of http-enumerator-0.7.3.3)\n</code></pre>\n\n<p>But <code>http-enumerator-0.7.3.3</code> also requires <code>tls-extra</code>.</p>\n\n<pre><code>rejecting: tls-extra-0.6.6, 0.6.5, 0.6.4, 0.6.3, 0.6.1, 0.6.0, 0.5.1, 0.5.0\n(conflict: http-enumerator =&gt; tls-extra&gt;=0.4.3 &amp;&amp; &lt;0.5)\n</code></pre>\n\n<p>We can't use the latest versions of <code>tls-extra</code> because they are incompatible with <code>http-enumerator</code>.</p>\n\n<pre><code>rejecting: tls-extra-0.4.7.1, 0.4.7, 0.4.6.1, 0.4.6, 0.4.5 (conflict:\ncertificate==1.1.1, tls-extra =&gt; certificate&gt;=1.2.0 &amp;&amp; &lt;1.3.0)\n</code></pre>\n\n<p>We can't use these versions of <code>tls-extra</code> because they are incompatible with <code>certificate</code>.</p>\n\n<pre><code>rejecting: tls-extra-0.4.4, 0.4.3 (conflict: text==1.2.0.4, tls-extra =&gt;\ntext&gt;=0.5 &amp;&amp; &lt;1.0)\n</code></pre>\n\n<p>We can't use these versions of <code>tls-extra</code> because they are incompatible with <code>text</code>.</p>\n\n<pre><code>rejecting: tls-extra-0.4.2.1, 0.4.2, 0.4.1, 0.4.0, 0.3.1, 0.3.0, 0.2.3, 0.2.2,\n0.2.1, 0.2.0, 0.1.9, 0.1.8, 0.1.7, 0.1.6, 0.1.5, 0.1.4, 0.1.3, 0.1.2, 0.1.1,\n0.1.0 (conflict: http-enumerator =&gt; tls-extra&gt;=0.4.3 &amp;&amp; &lt;0.5)\n</code></pre>\n\n<p>And older versions of <code>tls-extra</code> aren't compatible with <code>http-enumerator</code>.</p>\n\n<pre><code>Backjump limit reached (change with --max-backjumps).\n</code></pre>\n\n<p>I give up!</p>\n"}], "owner": {"reputation": 113, "user_id": 4513188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/609cd019a4304cc8d0bbb4b0fc6f4076?s=128&d=identicon&r=PG&f=1", "display_name": "haskell looks great", "link": "https://stackoverflow.com/users/4513188/haskell-looks-great"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422903101, "creation_date": 1422890950, "question_id": 28281103, "link": "https://stackoverflow.com/questions/28281103/cant-install-haskell-package-http-enumerator", "title": "Can&#39;t install haskell package http-enumerator", "body": "<p>Got the following bash transcript when run cabal install. </p>\n\n<p>It looks it complainted many packages required by http-enumerator is not available. I am not sure what \"Backjump\" mean in the last line of the printout.</p>\n\n<p>How do I resolve the package dependencies?</p>\n\n<pre><code>$ cabal install http-enumerator\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: http-enumerator-0.7.3.3 (user goal)\nnext goal: asn1-data (dependency of http-enumerator-0.7.3.3)\nrejecting: asn1-data-0.7.1, 0.7.0 (conflict: http-enumerator =&gt;\nasn1-data&gt;=0.5.1 &amp;&amp; &lt;0.7)\ntrying: asn1-data-0.6.1.3\nnext goal: text (dependency of asn1-data-0.6.1.3)\nrejecting: text-1.2.0.0/installed-18f... (conflict: text =&gt;\nbytestring==0.10.4.0/installed-6da..., http-enumerator =&gt; bytestring&gt;=0.9.1.4\n&amp;&amp; &lt;0.10)\ntrying: text-1.2.0.4\nnext goal: certificate (dependency of http-enumerator-0.7.3.3)\nrejecting: certificate-1.3.9, 1.3.8, 1.3.7, 1.3.6, 1.3.5, 1.3.3, 1.3.2, 1.3.1,\n1.3.0, 1.2.9, 1.2.8, 1.2.7, 1.2.6, 1.2.5, 1.2.4, 1.2.3, 1.2.2, 1.2.1, 1.2.0\n(conflict: http-enumerator =&gt; certificate&gt;=1.1 &amp;&amp; &lt;1.2)\ntrying: certificate-1.1.1\nnext goal: tls-extra (dependency of http-enumerator-0.7.3.3)\nrejecting: tls-extra-0.6.6, 0.6.5, 0.6.4, 0.6.3, 0.6.1, 0.6.0, 0.5.1, 0.5.0\n(conflict: http-enumerator =&gt; tls-extra&gt;=0.4.3 &amp;&amp; &lt;0.5)\nrejecting: tls-extra-0.4.7.1, 0.4.7, 0.4.6.1, 0.4.6, 0.4.5 (conflict:\ncertificate==1.1.1, tls-extra =&gt; certificate&gt;=1.2.0 &amp;&amp; &lt;1.3.0)\nrejecting: tls-extra-0.4.4, 0.4.3 (conflict: text==1.2.0.4, tls-extra =&gt;\ntext&gt;=0.5 &amp;&amp; &lt;1.0)\nrejecting: tls-extra-0.4.2.1, 0.4.2, 0.4.1, 0.4.0, 0.3.1, 0.3.0, 0.2.3, 0.2.2,\n0.2.1, 0.2.0, 0.1.9, 0.1.8, 0.1.7, 0.1.6, 0.1.5, 0.1.4, 0.1.3, 0.1.2, 0.1.1,\n0.1.0 (conflict: http-enumerator =&gt; tls-extra&gt;=0.4.3 &amp;&amp; &lt;0.5)\nBackjump limit reached (change with --max-backjumps).\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 3, "creation_date": 1422883275, "post_id": 28278378, "comment_id": 44911382, "body": "Can you show what exactly is <code>Version</code> and <code>Artifact</code> ?"}, {"owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 0, "creation_date": 1422883503, "post_id": 28278378, "comment_id": 44911499, "body": "Maybe, you should generalize <code>Version</code> and <code>Artifact</code> and make something like type family. Show code for those types."}, {"owner": {"reputation": 52258, "user_id": 375232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h3OwD.png?s=128&g=1", "display_name": "Landei", "link": "https://stackoverflow.com/users/375232/landei"}, "edited": false, "score": 1, "creation_date": 1422883571, "post_id": 28278378, "comment_id": 44911538, "body": "Also, what type is <code>List</code> exactly?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 10, "creation_date": 1422883957, "post_id": 28278378, "comment_id": 44911769, "body": "If the <code>searchList</code> method is identical for both types, why do you even need a class in the first place?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1422887268, "post_id": 28278378, "comment_id": 44913788, "body": "Both look as a <code>map</code> to me."}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "edited": false, "score": 2, "creation_date": 1422895262, "post_id": 28278378, "comment_id": 44919111, "body": "Specifically, <code>searchList xs thing = concatMap (searchElement thing) xs</code>"}], "answers": [{"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 0, "last_activity_date": 1422897570, "last_edit_date": 1422897570, "creation_date": 1422896252, "answer_id": 28282759, "question_id": 28278378, "link": "https://stackoverflow.com/questions/28278378/implement-two-or-more-instances-simultaneously-in-haskell/28282759#28282759", "title": "Implement two or more instances simultaneously in haskell", "body": "<p>You do not need a typeclass for this function. There is no way to do what you are asking in general, but if your functions have identical implementations then they can often be written without a typeclass anwyway.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1422899228, "last_edit_date": 1592644375, "creation_date": 1422899228, "answer_id": 28283629, "question_id": 28278378, "link": "https://stackoverflow.com/questions/28278378/implement-two-or-more-instances-simultaneously-in-haskell/28283629#28283629", "title": "Implement two or more instances simultaneously in haskell", "body": "<p>As Reid Henrichs said, there is no way to do this in general, and it's probably not necessary in this case. However, there are a couple things that can be very helpful.</p>\n<h3>Higher-kinded types</h3>\n<p>Don't get scared off by the crazy name. The <code>Maybe</code> type, for example, is &quot;higher-kinded&quot;, because you can't have a value of type <code>Maybe</code>\u2014it needs to have type <code>Maybe a</code> for some <code>a</code>. There are two ways to deal with type classes for higher-kinded types. One way is to actually make a higher-kinded class. Another is to make a polymorphic instance. So for example, you can have</p>\n<pre><code>class Foo f where\n  foom :: f a -&gt; Int\n\ninstance Foo [] where\n  foom lst = length lst\n</code></pre>\n<p>or you can have</p>\n<pre><code>class Bar t where\n  boom :: t -&gt; Int\n\ninstance Bar [a] where\n  boom lst = length lst\n</code></pre>\n<h3>Helper functions</h3>\n<p>Suppose you have a class, and want the instances for lists of <code>Int</code> and lists of <code>Bool</code> and lists of <code>[Bool]</code> to all act in about the same way, but other sorts of lists to do something else. You can write list functions implementing that common behavior, and then write three tiny little instance declarations that use the functions.</p>\n"}], "owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 28283629, "answer_count": 2, "score": 0, "last_activity_date": 1422899228, "creation_date": 1422882196, "last_edit_date": 1422883876, "question_id": 28278378, "link": "https://stackoverflow.com/questions/28278378/implement-two-or-more-instances-simultaneously-in-haskell", "title": "Implement two or more instances simultaneously in haskell", "body": "<p>I have defined following class in Haskell: </p>\n\n<pre><code>class SearchList searchEntity where\n    searchList :: [ArtifactTree] -&gt; searchEntity -&gt; [Artifact] \n</code></pre>\n\n<p>I have two equal implementations of this class for different entities:</p>\n\n<pre><code>instance SearchList Version where\n    searchList [] _ = []\n    searchList (artifactTree:[]) element = searchElement artifactTree element\n    searchList (x:xs) version = (searchElement x version) ++ (searchList xs version)\ninstance SearchList Artifact where\n    searchList [] _ = []\n    searchList (artifactTree:[]) element = searchElement artifactTree element\n    searchList (x:xs) artifact = (searchElement x artifact) ++ (searchList xs artifact)\n</code></pre>\n\n<p>Is there a way to combine two equal instances into one to avoid code duplication? For example, I am looking for something similar to</p>\n\n<pre><code>instance SearchList {Version, Artifact} where\n    searchList [] _ = []\n    searchList (artifactTree:[]) element = searchElement artifactTree element\n    searchList (x:xs) version = (searchElement x version) ++ (searchList xs version)\n</code></pre>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 1, "creation_date": 1422879155, "post_id": 28277402, "comment_id": 44909265, "body": "Did you look at <a href=\"https://hackage.haskell.org/package/KMP-0.1.0.2/docs/Data-Algorithms-KMP.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/KMP-0.1.0.2/docs/&hellip;</a> ? Also you can use list comprehension to do what you need."}, {"owner": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "reply_to_user": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 0, "creation_date": 1422879551, "post_id": 28277402, "comment_id": 44909503, "body": "@Sigrlami I did just now after you suggested. It seems to work on lists. I am trying to use Data.Text.Text. I don&#39;t think it will work on that unless I unpack the Text to String."}, {"owner": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "reply_to_user": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 0, "creation_date": 1422879667, "post_id": 28277402, "comment_id": 44909577, "body": "@Sigrlami also, are you suggesting the O(nm) approach using list comprehensions ? I am aware of that but it would be inefficient for large text."}, {"owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 0, "creation_date": 1422879781, "post_id": 28277402, "comment_id": 44909636, "body": "added answer with Data.Text"}], "answers": [{"comments": [{"owner": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "edited": false, "score": 0, "creation_date": 1422880183, "post_id": 28277610, "comment_id": 44909853, "body": "I want to find the indices of overlapping occurrences too. Also KMP implementation seems to be designed for Lists, not for Text. I will have to unpack text to use it."}, {"owner": {"reputation": 4198, "user_id": 445762, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0dc3d3e6ede97a600e7b5e3d55f30eb4?s=128&d=identicon&r=PG", "display_name": "matcheek", "link": "https://stackoverflow.com/users/445762/matcheek"}, "edited": false, "score": 0, "creation_date": 1422880344, "post_id": 28277610, "comment_id": 44909933, "body": "Have I misunderstood your comment?  type String = [Char], so Strings are lists too."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "edited": false, "score": 0, "creation_date": 1422880405, "post_id": 28277610, "comment_id": 44909962, "body": "@AviralGoel Uhm... the <code>breakOnAll</code> function seems to work on <code>Text</code>. For the index, you can use the length of the first pair component (<code>length</code> is O(1) on <code>Text</code>)."}, {"owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "reply_to_user": {"reputation": 4198, "user_id": 445762, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0dc3d3e6ede97a600e7b5e3d55f30eb4?s=128&d=identicon&r=PG", "display_name": "matcheek", "link": "https://stackoverflow.com/users/445762/matcheek"}, "edited": false, "score": 0, "creation_date": 1422880459, "post_id": 28277610, "comment_id": 44909991, "body": "@matcheek String is list of chars, it just <code>type String = [Char]</code> <a href=\"https://hackage.haskell.org/package/base-4.1.0.0/docs/Data-Char.html#t%3AString\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.1.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1422880646, "post_id": 28277610, "comment_id": 44910098, "body": "@chi It does not provide overlapping occurrences."}, {"owner": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "reply_to_user": {"reputation": 4198, "user_id": 445762, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0dc3d3e6ede97a600e7b5e3d55f30eb4?s=128&d=identicon&r=PG", "display_name": "matcheek", "link": "https://stackoverflow.com/users/445762/matcheek"}, "edited": false, "score": 0, "creation_date": 1422880738, "post_id": 28277610, "comment_id": 44910153, "body": "@matcheek  I am using <code>Data.Text.Text</code> not <code>String</code>. KMP is designed for <code>List</code> or <code>String</code> but not for <code>Text</code> type."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "edited": false, "score": 0, "creation_date": 1422882675, "post_id": 28277610, "comment_id": 44911077, "body": "@AviralGoel You&#39;re right (and length is NOT even O(1) on <code>Text</code> as I expected!) :-("}], "tags": [], "owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "is_accepted": false, "score": 1, "last_activity_date": 1422881699, "last_edit_date": 1422881699, "creation_date": 1422879449, "answer_id": 28277610, "question_id": 28277402, "link": "https://stackoverflow.com/questions/28277402/haskell-text-substring-occurrences/28277610#28277610", "title": "Haskell Text substring occurrences", "body": "<p>You can use <a href=\"http://hackage.haskell.org/package/text-1.2.0.4/docs/Data-Text.html#v:breakOnAll\" rel=\"nofollow\">breakOnAll</a> which have O(n+m) asymptotic performance.</p>\n\n<pre><code>module Main where\n\nimport Data.Text as T(map, length, pack, breakOnAll)\n\nmain = do\n  print $ subStrs \"Grey Hound dig down\" \"ou\"\n  print $ subStrInd \"Grey Hound dig down\" \"ou\"\n  print $ subStrs \"abababababaaabbaba\" \"ab\"\n  print $ subStrInd \"abababababaaabbaba\" \"ab\"\n\n-- Return list of non-overlapping occurrences of sub in str\nsubStrs str sub = breakOnAll (pack sub) (pack str)\n\n-- Return the indices of occurrences\nsubStrInd str sub =  Prelude.map (\\x -&gt; T.length $ fst x) $ subStrs str sub\n</code></pre>\n\n<p>In bad cases, this function's time complexity degrades towards O(n*m).</p>\n\n<p>Also, you have needed algorithms already implemented, look at <a href=\"https://hackage.haskell.org/package/KMP-0.1.0.2/docs/Data-Algorithms-KMP.html\" rel=\"nofollow\">https://hackage.haskell.org/package/KMP-0.1.0.2/docs/Data-Algorithms-KMP.html</a></p>\n"}], "owner": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1422881699, "creation_date": 1422878712, "question_id": 28277402, "link": "https://stackoverflow.com/questions/28277402/haskell-text-substring-occurrences", "title": "Haskell Text substring occurrences", "body": "<p>I want to find all occurrences(indices) of a substring in a given string.\nMy strings are of Data.Text.Text type. I was not able to find any function to do this directly. Is there a reason to not provide it? I am aware of the following options -</p>\n\n<ol>\n<li>I could use the brute force O(n^2) approach</li>\n<li>Regular Expressions</li>\n<li>Write my own Knuth Morris Pratt or Boyer-Moore\nalgorithm .</li>\n</ol>\n\n<p>The documentation for <a href=\"http://hackage.haskell.org/package/bytestring-0.10.4.1/docs/src/Data-ByteString.html#findSubstrings\" rel=\"nofollow\">Bytestring</a> shows that findSubstrings is deprecated. More than that, the implementation seems to be the naive pattern matching which gives O(n^2) asymptotic performance.</p>\n\n<p>This confuses me. Are we saying that Haskell doesn't have efficient string processing algorithms by default? </p>\n"}, {"tags": ["haskell", "yesod", "persistent", "esqueleto"], "answers": [{"comments": [{"owner": {"reputation": 667, "user_id": 4220095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRjm8.png?s=128&g=1", "display_name": "Agumander", "link": "https://stackoverflow.com/users/4220095/agumander"}, "edited": false, "score": 0, "creation_date": 1476982557, "post_id": 28775901, "comment_id": 67589400, "body": "What was the type ambiguity? I am having this same problem but don&#39;t know where to add extra restrictions"}, {"owner": {"reputation": 3385, "user_id": 841562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4cbb35380ef84f4f0f68061f578a4e73?s=128&d=identicon&r=PG", "display_name": "Lemming", "link": "https://stackoverflow.com/users/841562/lemming"}, "reply_to_user": {"reputation": 667, "user_id": 4220095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRjm8.png?s=128&g=1", "display_name": "Agumander", "link": "https://stackoverflow.com/users/4220095/agumander"}, "edited": false, "score": 2, "creation_date": 1477224766, "post_id": 28775901, "comment_id": 67670201, "body": "@Agumander I&#39;m afraid it&#39;s been a long time and I don&#39;t remember what exactly the issue was. However, looking at the code now, it seems that changing <code>count1</code> to <code>E.Value count1</code> in the pattern binding should help."}, {"owner": {"reputation": 667, "user_id": 4220095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRjm8.png?s=128&g=1", "display_name": "Agumander", "link": "https://stackoverflow.com/users/4220095/agumander"}, "edited": false, "score": 2, "creation_date": 1477604726, "post_id": 28775901, "comment_id": 67847788, "body": "This led to a breakthrough! In my case I had additionally specify [E.Value (count1 :: Int)] since it was later passed to show. Thank you!"}], "tags": [], "owner": {"reputation": 3385, "user_id": 841562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4cbb35380ef84f4f0f68061f578a4e73?s=128&d=identicon&r=PG", "display_name": "Lemming", "link": "https://stackoverflow.com/users/841562/lemming"}, "is_accepted": true, "score": 1, "last_activity_date": 1425078586, "creation_date": 1425078586, "answer_id": 28775901, "question_id": 28273922, "link": "https://stackoverflow.com/questions/28273922/counting-rows-with-esqueleto/28775901#28775901", "title": "Counting rows with esqueleto", "body": "<p>It turns out that the Esqueleto code above is correct. The error was in another part of the code where a lack of restrictions caused type-ambiguity.</p>\n"}], "owner": {"reputation": 3385, "user_id": 841562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4cbb35380ef84f4f0f68061f578a4e73?s=128&d=identicon&r=PG", "display_name": "Lemming", "link": "https://stackoverflow.com/users/841562/lemming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "accepted_answer_id": 28775901, "answer_count": 1, "score": 4, "last_activity_date": 1425078586, "creation_date": 1422867003, "last_edit_date": 1495535343, "question_id": 28273922, "link": "https://stackoverflow.com/questions/28273922/counting-rows-with-esqueleto", "title": "Counting rows with esqueleto", "body": "<p>I am trying to count the rows of an inner-join with Esqueleto (version 2.1.2.1). Unfortunately, my code doesn't compile and I don't understand why. I looked at the following examples of how to do this but couldn't figure out what I'm doing wrong: <a href=\"https://stackoverflow.com/questions/16595892/composing-database-esqueleto-queries-conditional-joins-and-counting\">example1</a>, <a href=\"https://www.haskell.org/pipermail/web-devel/2012/002621.html\" rel=\"nofollow noreferrer\">example2</a>.</p>\n\n<p>My schema looks like this (simplified):</p>\n\n<pre><code>User\nGame\n  state\nPlayer\n  user UserId Maybe\n  game GameId\n</code></pre>\n\n<p>Users can register on the site to play games. You can also play without registering. Hence, there is a separate table <code>Player</code>. A game has a state. It can be <code>Ongoing</code>, or some form of game-over. I now want to count all ongoing games that a user is playing in.</p>\n\n<p>The following SQL-query does that just fine (for a fixed userId of 1):</p>\n\n<pre><code>SELECT COUNT (*)\nFROM Player INNER JOIN Game\nON Player.game = Game.id\nWHERE Player.user = 1 AND game.state = \"Ongoing\"\n</code></pre>\n\n<p>However, the following Esqueleto query does not compile:</p>\n\n<pre><code>[count1] &lt;- runDB $ E.select                                    -- Line 25\n                  $ E.from $ \\(player `E.InnerJoin` game) -&gt; do\n                      E.on $ player^.PlayerGame E.==. game^.GameId\n                      E.where_ $\n                          player^.PlayerUser E.==. E.just (E.val userId) E.&amp;&amp;.\n                          game^.GameState E.==. E.val MyGame.Ongoing\n                      return (game, player)\n                      return E.countRows                        -- Line 32\n</code></pre>\n\n<p>The error message reads like this:</p>\n\n<pre><code>Handler/ListUserGames.hs:25:23:\n    No instance for (E.SqlSelect (expr0 (E.Value a0)) r0)\n      arising from a use of \u2018E.select\u2019\n    The type variables \u2018r0\u2019, \u2018expr0\u2019, \u2018a0\u2019 are ambiguous\n    Note: there are several potential instances:\n      instance (E.SqlSelect a ra, E.SqlSelect b rb) =&gt;\n               E.SqlSelect (a, b) (ra, rb)\n        -- Defined in \u2018Database.Esqueleto.Internal.Sql\u2019\n      instance (E.SqlSelect a ra, E.SqlSelect b rb, E.SqlSelect c rc) =&gt;\n               E.SqlSelect (a, b, c) (ra, rb, rc)\n        -- Defined in \u2018Database.Esqueleto.Internal.Sql\u2019\n      instance (E.SqlSelect a ra, E.SqlSelect b rb, E.SqlSelect c rc,\n                E.SqlSelect d rd) =&gt;\n               E.SqlSelect (a, b, c, d) (ra, rb, rc, rd)\n        -- Defined in \u2018Database.Esqueleto.Internal.Sql\u2019\n      ...plus 13 others\n    In the expression: E.select\n    In the second argument of \u2018($)\u2019, namely\n      \u2018E.select\n       $ E.from\n         $ \\ (player `E.InnerJoin` game)\n             -&gt; do { E.on $ player ^. PlayerGame E.==. game ^. GameId;\n                     E.where_\n                     $ player ^. PlayerUser E.==. E.just (E.val userId)\n                       E.&amp;&amp;. game ^. GameState E.==. E.val MyGame.Ongoing;\n                     .... }\u2019\n    In a stmt of a 'do' block:\n      [count1] &lt;- runDB\n                  $ E.select\n                    $ E.from\n                      $ \\ (player `E.InnerJoin` game)\n                          -&gt; do { E.on $ player ^. PlayerGame E.==. game ^. GameId;\n                                  E.where_\n                                  $ player ^. PlayerUser E.==. E.just (E.val userId)\n                                    E.&amp;&amp;. game ^. GameState E.==. E.val MyGame.Ongoing;\n                                  .... }\n\nHandler/ListUserGames.hs:32:32:\n    No instance for (E.Esqueleto query0 expr0 backend0)\n      arising from a use of \u2018E.countRows\u2019\n    The type variables \u2018query0\u2019, \u2018expr0\u2019, \u2018backend0\u2019 are ambiguous\n    Note: there is a potential instance available:\n      instance E.Esqueleto E.SqlQuery E.SqlExpr SqlBackend\n        -- Defined in \u2018Database.Esqueleto.Internal.Sql\u2019\n    In the first argument of \u2018return\u2019, namely \u2018E.countRows\u2019\n    In a stmt of a 'do' block: return E.countRows\n    In the expression:\n      do { E.on $ player ^. PlayerGame E.==. game ^. GameId;\n           E.where_\n           $ player ^. PlayerUser E.==. E.just (E.val userId)\n             E.&amp;&amp;. game ^. GameState E.==. E.val MyGame.Ongoing;\n           return (game, player);\n           return E.countRows }\n</code></pre>\n\n<p>However, the exact same query works if I remove the <code>countRows</code>. I.e. the following code compiles and does what I want it to do.</p>\n\n<pre><code>ongoing &lt;- runDB $ E.select\n                 $ E.from $ \\(player `E.InnerJoin` game) -&gt; do\n                     E.on $ player^.PlayerGame E.==. game^.GameId\n                     E.where_ $\n                       player^.PlayerUser E.==. E.just (E.val userId) E.&amp;&amp;.\n                       game^.GameState E.==. E.val MyGame.Ongoing\n                     E.orderBy [E.desc $ game^.GameLastActionTime]\n                     E.limit pagelen\n                     E.offset $ max 0 $ (page1 - 1) * pagelen\n                     return (game, player)\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 5, "creation_date": 1422863937, "post_id": 28273198, "comment_id": 44901461, "body": "You can try putting it in REPL and see it for yourself."}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 4, "creation_date": 1422864081, "post_id": 28273198, "comment_id": 44901515, "body": "More specifically define <code>fix</code> in GHCi with <code>let fix f = f (fix f)</code> and then ask for its type with <code>:t fix</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1422892349, "post_id": 28273198, "comment_id": 44917143, "body": "I&#39;m voting to close this question as off-topic because I don&#39;t want to do your homework either."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1422894710, "post_id": 28273198, "comment_id": 44918777, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/8918990/why-is-the-type-of-this-function-a-a-a\">Why is the type of this function (a -&gt; a) -&gt; a?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 6, "last_activity_date": 1422864719, "creation_date": 1422864719, "answer_id": 28273436, "question_id": 28273198, "link": "https://stackoverflow.com/questions/28273198/haskell-fixed-point-signature/28273436#28273436", "title": "Haskell fixed point signature", "body": "<p>This question looks like an course homework / test question. I'll help you to find the solution yourself:</p>\n\n<p>First you probably have GHC installed, so you can run <code>ghci</code> a haskell repl.</p>\n\n<p>There is <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html\">a section in GHC users' guide about GHCi</a>. Yet it's quite long.</p>\n\n<p>If you start up the GHCi you'll get a prompt, where you can type Haskell expressions:</p>\n\n<pre><code>Prelude&gt; 1 + 1\n2\nPrelude&gt; map (\\x -&gt; x + x) [1, 2, 3]\n[2,4,6]\n</code></pre>\n\n<p>You can also bind expression to names, and define functions:</p>\n\n<pre><code>Prelude&gt; let fix f = f (fix f)\n</code></pre>\n\n<p>And one of the most powerful features is to ask for the type of the expression:</p>\n\n<pre><code>Prelude&gt; :t map (\\x -&gt; x + x)\nmap (\\x -&gt; x + x) :: Num b =&gt; [b] -&gt; [b]\nPrelude&gt; :t fix\n... output omitted\n</code></pre>\n\n<p>That's how you find a solution to your problem. After you know that, you could ask why the type of <code>fix</code> is what it is.</p>\n"}, {"comments": [{"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1422898533, "post_id": 28281174, "comment_id": 44920967, "body": "Why you don&#39;t stop at <code>fix :: (t -&gt; t) -&gt; t</code>. That&#39;s the correct and principal HM type, which is equal (modulo renaming) to <i>c)</i>. I&#39;d say, both <i>a)</i> and <i>c)</i> are correct, if question is multiple choice. Or then either one is ok (any correct type)."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 1, "creation_date": 1422899554, "post_id": 28281174, "comment_id": 44921494, "body": "@phadej I did stop there, but I edited to hopefully make it a bit clearer that I did. The aside at the end is there to explain that alternative a) isn&#39;t general enough."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 2, "last_activity_date": 1422899329, "last_edit_date": 1422899329, "creation_date": 1422891181, "answer_id": 28281174, "question_id": 28273198, "link": "https://stackoverflow.com/questions/28273198/haskell-fixed-point-signature/28281174#28281174", "title": "Haskell fixed point signature", "body": "<p>A completely different approach: finding the solution through reasoning.</p>\n\n<p>The right hand side is</p>\n\n<pre><code>f (fix f)\n</code></pre>\n\n<p>so <code>f</code> has the type <code>a -&gt; b</code> for some types <code>a</code> and <code>b</code>, since <code>f</code> is a function.  </p>\n\n<p>In other words, the value of <code>f (fix f)</code> has type <code>b</code>, and <code>fix f</code> has the type <code>a</code>.  </p>\n\n<p>Since, by definition, </p>\n\n<pre><code>fix f = f (fix f)\n</code></pre>\n\n<p><code>fix f</code> must have the same type as <code>f (fix f)</code>, i.e. <code>b</code>.</p>\n\n<p>We have already said that <code>a</code> is the type of <code>fix f</code>, so <code>a</code> and <code>b</code> must be the same type.  </p>\n\n<p>Let's call it <code>t</code> to keep things separate.</p>\n\n<p>So <code>f : t -&gt; t</code>, since <code>a</code> and <code>b</code> were the same type <code>t</code>.<br>\nWe know that <code>fix f</code> has the type <code>b</code>, which we renamed <code>t</code>.</p>\n\n<p>Putting <code>f : t -&gt; t</code> and <code>fix f : t</code> together we get</p>\n\n<pre><code>fix : (t -&gt; t) -&gt; t  \n</code></pre>\n\n<p>which is alternative c).</p>\n\n<hr>\n\n<p>Aside: if we substitute <code>a -&gt; b</code> for <code>t</code> we get</p>\n\n<pre><code>((a -&gt; b) -&gt; (a -&gt; b)) -&gt; (a -&gt; b)\n</code></pre>\n\n<p>or, since the arrow associates to the right:</p>\n\n<pre><code>((a -&gt; b) -&gt; a -&gt; b) -&gt; a -&gt; b\n</code></pre>\n\n<p>which is exactly the answer in a).<br>\nSo a) is almost correct, but not general enough.</p>\n"}], "owner": {"reputation": 1794, "user_id": 1135950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b1cf007709e46bbd037f204a43c51fa4?s=128&d=identicon&r=PG", "display_name": "yonutix", "link": "https://stackoverflow.com/users/1135950/yonutix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "closed_date": 1423368788, "accepted_answer_id": 28273436, "answer_count": 2, "score": -4, "last_activity_date": 1422899329, "creation_date": 1422863584, "question_id": 28273198, "link": "https://stackoverflow.com/questions/28273198/haskell-fixed-point-signature", "closed_reason": "Not suitable for this site", "title": "Haskell fixed point signature", "body": "<p>What is the signature of the following Haskell function:</p>\n\n<pre><code>fix f = f (fix f)\n</code></pre>\n\n<p>a) ((a->b)->a->b)->a->b</p>\n\n<p>b) The signature can not be synthesized</p>\n\n<p>c) (a->a)->a</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["mysql", "database", "haskell", "yesod", "persistent"], "answers": [{"comments": [{"owner": {"reputation": 79487, "user_id": 72583, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/16a5eec5eca4550033c0e19dba3b32b8?s=128&d=identicon&r=PG", "display_name": "Jakub Arnold", "link": "https://stackoverflow.com/users/72583/jakub-arnold"}, "edited": false, "score": 0, "creation_date": 1422848688, "post_id": 28270777, "comment_id": 44897176, "body": "Thanks! This is exactly what I&#39;ve been looking for. I&#39;ll accept the answer as soon as SO lets me."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 79487, "user_id": 72583, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/16a5eec5eca4550033c0e19dba3b32b8?s=128&d=identicon&r=PG", "display_name": "Jakub Arnold", "link": "https://stackoverflow.com/users/72583/jakub-arnold"}, "edited": false, "score": 0, "creation_date": 1422858247, "post_id": 28270777, "comment_id": 44899495, "body": "@JakubArnold, in the case of a good question with a good answer, it&#39;s often best <i>not</i> to accept too early. Wait a bit for the question and answer to accumulate more views (help the community) and votes (help yourself and the answerer)."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 4, "last_activity_date": 1422848397, "creation_date": 1422848397, "answer_id": 28270777, "question_id": 28270754, "link": "https://stackoverflow.com/questions/28270754/how-can-i-query-using-persistent-mysql-using-withmysqlconn/28270777#28270777", "title": "How can I query using persistent-mysql using withMySQLConn?", "body": "<p>You're almost there. You just need to use one of the functions from <code>monad-logger</code> to provide a <code>MonadLogger</code> context. You may want to try <code>runStdoutLoggingT</code>.</p>\n"}], "owner": {"reputation": 79487, "user_id": 72583, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/16a5eec5eca4550033c0e19dba3b32b8?s=128&d=identicon&r=PG", "display_name": "Jakub Arnold", "link": "https://stackoverflow.com/users/72583/jakub-arnold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 28270777, "answer_count": 1, "score": 2, "last_activity_date": 1422848397, "creation_date": 1422848190, "question_id": 28270754, "link": "https://stackoverflow.com/questions/28270754/how-can-i-query-using-persistent-mysql-using-withmysqlconn", "title": "How can I query using persistent-mysql using withMySQLConn?", "body": "<p>I'm using <a href=\"https://hackage.haskell.org/package/persistent-mysql-2.1.2.1/docs/Database-Persist-MySQL.html\" rel=\"nofollow\">persistent-mysql</a> and trying to find a way to execute a simple command from the <code>SqlPersistM ()</code> monad. However I'm running into type errors.</p>\n\n<p>First there is <code>withMySQLConn defaultConnectInfo</code>, which has the following type</p>\n\n<pre><code>(MonadLogger m, MonadBaseControl IO m, MonadIO m) =&gt;\n (Connection -&gt; m a) -&gt; m a\n</code></pre>\n\n<p>The problem here is that if I try to run this in the <code>IO</code> monad, I'll get an error saying there's no <code>MonadLogger</code> instance for <code>IO</code>.</p>\n\n<pre><code>\u03bb&gt; :t withMySQLConn defaultConnectInfo $\n        \\c -&gt; runSqlPersistM (runMigration migrateAll) c\n\n&lt;interactive&gt;:1:1-13:\n    No instance for (MonadLogger IO)\n      arising from a use of \u2018withMySQLConn\u2019\n    In the expression: withMySQLConn defaultConnectInfo\n    In the expression:\n      withMySQLConn defaultConnectInfo\n      $ \\ c -&gt; runSqlPersistM (runMigration migrateAll) c\n</code></pre>\n\n<p>It seems there was one in <a href=\"https://hackage.haskell.org/package/monad-logger-0.2.4/docs/Control-Monad-Logger.html\" rel=\"nofollow\">an older version of <code>monad-logger</code></a>, but <a href=\"https://hackage.haskell.org/package/monad-logger-0.3.11.1/docs/Control-Monad-Logger.html\" rel=\"nofollow\">not anymore</a>. I'm not sure if I'm using this wrong, or if there's an underlying problem. I only have a small cabal project with persistent 2.1.1.4 setup, and trying to run the migrations from <code>cabal repl</code>.</p>\n\n<p>If it's of any relevance, here is my whole database setup code</p>\n\n<pre><code>{-# LANGUAGE EmptyDataDecls             #-}\n{-# LANGUAGE FlexibleContexts           #-}\n{-# LANGUAGE GADTs                      #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE MultiParamTypeClasses      #-}\n{-# LANGUAGE OverloadedStrings          #-}\n{-# LANGUAGE QuasiQuotes                #-}\n{-# LANGUAGE TemplateHaskell            #-}\n{-# LANGUAGE TypeFamilies               #-}\nmodule Model where\n\nimport Control.Monad.Trans.Control\nimport Control.Monad.IO.Class\nimport Control.Monad.Trans.Resource (runResourceT, ResourceT)\nimport Control.Monad.Logger\n\nimport Data.Text (Text)\nimport Data.Time (UTCTime)\nimport Database.Persist\nimport Database.Persist.TH\nimport Database.Persist.MySQL\nimport Database.Persist.Sqlite\n\nshare [mkPersist sqlSettings, mkMigrate \"migrateAll\"]\n    [persistLowerCase|\n     Receipt\n         name Text\n         createdAt UTCTime\n            |]\n</code></pre>\n\n<p>I've tried using <code>persistent-sqlite</code> and everything seems to work fine (based on the book tutorial), but I can't seem to get things working in MySQL.</p>\n\n<p><strong>What I'm looking for is a simple snippet showing how to execute a <code>SqlPersistM a</code> query (or equivalent) using <code>persistent-mysql</code>.</strong></p>\n\n<p><em>This question is a followup <a href=\"https://github.com/yesodweb/persistent/issues/355\" rel=\"nofollow\">from a GitHub issue discussion</a>.</em></p>\n"}, {"tags": ["haskell", "distributed-computing", "netwire"], "owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "closed_date": 1422867181, "answer_count": 0, "score": 3, "last_activity_date": 1422862273, "creation_date": 1422844738, "last_edit_date": 1422862273, "question_id": 28270414, "link": "https://stackoverflow.com/questions/28270414/cloud-haskell-netwire-do-they-overlap-can-both-be-used-effectively", "closed_reason": "Opinion-based", "title": "Cloud Haskell &amp; Netwire. Do they overlap? Can both be used effectively?", "body": "<p>Basically, I want to experiment with FRP and distributed Haskell.</p>\n\n<p>I wonder if I could use Netwire for FRP and Cloud Haskell to allow \"wires\" to be distributed over different \"nodes\".</p>\n\n<p>But maybe Cloud Haskell already provides FRP. Or maybe Netwire already provides distributed wires.</p>\n\n<p>How could you do distributed FRP?</p>\n"}, {"tags": ["haskell", "ghc", "cabal", "glib"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1422827343, "post_id": 28267744, "comment_id": 44892754, "body": "What does <code>ghc-pkg list Cabal</code> say?"}], "answers": [{"tags": [], "owner": {"reputation": 2813, "user_id": 4463660, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a7834b35fe2ac4b9d405e0b9f1b1bf10?s=128&d=identicon&r=PG&f=1", "display_name": "Citronen", "link": "https://stackoverflow.com/users/4463660/citronen"}, "is_accepted": false, "score": 2, "last_activity_date": 1422828252, "creation_date": 1422828252, "answer_id": 28268475, "question_id": 28267744, "link": "https://stackoverflow.com/questions/28267744/cabal-glib-installation-error/28268475#28268475", "title": "cabal glib installation error", "body": "<p>Run <code>cabal install cabal-install</code>. Daniel Wagner's suggestion will most likely provide different results than <code>cabal --version</code>.</p>\n"}], "owner": {"reputation": 620, "user_id": 2576287, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh5.googleusercontent.com/-VegFz4P9Ovc/AAAAAAAAAAI/AAAAAAAAATo/Z-69W9rBCno/photo.jpg?sz=128", "display_name": "mrLSD", "link": "https://stackoverflow.com/users/2576287/mrlsd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422828252, "creation_date": 1422824018, "question_id": 28267744, "link": "https://stackoverflow.com/questions/28267744/cabal-glib-installation-error", "title": "cabal glib installation error", "body": "<p>I try install install glib via cabal</p>\n\n<pre><code>evgeny@virtuos:~$ cabal install glib-0.13.0.7\nResolving dependencies...\nFailed to install glib-0.13.0.7\ncabal: Error: some packages failed to install:\nglib-0.13.0.7 failed during the configure step. The exception was:\nuser error (The package 'glib' requires Cabal library version -any &amp;&amp; &gt;=1.18\nbut no suitable version is installed.)\nevgeny@virtuos:~$ cabal --version \ncabal-install version 1.20.0.3\nusing version 1.20.0.2 of the Cabal library\n</code></pre>\n\n<p>what's wrong?\nOS: Ubuntu 14.10\nCabal 1.20.0.3\nGHC: 7.6.3</p>\n"}, {"tags": ["haskell", "combobox", "treeview", "gtk", "gtk2hs"], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1422805600, "creation_date": 1422805600, "question_id": 28264538, "link": "https://stackoverflow.com/questions/28264538/gtk-make-a-pixbuf-cellrenderer-editable", "title": "Gtk : Make a pixbuf cellrenderer editable", "body": "<p>I want to make a combobox of pictures inside of a treeview cell (the cell must render the selected picture)</p>\n\n<p>I tried these solutions : </p>\n\n<ol>\n<li>Make a <code>cellRendererComboNew</code> in the column. The cells are editable but the combobox render only <code>Strings</code>!</li>\n<li>I used the <code>editingStarted</code> signal to detect the edition of the cell and create a combobox with pictures in this cell. It Works fine but the cell doesn't render a picture!</li>\n<li>I tryed to make a <code>cellRendererPixbufNew</code> in the column and make these cells editable (clickable,selectable) and use the <code>editingStarted</code> signal the same way as previously. But pixbuf cells are not editable!</li>\n<li>I tryed to change the <code>cellMode</code> property of the cells with\n<code>set render [ cellMode:= CellRendererModeActivatable ]</code> to make the signal <code>editingStarted</code> to be emitted when clicking on the cell. But it doesn't work!</li>\n</ol>\n\n<p>My questions are :</p>\n\n<ul>\n<li>Is it possible to make a pixbuf cell renderer editable? And what is the correct way to do it?</li>\n<li>Is it possible to detect the left click on a treeview cell and replace the widget inside this cell like with <code>editingStarted</code> ?</li>\n<li>Do you have an example in Haskell? Python? or any language?</li>\n</ul>\n\n<p>Best Regards.</p>\n"}, {"tags": ["haskell", "ghc", "gtk2hs"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1422795151, "last_edit_date": 1422795151, "creation_date": 1422794439, "answer_id": 28262814, "question_id": 28262747, "link": "https://stackoverflow.com/questions/28262747/gtk2hs-existing-function-not-found/28262814#28262814", "title": "Gtk2Hs : Existing function not found", "body": "<p>This looks as a bug in that old Haskell library: from its source code</p>\n\n<pre><code>module Graphics.UI.Gtk.ModelView.CellRenderer (\n  -- snip\n  CellRendererMode,\n</code></pre>\n\n<p>The above is <em>not</em> exporting the constructors. Newer versions do:</p>\n\n<pre><code>module Graphics.UI.Gtk.ModelView.CellRenderer (\n  -- snip\n  CellRendererMode(..),\n</code></pre>\n\n<p>You may try to update the Haskell library to a newer version. That should fix it.</p>\n\n<hr>\n\n<p><strong>Alternative</strong>. The type has an <code>Enum</code> instance even in the old version, so as a quick &amp; dirty workaround you can use <code>toEnum 1 :: CellRendererMode</code> \ninstead of the constructor.</p>\n\n<pre><code>data CellRendererMode = CellRendererModeInert         -- 0\n                      | CellRendererModeActivatable   -- 1\n                      | CellRendererModeEditable      -- 2\n                      deriving (Enum,Eq)\n</code></pre>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 28262814, "answer_count": 1, "score": 0, "last_activity_date": 1422795151, "creation_date": 1422793924, "question_id": 28262747, "link": "https://stackoverflow.com/questions/28262747/gtk2hs-existing-function-not-found", "title": "Gtk2Hs : Existing function not found", "body": "<p>I have a problem with Gtk2Hs, I want to set a <code>cellRenderer</code> activatable.\nFor that, I need to set it's property   <code>cellMode</code> to <code>CellRendererModeActivatable</code> by using :</p>\n\n<pre><code>set render [ cellMode:= CellRendererModeActivatable ]\n</code></pre>\n\n<p>But I have the following error when compiling</p>\n\n<pre><code>Not in scope: data constructor `CellRendererModeActivatable'\n</code></pre>\n\n<p>I'm using Gtk2Hs 0.12.3 on my Debian Wheezy with GHC 7.4.1. </p>\n\n<p>I looked in Hackage if the constructor exist (in the correct version of the documentation) and ... <strong>it does</strong>.</p>\n\n<p>I tried to explicity load the module</p>\n\n<pre><code>import Graphics.UI.Gtk.ModelView.CellRenderer\n</code></pre>\n\n<p>but the compilation error remain the same.</p>\n\n<p>Do you have an idea where the error come from?</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 3, "last_activity_date": 1422786768, "creation_date": 1422786768, "answer_id": 28261732, "question_id": 28261695, "link": "https://stackoverflow.com/questions/28261695/what-is-the-type-in-haskell-means/28261732#28261732", "title": "what is the type () :: () in haskell means?", "body": "<p><code>()</code> (pronounced unit) is both the name of the type and the single value of that type. It is therefore saying 'The value <code>()</code> has type <code>()</code>' in the same way as</p>\n\n<pre><code>:t \"Hello\"\n\"Hello\" :: String\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 8, "last_activity_date": 1422791077, "last_edit_date": 1495539812, "creation_date": 1422791077, "answer_id": 28262312, "question_id": 28261695, "link": "https://stackoverflow.com/questions/28261695/what-is-the-type-in-haskell-means/28262312#28262312", "title": "what is the type () :: () in haskell means?", "body": "<h2>Different namespaces</h2>\n\n<p>As said by Lee, <code>()</code> happens to be both the name of a type, and of its only constructor. Basically, it's the same as if you had defined</p>\n\n<pre><code>data Unit = Unit\n\nf :: Unit -&gt; Int\nf Unit = 7\n</code></pre>\n\n<p>...perhaps less confusing when the constructor isn't nullary:</p>\n\n<pre><code>newtype MyInt = MyInt Int\n\ng :: MyInt -&gt; Int\ng (MyInt i) = i\n</code></pre>\n\n<p>Note that in each case, both of the &ldquo;equal&rdquo; names live in completely seperate namespaces: read the examples as</p>\n\n<pre><code>data T\u028f\u1d18\u1d07S\u1d04\u1d0f\u1d18\u1d07.Unit = V\u1d00\u029f\u1d1c\u1d07S\u1d04\u1d0f\u1d18\u1d07.Unit\nnewtype T\u028f\u1d18\u1d07S\u1d04\u1d0f\u1d18\u1d07.MyInt = V\u1d00\u029f\u1d1c\u1d07S\u1d04\u1d0f\u1d18\u1d07.MyInt Int\n\nV\u1d00\u029f\u1d1c\u1d07S\u1d04\u1d0f\u1d18\u1d07.MyInt 7 :: T\u028f\u1d18\u1d07S\u1d04\u1d0f\u1d18\u1d07.MyInt\nV\u1d00\u029f\u1d1c\u1d07S\u1d04\u1d0f\u1d18\u1d07.Unit :: T\u028f\u1d18\u1d07S\u1d04\u1d0f\u1d18\u1d07.Unit\nV\u1d00\u029f\u1d1c\u1d07S\u1d04\u1d0f\u1d18\u1d07.() :: T\u028f\u1d18\u1d07S\u1d04\u1d0f\u1d18\u1d07.()\n</code></pre>\n\n<h2>About the unit type</h2>\n\n<p>Your characterisation</p>\n\n<blockquote>\n  <p>I know you can return this from a function when you don't want to do any thing</p>\n</blockquote>\n\n<p>is kind of correct from a procedural point of view, but in Haskell &ldquo;do anything&rdquo; isn't really a meaningful thing to say: functions <em>never</em> &ldquo;do anything&rdquo;, they merely yield results. And a function with result type <code>()</code> is no exception: it yields a result, only the result contains no actual information.</p>\n\n<p>For further reference, see <a href=\"https://stackoverflow.com/questions/16892570/what-is-in-haskell-exactly\">What is () in Haskell, exactly?</a>.</p>\n"}], "owner": {"reputation": 1497, "user_id": 2148851, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b7558f5365a89314a0d569edba74dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "k4vin", "link": "https://stackoverflow.com/users/2148851/k4vin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "closed_date": 1422793791, "accepted_answer_id": 28262312, "answer_count": 2, "score": 2, "last_activity_date": 1422791077, "creation_date": 1422786440, "question_id": 28261695, "link": "https://stackoverflow.com/questions/28261695/what-is-the-type-in-haskell-means", "closed_reason": "Duplicate", "title": "what is the type () :: () in haskell means?", "body": "<p>on the prelude i just checked the type of () what does it really mean</p>\n\n<pre><code>Prelude&gt; :type ()\n() :: ()\n</code></pre>\n\n<p>I know you can return this from a function when you don't want to do any thing. what actually is happening there ?</p>\n"}, {"tags": ["haskell", "types", "operator-precedence", "implicit-typing"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 4, "creation_date": 1422752484, "post_id": 28258308, "comment_id": 44874673, "body": "You need parens: <code>latter (1&#47;2) (1&#47;2)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "edited": false, "score": 0, "creation_date": 1422753255, "post_id": 28258343, "comment_id": 44874786, "body": "Thanks a lot for your help."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 17, "last_activity_date": 1422752505, "creation_date": 1422752505, "answer_id": 28258343, "question_id": 28258308, "link": "https://stackoverflow.com/questions/28258308/why-does-a-simple-haskell-function-reject-a-fractional-argument-expressed-as-a-r/28258343#28258343", "title": "Why does a simple Haskell function reject a Fractional argument expressed as a ratio?", "body": "<p>Function application in Haskell binds more tightly than anything else. So</p>\n\n<pre><code>latter 1/2 1/2\n</code></pre>\n\n<p>gets read as</p>\n\n<pre><code>((latter 1) / (2 1)) / 2\n</code></pre>\n\n<p>Applying <code>2</code> to <code>1</code> is not such a hot idea, and since <code>latter</code> takes two arguments, <code>latter 1</code> is actually a function. Dividing a function by something is also not a good idea. You can fix all of these problems using some parentheses:</p>\n\n<pre><code>latter (1/2) (1/2)\n</code></pre>\n"}], "owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1422753598, "creation_date": 1422752185, "last_edit_date": 1422753598, "question_id": 28258308, "link": "https://stackoverflow.com/questions/28258308/why-does-a-simple-haskell-function-reject-a-fractional-argument-expressed-as-a-r", "title": "Why does a simple Haskell function reject a Fractional argument expressed as a ratio?", "body": "<p>I'm admittedly a Haskell newbie.  To explore laziness, I created a function in ghci that returns its second argument:</p>\n\n<pre><code>Prelude&gt; let latter x y = y\nlatter :: t -&gt; t1 -&gt; t1\n</code></pre>\n\n<p>I am able to call it with arguments of types <code>Char</code>, <code>[Char]</code>, <code>Num</code>, <code>Floating</code>, and <code>Fractional</code> (expressed as decimals):</p>\n\n<pre><code>Prelude&gt; latter 'x' 'y'\n'y'\nit :: Char\n\nPrelude&gt; latter \"foo\" \"bar\"\n\"bar\"\nit :: [Char]\n\nPrelude&gt; latter 1 2\n2\nit :: Num t1 =&gt; t1\n\nPrelude&gt; latter pi pi\n3.141592653589793\nit :: Floating t1 =&gt; t1\n\nPrelude&gt; latter 0.5 0.7\n0.7\nit :: Fractional t1 =&gt; t1\n</code></pre>\n\n<p>Why do I get a horrible error (and what does it mean) when I try applying <code>latter</code> to a <code>Fractional</code> expressed as a ratio:</p>\n\n<pre><code>Prelude&gt; 1/2\n0.5\nit :: Fractional a =&gt; a\n\nPrelude&gt; latter 1/2 1/2\n\n&lt;interactive&gt;:62:1:\n    Could not deduce (Num (a0 -&gt; t1 -&gt; t1))\n      arising from the ambiguity check for \u2018it\u2019\n    from the context (Num (a -&gt; t1 -&gt; t1),\n                      Num a,\n                      Fractional (t1 -&gt; t1))\n      bound by the inferred type for \u2018it\u2019:\n                 (Num (a -&gt; t1 -&gt; t1), Num a, Fractional (t1 -&gt; t1)) =&gt; t1 -&gt; t1\n      at &lt;interactive&gt;:62:1-14\n    The type variable \u2018a0\u2019 is ambiguous\n    When checking that \u2018it\u2019\n      has the inferred type \u2018forall t1 a.\n                             (Num (a -&gt; t1 -&gt; t1), Num a, Fractional (t1 -&gt; t1)) =&gt;\n                             t1 -&gt; t1\u2019\n    Probable cause: the inferred type is ambiguous\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2336, "user_id": 799829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/736cd516c29ee2f6cdc2c8f454a36bb9?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/799829/tim"}, "edited": false, "score": 0, "creation_date": 1422819503, "post_id": 28261967, "comment_id": 44890137, "body": "Thanks for the reply. In my case I have trouble seeing any obvious loops. I am using recursive higher-order functions (e.g. map) all over the place. Is it possible this would show up for inlined code?  I added a second example. The <code>commafy</code> function does recurse, but elsewhere shows up as <code>statsFields.commafy.(...)</code>. I suppose it could have be inlined at this use and not the other?"}, {"owner": {"reputation": 2336, "user_id": 799829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/736cd516c29ee2f6cdc2c8f454a36bb9?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/799829/tim"}, "edited": false, "score": 0, "creation_date": 1422819592, "post_id": 28261967, "comment_id": 44890167, "body": "Does a reference on this profiling format exist at all?"}], "tags": [], "owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "is_accepted": false, "score": 3, "last_activity_date": 1422799050, "last_edit_date": 1422799050, "creation_date": 1422788582, "answer_id": 28261967, "question_id": 28258114, "link": "https://stackoverflow.com/questions/28258114/understanding-cost-center-names-in-haskell-profiling-reports/28261967#28261967", "title": "Understanding cost center names in Haskell profiling reports", "body": "<p>(...) means repeatable operation something like recursive call. I have the same question when investigating my program. Look at the following simple example, I'm evaluating <code>count</code> and <code>mergeAndCount</code> recursively:</p>\n\n<pre><code>count :: [Int] -&gt; (Int, [Int])\ncount []       = (0, [])\ncount (x:[])   = (0, [x])\ncount xs       =\n  let halves  = splitAt (length xs `div` 2) xs\n      (ac, a) = count $ fst halves\n      (bc, b) = count $ snd halves\n      (mc, merged) = mergeAndCount a b\n  in\n      (ac + bc + mc, merged)\n\nmergeAndCount :: [Int] -&gt; [Int] -&gt; (Int, [Int])\nmergeAndCount [] [] = (0, [])\nmergeAndCount xs [] = (0, xs)\nmergeAndCount [] ys = (0, ys)\nmergeAndCount xs@(x:xs') ys@(y:ys') =\n  let (larger, thisCount, (counted, merged))\n        = if x &lt; y\n            then (x, 0,         mergeAndCount xs' ys)\n            else (y, length xs, mergeAndCount xs ys')\n  in\n      (thisCount + counted, larger : merged)\n</code></pre>\n\n<p>will generate profiling output like</p>\n\n<pre><code>    count                   Invariant               103      199999    0.1    4.3    99.2   37.5\n     count.merged           Invariant               118       99998    0.0    0.0     0.0    0.0\n     count.a                Invariant               113       99999    0.0    0.0     0.0    0.0\n     count.b                Invariant               112       99999    0.0    0.0     0.0    0.0\n     count.(...)            Invariant               110       99999    0.0    0.0    99.0   25.2\n      mergeAndCount         Invariant               111     1636301   98.9   25.2    99.0   25.2\n       mergeAndCount.merged Invariant               122      726644    0.0    0.0     0.0    0.0\n       mergeAndCount.merged Invariant               121      709659    0.0    0.0     0.0    0.0\n       mergeAndCount.(...)  Invariant               120      776644    0.0    0.0     0.0    0.0\n       mergeAndCount.cnt    Invariant               119      776644    0.0    0.0     0.0    0.0\n       mergeAndCount.(...)  Invariant               117      759658    0.0    0.0     0.0    0.0\n       mergeAndCount.cnt    Invariant               116      759658    0.0    0.0     0.0    \n</code></pre>\n\n<p>where <code>count.merged</code> indicated overall result, <code>count.a</code> <code>count.b</code> cost centers for function pattern matching. This <code>(...)</code> clearly visible with each inner call to <code>mergeAndCount</code>. </p>\n\n<p>If you functions contained many different approaches to work with data, your profiling output will be different and highly related to data you have sent.</p>\n"}], "owner": {"reputation": 2336, "user_id": 799829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/736cd516c29ee2f6cdc2c8f454a36bb9?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/799829/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 2, "answer_count": 1, "score": 8, "last_activity_date": 1422819304, "creation_date": 1422750260, "last_edit_date": 1422819304, "question_id": 28258114, "link": "https://stackoverflow.com/questions/28258114/understanding-cost-center-names-in-haskell-profiling-reports", "title": "Understanding cost center names in Haskell profiling reports", "body": "<p>I am trying to decode the meaning of various cost center names in my Haskell profiling output. Here is a sample of the <code>.prof</code> file</p>\n\n<pre><code>COST CENTRE                                         MODULE   no. entries  %time %alloc   %time %alloc\n  ...\n  runSiT.\\.\\.readBufResults           SiT.SiT       3487     0    0.0      46.3   51.9   \n    ...\n     ...\n     readBuffer.(...)                 SiT.SiT       3540     1    0.0      0.2     0.0    0.2\n     readBuffer.tm0_vals              SiT.SiT       3539     1    0.0      0.0     0.0    0.0\n     readBuffer.\\                     SiT.SiT       3499     0   18.4     12.8    31.0   27.7\n     ...\n</code></pre>\n\n<p>It seems that a dot separates nested cost centers (e.g. <code>readBuffer.n_threads</code> means the binding <code>n_threads</code> within <code>readBuffer</code>), but I am unsure as to some of the other elements. And the <code>.\\.\\.</code> indicates nested lambda functions (e.g. from stuff like <code>forM_ ... $ \\arg -&gt; do</code>). <strong>However, what is the meaning of the <code>(...)</code> in <code>readBuffer.(...)</code></strong>?</p>\n\n<p><strong>EDIT:</strong>\nAs a second example I have:</p>\n\n<pre><code>statsFields.mkStr.\\                  Main         3801           4    0.0    0.0     0.0    0.0\n statsFields.fmtModePct              Main         3811           2    0.0    0.0     0.0    0.0\n  statsFields.fmtModePct.pct_str     Main         3815           2    0.0    0.0     0.0    0.0\n   ssN                               SiT.SiT      3817           2    0.0    0.0     0.0    0.0\n   statsFields.fmtPctI               Main         3816           2    0.0    0.0     0.0    0.0\n  statsFields.fmtModePct.(...)       Main         3813           2    0.0    0.0     0.0    0.0\n   ssMode                            SiT.SiT      3814           2    0.0    0.0     0.0    0.0\n  statsFields.fmtModePct.m_fq        Main         3812           2    0.0    0.0     0.0    0.0\n</code></pre>\n\n<p>Source for that is:</p>\n\n<pre><code>where ...\n      fmtModePct :: SiTStats -&gt; String\n      fmtModePct ss = fmtI64 m_fq ++ \" (\" ++ pct_str ++ \")\"\n        where (m_val,m_fq) = ssMode ss\n              pct_str = fmtPctI m_fq (ssN ss)\n\n      fmtF64 :: Double -&gt; String\n      fmtF64 = commafy . printf \"%.1f\"\n\n      -- turns 1000 -&gt; 1,000\n      commafy :: String -&gt; String\n      commafy str\n        | head str == '-' = '-':commafy (tail str)\n        | otherwise = reverse (go (reverse sig)) ++ frac\n        where (sig,frac) = span (/='.') str\n              go (a:b:c:cs@(_:_)) = a : b : c : ',' : go cs\n              go str = str\n</code></pre>\n"}, {"tags": ["haskell", "combobox", "gtk2hs"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1422750619, "post_id": 28258030, "comment_id": 44874338, "body": "You should clarify what is the question."}], "answers": [{"tags": [], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "is_accepted": true, "score": 2, "last_activity_date": 1422749341, "creation_date": 1422749341, "answer_id": 28258031, "question_id": 28258030, "link": "https://stackoverflow.com/questions/28258030/gtk2hs-combo-box-with-text-and-pictures/28258031#28258031", "title": "gtk2Hs : Combo box with text and pictures", "body": "<p>Here is the code to obtain the expected result : </p>\n\n<pre><code>pic1 &lt;- pixbufNewFromFile \"Picture_1.png\"\npic2 &lt;- pixbufNewFromFile \"Picture_2.png\"\npic3 &lt;- pixbufNewFromFile \"Picture_3.png\"\n\nlet lstsecrep = [\n                  (\"Picture 1\",pic1)\n                , (\"Picture 2\",pic2)\n                , (\"Picture 3\",pic3)\n                ]\n\nlststorerep &lt;- listStoreNew lstsecrep \n\ncustomStoreSetColumn lststorerep (makeColumnIdString 0) fst\ncustomStoreSetColumn lststorerep (makeColumnIdPixbuf 1) snd\n\ncombo &lt;- comboBoxNewWithModel lststorerep\n\nrendertxt &lt;- cellRendererTextNew\nrenderpic &lt;- cellRendererPixbufNew\n\ncellLayoutPackStart  combo rendertxt False\ncellLayoutPackStart  combo renderpic True\ncellLayoutAddColumnAttribute combo rendertxt cellText $ makeColumnIdString 0\ncellLayoutAddColumnAttribute combo renderpic cellPixbuf $ makeColumnIdPixbuf 1\n</code></pre>\n\n<p>Best regards.</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 28258031, "answer_count": 1, "score": 1, "last_activity_date": 1422751761, "creation_date": 1422749341, "last_edit_date": 1422751761, "question_id": 28258030, "link": "https://stackoverflow.com/questions/28258030/gtk2hs-combo-box-with-text-and-pictures", "title": "gtk2Hs : Combo box with text and pictures", "body": "<p>The basic <code>ComboBox</code> provided by Gtk can only handle a <code>String</code> or a <code>Pixbuf</code></p>\n\n<p>But I wanted a text and a picture nearby on the same row of selection.</p>\n\n<p>I looked for a while how to obtain the result bellow using Haskell and Gtk2Hs.</p>\n\n<p><img src=\"https://i.stack.imgur.com/Veear.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422754818, "post_id": 28257511, "comment_id": 44875024, "body": "Another odd thing is that if I ask GHCi <code>:k (~)</code>, it tells me <code>(~) :: k -&gt; k -&gt; Constraint</code>, but if I ask <code>:i (~)</code>, it tells me <code>parse error on input \u2018~\u2019</code>. So something seems to be very strange about how the parser handles <code>~</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1422768038, "post_id": 28257511, "comment_id": 44877080, "body": "I&#39;m not certain what the cause of this is - <code>~</code> has some special behaviors due to being a built-in type function, and maybe it should be consistent with other things. But if this really bothers you, you can do something like <code>type (==) = (~); infixr 0 ==</code>, which would even be more syntactically consistent between term and type level."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1422811994, "post_id": 28257511, "comment_id": 44887740, "body": "I&#39;ve got a <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10056\" rel=\"nofollow noreferrer\">GHC ticket</a> now"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422776532, "post_id": 28260520, "comment_id": 44878446, "body": "That&#39;s clearly not the whole story. Yes, <code>~</code> in a pattern is syntax, but in other contexts it&#39;s a type operator."}, {"owner": {"reputation": 1207, "user_id": 2884502, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d817ec525df88f7a149bc9186e1a31f3?s=128&d=identicon&r=PG&f=1", "display_name": "lightandlight", "link": "https://stackoverflow.com/users/2884502/lightandlight"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1422777575, "post_id": 28260520, "comment_id": 44878611, "body": "It seems like a type operator because you can get its kind, but isn&#39;t it possible it just <i>acts</i> like one?"}, {"owner": {"reputation": 1207, "user_id": 2884502, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d817ec525df88f7a149bc9186e1a31f3?s=128&d=identicon&r=PG&f=1", "display_name": "lightandlight", "link": "https://stackoverflow.com/users/2884502/lightandlight"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422777769, "post_id": 28260520, "comment_id": 44878629, "body": "I&#39;m not skilled enough to comb the source for the implementation,  but that&#39;s what I suspect."}], "tags": [], "owner": {"reputation": 1207, "user_id": 2884502, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d817ec525df88f7a149bc9186e1a31f3?s=128&d=identicon&r=PG&f=1", "display_name": "lightandlight", "link": "https://stackoverflow.com/users/2884502/lightandlight"}, "is_accepted": false, "score": 1, "last_activity_date": 1422775797, "creation_date": 1422775797, "answer_id": 28260520, "question_id": 28257511, "link": "https://stackoverflow.com/questions/28257511/what-is-the-precedence-of-and-why/28260520#28260520", "title": "What is the precedence of ~, and why?", "body": "<p><code>~</code> isn't an operator, it's a keyword, like <code>module</code> or <code>case</code>, so I think you could only alter the precedence using parentheses.</p>\n\n<p>See more here: <a href=\"https://wiki.haskell.org/Keywords#.7E\" rel=\"nofollow\">https://wiki.haskell.org/Keywords#.7E</a></p>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 2, "answer_count": 1, "score": 18, "last_activity_date": 1422799702, "creation_date": 1422745205, "last_edit_date": 1592644375, "question_id": 28257511, "link": "https://stackoverflow.com/questions/28257511/what-is-the-precedence-of-and-why", "title": "What is the precedence of ~, and why?", "body": "<p>The following snippet compiles:</p>\n<pre><code>{-# LANGUAGE TypeFamilies #-}\ntype family Foo a b\n\nf :: (Foo a b ~ Int) =&gt; a -&gt; b -&gt; b\nf = error &quot;&quot;\n</code></pre>\n<p>but <em>infix</em> type operators seem to behave differently:</p>\n<pre><code>{-# LANGUAGE TypeFamilies #-}\ntype family a \\\\ b\n\nf :: (a \\\\ b ~ Int) =&gt; a -&gt; b -&gt; b\nf = error &quot;&quot;\n</code></pre>\n<p>GHC complains that the second argument to <code>\\\\</code> should have kind <code>*</code>, but <code>b ~ Int</code> has kind <code>Constraint</code>. Of course this can be fixed with parens, but I'm wondering if there's another way.</p>\n<p>I've tried setting the precedence of my operator with the fixity declaration <code>infixl 9 \\\\</code>, but that doesn't fix the problem, indicating that the precedence of <code>~</code> is <a href=\"https://www.haskell.org/onlinereport/decls.html#sect4.4.2\" rel=\"noreferrer\">at least 9</a> (if I'm interpreting that correctly). I tried using the trick from <a href=\"https://stackoverflow.com/a/27099641/925978\">this answer</a> to make GHCi tell me the precedence of <code>~</code>, but it didn't work.</p>\n<p>Technically speaking, <code>~</code> probably isn't a type operator, it's more of a lexical construct similar to <code>,</code>, but the questions still stand:</p>\n<ol>\n<li>Why do infix and prefix operators exhibit different behavior?</li>\n<li>Why does <code>~</code> bind so tightly?</li>\n<li>Is there something I can do to make my own operators bind even tighter?</li>\n</ol>\n<p>(Note: <a href=\"https://stackoverflow.com/q/27096277/925978\">This question</a> asks about the precedence of type functions, but it doesn't say anything about <code>~</code>.)</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1422740683, "post_id": 28256830, "comment_id": 44871895, "body": "There are certainly <i>other</i> ways. But I&#39;m voting to close on the grounds that what qualifies as &quot;better&quot; in this case seems very subjective. If you can describe a concrete problem you have with your implementation, then we can make a go of dealing with that problem."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 10, "creation_date": 1422741408, "post_id": 28256830, "comment_id": 44872090, "body": "I&#39;m with @DanielWagner on this, but here&#39;s a standard fun answer: <code>map2nd f = zipWith ($) (cycle [id, f])</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 2, "creation_date": 1422742142, "post_id": 28256830, "comment_id": 44872312, "body": "@J.Abrahamson, as of base 4.8, that will sometimes be slower than it is in previous versions (previous ones were shady). You can instead use <code>map2nd f xs = zipWith (flip ($)) xs (cycle [id, f])</code>."}, {"owner": {"reputation": 101, "user_id": 3675367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160781f2227e937225d258d2f97a86c5?s=128&d=identicon&r=PG&f=1", "display_name": "Nausika", "link": "https://stackoverflow.com/users/3675367/nausika"}, "reply_to_user": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 1, "creation_date": 1422742491, "post_id": 28256830, "comment_id": 44872388, "body": "You are right, &quot;better&quot; is subjective. But as I&#39;m just starting to learn Haskell I&#39;m interesseted to see solutions of experienced Haskellers. When I found this solution I just wondered if &quot;this is it&quot;... coming from for-loop-languages this feels very different. Thank you for the answer @J.Abrahamson."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422750029, "post_id": 28256830, "comment_id": 44874224, "body": "@dfeuer Why would the partially-applied version be slower in new versions of GHC? And why is it not considered a compiler bug?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1422750323, "post_id": 28256830, "comment_id": 44874289, "body": "@BenjaminHodgson, it&#39;s not about the compiler, and it&#39;s not about the partial application either. <code>zipWith</code> has long attempted to fuse with either of its list arguments. Unfortunately, fusing with the <i>right</i> list argument is actually semantically wrong, and can produce bottoms where none should be when compiled with optimization and not otherwise. So I pushed to have that removed, and so <code>zipWith</code> will only fuse with its <i>left</i> list argument."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422750418, "post_id": 28256830, "comment_id": 44874304, "body": "The trouble with fusing with the <i>right</i> argument is that if the right argument goes to bottom just where the left argument ends, you&#39;ll get bottom instead of <code>[]</code>. Although this was known when the code was written, it was really <i>always</i> a bug."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1422779357, "post_id": 28256830, "comment_id": 44878883, "body": "Great explanation, thanks"}], "answers": [{"tags": [], "owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "is_accepted": false, "score": 5, "last_activity_date": 1422748594, "creation_date": 1422748594, "answer_id": 28257946, "question_id": 28256830, "link": "https://stackoverflow.com/questions/28256830/apply-a-function-to-every-second-element-in-a-list/28257946#28257946", "title": "Apply a function to every second element in a list", "body": "<p>Here is how I would do it:</p>\n\n<pre><code>mapOnlyOddNumbered f []      = []\nmapOnlyOddNumbered f (x:xs)  = f x : mapOnlyEvenNumbered f xs\n\nmapOnlyEvenNumbered f []     = []\nmapOnlyEvenNumbered f (x:xs) = x : mapOnlyOddNumbered f xs\n</code></pre>\n\n<p>Whether this is \"idiomatic\" is a matter of opinion (and I would have given it as a comment if it would fit there) , but it may be useful to see a number of different approaches. Your solution is just as valid as mine, or the ones in the comments, and easier to change into say <code>mapOnlyEvery13nd</code> or <code>mapOnlyPrimeNumbered</code></p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422750067, "post_id": 28258023, "comment_id": 44874230, "body": "Very reasonable. However, you should probably remove the redundant parentheses in the last line: <code>func f (x:s:xs)=x : f s : func f xs</code>."}, {"owner": {"reputation": 101, "user_id": 3675367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160781f2227e937225d258d2f97a86c5?s=128&d=identicon&r=PG&f=1", "display_name": "Nausika", "link": "https://stackoverflow.com/users/3675367/nausika"}, "edited": false, "score": 0, "creation_date": 1422822093, "post_id": 28258023, "comment_id": 44890904, "body": "Accepted, this is the most straight forward solution (for me). Thank you. I guess for other index based criterias (every third, fourth, only prime, etc) I&#39;ll stick with my solution."}, {"owner": {"reputation": 52258, "user_id": 375232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h3OwD.png?s=128&g=1", "display_name": "Landei", "link": "https://stackoverflow.com/users/375232/landei"}, "edited": false, "score": 1, "creation_date": 1422885750, "post_id": 28258023, "comment_id": 44912782, "body": "You could remove the first two cases, and append <code>func f xs = xs</code> as <b>last</b> one instead."}], "tags": [], "owner": {"reputation": 1357, "user_id": 986816, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cc682a4311984f4247d03dc5926bf9f4?s=128&d=identicon&r=PG", "display_name": "MartinHaTh", "link": "https://stackoverflow.com/users/986816/martinhath"}, "is_accepted": true, "score": 7, "last_activity_date": 1422886070, "last_edit_date": 1422886070, "creation_date": 1422749287, "answer_id": 28258023, "question_id": 28256830, "link": "https://stackoverflow.com/questions/28256830/apply-a-function-to-every-second-element-in-a-list/28258023#28258023", "title": "Apply a function to every second element in a list", "body": "<p>I haven't written very much Haskell, but here's the first thing that came into mind:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>func :: (a -&gt; a) -&gt; [a] -&gt; [a]\nfunc f [] = []\nfunc f [x] = [x]\nfunc f (x:s:xs) = x:(f s):(func f xs)\n</code></pre>\n\n<p>It is a little ulgy, since you have to not only take care of the empty list, but also the list with one element. This doesn't really scale well either (what if you want every third, or </p>\n\n<p>One could do as @Landei points out, and write</p>\n\n<pre><code>func :: (a -&gt; a) -&gt; [a] -&gt; [a]\nfunc f (x:s:xs) = x:(f s):(func f xs)\nfunc f xs = xs\n</code></pre>\n\n<p>In order to get rid of the ugly checks for both <code>[]</code> and <code>[x]</code>, though, IMHO, this makes it a little harder to read (at least the first time).</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 3675367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160781f2227e937225d258d2f97a86c5?s=128&d=identicon&r=PG&f=1", "display_name": "Nausika", "link": "https://stackoverflow.com/users/3675367/nausika"}, "edited": false, "score": 0, "creation_date": 1422821733, "post_id": 28258198, "comment_id": 44890799, "body": "Thank you, this looks interessting (I wanted to use a fold/scan initially). I need to look up seq and ! though, this is the first time I see them."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 101, "user_id": 3675367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160781f2227e937225d258d2f97a86c5?s=128&d=identicon&r=PG&f=1", "display_name": "Nausika", "link": "https://stackoverflow.com/users/3675367/nausika"}, "edited": false, "score": 0, "creation_date": 1422823529, "post_id": 28258198, "comment_id": 44891396, "body": "@Nausika, unfortunately, scans are a little bit broken in Haskell (grr...), but you can use them anyway if you like. Another, differently-broken, option is <code>mapAccumL</code>. Cleaner than either would be <code>traverse</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 101, "user_id": 3675367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160781f2227e937225d258d2f97a86c5?s=128&d=identicon&r=PG&f=1", "display_name": "Nausika", "link": "https://stackoverflow.com/users/3675367/nausika"}, "edited": false, "score": 0, "creation_date": 1422826186, "post_id": 28258198, "comment_id": 44892338, "body": "@Nausika, I&#39;ve added some details."}, {"owner": {"reputation": 101, "user_id": 3675367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160781f2227e937225d258d2f97a86c5?s=128&d=identicon&r=PG&f=1", "display_name": "Nausika", "link": "https://stackoverflow.com/users/3675367/nausika"}, "edited": false, "score": 0, "creation_date": 1423058924, "post_id": 28258198, "comment_id": 44994627, "body": "Thanks for the details. The function <code>mapAccumL</code> is excatly what I was looking for! Why do you say that scans and mapAccum are broken?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 101, "user_id": 3675367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160781f2227e937225d258d2f97a86c5?s=128&d=identicon&r=PG&f=1", "display_name": "Nausika", "link": "https://stackoverflow.com/users/3675367/nausika"}, "edited": false, "score": 0, "creation_date": 1423068990, "post_id": 28258198, "comment_id": 45001612, "body": "@Nausika, <code>mapAccumL</code> is not really broken, per se, but the fact that it returns the final value of the accumulator along with the list keeps it from working as well as it otherwise could with the list fusion optimizations. <code>scanl</code> is broken because it starts the list off with the initial accumulator value. The biggest problem with this, probably, is that it can&#39;t be defined for general <code>Traversable</code> types. It also makes some other thing a bit awkward, as I recall."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1422826166, "last_edit_date": 1592644375, "creation_date": 1422751213, "answer_id": 28258198, "question_id": 28256830, "link": "https://stackoverflow.com/questions/28256830/apply-a-function-to-every-second-element-in-a-list/28258198#28258198", "title": "Apply a function to every second element in a list", "body": "<p>Here's how I would probably do it:</p>\n<pre><code>mapToEverySecond f xs = foldr go (`seq` []) xs False\n  where\n    go x cont !mapThisTime =\n      (if mapThisTime then f x else x) : cont (not mapThisTime)\n</code></pre>\n<p>But if I were writing library code, I'd probably wrap that up in a <code>build</code> form.</p>\n<h3>Edit</h3>\n<p>Yes, this can also be done using <code>mapAccumL</code> or <code>traverse</code>.</p>\n<pre><code>import Control.Applicative\nimport Control.Monad.Trans.State.Strict\nimport Data.Traversable (Traversable (traverse), mapAccumL)\n\nmapToEverySecond :: Traversable t =&gt; (a -&gt; a) -&gt; t a -&gt; t a\n-- Either\nmapToEverySecond f = snd . flip mapAccumL False\n (\\mapThisTime x -&gt;\n     if mapThisTime\n     then (False, f x)\n     else (True, x))\n\n-- or\nmapToEverySecond f xs = evalState (traverse step xs) False\n  where\n    step x = do\n      mapThisTime &lt;- get\n      put (not mapThisTime)\n      if mapThisTime then return (f x) else return x\n</code></pre>\n<p>Or you can do it with <code>scanl</code>, which I'll leave for you to figure out.</p>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1422780312, "post_id": 28260763, "comment_id": 44879075, "body": "Is this actually an optimization, or just saving characters? You don&#39;t explicitly pass the <code>f</code> to recursive calls anymore, but I think it&#39;s still implicitly passed around just as much by the closure-creating machinery."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1422871991, "post_id": 28260763, "comment_id": 44905360, "body": "@amalloy It is an optimization. MartinHaTh&#39;s function is recursive, which means it won&#39;t be inlined by GHC. But this <code>func</code> isn&#39;t (only <code>loop</code> is), so <code>func f</code> will be inlined, which also enables further potential optimizations. See also <a href=\"http://stackoverflow.com/q/9658438/1333025\">Can GHC really never inline map, scanl, foldr, etc.?</a>."}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 0, "last_activity_date": 1422778357, "creation_date": 1422778357, "answer_id": 28260763, "question_id": 28256830, "link": "https://stackoverflow.com/questions/28256830/apply-a-function-to-every-second-element-in-a-list/28260763#28260763", "title": "Apply a function to every second element in a list", "body": "<p>This is more a comment to @MartinHaTh's answer. I'd slightly optimize his solution to</p>\n\n<pre><code>func :: (a -&gt; a) -&gt; [a] -&gt; [a]\nfunc f = loop\n  where\n    loop []  = []\n    loop [x] = [x]\n    loop (x:s:xs) = x : f s : loop xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23895, "user_id": 472416, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa78d79fb4238d200e26fb87e3de947b?s=128&d=identicon&r=PG", "display_name": "utdemir", "link": "https://stackoverflow.com/users/472416/utdemir"}, "is_accepted": false, "score": 4, "last_activity_date": 1422821374, "last_edit_date": 1422821374, "creation_date": 1422820951, "answer_id": 28267231, "question_id": 28256830, "link": "https://stackoverflow.com/questions/28256830/apply-a-function-to-every-second-element-in-a-list/28267231#28267231", "title": "Apply a function to every second element in a list", "body": "<pre><code>mapToEverySecond = zipWith ($) (cycle [id, (*2)])\n</code></pre>\n\n<p>Is the smallest I can think of, also looks pretty clear in my opinion. It also <em>kinda</em> scales with every <em>n</em>th.</p>\n\n<p>Edit: Oh, people already suggested it in comments. I don't want to steal it, but I really think this is the answer.</p>\n"}, {"tags": [], "owner": {"reputation": 52258, "user_id": 375232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h3OwD.png?s=128&g=1", "display_name": "Landei", "link": "https://stackoverflow.com/users/375232/landei"}, "is_accepted": false, "score": 0, "last_activity_date": 1422885946, "last_edit_date": 1422885946, "creation_date": 1422885601, "answer_id": 28279409, "question_id": 28256830, "link": "https://stackoverflow.com/questions/28256830/apply-a-function-to-every-second-element-in-a-list/28279409#28279409", "title": "Apply a function to every second element in a list", "body": "<p>Not very elegant, but this is my take:</p>\n\n<pre><code>mapToEverySecond f = reverse . fst . foldl' cmb ([], False) where\n    cmb (xs, b) x = ((if b then f else id) x : xs, not b)\n</code></pre>\n\n<p>Or improving on MartinHaTh's answer:</p>\n\n<pre><code>mapToEverySecond f (x : x' : xs) = x : f x' : mapToEverySecond f xs\nmapToEverySecond _ xs = xs\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 3675367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160781f2227e937225d258d2f97a86c5?s=128&d=identicon&r=PG&f=1", "display_name": "Nausika", "link": "https://stackoverflow.com/users/3675367/nausika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2187, "favorite_count": 0, "accepted_answer_id": 28258023, "answer_count": 6, "score": 6, "last_activity_date": 1422886070, "creation_date": 1422740434, "last_edit_date": 1422752692, "question_id": 28256830, "link": "https://stackoverflow.com/questions/28256830/apply-a-function-to-every-second-element-in-a-list", "title": "Apply a function to every second element in a list", "body": "<p>I'd like to apply a function to every second element in a list:</p>\n\n<pre><code>&gt; mapToEverySecond (*2) [1..10]\n[1,4,3,8,5,12,7,16,9,20] \n</code></pre>\n\n<p>I've written the following function:</p>\n\n<pre><code>mapToEverySecond :: (a -&gt; a) -&gt; [a] -&gt; [a]\nmapToEverySecond f l = map (\\(i,x) -&gt; if odd i then f x else x) $ zip [0..] l\n</code></pre>\n\n<p>This works, but I wonder if there is a more idiomatic way to do things like that.</p>\n"}, {"tags": ["haskell", "generic-programming", "ghc-generics"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1422731222, "post_id": 28255115, "comment_id": 44869072, "body": "Are you sure that&#39;s the error you get with the posted code? What version of ghc are you using? <code>Class</code> and <code>GClass</code> both compile fine for me with ghc 7.8.3, but the <code>GClass</code> instance for <code>:+:</code> fails to compile with different error messages. It&#39;s also useful to include more of the error message; there are three occurrences of <code>from</code> in the code, and the full error message from ghc would tell which of them doesn&#39;t have a the required instance."}], "answers": [{"comments": [{"owner": {"reputation": 222, "user_id": 2051432, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a802810986fbce9e8fcfe7e1deb89652?s=128&d=identicon&r=PG", "display_name": "sgillis", "link": "https://stackoverflow.com/users/2051432/sgillis"}, "edited": false, "score": 0, "creation_date": 1422733746, "post_id": 28255773, "comment_id": 44869863, "body": "Great write up, and this answers my question correctly. Thanks for your help!"}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 5, "last_activity_date": 1422733380, "creation_date": 1422733380, "answer_id": 28255773, "question_id": 28255115, "link": "https://stackoverflow.com/questions/28255115/no-instance-for-generic-f-a-arising-from-a-use-of-from/28255773#28255773", "title": "No instance for (Generic (f a)) arising from a use of `from&#39;", "body": "<p>I presume you are trying to get the constructor names using <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/GHC-Generics.html\" rel=\"noreferrer\"><code>Ghc.Generics</code></a>. Constructor, field, and data type metadata is held in <code>M1</code> nodes. <code>M1</code> nodes are tagged with either <code>D</code>, <code>C</code>, or <code>S</code> to indicate whether they hold datatype, constructor, or selector (field) metadata.</p>\n\n<p>I've simplified your <code>Class</code> and <code>GClass</code> to return the outermost constructor name instead of checking to see if it is a certain name. I'm interpreting <code>Class</code> as the class of types whose values have an outermost constructor with a name.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE DefaultSignatures #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\nimport GHC.Generics\n\ndata Value = One | Two deriving Generic\n\nclass Class a where\n    cname :: a -&gt; String\n    default cname :: (Generic a, GClass (Rep a))\n               =&gt; a -&gt; String\n    cname = gname . from\n\nclass GClass f where\n    gname :: f a -&gt; String\n</code></pre>\n\n<p>We'd like to be able to derive a <code>Class</code> instance for <code>Value</code> and observe that <code>cname One == \"One\"</code> and <code>cname Two == \"Two\"</code>.</p>\n\n<pre><code>instance Class Value    \n\nmain = do\n    print . cname $ One\n    print . cname $ Two\n</code></pre>\n\n<p>We need to implement <code>GClass</code> for three of the representation nodes to be able to do this. The representation for <code>One</code> is:</p>\n\n<pre><code>&gt; from One\nM1 {unM1 = L1 (M1 {unM1 = U1})}\n</code></pre>\n\n<p>The outer <code>M1</code> is an <code>M1 D</code> holding in a dictionary the metadata for the <code>Value</code> datatype. The <code>L1</code> is selecting the first constructor, <code>One</code>. The inner <code>M1</code> is an <code>M1 C</code> holding in a dictionary the metadata for the <code>One</code> constructor. We don't care about anything deeper than it, since that <code>M1</code> represents the outermost constructor.</p>\n\n<p>The most interesting node is the inner <code>M1 C</code> which holds the constructor metadata. We can get the constructor name as long as the metadata implements the <code>Constructor</code> class. The <code>Constructor</code> class includes <code>conName</code> which returns the constructor name given an appropriate proxy, and the appropriate proxy type is designed to looks like the type of <code>M1 C</code>.</p>\n\n<pre><code>conName :: Constructor c =&gt; t    c (f :: * -&gt; *) a -&gt; [Char]\n                            M1 C c  f            p\n</code></pre>\n\n<p>This means we can implement <code>GClass</code> simply for <code>M1 C</code> nodes as long as there's a <code>Constructor</code> instance for the metadata tag <code>c</code></p>\n\n<pre><code>instance (Constructor c) =&gt; GClass (M1 C c f) where\n    gname = conName\n</code></pre>\n\n<p>When we are faced with the choice between two constructors, <code>:+:</code>, we can determine the outermost constructor name if we can determine the outermost constructor name of both constructors.</p>\n\n<pre><code>instance (GClass f, GClass g) =&gt; GClass (f :+: g) where\n    gname (L1 x) = gname x\n    gname (R1 x) = gname x\n</code></pre>\n\n<p>When we are dealing with a metadata node for a datatype, <code>M1 D</code>, we can determine the outermost constructor name when we can determine the outermost constructor name of the representation absent the metadata node.</p>\n\n<pre><code>instance GClass f =&gt; GClass (M1 D c f) where\n    gname (M1 x) = gname x\n</code></pre>\n\n<p>With these three instances we can run our desired code and see that </p>\n\n<pre><code>&gt; cname One\n\"One\"\n&gt; cname Two\n\"Two\"\n</code></pre>\n"}], "owner": {"reputation": 222, "user_id": 2051432, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a802810986fbce9e8fcfe7e1deb89652?s=128&d=identicon&r=PG", "display_name": "sgillis", "link": "https://stackoverflow.com/users/2051432/sgillis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 1, "accepted_answer_id": 28255773, "answer_count": 1, "score": 3, "last_activity_date": 1422733471, "creation_date": 1422729430, "last_edit_date": 1422733471, "question_id": 28255115, "link": "https://stackoverflow.com/questions/28255115/no-instance-for-generic-f-a-arising-from-a-use-of-from", "title": "No instance for (Generic (f a)) arising from a use of `from&#39;", "body": "<p>I'm having issues with finding suitable type constraints for the following code</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE DefaultSignatures #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE FlexibleContexts #-}\nimport GHC.Generics\n\ndata Value = One | Two deriving Generic\n\nclass Class a where\n    cname :: a -&gt; String -&gt; Bool\n    default cname :: (Generic a, GClass (Rep a))\n               =&gt; a -&gt; String -&gt; Bool\n    cname = gname . from\n\nclass GClass f where\n    gname :: f a -&gt; String -&gt; Bool\n\ninstance GClass (f :+: g) where\n    gname (L1 x) s | conName (from x) == s = True\n                   | otherwise             = False\n    gname (R1 x) s | conName (from x) == s = True\n                   | otherwise             = False\n</code></pre>\n\n<p>It fails with</p>\n\n<pre><code>No instance for (Generic (f a)) arising from a use of `from'\n</code></pre>\n\n<p>Adding the constraint to <code>gname</code> like this</p>\n\n<pre><code>instance (Generic (f a)) =&gt; GClass (f :+: g) where\n</code></pre>\n\n<p>fails with</p>\n\n<pre><code>Could not deduce (Generic (f a1)) arising from a use of `from'\nfrom the context (Generic (f a))\n</code></pre>\n\n<p>Edit: The full error message for the full snippet</p>\n\n<pre><code>Generic.hs:19:31:\n    No instance for (Generic (f a)) arising from a use of `from'\n    Possible fix: add an instance declaration for (Generic (f a))\n    In the first argument of `conName', namely `(from x)'\n    In the first argument of `(==)', namely `conName (from x)'\n    In the expression: conName (from x) == s\n\nGeneric.hs:21:31:\n    No instance for (Generic (g a)) arising from a use of `from'\n    Possible fix: add an instance declaration for (Generic (g a))\n    In the first argument of `conName', namely `(from x)'\n    In the first argument of `(==)', namely `conName (from x)'\n    In the expression: conName (from x) == s\n</code></pre>\n\n<p>This is with GHC 7.6.3</p>\n"}, {"tags": ["json", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1422734052, "last_edit_date": 1422734052, "creation_date": 1422727697, "answer_id": 28254843, "question_id": 28254680, "link": "https://stackoverflow.com/questions/28254680/json-output-with-haskell/28254843#28254843", "title": "JSON output with Haskell", "body": "<p>You can have GHC automatically derive a show function for you by adding <code>deriving (Show)</code> to your data declaration, e.g.:</p>\n\n<pre><code>data JSON = ... deriving (Show)\n</code></pre>\n\n<p>As for your code, in order for <code>show ans = \"[\" ++ ans ++ \"]\"</code> to type check <code>ans</code> needs to be a String, but <code>ans</code> has type JSON.</p>\n\n<p>To write your own show function you have to write something like:</p>\n\n<pre><code>instance Show JSON where\n   show (JNum d) = ... code for the JNum constructor ...\n   show (JObj pairs) = ... code for the JObj constructor ...\n   show (JArr arr) = ... code for the JArr constructor ...\n   ...\n</code></pre>\n\n<p>Here <code>d</code> will have type Double, so for the first case you might write:</p>\n\n<pre><code>   show (JNum d) = \"JNum \" ++ show d\n</code></pre>\n\n<p>or however you want to represent a JSON number.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4490870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e9d309394ce2d7029ddfcf9451019d0?s=128&d=identicon&r=PG&f=1", "display_name": "SumYungGai", "link": "https://stackoverflow.com/users/4490870/sumyunggai"}, "edited": false, "score": 0, "creation_date": 1422728483, "post_id": 28254851, "comment_id": 44868307, "body": "How come you wrote  &#39;show (JStr x) = x&#39; rather than &#39;show (JStr x ) = show x &#39;? Thank you"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 41, "user_id": 4490870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e9d309394ce2d7029ddfcf9451019d0?s=128&d=identicon&r=PG&f=1", "display_name": "SumYungGai", "link": "https://stackoverflow.com/users/4490870/sumyunggai"}, "edited": false, "score": 0, "creation_date": 1422728582, "post_id": 28254851, "comment_id": 44868341, "body": "@SumYungGai They both are equivalent. <code>show x</code> will produce <code>String</code> but for <code>JStr s</code> data constructor, <code>s</code> is already a <code>String</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1422734021, "post_id": 28254851, "comment_id": 44869935, "body": "@Sibi Actually, they are not equivalent: if <code>s</code> is a string, <code>show s</code> will add quotes around <code>s</code>, as well as escape any quotes which might be inside <code>s</code>, and any other &quot;special&quot; characters."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1422737320, "post_id": 28254851, "comment_id": 44870928, "body": "@chi Thanks, didn&#39;t know that!"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 1, "last_activity_date": 1422727773, "creation_date": 1422727773, "answer_id": 28254851, "question_id": 28254680, "link": "https://stackoverflow.com/questions/28254680/json-output-with-haskell/28254851#28254851", "title": "JSON output with Haskell", "body": "<p>If you want to write your own instance, you can do something like this:</p>\n\n<pre><code>instance Show JSON where\n  show (JNum x) = show x\n  show (JStr x) = x\n  show (JObj xs) = show xs\n  show (JArr xs) = show xs\n</code></pre>\n\n<p>Note that for <code>JObj</code> and <code>JArr</code> data constructor, the show will use the instance defined for <code>JObj</code> and <code>JArr</code>.</p>\n\n<p>Demo:</p>\n\n<pre><code>\u03bb&gt; JArr[JNum 12, JStr\"bye\", JNum 9, JStr\"hi\"] \n[12.0,bye,9.0,hi]\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4490870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e9d309394ce2d7029ddfcf9451019d0?s=128&d=identicon&r=PG&f=1", "display_name": "SumYungGai", "link": "https://stackoverflow.com/users/4490870/sumyunggai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1555327541, "creation_date": 1422726766, "last_edit_date": 1555327541, "question_id": 28254680, "link": "https://stackoverflow.com/questions/28254680/json-output-with-haskell", "title": "JSON output with Haskell", "body": "<p>I am trying to use the show function and get back output that looks like JSON\nThe type I have to work with is </p>\n\n<pre><code>data JSON = JNum Double\n          | JStr String\n</code></pre>\n\n<p>I am looking for </p>\n\n<p>JNum 12, JStr\"bye\", JNum 9, JStr\"hi\"\nto return</p>\n\n<pre><code>[12, \"bye\", 9, \"hi\"]\n</code></pre>\n\n<p>I have attempted:</p>\n\n<pre><code>instance Show JSON where\n  show ans = \"[\" ++ ans ++ \"]\"\n</code></pre>\n\n<p>but fails with a compile error. \nI have also tried</p>\n\n<pre><code>instance Show JSON where\n  show ans = \"[\" ++ ans ++ intercalate \", \" ++ \"]\"\n</code></pre>\n\n<p>but failed with \"Not in scope: data constructor 'JSON'\nNot sure how to use \"ans\" to represent whatever type JSON receives as input in the ouput, be it a string, double..etc...\nNot very good with Haskell so any hints would be great.</p>\n\n<p>Thx for reading</p>\n"}, {"tags": ["session", "haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 208545, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c949177224405cb00f6b2a956ebf7288?s=128&d=identicon&r=PG", "display_name": "wiz", "link": "https://stackoverflow.com/users/208545/wiz"}, "edited": false, "score": 0, "creation_date": 1422772178, "post_id": 28256864, "comment_id": 44877720, "body": "I, too, expected something like this to work but found no way to access processed current route."}], "tags": [], "owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "is_accepted": false, "score": 2, "last_activity_date": 1422740679, "creation_date": 1422740679, "answer_id": 28256864, "question_id": 28254505, "link": "https://stackoverflow.com/questions/28254505/how-to-disable-sessions-in-yesod-for-a-specific-set-of-urls-or-a-subsite/28256864#28256864", "title": "How to disable sessions in Yesod for a specific set of urls or a subsite?", "body": "<p>All of your points can be modified by overriding the <code>makeSessionBackend</code> method in the Yesod typeclass. Something like</p>\n\n<pre><code>instance Yesod App where\n    makeSessionBackend _ = fmap Just $ defaultClientSessionBackend expireTime filepath\n      where expireTime = 24 * 60\n</code></pre>\n"}], "owner": {"reputation": 491, "user_id": 208545, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c949177224405cb00f6b2a956ebf7288?s=128&d=identicon&r=PG", "display_name": "wiz", "link": "https://stackoverflow.com/users/208545/wiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1422772108, "creation_date": 1422725738, "last_edit_date": 1422772108, "question_id": 28254505, "link": "https://stackoverflow.com/questions/28254505/how-to-disable-sessions-in-yesod-for-a-specific-set-of-urls-or-a-subsite", "title": "How to disable sessions in Yesod for a specific set of urls or a subsite?", "body": "<p>I want to disable sessions for headless API endpoints, but I have to keep them turned on because this service also handles user logins.</p>\n\n<p>However <code>makeSessionBackend</code> doesn't have access to <code>Handler</code> stuff or even current URI, like <code>isAuthorizedSource</code> does.</p>\n\n<p>It appears to me that I should lift Client Session Backend code and sprinkle it with wrappers until the moment I can get at least textual path from that WAI <code>Request</code>.</p>\n\n<p>Isn't there a better way to tell any bakend to ignore some routes like <code>StaticR</code>?</p>\n"}, {"tags": ["haskell", "combobox", "treeview", "gtk", "gtk2hs"], "answers": [{"comments": [{"owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "edited": false, "score": 0, "creation_date": 1422750107, "post_id": 28251927, "comment_id": 44874242, "body": "It works fine for <b>individual ComboBox</b> but not for a <b>combobox in a treeview</b>. Haskell code for individual combobox is in this post [<a href=\"http://stackoverflow.com/q/28258030/3595992]\">stackoverflow.com/q/28258030/3595992]</a>."}], "tags": [], "owner": {"reputation": 2261, "user_id": 1833602, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c3fbb2fac1915098cacb685ba8ca2013?s=128&d=identicon&r=PG", "display_name": "tobias47n9e", "link": "https://stackoverflow.com/users/1833602/tobias47n9e"}, "is_accepted": false, "score": 1, "last_activity_date": 1422711010, "last_edit_date": 1495542511, "creation_date": 1422709574, "answer_id": 28251927, "question_id": 28251150, "link": "https://stackoverflow.com/questions/28251150/gtk-combo-of-pictures-in-a-treeview/28251927#28251927", "title": "gtk : combo of pictures in a treeview", "body": "<p>In PyGobject I came up with this solution. The example is fully functional but requires 2 png files in the same directory. I used two pngs with 100 x 20 pixel format.</p>\n\n<p>The previous example used Gtk.ComboBox.new_with_model_and_entry() and I was missing the set_entry_text_colum() function that has to go with such kind of combobox.</p>\n\n<pre><code>#!/usr/bin/python3\n\nfrom gi.repository import Gtk, Gdk, GdkPixbuf\n\nclass ComboBoxWindow(Gtk.Window):\n\n    def __init__(self):\n        Gtk.Window.__init__(self, title=\"ComboBox Pixbuf Example\")\n\n        self.set_border_width(10)\n\n        store = Gtk.ListStore(str, GdkPixbuf.Pixbuf)\n        solid_line = GdkPixbuf.Pixbuf.new_from_file(\"solid_line.png\")\n        store.append([\"1\", solid_line])\n        dashed_line = GdkPixbuf.Pixbuf.new_from_file(\"dashed_line.png\")\n        store.append([\"2\", dashed_line])\n\n        vbox = Gtk.Box(orientation=Gtk.Orientation.VERTICAL, spacing=6)\n\n        combo = Gtk.ComboBox.new_with_model(store)\n        rend_int = Gtk.CellRendererText()\n        rend_pixbuf = Gtk.CellRendererPixbuf()\n        combo.pack_start(rend_int, False)\n        combo.add_attribute(rend_int, \"text\", 0)\n        combo.pack_start(rend_pixbuf, True)\n        combo.add_attribute(rend_pixbuf, \"pixbuf\", 1)\n        combo.connect(\"changed\", self.on_combo_changed)\n\n        vbox.pack_start(combo, False, False, 0)\n\n        self.add(vbox)\n\n    def on_combo_changed(self, combo):\n        tree_iter = combo.get_active_iter()\n        if tree_iter != None:\n            model = combo.get_model()\n            row = model[tree_iter][0]\n            print(\"Selected row {0}\".format(row))\n\nwin = ComboBoxWindow()\nwin.connect(\"delete-event\", Gtk.main_quit)\nwin.show_all()\nGtk.main()\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/4G06s.png\" alt=\"enter image description here\"></p>\n\n<p>Similar question:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/27745585/show-icon-or-color-in-gtk-treeview-tree\">Show icon or color in Gtk TreeView tree</a></li>\n</ul>\n\n<p>Source:</p>\n\n<ul>\n<li><a href=\"http://python-gtk-3-tutorial.readthedocs.org/en/latest/combobox.html\" rel=\"nofollow noreferrer\">http://python-gtk-3-tutorial.readthedocs.org/en/latest/combobox.html</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 1798586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1c9008ee67a450ada765469e3b8d66?s=128&d=identicon&r=PG", "display_name": "Sergey  Stretovich", "link": "https://stackoverflow.com/users/1798586/sergey-stretovich"}, "is_accepted": false, "score": 0, "last_activity_date": 1596902564, "last_edit_date": 1596902564, "creation_date": 1596899941, "answer_id": 63317021, "question_id": 28251150, "link": "https://stackoverflow.com/questions/28251150/gtk-combo-of-pictures-in-a-treeview/63317021#63317021", "title": "gtk : combo of pictures in a treeview", "body": "<p>This is my solution in Haskell:</p>\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.String\nimport Graphics.UI.Gtk\nimport qualified Data.Map as Map\nimport qualified Data.Text as T\nimport Data.Maybe\nimport qualified Graphics.UI.Gtk.Gdk.Pixbuf as Pixbuf\nimport Control.Monad\n\ncolorsRawL = [(0,0,0),(254,26,89),(255,0,0),(0,255,0),(0,0,255),(255,255,0),(0,255,255),(255,0,255),(192,192,192),(128,128,128),(128,0,0),(128,128,0),(0,128,0),(128,0,128),(0,128,128),(0,0,128)]\nmanufacturers = [(&quot;Sony&quot;::String), (&quot;LG&quot;::String), (&quot;Panasonic&quot;::String), (&quot;Toshiba&quot;::String), (&quot;Nokia&quot;::String), (&quot;Samsung&quot;::String)]\n\ndata ListElement = ListElement { name :: String   ,   selected::Pixbuf  }\n\ngetManufacturers::IO[ListElement]\ngetManufacturers = mapM (\\x -&gt; do \n                             pbn &lt;- Pixbuf.pixbufNew ColorspaceRgb False 8 16 16\n                             Pixbuf.pixbufFill pbn 255 255 255 1 \n                             let el = ListElement x pbn\n                             return el                            \n                           ) manufacturers\n     \npixBufListS::IO [(String,Pixbuf)]\npixBufListS =   mapM (\\(r,g,b)-&gt; do \n                             pbn &lt;- Pixbuf.pixbufNew ColorspaceRgb False 8 16 16\n                             Pixbuf.pixbufFill pbn r g b 1 \n                             let name::String = (&quot;Color (&quot;++(show r)++&quot; &quot;++(show g)++&quot; &quot;++(show b)++  &quot;)&quot;)                             \n                             return (name,pbn)                            \n                           ) colorsRawL\n\ngetMap::IO (Map.Map String Pixbuf)\ngetMap = do\n    list &lt;- pixBufListS\n    let mp = Map.fromList list\n    return mp\n\nmain :: IO ()   \nmain = do    \n    initGUI\n    window  &lt;- windowNew\n    fixed &lt;- fixedNew\n    \n    pixList &lt;-pixBufListS\n\n    manus &lt;- getManufacturers\n    lststoreManus::(ListStore ListElement) &lt;- listStoreNew manus\n\n    treeview &lt;- treeViewNew\n    treeViewSetModel treeview lststoreManus\n    treeViewSetHeadersVisible treeview True\n\n    colName &lt;- treeViewColumnNew\n    imgCol &lt;- treeViewColumnNew\n    colCombo &lt;- treeViewColumnNew\n    treeViewColumnSetTitle imgCol (&quot;Image column&quot;::T.Text  )\n    treeViewColumnSetTitle colName (&quot;String column&quot;::T.Text  )\n    treeViewColumnSetTitle colCombo (&quot;Combo&quot;::T.Text  )\n\n    iconRenderer &lt;- cellRendererPixbufNew\n    renderer1 &lt;- cellRendererTextNew\n    comboRenderer &lt;- cellRendererComboNew\n\n    cellLayoutPackStart imgCol iconRenderer True\n    cellLayoutPackStart colName renderer1 True\n    cellLayoutPackStart colCombo comboRenderer True\n    \n    cellLayoutSetAttributes imgCol iconRenderer lststoreManus $  (\\ListElement { selected = t } -&gt; [cellPixbuf := t])\n    cellLayoutSetAttributes colName renderer1 lststoreManus $ \\row -&gt; [ cellText := name row ]\n\n    cellLayoutSetAttributeFunc colCombo comboRenderer lststoreManus $ \n        (\\iter -&gt; do (tmodel, colid) &lt;- comboTextModel \n                     (ListElement a b) &lt;- treeModelGetRow lststoreManus iter\n                     set comboRenderer [ cellVisible        := True\n                                       , cellComboTextModel := (tmodel, colid)\n                                       , cellTextEditable   := True\n                                       , cellComboHasEntry  := False\n                                       , cellText           := (&quot;Choose pixbuf&quot;::String)])  \n\n    treeViewAppendColumn treeview colName\n    treeViewAppendColumn treeview imgCol\n    treeViewAppendColumn treeview colCombo\n\n    _ &lt;- on comboRenderer editingStarted $ \\widget treepath -&gt; do\n     case treepath of\n      [k] -&gt; do       \n        let comboPix::ComboBox = castToComboBox widget\n        \n        lststorerep::(ListStore (String,Pixbuf)) &lt;- listStoreNew pixList\n        customStoreSetColumn lststorerep (makeColumnIdString 0) fst\n        customStoreSetColumn lststorerep (makeColumnIdPixbuf 1) snd\n      \n        comboBoxSetModel comboPix (Just lststorerep)\n        rendertxt &lt;- cellRendererTextNew\n        renderpic &lt;- cellRendererPixbufNew\n     \n        cellLayoutPackStart  comboPix rendertxt False\n        cellLayoutPackStart  comboPix renderpic True\n        cellLayoutAddColumnAttribute comboPix renderpic cellPixbuf $ makeColumnIdPixbuf 1\n       \n    _ &lt;- on comboRenderer edited $ \\_treePath newStringValue -&gt; do\n        case _treePath of\n          [k] -&gt; do\n           (ListElement a b) &lt;- listStoreGetValue lststoreManus k\n           myMap &lt;- getMap\n           let finded = fromJust ( Map.lookup newStringValue myMap  )\n           let toStore = ListElement a finded\n           listStoreSetValue lststoreManus k toStore\n           putStrLn $ &quot;new value: &quot; ++ newStringValue  \n   \n    fixedPut fixed treeview (10,10)\n    widgetSetSizeRequest  treeview 500 100\n\n    containerAdd window fixed\n    onDestroy window mainQuit\n    windowSetDefaultSize window 600 500\n    windowSetPosition window WinPosCenter\n    widgetShowAll window\n    mainGUI\n\ncomboTextModel = do store &lt;- listStoreNew []\n                    let column = makeColumnIdString 0 :: ColumnId String String\n                    return (store, column)\n\n{-\ndependencies :\n- base &gt;= 4.7 &amp;&amp; &lt; 5\n- gtk\n- text\n- containers\n-}\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/vLBeT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vLBeT.png\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1596902564, "creation_date": 1422704220, "question_id": 28251150, "link": "https://stackoverflow.com/questions/28251150/gtk-combo-of-pictures-in-a-treeview", "title": "gtk : combo of pictures in a treeview", "body": "<p>I'm trying to make a combo box of pictures (as bellow) inside a treeview cell to make a selection.</p>\n\n<p><img src=\"https://i.stack.imgur.com/agLTj.png\" alt=\"enter image description here\"></p>\n\n<p>I tried to use a <code>cellRendererComboNew</code> to render the combo but the options to fill the combobox <code>cellComboTextModel :=</code> work only for <code>String</code> and I can't render pictures.</p>\n\n<p>I tried to use a <code>cellRendererPixbufNew</code>. It render images but I can't perform a selection on it.</p>\n\n<p>What is the correct approach to make that?</p>\n\n<p>An example in Haskell, Python, or in any language would be very helpfull.</p>\n\n<p>Best regards.</p>\n"}, {"tags": ["function", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 3071121, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/0018531cae1d120c3238691a2c67a3c3?s=128&d=identicon&r=PG&f=1", "display_name": "user3071121", "link": "https://stackoverflow.com/users/3071121/user3071121"}, "edited": false, "score": 0, "creation_date": 1422691744, "post_id": 28249514, "comment_id": 44858870, "body": "How does the returned function know about <code>11</code>? Does it store <code>11</code> in its memory &amp; then take <code>2</code> as arguments of it."}, {"owner": {"reputation": 4742, "user_id": 955926, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5313fc53e1b61d0e45bf11c5bd3608a4?s=128&d=identicon&r=PG", "display_name": "Gary Fixler", "link": "https://stackoverflow.com/users/955926/gary-fixler"}, "edited": false, "score": 1, "creation_date": 1422696688, "post_id": 28249514, "comment_id": 44859879, "body": "The returned function is a <a href=\"http://en.wikipedia.org/wiki/Closure_%28computer_programming%29\" rel=\"nofollow noreferrer\">closure</a> that captures the 11 at the time of its creation, care of <a href=\"http://en.wikipedia.org/wiki/Scope_%28computer_science%29#Lexical_scoping\" rel=\"nofollow noreferrer\">lexical scoping</a>."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1422711856, "post_id": 28249514, "comment_id": 44863538, "body": "Note also that one of the most basic optimizations GHC does is not bothering to make an intermediate closure if it&#39;s going to be used only for immediate application to a known argument."}], "tags": [], "owner": {"reputation": 23895, "user_id": 472416, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa78d79fb4238d200e26fb87e3de947b?s=128&d=identicon&r=PG", "display_name": "utdemir", "link": "https://stackoverflow.com/users/472416/utdemir"}, "is_accepted": false, "score": 8, "last_activity_date": 1422691047, "creation_date": 1422691047, "answer_id": 28249514, "question_id": 28249389, "link": "https://stackoverflow.com/questions/28249389/passing-2-arguments-to-a-function-in-haskell/28249514#28249514", "title": "passing 2 arguments to a function in Haskell", "body": "<p>In Haskell, everything is a value,</p>\n\n<pre><code>add x y = x + y\n</code></pre>\n\n<p>is just a syntactic sugar of:</p>\n\n<pre><code>add = \\x -&gt; \\y -&gt; x + y\n</code></pre>\n\n<p>For more information: <a href=\"https://wiki.haskell.org/Currying\" rel=\"noreferrer\">https://wiki.haskell.org/Currying</a> :</p>\n\n<blockquote>\n  <p>In Haskell, all functions are considered curried: That is, all functions > in Haskell take just single arguments.</p>\n  \n  <p>This is mostly hidden in notation, and so may not be apparent to a new\n  Haskeller. Let's take the function</p>\n  \n  <p><code>div :: Int -&gt; Int -&gt; Int</code></p>\n  \n  <p>which performs integer division. The expression div 11 2\n  unsurprisingly evaluates to 5. But there's more that's going on than\n  immediately meets the untrained eye. It's a two-part process. First,</p>\n  \n  <p><code>div 11</code></p>\n  \n  <p>is evaluated and returns a function of type</p>\n  \n  <p><code>Int -&gt; Int</code></p>\n  \n  <p>Then that resulting function is applied to the value 2, and yields 5.\n  You'll notice that the notation for types reflects this: you can read</p>\n  \n  <p><code>Int -&gt; Int -&gt; Int</code></p>\n  \n  <p>incorrectly as \"takes two Ints and returns an Int\", but what it's\n  really saying is \"takes an Int and returns something of the type Int\n  -> Int\" -- that is, it returns a function that takes an Int and returns an Int. (One can write the type as Int x Int -> Int if you\n  really mean the former -- but since all functions in Haskell are\n  curried, that's not legal Haskell. Alternatively, using tuples, you\n  can write (Int, Int) -> Int, but keep in mind that the tuple\n  constructor (,) itself can be curried.)</p>\n</blockquote>\n"}], "owner": {"reputation": 375, "user_id": 3071121, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/0018531cae1d120c3238691a2c67a3c3?s=128&d=identicon&r=PG&f=1", "display_name": "user3071121", "link": "https://stackoverflow.com/users/3071121/user3071121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9624, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1422691047, "creation_date": 1422689842, "question_id": 28249389, "link": "https://stackoverflow.com/questions/28249389/passing-2-arguments-to-a-function-in-haskell", "title": "passing 2 arguments to a function in Haskell", "body": "<p>In Haskell, I know that if I define a function like this <code>add x y = x + y</code><br>\nthen I call like this <code>add e1 e2</code>. that call is equivalent to <code>(add e1) e2</code><br>\nwhich means that applying <code>add</code> to one argument <code>e1</code> yields a new function which is then applied to the second argument <code>e2</code>.</p>\n\n<p>That's what I don't understand in Haskell. in other languages (like Dart), to do the task above, I would do this</p>\n\n<pre><code>add(x) {\n  return (y) =&gt; x + y;\n}\n</code></pre>\n\n<p>I have to explicitly <code>return</code> a function. So does the part \"yields a new function which is then applied to the second argument\" automatically do underlying in Haskell? If so, what does that \"hiding\" function look like? Or I just missunderstand Haskell?</p>\n"}, {"tags": ["haskell", "optimization", "random", "ghc"], "comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1422681092, "post_id": 28248370, "comment_id": 44857041, "body": "Constant memory usage? With Haskell? I never heard about that since pretty much anything in Haskell allocs. I guess that is part of the point, actually... also, I think there is no -O3, only -O2. Also, make sure to have <code>-fforce-recomp</code>."}, {"owner": {"reputation": 2875, "user_id": 2299477, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/xppB7.jpg?s=128&g=1", "display_name": "Alaya", "link": "https://stackoverflow.com/users/2299477/alaya"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1422682103, "post_id": 28248370, "comment_id": 44857206, "body": "Well... I heard that if I compile with <code>-O2</code>, tail call would be optimized, so I guess that I might get constant memory usage..."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1422682903, "post_id": 28248370, "comment_id": 44857341, "body": "You can safely count on the tail call optimization and the function will not grow a stack. That way, if you, for example, write a function that does nothing but add numbers together, then I guess that function will get constant memory usage. But as soon as you do anything inside it that needs allocation (which is pretty much anything in Haskell), you have to pay for it. That is my guess, though - I find it very unlikely that you can get an actual constant memory Haskell program, but I might be wrong."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1422687175, "post_id": 28248370, "comment_id": 44858062, "body": "Make your accumulator strict."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 2, "creation_date": 1422728521, "post_id": 28248370, "comment_id": 44868321, "body": "@Viclib In my experience it&#39;s almost very common to optimize loops so that they&#39;ll run in constant space if you&#39;re being lazy. See the <code>means</code> example in Real World Haskell over <a href=\"http://book.realworldhaskell.org/read/profiling-and-optimization.html\" rel=\"nofollow noreferrer\">here</a>. The tail-recursive and strictly accumulated version runs in constant space."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1422731470, "post_id": 28248370, "comment_id": 44869147, "body": "@Viclib Constant space doesn&#39;t mean &quot;no allocation&quot;. It just means that memory is freed as quickly as it is allocated."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1424633253, "creation_date": 1424633253, "answer_id": 28662247, "question_id": 28248370, "link": "https://stackoverflow.com/questions/28248370/how-to-explain-this-profilng-data-of-haskell-random-generator-for-huge-memory-us/28662247#28662247", "title": "How to explain this profilng data of Haskell random generator for huge memory usage and low speed?", "body": "<p>As Daniel Wagner says in the comments, your state accumulator is not strict. First off, try to import <code>Control.Monad.State.Strict</code>. That may itself be enough! Otherwise, you also need to alter <code>myRandGen</code> such that it more thoroughly forces the new generator before replacing it in the state.</p>\n"}], "owner": {"reputation": 2875, "user_id": 2299477, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/xppB7.jpg?s=128&g=1", "display_name": "Alaya", "link": "https://stackoverflow.com/users/2299477/alaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1424633253, "creation_date": 1422680777, "last_edit_date": 1422681889, "question_id": 28248370, "link": "https://stackoverflow.com/questions/28248370/how-to-explain-this-profilng-data-of-haskell-random-generator-for-huge-memory-us", "title": "How to explain this profilng data of Haskell random generator for huge memory usage and low speed?", "body": "<p>I want to profile the speed of Haskell random generator, and my test case is to generate 1000000 double precision random numbers range from zero to one and calculate their sum. here is my code:</p>\n\n<pre><code>import System.Random\nimport System.Environment\nimport Control.Monad.State\nimport Data.Time.Clock\ntype Seed = Int\nintDayTime :: IO Int\nintDayTime = getCurrentTime &gt;&gt;= return.(floor.utctDayTime :: UTCTime-&gt;Int)\nn = 1000000 :: Int\nmain :: IO ()\nmain = do\n    calc &lt;- getArgs &gt;&gt;= return . (read ::(String-&gt;Int)).head\n    seed &lt;- intDayTime \n    let calcit :: Int-&gt;Double \n        calcit 1 = calc1 n seed \n        calcit 2 = calc2 n (mkStdGen seed)\n        calcit _ = error \"error calculating\" \n     in print $ calcit calc\ncalc1 ::Int-&gt;Seed-&gt;Double\ncalc1 n initSeed = \n  let next      :: Seed-&gt;(Double,Seed) -- my simple random number generator, just for test\n      myRandGen :: State Seed Double \n      calc      :: Int-&gt;Int-&gt;Seed-&gt;Double-&gt;Double \n      next seed = let x = (1103515245 * seed + 12345) `mod` 1073741824 in (((fromIntegral x)/1073741824),x)\n      myRandGen = state next \n      calc _ 0 _ r = r\n      calc n c s r = calc n (c-1) ns (r + nv)\n        where (nv,ns) = runState myRandGen s \n     in calc n n initSeed 0\ncalc2 ::Int-&gt;StdGen-&gt;Double\ncalc2 n initSeed = \n    let myRandGen :: State StdGen Double \n        calc      :: Int-&gt;Int-&gt;StdGen-&gt;Double-&gt;Double \n        next      :: StdGen-&gt;(Double,StdGen)\n        next gen  = randomR (0,1) gen\n        myRandGen = state next\n        calc _ 0 _ r = r\n        calc n c s r = calc n (c-1) ns (r + nv)\n          where (nv,ns) = runState myRandGen s \n       in calc n n initSeed 0\n</code></pre>\n\n<p>and I compile the code with </p>\n\n<pre><code>ghc profRandGen.hs -O3 -prof -fprof-auto -rtsopts\n</code></pre>\n\n<p>run with </p>\n\n<pre><code>./profRandGen.exe 1 +RTS -o # for calc1\n./profRandGen.exe 2 +RTS -o # for calc2\n</code></pre>\n\n<p>and the profiling data for calc1 is </p>\n\n<pre><code>total time  =        0.10 secs   (105 ticks @ 1000 us, 1 processor)\ntotal alloc = 128,121,344 bytes  (excludes profiling overheads)\n</code></pre>\n\n<p>profiling data for calc1 is </p>\n\n<pre><code>total time  =        1.48 secs   (1479 ticks @ 1000 us, 1 processor)\ntotal alloc = 2,008,077,560 bytes  (excludes profiling overheads)\n</code></pre>\n\n<p>I can understand that the random generator in <code>System.Random</code>would be slower, but why would it be slower so much and why would it allocating much more memory?</p>\n\n<p>I used <strong>tail recursion</strong> in my code and compiled with <code>-O2 -fforce-recomp</code> option, why didn't I get constant memory usage?</p>\n\n<p>is there anything wrong in my code? for example, is it because there being lazy evaluation that tail recursion is not optimized and a lot of memory is allocated? If so,How could this program be further optimized?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1422678853, "post_id": 28247859, "comment_id": 44856678, "body": "I&#39;ve voted to close this question as primarily opinion based since everyone has a language they like best, but if you want to look at functional programming in other languages then I would tell you to start with Python.  There are numerous resources out there for functional programming in Python if you google around for them.  Alternatively, look at Scala as a JVM FP language, it can seamlessly use Java libraries, and still has lots of OOP, but plenty of FP mixed in.  If .NET is more of your thing, F# is the top contender.  Like Scala it mixes OOP and FP too."}], "answers": [{"comments": [{"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 1, "creation_date": 1422681850, "post_id": 28248469, "comment_id": 44857171, "body": "By the by, in the last sentence the only thing I&#39;m kidding about is that it&#39;s something negative. Other than that I&#39;m serious; after learning Haskell I really don&#39;t like working in other languages so much (still do if they fit better, of course)."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1422726152, "post_id": 28248469, "comment_id": 44867654, "body": "What does make F# not a functional language ? It has high-order function,currying, Algebric data types etc ..."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1422726793, "post_id": 28248469, "comment_id": 44867846, "body": "@mb14 F# is considered a multi-paradigm programming language, not a FP language (see wiki). It&#39;s not to say it doesn&#39;t have FP construct (it does), it&#39;s to say that it&#39;s just different, mainly for also supporting OO and imperative programming. I&#39;d also say it doesn&#39;t have some vital FP constructs by the way, but that&#39;s not the reason it&#39;s not a functional language. You might also want to check the very first few minutes in this <a href=\"https://www.youtube.com/watch?v=pOl4E8x3fmw#t=25\" rel=\"nofollow noreferrer\">lecture</a> by Eric Meijer, he refers specifically to F# on this matter; it&#39;s in an amusing tone but the point is valid."}], "tags": [], "owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "is_accepted": true, "score": 4, "last_activity_date": 1422700189, "last_edit_date": 1422700189, "creation_date": 1422681725, "answer_id": 28248469, "question_id": 28247859, "link": "https://stackoverflow.com/questions/28247859/learning-functional-programming-after-other-programming-paradigms/28248469#28248469", "title": "Learning functional programming after other programming paradigms", "body": "<p>It's probably varies with people (and this question is bound to get closed over that), but the way I see it: there isn't a stair you need to step on before you can be within reach to Haskell.</p>\n\n<p>So I'd say you're not driven temporarily off necessarily by the language, but by your sources of learning. For the only truly gentle introduction, I recommend <a href=\"http://learnyouahaskell.com\" rel=\"nofollow\">LYAH</a>. It keeps things within reasonable difficulty and it has some really entertaining points every now and then.</p>\n\n<p>However, if you still want to almost-soften your transition, you can check out F# which isn't a functional language but it will give you a good taste of FP, and it will be very familiar to you because you still live in an OO world.<br />\nYou can also check out basically any other functional language and it will give you some of the mindset (Scala, ML, etc.).</p>\n\n<p>Keep in mind that I say \"almost-soften\", because Haskell is very different (especially because of purity), and that gives you a very logical and mathematical mindset to things and that has been very different for me than any other language I learned. It's incredible. It was much beyond learning different syntax, it's a way to think about things and I can always find myself learning more and a truly amazing part of it is that (since it's so logical, mathematical, reasonable, etc.) the new ways of thinking I acquire with Haskell don't leave me both when I use other languages and even in my personal daily life.</p>\n\n<p>That being said, the only thing truly horrible with Haskell is that it ruined me for other languages. I used to like C#... :(</p>\n"}], "owner": {"reputation": 504, "user_id": 2628694, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t2Coc.jpg?s=128&g=1", "display_name": "David Corbin", "link": "https://stackoverflow.com/users/2628694/david-corbin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "closed_date": 1422683089, "accepted_answer_id": 28248469, "answer_count": 1, "score": 0, "last_activity_date": 1422700189, "creation_date": 1422675077, "question_id": 28247859, "link": "https://stackoverflow.com/questions/28247859/learning-functional-programming-after-other-programming-paradigms", "closed_reason": "Opinion-based", "title": "Learning functional programming after other programming paradigms", "body": "<p>I have taught myself C, Python, Java and a few other procedural or object oriented languages to an intermediate degree from resouces on the internet (thanks SO :D) and in books. When I tried to learn Haskell, I couldn't wrap my head around what the code actually did. </p>\n\n<p>Is there a better functional language for someone coming from a background in procedural or object oriented programming to learn? Are there any resources meant for people in my situation? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1422675526, "post_id": 28247832, "comment_id": 44856211, "body": "An associated type family is only different in that the compiler expects 1 or more type instances in every class instance. When the docs says &quot;the same functionality&quot;, it means that the semantics are identical for the same declarations, but you still have to place declarations in the correct place. The purpose of &quot;associating&quot; the type family is to remind implementers that they must define that type instance."}], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1422681026, "post_id": 28247927, "comment_id": 44857027, "body": "The right kind is inferred for the associated type family because it has the additional type information present in the functions which use the type family, and the type <code>a</code> from the class declaration. For example it sees <code>a Int</code> must be a valid type of kind <code>*</code>, from which you can infer that <code>a :: * -&gt; *</code>. If the type family is not associated, the compiler will obviously not have access to that information, so it gives the type family the default type: <code>* -&gt; *</code>."}, {"owner": {"reputation": 1178, "user_id": 1940209, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/247799acb8cb63c48d278c09eb455283?s=128&d=identicon&r=PG", "display_name": "aavogt", "link": "https://stackoverflow.com/users/1940209/aavogt"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1422754500, "post_id": 28247927, "comment_id": 44874971, "body": "I don&#39;t agree with <i>the compiler will obviously not have access to that information</i>. It seems to be available in that file, it&#39;s just not used for whatever reason (nobody asked for it, it&#39;s too hard to implement, it would be too confusing to have uses of a type family help determine kinds etc.)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1422767688, "post_id": 28247927, "comment_id": 44877019, "body": "I agree that it isn&#39;t <i>impossible</i> in any sense. I meant more along the lines of, the compiler doesn&#39;t look at the type families&#39; use sites to determine its type; it probably wouldn&#39;t really make sense to do that, especially since the solution is so simple."}], "tags": [], "owner": {"reputation": 1178, "user_id": 1940209, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/247799acb8cb63c48d278c09eb455283?s=128&d=identicon&r=PG", "display_name": "aavogt", "link": "https://stackoverflow.com/users/1940209/aavogt"}, "is_accepted": true, "score": 5, "last_activity_date": 1422675743, "creation_date": 1422675743, "answer_id": 28247927, "question_id": 28247832, "link": "https://stackoverflow.com/questions/28247832/type-families-top-level-vs-associated/28247927#28247927", "title": "Type families: top level vs. associated", "body": "<p>The second one works if you annotate the kind:</p>\n\n<pre><code>type family R (a :: * -&gt; *)\n</code></pre>\n\n<p>I don't think there's any reason why the right kind is only inferred for the associated type family.</p>\n"}], "owner": {"reputation": 949, "user_id": 1017252, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/90e3d67b15c2573bfc3821746de04dc0?s=128&d=identicon&r=PG", "display_name": "Omari Norman", "link": "https://stackoverflow.com/users/1017252/omari-norman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "accepted_answer_id": 28247927, "answer_count": 1, "score": 4, "last_activity_date": 1422675743, "creation_date": 1422674816, "question_id": 28247832, "link": "https://stackoverflow.com/questions/28247832/type-families-top-level-vs-associated", "title": "Type families: top level vs. associated", "body": "<p>I am just starting to learn type families.  The GHC documentation states that top level and associated type families have the same functionality, but the code I am writing behaves differently in top level than it does when the families are associated.  This compiles and runs fine:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\nmodule Test where\n\n-- type family R a\n-- type instance R Maybe = Int\n\nclass C' a where\n  type R a\n  getInt' :: a Int\n  getBool' :: R a -&gt; a Bool\n\ninstance C' Maybe where\n  type R Maybe = Int\n  getInt' = Just 3\n  getBool' i = Just $ i &lt; 10\n\nprinter :: IO ()\nprinter = print $ (getBool' 5 :: Maybe Bool)\n</code></pre>\n\n<p>but this gives me a type error:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\nmodule Test where\n\ntype family R a\ntype instance R Maybe = Int\n\nclass C' a where\n  -- type R a\n  getInt' :: a Int\n  getBool' :: R a -&gt; a Bool\n\ninstance C' Maybe where\n  -- type R Maybe = Int\n  getInt' = Just 3\n  getBool' i = Just $ i &lt; 10\n\nprinter :: IO ()\nprinter = print $ (getBool' 5 :: Maybe Bool)\n</code></pre>\n\n<p>These look identical to me; why is it that one compiles and the other doesn't?</p>\n"}, {"tags": ["haskell", "phantom-types"], "answers": [{"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1422677083, "post_id": 28247968, "comment_id": 44856442, "body": "Thank you - quite helpful. When you mentioned, <code>Hence, we can create smart constructors for Expr as follows:</code>, does that mean that you&#39;d still keep <code>data Expr a = Expr Int | ...</code>, but you would not expose their constructors? What&#39;s to prevent someone from still using the &quot;non-smart&quot; constructor?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 1, "creation_date": 1422678725, "post_id": 28247968, "comment_id": 44856665, "body": "Yes, the data declaration is kept intact but the constructors are not exported, <code>module MyModule (Expr(), number, boolean, increment, not) where</code>. This prevents people from using the actual constructors directly forcing them to use the smart constructors. Note that it also means that people won&#39;t be able to pattern match. Hence, you&#39;ll need to provide some way to allow them to deconstruct the data as well."}, {"owner": {"reputation": 31189, "user_id": 1097780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f01ad795c29c3d05ad26ee47ea6069?s=128&d=identicon&r=PG", "display_name": "Andreas Rossberg", "link": "https://stackoverflow.com/users/1097780/andreas-rossberg"}, "edited": false, "score": 16, "creation_date": 1422691790, "post_id": 28247968, "comment_id": 44858875, "body": "While this sounds like a nice explanation, it is wrong, unfortunately. Your answer is confusing phantom types with GADTs. To be clear, a phantom type is a type that has <i>no values</i> associated with it. Consequently, in a data type, a phantom type parameter is one that is not used by <i>any</i> constructor. There is no such thing as a &quot;phantom constructor&quot;."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 31189, "user_id": 1097780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f01ad795c29c3d05ad26ee47ea6069?s=128&d=identicon&r=PG", "display_name": "Andreas Rossberg", "link": "https://stackoverflow.com/users/1097780/andreas-rossberg"}, "edited": false, "score": 1, "creation_date": 1422710309, "post_id": 28247968, "comment_id": 44863147, "body": "@AndreasRossberg I am glad that I learned something new today. =)"}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": false, "score": 16, "last_activity_date": 1422676144, "creation_date": 1422676144, "answer_id": 28247968, "question_id": 28247543, "link": "https://stackoverflow.com/questions/28247543/motivation-behind-phantom-types/28247968#28247968", "title": "Motivation behind Phantom Types?", "body": "<p>The motivation behind using phantom types is to specialize the return type of data constructors. For example, consider:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data List a = Nil | Cons a (List a)\n</code></pre>\n\n<p>The return type of both <code>Nil</code> and <code>Cons</code> is <code>List a</code> by default (which is generalized for all lists of type <code>a</code>).</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Nil  ::                List a\nCons :: a -&gt; List a -&gt; List a\n                       |____|\n                          |\n                    -- return type is generalized\n</code></pre>\n\n<p>Also note that <code>Nil</code> is a phantom constructor (i.e. its return type doesn't depend upon its arguments, vacuously in this case, but nonetheless the same).</p>\n\n<p>Because <code>Nil</code> is a phantom constructor we can specialize <code>Nil</code> to any type we want (e.g. <code>Nil :: List Int</code> or <code>Nil :: List Char</code>).</p>\n\n<hr>\n\n<p>Normal algebraic data types in Haskell allow you to choose the type of the arguments of a data constructor. For example, we chose the type of arguments for <code>Cons</code> above (<code>a</code> and <code>List a</code>).</p>\n\n<p>However, it doesn't allow you to choose the return type of a data constructor. The return type is always generalized. This is fine for most cases. However, there are exceptions. For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Expr a = Number     Int\n            | Boolean    Bool\n            | Increment (Expr Int)\n            | Not       (Expr Bool)\n</code></pre>\n\n<p>The type of the data constructors are:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Number    :: Int       -&gt; Expr a\nBoolean   :: Bool      -&gt; Expr a\nIncrement :: Expr Int  -&gt; Expr a\nNot       :: Expr Bool -&gt; Expr a\n</code></pre>\n\n<p>As you can see, the return type of all the data constructors are generalized. This is problematic because we know that <code>Number</code> and <code>Increment</code> must always return an <code>Expr Int</code> and <code>Boolean</code> and <code>Not</code> must always return an <code>Expr Bool</code>.</p>\n\n<p>The return types of the data constructors are wrong because they are too general. For example, <code>Number</code> cannot possibly return an <code>Expr a</code> but yet it does. This allows you to write wrong expressions which the type checker won't catch. For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Increment (Boolean False) -- you shouldn't be able to increment a boolean\nNot       (Number  0)     -- you shouldn't be able to negate a number\n</code></pre>\n\n<p>The problem is that we can't specify the return type of data constructors.</p>\n\n<hr>\n\n<p>Notice that all the data constructors of <code>Expr</code> are phantom constructors (i.e. their return type doesn't depend upon their arguments). A data type whose constructors are all phantom constructors is called a phantom type.</p>\n\n<p>Remember that the return type of phantom constructors like <code>Nil</code> can be specialized to any type we want. Hence, we can create smart constructors for <code>Expr</code> as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>number    :: Int       -&gt; Expr Int\nboolean   :: Bool      -&gt; Expr Bool\nincrement :: Expr Int  -&gt; Expr Int\nnot       :: Expr Bool -&gt; Expr Bool\n\nnumber    = Number\nboolean   = Boolean\nincrement = Increment\nnot       = Not\n</code></pre>\n\n<p>Now we can use the smart constructors instead of the normal constructors and our problem is solved:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>increment (boolean False) -- error\nnot       (number  0)     -- error\n</code></pre>\n\n<p>So phantom constructors are useful when you want to specialize the return type of a data constructor and phantom types are data types whose constructors are all phantom constructors.</p>\n\n<hr>\n\n<p>Note that data constructors like <code>Left</code> and <code>Right</code> are also phantom constructors:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Either a b = Left a | Right b\n\nLeft  :: a -&gt; Either a b\nRight :: b -&gt; Either a b\n</code></pre>\n\n<p>The reason is that although the return type of these data constructors do depend upon their arguments yet they are still generalized because they only partially depend upon their arguments.</p>\n\n<p>Simple way to know if a data constructor is a phantom constructor:</p>\n\n<blockquote>\n  <p>Do all the type variables appearing in the return type of the data constructor also appear in the arguments of the data constructor? If yes, it's not a phantom constructor.</p>\n</blockquote>\n\n<p>Hope that helps.</p>\n"}, {"comments": [{"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1422697888, "post_id": 28250226, "comment_id": 44860184, "body": "@DietrichEpp edited that part to be less ambiguous. I have similar problems when e.g. writing <i>JavaScript</i>, <code>fn.bind(this)</code> - wait <code>bind</code> , huh?"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1434519321, "post_id": 28250226, "comment_id": 49806649, "body": "here I am, reading on SOF, and I just suddenly recognize a familiar face!, thanks for the detailed explanation Oleg!"}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 75, "last_activity_date": 1542724622, "last_edit_date": 1542724622, "creation_date": 1422697419, "answer_id": 28250226, "question_id": 28247543, "link": "https://stackoverflow.com/questions/28247543/motivation-behind-phantom-types/28250226#28250226", "title": "Motivation behind Phantom Types?", "body": "<p>To answer the \"what's the motivation to use a phantom type\". There is two points:</p>\n\n<ul>\n<li>to make invalid states unrepresentable, which is well explained in <a href=\"https://stackoverflow.com/a/28247968/1308058\">Aadit's answer</a></li>\n<li>Carry some of the information on the type level</li>\n</ul>\n\n<p>For example you could have distances tagged by the length unit:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nnewtype Distance a = Distance Double\n  deriving (Num, Show)\n\ndata Kilometer\ndata Mile\n\nmarathonDistance :: Distance Kilometer\nmarathonDistance = Distance 42.195\n\ndistanceKmToMiles :: Distance Kilometer -&gt; Distance Mile\ndistanceKmToMiles (Distance km) = Distance (0.621371 * km)\n\nmarathonDistanceInMiles :: Distance Mile\nmarathonDistanceInMiles = distanceKmToMiles marathonDistance\n</code></pre>\n\n<p>And you can avoid <a href=\"http://en.wikipedia.org/wiki/Mars_Climate_Orbiter#Cause_of_failure\" rel=\"noreferrer\">Mars Climate Orbiter disaster</a>:</p>\n\n<pre><code>&gt;&gt;&gt; marathonDistanceInMiles\nDistance 26.218749345\n\n&gt;&gt;&gt; marathonDistanceInMiles + marathonDistance\n\n&lt;interactive&gt;:10:27:\n    Couldn't match type \u2018Kilometer\u2019 with \u2018Mile\u2019\n    Expected type: Distance Mile\n      Actual type: Distance Kilometer\n    In the second argument of \u2018(+)\u2019, namely \u2018marathonDistance\u2019\n    In the expression: marathonDistanceInMiles + marathonDistance\n</code></pre>\n\n<hr>\n\n<p>There are slight varitions to this \"pattern\". You can use <code>DataKinds</code> to have closed set of units:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE DataKinds #-}\n\ndata LengthUnit = Kilometer | Mile\n\nnewtype Distance (a :: LengthUnit) = Distance Double\n  deriving (Num, Show)\n\nmarathonDistance :: Distance 'Kilometer\nmarathonDistance = Distance 42.195\n\ndistanceKmToMiles :: Distance 'Kilometer -&gt; Distance 'Mile\ndistanceKmToMiles (Distance km) = Distance (0.621371 * km)\n\nmarathonDistanceInMiles :: Distance 'Mile\nmarathonDistanceInMiles = distanceKmToMiles marathonDistance\n</code></pre>\n\n<p>And it will work similarly:</p>\n\n<pre><code>&gt;&gt;&gt; marathonDistanceInMiles\nDistance 26.218749345\n\n&gt;&gt;&gt; marathonDistance + marathonDistance\nDistance 84.39\n\n&gt;&gt;&gt; marathonDistanceInMiles + marathonDistance\n\n&lt;interactive&gt;:28:27:\n    Couldn't match type \u2018'Kilometer\u2019 with \u2018'Mile\u2019\n    Expected type: Distance 'Mile\n      Actual type: Distance 'Kilometer\n    In the second argument of \u2018(+)\u2019, namely \u2018marathonDistance\u2019\n    In the expression: marathonDistanceInMiles + marathonDistance\n</code></pre>\n\n<p>But now the <code>Distance</code> can be only in kilometers or miles, we can't add more units later. That might be useful in some use cases.</p>\n\n<hr>\n\n<p>We could also do:</p>\n\n<pre><code>data Distance = Distance { distanceUnit :: LengthUnit, distanceValue :: Double }\n   deriving (Show)\n</code></pre>\n\n<p>In the distance case we can work out the addition, for example translate to kilometers if different units are involved. But this doesn't work well for <em>currencies</em> which ratio isn't constant over time etc.</p>\n\n<hr>\n\n<p>And it's possible to use GADTs for that instead, which may be simpler approach in some situations:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE StandaloneDeriving #-}\n\ndata Kilometer\ndata Mile\n\ndata Distance a where\n  KilometerDistance :: Double -&gt; Distance Kilometer\n  MileDistance :: Double -&gt; Distance Mile\n\nderiving instance Show (Distance a)\n\nmarathonDistance :: Distance Kilometer\nmarathonDistance = KilometerDistance 42.195\n\ndistanceKmToMiles :: Distance Kilometer -&gt; Distance Mile\ndistanceKmToMiles (KilometerDistance km) = MileDistance (0.621371 * km)\n\nmarathonDistanceInMiles :: Distance Mile\nmarathonDistanceInMiles = distanceKmToMiles marathonDistance\n</code></pre>\n\n<p>Now we know the unit also on the value level:</p>\n\n<pre><code>&gt;&gt;&gt; marathonDistanceInMiles \nMileDistance 26.218749345\n</code></pre>\n\n<hr>\n\n<p>This approach especially greately simplifies <code>Expr a</code> example from <a href=\"https://stackoverflow.com/a/28247968/1308058\">Aadit's answer</a>:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata Expr a where\n  Number     :: Int -&gt; Expr Int\n  Boolean    :: Bool -&gt; Expr Bool\n  Increment  :: Expr Int -&gt; Expr Int\n  Not        :: Expr Bool -&gt; Expr Bool\n</code></pre>\n\n<hr>\n\n<p>It's worth pointing out that the latter variations require non-trivial language extensions (<code>GADTs</code>, <code>DataKinds</code>, <code>KindSignatures</code>), which might not be supported in your compiler. That's might be the case with <em>Mu compiler</em> Don mentions.</p>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 1, "last_activity_date": 1422799969, "creation_date": 1422799969, "answer_id": 28263615, "question_id": 28247543, "link": "https://stackoverflow.com/questions/28247543/motivation-behind-phantom-types/28263615#28263615", "title": "Motivation behind Phantom Types?", "body": "<p>For <code>Ratio D3</code> specifically, we use rich types like that to drive type-directed code, so e.g. if you have a field somewhere at type <code>Ratio D3</code>, its editor is dispatched to a text field accepting numeric entries only and showing a precision of 3 digits. This is in contrast, e.g.,  with <code>newtype Amount = Amount Double</code> where we don't show decimal digits, but use thousand commas and parse input like '10m' as '10,000,000'.</p>\n\n<p>In the underlying representation, both are still just <code>Double</code>s.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7030, "favorite_count": 21, "accepted_answer_id": 28250226, "answer_count": 3, "score": 47, "last_activity_date": 1542724622, "creation_date": 1422671430, "last_edit_date": 1519295327, "question_id": 28247543, "link": "https://stackoverflow.com/questions/28247543/motivation-behind-phantom-types", "title": "Motivation behind Phantom Types?", "body": "<p>Don Stewart's <a href=\"http://web.archive.org/web/20150129012424/http://code.haskell.org/~dons/talks/dons-google-2015-01-27.pdf\" rel=\"noreferrer\">Haskell in the Large</a>'s presentation mentioned <em>Phantom Types</em>:</p>\n\n<pre><code>data Ratio n = Ratio Double\n1.234 :: Ratio D3\n\ndata Ask ccy = Ask Double\nAsk 1.5123 :: Ask GBP\n</code></pre>\n\n<p>I read over his bullet points about them, but I did not understand them. In addition, I read the <a href=\"https://wiki.haskell.org/Phantom_type\" rel=\"noreferrer\">Haskell Wiki</a> on the topic. Yet I still am missing their point.</p>\n\n<p>What's the motivation to use a phantom type?</p>\n"}, {"tags": ["haskell", "case"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1422678468, "post_id": 28247138, "comment_id": 44856626, "body": "Related: <a href=\"http://stackoverflow.com/questions/24700762/or-patterns-in-haskell\" title=\"or patterns in haskell\">stackoverflow.com/questions/24700762/or-patterns-in-haskell</a>"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1422679451, "post_id": 28247138, "comment_id": 44856772, "body": "Related: <a href=\"http://stackoverflow.com/q/27960784/783743\">stackoverflow.com/q/27960784/783743</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1066, "user_id": 1708941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bc1bcf0dc04ab41dd2b10ed73ae5b3c?s=128&d=identicon&r=PG", "display_name": "Kenogu Labz", "link": "https://stackoverflow.com/users/1708941/kenogu-labz"}, "edited": false, "score": 3, "creation_date": 1422667319, "post_id": 28247163, "comment_id": 44854924, "body": "This.  There is no fundamental correlation between the <code>b</code> in each of these constructors; they&#39;re just all coincidentally labeled the same thing."}], "tags": [], "owner": {"reputation": 940, "user_id": 1275256, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5cd12beabbb9d483c03d843cc504e5c0?s=128&d=identicon&r=PG", "display_name": "gxtaillon", "link": "https://stackoverflow.com/users/1275256/gxtaillon"}, "is_accepted": false, "score": 2, "last_activity_date": 1422667264, "creation_date": 1422667264, "answer_id": 28247163, "question_id": 28247138, "link": "https://stackoverflow.com/questions/28247138/haskell-is-there-a-better-way-to-write-case-statements-with-the-same-rhs/28247163#28247163", "title": "Haskell: Is there a better way to write case statements with the same RHS?", "body": "<p>Pattern matching at the function level will help with readability but since these are all differents constructors there is no way to pattern match more than one of them at a time (that I know of).</p>\n\n<pre><code>getB (A b _)    = b\ngetB (Aa b _)   = b\ngetB (Ag b _ _) = b\ngetB (Ae b _ _) = b\ngetB (Ax _)     = somethingElse\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1178, "user_id": 1940209, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/247799acb8cb63c48d278c09eb455283?s=128&d=identicon&r=PG", "display_name": "aavogt", "link": "https://stackoverflow.com/users/1940209/aavogt"}, "is_accepted": false, "score": 1, "last_activity_date": 1422675207, "creation_date": 1422675207, "answer_id": 28247876, "question_id": 28247138, "link": "https://stackoverflow.com/questions/28247138/haskell-is-there-a-better-way-to-write-case-statements-with-the-same-rhs/28247876#28247876", "title": "Haskell: Is there a better way to write case statements with the same RHS?", "body": "<p>If <code>A</code> has a Data instance, you can write</p>\n\n<pre><code>import Data.Data\nmgetB :: A -&gt; Maybe B\nmgetB = gmapQi 0 cast\n</code></pre>\n\n<p>and then define getB in terms of that function</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 4, "last_activity_date": 1422678449, "last_edit_date": 1495541193, "creation_date": 1422678449, "answer_id": 28248133, "question_id": 28247138, "link": "https://stackoverflow.com/questions/28247138/haskell-is-there-a-better-way-to-write-case-statements-with-the-same-rhs/28248133#28248133", "title": "Haskell: Is there a better way to write case statements with the same RHS?", "body": "<p>A feature called \"or patterns\", available in ML, helps a lot with this. Such a feature was <a href=\"https://ghc.haskell.org/trac/ghc/ticket/3919\" rel=\"nofollow noreferrer\">requested</a> for GHC five years ago, but no one appears to have taken on the task of specifying the details and actually implementing it. However, there is a <a href=\"http://hackage.haskell.org/package/OrPatterns\" rel=\"nofollow noreferrer\">package</a> offering a way to do something like this with Template Haskell, as explained in <a href=\"https://stackoverflow.com/questions/24700762/or-patterns-in-haskell/24741660#24741660\">Or-patterns in Haskell</a></p>\n"}, {"tags": [], "owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "is_accepted": false, "score": 1, "last_activity_date": 1422697142, "creation_date": 1422697142, "answer_id": 28250193, "question_id": 28247138, "link": "https://stackoverflow.com/questions/28247138/haskell-is-there-a-better-way-to-write-case-statements-with-the-same-rhs/28250193#28250193", "title": "Haskell: Is there a better way to write case statements with the same RHS?", "body": "<p>At some point you have to say how your <code>B</code>s are contained inside <code>A</code> so you many as well do it once and for all in a general way.</p>\n\n<pre><code>bOrX a = case a of\n    (A b _)         -&gt; B' b\n    (Aa b _)        -&gt; B' b\n    (Ag b _ _)      -&gt; B' b\n    (Ae b _ _)      -&gt; B' b\n    (Ax x)          -&gt; X' x\n</code></pre>\n\n<p>Subsequently you can match all <code>B</code>s at once with very little code.</p>\n\n<pre><code>getB a = case bOrX a of\n  B' b -&gt; b\n  X' _ -&gt; somethingElse\n\nanotherFunctionWithBandX a = case bOrX a of\n  B' b -&gt; f b\n  X' x -&gt; g x\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422743273, "post_id": 28256399, "comment_id": 44872623, "body": "Isn&#39;t  it generally considered poor form to name fields of non-record types? Is it possible to make just the total things?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422744200, "post_id": 28256399, "comment_id": 44872876, "body": "@dfeuer I&#39;m not sure what you mean by a &quot;non-record type&quot;, but if those fields are just accessed through the <code>lens</code> functions, everything should stay nice and total. You could enforce this by not exporting the underscored names."}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": false, "score": 3, "last_activity_date": 1422738293, "last_edit_date": 1422738293, "creation_date": 1422737430, "answer_id": 28256399, "question_id": 28247138, "link": "https://stackoverflow.com/questions/28247138/haskell-is-there-a-better-way-to-write-case-statements-with-the-same-rhs/28256399#28256399", "title": "Haskell: Is there a better way to write case statements with the same RHS?", "body": "<p>You can use a <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-Prism.html\" rel=\"nofollow\"><code>Prism</code></a> and the <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-Fold.html#v:-94--63-\" rel=\"nofollow\"><code>(^?)</code> operator</a> from the <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-Fold.html#v:-94--63-\" rel=\"nofollow\"><code>lens</code> package</a> to make this a little easier:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nimport Control.Lens\n\n-- ...\n\ndata A =\n  A { _b :: B, _d :: D }\n  | Aa { _b :: B, _c :: C }\n  | Ag { _b :: B, _x1 :: X, _x2 :: X }\n  | Ae { _b :: B, _r :: R, _q :: Q }\n  | Ax { _x1 :: X }\n\nmakeLenses ''A\n\ngetB :: A -&gt; B\ngetB a = case a ^? b of\n  Just theB -&gt; theB\n  Nothing   -&gt; somethingElse\n</code></pre>\n\n<p>The call to the Template Haskell function <code>makeLenses</code> takes care of all the boilerplate.</p>\n\n<p><code>lens</code> might be a bit of a heavy dependency if you're only using it for this, but it's something to consider (especially if you are already using <code>lens</code>/considering using <code>lens</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422881300, "post_id": 28277391, "comment_id": 44910453, "body": "This looks just like David Young&#39;s answer, except without adding the <code>lens</code> layer."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1422881699, "post_id": 28277391, "comment_id": 44910641, "body": "My point being that you don&#39;t need Template Haskell plus a large, complex library. It&#39;s just record syntax."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422881798, "post_id": 28277391, "comment_id": 44910681, "body": "Yes, that&#39;s a point. I guess I just think it would make sense to mention the relationship between the two answers, as they&#39;re based on the same concept."}, {"owner": {"reputation": 7308, "user_id": 1299750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d3c17e880be8ed7de5c3904171f432e1?s=128&d=identicon&r=PG", "display_name": "idunnololz", "link": "https://stackoverflow.com/users/1299750/idunnololz"}, "edited": false, "score": 0, "creation_date": 1423091436, "post_id": 28277391, "comment_id": 45013576, "body": "I&#39;m marking this as the answer since this is the actual method I&#39;m using to deal with this issue, but there were a lot of good answers and I have learned a lot. So thanks for all the answers guys :)"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 3, "last_activity_date": 1422878687, "creation_date": 1422878687, "answer_id": 28277391, "question_id": 28247138, "link": "https://stackoverflow.com/questions/28247138/haskell-is-there-a-better-way-to-write-case-statements-with-the-same-rhs/28277391#28277391", "title": "Haskell: Is there a better way to write case statements with the same RHS?", "body": "<p>You can use record syntax to hack get around this:</p>\n\n<pre><code>data A =\n  A {fieldB :: B, fieldC :: C} |\n  Aa {fieldB :: B, fieldX1 :: X, fieldX2 :: X} |\n  Ag {fieldB :: B, fieldR :: R, fieldQ :: Q} |\n  Ax {fieldX :: X}\n\ngetB a = case a of\n  Ax -&gt; somethingElse\n  _  -&gt; fieldB a\n</code></pre>\n\n<p>The key thing is to give <em>the same name</em> to all the fields of type <code>B</code>.</p>\n"}], "owner": {"reputation": 7308, "user_id": 1299750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d3c17e880be8ed7de5c3904171f432e1?s=128&d=identicon&r=PG", "display_name": "idunnololz", "link": "https://stackoverflow.com/users/1299750/idunnololz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "accepted_answer_id": 28277391, "answer_count": 6, "score": 3, "last_activity_date": 1422878687, "creation_date": 1422667035, "question_id": 28247138, "link": "https://stackoverflow.com/questions/28247138/haskell-is-there-a-better-way-to-write-case-statements-with-the-same-rhs", "title": "Haskell: Is there a better way to write case statements with the same RHS?", "body": "<p>Example:</p>\n\n<pre><code>data A =\n  A B D\n  | Aa B C\n  | Ag B X X\n  | Ae B R Q\n  | Ax X\n\ngetB a = case a of \n    (A b _)         -&gt; b\n    (Aa b _)        -&gt; b\n    (Ag b _ _)      -&gt; b\n    (Ae b _ _)      -&gt; b\n    (Ax _)          -&gt; somethingElse\n</code></pre>\n\n<p>In Haskell, given a data type where many of the constructors have the same argument type, is there a better way to return this argument. Or is there a better way to write the <code>case</code> statement shown above to have less repetition?</p>\n"}, {"tags": ["haskell", "optimization", "ghc", "inlining"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1422662269, "post_id": 28246409, "comment_id": 44853756, "body": "I&#39;d inline <code>g</code> as well. Also, check the GHC Core output to see what&#39;s going on. And most importantly, profile everything to check this inlining really matters."}], "owner": {"reputation": 3333, "user_id": 3859566, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a7c4c1c9ad9bd41f49004d32884bc680?s=128&d=identicon&r=PG&f=1", "display_name": "yong", "link": "https://stackoverflow.com/users/3859566/yong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1422661143, "creation_date": 1422661143, "question_id": 28246409, "link": "https://stackoverflow.com/questions/28246409/inlining-repeated-calls-ghc", "title": "Inlining repeated calls (GHC)", "body": "<p>Will GHC inline a function that is used more than once? For example:</p>\n\n<pre><code>{-# INLINE innerLoop #-}\ninnerLoop x = stuff...\n\ng f = \n    f 0 + f 1 + f 2\n</code></pre>\n\n<p>If we call <code>g innerLoop</code> will the function <code>innerLoop</code> be duplicated three times? Or will it just became <code>g stuff...</code>?</p>\n\n<p>How can we either force <code>innerLoop</code> to be inlined multiple times or prevent it from being inlined multiple times?</p>\n"}, {"tags": ["function", "haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422655189, "post_id": 28245328, "comment_id": 44851331, "body": "What error do you see?  I&#39;m going to guess that this problem originates from the dreaded monomorphism restriction.  Add <code>{-# LANGUAGE NoMonomorphismRestriction #-}</code> at the top of your file, or <code>:set -XNoMonomorphismRestriction</code> in GHCi."}], "answers": [{"tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 10, "last_activity_date": 1422655314, "creation_date": 1422655314, "answer_id": 28245371, "question_id": 28245328, "link": "https://stackoverflow.com/questions/28245328/aliasing-function-in-haskell/28245371#28245371", "title": "Aliasing function in Haskell", "body": "<p>This is a problem with the <a href=\"https://wiki.haskell.org/Monomorphism_restriction\">dreaded monomorphism restriction</a> (MMR), which is enabled by default. The MMR is a rule that forces top-level bindings that do not look like functions (ie <code>x = ...</code> vs <code>x a = ...</code>) to have monomorphic bindings unless they have an explicit polymorphic type signature.</p>\n\n<p>The problem is that <code>Bits a =&gt; a  -&gt; a -&gt; a</code> is polymorphic (note the type variable <code>a</code>), and Haskell does not know how to choose a default type for <code>a</code> that satisfies the <code>Bits</code> constraint.</p>\n\n<p>Once you add a type signature, the MMR is appeased and you can have a top-level binding that's polymorphic. Another option is to \"eta-expand\" the definition by adding a named argument; since <code>xor2</code> now syntactically looks like a function, the MMR does not apply:</p>\n\n<pre><code>xor2 x = xor x\n</code></pre>\n\n<p>You can also turn the MMR off with a language extension. You can put this at the top of your module:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 4513188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/609cd019a4304cc8d0bbb4b0fc6f4076?s=128&d=identicon&r=PG&f=1", "display_name": "haskell looks great", "link": "https://stackoverflow.com/users/4513188/haskell-looks-great"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 28245371, "answer_count": 1, "score": 4, "last_activity_date": 1422657973, "creation_date": 1422655100, "last_edit_date": 1422657973, "question_id": 28245328, "link": "https://stackoverflow.com/questions/28245328/aliasing-function-in-haskell", "title": "Aliasing function in Haskell", "body": "<p>The following code doesn't compile:</p>\n\n<pre><code>import Data.Bits\nxor2 = xor\n</code></pre>\n\n<p>However, once I added the type info, it compiles:</p>\n\n<pre><code>import Data.Bits\nxor2 :: Bits a =&gt; a-&gt;a-&gt;a\nxor2 = xor\n</code></pre>\n\n<p>I can't explain this. Any explanations?</p>\n"}, {"tags": ["haskell", "functional-programming", "generic-programming", "scrap-your-boilerplate"], "comments": [{"owner": {"reputation": 61842, "user_id": 779513, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/2ee8ffcc3449741a2f296a9ff9ce6968?s=128&d=identicon&r=PG", "display_name": "Justin Pihony", "link": "https://stackoverflow.com/users/779513/justin-pihony"}, "edited": false, "score": 1, "creation_date": 1422650109, "post_id": 28244136, "comment_id": 44849085, "body": "Google has a ton of documentation on this...."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 61842, "user_id": 779513, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/2ee8ffcc3449741a2f296a9ff9ce6968?s=128&d=identicon&r=PG", "display_name": "Justin Pihony", "link": "https://stackoverflow.com/users/779513/justin-pihony"}, "edited": false, "score": 7, "creation_date": 1422650797, "post_id": 28244136, "comment_id": 44849366, "body": "@JustinPihony I asked the question because one of the aims of Stack Overflow is to have the answer to <i>all</i> programming questions, <a href=\"http://meta.stackexchange.com/questions/5280/embrace-the-non-googlers\">even those that can be Googled</a>. This question, as far as I can see, has never been asked on SO before, and I believe it will generate some high-quality answers."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1422654396, "post_id": 28244136, "comment_id": 44850968, "body": "Section 2 of the paper <a href=\"http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=0088DE3D75D657BE9F2B9E5D705232B3?doi=10.1.1.1.3176&amp;rep=rep1&amp;type=pdf\" rel=\"nofollow noreferrer\">Scrap your boilerplate - A Practical Design Pattern for Generic Programming</a> contains a good motivating example."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1422878867, "post_id": 28244136, "comment_id": 44909120, "body": "FWIW, I have often wondered what the answer to this question is. The documentation for SYBP is vast and complex, and seems to omit to describe the problem it&#39;s actually attempting to <i>solve</i>..."}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1422695045, "post_id": 28247510, "comment_id": 44859471, "body": "How does <code>everywhere</code> figure out whether a pattern successfully matches or not? Usually, non-exhaustive patterns throw an exception which must be caught in <code>IO</code>."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1422717923, "post_id": 28247510, "comment_id": 44865170, "body": "It doesn&#39;t. <code>doubleNegSimpl</code> is identity when the redex doesn&#39;t match, so <code>everywhere</code> literally just applies it <i>everywhere</i> and it simply is a no-op in most places. Of course, <code>everywhere</code> is careful to do this efficiently."}], "tags": [], "owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "is_accepted": true, "score": 19, "last_activity_date": 1422671050, "creation_date": 1422671050, "answer_id": 28247510, "question_id": 28244136, "link": "https://stackoverflow.com/questions/28244136/what-is-scrap-your-boilerplate/28247510#28247510", "title": "What is &quot;Scrap Your Boilerplate&quot;?", "body": "<p>Often when making transformations on complex data types, we only need to affect small pieces of the structure---in other words, we're targeting specific reducible expressions, redexes, alone.</p>\n\n<p>The classic example is double-negation elimination over a type of integer expressions:</p>\n\n<pre><code>data Exp = Plus Exp Exp | Mult Exp Exp | Negate Exp | Pure Int\n\ndoubleNegSimpl :: Exp -&gt; Exp\ndoubleNegSimpl (Negate (Negate e)) = e\n...\n</code></pre>\n\n<p>Even in describing this example, I'd prefer not to write out the entirety of the <code>...</code> part. It is completely mechanical---nothing more than the engine for continuing the recursion throughout the entirety of the <code>Exp</code>.</p>\n\n<p>This \"engine\" is the boilerplate we intend to scrap.</p>\n\n<hr>\n\n<p>To achieve this, Scrap Your Boilerplate suggests a mechanism by which we can construct \"generic traversals\" over data types. These traversals operate exactly correctly without knowing anything at all about the specific data type in question. To do this, very roughly, we have a notion of generic annotated trees. These are larger than ADTs in such a way that all ADTs can be projected into the type of annotated trees:</p>\n\n<pre><code>section :: Generic a =&gt; a -&gt; AnnotatedTree\n</code></pre>\n\n<p>and \"valid\" annotated trees can be projected back into some brand of ADT</p>\n\n<pre><code>retract :: Generic a =&gt; AnnotatedTree -&gt; Maybe a\n</code></pre>\n\n<p>Notably, I'm introducing the <code>Generic</code> typeclass to indicate types which have <code>section</code> and <code>retract</code> defined.</p>\n\n<p>Using this generic, annotated tree representation of all data types, we can define a traversal once and for all. In particular, we provide an interface (using <code>section</code> and <code>retract</code> strategically) so that end users are never exposed to the <code>AnnotatedTree</code> type. Instead, it looks a bit like:</p>\n\n<pre><code>everywhere' :: Generic a =&gt; (a -&gt; a) -&gt; (AnnotatedTree -&gt; AnnotatedTree)\n</code></pre>\n\n<p>such that, combined with final and initial <code>section</code> and <code>retract</code>s and the invariant that our annotated trees are always \"valid\", we have</p>\n\n<pre><code>everywhere :: Generic a =&gt; (a -&gt; a) -&gt; (a -&gt; a)\neverywhere f a0 = fromJust . retract . everywhere' f . section\n</code></pre>\n\n<hr>\n\n<p>What does <code>everywhere f a</code> do? It tries to apply the function <code>f</code> \"everywhere\" in the ADT <code>a</code>. In other words, we now write our double negation simplification as follows</p>\n\n<pre><code>doubleNegSimpl :: Exp -&gt; Exp\ndoubleNegSimpl (Negate (Negate e)) = e\ndoubleNegSimpl e                   = e\n</code></pre>\n\n<p>In other words, it acts as <code>id</code> whenever the redex <code>(Negate (Negate _))</code> fails to match. If we apply <code>everywhere</code> to this</p>\n\n<pre><code>simplify :: Exp -&gt; Exp\nsimplify = everywhere doubleNegSimpl\n</code></pre>\n\n<p>then double negations will be eliminated \"everywhere\" via a generic traversal. The <code>...</code> boilerplate is gone.</p>\n"}], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 5, "accepted_answer_id": 28247510, "answer_count": 1, "score": 17, "last_activity_date": 1422671050, "creation_date": 1422649978, "question_id": 28244136, "link": "https://stackoverflow.com/questions/28244136/what-is-scrap-your-boilerplate", "title": "What is &quot;Scrap Your Boilerplate&quot;?", "body": "<p>I see people talking about <em>Scrap Your Boilerplate</em> and <em>generic programming</em> in Haskell. What do these terms mean? When would I want to use Scrap Your Boilerplate, and how do I use it?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3893, "user_id": 126128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65a7e11b6458430a621588e449b8f36a?s=128&d=identicon&r=PG", "display_name": "Kris Jenkins", "link": "https://stackoverflow.com/users/126128/kris-jenkins"}, "edited": false, "score": 1, "creation_date": 1422648939, "post_id": 28243546, "comment_id": 44848547, "body": "Brilliant! Thanks for the excellent explanation. That <code>(undefined :: Person)</code> trick was particularly enlightening. I hadn&#39;t realised there was a way to get an &#39;empty&#39; instance of the type. :-)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 3893, "user_id": 126128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65a7e11b6458430a621588e449b8f36a?s=128&d=identicon&r=PG", "display_name": "Kris Jenkins", "link": "https://stackoverflow.com/users/126128/kris-jenkins"}, "edited": false, "score": 1, "creation_date": 1422649318, "post_id": 28243546, "comment_id": 44848734, "body": "It works because <code>typeOf</code> doesn&#39;t actually use the value of its argument. We just need to give it &#39;something&#39; of a certain type so that GHC can select the right instance of <code>Typeable</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 3893, "user_id": 126128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65a7e11b6458430a621588e449b8f36a?s=128&d=identicon&r=PG", "display_name": "Kris Jenkins", "link": "https://stackoverflow.com/users/126128/kris-jenkins"}, "edited": false, "score": 2, "creation_date": 1422649334, "post_id": 28243546, "comment_id": 44848747, "body": "@KrisJenkins There&#39;s a lot of contention about the <code>undefined</code> trick.  Some people think it&#39;s sufficient, others think that it&#39;s a hack since it uses <code>undefined</code>.  You could implement the API to instead use something like <code>typeOf :: Typeable a =&gt; Proxy a -&gt; TypeRep</code> and <code>typeOf (Proxy :: Proxy Person)</code> which avoids <code>undefined</code>, but then there&#39;s disagreement on exactly how this should be implemented too.  For most use cases <code>undefined</code> should work well, but avoid using the actual value for anything since it&#39;ll raise an exception."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1422650756, "post_id": 28243546, "comment_id": 44849345, "body": "Defining your own <code>Typeable</code> instance is not just a waste of time; it&#39;s also extremely unsafe. It&#39;s prohibited in Safe Haskell, and it will most likely be prohibited altogether sometime soon. See Simon Peyton Jones&#39;s recent <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9858#comment:20\" rel=\"nofollow noreferrer\">comment</a> to that effect."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1422653707, "post_id": 28243546, "comment_id": 44850653, "body": "@dfeuer Actually it is <i>already</i> generally prohibited. The comment is talking about how GHC generates actual &quot;source code&quot; for the instances internally when deriving them, and suggesting to change that into a more efficient approach. (Of course thanks to the bug discussed, some uses of <code>Typeable</code> are currently extremely unsafe anyway.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1422663066, "post_id": 28243546, "comment_id": 44853988, "body": "@&#216;rjanJohansen, ah, I didn&#39;t realize that. I guess the code I&#39;ve seen doing it manually was just for pre-7.8 GHC. I probably even noticed that at some point, and forgot."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422664689, "post_id": 28243546, "comment_id": 44854379, "body": "@bheklilr, what&#39;s complicated about implementing such an interface?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1422665477, "post_id": 28243546, "comment_id": 44854549, "body": "An alternative to using <code>undefined</code> or <code>Proxy</code> is to add a phantom type to the <code>TypeRep</code> itself, turning it into <code>TTypeRep a</code>. There is actually <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Typeable\" rel=\"nofollow noreferrer\">a proposal</a> to do this, for more typesafe composition of <code>Typeable&#47;Dynamic</code> values, useful for distributed Haskell."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 23, "last_activity_date": 1444915597, "last_edit_date": 1444915597, "creation_date": 1422647500, "answer_id": 28243546, "question_id": 28243383, "link": "https://stackoverflow.com/questions/28243383/how-can-i-read-the-metadata-of-a-type-at-runtime/28243546#28243546", "title": "How can I read the metadata of a type at runtime?", "body": "<p>Reflection in Haskell works using the <code>Typeable</code> class, which is defined in <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Typeable.html\" rel=\"noreferrer\"><code>Data.Typeable</code></a> and includes the <code>typeOf</code>* method to get a run-time representation of a value's type.</p>\n\n<pre><code>ghci&gt; :m +Data.Typeable\nghci&gt; :t typeOf 'a'\ntypeOf 'a' :: TypeRep\nghci&gt; typeOf 'a'  -- We could use any value of type Char and get the same result\nChar  -- the `Show` instance of `TypeRep` just returns the name of the type\n</code></pre>\n\n<p>If you want <code>Typeable</code> to work for your own types, you can have the compiler generate an instance for you with the <code>DeriveDataTypeable</code> extension.</p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\nimport Data.Typeable\ndata Person = Person { name :: String, age :: Int } deriving Typeable\n</code></pre>\n\n<p><s>You can also write your own instance, but really, no one has the time for that.</s> <sub>Apparently you can't - see the comments</sub></p>\n\n<p>You can now use <code>typeOf</code> to grab a run-time representation of your type. We can query information about the type constructor (abbreviated to <code>TyCon</code>) and its type arguments:</p>\n\n<pre><code>-- (undefined :: Person) stands for \"some value of type Person\".\n-- If you have a real Person you can use that too.\n-- typeOf does not use the value, only the type\n-- (which is known at compile-time; typeOf is dispatched using the normal instance selection rules)\nghci&gt; typeOf (undefined :: Person)\nPerson\nghci&gt; tyConName $ typeRepTyCon $ typeOf (undefined :: Person)\n\"Person\"\nghci&gt; tyConModule $ typeRepTyCon $ typeOf (undefined :: Person)\n\"Main\"\n</code></pre>\n\n<p><code>Data.Typeable</code> also provides a <em>type-safe cast</em> operation which allows you to branch on a value's runtime type, somewhat like C#'s <code>as</code> operator.</p>\n\n<pre><code>f :: Typeable a =&gt; a -&gt; String\nf x = case (cast x :: Maybe Int) of\n           Just i -&gt; \"I can treat i as an int in this branch \" ++ show (i * i)\n           Nothing -&gt; case (cast x :: Maybe Bool) of\n                           Just b -&gt; \"I can treat b as a bool in this branch \" ++ if b then \"yes\" else \"no\"\n                           Nothing -&gt; \"x was of some type other than Int or Bool\"\n\nghci&gt; f True\n\"I can treat b as a bool in this branch yes\"\nghci&gt; f (3 :: Int)\n\"I can treat i as an int in this branch 9\"\n</code></pre>\n\n<p>Incidentally, a nicer way to write <code>f</code> is to use a GADT enumerating the set of types you expect your function to be called with. This allows us to lose the <code>Maybe</code> (<code>f</code> can never fail!), does a better job of documenting our assumptions, and gives compile-time feedback when we need to change the set of admissible argument types for <code>f</code>. (You can write a class to make <code>Admissible</code> implicit if you like.)</p>\n\n<pre><code>data Admissible a where\n    AdInt :: Admissible Int\n    AdBool :: Admissible Bool\nf :: Admissible a -&gt; a -&gt; String\nf AdInt i = \"I can treat i as an int in this branch \" ++ show (i * i)\nf AdBool b = \"I can treat b as a bool in this branch \" ++ if b then \"yes\" else \"no\"\n</code></pre>\n\n<p>In reality I probably wouldn't do either of these - I'd just stick <code>f</code> in a class and define instances for <code>Int</code> and <code>Bool</code>.</p>\n\n<hr>\n\n<p>If you want run-time information about the right-hand side of a type definition, you need to use the entertainingly-named <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Data.html\" rel=\"noreferrer\"><code>Data.Data</code></a>, which defines a subclass of <code>Typeable</code> called <code>Data</code>.** GHC can derive <code>Data</code> for you too, with the same extension:</p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\nimport Data.Typeable\nimport Data.Data\ndata Person = Person { name :: String, age :: Int } deriving (Typeable, Data)\n</code></pre>\n\n<p>Now we can grab a run-time representation of the <em>values</em> of a type, not just the type itself:</p>\n\n<pre><code>ghci&gt; dataTypeOf (undefined :: Person)\nDataType {tycon = \"Main.Person\", datarep = AlgRep [Person]}\nghci&gt; dataTypeConstrs $ dataTypeOf (undefined :: Person)\n[Person]  -- Person only defines one constructor, called Person\nghci&gt; constrFields $ head $ dataTypeConstrs $ dataTypeOf (undefined :: Person)\n[\"name\",\"age\"]\n</code></pre>\n\n<hr>\n\n<p><code>Data.Data</code> is the API for generic programming; if you ever hear people talking about <a href=\"http://research.microsoft.com/en-us/um/people/simonpj/Papers/hmap/hmap.ps\" rel=\"noreferrer\">\"Scrap Your Boilerplate\"</a>, this (along with <a href=\"https://hackage.haskell.org/package/syb-0.4.4/docs/Data-Generics.html\" rel=\"noreferrer\"><code>Data.Generics</code></a>, which builds on <code>Data.Data</code>) is what they mean. For example, you can write a function which converts record types to JSON using reflection on the type's fields.</p>\n\n<pre><code>toJSON :: Data a =&gt; a -&gt; String\n-- Implementation omitted because it is boring.\n-- But you only have to write the boring code once,\n-- and it'll be able to serialise any instance of `Data`.\n-- It's a good exercise to try to write this function yourself!\n</code></pre>\n\n<p><sub>* In recent versions of GHC, this API has changed somewhat. Consult the docs.</sub></p>\n\n<p><sub>** Yes, the fully-qualified name of that class is <code>Data.Data.Data</code>.</sub></p>\n"}], "owner": {"reputation": 3893, "user_id": 126128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65a7e11b6458430a621588e449b8f36a?s=128&d=identicon&r=PG", "display_name": "Kris Jenkins", "link": "https://stackoverflow.com/users/126128/kris-jenkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1660, "favorite_count": 6, "accepted_answer_id": 28243546, "answer_count": 1, "score": 19, "last_activity_date": 1444915597, "creation_date": 1422646809, "question_id": 28243383, "link": "https://stackoverflow.com/questions/28243383/how-can-i-read-the-metadata-of-a-type-at-runtime", "title": "How can I read the metadata of a type at runtime?", "body": "<p>I'd like to write a program that prints out some metadata of a Haskell type. Although I know this isn't valid code, the idea is something like:</p>\n\n<pre><code>data Person = Person { name :: String, age :: Int }\n\nmetadata :: Type -&gt; String\nmetadata t = ???\n\nmetadata Person -- returns \"Person (name,age)\"\n</code></pre>\n\n<p>The important restriction being I don't have an instance of <code>Person</code>, just the type.</p>\n\n<p>I've started looking into Generics &amp; Typeable/Data, but without an instance I'm not sure they'll do what I need. Can anyone point me in the right direction?</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "infinite"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422647363, "post_id": 28243314, "comment_id": 44847820, "body": "<a href=\"http://stackoverflow.com/questions/8945096/any-nice-tools-for-untying-knots-in-haskell\">Relevant SO answer</a>"}], "answers": [{"comments": [{"owner": {"reputation": 929, "user_id": 1750683, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/918873ca1e4732f952c0baa31cfd3ba0?s=128&d=identicon&r=PG", "display_name": "Enzo", "link": "https://stackoverflow.com/users/1750683/enzo"}, "edited": false, "score": 0, "creation_date": 1422647885, "post_id": 28243495, "comment_id": 44848061, "body": "I will try out the data-reify package. A while ago I implemented the same project in SML and the problem was solved with the SML <code>ref</code> functionality. It seems that data-reify is offering something very similar to that?"}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 929, "user_id": 1750683, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/918873ca1e4732f952c0baa31cfd3ba0?s=128&d=identicon&r=PG", "display_name": "Enzo", "link": "https://stackoverflow.com/users/1750683/enzo"}, "edited": false, "score": 0, "creation_date": 1422648604, "post_id": 28243495, "comment_id": 44848399, "body": "@Enzo: Yeah, exactly. It&#39;s a different and, for most cases, slightly nicer alternative to using refs for making your cycles explicit."}], "tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 5, "last_activity_date": 1422647317, "creation_date": 1422647317, "answer_id": 28243495, "question_id": 28243314, "link": "https://stackoverflow.com/questions/28243314/is-equality-testing-possible-between-two-infinite-data-structure-in-haskell/28243495#28243495", "title": "Is equality testing possible between two infinite data structure in Haskell?", "body": "<p>In general: no. This sort of equality testing reduces to the halting problem. One way to see this is that we could express the execution of a Turing machine on some input as an infinite data structure like this. Another way of looking at it is that lazy data structures can represent arbitrary suspended computations.</p>\n\n<p>The only real way to avoid problems like this is to either set some additional limitations on your data structure or check for something more limited than equality. </p>\n\n<p>An example of the first approach would be to make cycles in your data type explicit with references of some sort, letting you detect them as you go along. This will limit exactly what you can express with your data structure but will also let your equality predicate detect cycles robustly. I think you could do this with <strong>observable sharing</strong>; take a look at <a href=\"https://hackage.haskell.org/package/data-reify\">data-reify</a> for a package that does this. This approach should make checking a very directly recursive structure like your example easy.</p>\n\n<p>For the second approach, you could have a function that returns a <code>Maybe Bool</code>: if it can't figure out whether the two structures are equal or not in X steps, it returns <code>Nothing</code>. Depending on how your data types are created, you could probably ensure that any types beyond a certain size with the same prefix are <em>almost always</em> equal and just rely on that.</p>\n"}, {"comments": [{"owner": {"reputation": 929, "user_id": 1750683, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/918873ca1e4732f952c0baa31cfd3ba0?s=128&d=identicon&r=PG", "display_name": "Enzo", "link": "https://stackoverflow.com/users/1750683/enzo"}, "edited": false, "score": 0, "creation_date": 1422736222, "post_id": 28248238, "comment_id": 44870581, "body": "Wow this is amazing. I really don&#39;t know what else I can say... Thank you so much Daniel!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 10, "last_activity_date": 1422679976, "last_edit_date": 1422679976, "creation_date": 1422679477, "answer_id": 28248238, "question_id": 28243314, "link": "https://stackoverflow.com/questions/28243314/is-equality-testing-possible-between-two-infinite-data-structure-in-haskell/28248238#28248238", "title": "Is equality testing possible between two infinite data structure in Haskell?", "body": "<p>I'd like to talk a little bit about how to really do this right, if this is a thing you want to do. It's harder than you might guess at first -- and easier than you might guess at second! For fun, I'm going to make the problem slightly harder; we'll eventually be representing the values</p>\n\n<pre><code>a = Pear 10 a\nb = Pear 10 (Pear 10 b)\nc = Apple 10\n</code></pre>\n\n<p>and computing that <code>a</code> and <code>b</code> are \"equal\" -- for a precise sense of equal we'll discuss below. This is not a thing that observable sharing will necessarily give you for free.</p>\n\n<p>The precise sense of equality that we'll use in the sequel is bisimilarity. Normally, bisimilarity -- and its close relative, bisimulation -- are presented as relations between two labelled graphs. For our purposes, you should be picturing here nodes in the graph containing some data at the current constructor of our data type, and edges as pointing to subterms. Thus, for the value <code>Pear 10 (Pear 20 (Apple 30))</code>, we might have the graph <code>Pear 10 -&gt; Pear 20 -&gt; Apple 30</code>; and the value <code>b</code> above would be the cyclic graph</p>\n\n<pre><code>Pear 10 -&gt; Pear 10\n   ^         |\n    \\_______/\n</code></pre>\n\n<p>Observable sharing will you get you this far, but will not get you to the point where it's obvious how to decide that these two graphs are equivalent:</p>\n\n<pre><code>Pear 10 -.            Pear 10 -&gt; Pear 10\n   ^      |     ~=       ^         |\n    \\____/                \\_______/\n</code></pre>\n\n<p>If you're familiar with an algorithm used for minimizing DFAs, you can probably stop here; such algorithms are easy to adapt for the purpose of testing equality of regular languages, and that's essentially what we'll be doing below.</p>\n\n<p>The key insight is that all three nodes in the two graphs above behave essentially the same -- any path you can take starting from a node in the left graph has an \"identical\" path in the right graph. That is, suppose we have a relation R between nodes in the left and right graphs satisfying this property:</p>\n\n<pre><code>if  nl  R nr\nand  there is an edge (nl, e, nl') in the graph,\nthen there is an edge (nr, e, nr') in the graph\nand nl' R nr'\n</code></pre>\n\n<p>We'll call R a bisimulation. The largest relation R will be called a bisimilarity. If the \"root\" nodes in two graphs are bisimilar, then the corresponding Haskell values are equal! At this point, I hope you have gotten to the point where the problem seems harder than you guessed at first; perhaps impossible. After all, how are we supposed to get our hands on the largest such relation?</p>\n\n<p>One answer is to start with the complete relation and cut out any pairs of nodes that violate the above constraints. Keep iterating that process until nothing changes, and see what we've got left. It turns out you can prove that this process actually produces <em>the</em> bisimilarity! We'll implement this below in a pretty naive way; you can google about for efficient bisimilarity algorithms if you want to have more speed.</p>\n\n<p>First a preamble. We'll use the <a href=\"http://hackage.haskell.org/package/fgl\">fgl</a> package for our graph representation.</p>\n\n<pre><code>import Control.Monad.Reader\nimport Data.Graph.Inductive hiding (ap)\nimport Data.Map (Map)\nimport Data.Set (Set)\nimport qualified Data.Map as M\nimport qualified Data.Set as S\n</code></pre>\n\n<p>The fgl package defines a type <code>Node</code> for the identities of nodes. We'll represent our relation simply as</p>\n\n<pre><code>type Relation = Set (Node, Node)\n</code></pre>\n\n<p>To begin with, we want the complete relation for a pair of graphs. While we're at it, we might as well cut out any pairs whose node labels don't match right away. (A note on naming conventions I chose: in fgl, every node and edge has a label -- which can be of any type you like -- and an identity -- which must be of type <code>Node</code> or <code>Edge</code>. Our names will reflect this when possible: an <code>n</code> prefix for nodes, <code>e</code> for edges, <code>i</code> for identity, and <code>v</code> for label/value. We'll use <code>l</code> and <code>r</code> as a suffix for our left-hand and right-hand graphs.)</p>\n\n<pre><code>labeledPairs :: (Eq n, Graph gr) =&gt; gr n e -&gt; gr n e' -&gt; Relation\nlabeledPairs l r = S.fromList\n    [ (nil, nir)\n    | (nil, nvl) &lt;- labNodes l\n    , (nir, nvr) &lt;- labNodes r\n    , nvl == nvr\n    ]\n</code></pre>\n\n<p>Now, the next piece is to check whether two nodes satisfy the \"single-step relatedness\" condition we described above. That is, for each edge out of one of the nodes, we're looking for an edge out of the other with the same label and leading to another node that we currently claim is related. Transliterating this search to Haskell:</p>\n\n<pre><code>-- assumption: nil and nir are actual nodes in graphs l and r, respectively\nssRelated :: (Ord e, Graph gr) =&gt; gr n e -&gt; gr n e -&gt; Relation -&gt; Node -&gt; Node -&gt; Bool\nssRelated l r rel nil nir = rell &amp;&amp; relr where\n    el = out l nil\n    er = out r nil\n    mel = M.fromListWith (++) [(evl, [nil]) | (_, nil, evl) &lt;- el]\n    mer = M.fromListWith (++) [(evr, [nir]) | (_, nir, evr) &lt;- er]\n    rell = and\n        [ or [(nil, nir) `S.member` rel | nir &lt;- M.findWithDefault [] evl mer]\n        | (_, nil, evl) &lt;- el\n        ]\n    relr = and\n        [ or [(nil, nir) `S.member` rel | nil &lt;- M.findWithDefault [] evr mel]\n        | (_, nir, evr) &lt;- er\n        ]\n</code></pre>\n\n<p>We can now write a function which checks each pair of nodes for single-step suitability:</p>\n\n<pre><code>prune :: (Ord e, Graph gr) =&gt; gr n e -&gt; gr n e -&gt; Relation -&gt; Relation\nprune l r rel = S.filter (uncurry (ssRelated l r rel)) rel\n</code></pre>\n\n<p>To compute the bisimilarity, as said above, we'll start with the complete relation and repeatedly prune away nodes that don't fit the criteria.</p>\n\n<pre><code>bisimilarity :: (Eq n, Ord e, Graph gr) =&gt; gr n e -&gt; gr n e -&gt; Relation\nbisimilarity l r\n    = fst . head\n    . dropWhile (uncurry (/=))\n    . ap zip tail\n    . iterate (prune l r)\n    $ labeledPairs l r\n</code></pre>\n\n<p>Now we can check whether two graphs have the same infinite unrolling by picking root nodes in each graph and checking them for bisimilarity:</p>\n\n<pre><code>-- assumption: the root of the graph is node 0\nbisimilar :: (Eq n, Ord e, Graph gr) =&gt; gr n e -&gt; gr n e -&gt; Bool\nbisimilar l r = (0, 0) `S.member` bisimilarity l r\n</code></pre>\n\n<p>Now let's see it in action! We'll make analogs of <code>a</code>, <code>b</code>, and <code>c</code> from earlier in the answer in the graph representation. Since our data type only ever has one possible recursive occurrence, we don't need interesting edge labels. The <code>mkGraph</code> function takes a list of labeled nodes and a list of labeled edges and builds a graph out of them.</p>\n\n<pre><code>data NodeLabel = Apple Int | Pear Int\n    deriving (Eq, Ord, Read, Show)\ntype EdgeLabel = ()\n\na, b, c :: Gr NodeLabel EdgeLabel\na = mkGraph [(0, Pear 10)] [(0, 0, ())]\nb = mkGraph [(0, Pear 10), (1, Pear 10)] [(0, 1, ()), (1, 0, ())]\nc = mkGraph [(0, Apple 10)] []\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>*Main&gt; bisimilar a b\nTrue\n*Main&gt; bisimilar a c\nFalse\n*Main&gt; bisimilar b c\nFalse\n*Main&gt; bisimilar a a\nTrue\n*Main&gt; bisimilar b b\nTrue\n*Main&gt; bisimilar c c\nTrue\n</code></pre>\n\n<p>Looks good! Making it fast and hooking it up to an observable-sharing library are left as an exercise to the reader. And keep in mind that, though this method can handle graphs with infinite unrollings, of course one would probably have trouble handling infinite graphs in this way!</p>\n"}], "owner": {"reputation": 929, "user_id": 1750683, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/918873ca1e4732f952c0baa31cfd3ba0?s=128&d=identicon&r=PG", "display_name": "Enzo", "link": "https://stackoverflow.com/users/1750683/enzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 1, "accepted_answer_id": 28243495, "answer_count": 2, "score": 7, "last_activity_date": 1425012317, "creation_date": 1422646449, "last_edit_date": 1425012317, "question_id": 28243314, "link": "https://stackoverflow.com/questions/28243314/is-equality-testing-possible-between-two-infinite-data-structure-in-haskell", "title": "Is equality testing possible between two infinite data structure in Haskell?", "body": "<p>In a project I'm working on, data of a certain type may sometimes contain themselves in it. For example,</p>\n\n<pre><code>data Example = Apple Int\n             | Pear Int Example\n\na = Pear 10 a\nb = Pear 10 b\n</code></pre>\n\n<p>As a programmer I know that <code>a</code> and <code>b</code> are equal, but when I actually test equality between them it would infinite loop because their values need to be evaluated for comparison.</p>\n\n<p>Is there any other way to do equality testing between data like these? Or is there a way to avoid problems like these?</p>\n"}, {"tags": ["git", "parsing", "haskell"], "comments": [{"owner": {"reputation": 11426, "user_id": 4021077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3GtFHim6SUE/AAAAAAAAAAI/AAAAAAAACLk/KrEsgeVKOy0/photo.jpg?sz=128", "display_name": "Andrew C", "link": "https://stackoverflow.com/users/4021077/andrew-c"}, "edited": false, "score": 4, "creation_date": 1422638196, "post_id": 28240388, "comment_id": 44843384, "body": "The documentation for <code>git status --porcelain</code> explicitly states it is designed to be parsed by scripts.  Without a description of exactly what situation you aren&#39;t handling properly it&#39;s hard to say what is wrong with your approach.  I would guess that you don&#39;t handle non-tracking branches correctly."}, {"owner": {"reputation": 1206, "user_id": 783116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ZOv9Y.jpg?s=128&g=1", "display_name": "josiah", "link": "https://stackoverflow.com/users/783116/josiah"}, "reply_to_user": {"reputation": 11426, "user_id": 4021077, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3GtFHim6SUE/AAAAAAAAAAI/AAAAAAAACLk/KrEsgeVKOy0/photo.jpg?sz=128", "display_name": "Andrew C", "link": "https://stackoverflow.com/users/4021077/andrew-c"}, "edited": false, "score": 0, "creation_date": 1422638370, "post_id": 28240388, "comment_id": 44843474, "body": "@AndrewC That begs the question why I read (or remember reading) responses saying the --porcelain was not the way and then went on to recommend commands like rev-parse. I would think I&#39;d gone crazy, except --procelain was the most obvious approach, but I abandoned it due to those suggestions, as my code shows.  Hmmm."}, {"owner": {"reputation": 478015, "user_id": 279627, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2dceea858ad8f1577bec6ddaa0485d15?s=128&d=identicon&r=PG", "display_name": "Sven Marnach", "link": "https://stackoverflow.com/users/279627/sven-marnach"}, "edited": false, "score": 4, "creation_date": 1422638573, "post_id": 28240388, "comment_id": 44843574, "body": "Related: <a href=\"http://stackoverflow.com/q/6609643/279627\">Haskell library to manipulate a git repo</a>"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1422642397, "post_id": 28240388, "comment_id": 44845363, "body": "@Josiah Andrew is right. Here is how the <code>git status</code> man page describes the <code>--porcelain</code> flag: <i>Give the output in an easy-to-parse format for scripts.  This is similar to the short output, but will remain stable across Git versions and regardless of user configuration.</i>"}], "answers": [{"tags": [], "owner": {"reputation": 1206, "user_id": 783116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ZOv9Y.jpg?s=128&g=1", "display_name": "josiah", "link": "https://stackoverflow.com/users/783116/josiah"}, "is_accepted": true, "score": 1, "last_activity_date": 1422679248, "last_edit_date": 1495540328, "creation_date": 1422678914, "answer_id": 28248179, "question_id": 28240388, "link": "https://stackoverflow.com/questions/28240388/whats-the-proper-way-to-determine-the-status-of-a-git-branch-programmatically/28248179#28248179", "title": "What&#39;s the proper way to determine the status of a Git branch programmatically?", "body": "<p>Just so there is an official answer:</p>\n\n<p>As in the comments, the docs DO say that the --porcelain flag with Git Status is there to provide parsing for scripts.  My source of confusion is that, in general, this is not the role of the porcelain flag, and traditionally, a 'plumbing' command would normally be specified for such a purpose in Git.  Thus, in this case, using the --porcelain flag seems to be an accepted way of parsing out the status of Git repositories, but this is an exception to what --porcelain normally means.</p>\n\n<p>More details are covered in the below SO posts that I uncovered while searching around for better explanations.\n<a href=\"https://stackoverflow.com/questions/15798862/what-does-git-rev-parse-do\">What does git rev-parse do?</a>\n<a href=\"https://stackoverflow.com/questions/6976473/what-does-the-term-porcelain-mean-in-git\">What does the term &quot;porcelain&quot; mean in Git?</a></p>\n"}], "owner": {"reputation": 1206, "user_id": 783116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ZOv9Y.jpg?s=128&g=1", "display_name": "josiah", "link": "https://stackoverflow.com/users/783116/josiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 2, "accepted_answer_id": 28248179, "answer_count": 1, "score": 7, "last_activity_date": 1422679248, "creation_date": 1422635548, "last_edit_date": 1422638488, "question_id": 28240388, "link": "https://stackoverflow.com/questions/28240388/whats-the-proper-way-to-determine-the-status-of-a-git-branch-programmatically", "title": "What&#39;s the proper way to determine the status of a Git branch programmatically?", "body": "<p>I read over various other SO posts and Google search results that <code>git status --porcelain</code> is not really the command you want to be relying on if you are parsing out the current git branch status programmatically.  I was eventually pointed to <code>rev-parse</code>, <code>diff-index</code>, and <code>diff-files</code> commands for doing this - however, the method I'm currently using is a little buggy, particularly on branches other than master.  Themes like Bureau for oh-my-zsh seem to be using <code>git status --porcelain</code>, which I stated above was not recommended by the Git community.  So what's the proper way to read in such branch statuses as these?</p>\n\n<p>Code segment from the Bureau Oh-My-ZSH theme so that it's clear what behaviour I'm trying to reproduce.</p>\n\n<pre><code>bureau_git_status () {\n  _INDEX=$(command git status --porcelain -b 2&gt; /dev/null)\n  _STATUS=\"\"\n  if $(echo \"$_INDEX\" | grep '^[AMRD]. ' &amp;&gt; /dev/null); then\n    _STATUS=\"$_STATUS$ZSH_THEME_GIT_PROMPT_STAGED\"\n  fi\n  if $(echo \"$_INDEX\" | grep '^.[MTD] ' &amp;&gt; /dev/null); then\n    _STATUS=\"$_STATUS$ZSH_THEME_GIT_PROMPT_UNSTAGED\"\n  fi\n  if $(echo \"$_INDEX\" | command grep -E '^\\?\\? ' &amp;&gt; /dev/null); then\n    _STATUS=\"$_STATUS$ZSH_THEME_GIT_PROMPT_UNTRACKED\"\n  fi\n  if $(echo \"$_INDEX\" | grep '^UU ' &amp;&gt; /dev/null); then\n    _STATUS=\"$_STATUS$ZSH_THEME_GIT_PROMPT_UNMERGED\"\n  fi\n  if $(command git rev-parse --verify refs/stash &gt;/dev/null 2&gt;&amp;1); then\n    _STATUS=\"$_STATUS$ZSH_THEME_GIT_PROMPT_STASHED\"\n  fi\n  if $(echo \"$_INDEX\" | grep '^## .*ahead' &amp;&gt; /dev/null); then\n    _STATUS=\"$_STATUS$ZSH_THEME_GIT_PROMPT_AHEAD\"\n  fi\n  if $(echo \"$_INDEX\" | grep '^## .*behind' &amp;&gt; /dev/null); then\n    _STATUS=\"$_STATUS$ZSH_THEME_GIT_PROMPT_BEHIND\"\n  fi\n  if $(echo \"$_INDEX\" | grep '^## .*diverged' &amp;&gt; /dev/null); then\n    _STATUS=\"$_STATUS$ZSH_THEME_GIT_PROMPT_DIVERGED\"\n  fi\n\n  echo $_STATUS\n}\n</code></pre>\n\n<p>I'm eventually going to support all of the behavior above, by here is my start on that and the basic commands I'm currently using to do things (sorry about the fact it's Haskell, hopefully that doesn't prevent anyone from getting the gist of what the code is  doing - no pun intended).</p>\n\n<pre><code>hasCommitsToPush :: IO (Maybe Bool)\nhasCommitsToPush = do\n  latestCommits &lt;- liftM (fmap $ deleteNulls . splitOnNewLine) $ parseProcessResponse gitRemoteRefDiff\n  case latestCommits\n    of Nothing                                      -&gt; return Nothing\n       Just []                                      -&gt; return $ Just False\n       Just [_]                                     -&gt; return $ Just True -- This case is for a new repository with the first commit in local but not yet pushed.\n       Just [latestRemoteCommit, latestLocalCommit] -&gt; return . Just $ latestRemoteCommit /= latestLocalCommit\n       _                                            -&gt; return Nothing\n  where gitRemoteRefDiff = readProcessWithExitCode \"git\" [\"rev-parse\", \"@{u}\", \"HEAD\"] []\n\nhasStagedChanges :: IO (Maybe Bool)\nhasStagedChanges = liftM (fmap isResponseNull) $ parseProcessResponse gitResponse\n  where gitResponse = readProcessWithExitCode \"git\" [\"diff-index\",\"--cached\",\"--ignore-submodules\",\"HEAD\"] []\n\nhasUnstagedChanges :: IO (Maybe Bool)\nhasUnstagedChanges = liftM (fmap isResponseNull) $ parseProcessResponse gitStatus\n  where gitStatus = readProcessWithExitCode \"git\" [\"diff-files\",\"--ignore-submodules\"] []\n</code></pre>\n\n<p><strong>Edit</strong> <em>AndrewC pointed out that --porcelain is described in the docs as being purposed for parsing by scripts.  This causes me to ask the question, when should I use <code>rev-parse</code> vs. <code>--porcelain</code>??</em></p>\n"}, {"tags": ["haskell", "ocaml"], "comments": [{"owner": {"reputation": 23720, "user_id": 759076, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/u80ZJ.jpg?s=128&g=1", "display_name": "Jackson Tale", "link": "https://stackoverflow.com/users/759076/jackson-tale"}, "edited": false, "score": 3, "creation_date": 1422639130, "post_id": 28240375, "comment_id": 44843839, "body": "I think the problem description is confusing answers. You should say <code>list of &#39;a and one &#39;b</code>, if i understand correctly. In addition, if that&#39;s the case, then even in haskell, you don&#39;t need <code>zipWith</code>, a simple <code>map</code> can solve your problem."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1422640771, "post_id": 28240375, "comment_id": 44844611, "body": "Yikes. Please tell me you never actually wrote <code>zipWith f a (replicate (length a) b)</code>. Traversing <code>a</code> twice like that is very bad for streaming behavior. Much better to write <code>zipWith f a (repeat b)</code>."}, {"owner": {"reputation": 664, "user_id": 1942603, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/000d3f5089feca9226a46f8e1eba1bf0?s=128&d=identicon&r=PG", "display_name": "Joshua Snider", "link": "https://stackoverflow.com/users/1942603/joshua-snider"}, "edited": false, "score": 0, "creation_date": 1422641083, "post_id": 28240375, "comment_id": 44844729, "body": "It was back in undergrad when I was first learning Haskell, but yes yes I did."}], "answers": [{"comments": [{"owner": {"reputation": 23720, "user_id": 759076, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/u80ZJ.jpg?s=128&g=1", "display_name": "Jackson Tale", "link": "https://stackoverflow.com/users/759076/jackson-tale"}, "edited": false, "score": 0, "creation_date": 1422639055, "post_id": 28240533, "comment_id": 44843799, "body": "the op has only one <code>b</code>, not <code>list of &#39;b</code>"}, {"owner": {"reputation": 4223, "user_id": 597517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1fd636db960bba6027154d81ef106e?s=128&d=identicon&r=PG", "display_name": "Martin Jambon", "link": "https://stackoverflow.com/users/597517/martin-jambon"}, "edited": false, "score": 2, "creation_date": 1422643369, "post_id": 28240533, "comment_id": 44845865, "body": "This answers the question as phrased in the title, which is useful for future visitors."}, {"owner": {"reputation": 23720, "user_id": 759076, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/u80ZJ.jpg?s=128&g=1", "display_name": "Jackson Tale", "link": "https://stackoverflow.com/users/759076/jackson-tale"}, "reply_to_user": {"reputation": 4223, "user_id": 597517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1fd636db960bba6027154d81ef106e?s=128&d=identicon&r=PG", "display_name": "Martin Jambon", "link": "https://stackoverflow.com/users/597517/martin-jambon"}, "edited": false, "score": 0, "creation_date": 1422655465, "post_id": 28240533, "comment_id": 44851468, "body": "@MartinJambon hmm I agree"}], "tags": [], "owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "is_accepted": false, "score": 8, "last_activity_date": 1422636452, "last_edit_date": 1422636452, "creation_date": 1422636029, "answer_id": 28240533, "question_id": 28240375, "link": "https://stackoverflow.com/questions/28240375/equivalent-of-haskells-zipwith-in-ocaml/28240533#28240533", "title": "Equivalent of haskell&#39;s zipwith in OCaml", "body": "<p>\"List.map2\" is the equivalent of Haskell's \"zipWith\"</p>\n\n<pre><code>val map2 : ('a -&gt; 'b -&gt; 'c) -&gt; 'a list -&gt; 'b list -&gt; 'c list\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1422640456, "post_id": 28240673, "comment_id": 44844478, "body": "I took the liberty of adding some context since I was confused at first by this answer -- I expected this to provide what the OP asked, instead of what the OP needed."}], "tags": [], "owner": {"reputation": 5432, "user_id": 3210257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e031a73b4d825b34b8fbcdae03b76f0b?s=128&d=identicon&r=PG", "display_name": "PatJ", "link": "https://stackoverflow.com/users/3210257/patj"}, "is_accepted": true, "score": 8, "last_activity_date": 1422640278, "last_edit_date": 1422640278, "creation_date": 1422636465, "answer_id": 28240673, "question_id": 28240375, "link": "https://stackoverflow.com/questions/28240375/equivalent-of-haskells-zipwith-in-ocaml/28240673#28240673", "title": "Equivalent of haskell&#39;s zipwith in OCaml", "body": "<p>Well, in your example you do not really need <code>zipWith</code>, you can use a simple <code>map</code>:</p>\n\n<pre><code>List.map (fun a -&gt; f a b) a_list\n</code></pre>\n\n<p>This would be more efficient than a <code>List.map2</code> (the equivalent of <code>zipWith</code>) because OCaml doesn't handle lists the same way as Haskell so constructing a dummy list just for the sake of the iteration isn't really worth it.</p>\n"}, {"comments": [{"owner": {"reputation": 5432, "user_id": 3210257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e031a73b4d825b34b8fbcdae03b76f0b?s=128&d=identicon&r=PG", "display_name": "PatJ", "link": "https://stackoverflow.com/users/3210257/patj"}, "edited": false, "score": 0, "creation_date": 1422723681, "post_id": 28241184, "comment_id": 44866905, "body": "Well, I don&#39;t know much of Haskell&#39;s behavior and assumed it was optimized without checking. (lazy me :-p)"}], "tags": [], "owner": {"reputation": 28350, "user_id": 2625442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a48a497d3aae41354bc1189d57db2c3?s=128&d=identicon&r=PG", "display_name": "ivg", "link": "https://stackoverflow.com/users/2625442/ivg"}, "is_accepted": false, "score": 1, "last_activity_date": 1422642401, "last_edit_date": 1422642401, "creation_date": 1422638221, "answer_id": 28241184, "question_id": 28240375, "link": "https://stackoverflow.com/questions/28240375/equivalent-of-haskells-zipwith-in-ocaml/28241184#28241184", "title": "Equivalent of haskell&#39;s zipwith in OCaml", "body": "<p>The equivalent in OCaml would be:</p>\n\n<pre><code> open Core_kernel.Std\n\n let replicate n b = List.init n ~f:(fun _ -&gt; b)\n List.(map2_exn a (replicate (length b) b) ~f:your_function)\n</code></pre>\n\n<p>This code arises few questions, however. Like, are you sure, that you want to have a list as a second argument of your function? And, what is the reason, to duplicate the second argument, instead of passing it as a free variable to your function, as @PatJ has suggested. And it is not all about lazy vs. eager evaluation. In Haskell you still need to traverse the list, and <code>b</code> will be traversed twice. The fact that computation is lazy, doesn't mean that it will be any faster, when it is evaluated. </p>\n\n<p>But still, OCaml's Core library provides a lazy list named <code>Sequence</code>, that has behavior similar to the Haskell's one. The code would be the same, modulo the module name, i.e., just substitute <code>List</code> with a <code>Sequence</code>.</p>\n"}], "owner": {"reputation": 664, "user_id": 1942603, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/000d3f5089feca9226a46f8e1eba1bf0?s=128&d=identicon&r=PG", "display_name": "Joshua Snider", "link": "https://stackoverflow.com/users/1942603/joshua-snider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 1, "accepted_answer_id": 28240673, "answer_count": 3, "score": 2, "last_activity_date": 1422642401, "creation_date": 1422635523, "last_edit_date": 1422640826, "question_id": 28240375, "link": "https://stackoverflow.com/questions/28240375/equivalent-of-haskells-zipwith-in-ocaml", "title": "Equivalent of haskell&#39;s zipwith in OCaml", "body": "<p>I have a list of 'a, and one 'b, and a function of type <code>'a -&gt; 'b-&gt; 'c</code>. I'm trying to apply the function to every element of the a-list with the b I already have and make a list of 'c. In haskell, I would do something like <code>zipWith(foobar) a-list (replicate (length a) b).</code> \nWhat's the equivalent way to do this in OCaml?</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "is_accepted": false, "score": 1, "last_activity_date": 1422633092, "creation_date": 1422633092, "answer_id": 28239653, "question_id": 28238177, "link": "https://stackoverflow.com/questions/28238177/distributing-cabal-sandboxes/28239653#28239653", "title": "Distributing cabal sandboxes", "body": "<p>If your program uses GHC-API you will need GHC anyway.You should provide your application as executable, something like that: </p>\n\n<pre><code>$ ghc -O2 --make -static -optc-static -optl-static A.hs -fvia-C -optl-pthread\n</code></pre>\n\n<p>or use new Cabal feature called \"<a href=\"https://github.com/haskell/cabal/issues/462#issuecomment-64679257\" rel=\"nofollow\">Relocatable packages</a>\" with key <code>--enable-relocatable</code> to provide all additional files, but it will be huge distribution, I think.</p>\n"}], "owner": {"reputation": 4326, "user_id": 745281, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dadf31ef26bafd83d35d361802499418?s=128&d=identicon&r=PG", "display_name": "aleator", "link": "https://stackoverflow.com/users/745281/aleator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422633092, "creation_date": 1422628596, "question_id": 28238177, "link": "https://stackoverflow.com/questions/28238177/distributing-cabal-sandboxes", "title": "Distributing cabal sandboxes", "body": "<p>I have a program that uses GHC-API to work with Haskell source files. The source files import modules from specific cabal-packages, which means that the cabal packages must be installed to the system where my program is ran.</p>\n\n<p>What is the easiest way to distribute my program? I would not like to install ghc on each target system. Can I, for example, make some kind of portable a cabal sandbox that I could distribute with my program? How? Is there a better solution?</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "state-monad", "io-monad"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 2, "creation_date": 1422629262, "post_id": 28237814, "comment_id": 44837882, "body": "Impossible is nothing...but why do you want to do this? That&#39;s what <code>StateT</code> is <i>for</i>. You could always just pass around the <code>Int</code> state explicitly , and do everything in <code>IO ()</code> alone..."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1422638855, "post_id": 28237814, "comment_id": 44843709, "body": "You can completely avoid those data types by using <code>s -&gt; IO (a, s)</code> directly, substituting for <code>a</code> and <code>s</code> appropriately. It definitely won&#39;t be as nice though."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1422639142, "post_id": 28237814, "comment_id": 44843845, "body": "It&#39;s also worth noting that <code>State</code> is defined in terms of <code>StateT</code> and not the other way."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1422680874, "post_id": 28237814, "comment_id": 44856998, "body": "@DavidYoung Turn that into an answer!"}], "answers": [{"tags": [], "owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "is_accepted": false, "score": 1, "last_activity_date": 1422635081, "creation_date": 1422635081, "answer_id": 28240247, "question_id": 28237814, "link": "https://stackoverflow.com/questions/28237814/is-it-possible-to-emulate-the-behaviour-of-statet-without-the-use-of-custom-type/28240247#28240247", "title": "Is it possible to emulate the behaviour of StateT without the use of custom types?", "body": "<p>Of course you can do all the plumbing yourself. Monads don't add anything new to Haskell, they just enable a ton of code reuse and boilerplate reduction. So anything you can do with a monad, you can laborously do by hand.</p>\n\n<pre><code>manyOperations :: Int -&gt; IO ()\nmanyOperations n0 = do\n    let n1 = n0 + 2\n    print n1\n    let n2 = n1 - 3\n    print n2\n    let n3 = n2 + 5\n    print n3\n</code></pre>\n\n<p>If the amount of repetition in the above function is too much for you (it is for me!) you <em>could</em> try to reduce it with a 'combined computation and printing' function but at this point you're bending over backwards to avoid <code>StateT</code>.</p>\n\n<pre><code>-- a bad function, never write something like this!\nprintAndCompute :: a -&gt; (a -&gt; b) -&gt; IO b\nprintAndCompute a f = let b = f a in print b &gt;&gt; return b\n\n-- seriously, don't do this!\nmanyOperations n0 = do\n    n1 &lt;- printAndCompute (+2) n0\n    n2 &lt;- printAndCompute (-3) n1\n    n3 &lt;- printAndCompute (+5) n2\n    return ()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1207, "user_id": 2884502, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d817ec525df88f7a149bc9186e1a31f3?s=128&d=identicon&r=PG&f=1", "display_name": "lightandlight", "link": "https://stackoverflow.com/users/2884502/lightandlight"}, "edited": false, "score": 0, "creation_date": 1422654756, "post_id": 28244079, "comment_id": 44851128, "body": "Abstracting the printing might be a helpful feature, but it&#39;s not what I&#39;m looking for. Thanks for the input, though."}], "tags": [], "owner": {"reputation": 44721, "user_id": 546084, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/wMoWk.jpg?s=128&g=1", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/546084/chris-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1422650097, "last_edit_date": 1422650097, "creation_date": 1422649757, "answer_id": 28244079, "question_id": 28237814, "link": "https://stackoverflow.com/questions/28237814/is-it-possible-to-emulate-the-behaviour-of-statet-without-the-use-of-custom-type/28244079#28244079", "title": "Is it possible to emulate the behaviour of StateT without the use of custom types?", "body": "<p>I'm not sure if this is quite what you're looking for, but you could define an operation which takes a stateful operation that you alread have, and prints out the state after performing the operation -</p>\n\n<pre><code>withPrint :: (Show s) =&gt; State s a -&gt; StateT s IO a\nwithPrint operation = do\n    s &lt;- get\n    let (a, t) = runState operation s\n    liftIO (print t)\n    put t\n    return a\n</code></pre>\n\n<p>and then do</p>\n\n<pre><code>manyOperations :: StateT Int IO ()\nmanyOperations = do\n    withPrint (add 2)\n    withPrint (subtract 3)\n    withPrint (add 5)\n    -- etc\n</code></pre>\n\n<p>This doesn't <em>avoid</em> using <code>StateT</code> but it abstracts out the conversion of your regular, non-IO state operations into IO-ful state operations so you don't have to worry about the details (aside from adding <code>withPrint</code> when you want the state to be printed.</p>\n\n<p>If you don't want the state printed for a particular operation, you could define</p>\n\n<pre><code>withoutPrint :: State s a -&gt; StateT s IO a\nwithoutPrint operation = do\n    s &lt;- get\n    let (a, t) = runState operation s\n    put t\n    return a\n</code></pre>\n\n<p>which is actually equivalent to</p>\n\n<pre><code>import Control.Monad.Morph\n\nwithoutPrint :: State s a -&gt; StateT s IO a\nwithoutPrint = hoist (\\(Identity a) -&gt; return a)\n</code></pre>\n\n<p>using <code>hoist</code> from <code>Control.Monad.Morph</code> to transform the monad underlying <code>StateT</code> from <code>Identity</code> to <code>IO</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": false, "score": 0, "last_activity_date": 1422736061, "last_edit_date": 1422736061, "creation_date": 1422734981, "answer_id": 28256019, "question_id": 28237814, "link": "https://stackoverflow.com/questions/28237814/is-it-possible-to-emulate-the-behaviour-of-statet-without-the-use-of-custom-type/28256019#28256019", "title": "Is it possible to emulate the behaviour of StateT without the use of custom types?", "body": "<p>You can completely avoid those data types by using <code>s -&gt; IO (a, s)</code> directly, substituting for <code>a</code> and <code>s</code> appropriately. It definitely won't be as nice though.</p>\n\n<p>It would look something like this:</p>\n\n<pre><code>-- This makes StateIO s act as a shorthand for s -&gt; IO (a, s)\ntype StateIO s a = s -&gt; IO (a, s)\n\nadd :: Int -&gt; StateIO Int ()\nadd n = \\x -&gt; print (x+n) &gt;&gt; return ((),x+n)\n\nsub :: Int -&gt; StateIO Int ()\nsub n = \\x -&gt; print (x-n) &gt;&gt; return ((),x-n)\n\nmanyOperations :: StateIO Int ()\nmanyOperations =   -- Using the definition of (&gt;&gt;=) for StateT\n  \\s1 -&gt; do        -- and removing a lambda that is immediately applied\n      (a, s2) &lt;- add 2 s1\n      (a, s3) &lt;- sub 3 s2\n      add 5 s3\n\nresult :: IO ((), Int)\nresult = manyOperations 5\n</code></pre>\n\n<p>The state has to be explicitly threaded through all the operations. This is a major gain we get from using the <code>StateT</code> datatype: the <code>(&gt;&gt;=)</code> method of its <code>Monad</code> instance does all this for us! We can see from this example, though, that there is nothing magical going on in <code>StateT</code>. It's just a very nice way of abstracting out the threading of state.</p>\n\n<p>Also, the relationship between <code>StateT</code> and <code>State</code> is the opposite of the relationship between <code>MaybeT</code> and <code>Maybe</code>: <code>State</code> is defined in terms of <code>StateT</code>. We can see that fact expressed in <a href=\"https://hackage.haskell.org/package/transformers/docs/src/Control-Monad-Trans-State-Lazy.html#State\" rel=\"nofollow\">this type synonym</a>:</p>\n\n<pre><code>type State s = StateT s Identity\n</code></pre>\n\n<p>It is a transformer over <a href=\"https://hackage.haskell.org/package/transformers-0.4.2.0/docs/Data-Functor-Identity.html#t:Identity\" rel=\"nofollow\">the <code>Identity</code> type</a> (which has the trivial <code>Monad</code> instance).</p>\n"}], "owner": {"reputation": 1207, "user_id": 2884502, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d817ec525df88f7a149bc9186e1a31f3?s=128&d=identicon&r=PG&f=1", "display_name": "lightandlight", "link": "https://stackoverflow.com/users/2884502/lightandlight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1422736061, "creation_date": 1422627465, "question_id": 28237814, "link": "https://stackoverflow.com/questions/28237814/is-it-possible-to-emulate-the-behaviour-of-statet-without-the-use-of-custom-type", "title": "Is it possible to emulate the behaviour of StateT without the use of custom types?", "body": "<p>If we have the following two functions, add and subtract, it is simple to chain them to run a series of calculations on an input:</p>\n\n<pre><code>add :: Int -&gt; State Int ()\nadd n = state $ \\x -&gt; ((),x+n)\n\nsubtract :: Int -&gt; State Int ()\nsubtract n = state $ \\x -&gt; ((),x-n)\n\nmanyOperations :: State Int ()\nmanyOperations = do\n    add 2\n    subtract 3\n    add 5\n    --etc\n\n\nresult = execState manyOperations 5\n--result is 9\n</code></pre>\n\n<p>If we want to print out the state after each calculation is done, we use the <code>StateT</code> monad transformer:</p>\n\n<pre><code>add :: Int -&gt; StateT Int IO ()\nadd n = StateT $ \\x -&gt; print (x+n) &gt;&gt; return ((),x+n)\n\nsubtract :: Int -&gt; StateT Int IO ()\nsubtract n = StateT $ \\x -&gt; print (x-n) &gt;&gt; return ((),x-n)\n\nmanyOperations :: StateT Int IO ()\nmanyOperations = do\n    add 2\n    subtract 3\n    add 5\n\nmain = runStateT manyOperations 5\n-- prints 7, then 4, then 9\n</code></pre>\n\n<p>Is it possible to replicate this \"combined computation and printing\" without <code>StateT</code> or any custom datatypes?</p>\n\n<p>As far as I know it's possible to do all the processes that <code>MaybeT IO a</code> can do using <code>IO (Maybe a)</code>, but it seems like that's because it's just nested monads. On the other hand, <code>StateT</code> might not have an alternative because <code>s -&gt; (a,s)</code> is fundamentally different to <code>s -&gt; m (a,s)</code></p>\n\n<p>I can only see two directions the code could go: using <code>State Int (IO ())</code> or <code>IO (State Int ())</code>, but both of these seem nonsensical given the implementation of <code>StateT</code></p>\n\n<p>I believe it is impossible. Am I correct?</p>\n\n<p><em>Note: I know this is completely impractical, but I couldn't find any solution after some hours of work, which means I'm correct or my skills aren't enough for the task.</em></p>\n"}, {"tags": ["haskell", "java-8", "optional"], "answers": [{"comments": [{"owner": {"reputation": 5397, "user_id": 1149074, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/2Bm6Y.jpg?s=128&g=1", "display_name": "shock_one", "link": "https://stackoverflow.com/users/1149074/shock-one"}, "edited": false, "score": 0, "creation_date": 1422627251, "post_id": 28237159, "comment_id": 44836689, "body": "The reference syntax is <code>this::isInRoutesFile</code>."}], "tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": true, "score": 3, "last_activity_date": 1422625184, "creation_date": 1422625184, "answer_id": 28237159, "question_id": 28237057, "link": "https://stackoverflow.com/questions/28237057/boolean-predicate-guard-in-java-optional/28237159#28237159", "title": "Boolean Predicate (guard) in Java Optional", "body": "<p>It's <code>filter</code>.</p>\n\n<pre><code>return Optional.of(element)\n         .filter(isInRoutesFile)\n         .flatMap(controllerName)\n         .flatMap(name -&gt; findController(element.getProjcet(), name))\n         ...;\n</code></pre>\n\n<p>Haven't used Java 8 that much yet, so I'm not sure if you can pass the functions just like that or you need special function reference syntax, but you should get the idea.</p>\n"}], "owner": {"reputation": 5397, "user_id": 1149074, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/2Bm6Y.jpg?s=128&g=1", "display_name": "shock_one", "link": "https://stackoverflow.com/users/1149074/shock-one"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 2, "accepted_answer_id": 28237159, "answer_count": 1, "score": 1, "last_activity_date": 1422625184, "creation_date": 1422624826, "question_id": 28237057, "link": "https://stackoverflow.com/questions/28237057/boolean-predicate-guard-in-java-optional", "title": "Boolean Predicate (guard) in Java Optional", "body": "<p>Here's the method I have.</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public PsiReference[] getReferencesByElement(@NotNull PsiElement element, @NotNull ProcessingContext context) {\n    if (isInRoutesFile(element)) {\n        return controllerName(element)\n                .flatMap(name -&gt; findController(element.getProject(), name))\n                .map(controller -&gt; new PsiReference[]{new RPsiElementReference(controller)})\n                .orElse(new PsiReference[0]);\n    }\n\n    return new PsiReference[0];\n}\n</code></pre>\n\n<p>Now, I'd like to avoid the <code>if</code> clause and somehow built the predicate into the <code>Optional</code> chain in order to not duplicate <code>new PsiReference[0]</code>.</p>\n\n<p>For comparison, Haskell has a function <code>guard</code> for exactly that purpose. Here's how it would look like;</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>references :: Element -&gt; Maybe [Reference]\nreferences element = do\n    guard $ isInRoutesFile element\n    controllerName element &gt;&gt;= findController (getProject element) &gt;&gt;= Just . return . Reference\n</code></pre>\n\n<p>This code will return <code>Nothing</code>, which is equivalent to <code>Optional.empty()</code> in case <code>isInRoutesFile element</code> is <code>False</code>. What's the Java way to have a guard?</p>\n"}, {"tags": ["performance", "haskell", "recursion", "fibonacci"], "comments": [{"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1422617528, "post_id": 28234891, "comment_id": 44831491, "body": "I don&#39;t know <i>why</i> the two programs behave differently, but for me they behave the same when compiling with optimizations enabled (i.e. pass <code>-O</code> to ghc). The runtime difference is only visible when compiling without optimizations."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1422617983, "post_id": 28234891, "comment_id": 44831716, "body": "Roughly speaking, the poor performance is caused by your choice of type for <code>fibs</code>: it&#39;s too general for the compiler to perform fancy optimizations. Restrict it to  <code>[Int]</code> or <code>[Integers]</code>."}, {"owner": {"reputation": 4870, "user_id": 403875, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/439b8283080e4e2255205993da9de9ca?s=128&d=identicon&r=PG", "display_name": "dspyz", "link": "https://stackoverflow.com/users/403875/dspyz"}, "edited": false, "score": 0, "creation_date": 1422618025, "post_id": 28234891, "comment_id": 44831743, "body": "Oh right.  I forgot to compile with optimizations.  Still, even without optimizations I don&#39;t see why there should be a big-O difference."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1422639836, "post_id": 28234891, "comment_id": 44844180, "body": "Note that fibs is polymorphic. Without -O2 the fibs list is not being saved between calls so each element of fibs requires an exponential number of evaluations. With -O2 ghc identifies a specific instance (monomorphic version) of fibs and sets up a &quot;global variable&quot; to hold that specific instance."}], "owner": {"reputation": 4870, "user_id": 403875, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/439b8283080e4e2255205993da9de9ca?s=128&d=identicon&r=PG", "display_name": "dspyz", "link": "https://stackoverflow.com/users/403875/dspyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "closed_date": 1422622478, "answer_count": 0, "score": 1, "last_activity_date": 1422617199, "creation_date": 1422617199, "question_id": 28234891, "link": "https://stackoverflow.com/questions/28234891/generic-code-does-slow-fibonacci-while-specific-code-is-fast", "closed_reason": "Duplicate", "title": "Generic code does slow fibonacci while specific code is fast?", "body": "<p>This code for computing the 40'th Fibonacci number just seems to hang.  It appears to be computing it the slow recursive way.</p>\n\n<pre><code>fibs :: (Num a, Enum a) =&gt; [a]\nfibs = 0 : zipWith (+) fibs (1 : fibs)\n\nmain = do\n    print (fibs !! 40 :: Integer)\n</code></pre>\n\n<p>On the other hand, if I change the type of fibs to</p>\n\n<pre><code>fibs :: [Integer]\n</code></pre>\n\n<p>Then it computes it immediately.</p>\n\n<p>Why does changing the type to make it more specific effectively change the algorithm used to compute it? Is this a bug in GHC or is there something fundamental here?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1422616383, "post_id": 28234610, "comment_id": 44830924, "body": "Have you started that GHCi session before or after installing the package? Does the module load in a fresh session?"}, {"owner": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1422616480, "post_id": 28234610, "comment_id": 44830975, "body": "@leftaroundabout I started the GHCi session after installing the package, in a new terminal window."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1422617478, "post_id": 28234610, "comment_id": 44831465, "body": "And you&#39;re sure <code>ghc-pkg</code>/<code>cabal-install</code> and <code>ghci</code> actually use the same compiler version? Do other cabal installs work?"}, {"owner": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1422618614, "post_id": 28234610, "comment_id": 44832037, "body": "@leftaroundabout Yes, they use the same compiler version. Other cabal installs seem to work. Somehow this seems to be related to Template Haskell also."}, {"owner": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "edited": false, "score": 0, "creation_date": 1422620238, "post_id": 28234610, "comment_id": 44832881, "body": "what <code>ghc-pkg check</code> says?"}, {"owner": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "reply_to_user": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "edited": false, "score": 0, "creation_date": 1422621173, "post_id": 28234610, "comment_id": 44833357, "body": "@\u0414\u041c\u0418\u0422\u0420\u0418\u0419\u041c\u0410\u041b\u0418\u041a\u041e\u0412 a couple of warnings related to haddock-html and haddock-interfaces but nothing else."}, {"owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "edited": false, "score": 1, "creation_date": 1422635120, "post_id": 28234610, "comment_id": 44841474, "body": "Are you using sandboxes?"}, {"owner": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "reply_to_user": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "edited": false, "score": 0, "creation_date": 1422694171, "post_id": 28234610, "comment_id": 44859301, "body": "@mhwombat no i am not using sandboxes."}], "owner": {"reputation": 288, "user_id": 2801664, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fc61902904b9b6a5ab5bcb63f284c835?s=128&d=identicon&r=PG", "display_name": "Aviral Goel", "link": "https://stackoverflow.com/users/2801664/aviral-goel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 748, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1422616201, "creation_date": 1422616201, "question_id": 28234610, "link": "https://stackoverflow.com/questions/28234610/unable-to-import-lens-library", "title": "Unable to import lens library", "body": "<p>I installed haskell lens library. In ghci I try to run</p>\n\n<pre><code>\u03bb&gt; import Control.Lens\n</code></pre>\n\n<p>and it says - </p>\n\n<pre><code>&lt;no location info&gt;:\n    Could not find module \u2018Control.Lens\u2019\n    Perhaps you meant Control.Seq (from parallel-3.2.0.4)\n</code></pre>\n\n<p>I ran ghc-pkg list to list the installed packages and it does show - </p>\n\n<pre><code>lens-4.6.0.1\n</code></pre>\n\n<p>I am using GHC 7.8.3 on Ubuntu 13.04.</p>\n"}, {"tags": ["exception", "haskell", "standards"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1422617209, "post_id": 28234123, "comment_id": 44831338, "body": "I believe it&#39;s an extension. If you stick to the Report exceptions, only, everything should behave according to the report. Once you use GHC-specific extensions, their semantics is no longer mandated by the Report."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 3, "last_activity_date": 1424455940, "creation_date": 1424455940, "answer_id": 28635536, "question_id": 28234123, "link": "https://stackoverflow.com/questions/28234123/how-does-the-extensible-someexception-fit-in-with-the-haskell-standards/28635536#28635536", "title": "How does the extensible &quot;SomeException&quot; fit in with the Haskell standards?", "body": "<p>GHC still has all the machinery described in the report for <code>IOError</code>, etc.</p>\n\n<p>However, in practice that was found to be very limiting, as people needed to introduce new exception types for imprecise and later asynchronous exceptions. Thus a new module was born to manage all these types uniformly. However, this module then had the problem that while it extended the universe of exceptions available, it did so in a fixed way. Thus was born the desire for an <em>Extensible</em> mechanism for extensions. The design, motivations, and implementation were provided in a 2006 paper by Simon Marlow (<a href=\"http://community.haskell.org/~simonmar/papers/ext-exceptions.pdf\" rel=\"nofollow\">http://community.haskell.org/~simonmar/papers/ext-exceptions.pdf</a>).</p>\n\n<p>That brings us to the <code>Control.Exception</code> modules we know and love today.</p>\n\n<p>As the paper describes, the library is basically implemented in userland, with only the necessity of a few language-level constructs such as existentials and <code>Typeable</code>.</p>\n"}], "owner": {"reputation": 655, "user_id": 2424911, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6YlX9.jpg?s=128&g=1", "display_name": "Maarten Faddegon", "link": "https://stackoverflow.com/users/2424911/maarten-faddegon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1424455940, "creation_date": 1422614632, "question_id": 28234123, "link": "https://stackoverflow.com/questions/28234123/how-does-the-extensible-someexception-fit-in-with-the-haskell-standards", "title": "How does the extensible &quot;SomeException&quot; fit in with the Haskell standards?", "body": "<p>In section 7.3 of the Haskell 2010 standard I read the following:</p>\n\n<blockquote>\n  <p>The I/O monad includes a simple exception handling system. Any I/O\n  operation may raise an exception instead of returning a result.</p>\n  \n  <p>Exceptions in the I/O monad are represented by values of type IOError.\n  This is an abstract type: its constructors are hidden from the user.\n  The IO library defines functions that construct and examine IOError\n  values. The only Prelude function that creates an IOError value is\n  userError. User error values include a string describing the error.</p>\n</blockquote>\n\n<p>The text of the Haskell 98 standard is almost identical.</p>\n\n<p>In practice however I often see catch construction with SomeException from Control.Exception.Base:</p>\n\n<blockquote>\n  <p>The SomeException type is the root of the exception type hierarchy.\n  When an exception of type e is thrown, behind the scenes it is\n  encapsulated in a SomeException.</p>\n</blockquote>\n\n<p>A small experiment with GHC shows that also an IOException is encapsulated in a SomeException.</p>\n\n<pre><code>import GHC.IO(failIO)\nimport Control.Exception(catch, SomeException(..))\n\nmain :: IO ()\nmain = (x &gt;&gt;= print) `catchAll` \\e -&gt; print (\"caught: \" ++ show e)\n\nx :: IO Int\nx = failIO \"Failed to get x!\"\n\ncatchAll :: IO a -&gt; (SomeException -&gt; IO a) -&gt; IO a\ncatchAll = catch\n</code></pre>\n\n<p>Running above program gives us:</p>\n\n<pre><code>caught: user error (Failed to get x!)\n</code></pre>\n\n<p>How does this fit in with the standard? Is it a GHC specific extension of the Haskell standard?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1422612257, "post_id": 28233309, "comment_id": 44828867, "body": "Mapping in general refers to getting some value based on its linkage to some other value, not really old and new values. Can you share some background on where you saw &#39;mapping&#39; in the book?"}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "reply_to_user": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1422612513, "post_id": 28233309, "comment_id": 44828996, "body": "@shree.pat18 I often see this word in the russian translate of this ( <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">learnyouahaskell.com/chapters</a> )  book. At first I thought that it means only the <code>map</code> function using."}], "answers": [{"comments": [{"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422612607, "post_id": 28233414, "comment_id": 44829049, "body": "Thank you. Yes, I know about the <code>map</code> function existing."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1422613470, "post_id": 28233414, "comment_id": 44829496, "body": "In addition (since this is tagged <a href=\"https://stackoverflow.com/questions/tagged/haskell\">haskell</a>), you can differentiate between contextless mapping (like <code>map</code>, function application) and <code>fmap</code> - which does the mapping after the extraction from monadic/applicative/whatever context. And indeed for lists <code>fmap = map</code>"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 2, "last_activity_date": 1422620198, "last_edit_date": 1422620198, "creation_date": 1422612262, "answer_id": 28233414, "question_id": 28233309, "link": "https://stackoverflow.com/questions/28233309/is-my-understanding-of-mapping-correct/28233414#28233414", "title": "Is my understanding of *mapping* correct?", "body": "<p>Yes what you have understood is correct. Mapping means getting new values based on the old value by applying it to some function. The new value may or may not be of the same type (of the old value). In mathematics, the word mapping and function is actually used interchangeably.</p>\n\n<p>There is another concept related to mapping: <code>map</code></p>\n\n<p>map is a famous higher order function which can perform mapping on a list of values.</p>\n\n<pre><code>\u03bb&gt; map (+ 1) [1,2,3]\n[2,3,4]\n</code></pre>\n\n<p>In the previous example, you are using the <code>map</code> function to apply the function <code>(+ 1)</code> on each of the list values.</p>\n"}], "owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 28233414, "answer_count": 1, "score": 0, "last_activity_date": 1422620198, "creation_date": 1422611913, "question_id": 28233309, "link": "https://stackoverflow.com/questions/28233309/is-my-understanding-of-mapping-correct", "title": "Is my understanding of *mapping* correct?", "body": "<p>I learn Haskell. When I'm reading books (the russian translate of them) I often see the <em>mapping</em> word... I'm not sure I understand it right.</p>\n\n<p>In my understanding: the <em>mapping</em> - this is the getting of <em>new value</em> on the base of some <em>old value</em>. So it is a result of <em>any</em> function with parameters (at least one), or data constructor. The new value isn't obliged to have the same type, as old.</p>\n\n<p>I.e.</p>\n\n<pre><code>-- mapping samples:\nfunc a b = a + b \nfunc' a = show a\nfunc'' a = a\nfunc''' a = Just a\n</code></pre>\n\n<p>Am I right?</p>\n"}, {"tags": ["windows", "haskell", "ghci"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1422607360, "post_id": 28232105, "comment_id": 44826313, "body": "This may help you: <a href=\"http://stackoverflow.com/questions/25373116/how-can-i-set-my-ghci-prompt-to-a-lambda-character-on-windows\" title=\"how can i set my ghci prompt to a lambda character on windows\">stackoverflow.com/questions/25373116/&hellip;</a>"}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1422608928, "post_id": 28232105, "comment_id": 44827063, "body": "I did it (<code>chcp.com 65001</code>) but this is not help me. The <code>\u03bb</code> symbol is displayed sucessfully, but <code>\u2200</code> - not (when I try paste it). Oh, I can&#39;t paste the <code>\u03bb</code> too via the clipboard... I can print it through my code only..."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1422611814, "post_id": 28232105, "comment_id": 44828620, "body": "codepage 65001 is not UTF8, it just uses the same packing mechanism."}, {"owner": {"reputation": 42418, "user_id": 912144, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/d17cb5b704821f11179ce281b8cae25e?s=128&d=identicon&r=PG", "display_name": "Shahbaz", "link": "https://stackoverflow.com/users/912144/shahbaz"}, "edited": false, "score": 0, "creation_date": 1422616441, "post_id": 28232105, "comment_id": 44830953, "body": "Is it really more convenient to use mathematical symbols while typing? Especially with cmd.exe that doesn&#39;t support copy-paste by keyboard, switching to mouse on every type of that single character doesn&#39;t seem really convenient to me. Worse still if you have multiple of them, so you have to switch to mouse, select, copy, back to cmd.exe and paste."}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422616950, "post_id": 28232105, "comment_id": 44831208, "body": "It seems more compact and more convinient for reading. When I need write a special symbol I do it through the hot keys. For example Alt + 0169 is &#169;, or Alt + 8704 is \u2200. I got used to print special characters through the hot keys. It is convenient for me."}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 2, "creation_date": 1422620056, "post_id": 28232105, "comment_id": 44832774, "body": "This seems to work on Mac in it&#39;s Terminal: <code>*Main&gt; (+1) \u2200 [1,2]</code> <code>[2,3]</code>. I suspect this is <i>windows console</i> problem, not related to Haskell."}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422622845, "post_id": 28232105, "comment_id": 44834200, "body": "I found this: <a href=\"http://hackage.haskell.org/package/base-unicode-symbols\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-unicode-symbols</a>"}], "answers": [{"comments": [{"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422609272, "post_id": 28232354, "comment_id": 44827249, "body": "But I see many matematics symbols in <i>source codes</i> in the books too... For example: Richard Bird (University of Oxford) &quot;Pearls of Functional Algorithm Design&quot;."}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422609796, "post_id": 28232354, "comment_id": 44827514, "body": "And I thought that it perhaps is a widespread method naming of functions in Haskell (by mathematicians). When I am reading the books I try its source code too."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422609912, "post_id": 28232354, "comment_id": 44827580, "body": "@Bush As long as you want to put your code as an illustrative example in the book, it might be fine. If you want to write actual computer programs that are going to be run, you&#39;ve yourself noticed that non-ascii identifiers bring in a lot of problems for basically no reasonable gains. And they&#39;re harder to type."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422610478, "post_id": 28232354, "comment_id": 44827890, "body": "@Bush For real world code, I would suggest not to use unicode symbols. It is certainly not a widespread naming convention and none of the popular libraries in Hackage use them."}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422610564, "post_id": 28232354, "comment_id": 44827940, "body": "It surprised me that the unicode-font, doesn&#39;t support some unicode-characters (The <code>Alt + 955</code> works fine in MS Word, but doesn&#39;t work in the cmd.exe or powershell.exe, despite Unicode font and code chart)."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 2, "creation_date": 1422610620, "post_id": 28232354, "comment_id": 44827981, "body": "I think it&#39;s worth clarifying that even when you see mathematical symbols in papers and books about Haskell programs, the original source code is usually plain ASCII text. We use tools like lhs2TeX to apply systematic and hopefully attractive typesetting conventions to produce the rendering of our ASCII code that you see in print."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1422622723, "post_id": 28232354, "comment_id": 44834144, "body": "Those Unicode problems really aren&#39;t so bad on platforms other than Windows, and they should get ever less of an issue in the future. Harder to <i>type</i>? I don&#39;t really see that in a decent editor, though it&#39;s certainly a point in GHCi. Workarounds like Hasklig are cute, but they also bring problems with them (horizontal alignment, bad extendability...). IMO, real unicode identifiers are in many senses more consistent. And you can always supply a <code>YourModule.ASCII</code> for compatibility with non-unicode-capable systems, though I agree such redundancy isn&#39;t really nice either."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 1, "last_activity_date": 1422610689, "last_edit_date": 1422610689, "creation_date": 1422608342, "answer_id": 28232354, "question_id": 28232105, "link": "https://stackoverflow.com/questions/28232105/how-can-i-use-mathematic-symbols-function-name-in-the-ghci/28232354#28232354", "title": "How can I use mathematic symbols (function name) in the ghci?", "body": "<p>The most common way of getting the <em>visuals</em> of that is using a font and a text editor that supports <a href=\"http://en.wikipedia.org/wiki/Typographic_ligature\" rel=\"nofollow\">ligatures</a>, like <a href=\"https://github.com/i-tu/Hasklig\" rel=\"nofollow\">Hasklig</a>. That way it <em>looks</em> like you want it to, but it's saved as a regular ASCII file, which makes it much easier to work with with tools that don't support that technology.</p>\n\n<p>I would recommend <strong>against</strong> using actual non-ASCII characters as identifiers; it might be common in Agda, but it can get simply annoying when trying to work on the same code with multiple people, on different platforms, and so on.</p>\n"}], "owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 28232354, "answer_count": 1, "score": 2, "last_activity_date": 1422620135, "creation_date": 1422607284, "last_edit_date": 1422620135, "question_id": 28232105, "link": "https://stackoverflow.com/questions/28232105/how-can-i-use-mathematic-symbols-function-name-in-the-ghci", "title": "How can I use mathematic symbols (function name) in the ghci?", "body": "<p>I'm learning Haskell. I see an author uses some mathematic unicode chars in the code <a href=\"http://conal.net/blog/posts/everything-is-a-function-in-haskell\" rel=\"nofollow\">here</a> (<code>\u2200</code> for example). I try use it too, for example:</p>\n\n<pre><code>(\u2200) :: (a -&gt; b) -&gt; [a] -&gt; [b]\nf \u2200 [] = []\nf \u2200 (x:xs) = f x : f \u2200 xs\n</code></pre>\n\n<p><code>ghci</code> loads this sucessfully, but I can't call this function... When I try paste the <code>\u2200</code> symbol into <code>ghci</code> console from the clipboard, nothing happens (Windows 7, <em>Lucida console</em> font). </p>\n\n<p>It is very convenient - to use mathematic symbols (in my opinion). How can I use it in the <code>ghci</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1422608588, "post_id": 28231985, "comment_id": 44826881, "body": "What is different between the two AST types?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1422608763, "post_id": 28231985, "comment_id": 44826974, "body": "Scrap Your Boilerplate, perhaps?"}], "answers": [{"comments": [{"owner": {"reputation": 3533, "user_id": 3364697, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/df2e647c1f95880840f3833ada51da07?s=128&d=identicon&r=PG&f=1", "display_name": "iamnat", "link": "https://stackoverflow.com/users/3364697/iamnat"}, "edited": false, "score": 0, "creation_date": 1422614687, "post_id": 28233955, "comment_id": 44830088, "body": "I think the OP&#39;s intent is to 1) reduce the boilerplate by not writing <i>type declarations</i> for I (since most of I&#39;s AST is similar to E), and then 2) only write <i>functions explicitly converting I values to E values</i> (for those few types that are different), and not write the rest. Your code is probably what he already has. This problem could be solved with Template Haskell, but could be ugly."}, {"owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "reply_to_user": {"reputation": 3533, "user_id": 3364697, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/df2e647c1f95880840f3833ada51da07?s=128&d=identicon&r=PG&f=1", "display_name": "iamnat", "link": "https://stackoverflow.com/users/3364697/iamnat"}, "edited": false, "score": 0, "creation_date": 1422742675, "post_id": 28233955, "comment_id": 44872450, "body": "@tanmaig: If the approach from my answer is applicable at all, it achieves both these goals. In particular: (1) The type declaration for Reusable is written only once, not twice in E and I. (2) There is an explicit convertRoot, because E.Root and I.Root differ, but there is no explicit convertReusable, because the automatically generated traverse does the job just fine."}, {"owner": {"reputation": 3533, "user_id": 3364697, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/df2e647c1f95880840f3833ada51da07?s=128&d=identicon&r=PG&f=1", "display_name": "iamnat", "link": "https://stackoverflow.com/users/3364697/iamnat"}, "edited": false, "score": 0, "creation_date": 1422880126, "post_id": 28233955, "comment_id": 44909817, "body": "I understand, but I don&#39;t know how traverse will work on a &#39;Reusable&#39; traversable type with multiple type params instead of just one. Say, the AST is: <code>data Reusable aRoot bRoot cRoot</code> How will the traversable typeclass be derived in that case?"}, {"owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "reply_to_user": {"reputation": 3533, "user_id": 3364697, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/df2e647c1f95880840f3833ada51da07?s=128&d=identicon&r=PG&f=1", "display_name": "iamnat", "link": "https://stackoverflow.com/users/3364697/iamnat"}, "edited": false, "score": 0, "creation_date": 1423076438, "post_id": 28233955, "comment_id": 45005948, "body": "@tanmaig: Ah, that&#39;s a good question. I agree that in this case, plain <code>traverse</code> is not good enough."}], "tags": [], "owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "is_accepted": false, "score": 2, "last_activity_date": 1422718905, "last_edit_date": 1422718905, "creation_date": 1422614100, "answer_id": 28233955, "question_id": 28231985, "link": "https://stackoverflow.com/questions/28231985/ast-conversion-in-haskell/28233955#28233955", "title": "AST conversion in Haskell", "body": "<p>Sometimes you can factor out the common aspects of <code>E.Root</code> and <code>I.Root</code> into one ore more reusable datatypes. It usually also helps to hide the <code>AdditionalInfo -&gt; ...</code> in a monad or an applicative functor. For example, here's some pseudocode:</p>\n\n<pre><code>module Common where\n  {-# LANGUAGE DeriveTraversable #-}\n  data Reusable root = ... root ...\n    deriving (Functor, Foldable, Traversable)\n\nmodule E where\n  import Common\n  data Root = Leaf (Reusable Root) | Node Root\n\nmodule I where\n  {-# LANGUAGE GeneralizedNewtypeDeriving #-}\n  import Common\n\n  import Data.Monoid\n\n  data Root = Root [Reusable Root]\n    deriving Monoid\n\nmodule Transform where\n  import Common\n  import qualified E\n  import qualified I\n\n  import Control.Applicative\n  import Control.Monad.Reader\n  import Data.Monoid\n\n  type AdditionalInput = ...\n  type F = Reader AdditionalInput\n\n  convertRoot :: E.Root -&gt; F I.Root\n  convertRoot (Leaf reusable) =\n    traverse convertRoot reusable\n  convertRoot (Node left right) =\n    liftA2 mappend (convertRoot left) (convertRoot right)\n</code></pre>\n\n<p>Now I can use <code>traverse</code> to convert between <code>Reusable E.Root</code> and <code>Reusable I.Root</code>.</p>\n"}], "owner": {"reputation": 127, "user_id": 4270616, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b3a4832cbc4dad09193b766410eec381?s=128&d=identicon&r=PG&f=1", "display_name": "svr", "link": "https://stackoverflow.com/users/4270616/svr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1422718905, "creation_date": 1422606655, "question_id": 28231985, "link": "https://stackoverflow.com/questions/28231985/ast-conversion-in-haskell", "title": "AST conversion in Haskell", "body": "<p>I've an AST whose root node is of type <code>E.Root</code>. I need to convert it into an AST with root node whose type is <code>I.Root</code>. </p>\n\n<p>I can now define a function <code>eToI</code> with type signature :</p>\n\n<pre><code>eToI :: E.Root -&gt; AdditionalInfo -&gt; I.Root\n</code></pre>\n\n<p>However, both the ASTs share a lot of nodes. So, the function <code>eToF</code> has a lot of boilerplate code building <code>I's</code> nodes from <code>E's</code> nodes which are essentially the same.</p>\n\n<p>I would like to solve these 2 problems :</p>\n\n<ol>\n<li><p>At the type level, avoid defining the nodes of <code>I</code>. I have all the nodes\nof <code>E</code> defined. I define what nodes change in <code>I</code>. Can I have the\ncompiler generate all the types in <code>I</code>, by somehow mapping what\nneeds to change? </p></li>\n<li><p>At the value level, I'd only want to define transformations for the\n    nodes that change like (assuming E's A is mapped to I's Z ..) :  </p>\n\n<pre><code>    aToZ :: E.A -&gt; AdditionalInfo -&gt; I.Z\n    bToY :: E.B -&gt; AdditionalInfo -&gt; I.Y\n</code></pre>\n\n<p>Now, can the compiler generate a function like eToI?</p>\n\n<pre><code>    eToI :: E.Root -&gt; AdditionalInfo -&gt; I.Root\n</code></pre></li>\n</ol>\n\n<p>What's Haskell's idiomatic approach to do this?</p>\n"}, {"tags": ["xml", "haskell", "svg", "haxml"], "answers": [{"tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 1, "last_activity_date": 1422613252, "creation_date": 1422613252, "answer_id": 28233694, "question_id": 28230915, "link": "https://stackoverflow.com/questions/28230915/how-to-get-element-values-in-haxml/28233694#28233694", "title": "How to get Element values in HaXml?", "body": "<p>There are some functions provided for handling the parsed document, just not any that simply fetch the name of a tag. Most of them are in <code>Text.XML.HaXml.Combinators</code>. There are functions included for things like finding the children of the current node, filtering by tag name (I didn't see one for just extracting the tag name), filtering by attribute, etc.</p>\n\n<p>You can see the reference at <a href=\"http://hackage.haskell.org/package/HaXml-1.20.2/docs/Text-XML-HaXml-Combinators.html\" rel=\"nofollow\">http://hackage.haskell.org/package/HaXml-1.20.2/docs/Text-XML-HaXml-Combinators.html</a></p>\n\n<p>I do agree that a lot of obvious functions seem to be missing from that package.</p>\n"}], "owner": {"reputation": 2813, "user_id": 4463660, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a7834b35fe2ac4b9d405e0b9f1b1bf10?s=128&d=identicon&r=PG&f=1", "display_name": "Citronen", "link": "https://stackoverflow.com/users/4463660/citronen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422613252, "creation_date": 1422601744, "question_id": 28230915, "link": "https://stackoverflow.com/questions/28230915/how-to-get-element-values-in-haxml", "title": "How to get Element values in HaXml?", "body": "<p>I'm using HaXml to parse an SVG file. I can, so far, locate elements based on attributes and parse them into a <a href=\"http://hackage.haskell.org/package/HaXml-1.20.2/docs/Text-XML-HaXml-Types.html#t:Element\" rel=\"nofollow\">HaXml <code>Element</code> datatype.</a></p>\n\n<p>I'm now trying to parse the <code>Element</code> using the HaXml package, but have been unsuccessful.</p>\n\n<p>I've resorted to creating my own function that works, but it would be good to use resources from HaXml if possible.</p>\n\n<p>Here is the function that I have used to parse the name of an <code>Element</code>.</p>\n\n<pre><code>getName :: Element s -&gt; QName\ngetName (Elem a _ _) = a\n</code></pre>\n\n<p>Is there any way to do this with the HaXml package? I've searched, but so far found nothing.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["list", "haskell", "recursion", "tuples"], "answers": [{"comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1422598566, "post_id": 28230221, "comment_id": 44822984, "body": "Also, the function can be more polymorphic."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1422600168, "post_id": 28230221, "comment_id": 44823529, "body": "It can be more concise: <code>check :: Eq a =&gt; a -&gt; [a] -&gt; Bool</code> :)"}, {"owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1422600289, "post_id": 28230221, "comment_id": 44823566, "body": "@Sibi Right, but this looks more clear and easy to understand right? :)"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1422601204, "post_id": 28230221, "comment_id": 44823934, "body": "I agree with that. :)"}], "tags": [], "owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "is_accepted": true, "score": 2, "last_activity_date": 1422607303, "last_edit_date": 1495542511, "creation_date": 1422598448, "answer_id": 28230221, "question_id": 28230139, "link": "https://stackoverflow.com/questions/28230139/haskell-recursively-check-elements-of-associative-list/28230221#28230221", "title": "Haskell- recursively check elements of associative list", "body": "<ol>\n<li><p>Your data has Number and String but your function reads String and Number. So that has to be changed to this</p>\n\n<pre><code>check :: (Int, String) -&gt; [(Int, String)] -&gt; Bool\n</code></pre></li>\n<li><p>Your recursion should have a base condition, like this</p>\n\n<pre><code>check val [] = False\n</code></pre>\n\n<p>It means that if the list is empty (all elements are checked), return <code>False</code>.</p></li>\n</ol>\n\n<p>So your function should look like this</p>\n\n<pre><code>check :: (Int, String) -&gt; [(Int, String)] -&gt; Bool\n\ncheck val [] = False\ncheck val (x:xs)\n    | x == val = True\n    | otherwise = check val xs\n</code></pre>\n\n<p><a href=\"http://ideone.com/NVw0j0\" rel=\"nofollow noreferrer\">Online Demo</a></p>\n\n<hr>\n\n<p>As it is, you can make your function Polymorphic by doing</p>\n\n<pre><code>check :: Eq a =&gt; (a, String) -&gt; [(a, String)] -&gt; Bool\n</code></pre>\n\n<p>To know more about <code>Eq a</code>, please check <a href=\"https://stackoverflow.com/a/5012238/1903116\">this excellent answer</a></p>\n\n<hr>\n\n<p>Just for the sake of completion, you can always use <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Prelude.html#v:elem\" rel=\"nofollow noreferrer\"><code>elem</code></a> function, like this</p>\n\n<pre><code>Prelude&gt; elem (6548712, \"Charlie Brown\") [(6548712, \"Charlie Brown\"), (27378912, \"Linux Van Pelt\"), (5831457, \"Peppermint Patty\")]\nTrue\n</code></pre>\n"}], "owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 1, "accepted_answer_id": 28230221, "answer_count": 1, "score": 1, "last_activity_date": 1422607303, "creation_date": 1422597986, "last_edit_date": 1422598467, "question_id": 28230139, "link": "https://stackoverflow.com/questions/28230139/haskell-recursively-check-elements-of-associative-list", "title": "Haskell- recursively check elements of associative list", "body": "<p>Say I have the following associative list:</p>\n\n<pre><code>names = [(6548712, \"Charlie Brown\"), (27378912, \"Linux Van Pelt\"), (5831457, \"Peppermint Patty\")]\n</code></pre>\n\n<p>I want to check if a given tuple, such as...</p>\n\n<pre><code> (6548712, \"Charlie Brown\")\n</code></pre>\n\n<p>...exists within the associative list. </p>\n\n<p>Here is my function:</p>\n\n<pre><code>check :: (String,a) -&gt; [(String,a)] -&gt; Bool\ncheck val (x:xs)\n    | x == val = True\n    | otherwise = check val xs\n</code></pre>\n\n<p>The function does not work. I think the error lies in my first guard, since I do believe my recursive call is correct. I want to be able to do this using recursion, can someone help me out?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 1, "last_activity_date": 1422594552, "creation_date": 1422594552, "answer_id": 28229584, "question_id": 28229529, "link": "https://stackoverflow.com/questions/28229529/haskell-return-true-if-key-is-in-associative-list/28229584#28229584", "title": "Haskell- return True if key is in associative list", "body": "<p>In haskell, guards should evaluate to a boolean value. So, something like this will work:</p>\n\n<pre><code>check :: String -&gt; [(String,a)] -&gt; Bool\ncheck val alist\n    | length [ key | (key,num) &lt;-alist, key==val] &gt;= 1 = True\n    | otherwise = False\n</code></pre>\n\n<p>But note that this will have to traverse the entire list.</p>\n\n<p>Whereas in the following code it doesn't have to traverse the entire list and is more efficient:</p>\n\n<pre><code>check :: String -&gt; [(String,a)] -&gt; Bool\ncheck val alist\n    | efficientCheck [ key | (key,num) &lt;-alist, key==val] = True\n    | otherwise = False\n\nefficientCheck :: [a] -&gt; Bool\nefficientCheck (x:xs) = True\nefficientCheck _ = False\n</code></pre>\n\n<p>Demo:</p>\n\n<pre><code>\u03bb&gt; check \"bye\" [(\"hi\",3)]\nFalse\n\u03bb&gt; check \"hi\" [(\"hi\",3),(\"bye\",4)]\nTrue\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1424, "user_id": 756714, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0c58c5ad07c97f187f3a9241c4d2639?s=128&d=identicon&r=PG", "display_name": "vivian", "link": "https://stackoverflow.com/users/756714/vivian"}, "is_accepted": false, "score": 3, "last_activity_date": 1422594644, "creation_date": 1422594644, "answer_id": 28229598, "question_id": 28229529, "link": "https://stackoverflow.com/questions/28229529/haskell-return-true-if-key-is-in-associative-list/28229598#28229598", "title": "Haskell- return True if key is in associative list", "body": "<p>You are using a list comprehension that is of type <code>[String]</code> in a guard where a <code>Bool</code> is expected.</p>\n\n<p>What you need to do is check whether that list comprehension is empty or not.  Using, for example, <code>null</code>.</p>\n\n<pre><code>check :: String -&gt; [(String,a)] -&gt; Bool\ncheck val alist = not $ null [ key | (key,num) &lt;- alist, key==val ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 2, "last_activity_date": 1422594650, "creation_date": 1422594650, "answer_id": 28229601, "question_id": 28229529, "link": "https://stackoverflow.com/questions/28229529/haskell-return-true-if-key-is-in-associative-list/28229601#28229601", "title": "Haskell- return True if key is in associative list", "body": "<p>The expression in a guard clause has to evaluate to a <code>Bool</code>.  This isn't Python, it doesn't happen automatically.  Try</p>\n\n<pre><code>check val alist\n    | not $ null [key | (key, num) &lt;- alist, key == val] = True\n    | otherwise = False\n</code></pre>\n\n<p>But this can be written simpler as simply</p>\n\n<pre><code>check val alist = not $ null [key | (key, num) &lt;- alist, key == val]\n</code></pre>\n\n<p>Since the guard is just checking if a value is <code>True</code> or <code>False</code>.</p>\n"}], "owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 28229584, "answer_count": 3, "score": 0, "last_activity_date": 1422594650, "creation_date": 1422594205, "question_id": 28229529, "link": "https://stackoverflow.com/questions/28229529/haskell-return-true-if-key-is-in-associative-list", "title": "Haskell- return True if key is in associative list", "body": "<p>I am trying to create a function that accepts a String as parameter and returns a boolean <code>True</code> if the String exists as a key value in the following associative list:</p>\n\n<pre><code>lis = [(\"Kingston\", [12.2, 17.3, 9.1]), (\"Ottawa\", [10.0, 13.9, 8.2])]\n</code></pre>\n\n<p>This is my function, I want to be able to do this using list comprehension if possible:</p>\n\n<pre><code>check :: String -&gt; [(String,a)] -&gt; Bool\ncheck val alist\n    | [ key | (key,num)&lt;-alist, key==val] = True\n    | otherwise = False\n</code></pre>\n\n<p>The error I get, if it helps, is:</p>\n\n<pre><code>Couldn't match expected type \u2018Bool\u2019 with actual type \u2018[String]\u2019\n</code></pre>\n\n<p>Can someone show me what my mistake is?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1422592708, "post_id": 28229224, "comment_id": 44821482, "body": "This mostly matters when the limits aren&#39;t (both) constant. <code>[0..n]</code> is a lot easier to work with when it doesn&#39;t automagically change direction at 0."}], "answers": [{"tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 3, "last_activity_date": 1422592428, "creation_date": 1422592428, "answer_id": 28229283, "question_id": 28229224, "link": "https://stackoverflow.com/questions/28229224/haskell-list-confusion/28229283#28229283", "title": "Haskell-list confusion", "body": "<p>From <a href=\"http://en.wikibooks.org/wiki/Haskell/Syntactic_sugar\" rel=\"nofollow\">Wikibooks</a>, Arithmetic sequences are desugared as:</p>\n\n<pre><code>[1..5]   \u2192 enumFromTo 1 5\n[1,3..9] \u2192 enumFromThenTo 1 3 9\n[1..]    \u2192 enumFrom 1\n[1,3..]   \u2192 enumFromThen 1 3\n</code></pre>\n\n<p>So <code>[5,4..1]</code> is desugared into <code>enumFromThenTo 5 4 1</code>, but <code>[5..1]</code> to <code>enumFromTo 5 1</code>.</p>\n\n<p>You could define them as you wish for your data types. The functions are part of <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/Prelude.html#t:Enum\" rel=\"nofollow\"><code>Enum</code> type-class</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1422603884, "creation_date": 1422603884, "answer_id": 28231387, "question_id": 28229224, "link": "https://stackoverflow.com/questions/28229224/haskell-list-confusion/28231387#28231387", "title": "Haskell-list confusion", "body": "<p>The <code>[n..m]</code> list enumerates those numbers <code>x</code> such that <code>n &lt;= x &amp;&amp; x &lt;= m</code>. If <code>m&lt;n</code>, no such <code>x</code> can exist, hence the result is empty.</p>\n\n<p>Note that this convention helps when translating the idiomatic imperative loop</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// Does nothing if m&lt;n\nfor (int x=n; x &lt;= m ; x++) { ... }\n</code></pre>\n\n<p>which could transform into</p>\n\n<pre><code>map (...) [n..m]   -- or foldr, or ...\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>forM_ [n..m] $ \\x -&gt; ...\n</code></pre>\n\n<p>This convention is shared with some other languages, e.g. Python, where <code>range(n,m)</code> is roughly equivalent to <code>[n..m-1]</code>. Indeed, <code>range(1,1)</code> is empty, as well as <code>range(1,0)</code> and <code>range(1,-1)</code> and so on.</p>\n"}], "owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 28229283, "answer_count": 2, "score": 1, "last_activity_date": 1422603884, "creation_date": 1422591926, "last_edit_date": 1422592292, "question_id": 28229224, "link": "https://stackoverflow.com/questions/28229224/haskell-list-confusion", "title": "Haskell-list confusion", "body": "<p>To create a list of 5 numbers, the following is possible :</p>\n\n<pre><code>[1..5]\n</code></pre>\n\n<p>One may also start from greatest to lowest:</p>\n\n<pre><code>[5,4..1]\n</code></pre>\n\n<p>But what does not make sense is that if you were to create a list as so, you get an empty list:</p>\n\n<pre><code>[5..1]\n</code></pre>\n\n<p>Is there perhaps an explanation as to why an empty list is returned for the last snippet? It does not makes sense to me why you have to specify the gap between each number, just as in the second snippet above.</p>\n\n<p>If it works from lowest to greatest, I would assume it wouldn't be too hard to make the language work from greatest to lowest. Is there an underlying reason as to why Haskell does not allow for this, vulnerability issues perhaps?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1422597786, "post_id": 28229211, "comment_id": 44822744, "body": "I may be wrong, but I <i>think</i> the <i>main</i> thing <code>GHC.Exts</code> is for is exporting everything GHC-internal which users might want to import, so that the developers don&#39;t have to worry about reorganizing the other internal modules. As a side effect of this, it has also become the official path for importing GHC-specific extension stuff."}], "answers": [{"comments": [{"owner": {"reputation": 286, "user_id": 3408454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff230afe71e06b8852fae0371213e2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Witschey", "link": "https://stackoverflow.com/users/3408454/jim-witschey"}, "edited": false, "score": 0, "creation_date": 1422598765, "post_id": 28229959, "comment_id": 44823061, "body": "Ah, I see. So, just to make sure I understand:  <code>-XTransformListComp</code> enables a GHC extension. That extension is not implemented in Haskell, except for a couple pieces. The pure-Haskell pieces live in GHC.Exts, along with pieces of other extensions that, like <code>sortWith</code>, don&#39;t live in their own module."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "reply_to_user": {"reputation": 286, "user_id": 3408454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff230afe71e06b8852fae0371213e2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Witschey", "link": "https://stackoverflow.com/users/3408454/jim-witschey"}, "edited": false, "score": 1, "creation_date": 1422599325, "post_id": 28229959, "comment_id": 44823250, "body": "@mambocab Yup, you got it! In <code>GHC.Exts</code>, after all the primitives it&#39;s all extensions to either give an interface (like with <code>XOverloadedLists</code>), or to provide functionality without hard-coding too much on the extension (like in here). It&#39;s pretty dangerous and there&#39;s really no need for it, so might as-well make the extension <i>just</i> call regular functions. And the <code>GHC.Exts</code> would be the place to put them, of course). Except for the primitives, everything there isn&#39;t really &quot;vanilla&quot; Haskell, so to speak."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "reply_to_user": {"reputation": 286, "user_id": 3408454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff230afe71e06b8852fae0371213e2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Witschey", "link": "https://stackoverflow.com/users/3408454/jim-witschey"}, "edited": false, "score": 0, "creation_date": 1422599383, "post_id": 28229959, "comment_id": 44823269, "body": "I think the primitives are there too because there&#39;s freedom on the compilers on how to implement them (by the specification), so while their existence is a rigid part of Haskell, their implementation isn&#39;t, and here it&#39;s specific to how GHC chose to implement them."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1422599647, "post_id": 28229959, "comment_id": 44823374, "body": "Only moderately stable primitives make it into <code>GHC.Exts</code>. There are some experimental things in <code>GHC.Prim</code>, etc."}, {"owner": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "reply_to_user": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1534052702, "post_id": 28229959, "comment_id": 90567677, "body": "@CMCDragonkai the type is <code>sortWith :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]</code>, so presumably you&#39;d use tuples to do a multi-property sort: <code>sortWith (\\x -&gt; (prop1 x, prop2 x, prop3 x, \u2026)) xs</code>. Checking the implementation, it&#39;s <code>sortWith f = sortBy (\\x y -&gt; compare (f x) (f y))</code>, so that&#39;s the way to do it."}], "tags": [], "owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "is_accepted": true, "score": 8, "last_activity_date": 1422600362, "last_edit_date": 1422600362, "creation_date": 1422596941, "answer_id": 28229959, "question_id": 28229211, "link": "https://stackoverflow.com/questions/28229211/what-is-ghc-exts-and-how-were-its-contents-chosen/28229959#28229959", "title": "What is GHC.Exts, and how were its contents chosen?", "body": "<p>Those functions and the <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/GHC-Exts.html#t:Down\" rel=\"noreferrer\"><code>Down</code></a> newtype are for a syntactic extension: <a href=\"https://downloads.haskell.org/~ghc/7.2.2/docs/html/users_guide/syntax-extns.html#generalised-list-comprehensions\" rel=\"noreferrer\">Generalised (SQL-Like) List Comprehensions</a>, enabled with <code>-XTransformListComp</code>.</p>\n\n<p>This extension introduces keywords that correspond to those functions:</p>\n\n<blockquote>\n  <p>There are three new keywords: <code>group</code>, <code>by</code>, and <code>using</code>. (The function\n  <code>sortWith</code> is not a keyword; it is an ordinary function that is exported\n  by <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.7.0.2/GHC-Exts.html\" rel=\"noreferrer\"><code>GHC.Exts</code></a>.)</p>\n</blockquote>\n\n<p>Those functions are working on lists, but they really belong to an extension (and <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.7.0.2/GHC-Exts.html\" rel=\"noreferrer\"><code>GHC.Exts</code></a> is the extensions' home).</p>\n\n<p>And the reason <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.7.0.2/GHC-Exts.html\" rel=\"noreferrer\"><code>GHC.Exts</code></a> exports a varied mixture of stuff is because there are a varied mixture of extensions.</p>\n\n<p>If you'd like to see more, see the <a href=\"https://downloads.haskell.org/~ghc/7.2.2/docs/html/users_guide/syntax-extns.html#generalised-list-comprehensions\" rel=\"noreferrer\">user guide page</a> -- and for even more, the <a href=\"http://research.microsoft.com/en-us/um/people/simonpj/papers/list-comp/\" rel=\"noreferrer\">paper</a> for it by Phil Wadler and Simon Peyton Jones. It's actually quite exciting imo, here's an example from the user guide page:</p>\n\n<p>I truncated it, but you can say stuff like:</p>\n\n<pre><code>[ .. | (name, dept, salary) &lt;- employees\n, then group by dept\n, then sortWith by (sum salary)\n, then take 5 ]\n</code></pre>\n\n<p>And as another example:</p>\n\n<pre><code>output = [x| y &lt;- [1..5], x &lt;- \"hello\"\n, then group using inits]\n</code></pre>\n\n<p>Yields:</p>\n\n<pre><code>[\"\",\"h\",\"he\",\"hel\",\"hell\",\"hello\",\"helloh\",\"hellohe\",\"hellohel\",\"hellohell\",\"hellohello\",\"hellohelloh\",...]\n</code></pre>\n"}], "owner": {"reputation": 286, "user_id": 3408454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff230afe71e06b8852fae0371213e2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Witschey", "link": "https://stackoverflow.com/users/3408454/jim-witschey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 1, "accepted_answer_id": 28229959, "answer_count": 1, "score": 11, "last_activity_date": 1422600362, "creation_date": 1422591809, "question_id": 28229211, "link": "https://stackoverflow.com/questions/28229211/what-is-ghc-exts-and-how-were-its-contents-chosen", "title": "What is GHC.Exts, and how were its contents chosen?", "body": "<p>The <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.7.0.2/GHC-Exts.html\" rel=\"noreferrer\">GHC.Exts</a> module in the Haskell standard library claims that it</p>\n\n<blockquote>\n  <p>is the Approved Way to get at GHC-specific extensions.</p>\n</blockquote>\n\n<p>If that's true, it explains the inclusion of implementation-specific constants like <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.7.0.2/GHC-Exts.html#g:2\" rel=\"noreferrer\">the constant representing the maximum size of a tuple</a> and (presumably) non-portable <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.7.0.2/GHC-Exts.html#g:6\" rel=\"noreferrer\">debugging functions</a>.</p>\n\n<p>However, it doesn't explain why <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.7.0.2/GHC-Exts.html#v:sortWith\" rel=\"noreferrer\"><code>sortWith</code></a> is in this module. <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.7.0.2/src/GHC-Exts.html#sortWith\" rel=\"noreferrer\">Its implementation</a> looks like normal, portable Haskell to me.\nI'd expect to see it in, e.g., Data.List and Data.Sequence.</p>\n\n<p>It seems I misunderstand what GHC.Exts is, I don't understand the underlying logic behind its collection of exports, or there's some historical reason it exports a hodgepodge of things.</p>\n\n<p>So, <strong>what is GHC.Exts for</strong>? and <strong>why does it export such a weird mixture of stuff</strong>?</p>\n"}, {"tags": ["haskell", "type-declaration"], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 8, "creation_date": 1422574577, "post_id": 28226591, "comment_id": 44816613, "body": "Just as importantly, <code>a</code> is not special: <i>any</i> lower-case identifier means that. It&#39;s a type <i>variable</i>, and it&#39;s possible for multiple different type variables to exist in the same signature. For example, <code>const ::  a -&gt; b -&gt; a</code> takes in two arguments, each of any type at all, and returns a value with the same type as its first input."}, {"owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "edited": false, "score": 2, "creation_date": 1422575192, "post_id": 28226591, "comment_id": 44816821, "body": "I see, its very generic-like. So, I guess, in most cases, <code>a</code> would generally represent elements that my function doesn&#39;t really use, or change, too much."}, {"owner": {"reputation": 21422, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "reply_to_user": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "edited": false, "score": 1, "creation_date": 1422575520, "post_id": 28226591, "comment_id": 44816930, "body": "@Bolboa: Yes, it is closely related to the concept of &quot;generics&quot; in other languages. And yes, if the type is completely generic, there is little you can do directly to the value itself. Haskell does have a way of giving more information about the type (for example, &quot;can be compared for equality&quot;, &quot;can be printed&quot;, &quot;can be treated like a number&quot;), which allows you to do more processing on the values; if you&#39;re interested in this then look up &quot;classes&quot; in the documentation or a tutorial."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "edited": false, "score": 4, "creation_date": 1422575719, "post_id": 28226591, "comment_id": 44817005, "body": "@Bolboa Indeed, for instance a function <code>f :: [a] -&gt; [a]</code> can not produce in its output anything which was not present in its input, since it is &quot;generic&quot;. For instance <code>f [1,2]</code> can not produce <code>[2,3]</code>. Similarly, your <code>contains</code> function can not output anything new, and you can see that just from the type, without even looking at the code."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1422645258, "post_id": 28226591, "comment_id": 44846792, "body": "What @chi describes is called &#39;the parametricity property&#39;, if you&#39;re looking for a keyword to Google."}], "tags": [], "owner": {"reputation": 21422, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "is_accepted": true, "score": 12, "last_activity_date": 1422573792, "creation_date": 1422573792, "answer_id": 28226591, "question_id": 28226559, "link": "https://stackoverflow.com/questions/28226559/haskell-type-declaration-what-is-a/28226591#28226591", "title": "Haskell-(Type declaration) what is &quot;a&quot;?", "body": "<p>Yes, you're right, it represents \"any type\" - the restriction being that all <code>a</code>s in a given type signature must resolve to the same type. So you can input a list of any type, but when you use <code>contains</code> to look up a value in the list, the value you look up must be the same type as the elements of the list - which makes sense of course.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422587218, "post_id": 28227226, "comment_id": 44820147, "body": "Much more useful: <code>-XScopedTypeVariables</code>. Also, C++ templates seem to be inherently rather different from either Haskell/ML/... type variables or even Java Generics."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 1, "last_activity_date": 1422577601, "creation_date": 1422577601, "answer_id": 28227226, "question_id": 28226559, "link": "https://stackoverflow.com/questions/28226559/haskell-type-declaration-what-is-a/28227226#28227226", "title": "Haskell-(Type declaration) what is &quot;a&quot;?", "body": "<p>In Haskell, uppercase types are concrete types (<code>Int</code>, <code>Bool</code>) or type constructors (<code>Maybe</code>, <code>Either</code>) while lowercase types are <em>type variables</em>. A function is implicitly generic in all the type variables it uses, so this:</p>\n\n<pre><code>contains :: Int -&gt; [(Int, a)] -&gt; [a]\n</code></pre>\n\n<p>Is shorthand for this*:</p>\n\n<pre><code>contains :: forall a. Int -&gt; [(Int, a)] -&gt; [a]\n</code></pre>\n\n<p>In C++, <code>forall</code> is spelled <code>template</code>:</p>\n\n<pre><code>template&lt;typename a&gt;\nlist&lt;a&gt; contains(int, list&lt;pair&lt;int, a&gt;&gt;);\n</code></pre>\n\n<p>In Java and C#, it\u2019s spelled with angle brackets:</p>\n\n<pre><code>list&lt;a&gt; contains&lt;a&gt;(int, list&lt;pair&lt;int, a&gt;&gt;);\n</code></pre>\n\n<p>Of course, in these languages, generic type variables are often called <code>T</code>, <code>U</code>, <code>V</code>, while in Haskell they\u2019re often called <code>a</code>, <code>b</code>, <code>c</code>. It\u2019s just a difference of convention.</p>\n\n<p>* This syntax is enabled by the <code>-XExplicitForAll</code> flag in GHC, as well as other extensions.</p>\n"}], "owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 28226591, "answer_count": 2, "score": 5, "last_activity_date": 1422577601, "creation_date": 1422573649, "last_edit_date": 1422576068, "question_id": 28226559, "link": "https://stackoverflow.com/questions/28226559/haskell-type-declaration-what-is-a", "title": "Haskell-(Type declaration) what is &quot;a&quot;?", "body": "<p>This is perhaps a very basic question, but, nevertheless, it does not seem to have been covered on SO.</p>\n\n<p>I recently took up Haskell and up until now type declarations consisted of mostly the following:</p>\n\n<pre><code>Int\nBool\nFloat\netc, etc\n</code></pre>\n\n<p>Now I am getting into lists and I am seeing type declarations that use <code>a</code>, such as in the following function that iterates through an associative list:</p>\n\n<pre><code>contains :: Int -&gt; [(Int,a)] -&gt; [a]\ncontains x list = [values | (key,values)&lt;-list, x==key]\n</code></pre>\n\n<p>Can someone provide an explanation as to what this <code>a</code> is, and how it works? From observation it seems to represent every type. Does this mean I can input any list of any type as parameter? </p>\n"}, {"tags": ["r", "haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1422556911, "post_id": 28221948, "comment_id": 44807383, "body": "Why not something like <a href=\"http://lpaste.net/119527\" rel=\"nofollow noreferrer\">this</a> ?"}, {"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1422557115, "post_id": 28221948, "comment_id": 44807505, "body": "the point is in haskell it could be one function that handles both cases, dispatching one or the other depending on the parameter value. Also I&#39;m looking for the R equivalent of Haskell, not Haskell code."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422557485, "post_id": 28221948, "comment_id": 44807694, "body": "I found <a href=\"http://mentalmodels.princeton.edu/skhemlani/2013/02/16/ml-like-pattern-matching-and-its-limitations-in-r/\" rel=\"nofollow noreferrer\">this</a> which seems to extend R to add a limited form of pattern matching."}, {"owner": {"reputation": 830, "user_id": 2167532, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ggaVE.png?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/2167532/sebastian"}, "edited": false, "score": 0, "creation_date": 1427911609, "post_id": 28221948, "comment_id": 46971512, "body": "There is a package called lambda.r which I think addresses pattern matching and guards."}], "answers": [{"comments": [{"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 1, "creation_date": 1422558613, "post_id": 28222545, "comment_id": 44808276, "body": "haskell can pattern match on value. it&#39;s somewhat of a language idiom, for example <a href=\"http://learnyouahaskell.com/syntax-in-functions\" rel=\"nofollow noreferrer\">learnyouahaskell.com/syntax-in-functions</a>"}], "tags": [], "owner": {"reputation": 48116, "user_id": 2725969, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/t13vb.jpg?s=128&g=1", "display_name": "BrodieG", "link": "https://stackoverflow.com/users/2725969/brodieg"}, "is_accepted": false, "score": 1, "last_activity_date": 1422558190, "creation_date": 1422558190, "answer_id": 28222545, "question_id": 28221948, "link": "https://stackoverflow.com/questions/28221948/haskell-style-pattern-matching-of-parameter-values-for-function-calls-in-r/28222545#28222545", "title": "haskell style pattern matching of parameter values for function calls in R", "body": "<p>This can be done based on the \"class\" of the object, but not the value.  I am not super familiar with Haskell, but I though Haskell also dispatches on class/type rather than actual value?  Here is the R implementation:</p>\n\n<pre><code>&gt; foo &lt;- function(a) UseMethod(\"foo\")\n&gt; foo.1 &lt;- function(a) paste(a, 'foo1')\n&gt; foo.2 &lt;- function(a) paste('baz', a, 'foo2')\n&gt; \n&gt; obj_1 &lt;- structure(\"hello world\", class=\"1\")\n&gt; obj_2 &lt;- structure(\"hello world\", class=\"2\")\n&gt; \n&gt; foo(obj_1)\n[1] \"hello world foo1\"\n&gt; foo(obj_2)\n[1] \"baz hello world foo2\"\n</code></pre>\n\n<p>This will only dispatch based on the class of the first argument.  You can use S4 methods if you want to dispatch based on multiple arguments.</p>\n"}, {"comments": [{"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1422835956, "post_id": 28226839, "comment_id": 44894902, "body": "I must admit I&#39;m not familiar with church encoding. This seems somewhat involved/complicated, but I guess trying to achieve pattern matching is &quot;fighting&quot; the language somewhat."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1422575258, "creation_date": 1422575258, "answer_id": 28226839, "question_id": 28221948, "link": "https://stackoverflow.com/questions/28221948/haskell-style-pattern-matching-of-parameter-values-for-function-calls-in-r/28226839#28226839", "title": "haskell style pattern matching of parameter values for function calls in R", "body": "<p>For general algebraic data types, you can define your own matching function helpers. These are sometimes called \"eliminators\", and essentially convert your ADT values into their Church encoding.</p>\n\n<p>For instance, let's translate this Haskell code snipppet:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>x = Just 3\ny = Nothing\na = case x of Nothing -&gt; 42 ; Just w -&gt; w+100\nb = case y of Nothing -&gt; 42 ; Just w -&gt; w+100\n</code></pre>\n\n<p>The result is:</p>\n\n<pre class=\"lang-r prettyprint-override\"><code># eliminator\nmatchMaybe &lt;- function(x,kn,kj) {\n   ifelse(x[[1]]=='Nothing', kn(), kj(x[[2]]))\n}\n\n# tests\nx &lt;- list('Just', 3)\ny &lt;- list('Nothing')\na &lt;- matchMaybe(x\n               ,function() { 42 }\n               ,function(w){ w+100 })\nb &lt;- matchMaybe(y\n               ,function() { 42 }\n               ,function(w){ w+100 })\n</code></pre>\n\n<p>Note, however, that <em>deep</em> pattern matching is hard to translate in this way.\nThat is, in Haskell you can do stuff like</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>case x of Just 10 -&gt; 22 ; Nothing -&gt; 42 ; Just w -&gt; w+100\n</code></pre>\n\n<p>wherein you match the <code>Just</code> constructor and the inner <code>10</code> at the same time. This can not be encoded in a convenient way.</p>\n\n<p>For strings, as in the OP example, a possible eliminator could be:</p>\n\n<pre class=\"lang-r prettyprint-override\"><code>match &lt;- function(x,v,kt,ke) {\n   ifelse(x==v, kt(),ke(x))\n}\n\nr &lt;- match('foo'\n     , 'bar', function() { \"then\" }\n     ,        function(x) { \"else\" })\n</code></pre>\n\n<p>Also keep in mind that I am not fluent in R, so there might be a much better approach.</p>\n"}], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 28226839, "answer_count": 2, "score": 1, "last_activity_date": 1422575258, "creation_date": 1422556175, "last_edit_date": 1422556575, "question_id": 28221948, "link": "https://stackoverflow.com/questions/28221948/haskell-style-pattern-matching-of-parameter-values-for-function-calls-in-r", "title": "haskell style pattern matching of parameter values for function calls in R", "body": "<p>In R, is it possible to do function pattern matching based on parameter values ala Haskell?</p>\n\n<p>i.e. if parameter x is ='foo', run one version of a function, if x is 'bar', run another version? Obviously this could be done with if statements if necessary, but I'd like to know if there's a more 'functional' approach to it.</p>\n\n<p>For example, to do this kind of function selection (foo1 vs. foo2) automatically without the ifelse statement to do the conditioning:</p>\n\n<pre><code>foo1 &lt;- function(a) {\n    paste0(a, 'foo1')\n}\n\nfoo2 &lt;- function(a) {\n    paste0('baz', a, 'foo2')\n}\n\nx &lt;- 'barp'\nvalue &lt;- ifelse(x == 'barp', foo1(x), foo2(x))\n</code></pre>\n"}, {"tags": ["haskell", "intellij-idea"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422556218, "post_id": 28221717, "comment_id": 44807004, "body": "I have 0 experience with IntelliJ and Haskforce, but it looks like you need an install of the JDK and you&#39;ll have to point IntelliJ at it.  Have you tried that?"}, {"owner": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422570300, "post_id": 28221717, "comment_id": 44814800, "body": "This is not the issue; Java examples run fine - and anyway a Haskell execution does not require a JDK."}], "answers": [{"comments": [{"owner": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "edited": false, "score": 0, "creation_date": 1422625238, "post_id": 28234523, "comment_id": 44835576, "body": "Thanks, makes sense for the editing features - but probably not the JDK issue? This dependency should be noted in the Install notes. Trying to install it, gives an error; <code>&quot;Compiling Browse; Not in scope: data constructor ExplicitForall&#39; Perhaps you meantExplicitForAll&#39; (imported from Language.Haskell.Exts.Extension)&quot;</code> SO23277995 mentions this, and from that trying to install ghc-mod-4.0.2, then another posting with ghc-mod install problems notes a newer version (5.2.1.2), which then also fails: <code>&quot;Backjump limit reached (change with --max-backjumps).&quot;</code> I give up - stuck in cabal hell."}, {"owner": {"reputation": 21, "user_id": 4510866, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f8de69d51be099d36b6b9a3d847e3c19?s=128&d=identicon&r=PG", "display_name": "user4510866", "link": "https://stackoverflow.com/users/4510866/user4510866"}, "reply_to_user": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "edited": false, "score": 0, "creation_date": 1422629554, "post_id": 28234523, "comment_id": 44838055, "body": "@guthrie Not sure about the JDK message. As for ghc-mod issues, make sure to install it in a sandbox."}, {"owner": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "edited": false, "score": 0, "creation_date": 1422642616, "post_id": 28234523, "comment_id": 44845466, "body": "I think the current version of Cabal does this by default; but cabal seems broken itself."}], "tags": [], "owner": {"reputation": 21, "user_id": 4510866, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f8de69d51be099d36b6b9a3d847e3c19?s=128&d=identicon&r=PG", "display_name": "user4510866", "link": "https://stackoverflow.com/users/4510866/user4510866"}, "is_accepted": false, "score": 2, "last_activity_date": 1422615900, "creation_date": 1422615900, "answer_id": 28234523, "question_id": 28221717, "link": "https://stackoverflow.com/questions/28221717/intellij-haskforce-plugin-run-error/28234523#28234523", "title": "IntelliJ Haskforce plugin - run error", "body": "<p>In your project settings -> Haskell Tools, you haven't specified paths to all executables, in particular ghc-mod and ghc-modi.</p>\n"}], "owner": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422615900, "creation_date": 1422555257, "question_id": 28221717, "link": "https://stackoverflow.com/questions/28221717/intellij-haskforce-plugin-run-error", "title": "IntelliJ Haskforce plugin - run error", "body": "<p>I installed the Community edition of IntelliJ and the HaskForce Haskell plugin, and I find that:</p>\n\n<ol>\n<li><p>It does not do any of the context sensitive formatting or auto-completions shown on the demo page,</p></li>\n<li><p>There is not any obvious simple run configuration for Haskell\nand trying to use a default configuration gives the error:</p>\n\n<p><em>\"Error running Pgm: no JDK specified\"</em></p></li>\n</ol>\n\n<p>Doing a build is successful, and creates a Pgm.exe in the ./dist/build/Pgm directory.\nIs there some additional setup or configuration needed?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "edited": false, "score": 1, "creation_date": 1422549439, "post_id": 28219762, "comment_id": 44802978, "body": "Not an expert, but I think both cases are the same. The reason for this is currying (<a href=\"https://wiki.haskell.org/Currying\" rel=\"nofollow noreferrer\">wiki.haskell.org/Currying</a>)"}, {"owner": {"reputation": 62908, "user_id": 567620, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/g8HIM.jpg?s=128&g=1", "display_name": "ely", "link": "https://stackoverflow.com/users/567620/ely"}, "edited": false, "score": 0, "creation_date": 1422549461, "post_id": 28219762, "comment_id": 44802998, "body": "What will the resulting type be in each case if you curry <code>compose</code> by only giving it the first argument, e.g. the list of functions? Does that help explain what is going on? In both cases after currying, if you supply just one more argument (type <code>a</code>) what will happen?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1422552428, "post_id": 28219762, "comment_id": 44804790, "body": "I encourage you to think about what observations you would expect to be able to make to differentiate these two types, and try making those observations in ghci. Were they different? (I encourage you in this way because the moment I understood what was happening in this space, my mind exploded, and I have not been able to leave Haskell since.)"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1422569575, "post_id": 28219762, "comment_id": 44814430, "body": "You&#39;re wrong - <code>-&gt;</code> is right-assocative, so <code>a -&gt; foodiebar</code> automatically becomes <code>(-&gt;) (a) (foodiebar)</code>. This is the same for functions: <code>a -&gt; b -&gt; c</code> is <code>a -&gt; (b -&gt; c)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 7, "last_activity_date": 1422550929, "creation_date": 1422550929, "answer_id": 28220388, "question_id": 28219762, "link": "https://stackoverflow.com/questions/28219762/higher-order-function-and-parentheses/28220388#28220388", "title": "Higher-order function and parentheses", "body": "<p>These are both the same:</p>\n\n<pre><code>compose1 :: [a -&gt; a] -&gt; (a -&gt; a)\ncompose1 [] = \\x -&gt; x\ncompose1 [f] = \\x -&gt; f x\ncompose1 (f1:f2:fs) = compose1 ((f2 . f1):fs)\n\ncompose2 :: [a -&gt; a] -&gt; a -&gt; a\ncompose2 [] x = x\ncompose2 [f] x = f x\ncompose2 (f1:f2:fs) x = compose2 ((f2 . f1):fs) x\n</code></pre>\n\n<p>Notice how these definitions are virtually identical, except the lambda gets moved from one side of the <code>=</code> to the other.  In fact, you can always do the following transformations:</p>\n\n<pre><code>f x y z = &lt;expr x y z&gt;\nf x y = \\z -&gt; &lt;expr x y z&gt;\nf x = \\y -&gt; \\z -&gt; &lt;expr x y z&gt; = \\y z -&gt; &lt;expr x y z&gt;\nf = \\x -&gt; \\y -&gt; \\z -&gt; &lt;expr x y z&gt; = \\x y z -&gt; &lt;expr x y z&gt;\n</code></pre>\n\n<p>This is actually what the compiler does to all your functions.  If you compile with <code>-ddump-simpl</code> you will see the Core code dumped where all functions are defined in terms of lambdas.  This is because Haskell uses the law that</p>\n\n<pre><code>f x = &lt;expr&gt;\n</code></pre>\n\n<p>Is equivalent to</p>\n\n<pre><code>f = \\x -&gt; &lt;expr&gt;\n</code></pre>\n\n<p>The lambda syntax could be considered a more basic syntax than defining a function using explicit arguments.</p>\n\n<hr>\n\n<blockquote>\n  <p>Namely, when a function(higher-order function) takes another function as an argument or returns a function as a result, the parentheses around the argument(the result) shouldn't be omitted, e.g., if <code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code> removes the parentheses, its meaning will change.</p>\n</blockquote>\n\n<p>You are correct in thinking that you can't remove the parentheses from <code>filter</code>'s type signature, and this is because function application is right associative only.  This means that the following signatures are equivalent:</p>\n\n<pre><code>f :: a -&gt; b -&gt; c -&gt; d -&gt; e\nf :: a -&gt; (b -&gt; (c -&gt; (d -&gt; e)))\n</code></pre>\n\n<p>This is what is meant by associating to the right, you go from right to left when adding nested parentheses.  However, <code>f</code>'s signature is <strong>not</strong> equivalent to</p>\n\n<pre><code>-- Not equivalent!\nf :: (((a -&gt; b) -&gt; c) -&gt; d) -&gt; e\n</code></pre>\n\n<p>Simply because <code>-&gt;</code> is not a fully associative operator.  For example, with <code>+</code> you have</p>\n\n<pre><code>x + (y + z) = (x + y) + z\n</code></pre>\n\n<p>But with <code>-&gt;</code> you have</p>\n\n<pre><code>x -&gt; (y -&gt; z) /= (x -&gt; y) -&gt; z\n</code></pre>\n\n<p>This is similar to the <code>:</code> operator, e.g.</p>\n\n<pre><code>1:2:3:4:[] == 1:(2:(3:(4:[])))\n           /= (((1:2):3):4):[]\n</code></pre>\n\n<p>The last expression would not type check since <code>1:2</code> is ill typed, <code>2</code> is not a list!</p>\n"}, {"tags": [], "owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "is_accepted": false, "score": 7, "last_activity_date": 1422558469, "last_edit_date": 1422558469, "creation_date": 1422551134, "answer_id": 28220452, "question_id": 28219762, "link": "https://stackoverflow.com/questions/28219762/higher-order-function-and-parentheses/28220452#28220452", "title": "Higher-order function and parentheses", "body": "<p>The arrow is right-associative, so <code>[a -&gt; a] -&gt; a -&gt; a</code> and <code>[a -&gt; a] -&gt; (a -&gt; a)</code> are equivalent.</p>\n\n<p>If you remove the parenthesis in the type signature for <code>filter</code>, you get:</p>\n\n<pre><code>a -&gt; Bool -&gt; [a] -&gt; [a]\na -&gt; Bool -&gt; ([a] -&gt; [a])\na -&gt; (Bool -&gt; ([a] -&gt; [a]))\n</code></pre>\n\n<p>... which is not the same as the <em>correct</em> type signature.</p>\n"}], "owner": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 28220388, "answer_count": 2, "score": 3, "last_activity_date": 1422558469, "creation_date": 1422549083, "question_id": 28219762, "link": "https://stackoverflow.com/questions/28219762/higher-order-function-and-parentheses", "title": "Higher-order function and parentheses", "body": "<p>According to compose's type at <a href=\"https://wiki.haskell.org/Compose\" rel=\"nofollow\">https://wiki.haskell.org/Compose</a>, it can be written as<br>\n <code>compose :: [a -&gt; a] -&gt; (a -&gt; a)</code>\nor <code>compose :: [a -&gt; a] -&gt; a -&gt; a</code></p>\n\n<p>I think these two types is different: the former takes a list of functions and returns a function,the latter takes a list of functions and an argument,then finally returns a value.</p>\n\n<p>Namely, when a function(higher-order function) takes another function as an argument or returns a function as a result, the parentheses around the argument(the result) shouldn't be omitted, e.g., if <code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code> removes the parentheses, its meaning will change.</p>\n\n<p>Am I right or wrong?</p>\n"}, {"tags": ["haskell", "usability", "xmonad"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 2855435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a60eb79d930055d7b6acc27f097e084?s=128&d=identicon&r=PG", "display_name": "cub-uanic", "link": "https://stackoverflow.com/users/2855435/cub-uanic"}, "edited": false, "score": 0, "creation_date": 1422568697, "post_id": 28220667, "comment_id": 44813990, "body": "Well, according to xmodmap, valid name for modifiers are: Shift, Lock, Control, Mod1, Mod2, Mod3, Mod4  AFAIK, Mod1 is for both Alt&#39;s, and Mod4 is for both Gui&#39;s. Not sure what is for Mod2 and Mod3, but if they are unused then I can remap them and use as I want.  Thanks!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 131, "user_id": 2855435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a60eb79d930055d7b6acc27f097e084?s=128&d=identicon&r=PG", "display_name": "cub-uanic", "link": "https://stackoverflow.com/users/2855435/cub-uanic"}, "edited": false, "score": 0, "creation_date": 1422571294, "post_id": 28220667, "comment_id": 44815301, "body": "@cub-uanic Note that xmonad has some special handling of numlock, so you may want to avoid using that one."}, {"owner": {"reputation": 131, "user_id": 2855435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a60eb79d930055d7b6acc27f097e084?s=128&d=identicon&r=PG", "display_name": "cub-uanic", "link": "https://stackoverflow.com/users/2855435/cub-uanic"}, "edited": false, "score": 0, "creation_date": 1422866549, "post_id": 28220667, "comment_id": 44902543, "body": "Daniel, where I can find more about this special handling of numlock? I never hear about it before."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 131, "user_id": 2855435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a60eb79d930055d7b6acc27f097e084?s=128&d=identicon&r=PG", "display_name": "cub-uanic", "link": "https://stackoverflow.com/users/2855435/cub-uanic"}, "edited": false, "score": 0, "creation_date": 1422896715, "post_id": 28220667, "comment_id": 44919978, "body": "@cub-uanic Dunno of any English writing, but you can grep for <code>numberlockMask</code> in the source to get started."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1422551766, "creation_date": 1422551766, "answer_id": 28220667, "question_id": 28219335, "link": "https://stackoverflow.com/questions/28219335/right-gui-key-in-xmonad/28220667#28220667", "title": "Right GUI key in XMonad", "body": "<p>For such questions, one may ask xev what it thinks of your keypress. Here's some example output from me pressing left-control+a and right-control+a:</p>\n\n<pre><code>KeyPress event, serial 36, synthetic NO, window 0x1400001,\n    root 0x2a9, subw 0x0, time 4207488563, (419,468), root:(2341,612),\n    state 0x0, keycode 37 (keysym 0xffe3, Control_L), same_screen YES,\n    XLookupString gives 0 bytes: \n    XmbLookupString gives 0 bytes: \n    XFilterEvent returns: False\n\nKeyPress event, serial 36, synthetic NO, window 0x1400001,\n    root 0x2a9, subw 0x0, time 4207489283, (419,468), root:(2341,612),\n    state 0x4, keycode 38 (keysym 0x61, a), same_screen YES,\n    XLookupString gives 1 bytes: (01) \"\"\n    XmbLookupString gives 1 bytes: (01) \"\"\n    XFilterEvent returns: False\n\nKeyRelease event, serial 36, synthetic NO, window 0x1400001,\n    root 0x2a9, subw 0x0, time 4207489403, (419,468), root:(2341,612),\n    state 0x4, keycode 38 (keysym 0x61, a), same_screen YES,\n    XLookupString gives 1 bytes: (01) \"\"\n    XFilterEvent returns: False\n\nKeyRelease event, serial 36, synthetic NO, window 0x1400001,\n    root 0x2a9, subw 0x0, time 4207490035, (419,468), root:(2341,612),\n    state 0x4, keycode 37 (keysym 0xffe3, Control_L), same_screen YES,\n    XLookupString gives 0 bytes: \n    XFilterEvent returns: False\n\nKeyPress event, serial 36, synthetic NO, window 0x1400001,\n    root 0x2a9, subw 0x0, time 4207538195, (-175,35), root:(1747,179),\n    state 0x0, keycode 105 (keysym 0xffe4, Control_R), same_screen YES,\n    XLookupString gives 0 bytes: \n    XmbLookupString gives 0 bytes: \n    XFilterEvent returns: False\n\nKeyPress event, serial 36, synthetic NO, window 0x1400001,\n    root 0x2a9, subw 0x0, time 4207538595, (-175,35), root:(1747,179),\n    state 0x4, keycode 38 (keysym 0x61, a), same_screen YES,\n    XLookupString gives 1 bytes: (01) \"\"\n    XmbLookupString gives 1 bytes: (01) \"\"\n    XFilterEvent returns: False\n\nKeyRelease event, serial 36, synthetic NO, window 0x1400001,\n    root 0x2a9, subw 0x0, time 4207538715, (-175,35), root:(1747,179),\n    state 0x4, keycode 38 (keysym 0x61, a), same_screen YES,\n    XLookupString gives 1 bytes: (01) \"\"\n    XFilterEvent returns: False\n\nKeyRelease event, serial 36, synthetic NO, window 0x1400001,\n    root 0x2a9, subw 0x0, time 4207539227, (-175,35), root:(1747,179),\n    state 0x4, keycode 105 (keysym 0xffe4, Control_R), same_screen YES,\n    XLookupString gives 0 bytes: \n    XFilterEvent returns: False\n</code></pre>\n\n<p>As you can see, though left-control and right-control produce different keypresses when depressed, they produce the same state when held down during another keypress. So one would not be able to differentiate them in my current setup.</p>\n\n<p>If you would like to have them be different modifiers, that can be arranged with xmodmap; however, there is a limited total number of modifiers -- I think maybe four or so. But see the xmodmap documentation for details.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1422552908, "post_id": 28220778, "comment_id": 44805073, "body": "Oh, interesting, it didn&#39;t occur to me that he wanted to bind the actual keys, rather than use them as different modifiers. If that&#39;s what he wants, this is a great answer!"}, {"owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1422553685, "post_id": 28220778, "comment_id": 44805528, "body": "Re-reading his answer, I think he <i>did</i> to use them as modifiers. But I&#39;ll I think I&#39;ll leave the answer here as it may help someone else. Also, it shows an example where the keys <i>do</i> have different keycodes."}], "tags": [], "owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "is_accepted": false, "score": 2, "last_activity_date": 1422552403, "last_edit_date": 1422552403, "creation_date": 1422552082, "answer_id": 28220778, "question_id": 28219335, "link": "https://stackoverflow.com/questions/28219335/right-gui-key-in-xmonad/28220778#28220778", "title": "Right GUI key in XMonad", "body": "<p>I'm not familiar with the L_GUI key, but in general you can have different mappings for keys provided that they return different codes. An easy way to determine this is to use <code>xev</code>. With <code>xev</code> running, typing a key causes two events, one for the key press and one for the key release.</p>\n\n<p>I have an Irish keyboard. When I run <code>xev</code> and type the left Alt key, the events are:</p>\n\n<pre><code>KeyPress event, serial 33, synthetic NO, window 0xe00001,\n    root 0x1dc, subw 0x0, time 4233053053, (748,263), root:(1711,266),\n    state 0x10, keycode 64 (keysym 0xffe9, Alt_L), same_screen YES,\n    XLookupString gives 0 bytes: \n    XmbLookupString gives 0 bytes: \n    XFilterEvent returns: False\n\nKeyRelease event, serial 33, synthetic NO, window 0xe00001,\n    root 0x1dc, subw 0x0, time 4233053237, (748,263), root:(1711,266),\n    state 0x18, keycode 64 (keysym 0xffe9, Alt_L), same_screen YES,\n    XLookupString gives 0 bytes: \n    XFilterEvent returns: False\n</code></pre>\n\n<p>So the keycode is 64. Note that the keysim is <code>Alt_l</code>. to map this key I would look in Graphics.X11.Types and find that the constant for this key is <code>xK_Alt_L</code>.</p>\n\n<p>When I press the right Alt key (which is labelled Alt Gr) on my keyboard, I get a different keycode, 108. So I can have different bindings.</p>\n\n<pre><code>KeyPress event, serial 33, synthetic NO, window 0xe00001,\n    root 0x1dc, subw 0x0, time 4233053813, (748,263), root:(1711,266),\n    state 0x10, keycode 108 (keysym 0xfe03, ISO_Level3_Shift), same_screen YES,\n    XKeysymToKeycode returns keycode: 92\n    XLookupString gives 0 bytes: \n    XmbLookupString gives 0 bytes: \n    XFilterEvent returns: False\n\nKeyRelease event, serial 33, synthetic NO, window 0xe00001,\n    root 0x1dc, subw 0x0, time 4233053989, (748,263), root:(1711,266),\n    state 0x90, keycode 108 (keysym 0xfe03, ISO_Level3_Shift), same_screen YES,\n    XKeysymToKeycode returns keycode: 92\n    XLookupString gives 0 bytes: \n    XFilterEvent returns: False\n</code></pre>\n\n<p>I may be wrong, but I think U.S. keyboards return the same keycode for the left and right Alt keys. In that case, the keys could not have different bindings.</p>\n"}], "owner": {"reputation": 131, "user_id": 2855435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a60eb79d930055d7b6acc27f097e084?s=128&d=identicon&r=PG", "display_name": "cub-uanic", "link": "https://stackoverflow.com/users/2855435/cub-uanic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 28220667, "answer_count": 2, "score": 1, "last_activity_date": 1422552403, "creation_date": 1422547846, "question_id": 28219335, "link": "https://stackoverflow.com/questions/28219335/right-gui-key-in-xmonad", "title": "Right GUI key in XMonad", "body": "<p>Is there a possibility to make different bindings for L_GUI+key and R_GUI+key in XMonad, and if yes then how?\nSame question is for R_CTRL, R_SFT and R_ALT, but they are not so important for me.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 10281, "user_id": 1033448, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d64fdbd293e80580b1c702998cb6e740?s=128&d=identicon&r=PG", "display_name": "Anton Guryanov", "link": "https://stackoverflow.com/users/1033448/anton-guryanov"}, "edited": false, "score": 2, "creation_date": 1422535758, "post_id": 28214913, "comment_id": 44793612, "body": "The general way to combine monads is to use monad transformers. In your case, <code>MaybeT</code> (<a href=\"http://hackage.haskell.org/package/transformers-0.4.2.0/docs/Control-Monad-Trans-Maybe.html#v:MaybeT\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/transformers-0.4.2.0/docs/&hellip;</a>)"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1422535786, "post_id": 28214913, "comment_id": 44793628, "body": "MaybeT is indeed the best solution here."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1422552172, "post_id": 28214913, "comment_id": 44804629, "body": "There is not, in general, a function of type <code>(Monad m1, Monad m2) =&gt; m1 (m2 a) -&gt; (a -&gt; m1 (m2 b)) -&gt; m1 (m2 b)</code>. This is what is meant when people say &quot;monads don&#39;t compose&quot;. See also <a href=\"http://stackoverflow.com/q/13034229/791604\">Concrete example showing that monads are not closed under composition</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "edited": false, "score": 0, "creation_date": 1422535490, "post_id": 28215046, "comment_id": 44793468, "body": "That is indeed the code I have written to do that. Do you think there is a more general solution to that? Or should I be satisfied with that formulation?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "edited": false, "score": 0, "creation_date": 1422535708, "post_id": 28215046, "comment_id": 44793576, "body": "@madjar I have added a code without do notation. I don&#39;t know if there is more general solution than this."}, {"owner": {"reputation": 241, "user_id": 1551371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/260aa50e51b9227b2dd4572b68229f6a?s=128&d=identicon&r=PG", "display_name": "RobertDiep", "link": "https://stackoverflow.com/users/1551371/robertdiep"}, "edited": false, "score": 0, "creation_date": 1422538258, "post_id": 28215046, "comment_id": 44795213, "body": "And, instead of using do-notation in useToken, you can also use: <code>getToken &gt;&gt;= getUsername</code> with the <code>MaybeT</code> solution!"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 241, "user_id": 1551371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/260aa50e51b9227b2dd4572b68229f6a?s=128&d=identicon&r=PG", "display_name": "RobertDiep", "link": "https://stackoverflow.com/users/1551371/robertdiep"}, "edited": false, "score": 0, "creation_date": 1422538313, "post_id": 28215046, "comment_id": 44795251, "body": "@Robedino Oh yes, that would be more sweeter!"}, {"owner": {"reputation": 241, "user_id": 1551371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/260aa50e51b9227b2dd4572b68229f6a?s=128&d=identicon&r=PG", "display_name": "RobertDiep", "link": "https://stackoverflow.com/users/1551371/robertdiep"}, "edited": false, "score": 0, "creation_date": 1422538945, "post_id": 28215046, "comment_id": 44795682, "body": "Also, in order to run <code>useToken</code> now you should use <code>runMaybeT :: MaybeT m a -&gt; m (Maybe a)</code>. <code>runMaybeT useToken</code> now has type <code>IO (Maybe String)</code>, instead of <code>MaybeT IO String</code> :)"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 13, "last_activity_date": 1422538404, "last_edit_date": 1422538404, "creation_date": 1422535308, "answer_id": 28215046, "question_id": 28214913, "link": "https://stackoverflow.com/questions/28214913/how-to-use-bind-with-nested-monads/28215046#28215046", "title": "How to use bind with nested monads?", "body": "<p>I have defined a function <code>useToken</code> showing your use case:</p>\n\n<pre><code>type Token = String\n\ngetToken :: IO (Maybe Token)\ngetToken = undefined\n\ngetUsername :: Token -&gt; IO (Maybe String)\ngetUsername = undefined\n\nuseToken :: IO (Maybe String)\nuseToken = do\n  token &lt;- getToken\n  case token of\n    Just x -&gt; getUsername x\n    Nothing -&gt; return Nothing\n</code></pre>\n\n<p>If you don't want to use <code>do</code> notation, then you can use:</p>\n\n<pre><code>useToken2 :: IO (Maybe String)\nuseToken2 = getToken &gt;&gt;= \\token -&gt; maybe (return Nothing) getUsername token\n</code></pre>\n\n<p>Or using monad transformers, your code will become simpler:</p>\n\n<pre><code>import Control.Monad.Trans.Maybe\ntype Token = String\n\ngetToken :: MaybeT IO Token\ngetToken = undefined\n\ngetUsername :: Token -&gt; MaybeT IO String\ngetUsername = undefined\n\nuseToken :: MaybeT IO String \nuseToken = do\n  token &lt;- getToken\n  getUsername token\n</code></pre>\n\n<p>Note that, you can also directly lift IO operations inside the monad transformer. As @Robedino points out, now the code will be more concise without do notation:</p>\n\n<pre><code>useToken :: MaybeT IO String \nuseToken = getToken &gt;&gt;= getUsername\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 5, "last_activity_date": 1422540468, "last_edit_date": 1422540468, "creation_date": 1422537298, "answer_id": 28215697, "question_id": 28214913, "link": "https://stackoverflow.com/questions/28214913/how-to-use-bind-with-nested-monads/28215697#28215697", "title": "How to use bind with nested monads?", "body": "<p>As people in the comments suggest, you should just use monad transformers.</p>\n\n<p>However you can avoid this in your case. Monads do not commute in general, so you can't write a function with this signature</p>\n\n<pre><code>bind' :: (Monad m, Monad n) =&gt; m (n a) -&gt; (a -&gt; m (n b)) -&gt; m (n b)\n</code></pre>\n\n<p>But all is ok, if the inner monad is an instance of the <code>Traversable</code> class:</p>\n\n<pre><code>import Data.Traversable as T\nimport Control.Monad\n\njoinT :: (Monad m, Traversable t, Monad t) =&gt; m (t (m (t a))) -&gt; m (t a)\njoinT = (&gt;&gt;= liftM join . T.sequence)\n\nliftMM :: (Monad m, Monad n) =&gt; (a -&gt; b) -&gt; m (n a) -&gt; m (n b)\nliftMM = liftM . liftM\n\nbindT :: (Monad m, Traversable t, Monad t) =&gt; m (t a) -&gt; (a -&gt; m (t b)) -&gt; m (t b)\nbindT x f = joinT (liftMM f x)\n</code></pre>\n\n<p>and the <code>Maybe</code> monad is; hence</p>\n\n<pre><code>type Token = String\n\ngetToken :: IO (Maybe Token)\ngetToken = undefined\n\ngetUsername :: Token -&gt; IO (Maybe String)\ngetUsername = undefined\n\nuseToken :: IO (Maybe String)\nuseToken = getToken `bindT` getUsername\n</code></pre>\n\n<p>Also, with the <code>{-# LANGUAGE RebindableSyntax #-}</code> you can write</p>\n\n<pre><code>(&gt;&gt;=) = bindT\n\nuseToken :: IO (Maybe String)\nuseToken = do\n    x &lt;- getToken\n    getUsername x\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>With the type-level compose</p>\n\n<pre><code>newtype (f :. g) a = Nested { runNested :: f (g a) }\n</code></pre>\n\n<p>you can define a monad instance for nested monads:</p>\n\n<pre><code>instance (Monad m, Traversable t, Monad t) =&gt; Monad (m :. t) where\n    return  = Nested . return . return\n    x &gt;&gt;= f = Nested $ runNested x `bindT` (runNested . f)\n</code></pre>\n\n<p>Your example then is</p>\n\n<pre><code>type Token = String\n\ngetToken :: IO (Maybe Token)\ngetToken = undefined\n\ngetUsername :: Token -&gt; IO (Maybe String)\ngetUsername = undefined\n\nuseToken :: IO (Maybe String)\nuseToken = runNested $ Nested getToken &gt;&gt;= Nested . getUsername\n</code></pre>\n\n<p>Or like you would do with the <code>MaybeT</code> transformer:</p>\n\n<pre><code>type Nested = (:.)\n\ntype Token = String\n\ngetToken :: Nested IO Maybe Token\ngetToken = undefined\n\ngetUsername :: Token -&gt; Nested IO Maybe String\ngetUsername = undefined\n\nuseToken :: Nested IO Maybe String\nuseToken = getToken &gt;&gt;= getUsername\n\nrunUseToken :: IO (Maybe String)\nrunUseToken = runNested useToken\n</code></pre>\n"}], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2350, "favorite_count": 4, "accepted_answer_id": 28215046, "answer_count": 2, "score": 15, "last_activity_date": 1469451471, "creation_date": 1422534888, "last_edit_date": 1469451471, "question_id": 28214913, "link": "https://stackoverflow.com/questions/28214913/how-to-use-bind-with-nested-monads", "title": "How to use bind with nested monads?", "body": "<p>I have two functions, one that tries to get a token from a webservice and may fail, and one that tries to use this token to get the username and may fail.</p>\n\n<pre><code>getToken :: IO (Maybe Token)\ngetUsername :: Token -&gt; IO (Maybe String)\n</code></pre>\n\n<p>I would like to take the result of getToken and feed it to <code>getUsername</code>. If there was only <code>IO</code> or <code>Maybe</code>, I could simply use bind, but since there are down nested monads, I can't. How can I write something equivalent to <code>getToken &gt;&gt;= getUsername :: IO (Maybe String)</code> ?</p>\n\n<p>More generally, what function has type <code>m1 m2 a -&gt; (a -&gt; m1 m2 b) -&gt; m1 m2 b</code>?</p>\n\n<p>Bonus question: how would I do that using the do notation in an <code>IO</code> context?</p>\n"}, {"tags": ["haskell", "types", "refactoring", "gadt"], "comments": [{"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1422532100, "post_id": 28213785, "comment_id": 44791460, "body": "Have you tried <i>phantom types</i> to partition <code>ICode</code> etc?"}, {"owner": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "reply_to_user": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1422532383, "post_id": 28213785, "comment_id": 44791660, "body": "@phadej I&#39;ve thought about it, but haven&#39;t tried it yet. It seems that phantom types will help with arbitrary instances, but won&#39;t help with property number 4."}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1422534201, "post_id": 28213785, "comment_id": 44792787, "body": "For 4. I&#39;d suggest to make own type <code>newtype LocTypeOne = LocTypeOne ICode</code> and <code>LocType1 LocTypeOne</code> inside <code>LocType</code> ADT. Then add <code>LocTypeOne -&gt; LocType</code> &quot;explicit coercion&quot; function and you are done."}], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "edited": false, "score": 0, "creation_date": 1422560278, "post_id": 28221943, "comment_id": 44809196, "body": "I get your reasoning and maybe 3 have to go(i&#39;m still interested if it&#39;s possible to make all of the properties stated above hold). :) I&#39;m a little frustrated with a different aspect. It seems like <code>LocType</code> have to be encoded somewhat different to make this code work the way it&#39;s supposed to. It&#39;s a starting point though."}, {"owner": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "edited": false, "score": 0, "creation_date": 1422560787, "post_id": 28221943, "comment_id": 44809450, "body": "Ah, nevermind the second part. I thought for some reason that <code>LocType</code> is a type to be used instead of &quot;Code&quot;-types. I think it finally make sense for me."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "edited": false, "score": 0, "creation_date": 1422566896, "post_id": 28221943, "comment_id": 44812982, "body": "@dredozubov, I just realized that #3 asks about FromJSON, rather than Arbitrary.  In that case this should definitely be possible. The weird thing is that the <code>a</code> in the <code>Location a</code> that you are reading is supplied by the caller, not the JSON, so that may take some getting used to.  You can use an existential to have the parser supply it.  <code>data AnyLocation where AnyLocation :: Location a -&gt; AnyLocation</code>, then define <code>FromJSON AnyLocation</code>."}, {"owner": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "edited": false, "score": 0, "creation_date": 1422606431, "post_id": 28221943, "comment_id": 44825905, "body": "There are JSON objects like <code>{&#39;type&#39;: &#39;LocType1&#39;, code: &#39;somecode&#39;} </code>, which i interpret like this: <code>parseJSON (Object l) = let locationType = parse (.: &quot;type&quot;) l :: Result String in case locationType of ...</code>, so i wanted to leave it like that."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 2, "last_activity_date": 1422556142, "creation_date": 1422556142, "answer_id": 28221943, "question_id": 28213785, "link": "https://stackoverflow.com/questions/28213785/trouble-refactoring-current-typespossibly-gadt-type-families-related/28221943#28221943", "title": "Trouble refactoring current types(possibly GADT/Type Families related)", "body": "<p>3 and 4 seem incompatible.  This sounds like a \"fallback\" mechanism: use this instance if no more specific instance is available.  You can get this with OverlappingInstances, but I always seem to run into trouble with it.  Worth a shot, I guess.</p>\n\n<p>As for the rest of your problem, it seems like you want <code>Location</code> to be a GADT.</p>\n\n<pre><code>data LocType = Type1 | Type2 | Type3 | Type4\n\ndata Location :: LocType -&gt; * where\n    LocType1 :: ICode -&gt; Location Type1\n    LocType2 :: ICode -&gt; Location Type2\n    LocType3 :: RCode -&gt; Location Type3\n    LocType4 :: DCode -&gt; Location Type4\n</code></pre>\n\n<p>Then you can easily do:</p>\n\n<pre><code>location1IncludedInArbitraryLocation :: Location Type1 -&gt; Location t -&gt; Bool\nlocation1IncludedInArbitraryLocation (LocType1 icode) l = ...\n</code></pre>\n\n<p>No other cases need be defined here because no other constructor will be well-typed.</p>\n\n<p>I hope this gives you enough to start playing with.</p>\n\n<p>(Needs <code>DataKinds</code>, <code>KindSignatures</code>, <code>GADTs</code>)</p>\n"}], "owner": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 28221943, "answer_count": 1, "score": 0, "last_activity_date": 1422562394, "creation_date": 1422531419, "last_edit_date": 1422562394, "question_id": 28213785, "link": "https://stackoverflow.com/questions/28213785/trouble-refactoring-current-typespossibly-gadt-type-families-related", "title": "Trouble refactoring current types(possibly GADT/Type Families related)", "body": "<p>I've got types like this:</p>\n\n<pre><code>-- There are codes\nnewtype ICode = ICode { fromICode :: String }\nnewtype RCode = RCode { fromRCode :: String }\ndata DCode = DCode1 | DCode2 | DCode3\n\n-- There are locations described by type and code.\n-- Current implementation looks like this:\ndata Location = LocType1 ICode\n              | LocType2 ICode\n              | LocType3 RCode\n              | LocType4 DCode\n</code></pre>\n\n<p>I'd like to refactor these types to address some problems, which are present in current implementation.</p>\n\n<p>It's real easy to demonstrate the properties I'm after with QuickCheck <code>Arbitrary</code> and Aeson's <code>FromJSON</code> instances and one other function.\nFirst 3 properties are needed to generate correct test data and 4th to\nimplement business logic.</p>\n\n<p>I'd like to be able to:</p>\n\n<ol>\n<li><p>make Arbitrary instances of all code types such as</p>\n\n<pre><code>    instance Arbitrary ICode where\n      arbitrary = ...\n    -- same with RCode and DCode\n</code></pre></li>\n<li><p>make <code>Arbitrary</code> instances of types like <code>Location1 ICode</code>(It clearly differs from current implementation and it's what I'm trying to fix), which describe exact combination of location type and code type. <code>Location1 ICode</code> can contain only a subset of <code>ICode</code> possible values, so I have to make sure of that.</p></li>\n<li><p>make <code>FromJSON</code> instances of all possible types, something in the lines of:</p>\n\n<pre><code>instance FromJSON (Location a) where\n  parseJSON = ...\n</code></pre>\n\n<p>It's needed to deserialize some json objects depending on their values.</p></li>\n<li><p>Some functions have to work only on one location type. It's pretty inconvenient in current implementation, because I have to use either incomplete functions or not really correct return types such as <code>Maybe</code>. I'd like to be able to do something like:</p>\n\n<pre><code>location1IncludedInArbitraryLocation :: LocType1 -&gt; Location a -&gt; Bool\nlocation1IncludedInArbitraryLocation l = ...\n</code></pre></li>\n</ol>\n\n<p>I believe solution lies somewhere in the GADTs/Data Families territory, but I'm not really fluent with this kind of type-fu. If several ways to resolve this issue are possible, which one would be easier to typecheck/work with later? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1790, "user_id": 3350784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTuvN.png?s=128&g=1", "display_name": "Yuuri", "link": "https://stackoverflow.com/users/3350784/yuuri"}, "edited": false, "score": 2, "creation_date": 1422524769, "post_id": 28210958, "comment_id": 44787067, "body": "<i>Currying</i> is a <i>way</i> to express a <i>n</i>-ary function with <i>n</i> unary function and is one of the easiest way to achieve <i>partial application</i> (but not a sole one)."}, {"owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "edited": false, "score": 2, "creation_date": 1422541384, "post_id": 28210958, "comment_id": 44797270, "body": "I think your main problem is perhaps due to the fact that there&#39;s no such thing as &quot;partial application&quot; in Haskell.  There is just application.  If we &quot;say&quot; (to help us understand) that <code>f :: Int -&gt; Int -&gt; Int</code> has two arguments (which is not technically correct) then we can also &quot;say&quot; (again to help us understand) that <code>f 5</code> is &quot;partially applied&quot; (which again is not technically correct).  These are both analogies to aid understanding but neither has any technical meaning."}], "answers": [{"comments": [{"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422524151, "post_id": 28211194, "comment_id": 44786717, "body": "I understand what is <code>partial application</code>. But the <code>currying</code> notion is not clear to me still..."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 3, "creation_date": 1422524217, "post_id": 28211194, "comment_id": 44786746, "body": "@Bush the question was &quot;<i>is currying reverse of partial application</i>&quot;, to which the answer is <i>no</i>."}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422524545, "post_id": 28211194, "comment_id": 44786940, "body": "why your <code>f&#39;</code> signature is not the <code>f&#39; :: a -&gt; (a -&gt; a)</code>? For your case first parameter is a function..."}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 2, "creation_date": 1422524637, "post_id": 28211194, "comment_id": 44786987, "body": "it should be <code>f&#39; :: (a, a) -&gt; a</code>. yet&#39;s it better to use distinct type variables <code>a, b, c</code>: <code>f :: a -&gt; b -&gt; c</code> and <code>f&#39; :: (a, b) -&gt; c</code>. Also <code>f&#39;</code> is actually <i>uncurried</i>, as in <code>uncurry :: (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c</code>. I have troubles to remember which way is which myself too."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422524644, "post_id": 28211194, "comment_id": 44786993, "body": "@Bush oops, I got the &quot;un&quot; part wrong in the first example. Result of curry-by default in Haskell, no less."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1422524698, "post_id": 28211194, "comment_id": 44787028, "body": "@phadej you&#39;re right, I&#39;ll change to distinct type variables. Heh, confusing matters even more, but hopefully the answer will be ok in the end"}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 7, "last_activity_date": 1422524607, "last_edit_date": 1422524607, "creation_date": 1422523954, "answer_id": 28211194, "question_id": 28210958, "link": "https://stackoverflow.com/questions/28210958/is-it-possible-to-tell-that-the-currying-is-an-action-reverse-of-the-partial/28211194#28211194", "title": "Is it possible to tell that the &quot;currying&quot; is an action reverse of the &quot;partial application&quot;?", "body": "<h2>No.</h2>\n\n<p>A reverse of currying is <em>uncurrying</em>.</p>\n\n<pre><code>f :: a -&gt; b -&gt; c\n\nf' :: (a, b) -&gt; c\nf' = -- uncurried f\n\nf'' :: a -&gt; b -&gt; c\nf'' = -- curried f' = f\n</code></pre>\n\n<p>A curried function, despite having its \"language\" arity reduced to 1, keeps the \"semantic\" arity unchanged (becuse you still have to provide every value for the tuple). The only thing that changes in comparison is the way you pass the arguments.</p>\n\n<p>Partial application is an application that reduces the arity of the function to a number bigger than 0. This is an <em>irreversible</em> operation; you can't <em>unapply</em> arguments.</p>\n\n<pre><code>--   1    2\nf :: a -&gt; b -&gt; c\n\n--    1\nf' :: b -&gt; c\nf' = f c -- partially applied f\n\n--     0 arguments\nf'' :: c\nf'' = f c1 c2 -- fully applied f\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422529983, "post_id": 28212163, "comment_id": 44790194, "body": "Thank you! Can I say the &quot;currying&quot; is a synonym of &quot;partial application&quot; in Haskell?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422536480, "post_id": 28212163, "comment_id": 44794062, "body": "@Bush of course it&#39;s not. It doesn&#39;t apply anything. Note &quot;we can use <code>curry f x</code>&quot; in the answer above."}, {"owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "edited": false, "score": 0, "creation_date": 1422537845, "post_id": 28212163, "comment_id": 44794949, "body": "&gt;of course it&#39;s not. But what about this: &gt;*&quot;Currying&quot; can be seen as the same thing as &quot;partial application&quot;*?"}, {"owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "edited": false, "score": 0, "creation_date": 1422563365, "post_id": 28212163, "comment_id": 44811020, "body": "If you do <code>curry f</code>, you do currying, but not partial application, so the two are not always the same. Now if you do <code>curry f x</code> you do both currying and partial application, so the two can be seen as the same thing from some points of view"}], "tags": [], "owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "is_accepted": true, "score": 5, "last_activity_date": 1422526831, "creation_date": 1422526831, "answer_id": 28212163, "question_id": 28210958, "link": "https://stackoverflow.com/questions/28210958/is-it-possible-to-tell-that-the-currying-is-an-action-reverse-of-the-partial/28212163#28212163", "title": "Is it possible to tell that the &quot;currying&quot; is an action reverse of the &quot;partial application&quot;?", "body": "<blockquote>\n  <p>I.e. it is possible to tell that the \"currying\" is an action reverse of the \"partial application\".</p>\n</blockquote>\n\n<p>Almost but the other way around: \"Currying\" can be seen as the <strong>same thing</strong> as \"partial application\".</p>\n\n<p>Let me explain with the help of a ghci session. We start by defining some type synonyms for different kinds of functions.</p>\n\n<pre><code>Prelude&gt; type Binary a b c = (a, b) -&gt; c\nPrelude&gt; type Curried a b c = a -&gt; (b -&gt; c)\nPrelude&gt; type Unary a b = a -&gt; b\n</code></pre>\n\n<p>Here, we have two ways to represent a binary function: We have <code>Binary</code> functions like in mathematics, that is, functions that accept a tuple. Then we have <code>Curried</code> functions like usually in Haskell, that is, functions that return a function. And for completeness, we also have a special name for <code>Unary</code> functions.</p>\n\n<p>Now we can use the standard <code>curry</code> and <code>uncurry</code> functions to convert between the two representations of binary functions. In ghci, we can check this as follows:</p>\n\n<pre><code>Prelude&gt; :t curry :: Binary a b c -&gt; Curried a b c\ncurry :: Binary a b c -&gt; Curried a b c\n  :: Binary a b c -&gt; Curried a b c\n\nPrelude&gt; :t uncurry :: Curried a b c -&gt; Binary a b c\nuncurry :: Curried a b c -&gt; Binary a b c\n  :: Curried a b c -&gt; Binary a b c\n</code></pre>\n\n<p>(Note that when you type <code>:t foo :: SomeType</code>, then ghci will check whether <code>foo</code> has type <code>SomeType</code>. If yes, ghci will print it again. If not, ghci will complain).</p>\n\n<p>So as Bartek correctly states in his answer, the inverse of <code>curry</code> is <code>uncurry</code>. But we can also understand the type of <code>curry</code> as follows:</p>\n\n<pre><code>Prelude&gt; :t curry :: Binary a b c -&gt; a -&gt; Unary b c\ncurry :: Binary a b c -&gt; a -&gt; Unary b c\n  :: Binary a b c -&gt; a -&gt; Unary b c\n</code></pre>\n\n<p>If we write the type like this, we see that we can use <code>curry</code> to partially apply a <code>Binary</code> function: Given a <code>f :: Binary a b c</code> and the first argument <code>x :: a</code> we can use <code>curry f x</code> to yield a <code>Unary b c</code> that is still waiting for the second argument of type <code>b</code>.</p>\n"}], "owner": {"reputation": 10045, "user_id": 1306132, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kVX7T.png?s=128&g=1", "display_name": "Andrey Bushman", "link": "https://stackoverflow.com/users/1306132/andrey-bushman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 28212163, "answer_count": 2, "score": 2, "last_activity_date": 1422526831, "creation_date": 1422523248, "last_edit_date": 1422524171, "question_id": 28210958, "link": "https://stackoverflow.com/questions/28210958/is-it-possible-to-tell-that-the-currying-is-an-action-reverse-of-the-partial", "title": "Is it possible to tell that the &quot;currying&quot; is an action reverse of the &quot;partial application&quot;?", "body": "<p>I learn Haskell through reading the <em>\"Learn You a Haskell for Great Goog!\"</em> book. I want to be sure I correctly understand that is \"currying\".</p>\n\n<p>I understand a function can't get more then one parameter. When a function has more then one parameter it <em>actually</em> works as a function with one parameter. I.e. this:</p>\n\n<pre><code>func :: Int -&gt; Int -&gt; Int -&gt; Int\n</code></pre>\n\n<p>works like this (and is the same):</p>\n\n<pre><code>func :: Int -&gt; (Int -&gt; (Int -&gt; Int))\n</code></pre>\n\n<p>I.e. a function returns a function, that returns a function too, etc. This \"nested doll\" behaviour is called a \"currying\" (curried function). First variant of code is like a \"syntax sugar\".</p>\n\n<p>Any function with more than zero parameter can be <em>partially applied</em>. I.e. it is possible to tell that <em>the \"currying\" is an action reverse of the \"partial application\"</em>. Am I right?</p>\n"}, {"tags": ["haskell", "typeclass", "type-systems"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422510026, "post_id": 28207432, "comment_id": 44780422, "body": "You could try the <a href=\"https://wiki.haskell.org/Keywords#default\" rel=\"nofollow noreferrer\"><code>default</code></a> keyword and set it to <code>Int64</code>, is that what you&#39;re looking for?"}, {"owner": {"reputation": 492, "user_id": 2079797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c06f98eae9822ad28a2deac51a5a9f6e?s=128&d=identicon&r=PG&f=1", "display_name": "Minoru", "link": "https://stackoverflow.com/users/2079797/minoru"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1422513417, "post_id": 28207432, "comment_id": 44781542, "body": "Thank you for giving me the opportunity to look into what the <code>default</code> keyword does. Unfortunately it seems to be a module-level keyword, not suited for what I want (have a polymorphic library function to which you can pass numeric literals without adding type signatures)."}], "answers": [{"comments": [{"owner": {"reputation": 492, "user_id": 2079797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c06f98eae9822ad28a2deac51a5a9f6e?s=128&d=identicon&r=PG&f=1", "display_name": "Minoru", "link": "https://stackoverflow.com/users/2079797/minoru"}, "edited": false, "score": 0, "creation_date": 1422513894, "post_id": 28207753, "comment_id": 44781737, "body": "I&#39;m completely failing to grasp how <code>newtype MyInt = MyInt Int deriving (Num)</code> can help me deal with the type variable ambiguity error. Could you please elaborate a bit more?"}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "reply_to_user": {"reputation": 492, "user_id": 2079797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c06f98eae9822ad28a2deac51a5a9f6e?s=128&d=identicon&r=PG&f=1", "display_name": "Minoru", "link": "https://stackoverflow.com/users/2079797/minoru"}, "edited": false, "score": 0, "creation_date": 1422516073, "post_id": 28207753, "comment_id": 44782726, "body": "@Minoru, it doesn&#39;t help. I tried to clarify that part of the answer."}, {"owner": {"reputation": 492, "user_id": 2079797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c06f98eae9822ad28a2deac51a5a9f6e?s=128&d=identicon&r=PG&f=1", "display_name": "Minoru", "link": "https://stackoverflow.com/users/2079797/minoru"}, "edited": false, "score": 0, "creation_date": 1422516555, "post_id": 28207753, "comment_id": 44782951, "body": "I see. Thanks for such a great answer anyway."}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 2, "last_activity_date": 1422516059, "last_edit_date": 1422516059, "creation_date": 1422510350, "answer_id": 28207753, "question_id": 28207432, "link": "https://stackoverflow.com/questions/28207432/guessing-the-correct-instance-of-num-from-the-context/28207753#28207753", "title": "Guessing the correct instance of Num from the context", "body": "<p>When trying your example in GHC 7.8.3</p>\n\n<pre><code>&gt;&gt;&gt; meh 1\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>&lt;interactive&gt;:2:1:\n    No instance for (Meh a0) arising from a use of \u2018meh\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance Meh Unknown -- Defined at Meh.hs:9:10\n      instance Meh Int64 -- Defined at Meh.hs:7:10\n    In the expression: meh 1\n    In an equation for \u2018it\u2019: it = meh 1\n\n&lt;interactive&gt;:2:5:\n    No instance for (Num a0) arising from the literal \u20181\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Note: there are several potential instances:\n    ...\n</code></pre>\n\n<p>This is because compiler tries to typecheck:</p>\n\n<pre><code>&gt;&gt;&gt; meh (fromInteger (1 :: Integer))\n</code></pre>\n\n<p>For which you get similar errors:</p>\n\n<pre><code>&lt;interactive&gt;:4:1:\n    No instance for (Meh a0) arising from a use of \u2018meh\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance Meh Unknown -- Defined at Meh.hs:9:10\n      instance Meh Int64 -- Defined at Meh.hs:7:10\n    In the expression: meh (fromInteger (1 :: Integer))\n    In an equation for \u2018it\u2019: it = meh (fromInteger (1 :: Integer))\n\n&lt;interactive&gt;:4:6:\n    No instance for (Num a0) arising from a use of \u2018fromInteger\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Note: there are several potential instances:\n</code></pre>\n\n<hr>\n\n<p>Type-classes are open. No-one restricts someone else defining:</p>\n\n<pre><code>newtype MyInt = MyInt Int deriving (Num)\ninstance Meh MyInt where\n   meh = ...\n</code></pre>\n\n<p>Then even in your example <code>meh 1</code> can be resolved to <code>(meh :: Int64 -&gt; String) 1</code>, generally it can't. Arguments like \"but based on the <code>Meh</code> instances visible in the scope\" doesn't really work in Haskell, as instances are global.</p>\n\n<hr>\n\n<p>If you define <code>data</code> (which is closed), then using <code>{-# LANGUAGE OverloadedStrings #-}</code> you could do:</p>\n\n<pre><code>data Meh = MehInt Int64 | MehString String\n\ninstance IsString Meh where\n   fromString = MehString\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>\"foo\" :: Meh\n</code></pre>\n\n<p>will compile, as GHC \"will see\"</p>\n\n<pre><code>fromString \"foo\" :: Meh\n</code></pre>\n\n<p>Similarly you can define incomplete <code>Num</code> instance, with only <code>fromInteger</code> defined. Yet I personally dislike incomplete instances, though this case is handy when defining eDSLs.</p>\n"}], "owner": {"reputation": 492, "user_id": 2079797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c06f98eae9822ad28a2deac51a5a9f6e?s=128&d=identicon&r=PG&f=1", "display_name": "Minoru", "link": "https://stackoverflow.com/users/2079797/minoru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 28207753, "answer_count": 1, "score": 2, "last_activity_date": 1422516059, "creation_date": 1422508349, "question_id": 28207432, "link": "https://stackoverflow.com/questions/28207432/guessing-the-correct-instance-of-num-from-the-context", "title": "Guessing the correct instance of Num from the context", "body": "<p>Suppose:</p>\n\n<pre><code>import Data.Int (Int64)\n\ndata Unknown\n\nclass Meh a where\n    meh :: a -&gt; String\ninstance Meh Int64 where\n    meh = show\ninstance Meh Unknown where\n    meh _ = \"Unknown\"\n</code></pre>\n\n<p>It is obvious that <code>meh</code> can only take either an <code>Int64</code> or an <code>Unknown</code>.</p>\n\n<p>But we all know that</p>\n\n<pre><code>meh 1\n</code></pre>\n\n<p>will cause an error (No instance for (Num a0) arising from the literal '1') because <code>1</code> is <code>Num a =&gt; a</code> and compiler doesn't know which instance of <code>Num</code> it should be.</p>\n\n<p>However, it should (logically) be possible to infer <code>1</code> to be an <code>Int64</code> because it is passed to <code>meh</code> and <code>meh</code> can only take either an <code>Int64</code> or an <code>Unknown</code>. In other words, it should be possible to calculate the \"intersection\" of <code>Num</code> and <code>Meh</code> and decide which instance <code>1</code> is.</p>\n\n<p>So my question is: Do you know any way (compiler extension, code workaround, anything) that makes it possible to write <code>meh 1</code> where <code>1</code> is correctly inferred to be an <code>Int64</code> without adding type signatures or adding specialised functions?</p>\n"}, {"tags": ["facebook", "facebook-graph-api", "haskell", "happstack", "facebook-graph-api-v2.1"], "answers": [{"comments": [{"owner": {"reputation": 2813, "user_id": 4463660, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a7834b35fe2ac4b9d405e0b9f1b1bf10?s=128&d=identicon&r=PG&f=1", "display_name": "Citronen", "link": "https://stackoverflow.com/users/4463660/citronen"}, "edited": false, "score": 0, "creation_date": 1422549968, "post_id": 28210283, "comment_id": 44803292, "body": "Thank you for your answer, Tobi. I&#39;ve tried to encode the data as <code>multipart&#47;form</code> many different ways, but still receive the same error as above every time. Do you have any suggestions as to how to encode the PNG data?"}, {"owner": {"reputation": 30845, "user_id": 1603357, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/hvnAN.png?s=128&g=1", "display_name": "Tobi", "link": "https://stackoverflow.com/users/1603357/tobi"}, "reply_to_user": {"reputation": 2813, "user_id": 4463660, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a7834b35fe2ac4b9d405e0b9f1b1bf10?s=128&d=identicon&r=PG&f=1", "display_name": "Citronen", "link": "https://stackoverflow.com/users/4463660/citronen"}, "edited": false, "score": 0, "creation_date": 1422564227, "post_id": 28210283, "comment_id": 44811503, "body": "I&#39;m not a Haskell expert, but did you have a look at <a href=\"https://hackage.haskell.org/package/happstack-server-7.3.9/docs/Happstack-Server-Internal-Multipart.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/happstack-server-7.3.9/docs/&hellip;</a> especially the multipartBody property?"}, {"owner": {"reputation": 2813, "user_id": 4463660, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a7834b35fe2ac4b9d405e0b9f1b1bf10?s=128&d=identicon&r=PG&f=1", "display_name": "Citronen", "link": "https://stackoverflow.com/users/4463660/citronen"}, "edited": false, "score": 0, "creation_date": 1422574549, "post_id": 28210283, "comment_id": 44816601, "body": "I&#39;ve tried that, but I may be approaching the problem incorrectly. I&#39;ve been trying to encode the data as <code>multipart&#47;form-data</code> and send it along as a ByteString as a parameter. Should I somehow be trying to append the multipart to the request itself?"}, {"owner": {"reputation": 30845, "user_id": 1603357, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/hvnAN.png?s=128&g=1", "display_name": "Tobi", "link": "https://stackoverflow.com/users/1603357/tobi"}, "reply_to_user": {"reputation": 2813, "user_id": 4463660, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a7834b35fe2ac4b9d405e0b9f1b1bf10?s=128&d=identicon&r=PG&f=1", "display_name": "Citronen", "link": "https://stackoverflow.com/users/4463660/citronen"}, "edited": false, "score": 0, "creation_date": 1422604365, "post_id": 28210283, "comment_id": 44825122, "body": "As I said, I&#39;m not a Haskell export. I&#39;d try to append the multipart directly to the post request, I guess that is what it&#39;s for"}, {"owner": {"reputation": 2813, "user_id": 4463660, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a7834b35fe2ac4b9d405e0b9f1b1bf10?s=128&d=identicon&r=PG&f=1", "display_name": "Citronen", "link": "https://stackoverflow.com/users/4463660/citronen"}, "edited": false, "score": 0, "creation_date": 1422772865, "post_id": 28210283, "comment_id": 44877811, "body": "I have added the solution to my problem, but I have selected your answer as being correct."}], "tags": [], "owner": {"reputation": 30845, "user_id": 1603357, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/hvnAN.png?s=128&g=1", "display_name": "Tobi", "link": "https://stackoverflow.com/users/1603357/tobi"}, "is_accepted": true, "score": 0, "last_activity_date": 1422520847, "creation_date": 1422520847, "answer_id": 28210283, "question_id": 28207423, "link": "https://stackoverflow.com/questions/28207423/how-can-i-upload-a-photo-to-facebook-using-haskell/28210283#28210283", "title": "How can I upload a photo to Facebook using Haskell?", "body": "<p>Please check whether the photo's content is encoded correctly. It need to be <code>multipart/form-data</code> as stated on</p>\n\n<ul>\n<li><a href=\"https://developers.facebook.com/docs/graph-api/reference/v2.2/user/photos#publish\" rel=\"nofollow\">https://developers.facebook.com/docs/graph-api/reference/v2.2/user/photos#publish</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2813, "user_id": 4463660, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a7834b35fe2ac4b9d405e0b9f1b1bf10?s=128&d=identicon&r=PG&f=1", "display_name": "Citronen", "link": "https://stackoverflow.com/users/4463660/citronen"}, "is_accepted": false, "score": 0, "last_activity_date": 1422772828, "creation_date": 1422772828, "answer_id": 28260214, "question_id": 28207423, "link": "https://stackoverflow.com/questions/28207423/how-can-i-upload-a-photo-to-facebook-using-haskell/28260214#28260214", "title": "How can I upload a photo to Facebook using Haskell?", "body": "<p>What Tobi said is correct. The code to correctly perform this operation is: </p>\n\n<pre><code>postPhoto :: FB.UserAccessToken -&gt; IO Response\npostPhoto (FB.UserAccessToken _ b _) = withSocketsDo $ withManager $ \\m -&gt; do\n    fbpost &lt;- parseUrl $ \"https://graph.facebook.com/v2.2/me/photos?access_token=\" ++ T.unpack b\n    flip httpLbs m =&lt;&lt;\n        (formDataBody [partBS \"message\" \"Test Message\",\n                       partFileSource \"graph\" \"graph.png\"]\n                      fbpost)\n    return $ toResponse postFB\n</code></pre>\n\n<p>Enjoy!</p>\n"}], "owner": {"reputation": 2813, "user_id": 4463660, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a7834b35fe2ac4b9d405e0b9f1b1bf10?s=128&d=identicon&r=PG&f=1", "display_name": "Citronen", "link": "https://stackoverflow.com/users/4463660/citronen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "accepted_answer_id": 28210283, "answer_count": 2, "score": 3, "last_activity_date": 1422772828, "creation_date": 1422508301, "last_edit_date": 1422508690, "question_id": 28207423, "link": "https://stackoverflow.com/questions/28207423/how-can-i-upload-a-photo-to-facebook-using-haskell", "title": "How can I upload a photo to Facebook using Haskell?", "body": "<p>I am using Happstack, and I am trying to upload a photograph to Facebook using the Facebook Graph API.</p>\n\n<p>I can successfully post a message to Facebook. I can use <code>url</code>, however I am trying to do this with the <code>source</code> parameter.</p>\n\n<p>I have a ByteString of PNG data, but I can't seem to pass it along to Facebook.</p>\n\n<p>I am using the <a href=\"https://hackage.haskell.org/package/fb-0.7.5\" rel=\"nofollow\">fb Haskell library</a>.</p>\n\n<p>The functions that I have created to do this are:</p>\n\n<pre><code>performPost :: String -&gt; IO Response\nperformPost code = do\n    x &lt;- BS.readFile \"test.png\"\n    performFBAction $ do\n        postToFB (BS.unpack x) code =&lt;&lt; getToken url2 code\n        return $ toResponse postFB\n\npostToFB :: (MonadResource m, MonadBaseControl IO m) =&gt; String -&gt; String -&gt; FB.UserAccessToken -&gt; FB.FacebookT FB.Auth m FB.Id\npostToFB dataString code token = FB.postObject \"me/photos\" [args \"message\" \"Test Post Pls Ignore\",\n                                                            args \"source\" dataString] token\n</code></pre>\n\n<p>The error that I receive is:</p>\n\n<blockquote>\n  <p>The error was \"StatusCodeException (Status {statusCode = 400, statusMessage = \"Bad Request\"}) [(\"Content-Type\",\"text/html; charset=utf-8\"),(\"Date\",\"Thu, 29 Jan 2015 05:06:00 GMT\"),(\"Connection\",\"close\"),(\"Content-Length\",\"3121\")] (CJ {expose = []})</p>\n</blockquote>\n\n<p>What am I doing wrong? The Graph API states that the <code>source</code> parameter should be of type form data, but I have so far been unsuccessful in trying to convert it to such.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 18975, "user_id": 1539655, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/epO1x.jpg?s=128&g=1", "display_name": "levi", "link": "https://stackoverflow.com/users/1539655/levi"}, "edited": false, "score": 0, "creation_date": 1422507445, "post_id": 28207182, "comment_id": 44779647, "body": "what the function exactly does ? I didnt understand. It calculate if the given number is the length of the given list?"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 18975, "user_id": 1539655, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/epO1x.jpg?s=128&g=1", "display_name": "levi", "link": "https://stackoverflow.com/users/1539655/levi"}, "edited": false, "score": 0, "creation_date": 1422507811, "post_id": 28207182, "comment_id": 44779748, "body": "Sorry, I should proof read closer. Explanation and examples now included."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422509845, "post_id": 28207182, "comment_id": 44780378, "body": "FYI, <code>Ordering</code> and <code>compare</code> and all those things are exported by the standard Prelude, so you shouldn&#39;t need to import <code>Data.Ord</code> for those."}], "answers": [{"comments": [{"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1422508733, "post_id": 28207462, "comment_id": 44780031, "body": "Isn&#39;t <code>foldl</code> tail recursive? And can&#39;t we write <code>foldl</code> in terms of <code>foldr</code>? If we do so, do we lose the tail recursive property?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 1, "creation_date": 1422510142, "post_id": 28207462, "comment_id": 44780455, "body": "@Clinton, a big part of it is that tail recursion isn&#39;t nearly as important in a lazy language as it is in a strict language. The closest notion in a strict language to some of what laziness does for Haskell is a generalization of tail recursion called tail recursion modulo cons. Another thing is that GHC knows how to avoid the consing altogether in some important situations, turning something tail recursive modulo cons into something tail recursive. Or something like that, anyway."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422513147, "post_id": 28207462, "comment_id": 44781419, "body": "Could you explain why you chose to recast the problem in terms of the structure of the number instead of the structure of the list?"}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1422528232, "post_id": 28207462, "comment_id": 44789142, "body": "@Clinton To rephrase what dfeuer said: Yes, <code>foldl</code> defined in terms of <code>foldr</code> is still tail recursive. In Haskell, you cannot really say that &quot;<code>foldr</code> is not tail recursive&quot;. (So I disagree with the reply above.) Instead, given the definition of <code>foldr</code> shown above, it depends on what <code>cons</code> does. In a language with eager evaluation, the arguments to <code>cons</code> would be evaluated first, so it couldn&#39;t be tail-recursive. But Haskell evaluates <code>cons</code> first, and if that reduces to something that is just a call to <code>foldr</code> (and in the <code>foldl</code> via <code>foldr</code> case, it does), then everything is fine."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422556665, "post_id": 28207462, "comment_id": 44807247, "body": "@dfeuer Because part of the spec was being functional in face of infinite lists. Technically you could induct on both the list and the nat together to protect against all kinds of infinities, but that&#39;s a more complex induction principle."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "reply_to_user": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1422556899, "post_id": 28207462, "comment_id": 44807378, "body": "@kosmikus I agree with what you say in more detail. It&#39;s never as clear in lazy evaluation what will actually happen, but it&#39;s clear that short of inlining even your example will at least interleave calls to foldr and cons."}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1422557304, "post_id": 28207462, "comment_id": 44807613, "body": "@J.Abrahamson Yes. You are right about the possible interleaving. But all these calls (from foldr to cons and vice versa) are still tail calls, so I would still argue that this instantiation of foldr is (indirectly) tail recursive."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422560951, "post_id": 28207462, "comment_id": 44809543, "body": "@J.Abrahamson, take a look at my edit. To adapt my approach to potentially-infinite numbers just requires counting down instead of counting up."}], "tags": [], "owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "is_accepted": false, "score": 1, "last_activity_date": 1422514551, "last_edit_date": 1422514551, "creation_date": 1422508491, "answer_id": 28207462, "question_id": 28207182, "link": "https://stackoverflow.com/questions/28207182/generality-of-foldr-or-other-higher-order-function/28207462#28207462", "title": "Generality of `foldr` or other higher order function", "body": "<p>By it's very definition, <code>foldr</code> is not tail-recursive:</p>\n\n<pre><code>-- slightly simplified\nfoldr :: (a -&gt; r -&gt; r) -&gt; r -&gt; ([a] -&gt; r)\nfoldr cons nil []     = nil\nfoldr cons nil (a:as) = cons a (foldr cons nil as)\n</code></pre>\n\n<p>so you cannot achieve that end. That said, there are some attractive components of <code>foldr</code>'s semantics. In particular, it is \"productive\" which allows folds written with <code>foldr</code> to behave nicely with laziness.</p>\n\n<p>We can see <code>foldr</code> as saying how to break down (catalyze) a list one \"layer\" at a time. If the <code>cons</code> argument can return without caring about any further layers of the list then it can terminate early and we avoid ever having to examine any more tails of the list---this is how <code>foldr</code> can act non-strictly at times.</p>\n\n<p>Your function, to work on infinite lists, does something similar to the numeric argument. We'd like to operate on that argument \"layer by layer\". To make this more clear, let's define the naturals as follows</p>\n\n<pre><code>data Nat = Zero | Succ Nat\n</code></pre>\n\n<p>Now \"layer by layer\" more clearly means \"counting down to zero\". We can formalize that notion like so:</p>\n\n<pre><code>foldNat :: (r -&gt; r) -&gt; r -&gt; (Nat -&gt; r)\nfoldNat succ zero Zero = zero\nfoldNat succ zero (Succ n) = succ (foldNat succ zero n)\n</code></pre>\n\n<p>and now we can define something a bit like what we're looking for</p>\n\n<pre><code>compareLengthTo :: Nat -&gt; [a] -&gt; Ordering\ncompareLengthTo = foldNat succ zero where\n  zero :: [a] -&gt; Ordering\n  zero [] = EQ  -- we emptied the list and the nat at the same time\n  zero _  = GT  -- we're done with the nat, but more list remains\n\n  succ :: ([a] -&gt; Ordering) -&gt; ([a] -&gt; Ordering)\n  succ continue []     = LT  -- we ran out of list, but had more nat\n  succ continue (_:as) = continue as -- keep going, both nat and list remain\n</code></pre>\n\n<p>It can take some time to study the above to see how it works. In particular, note that I instantiated <code>r</code> as <em>a function</em>, <code>[a] -&gt; Ordering</code>. The form of the function above is \"recursion on the natural numbers\" and it allows it to accept infinite lists so long as the <code>Nat</code> argument isn't...</p>\n\n<pre><code> infinity :: Nat\n infinity = Succ infinity\n</code></pre>\n\n<p>Now, the above function works on this strange type, <code>Nat</code>, which models the non-negative integers. We can translate the same concept to <code>Int</code> by replacing <code>foldNat</code> with <code>foldInt</code>, written similarly:</p>\n\n<pre><code>foldInt :: (r -&gt; r) -&gt; r -&gt; (Int -&gt; r)\nfoldInt succ zero 0 = zero\nfoldInt succ zero n = succ (foldInt succ zero (n - 1))\n</code></pre>\n\n<p>which you can verify embodies the exact same pattern as <code>foldNat</code> but avoids the use of the awkward <code>Succ</code> and <code>Zero</code> constructors. You can also verify that <code>foldInt</code> behaves pathologically if we give it negative integers... which is about what we'd expect.</p>\n"}, {"comments": [{"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1422514092, "post_id": 28207799, "comment_id": 44781829, "body": "Thanks! Still need to get my head around the <code>foldl</code> using <code>foldr</code> thing, I suspected that was the approach but I think I&#39;ll need to pen+paper it to get a full understanding. Thanks for the guidance."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1422514395, "post_id": 28207799, "comment_id": 44781936, "body": "@Clinton, if you&#39;ve ever dealt with continuation passing style (CPS), the name <code>cont</code> should be suggestive."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 7, "last_activity_date": 1422560870, "last_edit_date": 1592644375, "creation_date": 1422510667, "answer_id": 28207799, "question_id": 28207182, "link": "https://stackoverflow.com/questions/28207182/generality-of-foldr-or-other-higher-order-function/28207799#28207799", "title": "Generality of `foldr` or other higher order function", "body": "<p>Here ya go (note: I just changed one comparison, which makes it lazier):</p>\n<pre><code>compareLengthTo :: [a] -&gt; Int -&gt; Ordering\ncompareLengthTo l n = foldr f (`compare` n) l 0\n  where\n    f l cont c | c &gt;= n = GT\n               | otherwise = cont $! c + 1\n</code></pre>\n<p>This uses exactly the same sort of technique used to implement <code>foldl</code> in terms of <code>foldr</code>. There's a classic article about the general technique called <a href=\"http://www.cs.nott.ac.uk/%7Egmh/fold.pdf\" rel=\"nofollow noreferrer\">A tutorial on the universality and expressiveness of fold</a>. You can also see a step-by-step explanation I wrote on the <a href=\"https://wiki.haskell.org/Foldl_as_foldr_alternative\" rel=\"nofollow noreferrer\">Haskell Wiki</a>.</p>\n<p>To get you started, note that <code>foldr</code> is being applied to <em>four</em> arguments here, rather than the usual three. This works out because the function being folded takes three arguments, and the &quot;base case&quot; is a function, <code>(`compare` n)</code>.</p>\n<h3>Edit</h3>\n<p>If you want to use lazy Peano numerals as J. Abrahamson does, you can count down instead of counting up.</p>\n<pre><code>compareLengthTo :: [a] -&gt; Nat -&gt; Ordering\ncompareLengthTo l n = foldr f final l n\n  where\n    f _ _ Zero = GT\n    f _ cont (Succ p) = cont p\n\n    final Zero = EQ\n    final _ = LT\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422517179, "post_id": 28208975, "comment_id": 44783234, "body": "The <code>foldr</code>-based solution I gave in my answer works for infinite lists. I think you may be missing something. It doesn&#39;t handle infinite numbers nearly as gracefully as a <code>zip</code>-style approach, however."}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422519661, "post_id": 28208975, "comment_id": 44784418, "body": "@dfeuer In your example you have a <code>c &gt;= n</code> case to short circuit the computation. Without that case, the function works still for finite lists. I find these code paths a bit smelly, at least worth comment to justify their existence. -- Indeed <code>zip</code> approach would be the most elegant, but it can&#39;t be expressed in terms of <code>foldr</code> + <code>foldNat</code> so it would work for both &quot;finite list + infinite number&quot; and &quot;infinite list + finite number&quot; situations. And obviously there aren&#39;t approach which would terminate for &quot;infinite number + infinite list&quot; combo."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1422561202, "post_id": 28208975, "comment_id": 44809701, "body": "I&#39;ve edited my answer; I expect you&#39;ll find the second implementation less smelly."}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 1, "last_activity_date": 1422515816, "last_edit_date": 1495540364, "creation_date": 1422515816, "answer_id": 28208975, "question_id": 28207182, "link": "https://stackoverflow.com/questions/28207182/generality-of-foldr-or-other-higher-order-function/28208975#28208975", "title": "Generality of `foldr` or other higher order function", "body": "<p>Have to participate into this coding competion:</p>\n\n<p>\"Prelude\":</p>\n\n<pre><code>import Test.QuickCheck\nimport Control.Applicative\n\ncompareLengthTo :: [a] -&gt; Int -&gt; Ordering\ncompareLengthTo l n = f 0 l\n  where\n    f c [] = c `compare` n\n    f c (l:ls) | c &gt; n = GT\n               | otherwise = f (c + 1) ls\n</code></pre>\n\n<p>My first attempt was to write this</p>\n\n<pre><code>compareLengthTo1 :: [a] -&gt; Int -&gt; Ordering\ncompareLengthTo1 l n = g $ foldr f (Just n) l\n  where\n    -- we go below zero\n    f _ (Just 0) = Nothing\n    f _ (Just n) = Just (n - 1)\n    f _ Nothing  = Nothing\n    g (Just 0) = EQ\n    g (Just _) = LT\n    g Nothing  = GT\n</code></pre>\n\n<p>And it works for finite arguments:</p>\n\n<pre><code>prop1 :: [()] -&gt; NonNegative Int -&gt; Property\nprop1 l (NonNegative n) = compareLengthTo l n === compareLengthTo1 l n\n\n-- &gt;&gt;&gt; quickCheck prop1\n-- +++ OK, passed 100 tests.\n</code></pre>\n\n<p>But it fails for infinite lists. Why?</p>\n\n<p>Let's define a variant using peano naturals:</p>\n\n<pre><code>data Nat = Zero | Succ Nat\n\nfoldNat :: (r -&gt; r) -&gt; r -&gt; (Nat -&gt; r)\nfoldNat succ zero Zero = zero\nfoldNat succ zero (Succ n) = succ (foldNat succ zero n)\n\nnatFromInteger :: Integer -&gt; Nat\nnatFromInteger 0 = Zero\nnatFromInteger n = Succ (natFromInteger (n - 1))\n\nnatToIntegral :: Integral a =&gt; Nat -&gt; a\nnatToIntegral = foldNat (1+) 0\n\ninstance Arbitrary Nat where\n  arbitrary = natFromInteger . getNonNegative &lt;$&gt; arbitrary\n\ninstance Show Nat where\n  show = show . (natToIntegral :: Nat -&gt; Integer)\n\ninfinity :: Nat\ninfinity = Succ infinity\n\ncompareLengthTo2 :: [a] -&gt; Nat -&gt; Ordering\ncompareLengthTo2 l n = g $ foldr f (Just n) l\n  where\n    f _ (Just Zero) = Nothing\n    f _ (Just (Succ n)) = Just n\n    f _ Nothing  = Nothing\n    g (Just Zero) = EQ\n    g (Just _) = LT\n    g Nothing  = GT\n\nprop2 :: [()] -&gt; Nat -&gt; Property\nprop2 l n = compareLengthTo l (natToIntegral n) === compareLengthTo2 l n\n\n-- &gt;&gt;&gt; compareLengthTo2 [] infinity\n-- LT\n</code></pre>\n\n<p>After staring long enough we see that it works for <em>infinite numbers</em>, not infinite lists.\nThat's why <a href=\"https://stackoverflow.com/a/28207462/1308058\">J. Abrahamson</a> used <code>foldNat</code> in his definition.\nSo if we <em>fold</em> the number argument, we will get function which works on infinite lists, but finite numbers:</p>\n\n<pre><code>compareLengthTo3 :: [a] -&gt; Nat -&gt; Ordering\ncompareLengthTo3 l n = g $ foldNat f (Just l) n\n  where\n    f (Just [])     = Nothing\n    f (Just (x:xs)) = Just xs\n    f Nothing       = Nothing\n    g (Just [])     = EQ\n    g (Just _)      = GT\n    g Nothing       = LT\n\nprop3 :: [()] -&gt; Nat -&gt; Property\nprop3 l n = compareLengthTo l (natToIntegral n) === compareLengthTo3 l n\n\nnats :: [Nat]\nnats = iterate Succ Zero\n\n-- &gt;&gt;&gt; compareLengthTo3 nats (natFromInteger 10)\n-- GT\n</code></pre>\n\n<hr>\n\n<p><code>foldr</code> and <code>foldNat</code> are kind of functions which generalise structural recursion on the argument (<em>catamorphisms</em>). They have nice property that given <em>finite</em> inputs and total functions as arguments, they are also total i.e. always terminate.</p>\n\n<p>That's why we <code>foldNat</code> in the last example. We assume that <code>Nat</code> argument is finite, so <code>compareLengthTo3</code> works on all <code>[a]</code> - even infinite.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 28207799, "answer_count": 3, "score": 1, "last_activity_date": 1422560870, "creation_date": 1422506799, "last_edit_date": 1422509736, "question_id": 28207182, "link": "https://stackoverflow.com/questions/28207182/generality-of-foldr-or-other-higher-order-function", "title": "Generality of `foldr` or other higher order function", "body": "<p>Here's a simple function that takes a list and a number and works out if the length of the list is greater than that number.</p>\n\n<p>e.g.</p>\n\n<pre><code>compareLengthTo [1,2,3] 3 == EQ\ncompareLengthTo [1,2] 3 == LT\ncompareLengthTo [1,2,3,4] 3 == GT\ncompareLengthTo [1..] 3 == GT\n</code></pre>\n\n<p>Note that it has two properties:</p>\n\n<ol>\n<li>It works for infinite lists.</li>\n<li>It is tail recursive and uses constant space.</li>\n</ol>\n\n\n\n<pre><code>import Data.Ord\n\ncompareLengthTo :: [a] -&gt; Int -&gt; Ordering\ncompareLengthTo l n = f 0 l\n  where\n    f c [] = c `compare` n\n    f c (l:ls) | c &gt; n = GT\n               | otherwise = f (c + 1) ls\n</code></pre>\n\n<p>Is there a way to write <code>compareLengthTo</code> using <code>foldr</code> only?</p>\n\n<p>Note, here's a version of <code>compareLengthTo</code> using <code>drop</code>:</p>\n\n<pre><code>compareLengthToDrop :: [a] -&gt; Int -&gt; Ordering\ncompareLengthToDrop l n = f (drop n (undefined:l))\n  where\n    f [] = LT\n    f [_] = EQ\n    f _ = GT\n</code></pre>\n\n<p>I guess another question is then, can you implement <code>drop</code> in terms of <code>foldr</code>?</p>\n"}, {"tags": ["haskell", "packaging", "shipping"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1422499462, "post_id": 28204973, "comment_id": 44777887, "body": "I can&#39;t reproduce this problem. When I run <code>PATH= .&#47;TryHint</code> everything goes smoothly: it prints a few numbers, then exits. I&#39;m also using GHC 7.8.3. How are you building <code>TryHint</code>?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1422505096, "post_id": 28204973, "comment_id": 44779088, "body": "What about <code>PATH=. TryHint</code> (note where the space is)? The executable <code>TryHint</code> should be in the current working directory."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1422506632, "post_id": 28204973, "comment_id": 44779432, "body": "@user5402 I tried both. They&#39;re exactly the same."}, {"owner": {"reputation": 3462, "user_id": 914859, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/52bf147a3e31747586f594049359d3d1?s=128&d=identicon&r=PG", "display_name": "Michael Fox", "link": "https://stackoverflow.com/users/914859/michael-fox"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1422507281, "post_id": 28204973, "comment_id": 44779619, "body": "@DanielWagner I&#39;m just compiling the normal way with ghc. Starting to suspect it&#39;s actually an OSX-specific issue. Dynamic linking works differently from Linux in ways I don&#39;t understand."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 7, "creation_date": 1422553863, "post_id": 28204973, "comment_id": 44805633, "body": "I also believe it&#39;s likely to be specific to OSX. You might want to open a ticket at GHC&#39;s <a href=\"https://ghc.haskell.org/trac/ghc/report\" rel=\"nofollow noreferrer\">tracker</a> as mentioned in the error message (after all, the impossible <i>did</i> just happen)."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 5, "creation_date": 1422643885, "post_id": 28204973, "comment_id": 44846112, "body": "I have no idea what is going on with that error, but in any case GHC depends on a lot of resources which you are not hiding from it with <code>PATH=.</code>, such as the interface files for Prelude and everything it transitively imports, the actual library files for base and ghc-prim and integer-gmp, and the GHC <code>settings</code> file. (Basically, everything installed under <code>&#47;usr&#47;lib&#47;ghc</code> or the equivalent directory for your installation.)"}, {"owner": {"reputation": 3462, "user_id": 914859, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/52bf147a3e31747586f594049359d3d1?s=128&d=identicon&r=PG", "display_name": "Michael Fox", "link": "https://stackoverflow.com/users/914859/michael-fox"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1422644545, "post_id": 28204973, "comment_id": 44846440, "body": "@ReidBarton I couldn&#39;t think of how to test it before but with <code>mv &#47;usr&#47;local&#47;Cellar&#47;ghc &#47;usr&#47;local&#47;Cellar&#47;ghc.bak</code> I get <code>&#47;usr&#47;local&#47;Cellar&#47;ghc&#47;7.8.4&#47;lib&#47;ghc-7.8.4&#47;settings: openFile: does not exist (No such file or directory)</code>. I was hoping everything would be statically linked but it&#39;s not looking good."}, {"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 2, "creation_date": 1423869955, "post_id": 28204973, "comment_id": 45339878, "body": "@MichaelFox statically linking the GHC API doesn&#39;t work with the new dynamic linker introduced in GHC 7.8, I think :| (interactive code execution now requires dynamic libraries)"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 2, "creation_date": 1424404432, "post_id": 28204973, "comment_id": 45544949, "body": "@bennofs it looks like your comment is almost an answer if you slightly reword it!"}, {"owner": {"reputation": 387, "user_id": 1701790, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/65944183b3935873fd2087e45b27269e?s=128&d=identicon&r=PG", "display_name": "Goens", "link": "https://stackoverflow.com/users/1701790/goens"}, "edited": false, "score": 0, "creation_date": 1434725427, "post_id": 28204973, "comment_id": 49917219, "body": "have you tried looking at the trace of system calls? It might help you find out where it hangs. In linux I would use strace, in OS X dtruss seems to be the equivalent."}], "answers": [{"tags": [], "owner": {"reputation": 6574, "user_id": 4698026, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-P-bQf8VLKQY/AAAAAAAAAAI/AAAAAAAAAO4/a_8mG7UXRfo/photo.jpg?sz=128", "display_name": "Himanshu Mishra", "link": "https://stackoverflow.com/users/4698026/himanshu-mishra"}, "is_accepted": false, "score": 2, "last_activity_date": 1435026121, "creation_date": 1435026121, "answer_id": 30992842, "question_id": 28204973, "link": "https://stackoverflow.com/questions/28204973/how-to-ship-an-executable-with-language-haskell-interpreter/30992842#30992842", "title": "How to ship an executable with Language.Haskell.Interpreter?", "body": "<p>Shipping an executable with <code>Language.Haskell.Interpreter</code> seems to go perfect with the way you have shown. You have to set your <code>PATH</code> to the script you want to execute.</p>\n\n<p>And as of side note, as mentioned by @bennofs in comments, Statically linking the GHC API doesn't work with the new dynamic linker introduced in GHC 7.8, (interactive code execution now requires dynamic libraries).</p>\n"}], "owner": {"reputation": 3462, "user_id": 914859, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/52bf147a3e31747586f594049359d3d1?s=128&d=identicon&r=PG", "display_name": "Michael Fox", "link": "https://stackoverflow.com/users/914859/michael-fox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2143, "favorite_count": 8, "answer_count": 1, "score": 136, "last_activity_date": 1535817383, "creation_date": 1422490948, "last_edit_date": 1535817383, "question_id": 28204973, "link": "https://stackoverflow.com/questions/28204973/how-to-ship-an-executable-with-language-haskell-interpreter", "title": "How to ship an executable with Language.Haskell.Interpreter?", "body": "<p>I was hoping to embed a Haskell interpreter using <code>hint</code> so that I could write plugins in Haskell to use with my program. I don't want to have to ship the entire Haskell platform for my executables. </p>\n\n<p>Normally, Haskell executables are pretty self-contained. For example, erasing the <code>PATH</code> does not cause a problem:</p>\n\n<pre><code>$ PATH=. Hello\nHello world\n</code></pre>\n\n<p>However, a simple test program using <code>runInterpreter</code> bombs if I erase the <code>PATH</code>:</p>\n\n<pre><code>$ PATH=. TryHint\nGhcException \"panic! (the 'impossible' happened)\\n  (GHC version 7.8.3 for x86_64-apple-darwin):\\n\\tDynamic linker not initialised\\n\\nPlease report this as a GHC bug:  http://www.haskell.org/ghc/reportabug\\n\"\n</code></pre>\n\n<p><strong>What libraries or executables have to be available in the environment for it to work?</strong></p>\n\n<p><code>otool</code> doesn't give much guidance:</p>\n\n<pre><code>otool -L TryHint\nTryHint:\n    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1213.0.0)\n    /usr/lib/libiconv.2.dylib (compatibility version 7.0.0, current version 7.0.0)\n    /usr/local/lib/libgmp.10.dylib (compatibility version 13.0.0, current version 13.0.0)\n</code></pre>\n\n<p>The test code for <code>TryHint</code> does not do much:</p>\n\n<pre><code>import Control.Monad\nimport Language.Haskell.Interpreter\n\nmain = do\n  f &lt;- runInterpreter $ loadModules [\"Test\"] &gt;&gt; setTopLevelModules [\"Test\"] &gt;&gt; interpret \"f\" (as :: Int -&gt; Int)\n  case f of\n    Left e -&gt; print e\n    Right r -&gt; mapM_ (print . r) [1..10]\n</code></pre>\n\n<p>It just binds <code>f</code> to a function in <code>Test.hs</code> to be interpreted at run-time. <code>Test.hs</code> looks like this:</p>\n\n<pre><code>module Test where\nf :: Int -&gt; Int\nf x = x + 1\n</code></pre>\n"}]