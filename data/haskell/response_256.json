[{"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1575737681, "last_edit_date": 1575737681, "creation_date": 1575515709, "answer_id": 59187689, "question_id": 59186285, "link": "https://stackoverflow.com/questions/59186285/why-does-this-example-from-haskells-svgfonts-library-fail-to-compile/59187689#59187689", "title": "Why does this example from Haskell&#39;s SVGFonts library fail to compile?", "body": "<p>It would appear that their documentation is outdated and no longer matches their code, as of commit <a href=\"https://github.com/diagrams/SVGFonts/commit/61424cca2bb752d756f9bec641e28ecd106a297c\" rel=\"nofollow noreferrer\"><code>61424cc</code></a>. (This is why you should use doctests, people!)</p>\n\n<p>You can't use <code>lin</code> while it's still wrapped in <code>IO</code>. Do something like this instead:</p>\n\n<pre><code>do\n  lin' &lt;- lin\n  let text'' t = (textSVG_ (TextOpts lin' INSIDE_H KERN True 1 1) t)\n                 # fc blue # lc blue # bg lightgrey # fillRule EvenOdd # showOrigin\n</code></pre>\n\n<p>If you don't have <code>IO</code> handy there, then make it a function argument and get the font later:</p>\n\n<pre><code>text'' font t = (textSVG_ (TextOpts font INSIDE_H KERN True 1 1) t)\n                # fc blue # lc blue # bg lightgrey # fillRule EvenOdd # showOrigin\n</code></pre>\n\n<p>Or you can cheat, <a href=\"https://hackage.haskell.org/package/SVGFonts-1.7.0.1/docs/src/Graphics.SVGFonts.Text.html#line-41\" rel=\"nofollow noreferrer\">like they do in their <code>Default</code> instance</a>:</p>\n\n<pre><code>text'' t = (textSVG_ (TextOpts (unsafePerformIO lin) INSIDE_H KERN True 1 1) t)\n           # fc blue # lc blue # bg lightgrey # fillRule EvenOdd # showOrigin\n</code></pre>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 59187689, "answer_count": 1, "score": 3, "last_activity_date": 1575737681, "creation_date": 1575503879, "question_id": 59186285, "link": "https://stackoverflow.com/questions/59186285/why-does-this-example-from-haskells-svgfonts-library-fail-to-compile", "title": "Why does this example from Haskell&#39;s SVGFonts library fail to compile?", "body": "<p>Using Haskell's <code>SVGFonts</code> library, I am trying to use the <code>textSVG_</code> function to generate a diagram. Here is the example I am trying to follow, which is included in the code by the <a href=\"https://hackage.haskell.org/package/SVGFonts-1.7.0.1/docs/Graphics-SVGFonts.html#v:textSVG_\" rel=\"nofollow noreferrer\">definition of <code>textSVG_</code></a>:</p>\n\n<pre><code>text'' t = (textSVG_ (TextOpts lin INSIDE_H KERN True 1 1) t)\n           # fc blue # lc blue # bg lightgrey # fillRule EvenOdd # showOrigin\n</code></pre>\n\n<p>It uses <code>lin</code> in <code>TextOpts</code>' <code>textFont</code> field. However, there appears to be a type mismatch between what is expected by <code>TextOpts</code>' <code>textFont</code> field, and the definition of <code>lin</code>.\n<a href=\"https://hackage.haskell.org/package/SVGFonts-1.7.0.1/docs/Graphics-SVGFonts.html#t:TextOpts\" rel=\"nofollow noreferrer\"><code>TextOpts</code>' definition</a> shows the <code>textFont</code> field to have type <code>textFont :: PreparedFont n</code>, whereas the <a href=\"https://hackage.haskell.org/package/SVGFonts-1.7.0.1/docs/Graphics-SVGFonts.html#v:lin\" rel=\"nofollow noreferrer\">definition of <code>lin</code></a> shows it to have type <code>lin :: (Read n, RealFloat n) =&gt; IO (PreparedFont n)</code>.</p>\n\n<p>Why the <code>IO</code> in <code>lin</code>? It throws a type mismatch when I attempt to compile it.</p>\n\n<pre><code>Couldn't match type `IO\n                         (Graphics.SVGFonts.ReadFont.PreparedFont Double)'\n                 with `(Graphics.SVGFonts.ReadFont.FontData n,\n                        Graphics.SVGFonts.ReadFont.OutlineMap n)'\n  Expected type: Graphics.SVGFonts.ReadFont.PreparedFont n\n    Actual type: IO (Graphics.SVGFonts.ReadFont.PreparedFont Double)\n</code></pre>\n\n<p>How can I simply provide a <code>PreparedFont n</code> to <code>TextOpts</code>'s <code>textFont</code> field?</p>\n"}, {"tags": ["haskell", "binary-tree", "binary-search-tree"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1575485347, "post_id": 59182840, "comment_id": 104586478, "body": "The underscore (<code>_</code>) means it is still something you need to fill in. Holes are sometimes used to let Haskell derive the type of that hole (and to give partial solutions :) )"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1575486356, "post_id": 59182840, "comment_id": 104586837, "body": "You are trying to use <code>if</code> to do pattern matching, but <code>if</code> does not do pattern matching. You need to use <code>case a of ....</code> or multiple defining equations."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1575486029, "post_id": 59182905, "comment_id": 104586729, "body": "I don&#39;t think there&#39;s anything you could fill these holes in with to make the program compile. Calling <code>a</code> as a function just makes no sense no matter what arguments you construct for it."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1575485572, "creation_date": 1575485572, "answer_id": 59182905, "question_id": 59182840, "link": "https://stackoverflow.com/questions/59182840/a-haskell-problem-writing-error-found-hole-a5/59182905#59182905", "title": "A Haskell Problem writing Error Found hole _ a5", "body": "<p>In your code, there are two underscores (<code>_</code>) at the right side of the <code>successor</code> function, these are <a href=\"https://wiki.haskell.org/GHC/Typed_holes\" rel=\"nofollow noreferrer\"><em>typed holes</em> [haskell-wiki]</a>.</p>\n\n<p>Typed holes are useful to let the compiler generate the type of the item that should be placed there, if it is hard to figure this out yourself. On QA sites, like StackOverflow, typed holes are frequently used to provide a solution where the OP still needs to implement certain aspects.</p>\n\n<p>In this specific case, you will thus need to fill in some expression for the <code>_</code> in the two subexpressions <code>(Node _ t1 t2)</code> (not per se the <em>same</em> expression in the two cases).</p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1575489291, "creation_date": 1575489291, "answer_id": 59183759, "question_id": 59182840, "link": "https://stackoverflow.com/questions/59182840/a-haskell-problem-writing-error-found-hole-a5/59183759#59183759", "title": "A Haskell Problem writing Error Found hole _ a5", "body": "<pre><code>if a (Node _ t1 t2)\n</code></pre>\n\n<p>This is not valid Haskell.  You seem to be treating <code>if</code> as a place to pattern match when in fact it requires a boolean expression.</p>\n\n<pre><code>if a Nil then\n</code></pre>\n\n<p>This seems to be following the same logic.</p>\n\n<p>Instead consider pattern matching via a case expression or function definition:</p>\n\n<pre><code>successor :: (Ord a) =&gt; a -&gt; BSearchTree a -&gt; Maybe a \nsuccessor _NotUsingThisValue Nil = ... something ...\nsuccessor valToMatch (Node val leftTree rightTree) = .. other thing ..\n</code></pre>\n\n<p>N.B. <code>Just succ Nil</code> is also not valid.  First, it parses as <code>(Just succ) Nil</code> (not <code>Just (succ Nil)</code>) and secondly there is no meaningful use of <code>succ</code> here.</p>\n"}, {"tags": [], "owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "is_accepted": false, "score": 0, "last_activity_date": 1575557310, "creation_date": 1575557310, "answer_id": 59197662, "question_id": 59182840, "link": "https://stackoverflow.com/questions/59182840/a-haskell-problem-writing-error-found-hole-a5/59197662#59197662", "title": "A Haskell Problem writing Error Found hole _ a5", "body": "<p>In Haskell, <code>if</code> statements work on <code>Bool</code> values. In your program, you have syntax that looks like <code>if (a Nil) then ... else ...</code>. Unfortunately, <code>(a Nil)</code> is not a <code>Bool</code> value. In fact, <code>a Nil</code> is not a well typed value at all.</p>\n\n<p>So, one way to write your code is the way Thomas M. DuBuisson said. Another way is to use <code>case ... of ...</code> syntax.</p>\n\n<pre><code>successor :: (Ord a) =&gt; a -&gt; BSearchTree a -&gt; Maybe a \nsuccessor a = case a of\n                Nil -&gt; Just (succ Nil)\n                n@(Node _ t1 t2) -&gt; Just (succ a n)\n                _ -&gt; Nothing\n</code></pre>\n\n<p>Couple of other comments:</p>\n\n<ul>\n<li>Note the use of <code>n@(Node _ t1 t2)</code> above. This says \"remember anything that matches this pattern as <code>n</code>\". Writing <code>Just (succ a (Node _ t1 t2))</code> on the right hand side of the pattern would not work, because <code>(Node _ t1 t2)</code> is a pattern, not a value, i.e, it is an instruction to match the <code>BSearchTree a</code> values of that \"shape\".</li>\n<li>Every value of type <code>BSearchTree a</code> always matches <code>Nil</code> or <code>Node _ _ _</code>. This is guaranteed by the Haskell semantics. Therefore, you should not really need the <code>else Nothing</code> branch.</li>\n<li>You can write <code>case a of Nil -&gt; ... ; _ -&gt; ...</code> as <code>if (a == Nil) then ... else ...</code>, but this is not advisable.</li>\n</ul>\n"}], "owner": {"reputation": 51, "user_id": 12290526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef0a9965f9a92c5f2c3d8b1f5a5a58dd?s=128&d=identicon&r=PG&f=1", "display_name": "123", "link": "https://stackoverflow.com/users/12290526/123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1575557310, "creation_date": 1575485257, "question_id": 59182840, "link": "https://stackoverflow.com/questions/59182840/a-haskell-problem-writing-error-found-hole-a5", "title": "A Haskell Problem writing Error Found hole _ a5", "body": "<p>Make a function that counts the next element in the binary tree.</p>\n\n<pre><code>data BSearchTree a = Nil | Node a (BSearchTree a) (BSearchTree a)\n                      deriving (Show, Eq)\nsuccessor :: (Ord a) =&gt; a -&gt; BSearchTree a -&gt; Maybe a \nsuccessor a = if a Nil then Just succ Nil\n              else if a (Node _ t1 t2)\n               then Just succ a (Node _ t1 t2)\n           else Nothing\n</code></pre>\n\n<p>Found hole: _ :: a5\n      Where: \u2018a5\u2019 is an ambiguous type variable\n    \u2022 In the first argument of \u2018Node\u2019, namely \u2018_\u2019\n      In the first argument of \u2018a\u2019, namely \u2018(Node _ t1 t2)\u2019\n      In the expression: a (Node _ t1 t2)\n    \u2022 Relevant bindings include\n        a :: a (bound at desktop/Aufgabe6.4.hs:32:11)\n        successor :: a -> BSearchTree a -> Maybe a\n          (bound at desktop/Aufgabe6.4.hs:32:1)\n      Constraints include Ord a (from desktop/Aufgabe6.4.hs:30:1-53)\n   |\n |               else if a (Node _ t1 t2)</p>\n\n<p>don't really understand, what the error means...</p>\n"}, {"tags": ["haskell", "state", "monads", "monad-transformers", "state-monad"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575480639, "post_id": 59181689, "comment_id": 104584189, "body": "FYI, <code>_innerVal &lt;$&gt; get</code> is just <code>gets _innerVal</code> (as <code>gets f == liftM f get</code>, and <code>liftM</code> is just <code>fmap</code> specialized to monads)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575480811, "post_id": 59181689, "comment_id": 104584294, "body": "Where are you getting a <code>StateT InnerState m Int</code> value in the first place in <code>outerStateFoo</code>?"}, {"owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575481307, "post_id": 59181689, "comment_id": 104584552, "body": "@chepner in case the value b is true, I want to run the innerStateFoo"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 6, "creation_date": 1575481669, "post_id": 59181689, "comment_id": 104584736, "body": "Are you comfortable with lens? This use case seems to be exactly what <a href=\"https://hackage.haskell.org/package/lens-4.18.1/docs/Control-Lens-Zoom.html#v:zoom\" rel=\"nofollow noreferrer\"><code>zoom</code></a> is for."}, {"owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1575482991, "post_id": 59181689, "comment_id": 104585430, "body": "@Carl I have seen some lenses but don&#39;t understand them very well. Maybe you can explain in an answer how to use zoom?"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 5, "creation_date": 1575483320, "post_id": 59181689, "comment_id": 104585610, "body": "An observation: This entry does not contain a single question."}], "answers": [{"comments": [{"owner": {"reputation": 866, "user_id": 2872507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ebde219395d677c399d8e950f5a48c?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Vieth", "link": "https://stackoverflow.com/users/2872507/alexander-vieth"}, "reply_to_user": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "edited": false, "score": 3, "creation_date": 1575503867, "post_id": 59186012, "comment_id": 104592728, "body": "I&#39;d just call it pure functional programming! But I know that&#39;s not the answer you&#39;re looking for :) StreamTransformer is in fact a &quot;Mealy machine&quot; <a href=\"http://hackage.haskell.org/package/machines-0.7/docs/Data-Machine-Mealy.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/machines-0.7/docs/&hellip;</a>"}, {"owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "edited": false, "score": 0, "creation_date": 1575503963, "post_id": 59186012, "comment_id": 104592754, "body": "No, the first output vanishing isn&#39;t what I intended. I would like to <i>delay</i> the first output to be the second one."}, {"owner": {"reputation": 866, "user_id": 2872507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ebde219395d677c399d8e950f5a48c?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Vieth", "link": "https://stackoverflow.com/users/2872507/alexander-vieth"}, "reply_to_user": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "edited": false, "score": 2, "creation_date": 1575504236, "post_id": 59186012, "comment_id": 104592829, "body": "And so on so that every output is delayed by one step? That can be done."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1575576775, "post_id": 59186012, "comment_id": 104623042, "body": "very nice, thanks for posting! (sorry for commenting previously without heaving read the Q properly). I think the OP meant <code>pre st = stateful (Nothing, st) k   where   k i (s,st) = let (o, st&#39;) = runStreamTransformer st i in                ( maybe False id s , (Just o, st&#39;))</code>."}], "tags": [], "owner": {"reputation": 866, "user_id": 2872507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ebde219395d677c399d8e950f5a48c?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Vieth", "link": "https://stackoverflow.com/users/2872507/alexander-vieth"}, "is_accepted": false, "score": 5, "last_activity_date": 1575503791, "last_edit_date": 1575503791, "creation_date": 1575501752, "answer_id": 59186012, "question_id": 59181689, "link": "https://stackoverflow.com/questions/59181689/nested-states-in-haskell/59186012#59186012", "title": "Nested States in Haskell", "body": "<blockquote>\n  <p>For context, this is what I want to achieve with this machinery:</p>\n  \n  <p>I want to design these things called \"Stream Transformers\", which are basically stateful functions: They consume a token, mutate their internal state and output something. Specifically, I am interested in a class of Stream Transformers where the output is a Boolean value; we will call these \"monitors\".</p>\n</blockquote>\n\n<p>I think that what you want to achieve doesn't need very much machinery.</p>\n\n<pre><code>newtype StreamTransformer input output = StreamTransformer\n  { runStreamTransformer :: input -&gt; (output, StreamTransformer input output)\n  }\n\ntype Monitor input = StreamTransformer input Bool\n\npre :: Monitor input -&gt; Monitor input\npre st = StreamTransformer $ \\i -&gt;\n  -- NB: the first output of the stream transformer vanishes.\n  -- Is that OK? Maybe this representation doesn't fit the spec?\n  let (_, st') = runStreamTransformer st i\n  in  (False, st')\n\nand :: Monitor input -&gt; Monitor input -&gt; Monitor input\nand left right = StreamTransformer $ \\i -&gt;\n  let (bleft,  mleft)  = runStreamTransformer left  i\n      (bright, mright) = runStreamTransformer right i\n  in  (bleft &amp;&amp; bright, mleft `and` mright)\n</code></pre>\n\n<p>This <code>StreamTransformer</code> is not <em>necessarily</em> stateful, but admits stateful ones. You don't need to (and IMO should not! in most cases!!) reach for typeclasses in order to define these (or indeed ever! :) but that's another topic).</p>\n\n<pre><code>notStateful :: StreamTransformer input ()\nnotStateful = StreamTransformer $ \\_ -&gt; ((), notStateful)\n\nstateful :: s -&gt; (input -&gt; s -&gt; (output, s)) -&gt; StreamTransformer input output\nstateful s k = StreamTransformer $ \\input -&gt;\n  let (output, s') = k input s\n  in  (output, stateful s' k)\n\nalternateBool :: Monitor anything\nalternateBool = stateful True $ \\_ s -&gt; (s, not s)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13132, "user_id": 2168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5e7e68e1cdaea224d93da209afb28e9d?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2168/john"}, "is_accepted": true, "score": 4, "last_activity_date": 1575524705, "last_edit_date": 1575524705, "creation_date": 1575524097, "answer_id": 59188858, "question_id": 59181689, "link": "https://stackoverflow.com/questions/59181689/nested-states-in-haskell/59188858#59188858", "title": "Nested States in Haskell", "body": "<p>For your first question, as Carl mentioned, <code>zoom</code> from <code>lens</code> does exactly what you want.  Your code with lenses could be written like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE TemplateHaskell #-}\n\nimport Control.Lens\nimport Control.Monad.State.Lazy\n\nnewtype InnerState = MkInnerState { _innerVal :: Int }\n  deriving (Eq, Ord, Read, Show)\n\ndata OuterState = MkOuterState\n  { _outerTrigger :: Bool\n  , _inner        :: InnerState\n  } deriving (Eq, Ord, Read, Show)\n\nmakeLenses ''InnerState\nmakeLenses ''OuterState\n\ninnerStateFoo :: Monad m =&gt; StateT InnerState m Int\ninnerStateFoo = do\n  i &lt;- gets _innerVal\n  put $ MkInnerState (i + 1)\n  return i\n\nouterStateFoo :: Monad m =&gt;  StateT OuterState m Int\nouterStateFoo = do\n  b &lt;- gets _outerTrigger\n  if b\n    then zoom inner $ innerStateFoo\n    else pure 666\n</code></pre>\n\n<p>Edit: While we're at it, if you're already bringing in <code>lens</code> then <code>innerStateFoo</code> can be written like so:</p>\n\n<pre><code>innerStateFoo :: Monad m =&gt; StateT InnerState m Int\ninnerStateFoo = innerVal &lt;&lt;+= 1\n</code></pre>\n"}], "owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 59188858, "answer_count": 2, "score": 9, "last_activity_date": 1575524705, "creation_date": 1575480434, "last_edit_date": 1575482913, "question_id": 59181689, "link": "https://stackoverflow.com/questions/59181689/nested-states-in-haskell", "title": "Nested States in Haskell", "body": "<p>I am trying to define a family of state machines with somewhat different kinds of states. In particular, the more \"complex\" state machines have states which are formed by combining the states of simpler state machines. </p>\n\n<p>(This is similar to an object oriented setting where an object has several attributes which are also objects.)</p>\n\n<p>Here is a simplified example of what I want to achieve.</p>\n\n<pre><code>data InnerState = MkInnerState { _innerVal :: Int }\n\ndata OuterState = MkOuterState { _outerTrigger :: Bool, _inner :: InnerState }\n\ninnerStateFoo :: Monad m =&gt; StateT InnerState m Int\ninnerStateFoo = do\n  i &lt;- _innerVal &lt;$&gt; get\n  put $ MkInnerState (i + 1)\n  return i\n\nouterStateFoo :: Monad m =&gt;  StateT OuterState m Int\nouterStateFoo = do\n  b &lt;- _outerTrigger &lt;$&gt; get\n  if b\n    then\n       undefined\n       -- Here I want to \"invoke\" innerStateFoo\n       -- which should work/mutate things\n        -- \"as expected\" without\n       -- having to know about the outerState it\n       -- is wrapped in\n    else\n       return 666\n</code></pre>\n\n<p>More generally, I want a generalized framework where these nestings are more complex. Here is something I wish to know how to do.</p>\n\n<pre><code>class LegalState s\n\ndata StateLess\n\ndata StateWithTrigger where\n  StateWithTrigger :: LegalState s =&gt; Bool -- if this trigger is `True`, I want to use\n                                   -&gt; s    -- this state machine\n                                   -&gt; StateWithTrigger\n\ndata CombinedState where\n  CombinedState :: LegalState s =&gt; [s] -- Here is a list of state machines.\n                                -&gt; CombinedState -- The combinedstate state machine runs each of them\n\ninstance LegalState StateLess\ninstance LegalState StateWithTrigger\ninstance LegalState CombinedState\n\nliftToTrigger :: Monad m, LegalState s =&gt; StateT s m o -&gt; StateT StateWithTrigger m o\nliftToCombine :: Monad m, LegalState s =&gt; [StateT s m o] -&gt; StateT CombinedState m o\n</code></pre>\n\n<hr>\n\n<p>For context, this is what I want to achieve with this machinery:</p>\n\n<p>I want to design these things called \"Stream Transformers\", which are basically stateful functions: They consume a token, mutate their internal state and output something. Specifically, I am interested in a class of Stream Transformers where the output is a Boolean value; we will call these \"monitors\".</p>\n\n<p>Now, I am trying to design combinators for these objects. Some of them are:</p>\n\n<ul>\n<li>A <code>pre</code> combinator. Suppose that <code>mon</code> is a monitor. Then, <code>pre mon</code> is a monitor which always produces <code>False</code> after the first token is consumed and then mimicks the behaviour of <code>mon</code> as if the previous token is being inserted now. I would want to model the state of <code>pre mon</code> with <code>StateWithTrigger</code> in the example above since the new state is a boolean along with the original state.</li>\n<li>An <code>and</code> combinator. Suppose that <code>m1</code> and <code>m2</code> are monitors. Then, <code>m1 `and` m2</code> is a monitor which feeds the token to m1, and then to m2, and then produces <code>True</code> if both of the answers were true. I would want to model the state of <code>m1 `and` m2</code> with <code>CombinedState</code> in the example above since the state of both monitors must be maintained.</li>\n</ul>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "edited": false, "score": 1, "creation_date": 1575478451, "post_id": 59180537, "comment_id": 104582991, "body": "You can use <code>foldr</code> or <code>foldl</code> to reduct a list depends on the direction. To apply function user <code>$</code>.  In this case expression is: <code>foldr ($) 5 [(+1),(*3),(+(-2))]</code>"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1575498402, "post_id": 59180537, "comment_id": 104591218, "body": "I don&#39;t think this is the same with the assigned duplicate since OP requires a composition of functions. I voted reopen. An answer could be <code>foldl1 (.) [(+1),(*3),(+(-2))] $ 5</code>"}, {"owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "edited": false, "score": 0, "creation_date": 1575533941, "post_id": 59180537, "comment_id": 104600864, "body": "Agree with you, in the opposite direction we need different <code>f</code> because of <code>foldl</code> signature."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575559316, "post_id": 59180537, "comment_id": 104614448, "body": "Use <code>Data.List.foldl1&#39;</code>, though, to force evaluation of each function as it is processed."}, {"owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "reply_to_user": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "edited": false, "score": 1, "creation_date": 1575563727, "post_id": 59180537, "comment_id": 104616986, "body": "@mkUltra Thank you for the help, I posted the solution as an answer so I could close the question."}], "answers": [{"tags": [], "owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1575563667, "creation_date": 1575563667, "answer_id": 59199562, "question_id": 59180537, "link": "https://stackoverflow.com/questions/59180537/apply-a-list-of-functions-to-an-input/59199562#59199562", "title": "Apply a list of functions to an input", "body": "<p>Solved with mkUltras' comment:</p>\n\n<blockquote>\n  <p>You can use foldr or foldl to reduct a list depends on the direction.\n  To apply function user $. In this case expression is: foldr ($) 5\n  [(+1),(*3),(+(-2))]</p>\n</blockquote>\n\n<p>My final code: <code>succApply x n = foldr ($) n x</code></p>\n\n<p>Example inputs:</p>\n\n<pre><code>succApply [(+1),(*2),(+(-1))] 1 == 1\nsuccApply [init, tail] [1..5] == [2,3,4]\nsuccApply [(*2), id, (+1)] 5 == 12\n</code></pre>\n"}], "owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 59199562, "answer_count": 1, "score": 1, "last_activity_date": 1575563798, "creation_date": 1575476848, "last_edit_date": 1575563798, "question_id": 59180537, "link": "https://stackoverflow.com/questions/59180537/apply-a-list-of-functions-to-an-input", "title": "Apply a list of functions to an input", "body": "<p>I'd like to apply a list of functions to an input.\nFor example, if my list fo functions is <code>[(+1),(*3),(+(-2))]</code> and my input is <code>5</code>, I would like to apply the functions from right to left, so the output would be <code>10</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 5, "creation_date": 1575468511, "post_id": 59177765, "comment_id": 104577016, "body": "If it currently works, <a href=\"http://codereview.stackexchange.com\">codereview.stackexchange.com</a> is more appropriate for this kind of question (open-ended requests for improvements to working code)."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1575470612, "post_id": 59177765, "comment_id": 104578353, "body": "Use more pattern matching, and check out <code>Data.List.maximumBy</code>."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1575474725, "creation_date": 1575474725, "answer_id": 59179888, "question_id": 59177765, "link": "https://stackoverflow.com/questions/59177765/rewriting-function-haskell/59179888#59179888", "title": "Rewriting function haskell", "body": "<p>I guess something like this looks pretty decent:</p>\n\n<pre><code>import Data.Ord\nimport Safe\n\nmostCommonNeighbour pairsTally word = fst &lt;$&gt; maximumByMay (comparing snd)\n    [ (here, n)\n    | ((w1, w2), n) &lt;- pairsTally\n    , (here, there) &lt;- [(w1, w2), (w2, w1)]\n    , there == word\n    ]\n</code></pre>\n\n<p>The <code>Safe</code> module may be obtained from the <a href=\"https://hackage.haskell.org/package/safe\" rel=\"nofollow noreferrer\">safe</a> package; or you can copy <code>maximumByMay</code> into your codebase yourself (it is just two lines long).</p>\n"}], "owner": {"reputation": 9, "user_id": 12452860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBdIwUBr_nSkiHrJKcoLuE8I4KBxEtTyZuTqu6s=k-s128", "display_name": "RedLine", "link": "https://stackoverflow.com/users/12452860/redline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1575474725, "creation_date": 1575468044, "question_id": 59177765, "link": "https://stackoverflow.com/questions/59177765/rewriting-function-haskell", "title": "Rewriting function haskell", "body": "<pre><code>mostCommonNeighbour pairsTally word =\n  let matchedPairTally = neighboursTally word pairsTally\n  in if matchedPairTally == [] then Nothing -- Has no neighbour\n     else let commonNeighbour = (fst $ largestTally matchedPairTally)\n          in if (fst commonNeighbour) == word then Just (snd commonNeighbour)\n             else Just (fst commonNeighbour)\n  where\n    -- Filter out all Pairs from pairsTally that does not contain word\n    neighboursTally :: String -&gt; PairsTally -&gt; PairsTally\n    neighboursTally word pairsTally = filter ((inPair word).fst) pairsTally\n\n    -- Check if a word is contained in a pair\n    inPair :: String -&gt; (String, String) -&gt; Bool\n    inPair word pair\n      | word == (fst pair) || word == (snd pair) = True\n      | otherwise                                = False\n\n    -- Return the largest Tally in a PairsTally\n    largestTally :: PairsTally -&gt; ((String, String), Int)\n    largestTally pairsTally = foldr bigTally ((\"\", \"\"), 0) pairsTally\n      where\n        bigTally :: ((String, String), Int) -&gt; ((String, String), Int) -&gt; ((String, String), Int)\n        bigTally tally1 tally2\n          | snd tally1 &gt; snd tally2 = tally1\n          | otherwise               = tally2\n</code></pre>\n\n<p>Anyone know a good way to rewrite this function?, feel like it's a little long and am just checking if anyone knows how to make it shorter</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1575462069, "post_id": 59175728, "comment_id": 104573306, "body": "The type annotation only applies to the RHS of the definition, not the entire definition."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 12479659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b83c32f84f9ab7fce4bf1e9d0b9a3691?s=128&d=identicon&r=PG&f=1", "display_name": "Donvini", "link": "https://stackoverflow.com/users/12479659/donvini"}, "edited": false, "score": 1, "creation_date": 1575462523, "post_id": 59175947, "comment_id": 104573534, "body": "Ah, I was typing the x. That was what was confusing me.. I saw the :: typing at the end of the function and thought this is some way of shorthand to type the function. Thank you!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1575462025, "creation_date": 1575462025, "answer_id": 59175947, "question_id": 59175728, "link": "https://stackoverflow.com/questions/59175728/typing-with-anonymous-vs-non-anonymous-functions-in-haskell/59175947#59175947", "title": "Typing with anonymous vs. non anonymous functions in haskell", "body": "<p>You apply the type signature <code>:: a -&gt; a</code> to <code>x</code>, <em>not</em> to <code>f</code>. You can add a type signature with:</p>\n\n<pre><code><b>f :: a -&gt; a</b>; f x = x</code></pre>\n\n<p>However, you can not specify that <code>x</code> is of type <code>:: a</code> anyway, since that <code>a</code> is a different type variable than the <code>a</code> in the outer type signature. You can enable the <a href=\"https://downloads.haskell.org/~ghc/7.0-latest/docs/html/users_guide/other-type-extensions.html#scoped-type-variables\" rel=\"noreferrer\"><strong><code>ScopedTypeVariables</code></strong> [ghc-doc]</a> extension, to use type variables defined in an outer scope, like:</p>\n\n<pre><code>{-# LANGUAGE <b>ScopedTypeVariables</b> #-}\n\nf :: <b>forall a</b> . a -> a\nf x = x <b>:: a</b></code></pre>\n"}], "owner": {"reputation": 63, "user_id": 12479659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b83c32f84f9ab7fce4bf1e9d0b9a3691?s=128&d=identicon&r=PG&f=1", "display_name": "Donvini", "link": "https://stackoverflow.com/users/12479659/donvini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 59175947, "answer_count": 1, "score": 6, "last_activity_date": 1575462025, "creation_date": 1575461343, "question_id": 59175728, "link": "https://stackoverflow.com/questions/59175728/typing-with-anonymous-vs-non-anonymous-functions-in-haskell", "title": "Typing with anonymous vs. non anonymous functions in haskell", "body": "<p>Why does this identity compile when I type it</p>\n\n<pre><code>f = (\\x -&gt; x) :: a -&gt; a\n</code></pre>\n\n<p>but this one does not?</p>\n\n<pre><code>f x = x :: a -&gt; a\n</code></pre>\n\n<p>When I just write </p>\n\n<pre><code>f x = x\n</code></pre>\n\n<p>And load it into ghci and type :t f I receive</p>\n\n<pre><code>f :: p -&gt; p\n</code></pre>\n\n<p>So, shouldn't it be the same thing? </p>\n\n<p>The error I receive is </p>\n\n<blockquote>\n  <p>Couldn't match expected type \u2018a1 -> a1\u2019 with actual type \u2018p\u2019\n          because type variable \u2018a1\u2019 would escape its scope\n        This (rigid, skolem) type variable is bound by\n          an expression type signature:\n            forall a1. a1 -> a1</p>\n</blockquote>\n\n<p>I already googled about the rigid, skolem thing and the error but it only gave me more questions.</p>\n\n<p>Originally I wanted to write a function that takes two inputs and returns the first one, which only worked with the anonymous function. So I seem to lack some understanding when it comes to lambdas and typing. I am still at the beginning of learning Haskell.</p>\n\n<pre><code>f = (\\x y -&gt; x) :: a -&gt; b -&gt; a\n</code></pre>\n"}, {"tags": ["haskell", "overloaded-lists"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1575454285, "post_id": 59173478, "comment_id": 104569127, "body": "It should be <code>Case :: IsList (list Foo) =&gt; String -&gt; list Foo -&gt; Foo -&gt; Case list</code>, since <code>IsList</code> takes a type with kind <code>*</code>, not <code>* -&gt; *</code>.."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1575454606, "post_id": 59173478, "comment_id": 104569325, "body": "But this will not fix the underlying problem, since the items of such overloaded lists are of type <code>Item</code>, and that is, although very common, not per se <code>Foo</code>."}], "answers": [{"comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1575455773, "post_id": 59173762, "comment_id": 104569982, "body": "Ah, so this uncovered two misconceptions, one of which I was not aware. Thanks a bunch!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1575454985, "creation_date": 1575454985, "answer_id": 59173762, "question_id": 59173478, "link": "https://stackoverflow.com/questions/59173478/top-level-overloadedlists-literal/59173762#59173762", "title": "Top-level OverloadedLists literal", "body": "<p>The reason this does not work is because the <code>Item</code> type of a <code>List (l Foo) =&gt; l</code> is not <em>per se</em> <code>Foo</code>. The extension makes abstraction of that, and thus it expects the elements of your list literal to be of type <code>Item (l Foo)</code>.</p>\n\n<p>You can however add a type constraint that says that the items are indeed of type <code>Foo</code>:</p>\n\n<pre><code>{-# LANGUAGE OverloadedLists #-}\n\ndata Case list = Case\n  { description :: String\n  , input :: list Foo\n  , expected :: Foo\n  }\n\ncases :: (IsList (l Foo), <b>Item (l Foo) ~ Foo</b>) =&gt; [Case l]\ncases = [\n    Case { description = \"blah blah\"\n         , input = [Foo 1, Foo 2, Foo 3]\n         , expected = Foo 1\n         }\n  ]</code></pre>\n\n<p>Here we thus say that the <code>Item (l Foo)</code> should be the same as <code>Foo</code>.</p>\n"}], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 59173762, "answer_count": 1, "score": 7, "last_activity_date": 1575455269, "creation_date": 1575454061, "last_edit_date": 1575455269, "question_id": 59173478, "link": "https://stackoverflow.com/questions/59173478/top-level-overloadedlists-literal", "title": "Top-level OverloadedLists literal", "body": "<p>I've got a test suite for a refactoring exercise where I'd like it to be compatible with both <code>Data.List</code> and <code>Data.List.NonEmpty</code>. The exercise consists of a function <code>foo :: [Foo] -&gt; Foo</code> and the test suite has some</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Case = Case\n  { description :: String\n  , input :: [Foo]\n  , expected :: Foo\n  }\n\ncases :: [Case]\ncases =\n  [ Case { description = \"blah blah\"\n         , input = [Foo 1, Foo 2, Foo 3]\n         , expected = Foo 1\n         }\n  , ...\n  ]\n</code></pre>\n\n<p>To make the test suite polymorphic with <code>OverloadedLists</code>, I tried</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE OverloadedLists #-}\n...\n\ndata Case list = Case\n  { description :: String\n  , input :: list Foo\n  , expected :: Foo\n  }\n\ncases =\n  [ Case { description = \"blah blah\"\n         , input = [Foo 1, Foo 2, Foo 3]\n         , expected = Foo 1\n         }\n  , ...\n  ]\n</code></pre>\n\n<p>but this gives me the error</p>\n\n<pre><code>    \u2022 Couldn't match expected type \u2018GHC.Exts.Item (list0 Foo)\u2019\n                  with actual type \u2018Foo\u2019\n      The type variable \u2018list0\u2019 is ambiguous\n      ...\n   |\n50 |          , input = [Foo 1, Foo 2, Foo 3]\n   |                     ^^^^^\n</code></pre>\n\n<p>I thought to move the <code>IsList list</code> constraint to the <code>Case</code> data type, like so</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE OverloadedLists #-}\n...\n\ndata Case list where\n  Case :: IsList list =&gt; String -&gt; list Foo -&gt; Foo -&gt; Case list\n\ncases =\n  [ Case \"blah blah\" [Foo 1, Foo 2, Foo 3] (Foo 1), ... ]\n</code></pre>\n\n<p>but this gives me the error</p>\n\n<pre><code>    \u2022 Expected kind \u2018* -&gt; *\u2019, but \u2018list\u2019 has kind \u2018*\u2019\n    \u2022 In the type \u2018list Foo\u2019\n      In the definition of data constructor \u2018Case\u2019\n      In the data declaration for \u2018Case\u2019\n   |        \n24 |   Case :: IsList list =&gt; String -&gt; list Foo -&gt; Foo -&gt; Case list\n   |                                    ^^^^^^^^\n</code></pre>\n\n<p>I'm not sure what the simplest approach here is. Any hints?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1575450333, "post_id": 59170347, "comment_id": 104566892, "body": "To annotate you add a line: <code>isPrime :: Int -&gt; Bool</code>."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1575452575, "post_id": 59170347, "comment_id": 104568099, "body": "There are purely integer algorithms to find the floor of the square root of an integer. See <a href=\"https://en.wikipedia.org/wiki/Integer_square_root\" rel=\"nofollow noreferrer\">here</a> for example. So you can avoid dealing with floating point numbers entirely."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 12288245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ecb8cdd93cdf2e490d096c0ee98887?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/12288245/peter"}, "edited": false, "score": 0, "creation_date": 1575447471, "post_id": 59171488, "comment_id": 104565493, "body": "Yeah I don&#39;t know why I was doing the take primes. I was mixing my primes function with the function from <a href=\"https://en.wikipedia.org/wiki/Primality_test#Pseudocode\" rel=\"nofollow noreferrer\">the 6k + 1 test</a>. That was just an oopsie doopsie.  I edited the code to use <code>sqrt n</code> and I edited the code to use <code>round (sqrt n)</code> and both still result in the error for <code>Floating Int</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 35, "user_id": 12288245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ecb8cdd93cdf2e490d096c0ee98887?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/12288245/peter"}, "edited": false, "score": 0, "creation_date": 1575447899, "post_id": 59171488, "comment_id": 104565687, "body": "You cannot take a square root of an integer. Have you looked at fromIntegral?"}, {"owner": {"reputation": 35, "user_id": 12288245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ecb8cdd93cdf2e490d096c0ee98887?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/12288245/peter"}, "edited": false, "score": 0, "creation_date": 1575448180, "post_id": 59171488, "comment_id": 104565846, "body": "I just edited to be <code>round (sqrt (fromIntegral n))</code> thanks to you and Yuri and it worked perfectly. Thank you so much"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1575446923, "creation_date": 1575446923, "answer_id": 59171488, "question_id": 59170347, "link": "https://stackoverflow.com/questions/59170347/ambiguous-type-variable-error-related-to-n-0-5/59171488#59171488", "title": "Ambiguous type variable error related to n ** 0.5", "body": "<p>Let's look at the types of tge involved operators.</p>\n\n<pre><code>(**) :: Floating a =&gt; a -&gt; a -&gt; a\nmod :: Integral a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>You apply both operators to the same variable <code>n</code>. There is no type that satisfies both constraints however, and even if there where, Haskell wouldn't know how to choose one.</p>\n\n<p>There are a couple of ways to solve this. One is to say <code>fromIntegral n ** 0.5</code> (or, perhaps better, use <code>sqrt</code>). Another one can be found <a href=\"https://stackoverflow.com/questions/19965149/integer-square-root-function-in-haskell\">here</a>.</p>\n\n<p>Last but not least you may want to notice that taking \u221an elements from a list of primes doesn't quite make sense. You want primes that are less than \u221an. Look at the <code>takeWhile</code> function.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 12288245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ecb8cdd93cdf2e490d096c0ee98887?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/12288245/peter"}, "edited": false, "score": 0, "creation_date": 1575448218, "post_id": 59171574, "comment_id": 104565868, "body": "I just edited to be <code>round (sqrt (fromIntegral n))</code> thanks to you and n. &#39;pronouns&#39; m.and it worked perfectly. Thank you so much"}], "tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1575447278, "creation_date": 1575447278, "answer_id": 59171574, "question_id": 59170347, "link": "https://stackoverflow.com/questions/59170347/ambiguous-type-variable-error-related-to-n-0-5/59171574#59171574", "title": "Ambiguous type variable error related to n ** 0.5", "body": "<p>The problem is, <code>n ** 0.5</code> (or simply written as <code>sqrt n</code>) requires <code>n</code> to be <code>Floating</code>:</p>\n\n<pre><code>(**) :: Floating a =&gt; a -&gt; a -&gt; a\nsqrt :: Floating a =&gt; a -&gt; a\n</code></pre>\n\n<p>But <code>mod</code> requires <code>n</code> to be <code>Integral</code>:</p>\n\n<pre><code>mod :: Integral a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Haskell is a language, where there is no implicit type conversions, so you can't just pass an <code>Int</code> to <code>sqrt</code>. You can try it in GHCi:</p>\n\n<pre><code>x = 4 :: Int\nsqrt x -- error\n</code></pre>\n\n<p>To solve that conflict you can use such a function <code>fromIntegral :: (Integral a, Num b) =&gt; a -&gt; b</code> that allows you to convert any <code>Integral</code> type to any <code>Num</code> type, and all <code>Floating</code> types are <code>Num</code>, so you will be able to use <code>n</code> in <code>sqrt</code>:</p>\n\n<pre><code>isPrime n = length [x | x &lt;- take (round (sqrt (fromIntegral n))) primes, n `mod` x == 0] == 0\n</code></pre>\n\n<p>Also, we can simplify it a bit with <code>$</code> application operator to omit some <code>()</code> and <code>null</code> function to check whether the list is empty:</p>\n\n<pre><code>isPrime n = null [x | x &lt;- take (round $ sqrt $ fromIntegral n) primes, n `mod` x == 0]\n</code></pre>\n\n<p>Try it there: <a href=\"https://repl.it/@Yuri12358/so-primes\" rel=\"nofollow noreferrer\">https://repl.it/@Yuri12358/so-primes</a></p>\n"}], "owner": {"reputation": 35, "user_id": 12288245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ecb8cdd93cdf2e490d096c0ee98887?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/12288245/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 59171574, "answer_count": 2, "score": 1, "last_activity_date": 1575448874, "creation_date": 1575442003, "last_edit_date": 1575448874, "question_id": 59170347, "link": "https://stackoverflow.com/questions/59170347/ambiguous-type-variable-error-related-to-n-0-5", "title": "Ambiguous type variable error related to n ** 0.5", "body": "<p>FINAL EDIT:</p>\n\n<p>My final function is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>isPrime n = n &gt; 1 &amp;&amp; n &lt; 4\n    || n `mod` 2 /= 0\n    &amp;&amp; n `mod` 3 /= 0\n    &amp;&amp; length [x | x &lt;- [5, 11..round (sqrt (fromIntegral n))], n `mod` x == 0 || n `mod` (x + 2) == 0] == 0\n</code></pre>\n\n<p>The issue was that I was trying to treat <code>n</code> as both a <code>Floating</code> in <code>sqrt n</code>, and as an <code>Integral</code> in <code>n mod x</code>. So I had to do <code>fromIntegral n</code> to force n to be treated as an <code>Integral</code> and not as a <code>Floating</code>.</p>\n\n<p>Also I just screwed up some of my code.</p>\n\n<hr>\n\n<p>So I have two functions:</p>\n\n<pre><code>primes = filterPrime [2..]\n    where filterPrime (p:xs) = p : filterPrime [x | x &lt;- xs, x `mod` p /= 0]\n</code></pre>\n\n<p>above is straight off of haskell.org, an example being <code>take 5 primes</code> results in <code>[2,3,5,7,11]</code></p>\n\n<p>My function <code>isPrime</code> is the following:</p>\n\n<pre><code>isPrime n = isPrime n = n &gt; 1 &amp;&amp; n &lt; 4\n    || (n `mod` 2 == 0 || n `mod` 3 == 0)\n    &amp;&amp; length [x | x &lt;- [5, 11..round (n ** 0.5)], n `mod` x == 0 || n `mod` (x + 2) == 0] == 0\n</code></pre>\n\n<p>However, when I call <code>isPrime</code> I get the error:</p>\n\n<pre><code>EulerMath.hs:6:33: error:\n    * No instance for (RealFrac Int) arising from a use of `round'\n    * In the expression: round (n ** 0.5)\n      In the expression: [5, 11 .. round (n ** 0.5)]\n      In a stmt of a list comprehension: x &lt;- [5, 11 .. round (n ** 0.5)]\n  |\n6 |     &amp;&amp; length [x | x &lt;- [5, 11..round (n ** 0.5)], n `mod` x == 0 || n `mod` (x + 2) == 0] == 0\n  |                                 ^^^^^^^^^^^^^^^^\n\nEulerMath.hs:6:40: error:\n    * No instance for (Floating Int) arising from a use of `**'\n    * In the first argument of `round', namely `(n ** 0.5)'\n      In the expression: round (n ** 0.5)\n      In the expression: [5, 11 .. round (n ** 0.5)]\n  |\n6 |     &amp;&amp; length [x | x &lt;- [5, 11..round (n ** 0.5)], n `mod` x == 0 || n `mod` (x + 2) == 0] == 0\n  |                                        ^^^^^^^^\n\nEulerMath.hs:6:45: error:\n    * No instance for (Fractional Int) arising from the literal `0.5'\n    * In the second argument of `(**)', namely `0.5'\n      In the first argument of `round', namely `(n ** 0.5)'\n      In the expression: round (n ** 0.5)\n  |\n6 |     &amp;&amp; length [x | x &lt;- [5, 11..round (n ** 0.5)], n `mod` x == 0 || n `mod` (x + 2) == 0] == 0\n  |                                             ^^^\n</code></pre>\n\n<p>I don't know how to annotate the <code>isPrime</code> function correctly (read: I don't know how to annotate properly at all) so I don't get this error</p>\n"}, {"tags": ["haskell", "streaming", "heap", "haskell-streaming"], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 3, "last_activity_date": 1575483966, "last_edit_date": 1575483966, "creation_date": 1575444074, "answer_id": 59170810, "question_id": 59170314, "link": "https://stackoverflow.com/questions/59170314/generalize-the-merge-function-of-the-haskell-streaming-library/59170810#59170810", "title": "Generalize the merge function of the Haskell &quot;Streaming&quot; library", "body": "<p>The signature of <code>bigMerge</code> looks <em>awfully</em> like the signature of <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Traversable.html#v:sequenceA\" rel=\"nofollow noreferrer\"><code>sequenceA</code></a> from <code>Data.Traversable</code>:</p>\n\n<pre><code>sequenceA :: Applicative f =&gt; [f r] -&gt; f [r]\n</code></pre>\n\n<p>The problem of course is that we can't use the standard <code>Applicative</code> instance for <code>Stream</code>s, because it concatenates instead of merging. But we can try to create our own instance over a newtype:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\nimport Streaming\nimport qualified Streaming.Prelude as S\n\nnewtype MergeStream a m r = \n    MergeStream { getMergeStream :: Stream (Of a) m r } deriving Functor\n\n-- BEWARE! Only valid for ORDERED streams!\ninstance (Monad m, Ord a) =&gt; Applicative (MergeStream a m) where\n    pure x = MergeStream (pure x)\n    MergeStream f &lt;*&gt; MergeStream x = MergeStream (uncurry ($) &lt;$&gt; S.merge f x) \n</code></pre>\n\n<p>Now, using <code>s1</code>, <code>s2</code> and <code>s3</code> from your example, and standard <code>Traversable</code> functions:</p>\n\n<pre><code>ghci&gt; S.toList_ $ getMergeStream . traverse MergeStream $ [s1,s2,s3]\n[1,2,2,3,4,4,5,5]\n</code></pre>\n\n<p>This seems to work. That said, your attempt of implementing <code>bigMerge</code> using the <code>Stream</code> internals and a heap might still be worth it, for efficiency reasons.</p>\n"}], "owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1575483966, "creation_date": 1575441881, "question_id": 59170314, "link": "https://stackoverflow.com/questions/59170314/generalize-the-merge-function-of-the-haskell-streaming-library", "title": "Generalize the merge function of the Haskell &quot;Streaming&quot; library", "body": "<p>The goal is to generalize the <a href=\"https://hackage.haskell.org/package/streaming-0.2.3.0/docs/Streaming-Prelude.html#v:merge\" rel=\"nofollow noreferrer\"><code>Streaming.merge</code></a> function,</p>\n\n<pre><code>merge :: (Monad m, Ord a) =&gt; Stream (Of a) m r -&gt; Stream (Of a) m s -&gt; Stream (Of a) m (r, s) \n</code></pre>\n\n<p>to an arbitrary number of source streams. The strategy is to use a <a href=\"https://hackage.haskell.org/package/heaps-0.3.6.1/docs/Data-Heap.html#t:Heap\" rel=\"nofollow noreferrer\"><code>Data.Heap.Heap</code></a> of <code>Stream (Of a) m r</code> that is sorted by <code>a</code>. I.e. <code>bigMerge</code> would have the signature</p>\n\n<pre><code>bigMerge :: (Monad m, Ord a) =&gt; [Stream (Of a) m r] -&gt; Stream (Of a) m [r]\n</code></pre>\n\n<p>(The list could just as well be replaced by <code>Heap</code>.)</p>\n\n<p>What I have is a rather evil concoction that isn't quite correct. Here it goes:</p>\n\n<p>For completenes, first off the imports:</p>\n\n<pre><code>import qualified Data.Heap as H\nimport Data.Heap (Heap)\nimport Data.List (sortBy)\nimport Data.Function (on)\nimport Streaming\nimport qualified Streaming.Prelude as S\nimport Streaming.Internal (Stream(..))  -- shouldn't!\n</code></pre>\n\n<p>In order to use <code>Heap</code> an element of class <code>Ord</code> is needed:</p>\n\n<pre><code>data Elt a m r = Elt Int (Maybe a) (Stream(Of a) m r)\n</code></pre>\n\n<p>The extra <code>Int</code> is introduced to carry along the index of the stream in the input list so that the returned <code>[r]</code> can be built with elements in the right order. The <code>Maybe a</code> carries the current value of the stream.</p>\n\n<p><code>Eq</code> and <code>Ord</code> instances are:</p>\n\n<pre><code>instance Eq a =&gt; Eq (Elt a m r) where\n(Elt i ma _) == (Elt i' ma' _) = \n    if i == i' then error \"Internal error: Index clash in ==\" \n    else ma == ma'\n\ninstance Ord a =&gt; Ord (Elt a m r) where\n(Elt i ma s) &lt;= (Elt i' ma' s') | i==i' = error \"Internal error: Index clash in &lt;=\"\n                                | otherwise = cmp (i, ma, s) (i', ma', s')\n    where \n    cmp _                      (_, Nothing, Return _) = True\n    cmp (_, Nothing, Return _) _                      = False\n    cmp (i, Just a, _)         (i', Just a', _)       = if a == a' then i &lt;= i' else a &lt;= a'\n    cmp (i, _, _)              (i', _, _)             = i &lt;= i'\n</code></pre>\n\n<p>Basically, anything is <code>&lt;=</code> a <code>Return</code>, and all other cases use the <code>a</code> and/or the <code>i</code> to sort <code>Elt</code>s. (The <code>errors</code> are for debugging purposes.) </p>\n\n<p>Some helper function make <code>Elt</code> from <code>Stream</code> and <code>Heap</code> from lists of <code>Stream</code>.</p>\n\n<pre><code>eltFromStream :: (Monad m, Ord a) =&gt; Int -&gt; Stream (Of a) m r -&gt; m (Elt a m r)\neltFromStream i (Return r) = return $ Elt i Nothing (Return r)\neltFromStream i (Effect m) = do\n    stream' &lt;- m\n    return $ Elt i Nothing stream'\neltFromStream i (Step (a :&gt; rest)) = return $ Elt i (Just a) rest\n\nheapFromStreams :: (Monad m, Ord a) =&gt; [Stream (Of a) m r] -&gt; m (Heap (Elt a m r))\nheapFromStreams strs = H.fromList &lt;$&gt; (sequence $ fmap (uncurry eltFromStream) (zip [0..] strs))\n</code></pre>\n\n<p>The core piece is the <code>loop</code> function</p>\n\n<pre><code>loop :: (Monad m, Ord a) =&gt; Heap (Elt a m r) -&gt; m (Heap (Elt a m r))\nloop h = do\nlet (Elt i ma s, h') = unsafeUncons h\nelt &lt;- case s of\n    Return r         -&gt; return $ Elt i Nothing (Return r)\n    Effect m         -&gt; Elt i Nothing &lt;$&gt; m\n    Step (a :&gt; rest) -&gt; return $ Elt i (Just a) rest\nreturn $ H.insert elt h'\n</code></pre>\n\n<p>with the cheeky <code>unsafeUncons</code> being</p>\n\n<pre><code>unsafeUncons :: Heap a -&gt; (a, Heap a)\nunsafeUncons h = case H.uncons h of\nNothing -&gt; error \"Internal error\"\nJust x -&gt; x\n</code></pre>\n\n<p>The <code>loop</code> function is used in <code>heapMerge</code> that turns the <code>Heap</code> into a <code>Stream</code></p>\n\n<pre><code>heapMerge :: (Monad m, Ord a) =&gt; Heap (Elt a m r) -&gt; Stream (Of a) m [r]\nheapMerge h = case (ma,s) of\n    (Nothing, Return _) -&gt; Return $ getRs h\n    (_, Effect m) -&gt; error \"TODO\"\n    (Just a, _)  -&gt; do\n        h' &lt;- lift $ loop h\n        Step (a :&gt; heapMerge h')\n    where\n        Elt i ma s = H.minimum h\n</code></pre>\n\n<p><code>getRs</code> just assembles the <code>Return</code> values into a list</p>\n\n<pre><code>getRs :: (Monad m, Ord a) =&gt; Heap (Elt a m r) -&gt; [r]\ngetRs h = snd &lt;$&gt; sortBy (compare `on` fst) (map f (H.toUnsortedList h))\nwhere\n    f :: Monad m =&gt; Elt a m r -&gt; (Int, r)\n    f (Elt i _ (Return r)) = (i,r)\n    f _ = error \"Internal error: Call getR only after stream has finished!\"\n</code></pre>\n\n<p>Then, finally, </p>\n\n<pre><code>bigMerge :: (Monad m, Ord a) =&gt; [Stream (Of a) m r] -&gt; Stream (Of a) m [r]\nbigMerge streams = \nif null streams then Return [] \nelse do\n    h &lt;- lift $ heapFromStreams streams\n    heapMerge h\n</code></pre>\n\n<p>This is convoluted, <code>Effect</code> is not treated correctly, it relies on <code>Return</code>, <code>Step</code>, <code>Effect</code> instead of <code>inspect</code> and <code>next</code>. It does produce the right result on simple inputs, e.g.</p>\n\n<pre><code>s1 = S.each [2,4,5::Int]\ns2 = S.each [1,2,4,5::Int]\ns3 = S.each [3::Int]\nS.print $ merge [s1,s2,s3]\n</code></pre>\n\n<p>I'm sure there's a way to do this correctly and more idiomatically. For one thing, the <code>Maybe a</code> in the <code>Elt</code> is probably redundant, I can make <code>(Stream (Of a) m r)</code> an instance of <code>Ord</code> directly, and if <code>Effect</code>s are just pattern-matched, not executed, then this should be ok. But <code>Stream (Of (Heap (Stream (Of a) m r, Int))) (Heap (Int,r))</code> looks weird. A \"stream with index\" <code>IStream a m r = IStream Int ((Heap (Stream (Of a) m r) deriving Functor</code> is a functor in <code>r</code>, so, with appropriate <code>==</code> and <code>&lt;=</code>, I'd be looking at <code>Stream (IStream a m) m (Heap (Int, r))</code>?</p>\n\n<p>This functorial aspect of the <code>streaming</code> library is still a bit of a puzzle to me, so any help would be appreciated.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575421052, "post_id": 59167319, "comment_id": 104558436, "body": "Be aware that <code>comparing :: Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering</code> is already the name of a function in <code>Data.Ord</code>."}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1575450857, "post_id": 59167319, "comment_id": 104567164, "body": "Why is there a <code>&#39;g&#39;</code> in the result, shouldn&#39;t it be a <code>&#39;-&#39;</code>, that is <code>&quot;-----m---i--&quot;</code> instead of <code>&quot;-----m---i-g&quot;</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 3, "last_activity_date": 1575432006, "last_edit_date": 1575432006, "creation_date": 1575421350, "answer_id": 59167544, "question_id": 59167319, "link": "https://stackoverflow.com/questions/59167319/comparing-each-element-of-a-list-to-each-element-of-another-list/59167544#59167544", "title": "Comparing each element of a list to each element of another list", "body": "<p><strong>First,</strong> at each recursive call, while you're iterating over the string <code>a</code>, you are for some reason also iterating over the string <code>b</code> at the same time. Look: you're passing only <code>tail b</code> to the next call. This means that the next call won't be able to look through the <em>whole</em> string <code>b</code>, but only through its tail. Why are you doing this?</p>\n\n<p><strong>Second,</strong> in order to see if a character is present in a string, use <code>elem</code>: </p>\n\n<pre><code>elem 'x' \"xyz\" == True\nelem 'x' \"abc\" == False\n</code></pre>\n\n<p>So the second line of your function should look like this:</p>\n\n<pre><code>    else if elem (head a) b then \"-\" ++ (comparing (tail a) b)\n</code></pre>\n\n<hr>\n\n<p>On a somewhat related note, use of <code>head</code> and <code>tail</code> functions is somewhat frowned upon, because they're partial: they will crash if the string is empty. Yes, I see that you have checked to make sure that the string is <em>not</em> empty, but the compiler doesn't understand that, which means that it won't be able to catch you when you accidentally change this check in the future.</p>\n\n<p>A better way to inspect data is via pattern matching:</p>\n\n<pre><code>-- Comparing an empty string with anything results in an empty string\ncomparing \"\" _ = \"\" \n-- Comparing a string that starts with `a` and ends with `rest`\ncomparing (a:rest) b = \n    (if elem a b then \"-\" else a) ++ comparing rest b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 1, "last_activity_date": 1575445492, "creation_date": 1575445492, "answer_id": 59171163, "question_id": 59167319, "link": "https://stackoverflow.com/questions/59167319/comparing-each-element-of-a-list-to-each-element-of-another-list/59171163#59171163", "title": "Comparing each element of a list to each element of another list", "body": "<p>Rather than writing the recursive logic manually, this looks like a classic use case for <code>map</code>. You just need a function that takes a character and returns either that character or <code>'-'</code> depending on its presence in the other list.</p>\n\n<p>Written out fully, this would look like:</p>\n\n<pre><code>comparing first second = map replace first\n  where replace c = if c `elem` second then '-' else c\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12458908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7fdd5c8aa307c0177b2a0f1aaf6973?s=128&d=identicon&r=PG&f=1", "display_name": "sad_banana_peel", "link": "https://stackoverflow.com/users/12458908/sad-banana-peel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 59167544, "answer_count": 2, "score": 2, "last_activity_date": 1575450909, "creation_date": 1575419158, "last_edit_date": 1575450909, "question_id": 59167319, "link": "https://stackoverflow.com/questions/59167319/comparing-each-element-of-a-list-to-each-element-of-another-list", "title": "Comparing each element of a list to each element of another list", "body": "<p>I'm trying to write a function that takes the first character of the first string, compares it to all the characters of the second string and if it finds the same character, replaces with a \"-\". Then it moves on to the second character of the first string, does the same comparison with each character (except the first character - the one we already checked) on the second string and so on. I want it to return the first string, but with the repeating characters swapped with the symbol \"-\". </p>\n\n<p>E.g. if I put in <code>comparing \"good morning\" \"good afternoon\"</code>, I'd like it to return <code>\"-----m---i-g\"</code></p>\n\n<p>I hope I explained it clearly enough. So far I've got:</p>\n\n<pre><code>comparing :: String -&gt; String -&gt; String\ncomparing a b =\n    if a == \"\" then \"\"\n    else if head a == head b then \"-\" ++ (comparing (tail a) (tail b))\n    else [head a] ++ (comparing (tail a) b)\n</code></pre>\n\n<p>The problem with this is it does not go through the second string character by character and I'm not sure how to implement that. I think I would need to call a recursive function on the 4th line:</p>\n\n<pre><code>if head a == ***the first character of tail b*** then \"-\" ++ (comparing (tail a) (tail b))\n</code></pre>\n\n<p>What could that function look like? Or is there a better way to do this?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1575445767, "post_id": 59166919, "comment_id": 104564786, "body": "Are you sure you&#39;re typing exactly what you intend? As you say,  those errors make no sense given your intended input - but the variable names it&#39;s complaining about are made up of characters from the intended input, in order. So it&#39;s almost like your keyboard is broken and missing some characters don&#39;t display? (But then I don&#39;t know how you typed your post, including the sample GHCi session...)"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1575469227, "post_id": 59166919, "comment_id": 104577458, "body": "There is no way you would get these errors from this command. If you had something not in scope in your program, it would say it when it loads your program, not when you type the command."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11133715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/758e60529b128a7efbf5d7ed7a150269?s=128&d=identicon&r=PG&f=1", "display_name": "jackattack8251", "link": "https://stackoverflow.com/users/11133715/jackattack8251"}, "edited": false, "score": 0, "creation_date": 1575416699, "post_id": 59167005, "comment_id": 104557559, "body": "I realized I misunderstood the tail function and swapped it for the last function. My code compiles now, but it is giving me bizarre errors now when running the function."}], "tags": [], "owner": {"reputation": 46, "user_id": 11634123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/219fd61122db014c1a61a58ee5f2e10f?s=128&d=identicon&r=PG&f=1", "display_name": "brandonhewer", "link": "https://stackoverflow.com/users/11634123/brandonhewer"}, "is_accepted": false, "score": 0, "last_activity_date": 1575417328, "last_edit_date": 1575417328, "creation_date": 1575416455, "answer_id": 59167005, "question_id": 59166919, "link": "https://stackoverflow.com/questions/59166919/haskell-recursive-adding-function-not-working/59167005#59167005", "title": "Haskell Recursive Adding Function Not Working", "body": "<p>The tail of a list denotes everything after the first element in the list. \nFor example, the tail of [1, 2, 3, 4] would simply be [2, 3, 4]. The error you have received is sensibly informing you that you cannot add a float to a list of floats.</p>\n\n<p>The implementation of the tail function is made clear by considering the inductive definition of the list data-type, i.e. a list is either empty or is constructed with an element and a list.</p>\n\n<p>One way you might have spotted this issue earlier is to observe the type of tail, which is as follows:</p>\n\n<pre><code>tail :: [a] -&gt; [a]\n</code></pre>\n\n<p>The correct way to obtain the last element of a list is with the last function, with the following type signature:</p>\n\n<pre><code>last :: [a] -&gt; a\n</code></pre>\n\n<p>I also recommend using the <code>all :: (a -&gt; Bool) -&gt; [a] -&gt; Bool</code> function for checking whether a condition holds for an entire list. For example, given a list of floats <code>xs</code>, you can use:</p>\n\n<pre><code>all (&lt;= 20) xs\n</code></pre>\n\n<p>Alternatively, there is also <code>any :: (a -&gt; Bool) -&gt; [a] -&gt; Bool</code>. Additionally, the idiomatic way to recurse over a list is to pattern match on the head and the tail, for example:</p>\n\n<pre><code>checkIfExpensive :: [Float] -&gt; String\ncheckIfExpensive [] = \"You have enough money\"\ncheckIfExpensive (x:xs)\n  | x &gt; 20 = \"You don't have enough money\"\n  | otherwise = checkIfExpensive xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1575461622, "creation_date": 1575461622, "answer_id": 59175810, "question_id": 59166919, "link": "https://stackoverflow.com/questions/59166919/haskell-recursive-adding-function-not-working/59175810#59175810", "title": "Haskell Recursive Adding Function Not Working", "body": "<p>First: <code>String</code> is far too \"large\" a type for your return value. There are only two (out of an infinite number) possible return values. Use <code>Bool</code> instead. (You can always write a separate function to select a message to display.)</p>\n\n<pre><code>checkIfExpensive :: [Float] -&gt; Bool\n</code></pre>\n\n<p>Second, there is already a pre-defined function to determine if <em>any</em> element of the list satisfies your condition: the <code>any</code> function.</p>\n\n<pre><code>any :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool\n</code></pre>\n\n<p>Lists are foldable, so all you need to write is</p>\n\n<pre><code>checkIfExpensive list = any (\\x -&gt; x &gt; 20) list\n</code></pre>\n\n<p>If you want to return a <code>String</code> anyway, the <code>if</code> expression can test the return value of <code>any</code>.</p>\n\n<pre><code>checkIfExpensive :: [Float] -&gt; String\ncheckIfExpensive list = if any (\\x -&gt; x &gt; 20) list \n                        then \"You don't have enough money\"\n                        else \"You don't have enough money\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11133715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/758e60529b128a7efbf5d7ed7a150269?s=128&d=identicon&r=PG&f=1", "display_name": "jackattack8251", "link": "https://stackoverflow.com/users/11133715/jackattack8251"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1575461622, "creation_date": 1575415872, "last_edit_date": 1575416901, "question_id": 59166919, "link": "https://stackoverflow.com/questions/59166919/haskell-recursive-adding-function-not-working", "title": "Haskell Recursive Adding Function Not Working", "body": "<p>I attempted to write a Haskell function to recursively determine if a list is under a arbitrary value. For some reason, the code is not compiling. My error is below.</p>\n\n<pre><code>--declare function\ncheckIfExpensive :: [Float] -&gt; Float -&gt; String\n\n--base case\ncheckIfExpensive [] x = \"You have enough money\"\ncheckIfExpensive list x = if x &gt; 20\n--recursive case\n                                then \"You don't have enough money\"\n                                else checkIfExpensive (init list) (last list + x)\n</code></pre>\n\n<p>EDIT: got code to compile by switching where I had 'tail' to 'last'. But, now I seem to get a different error everytime I run my code.</p>\n\n<p>Here is what some of the errors look like</p>\n\n<pre><code>*Main&gt; checkIfExpensive [5,5,5] 0\n\n&lt;interactive&gt;:1:1: error: Data constructor not in scope: Ixve5\n*Main&gt; checkIfExpensive [1,1,1] 0\n\n&lt;interactive&gt;:1:1: error: Variable not in scope: cpe\nPrelude&gt;\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1575490763, "post_id": 59164992, "comment_id": 104588608, "body": "<code>base &lt;4.12</code> says that it&#39;s looking for a version of base that is <i>older than</i> 4.12. You have 4.12, which is too new: the version of split you have has apparently not been tested against that version of base, or has been tested and found to be incompatible. The <a href=\"http://hackage.haskell.org/package/split\" rel=\"nofollow noreferrer\">current version of split</a> wants <code>base &lt;4.14</code>, which it looks like you have. So I&#39;d say you&#39;re trying to install a too-old version of split."}], "answers": [{"comments": [{"owner": {"reputation": 2299, "user_id": 1596308, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JxwHy.png?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/1596308/adam"}, "edited": false, "score": 0, "creation_date": 1575447289, "post_id": 59166462, "comment_id": 104565423, "body": "Not at home right now, but I think &#39;Using libraries&#39; section of the following article might be what I need, I have hope: <a href=\"https://wiki.haskell.org/Learn_Haskell_in_10_minutes\" rel=\"nofollow noreferrer\">wiki.haskell.org/Learn_Haskell_in_10_minutes</a>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 2299, "user_id": 1596308, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JxwHy.png?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/1596308/adam"}, "edited": false, "score": 0, "creation_date": 1575451862, "post_id": 59166462, "comment_id": 104567680, "body": "Those instructions look more error-prone than just installing stack and using an ordinary stack project. Have you considered upgrading to a more-than-one-file setup?"}, {"owner": {"reputation": 2299, "user_id": 1596308, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JxwHy.png?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/1596308/adam"}, "edited": false, "score": 0, "creation_date": 1575489365, "post_id": 59166462, "comment_id": 104588036, "body": "Maybe that&#39;d be best, I&#39;m just haunted by the &#39;this worked perfectly fine before&#39;-ghost. Maybe it&#39;s an illusion that fixing it is the easiest way forward."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 1, "last_activity_date": 1575412756, "creation_date": 1575412756, "answer_id": 59166462, "question_id": 59164992, "link": "https://stackoverflow.com/questions/59164992/could-not-find-module-in-runhaskell-script/59166462#59166462", "title": "Could not find module in runhaskell-script", "body": "<p><code>Data.List.Split</code> is not part of \"base\", the core libraries that are distributed with Haskell. It is part of an external package named \"split\". If you want to use it, you must get that package somehow. This is typically done with cabal or stack. Perhaps there is a way to do this that runhaskell understands; I don't know anything about runhaskell.</p>\n"}, {"tags": [], "owner": {"reputation": 2299, "user_id": 1596308, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JxwHy.png?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/1596308/adam"}, "is_accepted": true, "score": 0, "last_activity_date": 1575712315, "last_edit_date": 1575712315, "creation_date": 1575711999, "answer_id": 59224749, "question_id": 59164992, "link": "https://stackoverflow.com/questions/59164992/could-not-find-module-in-runhaskell-script/59224749#59224749", "title": "Could not find module in runhaskell-script", "body": "<p>Ok so after following the instructions <a href=\"https://wiki.haskell.org/Cabal/How_to_install_a_Cabal_package\" rel=\"nofollow noreferrer\">to do things manually</a>, I double checked that I had the latest split package. The <a href=\"http://hackage.haskell.org/package/split\" rel=\"nofollow noreferrer\">web page</a> says the package requires <code>base (&lt;4.14)</code> but it still complains <code>Setup: Encountered missing dependencies: base &lt;4.12</code> when I try to run runhaskell Setup configure </p>\n\n<p>But then after I've tried and failed to install an older 'base', seemed like a long shot anyway, I simply followed the 'Installing packages using cabal' part of the guide.  </p>\n\n<pre><code>cabal update\ncabal install split\n</code></pre>\n\n<p>I ran those two commands and ignored the warnings that it was part of the legacy v1 cabal usage. It worked and it installed split so the runhaskell command could access it.</p>\n"}], "owner": {"reputation": 2299, "user_id": 1596308, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JxwHy.png?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/1596308/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 59224749, "answer_count": 2, "score": 1, "last_activity_date": 1575712315, "creation_date": 1575405660, "last_edit_date": 1575489828, "question_id": 59164992, "link": "https://stackoverflow.com/questions/59164992/could-not-find-module-in-runhaskell-script", "title": "Could not find module in runhaskell-script", "body": "<p>I code haskell of poor quality in <a href=\"https://adventofcode.com/\" rel=\"nofollow noreferrer\">december</a> each year. This year my environment is broken for some reason.</p>\n\n<p>When I try to run my old scripts with</p>\n\n<pre><code>runhaskell .\\myCode.hs\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>Could not find module `Data.List.Split'\nUse -v to see a list of the files searched for.\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/34175173/haskell-could-not-find-module-data-list-split\">This question</a> has a comment in one of the answers:</p>\n\n<pre><code>Maybe he doesn't even use a .cabal or .yaml file and only wants to write a stand-alone Haskell script for runhaskell.\n</code></pre>\n\n<p>That is exactly what I'm after, but the comment thread does not provide an answer. It worked 2016-2018 and I do not remember this issue, and I've never had the setup that is written <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#adding-dependencies\" rel=\"nofollow noreferrer\">about here</a> or <a href=\"https://www.reddit.com/r/haskell/comments/54caag/help_understanding_hidden_modules/\" rel=\"nofollow noreferrer\">here(\"hidden modules\")</a>.</p>\n\n<p>Anyone have an idea how to fix this?</p>\n\n<p><strong>Edit:</strong> I tried the guide <a href=\"https://wiki.haskell.org/Learn_Haskell_in_10_minutes\" rel=\"nofollow noreferrer\">here</a> which says to download the package, extract it and run:</p>\n\n<pre><code>runhaskell Setup configure\nrunhaskell Setup build\nrunhaskell Setup install\n</code></pre>\n\n<p>But I just get an error which says:</p>\n\n<pre><code>$ runhaskell Setup configure\nConfiguring split-0.2.3.3...\nSetup: Encountered missing dependencies:\nbase &lt;4.12\n</code></pre>\n\n<p>And I do have a Haskell\\8.6.3\\lib\\base-4.12.0.0 in the installation.</p>\n"}, {"tags": ["haskell", "types", "functional-programming"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1575396467, "post_id": 59162943, "comment_id": 104550196, "body": "I&#39;m not sure what your objection is to using <code>Either</code> here. If it&#39;s just the names of the constructors, you can always make your own sum type, like <code>data Direction = Horizontal HorizontalDirection | Vertical VerticalDirection</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1575397862, "post_id": 59162943, "comment_id": 104550749, "body": "If you are feeling adventurous, you might look at <a href=\"https://hackage.haskell.org/package/union-0.1.2/docs/Data-Union.html\" rel=\"nofollow noreferrer\">union types</a>."}, {"owner": {"reputation": 35, "user_id": 9388691, "user_type": "registered", "profile_image": "https://graph.facebook.com/2076875528994676/picture?type=large", "display_name": "Gabriel Crispino", "link": "https://stackoverflow.com/users/9388691/gabriel-crispino"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1575401336, "post_id": 59162943, "comment_id": 104552191, "body": "@RobinZigmond, it&#39;s not a problem. I just felt that it was wrong because I always see Either as a means of error handling."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9388691, "user_type": "registered", "profile_image": "https://graph.facebook.com/2076875528994676/picture?type=large", "display_name": "Gabriel Crispino", "link": "https://stackoverflow.com/users/9388691/gabriel-crispino"}, "edited": false, "score": 0, "creation_date": 1575401189, "post_id": 59163000, "comment_id": 104552125, "body": "Thanks! That was exactly what I was looking for!"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 8, "last_activity_date": 1575396474, "creation_date": 1575396474, "answer_id": 59163000, "question_id": 59162943, "link": "https://stackoverflow.com/questions/59162943/two-level-type-hierarchy-with-haskell/59163000#59163000", "title": "Two-level type hierarchy with Haskell", "body": "<p>Instead of using <code>Either</code> you can declare a new data type with more meaningful names.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Direction\n  = Horizontal HorizontalDirection\n  | Vertical   VerticalDirection\n\nbar :: Direction -&gt; String\nbar (Horizontal _) = \"Horizontal!\"\nbar (Vertical _) = \"Vertical!\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 9388691, "user_type": "registered", "profile_image": "https://graph.facebook.com/2076875528994676/picture?type=large", "display_name": "Gabriel Crispino", "link": "https://stackoverflow.com/users/9388691/gabriel-crispino"}, "edited": false, "score": 0, "creation_date": 1575401230, "post_id": 59163001, "comment_id": 104552146, "body": "Thank you for the suggestion! However, I think that @Li-yao Xia&#39;s answer is the one because it does not require typeclasses."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1575396484, "creation_date": 1575396484, "answer_id": 59163001, "question_id": 59162943, "link": "https://stackoverflow.com/questions/59162943/two-level-type-hierarchy-with-haskell/59163001#59163001", "title": "Two-level type hierarchy with Haskell", "body": "<p>You are quite close, but you need to define the function <em>in</em> the class:</p>\n\n<pre><code>class Direction a <b>where</b>\n    <b>baz</b> :: a -&gt; String\n\ninstance Direction HorizontalDirection where\n    <b>baz</b> _ = \"Horizontal\"\n\ninstance Direction VerticalDirection where\n    <b>baz</b> _ = \"Vertical\"</code></pre>\n\n<p>Note however that Haskell is statically typed, and the types are known at compile time.</p>\n"}], "owner": {"reputation": 35, "user_id": 9388691, "user_type": "registered", "profile_image": "https://graph.facebook.com/2076875528994676/picture?type=large", "display_name": "Gabriel Crispino", "link": "https://stackoverflow.com/users/9388691/gabriel-crispino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 59163000, "answer_count": 2, "score": 2, "last_activity_date": 1575396484, "creation_date": 1575396240, "question_id": 59162943, "link": "https://stackoverflow.com/questions/59162943/two-level-type-hierarchy-with-haskell", "title": "Two-level type hierarchy with Haskell", "body": "<p>I want to model 4 kinds of directions in my application: right, left, up and down. However, I want to be able to have a function that takes only the horizontal ones for a variable and the vertical ones for other variable.</p>\n\n<p>To solve this, I can have two types: HorizontalDirection and VerticalDirection:</p>\n\n<pre><code>data HorizontalDirection = RightDir | LeftDir\ndata VerticalDirection = UpDir | DownDir\n\nfoo :: HorizontalDirection -&gt; VerticalDirection -&gt; String\nfoo hDir vDir = \"This works\" \n</code></pre>\n\n<p>However, I also would like to be able to have a function that can take one type as well as the other, something like this:</p>\n\n<pre><code>bar :: Direction -&gt; String\nbar (HorizontalDirection _) = \"Horizontal!\"\nbar (VerticalDirection _)   = \"Vertical!\"\n</code></pre>\n\n<p>but this wouldn't work since HorizontalDirection and VerticalDirection aren't data constructors.</p>\n\n<p>I know I can use Either and make it work, like this:</p>\n\n<pre><code>bar :: (Either HorizontalDirection VerticalDirection) -&gt; String\nbar (Left _) = \"Horizontal!\"\nbar (Right _) = \"Vertical!\"\n</code></pre>\n\n<p>however, I wonder if I can do this without the Either type.</p>\n\n<p>I also tried using typeclasses:</p>\n\n<pre><code>data HorizontalDirection = RightDir | LeftDir\ndata VerticalDirection = UpDir | DownDir\n\nclass Direction a\n\ninstance Direction HorizontalDirection\ninstance Direction VerticalDirection\n\nbaz :: Direction d =&gt; d -&gt; String\nbaz RightDir = \"Horizontal\"\n</code></pre>\n\n<p>but that gives me the following compiler error:</p>\n\n<pre><code>Direction.hs:21:5: error:\n    \u2022 Couldn't match expected type \u2018d\u2019\n                  with actual type \u2018HorizontalDirection\u2019\n      \u2018d\u2019 is a rigid type variable bound by\n        the type signature for:\n          baz :: forall d. Direction d =&gt; d -&gt; String\n        at Direction.hs:20:1-33\n    \u2022 In the pattern: RightDir\n      In an equation for \u2018baz\u2019: baz RightDir = \"Horizontal\"\n    \u2022 Relevant bindings include\n        baz :: d -&gt; String (bound at Direction.hs:21:1)\n</code></pre>\n\n<p>Is my way of thinking totally wrong here? Or am I just missing something?</p>\n"}, {"tags": ["haskell", "higher-order-types"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1575393153, "post_id": 59161843, "comment_id": 104548694, "body": "You can construct functions with <i>template Haskell</i>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1575394105, "post_id": 59161843, "comment_id": 104549084, "body": "@WillemVanOnsem This is not a very useful piece of knowledge for a self-attested Haskell beginner."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1575394202, "post_id": 59161843, "comment_id": 104549121, "body": "Where would you need to use a function like <code>lengthTuple</code>? Especially given that <code>kth</code>, like you correctly guessed, is impossible."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1575404755, "post_id": 59161843, "comment_id": 104553654, "body": "Empirically: this comes up much less often than you might expect if you come from a dynamically-typed language."}], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "is_accepted": false, "score": 1, "last_activity_date": 1575393307, "creation_date": 1575393307, "answer_id": 59162229, "question_id": 59161843, "link": "https://stackoverflow.com/questions/59161843/how-to-define-a-family-of-type-dependent-function-in-haskell/59162229#59162229", "title": "How to define a family of type dependent function in Haskell", "body": "<p>This kind of problem (dependent type) is still a headache in Haskell.  The Tuple from Prelude is not quite suitable for this kind of task (perhaps doable though).  But you can use the sized vector with dependent type for this kind of problem.</p>\n\n<p>Example: \n<a href=\"https://www.schoolofhaskell.com/user/konn/prove-your-haskell-for-great-safety/dependent-types-in-haskell\" rel=\"nofollow noreferrer\">https://www.schoolofhaskell.com/user/konn/prove-your-haskell-for-great-safety/dependent-types-in-haskell</a></p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1575404331, "post_id": 59163992, "comment_id": 104553477, "body": "Perhaps too cute to actually do, but... if you make it <code>type family T (ix :: Ix) t; type instance T &#39;I1 (a1, _, _, _) = a1</code> and so forth, then the type signature <code>choose :: t ~ (a1, a2, a3, a4) =&gt; t -&gt; SIx ix -&gt; T ix t</code> is a bit more compact."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1575401308, "last_edit_date": 1575401308, "creation_date": 1575400858, "answer_id": 59163992, "question_id": 59161843, "link": "https://stackoverflow.com/questions/59161843/how-to-define-a-family-of-type-dependent-function-in-haskell/59163992#59163992", "title": "How to define a family of type dependent function in Haskell", "body": "<p>You can not implement your function if the index must be an <code>Int</code>, but you could if that were a custom \"singleton\" index type. Essentially, if we want to mimic dependent types, the best option we have is to pass singletons around a lot, to connect type-level values to term-level ones.</p>\n\n<p>Here is one example:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, TypeFamilies #-}\n{-# OPTIONS -Wall #-}\n\n-- custom index type\ndata Ix = I1 | I2 | I3 | I4\n\n-- associated singleton type (this could be autogenerated using the singletons library)\ndata SIx (ix :: Ix) where\n  SI1 :: SIx 'I1\n  SI2 :: SIx 'I2\n  SI3 :: SIx 'I3\n  SI4 :: SIx 'I4\n\n-- type level function\ntype family T (ix :: Ix) a1 a2 a3 a4 \ntype instance T 'I1 a1 _ _ _ = a1\ntype instance T 'I2 _ a2 _ _ = a2\ntype instance T 'I3 _ _ a3 _ = a3\ntype instance T 'I4 _ _ _ a4 = a4\n\n-- our \"dependent\" tuple selector\nchoose :: (a1, a2, a3, a4) -&gt; SIx ix -&gt; T ix a1 a2 a3 a4\nchoose (x1, _, _, _) SI1 = x1\nchoose (_, x2, _, _) SI2 = x2\nchoose (_, _, x3, _) SI3 = x3\nchoose (_, _, _, x4) SI4 = x4\n</code></pre>\n\n<p>If wanted, we can \"hide\" the <code>ix</code> parameter of <code>SIx ix</code> and <code>T ix a1 a2 a3 a4</code> using an existential wrapper (as a sort of dependent sum type), building a function that given \"some index\" returns \"some component\".</p>\n\n<p>This would be much more convenient if we had real dependent types. Still, this is the price we currently pay to have type erasure at runtime. If Haskell one day adds non-erased <code>pi a . ...</code> types to the erased ones <code>forall a . ...</code> we have now, we will have much more control.</p>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 0, "last_activity_date": 1575410863, "creation_date": 1575410863, "answer_id": 59166111, "question_id": 59161843, "link": "https://stackoverflow.com/questions/59161843/how-to-define-a-family-of-type-dependent-function-in-haskell/59166111#59166111", "title": "How to define a family of type dependent function in Haskell", "body": "<p>The short answer, as suggested in some comments, is that you shouldn't seriously be doing this in Haskell.  If you find yourself needing to write functions that can operate on differently sized tuples, you're programming Haskell wrong.</p>\n\n<p>However, the idiomatic method of defining a function like <code>lengthTuple</code> is to use type classes with explicit instances for different tuple sizes.  If this is for a library, you pick some upper bound and write instances up to that size.  A reasonable choice might be a 15-tuple, since that's also the largest tuple that has a <code>Show</code> instance:</p>\n\n<pre><code>&gt; (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15)\n(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15)\n&gt; (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16)\n&lt;interactive&gt;:72:1: error:\n    \u2022 No instance for (Show ...\n</code></pre>\n\n<p>So, the definition for <code>lengthTuple</code> would look like this:</p>\n\n<pre><code>class Tuple a where lengthTuple :: a -&gt; Int\ninstance Tuple (a,b) where lengthTuple _ = 2\ninstance Tuple (a,b,c) where lengthTuple _ = 3\ninstance Tuple (a,b,c,d) where lengthTuple _ = 4\n...up to 15...\n</code></pre>\n\n<p>Tedious, but pretty standard.</p>\n\n<p>Remarkably, it is possible to write <code>lengthTuple</code> without any boilerplate using <code>Data.Data</code> generics.  These generics provide a way to fold over the structure of an algebraic data type in a fairly general way, and you can use a <code>Const</code> functor to ignore the actual content of the data type while counting the number of fields:</p>\n\n<pre><code>import Data.Data\nimport Data.Functor.Const\nlengthTuple :: (Data a) =&gt; a -&gt; Int\nlengthTuple = getConst . gfoldl (\\(Const n) _ -&gt; Const (n+1))\n                                (\\_ -&gt; Const 0)\n</code></pre>\n\n<p>This works fine, though there's no straightforward way to restrict it to tuples, and you may find its return value for non-tuples somewhat surprising:</p>\n\n<pre><code>&gt; lengthTuple (1,2,3,4)\n4\n&gt; lengthTuple \"\"\n0\n&gt; lengthTuple \"what the heck?\"\n2\n</code></pre>\n\n<p>Writing <code>kth</code> is much, much harder.  Your intuition is right.  Because the type of the expression <code>kth tuple n</code> depends on the <strong>value</strong> rather than the type of the parameter <code>n</code>, a simple definition isn't possible.  The other answers have covered a couple of approaches.</p>\n"}], "owner": {"reputation": 121, "user_id": 9819411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f8b93e1c84796d49aea943b33a1308?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/9819411/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1575410863, "creation_date": 1575391961, "question_id": 59161843, "link": "https://stackoverflow.com/questions/59161843/how-to-define-a-family-of-type-dependent-function-in-haskell", "title": "How to define a family of type dependent function in Haskell", "body": "<p>This is a (series of) Haskell question(s). I am fairly new to Haskell.</p>\n\n<p>Suppose we have a 4-tuple (a1,a2,a3,a4). How do we define a function, <code>kth</code>, that gives the k-th element in this tuple? Example,</p>\n\n<pre><code>kth (1,\"A\",'b',True) 3 = 'b'\n</code></pre>\n\n<p>If the types of a1, a2, a3, a4 are the same, then it has a fairly simple definition. For example, if they are all integers:</p>\n\n<pre><code>kth :: (Int,Int,Int,Int) -&gt; Int -&gt; Int\nkth (a1,a2,a3,a4) 1 = a1\nkth (a1,a2,a3,a4) 2 = a2\nkth (a1,a2,a3,a4) 3 = a3\nkth (a1,a2,a3,a4) 4 = a4\n</code></pre>\n\n<p>My suspicion of why this is not straightforward is because Haskell must know the type in advance. In the library function <code>fst</code> and <code>snd</code>, Haskell knows that the output type is the type of the first element for the formal, and the output type is the type of the second element for the latter. Hence, there is no ambiguity. In <code>kth</code>, the output type depends on the second input, hence Haskell cannot do type check based on the syntax.</p>\n\n<p>Now, suppose we have a n-th tuple (a1,a2,...,an). Can we define a family of length functions such that</p>\n\n<pre><code>lengthTuple :: a -&gt; Int\nlengthTuple (a1,a2,...,an) = n\n</code></pre>\n"}, {"tags": ["list", "haskell", "monads"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1575385916, "post_id": 59160026, "comment_id": 104544594, "body": "Here <code>forM</code> will return a list <code>[(), (), ..., ()]</code>. You might want to use <code>forM_</code>, but it here looks like you are translating imperative code to functional. In fact you do not need <code>forM</code>, or <code>do</code> at all."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575392883, "post_id": 59160026, "comment_id": 104548537, "body": "Even using the monad instance for lists, <code>forM</code> isn&#39;t necessary. You would just need <code>input &gt;&gt;= \\x -&gt; return (read x) :: [Int]</code> or <code>input &gt;&gt;= return . read :: [Int]</code>, or even <code>input &gt;&gt;= \\x -&gt; [read x]</code>. (Using list notation in the last one is sufficient to indicate that the result should be a list, without the explicit type annotation.)"}, {"owner": {"reputation": 43, "user_id": 11406599, "user_type": "registered", "profile_image": "https://graph.facebook.com/2177810422326853/picture?type=large", "display_name": "Balog Szil&#225;rd", "link": "https://stackoverflow.com/users/11406599/balog-szil%c3%a1rd"}, "edited": false, "score": 0, "creation_date": 1575459369, "post_id": 59160026, "comment_id": 104571832, "body": "Okay, I see that forM is not necesarry, but if I have to leave it like that, how can I access the elements of the list"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11406599, "user_type": "registered", "profile_image": "https://graph.facebook.com/2177810422326853/picture?type=large", "display_name": "Balog Szil&#225;rd", "link": "https://stackoverflow.com/users/11406599/balog-szil%c3%a1rd"}, "edited": false, "score": 0, "creation_date": 1575474136, "post_id": 59160117, "comment_id": 104580369, "body": "<code>map read input :: [Int]</code> works just fine if I type it in the terminal, however when I&#39;m using it in my <code>main</code> function, it gives me an error"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 43, "user_id": 11406599, "user_type": "registered", "profile_image": "https://graph.facebook.com/2177810422326853/picture?type=large", "display_name": "Balog Szil&#225;rd", "link": "https://stackoverflow.com/users/11406599/balog-szil%c3%a1rd"}, "edited": false, "score": 0, "creation_date": 1575474319, "post_id": 59160117, "comment_id": 104580493, "body": "@BalogSzil&#225;rd: that is because <code>main</code> should be of type <code>IO a</code>. So you need to perform an <i>action</i>, for example <code>main = print (map read input :: [Int])</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 8, "last_activity_date": 1575385994, "creation_date": 1575385994, "answer_id": 59160117, "question_id": 59160026, "link": "https://stackoverflow.com/questions/59160026/return-value-of-form-in-haskell/59160117#59160117", "title": "Return value of forM in Haskell", "body": "<blockquote>\n  <p>If I have a list <code>input = [\"1\", \"-2\", \"14\", \"3\"]</code> with length n and I want to convert it into an <code>Int</code> list.</p>\n</blockquote>\n\n<p>Then you should use:</p>\n\n<pre><code><b>map read</b> input :: [Int]</code></pre>\n\n<p>Indeed:</p>\n\n<pre><code>Prelude&gt; input = [\"1\", \"-2\", \"14\", \"3\"]\nPrelude&gt; map read input :: [Int]\n[1,-2,14,3]\n</code></pre>\n\n<blockquote>\n  <p>I figured out that t will contain the Int value of each string from the input list but I don't understand how should I put them in a new list.</p>\n</blockquote>\n\n<p>Variables in (pure) functional languages, like Haskell, are <em>immutable</em>. That means that once a variable is set to a value, you can not set it to a different value.</p>\n\n<p>In fact in Haskell, one seldomly use looping mechanisms like <code>forM</code>, etc. The <code>M</code> suffix usually says you are working with <strong>M</strong>onads, but here you do not need monads at all. I strongly advice not to use <code>do</code>, etc. before you have some basic understanding on how a monad works. See for example the <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"noreferrer\"><em>A fistful of Monads</em> chapter on <em>Learn You A Haskell</em> [lyah]</a>.</p>\n"}], "owner": {"reputation": 43, "user_id": 11406599, "user_type": "registered", "profile_image": "https://graph.facebook.com/2177810422326853/picture?type=large", "display_name": "Balog Szil&#225;rd", "link": "https://stackoverflow.com/users/11406599/balog-szil%c3%a1rd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575395719, "creation_date": 1575385601, "last_edit_date": 1575395719, "question_id": 59160026, "link": "https://stackoverflow.com/questions/59160026/return-value-of-form-in-haskell", "title": "Return value of forM in Haskell", "body": "<p>If I have a list <code>input = [\"1\", \"-2\", \"14\", \"3\"]</code> with length <code>n</code>and I want to convert it into an <code>Int</code> list, what is the return value of </p>\n\n<pre><code>forM [0..(n-1)] $ \\i -&gt; do\n        let t = read (input!!(i)) :: Int \n        return ()\n</code></pre>\n\n<p>I figured out that <code>t</code> will contain the <code>Int</code> value of each string from the <code>input</code> list but I don't understand how should I put them in a new list. Note that this <code>forM</code> syntax is not written by me. I researched how I should work with monads but I still don't really get it since I couldn't find a single example.</p>\n"}, {"tags": ["function", "haskell"], "comments": [{"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 2, "creation_date": 1575385624, "post_id": 59159990, "comment_id": 104544412, "body": "Did you try actually calling this function? E.g. the result of <code>f &quot;abcde&quot; &quot;bad bread is good&quot;</code>, <code>f &quot;xyz&quot; &quot;extra credit&quot;</code> should give you some clues."}, {"owner": {"reputation": 11, "user_id": 12424825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb8b6dd01b3d00355683e8c85df842c?s=128&d=identicon&r=PG&f=1", "display_name": "mattyp", "link": "https://stackoverflow.com/users/12424825/mattyp"}, "reply_to_user": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 0, "creation_date": 1575385891, "post_id": 59159990, "comment_id": 104544573, "body": "@lisyarus, yeah I did, I&#39;m sorry I meant more in the lines of how it works, I understand it removes occurrences of letters in the first string in the second"}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 0, "creation_date": 1575385942, "post_id": 59159990, "comment_id": 104544612, "body": "Okay, that&#39;s already something worth mentioning in the question, it will help answering it."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1575386044, "post_id": 59159990, "comment_id": 104544658, "body": "try to do <code>filter . notElem</code> first, then add <code>flip</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12424825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb8b6dd01b3d00355683e8c85df842c?s=128&d=identicon&r=PG&f=1", "display_name": "mattyp", "link": "https://stackoverflow.com/users/12424825/mattyp"}, "edited": false, "score": 0, "creation_date": 1575386187, "post_id": 59160081, "comment_id": 104544735, "body": "Thank you for your help!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1575386448, "last_edit_date": 1575386448, "creation_date": 1575385853, "answer_id": 59160081, "question_id": 59159990, "link": "https://stackoverflow.com/questions/59159990/what-does-this-do-in-haskell/59160081#59160081", "title": "What does this do in Haskell?", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:flip\" rel=\"nofollow noreferrer\"><strong><code>flip :: (b -&gt; a -&gt; c) -&gt; a -&gt; b -&gt; c</code></strong></a> flips the first two parameters of a function. So since <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:notElem\" rel=\"nofollow noreferrer\"><strong><code>notElem :: Eq a =&gt; a -&gt; [a] -&gt; Bool</code></strong></a> takes a value and a list to check if the value is not in the list, <code>flip notElem :: Eq a =&gt; [a] -&gt; a -&gt; Bool</code> takes a list and a value to check if it is not in the list.</p>\n\n<p>We thus will first partially apply the first parameter in <code>f</code> to <code>flip notElem</code>, and then <code>filter</code> a list. Your expression is thus a short form of:</p>\n\n<pre><code>f :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\nf xs ys = filter (\\y -&gt; notElem y xs) ys\n</code></pre>\n\n<p>It will thus return all elements in <code>ys</code> (the second parameter) that are not in <code>xs</code> (the first parameter). For example:</p>\n\n<pre><code>Prelude&gt; f [1,3,0,2] [1,4,2,5]\n[4,5]\n</code></pre>\n\n<p>Both <code>4</code> and <code>5</code> are elements of the second list, but not of the first one.</p>\n"}], "owner": {"reputation": 11, "user_id": 12424825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb8b6dd01b3d00355683e8c85df842c?s=128&d=identicon&r=PG&f=1", "display_name": "mattyp", "link": "https://stackoverflow.com/users/12424825/mattyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 59160081, "answer_count": 1, "score": 0, "last_activity_date": 1575386448, "creation_date": 1575385465, "last_edit_date": 1575385927, "question_id": 59159990, "link": "https://stackoverflow.com/questions/59159990/what-does-this-do-in-haskell", "title": "What does this do in Haskell?", "body": "<pre><code>f = filter . flip notElem\n</code></pre>\n\n<p>I am wondering how this line works, this is a function that should take two strings and return a string.</p>\n"}, {"tags": ["haskell", "coercion", "type-level-computation"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 12473867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95082b5c828c8a0ada7c0423681f2a23?s=128&d=identicon&r=PG&f=1", "display_name": "&#230;ons", "link": "https://stackoverflow.com/users/12473867/%c3%a6ons"}, "edited": false, "score": 0, "creation_date": 1575380751, "post_id": 59157636, "comment_id": 104541214, "body": "Thank you for the answer, chi. My problem is actually more complicated, could you please take another look at the edited question?"}, {"owner": {"reputation": 63, "user_id": 12473867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95082b5c828c8a0ada7c0423681f2a23?s=128&d=identicon&r=PG&f=1", "display_name": "&#230;ons", "link": "https://stackoverflow.com/users/12473867/%c3%a6ons"}, "edited": false, "score": 0, "creation_date": 1575388192, "post_id": 59157636, "comment_id": 104545929, "body": "I forgot to add the (C t) constraint to my implementation so I&#39;ve edited again. It must somehow be possible to use the coerceX from (C t), but pattern matching on the type-applied version doesn&#39;t seem to do the trick."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1575382532, "last_edit_date": 1575382532, "creation_date": 1575377750, "answer_id": 59157636, "question_id": 59157563, "link": "https://stackoverflow.com/questions/59157563/coercion-of-newtyped-reader-monad-given-coercion-for-its-value-type/59157636#59157636", "title": "Coercion of newtyped reader monad given coercion for its value type", "body": "<p>You can pattern match with the constructor <code>Coercion</code> and use the same constructor <code>Coercion</code> for the new value. The pattern matching will bring the constraint <code>Coercible a b</code> in scope, and using <code>Coercion</code> for the result will use that constraint to prove the wanted <code>Coercible (X (T r) a) (X (T r) b)</code>.</p>\n\n<p>Pragmatically, this compiles. The magic happens in the last line, where the compiler automatically infers the constraint brought into scope, and the constraint needed for the result to type check. The compiler then verifies that the assumed constraint indeed implies the required one, for the given definition of <code>data X (T r) a</code>.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nimport Data.Type.Coercion\nimport Control.Monad.Trans.Reader\n\nclass C t where\n  data X t :: * -&gt; *\n  coerceX :: Coercion a b -&gt; Coercion (X t a) (X t b)\n\ndata T r = Unused\n\ninstance C (T r) where\n  newtype X (T r) a = X (Reader r a)\n  coerceX Coercion = Coercion\n</code></pre>\n\n<hr>\n\n<p>The question changed since the above answer was written.</p>\n\n<p>For the updated question, I think we need to require a quantified constraint to make it type check:</p>\n\n<pre><code>instance\n    (forall a b . Coercible a b\n               =&gt; Coercible (X (T r t) a) (X (T r t) b))\n    =&gt; C (T r t) where\n  newtype X (T r t) a = X (Reader r (X t a))\n  coerceX :: Coercion a b -&gt; Coercion (X (T r t) a) (X (T r t) b)\n  coerceX Coercion = Coercion\n</code></pre>\n\n<p>I am not sure about how this will be used later on.</p>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 1, "last_activity_date": 1575494324, "creation_date": 1575494324, "answer_id": 59184809, "question_id": 59157563, "link": "https://stackoverflow.com/questions/59157563/coercion-of-newtyped-reader-monad-given-coercion-for-its-value-type/59184809#59184809", "title": "Coercion of newtyped reader monad given coercion for its value type", "body": "<p>It looks like you can lead GHC by the nose through the necessary coercions, like so:</p>\n\n<pre><code>{-# LANGUAGE InstanceSigs #-}\ninstance (C t) =&gt; C (T r t) where\n  newtype X (T r t) a = X (Reader r (X t a))\n  coerceX :: forall a b. Coercion a b -&gt; Coercion (X (T r t) a) (X (T r t) b)\n  coerceX Coercion\n    = gcoerceWith (coerceX Coercion :: Coercion (X t a) (X t b)) $\n        (Coercion :: Coercion (X (T r t) a) (Reader r (X t a))) `trans`\n        (Coercion :: Coercible a' b' =&gt; Coercion (Reader r a') (Reader r b')) `trans`\n        (Coercion :: Coercion (Reader r (X t b)) (X (T r t) b))\n</code></pre>\n\n<p>Once the pattern match:</p>\n\n<pre><code>coerceX Coercion = ...\n</code></pre>\n\n<p>brings <code>Coercible a b</code> into scope, I think you need to explicitly invoke <code>coerceX</code> for the <code>C t</code> instance to get <code>Coercion (X t a) (X t b)</code>.  I don't see how GHC could deduce this automatically.</p>\n\n<p>Now, in an ideal world, it would be then enough to write:</p>\n\n<pre><code>coerceX Coercion = gcoerceWith (coerceX Coercion :: Coercion (X t a) (X t b)) Coercion\n</code></pre>\n\n<p>and with <code>Coercible (X t a) (X t b)</code> in scope, GHC would be able to infer the representational equality of <code>Reader r (X t a)</code> and <code>Reader r (X t b)</code> and consequently the representation equality of <code>X (T r t) a</code> and <code>X (T r t) b</code>, but it can't quite make this leap.</p>\n"}], "owner": {"reputation": 63, "user_id": 12473867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95082b5c828c8a0ada7c0423681f2a23?s=128&d=identicon&r=PG&f=1", "display_name": "&#230;ons", "link": "https://stackoverflow.com/users/12473867/%c3%a6ons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 59184809, "answer_count": 2, "score": 5, "last_activity_date": 1575494324, "creation_date": 1575377471, "last_edit_date": 1575386390, "question_id": 59157563, "link": "https://stackoverflow.com/questions/59157563/coercion-of-newtyped-reader-monad-given-coercion-for-its-value-type", "title": "Coercion of newtyped reader monad given coercion for its value type", "body": "<p>A typeclass <code>C</code> with associated data family <code>X</code> requires a function <code>coerceX</code>. If I implement the typeclass like below, how do I write <code>coerceX</code>?</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeApplications #-}\n\nimport Data.Type.Coercion\nimport Control.Monad.Reader\n\ndata (T r t)\n\nclass C t where\n  data X t :: * -&gt; *\n  coerceX :: Coercion a b -&gt; Coercion (X t a) (X t b)\n\ninstance (C t) =&gt; C (T r t) where\n  newtype X (T r t) a = X (Reader r (X t a))\n  coerceX = ...\n</code></pre>\n"}, {"tags": ["haskell", "logging"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1575371014, "creation_date": 1575371014, "answer_id": 59155643, "question_id": 59155315, "link": "https://stackoverflow.com/questions/59155315/how-can-i-modify-the-log-format-of-katip/59155643#59155643", "title": "How can I modify the log format of Katip?", "body": "<p>Instead of creating a <code>Scribe</code> with <a href=\"https://hackage.haskell.org/package/katip-0.8.3.0/docs/Katip-Scribes-Handle.html#v:mkHandleScribe\" rel=\"nofollow noreferrer\"><strong><code>mkHandleScribe</code></strong></a>, you can create one with <a href=\"https://hackage.haskell.org/package/katip-0.8.3.0/docs/Katip-Scribes-Handle.html#v:mkHandleScribeWithFormatter\" rel=\"nofollow noreferrer\"><strong><code>mkHandleScribeWithFormatter</code></strong></a> where you pass a <em>formatter</em>: a function that decides how to render the content. You can make use of the <a href=\"https://hackage.haskell.org/package/katip-0.8.3.0/docs/Katip-Scribes-Handle.html#v:bracketFormat\" rel=\"nofollow noreferrer\"><strong><code>bracketFormat :: LogItem a =&gt; ItemFormatter a</code></strong></a> as an example how to implement such formatter.</p>\n\n<p>For example:</p>\n\n<pre><code>import Data.Text(pack)\nimport Data.Time.Clock(UTCTime)\nimport Data.Time.Format(formatTime, defaultTimeLocale)\n\nimport Katip.Scribes.Handle\n\nmyTimeFormat :: UTCTime -&gt; Text\nmyTimeFormat = pack . formatTime defaultTimeLocale \"%H:%m\"\n\nmyFormat :: LogItem a =&gt; ItemFormatter a\nmyFormat withColor verb Item{..} =\n    brackets nowStr &lt;&gt;\n    brackets (mconcat $ map fromText $ intercalateNs _itemNamespace) &lt;&gt;\n    brackets (fromText (renderSeverity' _itemSeverity)) &lt;&gt;\n    mconcat ks &lt;&gt;\n    maybe mempty (brackets . fromString . locationToString) _itemLoc &lt;&gt;\n    fromText \" \" &lt;&gt; (unLogStr _itemMessage)\n  where\n    nowStr = fromText (myTimeFormat _itemTime)\n    ks = map brackets $ getKeys verb _itemPayload\n    renderSeverity' severity =\n      colorBySeverity withColor severity (renderSeverity severity)\n</code></pre>\n\n<p>Then you can thus construct a <code>Scribe</code> with:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  handleScribe &lt;- mkHandleScribeWithFormatter <b>myFormat</b> ColorIfTerminal stdout (permitItem InfoS) V2\n  -- &hellip;</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4939115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhXgf.png?s=128&g=1", "display_name": "eatt1029", "link": "https://stackoverflow.com/users/4939115/eatt1029"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 59155643, "answer_count": 1, "score": 1, "last_activity_date": 1575371014, "creation_date": 1575369950, "last_edit_date": 1575370752, "question_id": 59155315, "link": "https://stackoverflow.com/questions/59155315/how-can-i-modify-the-log-format-of-katip", "title": "How can I modify the log format of Katip?", "body": "<p>I'm trying to use <a href=\"http://hackage.haskell.org/package/katip\" rel=\"nofollow noreferrer\">Katip</a> for logging. I just follow the basic example in <a href=\"http://hackage.haskell.org/package/katip-0.8.3.0/docs/Katip.html\" rel=\"nofollow noreferrer\">this page</a>. and the log looks like this:</p>\n\n<pre><code>[2019-12-03 10:34:28][app.main][Info][yy-Air][PID 45424][ThreadId 7][main:Main app/Main.hs:36:3] Hello Katip\n[2019-12-03 10:34:28][app.main.additional_namespace][Warning][yy-Air][PID 45424][ThreadId 7][main:Main app/Main.hs:38:5] Now we're getting fancy\n[2019-12-03 10:34:28][app.main.additional_namespace][Error][yy-Air][PID 45424][ThreadId 7] You will never see this!\n</code></pre>\n\n<p>It's too many information to me. So, is there a way to: </p>\n\n<ol>\n<li>remove information like <em>host</em>, <em>PID</em> and <em>ThreadId</em>? </li>\n<li>change the format of its timestamp? Say, I only need something like <code>[10:34]</code>.</li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1575368060, "post_id": 59154523, "comment_id": 104533745, "body": "There are alternatives, but IMO using an editor is the best way, since it allows one to change the previously defined entities (typo fixes, new experiments, ...) without re-typing all the code. Every time I start typing in GHCi non trivial code I find myself to regret I did not use an editor."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1575367655, "creation_date": 1575367655, "answer_id": 59154571, "question_id": 59154523, "link": "https://stackoverflow.com/questions/59154523/how-to-define-data-type-in-ghci/59154571#59154571", "title": "How to define data type in GHCi", "body": "<p>You defined the data type correctly, but when you want to enter a multi-line statement in GHCi, you need to use <code>:{</code> and <code>:}</code>, or use another mechanism to make multi-line statements. You thus can enter this with:</p>\n\n<pre><code>Prelude&gt; data Shape = Circle Float Float Float | Rectangle Float Float Float Float\nPrelude&gt; <b>:{</b>\nPrelude| surface :: Shape -&gt; Float\nPrelude| surface (Circle _ _ r) = pi * r ^ 2\nPrelude| surface (Rectangle x1 y1 x2 y2) = (abs $ x2 - x1) * (abs $ y2 - y1)\nPrelude| <b>:}</b></code></pre>\n"}], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 59154571, "answer_count": 1, "score": 2, "last_activity_date": 1575367655, "creation_date": 1575367452, "question_id": 59154523, "link": "https://stackoverflow.com/questions/59154523/how-to-define-data-type-in-ghci", "title": "How to define data type in GHCi", "body": "<p>I'm reading from \"<a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">Making Our Own Types and Typeclasses</a>\" part from \"Learn You a Haskell for Great Good!\".</p>\n\n<p>By following the text I wrote the code in GHCi and got an error.</p>\n\n<pre><code>data Shape = Circle Float Float Float | Rectangle Float Float Float Float   \nsurface :: Shape -&gt; Float\n\n&lt;interactive&gt;:2:1: error:\n    Variable not in scope: surface :: Shape -&gt; Float\n</code></pre>\n\n<p>When I write the code by text editor and load from GHCi, it works without problem.</p>\n\n<p>How should I define data type in GHCi?</p>\n"}, {"tags": ["haskell", "caching", "nix", "shake", "shake-build-system"], "answers": [{"tags": [], "owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "is_accepted": true, "score": 0, "last_activity_date": 1575565690, "creation_date": 1575565690, "answer_id": 59200106, "question_id": 59147136, "link": "https://stackoverflow.com/questions/59147136/haskell-shake-build-how-can-i-set-up-a-shared-cache-folder-using-shakeshare-and/59200106#59200106", "title": "Haskell Shake build: how can I set up a shared cache folder using shakeShare and/or shakeCloud?", "body": "<p>I misunderstood what Shake caches are for: I assumed they cache build artifacts indexed by all their inputs, but actually they just cache reading + processing of files used to decide things while producing those artifacts. Like in this example from <a href=\"http://hackage.haskell.org/package/shake-0.18.3/docs/Development-Shake.html#v:newCache\" rel=\"nofollow noreferrer\">the docs</a>:</p>\n\n<pre><code>digits &lt;- newCache $ \\file -&gt; do\n    src &lt;- readFile' file\n    return $ length $ filter isDigit src\n\"*.digits\" %&gt; \\x -&gt; do\n    v1 &lt;- digits (dropExtension x)\n    v2 &lt;- digits (dropExtension x)\n    writeFile' x $ show (v1,v2)\n</code></pre>\n\n<p>As it says, \"This function is useful when creating files that store intermediate values, to avoid the overhead of repeatedly reading from disk, particularly if the file requires expensive parsing.\" I think the cache here is equivalent to writing an intermediate <code>.digits</code> file and <code>need</code>ing it twice.</p>\n\n<p>I implemented what I was looking for separately by writing a <code>need'</code> function that checks if a file is in the cache (local or remote), fetches it if possible, and then calls <code>Development.Shake.need</code>. Depending on the build system, it might also be possible to do this kind of \"caching\" with something like <code>rsync</code>.</p>\n\n<p>The Shake cache still looks very useful for the part of my code that needs to read a list of all sequence IDs into memory once per program run and refer to them later from various rules.</p>\n"}, {"tags": [], "owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "is_accepted": false, "score": 0, "last_activity_date": 1576344675, "creation_date": 1576344675, "answer_id": 59337514, "question_id": 59147136, "link": "https://stackoverflow.com/questions/59147136/haskell-shake-build-how-can-i-set-up-a-shared-cache-folder-using-shakeshare-and/59337514#59337514", "title": "Haskell Shake build: how can I set up a shared cache folder using shakeShare and/or shakeCloud?", "body": "<p>I think there's a confusion here that <code>newCache</code> and <code>newCacheIO</code> are  involved with the Cloud Shake feature. They aren't - in fact, <code>newCache</code> happens to be one of the things that has no impact on the cloud cache (coincidentally, rather than because of the <code>Cache</code> in the name). I see no reason your use case shouldn't work with Cloud Shake.</p>\n\n<p>The exception <code>/home/jefdaj/shortcut/sharedir/.shake.cache/2faae061b9976bed/0x134125AC: getPermissions:getFileStatus: does not exist (No such file or directory)</code> seems to imply that Shake has recorded that the above file is in the cache, and can be used to satisfy the file. So the question is where did the file go? Is it possible when you cleaned the files that they deleted the files from the cache too? Shake can be run with both <code>--share-copy</code> and <code>--share-symlink</code> - I'd recommend the former to ensure there is less action-at-a-distance, which might also explain what is deleting the files. I'd also recommend using Shake HEAD, as there are some fixes that haven't yet been released.</p>\n\n<p>If that still doesn't work, perhaps raise a ticket on the <a href=\"https://github.com/ndmitchell/shake/issues\" rel=\"nofollow noreferrer\">Shake GitHub</a>?</p>\n"}], "owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 59200106, "answer_count": 2, "score": 0, "last_activity_date": 1576344675, "creation_date": 1575323271, "question_id": 59147136, "link": "https://stackoverflow.com/questions/59147136/haskell-shake-build-how-can-i-set-up-a-shared-cache-folder-using-shakeshare-and", "title": "Haskell Shake build: how can I set up a shared cache folder using shakeShare and/or shakeCloud?", "body": "<p>I understand this is a new feature being worked on for GHC's Hadrian build system, so the workflow might be advanced, oddly specific, or still evolving. I read these so far:</p>\n\n<ul>\n<li><a href=\"https://github.com/ndmitchell/shake/blob/master/docs/Cloud.md\" rel=\"nofollow noreferrer\">docs/Cloud.md</a></li>\n<li><a href=\"https://www.haskell.org/ghc/blog/20190731-hadrian-cloud-builds.html\" rel=\"nofollow noreferrer\">Exploring Cloud Builds in Hadrian</a></li>\n</ul>\n\n<p>It sounds like it should work for my use case: a domain-specific language for bioinformatics that would benefit greatly from caching comparisons between large genomes. I would be happy working from a basic minimal example or description of where to look. But I've included more details about my program too in case they make it easier...</p>\n\n<p>The <a href=\"https://github.com/jefdaj/shortcut\" rel=\"nofollow noreferrer\">shortcut</a> interpreter builds lots of artifacts with names derived from hashes of their inputs (somewhat Nix-like), and theoretically they should be portable across machines or even operating systems. A small program run might generate files + symlinks like this:</p>\n\n<pre><code>~/.shortcut\n\u251c\u2500\u2500 cache\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 each\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 59e0192b1f\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 2633d268bf.ndb -&gt; ../../../exprs/makeblastdb_nucl/2633d268bf_0.ndb\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 2633d268bf.ndb.args -&gt; ../../../cache/lines/3428ab5186.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 623e07ac5b\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 b9361606af.str.list -&gt; ../../../exprs/extract_queries/b9361606af_0.str.list\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 b9361606af.str.list.args -&gt; ../../../cache/lines/12ae82a598.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 f477cfe47b\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 35e97350d8.bht -&gt; ../../../exprs/blastn/ce1c174684_420e4f7fdf_35e97350d8_0.bht\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 35e97350d8.bht.args -&gt; ../../../cache/lines/9491bbe6a0.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 lines\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 0094e500eb.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 12ae82a598.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 246ddae0d8.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 3428ab5186.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 46767f8ae8.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 5d54256d91.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 61a97fd32d.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 6de4b9ad67.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 778251fd80.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 81f7f42c42.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 91ce94df26.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 9491bbe6a0.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 b575c745e6.txt -&gt; ../../cache/lines/6de4b9ad67.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 f094bac04c.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 fcfb7a47a6.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 load\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 1e7afd22cf.gbk -&gt; /home/jefdaj/shortcut/data/Mycoplasma_bovis_HB0801-P115.gbk\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 28ce925871.gbk -&gt; /home/jefdaj/shortcut/data/Mycoplasma_genitalium_M2321.gbk\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 makeblastdb\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 6de4b9ad67\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 6de4b9ad67.ndb.err\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 6de4b9ad67.ndb.nhr\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 6de4b9ad67.ndb.nin\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 6de4b9ad67.ndb.nsq\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 6de4b9ad67.ndb.out\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 seqio\n\u251c\u2500\u2500 exprs\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 any\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 e5677b1051_0.str.list.list -&gt; ../../cache/lines/91ce94df26.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 blastn\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 ce1c174684_420e4f7fdf_35e97350d8_0.bht -&gt; ../../exprs/blastn/ce1c174684_420e4f7fdf_35e97350d8_0.bht.out\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 ce1c174684_420e4f7fdf_35e97350d8_0.bht.out\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 ce1c174684_420e4f7fdf_35e97350d8_0.bht.out.err\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 blastn_db\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 46e62edec1_420e4f7fdf_9ef76468c4_0.bht -&gt; ../../exprs/blastn_db/46e62edec1_420e4f7fdf_9ef76468c4_0.bht.out\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 46e62edec1_420e4f7fdf_9ef76468c4_0.bht.out\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 46e62edec1_420e4f7fdf_9ef76468c4_0.bht.out.err\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 blastn_each\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 46e62edec1_420e4f7fdf_2943ae4ea3_0.bht.list -&gt; ../../cache/lines/12ae82a598.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 extract_queries\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 53376e198d_0.str.list -&gt; ../../cache/lines/246ddae0d8.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 53376e198d_0.str.list.tmp\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 53376e198d_0.str.list.tmp.err\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 b9361606af_0.str.list -&gt; ../../cache/lines/246ddae0d8.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 b9361606af_0.str.list.tmp\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 b9361606af_0.str.list.tmp.err\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 extract_queries_each\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 d724d35317_0.str.list.list -&gt; ../../cache/lines/91ce94df26.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 gbk_to_fna\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 262cf7e4e4_a355cc10e8_0.fna\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 262cf7e4e4_cdab12f059_0.fna\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 list\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 3bbbf950a3_0.str.list.list -&gt; ../../cache/lines/91ce94df26.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 65127d0127_0.fna.list -&gt; ../../cache/lines/6de4b9ad67.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 df91bd4d94_0.str.list.list.list -&gt; ../../cache/lines/46767f8ae8.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 load_fna\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 load_gbk\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 15e3d91521_0.gbk -&gt; ../../cache/load/28ce925871.gbk\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 74e27ec9a5_0.gbk -&gt; ../../cache/load/1e7afd22cf.gbk\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 makeblastdb_nucl\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 2633d268bf_0.ndb -&gt; ../../cache/lines/81f7f42c42.txt\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 954abc5fe7_0.ndb -&gt; ../../cache/lines/81f7f42c42.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 makeblastdb_nucl_each\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 209fe6406d_0.ndb.list -&gt; ../../cache/lines/5d54256d91.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 num\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 a53b190835_0.num -&gt; ../../cache/lines/778251fd80.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 singletons\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 954abc5fe7_0.fna.list.list -&gt; ../../cache/lines/0094e500eb.txt\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 str\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 90811d06ee_0.str -&gt; ../../cache/lines/f094bac04c.txt\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 b4da62b027_0.str -&gt; ../../cache/lines/fcfb7a47a6.txt\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 b81c880be5_0.str -&gt; ../../cache/lines/61a97fd32d.txt\n\u251c\u2500\u2500 profile.html\n\u2514\u2500\u2500 vars\n    \u251c\u2500\u2500 mapped.str.list.list -&gt; ../exprs/extract_queries_each/d724d35317_0.str.list.list\n    \u251c\u2500\u2500 mbov.fna -&gt; ../exprs/gbk_to_fna/262cf7e4e4_a355cc10e8_0.fna\n    \u251c\u2500\u2500 mgen.fna -&gt; ../exprs/gbk_to_fna/262cf7e4e4_cdab12f059_0.fna\n    \u251c\u2500\u2500 result -&gt; ../exprs/any/e5677b1051_0.str.list.list\n    \u2514\u2500\u2500 single.str.list -&gt; ../exprs/extract_queries/53376e198d_0.str.list\n\n27 directories, 64 files\n</code></pre>\n\n<p>I tried adding <code>shakeShare = Just \"sharedir\"</code> to my Shake options. When I run the build, delete all artifacts, and re-run, it fails to find a cached file:</p>\n\n<pre><code>error! Error when running Shake build system:\n  at want, called at ./ShortCut/Core/Eval.hs:253:7 in main:ShortCut.Core.Eval\n* Depends on: eval\n  at need, called at ./ShortCut/Core/Eval.hs:256:25 in main:ShortCut.Core.Eval\n* Depends on: /root/.shortcut/vars/result\n  at need, called at ./ShortCut/Core/Actions.hs:110:3 in main:ShortCut.Core.Actions\n* Depends on: /root/.shortcut/exprs/all/b2ba759dce_0.str.list\n  at need, called at ./ShortCut/Core/Actions.hs:110:3 in main:ShortCut.Core.Actions\n* Depends on: /root/.shortcut/exprs/any/0a89231af6_0.str.list.list\n  at need, called at ./ShortCut/Core/Actions.hs:110:3 in main:ShortCut.Core.Actions\n* Depends on: /root/.shortcut/exprs/list/df91bd4d94_0.str.list.list.list\n  at need, called at ./ShortCut/Core/Actions.hs:110:3 in main:ShortCut.Core.Actions\n* Depends on: /root/.shortcut/vars/mapped.str.list.list\n  at need, called at ./ShortCut/Core/Actions.hs:110:3 in main:ShortCut.Core.Actions\n* Depends on: /root/.shortcut/exprs/extract_queries_each/730901fdda_0.str.list.list\n  at need, called at ./ShortCut/Core/Actions.hs:110:3 in main:ShortCut.Core.Actions\n* Depends on: /root/.shortcut/exprs/tblastn_each/46e62edec1_183f436b85_a5a22079c6_0.bht.list\n  at need, called at ./ShortCut/Core/Actions.hs:110:3 in main:ShortCut.Core.Actions\n* Depends on: /root/.shortcut/exprs/num/a53b190835_0.num\n* Raised the exception:\n/home/jefdaj/shortcut/sharedir/.shake.cache/2faae061b9976bed/0x134125AC: getPermissions:getFileStatus: does not exist (No such file or directory)\n</code></pre>\n\n<p>That was expected, but now how do I go about fixing it? The hashes should be stable because all symlinks are relative to the top level tmpdir (<code>~/.shortcut</code> here). And Shake should know about each of them since I make sure to call <code>trackWrite</code>.</p>\n\n<p>Do I need to explicitly add all files to a cache using <code>newCache</code>, <code>newCacheIO</code>, and/or an oracle as they're built, or am I missing something simpler?</p>\n\n<p>Ideally I would have a shared directory to cache everything done on <a href=\"http://shortcut.pmb.berkeley.edu\" rel=\"nofollow noreferrer\">the demo server</a>, and also give users the option to connect their own instances to it like a Nix binary cache.</p>\n"}, {"tags": ["haskell", "types", "polymorphism"], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 1, "creation_date": 1575399282, "post_id": 59146312, "comment_id": 104551295, "body": "@schuelermine that&#39;s big enough of a question to be worth a full question here"}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 4, "last_activity_date": 1575391768, "last_edit_date": 1575391768, "creation_date": 1575318997, "answer_id": 59146312, "question_id": 59145861, "link": "https://stackoverflow.com/questions/59145861/why-does-ghc-refuse-to-allow-this-existential-type-function/59146312#59146312", "title": "Why does GHC refuse to allow this existential type function?", "body": "<p>Your data definition hides a monotyped choice of <code>a</code> by packing up a value with the dictionary for <code>f</code>. It's important to recognize that the whole point of that is to throw away the information about the specific type while keeping the instance dictionary associated with that type.</p>\n\n<p>This is incompatible with what you're trying to do in <code>hset</code>. There never is a concrete type to pack up the instance from. The pieces can't fit together that way, because they're both missing the same required thing. <code>Heterotype f</code> and <code>(forall a. f a =&gt; a)</code> both lack a concrete type to choose an instance for, but the <code>Heterotype</code> constructor needs a concrete instance to include. The information just doesn't exist. These pieces are incompatible.</p>\n"}, {"comments": [{"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1575373224, "post_id": 59146480, "comment_id": 104536754, "body": "OK, but Haskell has <code>mempty :: forall a. Monoid a =&gt; a</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1575377259, "post_id": 59146480, "comment_id": 104539021, "body": "@schuelermine I don&#39;t see how that is relevant? Can you elaborate? Your code is using a generic <code>f</code> which may be <code>Monoid</code>, but might also be something else."}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1575399560, "post_id": 59146480, "comment_id": 104551413, "body": "Yes, but if I have a value <code>p :: F a =&gt; a</code>, then I can call <code>newhset p :: Heterotype F</code>. Why can&#39;t I then write a function that only takes such polymorphic values <code>x :: F a =&gt; a</code> and puts them into <code>newhset</code>? I imagine one could define an overly specific version of functions."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 1, "creation_date": 1575399886, "post_id": 59146480, "comment_id": 104551541, "body": "@schuelermine If you want to store your <code>p</code> in a constructor, then you would need <code>data Heterotype f = Heterotype (forall a. f a =&gt; a)</code> which uses universal quantification instead of existential one, where one could define <code>newhset = Heterotype</code>. Your posted version instead uses existential quantification, and that requires <code>F</code> to be satisfied by some type."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1575319879, "creation_date": 1575319879, "answer_id": 59146480, "question_id": 59145861, "link": "https://stackoverflow.com/questions/59145861/why-does-ghc-refuse-to-allow-this-existential-type-function/59146480#59146480", "title": "Why does GHC refuse to allow this existential type function?", "body": "<p>From a logical point of view, your code would correspond to a proof of a logical formula which can be read as follows (rouhgly):</p>\n\n<ul>\n<li>Let <code>f</code> be any property of types;</li>\n<li>Assume that, for any type <code>a</code> satisfying <code>f</code>, we can produce a value <code>x</code> of type <code>a</code>;</li>\n<li>Then, there exists a type <code>a</code>, satisfying <code>f</code>, and having a value <code>x</code>.</li>\n</ul>\n\n<p>This is not logically sound. Indeed, it is possible that <code>f a</code> never holds, no matter what <code>a</code> is. In such case, the assumption above vacuously holds, hence it is true. Yet, the conclusion above contradicts the fact that <code>f a</code> is always false.</p>\n\n<p>As a consequence of this, we can not define your <code>hset</code> with that type.</p>\n\n<p>To make the argument sound, we must add, as an additional hypothesis, that there is some type <code>b</code> which makes the property <code>f</code> true. If we add that hypothesis, we can prove the statement: </p>\n\n<pre><code>-- (untested, but should work)\nhset :: forall b . f b =&gt; (forall a. f a =&gt; a) -&gt; Heterotype f\nhset x = Heterotype (x :: b)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "is_accepted": false, "score": 3, "last_activity_date": 1575326532, "creation_date": 1575326532, "answer_id": 59147715, "question_id": 59145861, "link": "https://stackoverflow.com/questions/59145861/why-does-ghc-refuse-to-allow-this-existential-type-function/59147715#59147715", "title": "Why does GHC refuse to allow this existential type function?", "body": "<p>You're over-specifying a bit :), the following works fine:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Heterotype f = forall a. f a =&gt; Heterotype a\n\nhset :: forall f a. f a =&gt; a -&gt; Heterotype f\nhset x = Heterotype x\n</code></pre>\n\n<p>The difference being that you've quantified your argument: <code>(forall a. f a =&gt; a)</code> which says that this function accepts an expression which must be ANY possible type all at once (the caller can't choose a specific 'a'), which doesn't really make sense. The new version (which consequently is identical to just using the <code>Heterotype</code> constructor on its own) says that the caller is allowed to <em>pick</em> the type of <code>a</code>, which can be anything, but must be exactly ONE type (per call).</p>\n\n<p>It can take a bit of practice to get used to existentials; best way is trial and error :)</p>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 59146480, "answer_count": 3, "score": 5, "last_activity_date": 1575391768, "creation_date": 1575316830, "question_id": 59145861, "link": "https://stackoverflow.com/questions/59145861/why-does-ghc-refuse-to-allow-this-existential-type-function", "title": "Why does GHC refuse to allow this existential type function?", "body": "<p>I have defined a general <em>heterogenous</em>, as I call it (I don't know if that's correct), type:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Heterotype f = forall a. f a =&gt; Heterotype a\n</code></pre>\n\n<p>I then decided to make a function that allows you to create heterotypes from polymorphic values:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>hset :: (forall a. f a =&gt; a) -&gt; Heterotype f\nhset x = Heterotype x\n</code></pre>\n\n<p>However, GHC complains with the following:</p>\n\n<pre><code>\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.hs:15:10: error:\n    * Could not deduce: f a0 arising from a use of `Heterotype'\n    * In the expression: Heterotype x\n      In an equation for `hset': hset x = Heterotype x\n    * Relevant bindings include\n        x :: forall a. f a =&gt; a\n          (bound at \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.hs:15:6)\n        hset :: (forall a. f a =&gt; a) -&gt; Heterotype f\n          (bound at \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.hs:15:1)\n   |\n15 | hset x = Heterotype x\n   |          ^^^^^^^^^^^^\n</code></pre>\n\n<p><em>EDIT</em>: The following extensions are enabled:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE GADTs, ScopedTypeVariables #-}\n{-# LANGUAGE NoStarIsType, ConstraintKinds #-}\n{-# LANGUAGE AllowAmbiguousTypes, RankNTypes #-}\nimport Data.Kind\n</code></pre>\n"}, {"tags": ["haskell", "generics", "functional-programming", "recursive-datastructures", "gadt"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1575311877, "post_id": 59144773, "comment_id": 104515752, "body": "Could you perhaps describe what you are trying to achieve with this function? There are multiple type errors in the definition (as GHC told you), and in particular the type signature is incredibly (probably impossibly) general, as it says you can get <i>any</i> type whatsoever out of this function. That in itself definitely isn&#39;t true of your definition."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1575312008, "post_id": 59144773, "comment_id": 104515804, "body": "On second glance, a type signature of <code>Rdd a -&gt; [a]</code> is probably what you want - but there is definitely something wrong with the <code>Cartesian</code> constructor. I would assume you want that to have type <code>Rdd a -&gt; Rdd b -&gt; Rdd (a,b)</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1575312043, "post_id": 59144773, "comment_id": 104515823, "body": "<code>Cartesian :: (Rdd a) -&gt; (Rdd a) -&gt; (Rdd b)</code> looks quite wrong, it states that the result type is completely unrelated to the arguments type (apart from <code>Rdd</code>). Surely that&#39;s a typo?"}, {"owner": {"reputation": 1899, "user_id": 7058363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zppXn.jpg?s=128&g=1", "display_name": "Genarito", "link": "https://stackoverflow.com/users/7058363/genarito"}, "edited": false, "score": 1, "creation_date": 1575313381, "post_id": 59144773, "comment_id": 104516340, "body": "What a shame... I&#39;ve edited the question with more information about the problem. But changing <i>Cartesian</i> type to <code>(Rdd a) -&gt; (Rdd a) -&gt; (Rdd (a, a))</code> and the <code>totalEvaluate</code> function&#39;s type to <code>Rdd a -&gt; [a]</code> make it works. Thank you so much and sorry for the time lost"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1575346152, "post_id": 59144773, "comment_id": 104525464, "body": "@Genarito, I suspect it will also work with the more general type <code>Cartesian :: Rdd a -&gt; Rdd b -&gt; Rdd (a,b)</code>, which allows the data from each multiplicand to be of different types."}, {"owner": {"reputation": 1899, "user_id": 7058363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zppXn.jpg?s=128&g=1", "display_name": "Genarito", "link": "https://stackoverflow.com/users/7058363/genarito"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1575373495, "post_id": 59144773, "comment_id": 104536887, "body": "Thank you so much @luqui. I&#39;ve edited the code and It worked. If any of you wants to write an answer to close the question I&#39;ll mark It as the correct one. Otherwise I&#39;ll submit an answer with your corrections later"}], "owner": {"reputation": 1899, "user_id": 7058363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zppXn.jpg?s=128&g=1", "display_name": "Genarito", "link": "https://stackoverflow.com/users/7058363/genarito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1575373652, "creation_date": 1575311423, "last_edit_date": 1575373652, "question_id": 59144773, "link": "https://stackoverflow.com/questions/59144773/gadts-in-haskell-with-map-and-filter-functions", "title": "GADTs in Haskell with map and filter functions", "body": "<p>I'm working with Algebraic DataType in Haskell. I would like to define a recursive structure with functions that could modify the type of the data. Y read about <em>GADTs</em> and I think It could help me with the problem, but I'm stuck.</p>\n\n<p>I'm designin an execution graph where every \"Node\" of execution (what I call \"Rdd\") is a function applied to a specific data. So, I can have only data (<em>PlainData</em>), a map function (<em>Map</em>) to apply to the data, a Cartesian Product (<em>Cartesian</em>) between two Rdd or a <em>Filter</em>. Its logic is like a pipe where I can define the data, and apply one or more adjacent operations.</p>\n\n<p>I have the following code:</p>\n\n<pre><code>data Rdd a where\n    PlainData :: [a] -&gt; Rdd a\n    Map :: (a -&gt; b) -&gt; (Rdd a) -&gt; (Rdd b)\n    Cartesian :: (Rdd a) -&gt; (Rdd a) -&gt; (Rdd b)\n    Filter :: (a -&gt; Bool) -&gt; (Rdd a) -&gt; (Rdd a)\n\ntotalEvaluate :: Rdd a -&gt; b\ntotalEvaluate (PlainData xs) = xs -- [a]\ntotalEvaluate (Map f e1) = map f (totalEvaluate e1) -- Rdd b\ntotalEvaluate (Filter f e1) = filter f (totalEvaluate e1) -- Rdd a\ntotalEvaluate (Cartesian e1 e2) = [(x, y) | x &lt;- (totalEvaluate e1), y &lt;- (totalEvaluate e2)] -- A tuple with all combinations\n</code></pre>\n\n<p>It's throwing type errors. I would like to be able to execute functions like this one:</p>\n\n<pre><code>totalEvaluate (Map (\\x -&gt; x + 1) (PlainData [1, 2, 3])) -- [2, 3, 4] It does not change the type\ntotalEvaluate (Map (\\x -&gt; x &lt; 2) (PlainData [1, 2, 3])) -- [True, False, False] It changes the type\ntotalEvaluate (Cartesian (PlainData [1, 2]) (PlainData[3, 4, 5])) -- [(1, 3), (1, 4), (1, 5), (2, 3), (2, 4), (2, 5)] It changes the type\ntotalEvaluate (Filter (\\(x, y) -&gt; (y - x) == 2) (Cartesian (PlainData [1, 2]) (PlainData[3, 4, 5]))) -- [(1, 3), (2, 4)] It changes the type\n</code></pre>\n\n<p>I'm following the <a href=\"https://en.wikibooks.org/wiki/Haskell/GADT\" rel=\"nofollow noreferrer\">Haskell's wiki</a> but It's not working as It's throwing types error like:</p>\n\n<blockquote>\n  <p>Couldn't match expected type \u2018b\u2019 with actual type \u2018[(a0, b0)]\u2019</p>\n</blockquote>\n\n<p>I'm running the example with:</p>\n\n<pre><code>ghci\n:l \"example.hs\"\n</code></pre>\n\n<p>Thanks in advance and sorry about my English</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 7, "last_activity_date": 1575309190, "creation_date": 1575309190, "answer_id": 59144269, "question_id": 59144172, "link": "https://stackoverflow.com/questions/59144172/case-why-am-i-getting-illegal-lambda-expression/59144269#59144269", "title": "Case - why am i getting illegal lambda expression", "body": "<p>The syntax <code>\\case</code> isn't in the Haskell Report, so it isn't allowed in standard Haskell. To use it, you have to enable the <code>LambdaCase</code> extension. There are several different ways you can do so, including:</p>\n\n<ol>\n<li>Put <code>-XLambdaCase</code> on the command line</li>\n<li>Put <code>{-# LANGUAGE LambdaCase #-}</code> at the top of the file</li>\n<li>Run <code>:set -XLambdaCase</code> at the GHCi prompt</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 12460876, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CZbaMEQekIg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3repGImGkN-msAqbVCDW5a8pLWYY6w/photo.jpg?sz=128", "display_name": "Dieter Wick", "link": "https://stackoverflow.com/users/12460876/dieter-wick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1575315597, "creation_date": 1575308794, "question_id": 59144172, "link": "https://stackoverflow.com/questions/59144172/case-why-am-i-getting-illegal-lambda-expression", "title": "Case - why am i getting illegal lambda expression", "body": "<pre><code> data Nat = Zero | Succ Nat \n data NatSig val = NatSig {zero_ :: val, succ :: val -&gt; val}\n\nfoldNat :: NatSig val -&gt; Nat -&gt; val\n\nfoldNat alg = \\case Zero -&gt; zero_ alg \n                    Succ n -&gt; succ alg $ foldNat alg sn\n</code></pre>\n\n<p>Hello this is a code from my University but if i want to run it i get an error </p>\n\n<pre><code>Illegal lambda-case (use -XLambdaCase)\n</code></pre>\n\n<p>some\none know why?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 1, "creation_date": 1575284436, "post_id": 59137368, "comment_id": 104502032, "body": "Start with a simpler data type and work your way up to a more complex type."}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 5, "creation_date": 1575284559, "post_id": 59137368, "comment_id": 104502124, "body": "What happens in <code>Variable &quot;&quot; 1 1 == Numeric 1</code>? What happens in <code>name (Numeric 1)</code>?"}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 5, "creation_date": 1575284648, "post_id": 59137368, "comment_id": 104502177, "body": "People usually recommend not mixing Sum and Record types, see for example: <a href=\"https://stackoverflow.com/questions/37652243/record-syntax-and-sum-types\" title=\"record syntax and sum types\">stackoverflow.com/questions/37652243/&hellip;</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1575294535, "post_id": 59137368, "comment_id": 104507265, "body": "What does &quot;simultaneously&quot; mean here? What&#39;s wrong with the instance generated by <code>deriving (Show, Eq)</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 285, "user_id": 3653363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a8838771b657f70001cb3ba9a586fd?s=128&d=identicon&r=PG&f=1", "display_name": "Gabscap", "link": "https://stackoverflow.com/users/3653363/gabscap"}, "is_accepted": false, "score": 3, "last_activity_date": 1575295447, "creation_date": 1575295447, "answer_id": 59140522, "question_id": 59137368, "link": "https://stackoverflow.com/questions/59137368/instance-eq-for-data-type-with-several-sub-fields/59140522#59140522", "title": "Instance Eq for data type with several sub-fields", "body": "<p>Use pattern matching in your <code>==</code> definition</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Eq Expression where\n    Variable a b c == Variable a' b' c = a == a' &amp;&amp; b == b' &amp;&amp; c == c'\n    -- other 2 cases\n    _ == _ = False\n</code></pre>\n\n<p>Or just use <code>deriving Eq</code> as already pointed out in the comments.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1575295555, "creation_date": 1575295555, "answer_id": 59140562, "question_id": 59137368, "link": "https://stackoverflow.com/questions/59137368/instance-eq-for-data-type-with-several-sub-fields/59140562#59140562", "title": "Instance Eq for data type with several sub-fields", "body": "<p>For comparing two <code>Variable</code> values, you just need to combine the two field comparisons with <code>&amp;&amp;</code>.</p>\n\n<pre><code>instance Eq Expression where\n    someone == another = name someone == name another &amp;&amp; exponentVal someone == exponentVal another\n</code></pre>\n\n<p>However, this ignores the possibility that either argument might not <em>be</em> a <code>Variable</code>. You should use pattern matching.</p>\n\n<pre><code>instance Eq Expression where\n    Variable n1 _ v1 == Variable n2 _ v2 = n1 == n2 &amp;&amp; v1 == v2\n    Number n1 == Number n2 = n1 == n2\n    CanonicalForm es1 == CanonicalForm es2 = ...  -- appropriate definition here\n    _ == _ = False\n</code></pre>\n\n<p>In the above, I've assumed that if the data constructors don't match, the expressions are not equal.</p>\n"}], "owner": {"reputation": 43, "user_id": 8185086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67159d6a04157a0a8f572a8a4e27d378?s=128&d=identicon&r=PG&f=1", "display_name": "Lazare Rossillon", "link": "https://stackoverflow.com/users/8185086/lazare-rossillon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1575935912, "creation_date": 1575283853, "question_id": 59137368, "link": "https://stackoverflow.com/questions/59137368/instance-eq-for-data-type-with-several-sub-fields", "title": "Instance Eq for data type with several sub-fields", "body": "<p>I have a data type with several sub-fields and would like to implement the <code>instance Eq</code> class <em>simultaneously</em>.</p>\n\n<p>The code is the following :</p>\n\n<pre><code>data Expression \n                = Variable  {\n                            name            ::  String,\n                            number          ::  Double,\n                            exponentVal     ::  Double \n                            }\n                |   Numeric Double\n                |   CanonicalForm [Expression]\n    deriving Show \n\ninstance Eq Expression where\n    someone == another = name someone == name another\n    someone == another = exponentVal someone == exponentVal another\n</code></pre>\n\n<p>How could I modify the <code>instance Eq</code> class so that when I compare two variables the comparison evaluates both the <code>name</code> field and the <code>exponentVal</code> field ?</p>\n"}, {"tags": ["haskell", "semigroup"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1575303105, "post_id": 59133631, "comment_id": 104511869, "body": "&quot;Big list&quot; questions are typically considered off-topic here, because it&#39;s almost impossible to write an answer that is both complete and future-proof. I know that&#39;s not your goal, but... it <i>is</i> part of the site&#39;s stated goals, and the way it maintains the property that answers live forever is by banning questions that can&#39;t be answered in such a way. There may be other fora that welcome this question in the spirit it was intended; I encourage you to seek them out."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1575318609, "last_edit_date": 1575318609, "creation_date": 1575271460, "answer_id": 59134298, "question_id": 59133631, "link": "https://stackoverflow.com/questions/59133631/join-semilattice-examples-amongst-semigroup-instances-in-haskell/59134298#59134298", "title": "Join semilattice examples amongst semigroup instances in Haskell", "body": "<p>Ordered strictly increasing lists of wholly compared elements (where equality implies sameness) seem to form join semilattice under <a href=\"http://hackage.haskell.org/package/data-ordlist-0.4.7.0/docs/Data-List-Ordered.html#v:union\" rel=\"nofollow noreferrer\"><code>Data.List.Ordered.union</code></a> from <code>data-ordlist</code> package.</p>\n"}, {"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1575314999, "creation_date": 1575314999, "answer_id": 59145507, "question_id": 59133631, "link": "https://stackoverflow.com/questions/59133631/join-semilattice-examples-amongst-semigroup-instances-in-haskell/59145507#59145507", "title": "Join semilattice examples amongst semigroup instances in Haskell", "body": "<p><a href=\"http://hackage.haskell.org/package/containers-0.6.2.1/docs/Data-IntSet.html#t:IntSet\" rel=\"nofollow noreferrer\"><code>Data.IntSet.IntSet</code></a> has the set union operation as its <code>&lt;&gt;</code>, which seems to meet your criteria. This may be true for other sets too, as long as you're okay with pathological <code>Eq</code> instances for their elements breaking it.</p>\n\n<p>This is also true for <code>Proxy</code>, but that's about as far from useful as you can get.</p>\n"}], "owner": {"reputation": 145, "user_id": 5255089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb99414b7f1cbc6d5a1dc99d217c6125?s=128&d=identicon&r=PG", "display_name": "Eryk Ciepiela", "link": "https://stackoverflow.com/users/5255089/eryk-ciepiela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "closed_date": 1575344196, "answer_count": 2, "score": 2, "last_activity_date": 1575318609, "creation_date": 1575267851, "question_id": 59133631, "link": "https://stackoverflow.com/questions/59133631/join-semilattice-examples-amongst-semigroup-instances-in-haskell", "closed_reason": "Not suitable for this site", "title": "Join semilattice examples amongst semigroup instances in Haskell", "body": "<p>I am collecting examples of join semilattices amongst <code>Semigroup</code> instances. As you may know join semilattice is similar to semigroup but requires additionally commutativity and idempotence. From the quick scan of the libraries on hackage I found the following examples:</p>\n\n<ul>\n<li><code>Data.Semigroup.Max</code> </li>\n<li><code>Data.Semigroup.All</code> </li>\n<li><code>Data.Semigroup.Any</code></li>\n<li><code>Data.Map.Append.AppendMap</code></li>\n</ul>\n\n<p>I'm curious whether you came across any other (interesting and useful) join semilattices examples in Haskell libraries?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1575268941, "post_id": 59133190, "comment_id": 104495299, "body": "How would you use <code>example</code> to update <code>n</code>? <code>n</code> is an <code>Int</code>, but <code>example</code> returns a <code>G</code> value. You can&#39;t bind a <code>G</code> value to an <code>Int</code> variable."}, {"owner": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1575269434, "post_id": 59133190, "comment_id": 104495456, "body": "Is there no way to solve this? Not even by using some helper function?"}, {"owner": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1575269568, "post_id": 59133190, "comment_id": 104495489, "body": "I need to first evaluate recursively (example n i1), and then evaluate (example n i2) with n from the end result of the first recursion."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1575269915, "post_id": 59133190, "comment_id": 104495594, "body": "How do you propose to translate <code>G</code> into <code>Int</code>? It can be done, but there&#39;s several ways, and no unambiguously correct way."}, {"owner": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1575270101, "post_id": 59133190, "comment_id": 104495661, "body": "I do not wish to change my data type for G, that is my only restriction. Would you be able to write me an example using any of the potential methods that achieves what I need? Again, thanks for your help and time."}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 1, "creation_date": 1575273837, "post_id": 59133190, "comment_id": 104496982, "body": "<i>&quot;I wish for (example n i1) to evaluate first and update the variable n.&quot;</i> What value should be used for <code>n</code> &quot;after&quot; <code>(example n i1)</code>?"}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 1, "creation_date": 1575274088, "post_id": 59133190, "comment_id": 104497068, "body": "While <code>example n (F i1 i2) = F (example n i1) i2</code> seems to match your test case. It is not clear at all, what you want. Your question is missing a specification."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1575277334, "post_id": 59133190, "comment_id": 104498421, "body": "Write a helper <code>exampleH :: Int -&gt; G -&gt; (G, Int)</code> taking <code>n</code> as input and returning the &quot;updated&quot; <code>n</code> as output in the returned pair."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1575300959, "post_id": 59133190, "comment_id": 104510748, "body": "What should <code>example 2 (F (H 1) (H 2))</code> return?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "edited": false, "score": 0, "creation_date": 1575271958, "post_id": 59134297, "comment_id": 104496302, "body": "Firstly, thank you so much for spending your time helping me. However, I do not quite understand that solution, or how I may use it / a variant of it to achieve my desired effect."}, {"owner": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "edited": false, "score": 0, "creation_date": 1575272174, "post_id": 59134297, "comment_id": 104496371, "body": "My functional programming experience is very limited. However in other languages, one could pass the same pointer for n to achieve my desired solution."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "edited": false, "score": 0, "creation_date": 1575272200, "post_id": 59134297, "comment_id": 104496378, "body": "@Haskell_Adventurer When you call <code>example n i1</code> it produces a <code>G</code> value. Use a <code>G -&gt; Int</code> function to evaluate that <code>G</code> to an <code>Int</code>. The resulting <code>Int</code> is your <code>n1</code>. Now invoke <code>example n1 i2</code>."}, {"owner": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "edited": false, "score": 0, "creation_date": 1575273072, "post_id": 59134297, "comment_id": 104496702, "body": "I think I get it now. So we pass the output of <code>example n i1</code> into some function of type <code>G -&gt; Int</code> that produces an <code>Int</code>, say n1, which we then use for <code>example n1 i2</code>. But wouldn&#39;t this mean having to recurse <code>example n i</code> twice? And by twice I mean once for when we calculate <code>example n i1</code> and once for when we use it to calculate the <code>Int</code>."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "edited": false, "score": 0, "creation_date": 1575274175, "post_id": 59134297, "comment_id": 104497088, "body": "@Haskell_Adventurer No, but you may need a <code>let</code> binding. <a href=\"http://learnyouahaskell.com/syntax-in-functions\" rel=\"nofollow noreferrer\">learnyouahaskell.com/syntax-in-functions</a>"}, {"owner": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "edited": false, "score": 0, "creation_date": 1575274709, "post_id": 59134297, "comment_id": 104497290, "body": "The thing that confuses me the most about this problem is that it is recursive but it does not have a definite base case because of line 5. Is there anything that I could read on recursive functions that use recursion twice like in the example above, similar to line 5, that being <code>example n (F i1 i2) = F (example n i1)(example n i2)</code> ?"}, {"owner": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "edited": false, "score": 0, "creation_date": 1575274867, "post_id": 59134297, "comment_id": 104497346, "body": "Like with a more &quot;normal&quot; recursive problem we know that when a base case is reached, a value is returned. However for this problem when a base case is reached it does not necessarily mean that the overall recursion is over and a value may be returned later."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "edited": false, "score": 0, "creation_date": 1575276921, "post_id": 59134297, "comment_id": 104498224, "body": "@Haskell_Adventurer The way that you&#39;ve written the function <code>example 0 (H i)</code> is a base case."}, {"owner": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "edited": false, "score": 0, "creation_date": 1575277323, "post_id": 59134297, "comment_id": 104498416, "body": "Actually, as the output of the examples I&#39;ve given suggests, the function does not return a value exactly when a base case is met. We have to wait for all subrecursions to end. And that I find very confusing and difficult to work with."}, {"owner": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "edited": false, "score": 0, "creation_date": 1575315250, "post_id": 59134297, "comment_id": 104517083, "body": "Thanks to your idea and support, I was able to solve my problem (a more complex variant of the example given). Thank you so much."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 1, "last_activity_date": 1575271455, "creation_date": 1575271455, "answer_id": 59134297, "question_id": 59133190, "link": "https://stackoverflow.com/questions/59133190/haskell-evaluation/59134297#59134297", "title": "Haskell Evaluation", "body": "<p>The problem seems to be that you want to use <code>example</code> to 'update' <code>n</code>. You can't directly do that, however, since <code>example</code> returns a <code>G</code> value, and <code>n</code> is an <code>Int</code>.</p>\n\n<p>It seems, then, that you need a function <code>G -&gt; Int</code>. The issue is that there's no unambiguously correct way to write that function. In fact, there's infinitely many possible implementations. Here's a sample:</p>\n\n<pre><code>evalZero :: G -&gt; Int\nevalZero = const 0\n\nevalOne :: G -&gt; Int\nevalOne = const 1\n\nevalLeft :: G -&gt; Int\nevalLeft (H i) = i\nevalLeft (F g _) = evalLeft g\n\nevalRight :: G -&gt; Int\nevalRight (H i) = i\nevalRight (F _ g) = evalRight g\n\nevalSum :: G -&gt; Int\nevalSum (H i) = i\nevalSum (F g1 g2) = evalSum g1 + evalSum g2\n\nevalProduct :: G -&gt; Int\nevalProduct (H i) = i\nevalProduct (F g1 g2) = evalProduct g1 * evalProduct g2\n\nevalPlusOneProduct :: G -&gt; Int\nevalPlusOneProduct (H i) = i + 1\nevalPlusOneProduct (F g1 g2) = evalPlusOneProduct g1 * evalPlusOneProduct g2\n\n-- etc.\n</code></pre>\n\n<p>As <code>evalPlusOneProduct</code> illustrates, you can arbitrarily add or subtract a constant <code>Int</code>, or, for that matter, multiply by a constant, or perform more complex arbitrary calculations. Since there's infinitely many integers, there's infinitely many implementations (although, granted, technically, we're constrained by the range of <code>Int</code>).</p>\n\n<p>Once you've figured out how to transform <code>G</code> into <code>Int</code>, you can use that function to calculate a new value <code>n1</code> from <code>n</code> and the left <code>G</code> value.</p>\n"}], "owner": {"reputation": 21, "user_id": 12466503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92b048ef4159ad933cf71f37be242a0?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell_Adventurer", "link": "https://stackoverflow.com/users/12466503/haskell-adventurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 59134297, "answer_count": 1, "score": 1, "last_activity_date": 1575271512, "creation_date": 1575265019, "last_edit_date": 1575271512, "question_id": 59133190, "link": "https://stackoverflow.com/questions/59133190/haskell-evaluation", "title": "Haskell Evaluation", "body": "<p>I have the following block of code:</p>\n\n<pre><code>data G = F G G | H Int deriving (Show, Eq)\n\nexample :: Int -&gt; G -&gt; G\nexample 0 (H i) = (H i)\nexample n (H i) = F (example (n-1) (H i)) (example (n-1) (H i))\nexample n (F i1 i2) = F (example n i1) (example n i2)\n</code></pre>\n\n<p>When I run <code>example 0 (F (H 1) (H 2))</code> , as expected it returns <code>F (H 1) (H 2)</code></p>\n\n<p>When I run <code>example 1 (F (H 1) (H 2))</code> , it returns <code>F (F (H 1) (H 1)) (F (H 2) (H 2))</code></p>\n\n<p>This is not what I want. I need to return <code>F (F (H 1) (H 1)) (H 2)</code></p>\n\n<p>What I mean is on the 6th line, <code>example n (F i1 i2) = F (example n i1) (example n i2)</code> , I call the recursive function twice. However I wish for <code>(example n i1)</code> to evaluate first and update the variable <code>n</code> before we evaluate <code>(example n i2)</code></p>\n\n<p>Any help/solutions to this exact problem will be greatly appreciated. I have been trying for hours with zero success.</p>\n"}, {"tags": ["haskell", "functional-programming", "xml-serialization", "typeclass", "abstract-data-type"], "answers": [{"comments": [{"owner": {"reputation": 415, "user_id": 7330813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0294fe5f7d94f3b03e97f4153e4c373f?s=128&d=identicon&r=PG", "display_name": "Kaan E.", "link": "https://stackoverflow.com/users/7330813/kaan-e"}, "edited": false, "score": 0, "creation_date": 1575305979, "post_id": 59135422, "comment_id": 104513293, "body": "I actually tried this before posting the question in here, but received <code>data constructor not in scope error</code>. Then I just assumed it is not possible to export data constructors. Once I learned how to do that properly this solution worked fine."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 0, "last_activity_date": 1575277004, "creation_date": 1575277004, "answer_id": 59135422, "question_id": 59132599, "link": "https://stackoverflow.com/questions/59132599/haskell-rendering-adt-as-xml-design-problem/59135422#59135422", "title": "Haskell rendering adt as xml design problem", "body": "<p>I think you can use pattern matching for that. Something like</p>\n\n<pre><code>instance ModelRenderer ContainerData where\n    makeElement (NestedCons cm) = makeElement cm\n    makeElement (SimpleCons um) = makeElement um\n</code></pre>\n\n<p>You can adapt this to the full <code>ContainerModel</code>, adding the tags you wish.</p>\n"}], "owner": {"reputation": 415, "user_id": 7330813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0294fe5f7d94f3b03e97f4153e4c373f?s=128&d=identicon&r=PG", "display_name": "Kaan E.", "link": "https://stackoverflow.com/users/7330813/kaan-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 59135422, "answer_count": 1, "score": 0, "last_activity_date": 1575277004, "creation_date": 1575260309, "question_id": 59132599, "link": "https://stackoverflow.com/questions/59132599/haskell-rendering-adt-as-xml-design-problem", "title": "Haskell rendering adt as xml design problem", "body": "<p>I am a beginner at haskell, and I hit a wall during a toy project. I am simply trying to model a unit and a container which can units and containers as members. I want to serialize the unit and the container as xml maybe other formats afterwards. \nHere is what I have so far</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module Model where\nimport           Data.Map                       ( Map )  -- importing type\nimport           Data.Text                      ( Text )\n\ndata ModelInfo = InfoCons {\n                    modelId :: Text, modelType :: Text,\n                    modelAttrs :: Map Text Text\n                } deriving (Show, Eq)\n\ndata UnitModel = UnitCons { unitInfo :: ModelInfo, unitData :: Text} deriving (Show, Eq)\n\ndata ContainerModel = ContainerCons {  containerInfo :: ModelInfo\n                       , containerData :: [ContainerData]} deriving (Show, Eq)\n\n\ndata ContainerData = NestedCons ContainerModel\n                    | SimpleCons UnitModel\n                     deriving (Show, Eq)\n</code></pre>\n\n<p>These are my models. They are mostly inspired from <a href=\"https://www.yesodweb.com/book/xml\" rel=\"nofollow noreferrer\">here</a>.\nHere are my rendering functions:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\nclass ModelRenderer model where\n    -- function definition\n    addIdType2Props :: (model -&gt; ModelInfo) -&gt; model -&gt; Map Txt.Text Txt.Text\n    addIdType2Props f mdl = add2Map\n        (modelAttrs (f mdl))\n        [(Txt.pack \"id\", modelId (f mdl)),\n         (Txt.pack \"type\", modelType (f mdl))]\n\n    makeElement :: model -&gt; Xml.Element\n\n\n-- transform unit model to xml\n\ninstance ModelRenderer UnitModel where\n    makeElement um = Xml.Element\n        { Xml.elementName       = makeName (Txt.pack \"unit\")\n        , Xml.elementAttributes = convertTxt2NameMap\n                                      (addIdType2Props unitInfo um)\n        , Xml.elementNodes      = [Xml.NodeContent (unitData um)]\n        }\n\n\n-- transform container model to xml\ninstance ModelRenderer ContainerModel where\n    makeElement cm = Xml.Element\n        { Xml.elementName       = makeName (Txt.pack \"container\")\n        , Xml.elementAttributes = convertTxt2NameMap\n                                      (addIdType2Props containerInfo cm)\n        , Xml.elementNodes      = map (Xml.NodeElement . makeElement)\n                                      (containerData cm)\n        }\n</code></pre>\n\n<p>The problem is I can't figure out how to render <code>ContainerData</code> with my current knowledge on haskell. I want to typecheck the value that constructs the <code>ContainerData</code> but I know that it is not the haskell way. Any suggestions ?</p>\n"}, {"tags": ["haskell", "yesod", "shakespeare-text"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1575254727, "post_id": 59131483, "comment_id": 104491967, "body": "Have a look at the <a href=\"https://www.yesodweb.com/book/shakespearean-templates\" rel=\"nofollow noreferrer\">documentation for Hamlet</a>. It should answer your question."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 3, "last_activity_date": 1575266301, "creation_date": 1575266301, "answer_id": 59133387, "question_id": 59131483, "link": "https://stackoverflow.com/questions/59131483/what-is-the-meaning-of-in-hamlet-files/59133387#59133387", "title": "What is the meaning of ^{...} in &quot;.hamlet&quot; files", "body": "<p>That example you have been linked might be slightly confusing because you don't see the <code>copyright</code> function anywhere. <code>copyright</code> is just another function. You can use the <code>^{..}</code> function to embed another widget within one. This example might help you:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-13.19 script\n\n{-# LANGUAGE QuasiQuotes #-}\n\nimport Text.Blaze.Html\nimport Text.Blaze.Html.Renderer.Text (renderHtml)\nimport Text.Hamlet\n\nhello ::  Html\nhello = [shamlet|\n&lt;body&gt;\n    &lt;p&gt;Hello world\n    ^{copyRight}\n|]\n\ncopyRight :: Html\ncopyRight = [shamlet|\n&lt;p&gt;Copyright by the SPJ\n|]\n\nmain :: IO ()\nmain = do\n  let txt = renderHtml hello\n  print txt\n</code></pre>\n\n<p>And on executing it:</p>\n\n<pre><code>$ stack hamlet.hs\n\"&lt;body&gt;&lt;p&gt;Hello world&lt;/p&gt;\\n&lt;p&gt;Copyright by the SPJ&lt;/p&gt;\\n&lt;/body&gt;\\n\"\n</code></pre>\n\n<p>I would recommend you to go through the <a href=\"https://www.yesodweb.com/book/widgets\" rel=\"nofollow noreferrer\">widgets chapter</a> to get a better understanding of this.</p>\n"}], "owner": {"reputation": 81, "user_id": 11042609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2139b66b36b8cb251ef2e3f5d5daf4f?s=128&d=identicon&r=PG&f=1", "display_name": "chrometic", "link": "https://stackoverflow.com/users/11042609/chrometic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575266301, "creation_date": 1575249093, "question_id": 59131483, "link": "https://stackoverflow.com/questions/59131483/what-is-the-meaning-of-in-hamlet-files", "title": "What is the meaning of ^{...} in &quot;.hamlet&quot; files", "body": "<p>In this \".hamlet\" code I would like to know what is the meaning of <code>^{copyright}</code> line</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>$doctype 5\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;#{pageTitle} - My Site\n        &lt;link rel=stylesheet href=@{Stylesheet}&gt;\n    &lt;body&gt;\n        &lt;h1 .page-title&gt;#{pageTitle}\n        &lt;p&gt;Here is a list of your friends:\n        $if null friends\n            &lt;p&gt;Sorry, I lied, you don't have any friends.\n        $else\n            &lt;ul&gt;\n                $forall Friend name age &lt;- friends\n                    &lt;li&gt;#{name} (#{age} years old)\n        &lt;footer&gt;^{copyright}\n</code></pre>\n"}, {"tags": ["haskell", "lazy-evaluation"], "answers": [{"comments": [{"owner": {"reputation": 1119, "user_id": 11714860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6Xo3.png?s=128&g=1", "display_name": "Sapphire_Brick", "link": "https://stackoverflow.com/users/11714860/sapphire-brick"}, "edited": false, "score": 0, "creation_date": 1575251903, "post_id": 59131497, "comment_id": 104491486, "body": "Ohhhhh. My dad was said something like that: &quot; suppose you have <code>a &amp;&amp; b</code> where <code>a</code> is <code>false</code>, <code>b</code> doesn&#39;t get evaluated. Haskell does that more than most programming languages&quot;, I just didn&#39;t get what he meant. ;-)"}, {"owner": {"reputation": 1119, "user_id": 11714860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6Xo3.png?s=128&g=1", "display_name": "Sapphire_Brick", "link": "https://stackoverflow.com/users/11714860/sapphire-brick"}, "edited": false, "score": 0, "creation_date": 1575252186, "post_id": 59131497, "comment_id": 104491534, "body": "also, I didn&#39;t need to declare &quot;<code>unobtanium</code>&quot;."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 9, "last_activity_date": 1575249243, "creation_date": 1575249243, "answer_id": 59131497, "question_id": 59131342, "link": "https://stackoverflow.com/questions/59131342/how-does-haskell-have-late-evaluation/59131497#59131497", "title": "How does Haskell have late evaluation?", "body": "<p>First some important general information to keep in mind:</p>\n\n<p><strong>Haskell variables are <em>immutable</em>.</strong><br>\nAlways, without exception, and there is nothing you can do about it.</p>\n\n<p>So when you're writing something like <code>let y = 5</code>, it does <em>never</em> change the value of some already existing variable. Rather, it introduces a new variable called <code>y</code> and gives it the desired value. Whether somewhere else in your program there's also a variable you happen to have called <code>y</code> is irrelevant, that's a <em>different</em> variable altogether. In fact, consider this:</p>\n\n<pre><code>main :: IO ()\nmain = do\n   let y = 1\n   do let y = 2\n      print y\n   print y\n</code></pre>\n\n<p>The output is</p>\n\n<pre><code>2\n1\n</code></pre>\n\n<p>In your example, the <code>let y = 5</code> statement has no effect at all and will most likely just be thrown away by the compiler altogether. In fact, if you compile with <code>-Wall</code> (as you should), GHC will tell you that:</p>\n\n<pre><code>/tmp/wtmpf-file30239.hs:4:7: warning: [-Wunused-local-binds]\n    Defined but not used: \u2018y\u2019\n  |\n4 |   let y = 5\n  |       ^\n</code></pre>\n\n<p>So in particular, the <code>y == 8</code> check cannot possibly be affected by any <code>let y =</code> statement you could use.</p>\n\n<p>In fact more generally, lazy evaluation doesn't affect values. That's one of the great things about having a purely functional language: because everything is constant, lazy evaluation generally doesn't affect the value semantics, it only affects the order in which the same work is done \u2013 which <em>can</em> affect how fast something terminates (or whether it terminates at all), but not what value it produces when it's done. It doesn't matter whether <code>y == 8</code> is evaluated before or after the runtime enters the <code>test</code> function, and in fact the Haskell standard doesn't tell anything about it \u2013 all it tells is that if <code>test</code> ends up <em>not even using</em> the argument value then a nonterminating argument shall not prevent <code>test</code> from terminating (<em>non-strict semantics</em>). So, the following demonstrates lazy evaluation in action:</p>\n\n<pre><code>unobtanium :: Bool\nunobtanium = unobtanium -- infinite loop\n\ndon'tTest :: Bool -&gt; IO ()\ndon'tTest a = do\n   putStrLn \"Meh, I'm too lazy to do it.\"\n\nmain :: IO ()\nmain = do\n   let y = unobtanium\n   don'tTest y\n</code></pre>\n\n<p>...even though <code>y</code> cannot possibly be evaluated.</p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1575323254, "last_edit_date": 1575323254, "creation_date": 1575250911, "answer_id": 59131622, "question_id": 59131342, "link": "https://stackoverflow.com/questions/59131342/how-does-haskell-have-late-evaluation/59131622#59131622", "title": "How does Haskell have late evaluation?", "body": "<blockquote>\n  <p>Why is this code doing early evaluation?</p>\n</blockquote>\n\n<p>It isn't, as @leftaroundabout discussed.  The misunderstanding here is about variable scoping and not evaluation.</p>\n\n<blockquote>\n  <p>can I have an example of late evaluation in Haskell?</p>\n</blockquote>\n\n<p><strong>Infinite Lists</strong></p>\n\n<p>I found the earliest easily grokked examples of lazy evaluation were infinite lists.  Consider the typical fibonacci sequence.  A verbose version for naming sake is:</p>\n\n<pre><code>fibs :: [Integer]\nfibs = 0 -- First element\n     : 1 -- Cons with the second element\n     : zipWith (\\first second -&gt; first + second) fibs (drop 1 fibs)\n         -- Cons with all other elements, dynamically computed.\n</code></pre>\n\n<p>Some people don't like computation.  An example for those people is a repeating list.  Consider a never ending linked list of 42... this can be hard to do in a useful manner in C.</p>\n\n<pre><code>infiniteFortyTwos = 42 :infiniteFortyTwos\n</code></pre>\n\n<p><strong>Errors</strong></p>\n\n<p>Errors are perhaps the most common lazy evaluation but most people don't really realize that lazy evaluation is taking place.  Often called short-circuiting when used with boolean operation, consider the shell script:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>var=$(ls /dir/that/does/not/exist 2&gt;/dev/null || echo DNE)\n</code></pre>\n\n<p>This idiom appears all over the place in programming and development.  Perl often used <code>|| die \"error\"</code> in its early years.  In Haskell the types discourage mixing of evaluation and failure in this specific manner but the lazy functionality is the same.</p>\n\n<p>Consider this poorly-conceived routine:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>headEquals :: Eq a =&gt; a -&gt; [a] -&gt; Bool\nheadEquals v xs = not (null xs) &amp;&amp; v == head xs\n</code></pre>\n\n<p>Or the common java and C patterns:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if(ptr != NULL &amp;&amp; *ptr == value) {\n   ...\n}\n</code></pre>\n\n<p><strong>Tie The Knot</strong></p>\n\n<p>A much more advanced lazy evaluation technique is <a href=\"https://wiki.haskell.org/Tying_the_Knot\" rel=\"nofollow noreferrer\">tying the knot</a>.  For example, pretend we want to replace all elements in a list with the smallest element in the list.  Let's pretend we have the answer while computing the answer then use the returned value as said answer:</p>\n\n<pre><code>minList :: [Int] -&gt; [Int]\nminList [] = []\nminList (m:xs) =\n    let (theMin, newList) = go theMin m xs\n    in theMin : newList\n  where\n   go realAnswer partialAnswer []     = (partialAnswer, [])\n   go realAnswer partialAnswer (y:ys) =\n        let newPartialAnswer = min y partialAnswer\n        in (realAnswer :) &lt;$&gt; go realAnswer newPartialAnswer ys\n</code></pre>\n"}], "owner": {"reputation": 1119, "user_id": 11714860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6Xo3.png?s=128&g=1", "display_name": "Sapphire_Brick", "link": "https://stackoverflow.com/users/11714860/sapphire-brick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 1, "accepted_answer_id": 59131497, "answer_count": 2, "score": 3, "last_activity_date": 1576506817, "creation_date": 1575247389, "last_edit_date": 1576506817, "question_id": 59131342, "link": "https://stackoverflow.com/questions/59131342/how-does-haskell-have-late-evaluation", "title": "How does Haskell have late evaluation?", "body": "<p>I have heard that Haskell has late evaluation. However, whatever I tried to do, it seemed to evaluate it the same way any other programming language does;  </p>\n\n<p>consider the following code:</p>\n\n<pre><code>test :: Bool -&gt; IO()\ntest n = do\n  let y = 5\n  print n\n\nmain = do\n  let y = 8\n  test (y == 8)\n</code></pre>\n\n<p>This code outputs:</p>\n\n<pre><code>True\n</code></pre>\n\n<ul>\n<li>Why is this code evaluating the \"y\" early?</li>\n<li>Can I have an example of late evaluation in Haskell?</li>\n</ul>\n"}, {"tags": ["list", "haskell", "semigroup"], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1575238729, "creation_date": 1575238729, "answer_id": 59130502, "question_id": 59129935, "link": "https://stackoverflow.com/questions/59129935/list-instance-of-semigroup-mappeding-respective-pairs-of-elements/59130502#59130502", "title": "List instance of semigroup mappeding respective pairs of elements", "body": "<p>Not a wrapper type, but a different function that does that on regular lists: <a href=\"https://hackage.haskell.org/package/semialign-1.1/docs/Data-Semialign.html#v:salign\" rel=\"nofollow noreferrer\"><code>salign</code> from semialign's Data.Semialign</a>. You can either call it directly or implement SList in terms of it:</p>\n\n<pre><code>import Data.Semialign (salign)\ninstance Semigroup a =&gt; Semigroup (SList a) where\n    SList l1 &lt;&gt; SList l2 = SList (salign l1 l2)\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 5255089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb99414b7f1cbc6d5a1dc99d217c6125?s=128&d=identicon&r=PG", "display_name": "Eryk Ciepiela", "link": "https://stackoverflow.com/users/5255089/eryk-ciepiela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1575239277, "creation_date": 1575234073, "last_edit_date": 1575238151, "question_id": 59129935, "link": "https://stackoverflow.com/questions/59129935/list-instance-of-semigroup-mappeding-respective-pairs-of-elements", "title": "List instance of semigroup mappeding respective pairs of elements", "body": "<p>I am looking for most common Haskell library that introduces <code>[a]</code> wrapper that instantiates <code>Semigroup</code> by delegating <code>mappend</code>ing to its elements in the similar way to:</p>\n\n<pre><code>newtype SList a = SList { slist :: [a] } \n\ninstance Semigroup a =&gt; Semigroup (SList a) where\n    l1 &lt;&gt; l2 = SList $ foldl1 (&lt;&gt;) &lt;$&gt; transpose [slist l1, slist l2]\n</code></pre>\n\n<p>For example, <code>SList [a,b,c] &lt;&gt; SList [d,e,f,g]</code> would evaluate to <code>SList [a &lt;&gt; d, \nb &lt;&gt; e, c &lt;&gt; f, g]</code>.</p>\n\n<p>To my surprise I couldn't found any in Prelude nor other most popular libraries. Why is that?</p>\n"}, {"tags": ["haskell", "expression", "monads", "environment", "applicative"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1575223781, "post_id": 59128317, "comment_id": 104484975, "body": "The first step is to make sure you type <i>has</i> the right kind: <code>data Expr a = ...</code> Only then does it even make sense to define <code>Functor</code>, <code>Applicative</code>, and <code>Monad</code> instances for <code>Expr</code>. However, you still have to think about what it would <i>mean</i> for your type to have a <code>Monad</code> instance. As a simple example, what do you think <code>f &gt;&gt;= Lit 3</code> should mean?"}, {"owner": {"reputation": 21, "user_id": 12464738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acc55714c9fb6a0630827ff022f7353?s=128&d=identicon&r=PG&f=1", "display_name": "Iamfour", "link": "https://stackoverflow.com/users/12464738/iamfour"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575224118, "post_id": 59128317, "comment_id": 104485072, "body": "First of all, thanks for responding. I am confused about how somebody would add the polymorphic &#39;a&#39; to a data type without it being useless. Secondly, does f &gt;&gt;= Lit 3 mean Lit f a?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1575224118, "post_id": 59128317, "comment_id": 104485073, "body": "@chepner <code>Lit 3 &gt;&gt;= f</code>, surely."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 3, "creation_date": 1575224690, "post_id": 59128317, "comment_id": 104485231, "body": "Can you explain <i>why</i> you&#39;re trying to add a monad instance?  You already have a working <code>eval</code>, so what do you expect the monad to do for you?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1575225989, "post_id": 59128317, "comment_id": 104485594, "body": "@amalloy &lt;facepalm&gt;"}, {"owner": {"reputation": 21, "user_id": 12464738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acc55714c9fb6a0630827ff022f7353?s=128&d=identicon&r=PG&f=1", "display_name": "Iamfour", "link": "https://stackoverflow.com/users/12464738/iamfour"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1575227104, "post_id": 59128317, "comment_id": 104485858, "body": "@K.A.Buhr. I want to add a monad instance that takes the elements out of the environment (Env :: [(String, Value)] ) and it creates an application :@: term from it. This way the variables have values in a list and you can use them in expressions."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 2, "creation_date": 1575227680, "post_id": 59128317, "comment_id": 104486023, "body": "It sounds like you want a reader monad. This won&#39;t have an instance for <code>Expr</code>, rather your <code>eval</code> will have a type like <code>eval :: Expr -&gt; Reader Env Value</code>. Then your <code>Env</code> gets threaded through the calls without needing to be passed explicitly for every recursive call."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1575229800, "post_id": 59128317, "comment_id": 104486556, "body": "Do you want the monadic bind to substitute variables? If so, then you need an <code>Expr a</code> with <code>Var a</code> instead of <code>Expr</code> with <code>Var String</code>."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 0, "last_activity_date": 1575498210, "creation_date": 1575498210, "answer_id": 59185474, "question_id": 59128317, "link": "https://stackoverflow.com/questions/59128317/how-do-you-define-the-monad-instance-for-the-following-data-types/59185474#59185474", "title": "How do you define the monad instance for the following data types?", "body": "<p>As a side note, your <code>eval (ef :@: ae)</code> case is wrong, since you're using the wrong copy of <code>env</code> in evaluating <code>ef</code> and <code>ea</code>.  You want this instead:</p>\n\n<pre><code>eval (ef :@: ea)    env = let FunVal env' var body = eval ef env\n                              arg                  = eval ea env\n                           in eval body ((var,arg):env')\n</code></pre>\n\n<p>Anyway, let's start by discussing the usual way of \"using a monad\" for an evaluation function like <code>eval</code>.</p>\n\n<p>Your <code>eval</code> function has signature:</p>\n\n<pre><code>eval :: Expr -&gt; Env -&gt; Value\n</code></pre>\n\n<p>Even though it's <em>primary</em> purpose is to take an <code>Expr</code> and determine its <code>Value</code> (i.e., it's basically a function <code>Expr -&gt; Value</code>), you have some extra information you need to carry around, namely this <code>Env</code> that describes variable bindings.  Even though you only access these bindings when processing <code>Var</code> and <code>Sub</code> constructors and only modify these bindings when processing <code>:@:</code> constructors, you still need to pass <code>Env</code> around for all the cases that don't care about it, especially cases like:</p>\n\n<pre><code>eval (Bin e1 op e2) env = applyIntOp op (eval e1 env) (eval e2 env)\n</code></pre>\n\n<p>which don't even <em>touch</em> <code>env</code>, but need to pass it along to every recursive <code>eval</code> call.</p>\n\n<p>To avoid this, what folks usually do is introduce a monadic context for their evaluation.  This does <strong>not</strong> involve writing a monad instance for <code>Expr</code> or <code>Env</code> or <code>Value</code>.  Rather, it involves changing the signature of <code>eval</code> to take an <code>Expr</code> and return a <code>Value</code>, but in a \"monadic context\" that can make <code>Env</code> available for inspection and modification:</p>\n\n<pre><code>evalM :: Expr -&gt; MyMonad Value\n</code></pre>\n\n<p>There's a actually a ready-made monad for this, so you don't have to write your own:</p>\n\n<pre><code>import Control.Monad.Reader\ntype MyMonad = Reader Env\n</code></pre>\n\n<p>After this, it's somewhat easier to write the cases that don't care about <code>Env</code>:</p>\n\n<pre><code>evalM (Lit i) = pure $ IntVal i\nevalM (Bin e1 op e2) = applyIntOp op &lt;*&gt; eval e1 &lt;*&gt; eval e2\n</code></pre>\n\n<p>and the cases that <em>do</em> care about <code>Env</code> don't look too bad either:</p>\n\n<pre><code>evalM (Var v) = asks (fromJust . lookup v)\nevalM (Abs v b) = FunVal &lt;$&gt; ask &lt;*&gt; pure v &lt;*&gt; pure b\nevalM (ef :@: ea) = join $ apply &lt;$&gt; evalM ef &lt;*&gt; evalM ea\n  where apply (FunVal env var body) va =\n          local (const ((var,va):env)) $ evalM body\n</code></pre>\n\n<p>Admittedly, introducing <code>MyMonad</code> doesn't help very much in this example, but if you decided to extend your language to support mutable values, error handling, and IO side effects, you'd start to see more advantages to this approach.</p>\n\n<p>Again, this is the <strong>usual</strong> way of using a monad for evaluation, but I'm not sure if this is what you were asking about or not.</p>\n\n<p>An <strong>unusual</strong> way of using a monad for evaluation would be to write a monad instance for an <code>Expr</code> type where the monadic action is some kind of \"substitution\".  It's really hard to imagine how this would work.  The most obvious starting point would be to consider the way a monad is often used to recursively replace elements of a structure without changing the overall structure.  For example, the list monad can be viewed as replacing each element of a list with a new list, but instead of returning a list of lists, it concatenated it all together to give it the same type as the origin.  For trees with values at the leaves, there's a usual monad that replaces each leaf with an associated tree, but instead of giving a tree of trees, the structure is flattened out so it's just a tree of the same type as the original.</p>\n\n<p>From this starting point, it's easy to imagine a substitution monad for expressions where the leaves are the variable references:</p>\n\n<pre><code>data ExprM a\n  =  LitM Integer\n  |  VarM a\n  |  BinM (ExprM a) Op (ExprM a)\n  deriving (Show, Functor)\n</code></pre>\n\n<p>The monadic action can be to substitute each <code>VarM a</code> (leaf) with an <code>ExprM a</code> (tree):</p>\n\n<pre><code>instance Applicative ExprM where\n  pure = VarM\n  (&lt;*&gt;) = ap\ninstance Monad ExprM where\n  VarM x &gt;&gt;= f = f x\n  LitM n &gt;&gt;= f = LitM n\n  BinM e1 op e2 &gt;&gt;= f = BinM (e1 &gt;&gt;= f) op (e2 &gt;&gt;= f)\n</code></pre>\n\n<p>Note that there is no <code>AppM</code> constructor because it's been replaced by the monadic bind.  If you want to substitute <code>LitM 1</code> for the value of <code>VarM \"x\"</code> in the expression <code>BinM (VarM \"x\") Plus (VarM \"x\")</code>, you do it like so:</p>\n\n<pre><code>body1 = BinM (VarM \"x\") Plus (VarM \"x\")\n\ncontext1 \"x\" = LitM 1\ncontext1 _ = error \"variable not found\"\n\nexample1 = body1 &gt;&gt;= context1\n</code></pre>\n\n<p>which gives:</p>\n\n<pre><code>&gt; example1\nBinM (LitM 1) Plus (LitM 1)\n</code></pre>\n\n<p>The problem is that it's not at all clear how to add the <code>Abs</code> constructor back in.  It can't really have form:</p>\n\n<pre><code>... | Abs a (ExprM a) | ...\n</code></pre>\n\n<p>because the only sensible monad instance would have to perform substitution on the <em>argument name</em>, which doesn't make any sense.  It would also be susceptible to variable capture.</p>\n\n<p>If there's some clever representation for <code>Abs</code> that lets you stick with a monadic substitution scheme, I'm not seeing it.</p>\n"}], "owner": {"reputation": 21, "user_id": 12464738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acc55714c9fb6a0630827ff022f7353?s=128&d=identicon&r=PG&f=1", "display_name": "Iamfour", "link": "https://stackoverflow.com/users/12464738/iamfour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1575498210, "creation_date": 1575222909, "last_edit_date": 1575224675, "question_id": 59128317, "link": "https://stackoverflow.com/questions/59128317/how-do-you-define-the-monad-instance-for-the-following-data-types", "title": "How do you define the monad instance for the following data types?", "body": "<p>Here's the code I have to work with:</p>\n\n<pre><code>infixl 9 :@: -- This is newly defined symbol used in the application of expressions\n\ndata Expr\n  =  Lit Integer      -- a literal\n  |  Var String       -- a variable\n  |  Bin Expr Op Expr -- binary operator\n  |  Abs String Expr  -- a lambda expression\n  |  Expr :@: Expr    -- an application\n  deriving Show\n\ndata Op = Plus | Mult\n  deriving Show\n\ndata Value = IntVal Integer | FunVal Env String Expr\n  deriving Show\n\ntype Env = [(String,Value)]\n\napplyIntOp :: Op -&gt; Value -&gt; Value -&gt; Value\napplyIntOp op (IntVal v1) (IntVal v2) = \n   case op of \n      Plus -&gt; IntVal (v1 + v2)\n      Mult -&gt; IntVal (v1 * v2)\n\neval :: Expr -&gt; Env -&gt; Value\neval (Lit i)        env = IntVal i\neval (Var v)        env = fromJust (lookup v env)\neval (Bin e1 op e2) env = applyIntOp op (eval e1 env) (eval e2 env)\neval (Abs v b)      env = FunVal env v b\neval (ef :@: ea)    env = let FunVal env var body = eval ef env\n                              arg                 = eval ea env\n                           in eval body ((var,arg):env) \n\n</code></pre>\n\n<p>The goal is to make an evaluation function such that it can use variables (Var String), of which the variables are taken from the environment (Env). However when I try to define a monad with any of these types, I can't because they don't have the correct kind (* instead of * -> *).</p>\n\n<p>So, how would I go about defining this Monad such that I can use it to evaluate any expressions correctly.</p>\n\n<pre><code>instance Monad ? where\n  return = ..\n  &gt;&gt;=    = .. \n</code></pre>\n\n<p>As an example (3 + (x * 4)(apply)(x=1+2)):</p>\n\n<pre><code>eval (Bin (Lit 3) Plus ((Abs \"x\" (Bin (Var \"x\") Mult (Lit 4))) :@: Bin (Lit 1) Plus (Lit 2))) []\n</code></pre>\n\n<p>This returns 15</p>\n"}, {"tags": ["haskell", "pattern-matching", "compiler-warnings"], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1575222556, "post_id": 59128256, "comment_id": 104484671, "body": "\u201cBecause the expressions are different\u201d \u2013 actually they aren&#39;t, it&#39;s both <code>id x</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575222654, "post_id": 59128256, "comment_id": 104484696, "body": "For both <code>(,)</code> and <code>Maybe</code>, the type checker already knows the complete set of data constructors; why is there a difference between one (<code>(,)</code> for <code>(,)</code>) and two (<code>Just</code> and <code>Nothing</code> for <code>Maybe</code>)?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1575223256, "post_id": 59128256, "comment_id": 104484836, "body": "I agree with @leftaroundabout here. The one missing piece for me is: Why does it matter whether GHC has simplified away <code>id</code>, or even knows what <code>id</code> does, given that both patterns are matching the same expression?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1575228130, "post_id": 59128256, "comment_id": 104486144, "body": "I totally misread the question.  I guess it doesn&#39;t even consider whether any expression more complex than a single expression matches.  Will update."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1575228673, "post_id": 59128256, "comment_id": 104486274, "body": "I have updated the answer to be an answer to the question asked."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 9, "last_activity_date": 1575228643, "last_edit_date": 1575228643, "creation_date": 1575222498, "answer_id": 59128256, "question_id": 59128155, "link": "https://stackoverflow.com/questions/59128155/why-does-the-identity-function-sometimes-change-whether-patterns-are-exhaustive/59128256#59128256", "title": "Why does the identity function sometimes change whether patterns are exhaustive?", "body": "<p>It looks like GHC doesn't consider identical expressions to be the same value in a pattern guard unless the expression is a single binding:</p>\n\n<pre><code>Prelude&gt; f | Just x &lt;- Just 1 = \"foo\" | Nothing &lt;- Just 1 = \"bar\"\n\n&lt;interactive&gt;:5:1: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018f\u2019: Guards do not cover entire pattern space\n</code></pre>\n\n<p>This is even more silly, in that it's clear the patterns are exhaustive.  It can't even branch. </p>\n\n<p>I'd say that this is probably the right way to do things, even if it's weird.  It encourages binding the expression to a name, which is helpful for ensuring the expression is only evaluated once.  It's certainly a roundabout way of doing it, though.</p>\n\n<p>As for why you're not getting that error in <code>bar</code>, it's because there's only one constructor for pairs. You're matching every possible output of <code>id t</code>, even if it's a computed expression.  There's no alternative constructor you haven't matched.</p>\n"}], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 1, "accepted_answer_id": 59128256, "answer_count": 1, "score": 6, "last_activity_date": 1575228643, "creation_date": 1575221705, "last_edit_date": 1575228201, "question_id": 59128155, "link": "https://stackoverflow.com/questions/59128155/why-does-the-identity-function-sometimes-change-whether-patterns-are-exhaustive", "title": "Why does the identity function sometimes change whether patterns are exhaustive?", "body": "<p>Consider this GHCi session:</p>\n\n<pre><code>$ ghci\nGHCi, version 8.6.5: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :set -Wincomplete-patterns -Wincomplete-uni-patterns\nPrelude&gt; foo t | (_, _) &lt;- t = \"Foo\"\nPrelude&gt; bar t | (_, _) &lt;- id t = \"Foo\"\nPrelude&gt; baz x | Just _ &lt;- x = \"Yes\" | Nothing &lt;- x = \"No\"\nPrelude&gt; qux x | Just _ &lt;- id x = \"Yes\" | Nothing &lt;- id x = \"No\"\n\n&lt;interactive&gt;:3:1: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018qux\u2019: Patterns not matched: _\nPrelude&gt;\n</code></pre>\n\n<p>Why is <code>qux</code> considered incomplete by GHC? Do we really know more about <code>id x</code> than we do about <code>x</code>? And why isn't <code>bar</code> also considered incomplete for the same reason that <code>qux</code> is?</p>\n\n<p>Or for a possibly clearer example:</p>\n\n<pre><code>foo f x\n  | Just _ &lt;- f x = \"Yes\"\n  | Nothing &lt;- f x = \"No\"\n\nbar f x = case f x of\n  Just _ -&gt; \"Yes\"\n  Nothing -&gt; \"No\"\n</code></pre>\n\n<p>As far as I know, those are exactly equivalent, but the former produces the warning and the latter does not.</p>\n"}, {"tags": ["scala", "haskell", "functional-programming", "monads", "comonad"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 3, "creation_date": 1575212866, "post_id": 59126653, "comment_id": 104481896, "body": "What makes you think that&#39;s possible? Let <code>D</code> be the identity comonad, then such a scheme would turn any monad into a comonad."}, {"owner": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1575231997, "post_id": 59126653, "comment_id": 104487132, "body": "@Li-yaoXia Because I thought it was the point of having a distributive law. So what is it useful for?"}], "answers": [{"comments": [{"owner": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 0, "creation_date": 1575232089, "post_id": 59126837, "comment_id": 104487164, "body": "Great :-( So what&#39;s the point of having a distributive law if you cannot use it to derive a comonad (or a monad)?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "edited": false, "score": 2, "creation_date": 1575232969, "post_id": 59126837, "comment_id": 104487426, "body": "@Bob we need distribution to compose <a href=\"https://stackoverflow.com/questions/12963733/writing-cojoin-or-cobind-for-n-dimensional-grid-type\">two comonads</a>, for example."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 7, "last_activity_date": 1575233353, "last_edit_date": 1575233353, "creation_date": 1575213102, "answer_id": 59126837, "question_id": 59126653, "link": "https://stackoverflow.com/questions/59126653/how-to-combine-a-comonad-and-a-monad-into-a-comonad/59126837#59126837", "title": "How to combine a comonad and a monad into a comonad?", "body": "<p>You can't. Suppose <code>D</code> is the identity comonad and <code>T</code> is <code>Cont Void</code>, i.e. the continuation monad at the empty type.</p>\n\n<pre><code>newtype D a = D {runD :: a}\nnewtype T a = T {runT :: (a -&gt; Void) -&gt; Void}\n</code></pre>\n\n<p>Then distributivity holds trivially. But <code>extract :: D (T a) -&gt; a</code> is not definable as a total computable program. It would be double negation elimination <code>forall a. ((a -&gt; Void) -&gt; Void) -&gt; a</code>, which is not definable in constructive languages.</p>\n"}], "owner": {"reputation": 1315, "user_id": 3780931, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7ed60a7e72a67346cacc5173dd359c65?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/3780931/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 59126837, "answer_count": 1, "score": 1, "last_activity_date": 1575233353, "creation_date": 1575211789, "question_id": 59126653, "link": "https://stackoverflow.com/questions/59126653/how-to-combine-a-comonad-and-a-monad-into-a-comonad", "title": "How to combine a comonad and a monad into a comonad?", "body": "<p>Assume I have</p>\n\n<ul>\n<li>a comonad <code>D</code></li>\n<li>a monad <code>T</code></li>\n<li>a distributive law <code>l : D T -&gt; T D</code> of the comonad <code>D</code> over the monad <code>T</code>.</li>\n</ul>\n\n<p>How can I define the comonad <code>D T</code>?</p>\n"}, {"tags": ["parsing", "haskell", "monads"], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 6, "last_activity_date": 1575209523, "creation_date": 1575209523, "answer_id": 59126301, "question_id": 59126030, "link": "https://stackoverflow.com/questions/59126030/data-list-intercalate-for-monads/59126301#59126301", "title": "Data.List intercalate for monads", "body": "<p>You can use <code>choice</code>:</p>\n\n<pre><code>Prelude Text.ParserCombinators.ReadP&gt; cmds = [\"create\", \"add\", \"another alias\"]\nPrelude Text.ParserCombinators.ReadP&gt; :t choice $ map string cmds\nchoice $ map string cmds :: ReadP String\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 4, "creation_date": 1575212280, "post_id": 59126344, "comment_id": 104481731, "body": "<code>foldr (&lt;|&gt;) empty</code> exists as <code>asum</code> - slightly hard to find because it&#39;s in Data.Foldable rather than with the definition of Alternative."}], "tags": [], "owner": {"reputation": 1064, "user_id": 12153248, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f7ubefVLzQg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOhhV81djlo9daQq8Jy-mYdaQz5A/photo.jpg?sz=128", "display_name": "Ari Fordsham", "link": "https://stackoverflow.com/users/12153248/ari-fordsham"}, "is_accepted": false, "score": 4, "last_activity_date": 1575209786, "creation_date": 1575209786, "answer_id": 59126344, "question_id": 59126030, "link": "https://stackoverflow.com/questions/59126030/data-list-intercalate-for-monads/59126344#59126344", "title": "Data.List intercalate for monads", "body": "<p>What you need is a fold.</p>\n\n<p><code>&lt;|&gt;</code> is not a list element, it's an associative function taking two arguments.</p>\n\n<p>You need to do something like this:</p>\n\n<pre><code>getExpr cmds = foldr1 (&lt;|&gt;) $ map string cmds\n</code></pre>\n\n<p>Note that using <code>foldr1</code> is a quick and dirty fix: it will throw an exception if given an empty list. The robust way would be to use <code>foldr</code> with some kind of null parser as the base case.</p>\n"}, {"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1575231986, "creation_date": 1575231986, "answer_id": 59129647, "question_id": 59126030, "link": "https://stackoverflow.com/questions/59126030/data-list-intercalate-for-monads/59129647#59129647", "title": "Data.List intercalate for monads", "body": "<p>This is the perfect use-case for <a href=\"https://hackage.haskell.org/package/relude-0.6.0.0/docs/Relude-Foldable-Fold.html#v:asumMap\" rel=\"nofollow noreferrer\"><code>asumMap</code> in Relude</a>:</p>\n\n<pre><code>getExpr cmds = asumMap string cmds\ncmdExpr = getExpr [\"create\", \"add\", \"another alias\", ...]\n</code></pre>\n\n<p>If you're not using Relude but are using other third-party libraries, then there are other identical functions, such as <a href=\"https://hackage.haskell.org/package/util-0.1.14.0/docs/Util.html#v:altMap\" rel=\"nofollow noreferrer\"><code>altMap</code> in Util</a>:</p>\n\n<pre><code>import Util (altMap)\ngetExpr cmds = altMap string cmds\ncmdExpr = getExpr [\"create\", \"add\", \"another alias\", ...]\n</code></pre>\n\n<p>If you want to stick with Base, then you can use <code>asum</code> and <code>map</code> separately, <a href=\"https://stackoverflow.com/questions/59126030/data-list-intercalate-for-monads#comment104481731_59126344\">as David Fletcher mentioned in a comment</a>:</p>\n\n<pre><code>import Data.Foldable (asum)\ngetExpr cmds = asum $ map string cmds\ncmdExpr = getExpr [\"create\", \"add\", \"another alias\", ...]\n</code></pre>\n"}], "owner": {"reputation": 3695, "user_id": 6213048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8fcf68f42b160a352e7fa157dba36392?s=128&d=identicon&r=PG", "display_name": "soywod", "link": "https://stackoverflow.com/users/6213048/soywod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 59126301, "answer_count": 3, "score": 1, "last_activity_date": 1575231986, "creation_date": 1575207337, "last_edit_date": 1575211206, "question_id": 59126030, "link": "https://stackoverflow.com/questions/59126030/data-list-intercalate-for-monads", "title": "Data.List intercalate for monads", "body": "<p>I'm writing a small parser using the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Text-ParserCombinators-ReadP.html\" rel=\"nofollow noreferrer\">ReadP</a> module. I have this expression:</p>\n\n<pre><code>cmdExpr = string \"create\" &lt;|&gt; string \"add\" &lt;|&gt; string \"another alias\" &lt;|&gt; ...\n</code></pre>\n\n<p>I would like to abstract away the <code>&lt;|&gt;</code> operation, but I don't see how. Something like <code>intercalate</code>:</p>\n\n<pre><code>getExpr cmds = intercalateM (&lt;|&gt;) $ map string cmds\ncmdExpr = getExpr [\"create\", \"add\", \"another alias\", ...]\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1575204541, "post_id": 59125627, "comment_id": 104479820, "body": "Not sure if this is 100% what you&#39;re looking for, but the standard library function <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:takeWhile\" rel=\"nofollow noreferrer\">takeWhile</a> does exactly this. (I see your implementation uses its close relative <code>dropWhile</code>.) Note that the implementation of <code>takeWhile</code> is a very simple recursive definition, you definitely don&#39;t need all these auxiliary functions!"}, {"owner": {"reputation": 51, "user_id": 12463755, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a34F28wfIm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rec59UTesND3VkDjs04PgzJ8kMl8g/photo.jpg?sz=128", "display_name": "Marwan Sabih", "link": "https://stackoverflow.com/users/12463755/marwan-sabih"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1575205626, "post_id": 59125627, "comment_id": 104480063, "body": "@RobinZigmond Thank you for your reply. I would love to get rid of all these auxilary functions, but just don&#39;t know how. First I used takeWhile - but with span it seemed simpler. If I understand correctly takeWhile -starts listing all elements from the start of the list where the condidtion applies, but what I&#39;m searching is the longest sublist for which the conditions apply - so for example: aaaaaaaBBBBBBaaaaaBBBBBBBBBBcccccDDDDDDDDDDDDDDDDaaaa should return DDDDDDDDDDDDDDDD. Is it possible to do this in just one small functions?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1575205812, "post_id": 59125627, "comment_id": 104480102, "body": "oh I see, sorry. I had thought you just wanted to write your own version of <code>takeWhile</code> (without being sure that you didn&#39;t know it already existed)"}, {"owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "edited": false, "score": 0, "creation_date": 1575232044, "post_id": 59125627, "comment_id": 104487150, "body": "I&#39;ve added a shortened version to my answer in addition to the previous ones, maybe you&#39;ll like it"}, {"owner": {"reputation": 51, "user_id": 12463755, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a34F28wfIm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rec59UTesND3VkDjs04PgzJ8kMl8g/photo.jpg?sz=128", "display_name": "Marwan Sabih", "link": "https://stackoverflow.com/users/12463755/marwan-sabih"}, "reply_to_user": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "edited": false, "score": 0, "creation_date": 1575438926, "post_id": 59125627, "comment_id": 104562403, "body": "@YuriKovalenko Hey from all the suggestions your shortened version seems to be the best, I really like it!"}, {"owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "edited": false, "score": 0, "creation_date": 1575447859, "post_id": 59125627, "comment_id": 104565663, "body": "@MarwanSabih I&#39;m glad that you liked it. If so, could you mark it as an accepted answer?"}, {"owner": {"reputation": 51, "user_id": 12463755, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a34F28wfIm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rec59UTesND3VkDjs04PgzJ8kMl8g/photo.jpg?sz=128", "display_name": "Marwan Sabih", "link": "https://stackoverflow.com/users/12463755/marwan-sabih"}, "reply_to_user": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "edited": false, "score": 0, "creation_date": 1576843105, "post_id": 59125627, "comment_id": 105035844, "body": "@YuriKovalenko Sorry took me some time but here you go ... didn&#39;t know you can only accept one of the answers."}], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1575232314, "last_edit_date": 1575232314, "creation_date": 1575209264, "answer_id": 59126273, "question_id": 59125627, "link": "https://stackoverflow.com/questions/59125627/how-to-enhance-small-haskell-code-snippet/59126273#59126273", "title": "How to enhance small Haskell Code Snippet", "body": "<p>At first, you can define your <code>longest</code> like this:</p>\n\n<pre><code>import Data.Function\nimport Data.List\n\nlongest :: [[a]] -&gt; [a]\nlongest = maximumBy (compare `on` length)\n</code></pre>\n\n<p>And to get all subsequences that satisfy a given condition you can write a function like this:</p>\n\n<pre><code>import Data.List\n\ngetSatisfyingSubseqs :: (a -&gt; Bool) -&gt; [a] -&gt; [[a]]\ngetSatisfyingSubseqs f = filter (f . head) . groupBy same \n    where same x y = f x == f y\n</code></pre>\n\n<p>Here we group elements where the condition yields the same result and filter only subsequences that satisfy the condition.</p>\n\n<p>In the total:</p>\n\n<pre><code>longestSubsequence :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nlongestSubsequence f = longest . getSatisfyingSubseqs f\n</code></pre>\n\n<p>UPDATE: And if you want to make it shorter, you can just throw out the auxiliary functions and write the whole at a time:</p>\n\n<pre><code>longestSubsequence :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nlongestSubsequence f = maximumBy (compare `on` length) . filter (f . head) . groupBy same \n    where same x y = f x == f y\n</code></pre>\n\n<p>(Don't forget the imports)\nYou can run it there: <a href=\"https://repl.it/@Yuri12358/so-longestsequence\" rel=\"nofollow noreferrer\">https://repl.it/@Yuri12358/so-longestsequence</a></p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 12463755, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a34F28wfIm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rec59UTesND3VkDjs04PgzJ8kMl8g/photo.jpg?sz=128", "display_name": "Marwan Sabih", "link": "https://stackoverflow.com/users/12463755/marwan-sabih"}, "edited": false, "score": 0, "creation_date": 1575214935, "post_id": 59126274, "comment_id": 104482494, "body": "Thank you! Wow that&#39;s amazingly short :)"}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1575209273, "creation_date": 1575209273, "answer_id": 59126274, "question_id": 59125627, "link": "https://stackoverflow.com/questions/59125627/how-to-enhance-small-haskell-code-snippet/59126274#59126274", "title": "How to enhance small Haskell Code Snippet", "body": "<p>The <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:span\" rel=\"nofollow noreferrer\">span :: (a -> Bool) -> [a] -> ([a], [a])</a> function could be very handy here. Also note that <code>f &lt;$&gt; (a,b) = (a,f b)</code>. Probably not very efficient due to the <code>length</code> checks but it should do the job.</p>\n\n<pre><code>lss :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nlss f []        = []\nlss f ls@(x:xs) = if f x then longer (lss f &lt;$&gt; span f ls)\n                         else lss f xs\n                  where\n                  longer ::([a],[a]) -&gt; [a]\n                  longer (xs,ys) = if length xs &gt;= length ys then xs else ys\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 12463755, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a34F28wfIm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rec59UTesND3VkDjs04PgzJ8kMl8g/photo.jpg?sz=128", "display_name": "Marwan Sabih", "link": "https://stackoverflow.com/users/12463755/marwan-sabih"}, "edited": false, "score": 0, "creation_date": 1575439150, "post_id": 59129229, "comment_id": 104562473, "body": "Thank you! This is quite handy didn&#39;t thought about lists and the performance at all :)"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1575228984, "creation_date": 1575228984, "answer_id": 59129229, "question_id": 59125627, "link": "https://stackoverflow.com/questions/59125627/how-to-enhance-small-haskell-code-snippet/59129229#59129229", "title": "How to enhance small Haskell Code Snippet", "body": "<p>Your <code>longer</code> function uses <code>length</code>, which means it doesn't work if either input is infinite. However, it can be improved to work when at most one is infinite:</p>\n\n<pre><code>longer l1 l2 = go l1 l2\n  where\n    go [] _ = l2\n    go _ [] = l1\n    go (_:xs) (_:ys) = go xs ys\n</code></pre>\n\n<p>This is also a performance optimization. Before, if you had a 10-element list and a 10-million-element list, it would walk through all 10 million elements of the 10-million-element list before returning it. Here, it will return it as soon as it gets to the 11th element instead.</p>\n"}], "owner": {"reputation": 51, "user_id": 12463755, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a34F28wfIm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rec59UTesND3VkDjs04PgzJ8kMl8g/photo.jpg?sz=128", "display_name": "Marwan Sabih", "link": "https://stackoverflow.com/users/12463755/marwan-sabih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 59126273, "answer_count": 3, "score": 1, "last_activity_date": 1575232314, "creation_date": 1575204359, "question_id": 59125627, "link": "https://stackoverflow.com/questions/59125627/how-to-enhance-small-haskell-code-snippet", "title": "How to enhance small Haskell Code Snippet", "body": "<p>just recently I started to try out haskell. \nIt's fun trying out different exercises, but sometimes I get the feeling, that my found solutions are far from elegant: The following Code Snipplet will find the longest sub-sequence in a list, which will satisfy a given condition (for example uppercase letters etc.)   </p>\n\n<p>Could you help a noob to make everything shorter and more elegant - every advice is highly appreciated.</p>\n\n<pre><code>import           Data.Char\n\nlonger :: [a] -&gt; [a] -&gt; [a]\nlonger x y = if length x &gt; length y\n             then x\n             else y\n\nlongest :: [[a]]-&gt;[a]\nlongest  = foldl longer []\n\nnextSequence :: (a-&gt;Bool) -&gt; [a] -&gt;([a],[a])\nnextSequence f x = span f (dropWhile (not . f) x)\n\n\nlongestSubsequence :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nlongestSubsequence _ x | null x = []\nlongestSubsequence f x =\n     longest $  (\\y -&gt; [fst y , longestSubsequence f $ snd y]) (nextSequence f x)\n\n\ntestSequence :: String\ntestSequence = longestSubsequence Data.Char.isUpper\n    \"hkerhklehrERJKJKJERKJejkrjekERHkhkerHERKLJHERJKHKJHERdjfkj\"\n</code></pre>\n"}, {"tags": ["haskell", "hdevtools"], "answers": [{"comments": [{"owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "edited": false, "score": 0, "creation_date": 1575271764, "post_id": 59128173, "comment_id": 104496235, "body": "Thanks. Yesterday night I noticed I forgot to purge the .cabal directory.  After a round of repurging everything and installing and  rebuilding it now works."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 1, "last_activity_date": 1575221827, "creation_date": 1575221827, "answer_id": 59128173, "question_id": 59124802, "link": "https://stackoverflow.com/questions/59124802/how-to-fix-hdevtools-ghc-package-path-is-incompatible-error/59128173#59128173", "title": "How to fix hdevtools - &quot;GHC_PACKAGE_PATH is incompatible..&quot; error", "body": "<p>The <code>--no-ghc-package-path</code> solution should have worked.  However, you can just run <code>hdevtools</code> outside of Stack.  On a Linux machine, if I run the following set of commands exactly:</p>\n\n<pre><code>$ stack new advent2019\n$ cd advent2019\n$ stack build\n$ stack install hdevtools\n$ hdevtools check src/Lib.hs\n</code></pre>\n\n<p>then <code>hdevtools</code> starts without error and runs in the background.</p>\n\n<p>If your shell can't find <code>hdevtools</code>, it may be that <code>~/.local/bin</code> is not in your path, so add it or try this instead:</p>\n\n<pre><code>$ ~/.local/bin/hdevtools check src/Lib.hs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "is_accepted": true, "score": 0, "last_activity_date": 1575272199, "creation_date": 1575272199, "answer_id": 59134442, "question_id": 59124802, "link": "https://stackoverflow.com/questions/59124802/how-to-fix-hdevtools-ghc-package-path-is-incompatible-error/59134442#59134442", "title": "How to fix hdevtools - &quot;GHC_PACKAGE_PATH is incompatible..&quot; error", "body": "<p>Turns out I overlooked the <code>.cabal</code> directory in my purge. Though still had to also wipe <code>.stack</code> before installing <code>hdevtools</code>.  Also had to build test separately so I would get dependency errors.</p>\n\n<p>I don't think this is a solution for someone who uses haskell productively. Reminds me of my Windows 95 days where support told you to format and reinstall for every issue.  </p>\n"}], "owner": {"reputation": 4459, "user_id": 471614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea9a366a11e2e425394cf168c21034d8?s=128&d=identicon&r=PG", "display_name": "bdecaf", "link": "https://stackoverflow.com/users/471614/bdecaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 59134442, "answer_count": 2, "score": 0, "last_activity_date": 1575272199, "creation_date": 1575197486, "last_edit_date": 1575197841, "question_id": 59124802, "link": "https://stackoverflow.com/questions/59124802/how-to-fix-hdevtools-ghc-package-path-is-incompatible-error", "title": "How to fix hdevtools - &quot;GHC_PACKAGE_PATH is incompatible..&quot; error", "body": "<p>I'm a haskell beginner, I use the advent of code as learning examples.\nWhen setting up for this year I reinstalled stack (on a new machine, however copied most dotfiles over) and was starting from my last years notes and was not able to get hdevtools working again.</p>\n\n<p>I have set up a new project with <code>stack new advent2019</code>. In case it matters <code>stack build</code> on the \"empty\" project seems to take several minutes - seems much longer than last year. I install hdevtools with <code>stack build hdevtools</code>.</p>\n\n<p>When I run <code>stack exec hdevtools -- check src/Lib.hs</code> I get following error:</p>\n\n<pre><code>Cabal error: hdevtools: Use of GHC's environment variable GHC_PACKAGE_PATH is incompatible\nwith Cabal. Use the flag --package-db to specify a package database (it can be\nused multiple times).\n</code></pre>\n\n<p>So far I tried:</p>\n\n<ul>\n<li>I checked my shell and did an <code>rg --no-ignore</code> over my home directory to confirm <code>GHC_PACKAGE_PATH</code> is not set by me. Also over the project directory.</li>\n<li>I was not able to figure out how to use the mentioned <code>--package-db</code> flag - putting it after hdevtools I get an <code>unknown flag</code> error, putting it to stack I get an <code>invalid option</code>.</li>\n<li><code>stack exec --no-ghc-package-path hdevtools -- check src/Lib.hs</code> - mentioned <a href=\"https://github.com/hdevtools/hdevtools/issues/6\" rel=\"nofollow noreferrer\">here</a></li>\n<li>I deleted all possible related files: <code>~/.local/bin/hdevtools</code>, everything from <code>~/.stack</code>, all <code>~/.ghc*</code>.</li>\n</ul>\n\n<p>None helped with the error.</p>\n\n<p>I suppose I overlooked something obvious - however can you help point it out?</p>\n\n<p>For completeness:</p>\n\n<ul>\n<li>on OS X, 10.15.1</li>\n<li><code>stack --version</code>: <code>Version 1.9.3,  Git revision 40cf7b37526b86d1676da82167ea8758a854953b (6211 commits) x86_64 hpack-0.31.1</code></li>\n<li><code>stack ghc -- --version</code>: <code>The Glorious Glasgow Haskell Compilation System, version 8.6.5</code></li>\n<li><code>stack path</code>: </li>\n</ul>\n\n<pre><code>stack-root: /Users/me/.stack\nproject-root: /Users/me/Code/advent2019\nconfig-location: /Users/me/Code/advent2019/stack.yaml\nbin-path: /Users/me/.stack/snapshots/x86_64-osx/lts-14.16/8.6.5/bin:/Users/me/.stack/compiler-tools/x86_64-osx/ghc-8.6.5/bin:/Users/me/.stack/programs/x86_64-osx/ghc-8.6.5/bin:/usr/local/texlive/2018basic/bin/x86_64-darwin:/Users/me/.local/bin/:/Users/me/.gem/bin:/Users/me/.yarn/bin:/Users/me/Library/Python/3.7/bin/:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/Library/TeX/texbin:.:/Applications/Wireshark.app/Contents/MacOS\nprograms: /Users/me/.stack/programs/x86_64-osx\ncompiler-exe: /Users/me/.stack/programs/x86_64-osx/ghc-8.6.5/bin/ghc\ncompiler-bin: /Users/me/.stack/programs/x86_64-osx/ghc-8.6.5/bin\ncompiler-tools-bin: /Users/me/.stack/compiler-tools/x86_64-osx/ghc-8.6.5/bin\nlocal-bin: /Users/me/.local/bin\nextra-include-dirs: \nextra-library-dirs: \nsnapshot-pkg-db: /Users/me/.stack/snapshots/x86_64-osx/lts-14.16/8.6.5/pkgdb\nlocal-pkg-db: /Users/me/Code/advent2019/.stack-work/install/x86_64-osx/lts-14.16/8.6.5/pkgdb\nglobal-pkg-db: /Users/me/.stack/programs/x86_64-osx/ghc-8.6.5/lib/ghc-8.6.5/package.conf.d\nghc-package-path: /Users/me/Code/advent2019/.stack-work/install/x86_64-osx/lts-14.16/8.6.5/pkgdb:/Users/me/.stack/snapshots/x86_64-osx/lts-14.16/8.6.5/pkgdb:/Users/me/.stack/programs/x86_64-osx/ghc-8.6.5/lib/ghc-8.6.5/package.conf.d\nsnapshot-install-root: /Users/me/.stack/snapshots/x86_64-osx/lts-14.16/8.6.5\nlocal-install-root: /Users/me/Code/advent2019/.stack-work/install/x86_64-osx/lts-14.16/8.6.5\nsnapshot-doc-root: /Users/me/.stack/snapshots/x86_64-osx/lts-14.16/8.6.5/doc\nlocal-doc-root: /Users/me/Code/advent2019/.stack-work/install/x86_64-osx/lts-14.16/8.6.5/doc\ndist-dir: .stack-work/dist/x86_64-osx/Cabal-2.4.0.1\n/Users/me/Code/advent2019/.stack-work/install/x86_64-osx/lts-14.16/8.6.5/hpc\nlocal-bin-path: /Users/me/.local/bin\nghc-paths: /Users/me/.stack/programs/x86_64-osx\n</code></pre>\n"}, {"tags": ["haskell", "continuations", "quickcheck", "continuation-passing"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 2, "creation_date": 1575181756, "post_id": 59122852, "comment_id": 104475456, "body": "Have a look at the <a href=\"https://en.wikibooks.org/wiki/Haskell/Continuation_passing_style\" rel=\"nofollow noreferrer\">Haskell Wikibook chapter on continuations</a> \u2014 it\u2019s a great introduction to this topic."}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1575186274, "post_id": 59123077, "comment_id": 104476149, "body": "Thanks for taking time to help me out. Can you also please help me how to generate arbitrary functions in QuickCheck."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 1, "creation_date": 1575212221, "post_id": 59123077, "comment_id": 104481710, "body": "One question per question, please."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575242993, "post_id": 59123077, "comment_id": 104489958, "body": "personally I&#39;m lost in all the differently typed <code>k1</code>s and <code>k2</code>s,  but <code>fmap ab (Cont akk) = Cont (\\bk -&gt; akk (bk . ab))</code> or <code>fmapRaw ab akk bk = akk (bk . ab)</code> I <i>can</i> follow. :) also, you might need <code>InstanceSigs</code> for the last one."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 6, "last_activity_date": 1575220919, "last_edit_date": 1575220919, "creation_date": 1575181412, "answer_id": 59123077, "question_id": 59122852, "link": "https://stackoverflow.com/questions/59122852/how-to-write-functor-instance-of-continuation-monad/59123077#59123077", "title": "How to write Functor instance of Continuation Monad?", "body": "<p>Since there's at most one valid <code>Functor</code> for any type, it's easy to mechanically solve for it. In fact, we can make the compiler do the hard work for us:</p>\n\n<pre><code>GHCi, version 8.6.5: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :set -ddump-deriv -XDeriveFunctor\nPrelude&gt; newtype Cont k a = Cont { runCont :: (a -&gt; k) -&gt; k } deriving(Functor)\n\n==================== Derived instances ====================\nDerived class instances:\n  instance GHC.Base.Functor (Ghci1.Cont k) where\n    GHC.Base.fmap f_a1xR (Ghci1.Cont a1_a1xS)\n      = Ghci1.Cont\n          ((\\ b5_a1xT b6_a1xU\n              -&gt; (\\ b4_a1xV -&gt; b4_a1xV)\n                   (b5_a1xT\n                      ((\\ b2_a1xW b3_a1xX\n                          -&gt; (\\ b1_a1xY -&gt; b1_a1xY) (b2_a1xW (f_a1xR b3_a1xX)))\n                         b6_a1xU)))\n             a1_a1xS)\n    (GHC.Base.&lt;$) z_a1xZ (Ghci1.Cont a1_a1y0)\n      = Ghci1.Cont\n          ((\\ b6_a1y1 b7_a1y2\n              -&gt; (\\ b5_a1y3 -&gt; b5_a1y3)\n                   (b6_a1y1\n                      ((\\ b3_a1y4 b4_a1y5\n                          -&gt; (\\ b2_a1y6 -&gt; b2_a1y6)\n                               (b3_a1y4 ((\\ b1_a1y7 -&gt; z_a1xZ) b4_a1y5)))\n                         b7_a1y2)))\n             a1_a1y0)\n\n\nDerived type family instances:\n\n\nPrelude&gt;\n</code></pre>\n\n<p>That's a big mess, but it's easy to simplify (just rename some variables, remove functions that are basically <code>id</code>, and use <code>.</code> instead of writing it out by hand):</p>\n\n<pre><code>instance Functor (Cont k) where\n  fmap f (Cont k2) = Cont (\\k1 -&gt; k2 (k1 . f))\n</code></pre>\n\n<p>It may also be enlightening to consider <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Functor-Contravariant.html#t:Op\" rel=\"nofollow noreferrer\"><code>Op</code></a>, and defining your <code>Functor</code> in terms of its <code>Contravariant</code> instance:</p>\n\n<pre><code>import Data.Functor.Contravariant\n\ninstance Functor (Cont k) where\n  fmap f = Cont . getOp . contramap (getOp . contramap f . Op) . Op . runCont\n</code></pre>\n\n<p>Or possibly more easily understandable, with some extensions:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, TypeApplications #-}\n\nimport Data.Coerce\nimport Data.Functor.Contravariant\n\ninstance Functor (Cont k) where\n  fmap f = coerce (contramap @(Op k) (contramap @(Op k) f))\n</code></pre>\n\n<p>Or foregoing that typeclass entirely, and just noting that its <code>contramap = flip (.)</code>:</p>\n\n<pre><code>instance Functor (Cont k) where\n  fmap f = Cont . contramapFunc (contramapFunc f) . runCont\n    where contramapFunc = flip (.)\n</code></pre>\n\n<p>This works since doubled contravariant functors yield a covariant functor.</p>\n\n<p>Yet another option is to remove the newtype wrapper and then just play type Tetris:</p>\n\n<pre><code>instance Functor (Cont k) where\n  fmap f = Cont . fmapRaw f . runCont\n    where\n      fmapRaw :: (a -&gt; b) -&gt; ((a -&gt; k) -&gt; k) -&gt; (b -&gt; k) -&gt; k\n      fmapRaw f k2 k1 = k2 (k1 . f)\n</code></pre>\n\n<p>Here, we have an <code>a -&gt; b</code>, an <code>(a -&gt; k) -&gt; k</code>, and a <code>b -&gt; k</code>, and we need to combine them to get a <code>k</code>. If we compose the <code>b -&gt; k</code> with the <code>a -&gt; b</code>, we get an <code>a -&gt; k</code>, and we can then give that to the <code>(a -&gt; k) -&gt; k</code> to get a <code>k</code>.</p>\n"}], "owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 59123077, "answer_count": 1, "score": 4, "last_activity_date": 1575220919, "creation_date": 1575178845, "last_edit_date": 1575179743, "question_id": 59122852, "link": "https://stackoverflow.com/questions/59122852/how-to-write-functor-instance-of-continuation-monad", "title": "How to write Functor instance of Continuation Monad?", "body": "<pre><code>newtype Cont k a = Cont { runCont :: (a -&gt; k) -&gt; k }\n\ninstance Functor (Cont k) where\n  -- fmap :: (a -&gt; b) -&gt; (Cont k a) -&gt; (Cont k b)\n  fmap f (Cont akTok) = Cont $ ???\n</code></pre>\n\n<p>My doubts: </p>\n\n<ol>\n<li><p>We can only write Functor instance to any data type that can produce a type out (ex: [a], Maybe a, (y -> a)), but not for the data types that consumes a type. Now in the above data type it consumes a function that consumes <strong>a</strong> then how does this indirect consumption's can be considered as producing a type <strong>a</strong>. That means we cannot write Functor instance for <strong>(k -> a) -> k</strong>?</p></li>\n<li><p>How can I read the <strong>Cont</strong> data type. <strong>Cont</strong> produces <strong>k</strong> when it have <strong>a</strong>? (Just like Javascript XHR callback produces JSON when it have response from fetching data from server?)</p></li>\n<li><p>How to write QuickCheck test cases for <strong>Cont</strong> data type</p></li>\n</ol>\n\n<pre><code>import Test.QuickCheck\nimport Test.QuickCheck.Checkers\nimport Test.QuickCheck.Classes\n\nnewtype Cont k a = Cont { runCont :: (a -&gt; k) -&gt; k }\n\ninstance Functor (Cont k) where\n   ...\n\ninstance Applicative (Cont k) where\n   ...\n\ninstance Monad (Cont k) where\n   ...\n\ninstance (Arbitrary a, Arbitrary b) =&gt; Arbitrary (Cont k a) where\n    arbitrary = do\n        -- akTok &lt;- arbitrary -- How to generate Arbitrary functions like this\n        return $ Cont akTok\n\ninstance (Eq k, Eq a) =&gt; EqProp (Cont k a) where\n    (=-=) = eq -- How can I test this equality\n\nmain :: IO ()\nmain = do\n    let trigger :: Cont ???\n        trigger = undefined\n    quickBatch $ functor trigger\n    quickBatch $ applicative trigger\n    quickBatch $ monad trigger\n</code></pre>\n"}, {"tags": ["haskell", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12085352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc1087bfeb0328ee1b214d733274165?s=128&d=identicon&r=PG&f=1", "display_name": "marowl", "link": "https://stackoverflow.com/users/12085352/marowl"}, "edited": false, "score": 0, "creation_date": 1575186434, "post_id": 59122989, "comment_id": 104476185, "body": "WOW! I&#39;m completely thunderstruck that this is the cause of the warning. Thank you. Much love &lt;3"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 33, "user_id": 12085352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc1087bfeb0328ee1b214d733274165?s=128&d=identicon&r=PG&f=1", "display_name": "marowl", "link": "https://stackoverflow.com/users/12085352/marowl"}, "edited": false, "score": 1, "creation_date": 1575192998, "post_id": 59122989, "comment_id": 104477305, "body": "@marvinm Even assuming instances are lawful, in the general case one could use very complex logical formulas as guard conditions, and GHC can not decide whether they catch all cases -- indeed the problem is undecidable, in general. When checking patterns, GHC conservatively assumes all the guards in a group might be false, unless they end with <code>| True = ...</code> or <code>| otherwise = ...</code>. Also, if you are sure that they are exhaustive, using <code>otherwise</code> in the last one is more efficient than repeating any other check."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1575221318, "post_id": 59122989, "comment_id": 104484306, "body": "@chi Worth mentioning that that&#39;s only true in general for Boolean guards. It&#39;s possible for some pattern guards to be considered complete on their own, for example."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1575180544, "creation_date": 1575180544, "answer_id": 59122989, "question_id": 59122845, "link": "https://stackoverflow.com/questions/59122845/non-exhaustive-pattern/59122989#59122989", "title": "Non-exhaustive pattern", "body": "<p>Basically, because it's technically possible that neither of your guards <code>a == y</code> or <code>a /= y</code> are true.</p>\n\n<p>Even though it's commonly assumed that <code>Eq</code> means an equivalence relation, the Haskell Report actually doesn't define any laws for it. In particular, the \"custom\" <code>x /= y = not (x == y)</code> can be violated. (And even if it were a law, those still aren't enforced by the compiler.) Consider this:</p>\n\n<pre><code>data BadIdea = BadIdea\n\ninstance Eq BadIdea where\n    _ == _ = False\n    _ /= _ = False\n</code></pre>\n\n<p>Although you really shouldn't do that, you <em>can</em>, and then your program would crash since neither case was true.</p>\n\n<p>The easiest way for you to fix this is to replace <code>a /= y</code> with <code>otherwise</code>. This is analogous to the fact that you wouldn't write <code>if a == y then ...</code> and <code>if a /= y then ...</code> but would rather write <code>if a == y then ... else ...</code>. Since in practice, no real types have an <code>Eq</code> instance that's so pathological, this won't really change your program's behavior (and if you did use such a type, it would just consider them unequal instead of crashing).</p>\n"}], "owner": {"reputation": 33, "user_id": 12085352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc1087bfeb0328ee1b214d733274165?s=128&d=identicon&r=PG&f=1", "display_name": "marowl", "link": "https://stackoverflow.com/users/12085352/marowl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 59122989, "answer_count": 1, "score": 3, "last_activity_date": 1590962221, "creation_date": 1575178760, "last_edit_date": 1590962221, "question_id": 59122845, "link": "https://stackoverflow.com/questions/59122845/non-exhaustive-pattern", "title": "Non-exhaustive pattern", "body": "<p>I wrote a function that would take a list [a] and would group all equal values into another list - so the output would be something like [[a]]. Now I used ghci with (-W) Warnings enabled, and it seems one of my patterns isn't exhaustive - could you help me find the case my pattern doesn't match yet ?  &lt;3</p>\n\n<pre><code>h :: Eq a =&gt; [a] -&gt; [[a]]\nh [] = []\nh (x:xs) = help x xs [x] []\n where help :: Eq a =&gt; a -&gt; [a] -&gt; [a] -&gt; [a] -&gt; [[a]]\n       help _ [] s [] = [s]                            --line 15\n       help _ [] s n = s : (h n) \n       help a (y:ys) s n | a == y = help a ys (y:s) n\n                         | a /= y = help a ys s (y:n)\n</code></pre>\n\n<pre><code>test.hs:15:8: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018help\u2019: Patterns not matched: _ (_:_) _ _\n   |\n15 |        help _ [] s [] = [s]\n   |        ^^^^^^^^^^^^^^^^^^^^...\n</code></pre>\n"}, {"tags": ["haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 18252, "user_id": 154527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9367d0448b8fc3e6d7f6cd421940ac62?s=128&d=identicon&r=PG", "display_name": "Alain O&#39;Dea", "link": "https://stackoverflow.com/users/154527/alain-odea"}, "edited": false, "score": 0, "creation_date": 1610583004, "post_id": 65689281, "comment_id": 116182969, "body": "My use case is to generate JSON requests to an API. What I&#39;m looking for is a way to directly construct a value of type <b>Object Example</b> in code. The only way I could find was roundtripping the through a text encoding and parsing it back. In a sense I&#39;d like a function <code>object&#39; :: ToObject a =&gt; a -&gt; Object a</code> where instances of <b>ToObject</b> could possibly be derived or manually coded."}, {"owner": {"reputation": 18252, "user_id": 154527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9367d0448b8fc3e6d7f6cd421940ac62?s=128&d=identicon&r=PG", "display_name": "Alain O&#39;Dea", "link": "https://stackoverflow.com/users/154527/alain-odea"}, "edited": false, "score": 0, "creation_date": 1610639446, "post_id": 65689281, "comment_id": 116201582, "body": "I really appreciate your answer here, Brandon. My use case is creating values of type <b>Object Example</b> directly without having the external representation. I think the <code>unsafeObject</code> suggestion is a interesting one. <code>fromJust</code> is an ugly hack on my part here. Would <code>schemaObject :: Value -&gt; Maybe (Object a)</code> be a reasonable choice here?"}, {"owner": {"reputation": 141, "user_id": 8565175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5jYdIxZdMlY/AAAAAAAAAAI/AAAAAAAAACU/e_9FLrZl0Og/photo.jpg?sz=128", "display_name": "Brandon Chinn", "link": "https://stackoverflow.com/users/8565175/brandon-chinn"}, "reply_to_user": {"reputation": 18252, "user_id": 154527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9367d0448b8fc3e6d7f6cd421940ac62?s=128&d=identicon&r=PG", "display_name": "Alain O&#39;Dea", "link": "https://stackoverflow.com/users/154527/alain-odea"}, "edited": false, "score": 1, "creation_date": 1610640960, "post_id": 65689281, "comment_id": 116202322, "body": "Why are you using aeson-schemas for sending JSON data? It&#39;s primarily useful for parsing JSON data. Why not just use <code>toJSON</code> instead of your proposed <code>object&#39;</code> function? I&#39;m still confused about how <code>schemaObject</code> would be useful in this use-case. Regardless, <code>schemaObject</code> is not too difficult to define yourself: <code>schemaObject = parseMaybe parseJSON</code>. Maybe open an issue in the aeson-schemas github page?"}, {"owner": {"reputation": 18252, "user_id": 154527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9367d0448b8fc3e6d7f6cd421940ac62?s=128&d=identicon&r=PG", "display_name": "Alain O&#39;Dea", "link": "https://stackoverflow.com/users/154527/alain-odea"}, "edited": false, "score": 0, "creation_date": 1610642612, "post_id": 65689281, "comment_id": 116203099, "body": "It&#39;s been a while since I looked at how I was using it. I appreciate your engagement here. If this need arises again, I&#39;ll think it through and post up a proposal on the GitHub repo :)"}], "tags": [], "owner": {"reputation": 141, "user_id": 8565175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5jYdIxZdMlY/AAAAAAAAAAI/AAAAAAAAACU/e_9FLrZl0Og/photo.jpg?sz=128", "display_name": "Brandon Chinn", "link": "https://stackoverflow.com/users/8565175/brandon-chinn"}, "is_accepted": true, "score": 1, "last_activity_date": 1610473836, "creation_date": 1610473836, "answer_id": 65689281, "question_id": 59122804, "link": "https://stackoverflow.com/questions/59122804/in-aeson-schemas-how-do-you-construct-an-object-of-a-schematype-without-encoding/65689281#65689281", "title": "In aeson-schemas how do you construct an Object of a SchemaType without encoding to text and decoding back?", "body": "<p>I'm the author of <code>aeson-schemas</code>. There is currently no way to make a literal <code>Object</code>. The issue with what you're trying to do is, how do you know that the literal <code>Object</code> matches the schema? It's possible I could make an <code>unsafeObject</code> quasiquoter that would assume the object matches the schema you type it as.</p>\n<p>I know this is old, but if you're still having problems with this, what exactly is your use-case? Often times, you'll be loading JSON data from an external source, like an API or a file.</p>\n"}], "owner": {"reputation": 18252, "user_id": 154527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9367d0448b8fc3e6d7f6cd421940ac62?s=128&d=identicon&r=PG", "display_name": "Alain O&#39;Dea", "link": "https://stackoverflow.com/users/154527/alain-odea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 65689281, "answer_count": 1, "score": 1, "last_activity_date": 1610473836, "creation_date": 1575178304, "last_edit_date": 1575240581, "question_id": 59122804, "link": "https://stackoverflow.com/questions/59122804/in-aeson-schemas-how-do-you-construct-an-object-of-a-schematype-without-encoding", "title": "In aeson-schemas how do you construct an Object of a SchemaType without encoding to text and decoding back?", "body": "<p>I'm using <a href=\"https://hackage.haskell.org/package/aeson-schemas-1.0.3\" rel=\"nofollow noreferrer\">aeson-schemas-1.0.3</a> and I want to construct values of <strong>Object Example</strong> without round-tripping through an external serialized representation. It seems like a hack and I'm worried about the performance impact.</p>\n\n<p>I have this schema defined:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Example = [schema|\n  {\n    example: Text,\n  }\n|]\n</code></pre>\n\n<p>I want to be able to write something like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>coerceJson $ object [ \"example\" .= (\"Example\" :: Text) ]\n</code></pre>\n\n<p>I have a workaround which does allow that, but it involves encoding to a ByteString and decoding to the Object of the desired SchemaType, which seems expensive and inelegant:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>coerceJson :: FromJSON a =&gt; Value -&gt; a\ncoerceJson = fromJust . decode . encode\n</code></pre>\n\n<p>This seems terribly inefficient.</p>\n\n<p>Here's an <a href=\"http://www.sscce.org/\" rel=\"nofollow noreferrer\">SSCCE (Short, Self Contained, Correct (Compilable), Example)</a> with my hack workaround employed. It works, but I'm convinced there's a better solution.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>#!/usr/bin/env stack\n{- stack\n    runghc\n    --resolver lts-14.15\n    --package aeson-schemas-1.0.3\n    --package aeson\n    --package text\n-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE QuasiQuotes #-}\n{-# LANGUAGE TypeFamilies #-}\n\nimport Data.Aeson (decode, encode, object, (.=), FromJSON, Value)\nimport Data.Aeson.Schema\nimport Data.Aeson.Text (encodeToLazyText)\nimport Data.Maybe (fromJust)\nimport qualified Data.Text.IO as T\nimport Data.Text(Text)\nimport Data.Text.Lazy (toStrict)\n\n\nmain :: IO ()\nmain = do\n  let example = coerceJson $ object [ \"example\" .= (\"Example\" :: Text) ]\n  useExample example\n\n\nuseExample :: Object Example -&gt; IO ()\nuseExample example = T.putStrLn $ toStrict $ encodeToLazyText $ object [\n    \"example\" .= [get| example.example|]\n  ]\n\ncoerceJson :: FromJSON a =&gt; Value -&gt; a\ncoerceJson = fromJust . decode . encode\n\n\ntype Example = [schema|\n  {\n    example: Text,\n  }\n|]\n</code></pre>\n\n<p>In aeson-schemas how do you construct an Object of a SchemaType without encoding to text and decoding back?</p>\n"}, {"tags": ["haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1575190665, "post_id": 59122760, "comment_id": 104476873, "body": "<i>[(1,2),(3,4)] or [(1,3),(2,4)]</i> what do you mean by &quot;or&quot; exactly? Is this &quot;I don&#39;t care which of the results is returned&quot;, or &quot;it should return one of the results depending on some condition&quot;, oor &quot;it should return all of the results&quot;, or something else?"}], "answers": [{"comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1575429787, "post_id": 59123972, "comment_id": 104560308, "body": "Downvoting isn&#39;t about getting angry. Downvoting helps remove the dross from the valuable."}], "tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1575190016, "creation_date": 1575190016, "answer_id": 59123972, "question_id": 59122760, "link": "https://stackoverflow.com/questions/59122760/how-to-extract-a-list-of-tuple-from-a-list-with-each-element-paired-with-exactly/59123972#59123972", "title": "How to extract a list of tuple from a list with each element paired with exactly one other element?", "body": "<p>StackOverflow is not a service where people will just write code for you. You have to show your attemts or any effort that you applied to solve the task and demonstrate us problems that you've encountered on that way.</p>\n\n<p>If you just ask people to solve your task, they'll get angry at you (-3 score of this question states exactly that), and your question will be closed. So make sure you demonstrate enough effort in solving a task when asking about it here.</p>\n\n<p>BTW, I'll give you a hint:</p>\n\n<pre><code>pairUp :: [a] -&gt; [(a, a)]\npairUp [] = [] -- obvious case\npairUp [x] = error \"Odd-length list!\"\npairUp (x:y:xs) = ...\n</code></pre>\n\n<p>You have to complete the last case. Here you have first two elements <code>x</code> and <code>y</code>, and also the tail list of all other elements. You have to combine the first two elements in a pair and also process the tail in the same way. You will need an understanding <a href=\"http://learnyouahaskell.com/recursion#hello-recursion\" rel=\"nofollow noreferrer\">recursion</a> to accomplish the task.</p>\n"}], "owner": {"reputation": 1, "user_id": 12462678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mQZJmz6zhb4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcWQUMfzXbCWXGtjBJrE_uNwlRwVw/photo.jpg?sz=128", "display_name": "lynn", "link": "https://stackoverflow.com/users/12462678/lynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1575190016, "creation_date": 1575177914, "question_id": 59122760, "link": "https://stackoverflow.com/questions/59122760/how-to-extract-a-list-of-tuple-from-a-list-with-each-element-paired-with-exactly", "title": "How to extract a list of tuple from a list with each element paired with exactly one other element?", "body": "<p>I am new to Haskell and I got a question. How can I write a function that takes an even length list of values and returns a list of tuples? Each element in the list should be paired with exactly one other element.</p>\n\n<p>For example : [1, 2, 3, 4] would give [(1,2),(3,4)] or [(1,3),(2,4)]or[(1,4),(2,3)]</p>\n"}, {"tags": ["list", "haskell", "range"], "comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1575177557, "post_id": 59122686, "comment_id": 104474884, "body": "Can you provide one such very very long and quite convoluted solution? Perhaps then we can focus on shortening it or look at where the standard library or another solution strategy may help in shortening the solution."}, {"owner": {"reputation": 256, "user_id": 4376737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5NOrP.jpg?s=128&g=1", "display_name": "ar1a", "link": "https://stackoverflow.com/users/4376737/ar1a"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1575177653, "post_id": 59122686, "comment_id": 104474895, "body": "<a href=\"https://www.rosettacode.org/wiki/Range_extraction#Haskell\" rel=\"nofollow noreferrer\">rosettacode.org/wiki/Range_extraction#Haskell</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1575259982, "post_id": 59122686, "comment_id": 104493003, "body": "Is your actual goal to solve that Rosetta Code problem?"}], "answers": [{"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1575549524, "last_edit_date": 1575549524, "creation_date": 1575195054, "answer_id": 59124529, "question_id": 59122686, "link": "https://stackoverflow.com/questions/59122686/how-do-you-convert-a-list-of-numbers-into-a-list-of-ranges-in-haskell/59124529#59124529", "title": "How do you convert a list of numbers into a list of ranges in haskell?", "body": "<p>So one might do it like the <a href=\"https://stackoverflow.com/a/59075309/4543207\">idea from @Will Ness</a> on the stateful folding or <a href=\"https://stackoverflow.com/a/59117483/4543207\">mine under the same answer</a>. All explanations are to be found there. Besides, if you get curious and want to read more about it then have a look at <a href=\"https://en.wikibooks.org/wiki/Haskell/Continuation_passing_style\" rel=\"nofollow noreferrer\">Haskell Continuation Passing Style page</a>. I am currently trying to gerealize this in such a way that we can have a variant of <code>foldr1</code> in a stateful manner. A <code>foldS :: Foldable t =&gt; (a -&gt; a -&gt; b) -&gt; t a -&gt; b</code>. However this is still not general stateful folding. It's just tailored to this question. </p>\n\n<pre><code>ranges :: (Ord a, Num a) =&gt; [a] -&gt; [[a]]\nranges xs = foldr go return xs $ []\n            where\n            go :: (Ord a, Num a) =&gt; a -&gt; ([a] -&gt; [[a]]) -&gt; ([a] -&gt; [[a]])\n            go c f = \\ps -&gt; let rrs@(r:rs) = f [c] \n                            in case ps of \n                               []  -&gt; [c]:r:rs\n                               [p] -&gt; if p + 1 == c then rrs else [p]:(c:r):rs\n\n*Main&gt; ranges [1,2,3,5,6,7,8,9,11,12,15,16,17]\n[[1,3],[5,9],[11,12],[15,17]]\n</code></pre>\n\n<p>I haven't had time to test any edge cases. All advices are welcome.</p>\n"}, {"comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1575221108, "post_id": 59127380, "comment_id": 104484233, "body": "<code>-- 14 sic!</code> :). Yet <code>[14..14]</code> gives just <code>[14]</code> if you attempt to reconstruct the original list. So shouldn&#39;t be a problem. ie <code>foldMap (\\[x,y] -&gt; [x..y])</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1575241196, "post_id": 59127380, "comment_id": 104489594, "body": "yes, the representation of singleton ranges wasn&#39;t specified in the Q. as long as all the needed information is present, it doesn&#39;t matter. BTW as written, the segments-joining <code>foldr</code> isn&#39;t lazy (i.e. top-down, or left-to-right), as it should be. (<code>head.head.ranges $ [1..]</code> shouldn&#39;t hang). food for thought! (or just some <code>~</code> patterns thrown around for good measure)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1575259393, "post_id": 59127380, "comment_id": 104492896, "body": "I think it&#39;s cleaner to go <code>a -&gt; (a,a)</code> to start (map the diagonal function). Then you can merge up on endpoints and not monkey around with the surprise addition and subtraction."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1575259930, "post_id": 59127380, "comment_id": 104492993, "body": "Also, the representation using pairs, or <code>Either a (a,a)</code>, is much better than one using lists."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575263945, "post_id": 59127380, "comment_id": 104493807, "body": "of course it&#39;s better, as it&#39;s much more tight. I meant &quot;doesn&#39;t matter&quot; as in &quot;doesn&#39;t lose anything&quot;. &quot;monkeying around&quot; that&#39;s the playful fun of FP! the austerity of tight types and tight codes in Haskell is another layer on top of that. :) and I definitely had in mind another possible processing step converting the lists into whatever, as <i>the OP would want</i>, all the interim steps hidden well inside. (what do you mean by map the diagonal? I actually envisioned the short 1-intervals arranged as the diagonal, when I thought it up)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1575264030, "post_id": 59127380, "comment_id": 104493833, "body": "@dfeuer (contd.) re addition, I thought about zipping with tail but that didn&#39;t immediately work with the singleton intervals, and the addition did. also, my goals were correctness <i>and</i> simplicity and immediate clarity of the solution. that&#39;s why the first one isn&#39;t even properly lazy - that one already is more obscure."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1575264715, "post_id": 59127380, "comment_id": 104494018, "body": "To be really tight and also properly lazy is a little trickier, and I believe it requires a departure from Haskell lists as a result type."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1575265234, "post_id": 59127380, "comment_id": 104494149, "body": "@dfeuer isn&#39;t my 2nd solution as lazy as yours? I thought it is. also, I don&#39;t see any difference between <code>(a,a)</code> and <code>[a,a]</code>."}, {"owner": {"reputation": 256, "user_id": 4376737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5NOrP.jpg?s=128&g=1", "display_name": "ar1a", "link": "https://stackoverflow.com/users/4376737/ar1a"}, "edited": false, "score": 0, "creation_date": 1575266962, "post_id": 59127380, "comment_id": 104494694, "body": "All the solutions look quite good, but i think yours wins out! thanks!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1575270330, "post_id": 59127380, "comment_id": 104495738, "body": "@dfeuer ah, wait, of course there&#39;s a difference. (\uff0d\u2038\u10da) But I have a feeling it makes no difference here in this specific algorithm. any access to the second element forces the input list till the next segment&#39;s start is discovered, and that automatically closes the previous segment list anyway. the drawback might be that the <code>[a,a]</code> allows a nonsensical call like <code>length . head . ranges</code> which is impossible with the <code>(a,a)</code>, as it should be. perhaps that&#39;s what you meant."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575288137, "post_id": 59127380, "comment_id": 104503893, "body": "(that  (\uff0d\u2038\u10da) was Google&#39;s suggestion for the ASCII variant of \ud83e\udd26 , if you were wondering)."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1575290775, "post_id": 59127380, "comment_id": 104505267, "body": "I have just discovered by chance that I had already done <a href=\"https://stackoverflow.com/a/53191704/4543207\">a singleton version</a> under a very similar question. I must be going amnesic :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1575306201, "post_id": 59127380, "comment_id": 104513387, "body": "@Redu I also answered a few questions like that in the past. the first one I remember vaguely also had <a href=\"https://stackoverflow.com/a/14403413/849891\">an answer</a> by <a href=\"https://stackoverflow.com/users/1011995/daniel-fischer\">Daniel Fischer</a>, with a lazy foldr-based solution. of course here the ranges are collapsed to two endpoints, so it&#39;s little bit different, though yes, not that much."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 4, "last_activity_date": 1575270646, "last_edit_date": 1575270646, "creation_date": 1575216744, "answer_id": 59127380, "question_id": 59122686, "link": "https://stackoverflow.com/questions/59122686/how-do-you-convert-a-list-of-numbers-into-a-list-of-ranges-in-haskell/59127380#59127380", "title": "How do you convert a list of numbers into a list of ranges in haskell?", "body": "<p>So we have a list of numbers,</p>\n\n<pre><code>xs = [1,2,3,5,6,7,8,9,11,12,14,16,17]     -- 14 sic!\n</code></pre>\n\n<p>We turn it into a list of segments,</p>\n\n<pre><code>ys = [[x,x+1] | x &lt;- xs]\n  -- [[1,2], [2,3], [3,4], [5,6], ..., [11,12], [12,13], [14,15], [16,17], [17,18] ]\n</code></pre>\n\n<p>we join the touching segments,</p>\n\n<pre><code>zs = foldr g [] ys\n  -- [[1,4], [5,10], [11,13], [14,15], [16,18]]\n  where\n  g [a,b] []                  =  [[a,b]]\n  g [a,b] r@([c,d]:t) | b==c  =  [a,d]:t\n                 | otherwise  =  [a,b]:r\n</code></pre>\n\n<p>and we subtract <em>1</em> from each segment's ending value,</p>\n\n<pre><code>ws = [[a,b-1] | [a,b] &lt;- zs]\n  -- [[1,3], [5,9], [11,12], [14,14], [16,17]]\n</code></pre>\n\n<p>All in all we get</p>\n\n<pre><code>ranges :: (Num t, Eq t) =&gt; [t] -&gt; [[t]]\nranges  =  map (\\[a,b] -&gt; [a,b-1]) . foldr g [] . map (\\x -&gt; [x,x+1]) \n  where\n  g [a,b] []                  =  [[a,b]]\n  g [a,b] r@([c,d]:t) | b==c  =  [a,d]:t\n                 | otherwise  =  [a,b]:r\n</code></pre>\n\n<p>Simple and clear.</p>\n\n<p><em>edit:</em> or, to be properly lazy,</p>\n\n<pre><code>  where\n  g [a,b] r = [a,x]:y\n       where\n       (x,y) = case r of ([c,d]:t) | b==c  -&gt; (d,t)   -- delay forcing\n                         _                 -&gt; (b,r)\n</code></pre>\n\n<p><em>update:</em> as <a href=\"https://stackoverflow.com/users/1477667/dfeuer\">dfeuer</a> notes, <code>(a,a)</code> type is better than <code>[a,a]</code>. Wherever <code>[P,Q]</code> appears in this code, replace it with <code>(P,Q)</code>. This will improve the code, with zero cost to readability.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575263648, "post_id": 59132863, "comment_id": 104493742, "body": "<code>| x == l + 1</code> ha! you add 1 too! it&#39;s the same addition, really. :) :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575264583, "post_id": 59132863, "comment_id": 104493984, "body": "@WillNess, sure, but it&#39;s confined to the check. It doesn&#39;t have to be undone later, which is confusing."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1575262683, "creation_date": 1575262683, "answer_id": 59132863, "question_id": 59122686, "link": "https://stackoverflow.com/questions/59122686/how-do-you-convert-a-list-of-numbers-into-a-list-of-ranges-in-haskell/59132863#59132863", "title": "How do you convert a list of numbers into a list of ranges in haskell?", "body": "<p>I would definitely prefer the alternative representation to the first one you give.</p>\n\n<pre><code>ranges :: (Num a, Eq a) =&gt; [a] -&gt; [(a,a)]\nranges [] = []\nranges (a : as) = ranges1 a as\n\n-- | A version of 'ranges' for non-empty lists, where\n-- the first element is supplied separately.\nranges1 :: (Num a, Eq a) =&gt; a -&gt; [a] -&gt; [(a,a)]\nranges1 a as = (a, b) : bs\n  where\n    -- Calculate the right endpoint and the rest of the\n    -- result lazily, when needed.\n    (b, bs) = finish a as\n\n-- | This takes the left end of the current interval\n-- and the rest of the list and produces the right endpoint of\n-- that interval and the rest of the result.\nfinish :: (Num a, Eq a) =&gt; a -&gt; [a] -&gt; (a, [(a, a)])\nfinish l [] = (l, [])\nfinish l (x : xs)\n  | x == l + 1 = finish x xs\n  | otherwise = (l, ranges1 x xs)\n</code></pre>\n\n<p>To solve the <a href=\"https://www.rosettacode.org/wiki/Range_extraction\" rel=\"nofollow noreferrer\">Rosetta Code problem</a> linked in the comment above, this isn't really <em>quite</em> an optimal representation. I'll try to explain how to match the representation more precisely later.</p>\n"}], "owner": {"reputation": 256, "user_id": 4376737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5NOrP.jpg?s=128&g=1", "display_name": "ar1a", "link": "https://stackoverflow.com/users/4376737/ar1a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 59127380, "answer_count": 3, "score": 4, "last_activity_date": 1575549524, "creation_date": 1575176938, "question_id": 59122686, "link": "https://stackoverflow.com/questions/59122686/how-do-you-convert-a-list-of-numbers-into-a-list-of-ranges-in-haskell", "title": "How do you convert a list of numbers into a list of ranges in haskell?", "body": "<p>Say you have a list of numbers, <code>[1,2,3,5,6,7,8,9,11,12,15,16,17]</code></p>\n\n<p>and you want a function that takes that as an input and returns something like</p>\n\n<p><code>[[1,3],[5,9],[11,12],[15,17]]</code> or alternatively maybe\n<code>[(1,3), (5,9), (11,12), (15,17)]</code></p>\n\n<p>how would this be done? all of the solutions i've found online are very very long and quite convoluted, when this seems like such an easy problem for a functional language like haskell</p>\n"}, {"tags": ["haskell", "monads", "coroutine", "continuations"], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 2, "last_activity_date": 1575164401, "creation_date": 1575164401, "answer_id": 59121850, "question_id": 59121370, "link": "https://stackoverflow.com/questions/59121370/cps-coroutines-why-does-this-example-require-exhaust/59121850#59121850", "title": "CPS Coroutines: Why does this example require exhaust?", "body": "<p>It doesn't look to me like it works. The example program you linked to ends with</p>\n\n<pre><code>example = runCoroutineT $ do\n    fork $ replicateM_ 3 (printOne 3)\n    fork $ replicateM_ 4 (printOne 4)\n    replicateM_ 2 (printOne 2)\n</code></pre>\n\n<p>But when run, not all of the 4s are printed:</p>\n\n<pre><code>3\n4\n3\n2\n4\n3\n2\n4\n</code></pre>\n\n<p>There should be four of them!</p>\n\n<p>The point of <code>exhaust</code> is to finish off all threads that are waiting to run, and when you run without it some threads may not get to finish.</p>\n"}], "owner": {"reputation": 5590, "user_id": 3686755, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976c04703d1b52c15d067c0556d5064c?s=128&d=identicon&r=PG", "display_name": "neshkeev", "link": "https://stackoverflow.com/users/3686755/neshkeev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 59121850, "answer_count": 1, "score": 1, "last_activity_date": 1575164401, "creation_date": 1575158122, "last_edit_date": 1575161193, "question_id": 59121370, "link": "https://stackoverflow.com/questions/59121370/cps-coroutines-why-does-this-example-require-exhaust", "title": "CPS Coroutines: Why does this example require exhaust?", "body": "<p>I am trying to figure out <a href=\"https://en.wikibooks.org/wiki/Haskell/Continuation_passing_style#Example:_coroutines\" rel=\"nofollow noreferrer\">the coroutines example</a> from the <strong>CPS</strong> chapter from <strong>wikibooks/Haskell</strong>, but I cannot understand why the <code>runCoroutineT</code> function requires <code>. (&lt;* exhaust)</code> at the end, if I change the function from</p>\n\n<pre><code>runCoroutineT = flip evalStateT [] . flip runContT return . runCoroutineT' . (&lt;* exhaust)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>runCoroutineT = flip evalStateT [] . flip runContT return . runCoroutineT'\n</code></pre>\n\n<p>the example seems to <a href=\"https://repl.it/repls/ExtrasmallInsignificantRom\" rel=\"nofollow noreferrer\">keep working</a>(Take a look at the 56-th line)\nCould anyone please explain if there is a mistake?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575146285, "post_id": 59119586, "comment_id": 104469728, "body": "You appear to be trying to call the <code>IORef</code> bound to <code>count</code> as if it were a function. Aside from that, it seems it would be a lot easier to populate a list using <code>repcountIORIban</code>, then map <code>forkIO</code> over it."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "edited": false, "score": 0, "creation_date": 1575145069, "post_id": 59119651, "comment_id": 104469459, "body": "Even if I change it to that, the compilers gives me an error. Now it says that extra is not is scope in the other if/then/else block."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "edited": false, "score": 0, "creation_date": 1575462183, "post_id": 59119651, "comment_id": 104573361, "body": "@JoesdeJonge That <code>extra</code> is definitely in scope where I wrote the <code>...</code> in the code above. I can not guess which error you are getting, so I can not provide any help. You could open a new question with that new error."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1575462220, "post_id": 59119651, "comment_id": 104573385, "body": "@schuelermine Why would <code>extra</code> not be on scope, once the code is changed as shown above?"}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "reply_to_user": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "edited": false, "score": 0, "creation_date": 1575470389, "post_id": 59119651, "comment_id": 104578215, "body": "@JoesdeJonge can you post your new code [like on pastebin]?"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1575143130, "creation_date": 1575143130, "answer_id": 59119651, "question_id": 59119586, "link": "https://stackoverflow.com/questions/59119586/how-does-the-syntax-in-a-if-then-else-within-a-do-block-work-in-haskell/59119651#59119651", "title": "How does the syntax in a if/then/else within a do block work in Haskell", "body": "<p>This is incorrect, you can't <code>let</code> after <code>then</code>/<code>else</code> and expect those <code>let</code>s to define bindings which are visible below.</p>\n\n<pre><code>do if rest &gt; number\n     then let extra = 1  -- wrong, needs a \"do\", or should be \"let .. in ..\"\n     else let extra = 0\n   ... -- In any case, extra is not visible here\n</code></pre>\n\n<p>Try this instead</p>\n\n<pre><code>do let extra = if rest &gt; number\n               then 1\n               else 0\n   ...\n</code></pre>\n\n<p>Further, you need <code>then do</code> if after that you need to perform two or more actions.</p>\n\n<pre><code>if number + 1 &lt; amountthreads\n  then do\n    something\n    somethingElse\n  else         -- use do here if you have two or more actions\n    ...\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575143130, "creation_date": 1575142688, "question_id": 59119586, "link": "https://stackoverflow.com/questions/59119586/how-does-the-syntax-in-a-if-then-else-within-a-do-block-work-in-haskell", "title": "How does the syntax in a if/then/else within a do block work in Haskell", "body": "<p>I'm trying to make the folowing function:</p>\n\n<pre><code>repcountIORIban :: IORef -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Lock -&gt; IORef -&gt; Lock -&gt; Int -&gt; Int -&gt; IO ()\nrepcountIORIban count number lower modulus amountthreads lock done lock2 difference rest = do\n        if rest &gt; number\n            then let extra = 1\n            else let extra = 0\n        if number + 1 &lt; amountthreads\n            then\n                forkIO $ realcountIORIban(count lower (lower + difference + extra - 1) modulus lock done lock2)\n                repcountIORIban (count (number + 1) (lower + difference + extra) modulus amountthreads lock done lock2 difference rest)\n            else\n                forkIO $ realcountIORIban(count lower (lower + difference + extra - 1) modulus lock done lock2)\n</code></pre>\n\n<p>But I can't run the program from which this function is a part of. It gives me the error:</p>\n\n<pre><code>error: parse error on input `else'\n    |\n113 |             else let extra = 0\n    |             ^^^^\n</code></pre>\n\n<p>I've got this error a lot of times withing my program but I don't know what I'm doing wrong.</p>\n"}, {"tags": ["haskell", "visual-studio-code"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1575138998, "post_id": 59118764, "comment_id": 104467995, "body": "You need to install the <b>package</b> that includes the <b>module</b> <code>Crypto.Hash.SHA1</code>.  A module with this name might be included in many packages, but you probably want to install the <code>cryptohash</code> package.  As for how to install packages, that varies tremendously by your setup."}, {"owner": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1575139323, "post_id": 59118764, "comment_id": 104468076, "body": "@ThomasM.DuBuisson I saw that I had to use Cabal install cryptonite. But now I&#39;ve got another problem. It says Could not load module <code>Crypto.Hash.SHA1&#39; it is a hidden module in the package </code>cryptonite-0.26&#39;. How can I solve this?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1575139440, "post_id": 59118764, "comment_id": 104468097, "body": "I didn&#39;t mention cryptonite precisely because it does not expose said module.  You need to install a package that <i>does</i> expose the module you want - such as the cryptohash package I suggested. There is no reasonable accessing of a hidden module from a package."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1575139535, "post_id": 59118764, "comment_id": 104468119, "body": "Or you can use the sha1 implementation from the cryptonite modules via <code>Crypto.Hash</code> and <code>Crypto.Hash.Algorithms</code>, but I had figured you didn&#39;t want to change the code you already have that probably assumes the cryptohash api."}], "owner": {"reputation": 145, "user_id": 10788028, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209163503639282/picture?type=large", "display_name": "Joes de Jonge", "link": "https://stackoverflow.com/users/10788028/joes-de-jonge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575136448, "creation_date": 1575136448, "question_id": 59118764, "link": "https://stackoverflow.com/questions/59118764/could-not-find-module-crypto-hash-sha1-in-haskell-in-visual-studio-code", "title": "Could not find module `Crypto.Hash.SHA1&#39; in Haskell in Visual Studio Code", "body": "<p>I want to run my Haskell program in the terminal of Visual Studio Code, but when I try to do this I get this error back:</p>\n\n<pre><code>Could not find module `Crypto.Hash.SHA1'\n\n        Use -v to see a list of the files searched for.\n       |\n    14 |     import Crypto.Hash.SHA1\n       |     ^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>How can I solve this problem?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "is_accepted": true, "score": 0, "last_activity_date": 1575590198, "last_edit_date": 1575590198, "creation_date": 1575588860, "answer_id": 59204760, "question_id": 59118157, "link": "https://stackoverflow.com/questions/59118157/how-to-draw-lines-in-haskell/59204760#59204760", "title": "How to draw lines in Haskell?", "body": "<p>This is called <em>\"rasterization\"</em>. There is a simple trick by which libraries such as <a href=\"https://archives.haskell.org/projects.haskell.org/diagrams/\" rel=\"nofollow noreferrer\"><code>diagrams</code></a> rasterize their vector images, and I will let you in on it. Then you will have easy time writing the code.</p>\n\n<p>The trick is this:</p>\n\n<ol>\n<li>Define a function that determines if a point with given coordinates should be painted black or white.</li>\n<li>Map this function all over the grid.</li>\n</ol>\n\n<p>For example, suppose you have a line <code>Line (Point 1 2) (Point 3 4)</code>. You must be able to answer the question: should <code>Point 2 3</code> be black? Does the given line pass close enough to the given point for it to be painted black?</p>\n\n<pre><code>shouldIPaint :: Point -&gt; Line -&gt; Colour\n</code></pre>\n\n<p>Now, if you have 2 lines, and either one is close enough, you paint, and so on for any number of lines.</p>\n\n<pre><code>overlay :: [Colour] -&gt; Colour\n\nshouldIPaintMany :: Point -&gt; [Line] -&gt; Colour\nshouldIPaintMany point = overlay . fmap (shouldIPaint point)\n</code></pre>\n\n<p>Seeing how a view is a collection of points, you need to determine the value of this function for each point. To this end, you may first create a view where every point holds its coordinates as values, then convert the coordinates to colour.</p>\n\n<pre><code>initialView :: Point -&gt; View Point\n\nsolution :: Point -&gt; [Line] -&gt; View Colour\nsolution point lines = fmap (flip shouldIPaintMany lines) (initialView point)\n</code></pre>\n\n<p>Done! And the beauty here is that it is straightforward to extend this solution to paint in 3 dimensional space, or to paint circles as well as lines, and so on.</p>\n\n<hr>\n\n<p>I do not really expect you to be able to fill in the missing parts all by yourself. You may have any number of questions by now, but these will be specific, sharp questions. Some of them will be about Mathematics, others will be about Haskell. If you want to be successful, you should write down these sharp questions, then try to answer them, and if you cannot, then ask them here on Stack Overflow or, maybe, at <a href=\"https://math.stackexchange.com\">Mathematics Stack Exchange</a>. You can start by writing me a comment below this answer, and I will tell you if you are on the right track. It is also a possibility that you will not understand the solution I offered at first, but you really need to persist about it, and ask me if something does not make sense despite your best effort.</p>\n"}], "owner": {"reputation": 13, "user_id": 12460924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6faa68288abad41b22932cdb983f546?s=128&d=identicon&r=PG&f=1", "display_name": "Vorteo", "link": "https://stackoverflow.com/users/12460924/vorteo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 59204760, "answer_count": 1, "score": -3, "last_activity_date": 1575590198, "creation_date": 1575131930, "last_edit_date": 1575317767, "question_id": 59118157, "link": "https://stackoverflow.com/questions/59118157/how-to-draw-lines-in-haskell", "title": "How to draw lines in Haskell?", "body": "<p>I have to write a function drawLines that creates a view of defined lines. The first parameter is a tuple (columns, rows) defining the size of the resulting view. Left top corner has a coordinate (0,0). The second argument is a list of lines.</p>\n\n<p>There is function for print:</p>\n\n<pre><code>pt :: Result -&gt; IO ()\npt x = putStr (concat (map (++\"\\n\") x))\n</code></pre>\n\n<p>Function:</p>\n\n<pre><code>drawLines :: (Int,Int) -&gt; [Line] -&gt; Result\n</code></pre>\n\n<p>Data types representing a point and a line:</p>\n\n<pre><code>data Point = Point Int Int\ndata Line = Line Point Point\n</code></pre>\n\n<p>There is IO example:</p>\n\n<pre><code>Prelude&gt;pt(drawLines (31,15) [Line (Point x y) (Point 15 7)|(x,y)&lt;-concat [[(x,y)|y&lt;-[0,7,14]]|x&lt;-[0,15,30]]])\n\n ##.............#.............##\n ..##...........#...........##..\n ....##.........#.........##....\n .....###.......#.......###.....\n ........##.....#.....##........\n ..........###..#..###..........\n .............#####.............\n ###############################\n .............#####.............\n ..........###..#..###..........\n ........##.....#.....##........\n .....###.......#.......###.....\n ....##.........#.........##....\n ..##...........#...........##..\n ##.............#.............##\n</code></pre>\n\n<p>Please help me. I tried something, but it doesn't work. Can someone explain to me how it works.\nI tried this: </p>\n\n<pre><code>type Result = [String]\npt :: Result -&gt; IO () \npt x = putStr (concat (map (++\"\\n\") x)) \ndrawLines :: (Int,Int) -&gt; [(Int,Int)] -&gt; Result\ndrawLines (0,0) (x:xs) = [] drawLines (a,b) [] = [] \ndrawLines (a,b) (x:xs) =[ [if a == fst x &amp;&amp; b == snd x then 'x' else '.' | b \n&lt;- [1..b]]| a &lt;- [1..a]] ++ drawLines (a,b) xs\n</code></pre>\n\n<p>I'm a beginner in Haskell language.</p>\n\n<p>Any advice will be good for me.\nThank you.</p>\n"}, {"tags": ["haskell", "optparse-applicative"], "answers": [{"tags": [], "owner": {"reputation": 616, "user_id": 8578679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CeZ5Z.png?s=128&g=1", "display_name": "Ruifeng Xie", "link": "https://stackoverflow.com/users/8578679/ruifeng-xie"}, "is_accepted": false, "score": 0, "last_activity_date": 1575135308, "creation_date": 1575135308, "answer_id": 59118601, "question_id": 59117975, "link": "https://stackoverflow.com/questions/59117975/how-does-optparse-applicative-bash-autocompletion-work/59118601#59118601", "title": "How does optparse-applicative bash autocompletion work?", "body": "<p>I have not tested this, but after reading the documentation, it seems to me that by calling <code>execParser</code> in <code>main</code>, your program automatically supports the required options for command complete. You just need to run your program with <code>--bash-completion-script</code> as documented to generate a shell script, and then load that script to bash. </p>\n"}, {"tags": [], "owner": {"reputation": 634, "user_id": 4575363, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/QUCj2.jpg?s=128&g=1", "display_name": "The Hoff", "link": "https://stackoverflow.com/users/4575363/the-hoff"}, "is_accepted": true, "score": 1, "last_activity_date": 1575207594, "creation_date": 1575207594, "answer_id": 59126063, "question_id": 59117975, "link": "https://stackoverflow.com/questions/59117975/how-does-optparse-applicative-bash-autocompletion-work/59126063#59126063", "title": "How does optparse-applicative bash autocompletion work?", "body": "<p>After RTFM'ing a bit I found out how to configure the auto completion.\n<code>completeWith</code> is applied when constructing the parsers for the individual arguments.\nLike so:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data CompileArgs = CompileArgs\n  {\n    debug :: Bool,\n    optimizations :: OptimizationLevel,\n    file :: String\n  }\n  deriving (Show, Read)\n\ncompileArgsParser :: Parser CompileArgs\ncompileArgsParser = CompileArgs\n  &lt;$&gt; switch (\n    long \"debug\" &lt;&gt;\n    help \"Outputs object and assembly files\")\n  &lt;*&gt; option auto (\n    long \"optimization-level\" &lt;&gt;\n    value All &lt;&gt;\n    metavar \"LEVEL\" &lt;&gt;\n    help \"all | none, default: all\" &lt;&gt;\n    completeWith [\"all\", \"none\"])\n  &lt;*&gt; argument str (\n    metavar \"FILE\" &lt;&gt;\n    help \"brainfuck source code\" &lt;&gt;\n    action \"file\")\n  &lt;**&gt; helper\n</code></pre>\n\n<p><code>action</code> is an instruction to bash on how auto complete. <code>\"file\"</code> means auto complete with any file or directory. See <a href=\"https://www.gnu.org/software/bash/manual/html_node/Programmable-Completion-Builtins.html\" rel=\"nofollow noreferrer\">this</a> page for more info.</p>\n\n<p>In order for these auto completions to kick in you need to generate a script and make sure that script is sourced. By convention it's placed under <code>/etc/bash_completion.d/</code> when using bash.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>brainfuck --bash-completion-script `which brainfuck` | sudo tee /etc/bash_completion.d/brainfuck\n</code></pre>\n\n<p>in my case where my program is called <code>brainfuck</code>.</p>\n"}], "owner": {"reputation": 634, "user_id": 4575363, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/QUCj2.jpg?s=128&g=1", "display_name": "The Hoff", "link": "https://stackoverflow.com/users/4575363/the-hoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 59126063, "answer_count": 2, "score": 3, "last_activity_date": 1575207594, "creation_date": 1575130410, "question_id": 59117975, "link": "https://stackoverflow.com/questions/59117975/how-does-optparse-applicative-bash-autocompletion-work", "title": "How does optparse-applicative bash autocompletion work?", "body": "<p>I'm building a brainfuck compiler. The executable accepts two commands <code>$ brainfuck compile ...</code> and <code>$ brainfuck run</code>. I want the executable to auto complete when pressing tab. E.g. writing <code>$ brainfuck com</code> and then pressing tab should generate <code>$ brainfuck compile</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Command = Compile CompileArgs | Run RunArgs\n  deriving (Show)\n\nmain :: IO ()\nmain = execute =&lt;&lt; execParser opts\n  where\n    opts = info (helper &lt;*&gt; argsParser) fullDesc\n\nexecute :: Command -&gt; IO ()\nexecute (Compile args)  = compile args\nexecute (Run args)      = run args\n\nargsParser :: Parser Command\nargsParser = subparser (compileCommand &lt;&gt; runCommand)\n  where\n    compileCommand  = command \"compile\" $ info compileOptions $ progDesc \"Compile brainfuck to an executable\"\n    runCommand      = command \"run\"     $ info runOptions     $ progDesc \"Execute brainfuck code\"\n</code></pre>\n\n<p>There is a section on optparse's github page <a href=\"https://github.com/pcapriotti/optparse-applicative/wiki/Bash-Completion\" rel=\"nofollow noreferrer\">here</a>, but I don't really understand it.</p>\n\n<p>The function <code>completeWith :: Options.Applicative.Builder.Internal.HasCompleter f =&gt; [String] -&gt; Mod f a</code> looks quite similar to <code>command :: String -&gt; ParserInfo a -&gt; Mod CommandFields a</code> which I'm already using. So I figured I could use it and just combine them with <code>&lt;&gt;</code> but it turns out that <code>CommandFields</code> is not an instance of <code>HasCompleter</code>.</p>\n\n<p>How are you supposed to get the auto completion to work?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1575122622, "post_id": 59116860, "comment_id": 104463781, "body": "<code>&quot;&quot;</code> is just syntactic sugar for <code>[]</code> - it&#39;s an empty list (in this case a list of <code>Char</code>s). If you <code>map</code> anything over an empty list, you get an empty list back. In your other example, <code>[[]]</code> is not empty, it contains a single element (which is itself an empty list)."}, {"owner": {"reputation": 3, "user_id": 8157580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7e47ba723beb118a23a5571776ab25b?s=128&d=identicon&r=PG&f=1", "display_name": "zorkedon", "link": "https://stackoverflow.com/users/8157580/zorkedon"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1575123119, "post_id": 59116860, "comment_id": 104463901, "body": "@RobinZigmond How would I do for words return [&quot;&quot;] instead of [], as I know the Functor rules :)"}], "answers": [{"tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": false, "score": 1, "last_activity_date": 1575126471, "creation_date": 1575126471, "answer_id": 59117403, "question_id": 59116860, "link": "https://stackoverflow.com/questions/59116860/the-result-of-map-sum-is-wrong/59117403#59117403", "title": "The result of map sum [[]] is wrong?", "body": "<p><code>map sum [[]]</code> is fine. You can try it yourself. The problem is that <code>words \"\"</code> is <code>[]</code> not <code>[[]]</code>, so your <code>sumords</code> ends up being <code>(unwords . map _ . words) \"\"</code>, which is <code>unwords (map _ (words \"\"))</code>, which is <code>unwords (map _ [])</code> which is <code>unwords []</code> which is <code>\"\"</code>, not <code>\"0\"</code> as you seem to be expecting.</p>\n"}], "owner": {"reputation": 3, "user_id": 8157580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7e47ba723beb118a23a5571776ab25b?s=128&d=identicon&r=PG&f=1", "display_name": "zorkedon", "link": "https://stackoverflow.com/users/8157580/zorkedon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575126471, "creation_date": 1575122255, "question_id": 59116860, "link": "https://stackoverflow.com/questions/59116860/the-result-of-map-sum-is-wrong", "title": "The result of map sum [[]] is wrong?", "body": "<pre class=\"lang-hs prettyprint-override\"><code>sumord = unwords . map (show . sum . filter odd . map ord) . words\n\nsumord \"\" == \"\"\n</code></pre>\n\n<p>the value of <code>sumord \"\"</code> should be 0, and it is probably a wrong value of the function <code>sum</code>, but <code>map sum [[]] == [0]</code> which should be the write result.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1575129525, "post_id": 59115949, "comment_id": 104465576, "body": "Not related to the problem you&#39;re having, but it seems a bit weird to define your parser to return lists, but only handle one-element and zero-element lists. Why not just return a Maybe instead?"}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1575322562, "post_id": 59116110, "comment_id": 104519882, "body": "Namely: <code>eof = Parser (\\ x -&gt; if null x then Just () else Nothing)</code>, then <code>test = sat (== &#39;x&#39;) &lt;* eof</code>, or <code>only p = p &lt;* eof</code> and <code>test = only $ sat (== &#39;x&#39;)</code>"}], "tags": [], "owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "is_accepted": true, "score": 6, "last_activity_date": 1575116349, "creation_date": 1575116349, "answer_id": 59116110, "question_id": 59115949, "link": "https://stackoverflow.com/questions/59115949/stop-parser-from-accepting-extra-characters/59116110#59116110", "title": "Stop Parser From Accepting Extra Characters", "body": "<p>The fix is actually really simple. Just check that the remaining string after parsing is empty in the <code>run</code> function. Like this:</p>\n\n<pre><code>run s = case parse test s of\n             [(a, \"\")] -&gt; Just a\n             otherwise -&gt; Nothing\n</code></pre>\n\n<p>Now any spurious characters will cause the function to return Nothing as you want.</p>\n\n<p>An alternative is to split the check into a separate <code>eof</code> parser that succeeds if the string is empty and fails if there are any characters left and add that to the end of your parser.</p>\n"}], "owner": {"reputation": 139, "user_id": 10564793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea55694a1fd734c241fe4d99816ee4c?s=128&d=identicon&r=PG&f=1", "display_name": "Edgar Smith", "link": "https://stackoverflow.com/users/10564793/edgar-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 59116110, "answer_count": 1, "score": 3, "last_activity_date": 1575116349, "creation_date": 1575115199, "question_id": 59115949, "link": "https://stackoverflow.com/questions/59115949/stop-parser-from-accepting-extra-characters", "title": "Stop Parser From Accepting Extra Characters", "body": "<p>I have a very simple parser with pretty standard parsing functions used with Haskell. I have the parser recognizing what I want, but the problem is that is accepts any extra input after what I'm looking for has been recognized. The simple example code I'll give should recognize a string \"x\", then return, Just 'x', or return Nothing for an input string other than \"x\". Given input \"x\", it returns Just 'x', as it should, given the string \"d\", it returns Nothing, as it should, given \"dx\", it returns Nothing, as it should, but if given \"xd\", it will return Just 'x', while I want it to return Nothing. </p>\n\n<pre><code>newtype Parser a = P (String -&gt; [(a,String)])\n\ninstance Functor Parser where\n   fmap g p = P (\\inp -&gt; case parse p inp of\n                            []        -&gt; []\n                            [(v,out)] -&gt; [(g v, out)])\n\ninstance Applicative Parser where\n   pure v = P (\\inp -&gt; [(v,inp)])\n   pg &lt;*&gt; px = P (\\inp -&gt; case parse pg inp of\n                             []        -&gt; []\n                             [(g,out)] -&gt; parse (fmap g px) out)\n\ninstance Monad Parser where\n   p &gt;&gt;= f = P (\\inp -&gt; case parse p inp of\n                           []        -&gt; []\n                           [(v,out)] -&gt; parse (f v) out)\n\nparse (P p) inp = p inp\n\nitem :: Parser Char\nitem = P (\\inp -&gt; case inp of\n                     []     -&gt; []\n                     (x:xs) -&gt; [(x,xs)])\n\nsat :: (Char -&gt; Bool) -&gt; Parser Char\nsat p = do x &lt;- item\n           if p x then return x else empty\n\nempty = P (\\inp -&gt; [])\n\ntest = do { x &lt;- sat (\\x -&gt; x == 'x'); return x}\n\nrun s = case parse test s of\n             [(a, _)] -&gt; Just a\n             otherwise -&gt; Nothing\n</code></pre>\n\n<p>given:</p>\n\n<pre><code>run \"xd\"\n</code></pre>\n\n<p>returns:</p>\n\n<pre><code>Just 'x'\n</code></pre>\n\n<p>My most reasonable attempt was to try to recognize anything that's not an alpha-numeric character, but that just seems to make the parser try to parse beyond the string length and it returns Nothing. Is there a standard way of dealing with this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1575082434, "post_id": 59112628, "comment_id": 104456567, "body": "Try writing a function that takes the index at which to insert the * as an argument, then calling that function with all the desired indices."}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 1, "last_activity_date": 1575085808, "creation_date": 1575085808, "answer_id": 59113039, "question_id": 59112628, "link": "https://stackoverflow.com/questions/59112628/haskell-how-can-i-take-each-number-from-a-list-separately/59113039#59113039", "title": "Haskell: how can I take each number from a list separately?", "body": "<p>The simplest way is to create a function that prints one line:</p>\n\n<pre><code>line width idx = duplicate \"-\" idx ++ \"*\" ++ duplicate \"-\" (width - idx - 1) ++ \"\\n\"\n</code></pre>\n\n<p>And then map it over a list <code>[0..(n-1)]</code>, then concatenate results:</p>\n\n<pre><code>block n = concat $ map (line n) [0..(n-1)]\n</code></pre>\n\n<p>Or, for a more intuitively looking solution, you can do the same thing as a list comprehension:</p>\n\n<pre><code>block n = concat\n    [ duplicate \"-\" i ++ \"*\" ++ duplicate \"-\" (n - i - 1) ++ \"\\n\"\n    | i &lt;- [0..(n-1)]\n    ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1575117297, "creation_date": 1575117297, "answer_id": 59116216, "question_id": 59112628, "link": "https://stackoverflow.com/questions/59112628/haskell-how-can-i-take-each-number-from-a-list-separately/59116216#59116216", "title": "Haskell: how can I take each number from a list separately?", "body": "<p>A simple code to handle this job could be;</p>\n\n<pre><code>\\n -&gt; (drop &lt;&gt; take) &lt;$&gt; [n+1,n..1] &lt;*&gt; ['*':replicate n '-']\n</code></pre>\n\n<p>I had explained about <code>drop &lt;&gt; take :: Int -&gt; [a] -&gt; [a]</code> <a href=\"https://stackoverflow.com/a/58328879/4543207\">in a previous answer of mine</a>. fmap (<code>&lt;$&gt;</code>) and applicative op (<code>&lt;*&gt;</code>) should be clear.</p>\n"}], "owner": {"reputation": 25, "user_id": 12458908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7fdd5c8aa307c0177b2a0f1aaf6973?s=128&d=identicon&r=PG&f=1", "display_name": "sad_banana_peel", "link": "https://stackoverflow.com/users/12458908/sad-banana-peel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1575117297, "creation_date": 1575080206, "last_edit_date": 1575085495, "question_id": 59112628, "link": "https://stackoverflow.com/questions/59112628/haskell-how-can-i-take-each-number-from-a-list-separately", "title": "Haskell: how can I take each number from a list separately?", "body": "<p>I'm trying to duplicate a \"-\" character for 0 to n number of times, add a '*' and add a duplicate of \"-\" character again for n to 0 times recursively, e.g.:\nIf n = 5, I'd like the answer to be:</p>\n\n<pre><code>*-----\n\n-*----\n\n--*---\n\n---*--\n\n----*-\n\n-----*\n\n\n\n\nduplicate :: String -&gt; Int -&gt; String -- will be used to duplicate spaces\nduplicate string n = \n    concat $ replicate n string\n\nblock :: Int -&gt; String\nblock n =\n    duplicate ***from 0 to n*** \"-\" ++ '*' ++ duplicate ***from n to 0*** \"-\"\n</code></pre>\n\n<p>How can I do this?</p>\n"}, {"tags": ["haskell", "recursion", "tree", "binary-tree"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1575043815, "post_id": 59108015, "comment_id": 104447580, "body": "where is 2 in the output?"}, {"owner": {"reputation": 8678, "user_id": 750186, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5IH0v.jpg?s=128&g=1", "display_name": "Martin Kristiansen", "link": "https://stackoverflow.com/users/750186/martin-kristiansen"}, "edited": false, "score": 0, "creation_date": 1575044803, "post_id": 59108015, "comment_id": 104447988, "body": "Can you share what you have already done and where you are stuck? I would assume some kind of CPS approach, but this can be done in lots of ways."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1575045595, "post_id": 59108015, "comment_id": 104448303, "body": "What order? Breadth-first, depth-first, something else?"}, {"owner": {"reputation": 3370, "user_id": 722938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MtO4E.jpg?s=128&g=1", "display_name": "is7s", "link": "https://stackoverflow.com/users/722938/is7s"}, "edited": false, "score": 0, "creation_date": 1575045624, "post_id": 59108015, "comment_id": 104448315, "body": "what if it&#39;s not possiblee &quot;apply&quot; the list?"}, {"owner": {"reputation": 11, "user_id": 11389158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/083fb8cf3b929f38b1dcf87b65df5158?s=128&d=identicon&r=PG&f=1", "display_name": "EightPinkArrows", "link": "https://stackoverflow.com/users/11389158/eightpinkarrows"}, "reply_to_user": {"reputation": 8678, "user_id": 750186, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5IH0v.jpg?s=128&g=1", "display_name": "Martin Kristiansen", "link": "https://stackoverflow.com/users/750186/martin-kristiansen"}, "edited": false, "score": 0, "creation_date": 1575046142, "post_id": 59108015, "comment_id": 104448527, "body": "@MartinKristiansen As I said in my question, I&#39;m struggling with A. Right now my idea is that I would have some sort of secondary function that &quot;scans&quot; a certain path to find how many integers are in it, so that my algorithm can know how much of a list to supply to either Foo in A."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575046669, "post_id": 59108015, "comment_id": 104448717, "body": "This is very similar to the tree-labelling problem described in the documentation for <a href=\"https://hackage.haskell.org/package/transformers-0.3.0.0/docs/Control-Monad-Trans-State-Lazy.html\" rel=\"nofollow noreferrer\"><code>Control.Monad.Trans.Lazy</code></a>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575098883, "post_id": 59108015, "comment_id": 104458862, "body": "well, firstly, <code>B Int Foo ==  A (C Int) Foo</code> so the data type is needlessly overly complex."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 8678, "user_id": 750186, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5IH0v.jpg?s=128&g=1", "display_name": "Martin Kristiansen", "link": "https://stackoverflow.com/users/750186/martin-kristiansen"}, "edited": false, "score": 0, "creation_date": 1575105305, "post_id": 59108015, "comment_id": 104459994, "body": "@MartinKristiansen yes, <a href=\"https://stackoverflow.com/a/50588667/849891\">CPS works</a>. it encodes state passing with <a href=\"https://stackoverflow.com/a/9889702/849891\">unique selection</a> from <a href=\"https://stackoverflow.com/search?q=user%3A849891+shrinking+domain\">shrinking domain</a>. which is like parsing."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575105840, "post_id": 59108015, "comment_id": 104460090, "body": "@chepner &quot;Breadth-first, depth-first, something else?&quot; not applicable. there&#39;s no data in nodes, only in leaves. the  intent is fringe replacement."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1575058138, "post_id": 59108645, "comment_id": 104452184, "body": "Fun fact, the advanced approach and the basic one are the same"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1575046613, "creation_date": 1575046613, "answer_id": 59108645, "question_id": 59108015, "link": "https://stackoverflow.com/questions/59108015/haskell-translate-a-list-to-a-recursive-data-structure/59108645#59108645", "title": "Haskell - Translate a list to a recursive data structure", "body": "<p>Here is a hint:</p>\n\n<p>I would start by writing an auxiliary function, which takes the <code>[Int]</code> and <code>Foo</code> arguments, and returns not just the output <code>Foo</code> but an additional <code>[Int]</code> representing the numbers in the input list which have not been used, yet. \nHence, the resulting output type can be a pair.</p>\n\n<p>The intuition here is that this auxiliary function does not assume that the input <code>[Int]</code> list contains the right amount of numbers for the <code>Foo</code> input, but allows more <code>Int</code>s to be present, and returns the ones in excess.</p>\n\n<p>Using this auxiliary function, you can handle the <code>A</code> case with two <code>Foo</code>s inside: you call the auxiliary function on the first <code>Foo</code>, and obtain the excess <code>Int</code>s, then you use those for the second <code>Foo</code>, and return the new excess <code>Int</code>s.</p>\n\n<p>(A more advanced approach would be to use a <code>State [Int]</code> monad, but the above basic approach should be fine.)</p>\n"}], "owner": {"reputation": 11, "user_id": 11389158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/083fb8cf3b929f38b1dcf87b65df5158?s=128&d=identicon&r=PG&f=1", "display_name": "EightPinkArrows", "link": "https://stackoverflow.com/users/11389158/eightpinkarrows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 59108645, "answer_count": 1, "score": 0, "last_activity_date": 1575105964, "creation_date": 1575043568, "last_edit_date": 1575105964, "question_id": 59108015, "link": "https://stackoverflow.com/questions/59108015/haskell-translate-a-list-to-a-recursive-data-structure", "title": "Haskell - Translate a list to a recursive data structure", "body": "<p>I found this problem in a Haskell textbook. Given a recursive data structure:</p>\n\n<pre><code>data Foo = A Foo Foo | B Int Foo | C Int\n</code></pre>\n\n<p>create a function:</p>\n\n<pre><code>createFooFromList :: [Int] -&gt; Foo -&gt; Foo\n</code></pre>\n\n<p>that takes in a list and a <code>Foo</code>, applies the list to the <code>Foo</code>, and returns the new <code>Foo</code>.</p>\n\n<p>What \"applying\" means is best described using an example.</p>\n\n<p>Say we have a <code>Foo</code> that is defined as <code>B 0 (B 1 (A (B 0 (C 1)) (B 1 (C 1))))</code> and we have to apply the list <code>[0,0,1,0,2,0]</code> to this <code>Foo</code>. To do this, simply take each integer in the given sequence and replace integers in the <code>Foo</code> structure in order with these integers in the sequence.</p>\n\n<p>So for the above example, our output would be <code>B 0 (B 0 (A (B 1 (C 0)) (B 2 (C 0))))</code></p>\n\n<p>So far,  I have created a function that applies the list to the <code>B</code> and <code>C</code> structures. <code>C</code> is trivial, and <code>B</code> is also easy as I simply set the head of the list to the <code>Int</code> parameter of <code>B</code>, and recursively apply the rest of the list to the <code>Foo</code> part of <code>B</code>. However I am unsure as to how to deal with <code>A</code>.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1575043224, "post_id": 59107763, "comment_id": 104447332, "body": "Further <code>a</code> will be <i>too</i> general; not all types support <code>sqrt</code> and <code>**</code>. The correct signature (which GHCi can infer for you, if you omit the signature entirely), is <code>Floating a =&gt; Metric a</code>."}], "tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": false, "score": 3, "last_activity_date": 1575042366, "creation_date": 1575042366, "answer_id": 59107763, "question_id": 59107633, "link": "https://stackoverflow.com/questions/59107633/haskell-error-couldnt-match-type-a-with-double/59107763#59107763", "title": "Haskell error: Couldn&#39;t match type \u2018a\u2019 with \u2018Double\u2019", "body": "<p>See in the implementation of</p>\n\n<pre><code>points :: Point a -&gt; [Point a] -&gt; [(Point a, Double)]\n</code></pre>\n\n<p>you call</p>\n\n<pre><code>calDistance :: Metric Double\n</code></pre>\n\n<p>This means, that <code>a</code> has to be <code>Double</code>, as what should happen if someone called <code>points</code> with a value of type <code>Point Int</code> as the first argument? How should <code>calDistance</code> handle that, as it can only handle values of <code>Point Double</code>?</p>\n\n<p>The error tells you, that <code>calDistance</code> was called with a value of type <code>Point a</code>, where <code>a</code> could be any type. And that doesn't match as <code>calDistance</code> expects a <code>Point Double</code> as its first argument.</p>\n"}], "owner": {"reputation": 11, "user_id": 12366705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72b19f34ca183b5cce658a5416d31733?s=128&d=identicon&r=PG&f=1", "display_name": "user12366705", "link": "https://stackoverflow.com/users/12366705/user12366705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575042366, "creation_date": 1575041805, "question_id": 59107633, "link": "https://stackoverflow.com/questions/59107633/haskell-error-couldnt-match-type-a-with-double", "title": "Haskell error: Couldn&#39;t match type \u2018a\u2019 with \u2018Double\u2019", "body": "<p>I am writing a Haskell code to find a list of the k nearest neighbours, in distance order, according to metric d to point p in the list xs of points. My code is below</p>\n\n<pre><code>import Data.List\nimport Data.Function\n\ntype Point a = (a,a)\ntype Metric a = (Point a) -&gt; (Point a) -&gt; Double\n\nneighbours :: Int -&gt; Metric a -&gt; Point a -&gt; [Point a] -&gt; [Point a]\nneighbours k calDistance p [] = []\nneighbours k calDistance p ps\n | k &lt; 0     = error \"k cannot be negative\"\n | otherwise = take k (neighbours' (sortBy (compare `on` snd) [ (poi,dis) | (poi,dis) &lt;- points p ps]))\n\nneighbours' :: [(Point a, Double)] -&gt; [Point a]\nneighbours' xs = [ x | (x,y)&lt;-xs]\n\npoints :: Point a -&gt; [Point a] -&gt; [(Point a, Double)]\npoints _ [] = []\npoints p1 (p2:px) = (p2,(calDistance p1 p2)): points p1 px\n\ncalDistance :: Metric Double\ncalDistance (x1,y1) (x2,y2) = sqrt((x1-x2)**2 + (y1-y2)**2)\n</code></pre>\n\n<p>The error is</p>\n\n<pre><code>    \u2022 Couldn't match type \u2018a\u2019 with \u2018Double\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n        the type signature for:\n          points :: forall a. Point a -&gt; [Point a] -&gt; [(Point a, Double)]\n        at A4.hs:27:1-53\n      Expected type: Point Double\n        Actual type: Point a\n    \u2022 In the first argument of \u2018calDistance\u2019, namely \u2018p1\u2019\n      In the expression: (calDistance p1 p2)\n      In the first argument of \u2018(:)\u2019, namely \u2018(p2, (calDistance p1 p2))\u2019\n    \u2022 Relevant bindings include\n        px :: [Point a] (bound at A4.hs:29:15)\n        p2 :: Point a (bound at A4.hs:29:12)\n        p1 :: Point a (bound at A4.hs:29:8)\n        points :: Point a -&gt; [Point a] -&gt; [(Point a, Double)]\n          (bound at A4.hs:28:1)\n   |\n29 | points p1 (p2:px) = (p2,(calDistance p1 p2)): points p1 px\n   |     \n</code></pre>\n\n<p>However, if I change 'Metric Double' to 'Double a' there is also a compile error: Couldn't match expected type \u2018Double\u2019 with actual type \u2018a\u2019. Please can someone tell me how to solve it?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1575052705, "post_id": 59106269, "comment_id": 104450689, "body": "One-element tuple? There is no such thing in Haskell, and I don&#39;t see what in the question what might make you think this. Also, while I think I see what you&#39;re trying to say, claiming this function takes two arguments is definitely incorrect."}, {"owner": {"reputation": 11377, "user_id": 553279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de617e09030cad8f06663113eeea27cc?s=128&d=identicon&r=PG", "display_name": "fdreger", "link": "https://stackoverflow.com/users/553279/fdreger"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1575075239, "post_id": 59106269, "comment_id": 104455653, "body": "@amalloy I never mentioned two arguments. When the lhs of a function definition introduces a variable, I think it is proper to call it &quot;a parameter&quot; - even if it is introduced by the pattern binding syntax (how else would I call it?). As for &quot;what might make you think this&quot; - the code calling the noSpace function wraps the string literal in parentheses, making it look like a one-element tuple. It&#39;s not an error (just an unnecessary grouping) but probably a misunderstanding which will blow up when OP calls a function with multiple arguments."}], "tags": [], "owner": {"reputation": 11377, "user_id": 553279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de617e09030cad8f06663113eeea27cc?s=128&d=identicon&r=PG", "display_name": "fdreger", "link": "https://stackoverflow.com/users/553279/fdreger"}, "is_accepted": false, "score": 0, "last_activity_date": 1575036244, "creation_date": 1575036244, "answer_id": 59106269, "question_id": 59106208, "link": "https://stackoverflow.com/questions/59106208/list-comprehension-is-removing-first-character-why/59106269#59106269", "title": "List comprehension is removing first character, why?", "body": "<p>You are matching on <code>(x : xs)</code> (instead of just <code>(xs)</code>), so your function takes two parameters: the first element of the list and the rest. And then you only work on \"the rest\" (xs), and discard x altogether.</p>\n\n<p>Probably you don't want to use a one-element tuple as a parameter, but this is another story.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575139443, "post_id": 59106280, "comment_id": 104468099, "body": "list comprehensions are much more self-explanatory though. <code>filter p</code>? what&#39;s that do? is it filtering the <code>p</code> chars out, or in? with LC, no questions."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1575040831, "last_edit_date": 1575040831, "creation_date": 1575036291, "answer_id": 59106280, "question_id": 59106208, "link": "https://stackoverflow.com/questions/59106208/list-comprehension-is-removing-first-character-why/59106280#59106280", "title": "List comprehension is removing first character, why?", "body": "<p>The <code>x</code> in your pattern is not related to the <code>x</code> in your list comprehension; it's as if you wrote</p>\n\n<pre><code>noSpace (x:xs) = [y | y &lt;- xs, y /= ' ']\n</code></pre>\n\n<p>Note that <code>x</code> is effectively dropped, because the list comprehension doesn't consider it.</p>\n\n<p>You don't need both in this definition; the list comprehension is already capable of matching each character in the list on its own, so <code>noSpace</code> itself doesn't have to do any pattern matching.</p>\n\n<pre><code>noSpace xs = [x | x &lt;- xs, x /= ' ']\n</code></pre>\n\n<p>This is just an alternate way of writing the <code>filter</code> function.</p>\n\n<pre><code>noSpace xs = filter (\\x -&gt; x /= ' ') xs\n</code></pre>\n\n<p>or simply </p>\n\n<pre><code>noSpace = filter (\\x -&gt; x /= ' ')\n</code></pre>\n\n<p>or even more simply</p>\n\n<pre><code>noSpace = filter (/= ' ')\n</code></pre>\n\n<p>Both simplifications come via <a href=\"https://wiki.haskell.org/Eta_conversion\" rel=\"nofollow noreferrer\">eta conversion</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1575036307, "creation_date": 1575036307, "answer_id": 59106287, "question_id": 59106208, "link": "https://stackoverflow.com/questions/59106208/list-comprehension-is-removing-first-character-why/59106287#59106287", "title": "List comprehension is removing first character, why?", "body": "<p>You are misusing the pattern match syntax.</p>\n\n<pre><code>noSpace (x:xs) = [x | x &lt;- xs, x /= ' ']\n--                this x has nothing to do with x in x:xs\n--       this x is unused and dropped ftom the result\n</code></pre>\n\n<p>To fix:</p>\n\n<pre><code>noSpace xs = [x | x &lt;- xs, x /= ' ']\n</code></pre>\n"}], "owner": {"reputation": 6568, "user_id": 1795924, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tC8HY.jpg?s=128&g=1", "display_name": "Ericson Willians", "link": "https://stackoverflow.com/users/1795924/ericson-willians"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1575463855, "creation_date": 1575035979, "last_edit_date": 1575463855, "question_id": 59106208, "link": "https://stackoverflow.com/questions/59106208/list-comprehension-is-removing-first-character-why", "title": "List comprehension is removing first character, why?", "body": "<p>I'm trying to implement a function that eliminates the spaces of a string. I don't understand why this list comprehension is eliminating the first character, if the predicate explicitly filters only empty spaces.</p>\n\n<pre><code>import Data.List\nimport System.IO\n\nnoSpace :: String -&gt; String\nnoSpace (x:xs) = [x | x &lt;- xs, x /= ' ']\n\nmain = do\n  print(noSpace(\"8 j 8   mBliB8g  imjB8B8  jl  B\"))\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>\"j8mBliB8gimjB8B8jlB\"\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>8j8mBliB8gimjB8B8jlB\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens", "monoids"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1575026378, "post_id": 59103013, "comment_id": 104439547, "body": "Uff, there are at least three things here that I&#39;d consider generally a bad idea: <b>1.</b> making record fields for sum types. (Lenses do to some degree solve the problems that come with that, but as you&#39;ve encountered  this brings its own problems.) <b>2.</b> Duplicate record fields. (Always were a half-baked concept; only <code>OverloadedLabels</code> has made sense of this.) <b>3.</b> Don&#39;t re-use standard names for something different, in particular not for something as fundamental as <code>id</code>."}, {"owner": {"reputation": 222, "user_id": 893169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/12836e8cffceb6711a3fc918edd93f6f?s=128&d=identicon&r=PG", "display_name": "itsu", "link": "https://stackoverflow.com/users/893169/itsu"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1575030835, "post_id": 59103013, "comment_id": 104441579, "body": "Yeah, I know about 1 and 2 but I thought lens would solve their issue :-("}, {"owner": {"reputation": 222, "user_id": 893169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/12836e8cffceb6711a3fc918edd93f6f?s=128&d=identicon&r=PG", "display_name": "itsu", "link": "https://stackoverflow.com/users/893169/itsu"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1575032138, "post_id": 59103013, "comment_id": 104442209, "body": "Is it sure that <b>1</b> is a bad idea when used with lens ? It seems strange to me that the first example on <a href=\"http://hackage.haskell.org/package/lens-4.18.1/docs/Control-Lens.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/lens-4.18.1/docs/Control-Lens.ht&zwnj;&#8203;ml</a> is using sum types of records if it was a bad practice"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1575033155, "post_id": 59103013, "comment_id": 104442687, "body": "Well, <b>I</b> consider it a bad idea. Opinions may vary."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1575048688, "post_id": 59103013, "comment_id": 104449396, "body": "You can get around a lot of these issues with <a href=\"https://hackage.haskell.org/package/generic-lens\" rel=\"nofollow noreferrer\">generic-lens</a>.  And as a bonus, no  TH splices!"}], "answers": [{"comments": [{"owner": {"reputation": 222, "user_id": 893169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/12836e8cffceb6711a3fc918edd93f6f?s=128&d=identicon&r=PG", "display_name": "itsu", "link": "https://stackoverflow.com/users/893169/itsu"}, "edited": false, "score": 0, "creation_date": 1575202899, "post_id": 59110231, "comment_id": 104479428, "body": "Such a well detailed response, this is great. Thank you so much !! I chose to use the lens lib because I thought it&#39;d solved the haskell record issue but I guess the easiest solution is still to prefix my record with the class name :-("}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "reply_to_user": {"reputation": 222, "user_id": 893169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/12836e8cffceb6711a3fc918edd93f6f?s=128&d=identicon&r=PG", "display_name": "itsu", "link": "https://stackoverflow.com/users/893169/itsu"}, "edited": false, "score": 1, "creation_date": 1575217909, "post_id": 59110231, "comment_id": 104483352, "body": "No problem :) If you&#39;re interested in learning more about lenses I&#39;m releasing a comprehensive lenses book later this month! <a href=\"https://leanpub.com/optics-by-example/\" rel=\"nofollow noreferrer\">leanpub.com/optics-by-example</a>"}], "tags": [], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "is_accepted": true, "score": 4, "last_activity_date": 1575056641, "creation_date": 1575056641, "answer_id": 59110231, "question_id": 59103013, "link": "https://stackoverflow.com/questions/59103013/how-to-deal-with-duplicate-record-field-with-lenses/59110231#59110231", "title": "how to deal with duplicate record field with lenses?", "body": "<p>So, the issue here is caused in part by the record used in a sum-type. We can generate a lens for <code>name</code> for Foo since each constructor has a <code>name</code> field; but only one constructor has an <code>id</code>. This causes TemplateHaskell to generate the following <code>HasId</code> class, which you can see for yourself by running <code>:browse Foo</code> in ghci:</p>\n\n<pre><code>class HasId s a | s -&gt; a where\n  id :: Traversal' s a\n</code></pre>\n\n<p>As you can see, it set the type to <code>Traversal'</code>. Since there can only be one <code>HasId</code> typeclass, when you <code>makeFields</code> on <code>Foo</code> it'll re-use the same typeclass, and even though it CAN generate a lens, the typeclass method <code>id</code> only has type <code>Traversal</code>, and you need a <code>Monoid</code> to use <code>^.</code> on a traversal.</p>\n\n<p>If you swap the ordering of your <code>makeFields</code> calls in the module you'll notice the typeclass is now generated with <code>id</code> as a <code>Lens</code>; but now the second <code>makeLenses</code> call fails to compile because it's generating a <code>Traversal</code>, not a lens.</p>\n\n<p>To sum up the problem, you're expecting the typeclass's <code>id</code> method to change types based on how it's used (by picking either a Lens or Traversal), but that's not how typeclasses work in Haskell.</p>\n\n<p>You have a few options here, but you really need to decide on what you want the semantics to be. The safest is to stick with what you've got here, (use the Traversal) and always use <code>preview</code> a.k.a. <code>(^?)</code> to access the id field. Alternatively you could generate separate combinators; a <code>fooId</code> and a <code>barId</code>, one a lens and the other a Traversal. Alternatively you could implement the <code>HasId</code> typeclass manually, and provide a 'default' id for when it's missing (or call error), but both of these would result in an unlawful lens.</p>\n\n<p>You could do something really gross and determine whether each type's <code>id</code> field is a Lens or Traversal using Type families or something like that; but it's going to be unidiomatic and really hard to understand. It's more work than it's worth.</p>\n\n<p>The crux of it is, you <strong>can't</strong> have a valid lens for <code>id</code> if there's a constructor fo the type that doesn't have an id. It's up to you how you want to handle that case.</p>\n"}], "owner": {"reputation": 222, "user_id": 893169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/12836e8cffceb6711a3fc918edd93f6f?s=128&d=identicon&r=PG", "display_name": "itsu", "link": "https://stackoverflow.com/users/893169/itsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 59110231, "answer_count": 1, "score": 0, "last_activity_date": 1575056641, "creation_date": 1575023254, "question_id": 59103013, "link": "https://stackoverflow.com/questions/59103013/how-to-deal-with-duplicate-record-field-with-lenses", "title": "how to deal with duplicate record field with lenses?", "body": "<p>given this piece of code:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE DuplicateRecordFields #-}\n{-# LANGUAGE FunctionalDependencies #-}\n\nmodule Foo where\n\nimport Control.Lens ((^.), makeFieldsNoPrefix)\nimport Prelude hiding (id)\n\ndata Bar\n  = Bar1 { _id :: Int\n         , _name :: String\n         }\n  | Bar2 { _name :: String }\n\n$(makeFieldsNoPrefix ''Bar)\n\n\ndata Foo = Foo { _id :: Int\n               , _name :: String\n               }\n\n$(makeFieldsNoPrefix ''Foo)\n\na = (undefined :: Foo) ^. name -- compiles fine\n\nb = (undefined :: Foo) ^. id -- doesnt compile\n{-\n    \u2022 No instance for (Monoid Int) arising from a use of \u2018id\u2019\n    \u2022 In the second argument of \u2018(^.)\u2019, namely \u2018id\u2019\n      In the expression: (undefined :: Foo) ^. id\n      In an equation for \u2018b\u2019: b = (undefined :: Foo) ^. id\n-}\n</code></pre>\n\n<p>As far as I can understand, it seems <code>id</code> needs an instance of Monoid because of Bar that could fail when the instance is of type <code>Bar2</code> (which doesnt have an <code>id</code> field).</p>\n\n<p>But since I'm working on a Foo (which always has an <code>id</code> field) it should work, doesnt it ?</p>\n\n<p>I know I could solve this with prefixing the field with the class name like:</p>\n\n<pre><code>data Foo = Foo { _fooId :: Int, _fooName :: String }\n</code></pre>\n\n<p>but if there is a nice solution without cluttering my fields name then I'm all for it :-)</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 7, "last_activity_date": 1574998028, "creation_date": 1574998028, "answer_id": 59098424, "question_id": 59098273, "link": "https://stackoverflow.com/questions/59098273/define-data-type-include-constrained-functions/59098424#59098424", "title": "Define data type include constrained functions", "body": "<p>You're trying to use a rank-2 type (specifically, the type of the <code>Env</code> data constructor). You need to both enable the <code>RankNTypes</code> extension, and use a <code>forall</code> since rank-2 types are never inferred:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\ndata Env = Env\n  { envLog :: forall a. (Serializable a) =&gt; a -&gt; FilePath -&gt; IO ()\n  , ...\n  }\n</code></pre>\n"}], "owner": {"reputation": 443, "user_id": 4183297, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/UNM2l.jpg?s=128&g=1", "display_name": "Theodora", "link": "https://stackoverflow.com/users/4183297/theodora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 59098424, "answer_count": 1, "score": 3, "last_activity_date": 1574998028, "creation_date": 1574996676, "question_id": 59098273, "link": "https://stackoverflow.com/questions/59098273/define-data-type-include-constrained-functions", "title": "Define data type include constrained functions", "body": "<p>I am trying to adopt the idea of <a href=\"https://www.fpcomplete.com/blog/2017/06/readert-design-pattern\" rel=\"nofollow noreferrer\">ReaderT pattern</a> in a simple production system. </p>\n\n<p>In the original example data type <code>Env</code> is defined as:</p>\n\n<pre><code>data Env = Env\n  { envLog :: !(String -&gt; IO ())\n  , ...\n  }\n</code></pre>\n\n<p>I my implementation, \nI defined a typeclass <code>Serializable</code> to help me logging different data types.\nSo that I could have a more generic logging function (including serialization in different file format):</p>\n\n<pre><code>data Env = Env\n  { evnLog :: (Serializable a) =&gt; a -&gt; FilePath -&gt; IO ()\n  , ...\n  }\n</code></pre>\n\n<p>Of course, this doesn't work. The error message is:</p>\n\n<pre><code>    Not in scope: type variable \u2018a\u2019\n   |\n61 |   { envLog :: (Serializable a) =&gt;\n   |                             ^\n</code></pre>\n\n<p>If <code>a</code> is included in the Type constructor of <code>Env</code>, I will be forced to change the Context information in ReaderT constantly, it would be really cumbersome.</p>\n\n<p>I just want to pass this generic function along a sequences of computations and use it whenever being needed. </p>\n\n<p>Is there any possibility of not introducing  <code>a</code> in the Type constructor of <code>Env</code> ? Or maybe ReaderT pattern needs more tricks to be used like this?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 7, "last_activity_date": 1574974175, "creation_date": 1574974175, "answer_id": 59095986, "question_id": 59095853, "link": "https://stackoverflow.com/questions/59095853/haskell-error-couldnt-match-expected-type/59095986#59095986", "title": "Haskell error: Couldn&#39;t match expected type", "body": "<p>This part</p>\n\n<pre><code>(sortOn distance(p ps))\n</code></pre>\n\n<p>means: </p>\n\n<ul>\n<li>call function <code>p</code> with argument <code>ps</code>, name the result <code>res</code>;</li>\n<li>call function <code>sortOn</code> with two arguments: <code>distance</code> (the 2-arguments function), and <code>res</code>.</li>\n</ul>\n\n<p>This is not what you wanted. Indeed, <code>p</code> is a pair, and not a function, as the error states:</p>\n\n<pre><code> The function \u2018p\u2019 is applied to one argument,\n but its type \u2018(a, a)\u2019 has none\n</code></pre>\n\n<p>What you probably wanted is</p>\n\n<pre><code>(sortOn (distance p) ps)\n</code></pre>\n\n<p>which would sort all the points in <code>ps</code> according to the 1-argument function <code>distance p</code>, providing the distance from <code>p</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 12366705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72b19f34ca183b5cce658a5416d31733?s=128&d=identicon&r=PG&f=1", "display_name": "user12366705", "link": "https://stackoverflow.com/users/12366705/user12366705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574974175, "creation_date": 1574973470, "last_edit_date": 1574973878, "question_id": 59095853, "link": "https://stackoverflow.com/questions/59095853/haskell-error-couldnt-match-expected-type", "title": "Haskell error: Couldn&#39;t match expected type", "body": "<p>I am writing a Haskell code to a list of the k nearest neighbours, in distance order, according to metric d to point p in the list xs of points. Below is my code:</p>\n\n<pre><code>import Data.List\n\ntype Point a = (a,a)\ntype Metric a = (Point a) -&gt; (Point a) -&gt; Double\n\nneighbours ::  Int -&gt; Metric a -&gt; Point a -&gt; [Point a] -&gt; [Point a]\nneighbours k d p [] = []\nneighbours k d p ps = take k (sortOn distance(p ps))\n\ndistance :: Metric Double\ndistance (x1,y1) (x2,y2) = sqrt(((x1-x2)^2)+((y1-y2)^2))\n</code></pre>\n\n<p>The error is</p>\n\n<pre><code>    \u2022 Couldn't match expected type \u2018[Point a] -&gt; [Point Double]\u2019\n                  with actual type \u2018(a, a)\u2019\n    \u2022 The function \u2018p\u2019 is applied to one argument,\n      but its type \u2018(a, a)\u2019 has none\n      In the second argument of \u2018sortOn\u2019, namely \u2018(p ps)\u2019\n      In the second argument of \u2018take\u2019, namely \u2018(sortOn distance (p ps))\u2019\n    \u2022 Relevant bindings include\n        ps :: [Point a] (bound at A4.hs:21:18)\n        p :: Point a (bound at A4.hs:21:16)\n        d :: Metric a (bound at A4.hs:21:14)\n        neighbours :: Int -&gt; Metric a -&gt; Point a -&gt; [Point a] -&gt; [Point a]\n          (bound at A4.hs:20:1)\n   |\n23 |                     | otherwise = take k (sortOn distance(p ps))\n</code></pre>\n\n<p>Please can someone tell me how to solve it?</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "strictness"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1574962459, "post_id": 59093838, "comment_id": 104421885, "body": "You can&#39;t implement this, unless relying on concurrency to evaluate both expressions in parallel (or some unsafe functions hiding the parallelism). It exists in a library as <a href=\"https://hackage.haskell.org/package/unamb-0.2.7/docs/Data-Unamb.html#v:por\" rel=\"nofollow noreferrer\"><code>por</code></a> for &quot;parallel or&quot;."}, {"owner": {"reputation": 381, "user_id": 2197587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2145fb9dff1eec2badb45f58e8fd936f?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/2197587/federico"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1574962541, "post_id": 59093838, "comment_id": 104421913, "body": "@chi Would you mind sharing a proof?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1574962631, "post_id": 59093838, "comment_id": 104421945, "body": "@Federico It&#39;s the halting problem. Given <code>or x y</code>, you have to evaluate <i>one</i> of them, at least, to determine whether to return <code>True</code> or <code>False</code>. Whichever of <code>x</code> or <code>y</code> you pick, you run the chance of it being a divergent computation, even if the other is not. Concurrency lets you evaluate each of them &quot;a little at a time&quot;, so that if there is non-bottom value, you&#39;ll find it eventually."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1574962650, "post_id": 59093838, "comment_id": 104421951, "body": "I don&#39;t have a quick reference, but you could try googling for &quot;por&quot; in lambda calculus, and its related failure of full abstraction of denotational semantics. I think there are some Winskel (?) slides around somewhere."}, {"owner": {"reputation": 381, "user_id": 2197587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2145fb9dff1eec2badb45f58e8fd936f?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/2197587/federico"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574962821, "post_id": 59093838, "comment_id": 104422011, "body": "@chepner Thanks a lot! I&#39;ll accept it as the answer if you mind posting it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1574963061, "post_id": 59093838, "comment_id": 104422076, "body": "@chepner I would not relate this to the halting problem, since it can be solved with concurrency. This can be misleading I think -- if this problem were undecidable because of the HP, no amount of concurrency would help. Fortunately, we don&#39;t have to decide the HP on <code>x</code> or <code>y</code> to compute <code>por x y</code> since we can run the computations concurrently. It&#39;s more related to the lack of concurrency in the lambda calculus, in my eye."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574963189, "post_id": 59093838, "comment_id": 104422121, "body": "I&#39;m taking concurrency to simply mean you simply bypass the check for termination. Assuming one thread <i>does</i> terminate, you don&#39;t care any more if the other thread will eventually terminate or not; you just give up."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1574963591, "post_id": 59093838, "comment_id": 104422259, "body": "Put another way; I&#39;m not try to determine if a thread <i>will</i> complete, I&#39;m just switching to the other thread if I haven&#39;t completed <i>yet</i>. If neither thread will complete, neither will I."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 7, "last_activity_date": 1574963509, "last_edit_date": 1574963509, "creation_date": 1574963065, "answer_id": 59094078, "question_id": 59093838, "link": "https://stackoverflow.com/questions/59093838/is-it-possible-to-implement-this-function-in-haskell/59094078#59094078", "title": "Is it possible to implement this function in Haskell?", "body": "<p>Suppose you were to try to evaluate <code>or x y</code>. To do so, you have to pick one argument or the other to see if evaluating it leads to <code>True</code> or <code>False</code>. If you guess correctly, you'll figure out if the result should be <code>True</code> or <code>False</code> without having to evaluate the other argument (which might be \u22a5).</p>\n\n<p>If you guess <em>wrong</em>, though, you'll never finish evaluating the argument; either you'll get stuck in an infinite loop or you'll get a runtime error.</p>\n\n<hr>\n\n<p>Concurrency lets you evaluate <em>both</em> arguments in parallel[1]. Assuming one of the two arguments evaluates to a proper <code>Boolean</code>, one of the two branches will succeed in finding it. The other branch will either raise an error (in which case you can simply discard that branch and ignore the error) or get stuck in a loop (which you can terminate by force when the other branch succeeds). Either way, you can get the correct answer eventually.</p>\n\n<p>If <em>both</em> arguments lead to \u22a5, of course, the implicit result of <code>or</code> will still be \u22a5; you can't completely bypass the halting problem.</p>\n\n<hr>\n\n<p>[1] By \"parallel\", I don't necessarily mean forking another process and evaluating them simultaneously. You can evaluate one argument for <code>N</code> steps (for some value <code>N</code> and whatever \"step\" means); if an error is raised, give up and try the other argument, and if you haven't terminated yet, suspend this thread and try the other one for <code>N</code> steps. Keep bouncing back and forth between the two until one of them produces a concrete value.</p>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 6, "last_activity_date": 1574963472, "creation_date": 1574963472, "answer_id": 59094153, "question_id": 59093838, "link": "https://stackoverflow.com/questions/59093838/is-it-possible-to-implement-this-function-in-haskell/59094153#59094153", "title": "Is it possible to implement this function in Haskell?", "body": "<p><a href=\"https://hackage.haskell.org/package/unamb-0.2.7/docs/Data-Unamb.html\" rel=\"noreferrer\">The <em>unamb</em> package</a> uses concurrency (and <code>unsafePerformIO</code>) as described in chepner's answer to implement primitives with which the parallel <code>or</code> can be defined.</p>\n\n<pre><code>parOr :: Bool -&gt; Bool -&gt; Bool\nparOr x y = (x || y) `unamb` (y || x)  -- unamb from Data.Unamb\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 2197587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2145fb9dff1eec2badb45f58e8fd936f?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/2197587/federico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1574963509, "creation_date": 1574961858, "last_edit_date": 1592644375, "question_id": 59093838, "link": "https://stackoverflow.com/questions/59093838/is-it-possible-to-implement-this-function-in-haskell", "title": "Is it possible to implement this function in Haskell?", "body": "<p>At the page <a href=\"https://en.wikibooks.org/wiki/Haskell/Denotational_semantics#Pattern_Matching\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/Haskell/Denotational_semantics#Pattern_Matching</a> there is the following exercise:</p>\n<blockquote>\n<p>Consider a function <code>or</code> of two boolean arguments with the following properties:</p>\n<ul>\n<li>or \u22a5 \u22a5 = \u22a5</li>\n<li>or True \u22a5 = True</li>\n<li>or \u22a5 True = True</li>\n<li>or False y = y</li>\n<li>or x False = x</li>\n</ul>\n<p>This function is another example of joint strictness, but a much sharper one: the result is only \u22a5 if both arguments are (at least when we restrict the arguments to True and \u22a5). Can such a function be implemented in Haskell?</p>\n</blockquote>\n<p>The function can be represented with the following table:</p>\n<pre><code>      |   \u22a5   | False | True\n------|-----------------------\n  \u22a5   |   \u22a5   |   \u22a5   | True\nFalse |   \u22a5   | False | True\nTrue  | True  | True  | True\n</code></pre>\n<p>This function is <em>monotone</em> according to the definition given in <a href=\"https://en.wikibooks.org/wiki/Haskell/Denotational_semantics#Monotonicity\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/Haskell/Denotational_semantics#Monotonicity</a>, so I don't see a reason to exclude the possibility of implementing this function in Haskell. Nonetheless, I don't see a way to implement it.</p>\n<p>What is the answer to the exercise?</p>\n<p>PS: I get that the answer is &quot;no, you can't&quot;. What I'm looking for is a rigorous proof. I feel I'm missing some important restriction on what functions can be defined. Definitely not all monotone functions.</p>\n"}, {"tags": ["string", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 2, "last_activity_date": 1574961431, "creation_date": 1574961431, "answer_id": 59093750, "question_id": 59093405, "link": "https://stackoverflow.com/questions/59093405/static-result-in-a-recursive-haskell-function/59093750#59093750", "title": "Static result in a recursive Haskell function?", "body": "<p>Instead of just doing <code>otherwise = 1 + findString (drop 1 mainstring) substring</code>, compare the value with <code>-1</code> first. Look up <code>let</code> and <code>where</code> in your study materials, they will help. I think that's enough given it's an assignment.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 12452860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBdIwUBr_nSkiHrJKcoLuE8I4KBxEtTyZuTqu6s=k-s128", "display_name": "RedLine", "link": "https://stackoverflow.com/users/12452860/redline"}, "edited": false, "score": 0, "creation_date": 1575020729, "post_id": 59094590, "comment_id": 104436863, "body": "Thank you very much! I was thinking something like this, a separate variable for counting) just did&#39;nt know what that woud look like in haskell. I didn&#39;t really know the syntax for <code>where</code> so I will have to look into that properly."}], "tags": [], "owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "is_accepted": true, "score": 1, "last_activity_date": 1574965675, "creation_date": 1574965675, "answer_id": 59094590, "question_id": 59093405, "link": "https://stackoverflow.com/questions/59093405/static-result-in-a-recursive-haskell-function/59094590#59094590", "title": "Static result in a recursive Haskell function?", "body": "<p>Don't fix your thoughts on the type signatures, you can have define functions inside a function as well</p>\n\n<pre><code>findString :: String -&gt; String -&gt; Integer\nfindString mainstring substring = helper mainstring substring 0\n  where \n    helper mainstring substring len\n      | length substring &gt; length mainstring = (-1)\n      | take (length substring) mainstring == substring = len\n      | otherwise = helper (drop 1 mainstring) substring (len + 1)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12452860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBdIwUBr_nSkiHrJKcoLuE8I4KBxEtTyZuTqu6s=k-s128", "display_name": "RedLine", "link": "https://stackoverflow.com/users/12452860/redline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 59094590, "answer_count": 2, "score": 1, "last_activity_date": 1574965675, "creation_date": 1574959908, "question_id": 59093405, "link": "https://stackoverflow.com/questions/59093405/static-result-in-a-recursive-haskell-function", "title": "Static result in a recursive Haskell function?", "body": "<p>I am a beginner in Haskell programming and have gotten an assignment to create a function that checks if a given string is the substring of another string and if it is it returns the position of the substring in the main string. This is what I have so far:</p>\n\n<pre><code>findString :: String -&gt; String -&gt; Integer\nfindString mainstring substring \n   | length substring &gt; length mainstring = (-1)\n   | take (length substring) mainstring == substring  = 0\n   | otherwise = 1 + findString (drop 1 mainstring) substring\n</code></pre>\n\n<p>The instructions for this assignment explicitly state that I have to use <code>findString :: String -&gt; String -&gt; Integer</code> and that if the substring is not a substring of the mainstring it should return <code>(-1)</code>. Right now the recursive part of the function interferes with the result of<code>| length substring &gt; length mainstring = (-1)</code> by adding <code>+1</code> to it for each recursion but I just want a static <code>(-1)</code>. I feel like I'm very close here but I've been stuck on this one for quite some time now. Any help would be appreciated!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 1, "creation_date": 1574959722, "post_id": 59093287, "comment_id": 104420811, "body": "Because you have an extra definition. remove <code>makeNegative = error &quot;todo: makeNegative&quot;</code>"}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 1, "creation_date": 1574960835, "post_id": 59093287, "comment_id": 104421290, "body": "If you intend the 2nd clause as some sort of placeholder, it still needs to have one (possibly dummy) argument just like the first clause. Like: <code>makeNegative _ = error &quot;todo: makeNegative&quot;</code>. Otherwise the 2nd clause contradicts the type signature. But even like that, it is unreachable as is, and so the compiler will complain in another fashion."}], "answers": [{"tags": [], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "is_accepted": true, "score": 2, "last_activity_date": 1575057566, "creation_date": 1575057566, "answer_id": 59110381, "question_id": 59093287, "link": "https://stackoverflow.com/questions/59093287/equations-for-somefunction-have-different-numbers-of-arguments-codewars/59110381#59110381", "title": "Equations for `someFunction&#39; have different numbers of arguments (CodeWars)", "body": "<p>The problem lies in your definition of <code>makeNegative</code>. Notice there's three lines of the definition:</p>\n\n<pre><code>makeNegative :: (Num a) =&gt; a -&gt; a\nmakeNegative x = x + x\nmakeNegative = error \"todo: makeNegative\"\n</code></pre>\n\n<p>The first is the type signature, followed by two definitions. Oftentimes multiple definitions are provided when pattern matching on arguments and handling different cases; however in this case the pattern match will never fail; so the <code>error</code> line will never run.</p>\n\n<p>Regardless of the fact that it will never be run; Haskell still requires that all implementations of a function have the same number of bound arguments, <code>makeNegative x =</code> binds one argument (namely <code>x</code>); but the second definition <code>makeNegative =</code> doesn't bind any arguments. In this case it looks like it's a placeholder definition so you can just delete the line with <code>error</code> and it should work.</p>\n\n<p>Your <code>example</code> test only has a single definition, so it doesn't run into this issue.</p>\n"}], "owner": {"reputation": 6568, "user_id": 1795924, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tC8HY.jpg?s=128&g=1", "display_name": "Ericson Willians", "link": "https://stackoverflow.com/users/1795924/ericson-willians"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 59110381, "answer_count": 1, "score": -1, "last_activity_date": 1575057566, "creation_date": 1574959373, "question_id": 59093287, "link": "https://stackoverflow.com/questions/59093287/equations-for-somefunction-have-different-numbers-of-arguments-codewars", "title": "Equations for `someFunction&#39; have different numbers of arguments (CodeWars)", "body": "<p>I'm using in order to practice/learn Haskell. I'm having trouble understanding why a given situation works on my example local code, and doesn't work on CodeWars.</p>\n\n<p>On codewars:</p>\n\n<pre><code>module Codewars.Kata.Negative where\n\nmakeNegative :: (Num a) =&gt; a -&gt; a\nmakeNegative x = x + x\nmakeNegative = error \"todo: makeNegative\"\n</code></pre>\n\n<p>This gives me:</p>\n\n<pre><code>Codewars/Kata/Negative.hs:4:1:\n    Equations for `makeNegative' have different numbers of arguments\n      Codewars/Kata/Negative.hs:4:1-22\n      Codewars/Kata/Negative.hs:5:1-41\n</code></pre>\n\n<p>But when I test it locally:</p>\n\n<pre><code>import Data.List\nimport System.IO\n\nexample :: (Num a) =&gt; a -&gt; a\nexample x = x + x\nmain = do\n  print (example(3))\n</code></pre>\n\n<p>It returns 6 properly. I can't even try to solve the problem because the compiler complains about the arguments. I <em>kinda</em> got it that Num is a \"typeclass\", but I don't get how that works differently on codewars. I guess its because of that \"where\" clause there.</p>\n"}, {"tags": ["haskell", "io", "architecture", "software-design", "purely-functional"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 3, "creation_date": 1574961075, "post_id": 59092892, "comment_id": 104421381, "body": "&quot;the first one would be littered with IO everywhere&quot; If it works it works, one doesn&#39;t need to be a purist over purity. Still, if you wanted to contain the proliferation of <code>IO</code>, you could make different parts of the program work not in a concrete monad, but polymorphically over any monad that provided the operations required for the current component. Only at composition time you would specify the concrete monad. There are various ways to do this in Haskell. The &quot;mtl&quot; library, <code>ReaderT</code>-based approaches reminiscent of OO-dependency injection, extensible effects libraries..."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1574961998, "post_id": 59092892, "comment_id": 104421717, "body": "Related: <a href=\"https://stackoverflow.com/questions/57703898/how-to-call-impure-functions-from-pure-ones\" title=\"how to call impure functions from pure ones\">stackoverflow.com/questions/57703898/&hellip;</a>"}, {"owner": {"reputation": 381, "user_id": 2197587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2145fb9dff1eec2badb45f58e8fd936f?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/2197587/federico"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1574962191, "post_id": 59092892, "comment_id": 104421784, "body": "@danidiaz From the most voted answer in the linked question: &quot;In many cases, you can get away with what I call an <i>impure-pure-impure sandwich</i>&quot;. This is exactly what I called the <i>interaction-driven</i> approach: <code>input -&gt; (state transformation) -&gt; output</code>. This seems to corroborate my thesis that the purity of the language forces this architecture. I was interested in learning if there are other more reasonable approaches."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1574963432, "post_id": 59092892, "comment_id": 104422214, "body": "Notice that you can wrap the interaction-driven approach in a main loop to get the logic-driven version, but you can&#39;t wrap the logic-driven version to make it interaction-driven unless you have something like coroutines, and even then it&#39;s a pain."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1574965240, "post_id": 59092892, "comment_id": 104422812, "body": "FWIW: <a href=\"https://blog.ploeh.dk/2017/07/10/pure-interactions\" rel=\"nofollow noreferrer\">blog.ploeh.dk/2017/07/10/pure-interactions</a>"}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 0, "last_activity_date": 1574981855, "creation_date": 1574981855, "answer_id": 59096976, "question_id": 59092892, "link": "https://stackoverflow.com/questions/59092892/software-architecture-in-pure-languages-haskell-logic-driven-vs-interaction/59096976#59096976", "title": "Software architecture in pure languages (Haskell): logic-driven vs. interaction-driven", "body": "<p>I suppose the Haskell equivalent of your Logic-Driven implementation (with error handling omitted) is something like this:</p>\n\n<pre><code>{-# OPTIONS_GHC -Wall #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nimport System.Random\nimport Control.Monad\nimport Control.Monad.State\nimport Control.Monad.Trans.Maybe\n\ndata Game = Game Int Range Player Player\ntype Range = (Int, Int)\ndata Player = Player String (Range -&gt; IO Int)\n\nhumanPlayer, computerPlayer :: String -&gt; Player\nhumanPlayer nam = Player nam strategy\n  where strategy _ = do\n          putStrLn \"Please enter your guess:\"\n          readLn\ncomputerPlayer nam = Player nam strategy\n  where strategy s = do\n          x &lt;- randomRIO s\n          putStrLn $ nam ++ \" guessing \" ++ show x\n          return x\n\nnewGame :: Player -&gt; Player -&gt; IO Game\nnewGame p1 p2 = do\n  let s = (0,100)\n  x &lt;- randomRIO s\n  return $ Game x s p1 p2\n\nrun :: Game -&gt; IO ()\nrun (Game x s0 p1 p2)\n  = do Nothing &lt;- runMaybeT $ evalStateT game s0\n       return ()\n  where\n    game = mapM_ runPlayer $ cycle [p1, p2]\n    runPlayer (Player nam strat) = do\n      s@(lo,hi) &lt;- get\n      liftIO . putStrLn $ \"Current state = \" ++ show s\n      guess &lt;- liftIO $ strat s\n      put =&lt;&lt; case compare x guess of\n        LT -&gt; return (lo, guess-1)\n        GT -&gt; return (guess+1, hi)\n        EQ -&gt; do\n          liftIO . putStrLn $ nam ++ \" wins!\"\n          mzero\n\nmain :: IO ()\nmain = run =&lt;&lt; newGame (humanPlayer \"Human\") (computerPlayer \"Computer\")\n</code></pre>\n\n<p>We could tear our hair, rend our clothes, and moan pitifully that we had to use <code>liftIO</code>s in a few places and that the monad transformer stack hurts our tummies, but it mostly looks like idiomatic Haskell code to me, except perhaps that using MaybeT to end a loop is a little ugly.  (Like many Haskell programmers who should know better, I got swept up in the pleasing form of the minor expression <code>mapM_ runPlayer $ cycle [p1, p2]</code> and wrote a silly monad stack to accommodate it.)</p>\n\n<p>I guess I find it a little disingenuous to argue that, on the one hand, in an effectful language like Rust we can effortlessly mix pure and impure code because the pure code is actually written in an impure language, but for some reason if we try to write the same code in Haskell, we are bound by God and Country to write our pure code outside the IO monad and then bemoan the fact that we can't do IO there and so our implementation choices are suddenly limited.  Writing \"pure\" code in an impure context isn't a capital offense, in Haskell or any other language.</p>\n\n<p>In particular, you can easily write an obviously pure player for this implementation:</p>\n\n<pre><code>purePlayer :: String -&gt; Player\npurePlayer nam = Player nam (return . pureStrategy)\n  where pureStrategy :: Range -&gt; Int\n        pureStrategy (lo, hi) = (lo + hi) `div` 2\n</code></pre>\n\n<p>or, if you're a zealot, you could make the above code polymorphic in the base monad, and use <code>IO</code> for the human but <code>Identity</code> for the <code>purePlayer</code>.  Ta da, your pure player is now truly pure, and you can tell all your dimwitted, effectful Rust friends that you're so much better than they are while boasting to your genius, pure Haskell friends that you just figured out why they invented <code>UnliftIO</code>.</p>\n"}], "owner": {"reputation": 381, "user_id": 2197587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2145fb9dff1eec2badb45f58e8fd936f?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/2197587/federico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1574981855, "creation_date": 1574957741, "question_id": 59092892, "link": "https://stackoverflow.com/questions/59092892/software-architecture-in-pure-languages-haskell-logic-driven-vs-interaction", "title": "Software architecture in pure languages (Haskell): logic-driven vs. interaction-driven", "body": "<p>I'm trying to learn best practices on how to structure a program in a pure functional language (Haskell), but I'm having trouble with an architecture which I find natural but cannot replicate easily in the \"pure world\".</p>\n\n<p>Let me describe a simple model case: a two-player guessing game.</p>\n\n<blockquote>\n  <h2>Game rules</h2>\n  \n  <ol>\n  <li>A secret random integer number in [0, 100] is generated.</li>\n  <li>Players take turns trying to guess the secret number.</li>\n  <li>If the guess is correct, the player wins.</li>\n  <li>Otherwise the game tells whether the secret number is larger or smaller than the guess and the possible range for the unknown secret is updated.</li>\n  </ol>\n</blockquote>\n\n<p>My question concerns the implementation of this game where a human player plays against the computer.</p>\n\n<p>I propose two implementations:</p>\n\n<ul>\n<li>logic driven</li>\n<li>interaction driven</li>\n</ul>\n\n<h1>Logic-driven</h1>\n\n<p>In the logic-driven implementation, the execution is driven by the game logic. A <code>Game</code> has a <code>State</code> and some participating <code>Player</code>s. The <code>Game::run</code> function makes the players play in turns and updates the game state until completion. The players receive a state in <code>Player::play</code> and return the move they decide to play.</p>\n\n<p>The benefits that I can see of this approach are:</p>\n\n<ol>\n<li>the architecture is very clean and natural;</li>\n<li>it abstracts the nature of a <code>Player</code>: a <code>HumanPlayer</code> and a <code>ComputerPlayer</code> are interchangeable, even if the former has to deal with IO, whereas the latter represents a pure computation (you can verify this by putting <code>Game::new(ComputerPlayer::new(\"CPU-1\"), ComputerPlayer::new(\"CPU-2\"))</code> in the <code>main</code> function and watching the computer battle).</li>\n</ol>\n\n<p>Here is a possible implementation in Rust:</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>use rand::Rng;\nuse std::io::{self, Write};\n\nfn min&lt;T: Ord&gt;(x: T, y: T) -&gt; T { if x &lt;= y { x } else { y } }\n\nfn max&lt;T: Ord&gt;(x: T, y: T) -&gt; T { if x &gt;= y { x } else { y } }\n\nstruct Game&lt;P1, P2&gt; {\n    secret: i32,\n    state: State,\n    p1: P1,\n    p2: P2,\n}\n\n#[derive(Clone, Copy, Debug)]\nstruct State {\n    lower: i32,\n    upper: i32,\n}\n\nstruct Move(i32);\n\ntrait Player {\n    fn name(&amp;self) -&gt; &amp;str;\n    fn play(&amp;mut self, st: State) -&gt; Move;\n}\n\nstruct HumanPlayer {\n    name: String,\n}\n\nstruct ComputerPlayer {\n    name: String,\n}\n\nimpl HumanPlayer {\n    fn new(name: &amp;str) -&gt; Self {\n        Self {\n            name: String::from(name),\n        }\n    }\n}\n\nimpl ComputerPlayer {\n    fn new(name: &amp;str) -&gt; Self {\n        Self {\n            name: String::from(name),\n        }\n    }\n}\n\nimpl Player for HumanPlayer {\n    fn name(&amp;self) -&gt; &amp;str {\n        &amp;self.name\n    }\n\n    fn play(&amp;mut self, _st: State) -&gt; Move {\n        let mut s = String::new();\n        print!(\"Please enter your guess: \");\n        let _ = io::stdout().flush();\n        io::stdin().read_line(&amp;mut s).expect(\"Error reading input\");\n        let guess = s.trim().parse().expect(\"Error parsing number\");\n        println!(\"{} guessing {}\", self.name, guess);\n        Move(guess)\n    }\n}\n\nimpl Player for ComputerPlayer {\n    fn name(&amp;self) -&gt; &amp;str {\n        &amp;self.name\n    }\n\n    fn play(&amp;mut self, st: State) -&gt; Move {\n        let mut rng = rand::thread_rng();\n        let guess = rng.gen_range(st.lower, st.upper + 1);\n        println!(\"{} guessing {}\", self.name, guess);\n        Move(guess)\n    }\n}\n\nimpl&lt;P1, P2&gt; Game&lt;P1, P2&gt;\nwhere\n    P1: Player,\n    P2: Player,\n{\n    fn new(p1: P1, p2: P2) -&gt; Self {\n        let mut rng = rand::thread_rng();\n        Game {\n            secret: rng.gen_range(0, 101),\n            state: State {\n                lower: 0,\n                upper: 100,\n            },\n            p1,\n            p2,\n        }\n    }\n\n    fn run(&amp;mut self) {\n        loop {\n            // Player 1's turn\n            self.report();\n            let m1 = self.p1.play(self.state);\n            if self.update(m1) {\n                println!(\"{} wins!\", self.p1.name());\n                break;\n            }\n            // Player 2's turn\n            self.report();\n            let m2 = self.p2.play(self.state);\n            if self.update(m2) {\n                println!(\"{} wins!\", self.p2.name());\n                break;\n            }\n        }\n    }\n\n    fn update(&amp;mut self, mv: Move) -&gt; bool {\n        let Move(m) = mv;\n        if m &lt; self.secret {\n            self.state.lower = max(self.state.lower, m + 1);\n            false\n        } else if m &gt; self.secret {\n            self.state.upper = min(self.state.upper, m - 1);\n            false\n        } else {\n            true\n        }\n    }\n\n    fn report(&amp;self) {\n        println!(\"Current state = {:?}\", self.state);\n    }\n}\n\nfn main() {\n    let mut game = Game::new(HumanPlayer::new(\"Human\"), ComputerPlayer::new(\"CPU\"));\n    game.run();\n}\n</code></pre>\n\n<h1>Interaction-driven</h1>\n\n<p>In the interaction-driven implementation, all the functionalities related to the game, including the decisions taken by the computer players, must be pure functions without side effects. <code>HumanPlayer</code> becomes then the interface through which the real person sitting in front of the computer interacts with the game. In a certain sense, the game becomes a function mapping user input to an updated state.</p>\n\n<p>This is the approach that, to my eyes, seems to be forced by a pure language, because all the logic of the game becomes a pure computation, free of side effects, simply transforming an old state to a new state.</p>\n\n<p>I kind of like also this point of view (separating <code>input -&gt; (state transformation) -&gt; output</code>): it definitely has some merits, but I feel that, as can be easily seen in this example, it breaks some other good properties of the program, such as the symmetry between human player and computer player. From the point of view of the game logic, its doesn't matter whether the decision for the next move comes from a pure computation performed by the computer or a user interaction involving IO.</p>\n\n<p>I provide here a reference implementation, again in Rust:</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>use rand::Rng;\nuse std::io::{self, Write};\n\nfn min&lt;T: Ord&gt;(x: T, y: T) -&gt; T { if x &lt;= y { x } else { y } }\n\nfn max&lt;T: Ord&gt;(x: T, y: T) -&gt; T { if x &gt;= y { x } else { y } }\n\nstruct Game {\n    secret: i32,\n    state: State,\n    computer: ComputerPlayer,\n}\n\n#[derive(Clone, Copy, Debug)]\nstruct State {\n    lower: i32,\n    upper: i32,\n}\n\nstruct Move(i32);\n\nstruct HumanPlayer {\n    name: String,\n    game: Game,\n}\n\nstruct ComputerPlayer {\n    name: String,\n}\n\nimpl HumanPlayer {\n    fn new(name: &amp;str, game: Game) -&gt; Self {\n        Self {\n            name: String::from(name),\n            game,\n        }\n    }\n\n    fn name(&amp;self) -&gt; &amp;str {\n        &amp;self.name\n    }\n\n    fn ask_user(&amp;self) -&gt; Move {\n        let mut s = String::new();\n        print!(\"Please enter your guess: \");\n        let _ = io::stdout().flush();\n        io::stdin().read_line(&amp;mut s).expect(\"Error reading input\");\n        let guess = s.trim().parse().expect(\"Error parsing number\");\n        println!(\"{} guessing {}\", self.name, guess);\n        Move(guess)\n    }\n\n    fn process_human_player_turn(&amp;mut self) -&gt; bool {\n        self.game.report();\n        let m = self.ask_user();\n        if self.game.update(m) {\n            println!(\"{} wins!\", self.name());\n            return false;\n        }\n\n        self.game.report();\n        let m = self.game.computer.play(self.game.state);\n        if self.game.update(m) {\n            println!(\"{} wins!\", self.game.computer.name());\n            return false;\n        }\n\n        true\n    }\n\n    fn run_game(&amp;mut self) {\n        while self.process_human_player_turn() {}\n    }\n}\n\nimpl ComputerPlayer {\n    fn new(name: &amp;str) -&gt; Self {\n        Self {\n            name: String::from(name),\n        }\n    }\n\n    fn name(&amp;self) -&gt; &amp;str {\n        &amp;self.name\n    }\n\n    fn play(&amp;mut self, st: State) -&gt; Move {\n        let mut rng = rand::thread_rng();\n        let guess = rng.gen_range(st.lower, st.upper + 1);\n        println!(\"{} guessing {}\", self.name, guess);\n        Move(guess)\n    }\n}\n\nimpl Game {\n    fn new(computer: ComputerPlayer) -&gt; Self {\n        let mut rng = rand::thread_rng();\n        Game {\n            secret: rng.gen_range(0, 101),\n            state: State {\n                lower: 0,\n                upper: 100,\n            },\n            computer,\n        }\n    }\n\n    fn update(&amp;mut self, mv: Move) -&gt; bool {\n        let Move(m) = mv;\n        if m &lt; self.secret {\n            self.state.lower = max(self.state.lower, m + 1);\n            false\n        } else if m &gt; self.secret {\n            self.state.upper = min(self.state.upper, m - 1);\n            false\n        } else {\n            true\n        }\n    }\n\n    fn report(&amp;self) {\n        println!(\"Current state = {:?}\", self.state);\n    }\n}\n\nfn main() {\n    let mut p = HumanPlayer::new(\"Human\", Game::new(ComputerPlayer::new(\"CPU\")));\n    p.run_game();\n}\n</code></pre>\n\n<h1>Conclusion</h1>\n\n<p>An effectful language (such as Rust) gives us the flexibility to choose the approach based on our priorities: either symmetry between human and computer players or sharp separation between pure computation (state transformation) and IO (user interaction).</p>\n\n<p>Given my current knowledge of Haskell, I cannot say the same about the pure world: I feel forced to adopt the second approach, because the first one would be littered with <code>IO</code> everywhere. In particular, I would like the hear some words from some functional programming gurus on how to implement in Haskell the logic-driven approach and what are their opinions/comments on the subject.</p>\n\n<p>I'm prepared to learn a lot of insight from this.</p>\n"}, {"tags": ["haskell", "record", "ghc", "template-haskell"], "comments": [{"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 4, "creation_date": 1574957894, "post_id": 59092812, "comment_id": 104419996, "body": "You should never use record syntax with sum types, it is really a bad practice. If you want accessors and modifiers like the ones you are asking you need to write them yourself with some pattern matching. That being said, since it is pretty straightforward boiler plate I am sure you can write some template Haskell for it. I wouldn&#39;t be surprised if someone already did."}], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1574959639, "creation_date": 1574959639, "answer_id": 59093343, "question_id": 59092812, "link": "https://stackoverflow.com/questions/59092812/accessing-record-fields-as-maybe-values-in-haskell/59093343#59093343", "title": "Accessing record fields as &#39;Maybe&#39; values in Haskell", "body": "<p>No, there's no way to do this with record selectors. To understand why, remember that they can be used for record updates, rather than just as a function. If <code>x = Empty</code>, then there's still nothing reasonable that <code>x { st = \"foo\" }</code> could be. If you don't care about the functions actually being records, then you could use Template Haskell to generate just the functions you want, though.</p>\n"}], "owner": {"reputation": 31, "user_id": 12452684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vQxvv.jpg?s=128&g=1", "display_name": "myc3lium", "link": "https://stackoverflow.com/users/12452684/myc3lium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1574959639, "creation_date": 1574957467, "question_id": 59092812, "link": "https://stackoverflow.com/questions/59092812/accessing-record-fields-as-maybe-values-in-haskell", "title": "Accessing record fields as &#39;Maybe&#39; values in Haskell", "body": "<p>In Haskell, if I specify field names for a type with a single constructor, the compiler should generate appropriate functions <code>MyType -&gt; fieldType</code>. This breaks down if <code>MyType</code> has multiple constructors with different arities or types however. I want to know if there is some way I can tell the compiler to give these functions the signature <code>MyType -&gt; Maybe fieldType</code>. i.e. instead of:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data MyType = Empty | Record { st :: String, ui :: Word }\n-- where\n-- st Empty == undefined\n-- ui Empty == undefined\n\n-- I have\ndata MyType = Empty | Record { st :: String, ui :: Word }\n-- where\n-- st :: MyType -&gt; Maybe String\n-- st Empty = Nothing\n-- st (Record s _) = Just s\n-- \n-- ui Empty = Nothing\n-- ui (Record _ n) = n\n</code></pre>\n\n<p>I want to avoid the default behaviour of having expressions like <code>st Empty</code> returning <code>undefined</code>, because if <code>st Empty</code> returns <code>Nothing</code>, I can use pattern matching to decide on what to do next, rather than having to catch the exception further up the callstack in impure code. I realise this is not part of Haskell by default, so I wonder if there is a compiler extension that allows this? Alternately, could I implement something like this myself using templating?</p>\n"}, {"tags": ["java", "parsing", "haskell", "cross-compiling", "grammar"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1574957057, "post_id": 59092560, "comment_id": 104419552, "body": "If you have to ask this question, then you have no hope of completing that highly ambitious project. Also, note that <a href=\"https://github.com/Frege/frege\" rel=\"nofollow noreferrer\">Frege</a> and <a href=\"https://eta-lang.org/\" rel=\"nofollow noreferrer\">Eta</a> both already do that."}, {"owner": {"reputation": 29, "user_id": 10500484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DdE6PHpWIUk/AAAAAAAAAAI/AAAAAAAAABI/o3VBtsfZdcU/photo.jpg?sz=128", "display_name": "Noah Stutznegger", "link": "https://stackoverflow.com/users/10500484/noah-stutznegger"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574982186, "post_id": 59092560, "comment_id": 104427257, "body": "I&#39;m asking because I am unfamiliar with Haskell and new to writing interpreters/parsers"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574982272, "post_id": 59092560, "comment_id": 104427277, "body": "Trying to write a compiler or interpreter for a large, complex language that you&#39;re unfamiliar with is a bad idea, especially if you don&#39;t understand interpreters or parsers. You should pick a much simpler project to get your feet wet with."}, {"owner": {"reputation": 29, "user_id": 10500484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DdE6PHpWIUk/AAAAAAAAAAI/AAAAAAAAABI/o3VBtsfZdcU/photo.jpg?sz=128", "display_name": "Noah Stutznegger", "link": "https://stackoverflow.com/users/10500484/noah-stutznegger"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574983394, "post_id": 59092560, "comment_id": 104427450, "body": "Also, those are essentially cross-compilers. I want this library to be a parser written in Java that reads Haskell, parses it, and compiles it into Java."}, {"owner": {"reputation": 2810, "user_id": 1428369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jS1Jx.png?s=128&g=1", "display_name": "Nikolai Dmitriev", "link": "https://stackoverflow.com/users/1428369/nikolai-dmitriev"}, "edited": false, "score": 0, "creation_date": 1575146805, "post_id": 59092560, "comment_id": 104469870, "body": "@NoahStutznegger I tried to argue that cross compiling is even harder than compiling because the conceptual differences to bridge are bigger (as I tried to point out in the answer aside dumping info about the grammar).  Except you make everything type <code>Object</code> or so, which seems to work somehow since there&#39;s the cross-compiler chain haskell-&gt;javascript-&gt; java. If you get it running you could get a preview of the resulting java. Scala is closer to Haskell, you could try a Haskell-&gt;Scala cross compiler ;)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2810, "user_id": 1428369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jS1Jx.png?s=128&g=1", "display_name": "Nikolai Dmitriev", "link": "https://stackoverflow.com/users/1428369/nikolai-dmitriev"}, "edited": false, "score": 0, "creation_date": 1610832195, "post_id": 59092560, "comment_id": 116258365, "body": "@NikolaiDmitriev, wrong language there; this site is English only."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1610832867, "post_id": 59092560, "comment_id": 116258556, "body": "Note that parsing Haskell doesn&#39;t get you all the way to an abstract syntax tree. Thanks to operator precedence declarations, you have to finish &quot;parenthesizing&quot; expressions after you&#39;ve looked up where each operator comes from (GHC calls this &quot;renaming&quot;)."}, {"owner": {"reputation": 2810, "user_id": 1428369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jS1Jx.png?s=128&g=1", "display_name": "Nikolai Dmitriev", "link": "https://stackoverflow.com/users/1428369/nikolai-dmitriev"}, "edited": false, "score": 0, "creation_date": 1610881162, "post_id": 59092560, "comment_id": 116267002, "body": "Check out <a href=\"https://www.aosabook.org/en/ghc.html\" rel=\"nofollow noreferrer\">these notes</a> explaining how ghc compiles down to a typed lambda calculus which might be a comparatively straight forward thing to express in java. But maybe not what you intended."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10500484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DdE6PHpWIUk/AAAAAAAAAAI/AAAAAAAAABI/o3VBtsfZdcU/photo.jpg?sz=128", "display_name": "Noah Stutznegger", "link": "https://stackoverflow.com/users/10500484/noah-stutznegger"}, "edited": false, "score": 0, "creation_date": 1575305515, "post_id": 59092833, "comment_id": 104513074, "body": "I&#39;m aware there are already premade solutions, but I want to build Jaskell from scratch, not using any external libraries. The whole reason I decided to set out on this (admittedly foolhardy) venture is as a programming challenge to myself so I can become a better programmer."}, {"owner": {"reputation": 29, "user_id": 10500484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DdE6PHpWIUk/AAAAAAAAAAI/AAAAAAAAABI/o3VBtsfZdcU/photo.jpg?sz=128", "display_name": "Noah Stutznegger", "link": "https://stackoverflow.com/users/10500484/noah-stutznegger"}, "edited": false, "score": 0, "creation_date": 1575305683, "post_id": 59092833, "comment_id": 104513145, "body": "It is my hope that in doing this, I will be able to learn more about imperative and declaritve languages, in the hopes that I might one day be able to make my own programming language from scratch."}], "tags": [], "owner": {"reputation": 2810, "user_id": 1428369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jS1Jx.png?s=128&g=1", "display_name": "Nikolai Dmitriev", "link": "https://stackoverflow.com/users/1428369/nikolai-dmitriev"}, "is_accepted": false, "score": 5, "last_activity_date": 1610828097, "last_edit_date": 1610828097, "creation_date": 1574957547, "answer_id": 59092833, "question_id": 59092560, "link": "https://stackoverflow.com/questions/59092560/what-is-haskells-grammar-and-which-type-of-parser-can-parse-it/59092833#59092833", "title": "What is Haskell&#39;s grammar and which type of parser can parse it?", "body": "<blockquote>\n<p>I need to know Haskell's formal grammar structure</p>\n</blockquote>\n<p><a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch10.html\" rel=\"nofollow noreferrer\">Haskell's grammar</a> is <a href=\"http://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-210002.7\" rel=\"nofollow noreferrer\">context sensitive</a> due to <a href=\"http://trevorjim.com/haskell-is-not-context-free/\" rel=\"nofollow noreferrer\">significant indentation</a>. In both the lexical and the context-free syntax there are some ambiguities that are to be resolved by the <a href=\"https://en.wikipedia.org/wiki/Maximal_munch\" rel=\"nofollow noreferrer\">longest match</a> (&quot;maximal munch&quot;) rule.</p>\n<p>Differences between the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch10.html#x17-17500010\" rel=\"nofollow noreferrer\">syntax specification</a> and implementations do exist, supposedly none of them precisely implements the spec. Also there are a whole lot of <a href=\"https://hackage.haskell.org/package/Cabal-1.14.0/docs/Language-Haskell-Extension.html\" rel=\"nofollow noreferrer\">language extensions</a>.</p>\n<p>There's a <a href=\"http://eclipsefp.sourceforge.net/repo/net.sf.eclipsefp.haskell.core.jparser/antlr-src/haskell-lexer.g\" rel=\"nofollow noreferrer\">ready-made scanner definition</a> out there to scan Haskell with an older version of <a href=\"https://www.antlr.org/\" rel=\"nofollow noreferrer\">Antlr</a>, but still <a href=\"https://github.com/antlr/grammars-v4/issues/210\" rel=\"nofollow noreferrer\">no parsing grammar</a>. Guess you'd have to grab the parsers from aforementioned projects (Frege, Eta) or the <a href=\"https://hackage.haskell.org/package/haskell-src-exts\" rel=\"nofollow noreferrer\">ghc</a> itself.</p>\n<p>Looking at the <a href=\"https://gitlab.haskell.org/ghc/ghc/blob/master/compiler/parser/Parser.y\" rel=\"nofollow noreferrer\">source tree</a> and the descriptions of <a href=\"http://hackage.haskell.org/package/ghc-lib-parser\" rel=\"nofollow noreferrer\">ghc-lib-parser package</a>, we learn thanks to <a href=\"https://www.quora.com/What-kind-of-grammar-does-Haskell-have\" rel=\"nofollow noreferrer\">this post</a> that GHC\u2019s parser was produced by the <a href=\"https://www.haskell.org/happy/\" rel=\"nofollow noreferrer\">happy parser generator</a>, generating a <a href=\"https://en.wikipedia.org/wiki/LALR_parser\" rel=\"nofollow noreferrer\">LALR</a>(1) parser. This means that Haskell\u2019s grammar is unambiguous , not requiring happy\u2019s <a href=\"https://en.wikipedia.org/wiki/GLR_parser\" rel=\"nofollow noreferrer\">GLR</a>-generating abilities.</p>\n<blockquote>\n<p>make a parsing library that reads Haskell code ... then translates it into Java</p>\n</blockquote>\n<p>You want to create a Haskell-Java cross compiler. Just looking at the discrepancy of the type systems I'd say, that this is pretty far fetched. One can squeeze Haskell into JVM bytecode, but I can't imagine, that any kind of generated Java might be very useful. On the other hand Haskell compiles <a href=\"https://www.aosabook.org/en/ghc.html\" rel=\"nofollow noreferrer\">internally</a> to something called &quot;core language&quot;, a typed lambda calculus basically. That might be a more straight forward starting point.</p>\n<p>If you're interested, there's a <a href=\"https://haste-lang.org/\" rel=\"nofollow noreferrer\">Haskell-Javascript</a> cross compiler (based on ghc), and there's a <a href=\"http://www.jsweet.org/\" rel=\"nofollow noreferrer\">javascript-java</a> cross compiler. Problem solved! Or isn't it?</p>\n"}], "owner": {"reputation": 29, "user_id": 10500484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DdE6PHpWIUk/AAAAAAAAAAI/AAAAAAAAABI/o3VBtsfZdcU/photo.jpg?sz=128", "display_name": "Noah Stutznegger", "link": "https://stackoverflow.com/users/10500484/noah-stutznegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1610828097, "creation_date": 1574956633, "last_edit_date": 1575602321, "question_id": 59092560, "link": "https://stackoverflow.com/questions/59092560/what-is-haskells-grammar-and-which-type-of-parser-can-parse-it", "title": "What is Haskell&#39;s grammar and which type of parser can parse it?", "body": "<p>I'm trying to make a parsing library for JDK 11.x that reads Haskell code as input, then translates it into Java to be executed by the JVM. I'm calling it Jaskell, but I need to know Haskell's formal grammar structure in order to determine what type of parser Jaskell needs to be (i.e. LL or LR parser).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5335, "user_id": 6920962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e62cd73355fc90d37429f9443df38da?s=128&d=identicon&r=PG&f=1", "display_name": "user28434", "link": "https://stackoverflow.com/users/6920962/user28434"}, "edited": false, "score": 0, "creation_date": 1574942869, "post_id": 59088505, "comment_id": 104412006, "body": "<a href=\"https://www.haskell.org/tutorial/classes.html\" rel=\"nofollow noreferrer\">haskell.org/tutorial/classes.html</a>"}, {"owner": {"reputation": 475, "user_id": 3993379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1027ad3128505e2ef6222c4e306e73?s=128&d=identicon&r=PG&f=1", "display_name": "FrownyFrog", "link": "https://stackoverflow.com/users/3993379/frownyfrog"}, "edited": false, "score": 1, "creation_date": 1574943154, "post_id": 59088505, "comment_id": 104412155, "body": "How about kind :: fueltype, no a?"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 2, "creation_date": 1574943236, "post_id": 59088505, "comment_id": 104412191, "body": "It depends how they are used later in the program. If it is just about pricing things, why not <code>data Fluid = Diesel {...} | Gasoline {...} | LPG {...} | AdBlue {...}</code> where the ellipses is always <code>volume :: Double, price :: Double</code>."}, {"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "reply_to_user": {"reputation": 475, "user_id": 3993379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1027ad3128505e2ef6222c4e306e73?s=128&d=identicon&r=PG&f=1", "display_name": "FrownyFrog", "link": "https://stackoverflow.com/users/3993379/frownyfrog"}, "edited": false, "score": 0, "creation_date": 1574943401, "post_id": 59088505, "comment_id": 104412294, "body": "@FrownyFrog Later on, they are used to check whether an engine is compatible with said fuel (can&#39;t throw gasoline in a diesel engine) and whether somebody filled up their AdBlue reservoir."}, {"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574943998, "post_id": 59088505, "comment_id": 104412572, "body": "@typetetris I didn&#39;t specify that in the question, but gasoline also has quite a few octane ratings. For example, 95%, 98%, 95% mixed with 10% ethanol. Would these also be new types in your answer?"}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 1, "creation_date": 1574947517, "post_id": 59088505, "comment_id": 104414469, "body": "Maybe the <code>Has</code> type class pattern is good for you. The idea is to have a type class named <code>HasFluidProperties</code> which has two methods: <code>volume</code> and <code>price</code>. Then you instantiate <code>FuelType</code> or If you prefer, create different types for each case. <a href=\"https://hackernoon.com/the-has-type-class-pattern-ca12adab70ae\" rel=\"nofollow noreferrer\">hackernoon.com/the-has-type-class-pattern-ca12adab70ae</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1574956459, "post_id": 59088505, "comment_id": 104419226, "body": "A type family might be a solution. See <a href=\"https://wiki.haskell.org/GHC/Type_families\" rel=\"nofollow noreferrer\">wiki.haskell.org/GHC/Type_families</a>. The relationship of an engine to the type of fuel it can use feels similar to the relationship between a map and the type of keys it uses."}, {"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574972091, "post_id": 59088505, "comment_id": 104424804, "body": "@typetetris I tried your method. It sadly gets in the way of the fuel compatibility check."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 475, "user_id": 3993379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1027ad3128505e2ef6222c4e306e73?s=128&d=identicon&r=PG&f=1", "display_name": "FrownyFrog", "link": "https://stackoverflow.com/users/3993379/frownyfrog"}, "edited": false, "score": 0, "creation_date": 1574996250, "post_id": 59088505, "comment_id": 104429546, "body": "I don&#39;t see what the problem is. This design is the one I would choose given what you have described about your problem (I might de-parameterize the fuel type as @FrownyFrog suggested, until I found a good reason to make it polymorphic). What&#39;s clunky when you try to use it?"}], "owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1574946028, "creation_date": 1574942732, "last_edit_date": 1574945003, "question_id": 59088505, "link": "https://stackoverflow.com/questions/59088505/modelling-two-kinds-of-objects-with-the-same-behavior", "title": "Modelling two kinds of objects with the same behavior", "body": "<p>I have two types of objects with the same properties, namely: <code>Fuel</code> and <code>AdBlue</code>. Both are <code>Fluid</code>s and they share the same logic.</p>\n\n<pre><code>data Fluid a = Fluid { volume :: Double, price :: Double, kind :: a }\n</code></pre>\n\n<p>The fields <code>volume</code> and <code>price</code> must be non-negative. The <code>kind</code> field is to distinguish what type of fluid it is. I've tried the following code.</p>\n\n<pre><code>data FuelType\n  = Diesel\n  | SuperE10 -- 90% octane with 10% ethanol (Super is gasoline)\n  | Super -- 95% octane\n  | SuperPlus -- 98% octane\n  | LPG\n\ntype Fuel = Fluid Fueltype\n</code></pre>\n\n<p>However, this make the API very clunky to use and it just doesn't feel right. How would you do it?</p>\n\n<p>The types are used to determine whether a vehicle can be refueled with a certain type of fuel. For example, you can't fill a diesel engine up with gasoline and vice versa. Diesel engines with the new EURO6 emissions norm need AdBlue.</p>\n"}, {"tags": ["windows", "haskell", "winapi", "memory"], "comments": [{"owner": {"reputation": 166, "user_id": 8185373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ZEXef8IQXQ/AAAAAAAAAAI/AAAAAAAAABk/mH0WwZYbEws/photo.jpg?sz=128", "display_name": "Joss Bird", "link": "https://stackoverflow.com/users/8185373/joss-bird"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1574943055, "post_id": 59088379, "comment_id": 104412100, "body": "@typetetris I tried the first suggestion and got <code>Couldn&#39;t match expected type &#39;IO a0&#39; with actual type &#39;Int32&#39;</code>, looking at the source they all use readProcessMemory I just thought peekP copied it to a separate buffer so wanted to use that one."}, {"owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 1, "creation_date": 1574990586, "post_id": 59088379, "comment_id": 104428652, "body": "@typetetris According to the so rule, please organize an answer instead of comment, in order to make it easier for people with the same issue find out."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 2, "creation_date": 1575022406, "post_id": 59088379, "comment_id": 104437733, "body": "Did so, deleted my comments, which went into the answer."}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 1, "last_activity_date": 1575022369, "creation_date": 1575022369, "answer_id": 59102785, "question_id": 59088379, "link": "https://stackoverflow.com/questions/59088379/haskell-reading-another-processs-memory/59102785#59102785", "title": "Haskell, reading another process&#39;s memory", "body": "<p>According to <a href=\"https://hackage.haskell.org/package/Win32-2.8.4.0/docs/System-Win32-DebugApi.html#v:peekP\" rel=\"nofollow noreferrer\">peekP Documentation</a> the signature of <code>peekP</code> is</p>\n\n<pre><code>peekP :: Storable a =&gt; PHANDLE -&gt; ForeignAddress -&gt; IO a\n</code></pre>\n\n<p>so it's polymorphic in the return type.</p>\n\n<p>If the compiler isn't able to deduce the concrete type used instead the type variable <code>a</code> it will issue such (or similar) an error message as you see it.</p>\n\n<p>As you suggested, you can help the compiler along with a type annotation, for example</p>\n\n<pre><code>result &lt;- ((peekP handle BASE_ADDRESS) :: IO Int32)\n</code></pre>\n\n<p>There is also <a href=\"https://hackage.haskell.org/package/Win32-2.8.4.0/docs/System-Win32-DebugApi.html#v:peekProcessMemory\" rel=\"nofollow noreferrer\">peekProcessMemory</a> which I guess by its name would be more appropriate.</p>\n"}], "owner": {"reputation": 166, "user_id": 8185373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ZEXef8IQXQ/AAAAAAAAAAI/AAAAAAAAABk/mH0WwZYbEws/photo.jpg?sz=128", "display_name": "Joss Bird", "link": "https://stackoverflow.com/users/8185373/joss-bird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 1, "accepted_answer_id": 59102785, "answer_count": 1, "score": 1, "last_activity_date": 1575022369, "creation_date": 1574942250, "question_id": 59088379, "link": "https://stackoverflow.com/questions/59088379/haskell-reading-another-processs-memory", "title": "Haskell, reading another process&#39;s memory", "body": "<p>I am trying to read the value of the base address of another process and output it.</p>\n\n<p>I am getting the handle like so:\n<code>handle &lt;- openProcess 0x0010 False PID</code></p>\n\n<p>then trying to read the base address like so <code>result &lt;- peekP handle BASE_ADDRESS</code></p>\n\n<p>However this obviously errors as it doesn't know what type it should be reading so I get:</p>\n\n<pre><code>Ambiguous type variable `a0' arising from a use of `peekP' prevents the constraint `(Storable a0)' from being solved.`\n</code></pre>\n\n<p>I believe I should use <code>::</code> somehow to specify the type of the storable I want to use but couldn't find anywhere that explained how to do this. </p>\n\n<p>It would be great if someone could show me how to do this.</p>\n\n<p>Sorry if this is a stupid question any help would be greatly appreciated.</p>\n"}]