[{"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1554355847, "post_id": 55505720, "comment_id": 97722179, "body": "<code>Value</code> has a <code>IsString</code> instance, so if you enable <code>-XOverloadedStrings</code> perhaps you could get rid of those explicit <code>String</code> constructors."}, {"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1554396327, "post_id": 55505720, "comment_id": 97746636, "body": "@danidiaz I get an <code>Ambiguous (ToJSON v)</code> :(, and without <code>OverloadedStrings</code>, the field names are seen as <code>String</code>, when expecting <code>Text</code>. I saw Aeson-qq, which, I dunno, maybe would help here, but just curious what best practices are"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1554545575, "post_id": 55505720, "comment_id": 97797903, "body": "The <code>object</code> function has signature <code>object :: [Pair] -&gt; Value</code>. <code>Pair</code> is simply <code>(Text, Value)</code>. With <code>OverloadedStrings</code> active, you could define entries with <i>literal</i> string values using <code>(&quot;method&quot;,&quot;GET&quot;)</code> instead of <code>&quot;method&quot; .= String &quot;GET&quot;</code> and it should work. <code>.=</code> has a more general signature that accepts any type with a <code>ToJSON</code> intance, and that was causing the ambiguity. You&#39;ll still need the <code>String</code> constructor for values that are not literal."}], "answers": [{"comments": [{"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1554493497, "post_id": 55540774, "comment_id": 97787992, "body": "Could you comment on this &quot;dynamic&quot; strategy? Am I setting up for failure by <i>not</i> declaring types+instances for everything? Is lensing into JSON responses reasonable? Or are there better strategies in general for working with data like this in Haskell?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 1, "creation_date": 1554762778, "post_id": 55540774, "comment_id": 97863482, "body": "Okay, I added some thoughts."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1554762764, "last_edit_date": 1554762764, "creation_date": 1554486067, "answer_id": 55540774, "question_id": 55505720, "link": "https://stackoverflow.com/questions/55505720/how-can-i-improve-the-ease-of-working-with-json-in-haskell/55540774#55540774", "title": "How can I improve the ease of working with JSON in Haskell?", "body": "<p><em>Update:</em> Added some comments on the \"dynamic strategy\" at the bottom.</p>\n\n<p>In similar situations, I've used single-character helpers to good effect:</p>\n\n<pre><code>json1 :: Value\njson1 = o[ \"batch\" .=\n           [ o[ \"method\" .= s\"GET\", \"name\" .= s\"oldmsg\",\n                   \"url\" .= s\"...\" ]\n           , o[ \"method\" .= s\"POST\", \"name\" .= s\"newmsg\",\n                   \"url\" .= s\"...\", \"body\" .= s\"...\" ]\n           ]\n         ]\n  where o = object\n        s = String\n</code></pre>\n\n<p>Note that the non-standard syntax (no space between one-character helper and argument) is intentional.  It's a signal to me and others reading my code that these are technical \"annotations\" to satisfy the type checker rather than a more usual kind of function call that's actually <em>doing</em> something.</p>\n\n<p>While this adds a little clutter, the annotations are easy to ignore while reading the code.  They're also easy to forget while writing code, but the type checker catches those, so they're easy to fix.</p>\n\n<p>In your particular case, I think some more structured helpers <strong>do</strong> make sense.  Something like:</p>\n\n<pre><code>softMove :: Text -&gt; Text -&gt; Text -&gt; Value\nsoftMove accessToken msgId groupId = object [\n  \"access_token\" .= accessToken\n  , \"batch\" .= [\n        get \"oldmsg\" (msgId &lt;&gt; \"?fields=from,message,id\")\n      , get \"imp\" \"{result=oldmsg:$.from.id}?fields=impersonate_token\"\n      , post \"newmsg\" (groupId &lt;&gt; \"...\") \"...\"\n      , post \"oldcomment\" \"{result=oldmsg:$.id}/comments\" \"...\"\n      , post \"newcomment\" \"{result=newmsg:$.id}/comments\" \"...\"\n      ]\n  ]\n  where get name url = object $ req \"GET\" name url\n        post name url body = object $ req \"POST\" name url \n                             &lt;&gt; [\"body\" .= s body]\n        req method name url = [ \"method\" .= s method, \"name\" .= s name, \n                                \"relative_url\" .= s url ]\n        s = String\n</code></pre>\n\n<p>Note that you can tailor these helpers to the <em>specific</em> JSON you're generating in a particular case and define them locally in a <code>where</code> clause.  You don't need to commit to some big chunk of ADT and function infrastructure that covers all JSON use-cases in your code, as you might do if the JSON was more unified in structure across the application.</p>\n\n<h3>Comments on the \"Dynamic Strategy\"</h3>\n\n<p>With respect to whether or not using a \"dynamic strategy\" is the right approach, it probably depends on more context than can realistically be shared in a Stack Overflow question.  But, taking a step back, the Haskell type system is useful to the extent that it helps clearly model the problem domain.  At its best, the types feel natural and assist you with writing correct code.  When they stop doing this, you need to rethink your types.</p>\n\n<p>The pain you encountered with a more traditional ADT-driven approach to this problem (rigidity of the types, proliferation of <code>Maybes</code>, and the \"tyranny of small differences\") suggests that these types were a bad model <strong>at least for what you were trying to do in this case.</strong>  In particular, given that your problem was one of generating fairly straightforward JSON directives/commands for an external API, rather than doing lots of data manipulation on structures that also happened to allow JSON serialization/deserialization, modeling the data as Haskell ADTs was probably overkill.</p>\n\n<p>My best guess is that, if you really wanted to properly model the FB Workplace API, you wouldn't want to do it at the JSON level.  Instead, you'd do it at a higher level of abstraction with <code>Message</code>, <code>Comment</code>, and <code>Group</code> types, and you'd end up wanting to generate the JSON dynamically anyway, because your types wouldn't directly map to the JSON structures expected by the API.</p>\n\n<p>It might be insightful to compare your problem to generating HTML.  Consider first the <code>lucid</code> (<code>blaze</code>-based) or <code>shakespeare</code> templating packages.  If you look at how these work, they don't try to build up HTML by generating a DOM with ADTs like <code>data Element = ImgElement ... | BlockquoteElement ...</code> and then serializing them to HTML.  Presumably the authors decided that this abstraction wasn't really necessary, because the HTML just needs to be <em>generated</em>, not <em>analyzed</em>.  Instead they use functions (<code>lucid</code>) or a quasiquoter (<code>shakespeare</code>) to build up a dynamic data structure representing an HTML document.  The chosen structure is rigid enough to ensure certain sorts of validity (e.g., proper matching of opening and closing element tags) but not others (e.g., no one stops you from sticking a <code>&lt;p&gt;</code> child in the middle of your <code>&lt;span&gt;</code> element).</p>\n\n<p>When you use these packages in a larger web app, you model the problem domain at a higher level of abstraction than HTML elements, and you generate the HTML in a largely dynamic fashion because there's not a clear one-to-one mapping between the types in your problem domain model and HTML elements.</p>\n\n<p>On the other hand, there's a <code>type-of-html</code> package that <em>does</em> model individual elements, so it's a type error to try to nest a <code>&lt;tr&gt;</code> inside <code>&lt;td&gt;</code> and so on.  Developing these types probably took a lot of work, and there's a lot of inflexibility \"baked in\", but the trade-off is a whole other level of type safety.  On the other hand, this seems easier to do for HTML than to do for a particular finicky JSON API.</p>\n"}], "owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 1, "accepted_answer_id": 55540774, "answer_count": 1, "score": 4, "last_activity_date": 1554762764, "creation_date": 1554334098, "last_edit_date": 1554337881, "question_id": 55505720, "link": "https://stackoverflow.com/questions/55505720/how-can-i-improve-the-ease-of-working-with-json-in-haskell", "title": "How can I improve the ease of working with JSON in Haskell?", "body": "<p>Haskell has become useful as a web language (thanks <code>Servant</code>!), and yet JSON is still so painful for me so I must be doing something wrong (?)</p>\n\n<p>I hear JSON mentioned as a pain point enough, and the responses I've heard revolve around \"use PureScript\", \"wait for Sub/Row Typing\", \"use esoterica, like Vinyl\", \"Aeson + just deal with the explosion of boiler plate data types\".</p>\n\n<p>As an (unfair) reference point, I really enjoy the ease of Clojure's JSON \"story\" (of course, it's a dynamic language, and has it's tradeoffs for which I still prefer Haskell).</p>\n\n<p>Here's an example I've been staring at for an hour.</p>\n\n<pre><code>{\n    \"access_token\": \"xxx\",\n    \"batch\": [\n        {\"method\":\"GET\", \"name\":\"oldmsg\", \"relative_url\": \"&lt;MESSAGE-ID&gt;?fields=from,message,id\"},\n        {\"method\":\"GET\", \"name\":\"imp\", \"relative_url\": \"{result=oldmsg:$.from.id}?fields=impersonate_token\"},\n        {\"method\":\"POST\", \"name\":\"newmsg\", \"relative_url\": \"&lt;GROUP-ID&gt;/feed?access_token={result=imp:$.impersonate_token}\", \"body\":\"message={result=oldmsg:$.message}\"},\n        {\"method\":\"POST\", \"name\":\"oldcomment\", \"relative_url\": \"{result=oldmsg:$.id}/comments\", \"body\":\"message=Post moved to https://workplace.facebook.com/{result=newmsg:$.id}\"},\n        {\"method\":\"POST\", \"name\":\"newcomment\", \"relative_url\": \"{result=newmsg:$.id}/comments\", \"body\":\"message=Post moved from https://workplace.facebook.com/{result=oldmsg:$.id}\"},\n    ]\n}\n</code></pre>\n\n<p>I need to POST this to FB workplace, which will copy a message to a new group, and comment a link on both, linking to each other.</p>\n\n<p>My first attempt looked something like: </p>\n\n<pre><code>data BatchReq = BatchReq {\n  method :: Text\n  , name :: Text\n  , relativeUrl :: Text\n  , body :: Maybe Text\n  }\n\ndata BatchReqs = BatchReqs {\n  accessToken :: Text\n  , batch :: [BatchReq]\n  }\n\nsoftMove tok msgId= BatchReqs tok [\n  BatchReq \"GET\" \"oldmsg\" (msgId `append` \"?fields=from,message,id\") Nothing\n  ...\n  ]\n</code></pre>\n\n<p>That's painfully rigid, and dealing with <code>Maybe</code>s all over is uncomfortable. Is <code>Nothing</code> a JSON <code>null</code>? Or should the field be absent? Then I worried about deriving the Aeson instances, and had to figure out how to convert eg <code>relativeUrl</code> to <code>relative_url</code>. Then I added an endpoint, and now I have name clashes. <code>DuplicateRecordFields</code>! But wait, that causes so many problems elsewhere. So update the data type to use eg <code>batchReqRelativeUrl</code>, and peel that off when deriving instances using <code>Typeable</code>s and <code>Proxy</code>s. Then I needed to add endpoints, and or massage the shape of that rigid data type for which I added more datapoints, trying to not let the \"tyranny of small differences\" bloat my data types too much.</p>\n\n<p>At this point, I was largely <em>consuming</em> JSON, so decided a \"dynamic\" thing would be to use <code>lens</code>es. So, to drill into a JSON field holding a group id I did:</p>\n\n<pre><code>filteredBy :: (Choice p, Applicative f) =&gt;  (a -&gt; Bool) -&gt; Getting (Data.Monoid.First a) s a -&gt; Optic' p f s s\nfilteredBy cond lens = filtered (\\x -&gt; maybe False cond (x ^? lens))\n\n-- the group to which to move the message\ngroupId :: AsValue s =&gt; s -&gt; AppM Text\ngroupId json  = maybe (error500 \"couldn't find group id in json.\")\n                pure (json ^? l)\n  where l = changeValue . key \"message_tags\" . values . filteredBy (== \"group\") (key \"type\") . key \"id\" . _String\n</code></pre>\n\n<p>That's rather heavy to access fields. But I also need to generate payloads, and I'm not skilled enough to see how lenses will be nice for that. Circling around to the motivating batch request, I've come up with a \"dynamic\" way of writing these payloads. It could be simplified with helper fns, but, I'm not even sure how much nicer it'll get with that.</p>\n\n<pre><code>softMove :: Text -&gt; Text -&gt; Text -&gt; Value\nsoftMove accessToken msgId groupId = object [\n  \"access_token\" .= accessToken\n  , \"batch\" .= [\n        object [\"method\" .= String \"GET\", \"name\" .= String \"oldmsg\", \"relative_url\" .= String (msgId `append` \"?fields=from,message,id\")]\n      , object [\"method\" .= String \"GET\", \"name\" .= String \"imp\", \"relative_url\" .= String \"{result=oldmsg:$.from.id}?fields=impersonate_token\"]\n      , object [\"method\" .= String \"POST\", \"name\" .= String \"newmsg\", \"relative_url\" .= String (groupId `append` \"/feed?access_token={result=imp:$.impersonate_token}\"), \"body\" .= String \"message={result=oldmsg:$.message}\"]\n      , object [\"method\" .= String \"POST\", \"name\" .= String \"oldcomment\", \"relative_url\" .= String \"{result=oldmsg:$.id}/comments\", \"body\" .= String \"message=Post moved to https://workplace.facebook.com/{result=newmsg:$.id}\"]\n      , object [\"method\" .= String \"POST\", \"name\" .= String \"newcomment\", \"relative_url\" .= String \"{result=newmsg:$.id}/comments\", \"body\" .= String \"message=Post moved from https://workplace.facebook.com/{result=oldmsg:$.id}\"]\n      ]\n  ]\n</code></pre>\n\n<p>I'm considering having JSON blobs in code or reading them in as files and using <code>Text.Printf</code> to splice in variables... </p>\n\n<p>I mean, I can do it all like this, but would sure appreciate finding an alternative. FB's API is a bit unique in that it can't be represented as a rigid data structure like a lot of REST APIs; they call it their Graph API which is quite a bit more dynamic in use, and treating it like a rigid API has been painful thus far.</p>\n\n<p>(Also, thanks to all the community help getting me this far with Haskell!)</p>\n"}, {"tags": ["function", "haskell", "merge"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1554328431, "post_id": 55504792, "comment_id": 97715686, "body": "What do you want the new function to do? What is <code>Dobbelsteen</code>? What is <code>giveValueDice</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 0, "creation_date": 1554367225, "post_id": 55505220, "comment_id": 97727956, "body": "Thank you! Now I understand it and it works, so really perfect answer :)"}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 4, "last_activity_date": 1554330349, "creation_date": 1554330349, "answer_id": 55505220, "question_id": 55504792, "link": "https://stackoverflow.com/questions/55504792/how-to-merge-two-functions-into-one-in-haskell/55505220#55505220", "title": "How to merge two functions into one in Haskell", "body": "<p>As you've already noticed, you can't just directly inline here; the reason for this is that you're pattern matching on <code>Stone</code> in <code>giveValueDice</code>. This pattern matching can be moved inside the right side of the list comprehension:</p>\n\n<pre><code> calculateScore :: [Dobbelsteen]  -&gt; Int\n calculateScore xs = sum[if d == 'W' then 5 else digitToInt d | (Stone d) &lt;- xs]\n</code></pre>\n\n<p>Another method for merging these two functions is using a <code>where</code> clause, which 'merges' one function into another while keeping them distince:</p>\n\n<pre><code> calculateScore :: [Dobbelsteen]  -&gt; Int\n calculateScore xs = sum[giveValueDice x | x &lt;- xs]\n   where\n     giveValueDice :: Dice -&gt; Int\n     giveValueDice (Stone d) = if d == 'W' then 5 else digitToInt d\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 55505220, "answer_count": 1, "score": -1, "last_activity_date": 1554330349, "creation_date": 1554327963, "question_id": 55504792, "link": "https://stackoverflow.com/questions/55504792/how-to-merge-two-functions-into-one-in-haskell", "title": "How to merge two functions into one in Haskell", "body": "<p>I want to merge two functions into one.</p>\n\n<p>The functions are </p>\n\n<pre><code> data Dice = Stone Char deriving (Show, Eq)\n\n calculateScore :: [Dobbelsteen]  -&gt; Int\n calculateScore xs = sum[giveValueDice x | x &lt;- xs]\n\n giveValueDice :: Dice -&gt; Int\n giveValueDice (Stone d) = if d == 'W' then 5 else digitToInt d\n</code></pre>\n\n<p>Normally, I would just copy one line into the first function en change a little bit to make the syntax correct. But here I am kinda lost how to do this</p>\n"}, {"tags": ["loops", "haskell", "while-loop", "do-loops", "do-notation"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1554324925, "post_id": 55504071, "comment_id": 97714447, "body": "What exactly are you trying to do? Note that Haskell doesn&#39;t have loops; it has recursion."}, {"owner": {"reputation": 31, "user_id": 10670725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8LJQHOkdtLA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iWgIjL5B6TMlXJlSxiG9QhoLJKpw/mo/photo.jpg?sz=128", "display_name": "Andy Tsao", "link": "https://stackoverflow.com/users/10670725/andy-tsao"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554325135, "post_id": 55504071, "comment_id": 97714530, "body": "sorry i&#39;m not native speaker, what I wanted to do is like this : acc_addition 1; then it shows 1;2; 3;4;5"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 7, "creation_date": 1554325908, "post_id": 55504071, "comment_id": 97714798, "body": "<code>do</code> is not a do-while loop, it is something completely different. If you&#39;re a Haskell beginner, which you appear to be, I&#39;d recommend reading <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">Learn You a Haskell</a> first."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1554327623, "post_id": 55504071, "comment_id": 97715394, "body": "I think the phrasing &quot;do and while loop&quot; was just unfortunate, and that the intended meaning was &quot;How do I write this while-loop equivalent using &#39;do&#39;?&quot;, i.e. &quot;How do I make this tail recursive function monadic?&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 31, "user_id": 10670725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8LJQHOkdtLA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iWgIjL5B6TMlXJlSxiG9QhoLJKpw/mo/photo.jpg?sz=128", "display_name": "Andy Tsao", "link": "https://stackoverflow.com/users/10670725/andy-tsao"}, "edited": false, "score": 1, "creation_date": 1554345014, "post_id": 55504594, "comment_id": 97719604, "body": "@AndyTsao: Here are <a href=\"https://gist.github.com/evincarofautumn/a9a85543ec788f8d5a3fa20e8b9003d5\" rel=\"nofollow noreferrer\">some minor style suggestions</a> as well."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 31, "user_id": 10670725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8LJQHOkdtLA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iWgIjL5B6TMlXJlSxiG9QhoLJKpw/mo/photo.jpg?sz=128", "display_name": "Andy Tsao", "link": "https://stackoverflow.com/users/10670725/andy-tsao"}, "edited": false, "score": 0, "creation_date": 1554373793, "post_id": 55504594, "comment_id": 97732053, "body": "@AndyTsao A few minor points: the above style is usually avoided in Haskell, when it is possible to do so. We do not like to mix pure computation and IO further than needed. In this specific case, one could instead write a pure function generating the list <code>[1,2,2,3,3,4,4]</code> (using recursion), and then finally print that list (<code>for_ myList print</code>). Also, it is usually recommended to start writing any top-level function from its type, so to allow GHC to produce better error messages."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1583759942, "post_id": 55504594, "comment_id": 107213479, "body": "instead of adding the <code>in</code> you could also un-indent the <code>if</code> to start at exactly the same indentation as <code>let</code> above it."}], "tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": true, "score": 1, "last_activity_date": 1554327031, "creation_date": 1554327031, "answer_id": 55504594, "question_id": 55504071, "link": "https://stackoverflow.com/questions/55504071/how-to-use-do-and-while-loop-in-haskell/55504594#55504594", "title": "how to use do and while loop in haskell", "body": "<p>You're pretty close, you just have to call <code>acc_addition</code> instead of <code>addition</code> as the last step. Syntactically, you also need an <code>in</code> for your <code>let</code> statement:</p>\n\n<pre><code>addition x = x+1\nacc_addition xs = do print xs\n                     let result = addition xs in\n                         if result == 5\n                            then return ()\n                            else do\n                                 print result\n                                 acc_addition result\n</code></pre>\n\n<p>When run via <code>ghci</code>:</p>\n\n<pre><code>*Main&gt; acc_addition 1\n1\n2\n2\n3\n3\n4\n4\n</code></pre>\n\n<p>The reason why it prints twice is of course that you have two print statements. </p>\n"}], "owner": {"reputation": 31, "user_id": 10670725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8LJQHOkdtLA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iWgIjL5B6TMlXJlSxiG9QhoLJKpw/mo/photo.jpg?sz=128", "display_name": "Andy Tsao", "link": "https://stackoverflow.com/users/10670725/andy-tsao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 55504594, "answer_count": 1, "score": -2, "last_activity_date": 1583759650, "creation_date": 1554324722, "last_edit_date": 1583759650, "question_id": 55504071, "link": "https://stackoverflow.com/questions/55504071/how-to-use-do-and-while-loop-in-haskell", "title": "how to use do and while loop in haskell", "body": "<p>I tried to use an addition and print every step, but it doesn't work, can someone help me out please?</p>\n\n<pre><code>addition x = x+1\nacc_addition xs = do print xs\n                     let result = addition xs\n                         if result == 5\n                            then return ()\n                            else do\n                                 print result\n                                 addition result\n</code></pre>\n"}, {"tags": ["string", "list", "haskell", "char"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1554322626, "post_id": 55503578, "comment_id": 97713462, "body": "A string is already a list of characters in Haskell. It&#39;s just a type alias."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554322993, "post_id": 55503578, "comment_id": 97713610, "body": "Nevermind,I see I misunderstood your question. You want to format the string in a particular way, with commas between each character and surrounding parentheses? But I don&#39;t know what <code>Steen</code> is, or <code>Lettre</code> (is it a type alias for <code>Char</code>?)"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 0, "creation_date": 1554324144, "post_id": 55503713, "comment_id": 97714100, "body": "Hey, thanks for answering, but how do I do that when the chars are in a list?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 1, "creation_date": 1554324717, "post_id": 55503713, "comment_id": 97714357, "body": "<code>type String = [Char]</code>; <code>&quot;foo&quot;</code> is just syntactic sugar for <code>[&#39;f&#39;, &#39;o&#39;, &#39;o&#39;]</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 0, "creation_date": 1554324842, "post_id": 55503713, "comment_id": 97714408, "body": "In fact, <code>intersperse :: a -&gt; [a] -&gt; [a]</code> and <code>intercalate :: [a] -&gt; [[a]] -&gt; [a]</code> are defined in <code>Data.List</code>, and work on strings <i>because</i> a string is just a list of <code>Char</code>."}, {"owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 0, "creation_date": 1554325213, "post_id": 55503713, "comment_id": 97714556, "body": "hey, thank you for answering. Saddly the code tells me that it    &quot;Couldn&#39;t match expected type \u2018[Char]\u2019 with actual type \u2018Char\u2019 &quot;"}, {"owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 0, "creation_date": 1554325272, "post_id": 55503713, "comment_id": 97714581, "body": "The difficult thing here is that the chars are here in a list. And that part is just giving an error in my head"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "reply_to_user": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 0, "creation_date": 1554326543, "post_id": 55503713, "comment_id": 97715034, "body": "@ElzineBurger Could we see the full error? Your code seems to be expecting a string somewhere, but is being passed a char."}, {"owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 0, "creation_date": 1554327218, "post_id": 55503713, "comment_id": 97715253, "body": "Dobbelen.hs:154:36: error:     \u2022 Couldn&#39;t match expected type \u2018[Char]\u2019 with actual type \u2018Char\u2019     \u2022 In the expression: x       In the second argument of \u2018intercalate\u2019, namely         \u2018[x | Steen x &lt;- xs]\u2019       In the expression: intercalate &quot;, &quot; [x | Steen x &lt;- xs]     | 154 | maakString xs =  intercalate &quot;, &quot; [x | Steen x &lt;- xs]     |                                    ^"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554328347, "post_id": 55503713, "comment_id": 97715660, "body": "You need to provide the definition of <code>Lettre</code> (in your <i>question</i>, not in a comment)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554377561, "post_id": 55503713, "comment_id": 97734397, "body": "OK, it&#39;s fixed now. I stupidly forgot to wrap <code>x</code> in a list in the list comprehension, so I was passing a <code>[Char]</code>, not a <code>[String]</code>, to <code>intercalate &quot;, &quot;</code>."}, {"owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 0, "creation_date": 1554379921, "post_id": 55503713, "comment_id": 97735994, "body": "Uhm, so how do I do this? I tried <code>intercalate &quot;, &quot; [x | Steen x &lt;- xs]</code> which doesnt work. Into what do I change this code?"}, {"owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 0, "creation_date": 1554387133, "post_id": 55503713, "comment_id": 97740879, "body": "Aah oke. Thank you so much!"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1554377476, "last_edit_date": 1554377476, "creation_date": 1554323073, "answer_id": 55503713, "question_id": 55503578, "link": "https://stackoverflow.com/questions/55503578/is-there-a-simple-function-to-make-a-string-of-a-list-of-chars/55503713#55503713", "title": "Is there a simple function to make a string of a list of chars?", "body": "<p>Given a list of a characters, you could use <code>intersperse</code>, but that only allows single-character separators.</p>\n\n<pre><code>&gt; \"(\" ++ intersperse ',' \"123W55W3\" ++ \")\"\n\"(1,2,3,W,5,5,W,3)\"\n</code></pre>\n\n<p>For a multicharacter separator like <code>\", \"</code>, you can use <code>intercalate</code>, but then you need a list of <code>String</code>, not a list of <code>Char</code>.</p>\n\n<p>The solution is to lift each character into a string, then use <code>intercalate</code>.</p>\n\n<pre><code>&gt; \"(\" ++ intercalate \", \" (map pure \"123W55W3\") ++ \")\"\n\"(1, 2, 3, W, 5, 5, W, 3)\"\n</code></pre>\n\n<hr>\n\n<p>I'm assuming the input is an actual <code>[Char]</code>/<code>String</code> value; if you actually have some more complicated <code>Char</code> wrapper, like</p>\n\n<pre><code>newtype Lettre = Steen Char\n</code></pre>\n\n<p>as could be inferred from your attempt, use instead something like</p>\n\n<pre><code>makeString :: [Lettre] -&gt; String\nmakeString xs = \"(\" ++ intercalate \", \" [[x] | Steen x &lt;- xs] ++ \")\"\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 55503713, "answer_count": 1, "score": -1, "last_activity_date": 1554381068, "creation_date": 1554322469, "last_edit_date": 1554381068, "question_id": 55503578, "link": "https://stackoverflow.com/questions/55503578/is-there-a-simple-function-to-make-a-string-of-a-list-of-chars", "title": "Is there a simple function to make a string of a list of chars?", "body": "<p>I want to make a String from a list of chars [Lettre] </p>\n\n<p>For example, \n       ['1', '2', '3', 'W', '5', '5', 'W', '3'] \nshould be printed as (1, 2, 3, W, 5, 5, W, 3) </p>\n\n<p>Now, I use</p>\n\n<pre><code>data Lettre = Steen Char\n\nmakeString :: [Lettre] -&gt; String\nmakeString [] = \"\"\nmakeString [Steen(x)] = x:[]\nmakeString (Steen(x):xs) = (x:\", \") ++ makeString xs\n</code></pre>\n\n<p>but I feel like this could be easier.</p>\n\n<p>Is there a simple function, something like toString? I tried using some functions I knew, but it doesn't seem to work on my code, so I keep using makeString.</p>\n\n<p>A big thanks to anyone who could help me out :)</p>\n"}, {"tags": ["haskell", "error-handling", "partial-functions"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 5, "creation_date": 1554318752, "post_id": 55502363, "comment_id": 97711537, "body": "It&#39;s something you need to decide on a case-by-case basis. <code>chunkOf</code> inherits <code>take</code>&#39;s behavior, which is to treat any negative argument the same as 0, and for <code>take</code>, that makes sense. Other functions might not have a suitable default, in which case using <code>Maybe</code> makes more sense to force you to deal with a bad input. If you are using Liquid Haskell, defining a dependent type like <code>PositiveInt</code> becomes a lot easier."}, {"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554319322, "post_id": 55502363, "comment_id": 97711812, "body": "woah, I&#39;ve never heard of Liquid Haskell.  It looks really powerful.  I&#39;ll have to investigate that further."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1554320422, "post_id": 55502363, "comment_id": 97712361, "body": "See also <a href=\"https://stackoverflow.com/q/11910143/791604\">Positive integer type</a>."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1554321515, "post_id": 55502363, "comment_id": 97712915, "body": "Related: <a href=\"https://stackoverflow.com/questions/39810259/limit-a-number-to-a-range-haskell\" title=\"limit a number to a range haskell\">stackoverflow.com/questions/39810259/&hellip;</a> and this post <a href=\"https://www.parsonsmatt.org/2018/10/02/small_types.html\" rel=\"nofollow noreferrer\">parsonsmatt.org/2018/10/02/small_types.html</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1554349529, "post_id": 55502363, "comment_id": 97720517, "body": "Yeah LH is great for stuff like this"}], "owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554317550, "creation_date": 1554317550, "question_id": 55502363, "link": "https://stackoverflow.com/questions/55502363/partial-functions-vs-input-verification", "title": "partial functions vs input verification", "body": "<p>I really love using total functions.  That said, sometimes I'm not sure what the best approach is for guaranteeing that.  Lets say that I'm writing a function similar to <a href=\"https://hackage.haskell.org/package/split-0.2.3.3/docs/Data-List-Split.html#v:chunksOf\" rel=\"nofollow noreferrer\">chunksOf</a> from the split package, where I want to split up a list into sublists of a given size.  Now I'd really rather say that the input for sublist size needs to be a <em>positive</em> int (so excluding 0).  As I see it I have several options:</p>\n\n<p>1) all-out: make a <code>newtype</code> for <code>PositiveInt</code>, hide the constructor, and only expose safe functions for creating a PositiveInt (perhaps returning a <code>Maybe</code> or some union of <code>Positive | Negative | Zero</code> or what have you).  This seems like it could be a huge hassle.</p>\n\n<p>2) what the split package does: just return an infinite list of size-0 sublists if the size &lt;= 0.  This seems like you risk bugs not getting caught, and worse: those bugs just infinitely hanging your program with no indication of what went wrong.</p>\n\n<p>3) what most other languages do: <code>error</code> when the input is &lt;= 0.  I really prefer total functions though...</p>\n\n<p>4) return an <code>Either</code> or <code>Maybe</code> to cover the case that the input might have been &lt;= 0.  Similar to #1, it seems like using this could just be a hassle.</p>\n\n<p>This seems similar to <a href=\"https://stackoverflow.com/a/12432899/8426314\">this</a> post, but this has more to do with error conditions than just being as precise about types as possible.  I'm looking for thoughts on how to decide what the best approach for a case like this is.  I'm probably most inclined towards doing #1, and just dealing with the added overhead, but I'm concerned that I'll be kicking myself down the road.  Is this a decision that needs to be made on a case-by-case basis, or is there a general strategy that consistently works best?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1554612739, "post_id": 55503055, "comment_id": 97812437, "body": "New answer added :)"}], "tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": true, "score": 2, "last_activity_date": 1554426826, "last_edit_date": 1554426826, "creation_date": 1554320291, "answer_id": 55503055, "question_id": 55501455, "link": "https://stackoverflow.com/questions/55501455/compile-stack-script-instead-of-running-it/55503055#55503055", "title": "Compile stack script instead of running it", "body": "<p>No, it's not compiled. It's run through <code>runhaskell</code> which is a Haskell interpreter. If you want to compile it... do that. Instead of running the script,\ntake the <code>--resolver</code> and <code>--package</code> options from the script comment and pass them like this</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>stack ghc --resolver lts-13.14 --package turtle test.hs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 3900540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff25e256cd48f9e3de65fee65277459?s=128&d=identicon&r=PG&f=1", "display_name": "Mikekekeke", "link": "https://stackoverflow.com/users/3900540/mikekekeke"}, "edited": false, "score": 0, "creation_date": 1608127960, "post_id": 55555726, "comment_id": 115487675, "body": "Tried  <code>#!&#47;usr&#47;bin&#47;env stack -- stack script --resolver lts-16.26 --compile main = print &quot;hello&quot; </code> got <code>run_serv.sh:2:1: syntax error, unexpected &#39;-&#39;, expecting $end</code>. Stack version 2.5.1"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 0, "last_activity_date": 1554612672, "creation_date": 1554612672, "answer_id": 55555726, "question_id": 55501455, "link": "https://stackoverflow.com/questions/55501455/compile-stack-script-instead-of-running-it/55555726#55555726", "title": "Compile stack script instead of running it", "body": "<p>The <code>script</code> command takes both <code>--compile</code> and <code>--optimize</code> as flags, which will instruct Stack to first compile to an executable (optionally with <code>-O2</code> optimization level) before running.</p>\n"}], "owner": {"reputation": 13, "user_id": 11307303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cc7df650f7b0b1459d2854644c29fe?s=128&d=identicon&r=PG&f=1", "display_name": "user11307303", "link": "https://stackoverflow.com/users/11307303/user11307303"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 55503055, "answer_count": 2, "score": 0, "last_activity_date": 1554612672, "creation_date": 1554314292, "last_edit_date": 1554336079, "question_id": 55501455, "link": "https://stackoverflow.com/questions/55501455/compile-stack-script-instead-of-running-it", "title": "Compile stack script instead of running it", "body": "<p>The build tool <code>stack</code> has the feature to treat a usually compiled haskell source file as a script. (<a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#script-interpreter\" rel=\"nofollow noreferrer\">https://docs.haskellstack.org/en/stable/GUIDE/#script-interpreter</a>)</p>\n\n<p>Is it also possible to create a compiled executable the same way?</p>\n\n<p>I searched the <code>help</code> section of <code>stack</code> and <code>stack script</code>, but could not find an options that make this possible.</p>\n\n<p>script.hs:</p>\n\n<pre><code>#!/usr/bin/env stack\n{-\n  stack script\n  --resolver lts-13.14\n  --package turtle\n-}\n\nmain = print \"hello\"\n</code></pre>\n\n<p>So if given it the right permissions, this file can be executed. I guess  behind the scenes stack compiles the file and then just runs it. And I'd like to just get the compiled intermediate binary.</p>\n"}, {"tags": ["list", "haskell", "types", "declaration", "ghci"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 5, "creation_date": 1554310931, "post_id": 55500477, "comment_id": 97707715, "body": "<code>[]</code> isn&#39;t a type; it&#39;s a type <i>constructor</i>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1554313934, "post_id": 55500477, "comment_id": 97709133, "body": "By analogy with &quot;Triple&quot;, &quot;Quadruple&quot;, &quot;Quintuple&quot;, should the constructor actually be named &quot;Zerople&quot;? =D"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554318900, "post_id": 55500477, "comment_id": 97711610, "body": "Sticking with Latin prefixes, it would be &quot;Nilple&quot;, or to avoid autocorrect follies, &quot;Nihilple&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1554312371, "last_edit_date": 1554312371, "creation_date": 1554311221, "answer_id": 55500627, "question_id": 55500477, "link": "https://stackoverflow.com/questions/55500477/haskell-how-can-i-create-an-empty-list-as-an-option-for-a-datatype/55500627#55500627", "title": "Haskell: How can I create an empty list as an option for a datatype?", "body": "<p>You are mixing up type and data constructors, and using the <em>type</em> constructor <code>[]</code> (via the alias <code>Empty</code> where a plain type is expected.</p>\n\n<p>Consider this pseudo-Haskell definition of the list constructor:</p>\n\n<pre><code>data [] a = [] | a : ([] a)\n</code></pre>\n\n<p>Here, <code>[]</code> is both the type constructor with kind <code>* -&gt; *</code> and the nullary data constructor with type <code>[a]</code> representing empty lists.</p>\n\n<p>For your type, do the same: <code>Zero</code> is just a nullary data constructor.</p>\n\n<pre><code>data E = Zero | Triple A B C\n</code></pre>\n\n<p>(assuming <code>A</code>, <code>B</code>, and <code>C</code> are fixed types. If you are trying to define triple of arbitrary types, you need to parameterize <code>E</code>:</p>\n\n<pre><code>data E a b c = Zero | Triple a b c\n</code></pre>\n\n<p>).</p>\n"}], "owner": {"reputation": 1, "user_id": 11307020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8922b8f3d529460cc626e21e645a84a9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabi", "link": "https://stackoverflow.com/users/11307020/fabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1554312371, "creation_date": 1554310672, "question_id": 55500477, "link": "https://stackoverflow.com/questions/55500477/haskell-how-can-i-create-an-empty-list-as-an-option-for-a-datatype", "title": "Haskell: How can I create an empty list as an option for a datatype?", "body": "<p>In Haskell using the ghci compiler want to create a datatype which is either empty or has a triple. I tried to create an empty type but my data type E does not let me use it. How do you correctly declare this?</p>\n\n<pre><code>type Empty = []\ndata E = Zero Empty | Triple A B C\n</code></pre>\n\n<p>I keep getting this error: expecting one more argument to \u2018Empty\u2019\n      Expected a type, but \u2018Empty\u2019 has kind \u2018* -> *\u2019</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1554323633, "post_id": 55500320, "comment_id": 97713885, "body": "What is your question?"}, {"owner": {"reputation": 25, "user_id": 7817987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OiENf.jpg?s=128&g=1", "display_name": "Kyriakos Hadjipandeli", "link": "https://stackoverflow.com/users/7817987/kyriakos-hadjipandeli"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1554399818, "post_id": 55500320, "comment_id": 97748385, "body": "If the way I am creating the list is useful or not, or should use standard list to add the accounts to it?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1554401823, "post_id": 55500320, "comment_id": 97749354, "body": "Okay. This isn&#39;t really the right forum for opinion-based questions like &quot;is this a good way to do things&quot;. If your code is working the way you want it to, you could try the code review StackExchange instead, where that is exactly the kind of question they&#39;re looking for."}], "owner": {"reputation": 25, "user_id": 7817987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OiENf.jpg?s=128&g=1", "display_name": "Kyriakos Hadjipandeli", "link": "https://stackoverflow.com/users/7817987/kyriakos-hadjipandeli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554310125, "creation_date": 1554310125, "question_id": 55500320, "link": "https://stackoverflow.com/questions/55500320/how-to-make-a-list-constructor-to-add-data-constructors-a-list-of-account-const", "title": "How to make a list constructor to add data constructors (A list of account constructors)", "body": "<p>I am fairly new to haskell and I am trying to add account constructors into a list and then check that list according to the account number and do certain modifications to them.\nI know how to do this without lists, but I am not sure how to do it using list constructors. I am using a network simple server where the user enters the account number and I transfer it to the methods.</p>\n\n<p>This is my talk server. (l) is \"Open 1975\". Where Open is to determine the definition to be used and 1975 is the account number.</p>\n\n<pre><code>talk :: Handle -&gt; IO ()\n talk h = loop\n  where loop = do\n          l &lt;- hGetLine h\n          hPutStrLn h \"Reply\"\n          let ws = words l\n          case (head ws) of (\"Open\") -&gt; open h ws\n                            (\"Tranfer\") -&gt; transfer h ws\n</code></pre>\n\n<p>Here are my constructors (I am not user about the list constructor)</p>\n\n<pre><code>data Account = Account\n  { nameArian :: String\n  , namePres :: String\n  , accNum :: TVar Int\n  , accValueA :: TVar Float\n  , accValueP :: TVar Float\n  }\n\ncreateAccount nA nP acc valA valP cR = do\n  valA' &lt;- newTVar valA\n  valP' &lt;- newTVar valP\n  return $ Account nA nP acc valA' valP'\n\ndata Lista = Lista { list :: TVar [Account]}\n\ncreateList a = do\n  a' &lt;- newTVar a\n  return $ Lista a'\n</code></pre>\n\n<p>This definition opens an account and adds it to the list</p>\n\n<pre><code>open :: Handle -&gt; [String] -&gt; IO ()\nopen h ws = do\n  let num = read (unwords (tail ws)) :: Int\n  accounts &lt;- atomically . sequence $\n    zipWith3 createAccount [\"Arian\"] [\"Pres\"] [x] [0.0] [0.0] [0]\n  let accVar = accounts\n  accls &lt;- atomically . sequence $\n    zipWith createList [accounts]\n</code></pre>\n\n<p>Sorry if it is a little bit messy.</p>\n"}, {"tags": ["windows", "haskell", "cabal", "haskell-platform"], "comments": [{"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 1, "creation_date": 1554303375, "post_id": 55497266, "comment_id": 97703350, "body": "At one point I couldn&#39;t even compile the template project with a fresh download of haskell-platform on windows.  I had to revert to an earlier ghc version to get things running, and then a couple months later or so I was able to update to the latest and it worked.  Might be worth a shot trying to downgrade some stuff to see if it works."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 2, "creation_date": 1554308368, "post_id": 55497266, "comment_id": 97706429, "body": "My suggestion is to do what you know you should be doing, and use unix. You can install an image on windows. From there you can use stack."}, {"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "reply_to_user": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 0, "creation_date": 1554309820, "post_id": 55497266, "comment_id": 97707156, "body": "@NathanWilson You may be right.  The last time I recall Haskell Platform working ok was under 8.4 and I was checking for fixed to 8.6.3 daily for weeks before posting the above.  Unfortunately, some of the packages I&#39;m contributing to require 8.6."}, {"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1554309824, "post_id": 55497266, "comment_id": 97707161, "body": "@MichaelLitchard You too may be right.  I&#39;ve done so in the past, but I hate losing either my graphical editors or their integration with Haskell (either one of which would be necessary, I think, if running Haskell on a VM)."}, {"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "edited": false, "score": 0, "creation_date": 1554309858, "post_id": 55497266, "comment_id": 97707178, "body": "Let me add a few more possibly unrelated issues with a clean Haskell Platform 8.6.3 install on Windows 10 x64: 1. WinGHCI routinely hangs while executing simple code in the interpreter that ghc has no problem compiling or executing. 2. Cabal install hsdev busy-hangs at several points. 3. Cabal install hsdev fails with &quot;opeFile: permission denied&quot; when run as root."}, {"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "edited": false, "score": 0, "creation_date": 1554310102, "post_id": 55497266, "comment_id": 97707300, "body": "4. Running compiled code under WinGHCi routinely become uninteruptible with ctrl-C, requiring restarting it and hunting down runaway processes about a dozen times a day (and that is for code which does nothing unsafe and only performs IO in main = print result)."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1554310514, "post_id": 55497266, "comment_id": 97707519, "body": "This may be a case where going with the flow gets your work done faster. Emacs makes a fine IDE, but would require learning the &quot;Emacs Way&quot;. If you don&#39;t need much more than coloring cues, graphical vim may meet your requirements."}, {"owner": {"reputation": 579, "user_id": 8426314, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101771879690894/picture?type=large", "display_name": "Nathan Wilson", "link": "https://stackoverflow.com/users/8426314/nathan-wilson"}, "edited": false, "score": 2, "creation_date": 1554311716, "post_id": 55497266, "comment_id": 97708116, "body": "I don&#39;t know how recent your installation is, but I just installed haskell on my windows machine from scratch about a month ago, and it all worked <i>but I avoided Haskell Platform like the plague</i> and just installed stack.  It was pretty seamless"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1554312001, "post_id": 55497266, "comment_id": 97708258, "body": "I use stack on both linux and windows, so to be sure I&#39;m working with a set of packages that is conflict-free. While it has its shortcomings (IMO), it greatly simplified the handling of packages."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1554326282, "post_id": 55497266, "comment_id": 97714942, "body": "On packages not showing up when you use <code>ghci</code>, you might want to check <a href=\"https://downloads.haskell.org/~ghc/8.6.4/docs/html/users_guide/packages.html#package-environments\" rel=\"nofollow noreferrer\">the default package environment file</a> to see whether <code>vector</code> is there. In your Windows system, I <i>think</i> it will be at <code>C:\\Users\\Carl\\AppData\\Roaming\\ghc\\x86_64-mingw32-8.6.3\\envir&zwnj;&#8203;onments\\default</code>."}, {"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1554332013, "post_id": 55497266, "comment_id": 97716793, "body": "@MichaelLitchard That is where my thoughts are going.  I used to run linux under a VM, but I seem to recall that display in particular was extremely slow even on a fast machine with lots of memory.  Given that I am already running an X server on my Windows machine, Xemacs that may be the way to go.  And I&#39;ve used emacs for 30 years, so my muscle memory speaks elisp.;)"}, {"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1554332123, "post_id": 55497266, "comment_id": 97716838, "body": "@duplode Thanks for the suggestions and apologies for not mentioning I already did: vector is listed there, as is the cabal package.db, but the file seems to be ignored by my ghci and ghc."}], "answers": [{"comments": [{"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "edited": false, "score": 0, "creation_date": 1554314219, "post_id": 55501085, "comment_id": 97709258, "body": "Thanks for the suggestion!  I thought that the crash might be related to me still not getting the install right, even with GHC_PACKAGE_PATH.  But this may very well be a separate bug."}, {"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "edited": false, "score": 0, "creation_date": 1554314316, "post_id": 55501085, "comment_id": 97709300, "body": "Unfortunately, adding the <code>-fexternal-interpreter</code> flag does not fix it, but instead slightly changes the message and causes ghci to hang rather than exiting: <code>$ ghci  -fexternal-interpreter ... Prelude Data.Vector&gt; toList $ empty  Access violation in generated code when reading 0xffffffffffffffff   Attempting to reconstruct a stack trace...     Frame        Code address  * 0x486dd90    0xe1e1f8 C:\\Program Files\\Haskell Platform\\8.6.3\\lib\\bin\\ghc-iserv.exe+0xa1e1f8</code>"}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 1, "last_activity_date": 1554312921, "creation_date": 1554312921, "answer_id": 55501085, "question_id": 55497266, "link": "https://stackoverflow.com/questions/55497266/on-windows-packages-installed-with-cabal-seem-to-be-unavailable-in-ghc-ghci/55501085#55501085", "title": "On Windows, packages installed with cabal seem to be unavailable in ghc/ghci", "body": "<p>So it looks like you solved your problem by setting <code>GHC_PACKAGE_PATH</code>, right? You might wish to file a bug about that.</p>\n\n<p>The second issue, the runtime \"Access violation in generated code when reading\" error seems to be documented here:</p>\n\n<p><a href=\"https://github.com/commercialhaskell/stack/issues/3765\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/issues/3765</a></p>\n\n<p><a href=\"https://gitlab.haskell.org/ghc/ghc/issues/13112\" rel=\"nofollow noreferrer\">https://gitlab.haskell.org/ghc/ghc/issues/13112</a></p>\n\n<p>Supposedly passing <code>-fexternal-interpreter</code> to ghci is a workaround. You might want to manually edit the <code>ghc</code>/<code>ghci</code> shim scripts to ensure the flag is always passed until the bug can be fixed.</p>\n"}, {"comments": [{"owner": {"reputation": 2667, "user_id": 325725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3db095f94749aaedfea12b927b13cf74?s=128&d=identicon&r=PG", "display_name": "Phyx", "link": "https://stackoverflow.com/users/325725/phyx"}, "edited": false, "score": 0, "creation_date": 1555273475, "post_id": 55562622, "comment_id": 98043979, "body": "This doesn&#39;t have anything to do with platform. the object code interpreter was broken in ghc 8.6.3 on Windows. 8.6.4 was released to address this."}, {"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "reply_to_user": {"reputation": 2667, "user_id": 325725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3db095f94749aaedfea12b927b13cf74?s=128&d=identicon&r=PG", "display_name": "Phyx", "link": "https://stackoverflow.com/users/325725/phyx"}, "edited": false, "score": 0, "creation_date": 1555362810, "post_id": 55562622, "comment_id": 98076928, "body": "Fair enough.  Unfortunately Platform is still stuck on 8.6.3, so it is difficult to tell for outsiders."}], "tags": [], "owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "is_accepted": false, "score": 1, "last_activity_date": 1554663879, "creation_date": 1554663879, "answer_id": 55562622, "question_id": 55497266, "link": "https://stackoverflow.com/questions/55497266/on-windows-packages-installed-with-cabal-seem-to-be-unavailable-in-ghc-ghci/55562622#55562622", "title": "On Windows, packages installed with cabal seem to be unavailable in ghc/ghci", "body": "<p>Thanks for all the responses.  I've experimented both with running ghc on some version of UN*X under VirtualBox and uninstalling Haskell Platform and going purely with stack under Windows 10 x64.</p>\n\n<p>Both seem to avoid the many issues I listed above, but stack under Windows seems a little more light-weight and integrates better with my preferred editors (Sublime Text and Visual Studio Code), so that is what I'm going with for now.</p>\n\n<p>In the meantime, with all due gratitude for all the great, free work done by the Haskell Platform guys and the author of WinGHCI, I cannot urge anybody reading this strongly enough to stay away from it, in particular version 8.6.3 under Windows, at least until things are much improved.</p>\n"}], "owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1554663879, "creation_date": 1554300784, "last_edit_date": 1554314414, "question_id": 55497266, "link": "https://stackoverflow.com/questions/55497266/on-windows-packages-installed-with-cabal-seem-to-be-unavailable-in-ghc-ghci", "title": "On Windows, packages installed with cabal seem to be unavailable in ghc/ghci", "body": "<p>I'm running the latest version of Haskell Platform 8.6.3 on a fairly standard Windows 10 x64 system.</p>\n\n<p>Now I am at my wits end getting packages installed from Hackage to work reliably.  Attributing my issues to local configuration problems, I've taken all steps short of nuking my Windows installation.  I have uninstalled and reinstalled Hackage, rebooted, scoured every last configuration file I could in any hidden directory or otherwise, deleted every registry key apparently related to Haskell, most of them multiple times, all to no avail:</p>\n\n<p>Packages installed with cabal just don't appear to be available under ghci, WinGHCI, either to be loaded interactively with (:m) under ghci or when compiling using ghc under WinGHCI, no matter what I do.</p>\n\n<p>Below are some symptoms.  Any suggestions?</p>\n\n<pre><code>#cabal new-update\nDownloading the latest package list from hackage.haskell.org\nTo revert to previous state run:\n    cabal new-update 'hackage.haskell.org,2019-04-02T19:24:19Z'\n\n#cabal new-install --lib vector\nResolving dependencies...\nUp to date\n\n#ghci\nPrelude&gt; :m Data.Vector\n\n&lt;no location info&gt;: error:\n    Could not find module \u2018Data.Vector\u2019\n    Perhaps you meant Data.Functor (from base-4.12.0.0)\n\n#ghc -O -optc-O3 -funfolding-use-threshold=16 -fexcess-precision -Wall -Wno-type-defaults -Wno-unused-imports -Wno-unused-top-binds -rtsopts \"P663.hs\"\n[1 of 1] Compiling Main             ( P663.hs, P663.o )\n\nP663.hs:54:1: error:\n    Could not find module \u2018Data.Vector.Unboxed\u2019\n    Use -v to see a list of the files searched for.\n   |\n54 | import           Data.Vector.Unboxed (Vector, (!))    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n #ghc-pkg list\nC:\\Program Files\\Haskell Platform\\8.6.3\\lib\\package.conf.d\n    Cabal-2.4.0.1\n    Win32-2.6.1.0\n    array-0.5.3.0\n    base-4.12.0.0\n    binary-0.8.6.0\n    bytestring-0.10.8.2\n    containers-0.6.0.1\n    deepseq-1.4.4.0\n    directory-1.3.3.0\n    filepath-1.4.2.1\n    (ghc-8.6.3)\n    ghc-boot-8.6.3\n    ghc-boot-th-8.6.3\n    ghc-compact-0.1.0.0\n    ghc-heap-8.6.3\n    ghc-prim-0.5.3\n    ghci-8.6.3\n    haskeline-0.7.4.3\n    hpc-0.6.0.3\n    hscolour-1.24.4\n    integer-gmp-1.0.2.0\n    libiserv-8.6.3\n    mtl-2.2.2\n    parsec-3.1.13.0\n    pretty-1.1.3.6\n    process-1.6.3.0\n    rts-1.0\n    stm-2.5.0.0\n    template-haskell-2.14.0.0\n    text-1.2.3.1\n    time-1.8.0.2\n    transformers-0.5.5.0\n    xhtml-3000.2.2.1\n\n#ghc-pkg list --user-package-db=C:\\Users\\Carl\\AppData\\Roaming\\cabal\\store\\ghc-8.6.3\\package.db\nC:\\Program Files\\Haskell Platform\\8.6.3\\lib\\package.conf.d\n    Cabal-2.4.0.1\n    Win32-2.6.1.0\n    array-0.5.3.0\n    base-4.12.0.0\n    binary-0.8.6.0\n    bytestring-0.10.8.2\n    containers-0.6.0.1\n    deepseq-1.4.4.0\n    directory-1.3.3.0\n    filepath-1.4.2.1\n    (ghc-8.6.3)\n    ghc-boot-8.6.3\n    ghc-boot-th-8.6.3\n    ghc-compact-0.1.0.0\n    ghc-heap-8.6.3\n    ghc-prim-0.5.3\n    ghci-8.6.3\n    haskeline-0.7.4.3\n    hpc-0.6.0.3\n    hscolour-1.24.4\n    integer-gmp-1.0.2.0\n    libiserv-8.6.3\n    mtl-2.2.2\n    parsec-3.1.13.0\n    pretty-1.1.3.6\n    process-1.6.3.0\n    rts-1.0\n    stm-2.5.0.0\n    template-haskell-2.14.0.0\n    text-1.2.3.1\n    time-1.8.0.2\n    transformers-0.5.5.0\n    xhtml-3000.2.2.1\n\nC:\\Users\\Carl\\AppData\\Roaming\\cabal\\store\\ghc-8.6.3\\package.db\n    primitive-0.6.4.0\n    vector-0.12.0.2\n\n#set GHC_PACKAGE_PATH=C:\\Users\\Carl\\AppData\\Roaming\\cabal\\store\\ghc-8.6.3\\package.db;\n#ghc-pkg list\nC:\\Program Files\\Haskell Platform\\8.6.3\\lib\\package.conf.d\n    Cabal-2.4.0.1\n    Win32-2.6.1.0\n    array-0.5.3.0\n    base-4.12.0.0\n    binary-0.8.6.0\n    bytestring-0.10.8.2\n    containers-0.6.0.1\n    deepseq-1.4.4.0\n    directory-1.3.3.0\n    filepath-1.4.2.1\n    (ghc-8.6.3)\n    ghc-boot-8.6.3\n    ghc-boot-th-8.6.3\n    ghc-compact-0.1.0.0\n    ghc-heap-8.6.3\n    ghc-prim-0.5.3\n    ghci-8.6.3\n    haskeline-0.7.4.3\n    hpc-0.6.0.3\n    hscolour-1.24.4\n    integer-gmp-1.0.2.0\n    libiserv-8.6.3\n    mtl-2.2.2\n    parsec-3.1.13.0\n    pretty-1.1.3.6\n    process-1.6.3.0\n    rts-1.0\n    stm-2.5.0.0\n    template-haskell-2.14.0.0\n    text-1.2.3.1\n    time-1.8.0.2\n    transformers-0.5.5.0\n    xhtml-3000.2.2.1\n\nC:\\Users\\Carl\\AppData\\Roaming\\ghc\\x86_64-mingw32-8.6.3\\package.conf.d\n    (no packages)\nC:\\Users\\Carl\\AppData\\Roaming\\cabal\\store\\ghc-8.6.3\\package.db\n    primitive-0.6.4.0\n    vector-0.12.0.2\n\n# ghci\nGHCi, version 8.6.3: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :m Data.Vector\nPrelude Data.Vector&gt; toList $ empty\n\nAccess violation in generated code when reading 0xffffffffffffffff\n\n Attempting to reconstruct a stack trace...\n\n   Frame        Code address\n * 0x7e5dd90    0x3d7d618 C:\\Program Files\\Haskell Platform\\8.6.3\\bin\\ghc.exe+0x397d618\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 590, "user_id": 6184960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9168edfb66b98995cae68f6b46d81ef?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Yellow", "link": "https://stackoverflow.com/users/6184960/mr-yellow"}, "edited": false, "score": 0, "creation_date": 1554300901, "post_id": 55497105, "comment_id": 97701596, "body": "Welcome to Stack Overflow. I don&#39;t fully understand your question, do you want a reverse function that just takes one argument? What exactly is your problem?"}, {"owner": {"reputation": 31, "user_id": 11305956, "user_type": "registered", "profile_image": "https://graph.facebook.com/2376065545785995/picture?type=large", "display_name": "Quentin Doniczka", "link": "https://stackoverflow.com/users/11305956/quentin-doniczka"}, "reply_to_user": {"reputation": 590, "user_id": 6184960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9168edfb66b98995cae68f6b46d81ef?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Yellow", "link": "https://stackoverflow.com/users/6184960/mr-yellow"}, "edited": false, "score": 0, "creation_date": 1554301193, "post_id": 55497105, "comment_id": 97701807, "body": "i simply creat a reverse fonction, currently call test(x,y) BUT this fonction take 2 argument, with y need to be NULL list, and want crate a fonction, which need only one argument, the seconde, inverse(x) but this one, depending of test(x,y) and currently, i&#39;ve 2 fonction test and inverse, and i want to have test locally on inverse"}, {"owner": {"reputation": 31, "user_id": 11305956, "user_type": "registered", "profile_image": "https://graph.facebook.com/2376065545785995/picture?type=large", "display_name": "Quentin Doniczka", "link": "https://stackoverflow.com/users/11305956/quentin-doniczka"}, "reply_to_user": {"reputation": 590, "user_id": 6184960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9168edfb66b98995cae68f6b46d81ef?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Yellow", "link": "https://stackoverflow.com/users/6184960/mr-yellow"}, "edited": false, "score": 0, "creation_date": 1554301585, "post_id": 55497105, "comment_id": 97702058, "body": "finaly, when all is done i want to have this respond inverse([4,2,1] &gt;[1,2,4] test([4,2,1],[]) &gt;error test fonction doesn&#39;t exist ( because she is locally creat ON inverse"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554309096, "post_id": 55497105, "comment_id": 97706804, "body": "I suggest you drop the habit of putting parentheses around your argument lists. <code>inverse x</code> and <code>inverse(x)</code> are essentially the same, but <code>test x y</code> and <code>test(x,y)</code> are <i>very</i> different. Haskell doesn&#39;t use parentheses for defining parameter lists or for calling functions."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11305956, "user_type": "registered", "profile_image": "https://graph.facebook.com/2376065545785995/picture?type=large", "display_name": "Quentin Doniczka", "link": "https://stackoverflow.com/users/11305956/quentin-doniczka"}, "edited": false, "score": 0, "creation_date": 1554301815, "post_id": 55497431, "comment_id": 97702213, "body": "Thank you Will help me a lot !"}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 2, "last_activity_date": 1554301302, "creation_date": 1554301302, "answer_id": 55497431, "question_id": 55497105, "link": "https://stackoverflow.com/questions/55497105/how-to-define-one-function-locally-within-another-in-my-version-of-reverse/55497431#55497431", "title": "How to define one function locally within another in my version of `reverse` -- getting parse errors", "body": "<p>When adding definitions using <code>let</code>, you want to put your definition between <code>let</code> and <code>in</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>inverse(x) =\n  let test(x,y) = if x==[] then y else test(tail(x),head(x):y) \n  in  test(x,[])\n</code></pre>\n\n<p>You could instead use <code>where</code> to give the definition afterwards:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>inverse(x) = test(x,[])\n  where test(x,y) = if x==[] then y else test(tail(x),head(x):y)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11305956, "user_type": "registered", "profile_image": "https://graph.facebook.com/2376065545785995/picture?type=large", "display_name": "Quentin Doniczka", "link": "https://stackoverflow.com/users/11305956/quentin-doniczka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 55497431, "answer_count": 1, "score": 1, "last_activity_date": 1554472977, "creation_date": 1554300335, "last_edit_date": 1554472977, "question_id": 55497105, "link": "https://stackoverflow.com/questions/55497105/how-to-define-one-function-locally-within-another-in-my-version-of-reverse", "title": "How to define one function locally within another in my version of `reverse` -- getting parse errors", "body": "<p>I have started studying Haskell, and I am try to write a \"reverse\" function.\nI created 2 functions for that, and they work, but now I want to define one locally within the second, but I get syntax errors.  Here's what I'm doing:</p>\n\n<pre><code>let liste1 = [4,2,8,1,7,12]  \n-- I create a random list\n\ntest(x,y)= if x==[] then y else test(tail(x),head(x):y) \n-- take a 2 list, with y=[] to have a list memory\n\ninverse(x)=test(x,[]) \n-- and finally, to have only 1 parameter\n</code></pre>\n\n<p>and then, we have:</p>\n\n<pre><code>&gt; inverse(liste1)\n[12,7,1,8,2,4]\n</code></pre>\n\n<p>It's works! Amazing!</p>\n\n<p>Now I want to have test as a <strong>LOCAL</strong> function.  This is what I have tried so far:</p>\n\n<pre><code>inverse(x) = let test(x,[]) in if x==[] then y else test(tail(x),head(x):y)\n</code></pre>\n\n<p>and </p>\n\n<pre><code>inverse(x) = let  if x==[] then y else test(tail(x),head(x):y) in test(x,[])\n</code></pre>\n\n<p>Both ways don't work, and I get the following error: <code>parse error on input \u00ecn'</code></p>\n\n<p>I know it's basic question, and more basic solution, but I don't get it... Help me please!</p>\n"}, {"tags": ["postgresql", "haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 577, "user_id": 656347, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f15mA.jpg?s=128&g=1", "display_name": "Sanchayan Maity", "link": "https://stackoverflow.com/users/656347/sanchayan-maity"}, "edited": false, "score": 0, "creation_date": 1554303281, "post_id": 55496533, "comment_id": 97703285, "body": "I should have gone deeper into the documentation. Thank you."}], "tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": true, "score": 0, "last_activity_date": 1554309810, "last_edit_date": 1554309810, "creation_date": 1554298523, "answer_id": 55496533, "question_id": 55496137, "link": "https://stackoverflow.com/questions/55496137/error-on-a-fromrow-instance-definition-with-postgres-simple/55496533#55496533", "title": "Error on a FromRow instance definition with postgres-simple", "body": "<p>There is a <code>FromField</code> instance for <code>Double</code>, but it doesn't work with <code>numeric</code>, because <code>numeric</code> is variable-precision <a href=\"https://www.postgresql.org/docs/9.3/datatype-numeric.html\" rel=\"nofollow noreferrer\">as per the PostgresSQL documentation</a>. If you look at the <a href=\"http://hackage.haskell.org/package/postgresql-simple-0.6.1/docs/Database-PostgreSQL-Simple-FromField.html\" rel=\"nofollow noreferrer\"><code>postgresql-simple</code> documentation</a> you'll see that the <code>Ratio Integer</code> (aka <code>Rational</code>) instance <em>does</em> support <code>numeric</code>.</p>\n\n<p>So what you can do here is one of two things:</p>\n\n<ol>\n<li>Use <code>Rational</code> instead of <code>Double</code> for your <code>amount</code> field</li>\n<li>Decide that you're alright with losing precision (although why are you using <code>numeric</code> on the SQL side then?), and do something like</li>\n</ol>\n\n<pre><code>import Data.Ratio\n\nloseNumericPrecision :: Postgres.RowParser Double\nloseNumericPrecision = fmap fromRational Postgres.field\n</code></pre>\n\n<p>and use that instead of <code>Postgres.field</code> for your fields corresponding to <code>numeric</code> values.</p>\n"}], "owner": {"reputation": 577, "user_id": 656347, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f15mA.jpg?s=128&g=1", "display_name": "Sanchayan Maity", "link": "https://stackoverflow.com/users/656347/sanchayan-maity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 55496533, "answer_count": 1, "score": 0, "last_activity_date": 1554309810, "creation_date": 1554297342, "question_id": 55496137, "link": "https://stackoverflow.com/questions/55496137/error-on-a-fromrow-instance-definition-with-postgres-simple", "title": "Error on a FromRow instance definition with postgres-simple", "body": "<pre><code>data CumulativeRevenue = CumulativeRevenue\n  { payment_date :: T.Text\n  , amount       :: Double\n  , sum          :: Double\n  } deriving (Show, Generic, Aeson.ToJSON, Aeson.FromJSON)\n\ninstance Postgres.FromRow CumulativeRevenue where\n  fromRow = CumulativeRevenue\n            &lt;$&gt; Postgres.field\n            &lt;*&gt; Postgres.field\n            &lt;*&gt; Postgres.field\n\ncumulativeRevenue :: Postgres.Connection -&gt; IO [CumulativeRevenue]\ncumulativeRevenue conn = Postgres.query_ conn\n  \"SELECT payment_date, amount, sum(amount) OVER (ORDER by payment_date) \\\n  \\ FROM (\\\n  \\ SELECT CAST (payment_date as TEXT) AS payment_date, SUM(amount) AS \\\n  \\ amount \\\n  \\ FROM payment \\\n  \\ GROUP BY CAST(payment_date AS TEXT) \\\n  \\ ) p \\\n  \\ ORDER BY payment_date \\\n  \\\"\n</code></pre>\n\n<p>Currently, I have the above piece of code. Complete code is <a href=\"https://gitlab.com/SanchayanMaity/postgres-play/blob/master/src/Lib.hs\" rel=\"nofollow noreferrer\">here</a>. The cumulativeRevenue is giving an exception as below. You can ignore the spock part.</p>\n\n<pre><code>Spock Error while handling [\"cumulative\"]: Incompatible {errSQLType = \"numeric\", errSQLTableOid = Nothing, errSQLField = \"amount\", errHaskellType = \"Double\", errMessage = \"types incompatible\"}\n</code></pre>\n\n<p>I am not clear on what to specify for the amount and sum fields in CumulativeRevenue. Can someone help me with that? Is there some easier way to figure out the type conversions from Haskell types to SQL types or vice versa while using postgres-simple library?</p>\n"}, {"tags": ["haskell", "constraints"], "comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 3, "creation_date": 1554293877, "post_id": 55494959, "comment_id": 97697053, "body": "Why don&#39;t you define it as <code>Int -&gt; [a] -&gt; [a]</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 1, "creation_date": 1554295835, "post_id": 55495009, "comment_id": 97698320, "body": "If you really, really want the signature to seem polymorphic, but want to constraint <code>n</code> to being <code>Int</code>, use <code>~</code>: <code>dropEvery :: (n ~ Int) =&gt; ...</code>. (Needs <code>LANGUAGE GADTs</code>. extension.)"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1554298212, "post_id": 55495009, "comment_id": 97699855, "body": "Um.  Why zip with <code>[0..]</code> then add 1 instead of just zipping with <code>[1..]</code>?"}, {"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1554300931, "post_id": 55495009, "comment_id": 97701613, "body": "@Carl I wanted to emphasize that the list indices are 0-based even if it doesn&#39;t matter in this example. But maybe you&#39;re interested in <a href=\"https://codegolf.stackexchange.com/\">PPCG.SE</a>? :)"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 4, "creation_date": 1554306231, "post_id": 55495009, "comment_id": 97705225, "body": "Not interested in code golf at all. I&#39;m interested in clarity and directness. If you want to associate the number 1 with a value, associate 1 with the value. Don&#39;t associate 0 with it and then add 1 when it&#39;s used. It&#39;s just extra complexity."}], "tags": [], "owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "is_accepted": true, "score": 6, "last_activity_date": 1554296797, "last_edit_date": 1554296797, "creation_date": 1554293883, "answer_id": 55495009, "question_id": 55494959, "link": "https://stackoverflow.com/questions/55494959/constraining-an-argument-to-be-an-int/55495009#55495009", "title": "Constraining an argument to be an Int", "body": "<p>You just have to use the actual type <code>Int</code> instead of using constrains <code>(Num n, Eq n)</code>. (Note that Haskell uses 0-based list indexing so I had to add a <code>-1</code> for it to work correctly.)</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>dropEvery :: Int -&gt; [a] -&gt; [a]\ndropEvery m list = [list !! (i-1) | i &lt;- [1 .. length list], i `rem` m /= 0]\n\nmain = print $ dropEvery 3 [1..20]\n</code></pre>\n\n<p><a href=\"https://tio.run/##y0gszk7Nyfn/P6Uov8C1LLWoUsHKSsEzr0RB104hOjEWSnEhpHMVcjKLSxRsFaLBtKKigkamrqGmQo1CpoKNrkK0oYKenkJOal56SQZYZawOUCKhKDU3AahV31bBIJaLKzcxMw9oQkFRJtAiFQWE4cZA/Xp6Rgax//8DAA\" rel=\"noreferrer\" title=\"Haskell \u2013 Try It Online\">Try it online!</a></p>\n\n<p>If you want to avoid the <code>!!</code> you can also avoid explicitly finding the length of the list by using <code>zip</code> which replaces your list comprehension with</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[ l | (l,i) &lt;- zip list [0..], (i+1) `rem` m /= 0]\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5964956, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lFBFsH50xpM/AAAAAAAAAAI/AAAAAAAADEg/RFDCMz2rINg/photo.jpg?sz=128", "display_name": "Laudosolis", "link": "https://stackoverflow.com/users/5964956/laudosolis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 55495009, "answer_count": 1, "score": 2, "last_activity_date": 1554296797, "creation_date": 1554293725, "question_id": 55494959, "link": "https://stackoverflow.com/questions/55494959/constraining-an-argument-to-be-an-int", "title": "Constraining an argument to be an Int", "body": "<p>I'm trying to declare a function where the numerical argument can only be an <code>Int</code>. </p>\n\n<p>I'm writing a function that'll discard every <code>n</code>th element of a list. I'm using modulo arithmetic, but the <code>mod</code> function will only take a type of <code>Int</code> and I can't figure out how to guarantee my number will satisfy that. </p>\n\n<p>My code is as follows:</p>\n\n<pre><code>dropEvery :: (Num n, Eq n) =&gt; n -&gt; [a] -&gt; [a]\ndropEvery m list = [list !! i | i &lt;- [1 .. length list], i `rem` m /= 0]\n</code></pre>\n\n<p>I've run <code>:info mod</code> and replaced <code>Num n</code> with <code>Real n, Enum n and Integral n</code> (all the constraints I can see in the output) but this still doesn't guarantee the compiler that <code>n</code> will be an <code>Int</code>. </p>\n\n<p>I'm sure there are solutions to this problem which don't use such a imperative approach, but I'd like to use this opportunity to learn a bit more about how types and constraints work in Haskell by solving this problem head-on.</p>\n"}, {"tags": ["haskell", "zipwith"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554296227, "post_id": 55494719, "comment_id": 97698584, "body": "your <code>ziptwee</code> is already almost the same as <code>zipWith Teg</code> - but it won&#39;t work because you haven&#39;t singled out the case where either input list is empty, just when both are. You need to have <code>ziptwee [] _ = []</code> and <code>ziptwee _ [] = []</code>, as well as the recursive case."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554297990, "post_id": 55494719, "comment_id": 97699724, "body": "<code>concatMap (replicate 4) [1..4]</code> or <code>[1..4] &gt;&gt;= replicate 4</code> would be more efficient."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "edited": false, "score": 0, "creation_date": 1554317309, "post_id": 55494867, "comment_id": 97710862, "body": "Thank you! So that was what I forgot! Thanks so much :)"}], "tags": [], "owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "is_accepted": true, "score": 1, "last_activity_date": 1554293481, "creation_date": 1554293481, "answer_id": 55494867, "question_id": 55494719, "link": "https://stackoverflow.com/questions/55494719/how-to-use-in-haskell-zipwith-correctly-to-create-a-int-int-list/55494867#55494867", "title": "How to use in Haskell zipWith correctly to create a [ [ int int ] ] list?", "body": "<p>The problem here is that you want the type <code>RijTegels</code> but actually the type you're creating with <code>zipWith (++)</code> is <code>[[a]]</code>. So to change that you could use the type constructor instead of the <code>(++)</code>:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Tegel = Teg Int Int deriving (Show)\ntype RijTegels = [Tegel]\n\nvolleRijTegels :: RijTegels\nvolleRijTegels = zipWith Teg [1,2,3] [4,5,6] -- here it is going wrong\n\nmain = print volleRijTegels\n</code></pre>\n\n<p><a href=\"https://tio.run/##XY69CsMwDIR3P4XGFpyhv0MgD9A1LXQwHgwRtlrXDrZJaF/edbyEdhAS3Hd3Mio@0dqcB5UU3FCjhW7ZcHGpzoCBJnIaNlfj5y1L7xGhp0dlY4FFvSRjk7cWV6VtV@xf6@BD452SqVVix/f8IEEc@YmfJTQNGAwIlIAiaL@0z8E7zdhLkSvuMVB57Tc05y8\" rel=\"nofollow noreferrer\" title=\"Haskell \u2013 Try It Online\">Try it online!</a></p>\n"}], "owner": {"reputation": 29, "user_id": 10499564, "user_type": "registered", "profile_image": "https://graph.facebook.com/972423296278054/picture?type=large", "display_name": "Elzine Burger", "link": "https://stackoverflow.com/users/10499564/elzine-burger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55494867, "answer_count": 1, "score": 2, "last_activity_date": 1554293481, "creation_date": 1554293048, "question_id": 55494719, "link": "https://stackoverflow.com/questions/55494719/how-to-use-in-haskell-zipwith-correctly-to-create-a-int-int-list", "title": "How to use in Haskell zipWith correctly to create a [ [ int int ] ] list?", "body": "<pre><code>data Tegel = Teg Int Int\ntype RijTegels = [Tegel]\n\n\nvolleRijTegels :: RijTegels\nvolleRijTegels = ziptwee [21..36] (replicate 4 1 ++ replicate 4 2 ++ replicate 4 3 ++ replicate 4 4)\n\nziptwee :: [Int] -&gt; [Int] -&gt; RijTegels\nziptwee []      []    = []\nziptwee (x:xs) (y:ys) = Teg x y: ziptwee xs ys \n</code></pre>\n\n<p>Now I use two functions, but I want to do it with one. \nI thought I could use zipWith, but I can't seem to figure out how. </p>\n\n<pre><code>volleRijTegels :: RijTegels\nvolleRijTegels = [zipWith (++) [1,2,3] [4,5,6]] -- here it is going wrong\n</code></pre>\n\n<p>I am placing the outer brackets wrong I guess, but I don't know where they should go.</p>\n\n<p>Anyone who could show me how the work is done?</p>\n"}, {"tags": ["haskell", "partial-application"], "comments": [{"owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "edited": false, "score": 2, "creation_date": 1554285522, "post_id": 55491659, "comment_id": 97691816, "body": "Do you understand that <code>(+) (+)</code> is <b>not a composition</b> of two functions but an application?"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "edited": false, "score": 0, "creation_date": 1554290624, "post_id": 55491659, "comment_id": 97694964, "body": "I understand that."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554308485, "post_id": 55491659, "comment_id": 97706501, "body": "They aren&#39;t methods, they&#39;re functions. Using the correct terminology, even in your own head, will help break any misconceptions you might bring to Haskell from other languages."}], "answers": [{"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1554290911, "post_id": 55492442, "comment_id": 97695140, "body": "So you are saying that i can think of the arguments of <code>+</code> as <code>slots</code> that can be filled with anything (does not matter how deep nested is, if at any point it matches the initial constraints).  So for <code>(+) (+2) (+(+3))</code>  , <code>+3</code> must match the constraints and <code>+(+3)</code> too, and that&#39;s it ?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1554291393, "post_id": 55492442, "comment_id": 97695453, "body": "Broadly, but it sounds like you&#39;re thinking in terms that are too complicated. <code>(+)</code> takes 2 arguments of the same type, an returns another of the same type - and that type can be anything that&#39;s an instance of <code>Num</code>. When you supply it a function, the type of that function must be an instance of <code>Num</code> - and the partially applied function takes a function of the same type and returns another function of that type."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1554291524, "post_id": 55492442, "comment_id": 97695524, "body": "But for example if i say : <code>(+) (2+) (+(+2))</code> from my reasoning the type should be <code>(+) (a-&gt;a)  (a-&gt;(a-&gt;a)-&gt;a)</code>. The compiler shows <code>(+) (a-&gt;a)-&gt;a-&gt;a</code>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1554291843, "post_id": 55492442, "comment_id": 97695742, "body": "can you explain your reasoning that comes up with that type? (It&#39;s not even a valid type, is there a typo somewhere?)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1554291953, "post_id": 55492442, "comment_id": 97695802, "body": "in any case, this is a rather confusing example, and relies on the fact that the literal <code>2</code> can stand for <i>any</i> instance of <code>Num</code>. In your example, the <code>2</code> in <code>(2+)</code> is actually being treated as a function. (At least I think so. As I said, this is quite a confusing example, and almost certainly nothing like this will come up in real practical code.)"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1554297417, "post_id": 55492442, "comment_id": 97699374, "body": "The first argument of <code>(+) </code> would be <code>(2+)</code> which is a <code>(a-&gt;a)</code>.The second argument is  <code>(+) (+2)</code> so <code>+2</code> would be <code>(a-&gt;a)</code> Therefore the <code>(+) (+2)</code> is <code>(a-&gt;a)-&gt;a-&gt;a</code>.So the big <code>+</code> would be <code>(+)   (a-&gt;a)  ((+) (a-&gt;a)  a)</code>.So applying in the second argument the <code>+</code> we get a <code>a-&gt;(a-&gt;a)-&gt;a</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 2, "creation_date": 1554297920, "post_id": 55492442, "comment_id": 97699689, "body": "The key point is that <code>(+)</code> requires both of its arguments to be the same type - and returns a value of the same type. Here the argument <code>(2+)</code> has type <code>Num a =&gt; a -&gt; a</code>, and <code>(+(+2))</code> is <code>(Num a, Num (a -&gt; a)) =&gt; (a -&gt; a) -&gt; a -&gt; a</code>. To make these the same type, Haskell takes the <code>a -&gt; a</code> as the <code>a</code> for the <code>(2+)</code> (which it can because of the <code>Num (a -&gt; a)</code> constraint. So both arguments you&#39;ve given <code>(+)</code> have the type <code>(a -&gt; a) -&gt; a -&gt; a</code> (with constraints that I&#39;m eliminating for brevity) - thus this must also be the type of the result."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1554321204, "post_id": 55492442, "comment_id": 97712751, "body": "&quot;So you are saying that i can think of the arguments of <code>+</code> as <code>slots</code> that can be filled with anything (does not matter how deep nested is, if at any point it matches the initial constraints).&quot; No, the argument as a whole must match the constraints, no nesting is considered. <code>+</code> takes two arguments of any type constrained by the <code>Num</code> typeclass. The reason passing functions to <code>+</code> typechecks is because Haskell has no way to know if you&#39;re later going to be creating a <code>Num</code> instance for functions (which is entirely possible, but not recommended)."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 3, "last_activity_date": 1554285885, "creation_date": 1554285885, "answer_id": 55492442, "question_id": 55491659, "link": "https://stackoverflow.com/questions/55491659/how-to-reason-about-partially-applied-method-chaining/55492442#55492442", "title": "How to reason about partially applied method chaining", "body": "<p>You've actually slightly misreported the type. There are some all-important typeclass constraints in there:</p>\n\n<pre><code>(+)(+2) :: (Num a, Num (a -&gt; a)) =&gt; (a -&gt; a) -&gt; a -&gt; a\n</code></pre>\n\n<p>So where does this come from? It's actually quite simple. Firstly, the type signature of <code>(+)</code> is</p>\n\n<pre><code>(+) :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Or, rewriting to make the currying explicit:</p>\n\n<pre><code>(+) :: Num a =&gt; a -&gt; (a -&gt; a)\n</code></pre>\n\n<p>Meanwhile, the type of <code>(+2)</code> (which is the result of just doing exactly that partial application) is:</p>\n\n<pre><code>(+2) :: Num a =&gt; a -&gt; a\n</code></pre>\n\n<p>Now when you do <code>(+)(+2)</code>, what you are doing is (partially) applying the <code>(+)</code> function to the function <code>(+2)</code>. That is, we're treating <code>(+2)</code> as the first argument of <code>(+)</code>. In order for this to work, its type - which is <code>Num a =&gt; a -&gt; a</code> - must be an instance of <code>Num</code>. So this is why we have a further type contraint, that <code>a -&gt; a</code>  must be an instance of <code>Num</code>. (This is never the case by default, but you can define your own instance for numerical functions - typically it would apply both functions to the input and add the results.)</p>\n\n<p>So let's specialise the type signature of <code>(+)</code> to the case where it's applied to a function <code>(a -&gt; a)</code> (which as I've just said must then itself be an instance of <code>Num</code>, as well as <code>a</code> itself). We get:</p>\n\n<pre><code>(+) :: (Num a, Num (a -&gt; a)) =&gt; (a -&gt; a) -&gt; (a -&gt; a) -&gt; (a -&gt; a)\n</code></pre>\n\n<p>or with currying made explicit:</p>\n\n<pre><code>(+) :: (Num a, Num (a -&gt; a)) =&gt; (a -&gt; a) -&gt; ((a -&gt; a) -&gt; (a -&gt; a))\n</code></pre>\n\n<p>That is, it takes an <code>a -&gt; a</code> function and returns a \"higher-order function\" of type <code>(a -&gt; a) -&gt; (a -&gt; a)</code>. So that when we apply this to <code>(+2)</code> we get exactly such a higher-order function:</p>\n\n<pre><code>(+)(+2) :: (Num a, Num (a -&gt; a)) =&gt; (a -&gt; a) -&gt; (a -&gt; a)\n</code></pre>\n\n<p>This is exactly what is reported, since the final pair of parentheses is unnecessary. (This is due to currying again.)</p>\n\n<p>The second case is entirely analagous, except that the function you're applying to is <code>a -&gt; a -&gt; a</code> rather than <code>a -&gt; a</code>.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 55492442, "answer_count": 1, "score": 0, "last_activity_date": 1554285885, "creation_date": 1554283604, "question_id": 55491659, "link": "https://stackoverflow.com/questions/55491659/how-to-reason-about-partially-applied-method-chaining", "title": "How to reason about partially applied method chaining", "body": "<p>I am trying to understand how to reason about the types for partial applied method chaining .\nI do not understand why :<br>\n<code>:t (+)(+2)</code> is <code>(a-&gt;a)-&gt;a-&gt;a</code><br>\nor why:<Br> <code>:t (+)(+)</code> is <code>(a-&gt;a-&gt;a)-&gt;a-&gt;a-&gt;a</code></p>\n\n<p>I mean for the first example\nI do not understand , when looking at the <code>(+)</code> do i need to look at what it needs <code>a-&gt;a-&gt;a</code> or what method is before it <code>(+2)</code> (which needs an <code>a</code>).</p>\n\n<p>At the second example i know the first <code>(+)</code> needs <code>a-&gt;a-&gt;a</code>, but once i fullfill the first method why does the second one need again the same parameters?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554287073, "post_id": 55492662, "comment_id": 97692819, "body": "Perhaps you could add an example showing how to use <code>displayException</code> correctly too ?"}, {"owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554287382, "post_id": 55492662, "comment_id": 97693003, "body": "I don&#39;t think it is used somehow extensively, but I found original <a href=\"https://mail.haskell.org/pipermail/libraries/2014-October/thread.html#24005\" rel=\"nofollow noreferrer\">discussion</a> about adding it."}, {"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "edited": false, "score": 0, "creation_date": 1554316736, "post_id": 55492662, "comment_id": 97710552, "body": "I found that discussion, too, and that\u2019s what I\u2019m wondering about: why isn\u2019t is used for the specific purpose it was intended for?"}], "tags": [], "owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "is_accepted": false, "score": 4, "last_activity_date": 1554319639, "last_edit_date": 1554319639, "creation_date": 1554286476, "answer_id": 55492662, "question_id": 55490766, "link": "https://stackoverflow.com/questions/55490766/why-doesn-t-ghc-use-my-displayexception-method/55492662#55492662", "title": "Why doesn\u2019t GHC use my displayException method?", "body": "<p>GHC's runtime does not use <code>displayException</code> to report catched exceptions to the user.</p>\n\n<p>You need to provide custom <code>Show</code> instance instead:</p>\n\n<pre><code>data MyException = MyException String\n    deriving Typeable\n\ninstance Show MyException where\n    show (MyException e) = \"oops! \" ++ e\n\ninstance Exception MyException\n</code></pre>\n\n<hr>\n\n<p><code>displayException</code> was <a href=\"https://mail.haskell.org/pipermail/libraries/2014-October/thread.html#24005\" rel=\"nofollow noreferrer\">added years ago</a> in order to have different methods for exception serialization (<code>show</code>) and reporting to the user (<code>displayException</code>).</p>\n\n<p>In the mentioned discussion I found <a href=\"https://mail.haskell.org/pipermail/libraries/2014-October/024039.html\" rel=\"nofollow noreferrer\">this reply by Edward Kmett</a> and it seems like a good reason for GHC RTS not to use <code>displayException</code>.</p>\n\n<blockquote>\n  <p>My experience is that whenever someone writes a \"helpful\" Show\n  instance it winds up anything but.</p>\n  \n  <p>Why?</p>\n  \n  <p>What happens when you print a list of them, or they occur deeper in a\n  larger structure?</p>\n  \n  <p>Invariably I wind up with things like a bag of your exceptions in an\n  async exception wrapper or someone's position type in my data\n  structure [...]</p>\n  \n  <p>\"Helpful\" Show instances are not compositional.</p>\n</blockquote>\n\n<p>So GHC RTS tires to provide the developer with as much detailed and parsable information about unhandled exceptions as possible. Leaving the ability to use <code>displayExceptions</code> to tell the end user about handled exceptions.</p>\n"}], "owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1554319639, "creation_date": 1554280998, "question_id": 55490766, "link": "https://stackoverflow.com/questions/55490766/why-doesn-t-ghc-use-my-displayexception-method", "title": "Why doesn\u2019t GHC use my displayException method?", "body": "<p>I have the following Haskell program where I customize the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html#v:displayException\" rel=\"noreferrer\"><code>displayException</code></a> method for human-friendly display of an exception:</p>\n\n<pre><code>import Control.Exception\nimport Data.Typeable\n\ndata MyException = MyException String\n                 deriving (Show, Typeable)\n\ninstance Exception MyException where\n  displayException (MyException e) = \"oops! \" ++ e\n\nmain = throw $ MyException \"something's wrong\"\n</code></pre>\n\n<p>But when I run it under GHC 8.6.4, I get</p>\n\n<pre><code>myprog.hs: MyException \"something's wrong\"\n</code></pre>\n\n<p>instead of the expected</p>\n\n<pre><code>myprog.hs: oops! something's wrong\n</code></pre>\n\n<p>Why isn\u2019t my <code>displayException</code> method being used?</p>\n"}, {"tags": ["haskell", "servant"], "comments": [{"owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 0, "creation_date": 1554303173, "post_id": 55488461, "comment_id": 97703198, "body": "Are you after <code>routerLayout</code> (see <a href=\"https://hackage.haskell.org/package/servant-server-0.16/docs/Servant-Server-Internal-Router.html#v:routerLayout\" rel=\"nofollow noreferrer\">here</a>) ?"}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "reply_to_user": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 0, "creation_date": 1554357530, "post_id": 55488461, "comment_id": 97722838, "body": "@AlpMestanogullari thank you! I have a feeling that this approach might be easier than <a href=\"https://stackoverflow.com/a/54890701/534481\">stackoverflow.com/a/54890701/534481</a> to solve my actual problem. Btw, how does one go from <code>Proxy api</code> to <code>Router env</code>? Via this function - <a href=\"https://www.stackage.org/haddock/lts-12.1/servant-server-0.14.1/Servant-Server-Internal.html#v:route\" rel=\"nofollow noreferrer\">stackage.org/haddock/lts-12.1/servant-server-0.14.1/&hellip;</a> ? Will passing an <code>EmptyContext</code> work, even if the app is actually using some <code>Context (eg for basic-auth)? What about </code>Delayed env (Server api)`? What does one pass here? (contd...)"}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "reply_to_user": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 0, "creation_date": 1554357694, "post_id": 55488461, "comment_id": 97722920, "body": "@AlpMestanogullari (...contd) here&#39;s what I&#39;m ultimately trying to do - I&#39;m trying to &quot;run the router&quot; as an independent entity. I want to feed it a URL (or some variation thereof), eg. <code>&#47;posts&#47;123</code> and get back a textual representation of the route it matched, eg. <code>&#47;posts&#47;:id</code>, or the <code>Summary</code>   - <a href=\"https://www.stackage.org/haddock/lts-12.1/servant-0.14.1/Servant-API.html#t:Summary\" rel=\"nofollow noreferrer\">stackage.org/haddock/lts-12.1/servant-0.14.1/&hellip;</a>  given in the route."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 475129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9818ce344fb428ac6332b38357e6249?s=128&d=identicon&r=PG", "display_name": "francisco", "link": "https://stackoverflow.com/users/475129/francisco"}, "is_accepted": false, "score": 0, "last_activity_date": 1604098586, "creation_date": 1604098586, "answer_id": 64616773, "question_id": 55488461, "link": "https://stackoverflow.com/questions/55488461/print-all-routes-in-a-haskell-servant-api-definition/64616773#64616773", "title": "Print all routes in a haskell-servant API definition?", "body": "<p>Servant has a function <code>layout</code> that works on a proxy of the api, doesn't give you quite the same as rake routes, but it's the same information.</p>\n<pre class=\"lang-hs prettyprint-override\"><code>import Servant\nimport Data.Text.IO as T\n\ntype MyAPI = ...\n\nprintLayout = T.putStrLn $ layout (Proxy :: Proxy MyAPI)\n</code></pre>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1604098586, "creation_date": 1554273033, "question_id": 55488461, "link": "https://stackoverflow.com/questions/55488461/print-all-routes-in-a-haskell-servant-api-definition", "title": "Print all routes in a haskell-servant API definition?", "body": "<p>I swear I saw this in the docs some time ago, but I can't seem to locate it now. Basically I'm looking for the equivalent of a <code>rake routes</code> command in <code>servant</code>, which prints out all routes in a human readable format.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 18, "creation_date": 1554263031, "post_id": 55486718, "comment_id": 97682126, "body": "Historical reasons.  There&#39;s <code>sequenceA</code> for the modern haskellista."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 5, "creation_date": 1554268137, "post_id": 55486718, "comment_id": 97683301, "body": "More specifically: it was defined before <code>Applicative</code> was known, and later was kept because when <code>Applicative</code> was added to <code>base</code> it wasn&#39;t a superclass of <code>Monad</code> yet."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1554292330, "post_id": 55486718, "comment_id": 97696036, "body": "For some reason, several functions in the past have been generalized to foldables/traversables when those were introduced, yet the previous monad-related functions (<code>ap</code>, <code>sequence</code>, ...) kept their type even when applicatives were introduced. Such changes are not backward compatible, that&#39;s true, but the other generalizations are not backwards compatible as well -- so I&#39;m unsure about the historic reason. (Haskell changed quite a bit: e.g., in the past <code>Monad</code> was not even a subclass of <code>Functor</code>)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1554292756, "post_id": 55486718, "comment_id": 97696288, "body": "@chi If <code>[]</code> was given a <code>Foldable</code> instance when <code>foldr</code> was generalized to <code>(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b</code>, that&#39;s not really a incompatible change, is it? When <code>Applicative</code> was introduced, monads didn&#39;t immediately become applicatives. Now that <code>Applicative</code> <i>is</i> a superclass of <code>Monad</code>, <code>sequence</code> could probably be re-typed. (That said, what&#39;s the corner case I&#39;m missing?)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1554293254, "post_id": 55486718, "comment_id": 97696621, "body": "@chepner It still is incompatible, in the general case, unfortunately. For instance if <code>class C a where foo :: a</code> with <code>instance C [a] where foo = []</code>, then <code>length foo</code> compiles if <code>length</code> forces <code>[a]</code>, but if <code>length</code> only requires a foldable the code is ambiguous. (In GHCi it works only because of <code>ExtendedDefaultRules</code>) This is a contrived example, but similar ambiguities can arise in real code."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1554320122, "post_id": 55486718, "comment_id": 97712195, "body": "I believe, but I can&#39;t find the reference right now, that there are certain (quasi-contrived? fully-contrived?) examples where <code>sequence</code> can be faster than <code>sequenceA</code>.  If anybody can find that explanation (maybe due to Edward Kmett?), I think that would make a great answer."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1554328362, "post_id": 55486718, "comment_id": 97715666, "body": "Related: <a href=\"https://stackoverflow.com/q/40181086/2751851\"><i>what does the A stand for in sequenceA?</i></a>"}], "answers": [{"comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1554426162, "post_id": 55500665, "comment_id": 97757775, "body": "Can you elaborate on &quot;compatibility reasons&quot;? Specifically, what would break if today, <code>sequence</code> were changed to have <code>sequenceA</code>&#39;s type signature, for example?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1554587517, "post_id": 55500665, "comment_id": 97808721, "body": "@JosephSible: You know, I may be mistaken\u2014nothing <i>should</i> break just from changing the signatures, and there might actually be a plan to do so in the future. It was other changes that didn\u2019t make the cut for AMP, such as moving <code>join</code> inside <code>Monad</code> and removing <code>return</code>, iirc due to issues with the role system."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 7, "last_activity_date": 1554588115, "last_edit_date": 1554588115, "creation_date": 1554311331, "answer_id": 55500665, "question_id": 55486718, "link": "https://stackoverflow.com/questions/55486718/why-sequence-requires-monad-if-applicative-would-suffice/55500665#55500665", "title": "Why sequence requires monad if applicative would suffice?", "body": "<p>There are many functions in Haskell that are equivalent but distinct because <code>Applicative</code> (resp. <code>Functor</code>) didn\u2019t use to be a superclass of <code>Monad</code>. For example:</p>\n\n<ul>\n<li><p><code>return</code> vs. <code>pure</code></p></li>\n<li><p><code>ap</code> vs. <code>&lt;*&gt;</code></p></li>\n<li><p><code>liftM</code> vs. <code>liftA</code> vs. <code>fmap</code></p></li>\n<li><p><code>liftM2</code>, <code>liftM3</code>, &amp;c. vs. <code>liftA2</code>, <code>liftA3</code>, &amp;c.</p></li>\n<li><p><code>mapM</code>/<code>forM</code> vs. <code>traverse</code>/<code>for</code></p></li>\n<li><p><code>mapM_</code>/<code>forM_</code> vs. <code>traverse_</code>/<code>for_</code></p></li>\n<li><p><code>sequence</code> vs. <code>sequenceA</code></p></li>\n<li><p><code>mzero</code> &amp; <code>mplus</code> (from <code>MonadPlus</code>) vs. <code>empty</code> &amp; <code>&lt;|&gt;</code> (from <code>Alternative</code>)</p></li>\n</ul>\n\n<p>The old functions with their original <code>Monad</code> signatures are still present, but in new code, since the <a href=\"https://wiki.haskell.org/Functor-Applicative-Monad_Proposal\" rel=\"nofollow noreferrer\">Applicative\u2013Monad Proposal (AMP)</a> was implemented, you can always use the <code>Applicative</code> versions because they\u2019re slightly more general\u2014that is, you can always replace <code>return</code> with <code>pure</code>, but not vice versa.</p>\n"}], "owner": {"reputation": 4198, "user_id": 4396113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/026c3ac09dad11029efe60f660e21dd5?s=128&d=identicon&r=PG&f=1", "display_name": "moped", "link": "https://stackoverflow.com/users/4396113/moped"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 2, "accepted_answer_id": 55500665, "answer_count": 1, "score": 7, "last_activity_date": 1554588115, "creation_date": 1554262892, "question_id": 55486718, "link": "https://stackoverflow.com/questions/55486718/why-sequence-requires-monad-if-applicative-would-suffice", "title": "Why sequence requires monad if applicative would suffice?", "body": "<p>The signature of sequence is</p>\n\n<pre><code>sequence :: Monad m =&gt; t (m a) -&gt; m (t a)\n</code></pre>\n\n<p>But we can implement it  as</p>\n\n<pre><code>sequence = traverse id\n</code></pre>\n\n<p>requiring <code>m</code> to be just <code>Applicative</code>. If monads are applicatives then why bother having this constraint on type level?</p>\n"}, {"tags": ["haskell", "yesod", "yesod-forms"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1554272536, "post_id": 55485593, "comment_id": 97684704, "body": "Why do you want to avoid it? It is exactly how I&#39;m converting keys coming from frontend to Persistent ones."}, {"owner": {"reputation": 11, "user_id": 10515039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e2e303d103b7e5aa0cd1c826874138?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo L&#243;pez", "link": "https://stackoverflow.com/users/10515039/camilo-l%c3%b3pez"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1554312223, "post_id": 55485593, "comment_id": 97708369, "body": "Actually im using toSqlKey, its only to search a different possibility or only syntactic sugar"}], "owner": {"reputation": 11, "user_id": 10515039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e2e303d103b7e5aa0cd1c826874138?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo L&#243;pez", "link": "https://stackoverflow.com/users/10515039/camilo-l%c3%b3pez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554253747, "creation_date": 1554253747, "question_id": 55485593, "link": "https://stackoverflow.com/questions/55485593/how-to-create-a-entity-key-form-field", "title": "How to create a entity key form field", "body": "<p>I want to create a new form field to enter an entity key, in this case an ArticleId instead of an Integer field, can I do that?</p>\n\n<p>There is my Article model</p>\n\n<pre><code>Article\n    title     Text\n    content   Text\n    userId    Int\n    score     Int Maybe\n    deriving  Show\n    deriving  Eq\n</code></pre>\n\n<p>And there is my AForm Article handler</p>\n\n<pre><code>&lt;$&gt; areq intField (bfs (\"Article Id\" :: Text)) Nothing\n&lt;*&gt; areq intField (bfs (\"Tag Id\" :: Text))     Nothing\n</code></pre>\n\n<p>I want to do this to avoid use toSqlKey in my selectList</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["windows", "haskell", "cabal", "jack"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1554272601, "post_id": 55484732, "comment_id": 97684724, "body": "You could try installing <code>stack</code> and using <code>stack exec pacman</code> to install jack package."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1554273054, "post_id": 55484732, "comment_id": 97684920, "body": "@arrowd&#39;s approach is exactly what I&#39;d do as well. Unfortunately, Stack&#39;s MinGW/MSYS2 distribution doesn&#39;t seem to include jack. It also seems that you&#39;re using Cabal, which means you wouldn&#39;t be able to use that method anyway."}], "owner": {"reputation": 21, "user_id": 11302425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fde099998643d6663063e034307a6e7?s=128&d=identicon&r=PG&f=1", "display_name": "Aperispomen", "link": "https://stackoverflow.com/users/11302425/aperispomen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554246459, "creation_date": 1554246459, "question_id": 55484732, "link": "https://stackoverflow.com/questions/55484732/how-to-install-jack-bindings-for-haskell-on-windows", "title": "How to install Jack bindings for Haskell on Windows", "body": "<p>I'm trying to setup the Jack bindings for Haskell (see <a href=\"https://www.stackage.org/package/jack\" rel=\"nofollow noreferrer\">https://www.stackage.org/package/jack</a> and <a href=\"http://hackage.haskell.org/package/jack\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/jack</a>) on Windows.</p>\n\n<p>I've installed Jack for Windows (from <a href=\"http://jackaudio.org/downloads/\" rel=\"nofollow noreferrer\">http://jackaudio.org/downloads/</a>). However, regardless of what I set <code>--extra-lib-dirs</code> to, I still get a <code>Missing (or bad) C library: jack</code> error.</p>\n\n<p>So, even if I run</p>\n\n<pre><code>cabal install jack --extra-include-dirs=\"C:\\Program Files (x86)\\Jack\\includes\" --extra-lib-dirs=\"C:\\Program Files (x86)\\Jack\" --extra-lib-dirs=\"C:\\Program Files (x86)\\Jack\\lib\" --extra-lib-dirs=\"C:\\Windows\\jack\"\n</code></pre>\n\n<p>I still get the error. Adding the <code>--extra-include-dirs=\"...\"</code> part did fix the <code>Missing (or bad) header file: jack/jack.h</code> error, though. </p>\n\n<p>I've tried installing pkg-config on the msys installation in <code>C:\\Program Files\\Haskell Platform\\...</code>, which fixed an error that occurred when I didn't use <code>-f -pkgconfig</code>, but otherwise didn't fix anything else. I also tried compiling Jack with MinGW, but I couldn't figure out how.</p>\n\n<p>Is there some location for the library files that I'm missing? Or is there some package for MinGW that has the required library files?</p>\n"}, {"tags": ["function", "haskell", "lambda"], "comments": [{"owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "edited": false, "score": 2, "creation_date": 1554237152, "post_id": 55482871, "comment_id": 97675901, "body": "What problems are you having with implementing this?"}, {"owner": {"reputation": 109, "user_id": 11013685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773f173a3f7dc76afcb72fe015821332?s=128&d=identicon&r=PG&f=1", "display_name": "KevinWendellCrumb", "link": "https://stackoverflow.com/users/11013685/kevinwendellcrumb"}, "reply_to_user": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "edited": false, "score": 0, "creation_date": 1554237423, "post_id": 55482871, "comment_id": 97676016, "body": "i havent find a way to start implementing this , i could do it if it was for example a polynom instead of that math formula which contians f(n) functions"}, {"owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "edited": false, "score": 0, "creation_date": 1554237745, "post_id": 55482871, "comment_id": 97676159, "body": "How would you write a function that evaluates a polynomial?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1554237862, "post_id": 55482871, "comment_id": 97676217, "body": "So, what attempt have you made?"}, {"owner": {"reputation": 109, "user_id": 11013685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773f173a3f7dc76afcb72fe015821332?s=128&d=identicon&r=PG&f=1", "display_name": "KevinWendellCrumb", "link": "https://stackoverflow.com/users/11013685/kevinwendellcrumb"}, "edited": false, "score": 0, "creation_date": 1554237914, "post_id": 55482871, "comment_id": 97676238, "body": "polynom (h:t) = \\x -&gt; h + x * ((poly t) x)"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554238013, "post_id": 55482871, "comment_id": 97676272, "body": "In particular, you need access to the index i, so a simple recursion will not suffice"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1554238994, "post_id": 55482871, "comment_id": 97676677, "body": "What did you attempt? What happened when you tried? Include this in your question, not the comments."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1554238877, "post_id": 55483375, "comment_id": 97676639, "body": "You could also <code>zip3 (iterate (2*) 1) ...</code>, which I believe saves having to <code>2^i</code> from scratch each time."}, {"owner": {"reputation": 109, "user_id": 11013685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773f173a3f7dc76afcb72fe015821332?s=128&d=identicon&r=PG&f=1", "display_name": "KevinWendellCrumb", "link": "https://stackoverflow.com/users/11013685/kevinwendellcrumb"}, "edited": false, "score": 0, "creation_date": 1554239377, "post_id": 55483375, "comment_id": 97676830, "body": "works great ! Seems like magic to me . Yea i understand the infinite lists implemetion part , just this code (fi, i) &lt;- zip fs in complicated for me , putting the fi in the generator. Also i cant use zip or zip3 , cause i should only use very basic haskell functions , but i think i should be able to find somewhere the source code for it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554239447, "post_id": 55483375, "comment_id": 97676858, "body": "Not sure why you could use <code>fold</code> but not <code>zip</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1554239448, "post_id": 55483375, "comment_id": 97676861, "body": "I believe there&#39;s a language extension somewhere that lets you replace <code>zip</code> by something like <code>[ ... | fi &lt;- fs | i &lt;- [0 ..] ]</code>."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554241044, "post_id": 55483375, "comment_id": 97677484, "body": "ParallelListComprehensions is the extension"}, {"owner": {"reputation": 109, "user_id": 11013685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773f173a3f7dc76afcb72fe015821332?s=128&d=identicon&r=PG&f=1", "display_name": "KevinWendellCrumb", "link": "https://stackoverflow.com/users/11013685/kevinwendellcrumb"}, "edited": false, "score": 0, "creation_date": 1554242545, "post_id": 55483375, "comment_id": 97677986, "body": "@A Tayler thank you for your input , i will check it out. In the meantime i found this <a href=\"https://gist.github.com/ijoshsmith/8cf1cff07b62fdf14056\" rel=\"nofollow noreferrer\">gist.github.com/ijoshsmith/8cf1cff07b62fdf14056</a> custom imp , works fine"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 109, "user_id": 11013685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773f173a3f7dc76afcb72fe015821332?s=128&d=identicon&r=PG&f=1", "display_name": "KevinWendellCrumb", "link": "https://stackoverflow.com/users/11013685/kevinwendellcrumb"}, "edited": false, "score": 0, "creation_date": 1554244214, "post_id": 55483375, "comment_id": 97678497, "body": "@TeoGoltsios you do know that you can just copy code from Prelude and/or Data.List right? eg. <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.List.html#zip3\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/src/&hellip;</a>"}, {"owner": {"reputation": 109, "user_id": 11013685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773f173a3f7dc76afcb72fe015821332?s=128&d=identicon&r=PG&f=1", "display_name": "KevinWendellCrumb", "link": "https://stackoverflow.com/users/11013685/kevinwendellcrumb"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554277717, "post_id": 55483375, "comment_id": 97687152, "body": "@ATayler i didnt no . Thanks for the info"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 0, "last_activity_date": 1554239040, "last_edit_date": 1554239040, "creation_date": 1554238278, "answer_id": 55483375, "question_id": 55482871, "link": "https://stackoverflow.com/questions/55482871/haskell-calculate-sum-of-functions-by-creating-a-higher-class-function/55483375#55483375", "title": "Haskell - Calculate sum of functions by creating a higher class function", "body": "<p>Let's say you have a list of functions:</p>\n\n<pre><code>fs = [f1, f2, f3, f4, f5] -- or more\n</code></pre>\n\n<p>Now, for each value <code>i</code> from 0 to infinity, we want to apply a function from <code>fs</code> to a corresponding <code>n - i</code>, then divide that value by 2<sup>i</sup>, and we want to sum the resulting floors.</p>\n\n<pre><code>hof fs = \\n -&gt; sum [ fi (n-i) `div` (2^i) | (fi, i) &lt;- zip fs [0..]]\n</code></pre>\n\n<p>Even though <code>[0..]</code> is an infinite list, the result of <code>zip fs [0..]</code> is finite, limited by the length of <code>fs</code>.</p>\n\n<p>To avoid repeated multiplications for each successive power of 2, use the <code>iterate</code> function to compute a sequence of them to zip along with <code>fs</code> and <code>[0..]</code></p>\n\n<pre><code>hof fs = \\n -&gt; sum [fi (n-i) `div` k | (fi, i, k) &lt;- zip3 fs [0..] (iterate (*2) 1)]\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 11013685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773f173a3f7dc76afcb72fe015821332?s=128&d=identicon&r=PG&f=1", "display_name": "KevinWendellCrumb", "link": "https://stackoverflow.com/users/11013685/kevinwendellcrumb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 55483375, "answer_count": 1, "score": -2, "last_activity_date": 1554239040, "creation_date": 1554236017, "last_edit_date": 1554238090, "question_id": 55482871, "link": "https://stackoverflow.com/questions/55482871/haskell-calculate-sum-of-functions-by-creating-a-higher-class-function", "title": "Haskell - Calculate sum of functions by creating a higher class function", "body": "<p><strong>Without the usage of imported code</strong> (i can use head, <code>tail</code>,<code>init</code>,<code>last</code>,<code>filter</code>,<code>map</code>,<code>fold</code>, <code>.</code> , generally basic haskell functions ) \nI want to create a higher-order function int ,type <code>hof :: [Integer-&gt;Integer]-&gt;(Integer-&gt;Integer)</code> , with <code>hof s = \\n -&gt;....</code> (using lambda)\nthat implements the following math formula </p>\n\n<p><a href=\"https://i.imgur.com/d3SXGJQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/d3SXGJQ.jpg\" alt=\"badly cropped photo of hand-written formula\"></a>\n(sorry, it is hand-written)</p>\n\n<p>Need some basic guidence for starting , i thought about implementing a recoursive call each time of the hof function , which hof itself should implement a changed math formula(which i given) suitable for recursive tail calls.</p>\n\n<p>some results that should be produced :</p>\n\n<pre><code>Main&gt; map (hof [(+1)]) [1..10]\n[2,3,4,5,6,7,8,9,10,11]\n\nMain&gt; map (hof [(+1),(+2)]) [1..10]\n[3,4,6,7,9,10,12,13,15,16]\n\nMain&gt; map (hof [(2^),(2^),(2^),(2^),(2^)]) [5..12]\n[42,85,170,341,682,1364,2728,5456]\n\nMain&gt; map (hof [(*2),(+100),(^3),negate,(mod 100)]) [24..40]\n[2768,3151,3567,4020,4509,5038,5609,6221,6876,7575,8322,9117,9960,10855,11805,\n12806,13863]\n\nMain&gt; map (hof [(mod 100),negate,(+100),(^3),(*2)]) [24..40]\n[1181,1351,1562,1767,1989,2230,2490,2771,3071,3395,3774,4145,4539,4958,5402,5873,6369]\n\nMain&gt; map (hof [(\u2018mod\u2018 i) | i&lt;-[50..100] ]) [1000..1030]\n[23,24,27,28,30,32,35,36,39,40,37,38,40,41,44,45,47,48,52,53,55,31,33,35,37,39,42,\n45,46,48,47]\n</code></pre>\n\n<p>Thanks for reading !</p>\n"}, {"tags": ["haskell", "recursion", "lambda-calculus"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9512830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6952fb1b9e1a63c067fb97a0f7d1108?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Diddler", "link": "https://stackoverflow.com/users/9512830/jimmy-diddler"}, "edited": false, "score": 0, "creation_date": 1554226881, "post_id": 55480363, "comment_id": 97671277, "body": "Wow, thank you! Using data and ditching the tuple certainly works, but it would simplify things if it were in the form of a tuple. <code>type Env = (Var, Term, [Env])</code> looked promising, but when I try to use it I get <code>Cycle in type synonym declarations</code>, and it refuses to compile. I saw a similar definition for a vertex in another post, but the compiler doesn&#39;t seem to like it. Is there a way around this?"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 23, "user_id": 9512830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6952fb1b9e1a63c067fb97a0f7d1108?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Diddler", "link": "https://stackoverflow.com/users/9512830/jimmy-diddler"}, "edited": false, "score": 0, "creation_date": 1554227140, "post_id": 55480363, "comment_id": 97671423, "body": "Ah, my bad, I forgot it was recursive. You can&#39;t have recursive aliases because that would lead to infinite types <code>(Var, Term [(Var, Term, [(Var, Term, [...</code>.  It&#39;s recursive, so you&#39;ll need to have a <code>data</code> declaration and a constructor."}, {"owner": {"reputation": 23, "user_id": 9512830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6952fb1b9e1a63c067fb97a0f7d1108?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Diddler", "link": "https://stackoverflow.com/users/9512830/jimmy-diddler"}, "edited": false, "score": 0, "creation_date": 1554227247, "post_id": 55480363, "comment_id": 97671482, "body": "I see, slightly more painful but I&#39;m sure I can push through :) Thank you!"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 23, "user_id": 9512830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6952fb1b9e1a63c067fb97a0f7d1108?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Diddler", "link": "https://stackoverflow.com/users/9512830/jimmy-diddler"}, "edited": false, "score": 0, "creation_date": 1554241458, "post_id": 55480363, "comment_id": 97677647, "body": "@Jimmy I don&#39;t know exactly what pain points you&#39;re finding, but there are a number of common ways to alleviate boilerplate, such as deriving Show, Eq, Functor, Foldable, which very often can make your life easier."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 8, "last_activity_date": 1554227217, "last_edit_date": 1554227217, "creation_date": 1554225649, "answer_id": 55480363, "question_id": 55480071, "link": "https://stackoverflow.com/questions/55480071/haskell-recursive-definition-of-a-tuple/55480363#55480363", "title": "Haskell : Recursive definition of a tuple", "body": "<pre class=\"lang-hs prettyprint-override\"><code>data Env = Env (Var, Term, [Env])\n</code></pre>\n\n<p>Here you define the type <code>Env</code> and the data constructor <code>Env</code>. They have the same name, but the data constructor <code>Env</code> is a value with type:</p>\n\n<pre><code>ghci&gt; :t Env\nEnv :: (Var, Term, [Env]) -&gt; Env\n</code></pre>\n\n<p>The constructor defines a mapping from tuples to <code>Env</code> values. It can also be used in pattern matching to map from <code>Env</code> values to tuples:</p>\n\n<pre><code>ghci&gt; :t \\(Env t) -&gt; t\n\\(Env t) -&gt; t :: Env -&gt; (Var, Term, [Env])\n</code></pre>\n\n<p>The trick is that though values of type <code>Env</code> are isomorphic to tuples <code>(Var, Term, [Env])</code>, they have a different type; <code>Env</code>. This is <em>nominitive</em> typing, rather that <em>structural</em> typing. It very useful when we want to have values that have the same structure under the hood, but are distinct in the type system, e.g.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data SecondsAfterMidnight = SecondsAfterMidnight Int\ndata PenniesPerHour = PenniesPerHour Int\n</code></pre>\n\n<p>This prevents us from doing something like <code>fiveCentsPerHour + oneFifteenAM</code>.</p>\n\n<p>That said, sometimes you just want a more convenient name for a complicated type and you don't want it to be distinct from the complicated type.  Haskell has <em>type aliases</em> to handle this case. For example, <code>String</code> is a type alias for <code>[Char]</code> (a list of char); they're two names for the same type.</p>\n\n<p>If it weren't recursive and you didn't want to bother with a constructor, you could use a type alias by using the <code>type</code> keyword:</p>\n\n<pre><code>type Env = (Var, Term, [SomethingElse])\n</code></pre>\n\n<p>But you can't use type aliases to define recursive types as they would then infinitely expand at compile time.</p>\n\n<p>Another way you could go is to ditch the tuple and embrace your <code>Env</code> constructor:</p>\n\n<pre><code>data Env = Env Var Term [Env]\n</code></pre>\n\n<p>Now the <code>Env</code> constructor takes three parameters, rather than a tuple.</p>\n\n<pre><code>ghci&gt; :t Env\nEnv :: Var -&gt; Term -&gt; [Env] -&gt; Env\n</code></pre>\n\n<p>You can also use record syntax to get getters for the various fields:</p>\n\n<pre><code>data Env = Env { var :: Var, term :: Term, env :: [Env] }\n</code></pre>\n\n<p>These can be pretty handy:</p>\n\n<pre><code>ghci&gt; :t var\nvar :: Env -&gt; Var\nghci&gt; :t term\nterm :: Env -&gt; Term\nghci&gt; :t env\nenv :: Env -&gt; [Env]\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9512830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6952fb1b9e1a63c067fb97a0f7d1108?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Diddler", "link": "https://stackoverflow.com/users/9512830/jimmy-diddler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 55480363, "answer_count": 1, "score": 0, "last_activity_date": 1554237913, "creation_date": 1554224524, "last_edit_date": 1554237913, "question_id": 55480071, "link": "https://stackoverflow.com/questions/55480071/haskell-recursive-definition-of-a-tuple", "title": "Haskell : Recursive definition of a tuple", "body": "<p>In it I'm trying to create a Krivine Abstract Machine. One of the data types I need to build is an environment. An Environment is built as such:</p>\n\n<p>We have x, a \"Var\" (This is just a synonym for string)\nWe have N, a \"Term\" (This is a Lambda term)</p>\n\n<p>So the definition of an environment E is:</p>\n\n<p>E = (x, N, E) \u00b7 E.</p>\n\n<p>So an environment is a list of tuples. Each tuple contains a Var (String), A Term and a list of environments (which may be empty).</p>\n\n<p>I'm defining \"Env\" like so:</p>\n\n<pre><code>data Env = Env (Var, Term, [Env])\n</code></pre>\n\n<p>To me, this looks as if it should work. However, when I try to utilise Env, I get:</p>\n\n<pre><code>*Main&gt; (\"y\", Lambda \"z\" (Variable \"z\"), []) :: Env\n\n&lt;interactive&gt;:166:1: error:\n* Couldn't match expected type `Env'\n              with actual type `([Char], Term, [a0])'\n* In the expression: (\"y\", Lambda \"z\" (Variable \"z\"), []) :: Env\n  In an equation for `it':\n      it = (\"y\", Lambda \"z\" (Variable \"z\"), []) :: Env\n</code></pre>\n\n<p>\"y\" is certainly [Char]</p>\n\n<p>Lambda \"z\" (Variable \"z\") is definitely of type Term</p>\n\n<p>And an empty list is definitely a list!</p>\n\n<p>I have a feeling that the problem may be occurring with the empty list, but it's absolutely essential that an empty list can be present within an environment (this is the base case).</p>\n\n<p>I've now been trying to get this working for a few hours with no luck at all. Any help is greatly appreciated.</p>\n"}, {"tags": ["haskell", "haskell-stack", "haddock", "hoogle"], "comments": [{"owner": {"reputation": 719, "user_id": 540718, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/64bb401eff530b423eae58217f2b1362?s=128&d=identicon&r=PG", "display_name": "nemron", "link": "https://stackoverflow.com/users/540718/nemron"}, "edited": false, "score": 0, "creation_date": 1554228411, "post_id": 55479788, "comment_id": 97671989, "body": "Seems to be this bug: <a href=\"https://github.com/haskell/haddock/issues/979\" rel=\"nofollow noreferrer\">github.com/haskell/haddock/issues/979</a>."}], "answers": [{"comments": [{"owner": {"reputation": 719, "user_id": 540718, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/64bb401eff530b423eae58217f2b1362?s=128&d=identicon&r=PG", "display_name": "nemron", "link": "https://stackoverflow.com/users/540718/nemron"}, "edited": false, "score": 0, "creation_date": 1554352279, "post_id": 55481960, "comment_id": 97721157, "body": "Where <code>stack hoogle</code> terminates with an error, <code>hoogle generate</code> runs through. <code>hoogle generate --local</code> terminates with error <code>Starting generate \\n Reading ghc-pkg... hoogle: ghc-pkg: createProcess: runInteractiveProcess: exec: does not exist (No such file or directory)</code>, though."}, {"owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "reply_to_user": {"reputation": 719, "user_id": 540718, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/64bb401eff530b423eae58217f2b1362?s=128&d=identicon&r=PG", "display_name": "nemron", "link": "https://stackoverflow.com/users/540718/nemron"}, "edited": false, "score": 1, "creation_date": 1556283441, "post_id": 55481960, "comment_id": 98396160, "body": "That says that <code>ghc-pkg</code> isn&#39;t on your path, perhaps because you don&#39;t have a global install of GHC and are only using it through Stack? You may need to do <code>stack exec -- hoogle generate --local</code> where <code>stack exec</code> will put <code>ghc-pkg</code> on your path and point at the right package databases."}], "tags": [], "owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "is_accepted": false, "score": 0, "last_activity_date": 1554232232, "creation_date": 1554232232, "answer_id": 55481960, "question_id": 55479788, "link": "https://stackoverflow.com/questions/55479788/build-local-hoogle-db-despite-error-in-haddock/55481960#55481960", "title": "Build local Hoogle DB despite error in Haddock", "body": "<p><code>stack hoogle</code> is approximately a helper around <code>stack haddock</code> then <code>hoogle generate --local</code>. If you can generate Haddock output only for the projects that work then you can manually <code>hoogle generate --local</code>. However, I'm not aware of any way to restrict <code>stack haddock</code> to only a subset, so it may not be practical.</p>\n\n<p>Another approach is to <code>hoogle generate &lt;list of dependencies&gt;</code>, which will use the remote documentation rather than local, and thus will skip running Haddock. </p>\n"}], "owner": {"reputation": 719, "user_id": 540718, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/64bb401eff530b423eae58217f2b1362?s=128&d=identicon&r=PG", "display_name": "nemron", "link": "https://stackoverflow.com/users/540718/nemron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554232232, "creation_date": 1554223433, "question_id": 55479788, "link": "https://stackoverflow.com/questions/55479788/build-local-hoogle-db-despite-error-in-haddock", "title": "Build local Hoogle DB despite error in Haddock", "body": "<p>Is there a workaround to build a lokal Hoogle DB despite Haddock errors in some packages. For example, is there a workaround on how to exclude those packages from the Haddock sub-task during the lokal Hoogle DB build?</p>\n\n<p>As a concret example:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ stack hoogle\nNo Hoogle database yet. Automatically building haddocks and hoogle database (use --no-setup to disable) ...\nclassy-prelude-yesod-1.5.0: configure\nclassy-prelude-yesod-1.5.0: build\nclassy-prelude-yesod-1.5.0: haddock\nProgress 1/2\n\n--  While building package classy-prelude-yesod-1.5.0 using:\n      /Users/nrm/.stack/setup-exe-cache/x86_64-osx/Cabal-simple_mPHDZzAJ_2.4.0.1_ghc-8.6.4 --builddir=.stack-work/dist/x86_64-osx/Cabal-2.4.0.1 haddock --html --hoogle --html-location=../$pkg-$version/ --haddock-option=--hyperlinked-source --haddock-option=--quickjump\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /Users/nrm/Sources/mdpm/projects/Yapper/.stack-work/logs/classy-prelude-yesod-1.5.0.log\n\n    Configuring classy-prelude-yesod-1.5.0...\n    Preprocessing library for classy-prelude-yesod-1.5.0..\n    Building library for classy-prelude-yesod-1.5.0..\n    [1 of 2] Compiling ClassyPrelude.Yesod ( src/ClassyPrelude/Yesod.hs, .stack-work/dist/x86_64-osx/Cabal-2.4.0.1/build/ClassyPrelude/Yesod.o )\n    [2 of 2] Compiling Paths_classy_prelude_yesod ( .stack-work/dist/x86_64-osx/Cabal-2.4.0.1/build/autogen/Paths_classy_prelude_yesod.hs, .stack-work/dist/x86_64-osx/Cabal-2.4.0.1/build/Paths_classy_prelude_yesod.o )\n    Preprocessing library for classy-prelude-yesod-1.5.0..\n    Running Haddock on library for classy-prelude-yesod-1.5.0..\n    Haddock coverage:\n    haddock: internal error: internal: extractDecl\n    CallStack (from HasCallStack):\n      error, called at utils/haddock/haddock-api/src/Haddock/Interface/Create.hs:1116:12 in main:Haddock.Interface.Create\n</code></pre>\n\n<p>Relates to <a href=\"https://stackoverflow.com/questions/52724952/how-to-build-with-haddocks-but-ignore-haddock-errors\">How to build with haddocks, but ignore haddock errors</a></p>\n"}, {"tags": ["json", "haskell", "aeson", "haskell-req"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1554211790, "post_id": 55475678, "comment_id": 97662406, "body": "Is filing a bug report to get a valid JSON response an option?"}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1554211824, "post_id": 55475678, "comment_id": 97662432, "body": "It may be easier to write your own parser. Perhaps take a copy of the Aeson parser and make the changes to it -- you now have something you can work with."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1554211918, "post_id": 55475678, "comment_id": 97662496, "body": "You might be able to pre-process the response with <a href=\"https://stedolan.github.io/jq/\" rel=\"nofollow noreferrer\"><code>jq</code></a>; treat the response as a filter: <code>bad_json=&#39;{foo: &quot;bar&quot;}&#39;; jq -n &quot;$bad_json&quot;</code> will output <code>{&quot;foo&quot;: &quot;bar&quot;}</code>."}, {"owner": {"reputation": 179, "user_id": 6814824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8407496f0354245617266793ca535010?s=128&d=identicon&r=PG&f=1", "display_name": "Vinothkumar Raman", "link": "https://stackoverflow.com/users/6814824/vinothkumar-raman"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554212716, "post_id": 55475678, "comment_id": 97663033, "body": "@chepner I don&#39;t think its possible. Its not even a documented API. I think writing my own parser is the only way to go about this I think."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1554220215, "post_id": 55475678, "comment_id": 97667831, "body": "There might be value in having a permissive parsing mode in <code>aeson</code> that handled various types of malformed input. So if you extended <code>aeson</code> it might result in a patch that could be upstreamed"}], "owner": {"reputation": 179, "user_id": 6814824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8407496f0354245617266793ca535010?s=128&d=identicon&r=PG&f=1", "display_name": "Vinothkumar Raman", "link": "https://stackoverflow.com/users/6814824/vinothkumar-raman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586462535, "creation_date": 1554210669, "last_edit_date": 1586462535, "question_id": 55475678, "link": "https://stackoverflow.com/questions/55475678/how-to-parse-something-json-like-with-unquoted-keys-with-aeson", "title": "How to parse something json-like with unquoted keys with aeson?", "body": "<p>I am trying to use <code>req</code> library to crawl a page. The response for the page, is <em>almost</em> a <code>JSON</code> object, except for the keys being unquoted.</p>\n\n<p>Is it possible to use <code>Aeson</code> to do relaxed parsing of it? </p>\n\n<p>What could be the simplest hack that I can do with <code>req</code> to do that.</p>\n\n<p>I tried to do regex replace in bytestring to introduce quotes, but it gets enormously complicated soon.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1554200731, "post_id": 55472400, "comment_id": 97655447, "body": "The input type should contain booleans if you want to call the first function. Also, you don&#39;t need to convert the whole list at each recursive call: converting once is enough."}, {"owner": {"reputation": 140, "user_id": 7586837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f33527036ce0b2404c278344fbe8a3?s=128&d=identicon&r=PG&f=1", "display_name": "Seiggailion", "link": "https://stackoverflow.com/users/7586837/seiggailion"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1554200918, "post_id": 55472400, "comment_id": 97655554, "body": "@chi, in what place should i call the function once? I was thinking something like that but i don&#39;t where to do it."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1554200949, "post_id": 55472400, "comment_id": 97655573, "body": "<code>sum [if b then 1 else 0 | (_, b) in ls]</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1554205389, "post_id": 55472400, "comment_id": 97658337, "body": "@Seiggailion Robin below showed how to do it: you can define <code>f ys = f2 (boolToInt ys) where f2 [] = ... ; f2 (x:xs) = ...</code>. The point is, you need to define an auxiliary recursive function (<code>f2</code> above) working on &quot;list with ints&quot;, and then call that with the modified list."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554205767, "post_id": 55472400, "comment_id": 97658577, "body": "Note that you don&#39;t actually need <code>boolToInt</code>, because <code>Bool</code> already has an <code>Enum</code> instance, which lets you write <code>teamNumberOfWins = ((x,y):xs) = fromEnum y + teamNumberOfWins xs</code>, or using Elmex80&#39;s list comprehension, <code>sum [fromEnum b | (_, b) &lt;- ls]</code>. (Which itself is just <code>teamNumberOfWins = sum . map (fromEnum . snd)</code>.)"}], "answers": [{"comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 3, "creation_date": 1554201329, "post_id": 55472510, "comment_id": 97655801, "body": "Imo it&#39;s worth introducing <code>fromEnum</code> for <code>singleBoolToInt</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1554205718, "post_id": 55472510, "comment_id": 97658550, "body": "If we want to simplify further, we can let <code>teamNumberOfWins = length . filter snd</code>. But I like Robin&#39;s answer since it <i>explains</i> to the OP what&#39;s wrong, and proposes a fix which should be understandable to the OP. By comparison, just giving out a cryptic solution as mine won&#39;t be very helpful, at least until the OP learns some intermediate Haskell."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1554206770, "post_id": 55472510, "comment_id": 97659190, "body": "Thanks @chi, and @ATayler - I agree with your comments, I didn&#39;t pursue the simplification beyond the <code>map</code>, in part because of laziness and time constraints, and also in part because I&#39;m nowhere near as familiar with Haskell myself as you guys. (Should definitely have spotted the <code>length . filter snd</code> version though.) Mainly i wanted to show the OP specifically what he was doing wrong, and the most &quot;direct&quot; (although not the &quot;best&quot;) way to fix it."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 4, "last_activity_date": 1554201490, "last_edit_date": 1554201490, "creation_date": 1554200848, "answer_id": 55472510, "question_id": 55472400, "link": "https://stackoverflow.com/questions/55472400/call-function-inside-of-the-other-function-in-haskell/55472510#55472510", "title": "Call function inside of the other function in Haskell", "body": "<p>In your defenition:</p>\n\n<pre><code>teamNumberOfWins :: [([Char], Int)] -&gt; Int\nteamNumberOfWins  []            = 0\nteamNumberOfWins ((x, y):xs)    = sum + y\n   where sum = teamNumberOfWins (boolToInt xs)\n</code></pre>\n\n<p>there is a problem with the last line. <code>xs</code> is a value of type <code>[([Char], Int)]</code>, but <code>boolToInt</code> has only been defined to work on values of type <code>[([Char], Bool)]</code>. Haskell has a very strict type system (which is actually one of the language's strengths), and simply won't allow you to do this.</p>\n\n<p>What you clearly want to do is to take a list of type <code>[([Char], Bool)]</code>, and apply <code>boolToInt</code>, then apply <code>teamNumberOfWins</code> (your original version), to the result. This is called function composition, and Haskell has a very helpful built-in function/operator to do this, which is simply <code>.</code></p>\n\n<p>So all you need to do is keep your first 2 functions as they are, and define a new one:</p>\n\n<pre><code>teamNumberOfWins' = teamNumberOfWins . boolToInt\n</code></pre>\n\n<p>Note that you can also drastically simplify the definition of <code>boolToInt</code> using the <code>map</code> function, which applies a function of one element to every element of a list. Thus:</p>\n\n<pre><code>boolToInt = map singleBoolToInt\n  where singleBoolToInt (x, True) = (x, 1)\n        singleBoolToInt (x, False) = (x, 0)\n</code></pre>\n"}], "owner": {"reputation": 140, "user_id": 7586837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f33527036ce0b2404c278344fbe8a3?s=128&d=identicon&r=PG&f=1", "display_name": "Seiggailion", "link": "https://stackoverflow.com/users/7586837/seiggailion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 55472510, "answer_count": 1, "score": -2, "last_activity_date": 1554201490, "creation_date": 1554200498, "question_id": 55472400, "link": "https://stackoverflow.com/questions/55472400/call-function-inside-of-the-other-function-in-haskell", "title": "Call function inside of the other function in Haskell", "body": "<p>I am really new to Haskell. I have two functions for array of tuples. Fist one replaces Bool value with 0 or 1.</p>\n\n<pre><code>boolToInt :: [([Char], Bool)] -&gt; [([Char], Int)]\nboolToInt ((x, True):xs)        = (x, 1): boolToInt xs\nboolToInt ((x, False):xs)       = (x, 0): boolToInt xs\nboolToInt []                    = []\n</code></pre>\n\n<p>Second sums the second values in the list</p>\n\n<pre><code>teamNumberOfWins :: [([Char], Int)] -&gt; Int\nteamNumberOfWins  []            = 0\nteamNumberOfWins ((x, y):xs)    = sum + y\n   where sum = teamNumberOfWins xs\n</code></pre>\n\n<p>For the second function list has to be already with Int values. Is there a way to call in second function first one? I tried something like this:</p>\n\n<pre><code>teamNumberOfWins :: [([Char], Int)] -&gt; Int\nteamNumberOfWins  []            = 0\nteamNumberOfWins ((x, y):xs)    = sum + y\n   where sum = teamNumberOfWins (boolToInt xs)\n</code></pre>\n\n<p>but it doesn't work. Can someone help me?</p>\n"}, {"tags": ["haskell", "ghc", "cabal", "archlinux", "cabal-install"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1554201573, "post_id": 55472132, "comment_id": 97655948, "body": "I don&#39;t quite understand, is your problem that you can&#39;t remove cabal properly? (In which case, isn&#39;t there a command like <code>type -a cabal</code> that shows where the executable resides?)"}], "answers": [{"tags": [], "owner": {"reputation": 3722, "user_id": 3962001, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/cafed2a6d406e62405d1716a20b2ed4b?s=128&d=identicon&r=PG", "display_name": "ahstro", "link": "https://stackoverflow.com/users/3962001/ahstro"}, "is_accepted": false, "score": 1, "last_activity_date": 1554294633, "creation_date": 1554294633, "answer_id": 55495258, "question_id": 55472132, "link": "https://stackoverflow.com/questions/55472132/how-to-overcome-cabal-error-while-loading-shared-libraries-error-on-arch-lin/55495258#55495258", "title": "How to overcome [cabal: error while loading shared libraries:] error on arch linux?", "body": "<p>I had similar problems and ended up reinstalling the specific Haskell libraries. E.g, for <code>libHSdlist-0.8.0.6-CQRMCGRgL5B3ZxhntX4iOr-ghc8.6.4.so</code> I'd run <code>pacman -S haskell-dlist</code>. So in your case, you'd want to run <code>pacman -S haskell-zip-archive</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554294633, "creation_date": 1554199735, "question_id": 55472132, "link": "https://stackoverflow.com/questions/55472132/how-to-overcome-cabal-error-while-loading-shared-libraries-error-on-arch-lin", "title": "How to overcome [cabal: error while loading shared libraries:] error on arch linux?", "body": "<p>I had some problems a while back trying to use cabal, so I reinstalled ghc (from 8.6.3) to 8.6.4.  </p>\n\n<p>When I try to use cabal (after it is uninstalled completely) I still get the below error, but can't see the file mentioned in when using fzf from the root directory.   <a href=\"https://i.stack.imgur.com/w6Ym9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w6Ym9.png\" alt=\"fzf from root\"></a> </p>\n\n<pre><code>[warrick@warrick-pc ~]$ cabal\ncabal: error while loading shared libraries: libHSzip-archive-0.3.3-FtEZ8cVpsWW1rhccfBNhic-ghc8.6.3.so: cannot open shared object file: No such file or directory\n</code></pre>\n\n<p>I have completely removed ~/.cabal but still don't have any clue how cabal is still being called from somewhere even though I have unistalled it.  If I reinstall it and use cabal I get the same error message.  </p>\n"}, {"tags": ["haskell", "typeclass", "monoids", "deriving"], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554205461, "post_id": 55471573, "comment_id": 97658389, "body": "Indeed; <code>:info Sum</code> explicitly shows <code>instance Eq a =&gt; Eq (Sum a)</code>."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 7, "last_activity_date": 1554198117, "creation_date": 1554198117, "answer_id": 55471573, "question_id": 55471499, "link": "https://stackoverflow.com/questions/55471499/data-monoid-sum-and-product-deriving-bounded-and-num-at-the-same-time/55471573#55471573", "title": "(Data.Monoid) - Sum and Product deriving Bounded and Num at the same time?", "body": "<p>I'm fairly sure this makes <code>Sum a</code> an instance of (say) <code>Eq</code> whenever <code>a</code> is an instance of <code>Eq</code>.</p>\n\n<pre><code>instance (Eq a) =&gt; Eq (Sum a) where ...\n</code></pre>\n\n<p>And likewise for all the other classes.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 55471573, "answer_count": 1, "score": 2, "last_activity_date": 1554560232, "creation_date": 1554197884, "last_edit_date": 1554560232, "question_id": 55471499, "link": "https://stackoverflow.com/questions/55471499/data-monoid-sum-and-product-deriving-bounded-and-num-at-the-same-time", "title": "(Data.Monoid) - Sum and Product deriving Bounded and Num at the same time?", "body": "<p>in <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/Data.Semigroup.Internal.html#Sum\" rel=\"nofollow noreferrer\"><code>Data.Monoid</code></a> : </p>\n\n<pre><code>newtype Sum a = Sum { getSum :: a }\n    deriving ( Eq       -- ^ @since 2.01\n             , Ord      -- ^ @since 2.01\n             , Read     -- ^ @since 2.01\n             , Show     -- ^ @since 2.01\n             , Bounded  -- ^ @since 2.01\n             , Generic  -- ^ @since 4.7.0.0\n             , Generic1 -- ^ @since 4.7.0.0\n             , Num      -- ^ @since 4.7.0.0\n             )\n</code></pre>\n\n<p>I don't understand how you could derive <code>Num</code> and <code>Bounded</code> on <code>Sum</code> with <code>Integer</code>, <code>Float</code> etc... which are naturally not <code>Bounded</code> (it's the same story for the <code>Product</code> wrapper). </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "closures", "church-encoding"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1554158755, "post_id": 55464145, "comment_id": 97641111, "body": "Under those assumptions, count the number of the <code>App</code>s inside the term."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1554178701, "post_id": 55464145, "comment_id": 97645129, "body": "@chi, I don&#39;t think that works, unless you assume reduction under lambdas. See also Daniel Wagner&#39;s comment."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1554188400, "post_id": 55464145, "comment_id": 97648505, "body": "@dfeuer Correct, I was assuming to have a numeral in normal form."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 2, "creation_date": 1554188789, "post_id": 55464145, "comment_id": 97648724, "body": "&quot; (sounds inefficient)&quot; ;-) a Church encoding just <i>is</i> inefficient. It&#39;s to demonstrate the power of the lambda calculus, not intended for any serious computation. You need an <code>Eval</code> or <code>Interp</code> function that pulls the variables&#39; assignments out of the <code>Env</code> and executes them."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1554229942, "post_id": 55464145, "comment_id": 97672676, "body": "I guess what you&#39;re discovering here is part of the motivation for including base types that are not lambdas -- since functions are so difficult to (correctly) introspect on, you include some types that are easier to inspect!"}, {"owner": {"reputation": 507, "user_id": 515276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eec8691200732875d9d0a619ea1be7ca?s=128&d=identicon&r=PG", "display_name": "Labbekak", "link": "https://stackoverflow.com/users/515276/labbekak"}, "edited": false, "score": 0, "creation_date": 1554230541, "post_id": 55464145, "comment_id": 97672933, "body": "Yeah I have come to the same conclusion. I am working on a little toy language based on pure lambda calculus, but it&#39;s not much fun computing stuff if you can&#39;t see the result :p So I will have to add some stuff to the CEK machine. Thanks everyone for the help anyway."}], "answers": [{"comments": [{"owner": {"reputation": 507, "user_id": 515276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eec8691200732875d9d0a619ea1be7ca?s=128&d=identicon&r=PG", "display_name": "Labbekak", "link": "https://stackoverflow.com/users/515276/labbekak"}, "edited": false, "score": 0, "creation_date": 1554184456, "post_id": 55464680, "comment_id": 97646718, "body": "Your <code>fromChurch</code> works on an Haskell function, while my <code>c</code> is of type <code>Clos</code> so I cannot apply it."}, {"owner": {"reputation": 507, "user_id": 515276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eec8691200732875d9d0a619ea1be7ca?s=128&d=identicon&r=PG", "display_name": "Labbekak", "link": "https://stackoverflow.com/users/515276/labbekak"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1554185587, "post_id": 55464680, "comment_id": 97647132, "body": "I updated my question. @DanielWagner I think the issue I have here is the &quot;fully applying and reducing&quot; because the term I get out from the CEK-machine is an abstraction with free variables together with an environment that assigns closures to those variables. I will not end up with a term of the form `\\s z -&gt; s ... s z)."}], "tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": false, "score": 3, "last_activity_date": 1554159292, "creation_date": 1554159292, "answer_id": 55464680, "question_id": 55464145, "link": "https://stackoverflow.com/questions/55464145/given-a-church-encoded-numeral-as-closure-result-from-a-cek-machine-how-to-get/55464680#55464680", "title": "Given a church encoded numeral as closure result from a CEK-machine, how to get back the number?", "body": "<p>A Church numeral is a function of two arguments</p>\n\n<pre><code>type Church a = (a -&gt; a) -&gt; a -&gt; a\n</code></pre>\n\n<p>The second argument is the zero case, the first argument is the increment case. So you just need to apply the numeral to a suitable couple of arguments to get some (typically numeric) data type:</p>\n\n<pre><code>fromChurch c = c (+ 1) (0 :: Int)\n</code></pre>\n"}], "owner": {"reputation": 507, "user_id": 515276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eec8691200732875d9d0a619ea1be7ca?s=128&d=identicon&r=PG", "display_name": "Labbekak", "link": "https://stackoverflow.com/users/515276/labbekak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1554187112, "creation_date": 1554155758, "last_edit_date": 1554187112, "question_id": 55464145, "link": "https://stackoverflow.com/questions/55464145/given-a-church-encoded-numeral-as-closure-result-from-a-cek-machine-how-to-get", "title": "Given a church encoded numeral as closure result from a CEK-machine, how to get back the number?", "body": "<p>I have implemented the CEK-machine. Given a closure result from this algorithm and the knowledge that this closure is a Church-encoded numeral, what is the best way to print out the numeral?</p>\n\n<p>Using the following types:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Term = Var String | Abs String Term | App Term Term\ndata Clos = Clos String Term Env\ntype Env = [(String, Clos)]\n</code></pre>\n\n<p>EDIT:\nTo make this vague question a little clearer:\nStarting my machine with <code>(\\n f x -&gt; f (n f x)) (\\f x -&gt; x)</code> (<code>s z</code>) I end up with:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(\\f -&gt; (\\x -&gt; (f ((n f) x)))) :: Term\n[(\"n\", Clos((\\f -&gt; (\\x -&gt; x)), []))] :: Env\n</code></pre>\n\n<p>This is a datastructure that represents a closure that represents a church numeral. How can I reify this structure to a number? Do I have to walk through the environment of the closure and substitute the variables in the <code>Term</code> (sounds inefficient)? Do I need renaming for this?</p>\n\n<p>EDIT:\nActual code:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Term = Var String | Abs String Term | App Term Term deriving (Show)\ndata Clos = Clos String Term Env deriving (Show)\ntype Env = [(String, Clos)]\ndata Frame = FArg Term Env | FFun Clos deriving (Show)\ndata State = State Term Env [Frame] deriving (Show)\n\nstep :: State -&gt; Maybe State\nstep (State (Var x) env k) = fmap (\\(Clos y b env') -&gt; State (Abs y b) env' k) $ lookup x env\nstep (State (App a b) env k) = return $ State a env (FArg b env : k)\nstep (State (Abs x b) env (FArg t env' : k)) = return $ State t env' (FFun (Clos x b env) : k)\nstep (State (Abs x b) env (FFun (Clos y b' env') : k)) = return $ State b' ((y, Clos x b env) : env') k\nstep _ = Nothing\n\nsteps :: State -&gt; State\nsteps st = maybe st steps (step st)\n\nz = Abs \"f\" $ Abs \"x\" $ Var \"x\"\ns = Abs \"n\" $ Abs \"f\" $ Abs \"x\" $ App (Var \"f\") $ App (App (Var \"n\") (Var \"f\")) (Var \"x\")\nterm = App s z\nresult = steps $ State term [] []\nmain = putStrLn $ show result\n</code></pre>\n\n<p>Results in:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>State (Abs \"f\" (Abs \"x\" (App (Var \"f\") (App (App (Var \"n\") (Var \"f\")) (Var \"x\"))))) [(\"n\",Clos \"f\" (Abs \"x\" (Var \"x\")) [])] []\n</code></pre>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 2, "creation_date": 1554126659, "post_id": 55456582, "comment_id": 97626592, "body": "I&#39;m not sure I understand what you want it to do, you should always include sample inputs and outputs. However try to use concatMap instead of map, if it is what you need I&#39;ll add it as an answer"}, {"owner": {"reputation": 11, "user_id": 9237400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d613a910ad7f360cc41f98e2c3ad64f?s=128&d=identicon&r=PG&f=1", "display_name": "Nordine MacAlistair Ritchie", "link": "https://stackoverflow.com/users/9237400/nordine-macalistair-ritchie"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1554126847, "post_id": 55456582, "comment_id": 97626714, "body": "You&#39;ve understand perfectly, that was that. I&#39;ve tried concatMap instead of map and it works ! thank you"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554128225, "post_id": 55456582, "comment_id": 97627483, "body": "<code>treemap</code> doesn&#39;t need to handle a leaf node specially; <code>map (treemap f) [] == []</code>."}, {"owner": {"reputation": 11, "user_id": 9237400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d613a910ad7f360cc41f98e2c3ad64f?s=128&d=identicon&r=PG&f=1", "display_name": "Nordine MacAlistair Ritchie", "link": "https://stackoverflow.com/users/9237400/nordine-macalistair-ritchie"}, "edited": false, "score": 0, "creation_date": 1554130434, "post_id": 55456582, "comment_id": 97628807, "body": "yes, you&#39;re right"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9237400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d613a910ad7f360cc41f98e2c3ad64f?s=128&d=identicon&r=PG&f=1", "display_name": "Nordine MacAlistair Ritchie", "link": "https://stackoverflow.com/users/9237400/nordine-macalistair-ritchie"}, "edited": false, "score": 0, "creation_date": 1554127553, "post_id": 55456955, "comment_id": 97627114, "body": "yes, at one point I tried to add (++) operator before the map function but it didn&#39;t work. Now I understand my errors. Thanks again"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 4, "last_activity_date": 1554127160, "creation_date": 1554127160, "answer_id": 55456955, "question_id": 55456582, "link": "https://stackoverflow.com/questions/55456582/how-to-fix-the-errors-about-return-subtrees-from-the-depth-given-in-parameter/55456955#55456955", "title": "How to fix the errors about return subtrees from the depth given in parameter", "body": "<p>Still don't quite understand what you need, so here is a very ad-hoc solution.</p>\n\n<p>Looking at your error, it is clear that you have the common problem <code>[a]</code> vs <code>[[a]]</code>.\nWhen you look at the type signature <code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code> you see that your function has to take an <code>[a]</code> and return a simple <code>[b]</code>, not <code>[[b]]</code>, as this then needs to be mapped over again. However, your <code>extForest</code> returns a list of forests, so what you should do, is to concatenate them: <code>concat . map</code>. Turns out this is a common thing, and there's a Prelude function to do this: <code>concatMap :: Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 9237400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d613a910ad7f360cc41f98e2c3ad64f?s=128&d=identicon&r=PG&f=1", "display_name": "Nordine MacAlistair Ritchie", "link": "https://stackoverflow.com/users/9237400/nordine-macalistair-ritchie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 55456955, "answer_count": 1, "score": 0, "last_activity_date": 1554127160, "creation_date": 1554126090, "question_id": 55456582, "link": "https://stackoverflow.com/questions/55456582/how-to-fix-the-errors-about-return-subtrees-from-the-depth-given-in-parameter", "title": "How to fix the errors about return subtrees from the depth given in parameter", "body": "<p>I want to return the list of all the subtrees of the initial tree with the depth given in parameter </p>\n\n<p>I've tried to return the list of the tree when the depth is 0 and when depth matching with n, I want to decrement n and apply the map function using my function and the n parameter decremented to the list of subtrees</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Tree t = Node t [Tree t] deriving (Show, Eq)\n\nexTree :: Tree Int\nexTree = Node 1 [ Node 2 [], Node 3 [ Node 4 [], Node 5 [],Node 6 []]]\n\nheight :: Tree t -&gt; Int\nheight (Node _ []) = 1\nheight (Node _ l) = 1 + maximum (map height l)\n\ntreemap :: (t-&gt;t) -&gt; Tree t -&gt; Tree t\ntreemap f (Node x []) = Node (f x) []\ntreemap f (Node x l) = Node (f x) (map (treemap f) l)\n\n-- Here is the function concerned:\n\nextrForest :: Int -&gt; Tree t -&gt; [Tree t]\nextrForest 0 a = [a]\nextrForest n (Node _ l) = map (extrForest (n-1)) l\n</code></pre>\n\n<p>Here is the error message:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\nCouldn't match type \u2018[Tree t]\u2019 with \u2018Tree t\u2019\n    Expected type: Tree t -&gt; Tree t\n      Actual type: Tree t -&gt; [Tree t]\n    Relevant bindings include\n      l :: [Tree t] (bound at ds2.hs:16:22)\n      extrForest :: Int -&gt; Tree t -&gt; [Tree t] (bound at ds2.hs:15:1)\n    In the first argument of \u2018map\u2019, namely \u2018(extrForest (n - 1))\u2019\n    In the expression: map (extrForest (n - 1)) l\n\n</code></pre>\n"}, {"tags": ["haskell", "stack", "undo", "redo"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1554115173, "post_id": 55453022, "comment_id": 97619959, "body": "this is a classic use case for the State monad, which you can find lots of references for online. Eg. here in <a href=\"http://learnyouahaskell.com/for-a-few-monads-more#state\" rel=\"nofollow noreferrer\">LYAH</a> for a very gentle introduction (there&#39;s even an exxample of modelling a stack with <code>push</code> and <code>pop</code> methods, like yours). You need to understand the basics of monads first though."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554115179, "post_id": 55453022, "comment_id": 97619962, "body": "What&#39;s the difference between creating a new stack with changes and throwing away the old one, vs. changing the old one? Lookup mutable vs immutable data structures. You may still want help here, in which case you should provide more detail about the precise problem you&#39;re encountering (eg. a function that you can&#39;t make it do exactly what you want). In general though - try just creating a new one! It won&#39;t hurt (trust me)~"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1554115398, "post_id": 55453022, "comment_id": 97620064, "body": "To expand on my comment and link it to that of @ATayler - you can certainly do it his way, but it can get quite tedious manually writing the code to thread the state through every function you write. And this is what the State monad is for, it just allows you to write clearer code by hiding all that boilerplate &quot;under the hood&quot; (in the implementation of the State monad itself). It doesn&#39;t do any &quot;magic&quot; that you can&#39;t do without it."}, {"owner": {"reputation": 439, "user_id": 3965984, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ebd308b6c18a49e01cbb39c2a6fce145?s=128&d=identicon&r=PG&f=1", "display_name": "InfinityLoop", "link": "https://stackoverflow.com/users/3965984/infinityloop"}, "edited": false, "score": 0, "creation_date": 1554115509, "post_id": 55453022, "comment_id": 97620130, "body": "Ah nice one, I&#39;ll take a look. Thanks!"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 5, "creation_date": 1554116543, "post_id": 55453022, "comment_id": 97620726, "body": "Robin is totally right - just personally I find a good way to learn about eg. the state monad is to go through the rigmarole of writing the boilerplate yourself a few times before wondering, &quot;is there a way to abstract cleanly over all this?&quot; And only then can you appreciate the beauty of the solution! (YMMV)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1554128452, "post_id": 55453022, "comment_id": 97627623, "body": "Also, note that there is a difference between <i>you</i> duplicating a stack and the <i>compiler</i> actually copying a data structure in memory. <i>Because</i> values are immutable, the compiler can let <code>Stack xs</code> and <code>Stack (x:xs)</code> both share a reference to <code>xs</code> behind the scenes."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 7, "last_activity_date": 1554131542, "last_edit_date": 1554131542, "creation_date": 1554129721, "answer_id": 55457780, "question_id": 55453022, "link": "https://stackoverflow.com/questions/55453022/implement-undo-and-redo-functions-using-a-stack-how-to-edit-a-stack-without-hav/55457780#55457780", "title": "Implement undo and redo functions using a stack. How to edit a stack without having to recreate it in Haskell", "body": "<blockquote>\n  <p>how do you create a stack as a structure without duplicating it?</p>\n</blockquote>\n\n<p>The code you have presented is fine and will not duplicate much data.</p>\n\n<p>Let's say you have a current stack of <code>stack1 = a - b - c - d - e</code>.  And now you <code>pop stack1</code> with the code:</p>\n\n<pre><code>pop (Stack (x:xs)) = (Just x, Stack xs)\n</code></pre>\n\n<p>You will return a new stack <code>stack2 = b - c - d - e</code> which is just the entire structure after the <code>a</code> and nothing is copied.  If you keep stack1 around then you'd have two structures that look something like this:</p>\n\n<pre><code> stack1 -&gt; a - b - c - d - e\n               ^\n               |\n             stack2\n</code></pre>\n\n<p>Bear in mind the singly linked list you're using means <code>a</code> is not part of <code>stack2</code>.  If <code>stack1</code> is garbage collected then you'll end up with <code>stack2 = b -  c - d - e</code> as you'd expect.</p>\n\n<p>Now let's say you <code>push z stack2</code> yielding <code>stack3 = z - b - c - d - e</code>.  If <code>stack1</code> and <code>stack2</code> are still live then the heap would look something like:</p>\n\n<pre><code>     stack3 -&gt; z\n               |\n stack1 -&gt; a - b - c - d - e\n               ^\n               |\n             stack2\n</code></pre>\n"}], "owner": {"reputation": 439, "user_id": 3965984, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ebd308b6c18a49e01cbb39c2a6fce145?s=128&d=identicon&r=PG&f=1", "display_name": "InfinityLoop", "link": "https://stackoverflow.com/users/3965984/infinityloop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 55457780, "answer_count": 1, "score": 2, "last_activity_date": 1554724370, "creation_date": 1554114649, "last_edit_date": 1554724370, "question_id": 55453022, "link": "https://stackoverflow.com/questions/55453022/implement-undo-and-redo-functions-using-a-stack-how-to-edit-a-stack-without-hav", "title": "Implement undo and redo functions using a stack. How to edit a stack without having to recreate it in Haskell", "body": "<p>I have a custom datatype called TextFile which stores four strings and I need to be able to store a version of it in a stack each time the text file is edited. This is so that I can implement some form of Undo and redo function. </p>\n\n<p>However, the stack will be updated from within other functions and without creating a new stack each time, I can't see a way to save the changes when I push something to it? </p>\n\n<p>Is there a way that I could create a stack and update that same stack each time something is pushed or popped from it? </p>\n\n<pre><code>newtype Stack a = Stack [a] deriving (Eq, Show)\nbuffer = Stack [] :: Stack TextFile\n\ndata TextFile = TextFile String String String String deriving Show\nfile = TextFile \"This is the left element\" \" This is the right element\" \"\" \"\"\n\npop :: Stack a -&gt; (Maybe a, Stack a)\npop (Stack (x:xs)) = (Just x, Stack xs)\npop (Stack []) = (Nothing, Stack [])\n\npush :: a -&gt; Stack a -&gt; Stack a\npush x (Stack xs) = Stack (x:xs)\n</code></pre>\n\n<p>To clarify, my main question is if you can't change a variable's value in Haskell, how do you create a stack as a structure without duplicating it?</p>\n"}, {"tags": ["haskell", "functional-programming", "arrows"], "answers": [{"tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": false, "score": 0, "last_activity_date": 1554125831, "last_edit_date": 1554125831, "creation_date": 1554114108, "answer_id": 55452848, "question_id": 55451420, "link": "https://stackoverflow.com/questions/55451420/understanding-space-leak-with-arrow/55452848#55452848", "title": "Understanding space leak with Arrow", "body": "<p>I have only glanced at the paper briefly, but will do my best.</p>\n\n<ol>\n<li><p>As usual, space complexity means than at some point in time we need to be storing that much \"stuff\" simultaneously in memory. GC says we can recover memory from variables we no longer need, but here we need to be remembering <code>O(n)</code> stuff, the memory can't be recovered yet because we (may) still need access to any part of it. You can think of it as, reusing memory (via eg. GC) adds to time but not space complexity. Here, <code>n</code> is computing the nth value by providing n time steps (dts).</p></li>\n<li><p>If <code>dt</code> is constant, then instead of the type of <code>C a = (a, dt -&gt; C a)</code> we have <code>C' a = (a, C' a)</code> which is just a (nonempty) list. The point of the paper is that either type can be made to run in constant space, but if it were isomorphic to lists then that's a solved problem. To see why creating a new value at each step can be constant memory, consider a possible evaluation of <code>(iterate f)!!n</code>, where we store just x, then overwrite it with <code>f (x)</code>, then overwrite it with <code>f (f (x))</code>, and so on until we have <code>f^n(x)</code>, but only ever using this one cell of memory for our values (and technically a second cell to iterate up to <code>n</code>). </p></li>\n<li><p>Let's consider a really simple example of evaluation giving these different complexities. Let's say we're generating a list from some seed where each item is the sum of all the previous items. To calculate each next item, we could hold the entirety of the initial part p of the list in memory (<code>O(Len(p))</code>) and sum it (<code>O(Len(p))</code>), resulting in total memory <code>O(n)</code> and run time <code>O(n^2) to retrieve the</code>n`th element - or we could observe that this is in fact the same as doubling the previous item, allowing us to use constant memory and linear time. I think the analogy section given is quite helpful - can you mechanically write out successors for the first few values and see how the two different evaluation strategies rapidly diverge in steps needed?</p></li>\n</ol>\n"}], "owner": {"reputation": 69, "user_id": 10356681, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TzEOGltC0GM/AAAAAAAAAAI/AAAAAAAAAEw/dRYmOMhphAc/photo.jpg?sz=128", "display_name": "Jun Xu", "link": "https://stackoverflow.com/users/10356681/jun-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1554125831, "creation_date": 1554109240, "question_id": 55451420, "link": "https://stackoverflow.com/questions/55451420/understanding-space-leak-with-arrow", "title": "Understanding space leak with Arrow", "body": "<p>I am having difficulty understanding the space leak in Hudak's paper \"plugging a space leak with arrow\"\n<a href=\"https://www.sciencedirect.com/science/article/pii/S1571066107005919\" rel=\"nofollow noreferrer\">https://www.sciencedirect.com/science/article/pii/S1571066107005919</a>.</p>\n\n<p>1) What exactly does O(n) space complexity mean? The total memory allocated with respect to input size? What about garbage collection along the way?</p>\n\n<p>2) If the definition in 1) holds, how is it that in page 34, they say if dt is constant, the signal type is akin to list type and runs in constant space? Doesn't integralC still create 1 unit of space at each step, totally n units, that is, still O(n)?</p>\n\n<p>3) I totally do not understand why time complexity is O(n^2). I do have an inkling of what needs to be evaluated (i', i'', i''' in picture below), but how is that O(n^2)? </p>\n\n<p>The image represents the evaluation steps I have drawn in lambda graph notation. Each step sees its structure ADDED to the overall scope rather than REPLACING whatever is in it. Square denotes pointer, so square(i') in step 2 denotes i' block in step 1 for example. </p>\n\n<p><a href=\"https://i.stack.imgur.com/hm4Yb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hm4Yb.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["haskell", "arrows", "newtype"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554098841, "post_id": 55448666, "comment_id": 97612258, "body": "I think it&#39;ll have something to do with data giving a lazy value constructor, newtype being strict. See for example Rose&#39;s answer to <a href=\"https://stackoverflow.com/questions/2649305/why-is-there-data-and-newtype-in-haskell\" title=\"why is there data and newtype in haskell\">stackoverflow.com/questions/2649305/&hellip;</a> . Perhaps someone more familiar could work through the code and give a more precise answer."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554101472, "post_id": 55449175, "comment_id": 97613241, "body": "You&#39;re probably talking about <a href=\"http://homepages.inf.ed.ac.uk/wadler/topics/garbage-collection.html\" rel=\"nofollow noreferrer\">homepages.inf.ed.ac.uk/wadler/topics/garbage-collection.html</a>"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1554110269, "post_id": 55449175, "comment_id": 97617395, "body": "Yes, that\u2019s problem with lazy match.  The solution was invented before Phil\u2019s paper, but not published."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1554155319, "post_id": 55449175, "comment_id": 97640179, "body": "@augustss, are you sure GHC uses that later approach? I&#39;m pretty sure it doesn&#39;t, for some performance reason or other. There is a special &quot;selector thunk&quot; heap object type that the garbage collector handles specially."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1554173615, "post_id": 55449175, "comment_id": 97644088, "body": "No, I\u2019m not sure.  I think the non-gc method is better, but maybe ghc didn\u2019t use it in the end."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 12, "last_activity_date": 1554186829, "last_edit_date": 1554186829, "creation_date": 1554100093, "answer_id": 55449175, "question_id": 55448666, "link": "https://stackoverflow.com/questions/55448666/why-data-cause-an-infinite-loop-while-newtype-not/55449175#55449175", "title": "Why `data` cause an infinite loop while `newtype` not", "body": "<p>Let's look at this example.</p>\n\n<pre><code>data A = A [Int]\n    deriving (Show)\n\ncons :: Int -&gt; A -&gt; A\ncons x (A xs) = A (x:xs)\n\nones :: A\nones = cons 1 ones\n</code></pre>\n\n<p>We would expect that <code>ones</code> should be <code>A [1,1,1,1...]</code>, because all we have done is wrap a list in a <code>data</code> constructor.  But we would be wrong.  Recall that <em>pattern matches are strict</em> for <code>data</code> constructors.  That is, <code>cons 1 undefined = undefined</code> rather than <code>A (1 : undefined)</code>.  So when we try to evaluate <code>ones</code>, <code>cons</code> pattern matches on its second argument, which causes us to evaluate <code>ones</code>... we have a problem.</p>\n\n<p><code>newtype</code>s don't do this.  At runtime <code>newtype</code> constructors are invisible, so it's as if we had written the equivalent program on plain lists</p>\n\n<pre><code>cons :: Int -&gt; [Int] -&gt; [Int]\ncons x ys = x:ys\n\nones = cons 1 ones\n</code></pre>\n\n<p>which is perfectly productive, since when we try to evaluate <code>ones</code>, there is a <code>:</code> constructor between us and the next evaluation of <code>ones</code>.</p>\n\n<p>You can get back the <code>newtype</code> semantics by making your data constructor pattern matches lazy:</p>\n\n<pre><code>cons x ~(A xs) = A (x:xs)\n</code></pre>\n\n<p>This is the problem with your code (I have run into this exact problem doing this exact thing).  There are a few reasons <code>data</code> pattern matches are strict by default; the most compelling one I see is that pattern matching would otherwise be impossible if the type had more than one constructor. There is also a small runtime overhead to lazy pattern matching in order to fix some subtle GC leaks; details linked in the comments.</p>\n"}], "owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 55449175, "answer_count": 1, "score": 9, "last_activity_date": 1554186829, "creation_date": 1554097205, "last_edit_date": 1554098425, "question_id": 55448666, "link": "https://stackoverflow.com/questions/55448666/why-data-cause-an-infinite-loop-while-newtype-not", "title": "Why `data` cause an infinite loop while `newtype` not", "body": "<p>I am learning <code>Arrow</code> following the tutorial <a href=\"http://www.cse.chalmers.se/~rjmh/afp-arrows.pdf\" rel=\"noreferrer\">programming with arrows</a>. I've typed the following code according to the paper except that the <code>SF</code> is defined by <code>data</code>, not by <code>newtype</code> as in the paper (<em>actually, I made this change by chance, since I typed the code from memory</em>):</p>\n\n<pre><code>import Control.Category\nimport Control.Arrow\nimport Prelude hiding (id, (.))\n\ndata SF a b = SF { runSF :: [a] -&gt; [b] }  -- this is the change, using data instead of newtype as in the paper \n\n-- The folowing code is the same as in the paper\ninstance Category SF where\n  id = SF $ \\x -&gt; x\n  (SF f) . (SF g) = SF $ \\x -&gt; f (g x)\n\ninstance Arrow SF where\n  arr f = SF $ map f\n  first (SF f) = SF $ unzip &gt;&gt;&gt; first f &gt;&gt;&gt; uncurry zip\n\ninstance ArrowChoice SF where\n  left (SF f) = SF $ \\xs -&gt; combine xs (f [y | Left y &lt;- xs])\n    where\n      combine (Left _ : ys) (z:zs) = Left z : combine ys zs\n      combine (Right y : ys) zs = Right y : combine ys zs\n      combine [] _ = []\n\ndelay :: a -&gt; SF a a\ndelay x = SF $ init . (x:)\n\nmapA :: ArrowChoice a =&gt; a b c -&gt; a [b] [c]\nmapA f = arr listcase &gt;&gt;&gt;\n         arr (const []) ||| (f *** mapA f &gt;&gt;&gt; arr (uncurry (:)))\n\nlistcase :: [a] -&gt; Either () (a, [a])\nlistcase [] = Left ()\nlistcase (x:xs) = Right (x, xs)\n</code></pre>\n\n<p>When I load the file in <code>ghci</code> and execute <code>runSF (mapA (delay 0)) [[1,2,3],[4,5,6]]</code>, it triggers an infinit loop and runs out of memory finally. If I change <code>data</code> back to <code>newtype</code>, everything is OK. The same problem happens in ghc 8.0.2, 8.2.2 and 8.6.3. </p>\n\n<p>The same problem also exists even I compile the code into an executable.</p>\n\n<p>I have thought the difference between <code>data</code> and <code>newtype</code>, when defining a data structure with only one field, is the runtime cost. But this problem seems to imply more difference between them. Or there may be something that I haven't noticed about the <code>Arrow</code> type-class.</p>\n\n<p>Can anyone have any ideas? Thanks very much!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 5, "creation_date": 1554082693, "post_id": 55447072, "comment_id": 97608929, "body": "What if it&#39;s <code>Nothing</code> there?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1554083176, "post_id": 55447072, "comment_id": 97609021, "body": "Hint: use a <code>case</code> statement. Or, write a new function that pattern-matches."}, {"owner": {"reputation": 35, "user_id": 6825049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9852e926d11812934acfd1cb9f8b968?s=128&d=identicon&r=PG&f=1", "display_name": "Mingo Pan", "link": "https://stackoverflow.com/users/6825049/mingo-pan"}, "edited": false, "score": 0, "creation_date": 1554084410, "post_id": 55447072, "comment_id": 97609194, "body": "Is there any way to remove the  Maybe wrapper if  we are sure that there is value  in that variable? In my project, another function that take the [Pitch] as input rather than [Maybe Pitch]."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1554085623, "post_id": 55447072, "comment_id": 97609412, "body": "@MingoPan You can&#39;t just remove it, because it might be a <code>Nothing</code> - <code>Maybe</code> is more than just a wrapper! You need monads. Have you read Learn You A Haskell?"}, {"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1554085734, "post_id": 55447072, "comment_id": 97609432, "body": "@MingoPan you can &quot;remove&quot; it by using the fromJust method in Data.Maybe.  However, this is not a total function and it will throw an error if you feed it a Nothing."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1554086291, "post_id": 55447072, "comment_id": 97609536, "body": "If you are sure that it is a Just then you should improve your code and return the <code>Pitch</code> instead of a <code>Maybe Pitch</code> at that point."}, {"owner": {"reputation": 35, "user_id": 6825049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9852e926d11812934acfd1cb9f8b968?s=128&d=identicon&r=PG&f=1", "display_name": "Mingo Pan", "link": "https://stackoverflow.com/users/6825049/mingo-pan"}, "edited": false, "score": 0, "creation_date": 1554087085, "post_id": 55447072, "comment_id": 97609701, "body": "Yeah, I got that, thank you guys!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1554087587, "post_id": 55447072, "comment_id": 97609776, "body": "@AJFarmar Why did you delete your answer? It&#39;s exactly the answer I wanted to write after reading the question."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1554090187, "post_id": 55447072, "comment_id": 97610275, "body": "@DanielWagner I realised that the main problem was that the asker was <code>show</code>ing a <code>Maybe Pitch</code>, not that they had written <code>show</code> incorrectly. If you truly think it&#39;s useful, I&#39;ll reinstate it."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1554091876, "post_id": 55447072, "comment_id": 97610559, "body": "@AJFarmar Ah, of course! I would have written the exact same wrong answer. =P"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1554123344, "post_id": 55447072, "comment_id": 97624522, "body": "I&#39;m not sure when <code>show (toPitch &quot;A2&quot;) ==&gt; &quot;A2&quot;</code> would be of more interest than <code>show &lt;$&gt; (toPitch &quot;A2&quot;) ==&gt; Just &quot;A2&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1554134445, "last_edit_date": 1554134445, "creation_date": 1554123745, "answer_id": 55455801, "question_id": 55447072, "link": "https://stackoverflow.com/questions/55447072/how-to-delete-the-just-in-customized-haskell-show-function/55455801#55455801", "title": "How to delete the &quot;Just&quot; in customized haskell show function", "body": "<p>I don't think a string representation of the <code>Maybe Pitch</code> value is what you really want. Instead, you want a <code>Maybe String</code> value, indicating that <em>if</em> you really have a <code>Pitch</code> value, you can get a <code>String</code> representation, but if you have <code>Nothing</code>, you still get <code>Nothing</code>. This just means a use of the <code>Functor</code> instance for <code>Maybe</code>.</p>\n\n<p>This means moving your logic into the <code>Show</code> instance for <code>Pitch</code>:</p>\n\n<pre><code>instance Show Pitch where\n    show pitch = note pitch : intToDigit (octave pitch) : \"\"\n</code></pre>\n\n<p>You typically aren't interested in a value of <code>Maybe Pitch</code> itself; you are interested in the <code>Pitch</code> value that you <em>might</em> be able to extract from it. That means you usually just want to lift <code>show</code> to get a <code>Maybe String</code> value.</p>\n\n<pre><code>&gt;&gt;&gt; show (Pitch 'A' 2)\n\"A2\"\n&gt;&gt;&gt; toPitch \"A2\"\nJust (Pitch 'A' 2)\n&gt;&gt;&gt; fmap show (toPitch \"A2\")\nJust \"A2\"  -- not \"Just A2\"\n</code></pre>\n\n<hr>\n\n<p>To be clear, if <code>toPitch</code> returns <code>Nothing</code>, that's somewhat of a show stopper: it's not obvious that there's a suitable default value to use instead. Using <code>Maybe Pitch</code> instead of a partial function like</p>\n\n<pre><code>toPitch :: String -&gt; Pitch\ntoPitch str \n    | strlen == 2 &amp;&amp; (note &gt;= 'A' &amp;&amp; note &lt;= 'G') \n           &amp;&amp; (octave &gt;= 1 &amp;&amp; octave &lt;= 3) = Pitch note octave\n    where \n        strlen = length str\n        note   = head str\n        octave = digitToInt (str!!1)\n</code></pre>\n\n<p>simply forces the rest of your code to accommodate the possibility of failure in a graceful fashion, rather than just crashing with a run-time error when <code>toPitch</code> fails to return a value of type <code>Pitch</code>.</p>\n\n<hr>\n\n<p>You might also want to use a parser library to implement <code>toPitch</code>. For example</p>\n\n<pre><code>import Text.Parsec\n\ntoPitch :: String -&gt; Either ParseError Pitch\ntoPitch str = parse pitchParser \"\" str\n    where pitchParser = do\n            note &lt;- oneOf \"ABCDEFG\"\n            octave &lt;- satisfy (`elem` \"123\")\n            return $ Pitch note (digitToInt octave)\n</code></pre>\n\n<p>The parsing process is a little more straightforward, and you'll get something (slightly) more descriptive than <code>Nothing</code> in the event of a parser failure.</p>\n"}], "owner": {"reputation": 35, "user_id": 6825049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9852e926d11812934acfd1cb9f8b968?s=128&d=identicon&r=PG&f=1", "display_name": "Mingo Pan", "link": "https://stackoverflow.com/users/6825049/mingo-pan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "accepted_answer_id": 55455801, "answer_count": 1, "score": 0, "last_activity_date": 1554134445, "creation_date": 1554082490, "question_id": 55447072, "link": "https://stackoverflow.com/questions/55447072/how-to-delete-the-just-in-customized-haskell-show-function", "title": "How to delete the &quot;Just&quot; in customized haskell show function", "body": "<p>I have a custome data structure called pitch with 2 variables note and octave. I need to convert a string to a pitch, so that I wrote a function that takes a String as input and Maybe Pitch as return value since there might be some invalid input. Then I customized my show function, when I tested it in ghci, it showed \"Just A2\" (A2 is the pitch value). Here is my code:</p>\n\n<pre><code>data Pitch     = Pitch { note :: Char, octave :: Int }deriving (Eq)\n\ntoPitch :: String -&gt; Maybe Pitch\ntoPitch str \n    | strlen == 2 &amp;&amp; (note &gt;= 'A' &amp;&amp; note &lt;= 'G') \n           &amp;&amp; (octave &gt;= 1 &amp;&amp; octave &lt;= 3) = Just (Pitch note octave)\n    | otherwise = Nothing\n    where \n        strlen = length str\n        note   = head str\n        octave = digitToInt (str!!1)\n\ntoString :: Maybe Pitch -&gt; String\ntoString (Just pitch) = [note pitch] ++ [(intToDigit (octave pitch))] \n\ninstance Show Pitch where\n    show pitch = toString (Just pitch)\n</code></pre>\n\n<p>And below is the test result:</p>\n\n<pre><code>*Main&gt; let pitch = toPitch \"A2\"\n*Main&gt; show pitch\n\"Just A2\"\n*Main&gt; \n</code></pre>\n\n<p>Can someone tell me how to remove that Just in the show function? Much appreciated!</p>\n"}, {"tags": ["haskell", "record", "algebraic-data-types"], "answers": [{"comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 1, "creation_date": 1554057987, "post_id": 55444075, "comment_id": 97603838, "body": "Great answer, I would&#39;ve never thought of it. However the prefixes are there because I didn&#39;t want to pollute the global namespace with things like <code>size</code> or <code>time</code> which I&#39;ll probably need for something else. Any simple solution for this?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 3, "creation_date": 1554059919, "post_id": 55444075, "comment_id": 97604325, "body": "@Lorenzo If you don&#39;t want to pollute the namespace, you either need prefixes (as you did) or to define them in a separate module and then <code>import qualified MyModule as M</code> and then use <code>M.field</code>. The latter is not terribly convenient, I think it&#39;s OK if one has a lot of types to add in the module."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554062545, "post_id": 55444075, "comment_id": 97605007, "body": "I&#39;d make the sum type&#39;s constructors strict. If the type is really performance critical, you might want to use <code>{-# UNPACK #-}</code>."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1554066230, "post_id": 55444075, "comment_id": 97605950, "body": "What about introducing support by <code>data Shared = Shared {     steps :: Step,   time :: Float, coords :: Coords}</code>?"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554071736, "post_id": 55444075, "comment_id": 97607095, "body": "@dfeuer I tried to look it up but don&#39;t seem to fully understand the benefits. Also one of the records is an infinite list so that can&#39;t be strict?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 1, "creation_date": 1554072873, "post_id": 55444075, "comment_id": 97607329, "body": "@Lorenzo, making it strict: <code>data Element = SunElement !Sun | CloudElement !Cloud</code>. That means that to produce an <code>Element</code> you need to have a <code>Sun</code> or <code>Cloud</code>, rather than just a thunk that will evaluate one. The semantics are then identical to your original type, rather than lazier, and you&#39;re less likely to leak memory. Unpacking: <code>data Element = SunElement {-# UNPACK #-} !Sun | CloudElement {-# UNPACK #-} !Cloud</code>. This unpacks the record into the sum type constructor, instead of having a pointer to it. This is exactly the same, operationally, as your original version. (cont)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1554072943, "post_id": 55444075, "comment_id": 97607346, "body": "(cont) Unless you&#39;re extracting the records and storing them, unpacking will likely improve efficiency a bit by reducing allocation and avoiding indirection. But you probably don&#39;t need to worry about it unless performance is critical."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1554126288, "post_id": 55444075, "comment_id": 97626356, "body": "I&#39;m not sure if the reference to <code>DuplicateRecordFields</code> is super helpful, given that there&#39;s no convenient way to actually <i>use</i> both field names in the same scope."}], "tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": true, "score": 9, "last_activity_date": 1554056869, "creation_date": 1554056869, "answer_id": 55444075, "question_id": 55443997, "link": "https://stackoverflow.com/questions/55443997/alternative-to-algebraic-data-type-with-lots-of-constructors-in-record-syntax/55444075#55444075", "title": "Alternative to algebraic data type with lots of constructors in record syntax", "body": "<p>Isolate the things into their own datatypes and have <code>Element</code> be a sum of them:</p>\n\n<pre><code>data Sun = Sun {\n  colorStart :: Color,\n  colorEnd :: Color,\n  coords :: Coords,\n  period :: Float,\n  size :: Float,\n  steps :: Step,\n  time :: Float\n}\n\ndata Cloud = Cloud {\n  kind :: CloudKind,\n  colorMain :: Color,\n  coords :: Coords,\n  rans :: [Float],\n  size :: Size',\n  steps :: Step,\n  time :: Float\n}\n\ndata Element = SunElement Sun | CloudElement Cloud\n</code></pre>\n\n<p>Now you can have dedicated APIs for things in isolation as much as all the good things that come with separation of concerns.</p>\n\n<p>Oh and BTW, I've dropped the prefixes on field names, since now we have the <code>DuplicateRecordFields</code> extension.</p>\n\n<p>BTW, you'll find <a href=\"https://stackoverflow.com/q/23955613/485115\">this question</a> useful.</p>\n"}, {"tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": false, "score": 1, "last_activity_date": 1554111425, "creation_date": 1554111425, "answer_id": 55452042, "question_id": 55443997, "link": "https://stackoverflow.com/questions/55443997/alternative-to-algebraic-data-type-with-lots-of-constructors-in-record-syntax/55452042#55452042", "title": "Alternative to algebraic data type with lots of constructors in record syntax", "body": "<p>A twist on Nikita's answer is to use an ADT called <code>Shared</code> holding fields found in both <code>Sun</code> and <code>Cloud</code>. If you want you can compare this to inheritance from OO. </p>\n\n<pre><code>data Shared = Shared {       \n  coords :: Coords,     \n  steps :: Step,\n  time :: Float\n}\n\ndata Sun = Sun {\n  colorStart :: Color,\n  colorEnd :: Color,\n  period :: Float,\n  size :: Float,\n  shared :: Shared\n}\n\ndata Cloud = Cloud {\n  kind :: CloudKind,\n  colorMain :: Color, \n  rans :: [Float],\n  size :: Size',\n  shared :: Shared\n}\n\ndata Element = SunElement Sun | CloudElement Cloud\n</code></pre>\n"}], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 55444075, "answer_count": 2, "score": 2, "last_activity_date": 1554111425, "creation_date": 1554056391, "last_edit_date": 1554061400, "question_id": 55443997, "link": "https://stackoverflow.com/questions/55443997/alternative-to-algebraic-data-type-with-lots-of-constructors-in-record-syntax", "title": "Alternative to algebraic data type with lots of constructors in record syntax", "body": "<p>I have a custom data type to contain elements of a landscape (cloud, sun, mountain, etc). I need to have a list of them, so I can't use different types and a common typeclass.</p>\n\n<p>They share most of the fields in the constructor, however some have properties that other don't (for example, if the cloud is raining or not).</p>\n\n<p>As of now, I have one data type with different constructors:</p>\n\n<pre><code>data Element = Sun {\n  elemColorStart :: Color,\n  elemColorEnd :: Color,\n  elemCoords :: Coords,\n  elemPeriod :: Float,\n  elemSize :: Float,\n  elemSteps :: Step,\n  elemTime :: Float\n}\n| Cloud {\n  elemKind :: CloudKind,\n  elemColorMain :: Color,\n  elemCoords :: Coords,\n  elemRans :: [Float],\n  elemSize' :: Size',\n  elemSteps :: Step,\n  elemTime :: Float\n}\n... etc\n</code></pre>\n\n<p>Alternatively I could have a common constructor with all the possible properties, and just not initialise them if theyre not needed, though this looks even worse.</p>\n\n<p>This does not look very \"Haskelly\", and in fact this approach in general is quite object oriented. <strong>What am I doing wrong?</strong> Any other possible approach would be welcome; it is not an assignment so I don't really have any constraints.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 3, "creation_date": 1554042539, "post_id": 55441901, "comment_id": 97599684, "body": "<a href=\"https://hackage.haskell.org/package/criterion\" rel=\"nofollow noreferrer\">criterion</a> package is often used for this, also GHC has some support for this: <a href=\"https://ghc.gitlab.haskell.org/ghc/doc/users_guide/profiling.html\" rel=\"nofollow noreferrer\">manual</a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1554053650, "post_id": 55441901, "comment_id": 97602613, "body": "I find that duplicate link underwhelming.  Do not benchmark in ghci. Never  benchmark without using the optimizations you intend when running the code in production (compiling with -O2 presumably).  I suggest using criterion such as shown here <a href=\"https://stackoverflow.com/questions/4033103/type-error-using-criterion/4034701#4034701\" title=\"type error using criterion\">stackoverflow.com/questions/4033103/type-error-using-criteri&zwnj;&#8203;on/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 6, "creation_date": 1554043946, "post_id": 55441933, "comment_id": 97600073, "body": "Note however that GHCi disables a lot of optimizations. For serious benchmarks, one really need to compile with <code>-O</code> and run the executable. For <code>print (product (replicate 10000000 (1 :: Int)))</code>, I get 2.44s in GHCi and 0.13s after compiling."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1554044388, "post_id": 55441933, "comment_id": 97600207, "body": "@chi ...and with <code>-O2 -fllvm</code> it becomes 0.00s!"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1554053705, "post_id": 55441933, "comment_id": 97602636, "body": "I strongly discourage anyone consider performance when using GHCi.  When you are concerned about performance be sure you compile the code, use optimizations, and preferably use a benchmark package like criterion."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1554065427, "post_id": 55441933, "comment_id": 97605733, "body": "Will some types of things be significantly slower/faster relative to GHCi? (Eg. use of ffi is 5x faster, code with lots of newtypes 10x faster, everything else 20x faster) @Thomas"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1554042962, "last_edit_date": 1554042962, "creation_date": 1554042562, "answer_id": 55441933, "question_id": 55441901, "link": "https://stackoverflow.com/questions/55441901/is-there-an-way-to-really-test-the-performance-of-a-haskell-code/55441933#55441933", "title": "Is there an way to really test the performance of a Haskell code?", "body": "<p>Run <code>:set +s</code> in GHCi. You'll then get time and memory allocation after each evaluation, like this:</p>\n\n<pre><code>GHCi, version 8.6.3: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :set +s\nPrelude&gt; product (replicate 10000000 1)\n1\n(1.78 secs, 1,292,363,104 bytes)\nPrelude&gt;\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8108789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g3u7Y.jpg?s=128&g=1", "display_name": "Gustavo Isidio", "link": "https://stackoverflow.com/users/8108789/gustavo-isidio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "closed_date": 1554044138, "accepted_answer_id": 55441933, "answer_count": 1, "score": 2, "last_activity_date": 1554042962, "creation_date": 1554042368, "question_id": 55441901, "link": "https://stackoverflow.com/questions/55441901/is-there-an-way-to-really-test-the-performance-of-a-haskell-code", "closed_reason": "Duplicate", "title": "Is there an way to really test the performance of a Haskell code?", "body": "<p>I would like to compare two different functions to see who has more performance. Maybe there is an tool or ghci command?</p>\n"}, {"tags": ["list", "haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1554042431, "post_id": 55441875, "comment_id": 97599655, "body": "your function just calculates the last element of a single list. That&#39;s a good start (although it already exists in the standard library as <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:last\" rel=\"nofollow noreferrer\">last</a>). But you need to apply this function to every list in the given list of lists. Hint: Haskell has a built-in way to do this for any function."}], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554042666, "post_id": 55441922, "comment_id": 97599716, "body": "While list recursion usually doesn&#39;t need a singleton list case, it does if you want to implement a function to find the last element of a list, which is what the function in the OP does. It&#39;s not clear to me if that was the intention or simply an accident,"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554042896, "post_id": 55441922, "comment_id": 97599782, "body": "@RobinZigmond Good call, but I was just trying to show the most simple but at the same type most generic recursion on lists, so that the OP can try to implement themself as they were quite close already."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554042967, "post_id": 55441922, "comment_id": 97599804, "body": "@RobinZigmond oh I see what you mean, I thought they were already using <code>last</code> and using recursion just to apply it to every element, my bad. Edited now"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 6, "last_activity_date": 1554043108, "last_edit_date": 1592644375, "creation_date": 1554042504, "answer_id": 55441922, "question_id": 55441875, "link": "https://stackoverflow.com/questions/55441875/haskellcreate-list-of-last-elements-of-each-list-in-list/55441922#55441922", "title": "Haskell:create list of last elements of each list in list", "body": "<h1>Problem</h1>\n<p>You are on the right track, the problem is that your code is not recursing. A recursive function on lists is usually of the form</p>\n<pre><code>f :: [a] -&gt; [b]\nf [] = y\nf (x:xs) = y : f xs\n</code></pre>\n<p>After <code>y</code> is evaluated, that result is &quot;<code>:</code>ed&quot; to the recursive call. Now try to make your code so something similar. Also note that you don't need the <code>lastElement [x]</code> case, it's just plain reduntant for the recursion. However, this only applies some function to every element. You will also need a function <code>f :: [a] -&gt; a</code> to get that last element from one single list. Your function as of now does just that, but there is a standard library function for that. Have a look at <a href=\"https://hoogle.haskell.org/?hoogle\" rel=\"nofollow noreferrer\">Hoogle</a>: you can search library functions by type or description</p>\n<h1>Better Alternative</h1>\n<p>In this case, I would use a list comprehension as I think it would be more clear to read. Have a look at that as well</p>\n<h1>Best Alternative</h1>\n<p>Haskell being a functional language, it allows you to think more about what change to need to apply to your data, rather than what steps do you need to achieve. If you know them, you can use higher order function for this. In particular, the function <code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code>. As you can guess from this type definition, <code>map</code> takes a function, and applies it to every element of a list. It looks like you already know the <code>last</code> function, so you can use that:</p>\n<pre><code>lastElements :: [[a]] -&gt; [a]\nlastElements = map last\n</code></pre>\n<p>Look how neat and simple this code is now; no need to think about what the recursion does, you just see that it takes the last element from each list.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 8108789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g3u7Y.jpg?s=128&g=1", "display_name": "Gustavo Isidio", "link": "https://stackoverflow.com/users/8108789/gustavo-isidio"}, "is_accepted": false, "score": 1, "last_activity_date": 1554060088, "creation_date": 1554060088, "answer_id": 55444549, "question_id": 55441875, "link": "https://stackoverflow.com/questions/55441875/haskellcreate-list-of-last-elements-of-each-list-in-list/55444549#55444549", "title": "Haskell:create list of last elements of each list in list", "body": "<p>I will assume that you have beginner skills in Haskell and try to explain better what you are doing wrong.</p>\n\n<pre><code>lastElement :: [[a]] -&gt; [a]\nlastElement [] = error \"error\"\nlastElement [x] = x\nlastElement (x:xs) = lastElement xs\n</code></pre>\n\n<p>In this function, you are receiving a list of elements and returning the last of it. Occurs that those elements are lists too. In that way, applying <code>lastElement [[1,2],[3,4]]</code> will give to you his last element how is the list <code>[3,4]</code>. Since you need to enter a list <code>[x,y,z]</code> in which x y and z are lists and you wanna return <code>[last of x, last of y, last of z]</code>, we need two things: </p>\n\n<p><strong>1.</strong> A function which receives a list of Int and return his last element</p>\n\n<p><strong>2.</strong> Apply this function to a (list of (lists of a)) <strong>[[a]]</strong></p>\n\n<p>To make <strong>(1)</strong> we can easily modify your function lastElement just like this:</p>\n\n<pre><code>lastElement :: [a] -&gt; a\nlastElement [] = error \"error\"\nlastElement [x] = x\nlastElement (x:xs) = lastElement xs\n</code></pre>\n\n<p>Now, lastElement receives one list and return its last element.</p>\n\n<p>To make <strong>(2)</strong> we just need to create a mapping function like this:</p>\n\n<pre><code>mapping :: ([a] -&gt; a) -&gt; [[a]] -&gt; [a]\nmapping _ [] = []\nmapping f (x:xs) = (f x) : (mapping f xs)\n</code></pre>\n\n<p>In that way, you can call <code>mapping lastElement [[1,2],[3,4]]</code> that will give you <code>[2,4]</code>.</p>\n\n<p>I need to say that none of this is needed if you knew two functions which is last who do the same as <strong>(1)</strong> and map who do the same as <strong>(2)</strong>. Knowing this, you can do like <a href=\"https://stackoverflow.com/users/9991455/lorenzo\">Lorenzo</a> already done above:</p>\n\n<pre><code>lastElements :: [[a]] -&gt; [a]\nlastElements = map last\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11048073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cff8ce12434e2158b52515a7cbd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "joel4", "link": "https://stackoverflow.com/users/11048073/joel4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 55441922, "answer_count": 2, "score": 1, "last_activity_date": 1554060088, "creation_date": 1554042155, "question_id": 55441875, "link": "https://stackoverflow.com/questions/55441875/haskellcreate-list-of-last-elements-of-each-list-in-list", "title": "Haskell:create list of last elements of each list in list", "body": "<p>I need to define the function in Haskell's \nwhich for a given list of lists will create a list of its last elements.\nFor example for <code>[[1,2],[3,4]]</code> it should return <code>[2,4]</code></p>\n\n<p>I tried to use pattern matching but ite returns only the last list :</p>\n\n<pre><code>lastElement :: [[a]] -&gt; [a]\nlastElement [] = error \"error\"\nlastElement [x] = x\nlastElement (x:xs) = lastElement xs\n</code></pre>\n\n<p>it gives me <code>[3,4]</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 1, "creation_date": 1554041992, "post_id": 55441802, "comment_id": 97599544, "body": "Can you post the actual error you&#39;re getting?"}, {"owner": {"reputation": 29, "user_id": 11285393, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bSA8HPTGDSo/AAAAAAAAAAI/AAAAAAAACV0/177jYS-H0uY/photo.jpg?sz=128", "display_name": "user11285393", "link": "https://stackoverflow.com/users/11285393/user11285393"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1554042664, "post_id": 55441802, "comment_id": 97599713, "body": ":20:40: error :  parse error on input `=&#39; Perhaps you need a &#39;let &#39; in a &#39;do &#39; block ?  e . g . &#39;let x = 5&#39; instead of &#39;x = 5&#39;"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1554045078, "post_id": 55441802, "comment_id": 97600383, "body": "Are there really backticks in the middle of your code? Please fix your formatting. I can&#39;t figure out what&#39;s real code and what&#39;s just a formatting screw-up on StackOverflow."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1554066018, "post_id": 55441802, "comment_id": 97605882, "body": "Hi there, and welcome to Stack Overflow.  I see you edited your question to delete all the text.  I understand why you did it (to avoid giving other students the answer), but this kind of edit leaves a useless question laying around that won&#39;t benefit anyone else.    I have rolled back your changes but edited your code down to the minimum necessary.  If you still feel uncomfortable having the code up, you can delete your question entirely, but see <a href=\"https://stackoverflow.com/help/what-to-do-instead-of-deleting-question\">stackoverflow.com/help/what-to-do-instead-of-deleting-questi&zwnj;&#8203;on</a> first."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11285393, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bSA8HPTGDSo/AAAAAAAAAAI/AAAAAAAACV0/177jYS-H0uY/photo.jpg?sz=128", "display_name": "user11285393", "link": "https://stackoverflow.com/users/11285393/user11285393"}, "edited": false, "score": 0, "creation_date": 1554045755, "post_id": 55442332, "comment_id": 97600570, "body": "Thanks! This is my first post on here, so I wasn&#39;t sure how I was supposed to edit it (in reference to the ```` throughout the code.  I&#39;m just learning how to post on here!) I appreciate the feedback! This is also my first time working with any functional language, so I&#39;ve been struggling with the syntax a lot.  I&#39;ll make those changes and see where I get!"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554065598, "post_id": 55442332, "comment_id": 97605781, "body": "Just for clarity, there is a comma operator (tuple constructor) @n.m. though it&#39;s a bit unusual in that you need the brackets too to use it"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554066038, "post_id": 55442332, "comment_id": 97605888, "body": "@ATayler there are commas all over the place tbf, lists, tuples, list comprehensions etc, but no standalone operator."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1554069842, "post_id": 55442332, "comment_id": 97606707, "body": "@n.m. you&#39;re right, checked the language report and the tuple constructor is technically not an operator, which when I think about it harder makes sense :)"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1554045149, "creation_date": 1554045149, "answer_id": 55442332, "question_id": 55441802, "link": "https://stackoverflow.com/questions/55441802/parse-error-in-haskell-code-cant-figure-out-why/55442332#55442332", "title": "Parse error in haskell code, can&#39;t figure out why", "body": "<p>Ignoring spurious ``` in the source code. Let's look at these lines:</p>\n\n<pre><code>if connectFour\n  onePlayerManyMoves game (move:moves) = game\nelse\n  onePlayerManyMoves game (move:moves) = play game '1' move, onePlayerManyMoves game (move:moves) = game moves\n</code></pre>\n\n<p>This is not how the conditional works in Haskell. First, it is an <em>expression</em>. Not a statement, not a declaration, not anything else. An expression. (And there's <code>then</code> keyword which is not optional). You cannot have a conditional pattern binding like that. You need a conditional expression:</p>\n\n<pre><code>onePlayerManyMoves game (move:moves) = if connectFour then ... else ...\n</code></pre>\n\n<p>Next thing, let's look what goes in the <code>else</code> branch.</p>\n\n<pre><code>play game '1' move, onePlayerManyMoves game (move:moves) = game moves\n</code></pre>\n\n<p>I have no idea what this could possibly mean. There is no comma operator in Haskell. It is very unclear what you are trying to do here. </p>\n\n<p>There are many other errors further down, but this should get you started.</p>\n"}], "owner": {"reputation": 29, "user_id": 11285393, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bSA8HPTGDSo/AAAAAAAAAAI/AAAAAAAACV0/177jYS-H0uY/photo.jpg?sz=128", "display_name": "user11285393", "link": "https://stackoverflow.com/users/11285393/user11285393"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1554065845, "creation_date": 1554041745, "last_edit_date": 1554065845, "question_id": 55441802, "link": "https://stackoverflow.com/questions/55441802/parse-error-in-haskell-code-cant-figure-out-why", "title": "Parse error in haskell code, can&#39;t figure out why", "body": "<p><strong>Updated:</strong> Removed code unrelated to error because this is homework and other students might see it.</p>\n\n<p>I'm working on a homework assignment that uses haskell in order to play connect four.  The game board is provided, as is the list that contains moves.  I'm new to haskell and I don't understand why I'm getting a parse error on line 20.  I'm also having issues with completing the code that checks for connect four, so any help on either of those two problems would be greatly appreciated.</p>\n\n<p>The error I get is:</p>\n\n<pre><code>:20:40: error :\n    parse error on input \u2018=\u2019\n    Perhaps you need a 'let' in a 'do' block?\n    e.g. 'let x = 5' instead of 'x = 5'\n</code></pre>\n\n<p>In the following code, the line causing the error is marked with a comment:</p>\n\n<pre><code>onePlayerManyMoves :: [[Char]] -&gt; [Int] -&gt; [[Char]]\nonePlayerManyMoves :: [[Char]] -&gt; [Int] -&gt; [[Char]]\nonePlayerManyMoves [] _ = []\nonePlayerManyMoves game [] = game  -- **parse error here**\nif connectFour\n  onePlayerManyMoves game (move:moves) = game\nelse\n  onePlayerManyMoves game (move:moves) = play game '1' move, onePlayerManyMoves game (move:moves) = game moves\nwhere connectFour = checkFour game\n\n</code></pre>\n"}, {"tags": ["haskell", "double", "precision"], "comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 2, "creation_date": 1554036080, "post_id": 55440904, "comment_id": 97598152, "body": "Can you please be more clear about what does not work and why? The two codes look identical"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1554044808, "post_id": 55440904, "comment_id": 97600310, "body": "I&#39;ve tried to make it a bit more clear exactly what you&#39;re asking. Please feel free to change any parts of the question back if I&#39;ve misunderstood what&#39;s confusing you."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 11235803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efcf6079e81dffe2bea86d12ade6cc5c?s=128&d=identicon&r=PG&f=1", "display_name": "Jankun", "link": "https://stackoverflow.com/users/11235803/jankun"}, "is_accepted": false, "score": 6, "last_activity_date": 1554038365, "last_edit_date": 1592644375, "creation_date": 1554036953, "answer_id": 55441107, "question_id": 55440904, "link": "https://stackoverflow.com/questions/55440904/how-to-sum-number-of-doubles/55441107#55441107", "title": "How to sum number of doubles?", "body": "<p>The second function has a different type that first one.</p>\n<blockquote>\n<p>(Fractional a1, Integral a2) =&gt; a2 -&gt; a2 -&gt; a1</p>\n</blockquote>\n<p>here a2 is any type that has an instance of Integral. Both Int and Integer implement Integral. Integer is an arbitrary precision type: it will hold any number no matter how big, up to the limit of your machine's memory. Int isn't. For example:</p>\n<blockquote>\n<p>(10::Integer)^100 == 10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</p>\n<p>(10::Int)^100 == 0</p>\n</blockquote>\n<p>The second case can happen in your first function. And then <strong>1/0 == Infinity</strong></p>\n<p>When there is no explicit type declaration Haskell will assume that any natural number literal is, in fact, an Integer. That's why the second function operates on Integers and the result is better</p>\n"}], "owner": {"reputation": 21, "user_id": 10707671, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZBlQCIHsfDQ/AAAAAAAAAAI/AAAAAAAABMg/qlju6j7tbzk/photo.jpg?sz=128", "display_name": "Fasdr", "link": "https://stackoverflow.com/users/10707671/fasdr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554044735, "creation_date": 1554035329, "last_edit_date": 1554044735, "question_id": 55440904, "link": "https://stackoverflow.com/questions/55440904/how-to-sum-number-of-doubles", "title": "How to sum number of doubles?", "body": "<p>How can I sum <code>Double</code>s? I thought <code>sum</code> would work out of the box, and when I just use type inference it does indeed seem to, but when I give a type signature fixing the output type to <code>Double</code> the sum goes infinite!</p>\n\n<p>This doesn't work:</p>\n\n<pre><code>doubles :: Int -&gt; Int -&gt; Double\ndoubles maxk maxn =  sum [1/(fromIntegral(i*(j+1)^(2*i)))|i&lt;-[1..maxk],j&lt;-[1..maxn]]\n</code></pre>\n\n<p>I see this behavior:</p>\n\n<pre><code>*Main&gt; doubles 20 1500\nInfinity\n</code></pre>\n\n<p>However, without a type signature, the same code:</p>\n\n<pre><code>doubles maxk maxn =  sum [1/(fromIntegral(i*(j+1)^(2*i)))|i&lt;-[1..maxk],j&lt;-[1..maxn]]\n</code></pre>\n\n<p>Produces a sensible answer:</p>\n\n<pre><code>*Main&gt; doubles 20 1500\n0.692481179869307\n</code></pre>\n\n<p>What gives?</p>\n"}, {"tags": ["haskell", "integer"], "comments": [{"owner": {"reputation": 619, "user_id": 8514005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318a3ae487b2140f9d08079450b6903d?s=128&d=identicon&r=PG&f=1", "display_name": "JohEker", "link": "https://stackoverflow.com/users/8514005/joheker"}, "edited": false, "score": 3, "creation_date": 1553989181, "post_id": 55436571, "comment_id": 97590578, "body": "the type of <code>length</code> is  <code>length :: Foldable t =&gt; t a -&gt; Int</code>. But you are explicitly saying that <code>totient</code> should return an <code>Integral a</code>."}, {"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "reply_to_user": {"reputation": 619, "user_id": 8514005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318a3ae487b2140f9d08079450b6903d?s=128&d=identicon&r=PG&f=1", "display_name": "JohEker", "link": "https://stackoverflow.com/users/8514005/joheker"}, "edited": false, "score": 0, "creation_date": 1553989394, "post_id": 55436571, "comment_id": 97590612, "body": "@JohEker I&#39;m missing something, isn&#39;t <code>Int</code> an <code>Integral a</code> type? <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch6.html#x13-1270011\" rel=\"nofollow noreferrer\">haskell.org/onlinereport/haskell2010/&hellip;</a>"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 619, "user_id": 8514005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318a3ae487b2140f9d08079450b6903d?s=128&d=identicon&r=PG&f=1", "display_name": "JohEker", "link": "https://stackoverflow.com/users/8514005/joheker"}, "edited": false, "score": 0, "creation_date": 1553989402, "post_id": 55436571, "comment_id": 97590614, "body": "@johEker is right, your problem is in the <code>length</code> bit, which returns an <code>Int</code>. You can then convert that using <code>fromIntegral</code>"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1553989485, "post_id": 55436571, "comment_id": 97590627, "body": "Yes, but your function has to type-check <code>forall a</code> in <code>Integral</code> , as you can also see from the error"}, {"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1553989799, "post_id": 55436571, "comment_id": 97590691, "body": "@Lorenzo I&#39;m still confused: <code>fromIntegral :: (Num b, Integral a) =&gt; a -&gt; b</code>. how does that make it typecheck if <code>fromIntegral</code> returns a <code>Num b =&gt; b</code> type when <code>totient</code> expects a <code>Integral a =&gt; a</code> type to be returned?"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 2, "creation_date": 1553990129, "post_id": 55436571, "comment_id": 97590746, "body": "As the answer explains, <code>fromIntegral (Num b, Integral a) =&gt; A -&gt; b</code> means that the caller (the <code>length</code> function) needs to provide it with any <code>Integral a</code>. <code>Int</code> is an <code>Integral</code> so this checks out. Then, <code>fromIntegral</code> returns a <code>Num b</code>, and the user (the <code>totient</code> function), chooses the type of this. In this case, you choose it to be a <code>Integral</code> in your type declaration."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 1, "creation_date": 1553990242, "post_id": 55436571, "comment_id": 97590760, "body": "Note that when you &quot;choose&quot; the returned type, you don&#39;t need to restrict it, in this case you could return <code>Num b</code> and it would still be valid."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1553991364, "post_id": 55436571, "comment_id": 97590903, "body": "You could also fix it by using <code>genericLength</code> (from <code>Data.List</code>) instead of <code>length</code>. It can be pretty annoying that <code>length</code> is monomorphic in its return type, it seems like a mistake in the initial design of the standard library which we can hope is changed in a future version."}, {"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1553992493, "post_id": 55436571, "comment_id": 97591052, "body": "@Lorenzo maybe I&#39;m thinking about types incorrectly. What if <code>fromIntegral</code> returns a <code>Floating</code> or <code>Fractional</code> type? By my understanding, that would be a <code>Num</code> type, but it wouldn&#39;t be an <code>Integral</code> type, so it&#39;s weird why that would typecheck"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 1, "creation_date": 1553993031, "post_id": 55436571, "comment_id": 97591122, "body": "But <code>fromIntegral</code> is returning a general <code>Num</code> type, and then you choose what you want it to be. You can leave as is, or you can &quot;cast it&quot; into a <code>Integral</code> like you&#39;re doing"}, {"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1553994193, "post_id": 55436571, "comment_id": 97591251, "body": "@Lorenzo hmm... I think I got it. I was thinking in terms of values and not types. I don&#39;t know if this is the right way to phrase it, but an <code>Int</code> value can be &quot;upcast&quot; into an <code>Integral</code> value or <code>Num</code> value, but a <code>Num</code> type or <code>Integral</code> type can be &quot;downcast&quot; into an <code>Int</code> type; is that right?"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1553996953, "post_id": 55436571, "comment_id": 97591621, "body": "Not quite. The essence is that <code>Num</code> and <code>Integral</code> are not types, they are typeclasses, which is like a set of types that have something in common, and with which you can so something. For example, <code>Eq</code> is a typeclass with those types that support and equality <code>(==)</code> operator. Similarly, <code>Num</code> is the typeclass of &quot;numbers&quot; (i.e. they support addition, multiplication and more). Have a look here and it might make it more clear <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">learnyouahaskell.com/making-our-own-types-and-typeclasses</a>"}, {"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1553999507, "post_id": 55436571, "comment_id": 97591933, "body": "@Lorenzo i&#39;m sorry, now it makes less sense. the type returned by <code>fromIntegral</code> is in the <code>Num</code> typeclass, which is a type that supports some set X of properties. the typeclass <code>Integral</code> supports some set Y of properties, but X is a subset of Y, because to be a part of the typeclass <code>Integral</code> the type must also be a part of typeclass <code>Num</code>. then, why is returning a type in typeclass <code>Num</code> sufficient?"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 1, "creation_date": 1553999820, "post_id": 55436571, "comment_id": 97591977, "body": "You got it the other way round. <code>Integral</code> is a subset of <code>Num</code>, so it supports all the properties <code>Num</code> does, plus some more, so X is a superset of Y"}, {"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1554005291, "post_id": 55436571, "comment_id": 97592672, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/190972/discussion-between-zli-and-lorenzo\">continue this discussion in chat</a>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1554102322, "post_id": 55436571, "comment_id": 97613579, "body": "@zli it&#39;s not letting me post this in the chatroom, so I&#39;m doing it here instead: <code>fromIntegral</code> can return any type you want, provided it&#39;s an instance of <code>Num</code>.  And <code>totient</code> needs to be able to return any type you might want, that&#39;s an instance of <code>Integral</code>. But since <code>Integral</code> is a subclass of <code>Num</code> this is no problem at all. Basically the type signature of <code>totient</code> places more restrictions on which types <code>fromIntegral</code> is allowed to return."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1554102328, "post_id": 55436571, "comment_id": 97613583, "body": "It wouldn&#39;t work the other way round - if <code>totient</code> had a more general return type such as any <code>Eq</code> instance - because then you might use the result of <code>totient</code> on a type (say <code>String</code>) which is in <code>Eq</code> but not <code>Num</code>. This obviously wouldn&#39;t work because <code>fromIntegral</code> can&#39;t return a <code>String</code> - and Haskell will tell you this by not allowing <code>totient</code> to typecheck. In other words the return type of <code>totient</code> needs to be at least restrictive as that of <code>fromIntegral</code>, to avoid this. Being more restrictive, as you are doing, can&#39;t lead to any such problem."}, {"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554156848, "post_id": 55436571, "comment_id": 97640619, "body": "thanks @RobinZigmond. i don&#39;t know why i&#39;m having such a hard time wrapping my head around this. <code>totient</code> returns an instance from <code>Integral</code> typeclass, let&#39;s say the <code>Integral</code> typeclass supports functions A and B. <code>fromIntegral</code> returns an instance from <code>Num</code> typeclass, let&#39;s say the <code>Num</code> typeclass only supports function A. as a caller of <code>totient</code> I want to use function B on the result (which I expect to be an instance from <code>Integral</code> typeclass). however, since <code>fromIntegral</code> returns an instance of the <code>Num</code> typeclass, it only guarantees that I can use function A on the result."}, {"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "edited": false, "score": 0, "creation_date": 1554156902, "post_id": 55436571, "comment_id": 97640639, "body": "to me that seems pretty dangerous, and I don&#39;t understand why we&#39;re able to just &quot;coerce&quot; types to fit the type signature when it doesn&#39;t seem like the guarantee that we can use it as we want exists"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1554157874, "post_id": 55436571, "comment_id": 97640897, "body": "<code>fromIntegral</code>, in isolation, does indeed return an instance of <code>Num</code>, which in your schematic representation supports function <code>A</code> but not necessarily <code>B</code>. But what you&#39;re overlooking is that you&#39;re not using it in isolation, your type signature for <code>totient</code> tells Haskell that it will return an instance of <code>Integral</code>, and therefore also have access to <code>B</code>. It is <code>totient</code> here, via its type signature that provides the guarantees to any function which uses its result. While <code>fromIntegral</code> doesn&#39;t have as many guarantees, that doesn&#39;t matter, they&#39;re provided by the context."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1554158056, "post_id": 55436571, "comment_id": 97640933, "body": "to put it another way, <code>fromIntegral</code> is one of several &quot;strange&quot; functions in Haskell in that it is polymorphic in its return type. Given the same input (of the same type), it can actually return results of different types - and the return type either needs to be given explicitly, or inferred from the context. The latter is what happens here - or at least the return type is restricted somewhat by the context. In isolation it could be any instance of <code>Num</code>, its use in <code>totient</code> further restricts it to an instance of <code>Integral</code>."}, {"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554159364, "post_id": 55436571, "comment_id": 97641276, "body": "@RobinZigmond thanks so much for patiently explaining. i don&#39;t know if i&#39;ve completely grokked it, but i think i&#39;m just starting to accept the weirdness. maybe i should sleep on it or come back 10 years later when i&#39;m more competent of a haskell developer (:"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554761554, "post_id": 55436571, "comment_id": 97863115, "body": "just to be sure, adding the <code>fromIntegral</code> as <code>totient m = fromIntegral $ length $ filter ...</code> would also solve your problem, as would changing the signature to <code>... -&gt; Int</code> instead (since <code>length</code> returns an <code>Int</code>). <a href=\"https://stackoverflow.com/a/52925066/849891\"><i>It is not your function that decides what type to return</i>. It&#39;s your function&#39;s <i>use</i> that determines that.</a>."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1553989413, "creation_date": 1553989413, "answer_id": 55436637, "question_id": 55436571, "link": "https://stackoverflow.com/questions/55436571/type-error-when-creating-list-from-integral-type/55436637#55436637", "title": "type error when creating list from integral type", "body": "<p>The type <code>Integral a =&gt; a -&gt; a</code> says:</p>\n\n<ol>\n<li>Caller gets to choose a type <code>a</code>.</li>\n<li>Caller must prove that <code>a</code> is an instance of <code>Integral</code>.</li>\n<li>Caller must provide a value of type <code>a</code>.</li>\n<li>Implementer produces another value of type <code>a</code>.</li>\n</ol>\n\n<p>However, in this case, the implementer has produced an <code>Int</code>. Any time the caller chooses <code>a</code> to be an instance of <code>Integral</code> that is not <code>Int</code>, this will not match the caller's type.</p>\n"}], "owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 55436637, "answer_count": 1, "score": 1, "last_activity_date": 1553989478, "creation_date": 1553988616, "last_edit_date": 1553989478, "question_id": 55436571, "link": "https://stackoverflow.com/questions/55436571/type-error-when-creating-list-from-integral-type", "title": "type error when creating list from integral type", "body": "<p>I'm trying to implement a simple function: <code>totient</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>coprime :: Integral a =&gt; a -&gt; a -&gt; Bool\ncoprime a b = gcd a b == 1\n\ntotient :: Integral a =&gt; a -&gt; a\ntotient m = length $ filter (coprime m) [1..m-1]\n\nghci&gt; :load 99problems.hs\n[1 of 1] Compiling Main             ( 99problems.hs, interpreted )\n\n99problems.hs:250:13: error:\n    \u2022 Couldn't match expected type \u2018a\u2019 with actual type \u2018Int\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n        the type signature for:\n          totient :: forall a. Integral a =&gt; a -&gt; a\n        at 99problems.hs:249:12\n    \u2022 In the expression: length $ filter (coprime m) [1 .. m - 1]\n      In an equation for \u2018totient\u2019:\n          totient m = length $ filter (coprime m) [1 .. m - 1]\n    \u2022 Relevant bindings include\n        m :: a (bound at 99problems.hs:250:9)\n        totient :: a -&gt; a (bound at 99problems.hs:250:1)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I tried using stuff like <code>fromIntegral</code> or <code>toInteger</code> on <code>(m-1)</code> but none of it has worked. I'm not sure what I'm missing here... it seems like <code>Int</code> should be a type <code>Integral a =&gt; a</code>. What's going wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1553999716, "post_id": 55435078, "comment_id": 97591961, "body": "I don&#39;t know about <code>Data.Row</code> specifically, but the general difficulty with extensible records is that your target label-type pair might be at any offset in the record; so there&#39;s an instance for every offset, and those instances overlap. GHC does not know (and there&#39;s no way to tell it) that each label appears only once in a record. Yes switching on <code>IncoherentInstances</code> is unlikely to make it work, but might get more info in the error message."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1554046293, "post_id": 55435078, "comment_id": 97600722, "body": "Is <code>Data.Row</code> your own code?  I can&#39;t find any such module or any definition of <code>HasType</code> taking three parameters on Hoogle.  I think you will have much better luck getting an answer if you provide a <a href=\"https://stackoverflow.com/help/mcve\">self-contained example illustrating the problem</a>."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1554094300, "post_id": 55435078, "comment_id": 97611018, "body": "<code>Data.Row</code> is in <code>row-types</code>, which is here <a href=\"http://hackage.haskell.org/package/row-types\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/row-types</a>. Based on CTRex, it says. That&#39;s a big library and I&#39;m not going to wade through it. (It claims &quot; it specifically forbids records from having more than one element of the same label.&quot;; but as I said there&#39;s no way to tell GHC about that.) I agree with @K.A.Buhr that it needs a self-contained example."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 1678575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ee96eaddc4ece5473a74bb1dec18bf?s=128&d=identicon&r=PG", "display_name": "Timo Meijer", "link": "https://stackoverflow.com/users/1678575/timo-meijer"}, "edited": false, "score": 0, "creation_date": 1554224291, "post_id": 55464563, "comment_id": 97670006, "body": "Thanks for showing how I could&#39;ve reduced my example even further!  To clarify a bit more, as I understand it now, <code>Rec.Modify</code> is a typelevel function, and because in <code>render</code> we don&#39;t have a concrete <code>r</code> type, so this function cannot unroll it&#39;s definition, and thus not derive the &quot;obvious&quot; constraints, even though in practice it works out. This is the reason why you need to explicitly add these constraints, as the compiler doesn&#39;t have enough information to derive them.  Does that about get to the core of it?"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1554158461, "creation_date": 1554158461, "answer_id": 55464563, "question_id": 55435078, "link": "https://stackoverflow.com/questions/55435078/overlapping-instances-when-modifying-extensible-record/55464563#55464563", "title": "Overlapping instances when modifying extensible record", "body": "<p>The scary message is mostly irrelevant.  This simplified example replaces <code>HasType</code> with its <code>(.!)</code> equivalent and illustrates the problem, which I think you've already discovered up above:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, FlexibleContexts, TypeOperators, GADTs #-}\n\nmodule MyRow where\n\nimport Data.Row\nimport qualified Data.Row.Records as Rec\n\nf2 :: ((r .! \"x\") ~ Double) =&gt; Rec r -&gt; Rec (Rec.Modify \"x\" Double r)\nf2 = undefined\n\nextract :: ((r .! \"x\") ~ Double) =&gt; Rec r -&gt; ()\nextract = undefined\n\nrender :: ((r .! \"x\") ~ Double) =&gt; Rec r -&gt; ()\nrender r = extract $ f2 r\n</code></pre>\n\n<p>This code results in the error that <code>(Modify \"x\" Double r .! \"x\") ~ Double</code> cannot be deduced from <code>(r .! \"x\") ~ Double</code>.  This may be \"obviously\" true, but that doesn't mean GHC can prove it.</p>\n\n<p>I'd be happy to be proven wrong, but I think you'll be forced to add the explicit constraints you need.  In your original example, the following type signature (which GHC is able to deduce on its own if you leave it out), appears to work:</p>\n\n<pre><code>render ::\n  ( HasType \"x\" [Double] r\n  , HasType \"x\" [Double] (Rec.Modify \"x\" [Double] r)\n  , HasType \"y\" [Double] (Rec.Modify \"x\" [Double] r)\n  ) =&gt; Scales -&gt; Rec r -&gt; ()\nrender Scales{..} r = extractFromRecord $ f2 _xScale r\n</code></pre>\n\n<p>I had to turn <code>FlexibleContexts</code> and <code>GADTs</code> on, in addition to the other extensions you had enabled in your example.</p>\n"}], "owner": {"reputation": 99, "user_id": 1678575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ee96eaddc4ece5473a74bb1dec18bf?s=128&d=identicon&r=PG", "display_name": "Timo Meijer", "link": "https://stackoverflow.com/users/1678575/timo-meijer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 1, "accepted_answer_id": 55464563, "answer_count": 1, "score": 3, "last_activity_date": 1554205392, "creation_date": 1553974800, "last_edit_date": 1554205392, "question_id": 55435078, "link": "https://stackoverflow.com/questions/55435078/overlapping-instances-when-modifying-extensible-record", "title": "Overlapping instances when modifying extensible record", "body": "<p>I'm experimenting with extensible records (I'm using the row-types library) in my project, but I'm running into an issue when I want to modify something in the record in a specific way, which returns very scary errors about overlapping instances and non-deducible types.</p>\n\n<p>What I'd like to express is a function that gets a record containing a specific label-type pair, and may modify that type. But when I try to use that function, the scary errors pop up.</p>\n\n<p>I've reduced the error to the following example. Especially the error after enabling <code>IncoherentInstances</code>(<code>Could not deduce: (Rec.Modify \"x\" [Double] r .! \"x\") ~ [Double]</code>) seems weird to me, as it says right there that the record contains <code>\"x\" :-&gt; [Double]</code>.\nI've tried avoiding the <code>Rec.Modify</code> with <code>f2 :: forall r. (HasType aes a r) =&gt; Rec r -&gt; Rec (r .- aes .+ aes .== b)</code>, but that results in a similar error.</p>\n\n<p>I would love to get some help figuring out what I'm doing wrong, and how to make something like this work.</p>\n\n<pre><code>{-# LANGUAGE DataKinds, OverloadedLabels, TypeOperators, RankNTypes,\n             RecordWildCards, NoMonomorphismRestriction #-}\nmodule GoG.Temp where\n\nimport Data.Row\nimport qualified Data.Row.Records as Rec\n\ntype Scale' aes a = Scale aes a a\ndata Scale aes a b = Scale\n  -- f1 works great\n  -- f2 results in very scary errormessages\n  { f1 :: forall r. (HasType aes a r) =&gt; Rec r -&gt; Rec r\n  -- What I'd like to express is a function that gets a record containing a\n  -- specific label-type pair, and may modify that type. But when I try to\n  -- use that function, the scary errors pop up\n  , f2 :: forall r. (HasType aes a r) =&gt; Rec r -&gt; Rec (Rec.Modify aes b r)\n  -- ... other fields\n  }\n\ndata Scales = Scales { _xScale :: Scale' \"x\" [Double] }\n\nextractFromRecord :: (HasType \"x\" [Double] r, HasType \"y\" [Double] r) \n    =&gt; Rec r -&gt; ()\nextractFromRecord = undefined\n\nrender :: (HasType \"x\" [Double] r, HasType \"y\" [Double] r) \n    =&gt; Scales -&gt; Rec r -&gt; ()\n-- If you replace f2 with f1 it works fine, but f2 results in the error\nrender Scales{..} r = extractFromRecord $ f2 _xScale r\n</code></pre>\n\n<p>This results in the following error:</p>\n\n<pre><code>    \u2022 Overlapping instances for HasType\n                                  \"x\" [Double] (Rec.Modify \"x\" [Double] r)\n        arising from a use of \u2018extractFromRecord\u2019\n      Matching instances:\n        instance forall k (r :: Row\n                                  k) (l :: ghc-prim-0.5.3:GHC.Types.Symbol) (a :: k).\n                 ((r .! l) \u2248 a) =&gt;\n                 HasType l a r\n          -- Defined in \u2018Data.Row.Internal\u2019\n      There exists a (perhaps superclass) match:\n        from the context: (HasType \"x\" [Double] r, HasType \"y\" [Double] r)\n          bound by the type signature for:\n                     render :: forall (r :: Row *).\n                               (HasType \"x\" [Double] r, HasType \"y\" [Double] r) =&gt;\n                               Scales -&gt; Rec r -&gt; ()\n          at /mnt/d/University/infoafp/afp-gog/src/GoG/Temp.hs:22:1-83\n      (The choice depends on the instantiation of \u2018r\u2019\n       To pick the first instance above, use IncoherentInstances\n       when compiling the other instance declarations)\n    \u2022 In the expression: extractFromRecord $ f2 _xScale r\n      In an equation for \u2018render\u2019:\n          render Scales {..} r = extractFromRecord $ f2 _xScale r\n   |\n23 | render Scales{..} r = extractFromRecord $ f2 _xScale r\n   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Or this if we enable IncoherentInstances as suggested:</p>\n\n<pre><code>    \u2022 Could not deduce: (Rec.Modify \"x\" [Double] r .! \"x\") ~ [Double]\n        arising from a use of \u2018extractFromRecord\u2019\n      from the context: (HasType \"x\" [Double] r, HasType \"y\" [Double] r)\n        bound by the type signature for:\n                   render :: forall (r :: Row *).\n                             (HasType \"x\" [Double] r, HasType \"y\" [Double] r) =&gt;\n                             Scales -&gt; Rec r -&gt; ()\n        at /mnt/d/University/infoafp/afp-gog/src/GoG/Temp.hs:23:1-83\n    \u2022 In the expression: extractFromRecord $ f2 _xScale r\n      In an equation for \u2018render\u2019:\n          render Scales {..} r = extractFromRecord $ f2 _xScale r\n    \u2022 Relevant bindings include\n        r :: Rec r\n          (bound at /mnt/d/University/infoafp/afp-gog/src/GoG/Temp.hs:24:19)\n        render :: Scales -&gt; Rec r -&gt; ()\n          (bound at /mnt/d/University/infoafp/afp-gog/src/GoG/Temp.hs:24:1)\n   |\n24 | render Scales{..} r = extractFromRecord $ f2 _xScale r\n   |         \n</code></pre>\n"}, {"tags": ["haskell", "types", "data-kinds"], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 1, "last_activity_date": 1554057347, "creation_date": 1554057347, "answer_id": 55444158, "question_id": 55434665, "link": "https://stackoverflow.com/questions/55434665/normalizing-typenats-inequalities/55444158#55444158", "title": "Normalizing TypeNats Inequalities", "body": "<p>Despite the package description, <code>ghc-typelits-natnormalise</code> can solve inequalities as well.  The following program typechecks with GHC 8.6.4 and <code>ghc-typelits-natnormalise-0.6.2</code>:</p>\n\n<pre><code>{-# LANGUAGE KindSignatures, TypeOperators, ScopedTypeVariables,\n             DataKinds, TypeFamilies #-}\n{-# OPTIONS_GHC -fplugin GHC.TypeLits.Normalise -Wall #-}\n\nimport GHC.TypeNats\nimport Data.Proxy\n\na :: forall (a :: Nat). 1 &lt;= a =&gt; Proxy a -&gt; Int\na = undefined\n\nb :: forall (a :: Nat). 2 &lt;= a =&gt; Proxy a -&gt; Int\nb = a\n</code></pre>\n"}], "owner": {"reputation": 747, "user_id": 6933270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7AdXs.jpg?s=128&g=1", "display_name": "William Rusnack", "link": "https://stackoverflow.com/users/6933270/william-rusnack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 1, "accepted_answer_id": 55444158, "answer_count": 1, "score": 2, "last_activity_date": 1554057347, "creation_date": 1553971795, "last_edit_date": 1554047366, "question_id": 55434665, "link": "https://stackoverflow.com/questions/55434665/normalizing-typenats-inequalities", "title": "Normalizing TypeNats Inequalities", "body": "<p>I have two functions both with a Nat (from TypeNats) kind that both have a comparison type operator <code>&lt;=</code>. The constraint <code>2 &lt;= n</code> for function <code>b</code> contains the constraint <code>1 &lt;= n</code> for function <code>a</code>. Is there a way to get ghc to resolve that <code>2 &lt;= n</code> satisfies the constraint <code>1 &lt;= n</code> so that I do not have to specify both <code>(1 &lt;= n, 2 &lt;= n)</code> constraints for <code>b</code>?</p>\n\n<p>The below code demonstrates the error.</p>\n\n<pre><code>{-# LANGUAGE KindSignatures, TypeOperators, ScopedTypeVariables, \n             DataKinds, TypeFamilies #-}\n\nimport GHC.TypeNats\nimport Data.Proxy\n\na :: forall (a :: Nat). 1 &lt;= a =&gt; Proxy a -&gt; Int\na = undefined\n\nb :: forall (a :: Nat). 2 &lt;= a =&gt; Proxy a -&gt; Int\nb = a\n</code></pre>\n\n<p>Results in a compile error</p>\n\n<pre><code>\u2022 Could not deduce: (1 &lt;=? a) ~ 'True arising from a use of \u2018a\u2019\n  from the context: 2 &lt;= a\n    bound by the type signature for:\n               b :: forall (a :: Nat). (2 &lt;= a) =&gt; Proxy a -&gt; Int\n    at Example.hs:9:1-48\n\u2022 In the expression: a\n  In an equation for \u2018b\u2019: b = a\n\u2022 Relevant bindings include\n    b :: Proxy a -&gt; Int\n      (bound at Example.hs:10:1)\n</code></pre>\n\n<p>There is a library to solve equalities <a href=\"https://hackage.haskell.org/package/ghc-typelits-natnormalise\" rel=\"nofollow noreferrer\">ghc-typelits-natnormalise</a> but not inequalities.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "edited": false, "score": 0, "creation_date": 1553972398, "post_id": 55434517, "comment_id": 97586859, "body": "Hmm, okay.  I think I understand.  My <code>App a</code> is a <code>ReaderT Config (LoggingT (ExceptT ServantErr IO)) a</code> with instances for <code>MonadError</code>, <code>MonadCatch</code>, and <code>MonadThrow</code> automatically derived.  Will I need to write a custom instance for any or all of those?  Or how can I otherwise ensure that the exceptions are caught in the monad they&#39;re thrown in?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "edited": false, "score": 0, "creation_date": 1553974813, "post_id": 55434517, "comment_id": 97587446, "body": "Perhaps you could modify <code>(&lt;??)</code> in two ways: add <code>Exception e</code> and <code>MonadThrow m</code> constraints and, before using <code>catch</code> on the monadic action, use <code>catchError</code> from <code>MonadError</code> and re-throw any error found using functions from <code>MonadThrow</code>. The idea is to convert the errors into something <code>MonadCatch</code> could handle. Still, this mix of error-handling typeclasses feels a bit inelegant. Perhaps it would make sense to shift to an exceptions-only solution."}, {"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "edited": false, "score": 0, "creation_date": 1553977148, "post_id": 55434517, "comment_id": 97588038, "body": "Thanks for your additional edit!  I&#39;ll give <code>onError</code> a shot."}, {"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "edited": false, "score": 0, "creation_date": 1554140879, "post_id": 55434517, "comment_id": 97634342, "body": "So, using <code>onError</code> rather than <code>catch</code> in my handler does appear to do the trick.  I do agree though, now that I&#39;ve thought a bit more about it, that mixing <code>MonadError</code> and <code>MonadThrow&#47;Catch</code> seems wrong (and caused this whole confusion in the first place).  However, if I change my <code>throwError</code>s to <code>throwM</code> this causes the error to not propagate back to the client, e.g., an exception is thrown and the response is a 500, where if I use <code>throwError err400</code>, for instance, the proper response is created."}, {"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "edited": false, "score": 0, "creation_date": 1554140963, "post_id": 55434517, "comment_id": 97634392, "body": "Would one way to make this nicer be to use <code>throwM</code> everywhere and in the handlers, <code>catch</code> the error and then use <code>throwError</code> on it?"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 6, "last_activity_date": 1553976893, "last_edit_date": 1553976893, "creation_date": 1553970750, "answer_id": 55434517, "question_id": 55434021, "link": "https://stackoverflow.com/questions/55434021/why-isnt-catch-catching-this-exception/55434517#55434517", "title": "Why isn&#39;t `catch` catching this exception?", "body": "<p>If your <code>App</code> type is ultimately an <a href=\"https://hackage.haskell.org/package/transformers-0.5.6.2/docs/Control-Monad-Trans-Except.html\" rel=\"nofollow noreferrer\"><code>ExceptT</code></a>, the problem could be that the <code>MonadError</code> and <code>MonadCatch</code> instances for <code>ExceptT</code> are mismatched: </p>\n\n<ul>\n<li>The <code>MonadError</code> instance throws errors as the <code>e</code> in <code>ExceptT e</code></li>\n<li>The <code>MonadCatch</code> intance catches exceptions in the <em>underlying monad</em>, not <code>ExceptT e</code> errors. </li>\n</ul>\n\n<p>The <a href=\"http://hackage.haskell.org/package/exceptions-0.10.1/docs/Control-Monad-Catch.html\" rel=\"nofollow noreferrer\">instance definition</a> for <code>MonadCatch (ExceptT e m)</code> is:</p>\n\n<pre><code>-- | Catches exceptions from the base monad.\ninstance MonadCatch m =&gt; MonadCatch (ExceptT e m) where\n   catch (ExceptT m) f = ExceptT $ catch m (runExceptT . f)\n</code></pre>\n\n<p><a href=\"https://hackage.haskell.org/package/servant-server-0.14.1/docs/Servant-Server.html#t:ServantErr\" rel=\"nofollow noreferrer\"><code>ServantErr</code></a> has an <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception-Base.html#t:Exception\" rel=\"nofollow noreferrer\"><code>Exception</code></a> instance, so it can be thrown as both.</p>\n\n<hr>\n\n<p><strong>Edit</strong>: The \"exceptions\" class <code>MonadMask</code> provides the <a href=\"http://hackage.haskell.org/package/exceptions-0.10.1/docs/Control-Monad-Catch.html#v:onError\" rel=\"nofollow noreferrer\"><code>onError</code></a> function, that even for <code>ExceptT</code> is quite well-behaved: it runs the cleanup action both in the case of <code>ExceptT e</code> exceptions <em>and</em> regular exceptions:</p>\n\n<blockquote>\n  <p>Run an action only if an error is thrown in the main action. Unlike\n  onException, this works with every kind of error, not just exceptions.\n  For example, if f is an ExceptT computation which aborts with a Left,\n  the computation onError f g will execute g, while onException f g will\n  not.</p>\n</blockquote>\n\n<p>It is a better option than <code>catch</code> for handling the rollback.</p>\n"}], "owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 55434517, "answer_count": 1, "score": 2, "last_activity_date": 1559443523, "creation_date": 1553967304, "last_edit_date": 1559443523, "question_id": 55434021, "link": "https://stackoverflow.com/questions/55434021/why-isnt-catch-catching-this-exception", "title": "Why isn&#39;t `catch` catching this exception?", "body": "<p>I have a Servant app and an endpoint that creates a record in a database, then attempts to copy a file between S3 locations.  If the copy fails, I want to roll back the transaction.  I have this operator</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}    \n\nimport Control.Monad.Catch\nimport Control.Monad.Except\nimport Control.Monad.Logger\n\n(&lt;??)\n  :: (MonadError e m, MonadCatch m, MonadLogger m)\n  =&gt; e\n  -&gt; m a\n  -&gt; m a\n(&lt;??) err a = a `catchAll` (\\e -&gt; $(logErrorSH) e &gt;&gt; throwError err)\ninfixr 0 &lt;??\n</code></pre>\n\n<p>that catches all exceptions, logs the nature of the exception, and then throws (in my case, since my <code>App</code> type has an instance of <code>MonadError ServantErr</code>) a <code>ServantErr</code>.  </p>\n\n<p>My handler is something like this:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nimport           Control.Monad\nimport           Control.Monad.Catch\nimport           Control.Monad.IO.Class\nimport qualified Network.AWS as AWS\nimport           Servant\n\nimport App.Types\nimport App.Db\n\n\ncopy :: Copy -&gt; App Text\ncopy (Copy user bucket srcKey tgtKey) = do\n  err400 &lt;?? runDb (insertRecord $ User user bucket srcKey tgtKey)\n\n  catch (err500 &lt;?? liftIO $ do\n    env &lt;- AWS.newEnv AWS.Discover\n    void . AWS.runResourceT . AWS.runAWS env $ copyFiles bucket srcKey tgtKey\n    return \"OK\") (\\(e :: ServantErr) -&gt; rollback e user)\n  where rollback e u = runDb (deleteRecord u) &gt;&gt; throwError e\n</code></pre>\n\n<p>To test the logic, I moved my AWS credentials file, expecting that the inner AWS action would throw an <a href=\"https://hackage.haskell.org/package/amazonka-1.5.0/docs/Network-AWS-Auth.html#v:InvalidFileError\" rel=\"nofollow noreferrer\"><code>InvalidFileError</code></a>, then <code>(&lt;??)</code> would convert it to a <code>ServantErr</code>, then <code>catch</code> would catch this <code>ServantErr</code> and enact the rollback function.  What happens instead is that the insert succeeds, the <code>InvalidFileError</code> is logged, but then the rollback never occurs (i.e., the record still exists in the database after execution).  This <code>deleteRecord</code> function is used elsewhere successfully, so I can be sure it's not an issue with its definition.</p>\n\n<p>Any idea what could be causing this?</p>\n"}, {"tags": ["haskell", "type-signature"], "comments": [{"owner": {"reputation": 73231, "user_id": 156142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7dcad6d7e959ef6d6cfd67c6fb15c171?s=128&d=identicon&r=PG", "display_name": "ChaosPandion", "link": "https://stackoverflow.com/users/156142/chaospandion"}, "edited": false, "score": 1, "creation_date": 1553954403, "post_id": 55432131, "comment_id": 97582031, "body": "It looks like the first one might be a bit more flexible since <code>t</code> could conceivably equal <code>a</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 73231, "user_id": 156142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7dcad6d7e959ef6d6cfd67c6fb15c171?s=128&d=identicon&r=PG", "display_name": "ChaosPandion", "link": "https://stackoverflow.com/users/156142/chaospandion"}, "edited": false, "score": 1, "creation_date": 1553954484, "post_id": 55432131, "comment_id": 97582054, "body": "@ChaosPandion yes it is, but that&#39;s the mystery (to me as well when I&#39;ve looked at it!) - it&#39;s saying the function input <code>f</code> must have the same input and output type, but there is nothing obvious in the function definition which would so constrain <code>f</code>. In fact the only line which differs in the two definitions doesn&#39;t reference <code>f</code> at all!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 4, "creation_date": 1553958176, "post_id": 55432131, "comment_id": 97583093, "body": "same thing happens with <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/Data.Functor.Const.html#line-82\" rel=\"nofollow noreferrer\">the definition of <code>fmap</code> for <code>Const</code></a> btw. the value is repackaged in a <i>different</i> <code>Right</code>/<code>Const</code> constructor (which is polymorphic in the other type)."}, {"owner": {"reputation": 28015, "user_id": 63550, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RIZKi.png?s=128&g=1", "display_name": "Peter Mortensen", "link": "https://stackoverflow.com/users/63550/peter-mortensen"}, "edited": false, "score": 0, "creation_date": 1553981070, "post_id": 55432131, "comment_id": 97588915, "body": "What is this &quot;as-pattern&quot; that you speak of?"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 28015, "user_id": 63550, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RIZKi.png?s=128&g=1", "display_name": "Peter Mortensen", "link": "https://stackoverflow.com/users/63550/peter-mortensen"}, "edited": false, "score": 2, "creation_date": 1554006794, "post_id": 55432131, "comment_id": 97592859, "body": "@PeterMortensen An &quot;as-pattern&quot; is a pattern that uses the <code>@</code> symbol to assign a value to an identifier while also pattern matching on that value. Here that&#39;s <code>r@(Right _)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1553955590, "post_id": 55432264, "comment_id": 97582359, "body": "Related question, borne of the same quirk of types: <a href=\"https://stackoverflow.com/questions/30859917/how-do-i-avoid-writing-this-type-of-haskell-boilerplate-code/\" title=\"how do i avoid writing this type of haskell boilerplate code\">stackoverflow.com/questions/30859917/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 25, "last_activity_date": 1553956087, "last_edit_date": 1553956087, "creation_date": 1553954845, "answer_id": 55432264, "question_id": 55432131, "link": "https://stackoverflow.com/questions/55432131/why-the-difference-in-type-inference-over-the-as-pattern-in-two-similar-function/55432264#55432264", "title": "Why the difference in type-inference over the as-pattern in two similar function definitions?", "body": "<p>In the second line of <code>left'</code>:</p>\n\n<pre><code>left' _ r@(Right _) = r\n--      ^^^^^^^^^^^   ^\n</code></pre>\n\n<p>Since you use an as-pattern, you require the input type to be equal to the return type, since clearly they're the exact same value. <code>left'</code>'s type is then restricted to something of the form <code>a -&gt; b -&gt; b</code>.</p>\n\n<p>This restriction then propogates backwards to in turn restrict the function's type \u2013 hopefully you can see how; it's not too difficult.</p>\n\n<p>However, in the second line of <code>left</code>, you construct a new value</p>\n\n<pre><code>left _ (Right x) = Right x\n--                 ^^^^^^^\n</code></pre>\n\n<p>The type of this new value has not been restricted, and thus the same problem doesn't occur; it can be something of the form <code>a -&gt; b -&gt; c</code>, which is what you want.</p>\n\n<p>For this reason, the type of <code>left'</code> is more restricted than the type of <code>left</code>, which is what causes their types to be unequal.</p>\n\n<hr>\n\n<p><em>To illustrate this concept more concretely, I will describe to you more precisely how this restriction propogates backwards.</em></p>\n\n<p><em>We know that <code>left'</code>'s signature is of the form <code>(a -&gt; b) -&gt; Either a q -&gt; Either b q</code>. However, line 2 dictates that <code>Either a q = Either b q</code>, which means that <code>a = b</code>, so the type now becomes <code>(a -&gt; a) -&gt; Either a q -&gt; Either a q</code>.</em></p>\n"}, {"comments": [{"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "edited": false, "score": 0, "creation_date": 1554092569, "post_id": 55432405, "comment_id": 97610678, "body": "Thanks for your detailed explanations!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 19, "last_activity_date": 1553971199, "last_edit_date": 1553971199, "creation_date": 1553956039, "answer_id": 55432405, "question_id": 55432131, "link": "https://stackoverflow.com/questions/55432131/why-the-difference-in-type-inference-over-the-as-pattern-in-two-similar-function/55432405#55432405", "title": "Why the difference in type-inference over the as-pattern in two similar function definitions?", "body": "<p>The issue here is that there are some \"hidden\" types which make the difference. The type inference engine can infer those in the first case, but can't in the second case.</p>\n\n<p>When we use </p>\n\n<pre><code>Right :: forall a b. b -&gt; Either a b\n</code></pre>\n\n<p>we actually need to choose what types <code>a</code> and <code>b</code> are. Fortunately, type inference makes this choice for us in most cases.\nType <code>b</code> is easy to choose: it is the type of the value inside the argument of <code>Right</code>. Type <code>a</code> instead can be anything -- the inference engine has to rely on the context to \"force\" some choice for <code>a</code>. For instance, note that all of these type check:</p>\n\n<pre><code>test0 :: Either Int Bool\ntest0 = Right True\n\ntest1 :: Either String Bool\ntest1 = Right True\n\ntest2 :: Either [(Char, Int)] Bool\ntest2 = Right True\n</code></pre>\n\n<p>Now, in your first function</p>\n\n<pre><code>left :: (t -&gt; a) -&gt; Either t b -&gt; Either a b\nleft f (Left x) = Left (f x)\nleft _ (Right x) = Right x\n</code></pre>\n\n<p>The first matched <code>Right x</code> is actually <code>Right x :: Either t b</code>, where the implicit type arguments are chosen to be <code>t</code> and <code>b</code>. This makes <code>x</code> to have type <code>b</code>.\nWith this information, the type inference tries to determine the type for the second <code>Right x</code>. There, it can see that it should be of the form <code>Either ?? b</code> since <code>x :: b</code>, but, as it happened for our <code>test</code> examples above, we could use anything for <code>??</code>. So the type inference engine chooses another type variable <code>a</code> (a type which might be <code>t</code>, but could also be something else).</p>\n\n<p>Instead, in the second function</p>\n\n<pre><code>left' :: (t -&gt; t) -&gt; Either t b -&gt; Either t b\nleft' f (Left x) = Left (f x)\nleft' _ r@(Right _) = r\n</code></pre>\n\n<p>we give a name (<code>r</code>) to the <code>Right _</code> pattern. As above, that is inferred to have type <code>Either t b</code>. However, now we use the name <code>r</code> on the right of the <code>=</code>, so type inference does not have to infer anything there, and can (in fact, <em>must</em>) simply reuse the type it has already inferred for <code>r</code>. This makes the output type to be the same <code>Either t b</code> as the one for the input, and in turn this forces <code>f</code> to be of type <code>t -&gt; t</code>.</p>\n\n<p>If this is confusing, you could try to completely avoid type inference and provide an explicit choice for the types using the syntax <code>Right @T @U</code> to choose the function <code>U -&gt; Either T U</code>. (You'll need to turn on the <code>ScopedTypeVariables</code>, <code>TypeApplications</code> extensions for this, though.)\nThen we can write:</p>\n\n<pre><code>left :: forall t a b. (t -&gt; a) -&gt; Either t b -&gt; Either a b\nleft f (Left x) = Left @a @b (f x)\nleft _ (Right x) = Right @a @b x\n                      -- ^^ -- we don't have to pick @t here!\n</code></pre>\n\n<p>We can also have</p>\n\n<pre><code>left :: forall t b. (t -&gt; t) -&gt; Either t b -&gt; Either t b\nleft f (Left x) = Left @t @b (f x)\nleft _ (Right x) = Right @t @b x\n</code></pre>\n\n<p>and it would work just fine. GHC prefers the first type since it is more general, allowing <code>a</code> to be anything (including <code>t</code>, but also including other types).</p>\n\n<p>There's no type application to specify in the second definition, since it reuses the same value <code>r</code> on the right hand side as on the left:</p>\n\n<pre><code>left' :: forall t b. (t -&gt; t) -&gt; Either t b -&gt; Either t b\nleft' f (Left x) = Left @t @b (f x)\nleft' _ r@(Right x) = r\n                   -- ^^ -- can't pick @a here! it's the same as on the LHS\n</code></pre>\n"}], "owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 1, "accepted_answer_id": 55432264, "answer_count": 2, "score": 26, "last_activity_date": 1553971199, "creation_date": 1553954056, "last_edit_date": 1553955533, "question_id": 55432131, "link": "https://stackoverflow.com/questions/55432131/why-the-difference-in-type-inference-over-the-as-pattern-in-two-similar-function", "title": "Why the difference in type-inference over the as-pattern in two similar function definitions?", "body": "<p>I have the following two similar function definitions:</p>\n\n<pre><code>left f (Left x) = Left (f x)\nleft _ (Right x) = Right x\n\nleft' f (Left x) = Left (f x)\nleft' _ r@(Right _) = r\n</code></pre>\n\n<p>When I check the type signatures of the two functions, I am confused by the following types:</p>\n\n<pre><code>ghci&gt; :t left\nleft :: (t -&gt; a) -&gt; Either t b -&gt; Either a b\nghci&gt; :t left'\nleft' :: (a -&gt; a) -&gt; Either a b -&gt; Either a b\n</code></pre>\n\n<p>I suppose <code>left</code> and <code>left'</code> should be of the same type signature, but the haskell's type inference gives me a suprise. </p>\n\n<p>I can't figure out why the type signatures of <code>left</code> and <code>left'</code> are different. Can anybody give me some information? Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1553951600, "post_id": 55431747, "comment_id": 97581267, "body": "do you mean, for the last line, <code>| otherwise = reu&#39; (left (a, b))</code>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1553951623, "post_id": 55431747, "comment_id": 97581274, "body": "The stopping condition isn&#39;t when <code>a</code> <i>equals</i> a string with a single space; it&#39;s when <code>a</code> <i>ends</i> with a space."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553951667, "post_id": 55431747, "comment_id": 97581285, "body": "PS you can simplify this code at least a bit: <code>reverse(tail(reverse a))</code> is simply <code>init a</code>. (And even if you insist on chaining 3 functions, it would be more idiomatic to write it as <code>(reverse . tail . reverse) a</code>)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1553952510, "post_id": 55431747, "comment_id": 97581483, "body": "The line <code>reu&#39;(a, b) = left (a, b)</code> has the wrong indentation, it should start in the same column as the <code>reu&#39; ...</code> a few lines above."}, {"owner": {"reputation": 3, "user_id": 11281567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dec9a65287bf3c1e671aac89d537b2?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/11281567/craig"}, "edited": false, "score": 0, "creation_date": 1553952824, "post_id": 55431747, "comment_id": 97581549, "body": "Thank you very much guys, helped a lot."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553952943, "post_id": 55431747, "comment_id": 97581582, "body": "did you mean the expected result of <code>(&quot;This is an &quot; , &quot;example of a string&quot;)</code>, <code>(&quot;This is an&quot; , &quot; example of a string&quot;)</code>, or really the <code>(&quot;This is an&quot; , &quot;example of a string&quot;)</code>?"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1553953097, "post_id": 55431747, "comment_id": 97581619, "body": "To add onto robins comment, most of these basic functions on list exist already, you can find them with a quick search on <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">haskell.org/hoogle</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11281567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dec9a65287bf3c1e671aac89d537b2?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/11281567/craig"}, "edited": false, "score": 0, "creation_date": 1553979459, "post_id": 55432022, "comment_id": 97588520, "body": "Thank you for the help. Can you give me any reason why my question was down voted? I thought it was pretty well structured."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 0, "last_activity_date": 1553953334, "creation_date": 1553953334, "answer_id": 55432022, "question_id": 55431747, "link": "https://stackoverflow.com/questions/55431747/is-there-a-specific-way-to-call-a-function-within-another-function/55432022#55432022", "title": "Is there a specific way to call a function within another function?", "body": "<p>Because you need to analyze the <em>end</em> of <code>a</code>, the recursion will get a little hairy. I might use the pre-defined <code>init</code> and <code>last</code> functions to make this easier, and work with words, not individual characters. Note, this will replace the need for <code>left</code>.</p>\n\n<pre><code>reu' (String, String) -&gt; (String, String)\nreu' a b = let w = words a  -- [\"This\", \"is\", \"an\", \"ex\"]\n               a' = init w  -- [\"This\", \"is\", \"an']\n           in (unwords a', last w : b)\n</code></pre>\n\n<p>If you want to do the recursion yourself, it's simpler to reverse <code>a</code> <em>once</em>, and move characters from the <em>front</em> of that string to the front of <code>b</code>, then re-reverse what's left once you find the space.</p>\n\n<pre><code>reu' (String, String) -&gt; (String, String)\nreu' a b = reu'' (reverse a) b  -- reu'' \"xe si na sihT\" \"ample of a string\"\n     where reu'' \"\" ys = (\"\", ys)\n           reu'' (' ':xs) ys = (reverse xs, ys)\n           reu'' (x:xs) ys = reu'' xs (x:ys)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11281567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dec9a65287bf3c1e671aac89d537b2?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/11281567/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55432022, "answer_count": 1, "score": -1, "last_activity_date": 1553961720, "creation_date": 1553951208, "last_edit_date": 1553961720, "question_id": 55431747, "link": "https://stackoverflow.com/questions/55431747/is-there-a-specific-way-to-call-a-function-within-another-function", "title": "Is there a specific way to call a function within another function?", "body": "<p>I am setting up a recursive function which calls another function to shift the values from one string to another. I have everything working within function <code>left</code>, but i am struggling understanding the syntax on how to call the <code>left</code> function recursively.</p>\n\n<p>The function should stop when it detects white space (<code>\" \"</code>) in value <code>a</code>.</p>\n\n<pre><code>left :: (String, String) -&gt; (String, String) \nleft (a, b) = (reverse(tail(reverse a)), ((head(reverse a))) :b)\n\nreu' :: (String, String) -&gt; (String, String)\nreu' (a, b)\n    | a ==  \" \" = (a, b)\n    reu'(a, b) = left (a, b)\n</code></pre>\n\n<p>Input: <code>\"This is an ex\"\"ample of a string\"</code></p>\n\n<p>Expected: <code>\"This is an\"\"example of a string\"</code></p>\n"}, {"tags": ["haskell", "nix"], "answers": [{"comments": [{"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1554290371, "post_id": 55444213, "comment_id": 97694801, "body": "Yes, this is an improvement. However, I had hoped that it was possible to use the new fancy <code>nix search</code> command for it and from the IRC log I linked, I got the impression that it was possible. I just don&#39;t understand how."}], "tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": false, "score": 2, "last_activity_date": 1554057767, "creation_date": 1554057767, "answer_id": 55444213, "question_id": 55431482, "link": "https://stackoverflow.com/questions/55431482/how-do-i-search-for-haskell-packages-using-nix-search/55444213#55444213", "title": "How do I search for Haskell packages using &quot;nix search&quot;?", "body": "<p>You could save the result of this:</p>\n\n<pre><code>nix-env -f '&lt;nixpkgs&gt;' -qaP -A haskellPackages\n</code></pre>\n\n<p>And search that output each time instead?</p>\n\n<p>I think the issue is <code>&lt;nixpkgs&gt;</code> will have to be evaluated at each invocation, however if this was a static file/path - it would not need to be.</p>\n"}, {"comments": [{"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1595600329, "post_id": 62985982, "comment_id": 111539899, "body": "Thanks! Yes, this looks like exactly what I need. For it to work however, I needed to put it after any other overlays that modifies <code>haskellPackages</code>. Not sure why."}], "tags": [], "owner": {"reputation": 106, "user_id": 13890432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11e08f1420b8c6349a4b4b4ca8367ebe?s=128&d=identicon&r=PG&f=1", "display_name": "galagora", "link": "https://stackoverflow.com/users/13890432/galagora"}, "is_accepted": true, "score": 6, "last_activity_date": 1595195370, "last_edit_date": 1595195370, "creation_date": 1595194676, "answer_id": 62985982, "question_id": 55431482, "link": "https://stackoverflow.com/questions/55431482/how-do-i-search-for-haskell-packages-using-nix-search/62985982#62985982", "title": "How do I search for Haskell packages using &quot;nix search&quot;?", "body": "<p>As per the IRC chat, create a <code>~/.config/nixpkgs/overlays.nix</code> file containing this:</p>\n<pre class=\"lang-nix prettyprint-override\"><code>[\n  (self: super: {\n    haskellPackages = super.recurseIntoAttrs super.haskellPackages;\n  })\n]\n</code></pre>\n<p>This is an overlay that sets the <code>recurseForDerivations</code> attribute of the haskellPackages set to true. <code>recurseForDerivations</code> tells nix tools to traverse the set, which searches it in the case of <code>nix search</code>. It is currently undocumented, but implemented <a href=\"https://github.com/NixOS/nix/blob/d5ecb8d3cd8cb2ae63966025c914fd4beff0a6ea/src/libexpr/get-drvs.cc#L346-L355\" rel=\"noreferrer\">here</a>.</p>\n<p>The <a href=\"https://nixos.wiki/wiki/Overlays#On_the_user_level\" rel=\"noreferrer\">Nix wiki</a> describes where to put the overlay and the <a href=\"https://nixos.org/nixpkgs/manual/#sec-overlays-definition\" rel=\"noreferrer\">Nixpkgs manual</a> describes what overlays actually are and how to use them.</p>\n"}], "owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1153, "favorite_count": 0, "accepted_answer_id": 62985982, "answer_count": 2, "score": 5, "last_activity_date": 1595195370, "creation_date": 1553949234, "last_edit_date": 1587115996, "question_id": 55431482, "link": "https://stackoverflow.com/questions/55431482/how-do-i-search-for-haskell-packages-using-nix-search", "title": "How do I search for Haskell packages using &quot;nix search&quot;?", "body": "<p>I know that I can search for Haskell packages with nix-env by using </p>\n\n<pre><code>nix-env -f '&lt;nixpkgs&gt;' -qaP -A haskellPackages name_of_package\n</code></pre>\n\n<p>but that is slow and uncached. If I try to use the new command <code>nix search</code> all the Haskell packages are hidden.</p>\n\n<pre><code>$ nix search aeson\nerror: no results for the given search term(s)!\n</code></pre>\n\n<p>Is it possible to search for Haskell packages using the new <code>nix search</code> command? If so, how?</p>\n\n<hr>\n\n<p><strong>Edit:</strong> I found some discussion about this in <a href=\"https://logs.nix.samueldr.com/nixos/2019-01-09\" rel=\"nofollow noreferrer\">this</a> irc log, but I couldn't quite grasp what the suggestions would mean in practice. Specifically this part:</p>\n\n<pre><code>20:49 &lt;duairc&gt; How do I make nix search include haskellPackages?\n20:52 &lt;ottidmes&gt; duairc: you might try and call recurseIntoAttrs on haskellPackages\n20:52 &lt;rain1&gt; thanks\n20:52 &lt;LnL&gt; rain1: nix-env -f '&lt;nixpkgs&gt;' -qaP -A haskellPackages\n20:54 &lt;gchristensen&gt; duairc: ^\n20:54 &lt;duairc&gt; LnL: Thanks!\n20:55 &lt;LnL&gt; err, wrong person\n20:56 &lt;LnL&gt; you can also add an overlay that recurses, but that might make it\n      hard to find non haskell stuff if you're searching for something else\n20:56 &lt;ottidmes&gt; I can confirm that\n      haskellPackages = super.recurseIntoAttrs super.haskellPackages; works though\n20:58 &lt;duairc&gt; ottidmes: What do I do with that expression? Put it in\n      configuration.nix somewhere? If I type \"nix search ghcid\" then\n      will it find it?\n20:59 &lt;duairc&gt; Ah, you're using super, so I guess it's an overlay\n20:59 &lt;clever&gt; duairc: for `nix search` to find it, the overlay must be\n      somewhere in $HOME, i forget the exact path\n20:59 &lt;clever&gt; duairc: configuration.nix only effects nixos-rebuild and\n      nothing else\n21:00 &lt;ottidmes&gt; duairc: yeah, it should be put in your overlay that is\n      also used by nix-env the like, so not nixpkgs.overlays in your\n      configuration.nix as mentioned by clever, and then searching\n      for e.g. nix search nix-diff will result in:\n      * nixpkgs.haskellPackages.nix-diff (nix-diff)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1553960545, "post_id": 55431050, "comment_id": 97583694, "body": "if you&#39;d omit the type signature, you&#39;d get <code>generator :: (a -&gt; a) -&gt; a -&gt; b</code>, which could serve as a valuable hint. So maybe there&#39;s a value in <i>not</i> providing the signatures yourself, or at least temporarily removing them, as a debugging / development  technique."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1553948096, "creation_date": 1553948096, "answer_id": 55431323, "question_id": 55431050, "link": "https://stackoverflow.com/questions/55431050/generator-selector-pattern-to-calculate-approximations-in-haskell/55431323#55431323", "title": "Generator, Selector Pattern to calculate approximations in Haskell", "body": "<p>This definition</p>\n\n<pre><code>generator f a = generator f (f a)\n</code></pre>\n\n<p>never generates any list elements: it gets stuck into an infinite recursion instead. You probably want</p>\n\n<pre><code>generator f a = a : generator f (f a)\n</code></pre>\n\n<p>which makes <code>a</code> to be the first element, followed by all the others we generate using recursion.</p>\n\n<p>It could also be beneficial to avoid putting unevaluated thunks in the list. To avoid that, one could use</p>\n\n<pre><code>generator f a = a `seq` (a : generator f (f a))\n</code></pre>\n\n<p>so that <code>a</code> is evaluated early. This should not matter much in your code, since the \nselector immediately evaluates the thunks as soon as they are generated.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1553960798, "post_id": 55432917, "comment_id": 97583779, "body": "and next ;) get rid of <code>selector</code>, and just use <code>until</code> so no list fusion is even needed... :)"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1553959525, "creation_date": 1553959525, "answer_id": 55432917, "question_id": 55431050, "link": "https://stackoverflow.com/questions/55431050/generator-selector-pattern-to-calculate-approximations-in-haskell/55432917#55432917", "title": "Generator, Selector Pattern to calculate approximations in Haskell", "body": "<p>Your generator function is missing the <code>a:</code>, as <a href=\"https://stackoverflow.com/a/55431323/7509065\">chi's answer</a> correctly points out. However, there's a better solution than just adding that. Get rid of <code>generator</code> altogether, and use the built-in method <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:iterate\" rel=\"nofollow noreferrer\"><code>iterate</code></a> instead (or <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:iterate-39-\" rel=\"nofollow noreferrer\"><code>iterate'</code> from Data.List</a> if you want to avoid unevaluated thunks). These methods have the same behavior that you want from <code>generate</code>, but support optimizations like <a href=\"https://downloads.haskell.org/~ghc/8.6.4/docs/html/users_guide/glasgow_exts.html#list-fusion\" rel=\"nofollow noreferrer\">list fusion</a> that your own method won't. And of course, there's also the advantage that it's one less function that you have to write and maintain.</p>\n"}], "owner": {"reputation": 4230, "user_id": 1804317, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/84f00e56b203aec51a3104f1ed30c3da?s=128&d=identicon&r=PG", "display_name": "Jakob Abfalter", "link": "https://stackoverflow.com/users/1804317/jakob-abfalter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 55431323, "answer_count": 2, "score": 2, "last_activity_date": 1553959525, "creation_date": 1553945864, "question_id": 55431050, "link": "https://stackoverflow.com/questions/55431050/generator-selector-pattern-to-calculate-approximations-in-haskell", "title": "Generator, Selector Pattern to calculate approximations in Haskell", "body": "<p>I am trying to implement a generator, selector pattern to approximately calculate square roots in haskell</p>\n\n<p>My generator looks like this:</p>\n\n<pre><code>generator :: (Double -&gt; Double) -&gt; Double -&gt; [Double]\ngenerator f a           = generator f (f a)\n</code></pre>\n\n<p>My selector:</p>\n\n<pre><code>selector :: Double -&gt; [Double] -&gt; Double\nselector eps (a : b : r)\n  | abs(a - b) &lt;= eps   = b\n  | otherwise           = selector eps (b : r)\n</code></pre>\n\n<p>And the approx function:</p>\n\n<pre><code>next :: Double -&gt; Double -&gt; Double\nnext n x                = (x + n/x) / 2\n</code></pre>\n\n<p>Calling this like <code>selector 0.1 (generator (next 5) 2)</code>\nshould give me <code>...(next 5( next 5 (next 5 2)))</code> so <code>[2.25, 2.23611111111111, 2.2360679779158,...]</code> since my eps parameter is 0.1 <code>abs(a - b) &lt;= eps</code> should be true on the first execution giving me <code>2.23611111111111</code> as a result. I do however end in a endless loop. </p>\n\n<p>Could somebody explain to me what is wrong in the implementation of those functions?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["haskell", "error-handling", "floating-point", "integer"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1553922470, "post_id": 55428206, "comment_id": 97575175, "body": "Your input verification needs to go where you do your input, which you haven&#39;t shown us. It can&#39;t go in this function; that&#39;s way too late!"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1554140298, "post_id": 55428206, "comment_id": 97634071, "body": "You specified an <code>Integer</code> input in the type annotation, so if you try to pass anything else, the compiler will already give you an error about it being invalid."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11280341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb52cc2dd8af1b36c5a71d270ab98b5?s=128&d=identicon&r=PG&f=1", "display_name": "Zarathustra Van Bommel", "link": "https://stackoverflow.com/users/11280341/zarathustra-van-bommel"}, "edited": false, "score": 0, "creation_date": 1553924520, "post_id": 55428438, "comment_id": 97575489, "body": "Thank you very much! I apologise but im new to haskell and i am not too sure how i would implement this directly into my code... would you perhaps be able to show me?"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 11, "user_id": 11280341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb52cc2dd8af1b36c5a71d270ab98b5?s=128&d=identicon&r=PG&f=1", "display_name": "Zarathustra Van Bommel", "link": "https://stackoverflow.com/users/11280341/zarathustra-van-bommel"}, "edited": false, "score": 0, "creation_date": 1553925286, "post_id": 55428438, "comment_id": 97575583, "body": "@LaurensMellink I edited it, should have been <code>getLine</code> not <code>readLn</code> sorry."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1553954213, "post_id": 55428438, "comment_id": 97581975, "body": "While the function is, in fact, pure, that&#39;s not really important here. The point is that Haskell is statically typed, which means the <i>compiler</i> will catch any attempt to pass a non-<code>Integer</code> value as the argument to <code>days_in_Year</code>, rather than the function having to detect the type of the value passed to it at run time."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1553968814, "post_id": 55428438, "comment_id": 97585883, "body": "@chepner I think it is important here. You&#39;re saying having fixed the functions type, the compiler catches any attempts to pass a bad argument type therefore the error happens at compile-time. I&#39;m making the subjective point that the runtime error of detecting a bad input belongs in a different function (though you could modify the function to accept a string and do error handling here, one should not do so! And thus function should remain pure)."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1553970055, "post_id": 55428438, "comment_id": 97586247, "body": "@chepner Perhaps I was confusing the two somewhat, edited for clarity."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1553970969, "post_id": 55428438, "comment_id": 97586466, "body": "Also, the purity comes from not just the type, but the fact that the case analysis is exhaustive: the compiler guarantees that only an <code>Integer</code> can be passed, but the function definition is what ensures that each of those <code>Integer</code> values gets mapped to a <code>String</code>. <code>readMaybe</code> is also pure (unlike <code>read</code>), because we&#39;ve augmented the codomain from <code>Integer</code> to <code>Maybe Integer</code> to allow for those <code>String</code> values that can&#39;t be mapped to an <code>Integer</code> value."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1553975199, "post_id": 55428438, "comment_id": 97587542, "body": "@chepner Is that really so different to saying &quot;because you can use <code>error</code> anywhere then really you always have to inspect the implementation to determine a function&#39;s purity&quot;? Re. the second point, I&#39;ve been thinking about what &quot;purity&quot; actually means. I could argue <code>read</code> is just as pure as <code>readMaybe</code>; both are referentially transparent, but as you&#39;ve observed type doesn&#39;t actually prevent arbitrary errors (eg. <code>readMaybe</code> could run out of memory)."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1553975662, "post_id": 55428438, "comment_id": 97587656, "body": "@chepner Is <code>f :: IO a</code> pure? I think you could argue yes and no from different perspectives depending on the level at which you evaluate purity. But you do want to be able to colloquially say it&#39;s &quot;less pure&quot; than <code>f :: a</code>. Similarly for <code>f :: String -&gt; Maybe b&quot; vs </code>f&#39; :: a -&gt; b` with the parsing done outside <code>f&#39;</code>; I think <code>f&#39;</code> is &quot;purer&quot; even when parsing is done &quot;purely&quot; inside <code>f</code> with a <code>readMaybe</code>, and hence even <code>Maybe</code> is indicating some level of &quot;impurity&quot;."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1553977647, "post_id": 55428438, "comment_id": 97588142, "body": "You have to have a function before you can discuss purity, and <code>f :: IO a</code> is not a function. I don&#39;t know what you mean with comparisons of monomorphic to polymorphic types; it doesn&#39;t really have anything to do with purity. You don&#39;t have the option of writing an impure total function in Haskell, unless you do something ill-advised like use <code>unsafePerformIO</code>."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1553981472, "post_id": 55428438, "comment_id": 97588999, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/190967/discussion-between-a-tayler-and-chepner\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": true, "score": 4, "last_activity_date": 1553970006, "last_edit_date": 1553970006, "creation_date": 1553923306, "answer_id": 55428438, "question_id": 55428206, "link": "https://stackoverflow.com/questions/55428206/how-to-create-an-error-message-when-input-value-is-float-type-and-not-integer-ty/55428438#55428438", "title": "How to create an error message when input value is Float type and not Integer type in Haskell", "body": "<p>One of the major advantages of Haskell is that the type-system enforces the distinction of \"pure\" functions from \"impure\" functions. What you've got there is a pure function - you promise to give it an <code>Integer</code>, and the function promises to always give you a good result (no error). (These promises are contractually enforced by the compiler ie. at compile-time, because Haskell is a statically-typed language.) This makes code much easier to reason about. Whilst you do need to deal with what happens if the users input is badly behaved, and could modify the function (and it's type signature) to do so, it's good practice to put that code elsewhere - like where you parse the input from the user. </p>\n\n<p>Which begs the question, how are you getting user input such that it might be a <code>Integer</code> or a <code>Float</code> or a <code>Double</code>? A simple pattern would be something like eg.</p>\n\n<pre><code>import Text.Read\n\nmain = do\n    s &lt;- getLine\n    case readMaybe s of\n        Nothing -&gt; putStrLn \"Please enter an integer\"\n        Just x -&gt; putStrLn $ days_in_Year x\n</code></pre>\n\n<p>Here, because <code>x</code> is provided as an argument to <code>days_in_Year</code>, the compiler knows that you're trying to read the string <code>s</code> as an <code>Integer</code>, and if it can't (eg. because <code>s == \"5.0\"</code>), then it will just return <code>Nothing</code> and you can tell the user what went wrong.</p>\n"}], "owner": {"reputation": 11, "user_id": 11280341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb52cc2dd8af1b36c5a71d270ab98b5?s=128&d=identicon&r=PG&f=1", "display_name": "Zarathustra Van Bommel", "link": "https://stackoverflow.com/users/11280341/zarathustra-van-bommel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 55428438, "answer_count": 1, "score": -1, "last_activity_date": 1553970006, "creation_date": 1553920725, "last_edit_date": 1553924230, "question_id": 55428206, "link": "https://stackoverflow.com/questions/55428206/how-to-create-an-error-message-when-input-value-is-float-type-and-not-integer-ty", "title": "How to create an error message when input value is Float type and not Integer type in Haskell", "body": "<p>For a school assignment i have been given the task of creating a function that determines whether a year is a leap year or not. </p>\n\n<p>Below is what i have so far. e.g When i type, \"days_in_Year 2018\" it returns \"Non-Leap Year\". This function only works for Integer value inputs. I need some extra code that will return an error message when the input value is a double or float value. </p>\n\n<pre><code>days_in_Year :: Integer -&gt; String\ndays_in_Year year\n | year `mod` 400 == 0 = \"Leap Year\"\n | year `mod` 100 == 0 = \"Non-Leap Year\"\n | year `mod` 4 == 0   = \"Leap Year\"\n | otherwise = \"Non-Leap Year\"\n</code></pre>\n\n<p>I would like my function to be able to return \"Invalid Input\" when a double or float value is the input...</p>\n"}, {"tags": ["windows", "haskell", "sdl", "haskell-stack"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1553926026, "post_id": 55427120, "comment_id": 97575696, "body": "IIRC, you have to use <code>stack exec pacman</code> to install it."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 2, "creation_date": 1553928081, "post_id": 55427120, "comment_id": 97576057, "body": "Expanding on @arrowd&#39;s comment, try running <code>stack exec -- pacman -S mingw64&#47;mingw-w64-x86_64-SDL2</code>. Of course, this only works if you use Stack."}], "owner": {"reputation": 101, "user_id": 10515870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zSliZh5bm6g/AAAAAAAAAAI/AAAAAAAAAVU/c4vXo_Dxovg/photo.jpg?sz=128", "display_name": "Another Sad balloon", "link": "https://stackoverflow.com/users/10515870/another-sad-balloon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553906887, "creation_date": 1553906887, "question_id": 55427120, "link": "https://stackoverflow.com/questions/55427120/haskell-stack-cant-find-sdl-config-windows-10", "title": "haskell stack can&#39;t find sdl_config? windows 10", "body": "<p>I'm trying to install sdl model into haskell. I have this problem and I don't know where to put the sdl_config and how to set it up.</p>\n\n<p>I have tried mutiple ways to get sdl_config working, such as building it with Code::blocks but I never seem to get it to work.</p>\n\n<pre><code>[1 of 2] Compiling Main             ( C:\\Users\\name\\AppData\\Local\\Temp\\stack14648\\SDL-0.6.7.0\\Setup.lhs, C:\\Users\\name\\AppData\\Local\\Temp\\stack14648\\SDL-0.6.7.0\\.stack-work\\dist\\e626a42b\\setup\\Main.o )\n[2 of 2] Compiling StackSetupShim   ( C:\\sr\\setup-exe-src\\setup-shim-Z6RU0evB.hs, C:\\Users\\name\\AppData\\Local\\Temp\\stack14648\\SDL-0.6.7.0\\.stack-work\\dist\\e626a42b\\setup\\StackSetupShim.o )\nLinking C:\\Users\\name\\AppData\\Local\\Temp\\stack14648\\SDL-0.6.7.0\\.stack-work\\dist\\e626a42b\\setup\\setup.exe ...\nConfiguring SDL-0.6.7.0...\nconfigure: WARNING: unrecognized options: --with-compiler\nconfigure: loading site script /usr/local/etc/config.site\nchecking for sdl-config... no\nchecking for sdl11-config... no\nconfigure: error: *** SDL not found! Get SDL from www.libsdl.org.\nIf you already installed it, check it's in the path. If problem remains,\nplease send a mail to the address that appears in ./configure --version\nindicating your platform, the version of configure script and the problem.\n</code></pre>\n\n<p>I want haskell stack to be able to install SDL model into haskell without error.</p>\n"}, {"tags": ["haskell", "cpu", "branch-prediction"], "comments": [{"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1553904733, "post_id": 55426905, "comment_id": 97572960, "body": "How are you actually compiling and testing your code?"}, {"owner": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "reply_to_user": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1553904882, "post_id": 55426905, "comment_id": 97572988, "body": "@MarcTalbot I have edited in my .cabal config if that would help."}, {"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1553905001, "post_id": 55426905, "comment_id": 97573007, "body": "So you are building as unoptimized code?"}, {"owner": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "reply_to_user": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1553905452, "post_id": 55426905, "comment_id": 97573067, "body": "@MarcTalbot I think GHC does optimization by default? I did try <code>-O0</code> but it didn&#39;t change anything. Not even the speed of the sorting."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1553905587, "post_id": 55426905, "comment_id": 97573087, "body": "GHC does not do optimization by default. <code>-O0</code> means &quot;don&#39;t do optimization&quot;, and is the default. <code>-O2</code> is the first flag to try for enabling optimizations."}, {"owner": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1553905820, "post_id": 55426905, "comment_id": 97573116, "body": "@DanielWagner Thank you for pointing that out! I just tried <code>-O2</code>but it doesn&#39;t change anything."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1553906615, "post_id": 55426905, "comment_id": 97573209, "body": "From what I remember of dabbling at the generated code level, lazy evaluation pretty much destroys any hope of predicting branching. The predictor doesn&#39;t understand what a thunk is."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1553921774, "post_id": 55426905, "comment_id": 97575091, "body": "You can use <code>perf</code> to look at branch misses (and a lot of other metrics), and build an intuition for these things. A better first place to start though is just running with <code>RTS -s</code>"}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 6, "last_activity_date": 1553907073, "creation_date": 1553907073, "answer_id": 55427132, "question_id": 55426905, "link": "https://stackoverflow.com/questions/55426905/how-much-impact-does-branch-prediction-have-on-haskell-program/55427132#55427132", "title": "How much impact does branch prediction have on Haskell program?", "body": "<p>You called <code>sort</code> instead of <code>insertionSort</code> in your (supposed-to-be-) recursive case. That's a run-optimized merge sort, which handles reversed input in O(n) time. So your \"worst case\" is actually a near-best case for the algorithm as written, rather than as intended. </p>\n"}], "owner": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 55427132, "answer_count": 1, "score": 1, "last_activity_date": 1553907073, "creation_date": 1553904416, "last_edit_date": 1553904858, "question_id": 55426905, "link": "https://stackoverflow.com/questions/55426905/how-much-impact-does-branch-prediction-have-on-haskell-program", "title": "How much impact does branch prediction have on Haskell program?", "body": "<p>I am benchmarking insertion sort on worst case input (reverse ordered list) and random input.</p>\n\n<pre><code>import Control.Monad\nimport Data.List\nimport System.Random\nimport Control.Exception\nimport Control.DeepSeq\nimport Criterion.Main\n\n--- Sorting ---\ninsertionSort :: (Ord a) =&gt; [a] -&gt; [a]\ninsertionSort [] = []\ninsertionSort (x:xs) = x `insert` (sort xs)\n\n--- Generators ---\nworstCaseGen :: Int -&gt; [Int]\nworstCaseGen n = [n, n-1..1]\n\nbestCaseGen :: Int -&gt; [Int]\nbestCaseGen n = [1..n]\n\nrandomGen :: Int -&gt; StdGen -&gt; [Int]\nrandomGen n = take n . randoms\n\n--- Testing ---\nmain = do\n  gen &lt;- newStdGen\n  randomList &lt;- evaluate $ force $ randomGen 10000 gen\n  defaultMain [\n    bgroup \"Insertion Sort\" [ bench \"worst\" $ nf insertionSort (worstCaseGen 10000)\n                            , bench \"best\" $ nf insertionSort (bestCaseGen 10000)\n                            , bench \"gen\" $ nf last randomList\n                            , bench \"random\" $ nf insertionSort randomList\n                            ]\n    ]\n</code></pre>\n\n<p>While random input should perform at about the same magnitude as the worst case input, in reality the benchmark shows that it is about 20 times slower. My guess is that branch prediction kicks in and the random case is very hard to predict and thus becomes slower. Could this be true?</p>\n\n<p>This is my .cabal if it helps:</p>\n\n<pre><code>executable BranchPrediction\n  main-is:             Main.hs\n  build-depends:       base &gt;=4.12 &amp;&amp; &lt;4.13,\n                       random,\n                       criterion ==1.5.4.0,\n                       deepseq ==1.4.4.0\n  default-language:    Haskell2010\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1553902977, "post_id": 55426663, "comment_id": 97572605, "body": "Kind of. Derive Eq for A, then make a newtype A&#39; = A&#39; A, with a custom Eq.  Then A&#39; is your type. Whether that&#39;s with you the hassle depends on the situation"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 4, "creation_date": 1553903942, "post_id": 55426663, "comment_id": 97572808, "body": "This wouldn&#39;t be a lawful Eq instance. Eq is supposed to mean &quot;nothing in the object&#39;s public API can tell these two objects apart&quot;. Consider calling this comparison function something other than <code>(==)</code>."}, {"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1553904666, "post_id": 55426663, "comment_id": 97572946, "body": "@amalloy do you have a suggestion to handle equality for cyclic types? The reason why I wanted to modify Eq is to avoid unending equality checks."}, {"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1553904819, "post_id": 55426663, "comment_id": 97572974, "body": "I&#39;m sort of curious to know the real world ask that is hidden behind a stack overflow question."}, {"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "reply_to_user": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1553905087, "post_id": 55426663, "comment_id": 97573022, "body": "@MarcTalbot I&#39;m writing a compiler for school. The type data can be recursive (struct with itself as a field), and I want to represent it as such. I also plan on mapping every type to a class name, which is why I want to implement <code>Eq</code>. The alternative I can think of is to have no data within the <code>D</code> constructor (which represents a cycle), and instead manage the recursive types myself. Neither method really allows for &#39;lawful&#39; <code>Eq</code> instances though, since <code>D</code> would depend on the root type, which won&#39;t be compared."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1553907103, "post_id": 55426663, "comment_id": 97573290, "body": "@AllanW the natural derived instance wouldn&#39;t give &quot;unending equality checks&quot;. It would certainly have <i>recursive</i> equality checks, but provided your actual values don&#39;t have infinite recursion then the equality checks won&#39;t either. After all Haskell lists are a recursive data type, with an unproblematic <code>Eq</code> instance - and I don&#39;t see your example as being fundamentally different."}, {"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553911824, "post_id": 55426663, "comment_id": 97573894, "body": "@RobinZigmond an example would be a struct that has itself as a field. In this case, my type would recurse forever, given that one of the fields is defined by the root type."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554050797, "post_id": 55426663, "comment_id": 97601882, "body": "@RobinZigmond consider <code>let {x = 1 : x} in x == tail x</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1554053426, "post_id": 55426663, "comment_id": 97602555, "body": "@WillNess fair point, but note I did say &quot;<i>provided your actual values don&#39;t have infinite recursion</i> then the equality checks won&#39;t either&quot; - so this was something I anticipated. But I didn&#39;t expect the OP would be working with such values (although it seems now that they are)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1554053719, "post_id": 55426663, "comment_id": 97602640, "body": "@RobinZigmond I guess I reacted to the other sentence, about the &quot;unproblematic&quot; <code>Eq</code> instance for lists, without any qualifications..."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1553967309, "creation_date": 1553967309, "answer_id": 55434022, "question_id": 55426663, "link": "https://stackoverflow.com/questions/55426663/create-instance-class-for-a-specific-constructor/55434022#55434022", "title": "Create instance class for a specific constructor", "body": "<p>There's no straightforward way to incorporate the default <code>Eq A</code> instance generated by GHC into your own <code>Eq A</code> instance.  The problem is that generation of the code for the instances is tied to the process of defining those instances -- the only way to generate the default <code>Eq A</code> code is to actually generate the unique <code>Eq A</code> instance, and once the instance is generated, you can't really change it.  I don't see any way, even with GHC \"deriving\"-related extensions, of working around this problem.</p>\n\n<p>However, there's a reimplementation of the default <code>Eq</code> instance provided by the package <code>generic-deriving</code> which you could use.  With some preamble:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\nimport GHC.Generics\nimport Generics.Deriving.Eq  -- from package generic-deriving\n</code></pre>\n\n<p>define your data type with a derived <code>Generic</code> instance:</p>\n\n<pre><code>data A\n  = B Int\n  | C Float\n  | D A\n  deriving (Generic)\n</code></pre>\n\n<p>Then, define a <code>GEq</code> instance that implements your special case for the <code>D</code> constructor while deferring to the default implementation for the rest.</p>\n\n<pre><code>instance GEq A where\n  D _ `geq` D _ = True\n  x   `geq` y   = x `geqdefault` y\n</code></pre>\n\n<p>Finally, define an <code>Eq</code> instance the uses this generic equality class.</p>\n\n<pre><code>instance Eq A where\n  (==) = geq\n</code></pre>\n\n<p>After that, it should all work as expected:</p>\n\n<pre><code>&gt; D (B 10) == D (B 20)\nTrue\n&gt; B 10 == B 20\nFalse\n&gt; \n</code></pre>\n\n<p>However, it might be more reasonable to take the advice in the comments, and either:</p>\n\n<ol>\n<li><p>Do what @malloy suggests. The operation you're trying to define isn't really <code>(==)</code>, so why do need to name it <code>(==)</code>? Just derive the usual <code>Eq</code> instance and write a separate function to avoid the unwanted recursion:</p>\n\n<pre><code>equalClasses :: A -&gt; A -&gt; Bool\nequalClasses (D _) (D _) =  True\nequalClasses x y = x == y\n</code></pre></li>\n<li><p>If you really want to use a <code>(==)</code>, I think using a <code>newtype</code> as suggested by @luqui is probably the most idiomatic approach:</p>\n\n<pre><code>data A'\n  = B Int\n  | C Float\n  | D A'\n  deriving (Eq)\n\nnewtype A = A A'\n\ninstance Eq A where\n  A (D _) == A (D _) = True\n  A x == A y = x == y\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 55434022, "answer_count": 1, "score": 3, "last_activity_date": 1553967309, "creation_date": 1553902124, "question_id": 55426663, "link": "https://stackoverflow.com/questions/55426663/create-instance-class-for-a-specific-constructor", "title": "Create instance class for a specific constructor", "body": "<p>Say I have the following data:</p>\n\n<pre><code>data A\n  = B Int\n  | C Float\n  | D A\n</code></pre>\n\n<p>If I want to derive <code>Eq</code>, but change the output so that comparing two items with constructor <code>D</code> will always equal, is there a way to do so without implementing it for all other constructors? For the other cases, I would like to derive the default <code>Eq</code> implementation.</p>\n\n<p>What I want to achieve is something along the lines of</p>\n\n<pre><code>instance Eq A where\n  (D _) == (D _) = True\n  _ == _ = undefined -- Use default eq\n</code></pre>\n"}, {"tags": ["haskell", "random", "monads", "let"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1553894118, "post_id": 55425343, "comment_id": 97570248, "body": "<code>dupRand2</code> doesn&#39;t typecheck as written. Maybe you meant <code>pure [i, i]</code>?"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 2, "creation_date": 1553894189, "post_id": 55425343, "comment_id": 97570269, "body": "<code>dupRand2</code> throws errors for me too. <code>dupRand</code> gives different random values because you&#39;re saying, consider the action that generates a random int, now consider the list that contains that action twice, now run the actions in that list sequentially left-to-right."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1553894504, "post_id": 55425343, "comment_id": 97570362, "body": "leaving aside the fact that <code>dupRand2</code> doesn&#39;t type-check, the essential difference here is that <code>randomRIO (1,10)</code> is an &quot;IO action&quot; that generates a number, this isn&#39;t guaranteed to be the same number every time. Whereas <code>i &lt;- randomRIO (1,10)</code> &quot;runs&quot; the action and collects its result in the variable <code>i</code>, which means that when you later put 2 <code>i</code>s in a list they will always have the same value. It&#39;s a bit like the difference in an imperative language between calling your random-number-generating function twice, and calling it just once and printing the result twice."}, {"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "edited": false, "score": 0, "creation_date": 1553894925, "post_id": 55425343, "comment_id": 97570478, "body": "oops thanks, I did mean <code>pure</code> rather than <code>sequence</code> in <code>dupRand2</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1553895439, "post_id": 55425343, "comment_id": 97570622, "body": "I think this is a nearly exact duplicate of the question I linked in my close-vote. If you disagree, feel free to point out the difference and I&#39;ll vote to reopen."}, {"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1553895878, "post_id": 55425343, "comment_id": 97570741, "body": "@chi huh, I&#39;ve read that question before but somehow I asked this question anyway. i think the questions are very similar, but for people just learning haskell, reading the former question might not lead to a complete understanding of its implications (which resulted in this question). all that being said i&#39;m fine with closing this and marking it as a duplicate"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "edited": false, "score": 0, "creation_date": 1553895252, "post_id": 55425671, "comment_id": 97570564, "body": "got it thanks. I guess I still need to get out of my imperative mindset where <code>=</code> is like <code>bind</code> in haskell. is this only an artifact of trying to bind <code>i</code> to a random value? i.e. does this mean that in cases where <code>let i =</code> or <code>i &lt;-</code> to a pure value, the two <code>dup</code> functions would be the same?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "edited": false, "score": 1, "creation_date": 1553895407, "post_id": 55425671, "comment_id": 97570611, "body": "@zli, <code>let x = e</code> is almost the same as <code>x &lt;- pure e</code> within a <code>do</code> block. But <code>let</code> and <code>&lt;-</code> generally serve different purposes."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1553900736, "post_id": 55425671, "comment_id": 97572078, "body": "(Why &quot;almost the same&quot; and not &quot;the same&quot;? Two reasons: <code>let</code> can make polymorphic bindings, whereas <code>&lt;-</code> is monomorphic; and <code>let</code> can make recursive bindings, whereas by default <code>x &lt;- f x</code> will either be a scope error or merely shadow the existing <code>x</code> with a new one.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1553909138, "post_id": 55425671, "comment_id": 97573549, "body": "@DanielWagner, pattern match failure also works differently."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1553909228, "post_id": 55425671, "comment_id": 97573562, "body": "Oh, was <code>x</code> intended to stand in for any pattern rather than a variable specifically? I assumed you would use a different metavariable if you wanted to talk about patterns in general. Anyway, yes, of course for refutable patterns there is another difference."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1553909347, "post_id": 55425671, "comment_id": 97573575, "body": "@DanielWagner, I thought about calling it <code>p</code> to suggest that, but since my main point was that <code>let</code> and <code>&lt;-</code> are mostly for different things anyway, I figured I&#39;d let it go."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1553894852, "creation_date": 1553894852, "answer_id": 55425671, "question_id": 55425343, "link": "https://stackoverflow.com/questions/55425343/let-vs-do-in-monadic-values/55425671#55425671", "title": "let vs do in monadic values", "body": "<p>In</p>\n\n<pre><code>dupRand =\n  let i = randomRIO (1, 10)\n  in sequence [i, i]\n</code></pre>\n\n<p>you bind <code>i</code> to an <code>IO</code> action that, when run, will produce a random number. You make a list of two elements, each of which contains that action. Now</p>\n\n<pre><code>sequence\n  :: (Traversable t, Monad m)\n  =&gt; t (m a) -&gt; m (t a)\n</code></pre>\n\n<p>In this context, the <code>Traversable</code> is <code>[]</code> and the <code>Monad</code> is <code>IO</code>, so</p>\n\n<pre><code>sequence :: [IO a] -&gt; IO [a]\n</code></pre>\n\n<p>What this does is run each of the <code>IO</code> actions in a list, returning a list of their results in order. So when we run <code>sequence [i, i]</code>, we get a random number, get a random number, and then produce a list with both of them.</p>\n\n<p><code>dupRand2</code> doesn't typecheck. I'm guessing you meant</p>\n\n<pre><code>dupRand2 = do\n  i &lt;- randomRIO (1, 10)\n  pure [i, i]\n</code></pre>\n\n<p>This is syntactic sugar for</p>\n\n<pre><code>dupRand2 =\n  randomRIO (1, 10) &gt;&gt;= \\i -&gt;\n    pure [i, i]\n</code></pre>\n\n<p>When run, this action binds <code>i</code> to a random number (rather than an action producing one) and then returns a list with <code>i</code> repeated twice.</p>\n"}], "owner": {"reputation": 175, "user_id": 8005232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MnWoD.png?s=128&g=1", "display_name": "zli", "link": "https://stackoverflow.com/users/8005232/zli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "closed_date": 1553895352, "accepted_answer_id": 55425671, "answer_count": 1, "score": -1, "last_activity_date": 1553895290, "creation_date": 1553892738, "last_edit_date": 1553895290, "question_id": 55425343, "link": "https://stackoverflow.com/questions/55425343/let-vs-do-in-monadic-values", "closed_reason": "Duplicate", "title": "let vs do in monadic values", "body": "<p>What's the difference in using <code>let</code> or <code>do</code> when trying to work with monadic values? (not sure if this is the right way to phrase it)</p>\n\n<p>For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>--import System.Random\n\n*Main&gt; dupRand = let i = randomRIO (1, 10) in sequence [i, i]\n*Main&gt; :t dupRand\ndupRand :: (Random a, Num a) =&gt; IO [a]\n*Main&gt; dupRand\n[8,3]\n*Main&gt; dupRand\n[2,9]\n*Main&gt; dupRand\n[9,5]\n\n*Main&gt; dupRand2 = do i &lt;- randomRIO (1, 10); pure [i, i]\n*Main&gt; :t dupRand2\ndupRand2 :: (Random a, Num a) =&gt; IO [a]\n*Main&gt; dupRand2\n[6,6]\n*Main&gt; dupRand2\n[9,9]\n*Main&gt; dupRand2\n[5,5]\n</code></pre>\n\n<p>why is it that in <code>dupRand2</code>, the function successfully duplicates a random value, whereas in <code>dupRand</code>, the function just seems like it generates two random values?</p>\n"}, {"tags": ["function", "haskell", "definition", "type-declaration"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1553886893, "post_id": 55424155, "comment_id": 97567406, "body": "What&#39;s your thought process with  <code>mystery :: [a] -&gt; a -&gt; [a]</code>? Finding types is more an exercise of logic than anything else; if you can explain that, you can work out where you went wrong."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 2, "creation_date": 1553888949, "post_id": 55424155, "comment_id": 97568294, "body": "&quot;what in the lines of code can tell me to consider <code>Bool</code> in my type declaration?&quot; The call to <code>p</code> is used as a predicate in a guard, which is always type <code>Bool</code>."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 7, "last_activity_date": 1553887277, "creation_date": 1553887277, "answer_id": 55424265, "question_id": 55424155, "link": "https://stackoverflow.com/questions/55424155/figuring-out-type-declaration-for-hof-in-haskell/55424265#55424265", "title": "Figuring out type declaration for HOF in Haskell", "body": "<p>Here's what we know about <code>p</code>:</p>\n\n<ol>\n<li>It is applied to a value, so it must be a function. That makes its type <code>t1 -&gt; t2</code> for some types <code>t1</code> and <code>t2</code>.</li>\n<li>It is specifically applied to <code>head x</code>. Since you've already determined that <code>x :: [a]</code>, then <code>head x :: a</code>. This means <code>t1 ~ a</code>, and so <code>p :: a -&gt; t2</code>.</li>\n<li><code>p (head x)</code> is used in a context where a Boolean value is expected, so <code>p (head x) :: Bool</code>. This means <code>t2 ~ Bool</code>, and so <code>p :: a -&gt; Bool</code>.</li>\n</ol>\n\n<p>QED.</p>\n"}], "owner": {"reputation": 83, "user_id": 10683263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ce74c450bb01ac8d2b919e3bedcead3?s=128&d=identicon&r=PG&f=1", "display_name": "wwww", "link": "https://stackoverflow.com/users/10683263/wwww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553887277, "creation_date": 1553886738, "question_id": 55424155, "link": "https://stackoverflow.com/questions/55424155/figuring-out-type-declaration-for-hof-in-haskell", "title": "Figuring out type declaration for HOF in Haskell", "body": "<p>I am reviewing for an exam and one of the practice problems ask to write the type declaration </p>\n\n<pre><code>mystery :: ---complete here---- \nmystery x p\n    | p (head x) = tail x\n    | otherwise  = head x : mystery (tail x) p\n</code></pre>\n\n<p>Without looking at the answer, I thought mystery would be of type: </p>\n\n<p><code>mystery:: [a] -&gt; a -&gt; [a]</code> </p>\n\n<p>but when I look at the solution to compare: </p>\n\n<p><code>mystery:: [a] -&gt; (a -&gt; Bool) -&gt; [a]</code> </p>\n\n<p>Why is <code>a -&gt; Bool</code>? and what in the lines of code can tell me to consider <code>Bool</code> in my type declaration ?</p>\n"}, {"tags": ["function", "haskell", "type-declaration"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1553875475, "post_id": 55421297, "comment_id": 97561939, "body": "No-one said a higher-order function has to return a function. The term is a somewhat loose one, but usually means a function that <i>either</i> has a function as a parameter <i>or</i> returns one. <code>zipWith</code> takes a function as a parameter and thus is considered a higher-order function - but it certainly doesn&#39;t return a function."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553875553, "post_id": 55421297, "comment_id": 97561979, "body": "As for how to call <code>zipWith</code> (or your, equivalent, version <code>zipWith`</code>), you haven&#39;t supplied it with the function argument. Try, for example, <code>zipWith&#39; (+) [1,2] [3,4]</code> (should be <code>[4,6]</code>)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1553875876, "post_id": 55421297, "comment_id": 97562156, "body": "@RobinZigmond Well, technically it <i>does</i> return a function. It takes a <code>a -&gt; b-&gt; c</code>, and returns a <code>[a] -&gt; [b] -&gt; [c]</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1553876190, "post_id": 55421297, "comment_id": 97562306, "body": "@wwww Where do you get <code>[a] -&gt; [b] -&gt; [(a,b)]</code>? That is, indeed, the type of <code>zip</code>, but it is also the type of <code>zipWith&#39; (,)</code> (which is <code>zipWith&#39;</code> applied to <code>(,) :: a -&gt; b -&gt; (a,b)</code>)."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1553876432, "post_id": 55421297, "comment_id": 97562426, "body": "@chepner - that&#39;s true of course. I&#39;m ignoring currying for the purposes of this discussion and assuming we have true &quot;functions of multiple arguments&quot;."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1553876469, "post_id": 55421297, "comment_id": 97562442, "body": "Note that <code>a -&gt;  b -&gt; c</code> is , itself, the broadest possible type for a higher-order function. It accepts an argument of some type <code>a</code> (which may or may not itself be a function), and returns a function of type <code>b -&gt; c</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1553876531, "post_id": 55421297, "comment_id": 97562474, "body": "@RobinZigmond I think for this question, one actually <i>should</i> explicitly acknowledge currying. It helps explain why the first argument has to have type <code>a -&gt; b -&gt; c</code> instead of just <code>a -&gt; b</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553952419, "post_id": 55421297, "comment_id": 97581453, "body": "@wwww you call it as <code>zipWith&#39; (+) [1..22] [3..33]</code> or <code>zipWith&#39; (,) [1..22] &quot;Hello, world!&quot;</code> etc."}], "answers": [{"comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1553894839, "post_id": 55422998, "comment_id": 97570462, "body": "A glance at Hoogle suggests eg. mtl <code>gets</code> , <code>asks</code> for <code>(a-&gt;b)-&gt;c</code> type functions, though I concede this is a little bit cheating."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1553881703, "creation_date": 1553881703, "answer_id": 55422998, "question_id": 55421297, "link": "https://stackoverflow.com/questions/55421297/haskell-high-order-functions-function-declaration/55422998#55422998", "title": "Haskell High Order Functions, Function Declaration", "body": "<p>For this answer, we'll acknowledge that all functions are curried. That is, every function has a type <code>a -&gt; b</code>, where <code>a</code> and <code>b</code> are some type.</p>\n\n<hr>\n\n<p>A higher-order function is one whose type includes a function for <em>either</em> its argument <em>or</em> return type. Return values are easy: it's any function you ordinary think of as taking more than one argument:</p>\n\n<ul>\n<li><p><code>take :: Int -&gt; [a] -&gt; [a]</code>. It takes an <code>Int</code> and returns a (polymorphic) function that takes a list and returns a list.</p></li>\n<li><p><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code>. It takes a function (literally <em>any</em> function) and returns a function from lists to lists. The types of the return value is determined by the type of the argument.</p></li>\n</ul>\n\n<p>Higher-order functions that take an function and return something that isn't a function are actually somewhat rare. Perhaps a commenter will point out an obvious one I am overlooking, but until then, consider <code>fix :: (a -&gt; a) -&gt; a</code>.</p>\n\n<p>Now, <code>zipWith'</code> is an example of a higher-order function whose argument <em>itself</em> must be a higher-order function. The general type <code>a -&gt; b</code> can unify with an ordinary function like <code>ord :: Char -&gt; Int</code> (<code>a ~ Char</code> and <code>b ~ Int</code>) as well as a higher-order function like <code>(+)</code> (with <code>a ~ Num t =&gt; t</code> and <code>b ~ Num t =&gt; t -&gt; t</code>. The type <code>a -&gt; b -&gt; c</code> will <em>only</em> unify with higher-order functions. <code>a</code> may or may not be a function type, but <code>b -&gt; c</code> is an explicit function type.</p>\n\n<p>This means that once you apply <code>zipWith'</code> to some higher-order function, type inference gives you more information about what the types of <code>[a]</code>, <code>[b]</code>, and <code>[c]</code> must be in the resulting function.</p>\n\n<ul>\n<li><code>zipWith' (+)</code> tells you that <code>a ~ b ~ c ~ Num t =&gt; [t]</code>.</li>\n<li><code>zipWith' (,)</code> tells you that <code>a</code> and <code>b</code> are still unrestricted, but <code>c ~ (a, b)</code></li>\n<li><code>zipWith' (:)</code> tells you that <code>a</code> is unrestricted, but <code>b ~ c ~ [a]</code>.</li>\n</ul>\n\n<p>It may also help if you consider that <code>zip :: [a] -&gt; [b] -&gt; [(a,b)]</code> could be defined as <code>zip = zipWith' (,)</code>.</p>\n"}], "owner": {"reputation": 83, "user_id": 10683263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ce74c450bb01ac8d2b919e3bedcead3?s=128&d=identicon&r=PG&f=1", "display_name": "wwww", "link": "https://stackoverflow.com/users/10683263/wwww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553881703, "creation_date": 1553875344, "question_id": 55421297, "link": "https://stackoverflow.com/questions/55421297/haskell-high-order-functions-function-declaration", "title": "Haskell High Order Functions, Function Declaration", "body": "<p>I am studying for an exam and I'm confused at this function. Based on the output how do I know that the type declaration of the function is (a -> b -> c)? also, how I can evaluate my function?</p>\n\n<pre><code>zipWith' :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWith' _ [] _ = []\nzipWith' _ _ [] = []\nzipWith' f (x:xs) (y:ys) = f x y : zipWith' f xs ys\n</code></pre>\n\n<p>What I understand is that high order functions in haskell mean that they take a function as a parameter and return a function as well, right? how can I call this particular function? </p>\n\n<p>I did this: </p>\n\n<pre><code>zipWith' [1..5] ['a','z','r']\n</code></pre>\n\n<p>but I know is wrong because I am calling it as if it were the regular <code>zip</code> function that takes 2 lists and returns a tuple. I am just confused at the type declaration</p>\n\n<p><code>zipWith' :: [a] -&gt; [b] -&gt; [(a,b)]</code></p>\n"}, {"tags": ["haskell", "functor", "applicative"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 6, "creation_date": 1553871087, "post_id": 55419957, "comment_id": 97559252, "body": "<code>Right (+3) &lt;*&gt; Right 3</code> works. <code>Left</code> doesn&#39;t contain the type that the functor operates on. Furthermore, <code>Just (+3)</code> and <code>Left 4</code> are completely incompatible types."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1553871745, "post_id": 55419957, "comment_id": 97559694, "body": "So the the functor that contains the function has to be the same type as the functor that has the value ?"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 2, "creation_date": 1553873213, "post_id": 55419957, "comment_id": 97560594, "body": "Right.  More generally, when substituting a concrete type for a type variable (<code>f</code>, <code>a</code>, <code>b</code>), all occurrences of the variable get replaced with the same value."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1553874659, "post_id": 55419957, "comment_id": 97561481, "body": "@BercoviciAdrian Yes, precisely. You can use <code>&lt;*&gt;</code> to combine <code>Either String (Int -&gt; Bool)</code> and <code>Either String Int</code> into a <code>Etiher String Bool</code>. The <code>Either String</code> part must be the same: it&#39;s the same functor that is it used for the two arguments and the result type. Indeed, <code>(&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b</code> uses the same applicative functor <code>f</code> three times (e.g. <code>f = Either String</code>)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1553880597, "post_id": 55419957, "comment_id": 97564484, "body": "Look at the type for <code>&lt;*&gt;</code>: <code>Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b</code>. The same applicative functor is used throughout. What did you expect the result of <code>Just (+3) &lt;*&gt; Left 4</code> to be, <code>Just 7</code> or <code>Left 7</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 1, "creation_date": 1553873119, "post_id": 55420374, "comment_id": 97560532, "body": "There&#39;s a potential for confusion where you write &quot;does not match the required type&quot;.  These types do unify, as <code>Num n =&gt; Either (n -&gt; n) (a -&gt; b)</code> even though the Applicative instance doesn&#39;t do what the OP expected."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553873968, "post_id": 55420374, "comment_id": 97561060, "body": "Not only that, but <code>Left (+3) &lt;*&gt; Left 3</code> is an error because <code>3</code> and <code>(+3)</code> don&#39;t have the same type (unless you declare a <code>Num</code> instance for something like <code>(Num a) =&gt; a -&gt; a</code>)"}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 7, "last_activity_date": 1553876543, "last_edit_date": 1553876543, "creation_date": 1553872107, "answer_id": 55420374, "question_id": 55419957, "link": "https://stackoverflow.com/questions/55419957/why-does-applicative-work-default-only-for-maybe/55420374#55420374", "title": "Why does applicative work default only for Maybe", "body": "<p>The <code>Applicative</code> instance for <code>Either</code> is defined as:</p>\n\n<pre><code>instance Applicative (Either e) where ...\n</code></pre>\n\n<p>given the type of <code>(&lt;*&gt;)</code> is <code>Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b</code> for <code>Either</code> that is:</p>\n\n<pre><code>Either e (a -&gt; b) -&gt; Either e a -&gt; Either e b\n</code></pre>\n\n<p>The type of <code>Left</code> is <code>e -&gt; Either e a</code> so the type of <code>Left (+3)</code> is</p>\n\n<pre><code>Num a =&gt; Either (a -&gt; a) b\n</code></pre>\n\n<p>and the type of <code>Left 3</code> is:</p>\n\n<pre><code>Num a =&gt; Either a b\n</code></pre>\n\n<p>which leads to the type for <code>Left (+3) &lt;*&gt; Left 3</code> as <code>(Num a, Num (a -&gt; a)) =&gt; Either (a -&gt; a) b</code> which is unlikely to be what you intended.</p>\n\n<p>Since it's the type <code>b</code> which contains the function and value to operate on, using the <code>Right</code> constructor does work:</p>\n\n<pre><code>Right (+3) &lt;*&gt; Right 3\n=&gt; Right 6\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 55420374, "answer_count": 1, "score": 0, "last_activity_date": 1553876543, "creation_date": 1553870788, "question_id": 55419957, "link": "https://stackoverflow.com/questions/55419957/why-does-applicative-work-default-only-for-maybe", "title": "Why does applicative work default only for Maybe", "body": "<p>I am trying to understand why do applicative functors work by default (no implementation needed)  for some functors like <code>Maybe</code> but for others don't:</p>\n\n<p>Example:<Br>\n<code>Just (+3) &lt;*&gt; (Just 3)</code> works fine \"out of the box\"- > <code>6</code><br>\n<code>Left (+3) &lt;*&gt; Left 3</code> does not work <Br>\n<code>Just (+3) &lt;*&gt; Left 4</code> does not work even if i declare an <code>Either Int Int</code>.</p>\n\n<p>I assume in 99% of cases when dealing with pairs of : <code>(f (a-&gt;b) , f a)</code> you must implement the desired behaviour yourself (<strong>Cartesian Product</strong>  <code>(f (a-&gt;b)) X (f a)</code> ) and the first example is just something simple out of the box.</p>\n\n<p><strong>Example</strong>\nIn the case of <code>(Maybe (a-&gt;b) , Either c d)</code> we would need to cover all 4 cases:<Br>\n<code>Just - Left\n Just - Right\n Nothing - Left\n Nothing -Right</code><br><Br>\nAm i right in this assumption ?</p>\n"}, {"tags": ["haskell", "memory-leaks", "xml-conduit"], "answers": [{"tags": [], "owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1553863132, "creation_date": 1553863132, "answer_id": 55417621, "question_id": 55417620, "link": "https://stackoverflow.com/questions/55417620/heap-memory-buildup-with-xml-conduit-parsebytes/55417621#55417621", "title": "heap memory buildup with xml-conduit parseBytes", "body": "<p>If I change <code>get</code> to just return <code>[\"hi\"]</code> or something, I don't get the buildup. So it seems the returned texts keep some reference to the larger text they were in (e.g. zero-copy slicing, cf. comment at <a href=\"https://hackage.haskell.org/package/text-0.11.2.0/docs/Data-Text.html#g:18\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/text-0.11.2.0/docs/Data-Text.html#g:18</a> ), so the rest of the text can't be garbage collected even though we're using only little parts.</p>\n\n<p>Our fix is to use <code>Data.Text.copy</code> on any attributes we want to yield:</p>\n\n<pre><code>someattr &lt;- requireAttr \"n\"\nyield (T.copy someattr)\n</code></pre>\n\n<p>which lets us parse with nearly constant memory use.</p>\n\n<p>(And we might consider using <a href=\"https://markkarpov.com/post/short-bs-and-text.html#shorttext\" rel=\"nofollow noreferrer\">https://markkarpov.com/post/short-bs-and-text.html#shorttext</a> if we want to save even more memory.)</p>\n"}], "owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553863132, "creation_date": 1553863132, "question_id": 55417620, "link": "https://stackoverflow.com/questions/55417620/heap-memory-buildup-with-xml-conduit-parsebytes", "title": "heap memory buildup with xml-conduit parseBytes", "body": "<p>I'm parsing some rather large XML files with xml-conduit's streaming interface <a href=\"https://hackage.haskell.org/package/xml-conduit-1.8.0/docs/Text-XML-Stream-Parse.html#v:parseBytes\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/xml-conduit-1.8.0/docs/Text-XML-Stream-Parse.html#v:parseBytes</a> but I'm seeing this memory buildup (here on a small test file):</p>\n\n<p><a href=\"https://i.stack.imgur.com/wMeL9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wMeL9.png\" alt=\"heap use over time\"></a></p>\n\n<p>where the top users are:</p>\n\n<p><a href=\"https://i.stack.imgur.com/F3o6e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F3o6e.png\" alt=\"heap blame\"></a></p>\n\n<p>The actual data shouldn't take up that much heap \u2013 if I serialise and re-read, the resident memory use is kilobytes vs the megabytes here.</p>\n\n<p>The minimal example I've managed to reproduce this with:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE BangPatterns      #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nmodule Main where\n\nimport           Control.Monad\nimport           Control.Monad.IO.Class\nimport           Data.Conduit\nimport           Data.Conduit.Binary    (sourceFile)\nimport qualified Data.Conduit.List      as CL\nimport           Data.Text              (Text)\nimport           Text.XML.Stream.Parse\n\ntype Y = [(Text, Text)]\n\nmain :: IO ()\nmain = do\n  res1 &lt;- runConduitRes $\n          sourceFile \"test.xml\"\n          .| Text.XML.Stream.Parse.parseBytes def\n          .| parseMain\n          .| CL.foldM get []\n  print res1\n\nget :: (MonadIO m, Show a) =&gt; [a] -&gt; [a] -&gt; m [a]\nget acc !vals = do\n liftIO $! print vals           -- this oughta force it?\n return $! take 1 vals ++ acc\n\nparseMain = void $ tagIgnoreAttrs \"Period\" parseDetails\n\nparseDetails = many parseParam &gt;&gt;= yield\n\nparseParam = tag' \"param\" parseParamAttrs $ \\idAttr -&gt; do\n  value &lt;- content\n  return (idAttr, value)\n\nparseParamAttrs = do\n  idAttr &lt;- requireAttr \"id\"\n  attr \"name\"\n  return idAttr\n</code></pre>\n"}, {"tags": ["json", "haskell", "gadt"], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 11131000, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WwVbrifzhso/AAAAAAAAAAI/AAAAAAAABo0/f3smAW-he4Q/photo.jpg?sz=128", "display_name": "Cale Gibbard", "link": "https://stackoverflow.com/users/11131000/cale-gibbard"}, "is_accepted": true, "score": 1, "last_activity_date": 1553860853, "creation_date": 1553860853, "answer_id": 55417004, "question_id": 55416906, "link": "https://stackoverflow.com/questions/55416906/how-to-derive-json-instances-for-a-type-with-dependent-map/55417004#55417004", "title": "How to derive JSON instances for a type with dependent-map?", "body": "<p>There is a library here which has ToJSON and FromJSON instances for DSum and DMap.</p>\n\n<p><a href=\"https://github.com/obsidiansystems/dependent-sum-aeson-orphans\" rel=\"nofollow noreferrer\">https://github.com/obsidiansystems/dependent-sum-aeson-orphans</a></p>\n\n<p>Be sure to have a look at how they work, it's a nice example of what can be done with <a href=\"http://hackage.haskell.org/package/constraints-extras-0.2.3.4/docs/src/Data.Constraint.Extras.html#ArgDict\" rel=\"nofollow noreferrer\">constraints-extras</a>.</p>\n"}], "owner": {"reputation": 68390, "user_id": 55246, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c25ae0f8b2c34d0766717abab05b2efb?s=128&d=identicon&r=PG", "display_name": "Sridhar Ratnakumar", "link": "https://stackoverflow.com/users/55246/sridhar-ratnakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 55417004, "answer_count": 1, "score": 1, "last_activity_date": 1582999583, "creation_date": 1553860481, "last_edit_date": 1582999583, "question_id": 55416906, "link": "https://stackoverflow.com/questions/55416906/how-to-derive-json-instances-for-a-type-with-dependent-map", "title": "How to derive JSON instances for a type with dependent-map?", "body": "<p>I use <a href=\"http://hackage.haskell.org/package/dependent-map\" rel=\"nofollow noreferrer\"><code>dependent-map</code></a> to create a map of GADT values. My goal is to derive JSON instances for them. The <a href=\"https://github.com/obsidiansystems/aeson-gadt-th\" rel=\"nofollow noreferrer\"><code>aeson-gadt-th</code></a> library can derive JSON instances for the GADT itself (the <code>P</code> type below); however automatic deriving for the map of GADT values (the <code>DMap P Identity</code> type below) fails because of missing <code>Generic</code> instance on this type: <code>\u2022 No instance for (Generic (DMap P Identity))</code>. </p>\n\n<p>How do I generate <code>Generic</code> for this type?</p>\n\n<pre><code>import Data.Dependent.Map\n\ndata P a where\n  P_Title :: P Text\n\nderiveGEq ''P\nderiveGCompare ''P\nderiveJSONGADT ''P\n\nderiving instance ToJSON (DMap P Identity)\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong> After using the <code>dependent-sum-aeson-orphans</code> library per Cale's answer below:</p>\n\n<pre><code>import Data.Dependent.Sum.Orphans ()\n\ndata MyType = MyType (DMap P Identity)\n  deriving Generic\n\nderiving instance ToJSON MyType\n</code></pre>\n\n<p>I see a different error:</p>\n\n<pre><code>\u2022 Could not deduce: Data.Constraint.Extras.ConstraintsFor'\n                      P ToJSON Identity\n</code></pre>\n\n<p>If <code>DMap P Identity</code> already has JSON instances (per the orphan import) why does a simple type wrapper not? </p>\n\n<hr>\n\n<p><strong>EDIT 2</strong>: Okay, after some exploration of the code and examples of the referenced libraries I realized I needed to derive <code>ArgDict</code>, after which everything works!</p>\n\n<pre><code>import Data.Constraint.Extras.TH\n\nderiveArgDict ''P\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553857481, "post_id": 55415983, "comment_id": 97550942, "body": "I would prefer to use pattern matching that explicit <code>case</code> statements - but either way you need separate cases for these 2. The only way I think to use a single statement with an &quot;or&quot; operator is to use guards - which I personally find less readable here than putting each case on a separate line. In any case, the best solution here to reducing redundancy is to use a type which doesn&#39;t have this redundancy built in. (ie. it has only one way to represent the empty list)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1553857769, "post_id": 55415983, "comment_id": 97551115, "body": "Ocaml has &quot;or patterns&quot; similar to the one you mention, but Haskell does not. You need to use two <code>case</code> branches. Alternatively, one could exploit view patterns / pattern synonyms to create a single branch, but that would require some preliminary boilerplate, making the code longer."}, {"owner": {"reputation": 124, "user_id": 1219507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxtPY.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/1219507/dave"}, "edited": false, "score": 2, "creation_date": 1553859084, "post_id": 55415983, "comment_id": 97551847, "body": "you could use _  that cover all other options so do the non empty first and use _ for the rest of your cases"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 2, "creation_date": 1553860550, "post_id": 55415983, "comment_id": 97552660, "body": "If you are learning on your own then I would have a look at this one <code>data List&#39; a = Empty | Node a Int List&#39;</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1553861612, "post_id": 55415983, "comment_id": 97553285, "body": "Are there <i>any</i> functions which should return different results for <code>EmptyList</code> and <code>List []</code>? What do they do?"}, {"owner": {"reputation": 105, "user_id": 11091357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22dccf8dd26dd3508969d61a30f4646f?s=128&d=identicon&r=PG&f=1", "display_name": "SadisticSardines", "link": "https://stackoverflow.com/users/11091357/sadisticsardines"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1553866288, "post_id": 55415983, "comment_id": 97556045, "body": "@DanielWagner nope there are no such functions. That&#39;s why I wanted to combine the two cases. I know how to do it using guards or multiple declarations but was wondering if this could be achieved using case expressions or not."}, {"owner": {"reputation": 105, "user_id": 11091357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22dccf8dd26dd3508969d61a30f4646f?s=128&d=identicon&r=PG&f=1", "display_name": "SadisticSardines", "link": "https://stackoverflow.com/users/11091357/sadisticsardines"}, "reply_to_user": {"reputation": 124, "user_id": 1219507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxtPY.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/1219507/dave"}, "edited": false, "score": 0, "creation_date": 1553866706, "post_id": 55415983, "comment_id": 97556343, "body": "@dave yep good point, I guess I&#39;ll have to go with that. But still, I&#39;m kinda surprised at this limitation."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 11091357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22dccf8dd26dd3508969d61a30f4646f?s=128&d=identicon&r=PG&f=1", "display_name": "SadisticSardines", "link": "https://stackoverflow.com/users/11091357/sadisticsardines"}, "edited": false, "score": 0, "creation_date": 1553866418, "post_id": 55416537, "comment_id": 97556132, "body": "Size was just an example function. But I like your idea of <code>_</code>  as I can use it to achieve the same in cases I suppose. I am aware of how it can be achieved using guards/multiple declarations. What I was wondering whether it was possible to combine cases together or not."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1553935840, "post_id": 55416537, "comment_id": 97577555, "body": "<code>elem</code> introduces an Eq constraint, which is quite a bummer for this function"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1553963560, "post_id": 55416537, "comment_id": 97584484, "body": "@amalloy yes \u2013 that&#39;s what I meant with \u201ceven worse style\u201d, but I should have elaborated."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1553963655, "last_edit_date": 1553963655, "creation_date": 1553859116, "answer_id": 55416537, "question_id": 55415983, "link": "https://stackoverflow.com/questions/55415983/case-of-case-expression-with-or-in-pattern-matching-possible/55416537#55416537", "title": "case-of / case expression with or in pattern matching possible?", "body": "<p>First of all you should consider why you have separate constructors for <code>List</code> and <code>EmptyList</code> in the first place. The empty list clearly is already a special case of a list anyway, so this is an awkward redundancy. If anything, you should make it</p>\n\n<pre><code>import Data.List.NonEmpty\ndata List' a = NEList (NonEmpty a) | EmptyList\n</code></pre>\n\n<p>Another option that would work for this specific example is to make the empty case into a \u201ccatch-all pattern\u201d:</p>\n\n<pre><code>size :: List -&gt; Int\nsize lst = case lst of\n  (List (x:xs)) -&gt; 1 + size (List xs)\n  _ -&gt; 0\n</code></pre>\n\n<p>BTW there's no reason to use <code>case</code> here, you can also just write two function clauses:</p>\n\n<pre><code>size :: List -&gt; Int\nsize (List (x:xs)) = 1 + size (List xs)\nsize _ = 0\n</code></pre>\n\n<p>Anyways \u2013 this is generally discouraged, because catch-all clauses are an easy place for hard to detect bugs to creep in if you extend your data type in the future.</p>\n\n<p>Also possible, but even worse style is to use a boolean <em>guard match</em> \u2013 this can easily use lookups in a list of options, like</p>\n\n<pre><code>size lst | lst`elem`[EmptyList, List []] = 0\nsize (List (x:xs)) = 1 + size (List xs)\n</code></pre>\n\n<p>Equality checks should be avoided if possible; they introduce an <code>Eq</code> constraint which, quite needlessly, will require the <em>elements</em> to be equality-comparable. And often equality check is also more computationally expensive than a pattern match.</p>\n\n<p>Another option if you can't change the data structure itself but <em>would</em> like to work with it as if <code>List []</code> and <code>EmptyList</code> were the same thing would be to write custom <em>pattern synonyms</em>. This is a relatively recent feature of Haskell; it kind of <em>pretends</em> the data structure is actually different \u2013 like <code>List'</code> \u2013 from how it's really layed out.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1553869859, "creation_date": 1553869859, "answer_id": 55419653, "question_id": 55415983, "link": "https://stackoverflow.com/questions/55415983/case-of-case-expression-with-or-in-pattern-matching-possible/55419653#55419653", "title": "case-of / case expression with or in pattern matching possible?", "body": "<p>In the comments, you say</p>\n\n<blockquote>\n  <p>there are no such functions [which should return different results for <code>EmptyList</code> and <code>List []</code>]</p>\n</blockquote>\n\n<p>therefore I recommend merging these two constructors in the type itself:</p>\n\n<pre><code>data List = List [String] deriving Show\n</code></pre>\n\n<p>Now you no longer need to distinguish between <code>EmptyList</code> and <code>List []</code> in functions that consume a <code>List</code>.</p>\n\n<p>...in point of fact, I would go even further and elide the definition entirely, simply using <code>[String]</code> everywhere instead. There is one exception to this: if you need to define an instance for a class that differs in behavior from <code>[String]</code>'s existing instance. In that exceptional case, defining a new type is sensible; but I would use <code>newtype</code> instead of <code>data</code>, for the usual efficiency and semantics reasons.</p>\n"}], "owner": {"reputation": 105, "user_id": 11091357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22dccf8dd26dd3508969d61a30f4646f?s=128&d=identicon&r=PG&f=1", "display_name": "SadisticSardines", "link": "https://stackoverflow.com/users/11091357/sadisticsardines"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1553963655, "creation_date": 1553857219, "question_id": 55415983, "link": "https://stackoverflow.com/questions/55415983/case-of-case-expression-with-or-in-pattern-matching-possible", "title": "case-of / case expression with or in pattern matching possible?", "body": "<p>I am learning haskell on my own. And was working on implementing a custom List data type using basic lists and case of.</p>\n\n<p>So data structure is something similar to this</p>\n\n<pre><code>data List = List [String] | EmptyList deriving Show\n</code></pre>\n\n<p>now if I am doing case expressions for base case, I have to do two matchings. A simple example would be the size function</p>\n\n<pre><code>size :: List -&gt; Int\nsize lst = case lst of\n  (List []) -&gt; 0\n  EmptyList -&gt; 0\n  (List (x:xs)) -&gt; 1 + size (List xs)\n</code></pre>\n\n<p>Can't I do something like combining the two base cases of list being empty <code>(List [])</code> and <code>EmptyList</code> somehow to reduce redundancy? </p>\n\n<pre><code>size :: List -&gt; Int\nsize lst = case lst of\n  (List []) | EmptyList -&gt; 0\n  (List (x:xs)) -&gt; 1 + size (List xs)\n</code></pre>\n\n<p>I have tried searching all over the net for this, but unfortunately wasn't able to find anything concrete over matching multiple patterns in one case.</p>\n"}, {"tags": ["haskell", "types", "io", "appendfile"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 2, "creation_date": 1553849816, "post_id": 55413537, "comment_id": 97546466, "body": "Do you mean typedAction :: Action ? in which case, (T.pack . show $ typedAction) would work. Alternatively, with the text-show package, (showt typedAction)"}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1553855270, "post_id": 55413537, "comment_id": 97549594, "body": "Thanks. That works as an intermediate solution if I were to use that and eventually store that using <code>TIO.appendFile</code>, but it is a bit of a hassle compared to directly writing the <code>Action</code> type and concrete content to file"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1553856031, "post_id": 55413537, "comment_id": 97550125, "body": "It&#39;s unclear what you mean @Madderote. Do you wish to store it in eg. JSON so that you can load it back from the file? Your title suggests you don&#39;t understand the difference between types and typeclasses; Text is a type so it doesn&#39;t have instances."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1553856752, "post_id": 55413537, "comment_id": 97550505, "body": "I understand the difference. Figured it out already thanks to your comment! If I save as &#39;shown&#39; it saves the complete concrete type record syntax. That&#39;s nice if you stay within Haskell, but I need a uniform text file, so won&#39;t work. It works if I use the type <code>Action</code> in Haskell, deconstruct it for storage and reconstruct it when reading."}, {"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 3, "creation_date": 1553860113, "post_id": 55413537, "comment_id": 97552430, "body": "You can serialize your class however you want.  The instance of <code>Show</code> will give you a default behavior to make a string out of your class, but you&#39;ve chosen to use the default instance.  You could either remove the <code>deriving Show</code> and make <code>Action</code> an instance of <code>Show</code> with your own <code>show</code> function, or you could write another function that turns an <code>Action</code> into <code>Text</code>."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1553880255, "post_id": 55413537, "comment_id": 97564329, "body": "So are you asking 1. How do I serialize a value, such as <code>Action</code> (ex to JSON or another format)?  2. How do I write such a serialized value to disk?  Or alternatively: what does it mean to you to &quot;directly writ[e] the <code>Action</code>&quot;?  What would be placed in the file if not the text obtained from <code>show someAction</code>?"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553849239, "creation_date": 1553849239, "question_id": 55413537, "link": "https://stackoverflow.com/questions/55413537/haskell-possible-make-own-type-instance-of-text", "title": "Haskell possible make own type instance of Text", "body": "<p>Noob here again. Getting my feet wet in making my own Haskell 'programs'. Stumbled across this. \nMade my own type: </p>\n\n<pre><code>data Action = Action \n  { idN         :: IdN\n  , description :: Desc \n  , duedate     :: Due \n  , donedate    :: Done \n  } deriving (Ord, Show, Read, Eq) \n</code></pre>\n\n<p>Imported <code>Data.Text.IO</code>. Want to write concrete info in <code>Action</code> to file using </p>\n\n<pre><code>TIO.appendFile \"./Dbase.txt\" typedAction\n</code></pre>\n\n<p>where <code>typedAction</code> is the concrete representation of the <code>Action</code> type. Now <code>Action</code> is not of type <code>Text</code>.\nSo how would I go about this?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1553849966, "post_id": 55412418, "comment_id": 97546550, "body": "<code>f x = x (x $) = x x</code>. It has no type, lambda or no lambda. By eta-expansion <code>f x y = x x y</code> which still has no type.  <code>g x = id x = x</code>.   I can&#39;t follow your reasoning."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553854625, "post_id": 55412418, "comment_id": 97549218, "body": "@WillNess It has no Rank-1 type but it has a Rank-2 type: <code>(forall a. a -&gt; b) -&gt; b</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1553860353, "post_id": 55412418, "comment_id": 97552559, "body": "@AaditMShah interesting. doesn&#39;t look like it helps us to type <code>f . (. f)</code> though. :)"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553860431, "post_id": 55412418, "comment_id": 97552591, "body": "@WillNess Lol, the Y combinator? Let me try to see if I can devise a type for that. Most likely I won&#39;t be able to though. AFAIK, little omega can&#39;t be typed."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1553860573, "post_id": 55412418, "comment_id": 97552674, "body": "@AaditMShah I googled for &quot;does y combinator have a Rank-2 type&quot; and no immediately apparent &quot;yes / no&quot; answer has popped up. Of course it can be done with a newtype..."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553860850, "post_id": 55412418, "comment_id": 97552837, "body": "@WillNess Well, the y combinator is known to have a rank-1 type (i.e. <code>(a -&gt; a) -&gt; a</code>). That&#39;s not the problem. The problem is defining the y combinator in terms of little omega and getting it to type check."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1553861440, "post_id": 55412418, "comment_id": 97553185, "body": "@AaditMShah yes, that&#39;s what is usually meant by &quot;Y combinator&quot;, I think."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1553873315, "post_id": 55412418, "comment_id": 97560656, "body": "@AaditMShah <code>\\ x -&gt; f (x x)</code> can have type <code>(forall a. a) -&gt; T</code> provided <code>f : T -&gt; T</code>. We won&#39;t be able to apply it to itself to obtain Y though. BTW, isn&#39;t little-omega <code>\\x -&gt; x x</code>, which you just typed using rank-2 types?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1553879980, "post_id": 55412418, "comment_id": 97564217, "body": "@chi Yes, I provided a type for little omega but it was too restrictive. Didn&#39;t allow <code>\u03c9 . (. \u03c9)</code> (which is the y combinator)."}], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1553852446, "post_id": 55413841, "comment_id": 97547880, "body": "Deleted and apologise."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 2, "creation_date": 1553852633, "post_id": 55413841, "comment_id": 97547982, "body": "Slightly more strictly: <code>f x = x x</code> can be typed with rank-2 types (so in GHC, but not in standard Haskell), but not inferred."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 1, "creation_date": 1553854438, "post_id": 55413841, "comment_id": 97549108, "body": "I agree with @AlexeyRomanov. You can assign the type <code>(forall a. a -&gt; b) -&gt; b</code> to <code>f x = x x</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1553856120, "post_id": 55413841, "comment_id": 97550168, "body": "@AlexeyRomanov Agreed, thanks. I updated my last paragraph accordingly. I often get that wrong since in System F there is no way of typing <code>x x</code>, and at best we can type <code>x @T x</code> -- but Haskell adds the implicit <code>@T</code> for us, making <code>x x</code> work :)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 1, "creation_date": 1553856239, "post_id": 55413841, "comment_id": 97550231, "body": "@AaditMShah Ah, right. In my amended answer I opted for the shorter type <code>f :: (forall a. a) -&gt; b</code>, but yours is more useful, since it allows non-bottom constant functions."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1553858084, "post_id": 55413841, "comment_id": 97551292, "body": "<code>f x y = x x y</code> is eta-equivalent to the correct definition, so not altogether wrong. the &quot;derivation&quot; is completely out of it, though."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553859359, "post_id": 55413841, "comment_id": 97552003, "body": "@WillNess For the second definition, I think the OP conveniently ignored the parentheses. Hence, <code>g = \\x -&gt; (\\y -&gt; y) x</code> became <code>g = \\x -&gt; \\y -&gt; y x</code>. Similarly, for the first definition, the OP conveniently ignored the parentheses and also moved all the binders to the left. Hence, <code>f = \\x -&gt; x (\\y -&gt; x y)</code> became <code>f = \\x -&gt; \\y -&gt; x x y</code>. The OP just got lucky in that the semantics of the first definition wasn&#39;t changed."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1553860484, "post_id": 55413841, "comment_id": 97552620, "body": "@AaditMShah likely so. they seem to implicitly ask for general conversion steps... this might be too broad though."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553863901, "post_id": 55413841, "comment_id": 97554566, "body": "@WillNess I totally missed that! Thanks. Still, I agree with Aadit in that the OP likely got the parentheses wrong, and the result is only incidentally correct. To void confusing the OP too much I&#39;ll leave my answer roughly as it is."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553872743, "post_id": 55413841, "comment_id": 97560300, "body": "@chi me too. :) I even started writing a lengthy answer about how it&#39;s completely wrong. had to scrap it. :)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1553863998, "last_edit_date": 1553863998, "creation_date": 1553850348, "answer_id": 55413841, "question_id": 55412418, "link": "https://stackoverflow.com/questions/55412418/how-to-understand-nested-lambda-functions-in-haskell/55413841#55413841", "title": "How to understand nested lambda functions in Haskell", "body": "<p>Neither is correct. Your solution uses the functions</p>\n\n<pre><code>f x y = x x y\ng x y = y x\n</code></pre>\n\n<p>which actually mean</p>\n\n<pre><code>f = \\x -&gt; (\\y -&gt; x x y)\ng = \\x -&gt; (\\y -&gt; y x)\n</code></pre>\n\n<p>and those differ from the original expressions</p>\n\n<pre><code>f = \\x -&gt; x (\\y -&gt; x y)\ng = \\x -&gt; (\\y -&gt; y) x\n</code></pre>\n\n<p>The above two equations can be rewritten as</p>\n\n<pre><code>f x = x (\\y -&gt; x y)\ng x = (\\y -&gt; y) x\n</code></pre>\n\n<p>But from here, there is no way to turn the remaining lambdas into more arguments for <code>f</code> or <code>g</code>. At best, we can simplify them using beta/eta conversion and get</p>\n\n<pre><code>f x = x x            -- eta  (\\y -&gt; x y) = x\ng x = x              -- beta (\\y -&gt; y) x = x\n</code></pre>\n\n<p>(Also see the comment below by Will Ness, who points out that through an additional eta expansion in <code>f</code> we could reach the OP's definition. Still, that is incidental.)</p>\n\n<p>Finally, note that Haskell will not accept <code>f x = x x</code> since that can not be typed, unless we use rank-2 types and explicitly provide a type annotation like <code>f :: (forall a. a) -&gt; b</code>. The original code <code>f = \\x -&gt; x (\\y -&gt; x y)</code> suffers from the same issue. That would also be fine in untyped languages, e.g. the untyped lambda calculus in programming languages theory.</p>\n"}, {"tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": false, "score": 1, "last_activity_date": 1553852188, "last_edit_date": 1553852188, "creation_date": 1553851727, "answer_id": 55414246, "question_id": 55412418, "link": "https://stackoverflow.com/questions/55412418/how-to-understand-nested-lambda-functions-in-haskell/55414246#55414246", "title": "How to understand nested lambda functions in Haskell", "body": "<p>The <code>:type</code> command at the GHCi prompt is your friend. Let's take your second example first</p>\n\n<pre><code>\u03bb&gt; :type let g = \\x -&gt; (\\y -&gt; y) x in g\nlet g = \\x -&gt; (\\y -&gt; y) x in g :: p -&gt; p\n</code></pre>\n\n<p>So <code>g</code> is well-typed and is a convoluted way to write an identity function <code>:: p -&gt; p</code>. Specifically, <code>g</code> takes some <code>x</code> and applies an identity function <code>(\\y -&gt; y)</code> to <code>x</code>, resulting in <code>x</code>. GHCi in giving the type uses a fresh type name <code>p</code>, to avoid confusion. No your <code>g x y = ...</code> is not equivalent. (Check it with <code>:type</code>.)</p>\n\n<p>You can abbreviate <code>:type</code> to just <code>:t</code>. Then let's take your first example.</p>\n\n<pre><code>\u03bb&gt; :t let f = \\x -&gt; x (\\y -&gt; x y) in f\n* Occurs check: cannot construct the infinite type: t2 ~ t2 -&gt; t3\n* In the first argument of `x', namely `(\\ y -&gt; x y)'\n  In the expression: x (\\ y -&gt; x y)\n  In the expression: \\ x -&gt; x (\\ y -&gt; x y)\n* Relevant bindings include\n    x :: t2 -&gt; t3 (bound at &lt;interactive&gt;:1:10)\n    f :: (t2 -&gt; t3) -&gt; t3 (bound at &lt;interactive&gt;:1:5)\n</code></pre>\n\n<p>Errk. Is your suggested <code>f</code> the same as that?</p>\n\n<pre><code>\u03bb&gt; :t let f x y = x x y in f\n* Occurs check: cannot construct the infinite type:\n    t3 ~ t3 -&gt; t4 -&gt; t5\n* In the first argument of `x', namely `x'\n</code></pre>\n\n<p>It at least looks like a similar error message. What are these <code>t2, t3, t4, t5</code>? Again it's GHCi using fresh names for the types, to avoid confusion.</p>\n\n<p>Looking at the <code>let f = ...</code>, GHCi sees <code>x</code> is applied to something, so it gives <code>x :: t2 -&gt; t3</code> where <code>t2</code> is the type of its argument, <code>t3</code> is the return type. It also sees <code>f = \\x -&gt; x (blah)</code>. So the return type of <code>f</code> must be whatever <code>x</code> returns, i.e. <code>t3</code>, and the argument to <code>f</code> is <code>x</code>. So <code>f :: (t2 -&gt; t3) -&gt; t3</code>.</p>\n\n<p>Inside the <code>(blah)</code>, there's <code>x</code> applied to something. So the something (i.e. <code>y</code>) must be the type of <code>x</code>'s argument, and the return type must be <code>x</code>'s return type. I.e. <code>(\\y -&gt; x y) :: t2 -&gt; t3</code>. Errk: then we must have <code>x</code>'s argument type same as that, because <code>x</code> is applied to it. And the way we write 'same as' is with <code>~</code>.</p>\n\n<p>Then the error message tells you GHCi is trying to make sense of <code>t2 ~ (t2 -&gt; t3)</code>. (<code>-&gt;</code> binds tighter than <code>~</code>.) And if you try to subsitute that equivalence for <code>t2</code> into the RHS you'll get <code>t2 ~ (((... -&gt; t3) -&gt; t3)-&gt; t3)</code> ad infinitum.</p>\n\n<p>Your suggested equivalent for <code>f x y =</code> is not equivalent (the message/typing is a little different). But they're both infinite types, so not allowed.</p>\n"}], "owner": {"reputation": 415, "user_id": 10484793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec95469fb82b965d3ee2f22d1cea5ce?s=128&d=identicon&r=PG&f=1", "display_name": "SavannahGemp", "link": "https://stackoverflow.com/users/10484793/savannahgemp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1553863998, "creation_date": 1553844437, "last_edit_date": 1553850480, "question_id": 55412418, "link": "https://stackoverflow.com/questions/55412418/how-to-understand-nested-lambda-functions-in-haskell", "title": "How to understand nested lambda functions in Haskell", "body": "<p>I am trying to understand the meaning of the following 2 lambda expressions in Haskell:</p>\n\n<pre><code>f = \\x -&gt; x (\\y -&gt; x y)\ng = \\x -&gt; (\\y -&gt; y) x\n</code></pre>\n\n<p>I tried to convert them, and I got this:</p>\n\n<pre><code>f x y = x x y\ng x y = y x\n</code></pre>\n\n<p>Is this correct? I assumed the arguments of both functions have to be x and y, as they are both found in a lambda expression in the function description. I basically understood it this way: f(x) = x f(y) and f(y) = y x. And for g, g(x) = g(y) x and g(y) = y. But as I am new to Haskell, I'm not very confident with these types of conversion. If not correct, what would be a correct conversion?</p>\n"}, {"tags": ["list", "function", "haskell", "nested", "list-comprehension"], "answers": [{"tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": false, "score": 2, "last_activity_date": 1553853506, "creation_date": 1553853506, "answer_id": 55414815, "question_id": 55411241, "link": "https://stackoverflow.com/questions/55411241/haskell-nested-list-comprehensions/55414815#55414815", "title": "Haskell Nested List Comprehensions", "body": "<pre><code>[ [ x | x &lt;- xs, even x] | xs &lt;- xxs ]\n[ [ x | x &lt;- xs, even x] | xs &lt;- [[1,2,3],[2,3,4],[4,5]] ]\n[ [ x | x &lt;- [1,2,3], even x] , [ x | x &lt;- [2,3,4], even x] , [ x | x &lt;- [4,5], even x] ]\n[filter even [1,2,3], filter even [2,3,4], filter even [4,5]]\n[[2],[2,4],[4]]\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>[ [ x | x &lt;- xs, even x] | xs &lt;- xxs ]\nmap (\\xs -&gt; [ x | x &lt;- xs, even x] ) xxs\nmap (\\xs -&gt; filter even xs) [[1,2,3],[2,3,4],[4,5]]\n[filter even [1,2,3], filter even [2,3,4], filter even [4,5]]\n[[2],[2,4],[4]]\n</code></pre>\n\n<p>Note this isn't the transformation that GHC actually does, just a way of writing it that might help you understand the output.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1553878466, "creation_date": 1553878466, "answer_id": 55422147, "question_id": 55411241, "link": "https://stackoverflow.com/questions/55411241/haskell-nested-list-comprehensions/55422147#55422147", "title": "Haskell Nested List Comprehensions", "body": "<p>List comprehensions could have been defined by few identities:</p>\n\n<pre><code>[ f x | x &lt;- [],  ... ]       ===   []\n[ f x | x &lt;- [y], ... ]       ===   [ f y | {y/x}... ]   -- well, actually, it's\n                                    -- case y of x -&gt; [ f y | {y/x}... ] ; _ -&gt; []\n\n[ f x | x &lt;- xs ++ ys, ...]   ===   [ f x | x &lt;- xs, ...] ++ [ f x | x &lt;- ys, ...]\n\n[ f x | True, ...]            ===   [ f x | ... ]\n[ f x | False, ...]           ===   []\n</code></pre>\n\n<p>The handling of <em>complex</em> <em>patterns</em> (as opposed to simple variable patterns) is elided, only hinted at, for simplicity. <code>{y/x}...</code> means, <code>y</code> is substituted for <code>x</code> in <code>...</code>. For actual definition, see <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-420003.11\" rel=\"nofollow noreferrer\">the Report</a>.</p>\n\n<p>It follows that</p>\n\n<pre><code>[ f x | xs &lt;- xss, x &lt;- xs]   ===  concat [ [f x | x &lt;- xs] | xs &lt;- xss] \n</code></pre>\n\n<p>and</p>\n\n<pre><code>[ f x | x &lt;- xs, test x ]     ===  map f (filter test xs)\n</code></pre>\n\n<p>Your expression is equivalent to</p>\n\n<pre><code>[ [ x | x &lt;- xs, even x] | xs &lt;- xxs ]   -- `]`, sic!\n=\n[ f xs | xs &lt;- xxs ]  where  f xs = [ x | x &lt;- xs, even x]\n</code></pre>\n\n<p>Which is to say, there's nothing special about a list comprehension being used as a value expression in the definition of <code>f</code>. It looks \"nested\", but actually, it isn't.</p>\n\n<p>What <em>is</em> nested, are the generator expressions separated by commas:</p>\n\n<pre><code>[ x | xs &lt;- xss, x &lt;- xs ]   ===   concat [ [x | x &lt;- xs] | xs &lt;- xss ]\n--              ^^^ nested generator\n</code></pre>\n\n<p>(the equivalency like we saw above.) So then,</p>\n\n<pre><code>[ [ x | x &lt;- xs, even x] | xs &lt;- [[1,2,3],[2,3,4],[4,5]] ]\n=\n[ [ x | x &lt;- [1,2,3], even x]] ++ [[ x | x &lt;- [2,3,4], even x]] ++ [[ x | x &lt;- [4,5], even x] ]\n=\n[ [ x | x &lt;- [1,2,3], even x], [ x | x &lt;- [2,3,4], even x], [ x | x &lt;- [4,5], even x] ]\n=\n[ [ x | x &lt;- [1], even x]++[ x | x &lt;- [2], even x]++[ x | x &lt;- [3], even x]\n, [ x | x &lt;- [2], even x]++[ x | x &lt;- [3], even x]++[ x | x &lt;- [4], even x]\n, [ x | x &lt;- [4], even x]++[ x | x &lt;- [5], even x] ]\n=\n[ [ 1 | even 1]++[ 2 | even 2]++[ 3 | even 3]\n, [ 2 | even 2]++[ 3 | even 3]++[ 4 | even 4]\n, [ 4 | even 4]++[ 5 | even 5] ]\n=\n[ []++[ 2 ]++[], [ 2 ]++[]++[ 4 ], [ 4 ]++[] ]\n=\n[ [2], [2,4], [4] ]\n</code></pre>\n\n<p>Or, with <code>filter</code> if you'd prefer,</p>\n\n<pre><code>[ [ x | x &lt;- [1,2,3], even x], [ x | x &lt;- [2,3,4], even x], [ x | x &lt;- [4,5], even x] ]\n=\n[ filter even [1,2,3], filter even [2,3,4], filter even [4,5] ]\n=\n[ [2], [2,4], [4] ]\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 10683263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ce74c450bb01ac8d2b919e3bedcead3?s=128&d=identicon&r=PG&f=1", "display_name": "wwww", "link": "https://stackoverflow.com/users/10683263/wwww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1553878466, "creation_date": 1553838724, "last_edit_date": 1553850043, "question_id": 55411241, "link": "https://stackoverflow.com/questions/55411241/haskell-nested-list-comprehensions", "title": "Haskell Nested List Comprehensions", "body": "<p>I am studying for an exam and I am looking at an example of nested list comprehensions from the book \"Learn you a Haskell\", and I was hoping if anyone could explain me step by step how to analyze it and come out with its output. </p>\n\n<pre><code>let xxs = [[1,2,3],[2,3,4],[4,5]]\n\n[ [ x | x &lt;- xs, even x] | xs &lt;- xxs ]] \n</code></pre>\n\n<p>Output: <code>([[2],[2,4],[4]])</code></p>\n"}, {"tags": ["list", "haskell", "printing"], "comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1553834349, "post_id": 55410523, "comment_id": 97541079, "body": "Seems like a homework question, within 24 hours someone asked a  question with a similar style of code . <a href=\"https://stackoverflow.com/questions/55402519/an-efficient-way-of-summing-up-different-values-in-a-haskell-database-implementa\" title=\"an efficient way of summing up different values in a haskell database implementa\">stackoverflow.com/questions/55402519/&hellip;</a>"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1553850541, "post_id": 55410523, "comment_id": 97546873, "body": "@Elmex80s it\u2019s definitely homework related but it\u201ds not a duplicate, it\u2019s asking about a different thing. Homework related questions aren\u2019t per se banned on SO."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1553850638, "post_id": 55410523, "comment_id": 97546928, "body": "As to the asker: what have you tried so far? Do you know how to print other things?"}], "answers": [{"tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": false, "score": 0, "last_activity_date": 1553861157, "creation_date": 1553861157, "answer_id": 55417102, "question_id": 55410523, "link": "https://stackoverflow.com/questions/55410523/printing-lists-in-haskell-new/55417102#55417102", "title": "Printing Lists in Haskell new", "body": "<p><strong>Tip 1:</strong></p>\n\n<p>Store the data like this</p>\n\n<pre><code>items = [(\"Scotland\",\"Desktop\",2017,900,25,22500),\n         (\"England\",\"Laptop\",2017,1100,75,82500),\n         (\"Wales\",\"Printer\",2017,120,15,1800),\n         (\"England\",\"Printer\",2017,120,60,7200),\n         (\"England\",\"Desktop\",2017,900,50,45000),\n         (\"Wales\",\"Desktop\",2017,900,20,18000),\n         (\"Scotland\",\"Printer\",2017,25,25,3000)]\n</code></pre>\n\n<p><strong>Tip 2:</strong></p>\n\n<p>Implement this function    </p>\n\n<pre><code>toString :: Item -&gt; String\ntoString = undefined -- do this yourselves\n</code></pre>\n\n<p><strong>Tip 3:</strong></p>\n\n<p>Try to combine the following functions </p>\n\n<ul>\n<li><code>unlines</code>, already in the Prelude</li>\n<li><code>toString</code>, you just wrote it </li>\n<li><code>map</code>, does not need any explanation</li>\n<li><code>putStrLn</code>, not even sure if this is a real function, but you need it anyway.</li>\n<li><code>($)</code>, you can do without this one, but it will give you bonus points</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 11002985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04d2131132178d5a98efcc644c81a15f?s=128&d=identicon&r=PG&f=1", "display_name": "Roberto", "link": "https://stackoverflow.com/users/11002985/roberto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1553861157, "creation_date": 1553833806, "question_id": 55410523, "link": "https://stackoverflow.com/questions/55410523/printing-lists-in-haskell-new", "title": "Printing Lists in Haskell new", "body": "<p>Brand new to haskell and I need to print out the data contained on a seperate row for each individual item</p>\n\n<p>Unsure on how to</p>\n\n<pre><code>type ItemDescr = String\ntype ItemYear = Int\ntype ItemPrice = Int\ntype ItemSold = Int\ntype ItemSales = Int\ntype Item = (ItemRegion,ItemDescr,ItemYear,ItemPrice,ItemSold,ItemSales)\ntype ListItems = [Item]\n\nrownumber x\n | x == 1  = (\"Scotland\",\"Desktop\",2017,900,25,22500)\n | x == 2  = (\"England\",\"Laptop\",2017,1100,75,82500)\n | x == 3  = (\"Wales\",\"Printer\",2017,120,15,1800)\n | x == 4  = (\"England\",\"Printer\",2017,120,60,7200)\n | x == 5  = (\"England\",\"Desktop\",2017,900,50,45000)\n | x == 6  = (\"Wales\",\"Desktop\",2017,900,20,18000)\n | x == 7  = (\"Scotland\",\"Printer\",2017,25,25,3000)\n\nshowall\n--print??\n</code></pre>\n\n<p>So for example on each individual line \nshow</p>\n\n<p>\"Scotland\",\"Desktop\",2017,900,25,22500 </p>\n\n<p>followed by the next record</p>\n"}, {"tags": ["haskell", "zipwith"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1553844745, "post_id": 55410189, "comment_id": 97544298, "body": "Why are you defining <code>zipWith</code> yourself instead of just using the normal one? And why are you using <code>(+)</code> as a variable name? That&#39;s very confusing."}], "answers": [{"tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": true, "score": 2, "last_activity_date": 1553831979, "creation_date": 1553831979, "answer_id": 55410300, "question_id": 55410189, "link": "https://stackoverflow.com/questions/55410189/how-to-add-two-list-of-data-type-double-using-zipwith/55410300#55410300", "title": "How to add two list of data type [[double]] using zipWith(+)?", "body": "<pre><code>zipWith (zipWith (+))\n</code></pre>\n\n<p>I think no further explanation is required ?</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11239824"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 55410300, "answer_count": 1, "score": 0, "last_activity_date": 1553831979, "creation_date": 1553830992, "last_edit_date": 1553831850, "question_id": 55410189, "link": "https://stackoverflow.com/questions/55410189/how-to-add-two-list-of-data-type-double-using-zipwith", "title": "How to add two list of data type [[double]] using zipWith(+)?", "body": "<p>I am doing this in Haskell. I am trying to add two lists to gather and I am using zipWith function to do this. But the data type won't match with my add function.</p>\n\n<p>this is what i have tried </p>\n\n<pre><code>add :: [[Double]] -&gt; [[Double]] -&gt; [[Double]]\nadd = zipWith []\nwhere zipWith :: (a -&gt; b) -&gt; [a] -&gt; [b]\nzipWith _ [] = []\nzipWith [] _ = []\nzipWith (+) (x:xs) (y:ys) = (+) x y : zipWith (+) xs ys\n</code></pre>\n\n<p>I want to add two list like this</p>\n\n<pre><code>add [[1,2],[3,4]] [[10,20],[30,40]]\n    [[11,22],[33,44]]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1553818316, "post_id": 55408679, "comment_id": 97537663, "body": "You can&#39;t, unless you define an instance of <code>Eq</code> for (an appropriate subset of) functions. Good luck if you want to try that :)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1553819812, "post_id": 55408679, "comment_id": 97538035, "body": "You might also like <a href=\"https://stackoverflow.com/q/17045941/791604\">How to compare two functions for equivalence</a>."}], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553819541, "post_id": 55408778, "comment_id": 97537960, "body": "That should teach me to make a comment that such a thing effectively can&#39;t be done! Clearly it&#39;s straightforward (in theory) to actually define the instance if the domain is finite but I&#39;m rather shocked that anyone has actually done it. And there doesn&#39;t appear to be a link to the source from there so I can&#39;t see if they used any &quot;magic&quot; to make it reasonably quick - although based on your comment I&#39;m guessing they didn&#39;t."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1553819588, "post_id": 55408778, "comment_id": 97537976, "body": "@RobinZigmond You may see the source of the <code>Eq</code> instance <a href=\"http://hackage.haskell.org/package/universe-reverse-instances-1.0/docs/src/Data-Universe-Instances-Eq.html\" rel=\"nofollow noreferrer\">here</a> if you like. No magic beyond the standard laziness to cut off early if possible."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553819708, "post_id": 55408778, "comment_id": 97538004, "body": "Thanks, and yeah, that&#39;s just the brute force approach (assuming <code>universeF</code> is a list of all values of the input type)."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1553876334, "post_id": 55408778, "comment_id": 97562377, "body": "Wow that&#39;s horrifying"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1553819386, "last_edit_date": 1553819386, "creation_date": 1553818991, "answer_id": 55408778, "question_id": 55408679, "link": "https://stackoverflow.com/questions/55408679/is-it-possible-to-compare-operators-like-in-haskell-in-the-following/55408778#55408778", "title": "Is it possible to compare operators like `(+), (-)` in haskell in the following way?", "body": "<p>Yes, the <a href=\"http://hackage.haskell.org/package/universe-1.0/docs/Data-Universe-Instances-Reverse.html\" rel=\"nofollow noreferrer\"><code>universe</code></a> package offers equality checking for total functions on finite domain -- at a price.</p>\n\n<pre><code>Data.Universe.Instances.Reverse Data.Word&gt; elem (+) [(+), (-), (*) :: Word8 -&gt; Word8 -&gt; Word8]\nTrue\nData.Universe.Instances.Reverse Data.Word&gt; elem (+) [(-), (*) :: Word8 -&gt; Word8 -&gt; Word8]\nFalse\n</code></pre>\n\n<p>What price? Comparison is done by applying the function to all possible inputs and comparing the corresponding outputs. In the case of <code>Word8</code> there's only about ~60k inputs, so it's feasible to do it before you blink, but don't try that first one on <code>Int -&gt; Int -&gt; Int</code>...</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1553819761, "creation_date": 1553819761, "answer_id": 55408880, "question_id": 55408679, "link": "https://stackoverflow.com/questions/55408679/is-it-possible-to-compare-operators-like-in-haskell-in-the-following/55408880#55408880", "title": "Is it possible to compare operators like `(+), (-)` in haskell in the following way?", "body": "<p>In general, equality of functions is <a href=\"https://stackoverflow.com/questions/10956419/why-isnt-every-type-part-of-eq-in-haskell/10956469#10956469\">a big can of worms that you don't want to open</a>. However, for <em>numerical operators</em> it is actually quite common to follow the symbolic-manipulation tradition of considering functions not so much as <em>value mappings</em> but as <em>algebraic expressions</em>, and those <em>can</em> in a na\u00efve but not completely unreasonable way be compared efficiently. This requires a suitable symbolic \u201creflection type\u201d; here with <a href=\"http://hackage.haskell.org/package/simple-reflect-0.3.3/docs/Debug-SimpleReflect.html\" rel=\"nofollow noreferrer\">simple-reflect</a>: you could do</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\nimport Debug.SimpleReflect\ninstance Eq (Expr -&gt; Expr -&gt; Expr) where\n  j == k  = j magicL magicR == k magicL magicR\n   where magicL = 6837629875629876529923867\n         magicR = 9825763982763958726923876\n\nmain = print $ (+) `elem` [(+), (*), div :: Expr-&gt;Expr-&gt;Expr]\n</code></pre>\n\n<p>This is still a heuristic which might yield false positives, but it does work for your example and also for more involved ones. Note however that it does <em>not</em> consider arithmetic laws in any way, so it will give e.g. <code>(+) /= flip (+)</code>.</p>\n\n<p>I would recommend to try to solve your problem in a way that doesn't require equality of Haskell functions.</p>\n"}], "owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1553819761, "creation_date": 1553818120, "question_id": 55408679, "link": "https://stackoverflow.com/questions/55408679/is-it-possible-to-compare-operators-like-in-haskell-in-the-following", "title": "Is it possible to compare operators like `(+), (-)` in haskell in the following way?", "body": "<p>The <code>elem</code> command allows us to do the following:</p>\n\n<pre><code>elem 1 [1,2,3] = True\n\nelem (Just 4) [(Just 5)] = False\n</code></pre>\n\n<p>My question is if this is possible to do on math operators.</p>\n\n<p>For example:</p>\n\n<p><code>elem (+) [(+), (-), div]</code></p>\n\n<p>It does not seem like it is possible from definition of <code>elem :: (Eq a, Foldable t) =&gt; a -&gt; t a -&gt; Bool</code>, and <code>(+)</code> is of <code>Num a =&gt; a -&gt; a -&gt; a</code>.</p>\n\n<p>Then how can one test this?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 6, "last_activity_date": 1553806000, "creation_date": 1553806000, "answer_id": 55406597, "question_id": 55406500, "link": "https://stackoverflow.com/questions/55406500/no-instance-for-fractional-double-arising-from-the-literal-1-0/55406597#55406597", "title": "No instance for (Fractional [Double]) arising from the literal \u20181.0\u2019", "body": "<p>The problem is</p>\n\n<pre><code>           replicate (y-1) 0.0 : 1.0\n</code></pre>\n\n<p>BTW you can (and should) always leave away trailing zeroes, so</p>\n\n<pre><code>           replicate (y-1) 0 : 1\n</code></pre>\n\n<p>For example, say <code>y=4</code>. Then this reads</p>\n\n<pre><code>           [0,0,0] : 1\n</code></pre>\n\n<p>So you're trying to prepend the list <code>[0,0,0]</code> before the... <em>list?</em> <code>1</code>. How is <code>1</code> supposed to be a list?</p>\n\n<p>I'm not sure what you want there, but one plausible option is <code>[[1]]</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 10514613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Tl6i0Q2SuPM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVc9o59GChK-9WPPZE1iJ4gpPxlFA/mo/photo.jpg?sz=128", "display_name": "Yogesh Patel", "link": "https://stackoverflow.com/users/10514613/yogesh-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555032194, "creation_date": 1553805604, "last_edit_date": 1555032194, "question_id": 55406500, "link": "https://stackoverflow.com/questions/55406500/no-instance-for-fractional-double-arising-from-the-literal-1-0", "title": "No instance for (Fractional [Double]) arising from the literal \u20181.0\u2019", "body": "<p>For class, we have to write some code for a given set of problems. One of these problems is to create an identity matrix in the form of a [[Double]] So far, I have come up with the following code. However, when I try to compile I get the following error, not sure of what I did wrong or what it means</p>\n\n<p>CODE:</p>\n\n<pre><code>ident :: Int -&gt; [[Double]]\nident x = identHelper x 0\n\nidentHelper :: Int -&gt; Int -&gt; [[Double]]\nidentHelper y z\n  | z == 0 = ([1.0] ++ replicate (y-1) 0.0) : identHelper y 1\n  | y == z = replicate (y-1) 0.0 : 1.0\n  | otherwise = (replicate z 0.0 ++ [1.0] ++ replicate (y-z-1) 0.0) : identHelper y (z+1)\n</code></pre>\n\n<p>ERROR: </p>\n\n<pre><code>    \u2022 No instance for (Fractional [[Double]])\n        arising from the literal \u20181.0\u2019\n    \u2022 In the second argument of \u2018(:)\u2019, namely \u20181.0\u2019\n      In the expression: replicate (y - 1) 0.0 : 1.0\n      In an equation for \u2018identHelper\u2019:\n          identHelper y z\n            | z == 0 = ([1.0] ++ replicate (y - 1) 0.0) : identHelper y 1\n            | y == z = replicate (y - 1) 0.0 : 1.0\n            | otherwise\n            = (replicate z 0.0 ++ [1.0] ++ replicate (y - z - 1) 0.0)\n                : identHelper y (z + 1)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "edited": false, "score": 0, "creation_date": 1553802725, "post_id": 55405796, "comment_id": 97532245, "body": "Sure, but that just produces a different encoding issue: <code>host                 = &quot;https:%2F%2Flehd.ces.census.gov%2Fdata%2Flodes%2FLODES7%2Fa&zwnj;&#8203;k%2Fod%2Fak_od_aux_J&zwnj;&#8203;T00_2002.csv.gz&quot;</code>"}, {"owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "edited": false, "score": 0, "creation_date": 1553803054, "post_id": 55405796, "comment_id": 97532380, "body": "I tried this: <code>contents &lt;- req GET (https (EN.decodeText $ T.pack url)) NoReqBody bsResponse mempty</code> and I get the same error."}, {"owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "edited": false, "score": 0, "creation_date": 1553803250, "post_id": 55405796, "comment_id": 97532479, "body": "Someone on another channel said &quot;Your hostname has a path mashed into it, causing an NXDOMAIN from DNS&quot; -- trying to figure out how to resolve that."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1553802572, "creation_date": 1553802572, "answer_id": 55405796, "question_id": 55405735, "link": "https://stackoverflow.com/questions/55405735/hitting-weird-character-encoding-issue-with-haskells-req-web-scraping-library/55405796#55405796", "title": "Hitting weird character encoding issue with Haskell&#39;s req web scraping library", "body": "<p>You almost certainly do not want to call <code>EN.encode</code>. Probably just delete that.</p>\n"}, {"tags": [], "owner": {"reputation": 1336, "user_id": 794944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b885541101d504bbd39901d5d7fc1766?s=128&d=identicon&r=PG", "display_name": "Jack Henahan", "link": "https://stackoverflow.com/users/794944/jack-henahan"}, "is_accepted": true, "score": 1, "last_activity_date": 1553813899, "creation_date": 1553813899, "answer_id": 55408089, "question_id": 55405735, "link": "https://stackoverflow.com/questions/55405735/hitting-weird-character-encoding-issue-with-haskells-req-web-scraping-library/55408089#55408089", "title": "Hitting weird character encoding issue with Haskell&#39;s req web scraping library", "body": "<p>You're not constructing the <code>Url</code> correctly. From the docs at </p>\n\n<p><a href=\"http://hackage.haskell.org/package/req-2.0.1/docs/Network-HTTP-Req.html#g:5\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/req-2.0.1/docs/Network-HTTP-Req.html#g:5</a></p>\n\n<p>we see that a <code>Url</code> can be constructed in a few ways.</p>\n\n<ol>\n<li>By hand:</li>\n</ol>\n\n<pre class=\"lang-hs prettyprint-override\"><code>https \"lehd.ces.census.gov\"\n      /~ \"data\"\n      /~ \"lodes\"\n      /~ \"LODES7\"\n      /~ \"ak\"\n      /~ \"od\"\n      /~ \"ak_od_aux_JT00_2003.csv.gz\"\n</code></pre>\n\n<ol start=\"2\">\n<li>By parsing:</li>\n</ol>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- Don't actually use fromJust, this is just an example\nfst . fromJust $ parseUrlHttps \"https://lehd.ces.census.gov/data/lodes/LODES7/ak/od/ak_od_aux_JT00_2003.csv.gz\"\n</code></pre>\n\n<p>In particular, notice what <a href=\"http://hackage.haskell.org/package/req-2.0.1/docs/Network-HTTP-Req.html#v:https\" rel=\"nofollow noreferrer\"><code>https</code></a> actually does: given a hostname, it constructs a <code>Url</code> with the HTTPS scheme, that hostname, and <em>an empty path</em>. <code>https someUrlString</code> will construct a <code>Url</code> like</p>\n\n<pre><code>https://&lt;the fully url-encoded version of someUrlString&gt;\n</code></pre>\n\n<p>which is not what you want.</p>\n"}], "owner": {"reputation": 677, "user_id": 2636579, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b615adca01077d21372bbbed1b998617?s=128&d=identicon&r=PG", "display_name": "reallymemorable", "link": "https://stackoverflow.com/users/2636579/reallymemorable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 55408089, "answer_count": 2, "score": 1, "last_activity_date": 1553813899, "creation_date": 1553802294, "question_id": 55405735, "link": "https://stackoverflow.com/questions/55405735/hitting-weird-character-encoding-issue-with-haskells-req-web-scraping-library", "title": "Hitting weird character encoding issue with Haskell&#39;s req web scraping library", "body": "<p>I can't make sense of an error occurring within this code:</p>\n\n<pre><code>import Network.URI.Encode as EN\n\ndownloadFile :: (MonadHttp m) =&gt; String -&gt; m ()\ndownloadFile url = do\n\n    traceShowM (T.pack url)\n\n    -- Pull them into memory\n    contents &lt;- req GET (https (T.pack $ EN.encode url)) NoReqBody bsResponse mempty\n\n    -- debug read file wrote file etc\n\n    -- Get the filename itself\n    let fileName = head $ reverse $ T.splitOn \"/\" (T.pack url)\n</code></pre>\n\n<p>This is the output of the main function (<code>eatChunks</code>):</p>\n\n<pre><code>\n*Main UsCensusDataLodesScraper&gt; eatChunks\n\"https://lehd.ces.census.gov/data/lodes/LODES7/ak/od/ak_od_aux_JT00_2003.csv.gz\"\n\"https://lehd.ces.census.gov/data/lodes/LODES7/ak/od/ak_od_aux_JT00_2002.csv.gz\"\n\"https://lehd.ces.census.gov/data/lodes/LODES7/ak/od/ak_od_aux_JT00_2004.csv.gz\"\n\"https://lehd.ces.census.gov/data/lodes/LODES7/ak/od/ak_od_aux_JT00_2006.csv.gz\"\n\"https://lehd.ces.census.gov/data/lodes/LODES7/ak/od/ak_od_aux_JT00_2008.csv.gz\"\n\"https://lehd.ces.census.gov/data/lodes/LODES7/ak/od/ak_od_aux_JT00_2009.csv.gz\"\n\"https://lehd.ces.census.gov/data/lodes/LODES7/ak/od/ak_od_aux_JT00_2007.csv.gz\"\n\"https://lehd.ces.census.gov/data/lodes/LODES7/ak/od/ak_od_aux_JT00_2010.csv.gz\"\n\"https://lehd.ces.census.gov/data/lodes/LODES7/ak/od/ak_od_aux_JT00_2011.csv.gz\"\n*** Exception: VanillaHttpException (HttpExceptionRequest Request {\n  host                 = \"https%253A%252F%252Flehd.ces.census.gov%252Fdata%252Flodes%252FLODES7%252Fak%252Fod%252Fak_od_aux_JT00_2002.csv.gz\"\n  port                 = 443\n  secure               = True\n  requestHeaders       = []\n  path                 = \"\"\n  queryString          = \"\"\n  method               = \"GET\"\n  proxy                = Nothing\n  rawBody              = False\n  redirectCount        = 10\n  responseTimeout      = ResponseTimeoutDefault\n  requestVersion       = HTTP/1.1\n}\n (ConnectionFailure Network.Socket.getAddrInfo (called with preferred socket type/protocol: AddrInfo {addrFlags = [AI_ADDRCONFIG], addrFamily = AF_UNSPEC, addrSocketType = Stream, addrProtocol = 6, addrAddress = &lt;assumed to be undefined&gt;, addrCanonName = &lt;assumed to be undefined&gt;}, host name: Just \"https%253A%252F%252Flehd.ces.census.gov%252Fdata%252Flodes%252FLODES7%252Fak%252Fod%252Fak_od_aux_JT00_2002.csv.gz\", service name: Just \"443\"): does not exist (nodename nor servname provided, or not known)))\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553792629, "post_id": 55403143, "comment_id": 97526917, "body": "you seem to be assuming that eg. <code>isLower s</code> returns the number of lower-case characters in <code>s</code>. In fact the function applies to a single character and returns a <code>Bool</code> telling you if that character is lowercase. There are a number of fixes but the most concise involves the function <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:any\" rel=\"nofollow noreferrer\">any</a>"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1553792673, "post_id": 55403143, "comment_id": 97526942, "body": "What&#39;s wrong? Please be clear. And why are you checking those predicates results against 0?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1553793943, "post_id": 55403143, "comment_id": 97527693, "body": "If you have something that &quot;doesn&#39;t work&quot; you should include a description of <i>how</i> it doesn&#39;t do what you expect. In this case it&#39;s clear enough that your code won&#39;t typecheck but it won&#39;t be obvious in all circumstances. (Side note: password policies like this are a pretty terrible idea, I hope you&#39;re doing this for fun and not for real production software)"}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 3, "creation_date": 1553794066, "post_id": 55403143, "comment_id": 97527754, "body": "Try narrowing it down in a repl. For example, does <code>isLower &quot;Foo&quot;</code> return 2 the way you expect?"}], "answers": [{"comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 1, "creation_date": 1553800712, "post_id": 55403887, "comment_id": 97531250, "body": "You could also use the <code>any</code> function which i believe is more readable in this case"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1553802058, "post_id": 55403887, "comment_id": 97531917, "body": "The <code>all</code> solution, much like <code>any</code>, is sort of odd looking to beginners because the partially applied function application operator <code>f s = all ($ s) [(&gt;= 8) . length, has isLower, has isUpper, has isDigit] where has p = not . null . filter p</code>.  I&#39;d upvote a reasonable alternative, code golf-esque, answer."}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 1, "creation_date": 1553818258, "post_id": 55403887, "comment_id": 97537646, "body": "I believe they meant that <code>any isLower s</code> should be used instead of <code>length (filter isLower s) &#47;= 0</code>"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 4, "last_activity_date": 1553871686, "last_edit_date": 1553871686, "creation_date": 1553794984, "answer_id": 55403887, "question_id": 55403143, "link": "https://stackoverflow.com/questions/55403143/need-a-function-to-verify-if-a-password-is-strong/55403887#55403887", "title": "Need a function to verify if a password is strong", "body": "<p>Welcome to stackoverflow.  In the future please be specific when you say something \"does not work\".  Copying and pasting the error message is a great start.</p>\n\n<p>For your case there are a few issues.</p>\n\n<ol>\n<li>There is no variable <code>n</code>. I think you mean <code>s</code> as in <code>length s</code>.</li>\n<li>The <code>isLower</code> function operates on characters, not strings (lists of characters).  You should check the length of the filtered list (<code>length (filter isLower s) /= 0</code>).  Same goes for <code>isUpper</code> and <code>isDigit</code>.</li>\n<li>Incidentally, the <code>if</code> statement is entirely unneeded.  Any time you write <code>if expr then True else False</code> it is the same as just writing <code>expr</code>.</li>\n</ol>\n\n<p>Applying these suggestions we have:</p>\n\n<pre><code>forte s = (length s &gt;= 8) &amp;&amp; (length (filter isLower s) /= 0) &amp;&amp; (length (filter isUpper s) /= 0) &amp;&amp; (length (filter isDigit s) /= 0)\n</code></pre>\n\n<p>or with a helper function:</p>\n\n<pre><code>forte s = (length s &gt;= 8) &amp;&amp; (cnt isLower /= 0) &amp;&amp;\n          (cnt isUpper /= 0) &amp;&amp; (cnt isDigit /= 0)\n  where cnt p = length (filter p s)\n</code></pre>\n\n<p>But I would probably write it as (typed but not tested):</p>\n\n<pre><code>forte s = and [ length s &gt;= 8\n              , cnt isLower /= 0\n              , cnt isUpper /= 0\n              , cnt isDigit /= 0]\n  where cnt p = length (filter p s)\n</code></pre>\n\n<p>EDIT: Ah, and I don't know why I didn't consider any instead of counting elements.  Thanks to @lorenzo</p>\n\n<pre><code>forte s = and [ length s &gt;= 8\n              , any isLower s\n              , any isUpper s\n              , any isDigit s]\n</code></pre>\n\n<p>Or with all and any, though this requires you to understand the partial application of <code>$</code> and function composition (<code>.</code>):</p>\n\n<pre><code>forte s = all ($ s) [ (&gt;= 8) . length\n                    , any isLower\n                    , any isUpper\n                    , any isDigit ]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11256383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7dGz7.jpg?s=128&g=1", "display_name": "QuickCods", "link": "https://stackoverflow.com/users/11256383/quickcods"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 55403887, "answer_count": 1, "score": -1, "last_activity_date": 1553871686, "creation_date": 1553792383, "last_edit_date": 1553792451, "question_id": 55403143, "link": "https://stackoverflow.com/questions/55403143/need-a-function-to-verify-if-a-password-is-strong", "title": "Need a function to verify if a password is strong", "body": "<p>I need to create a function to verify if a password is strong. If have more then 8 characters, at least 1 uppercase, 1 lowercase and 1 digit. But my function doesn't work. What could be wrong?</p>\n\n<pre><code>forte :: String -&gt; Bool\n\nforte s = if (length n &gt;= 8) &amp;&amp; (isLower s /= 0) &amp;&amp; (isUpper s /= 0) &amp;&amp; (isDigit s /= 0)\n          then True\n          else False\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "type-inference", "parametric-polymorphism"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1553791310, "post_id": 55402733, "comment_id": 97526133, "body": "Doesn&#39;t the monomorphism restriction apply only to simple bindings anyways (and <code>w&#39; = fromInteger w&#39;</code>, being recursive, is not simple)?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1553791436, "post_id": 55402733, "comment_id": 97526215, "body": "@Alec possible, but still \u2013 why does <i>something like the monomorphism restriction</i> seem to kick in here?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553791660, "post_id": 55402733, "comment_id": 97526344, "body": "I&#39;m probably being dense and missing something here, but <code>fromInteger</code> has type <code>(Num a) =&gt; Integer -&gt; a</code>, and since <code>w&#39;</code> is used as the input to <code>fromInteger</code>, doesn&#39;t that mean <code>Integer</code> is the only possible type for it? Indeed I&#39;m rather surprised that the version with the polymorphic type signature compiles. (So as I said, probably missing something.)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553791746, "post_id": 55402733, "comment_id": 97526394, "body": "@RobinZigmond <code>Integer</code> is certainly the only possible <i>monomorphic</i> type for <code>w&#39;</code>, but as <code>w</code> demonstrates a polymorphic type is perfectly fine as well. After all, a polymorphic type can be instantiated to a monomorphic one, provided it fulfills the constraints."}], "answers": [{"comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1553797513, "post_id": 55403422, "comment_id": 97529484, "body": "My bachelor was about a simple type inferencer for a subset of Haskell including typeclasses &amp; polymorphic recursion. A very simple approach is to limit the depth of the polymorphic recursion up to <code>k</code> depth. Most useful cases of polymorphic recursion can be inferred with a very low depth bound (like k=1 or k=2). Anyway Haskell type inference is already undecidable so that&#39;s not the <i>only</i> reason why it&#39;s not allowed. An other reason is probably performance, it surely makes type inference O(k&#183;f(n)) instead of O(f(n)) since you may need to do all over again for k times."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1553798544, "post_id": 55403422, "comment_id": 97530025, "body": "@Bakuriu, I am pretty sure that Haskell 2010 <i>without</i> polymorphic recursion has full type inference--it&#39;s basically Hindley-Milner at that point, plus type classes and defaulting. Do you have a reference saying otherwise? As for some limited recursion depth: that sounds like a potentially useful extension, but it has a very different flavor from what the Haskell Report tends to do. I would find such a feature most useful for discovering the right type signatures for polymorphic recursive code."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1553803150, "post_id": 55403422, "comment_id": 97532420, "body": "Yes, but I think all extensions to the type systems on top of Haskell2010 make type inference undecidable. Note that for example Type families are &quot;artificially&quot; limited to avoid undecidable instances by forbidding certain well-formed programs by default, so allowing a &quot;k-recursive&quot; polymorphic recursion would not be very different from that case, IMHO."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1553809238, "post_id": 55403422, "comment_id": 97535019, "body": "@Bakuriu, just for my own curiosity: how much of <code>Data.Sequence</code> could be inferred with bounded polymorphic recursion depth? I&#39;m not quite sure what you mean when you say &quot;depth&quot; in this context."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 2, "creation_date": 1553898285, "post_id": 55403422, "comment_id": 97571467, "body": "The reason there is no inference for polymorphic recursion is exactly because it\u2019s undecidable.  This is a decision from long before ghc gained a lot of other undecidable features.  You can trust me on this one, I was on the Haskell committee at that point. :)"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1554230834, "post_id": 55403422, "comment_id": 97673080, "body": "@dfeuer As far as I know given any well-typed polymorphic recursive program there exist a finite depth <code>k</code> such that the type inference works. The issue is that there is no finite <code>k</code> that works for every program. However, at the time, I did not consider other Haskell extensions so it could well be that if you add type families, functional dependencies and such this is not true anymore."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1554239871, "post_id": 55403422, "comment_id": 97677028, "body": "@Bakuriu, ah, I didn&#39;t realize it was semi-decidable. Interesting."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 19, "last_activity_date": 1553810537, "last_edit_date": 1553810537, "creation_date": 1553793285, "answer_id": 55403422, "question_id": 55402733, "link": "https://stackoverflow.com/questions/55402733/why-does-ghc-infer-a-monomorphic-type-here-even-with-monomorphismrestriction-di/55403422#55403422", "title": "Why does GHC infer a monomorphic type here, even with MonomorphismRestriction disabled?", "body": "<p>Polymorphic recursion (where a function calls itself at a different type than the one at which it was called) <em>always</em> requires a type signature. The full explanation is in <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-810004.4.1\" rel=\"noreferrer\">Section 4.4.1</a> of the Haskell 2010 Report:</p>\n\n<blockquote>\n  <p>If a variable <code>f</code> is defined without providing a corresponding type signature declaration, then each use of <code>f</code> outside its own declaration group (see <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-880004.5\" rel=\"noreferrer\">Section 4.5</a>) is treated as having the corresponding inferred, or <em>principal</em> type. However, to ensure that type inference is still possible, the defining occurrence, and all uses of <code>f</code> within its declaration group must have the same monomorphic type (from which the principal type is obtained by generalization, as described in <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-900004.5.2\" rel=\"noreferrer\">Section 4.5.2</a>).</p>\n</blockquote>\n\n<p>The same section later presents an example of polymorphic recursion supported by a type signature.</p>\n\n<p>My understanding is that unaided type inference is generally undecidable in the presence of polymorphic recursion, so Haskell doesn't even try.</p>\n\n<p>In this case, the type checker starts with</p>\n\n<pre><code>w :: a\n</code></pre>\n\n<p>where <code>a</code> is a meta-variable. Since <code>fromInteger</code> is called with <code>w</code> as an argument within its own declaration (and therefore within its declaration group), the type checker unifies <code>a</code> with <code>Integer</code>. There are no variables left to generalize.</p>\n\n<p>A slight modification of your program gives a different result for the same reason:</p>\n\n<pre><code>v = fromIntegral v\n</code></pre>\n\n<p>By your original reasoning, Haskell would infer <code>v :: forall a. Num a =&gt; a</code>, defaulting the <code>v</code> on the RHS to type <code>Integer</code>:</p>\n\n<pre><code>v :: forall a. Num a =&gt; a\nv = fromIntegral (v :: Integer)\n</code></pre>\n\n<p>But instead, it starts with <code>v :: a</code>. Since <code>v</code> is passed to <code>fromIntegral</code>, it imposes <code>Integral a</code>. Finally, it generalizes <code>a</code>. In the end, the program turns out to be</p>\n\n<pre><code>v :: forall a. Integral a =&gt; a\nv = fromIntegral (v :: a)\n</code></pre>\n"}], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 2, "answer_count": 1, "score": 17, "last_activity_date": 1553810537, "creation_date": 1553790954, "last_edit_date": 1553801204, "question_id": 55402733, "link": "https://stackoverflow.com/questions/55402733/why-does-ghc-infer-a-monomorphic-type-here-even-with-monomorphismrestriction-di", "title": "Why does GHC infer a monomorphic type here, even with MonomorphismRestriction disabled?", "body": "<p>This was prompted by <a href=\"https://stackoverflow.com/questions/55388119/resolving-the-type-of-f-f-pure/55388309?noredirect=1#comment97525285_55388309\">Resolving the type of `f = f (&lt;*&gt;) pure`</a>, which discusses a more complicated example, but this one works too.</p>\n\n<p>The following definition compiles without problem:</p>\n\n<pre><code>w :: Integral a =&gt; a\nw = fromInteger w\n</code></pre>\n\n<p>...Of course it doesn't <em>work</em> runtime-wise, but that's beside the question. The point is that the definition of <code>w</code> itself uses <em>a specialised version</em> of <code>w :: Integer</code>. Clearly that <em>is</em> a suitable instantiation, and therefore typechecks.</p>\n\n<p>However, if we remove the signature, then GHC infers not the above type, but only the concrete one:</p>\n\n<pre><code>w' = fromInteger w'\n</code></pre>\n\n<pre><code>GHCi> :t w\nw :: Integral a => a\nGHCi> :t w'\nw' :: Integer\n</code></pre>\n\n<p>Well, when I saw this, I was fairly sure this was the monomorphism restriction at work. It's well known that also e.g.</p>\n\n<pre><code>i = 3\n</code></pre>\n\n<pre><code>GHCi> :t i\ni :: Integer\n</code></pre>\n\n<p>although <code>i :: Num p =&gt; p</code> would be perfectly possible. And indeed, <code>i :: Num p =&gt; p</code> <em>is</em> inferred if <code>-XNoMonomorphismRestriction</code> is active, i.e. if the monomorphism restriction is disabled.</p>\n\n<p>However, in case of <code>w'</code> only the type <code>Integer</code> is inferred even when the monomorphism restriction <em>is</em> disabled.</p>\n\n<p>To count out that this has something to do with defaulting:</p>\n\n<pre><code>fromFloat :: RealFrac a =&gt; Float -&gt; a\nq :: RealFrac a =&gt; a\nq = fromFloat q\nq' = fromFloat q'\n</code></pre>\n\n<pre><code>GHCi> :t q\nq :: RealFrac a => a\nGHCi> :t q'\nq' :: Float</code></pre>\n\n<p>Why is the polymorphic type not inferred?</p>\n"}, {"tags": ["list", "haskell", "split"], "comments": [{"owner": {"reputation": 5062, "user_id": 5011469, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/u3AwK.jpg?s=128&g=1", "display_name": "OliverRadini", "link": "https://stackoverflow.com/users/5011469/oliverradini"}, "edited": false, "score": 0, "creation_date": 1553790869, "post_id": 55402654, "comment_id": 97525885, "body": "It&#39;s not particularly clear why you&#39;d reach the output <code>[[a,d,g],[b,e],[c,f]]</code> from the input, could you explain further?"}, {"owner": {"reputation": 75, "user_id": 10686157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IQBCPjl5qzM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyBParm2NeUyniKNHAokFIdty--g/mo/photo.jpg?sz=128", "display_name": "oddi", "link": "https://stackoverflow.com/users/10686157/oddi"}, "reply_to_user": {"reputation": 5062, "user_id": 5011469, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/u3AwK.jpg?s=128&g=1", "display_name": "OliverRadini", "link": "https://stackoverflow.com/users/5011469/oliverradini"}, "edited": false, "score": 0, "creation_date": 1553791023, "post_id": 55402654, "comment_id": 97525962, "body": "The first element goes to the first list, the second to the socond list and the third to the third and then its starts from the beginning, the fourth element goest to the first list and so on"}], "answers": [{"tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": true, "score": 3, "last_activity_date": 1553791424, "creation_date": 1553791424, "answer_id": 55402875, "question_id": 55402654, "link": "https://stackoverflow.com/questions/55402654/haskell-how-to-split-a-list-of-elements-into-several-lists-a-a/55402875#55402875", "title": "Haskell: How to split a list of elements into several lists [a]-&gt;[[a]]", "body": "<p>You want <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:transpose\" rel=\"nofollow noreferrer\">transpose</a>: </p>\n\n<pre><code>transpose [\"abc\", \"def\", \"g\"]\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>[\"adg\",\"be\",\"cf\"]\n</code></pre>\n\n<p>You can combine it</p>\n\n<pre><code>transpose $ chunksOf 3 \"abcdefg\"\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 10686157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IQBCPjl5qzM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jyBParm2NeUyniKNHAokFIdty--g/mo/photo.jpg?sz=128", "display_name": "oddi", "link": "https://stackoverflow.com/users/10686157/oddi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55402875, "answer_count": 1, "score": -2, "last_activity_date": 1553800307, "creation_date": 1553790685, "last_edit_date": 1553800307, "question_id": 55402654, "link": "https://stackoverflow.com/questions/55402654/haskell-how-to-split-a-list-of-elements-into-several-lists-a-a", "title": "Haskell: How to split a list of elements into several lists [a]-&gt;[[a]]", "body": "<p>I have a given Int (example: 3) and a list of elements.</p>\n\n<p>I want to sort these elements in 3 lists (depending on the given int).</p>\n\n<p>For example: <code>3 [a,b,c,d,e,f,g] -&gt; [[a,d,g],[b,e],[c,f]]</code></p>\n\n<p>I just know the function: </p>\n\n<pre><code>chunksOf 3 ['a'..'z']\n[\"abc\",\"def\",\"ghi\",\"jkl\",\"mno\",\"pqr\",\"stu\",\"vwx\",\"yz\"]\n</code></pre>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553789250, "post_id": 55401900, "comment_id": 97524991, "body": "isn&#39;t it just <code>fcm = Just [a | a &lt;- data_, predicate a]</code>? (It can&#39;t result in a <code>Nothing</code> because <code>(Just . predicate)</code> doesn&#39;t ever.)"}, {"owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553789915, "post_id": 55401900, "comment_id": 97525334, "body": "@RobinZigmond The <code>m</code> in <code>fcm</code> indicates that the predicate returns <code>m Bool</code>. By changing <code>(Just . predicate)</code> to <code>predicate</code> you&#39;ve moved from the <code>fcm</code> corner of the cube to the <code>fcp</code> corner. The whole point is that, for whatever reason, the predicate returns a monad, and I don&#39;t have the option of changing that, I just have to deal with it. (In real life this came up when refactoring a bunch of functions into the Reader monad, and suddenly my predicate turned monadic and my lisctomp broke.)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553790091, "post_id": 55401900, "comment_id": 97525437, "body": "but a predicate by definition cannot return <code>m Bool</code>. It must return a <code>Bool</code>. You&#39;re thinking of the fact that the function argument to <code>filterM</code> is of type <code>a -&gt; m Bool</code>, but you can&#39;t use that in a list comprehension because it&#39;s not actually a predicate. I thought the aim for <code>fcm</code> was for it to produce the same result as <code>ffm</code> but using a list comp - what I&#39;ve put above is the only way I see to do it."}, {"owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553791107, "post_id": 55401900, "comment_id": 97526001, "body": "@RobinZigmond As I said, this is motivated by refactoring to Reader. Imagine you have <code>fcm :: [a] -&gt; r -&gt; [b]</code> and <code>p :: a -&gt; r -&gt; Bool</code>. <code>fcm a r = [ xxx a r | a &lt;- as , p a r]. Then you try to refactor to </code>fcm :: [a] -&gt; Reader r [b]` and <code>p :: a -&gt; Reader r Bool</code>, which makes <code>p</code> unusable in the listcomp. Changing <code>xxx</code> from <code>a -&gt; r -&gt;b</code> to <code>a -&gt; Reader r b</code> can be dealt with <i>either</i> by switching to <code>mapM</code> or using <code>sequence</code> with the listcomp. I can see how to deal with the change in <code>p</code> by replacing the listcomp with <code>filterM</code>, but can it be done without getting rid of the listcomp?"}, {"owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553791632, "post_id": 55401900, "comment_id": 97526323, "body": "@RobinZigmond Yes, <code>fcm</code> is supposed to produce the same result as <code>ffm</code> using a listcomp ... <b>while respecting the fact that the only function you had to supply <code>filterM</code> has type <code>a -&gt; m Bool</code></b>. <code>(Just . predicate)</code> represents the function I have to work with. I do not have the luxury of removing the <code>Just .</code>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553792504, "post_id": 55401900, "comment_id": 97526839, "body": "I see. In that case, while I&#39;m relatively new to Haskell and hesitant to say &quot;you can&#39;t&quot;, I just can&#39;t see how you can do this. Your <code>mcm</code> version simply takes advantage of the fact that <code>mapM f</code> is equal to <code>sequence . (map f)</code>. I don&#39;t think there is any similar identity relating <code>filterM</code> to <code>filter</code>. Crucially, you can&#39;s use a function of type <code>a -&gt; m Bool</code> as the predicate inside a list comprehension, whereas it&#39;s fine to use a function <code>a -&gt; m b</code> as the output function."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1553805149, "post_id": 55401900, "comment_id": 97533376, "body": "If there&#39;s a way to do it, I suspect it will involve the <code>MonadComprehensions</code> extension. I&#39;m playing with it now, will update later."}], "answers": [{"comments": [{"owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "edited": false, "score": 0, "creation_date": 1553861119, "post_id": 55406909, "comment_id": 97552988, "body": "I&#39;ve added another edit, to emphasize the pragmatic motivation behind this. The point isn&#39;t to force it into a listcomp for the hell of it (fun and interesting though that may be!) In my edit you can see that the listcomp uses multiple input sets, and that there is a very clean translation to map+filter, which has a very clean translation to the monadic version, but it comes at the cost of having to uncurry the predicate and combiner. So the big-picture question is: is there a way of wirting it as a listcomp that is neater than the uncurry-<code>filterM</code>-<code>mapM</code> approach?"}], "tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": false, "score": 1, "last_activity_date": 1553818575, "last_edit_date": 1553818575, "creation_date": 1553807524, "answer_id": 55406909, "question_id": 55401900, "link": "https://stackoverflow.com/questions/55401900/list-comprehension-guard-equivalent-of-filterm/55406909#55406909", "title": "List comprehension guard equivalent of filterM", "body": "<p>Personally, I can't figure out a way to do it with <em>just</em> a list comp, but this might get you closer? (I've listed some intermediate steps I went through so you can take it in a different direction if you need).</p>\n\n<pre><code>{-# LANGUAGE MonadComprehensions #-}\n\npredicateM = return . (&gt;3)\n[[a | True &lt;- predicateM a] | a &lt;- [1,2,3,4,5]] \n  :: (Num b, Ord b, Control.Monad.Fail.MonadFail m) =&gt; [m b]\n[[if b then Just a else Nothing | b &lt;- predicateM a] | a &lt;- [1,2,3,4,5]]\n  :: (Num a, Monad m, Ord a) =&gt; [m (Maybe a)]\n[[bool Nothing (Just a) b | b &lt;- predicateM a] | a &lt;- [1,2,3,4,5]]\n  :: (Num a, Monad m, Ord a) =&gt; [m (Maybe a)]\ncatMaybes &lt;$&gt; sequence [[bool Nothing (Just a) b | b &lt;- predicateM a] | a &lt;- [1,2,3,4,5]]\n  :: (Monad f, Num a, Ord a) =&gt; f [a]\n\nfilterM' p xs = catMaybes &lt;$&gt; sequence [[bool Nothing (Just a) b | b &lt;- p a] | a &lt;- xs]\n</code></pre>\n\n<p>There may be something neater with a <code>ListT</code>?</p>\n\n<p>EDIT: Another approach, although it spews some warnings about <code>ListT</code> giving unlawful instances..</p>\n\n<pre><code>unListT (ListT x) = x\nfilterM'' p xs = unListT [a | (a,True) &lt;- ListT $ mapM (\\x -&gt; return . (x,) =&lt;&lt; p x) xs]\n</code></pre>\n\n<p>EDIT2: Okay I got it down to a single comprehension!</p>\n\n<pre><code>filterM''' :: (Traversable m1, Monad m2, Monad m1, Alternative m1) =&gt; (b -&gt; m2 Bool) -&gt; m1 b -&gt; m2 (m1 b)\nfilterM''' p xs = [[a | (a,b) &lt;- mlist, b] | mlist &lt;- mapM (\\x -&gt; return . (x,) =&lt;&lt; p x) xs]\n</code></pre>\n\n<p>EDIT3: Another approach, because I'm not sure on precisely what you need access to.</p>\n\n<pre><code>filterM' p xs = [x | x &lt;- filterM p xs]\n</code></pre>\n\n<p>Then, nest the comprehensions to obtain access to the \"inner\" element type eg. filtering and mapping,</p>\n\n<pre><code>filterMap f p xs = [[f x | x &lt;- mlist] | mlist &lt;- filterM p xs]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1553893447, "post_id": 55417617, "comment_id": 97570034, "body": "Sorry, the reason I wrote a few different versions was because I was experimenting myself and also because I wasn&#39;t exactly sure on your requirements. You have a few options, <code>uR xs ys zs = sequence [ join [ fR x y z | True &lt;- pR x y z ] | x &lt;- xs, y &lt;- ys, z &lt;- zs ]</code> is one of the clearer. You could remove the join by complicating the inner comprehension, and/or you can change the MonadFail constraint to Alternative by matching on the Bool directly ..<code>[ r | r &lt;- fR x y z, p &lt;- pR x y z, p]</code> (here both changes demonstrated). You may still feel the non-comprehension versions clearer though!"}], "tags": [], "owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "is_accepted": false, "score": 0, "last_activity_date": 1553863131, "creation_date": 1553863131, "answer_id": 55417617, "question_id": 55401900, "link": "https://stackoverflow.com/questions/55401900/list-comprehension-guard-equivalent-of-filterm/55417617#55417617", "title": "List comprehension guard equivalent of filterM", "body": "<pre><code>import Control.Monad.Trans.Reader\nimport Control.Monad (filterM)\n</code></pre>\n\n<p>The question was motivated by the desire to take some functions of the form</p>\n\n<pre><code>f ::  x  -&gt;  y  -&gt;  z -&gt;   a                 ; f  = undefined\np ::  x  -&gt;  y  -&gt;  z -&gt; Bool                ; p  = undefined\nu :: [x] -&gt; [y] -&gt; [z] -&gt; [a]\n</code></pre>\n\n<p>and replace them with similar ones within some context (<code>Reader</code> in this example):</p>\n\n<pre><code>fR ::  x  -&gt;  y  -&gt;  z  -&gt; Reader r  a        ; fR = undefined\npR ::  x  -&gt;  y  -&gt;  z  -&gt; Reader r Bool      ; pR = undefined\nuR :: [x] -&gt; [y] -&gt; [z] -&gt; Reader r [a]\n</code></pre>\n\n<p>At the core of the question, one of the original functions has a multi-input list comprehension that uses the other functions for combining and filtering purposes:</p>\n\n<pre><code>u xs ys zs = [ f x y z | x &lt;- xs, y &lt;- ys, z &lt;- zs, p x y z ]\n</code></pre>\n\n<p>The question addresses the difficulties of implementing the equivalent, contextful, <code>uR</code> function; specifically the apparent loss of ability to use a list comprehension and its conveniences.</p>\n\n<p>There is a fairly neat translation of <code>u</code> into an implementation that combines a list comprehension, <code>filter</code> and <code>map</code>. This is shown as <code>u'</code> below. <code>u'</code> has a direct translation to the contextful version, <code>uR</code>:</p>\n\n<pre><code>u' xs ys zs = map  ucf  $   filter  ucp  $           cartesian xs ys zs\nuR xs ys zs = mapM ucfR =&lt;&lt; filterM ucpR =&lt;&lt; return (cartesian xs ys zs)\n</code></pre>\n\n<p>In the above, the list comprehension is packed up in <code>cartesian</code></p>\n\n<pre><code>cartesian xs ys zs = [ (x,y,z) | x &lt;- xs, y &lt;- ys, z &lt;- zs ]\n</code></pre>\n\n<p>and the solution requires the original functions (<code>p</code>, <code>f</code>, <code>pR</code> and <code>fR</code>) to be uncurried:</p>\n\n<pre><code>ucp = uncurry3 p     ;    ucpR = uncurry3 pR\nucf = uncurry3 f     ;    ucfR = uncurry3 fR\n\nuncurry3 :: (a -&gt; b -&gt; c -&gt; r) -&gt; (a, b, c) -&gt; r\nuncurry3 f = \\(a,b,c) -&gt; f a b c\n</code></pre>\n\n<p>Maybe this solution can be sugared with a monad comprehension, but I haven't the time to think about that right now.</p>\n"}], "owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1553863514, "creation_date": 1553788342, "last_edit_date": 1553863514, "question_id": 55401900, "link": "https://stackoverflow.com/questions/55401900/list-comprehension-guard-equivalent-of-filterm", "title": "List comprehension guard equivalent of filterM", "body": "<p>List comprehensions have overlapping functionality with <code>map</code> and <code>filter</code>. <code>filterM</code> caters for the situation in which the predicate returns a <code>Bool</code> wrapped in a monad (well, an Applicative, to be precise). <code>mapM</code> does something similar for mapping functions whose result is wrapped in an Applicative.</p>\n\n<p>In case you want to reproduce the behaviour of <code>mapM</code> with a list comprehension, <code>sequence</code> comes to the rescue. But how can <code>filterM</code> be replaced with a list comprehension? In other words, how can a predicate which returns a <code>Bool</code> inside a context, be used as a guard in list comprehensions?</p>\n\n<p>Below are trivial examples exploring the 2x2x2 space (<strong>f</strong>ilter/<strong>m</strong>ap, <strong>f</strong>unction/<strong>c</strong>omprehension, <strong>p</strong>lain/<strong>m</strong>onadic) of above observations, only I don't know how to write <code>fcm</code>. How can <code>fcm</code> be fixed so that it has the same value as <code>ffm</code>?</p>\n\n<pre><code>import Control.Monad (filterM)\n\npredicate = (&gt;3)\nconvert = (*10)\npredicateM = Just . predicate -- Just represents an arbitrary monad\nconvertM   = Just . convert\ndata_ = [1..5]\n\nffp = filter           predicate  data_\nffm = filterM          predicateM data_\nfcp = [a | a &lt;- data_, predicate  a]\nfcm = [a | a &lt;- data_, predicateM a]\n\nmfp = map        convert           data_\nmfm = mapM       convertM          data_\nmcp =          [ convert  a | a &lt;- data_ ]\nmcm = sequence [ convertM a | a &lt;- data_ ]\n</code></pre>\n\n<h1>Edit:</h1>\n\n<p>It's important to note that the versions whose name ends in <code>m</code> must use a <code>convertM</code> or <code>predicateM</code>: the plain <code>convert</code> and <code>predicate</code> are unavailable in those situations; that's the whole point of the question.</p>\n\n<h1>Background information</h1>\n\n<p>The motivation arises from having a bunch of functions (here is a simplified collection, which is hopefully representative)</p>\n\n<pre><code>convert   ::  a  -&gt; r -&gt; b\npredicate ::  a  -&gt; r -&gt; Bool\nbig       :: [a] -&gt; r -&gt; [b]\n\nbig as r = [ convert a r | a &lt;- as, predicate a r ]\n</code></pre>\n\n<p>which are begging to be refactored in terms of Reader ... and one of which (<code>big</code>) uses one of the others (<code>predicate</code>) as a predicate in listcomp guard.</p>\n\n<p>Refactoring works just fine, as long as the listcomp is replaced with a combination of <code>mapM</code> and <code>filterM</code>:</p>\n\n<pre><code>convertR   ::  a  -&gt; Reader r b\npredicateR ::  a  -&gt; Reader r Bool\nbigR       :: [a] -&gt; Reader r [b]\n\nbigR as = mapM convertR =&lt;&lt; filterM predicateR as\n</code></pre>\n\n<p>The trouble with this is that, in real life, the listcomp is much more complex, and the translation to <code>mapM</code> and <code>filterM</code> is far less clean.</p>\n\n<p>Hence the motivation for wanting to keep the listcomp even when the predicate has turned monadic.</p>\n\n<h1>Edit 2</h1>\n\n<p>The real listcomp is more complex, because it combines elements from more than one list. I've tried to extact the essence of the problem into the following example, which differs from Edit 1 in that</p>\n\n<ul>\n<li>The listcomp in <code>big</code> takes data from more than one list.</li>\n<li><code>predicate</code> takes more than one value as input.</li>\n<li><code>convert</code> has been rename to <code>combine</code> and takes more than one value as input.</li>\n<li>Similar changes for the <code>Reader</code> versions.</li>\n</ul>\n\n<p>.</p>\n\n<pre><code>combine   :: r -&gt; (a,a) -&gt; b\npredicate :: r -&gt; (a,a) -&gt; Bool\nbig, big' :: r -&gt; [a]   -&gt; [b]\n\nbig  r as = [ combine r (a,b) | a &lt;- as, b &lt;- as, predicate r (a,b) ]\nbig' r as = map (combine r) $ filter (predicate r) $ [ (a,b) | a &lt;- as, b &lt;- as ]\n\ncombineR    :: (a,a) -&gt; Reader r b\npredicateR  :: (a,a) -&gt; Reader r Bool\nbigR, bigR' :: [a]   -&gt; Reader r [b]\n\nbigR     = undefined\nbigR' as = mapM combineR =&lt;&lt; filterM predicateR =&lt;&lt; return [ (a,b) | a &lt;- as, b &lt;- as ]\n</code></pre>\n\n<p><code>big'</code> is a rewrite of <code>big</code> in which <code>combine</code> and <code>predicate</code> are extracted from the listcomp. This has a direct equivalent in the Reader version: <code>bigR'</code>. So, the question is, how can you write <code>bigR</code> which should be</p>\n\n<ol>\n<li>Not significantly uglier than <code>bigR'</code></li>\n<li>As direct a translation of <code>big</code> as reasonably possible.</li>\n</ol>\n\n<p>At this stage I'm tempted to conclude that <code>bigR'</code> is as good as it's going to get. This implies that the answer to my question is:</p>\n\n<ul>\n<li>keep the listcomp for constructing the cartesian product</li>\n<li>move <code>predicate</code> and <code>combine</code> out of the expression into a <code>filter</code> and a <code>map</code> respectively</li>\n<li>in the monadic version, replace <code>filter</code> and <code>map</code> with <code>filterM</code> and <code>mapM</code> (and <code>$</code> with <code>=&lt;&lt;</code>).</li>\n<li>uncurry the predicate and combiner functions: the listcomp works equally well with curried and uncurried versions, but the map-filter combination needs them to be curried. At this stage this is probably the biggest price to pay for losing the ability to use the listcomp.</li>\n</ul>\n"}, {"tags": ["haskell", "accumulator", "non-exhaustive-patterns"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1553788104, "post_id": 55401763, "comment_id": 97524224, "body": "you haven&#39;t accounted for the case where the first argument to <code>go</code> is non-empty but the second is empty"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1553788180, "post_id": 55401763, "comment_id": 97524281, "body": "also you don&#39;t have to define this function yourself, <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:group\" rel=\"nofollow noreferrer\">group</a> from Data.List does it already"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553788221, "post_id": 55401763, "comment_id": 97524307, "body": "It was for learning purposes"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1553788104, "creation_date": 1553788104, "answer_id": 55401800, "question_id": 55401763, "link": "https://stackoverflow.com/questions/55401763/getting-non-exhaustive-pattern-exception-on-method/55401800#55401800", "title": "Getting non-exhaustive pattern exception on method", "body": "<p>You haven't accounted for something like <code>go (x:xs) [] big</code>; the only case that allows the second argument to be an empty list also requires the first argument to be an empty list as well.</p>\n\n<pre><code>    go [] small big=small:big\n    go (x:xs) (y:ys) big | x==y = go xs (x:y:ys) big\n                         | otherwise = go xs [] ((y:ys):big)\n    go (x:xs) [] big = ???\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553788112, "creation_date": 1553787968, "last_edit_date": 1553788112, "question_id": 55401763, "link": "https://stackoverflow.com/questions/55401763/getting-non-exhaustive-pattern-exception-on-method", "title": "Getting non-exhaustive pattern exception on method", "body": "<p>I keep getting <code>non-exhaustive pattern</code> exception for the following method:</p>\n\n<pre><code> groups::[Int]-&gt;[[Int]]\n groups ls=go ls [] [] where\n\n        go [] small big=small:big\n        go (x:xs) (y:ys) big | x==y = go xs (x:y:ys) big\n                             | otherwise = go xs [] ((y:ys):big)\n</code></pre>\n\n<p>What i want to do is : given an array <code>[1,2,3,3,4,4,4,1]</code> i want to split it in list of  consecutive duplicates: <code>[[1],[2],[3,3],[4,4,4],[1]]</code>.</p>\n\n<p>I am using <code>2</code> accumulators , one for the current forming list and the other for the big one.</p>\n\n<p>I can not use <code>wild-card</code> neither for the <code>big</code> list neither for the <code>small</code> one , since the only situation that is unusual is the empty input list.</p>\n"}, {"tags": ["haskell", "monads", "monoids", "do-notation", "writer-monad"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553779499, "post_id": 55398338, "comment_id": 97517690, "body": "I think you might be confused about what <code>return</code> means in Haskell - which is pretty common, so don&#39;t feel bad about it. In most imperative languages a <code>return x</code> at the bottom of a function definition means that the result of the function is <code>x</code>. But <code>return</code> in Haskell is just a function, and the actual value of <code>multWithLog</code> is the expression obtained from evaluating that entire <code>do</code> block, not just the last line with <code>return</code>. In particular the successive lines of the <code>do</code> block are connected by applications of <code>&gt;&gt;=</code>, and it is this which appends the log values &quot;behind the scenes&quot;."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1553784994, "post_id": 55398338, "comment_id": 97521924, "body": "&quot;I&#39;m under the impression that &gt;&gt;= only extracts Int 3 ...&quot;. That&#39;s where you are wrong. Only 3 is passed as the <i>argument</i> to the next function, but <code>m &gt;&gt;= f</code> doesn&#39;t simply return whatever <code>f</code> returns. It creates a <i>new</i> Writer value using both <code>m</code> and the return value of <code>f</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1553779179, "last_edit_date": 1553779179, "creation_date": 1553778870, "answer_id": 55398569, "question_id": 55398338, "link": "https://stackoverflow.com/questions/55398338/question-about-the-writer-monad-as-taught-in-lyah-how-did-the-appending-to-the/55398569#55398569", "title": "Question about the Writer monad as taught in LYAH. (How did the appending to the log take place?)", "body": "<p>From the code you posted</p>\n\n<pre><code>(Writer (x,v)) &gt;&gt;= f =\n   let (Writer (y, v')) = f x in Writer (y, v `mappend` v')\n</code></pre>\n\n<p>we can see that indeed <code>f</code> is being called only with the <code>x</code> argument.\nSo in <code>logNumber 3 &gt;&gt;= \\a -&gt; ...</code> variable <code>a</code> indeed is bound to <code>3</code>.</p>\n\n<p>However, <code>&gt;&gt;=</code> does something after calling <code>f</code>, namely it combines <code>v</code> with <code>v'</code>. In your example, <code>v</code> is the <code>[String]</code> coming from <code>logNumber 3</code> which is <code>[\"Got number: 3\"]</code>. Instead <code>v'</code> comes form evaluating <code>\\a -&gt; ...</code> with <code>a=3</code>, and is <code>[\"Got number: 5\"]</code>.</p>\n\n<p><code>mappend</code> for lists is <code>++</code>, which concatenates the lists together. Hence we get the final result.</p>\n\n<p>Allow me to be a little sloppy and neglect the <code>Writer</code> wrappers. We get</p>\n\n<pre><code>return (a*b)\n= (a*b, [])\n\nlogNumber 5 &gt;&gt;= \\b -&gt; return (a*b) \n= logNumber 5 &gt;&gt;= \\b -&gt; (a*b, [])\n= (5, [\"Got number: 5\"]) &gt;&gt;= \\b -&gt; (a*b, [])\n= (a*5, [\"Got number: 5\"] `mappend` [])\n= (a*5, [\"Got number: 5\"])\n\nlogNumber 3 &gt;&gt;= \\a -&gt; logNumber 5 &gt;&gt;= \\b -&gt; return (a*b)\n= logNumber 3 &gt;&gt;= \\a -&gt; (a*5, [\"Got number: 5\"])\n= (3, [\"Got number: 3\"]) &gt;&gt;= \\a -&gt; (a*5, [\"Got number: 5\"])\n= (3*5, [\"Got number: 3\"] `mappend` [\"Got number: 5\"])\n= (15, [\"Got number: 3\", \"Got number: 5\"])\n</code></pre>\n\n<p>Intuitively, we can pretend that a value in your writer monad is an effectful computation, which returns a value (like <code>3</code>) and as a side effect appends a few messages to a list-of-strings. The log of all such messages is invisible inside the monad (we can only append to the log), and will only be made available at the very end, when we will use <code>runWriter</code> to exit from the monadic context.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1554030258, "last_edit_date": 1554030258, "creation_date": 1554025181, "answer_id": 55439614, "question_id": 55398338, "link": "https://stackoverflow.com/questions/55398338/question-about-the-writer-monad-as-taught-in-lyah-how-did-the-appending-to-the/55439614#55439614", "title": "Question about the Writer monad as taught in LYAH. (How did the appending to the log take place?)", "body": "<p>This ought to explain it:</p>\n\n<pre><code>&gt; runWriter (return 15) :: (Int, [String])\n(15,[])                       -- == runWriter $ writer (15, mempty)\n\n&gt; runWriter (logNumber 3)\n(3,[\"Got number: 3\"])         -- == runWriter $ writer (3, [\"Got number: 3\"])\n\n&gt; runWriter (logNumber 5)\n(5,[\"Got number: 5\"])         -- == runWriter $ writer (5, [\"Got number: 5\"])\n\n&gt; runWriter (logNumber 3 &gt;&gt; logNumber 5)\n(5,[\"Got number: 3\",\"Got number: 5\"])   -- == [\"Got number: 3\"] ++ [\"Got number: 5\"]\n\n&gt; runWriter (logNumber 3 &gt;&gt;         logNumber 5 &gt;&gt;         return 15        )\n(15,[\"Got number: 3\",\"Got number: 5\"])  -- == [\"Got number: 3\"] ++ [\"Got number: 5\"] ++ []\n\n&gt; runWriter (logNumber 3 &gt;&gt;= (\\_ -&gt; logNumber 5 &gt;&gt;= (\\_ -&gt; return 15    ) ) )\n(15,[\"Got number: 3\",\"Got number: 5\"])\n\n&gt; runWriter (logNumber 3 &gt;&gt;= (\\i -&gt; logNumber 5 &gt;&gt;= (\\j -&gt; return (i*j) ) ) )\n(15,[\"Got number: 3\",\"Got number: 5\"])\n</code></pre>\n\n<p>And the last line's monadic expression is equivalent to <code>multWithLog</code>'s <code>do</code> block. </p>\n\n<p>Noice the <em>nesting</em> of the lambda functions: the lambda function </p>\n\n<pre><code>                                                    (\\j -&gt; return (i*j) )\n</code></pre>\n\n<p>is situated <em>inside</em> the lambda function </p>\n\n<pre><code>                             (\\i -&gt; logNumber 5 &gt;&gt;= (\\j -&gt; return (i*j) ) )\n</code></pre>\n\n<p>That's why the <code>i</code> in that <code>return (i*j)</code> refers to the <em>outer</em> lambda function's argument <code>i</code>, received by it from the outermost monadic action expression, <code>logNumber 3</code>.</p>\n\n<p>How? Because <em>according to the definition of <code>&gt;&gt;=</code></em> as you quote it in your question, we have</p>\n\n<pre><code>   runWriter ( Writer (x,v) &gt;&gt;= f )\n=\n   runWriter ( let (Writer (y, u)) = f x in Writer (y, v `mappend` u) )\n= \n   let (Writer (y, u)) = f x in runWriter ( Writer (y, v `mappend` u) )\n= \n   let (Writer (y, u)) = f x in (y, v `mappend` u) \n</code></pre>\n\n<p>i.e.</p>\n\n<pre><code>   runWriter ( logNumber 5 &gt;&gt;= (\\j -&gt; return j) )\n=                              -------- f -----\n   runWriter ( writer (5, [\"Got number: 5\"]) &gt;&gt;= (\\j -&gt; writer (j, mempty)) )\n=                  --  x  ------- v -------      -------- f ---------------\n   let Writer (y, u) = ( (\\j -&gt; writer (j, mempty)) 5 ) \n                         -------- f --------------- x\n                            in (y, [\"Got number: 5\"] `mappend` u) \n=                                  ------- v ------- \n   let (y, u) = (5, mempty) in (y, [\"Got number: 5\"] `mappend` u) \n=\n                               (5, [\"Got number: 5\"] `mappend` mempty) \n</code></pre>\n\n<p>The \"monoidic values\" from each <code>Writer</code> action do <em>not</em> \"get changed\". Each action <em>contributes</em> its \"monoidic value\" into the overall \"monoidic value\" of the combined <code>Writer</code>-type computation of the <code>do</code> block, built from its <code>Writer</code>-type sub-computations by <code>mappending</code> the monoidic values contributed by each sub-computation (the <strong><em>semantics</em></strong> of <code>Writer</code>), found in the <code>snd</code> field of the tuples representing the actions (the <strong><em>implementation</em></strong> of <code>Writer</code>). </p>\n\n<p>Again, this overall value is combined by combining the monoidic value parts of each tuple, namely, their <code>snd</code> fields. The monoidic combination is <code>mappend</code>, which is done behind the scenes for us by the <code>Writer</code> type computations. </p>\n\n<p>And for lists, <code>mappend [a] [b] == [a] ++ [b] == [a,b]</code>, while <code>mappend [a,b] [] == [a,b] ++ [] == [a,b]</code>.</p>\n\n<p>Your questions, then:</p>\n\n<ul>\n<li><blockquote>\n  <p>shouldn't <code>return (a*b)</code>  amount to <code>(15,[])</code>?</p>\n</blockquote>\n\n<p>it should, and it does, as we saw at the start of the answer.</p></li>\n<li><blockquote>\n  <p><code>Writer</code> vs. <code>WriterT</code> wrappers</p>\n</blockquote>\n\n<p>it doesn't matter. Both are isomorphic, because <code>Identity</code> is a no-op. <code>WriterT</code> is part of <a href=\"/questions/tagged/monad-transformers\" class=\"post-tag\" title=\"show questions tagged &#39;monad-transformers&#39;\" rel=\"tag\">monad-transformers</a> implementation of Writer monad; the one given in the book is simpler and easier to follow.</p></li>\n<li><blockquote>\n  <p>How did these operations lead to the <code>[String]</code> part of the Writer monad being altered?</p>\n</blockquote>\n\n<p>not altered, but combined, by the <code>mappend</code> of the specific Monoid used by the specific Writer; as part of the <em>monadic combination</em> i.e. the monadic bind's, <code>&gt;&gt;=</code>, definition; being as Monads generalize function call protocol and Writer Monad's generalization is collecting a Monoid values behind the scenes, so they can be appended in the shadows, in addition to the user functions doing their work in the open:</p>\n\n<pre><code> do { a &lt;- logNumber 3  \n    ; b &lt;- logNumber 5  \n    ; return (a*b)\n    }\n=    ----- user area ------       ---- hidden area ---\n do {  a       &lt;- writer (3       , [\"Got number: 3\"]       )\n    ;    b     &lt;- writer (5       , [\"Got number: 5\"]       )  \n    ;             writer (\n      (a*b)                       , []                      )\n    }\n=\n Writer\n    ( (3*5)                       , mconcat [..., ..., ...] )\n</code></pre></li>\n</ul>\n\n<p>Embrace <code>do</code>-notation, it's your friend. It helps us think <em>abstractly</em>.</p>\n"}], "owner": {"reputation": 21, "user_id": 9980628, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-56XXWcQ5TBA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2u7FSK59yerEB8SIZil66rKurEMg/mo/photo.jpg?sz=128", "display_name": "Andy", "link": "https://stackoverflow.com/users/9980628/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1554030258, "creation_date": 1553778080, "last_edit_date": 1554028639, "question_id": 55398338, "link": "https://stackoverflow.com/questions/55398338/question-about-the-writer-monad-as-taught-in-lyah-how-did-the-appending-to-the", "title": "Question about the Writer monad as taught in LYAH. (How did the appending to the log take place?)", "body": "<p>I'm learning Haskell from the \"Learn you a Haskell for Great Good\" tutorial and I've got to the part on <a href=\"http://learnyouahaskell.com/for-a-few-monads-more#writer\" rel=\"nofollow noreferrer\">writer monads</a>. Here's the example that I can't figure out.</p>\n\n<pre><code>import Control.Monad.Writer\n\nlogNumber :: Int -&gt; Writer [String] Int  \nlogNumber x = writer (x, [\"Got number: \" ++ show x])  \n\nmultWithLog :: Writer [String] Int  \nmultWithLog = do  \n   a &lt;- logNumber 3  \n   b &lt;- logNumber 5  \n   return (a*b) -- shouldn't return (3*5) result in (15,[]) ?\n\nghci&gt; runWriter $ multWithLog\n(15,[\"Got number: 3\",\"Got number: 5\"]) -- how did that happen? \n</code></pre>\n\n<p>I am trying understand how the monoidic value <code>w</code> in the <code>Writer w a</code> monad returned by the <code>do</code> block got changed. The tutorial did not go into details on how the <code>mappend</code>ing took place. </p>\n\n<p>The type declaration for <code>Writer</code> and the instance declaration for <code>Writer</code> as a monad is given by the tutorial as</p>\n\n<pre><code>newtype Writer w a = Writer { runWriter :: (a, w) }  \n\ninstance (Monoid w) =&gt; Monad (Writer w) where  \n    return x = Writer (x, mempty)\n    (Writer (x,v)) &gt;&gt;= f = let (Writer (y, v')) = f x in Writer (y, v `mappend` v')  \n</code></pre>\n\n<p>if <code>return x</code> results in <code>Writer (x, mempty)</code> as per the instance declaration and <code>mempty</code> for monoid <code>[a]</code> is <code>[]</code>, shouldn't <code>return (a*b)</code>, which amounts to <code>return (3*5)</code>, evaluate to <code>(15,[])</code>? </p>\n\n<pre><code>ghci&gt; return (15) :: Writer [String] Int\nWriterT (Identity (15,[]))\n</code></pre>\n\n<p>I gave the above command to ghci and it returns a <code>WriterT</code> type value, the tuple contains an empty list as expected.</p>\n\n<pre><code>multWithLog :: Writer [String] Int\nmultWithLog = logNumber 3 &gt;&gt;= (\\a -&gt; \n              logNumber 5 &gt;&gt;= (\\b -&gt; \n              return (a*b)))\n</code></pre>\n\n<p>I've rewritten the <code>do</code> block using bind operators instead. The above code gave identical result as the original code in the tutorial. </p>\n\n<p>I'm under the impression that <code>&gt;&gt;=</code> only extracted <code>Int</code> <code>3</code> from the result of <code>logNumber 3</code> and gave it to <code>(\\a -&gt; logNumber 5 ...etc.)</code>, which then did the <code>logNumber</code> function on a different value (<code>5</code>) and so on. How did these operations lead to the <code>[String]</code> part of the Writer monad being altered?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1553777629, "post_id": 55397823, "comment_id": 97516426, "body": "please share some example code with your desired outcome. I really don&#39;t know what you are asking for"}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1553777938, "post_id": 55397823, "comment_id": 97516631, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12450501/round-number-to-specified-number-of-digits\">Round number to specified number of digits</a>"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1553778030, "post_id": 55397823, "comment_id": 97516683, "body": "Do you want to round at display time, or do calculations with an equally-precise number that is a small modification of another?  ie, do you want a function with the type <code>Double -&gt; String</code> or a function with the type <code>Double -&gt; Double</code>?"}, {"owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1553778987, "post_id": 55397823, "comment_id": 97517330, "body": "@Carl Yes, I am looking for Double -&gt; Double function"}, {"owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1553779841, "post_id": 55397823, "comment_id": 97517923, "body": "@MichaelLitchard You are wrong"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1553782838, "post_id": 55397823, "comment_id": 97520249, "body": "I can have my mind changed. How am I wrong? Where is your attempt?"}, {"owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "edited": false, "score": 0, "creation_date": 1553785468, "post_id": 55397823, "comment_id": 97522230, "body": "I stuck with this problem from yesterday. I made some google and stackoverflow requests. I took a time read Prelude, searched for &quot;scale&quot; and &quot;precision&quot; on hoogle. Found something similar like <a href=\"https://hackage.haskell.org/package/rounded-0.1.0.1/docs/Numeric-Rounded.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/rounded-0.1.0.1/docs/&hellip;</a>, and then I decided to ask from someone with more experience to get a better solution. For sure I am wasn&#39;t clear with the question. I followed suggestions to clarify."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1553789055, "post_id": 55397823, "comment_id": 97524871, "body": "fair enough. removed downvote."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1553784348, "creation_date": 1553784348, "answer_id": 55400467, "question_id": 55397823, "link": "https://stackoverflow.com/questions/55397823/how-can-i-change-the-precision-of-double-value-in-haskell/55400467#55400467", "title": "How can I change the precision of double value in Haskell?", "body": "<p>The correct Haskell analog of Java's <code>BigDecimal</code> is <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Fixed.html\" rel=\"nofollow noreferrer\"><code>Fixed</code></a>, not <code>Double</code>. You may convert between different precisions via <code>realToFrac</code>.</p>\n"}], "owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 55400467, "answer_count": 1, "score": 0, "last_activity_date": 1553784348, "creation_date": 1553776607, "last_edit_date": 1553780083, "question_id": 55397823, "link": "https://stackoverflow.com/questions/55397823/how-can-i-change-the-precision-of-double-value-in-haskell", "title": "How can I change the precision of double value in Haskell?", "body": "<p>I would like to change the precision of double value.</p>\n\n<p>For example:</p>\n\n<p>I need to get 3.14 from 3.141592653589793</p>\n\n<p>I expect function like:</p>\n\n<pre><code>scale :: Int -&gt; Double -&gt; Double\n&gt; scale 2 3.141592653589793\n3.14\n&gt; scale 3 3.141592653589793\n3.141\n</code></pre>\n\n<p>Also, I would like to be able to choose the rounding strategy.</p>\n\n<pre><code>round :: ROUND -&gt; Int -&gt; Double -&gt; Double\n&gt; round ROUNDUP 5 3.141592653589793\n3.1416\n</code></pre>\n\n<ul>\n<li>How can I do it?</li>\n<li>How can I apply the rounding strategy for it?</li>\n</ul>\n\n<p><strong>P.S.:</strong></p>\n\n<p>Expected behavior in Java should setScale of BigDecimal: <a href=\"https://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html</a></p>\n"}, {"tags": ["haskell", "categories", "monads", "category-theory"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1553777789, "post_id": 55396989, "comment_id": 97516531, "body": "I strongly suspect <code>RevState</code> will be an adjunction between <b>Hask</b> and <b>Hask</b>Op."}], "owner": {"reputation": 2824, "user_id": 278132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/90223794e61bfb997dc23e7300c76f12?s=128&d=identicon&r=PG", "display_name": "Jacques Carette", "link": "https://stackoverflow.com/users/278132/jacques-carette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 3, "answer_count": 0, "score": 9, "last_activity_date": 1553774034, "creation_date": 1553774034, "question_id": 55396989, "link": "https://stackoverflow.com/questions/55396989/adjunction-underlying-the-tardis-monad", "title": "Adjunction underlying the Tardis monad", "body": "<p>We know that <a href=\"https://en.wikipedia.org/wiki/Monad_(category_theory)#Monads_and_adjunctions\" rel=\"noreferrer\">monads come from adjunctions</a> (and this was <a href=\"https://stackoverflow.com/questions/4697320/monads-as-adjunctions?noredirect=1&amp;lq=1\">discussed on SO</a> too).  The usual monads in programming use come from well-known adjunctions. So where does the <a href=\"http://hackage.haskell.org/package/tardis-0.4.1.0/docs/Control-Monad-Tardis.html\" rel=\"noreferrer\">Tardis</a> monad come from? (<code>RevState</code> would be nice to know about too).</p>\n"}]