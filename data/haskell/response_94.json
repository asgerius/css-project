[{"tags": ["haskell", "types", "type-constraints", "higher-rank-types"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1477522907, "post_id": 40273246, "comment_id": 67806658, "body": "I find that somewhat natural, since e.g. <code>x</code> in the type <code>f :: A -&gt; (x -&gt; B) -&gt; C</code> in in a <i>positive</i> (or covariant) position. Roughly, <code>f</code> is promising to <i>provide</i> <code>x</code> instead of requiring it from outside. This is extended to <code>y :: C a =&gt; a</code>. Also, every type you use that <code>y</code>, GHC has to provide a dictionary so to obtain a value of type <code>a</code> -- so it will complain if there&#39;s no such dictionary around."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1477525239, "post_id": 40273246, "comment_id": 67807282, "body": "That seems very strange, I agree. Probably, only GHC-makers know what kind of magic happens behind <code>forall</code> :)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1477533473, "post_id": 40273246, "comment_id": 67809177, "body": "@chi Putting the issue in terms of positive and negative positions is quite clarifying indeed. It is interesting how things only makes sense here if you sublate the intuitive view of constraints as some sort of restricted quantification (e.g. &quot;<code>Num a =&gt; a</code> stands for some type <code>a</code> in <code>Num</code>&quot;) and begin seeing them as, in essence, functions from dictionaries."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477566356, "post_id": 40273718, "comment_id": 67824181, "body": "How amusing. I wonder whether the following interpretation is sensible: If constraints are essentially functions from dictionaries, <code>Num</code> in <code>Num b</code> is essentially a type function that produces a type with one inhabitant (if there is an instance, and you aren&#39;t fooling around with <code>IncoherentInstances</code> and the like) or zero inhabitants (if there is no instance), and so <code>Num String =&gt; String</code> is much like <code>Void -&gt; String</code>, except that in the former case the compiler can&#39;t even cheat by passing <code>undefined</code> in lieu of the argument."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 13, "last_activity_date": 1477525960, "last_edit_date": 1477525960, "creation_date": 1477524377, "answer_id": 40273718, "question_id": 40273246, "link": "https://stackoverflow.com/questions/40273246/the-case-of-the-disappearing-constraint-oddities-of-a-higher-rank-type/40273718#40273718", "title": "The case of the disappearing constraint: Oddities of a higher-rank type", "body": "<p>Oh, it gets even weirder:</p>\n\n<pre><code>Prelude&gt; sleight3 1 (\"wat\"+\"man\")\n1\nPrelude Data.Void&gt; sleight3 1 (37 :: Void)\n1\n</code></pre>\n\n<p>See, there <em>is</em> an actual <code>Num</code> constraint on that argument. Only, because (as chi already commented) the <code>b</code> is in a covariant position, this is not a constraint you have to provide when calling <code>sleight3</code>. Rather, you can just pick any type <code>b</code>, then whatever it is, <code>sleight3</code> will provide a <code>Num</code> instance for it!</p>\n\n<p>Well, clearly that's bogus. <code>sleight3</code> <em>can't</em> provide such a num instance for strings, and most definitely not for <code>Void</code>. But it also doesn't <em>actually</em> need to because, quite like you said, the argument for which that constraint would apply is never evaluated. Recall that a constrained-polymorphic value is essentially just a function of a dictionary argument. <code>sleight3</code> simply promises to provide such a dictionary before it actually gets to use <code>y</code>, but then it <em>doesn't</em> use <code>y</code> in any way, so it's fine.</p>\n\n<p>It's basically the same as with a function like this:</p>\n\n<pre><code>defiant :: (Void -&gt; Int) -&gt; String\ndefiant f = \"Haha\"\n</code></pre>\n\n<p>Again, the argument function clearly can not possibly yield an <code>Int</code> because there doesn't exist a <code>Void</code> value to evaluate it with. But this isn't needed either, because <code>f</code> is simply ignored!</p>\n\n<p>By contrast, <code>sleight2 x y = const x y</code> does kinda sorta use <code>y</code>: the second argument to <code>const</code> is just a rank-0 type, so the compiler needs to resolve any needed dictionaries at that point. Even if <code>const</code> ultimately also throws <code>y</code> away, it still \u201cforces\u201d enough of this value to make it evident that it's not well-typed.</p>\n"}], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 40273718, "answer_count": 1, "score": 16, "last_activity_date": 1477525960, "creation_date": 1477521595, "last_edit_date": 1495539954, "question_id": 40273246, "link": "https://stackoverflow.com/questions/40273246/the-case-of-the-disappearing-constraint-oddities-of-a-higher-rank-type", "title": "The case of the disappearing constraint: Oddities of a higher-rank type", "body": "<p><em>All the experiments described below were done with GHC 8.0.1.</em></p>\n\n<p>This question is a follow-up to <a href=\"https://stackoverflow.com/q/40252867/2751851\"><em>RankNTypes with type aliases confusion</em></a>. The issue there boiled down to the types of functions like this one...</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nsleight1 :: a -&gt; (Num a =&gt; [a]) -&gt; a\nsleight1 x (y:_) = x + y\n</code></pre>\n\n<p>... which are rejected by the type checker...</p>\n\n<pre><code>ThinAir.hs:4:13: error:\n    * No instance for (Num a) arising from a pattern\n      Possible fix:\n        add (Num a) to the context of\n          the type signature for:\n            sleight1 :: a -&gt; (Num a =&gt; [a]) -&gt; a\n    * In the pattern: y : _\n      In an equation for `sleight1': sleight1 x (y : _) = x + y\n</code></pre>\n\n<p>... because the higher-rank constraint <code>Num a</code> <a href=\"https://stackoverflow.com/a/14593131/2751851\">cannot be moved outside of the type of the second argument</a> (as would be possible if we had <code>a -&gt; a -&gt; (Num a  =&gt; [a])</code> instead). That being so, we end up trying to add a higher-rank constraint to a variable already quantified over the whole thing, that is:</p>\n\n<pre><code>sleight1 :: forall a. a -&gt; (Num a =&gt; [a]) -&gt; a\n</code></pre>\n\n<p>With this recapitulation done, we might try to simplify the example a bit. Let's replace <code>(+)</code> with something that doesn't require <code>Num</code>, and uncouple the type of the problematic argument from that of the result:</p>\n\n<pre><code>sleight2 :: a -&gt; (Num b =&gt; b) -&gt; a\nsleight2 x y = const x y\n</code></pre>\n\n<p>This doesn't work just like before (save for a slight change in the error message):</p>\n\n<pre><code>ThinAir.hs:7:24: error:\n    * No instance for (Num b) arising from a use of `y'\n      Possible fix:\n        add (Num b) to the context of\n          the type signature for:\n            sleight2 :: a -&gt; (Num b =&gt; b) -&gt; a\n    * In the second argument of `const', namely `y'\n      In the expression: const x y\n      In an equation for `sleight2': sleight2 x y = const x y\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Using <code>const</code> here, however, is perhaps unnecessary, so we might try writing the implementation ourselves:</p>\n\n<pre><code>sleight3 :: a -&gt; (Num b =&gt; b) -&gt; a\nsleight3 x y = x\n</code></pre>\n\n<p>Surprisingly, this actually works!</p>\n\n<pre><code>Prelude&gt; :r\n[1 of 1] Compiling Main             ( ThinAir.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; :t sleight3\nsleight3 :: a -&gt; (Num b =&gt; b) -&gt; a\n*Main&gt; sleight3 1 2\n1\n</code></pre>\n\n<p>Even more bizarrely, there seems to be no actual <code>Num</code> constraint on the second argument:</p>\n\n<pre><code>*Main&gt; sleight3 1 \"wat\"\n1\n</code></pre>\n\n<p>I'm not quite sure about how to make that intelligible. Perhaps we might say that, just like we can juggle <code>undefined</code> as long as we never evaluate it, an unsatisfiable constraint can stick around in a type just fine as long as it is not used for unification anywhere in the right-hand side. That, however, feels like a pretty weak analogy, specially given that non-strictness as we usually understand it is a notion involving values, and not types. Furthermore, that leaves us no closer from grasping how in the world <code>String</code> unifies with <code>Num b =&gt; b</code> -- assuming that such a thing actually happens, something which I'm not at all sure of. What, then, is an accurate description of what is going on when a constraint seemingly vanishes in this manner?</p>\n"}, {"tags": ["haskell", "ffmpeg"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1477536427, "post_id": 40273059, "comment_id": 67809856, "body": "Adding the instance will not work - the compiler is trying to tell you that. There is an existing instance for <code>IO</code> and the functional dependency means there can&#39;t be another one for <code>IO</code> even if the first parameter is different. You simply cannot run <code>openFile :: A -&gt; IO B</code> - it must be a type with an <code>MonadError String</code> instance, such as <code>ExceptT String IO</code> (which also satisfies <code>MonadIO</code>). In the future, don&#39;t try to figure out how to &#39;force&#39; the compiler to do anything - try to figure it what it&#39;s telling you (it&#39;s trying to help you!)"}, {"owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477562731, "post_id": 40273059, "comment_id": 67821844, "body": "@user2407038 I changed my function to <code>openVideoFile :: String -&gt; ExceptIO ()</code> where <code>ExceptIO</code> is <code>type ExceptIO = ExceptT String IO</code> and now it&#39;s working, thanks! Does functional dependency of <code>MonadError e m</code> say that if there is an instance where <code>m</code> is used already, then <code>m</code> cannot be used in another instance?"}], "owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1477521683, "creation_date": 1477520531, "last_edit_date": 1477521683, "question_id": 40273059, "link": "https://stackoverflow.com/questions/40273059/cant-compile-project-with-ffmpeg-light", "title": "Can&#39;t compile project with ffmpeg-light", "body": "<p>Compilation of any project which uses <a href=\"https://hackage.haskell.org/package/ffmpeg-light-0.11.1/docs/Codec-FFmpeg-Decode.html#v:openFile\" rel=\"nofollow\">openFile</a> function from <a href=\"https://hackage.haskell.org/package/ffmpeg-light-0.11.1/docs/Codec-FFmpeg-Decode.html#\" rel=\"nofollow\">Codec.FFmpeg.Decode</a> fails with error:</p>\n\n<p><code>Couldn't match type \u2018GHC.IO.Exception.IOException\u2019 with \u2018[Char]\u2019\n            arising from a functional dependency between:\n              constraint \u2018mtl-2.2.1:Control.Monad.Error.Class.MonadError\n                            String IO\u2019\n                arising from a use of \u2018openFile\u2019\n              instance \u2018mtl-2.2.1:Control.Monad.Error.Class.MonadError\n                          GHC.IO.Exception.IOException IO\u2019\n                at &lt;no location info&gt;</code></p>\n\n<p>As an example, compilation of this fails:</p>\n\n<pre><code>openVideoFile :: String -&gt; IO ()\nopenVideoFile filePath = do\n\n  initFFmpeg\n\n  avFmtCtx &lt;- openFile filePath\n\n  return ()\n</code></pre>\n\n<p>I guess the reason is that there is no ready instance of <code>MonadError String IO</code>. But, when I add a dummy instance like this:</p>\n\n<pre><code>instance MonadError String IO where\n  throwError _   = undefined\n  catchError _ _ = undefined\n</code></pre>\n\n<p>I'm getting another error:</p>\n\n<p><code>Functional dependencies conflict between instance declarations:\n  instance MonadError String IO\n    -- Defined at src/Video/Play/Base.hs:20:10\n  instance [safe] MonadError GHC.IO.Exception.IOException IO\n    -- Defined in \u2018Control.Monad.Error.Class\u2019</code></p>\n\n<p>I don't know how to force compiler to use <code>MonadError String IO</code> instace here.</p>\n\n<ul>\n<li>Should I assure GHC that my instance is better?</li>\n<li>Do I have a wrong environment setup? I'm using <a href=\"https://hackage.haskell.org/package/ffmpeg-light\" rel=\"nofollow\">ffmpeg-light</a> clone from <a href=\"https://github.com/acowley/ffmpeg-light\" rel=\"nofollow\">here</a> and resolver <code>lts-7.2</code>. Host OS is Ubuntu.</li>\n<li>There is <a href=\"https://github.com/acowley/ffmpeg-light/commit/93f9c938e82b6ae1fda56e15c5047a1390431900\" rel=\"nofollow\">commit</a> which replaces import of <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error-Class.html\" rel=\"nofollow\">Control.Monad.Error.Class</a> by <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Except.html\" rel=\"nofollow\">Control.Monad.Except</a>. But, <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error-Class.html\" rel=\"nofollow\">Control.Monad.Error.Class</a> is still used in <a href=\"https://github.com/acowley/ffmpeg-light/blob/master/src/Codec/FFmpeg/Common.hsc\" rel=\"nofollow\">Codec.FFmpeg.Common</a>. First time I thought it caused a problem. But it turns out that <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Except.html\" rel=\"nofollow\">Control.Monad.Except</a> just re-exports <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Except.html#t:MonadError\" rel=\"nofollow\">MonadError</a> class from <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error-Class.html\" rel=\"nofollow\">Control.Monad.Error.Class</a>. So, it's not a problem.</li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1477512350, "post_id": 40271135, "comment_id": 67802390, "body": "I&#39;m not sure I understand your question.  In this case you haven&#39;t used <code>arg</code> at all, so there are no constraints on what its type can be, hence GHC deduces that it can be any type <code>a</code> (lower case names in types are always type variables).  If you had used it in some way in the definition of <code>f</code> then there would potentially be additional constraints on its type, forcing GHC to refine it from &quot;this can be anything&quot;."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477512436, "post_id": 40271135, "comment_id": 67802429, "body": "If the function was something like <code>f arg = arg + 2</code>, then the compiler would infer that <code>arg :: Num a =&gt; a</code>, since that is required to use <code>arg</code> with the <code>+</code> operator."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1477512445, "post_id": 40271135, "comment_id": 67802439, "body": "Yes, I have not used arg. But, I presented only simple situation."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477512475, "post_id": 40271135, "comment_id": 67802462, "body": "@chepner, yes. But how to check it"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1477512576, "post_id": 40271135, "comment_id": 67802502, "body": "Are you asking how GHC chooses the type <code>a -&gt; Int</code> for <code>f</code>, or how GHC chooses what type to assign to <code>a</code> when you call <code>f</code>? These are very different questions. bheklilr and chepner above are commenting about the first question. But the second question is interesting, too."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1477512666, "post_id": 40271135, "comment_id": 67802551, "body": "No. We called <code>f</code> somewhere in the code. So, compiler had to deduced type  of  argument. How to check what type was deduced?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1477514269, "post_id": 40271135, "comment_id": 67803339, "body": "If the compiler doesn&#39;t already know the type of <code>x</code>, <code>f x</code> doesn&#39;t provide it with any additional information."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477515120, "post_id": 40271135, "comment_id": 67803739, "body": "It seems like you want the compiler to notify you every time the <code>a</code> in the type of <code>f</code> is instantiated with a type (and in particular, which type was chosen)?"}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477517325, "post_id": 40271135, "comment_id": 67804820, "body": "@user2407038, yes. Or I can load a HS file in the ghci and then."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1477521845, "last_edit_date": 1477521845, "creation_date": 1477521465, "answer_id": 40273226, "question_id": 40271135, "link": "https://stackoverflow.com/questions/40271135/deducing-type-in-haskell/40273226#40273226", "title": "Deducing type in Haskell", "body": "<p>I'm not sure whether this is actually useful... but here is one way:</p>\n\n<pre><code>&gt; import Data.Typeable\n&gt; let argType f x = let _ = f x in typeOf x\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>&gt; let f :: a-&gt;Int ; f arg = 2\n&gt; argType f 'a'\nChar\n&gt; argType f 1\nInteger\n</code></pre>\n\n<p>The last example shows the actual type of <code>1</code>, after GHC(i) defaulting.</p>\n\n<hr>\n\n<p>A simpler alternative, working even in source files: when we have</p>\n\n<pre><code>foo (bar x) (baz y)\n</code></pre>\n\n<p>and we want to know the type of <code>y</code>, we can just replace it with</p>\n\n<pre><code>foo (bar x) (baz (asTypeOf _ y))\n</code></pre>\n\n<p>We will get an error such as</p>\n\n<pre><code>    \u2022 Found hole: _ :: Integer\n</code></pre>\n\n<p>which tells us the type of <code>y</code>. Downside: we have to revert the code back for it to compile.</p>\n\n<hr>\n\n<p>As a more low-level alternative, compile with <code>-ddump-simpl</code> and observe the scary GHC Core which is being produced. There, every type argument is made explicit: we could read something like <code>f @ Char 'a'</code>, where names could be possibly mangled a bit, e.g. <code>Main.a$f @ GHC.Char 'a'</code>, but it should still be possible to understand what's going on.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477521845, "creation_date": 1477511940, "question_id": 40271135, "link": "https://stackoverflow.com/questions/40271135/deducing-type-in-haskell", "title": "Deducing type in Haskell", "body": "<p>Let </p>\n\n<pre><code>f :: a -&gt; Int\nf arg = 2\n</code></pre>\n\n<p><code>a</code> is a type that will be deduced during compilation. Is it possible to learn how did Haskell deduce it?</p>\n"}, {"tags": ["haskell", "prolog", "sympy", "sage", "inequalities"], "comments": [{"owner": {"reputation": 4342, "user_id": 1879010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c078ef7744a1a430138a654d8d673956?s=128&d=identicon&r=PG", "display_name": "Dietrich", "link": "https://stackoverflow.com/users/1879010/dietrich"}, "edited": false, "score": 0, "creation_date": 1477948374, "post_id": 40270160, "comment_id": 67955796, "body": "Did you look at <a href=\"http://docs.sympy.org/latest/modules/solvers/inequalities.html#inequality-docs\" rel=\"nofollow noreferrer\">docs.sympy.org/latest/modules/solvers/&hellip;</a> ? I never tried it, but seems it should work for linear set of inequalities. If numeric solutions suffice, take a look at <code>scipy.optimize.linprog()</code>."}, {"owner": {"reputation": 75386, "user_id": 161801, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0383e4cae325f65a1bbd906be4be2276?s=128&d=identicon&r=PG", "display_name": "asmeurer", "link": "https://stackoverflow.com/users/161801/asmeurer"}, "edited": false, "score": 0, "creation_date": 1478027582, "post_id": 40270160, "comment_id": 67987292, "body": "Can you please post an example of the type of equation you would like to solve."}, {"owner": {"reputation": 19199, "user_id": 131187, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/27eJi.jpg?s=128&g=1", "display_name": "Bill Bell", "link": "https://stackoverflow.com/users/131187/bill-bell"}, "reply_to_user": {"reputation": 4342, "user_id": 1879010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c078ef7744a1a430138a654d8d673956?s=128&d=identicon&r=PG", "display_name": "Dietrich", "link": "https://stackoverflow.com/users/1879010/dietrich"}, "edited": false, "score": 0, "creation_date": 1478381082, "post_id": 40270160, "comment_id": 68133325, "body": "Many thanks to @Dietrich for your comment. I had been forgetting to read it until I encountered the question at <a href=\"http://stackoverflow.com/questions/40441532/how-to-restrict-sympy-finiteset-containing-symbol/40443339#40443339\" title=\"how to restrict sympy finiteset containing symbol\">stackoverflow.com/questions/40441532/&hellip;</a>. I hadn&#39;t understood that it&#39;s possible to solve <i>systems</i> of inequalities."}, {"owner": {"reputation": 19199, "user_id": 131187, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/27eJi.jpg?s=128&g=1", "display_name": "Bill Bell", "link": "https://stackoverflow.com/users/131187/bill-bell"}, "reply_to_user": {"reputation": 4342, "user_id": 1879010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c078ef7744a1a430138a654d8d673956?s=128&d=identicon&r=PG", "display_name": "Dietrich", "link": "https://stackoverflow.com/users/1879010/dietrich"}, "edited": false, "score": 0, "creation_date": 1478385046, "post_id": 40270160, "comment_id": 68134359, "body": "@Dietrich: Apparently reduce_inequalities can&#39;t handle more than one symbol."}, {"owner": {"reputation": 19199, "user_id": 131187, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/27eJi.jpg?s=128&g=1", "display_name": "Bill Bell", "link": "https://stackoverflow.com/users/131187/bill-bell"}, "reply_to_user": {"reputation": 75386, "user_id": 161801, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0383e4cae325f65a1bbd906be4be2276?s=128&d=identicon&r=PG", "display_name": "asmeurer", "link": "https://stackoverflow.com/users/161801/asmeurer"}, "edited": false, "score": 0, "creation_date": 1478385088, "post_id": 40270160, "comment_id": 68134366, "body": "@asmeurer: Thanks for responding. I&#39;ve included the Diophantine equation."}], "answers": [{"tags": [], "owner": {"reputation": 39597, "user_id": 1613573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BcY5m.jpg?s=128&g=1", "display_name": "mat", "link": "https://stackoverflow.com/users/1613573/mat"}, "is_accepted": false, "score": 2, "last_activity_date": 1490284578, "creation_date": 1490284578, "answer_id": 42981076, "question_id": 40270160, "link": "https://stackoverflow.com/questions/40270160/solving-a-system-of-more-than-two-linear-inequalities/42981076#42981076", "title": "Solving a system of (more than two) linear inequalities", "body": "<p>To reason about <strong>integers</strong> in Prolog, you can use your Prolog system's <strong>CLP(FD)&nbsp;constraints</strong>.</p>\n\n<p>The exact details differ slightly between different Prolog systems. Please see your system's manual for more information, and also <a href=\"/questions/tagged/clpfd\" class=\"post-tag\" title=\"show questions tagged &#39;clpfd&#39;\" rel=\"tag\">clpfd</a> for related questions.</p>\n\n<p>In your case, we can start by simply <strong>posting</strong> the constraint:</p>\n\n<pre>\n<b>?- 2*X + 3*Y - 5*Z #= 77.</b>\n2*X+3*Y#=5*Z+77.\n</pre>\n\n<p>In this case, and as for all pure Prolog programs, the system's answer is declaratively <em>equivalent</em> to the original query. This does not help a lot here: The system has only slightly rewritten the original constraint.</p>\n\n<p>You can constrain this <em>further</em>, for example with:</p>\n\n<pre>\n?- 2*X + 3*Y - 5*Z #= 77,\n   <b>[X,Y,Z] ins 0..sup.</b>\nX in 0..sup,\n2*X+3*Y#=5*Z+77,\nY in 0..sup,\nZ in 0..sup.\n</pre>\n\n<p>As requested, this additional goal constrains the variables to non-negative integers. The system's answer still does not help a&nbsp;lot.</p>\n\n<p>You can use <code>label/1</code> to search for concrete <strong>solutions</strong>. However, this so-called <em>labeling</em> requires that all domains be&nbsp;<em>finite</em>, and so we currently get:</p>\n\n<pre>\n?- 2*X + 3*Y - 5*Z #= 77,\n   Vs = [X,Y,Z],\n   Vs ins 0..sup,\n   <b>label(Vs)</b>.\n<b>ERROR: Arguments are not sufficiently instantiated</b>\n</pre>\n\n<p>The good news (in a sense) is that we don't have time to try <em>all</em> possibilities in any case. So we might as well restrict ourselves to some finite part of the search space. For example:</p>\n\n<pre>\n?- 2*X + 3*Y - 5*Z #= 77,\n   Vs = [X,Y,Z],\n   <b>Vs ins 0..10 000 000 000 000 000 000</b>,\n   label(Vs).\n</pre>\n\n<p>With this query, you get concrete <strong>integers</strong> as solutions:</p>\n\n<pre>\nX = 0,\nY = 29,\nZ = 2,\nVs = [0, 29, 2] ;\nX = 0,\nY = 34,\nZ = 5,\nVs = [0, 34, 5] ;\nX = 0,\nY = 39,\nZ = 8,\nVs = [0, 39, 8] ;\nX = 0,\nY = 44,\nZ = 11,\nVs = [0, 44, 11] ;\netc.\n</pre>\n\n<p>Since you are reasoning over <em>linear</em> constraints, CLP(Q) may also be worth a&nbsp;try.</p>\n"}], "owner": {"reputation": 19199, "user_id": 131187, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/27eJi.jpg?s=128&g=1", "display_name": "Bill Bell", "link": "https://stackoverflow.com/users/131187/bill-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1490284578, "creation_date": 1477508313, "last_edit_date": 1490283614, "question_id": 40270160, "link": "https://stackoverflow.com/questions/40270160/solving-a-system-of-more-than-two-linear-inequalities", "title": "Solving a system of (more than two) linear inequalities", "body": "<p>If I use</p>\n\n<pre><code>diophantine(2*x+3*y-5*z-77)\n</code></pre>\n\n<p>I receive this result.</p>\n\n<pre><code>{(t_0, -9*t_0 - 5*t_1 + 154, -5*t_0 - 3*t_1 + 77)}\n</code></pre>\n\n<p>Fine so far. However, on occasion one might like to constrain x, y and z to be (say) non-negative. When I use an approach like this&lt;</p>\n\n<pre><code>reduce_inequalities([0&lt;=t_0, 0&lt;=-9*t_0 - 5*t_1 + 154, 0&lt;=-5*t_0 - 3*t_1 + 77],[t_0, t_1])\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>NotImplementedError: \ninequality has more than one symbol of interest\n</code></pre>\n\n<p>Does sympy, sage, prolog, haskell or some other freely available product have means for solving systems of linear inequalities that arise in this way.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["haskell", "recursion", "towers-of-hanoi"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1477508959, "post_id": 40270155, "comment_id": 67800654, "body": "There will be no optimization done in GHCi, and besides that, the GHC compiler does not optimize things like <code>x + x</code> to <code>2 * x</code>. The reason that the latter is much faster than the former is because you are wrong about the complexity of your first solution (exponential) vs. your second (linear)."}, {"owner": {"reputation": 48, "user_id": 5576410, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3RrEbwgsjkc/AAAAAAAAAAI/AAAAAAAAA4M/RqLHP5QMChg/photo.jpg?sz=128", "display_name": "Pedro Garc&#237;a", "link": "https://stackoverflow.com/users/5576410/pedro-garc%c3%ada"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477514013, "post_id": 40270155, "comment_id": 67803216, "body": "@user2407038 I knew the exponential complexity, but I thought that GHCi transform x + x in 2 * x. Thanks a lot!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1477514723, "post_id": 40270155, "comment_id": 67803546, "body": "<a href=\"https://wiki.haskell.org/GHC_optimisations#Common_subexpression_elimination\" rel=\"nofollow noreferrer\">Common subexpression elimination</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1477522589, "post_id": 40270155, "comment_id": 67806564, "body": "Auto-memoization (dynamic programming) would also help here, but the user would still need to ask for that explicitly. GHC does not optimize things in this way."}], "answers": [{"tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": false, "score": 6, "last_activity_date": 1477508676, "creation_date": 1477508676, "answer_id": 40270256, "question_id": 40270155, "link": "https://stackoverflow.com/questions/40270155/two-recursive-called-no-finish-towers-of-hanoi/40270256#40270256", "title": "Two recursive called no finish (Towers of Hanoi)", "body": "<p>I suspect this actually <em>is</em> the function complexity.  Your first version makes 2 recursive calls for every invocation, a complexity of <strong>O(2^n)</strong>.  For n=64, you're making 2^65 - 1 total calls.  That's roughly 37 * 10^18 calls, so you're not going to see results in this lifetime with current computing power.  At one call per microsecond, that's still well over 10 million years.</p>\n\n<p>The second routine makes only one call per iteration; it's <strong>O(n)</strong>.</p>\n\n<p>To see the effect, try timing your first function at n = 19, 20, 21, 22.  That should be enough to show the 2x time difference for each added disc.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1477515684, "creation_date": 1477515684, "answer_id": 40272042, "question_id": 40270155, "link": "https://stackoverflow.com/questions/40270155/two-recursive-called-no-finish-towers-of-hanoi/40272042#40272042", "title": "Two recursive called no finish (Towers of Hanoi)", "body": "<p>It would appear that the standard advice is to do common subexpression optimization yourself if you want to guarantee it is applied. See <a href=\"https://wiki.haskell.org/GHC/FAQ#Does_GHC_do_common_subexpression_elimination.3F\" rel=\"nofollow\">https://wiki.haskell.org/GHC/FAQ#Does_GHC_do_common_subexpression_elimination.3F</a>. </p>\n\n<pre><code>numStepsHanoi :: Integer -&gt; Integer\nnumStepsHanoi 0 = 0\nnumStepsHanoi n = let steps = numStepsHanoi (n-1)\n                  in steps + steps + 1\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 5576410, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3RrEbwgsjkc/AAAAAAAAAAI/AAAAAAAAA4M/RqLHP5QMChg/photo.jpg?sz=128", "display_name": "Pedro Garc&#237;a", "link": "https://stackoverflow.com/users/5576410/pedro-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1477515684, "creation_date": 1477508299, "last_edit_date": 1477508953, "question_id": 40270155, "link": "https://stackoverflow.com/questions/40270155/two-recursive-called-no-finish-towers-of-hanoi", "title": "Two recursive called no finish (Towers of Hanoi)", "body": "<p>I programmed this function in <strong>haskell</strong> of the Towers of Hanoi problem. The function gives the numbers of steps from source stick to destination stick with only one alternative stick.</p>\n\n<pre><code>numStepsHanoi :: Integer -&gt; Integer\nnumStepsHanoi 0 = 0\nnumStepsHanoi n = numStepsHanoi (n-1) + numStepsHanoi (n-1) + 1\n</code></pre>\n\n<p>This function works fine ... until <strong>n</strong>, the number of discs, gets too high.  GHCi does not finish. I know the complexity of this problem and I know it can't run faster.</p>\n\n<p>For example, if I call it with <code>n = 64</code>, I can wait 20 minutes and get no output (it doesn't complete). Even if <code>n = 20</code>, it takes approximately 2 seconds.</p>\n\n<p>With another implementation (below), the time is quite reduced.</p>\n\n<pre><code>numStepsHanoi :: Integer -&gt; Integer\nnumStepsHanoi 0 = 0\nnumStepsHanoi n = 2 * numStepsHanoi (n-1) - 1\n</code></pre>\n\n<p>Now, with <code>n = 64</code>, I get the result instantly. Obviously this has only one recursive call, but does that have such a large effect?</p>\n\n<p>Could this be a problem of GHCi optimization?</p>\n"}, {"tags": ["haskell", "monads", "instances"], "comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1477557767, "post_id": 40265999, "comment_id": 67818656, "body": "Why has this been marked down? It seems like a perfectly good question."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1477642537, "post_id": 40265999, "comment_id": 67859201, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/5310203/how-to-use-instances-of-monad-and-confusion-about\">How to use (-&gt;) instances of Monad and confusion about (-&gt;)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "edited": false, "score": 0, "creation_date": 1477495340, "post_id": 40266056, "comment_id": 67792739, "body": "As I said in my original post, I cannot use deriving.  This is because I have class constraints on the type in my actual program.  It also isn&#39;t a newtype."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "edited": false, "score": 6, "creation_date": 1477495437, "post_id": 40266056, "comment_id": 67792806, "body": "In that case, please give the <i>actual</i> code you have."}, {"owner": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "edited": false, "score": 0, "creation_date": 1477496247, "post_id": 40266056, "comment_id": 67793336, "body": "The actual type is really large and overcomplicated and if I put it here it won&#39;t be answered for hours or maybe the rest of the day.  I just want this simple code to be answered in a reasonable time so I can spend the rest of the day (which is wide open at this point) working on my program rather than sitting around waiting."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "edited": false, "score": 2, "creation_date": 1477501910, "post_id": 40266056, "comment_id": 67796744, "body": "@mindreader It&#39;s still a good idea to at least put in the bits that are preventing you from doing what you want to do. With the constraint issue, you might still be able to do automatic deriving using the <code>StandaloneDeriving</code> extension (if you had never mentioned the constraint thing, I never would have thought of that)."}, {"owner": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "edited": false, "score": 0, "creation_date": 1477515234, "post_id": 40266056, "comment_id": 67803786, "body": "I get it, but I already tried standalone deriving, so I knew it wouldn&#39;t work.  I just didn&#39;t expect to get heavy down voting for merely rejecting a scenario an answer I explicitly said I wasn&#39;t interested in in my question."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 2, "last_activity_date": 1477494977, "creation_date": 1477494977, "answer_id": 40266056, "question_id": 40265999, "link": "https://stackoverflow.com/questions/40265999/applicative-and-monad-instances-for-a-function-type/40266056#40266056", "title": "Applicative and Monad instances for a function type?", "body": "<p>You can <code>derive</code> those instances. You just need to turn on the <code>GeneralizedNewtypeDeriving</code> flag, which enables GHC to simply reuse the instance for the wrapped type.</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nnewtype Blah a = Blah (String -&gt; a) deriving (Functor, Applicative, Monad)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "edited": false, "score": 0, "creation_date": 1477496565, "post_id": 40266546, "comment_id": 67793527, "body": "Exactly what I was looking for.  Thanks!"}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "reply_to_user": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "edited": false, "score": 4, "creation_date": 1477496684, "post_id": 40266546, "comment_id": 67793620, "body": "This is the <code>Reader String</code> monad"}, {"owner": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "edited": false, "score": 0, "creation_date": 1477496760, "post_id": 40266546, "comment_id": 67793672, "body": "I knew there would be a good example of exactly this out there somewhere, but I could not think of one."}], "tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": true, "score": 3, "last_activity_date": 1477496340, "creation_date": 1477496340, "answer_id": 40266546, "question_id": 40265999, "link": "https://stackoverflow.com/questions/40265999/applicative-and-monad-instances-for-a-function-type/40266546#40266546", "title": "Applicative and Monad instances for a function type?", "body": "<p>How about</p>\n\n<pre><code>Blah f &gt;&gt;= g = Blah $ \\s -&gt;\n    let Blah h = g $ f s in h s\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 1, "last_activity_date": 1477517808, "creation_date": 1477517808, "answer_id": 40272498, "question_id": 40265999, "link": "https://stackoverflow.com/questions/40265999/applicative-and-monad-instances-for-a-function-type/40272498#40272498", "title": "Applicative and Monad instances for a function type?", "body": "<p>Here\u2019s how you can derive this yourself using typed holes. Starting from your code, renamed a bit:</p>\n\n<pre><code>instance Monad Blah where\n  return = pure\n  f &gt;&gt;= g = Blah $ \\s -&gt; _\n</code></pre>\n\n<p>You\u2019ll get a message like this:</p>\n\n<pre><code>Found hole \u2018_\u2019 with type: b\nRelevant bindings include\n  s :: String\n  g :: a -&gt; Blah b\n  f :: Blah a\n</code></pre>\n\n<p>So we need to produce a <code>b</code>, given a <code>String</code>, a <code>Blah a</code>, and an <code>a -&gt; Blah b</code>. Well, we already know how to produce an <code>a</code> from a <code>Blah a</code> and a <code>String</code>, by pattern-matching and applying the function in the <code>Blah</code>:</p>\n\n<pre><code>Blah f &gt;&gt;= g = Blah $ \\s -&gt; let h = f s in _\n------                      -----------\n</code></pre>\n\n<p>Now we get:</p>\n\n<pre><code>Found hole \u2018_\u2019 with type: b\nRelevant bindings include\n  h :: a\n  s :: String\n  g :: a -&gt; Blah b\n  f :: String -&gt; a\n</code></pre>\n\n<p>So we have an <code>a</code>, which we can give to <code>g</code> to get a <code>Blah b</code>, and pattern-matching on that gives us a <code>String -&gt; b</code>:</p>\n\n<pre><code>Blah f &gt;&gt;= g = Blah $ \\s -&gt; let Blah h = g (f s) in _\n                                ----------------\n</code></pre>\n\n<p>Now we get:</p>\n\n<pre><code>Found hole \u2018_\u2019 with type: b\nRelevant bindings include\n  h :: String -&gt; b\n  s :: String\n  g :: a -&gt; Blah b\n  f :: String -&gt; a\n</code></pre>\n\n<p>So we need a <code>b</code>, and we have a <code>String</code> and a <code>String -&gt; b</code>. That\u2019s easy:</p>\n\n<pre><code>Blah f &gt;&gt;= g = Blah $ \\s -&gt; let Blah h = g (f s) in h s\n                                                    ---\n</code></pre>\n\n<p>And there you go, a correct implementation, guided by the types. You may also find it clearer if you define a helper function to \u201crun\u201d a <code>Blah</code>:</p>\n\n<pre><code>newtype Blah a = Blah { runBlah :: String -&gt; a }\n-- or:\nrunBlah :: Blah a -&gt; String -&gt; a\nrunBlah (Blah f) = f\n\ninstance Monad Blah where\n  f &gt;&gt;= g = Blah $ \\s -&gt; runBlah (g (runBlah f s)) s\n</code></pre>\n"}], "owner": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 40266546, "answer_count": 3, "score": 1, "last_activity_date": 1478800057, "creation_date": 1477494797, "last_edit_date": 1478800057, "question_id": 40265999, "link": "https://stackoverflow.com/questions/40265999/applicative-and-monad-instances-for-a-function-type", "title": "Applicative and Monad instances for a function type?", "body": "<p>I have a data type that resembles <code>Blah</code> below but <strong>because of a quirk with the type I cannot automatically derive Functor, Applicative, and Monad</strong>.  So I must do it manually, but I'm not sure how.  I tried to take inspiration from the instances for <code>((-&gt;) a)</code>, but I can't quite figure out the Monad instance.</p>\n\n<pre><code>newtype Blah a = Blah (String -&gt; a) -- deriving (Functor, Applicative, Monad)\n\n-- this seems right\ninstance Functor Blah where\n  fmap f (Blah g) = Blah (f .  g)\n\ninstance Applicative Blah where\n  pure = Blah . const\n  -- This is right, right?\n  (&lt;*&gt;) (Blah f) (Blah g) = Blah $ \\x -&gt; f x (g x)\n\ninstance Monad Blah where\n  return = pure\n\n  -- I'm not having any luck here.\n  (&gt;&gt;=) a b = Blah $ \\c -&gt; _\n</code></pre>\n\n<p>Edit: Someone marked this as a duplicate of another, but I don't see where I would've gotten the answer from that.  The newtype wrapper is what made this difficult.  I looked up the <code>Monad</code> instance in base for <code>(-&gt;) a</code> before I wrote this question, but the gymnastics in the answer here are what I needed.</p>\n"}, {"tags": ["string", "debugging", "haskell", "arithmetic-expressions"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 5, "creation_date": 1477494448, "post_id": 40265246, "comment_id": 67792107, "body": "This kind of task tends to be simpler if you separate parsing from evaluation. Define a data type like <code>data Expr = Value Int | Add Expr Expr | Must Expr Expr</code>, parse <code>2*(3+10)</code> to <code>Multiply (Add (Value 3) (Value 10))</code> with <code>parse :: String -&gt; Expr</code>, then evaluate the parsed expression with <code>evaluate :: Expr -&gt; Int</code>. All the hard work of dealing with parentheses, whitespace, and operator precedence gets isolated to your <code>parse</code> function."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1477500178, "post_id": 40265246, "comment_id": 67795838, "body": "@chepner Agreed, and I&#39;d use <code>parse :: String -&gt; Maybe Expr</code> instead, so that syntax errors can be reported."}, {"owner": {"reputation": 39, "user_id": 6004645, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10156517859875542/picture?type=large", "display_name": "Rick", "link": "https://stackoverflow.com/users/6004645/rick"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477502796, "post_id": 40265246, "comment_id": 67797209, "body": "@chepner does that solve the issue or is this a stylistic idea? Also, could you give an example of how to do that/what you mean?"}, {"owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1477504612, "post_id": 40265246, "comment_id": 67798222, "body": "@chi: Wouldn&#39;t <code>parse :: String -&gt; Either String Expr</code> be better since you can put an error message in <code>Left</code> as early as possible?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "edited": false, "score": 0, "creation_date": 1477506174, "post_id": 40265246, "comment_id": 67799092, "body": "@Guvante Yes, sure."}], "owner": {"reputation": 39, "user_id": 6004645, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10156517859875542/picture?type=large", "display_name": "Rick", "link": "https://stackoverflow.com/users/6004645/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477504469, "creation_date": 1477492835, "question_id": 40265246, "link": "https://stackoverflow.com/questions/40265246/evaluating-arithmetic-string-in-haskell-debugging", "title": "Evaluating arithmetic string in Haskell- debugging", "body": "<p>I'm attempting to take in a string, evaluate, and output the answer. For example: if the input is the string \"2*(3+10)\" then the output should be the int 26</p>\n\n<p>At the moment, It isn't working. I'm having problems with white space. If there is white space in the code input, I get <code>***Exception: Char.digitToInt: not a digit ' '</code>. If there is NO whitespace in the input i get <code>*** Exception: Prelude.!!: index too large</code></p>\n\n<pre><code>import Data.Char\n\nparseExpr :: String -&gt; Int\nparseExpr str = start(trim (str))\n\ntrim :: [Char] -&gt; [Char]\ntrim xs = [ x | x &lt;- xs, not (isSpace x)]\n\n\nstart :: [Char] -&gt; Int\nstart xs = expression xs 0\n\n\nexpression :: [Char] -&gt; Int -&gt; Int \nexpression xs i  \n    |(xs !! (((basic xs i (-1))!! 1)+1)) == '+' = (multiply xs ((basic xs i (-1))!! 1)) + (multiply xs ((basic xs (i+2) (-1))!! 0))\n    |(xs !! (((basic xs i (-1))!! 1)+1)) == '-' = (multiply xs ((basic xs i (-1))!! 1)) - (multiply xs ((basic xs (i+2) (-1))!! 0))\n    |otherwise = multiply xs i\n\n\nmultiply :: [Char] -&gt; Int -&gt; Int \nmultiply xs i  \n     | (xs !! (((basic xs i (-1))!! 1)+1)) == '*' = (power xs ((basic xs i (-1))!! 0)) * (power xs ((basic xs (i+2) (-1))!! 0))\n     | (xs !! (((basic xs i (-1))!! 1)+1)) == '/' = (power xs ((basic xs i (-1))!! 0)) `div` (power xs ((basic xs (i+2) (-1))!! 0))\n     |otherwise = power xs i\n\n\npower :: [Char] -&gt; Int -&gt; Int \npower xs i\n    | (xs !! (((basic xs i (-1))!! 1)+ 1)) == '^' = (((basic xs i (-1))!! 0) ^ ((basic xs (i+2) (-1))!! 0))\n    |otherwise = (basic xs i (-1)) !! 0\n\n\nbasic :: [Char] -&gt; Int -&gt; Int -&gt; [Int]\nbasic xs i pnum \n    | pnum &gt; (-1) &amp;&amp; (isDigit(xs !!(i+1))) = basic xs (i+1) (pnum*10 + (digitToInt(xs !! i)))\n    | isDigit(xs !! i ) &amp;&amp; isDigit(xs !!(i+1)) = basic xs (i+1) (digitToInt (xs !! i))\n    | pnum &gt; (-1) &amp;&amp; not (isDigit(xs !!(i+1))) = [pnum, i] -- + digitToInt(xs !! i)\n    | xs !! i == '-' = [(-(basic xs (i+1)(-1)) !! 0) , i] -- may want to delete if add/sub can handle\n    | xs !! i == '(' = [(expression xs (i+1)), i]\n    | xs !! i == ')' = [(expression xs (i+1)), i] --This may not work here\n    | otherwise =  [digitToInt (xs !! i), i]\n</code></pre>\n"}, {"tags": ["c", "performance", "haskell", "cairo"], "comments": [{"owner": {"reputation": 362978, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1477491904, "post_id": 40264828, "comment_id": 67790169, "body": "The easiest way to find out would of course be to disassemble two binaries. I&#39;m thinking there shouldn&#39;t be much Haskell&#39;s compiler can do to slow down the code inside Cairo, though."}, {"owner": {"reputation": 217, "user_id": 3916445, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/457c04fab5a8f301f264674174733af6?s=128&d=identicon&r=PG&f=1", "display_name": "nico7et8", "link": "https://stackoverflow.com/users/3916445/nico7et8"}, "reply_to_user": {"reputation": 362978, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1477492070, "post_id": 40264828, "comment_id": 67790279, "body": "Yup. But... Disassembling binaries -&gt; bit out of my league for now."}, {"owner": {"reputation": 1444, "user_id": 6062567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e87060f0ce67ed68a097ac5186027c5?s=128&d=identicon&r=PG&f=1", "display_name": "oldtechaa", "link": "https://stackoverflow.com/users/6062567/oldtechaa"}, "edited": false, "score": 0, "creation_date": 1477512667, "post_id": 40264828, "comment_id": 67802553, "body": "Just as a note, Haskell compilers may not be as optimized either, so you may take a performance hit there."}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 9, "last_activity_date": 1477492140, "creation_date": 1477492140, "answer_id": 40264991, "question_id": 40264828, "link": "https://stackoverflow.com/questions/40264828/is-cairo-graphics-slower-in-other-languages-than-c-in-haskell-for-example/40264991#40264991", "title": "Is Cairo Graphics slower in other languages than c? In Haskell for example?", "body": "<p>There's some FFI overhead from most languages calling C libraries. It's a small (usually-)constant overhead on each call to a C function, but it will add up if you make lot of calls.</p>\n\n<p>This isn't unique to calling C, for what it's worth. Any crossing of memory management systems does the job.  That's why modern OpenGL recommends doing as much as possible in calls that send data to graphics memory in giant blocks, instead of one triangle at a time.</p>\n"}], "owner": {"reputation": 217, "user_id": 3916445, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/457c04fab5a8f301f264674174733af6?s=128&d=identicon&r=PG&f=1", "display_name": "nico7et8", "link": "https://stackoverflow.com/users/3916445/nico7et8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 40264991, "answer_count": 1, "score": 3, "last_activity_date": 1477492140, "creation_date": 1477491717, "question_id": 40264828, "link": "https://stackoverflow.com/questions/40264828/is-cairo-graphics-slower-in-other-languages-than-c-in-haskell-for-example", "title": "Is Cairo Graphics slower in other languages than c? In Haskell for example?", "body": "<p>I've been using Cairo Graphics in c for a while and I'd like to use it in a more high-level language (namely Haskell, I've also tried Python). It works but truthfully, I don't have a clear picture in my head on how that works internally.</p>\n\n<p>When my Haskell source is compiled, is the cairo-related part of the object file the same as if it had been compiled from a c source ?</p>\n\n<p>Will <code>cairo_line_to (cr, 100, 100)</code> in c be compiled into the same machine code as <code>LineTo 100 100</code> in Haskell? Will the performance be the same?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1477487648, "post_id": 40262826, "comment_id": 67786886, "body": "<code>HsColour</code> is both an executable and a library. Stack and other tools will use the <i>executable</i> to actually colorize code in your terminal, your editor, etc. Install the executable (by building as usual, then copying the executable) in a directly in your <code>PATH</code>. &quot;i now have to require HsColour for each project&quot; - doesn&#39;t really make sense, as project dependencies are what <i>your</i> code needs, not what stack needs as part of its toolchain...."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477488873, "post_id": 40262826, "comment_id": 67787870, "body": "@user2407038 At first I thought the same thing as you, but it does seem that colourising GHCi in the manner described by the OP requires the library, and not the executable. Cf. <a href=\"https://www.reddit.com/r/haskell/comments/144biy/pretty_output_in_ghci_howto_in_comments/\" rel=\"nofollow noreferrer\">this r/haskell post</a>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477490582, "post_id": 40262826, "comment_id": 67789205, "body": "@duplode I agree in principle that it can be accomplished this way, but if you are depending on the library then you are depending on the library, period. That means recompiling the source code every time there&#39;s a chance it could have change and for every single project which depends on it. The <code>HsColour</code> <i>executable</i> allows you to <i>not</i> depend on the source code. The answer to &quot;How can i let stack ghci make use of the same HsColour each time without interfering with the project libraries?&quot; is &quot;Use the HsColour executable&quot;. @OP You might have to add your function and recompile HsColour."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477491147, "post_id": 40262826, "comment_id": 67789630, "body": "@user2407038 Indeed. Still, it would make sense if stack provided a way to manage &quot;dependencies&quot; of this sort, which are not dependencies of the project (they are never actually linked by project code) but merely of the stack/cabal/GHC environment -- I can imagine, for instance, stack ensuring <code>HsColour</code> is installed every time you switch to a new resolver/snapshot. (I think there is currently no way to do that, though I might be missing something.)"}, {"owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1477492727, "post_id": 40262826, "comment_id": 67790755, "body": "@user2407038 i tried HsColour as executable, it caused weird alignment of things in ghci. Also i use the <code>groom</code> library, and in the future possibly more libraries, so my original question still stands."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477497866, "post_id": 40262826, "comment_id": 67794454, "body": "@duplode I think stack does give you a way to manage executables - <code>stack exec</code> - for example, if you install a package globally with <code>stack install &lt;pkg&gt;</code> and that package builds an executable, that executable will be available with <code>stack exec &lt;executable-name&gt;</code> in the global environment and any package using that environment. You can then have e.g. <code>alias HsColour=&#39;stack exec HsColour --&#39;</code> which will always use your local project environment (in fact I use <code>alias ghci=&#39;stack exec ghci --&#39;</code>)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477498473, "post_id": 40262826, "comment_id": 67794826, "body": "@Flip Have you tried adding <code>hscolour</code> to <code>extra-deps</code> in the global config file? It seems to work for me (at least, for other libraries) - I can run <code>stack exec ghci</code> and the imports in the <code>.ghci</code> file are recognized properly."}, {"owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477498705, "post_id": 40262826, "comment_id": 67794961, "body": "@user2407038 yes that works only if you are not starting ghci in a project directory"}], "owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1477486357, "creation_date": 1477486357, "question_id": 40262826, "link": "https://stackoverflow.com/questions/40262826/stack-requires-same-package-for-each-project-due-to-ghci", "title": "Stack requires same package for each project due to .ghci", "body": "<p>Since recently i started using imports in my <code>.ghci</code> file to colorize my code. Since Stack uses a separate set of libraries for each project i now have to require <code>HsColour</code> for each project. Even though <code>HsColour</code> is not actually used by the code in the project. How can i let <code>stack ghci</code> make use of the same <code>HsColour</code> each time without interfering with the project libraries? If this is not possible, is there an alternative to this problem?</p>\n"}, {"tags": ["windows", "haskell", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477482365, "post_id": 40260323, "comment_id": 67783308, "body": "maybe try <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/\" rel=\"nofollow noreferrer\">stack</a> instead..?"}, {"owner": {"reputation": 942, "user_id": 1760615, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/1f4024259ceab3bfa03ae7570c5ea17c?s=128&d=identicon&r=PG", "display_name": "Lucidnonsense", "link": "https://stackoverflow.com/users/1760615/lucidnonsense"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477482884, "post_id": 40260323, "comment_id": 67783598, "body": "Ok but this should work! It&#39;s the same setup on both machines and only one of them works"}, {"owner": {"reputation": 942, "user_id": 1760615, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/1f4024259ceab3bfa03ae7570c5ea17c?s=128&d=identicon&r=PG", "display_name": "Lucidnonsense", "link": "https://stackoverflow.com/users/1760615/lucidnonsense"}, "edited": false, "score": 0, "creation_date": 1477488206, "post_id": 40260323, "comment_id": 67787326, "body": "ok, but I followed the directions on the haskell-platform site (modifying the config file to list msys directory)."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1477490173, "post_id": 40260323, "comment_id": 67788917, "body": "What happens if you do <code>cabal install old-time</code> just by itself?"}, {"owner": {"reputation": 942, "user_id": 1760615, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/1f4024259ceab3bfa03ae7570c5ea17c?s=128&d=identicon&r=PG", "display_name": "Lucidnonsense", "link": "https://stackoverflow.com/users/1760615/lucidnonsense"}, "edited": false, "score": 0, "creation_date": 1477490207, "post_id": 40260323, "comment_id": 67788947, "body": "Same result. Stack also fails in the same way"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1477490275, "post_id": 40260323, "comment_id": 67788991, "body": "The line <code>\\old-time-1.1.0.3&#39;</code> is pretty bizarre."}, {"owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "edited": false, "score": 0, "creation_date": 1477592410, "post_id": 40260323, "comment_id": 67841616, "body": "<a href=\"http://stackoverflow.com/questions/22570952/network-2-4-2-2-error-cabal-install-on-windows\" title=\"network 2 4 2 2 error cabal install on windows\">stackoverflow.com/questions/22570952/&hellip;</a> was proposed a a duplicate (and I mistakenly supported that before changing my mind and reopening), but actually I don&#39;t think it is: the <code>network</code> package has some specific installation requirements that aren&#39;t shared by most other packages like <code>old-time</code> and the answers to that question are specific to <code>network</code>."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1517905730, "creation_date": 1517905730, "answer_id": 48638538, "question_id": 40260323, "link": "https://stackoverflow.com/questions/40260323/installation-error-with-haskell-cabal/48638538#48638538", "title": "Installation error with haskell cabal", "body": "<p>Typically this is caused by not adding the following lines to your cabal config (discoverable by running <code>cabal user-config init</code>) as the platform instructions suggest:</p>\n\n<pre><code>extra-prog-path: C:\\Program Files\\Haskell Platform\\8.2.2\\msys\\usr\\bin\nextra-lib-dirs: C:\\Program Files\\Haskell Platform\\8.2.2\\mingw\\lib\nextra-include-dirs: C:\\Program Files\\Haskell Platform\\8.2.2\\mingw\\include\n</code></pre>\n\n<p>(with the paths set for the appropriate version of the platform.)</p>\n"}], "owner": {"reputation": 942, "user_id": 1760615, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/1f4024259ceab3bfa03ae7570c5ea17c?s=128&d=identicon&r=PG", "display_name": "Lucidnonsense", "link": "https://stackoverflow.com/users/1760615/lucidnonsense"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 436, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517905730, "creation_date": 1477479050, "question_id": 40260323, "link": "https://stackoverflow.com/questions/40260323/installation-error-with-haskell-cabal", "title": "Installation error with haskell cabal", "body": "<p>I'm installing haskell platform for windows 10 for the first time (<a href=\"https://www.haskell.org/platform/windows.html\" rel=\"nofollow\">https://www.haskell.org/platform/windows.html</a>) for my laptop and pc. </p>\n\n<p>My PC installs fine and I can run <code>cabal install hsdev</code> without any issues. However, when I do the exact same process on my laptop the following error is raised:</p>\n\n<pre><code>Resolving dependencies...\nConfiguring old-time-1.1.0.3...\nFailed to install old-time-1.1.0.3\nBuild log ( C:\\Users\\user\\AppData\\Roaming\\cabal\\logs\\old-time-1.1.0.3.log ):\nConfiguring old-time-1.1.0.3...\nconfigure: error: invalid package name: 0\n\\old-time-1.1.0.3'\ncabal: Leaving directory 'C:\\Users\\user\\AppData\\Local\\Temp\\cabal-tmp-7388\\old-time-1.1.0.3'\ncabal: Error: some packages failed to install:\nold-time-1.1.0.3 failed during the configure step. The exception was:\nExitFailure \n</code></pre>\n\n<p>The log just repeats the stdout shown above</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell", "filter"], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1477512051, "post_id": 40260683, "comment_id": 67802260, "body": "<code>(`mod` 100)</code>"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1477512125, "last_edit_date": 1477512125, "creation_date": 1477480005, "answer_id": 40260683, "question_id": 40260195, "link": "https://stackoverflow.com/questions/40260195/how-do-i-filter-numbers-which-end-in-other-numbers-in-haskell/40260683#40260683", "title": "How do I filter numbers which end in other numbers in Haskell?", "body": "<p>Compare them modulo 100:</p>\n\n<pre><code>let result = filter ((== 67) . (`mod` 100)) numbers\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "edited": false, "score": 0, "creation_date": 1477505170, "post_id": 40260910, "comment_id": 67798506, "body": "I would recommend against this, you are assuming that the number provided has no leading zeros (since <code>Int</code> cannot store <code>067</code> it can only store <code>67</code>) and you are stringifying which hurts performance."}, {"owner": {"reputation": 383, "user_id": 4937439, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZmHu9gy1S7c/AAAAAAAAAAI/AAAAAAAADpE/tKoIiG2kniU/photo.jpg?sz=128", "display_name": "Sandeep Tuniki", "link": "https://stackoverflow.com/users/4937439/sandeep-tuniki"}, "reply_to_user": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "edited": false, "score": 0, "creation_date": 1477542684, "post_id": 40260910, "comment_id": 67811281, "body": "@Guvante, I updated my answer to add a solution which doesn&#39;t stringify numbers. I don&#39;t understand your first statement about leading zeros, though. Could you explain it further?"}, {"owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "edited": false, "score": 0, "creation_date": 1477694481, "post_id": 40260910, "comment_id": 67885493, "body": "If I want to filter <code>[1037, 137, 2037]</code> to <code>[1037, 2037]</code> how would I do that using <code>extractSuff&#39;</code>? Note that if you never need leading zeros that isn&#39;t a problem, but if you do it does make this more complex. (Note that doing what I mention requires deciding how to handle <code>37</code> in the above example)."}, {"owner": {"reputation": 383, "user_id": 4937439, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZmHu9gy1S7c/AAAAAAAAAAI/AAAAAAAADpE/tKoIiG2kniU/photo.jpg?sz=128", "display_name": "Sandeep Tuniki", "link": "https://stackoverflow.com/users/4937439/sandeep-tuniki"}, "reply_to_user": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "edited": false, "score": 0, "creation_date": 1477706284, "post_id": 40260910, "comment_id": 67887706, "body": "Ah, now I get it. I guess that is only possible through strings since integers, as you mentioned, can&#39;t store the leading zeroes."}], "tags": [], "owner": {"reputation": 383, "user_id": 4937439, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZmHu9gy1S7c/AAAAAAAAAAI/AAAAAAAADpE/tKoIiG2kniU/photo.jpg?sz=128", "display_name": "Sandeep Tuniki", "link": "https://stackoverflow.com/users/4937439/sandeep-tuniki"}, "is_accepted": false, "score": 1, "last_activity_date": 1477542582, "last_edit_date": 1477542582, "creation_date": 1477480650, "answer_id": 40260910, "question_id": 40260195, "link": "https://stackoverflow.com/questions/40260195/how-do-i-filter-numbers-which-end-in-other-numbers-in-haskell/40260910#40260910", "title": "How do I filter numbers which end in other numbers in Haskell?", "body": "<p>The other answers will work if all you want is to match a <code>2-digit</code> number. Here is a more generalized solution:</p>\n\n<pre><code>import Data.List (isSuffixOf)\n\nextractSuff :: Int -&gt; [Int] -&gt; [Int]\nextractSuff n xs = filter (\\x -&gt; isSuffixOf (show n) (show x)) xs\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Upon Guvante's suggestion, I'm adding another solution which doesn't stringify numbers.</p>\n\n<pre><code>extractSuff' :: Int -&gt; [Int] -&gt; [Int]\nextractSuff' n xs = filter (\\x -&gt; n == (x `mod` (10 ^ (numDigits n)))) xs\n    where numDigits n\n            | abs n &lt; 10 = 1\n            | otherwise  = 1 + numDigits (n `div` 10)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7074547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YSnIf.jpg?s=128&g=1", "display_name": "AlbertoRRM", "link": "https://stackoverflow.com/users/7074547/albertorrm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477542582, "creation_date": 1477478722, "question_id": 40260195, "link": "https://stackoverflow.com/questions/40260195/how-do-i-filter-numbers-which-end-in-other-numbers-in-haskell", "title": "How do I filter numbers which end in other numbers in Haskell?", "body": "<p>For instance, I want to extract from a list the numbers that end in 67: 1637767, 9967, 523467...</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477488055, "post_id": 40259952, "comment_id": 67787191, "body": "Have you tried writing your own custom build script (<code>Setup.hs</code>?) Cabal only supports a fixed set of preprocessors known to it, anyways. You will have to program the logic for not re-creating your files when there is no need. E.g. see <a href=\"http://stackoverflow.com/questions/7370029/any-example-of-a-custom-preprocessor-in-haskell\">here</a> and <a href=\"http://stackoverflow.com/questions/16256987/haskell-packaging-cabal-package-with-custom-preprocessors\">here</a> (these look like duplicates to me. Any reason you think they aren&#39;t?)"}, {"owner": {"reputation": 1348, "user_id": 269515, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c36f2b6ca4c0a5955da7d497341c9653?s=128&d=identicon&r=PG", "display_name": "Ben Clifford", "link": "https://stackoverflow.com/users/269515/ben-clifford"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477490257, "post_id": 40259952, "comment_id": 67788976, "body": "I have. The preprocessor support in the question you link is (as I understand it) only one source file =&gt; one post-processed Haskell file, which is not how this operates. That&#39;s what I meant by: &quot;I think this means I can&#39;t use cabal&#39;s preprocessor support.&quot; That also doesn&#39;t address the case where Setup.hs is not run at all because cabal thinks nothing needs rebuilding."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477491091, "post_id": 40259952, "comment_id": 67789584, "body": "You don&#39;t necessarily use <code>hookedPreProcessors</code> but maybe <code>preConf</code> or <code>postConf</code> or whatever suits your needs (hard to tell what those actually are). Even if you used <code>PreProcessor</code> you could simply ignore the <code>FilePath</code> arguments and find the files yourself (although this seems dirty..). And <code>Setup.hs</code> is <i>always</i> run when you execute a custom build script, it may just decide that it has nothing to do (but if you put your code in <code>main</code> <b>outside</b> of the cabal options, it will be run every time)"}, {"owner": {"reputation": 1348, "user_id": 269515, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c36f2b6ca4c0a5955da7d497341c9653?s=128&d=identicon&r=PG", "display_name": "Ben Clifford", "link": "https://stackoverflow.com/users/269515/ben-clifford"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477568104, "post_id": 40259952, "comment_id": 67825343, "body": "ah, maybe it&#39;s stack optimising away any invocation of cabal, then."}], "owner": {"reputation": 1348, "user_id": 269515, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c36f2b6ca4c0a5955da7d497341c9653?s=128&d=identicon&r=PG", "display_name": "Ben Clifford", "link": "https://stackoverflow.com/users/269515/ben-clifford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477478089, "creation_date": 1477478089, "question_id": 40259952, "link": "https://stackoverflow.com/questions/40259952/generating-haskell-source-files-in-cabal-packaging", "title": "Generating Haskell source files in cabal packaging", "body": "<p>I have a package where most of the <code>.hs</code> files are generated from some spec files by a Haskell processor (stored in a subdirectory).</p>\n\n<p>At present this preprocessor is run manually, and so does not work particularly well with version control or when used as part of a larger stack.</p>\n\n<p>I would like Cabal to run this processor, for example from Setup.hs, so that the package can be built using <code>cabal build</code> or by <code>stack</code> as part of a larger project without needing separate manual steps.</p>\n\n<p>The input files are not 1-1 with the output <code>.hs</code> files: instead, a pile of <code>.csv</code> files are read in, and then a differently arranged pile of <code>.hs</code> files are output. I think this means I can't use cabal's preprocessor support.</p>\n\n<p>For my present development purposes I have bodged a call to <code>stack build &amp;&amp; stack exec gen-exe</code> at the start of Setup.hs. This runs sometimes too many times (for example it runs on <code>register</code> at the end of a build; and sometimes not enough (for example, it does not run if one of the input <code>.csv</code> files changes, so a manual clean is necessary).</p>\n\n<p>Is this achieveable in cabal, and if so, what do I need to put where to run my build commands frequently enough and not too frequently?</p>\n\n<p>(This is an inherited package... please don't blame me)</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1477488657, "post_id": 40259028, "comment_id": 67787694, "body": "Does the suggestion (<code>extra-source-files: stack.yaml</code>) in the thread you linked work? I would expect it to. Hackage package are not meant to be &#39;stack-installable&#39; (stack doesn&#39;t do anything but call other programs which do all the work, so &#39;stack-installable&#39; is just &#39;cabal-installable&#39;), or you are meant to get the <code>stack.yaml</code> from your resolver (remember, package maintainers will likely want to support multiple compile version and will have multiple <code>stack.yaml</code>)."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1477490363, "post_id": 40259028, "comment_id": 67789043, "body": "In addition to the previous comment, I&#39;d recommend getting your package into Stackage: <a href=\"https://github.com/fpco/stackage#add-your-package\" rel=\"nofollow noreferrer\">github.com/fpco/stackage#add-your-package</a>"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477501997, "post_id": 40259028, "comment_id": 67796774, "body": "@user2407038 <code>extra-source-files</code> doesn&#39;t help, see my update."}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1477502237, "post_id": 40259028, "comment_id": 67796883, "body": "@MichaelSnoyman my package consists of only one source code file, it&#39;s a really small pandoc filter that&#39;s not going to change much. Are we supposed to push small stuff like that to stackage as well? Won&#39;t there be too much administrative overhead for you guys? Also, I&#39;ll have to release a new package every few months, whenever the next <code>lts</code> comes along, even if my dependencies and code don&#39;t change at all, right? (please correct me if I&#39;m wrong and take it as feedback about what information I gathered as a casual haskell dev)"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1477508879, "post_id": 40259028, "comment_id": 67800607, "body": "I think the answer you&#39;re looking forward is to first stack unpack your package, then stack install inside the new directory."}, {"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 1, "creation_date": 1477533320, "post_id": 40259028, "comment_id": 67809128, "body": "Relevant stack issue about using stack.yaml from hackage package: <a href=\"https://github.com/commercialhaskell/stack/issues/2122\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/2122</a>"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "reply_to_user": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 0, "creation_date": 1477561851, "post_id": 40259028, "comment_id": 67821283, "body": "Thanks @mgsloan, that&#39;s exactly my issue!"}], "answers": [{"tags": [], "owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "is_accepted": true, "score": 1, "last_activity_date": 1477561817, "creation_date": 1477561817, "answer_id": 40281462, "question_id": 40259028, "link": "https://stackoverflow.com/questions/40259028/create-hackage-package-that-can-be-installed-with-stack/40281462#40281462", "title": "Create hackage package that can be installed with stack", "body": "<p>As mentioned by @mgsloan in the comments above: There's an open <a href=\"https://github.com/commercialhaskell/stack/issues/2122\" rel=\"nofollow\">stack issue about using stack.yaml from hackage package</a>.</p>\n\n<p>I guess until it's fixed I'll just tell people to clone from GitHub (or as mentioned by @MichaelSnoyman to <code>stack unpack</code>) and then <code>cd</code> into the newly created directory and <code>stack install</code> there.</p>\n"}], "owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 40281462, "answer_count": 1, "score": 1, "last_activity_date": 1477561817, "creation_date": 1477475478, "last_edit_date": 1477502911, "question_id": 40259028, "link": "https://stackoverflow.com/questions/40259028/create-hackage-package-that-can-be-installed-with-stack", "title": "Create hackage package that can be installed with stack", "body": "<p>When running <code>stack sdist</code> in my project directory, the <code>stack.yaml</code> file isn't included in the tarball (this seems to <a href=\"https://github.com/commercialhaskell/stack/issues/2105\" rel=\"nofollow\">be expected</a>).</p>\n\n<p>Consequently, when I upload the tarball to hackage, then <code>stack install mypackage</code> it complains about missing dependencies (<code>extra-deps</code>) which I specified in the <code>stack.yaml</code> file.</p>\n\n<pre><code>$ stack install pandoc-placetable\n\nRun from outside a project, using implicit global project config\nUsing resolver: lts-5.17 from implicit global project's config file: ~/.stack/global-project/stack.yaml\nWhile constructing the BuildPlan the following exceptions were encountered:\n\n--  Failure when adding dependencies:    \n      spreadsheet: needed (&gt;=0.1.3 &amp;&amp; &lt;0.1.4), not present in build plan (latest applicable is 0.1.3.4)\n    needed for package: pandoc-placetable-0.4\n\n--  While attempting to add dependency,\n    Could not find package spreadsheet in known packages\n\nRecommended action: try adding the following to your extra-deps in /Users/maurobieg/.stack/global-project/stack.yaml\n- spreadsheet-0.1.3.4\n</code></pre>\n\n<p>Or what's the recommended way to make a hackage package <code>stack</code>-installable if it has further hackage dependencies?</p>\n\n<p><strong>Update</strong>: I just added <code>extra-source-files: stack.yaml</code> to the cabal file and the <code>stack.yaml</code> is indeed included in the tarbal of the newly published version. Nevertheless, <code>stack install pandoc-placetable-0.4.1</code> still comes up with the same error.</p>\n\n<p>I could also just tell people who don't want to install <code>cabal-install</code> on their system to clone from GitHub, then build with <code>stack</code>. Is that the recommended approach for tiny packages? Or should I ask them to include the dependency of <code>pandoc-placetable</code> (i.e. <code>spreadsheet</code>) in their global <code>stack.yaml</code>? Smells like polluting a global file...</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1477471793, "post_id": 40257417, "comment_id": 67776589, "body": "Works for me. Your indentation is a bit weird, though, maybe that&#39;s all."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1477474287, "last_edit_date": 1495541612, "creation_date": 1477474287, "answer_id": 40258571, "question_id": 40257417, "link": "https://stackoverflow.com/questions/40257417/how-write-the-let-program-in-where/40258571#40258571", "title": "How write the let program in where?", "body": "<p>Indent <code>x=,dy=,dx=</code> on the same column:</p>\n\n<pre><code>slope (x1,y1) (x2,y2)\n | x&lt;0      = \"wrong input\"\n |otherwise = \"I don't know what Im doing\"\n where x=dy/dx\n       dy=(y2-y1)\n       dx=(x2-x1)\n</code></pre>\n\n<p>The <a href=\"https://stackoverflow.com/a/33010779/3234959\">indentation rule</a> is: after <code>where</code> (and <code>let</code>,<code>do</code>,<code>case of</code>) the very first non-space (non-comment) word starts a block of entries, and all those must start on the same column of that word. Above the word is <code>x</code>. You can indent in other ways, of course: e.g.</p>\n\n<pre><code>slope (x1,y1) (x2,y2)\n | x&lt;0      = \"wrong input\"\n |otherwise = \"I don't know what Im doing\"\n where\n   x=dy/dx\n   dy=(y2-y1)\n   dx=(x2-x1)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5484032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-CIzwVm-CRlE/AAAAAAAAAAI/AAAAAAAAAAw/MksXD0Na5f4/photo.jpg?sz=128", "display_name": "Shahzad", "link": "https://stackoverflow.com/users/5484032/shahzad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1477474287, "creation_date": 1477470883, "question_id": 40257417, "link": "https://stackoverflow.com/questions/40257417/how-write-the-let-program-in-where", "title": "How write the let program in where?", "body": "<p>This is a program in Haskell that with let:  </p>\n\n<pre><code>   slope (x1,y1) (x2,y2) = let dy = y2-y1\n    dx = x2-x1\n    in dy/dx\n</code></pre>\n\n<p>Now I try in where but it's not working properly actually I am unable to build a allgo for where would you like to write it for me :</p>\n\n<pre><code>slope (x1,y1) (x2,y2)\n | x&lt;0 =\"wronge input\"\n |otherwise =\"I don't know what Im doing\"\n where x=dy/dx\n dy=(y2-y1)\n dx=(x2-x1)\n</code></pre>\n"}, {"tags": ["function", "haskell", "types"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1477464678, "post_id": 40255405, "comment_id": 67772578, "body": "If you always want <code>count</code> to be <code>Int</code>, you could define it so in <code>Tree</code>: <code>data Tree k = Leaf | Node k Int (Tree k Int) (Tree k Int)</code>. No change required to your function, just the signature."}, {"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1477465309, "post_id": 40255405, "comment_id": 67772900, "body": "Awesome amigo, that completely did the trick. I had to go and get rid of the <code>count</code> part from the <code>Tree k count</code> in my function signatures as well as in the initial declaration of the type, exactly like you said! Put that in an answer and I&#39;ll mark it as correct :)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477488801, "post_id": 40255405, "comment_id": 67787820, "body": "&quot;The Num count really doesn&#39;t seem like a good way to solve the problem&quot; - this <i>is</i> the Haskell way of solving the problem."}, {"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477534554, "post_id": 40255405, "comment_id": 67809437, "body": "@user2407038 Num count isn&#39;t specific enough. As far as I&#39;m concerned, Haskell is about strict typing, so if I know it&#39;ll always be Int then I would like to define it as such."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 3, "last_activity_date": 1477467150, "last_edit_date": 1477467150, "creation_date": 1477466465, "answer_id": 40256064, "question_id": 40255405, "link": "https://stackoverflow.com/questions/40255405/how-to-define-the-types-of-parameters-in-a-haskell-type-constructor/40256064#40256064", "title": "How to define the types of parameters in a Haskell type constructor?", "body": "<p>Two alternatives here. The more straightforward one is to just not parametrize <code>count</code> over the <code>Tree</code> type.</p>\n\n<pre><code>data Tree k = Leaf | Node k Int (Tree k) (Tree k)\n\ntree_insert :: Ord k =&gt; k -&gt; Tree k -&gt; Tree k\ntree_insert ...\n</code></pre>\n\n<p>Alternately, if you envision yourself needing the more general tree type sometimes, you could stick with a type synonyn.</p>\n\n<pre><code>data Tree k count = Leaf | Node k count (Tree k count) (Tree k count)\ntype TreeInt k = Tree k Int\n\ntree_insert :: Ord k =&gt; k -&gt; TreeInt k -&gt; TreeInt k\ntree_insert ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "edited": false, "score": 0, "creation_date": 1477534618, "post_id": 40261976, "comment_id": 67809452, "body": "This is great too, another awesome way to do it. Thanks!"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1477483971, "creation_date": 1477483971, "answer_id": 40261976, "question_id": 40255405, "link": "https://stackoverflow.com/questions/40255405/how-to-define-the-types-of-parameters-in-a-haskell-type-constructor/40261976#40261976", "title": "How to define the types of parameters in a Haskell type constructor?", "body": "<p>Your original tree type is already fully parametric in the type of data stored at each node; you can work with a tree that stores <code>(k, Int)</code> values instead of just <code>k</code> values.</p>\n\n<pre><code>data Tree k = Leaf | Node k (Tree k) (Tree k)\n\ntree_insert :: a -&gt; Tree (a, Int) -&gt; Tree (a, Int)\ntree_insert k Leaf = Node (k, 1) Leaf Leaf\ntree_insert k (Node (n, count) l r)\n  | k == n = Node (n, count+1) l r\n  | k &lt; n  = Node (n, count) (tree_insert k l) r\n  | k &gt; n  = Node (n, count) l (tree_insert k r)\n</code></pre>\n"}], "owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 2, "accepted_answer_id": 40256064, "answer_count": 2, "score": 0, "last_activity_date": 1477483971, "creation_date": 1477464199, "question_id": 40255405, "link": "https://stackoverflow.com/questions/40255405/how-to-define-the-types-of-parameters-in-a-haskell-type-constructor", "title": "How to define the types of parameters in a Haskell type constructor?", "body": "<p>Imagine a standard construction of a Tree first:</p>\n\n<pre><code>data Tree k = Leaf | Node k (Tree k) (Tree k) \n</code></pre>\n\n<p>I want to implement a version of this where I deal with duplicate entries by counting them, so I have type like this:</p>\n\n<pre><code>data Tree k count = Leaf | Node k count (Tree k count) (Tree k count) \n</code></pre>\n\n<p>Accordingly my code is:</p>\n\n<pre><code>tree_insert :: Ord k =&gt; k -&gt; Tree k count -&gt; Tree k count\ntree_insert k Leaf = Node k 1 Leaf Leaf\ntree_insert k (Node n count l r)\n    | k == n = Node n (count+1) l r\n    | k &lt; n  = Node n count (tree_insert k l) r\n    | k &gt; n  = Node n count l (tree_insert k r)\n</code></pre>\n\n<p>If you try to use this code however, you will get the following error:</p>\n\n<blockquote>\n  <p>Could not deduce (Num count) arising from the literal \u20181\u2019</p>\n</blockquote>\n\n<p>To fix it I changed the type declaration for the function to this:</p>\n\n<pre><code>tree_insert :: (Ord k, Num count) =&gt; k -&gt; Tree k count -&gt; Tree k count\n</code></pre>\n\n<p>However down the line I ran into further problems. To me it seems like Haskell is telling me that, without the <code>Num count</code>, it doesn't know what type it is meant to be and therefore when I assign it as 1 in the first pattern, it produces the error. The <code>Num count</code> really doesn't seem like a good way to solve the problem. Ideally, I should be able to define what type count is when I make the initial type declaration, something like:</p>\n\n<pre><code>data Tree k count = Leaf | Node k count (Tree k count) (Tree k count)\nwhere count is Int\n</code></pre>\n\n<p>Obviously the above code is no good, but an example of the kind of thing I'm thinking of.</p>\n\n<p>If what I want is possible, or less ideally if there is another way to approach this issue, I'd love to hear it. The emphasis is on definition of data types and functions and all, not just this specific problem.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "types", "functional-programming", "higher-rank-types"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1477453917, "post_id": 40252867, "comment_id": 67768892, "body": "Just think of <code>Num a =&gt; a</code> as a function <code>NumDict a -&gt; a</code> and it should all be clear."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1477455900, "post_id": 40252867, "comment_id": 67769411, "body": "Though you had already linked to the question suggested by @Alec , it is worth pointing out that the second answer there (the one by luqui) is probably clearer than the accepted one in showing why <code>prepend</code> works and the other functions don&#39;t (in short, the compiler can only move the constraint to where you want it to be if you have the synonym at the rightmost position of the signature). By the way, note there is nothing strange or &quot;delayed&quot; in your usage examples of <code>prepend</code> -- it is doing exactly what you would expect a <code>Num a =&gt; a -&gt; [a] -&gt; [a]</code> function to do."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1477456037, "post_id": 40252867, "comment_id": 67769435, "body": "Yes, luqui&#39;s answer on the linked question is exactly relevant."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1477456412, "post_id": 40252867, "comment_id": 67769523, "body": "Oops! I had not intended to just link back to the same question you had linked - it was indeed luqui&#39;s answer I thought was pertinent."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477480804, "post_id": 40252867, "comment_id": 67782352, "body": "@duplode Yeah, second answer by @luqui makes now everything clear. Seems like type checking depends on whether my type-aliased argument on covariant position or contravariant. I understood earlier only why <code>foo :: forall a . a -&gt; (forall b . b)</code> is the same as <code>foo :: forall a b . a -&gt; b</code>. But now I see that such rules also spreads on constraints if you represent them as dictionaries. Now it seems quite elegant :)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1477521875, "post_id": 40252867, "comment_id": 67806376, "body": "@Shersh Playing with your question made me stumble upon something that seems genuinely strange, and to <a href=\"http://stackoverflow.com/q/40273246/2751851\">a new question</a>."}], "answers": [{"comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1477480836, "post_id": 40256778, "comment_id": 67782378, "body": "&gt; that does not mean that all the expressions you can build up using the functions defined in it will be well-typed. Yeah, that is a good point. I understood only after some thinking and observing error."}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": false, "score": 1, "last_activity_date": 1477468851, "creation_date": 1477468851, "answer_id": 40256778, "question_id": 40252867, "link": "https://stackoverflow.com/questions/40252867/rankntypes-with-type-aliases-confusion/40256778#40256778", "title": "RankNTypes with type aliases confusion", "body": "<blockquote>\n  <p>Seems like type type checking delayed at runtime :(</p>\n</blockquote>\n\n<p>Not really. Here it's may be a bit surprising because you get the type error in ghci <em>after</em> having loaded the file. However it can be explained: the file itself is perfectly fine but that does not mean that <em>all</em> the expressions you can build up using the functions defined in it will be well-typed.</p>\n\n<p>Higher-rank polymorphism has nothing to do with it. <code>(+)</code> for instance is defined in the prelude but if you try to evaluate <code>2 + \"argh\"</code> in ghci, you'll get a type-error too:</p>\n\n<pre><code>No instance for (Num [Char]) arising from a use of \u2018+\u2019\nIn the expression: 2 + \"argh\"\nIn an equation for \u2018it\u2019: it = 2 + \"argh\"\n</code></pre>\n\n<p>Now, let's see what the problem is with <code>first</code>: it claims that given a <code>NumList a</code>, it can produce an <code>a</code>, no questions asked. But we know how to build <code>NumList a</code> out of thin air! Indeed the <code>Num a</code> constraints means that <code>0</code> is an <code>a</code> and makes <code>[0]</code> a perfectly valid <code>NumList a</code>. Which means that if <code>first</code> were accepted then <em>all</em> the types would be inhabited:</p>\n\n<pre><code>first :: NumList a -&gt; a\nfirst = head\n\nelt :: a\nelt = first [0]\n</code></pre>\n\n<p>In particular <a href=\"https://hackage.haskell.org/package/void-0.7.1/docs/Data-Void.html\" rel=\"nofollow\">Void</a> would be too:</p>\n\n<pre><code>argh :: Void\nargh = elt\n</code></pre>\n\n<p>Argh indeed!</p>\n"}], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 1, "closed_date": 1477481275, "answer_count": 1, "score": 3, "last_activity_date": 1477468851, "creation_date": 1477449838, "last_edit_date": 1495542801, "question_id": 40252867, "link": "https://stackoverflow.com/questions/40252867/rankntypes-with-type-aliases-confusion", "closed_reason": "Duplicate", "title": "RankNTypes with type aliases confusion", "body": "<p>I'm trying to understand how type constraints work with type aliases. First, let's assume I have next type alias:</p>\n\n<pre><code>type NumList a = Num a =&gt; [a]\n</code></pre>\n\n<p>And I have next function:</p>\n\n<pre><code>addFirst :: a -&gt; NumList a -&gt; NumList\naddFirst x (y:_) = x + y\n</code></pre>\n\n<p>This function fails with next error:</p>\n\n<pre><code>Type.hs:9:13: error:\n    \u2022 No instance for (Num a) arising from a pattern\n      Possible fix:\n        add (Num a) to the context of\n          the type signature for:\n            addFirst :: a -&gt; NumList a -&gt; a\n    \u2022 In the pattern: y : _\n      In an equation for \u2018addFirst\u2019: ad\n</code></pre>\n\n<p>Which is obvious. This problem already described here: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/14585220/understanding-a-rank-2-type-alias-with-a-class-constraint\">Understanding a rank 2 type alias with a class constraint</a></p>\n\n<p>And I understand why we need <code>{-# LANGUAGE RankNTypes #-}</code> for such type aliases to work and why previous example doesn't work. But what I don't understand is why next example compiles fine (on ghc 8):</p>\n\n<pre><code>prepend :: a -&gt; NumList a -&gt; NumList a\nprepend = (:)\n</code></pre>\n\n<p>Of course it fails in <code>ghci</code> if I try to pass wrong value:</p>\n\n<pre><code>\u03bb: prepend 1 []\n[1]\n\u03bb: prepend \"xx\" []\n\n&lt;interactive&gt;:3:1: error:\n    \u2022 No instance for (Num [Char]) arising from a use of \u2018prepend\u2019\n    \u2022 When instantiating \u2018it\u2019, initially inferred to have\n      this overly-general type:\n        NumList [Char]\n      NB: This instantiation can be caused by the monomorphism restriction.\n</code></pre>\n\n<p>Seems like type type checking delayed at runtime :(</p>\n\n<p>Moreover, some simple and seems to be the same piece of code doesn't compile:</p>\n\n<pre><code>first :: NumList a -&gt; a\nfirst = head\n</code></pre>\n\n<p>And produces next error:</p>\n\n<pre><code>Type.hs:12:9: error:\n    \u2022 No instance for (Num a)\n      Possible fix:\n        add (Num a) to the context of\n          the type signature for:\n            first :: NumList a -&gt; a\n    \u2022 In the expression: head\n      In an equation for \u2018first\u2019: first = head\n</code></pre>\n\n<p>Can somebody explain what is going on here? I expect some consistency in whether function type checks or not.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477441335, "post_id": 40251676, "comment_id": 67765858, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/19215851/haskell-return-item-from-custom-type\">Haskell - Return item from custom type</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 4, "creation_date": 1477441633, "post_id": 40251676, "comment_id": 67765920, "body": "(The keywords you are looking for are &quot;pattern matching&quot; and &quot;case expression&quot;.)"}, {"owner": {"reputation": 978, "user_id": 5028531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dMWez.jpg?s=128&g=1", "display_name": "Arnold Balliu", "link": "https://stackoverflow.com/users/5028531/arnold-balliu"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477441834, "post_id": 40251676, "comment_id": 67765967, "body": "I really don&#39;t get this concept. I looked at the possible duplicate but the person on that question is using a tuple and mashing everything together. That is not my case. Can you explain using what I gave you above in code how I would do it?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477442266, "post_id": 40251676, "comment_id": 67766049, "body": "That is not a perfect duplicate indeed, but look at the second answer to that question, and how the <code>fsmGetQ</code> function there extracts a field from a <code>FSM</code> value. That is pattern matching. The only essential difference from your case is that you have two constructors (<code>CharToElement</code> and <code>IntToElement</code>), and so you will need a case expression to pattern match on both (i.e. handle both cases)."}, {"owner": {"reputation": 978, "user_id": 5028531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dMWez.jpg?s=128&g=1", "display_name": "Arnold Balliu", "link": "https://stackoverflow.com/users/5028531/arnold-balliu"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477443589, "post_id": 40251676, "comment_id": 67766396, "body": "I did not try this but would this be correct: ExtractPrimitive (Char, Int) (this is appended with | at the data Element statement)  extractInt (<i>, i) = i extractChar (c,</i>) = c. I am trying to understand what you meant first. Is this it?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1477444664, "post_id": 40251676, "comment_id": 67766648, "body": "No, it isn&#39;t. Please search for the keywords I suggested. To get you started, here is a better duplicate, with plenty of examples in the answers: <a href=\"http://stackoverflow.com/q/6047522/2751851\">Haskell type and pattern matching question: extracting fields from a data type</a>."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1477448113, "post_id": 40251676, "comment_id": 67767466, "body": "@ArnoldB if you also provide some examples of what you&#39;re trying to implement eventually (i.e. postfix evaluator) and how it should work with <code>Char</code> and <code>Int</code> values, maybe someone can come up with nice solution for you problem."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1477451582, "post_id": 40251676, "comment_id": 67768300, "body": "What representation will you use for your &quot;either Int or Char&quot;? (or in other words, you want to write a function <code>getIntOrChar :: Element -&gt; ???</code>)"}, {"owner": {"reputation": 978, "user_id": 5028531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dMWez.jpg?s=128&g=1", "display_name": "Arnold Balliu", "link": "https://stackoverflow.com/users/5028531/arnold-balliu"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1477451957, "post_id": 40251676, "comment_id": 67768401, "body": "@Shersh, immibis I just posted my code. Please check it out. I think I am close."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1477954361, "post_id": 40251676, "comment_id": 67957967, "body": "@ArnoldB I didn&#39;t ask you to post your code though, I asked a question that you didn&#39;t answer."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1477500575, "last_edit_date": 1477500575, "creation_date": 1477473888, "answer_id": 40258433, "question_id": 40251676, "link": "https://stackoverflow.com/questions/40251676/haskell-custom-data-type/40258433#40258433", "title": "Haskell Custom Data Type", "body": "<p>There are many ways to fix this. I'll only provide some general suggestions.</p>\n\n<p>First of all, strive to use only total functions -- functions that never error out. In particular, <code>head</code>, <code>tail</code> are unnecessary in most idiomatic Haskell code, and should be regarded as a code smell.</p>\n\n<p>Further, avoid <code>if</code>/guards that can be replaced by pattern matching. You really should get used to that, and there are <a href=\"http://learnyouahaskell.com/syntax-in-functions#pattern-matching\" rel=\"nofollow\">good tutorials</a> around.</p>\n\n<p>For instance, here's a first reworking of your <code>operate</code> function:</p>\n\n<pre><code>operate :: Element -&gt; Element -&gt; Element -&gt; Element\noperate (CharToElement '+') a b =\n   IntToElement (extractInt a + extractInt b) \noperate (CharToElement '-') a b =\n   IntToElement (extractInt a - extractInt b) \noperate (CharToElement '*') a b =\n   IntToElement (extractInt a * extractInt b) \noperate (CharToElement '/') a b =\n   IntToElement (extractInt a `div` extractInt b) \noperate _                   _ _ =\n   IntToElement 0\n</code></pre>\n\n<p>This is far from being perfect. First, why returning <code>0</code> on error? There's no way the caller can distinguish that from an actual null result. Second, the function <code>extractInt</code> will necessarily be partial (or again return a bogus result): what if <code>a</code> is a char instead?</p>\n\n<p>Ultimately, the big lie is already found at the type level:</p>\n\n<pre><code>operate :: Element -&gt; Element -&gt; Element -&gt; Element\n</code></pre>\n\n<p>This type indeed lies: we do not always have a resulting <code>Element</code> for all inputs. We want to model errors instead. This is more honest:</p>\n\n<pre><code>operate :: Element -&gt; Element -&gt; Element -&gt; Maybe Element\n</code></pre>\n\n<p>and can be implemented, again, by pattern matching:</p>\n\n<pre><code>operate :: Element -&gt; Element -&gt; Element -&gt; Maybe Element\noperate (CharToElement '+') (IntToElement a) (IntToElement b) =\n   Just $ IntToElement $ a + b\noperate (CharToElement '-') (IntToElement a) (IntToElement b) =\n   Just $ IntToElement $ a - b\noperate (CharToElement '*') (IntToElement a) (IntToElement b) =\n   Just $ IntToElement $ a * b\noperate (CharToElement '/') (IntToElement a) (IntToElement b) =\n   Just $ IntToElement $ a `div` b\noperate _                   _                _                =\n   Nothing\n</code></pre>\n\n<p>And voila, no need for dangerous <code>extract</code> functions. When the inputs are not integers, we simply return <code>Nothing</code> since the first matches fail.</p>\n\n<p>This might feel less convenient, since now we need to handle the <code>Maybe Element</code> in the rest of the code, which no longer receives a simple <code>Element</code> to work with. But this is the whole point! The rest of the code <em>needs</em> to cope with the possible errors, so the error handling must be performed there as well. The <code>Maybe Element</code> type forces us to do that.</p>\n"}], "owner": {"reputation": 978, "user_id": 5028531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dMWez.jpg?s=128&g=1", "display_name": "Arnold Balliu", "link": "https://stackoverflow.com/users/5028531/arnold-balliu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 0, "accepted_answer_id": 40258433, "answer_count": 1, "score": 2, "last_activity_date": 1477500575, "creation_date": 1477440497, "last_edit_date": 1477453060, "question_id": 40251676, "link": "https://stackoverflow.com/questions/40251676/haskell-custom-data-type", "title": "Haskell Custom Data Type", "body": "<p>I am working on a homework assignment and we have an array of mixed elements Char and Int.</p>\n\n<p>I created this custom type:</p>\n\n<pre><code>data Element = CharToElement Char | IntToElement Int\n</code></pre>\n\n<p>Which converts <code>Char</code>s and <code>Int</code>s into <code>Element</code>s so I can deal with them.</p>\n\n<p>The issue I am having is what to do when I want to convert back?</p>\n\n<p>So now that I do (head array) and that returns <code>Element</code> how do I convert that <code>Element</code> to an <code>Int</code> or <code>Char</code>.</p>\n\n<p>This is for a postfix evaluator program.</p>\n\n<p>Help is appreciated. Thanks.</p>\n\n<p>Edit:</p>\n\n<p>So I worked on it and this is what I have:</p>\n\n<pre><code>data Element = ElementConstructor (Char, Int, Bool) | IntToElement Int | CharToElement Char | NIL\n\nextractInt (_,i,_) = i\nextractChar (c,_,_) = c\nextractType (_,_,b) = b\n\nstack_push :: [Element] -&gt; Element -&gt; [Element]\nstack_push stack element = (element:stack)\n\nstack_pop :: [Element] -&gt; [Element]\nstack_pop stack = (tail stack)\n\nstack_top :: [Element] -&gt; Element\nstack_top stack = (head stack)\n\npostfix_eval eqn = (postfix_eval_rec (postfix_eval_const eqn []) [])\n\npostfix_eval_const eqn_raw eqn_conv =\n    if null eqn_raw\n        then NIL\n    else\n        if (isNumber (head eqn_raw))\n            then ElementConstructor(NIL, (head eqn_raw), True):eqn_conv\n        else if (isAlpha (head eqn_raw))\n            then ElementConstructor((head eqn_raw), NIL, False):eqn_conv\n        postfix_eval_const (tail eqn_raw) eqn_conv\n\n\noperate :: Element -&gt; Element -&gt; Element -&gt; Element\noperate operator_char a b = \n    if operator_char == '+'\n        then IntToElement ( (extractInt a) + (extractInt b) ) \n    else if operator_char == '-'\n        then IntToElement ( (extractInt b) - (extractInt a) )\n    else if operator_char == '*'\n        then IntToElement ( (extractInt a) * (extractInt b) )\n    else if operator_char == '/'\n        then IntToElement ( (extractInt b) `div` (extractInt a) )\n    else\n        IntToElement(0)\n\npostfix_eval_rec :: [Element] -&gt; [Element] -&gt; Int\npostfix_eval_rec eqn stack = \n    if null eqn\n        then (extractInt (stack_top stack))\n    else if ( (extractType (head eqn)) )\n        then (postfix_eval_rec (tail eqn) (stack_push stack (head eqn) ) )\n    else\n        (postfix_eval_rec (tail stack) (stack_push (stack_pop (stack_pop stack)) (operate (head eqn) (stack_top stack) (stack_top (stack_pop stack)))))\n</code></pre>\n\n<p>The idea is that you enter something like:\n    postfix_eval [1,2,3,'+',4,'+','*']\nand you get an answer in the form of an Int, in this case you get 9</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1477456474, "post_id": 40251348, "comment_id": 67769546, "body": "<code>stack install hspec</code> works for me, with the same version of stack, cabal, and ghc. Are you using a special stack.yaml file?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1477468254, "post_id": 40251348, "comment_id": 67774560, "body": "How did you install Stack and GHC?"}, {"owner": {"reputation": 158, "user_id": 2825414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/38b8b99f24ef9a602ad7a78385a3b1b2?s=128&d=identicon&r=PG", "display_name": "beane", "link": "https://stackoverflow.com/users/2825414/beane"}, "edited": false, "score": 0, "creation_date": 1477506600, "post_id": 40251348, "comment_id": 67799348, "body": "I downloaded stack a while ago -- don&#39;t really remember. But I updated with <code>stack upgrade</code>. ghc was installed originally through haskell platform, which might be causing some conflicts? How can I debug that?"}, {"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 3, "creation_date": 1477516448, "post_id": 40251348, "comment_id": 67804365, "body": "To test if it&#39;s due to the globally installed ghc, you can add <code>system-ghc: false</code> to your <code>~&#47;.stack&#47;config.yaml</code>.  Then, use <code>stack setup</code> to install a stack-managed ghc"}], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 2825414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/38b8b99f24ef9a602ad7a78385a3b1b2?s=128&d=identicon&r=PG", "display_name": "beane", "link": "https://stackoverflow.com/users/2825414/beane"}, "is_accepted": true, "score": 1, "last_activity_date": 1478112273, "creation_date": 1478112273, "answer_id": 40387516, "question_id": 40251348, "link": "https://stackoverflow.com/questions/40251348/how-to-resolve-this-stack-install-issue/40387516#40387516", "title": "How to resolve this stack install issue?", "body": "<p>It was due to the globally installed <code>ghc</code>.</p>\n\n<p>I was able to solve the problem by removing <code>/Library/Haskell</code> directory and Haskell symlinks in <code>/usr/local/bin/</code>.</p>\n"}], "owner": {"reputation": 158, "user_id": 2825414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/38b8b99f24ef9a602ad7a78385a3b1b2?s=128&d=identicon&r=PG", "display_name": "beane", "link": "https://stackoverflow.com/users/2825414/beane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 40387516, "answer_count": 1, "score": 1, "last_activity_date": 1478112273, "creation_date": 1477438118, "question_id": 40251348, "link": "https://stackoverflow.com/questions/40251348/how-to-resolve-this-stack-install-issue", "title": "How to resolve this stack install issue?", "body": "<p>I'm working on some of the <a href=\"http://exercism.io/languages/haskell/tests\" rel=\"nofollow\"><code>exercism.io</code></a> Haskell problems. Unfortunately, <code>stack test</code> fails when it tries to install <code>hspec</code>.</p>\n\n<p>I don't really know how else to debug this. I'd appreciate any help.</p>\n\n<p>Output:</p>\n\n<pre><code>$ stack install hspec\nquickcheck-io-0.1.3: configure\nquickcheck-io-0.1.3: build\nhspec-expectations-0.7.2: configure\nhspec-expectations-0.7.2: build\nProgress: 2/4\n--  While building package hspec-expectations-0.7.2 using:\n      /Users/me/.stack/setup-exe-cache/x86_64-osx/setup-Simple-Cabal-1.24.0.0-ghc-8.0.1 --builddir=.stack-work/dist/x86_64-osx/Cabal-1.24.0.0 build --ghc-options \" -ddump-hi -ddump-to-file\"\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /Users/me/projects/excercism.io/haskell/space-age/.stack-work/logs/hspec-expectations-0.7.2.log\n\n    Configuring hspec-expectations-0.7.2...\n    Building hspec-expectations-0.7.2...\n    Preprocessing library hspec-expectations-0.7.2...\n    &lt;command line&gt;: cannot satisfy -package-id HUnit-1.3.1.1-21JuQs5D85SLjuJsLVrBpA\n        (use -v for more information)\n\n\n--  While building package quickcheck-io-0.1.3 using:\n      /Users/me/.stack/setup-exe-cache/x86_64-osx/setup-Simple-Cabal-1.24.0.0-ghc-8.0.1 --builddir=.stack-work/dist/x86_64-osx/Cabal-1.24.0.0 build --ghc-options \" -ddump-hi -ddump-to-file\"\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /Users/me/projects/excercism.io/haskell/space-age/.stack-work/logs/quickcheck-io-0.1.3.log\n\n    Configuring quickcheck-io-0.1.3...\n    Building quickcheck-io-0.1.3...\n    Preprocessing library quickcheck-io-0.1.3...\n    &lt;command line&gt;: cannot satisfy -package-id HUnit-1.3.1.1-21JuQs5D85SLjuJsLVrBpA\n        (use -v for more information)\n</code></pre>\n\n<p>All the log files look basically the same. The don't change when I run <code>stack install -v hspec</code>.</p>\n\n<pre><code>    # /Users/me/projects/excercism.io/haskell/space-age/.stack-work/logs/hspec-expectations-0.7.2.log\n    Building hspec-expectations-0.7.2...\n    Preprocessing library hspec-expectations-0.7.2...\n    &lt;command line&gt;: cannot satisfy -package-id HUnit-1.3.1.1-21JuQs5D85SLjuJsLVrBpA\n        (use -v for more information)\nme:space-age \u03bb less /Users/me/projects/excercism.io/haskell/space-age/.stack-work/logs/hspec-expectations-0.7.2.log\n</code></pre>\n\n<p>Debugging information:</p>\n\n<pre><code>$ stack --version\nVersion 1.2.0 x86_64 hpack-0.14.0\n\n$ type -a stack\nstack is /Users/me/.local/bin/stack\n</code></pre>\n"}, {"tags": ["haskell", "pandoc", "libreoffice"], "comments": [{"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477502978, "post_id": 40248901, "comment_id": 67797306, "body": "does it work without the <code>Math</code> element?"}, {"owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477520265, "post_id": 40248901, "comment_id": 67805833, "body": "No, I removed the Math element but the error remain the same!"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 1901888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdbde26068be6276a92de3a7acb4c55?s=128&d=identicon&r=PG", "display_name": "jkr", "link": "https://stackoverflow.com/users/1901888/jkr"}, "is_accepted": false, "score": 0, "last_activity_date": 1477436144, "creation_date": 1477436144, "answer_id": 40251056, "question_id": 40248901, "link": "https://stackoverflow.com/questions/40248901/cant-open-odt-file-generated-from-pandoc/40251056#40251056", "title": "Can&#39;t open Odt file generated from Pandoc", "body": "<p>If the haskell is compiling without error, it should be well-formed pandoc, which means that any error in the document is most likely a bug in the ODT writer. You should submit a bug to the github issue tracker.</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477436144, "creation_date": 1477426360, "last_edit_date": 1495535655, "question_id": 40248901, "link": "https://stackoverflow.com/questions/40248901/cant-open-odt-file-generated-from-pandoc", "title": "Can&#39;t open Odt file generated from Pandoc", "body": "<p>I tried to generated a basic <code>odt</code> file with a mathematic formula with the Haskell <code>pandoc</code> library to verify if the problem described with <code>docx</code> documents in <a href=\"https://stackoverflow.com/questions/40228608/spaces-in-multi-characters-variable-name-in-pandoc-export-to-docx\">this question</a> is the same with odt files.</p>\n\n<p>However, when I execute this code : </p>\n\n<pre><code>import Text.Pandoc\nimport Data.Map (fromList)\nimport qualified Data.ByteString.Lazy as B\nimport qualified Data.Set as Set\n\nmain = do\n  document &lt;- writeODT   WriterOptions{ writerStandalone=False\n                               , writerReferenceODT=Nothing\n                               , writerUserDataDir=Nothing\n                               , writerExtensions=plainExtensions\n                               }  pandoc\n  B.writeFile \"document.odt\" document\n\npandoc = Pandoc ( Meta {unMeta = fromList []})\n                           [ Para  [Str \"A small Math example\"]\n                           , Plain [Math InlineMath \"A_e = \\\\{var\\\\} + 5\"]\n                           , HorizontalRule\n                           ]\n\n\nplainExtensions = Set.fromList\n  [ Ext_table_captions\n  , Ext_implicit_figures\n  , Ext_simple_tables\n  , Ext_multiline_tables\n  , Ext_grid_tables\n  , Ext_latex_macros\n  , Ext_fancy_lists\n  , Ext_startnum\n  , Ext_definition_lists\n  , Ext_example_lists\n  , Ext_intraword_underscores\n  , Ext_blank_before_blockquote\n  , Ext_blank_before_header\n  , Ext_strikeout\n  ]\n</code></pre>\n\n<p>The generated <code>odt</code> file can't be opened with libreoffice. When the file is opening, the following error message appear : </p>\n\n<pre><code>Format error discovered in the file in sub-document content.xml at 2,0(row,col)\n</code></pre>\n\n<p><strong>Is there something I made wrong with my Haskell code ? Or is it a Pandoc bug ?</strong></p>\n\n<p><strong>Is there a trick to open the odt file nevertheless ?</strong></p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "edited": false, "score": 0, "creation_date": 1477426787, "post_id": 40248860, "comment_id": 67760346, "body": "oh my, I hate being a newbie - silly mistakes... Thanks! :) Also, once I put it out, I don&#39;t need a special <code>race_</code>"}, {"owner": {"reputation": 428, "user_id": 1520657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599f6ac58a187b4e89ad8cb576304166?s=128&d=identicon&r=PG", "display_name": "MichaelO", "link": "https://stackoverflow.com/users/1520657/michaelo"}, "reply_to_user": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "edited": false, "score": 1, "creation_date": 1477511941, "post_id": 40248860, "comment_id": 67802205, "body": "Don&#39;t worry, Haskell takes some time!"}], "tags": [], "owner": {"reputation": 428, "user_id": 1520657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599f6ac58a187b4e89ad8cb576304166?s=128&d=identicon&r=PG", "display_name": "MichaelO", "link": "https://stackoverflow.com/users/1520657/michaelo"}, "is_accepted": true, "score": 1, "last_activity_date": 1477426241, "creation_date": 1477426241, "answer_id": 40248860, "question_id": 40248470, "link": "https://stackoverflow.com/questions/40248470/need-to-run-monadhandler-but-return-stm/40248860#40248860", "title": "Need to Run MonadHandler but Return STM", "body": "<p>Maybe I am missing something (example code is not complete), but why not just put the <code>atomically</code> just on <code>writeTChan</code>, as this would be the intention for using STM (untested):</p>\n\n<pre><code>handlerRace_\n    (forever $ atomically (readTChan readChan) &gt;&gt;= sendTextData)\n    (sourceWS $$ mapM_C (\\msg -&gt; do\n        users &lt;- lift (runDB $ selectList [] [] :: Handler [Entity User]) -- query the DB\n        atomically $ writeTChan writeChan msg\n    ))\n</code></pre>\n"}], "owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 40248860, "answer_count": 1, "score": 0, "last_activity_date": 1477426241, "creation_date": 1477424806, "question_id": 40248470, "link": "https://stackoverflow.com/questions/40248470/need-to-run-monadhandler-but-return-stm", "title": "Need to Run MonadHandler but Return STM", "body": "<p>I'm trying to execute a DB query, inside a websocket request. It's an adaptation of <a href=\"https://github.com/yesodweb/yesod/blob/e2e546df4d062e182da79a20115d1334055ee1a9/yesod-websockets/chat.hs#L31-L34\" rel=\"nofollow\">this</a> example.</p>\n\n<p>To do so, I try to create a specialized <code>race_</code> - that will also have the <code>MonadHandler</code> which I'll use to query the DB. This results with the following non-working code:</p>\n\n<pre><code>    handlerRace_\n        (forever $ atomically (readTChan readChan) &gt;&gt;= sendTextData)\n        (sourceWS $$ mapM_C (\\msg -&gt; atomically $ do\n            users &lt;- lift (runDB $ selectList [] [] :: Handler [Entity User]) -- query the DB\n            writeTChan writeChan $ msg\n        ))\n\nhandlerRace_ ::  (MonadBaseControl IO m, MonadHandler m) =&gt; m a -&gt; m b -&gt; m ()\nhandlerRace_ = race_\n</code></pre>\n\n<p>and the error:</p>\n\n<pre><code>Couldn't match type \u2018t0 (HandlerT App IO)\u2019 with \u2018STM\u2019\nExpected type: STM [Entity User]\n  Actual type: t0 (HandlerT App IO) [Entity User]\nIn a stmt of a 'do' block:\n  users &lt;- lift (runDB $ selectList [] [] :: Handler [Entity User])\n</code></pre>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 2, "creation_date": 1477425244, "post_id": 40248392, "comment_id": 67759488, "body": "Can you clarify the problem you&#39;re trying to solve? Why not a linear search through the list, since it&#39;s already sorted?"}, {"owner": {"reputation": 10318, "user_id": 650425, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/917eb01650ad8da7e4d2187eedcfeb82?s=128&d=identicon&r=PG", "display_name": "maple_shaft", "link": "https://stackoverflow.com/users/650425/maple-shaft"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1477425881, "post_id": 40248392, "comment_id": 67759853, "body": "@crockeea I was wanting an algo that was better than O(n) and I arbitraily picked the problem because it seemed like an interesting recursive approach to do in FP"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1477426476, "post_id": 40248392, "comment_id": 67760177, "body": "Your implementation is still O(n) if you are computing the sum or length of lists like <code>[(head xs)..(last xs)]</code>."}, {"owner": {"reputation": 10318, "user_id": 650425, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/917eb01650ad8da7e4d2187eedcfeb82?s=128&d=identicon&r=PG", "display_name": "maple_shaft", "link": "https://stackoverflow.com/users/650425/maple-shaft"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477427579, "post_id": 40248392, "comment_id": 67760790, "body": "@chepner Really? The function head and last in Haskell is O(n)? I am not saying you are wrong, like I said I am pretty new to Haskell and just doing this as a learning exercise."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1477427856, "post_id": 40248392, "comment_id": 67760921, "body": "For some reason, you are creating a list of size <code>last xs - head xs + 1</code>, and then computing its length. Why not just use the formula? Of course calling <code>length lower</code> is still O(n)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477428063, "post_id": 40248392, "comment_id": 67761046, "body": "@maple_shaft <code>last</code> is O(n) (it has to walk all the way to the end of the list), but even it it wasn&#39;t, both <code>sum</code> and <code>length</code> are strict in their argument, so the list would need to be constructed in its entirety."}, {"owner": {"reputation": 10318, "user_id": 650425, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/917eb01650ad8da7e4d2187eedcfeb82?s=128&d=identicon&r=PG", "display_name": "maple_shaft", "link": "https://stackoverflow.com/users/650425/maple-shaft"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477428450, "post_id": 40248392, "comment_id": 67761261, "body": "@chepner regardless I can definitely optimize it later if I want to. That really wasnt my question."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1477430061, "post_id": 40248392, "comment_id": 67762189, "body": "Your recursion seems to assume that the largest value in <code>lower</code> will always be <code>pivotValue - 1</code> (and similarly for the smallest value in <code>upper</code>), which will cause you to omit missing numbers that are adjacent to <code>pivotValue</code>. However, there&#39;s little point in fixing this, because it&#39;s never going to be O(n) as long as <code>length</code> is not an O(1) operation."}, {"owner": {"reputation": 10318, "user_id": 650425, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/917eb01650ad8da7e4d2187eedcfeb82?s=128&d=identicon&r=PG", "display_name": "maple_shaft", "link": "https://stackoverflow.com/users/650425/maple-shaft"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477431481, "post_id": 40248392, "comment_id": 67762924, "body": "@chepner I am passing around these lists when it is probably better to pass indexes and look to the list for values. I  dont need to call length I suppose, I can figure that out with some arithmetic."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1477434913, "post_id": 40248392, "comment_id": 67764288, "body": "@maple_shaft the first thing you should do is understand what a list is (it&#39;s not an array, but a recursive algebraic data type), and then the time complexity of the prelude list functions will be obvious, without looking at the implementation. As for debugging, you might have fun playing with <a href=\"https://hackage.haskell.org/package/QuickCheck-2.9.2/docs/Test-QuickCheck.html\" rel=\"nofollow noreferrer\">quickcheck</a> as a debugging aid; once it gives you a minimal failing case, the next step is to step through the algorithm with a pen and paper or in your head until you see the bug."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1477436194, "post_id": 40248392, "comment_id": 67764673, "body": "@chepner I think that view is too narrow. Lists are a convenient syntax for prototyping an algorithm that can later be converted to e.g. arrays, where all the operations that need to be done in O(1) can be. So why not write up an answer with the details needed to fix this algorithm, since that&#39;s already an interesting problem in itself?"}], "owner": {"reputation": 10318, "user_id": 650425, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/917eb01650ad8da7e4d2187eedcfeb82?s=128&d=identicon&r=PG", "display_name": "maple_shaft", "link": "https://stackoverflow.com/users/650425/maple-shaft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1477424562, "creation_date": 1477424562, "question_id": 40248392, "link": "https://stackoverflow.com/questions/40248392/haskell-find-k-missing-numbers-from-a-sorted-list-1-n", "title": "Haskell: Find k missing numbers from a sorted list [1..n]", "body": "<p>I am learning Haskell and FP in general and decided this was an interesting problem to try and solve.  The algorithm I am attempting is to use a variation of quickselect to count the length of two sublists split on a pivot, and if the length difference is 1 then use the difference of sums approach to find the missing number.  If greater than 1 then I recursively drill into the sublist.</p>\n\n<p>I feel like I am pretty close to a working solution here but there are a few fringe cases that don't seem to work well.  Where n is smaller than 100, I sometimes I have certain missing numbers that are missed seemingly randomly and when n is sufficiently small compared to k missing numbers I sometimes get a runtime exception.  For large sets of n, this runs correctly seemingly.  I must be missing something simple.</p>\n\n<p>Any thoughts?  A simple guard that I missed?</p>\n\n<pre><code>findMissingNumber :: (Ord k, Integral k, Enum k) =&gt; [k] -&gt; [k]\nfindMissingNumber [] = []\nfindMissingNumber xs = ( sum' [(head xs)..(last xs)] - sum' xs ) : []\n\n\nfindMissingNumbs :: [Int] -&gt; [Int]\nfindMissingNumbs [] = []\nfindMissingNumbs xs =\n  let shouldBeLength = length [(head xs)..(last xs)]\n      pivot = round $ fromIntegral (shouldBeLength) / 2\n      pivotValue = xs !! (pivot - 1)\n      lower = filter (&lt; pivotValue) xs\n      upper = filter (&gt;= pivotValue) xs\n      lowerMissingCount \n        | lower == [] = 0\n        | (length lower) == 1 = 0\n        | otherwise = (length [(head lower)..(last lower)]) - (length lower)\n      upperMissingCount \n        | upper == [] = 0\n        | (length upper) == 1 = 0\n        | otherwise = (length [(head upper)..(last upper)]) - (length upper)\n      missingLowerValues \n        | (lowerMissingCount) == 1 = findMissingNumber (lower)\n        | (lowerMissingCount) &gt; 1 = findMissingNumbs (lower)\n        | (lowerMissingCount) == 0 = []\n        | otherwise = []\n      missingUpperValues\n        | (upperMissingCount) == 1 = findMissingNumber (upper)\n        | (upperMissingCount) &gt; 1 = findMissingNumbs (upper)\n        | (upperMissingCount) == 0 = []\n        | otherwise = []\n  in\n     missingLowerValues ++ [] ++ missingUpperValues\n\nsum' :: (Num k) =&gt; [k] -&gt; k\nsum' xs = foldl' (+) 0 xs\n\nmain = do\n  putStrLn \"Enter a list size: \"\n  listSize &lt;- readLn\n  intToRemove &lt;- sequence $ replicate 5 $ randomRIO (1, (listSize :: Int))\n  putStrLn $ \"Int to remove is: \" ++ show intToRemove\n  let defaultList = [1..(listSize :: Int)]\n  let missingNumbers = findMissingNumbs $ (filter (not . (`elem` intToRemove)) defaultList)\n  putStrLn $ \"The missing number is \" ++ show missingNumbers\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1477421538, "post_id": 40247517, "comment_id": 67757371, "body": "It means <code>m</code> is a type of <i>kind</i> <code>* -&gt; *</code>; that is, <code>m</code> is a <i>type constructor</i> that accepts a single argument, like <code>Maybe</code> or <code>Either String</code>."}, {"owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1477421663, "post_id": 40247517, "comment_id": 67757437, "body": "@AlexisKing, Thanks, you can post it as answer and I will accept it"}, {"owner": {"reputation": 27723, "user_id": 627005, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/016a165f7d0d5d24bb38331502b912ed?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Manta", "link": "https://stackoverflow.com/users/627005/paul-manta"}, "edited": false, "score": 1, "creation_date": 1477422188, "post_id": 40247517, "comment_id": 67757716, "body": "It is similar to how generics work in Java or C#, or to how templates work in C++. In Java for example the function&#39;s signature would be something like <code>M&lt;B&gt; runKleisli(A a)</code>. This isn&#39;t an exact analogy though, since the Haskell signature you provided is a lot more generic than the Java signature I gave."}], "answers": [{"comments": [{"owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "edited": false, "score": 0, "creation_date": 1477428355, "post_id": 40247637, "comment_id": 67761215, "body": "I just find out that I don&#39;t quite understand, I don&#39;t know monads for now, so can you answer, function <code>m</code> must <b>return</b> or <b>accept as argument</b> something with type <code>b</code>?"}, {"owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "edited": false, "score": 0, "creation_date": 1477428838, "post_id": 40247637, "comment_id": 67761502, "body": "Question in context of this function <code>(*&gt;) :: (a -&gt; m b) -&gt; (b -&gt; m c) -&gt; (a -&gt; m c)</code> from <a href=\"https://anton-k.github.io/ru-haskell-book/files/ru-haskell-book.pdf\" rel=\"nofollow noreferrer\">book of Anton Kholomiov page 86</a>)"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "edited": false, "score": 0, "creation_date": 1477428958, "post_id": 40247637, "comment_id": 67761565, "body": "@bjornmelgaard <code>m</code> is not (necessarily) a function; it is just a type constructor. In the example I gave in my answer, <code>Kleisli Maybe String Integer</code> is just a simple wrapper around <code>String -&gt; Maybe Integer</code>. Nothing more, nothing less. The <code>m</code> in that example is <code>Maybe</code>, which is obviously not a function."}, {"owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "edited": false, "score": 0, "creation_date": 1477429864, "post_id": 40247637, "comment_id": 67762082, "body": "Ok, <code>m b</code> means constructor and only constructor(?). Therefore in <code>class Category cat where \\ id :: cat a a \\ (&gt;&gt;) :: cat a b -&gt; cat b c -&gt; cat a c</code> cat is  a constructor and only constructor with 2 arg too?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "edited": false, "score": 0, "creation_date": 1477431138, "post_id": 40247637, "comment_id": 67762737, "body": "@bjornmelgaard Neither. When you write <code>Maybe Integer</code> is <code>Maybe</code> returning or accepting as argument something with type <code>Integer</code>? Answer: The question makes no sense because <code>Maybe</code> is not a function."}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 5, "last_activity_date": 1477421836, "last_edit_date": 1495541959, "creation_date": 1477421836, "answer_id": 40247637, "question_id": 40247517, "link": "https://stackoverflow.com/questions/40247517/what-mean-type-a-m-b-in-haskell/40247637#40247637", "title": "What mean type `a -&gt; m b` in Haskell?", "body": "<p>It means <code>m</code> is a type of <em>kind</em> <code>* -&gt; *</code>; that is, <code>m</code> is a <em>type constructor</em> that accepts a single argument, like <code>Maybe</code> or <code>Either String</code>. When you instantiate <code>Kleisli</code> and perform the substitution yourself, you can see how this works out.</p>\n\n<p>For example, consider something like <code>Kleisli Maybe String Integer</code>. The substituted type of <code>runKleisli</code> would be <code>String -&gt; Maybe Integer</code>, and you can see how the <code>m</code> is being used as a type constructor.</p>\n\n<p>For more information about kinds in Haskell, see <a href=\"https://stackoverflow.com/q/27095011/465378\">What exactly is the kind &quot;*&quot; in Haskell?</a>.</p>\n"}], "owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 40247637, "answer_count": 1, "score": 0, "last_activity_date": 1477421836, "creation_date": 1477421460, "question_id": 40247517, "link": "https://stackoverflow.com/questions/40247517/what-mean-type-a-m-b-in-haskell", "title": "What mean type `a -&gt; m b` in Haskell?", "body": "<p>Example - function <code>runKleisli</code> from Haskell base module</p>\n\n<pre><code>newtype Kleisli m a b = Kleisli { runKleisli :: a -&gt; m b }\n</code></pre>\n\n<p>That means <code>runKleisli</code> have 1 argument with type <code>a</code> and must return function <code>m</code>, which have 1 argument <code>b</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1477422960, "post_id": 40247417, "comment_id": 67758116, "body": "Have you considered learning Haskell?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477428272, "post_id": 40247417, "comment_id": 67761170, "body": "Do you not understand the algorithm, or the Haskell implementation of the algorithm?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1477439300, "post_id": 40247417, "comment_id": 67765421, "body": "The interesting part is why it performs the recursive call twice instead of calculating it once and using the result twice. That&#39;s actually very important. Can you figure out why?"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 3824601, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxJA0.jpg?s=128&g=1", "display_name": "priortd", "link": "https://stackoverflow.com/users/3824601/priortd"}, "is_accepted": false, "score": 1, "last_activity_date": 1477426867, "creation_date": 1477426867, "answer_id": 40249017, "question_id": 40247417, "link": "https://stackoverflow.com/questions/40247417/haskell-function-for-computing-sublist-of-a-list/40249017#40249017", "title": "Haskell function for computing sublist of a list", "body": "<pre><code>sublists :: [a] -&gt; [[a]]\nsublists [] = [[]]\nsublists (x:xs) = [x:sublist | sublist &lt;- sublists xs] ++ sublists xs\n\n--  ghci&gt; sublists [1,2,3] \n--  [[1,2,3],[1,2],[1,3],[1],[2,3],[2],[3],[]]\n\n--    (each sublist l1 in (sublists [2 , 3])\n--      \n--      (1 : l1)) \n--        concat (sublists [2, 3])\n--\n--       sublists [2, 3] = \n--         (each sublist l2 in (sublists [3])\n--           (2 : l2)) \n--             concat (sublists [3]) \n--\n--             sublists [3] = \n--                 (3 : []) concat [[]]\n--                 = [[3], []]\n--    \n--    now substituting back into the recursion\n--        [[2, 3], [2], [3], []]\n--    \n--    [[1, 2, 3], [1, 2], [1, 3], [1], [2, 3], [2], [3], []]  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7071343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f76f5dd5260fa90a3a1c1352660b775?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Miller", "link": "https://stackoverflow.com/users/7071343/ben-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1541, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1477426867, "creation_date": 1477421089, "last_edit_date": 1477421107, "question_id": 40247417, "link": "https://stackoverflow.com/questions/40247417/haskell-function-for-computing-sublist-of-a-list", "title": "Haskell function for computing sublist of a list", "body": "<p>Can someone explain to me what does this haskell code mean?</p>\n\n<pre><code>sublists [] = [[]]\nsublists (x:xs) = [x:sublist | sublist &lt;- sublists xs] ++ sublists xs\n</code></pre>\n\n<p>I know this function computes sublist of a given list. But , I want to know how it works.</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"comments": [{"owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "edited": false, "score": 0, "creation_date": 1477599827, "post_id": 40249921, "comment_id": 67845566, "body": "I contacted the maintainer who updated the package. Thanks!"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 1, "last_activity_date": 1477430481, "creation_date": 1477430481, "answer_id": 40249921, "question_id": 40247355, "link": "https://stackoverflow.com/questions/40247355/why-can-i-not-install-haskell-slides-package/40249921#40249921", "title": "Why can I not install haskell Slides package?", "body": "<p>Slides library 0.1.0.8 (<a href=\"https://hackage.haskell.org/package/Slides\" rel=\"nofollow\">https://hackage.haskell.org/package/Slides</a>) has not been updated to work with GHC versions > 7.10.  This is apparent from the base restriction <code>base &lt; 4.9</code> since GHC 8 uses base 4.9.</p>\n\n<p>You can:</p>\n\n<ul>\n<li>File an issue with the maintainer, who should fix this and upload a new version.</li>\n<li><code>cabal unpack slides</code> then <code>cd slides*</code> and edit <code>slides.cabal</code> changing <code>&lt; 4.9</code> to <code>&lt; 4.10</code> then <code>cabal install</code>.  That is usually all that is required, but not always so you might see a new set of compilation errors.</li>\n</ul>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 40249921, "answer_count": 1, "score": 0, "last_activity_date": 1477430481, "creation_date": 1477420841, "question_id": 40247355, "link": "https://stackoverflow.com/questions/40247355/why-can-i-not-install-haskell-slides-package", "title": "Why can I not install haskell Slides package?", "body": "<p>Attempting to install Haskell's <a href=\"https://hackage.haskell.org/package/Slides\" rel=\"nofollow\">Slides</a> package, I run into cabal hell:</p>\n\n<pre><code>$ cabal update &amp;&amp; cabal install slides\nDownloading the latest package list from hackage.haskell.org\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: Slides-0.1.0.8 (user goal)\nnext goal: base (dependency of Slides-0.1.0.8)\nrejecting: base-4.9.0.0/installed-4.9... (conflict: Slides =&gt; base&gt;=4.8 &amp;&amp;\n&lt;4.9)\nrejecting: base-4.9.0.0, base-4.8.2.0, base-4.8.1.0, base-4.8.0.0,\nbase-4.7.0.2, base-4.7.0.1, base-4.7.0.0, base-4.6.0.1, base-4.6.0.0,\nbase-4.5.1.0, base-4.5.0.0, base-4.4.1.0, base-4.4.0.0, base-4.3.1.0,\nbase-4.3.0.0, base-4.2.0.2, base-4.2.0.1, base-4.2.0.0, base-4.1.0.0,\nbase-4.0.0.0, base-3.0.3.2, base-3.0.3.1 (constraint from non-upgradeable\npackage requires installed instance)\nDependency tree exhaustively searched.\n</code></pre>\n\n<p>I reset my packages by running:</p>\n\n<pre><code>$ rm -rf ~/.ghc ~/.cabal\n</code></pre>\n\n<p>per the instructions <a href=\"https://www.schoolofhaskell.com/user/simonmichael/how-to-cabal-install#could-not-resolve-dependencies--cabal-hell\" rel=\"nofollow\">here</a>, but still get that same error. Not sure what to try next.</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 2, "creation_date": 1477420834, "post_id": 40247339, "comment_id": 67756953, "body": "If it&#39;s Haskell, why are you tagging C++?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1477427251, "post_id": 40247339, "comment_id": 67760619, "body": "<a href=\"http://homepages.dcc.ufmg.br/~camarao/sblp2003.pdf\" rel=\"nofollow noreferrer\">Practical Type Inference for Polymorphic Recursion: an Implementation in Haskell</a> provides some good examples."}], "answers": [{"comments": [{"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1477422889, "post_id": 40247757, "comment_id": 67758081, "body": "Thanks! Could you explain the &#39;Nested&#39; example in a bit more simple terms? I&#39;ve looked over the Wiki article and still a little lost, what does &#39;:&lt;:&#39; do for example?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 2, "creation_date": 1477423633, "post_id": 40247757, "comment_id": 67758516, "body": "It&#39;s just an infix data constructor (which is like an infix operator, but must begin with <code>:</code>). You could write the same definition as <code>data Nested a = NestedCons a (Nested [a]) | Epsilon</code>, replacing the infix constructor <code>:&lt;:</code> with a &quot;regular&quot; data constructor named <code>NestedCons</code>."}, {"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1477424874, "post_id": 40247757, "comment_id": 67759259, "body": "Could you give a brief example of their use? :P"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 1, "creation_date": 1477438170, "post_id": 40247757, "comment_id": 67765147, "body": "@BabraCunningham It works just like <code>(:)</code> for lists. For instance, <code>[&#39;b&#39;, &#39;c&#39;]</code> is syntax sugar for <code>&#39;b&#39; : &#39;c&#39; : []</code>, a <code>[Char]</code> built using the constructors <code>(:)</code> and <code>[]</code>. Analogously, <code>&#39;a&#39; :&lt;: [&#39;b&#39;, &#39;c&#39;] :&lt;: Epsilon</code> is a <code>Nested Char</code> built with the constructors <code>(:&lt;:)</code> and <code>Epsilon</code>."}, {"owner": {"reputation": 280, "user_id": 5560529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEQgB.jpg?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5560529/peter"}, "edited": false, "score": 0, "creation_date": 1489652441, "post_id": 40247757, "comment_id": 72767303, "body": "As I see it, your solution is exactly the same as the straightforward length function. I don&#39;t see how you &quot;solved&quot; the problem."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 280, "user_id": 5560529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEQgB.jpg?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5560529/peter"}, "edited": false, "score": 1, "creation_date": 1489664053, "post_id": 40247757, "comment_id": 72775190, "body": "@Peter The solution is the explicit type annotation. With <code>:</code>, <code>(x:xs)</code> and <code>xs</code> have the same type. The same is not true with <code>(x :&lt;: xs)</code> and <code>xs</code>; <code>(x :&lt;: xs)</code> has type <code>Nested a</code>, while <code>xs</code> has type <code>Nested [a]</code>."}, {"owner": {"reputation": 1347, "user_id": 818164, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2b4e1be66cb26f89a88dc243be7305fe?s=128&d=identicon&r=PG", "display_name": "bellpeace", "link": "https://stackoverflow.com/users/818164/bellpeace"}, "edited": false, "score": 0, "creation_date": 1490274338, "post_id": 40247757, "comment_id": 73045734, "body": "@chepner To make this answer more precise, I would put &quot;...meaning the compiler cannot <i>always</i> infer the type...&quot; Undecidability means that the we cannot solve a problem for every single instance, but we might come up with a solution that can spit out a correct answer in some cases."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1477422253, "creation_date": 1477422253, "answer_id": 40247757, "question_id": 40247339, "link": "https://stackoverflow.com/questions/40247339/polymorphic-recursion-syntax-and-uses/40247757#40247757", "title": "Polymorphic recursion - syntax and uses?", "body": "<p>Type inference for polymorphic recursion is undecidable, meaning the compiler cannot <em>infer</em> the type of such a function even when it is well-typed.</p>\n\n<p>For example, an ordinary list applies <code>List</code> to the same (polymorphic) type on both sides:</p>\n\n<pre><code>data List a = Cons a (List a)\n</code></pre>\n\n<p>while this type taken from the <a href=\"https://en.wikipedia.org/wiki/Polymorphic_recursion\">Wikipedia article</a> applies <code>Nested</code> to two different (polymorphic) types, <code>a</code> and <code>[a]</code>:</p>\n\n<pre><code>data Nested a = a :&lt;: (Nested [a]) | Epsilon\n</code></pre>\n\n<p>From the same article, the compiler will fail to infer the type of a relatively straightforward <code>length</code> function</p>\n\n<pre><code>length Epsilon = 0\nlength (a :&lt;: xs) = 1 + length xs\n</code></pre>\n\n<p>because <code>length</code> is applied to values of two different types in the second equation, <code>Nested a</code> and <code>Nested [a]</code>.</p>\n\n<p>The solution is to assert that the type is indeed <code>Nested a -&gt; Int</code>.</p>\n\n<pre><code>length :: Nested a -&gt; Int\nlength Epsilon = 0\nlength (a :&lt;: xs) = 1 + length xs\n</code></pre>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1391, "favorite_count": 1, "accepted_answer_id": 40247757, "answer_count": 1, "score": 4, "last_activity_date": 1477422253, "creation_date": 1477420792, "last_edit_date": 1477420839, "question_id": 40247339, "link": "https://stackoverflow.com/questions/40247339/polymorphic-recursion-syntax-and-uses", "title": "Polymorphic recursion - syntax and uses?", "body": "<p>I've spent significant time looking over learnyouahaskell and I haven't found a good explanation of polymorphic recursion!</p>\n\n<p>I understand basic recursive structures:</p>\n\n<pre><code>myFunction :: [Int] -&gt; [Int]\nmyFunction [] = []\nmyFunction (x : xs) = (\\x -&gt; x + 1) x : myFunction xs\n</code></pre>\n\n<p>What would polymorphic recursion look like? And what are its benefits/uses?</p>\n"}, {"tags": ["haskell", "typeclass", "monad-transformers"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1477411644, "post_id": 40244354, "comment_id": 67751620, "body": "My gut feeling is that the backend specfific constraints should somehow show up in the <i>instances</i> of your custom class (so that you would have one instance per backend). I haven&#39;t thought about it for more than a few seconds though, and so I might be talking nonsense."}, {"owner": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477412299, "post_id": 40244354, "comment_id": 67752064, "body": "I&#39;m fine with whatever, so long as it is simple.  My end goal is to be able to add <code>resourceT</code> and <code>StateT DBState</code> layers to the concrete type in whatever app I&#39;m writing and if I happen to decide to query any database, it will connect and return results and clean up and I don&#39;t have to care."}], "answers": [{"tags": [], "owner": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "is_accepted": false, "score": 0, "last_activity_date": 1477418505, "creation_date": 1477418505, "answer_id": 40246676, "question_id": 40244354, "link": "https://stackoverflow.com/questions/40244354/preventing-typeclass-constraints-from-propagating-upwards-through-a-transformer/40246676#40246676", "title": "Preventing Typeclass constraints from propagating upwards through a transformer stack", "body": "<p>After working on this for a bit, I found the solution I was looking for.</p>\n\n<pre><code>data DBAction a =\n    forall p r. (QueryParams p, QueryResults r) =&gt; AAction Query p ([r] -&gt; a)\n  | forall p r. (QueryParams p, QueryResults r) =&gt; BAction DBName Query p ([r] -&gt; a)\n  -- forall p r. (FromRow r, ToRow r) =&gt; .... etc.\n\ndata AQuery a = forall r p. (QueryParams p, QueryResults r) =&gt; AQuery Query p ([r] -&gt; a)\ndata BQuery a = forall r p. (QueryParams p, QueryResults r) =&gt; BQuery Query p ([r] -&gt; a)\n</code></pre>\n\n<p>Then changing my queries so that they give concrete types to remove ambiguity when the time comes to query.</p>\n\n<pre><code>friends :: UID -&gt; BQuery Int\nfriends uid = BQuery \"select count(*) from friends where uid = ?\" (undefined uid :: (Only Int)) toCount\n  where\n    toCount ((Only i):_) = i\n    toCount _ = 0\n</code></pre>\n"}], "owner": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477418505, "creation_date": 1477410499, "question_id": 40244354, "link": "https://stackoverflow.com/questions/40244354/preventing-typeclass-constraints-from-propagating-upwards-through-a-transformer", "title": "Preventing Typeclass constraints from propagating upwards through a transformer stack", "body": "<p>I have a lot of databases (and other sources of data) that I use at work, each one is slightly different, maybe a different backend, or requires slightly different information be provided at runtime, so whenever I write a program in haskell I have to juggle a lot of logic, withDB this and ConnectInfo that, pass around this handle here or there and it ends up swamping the logic of my programs, which are generally very simple.</p>\n\n<p>So I decided to write a little library to just do all the heavy lifting for me.</p>\n\n<p>I feel like I am approaching my goals, but I'm not quite there.  In this I have two pretend databases, <code>A</code> and <code>B</code>, one just requires a query, but the other one requires that I specify the name of the database I want to query.</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-6.22  runghc --package mtl --package mysql-simple\n\n{-# LANGUAGE ExistentialQuantification, LambdaCase, FlexibleInstances, FlexibleContexts, UndecidableInstances, OverloadedStrings #-}\n{-# OPTIONS_GHC -Wall #-}\nmodule West.Databases.Types where\n\nimport Control.Monad.Trans.Resource\nimport Control.Monad.Trans\nimport Control.Monad.State.Strict\n\nimport Database.MySQL.Simple as MS\nimport Database.MySQL.Simple.QueryParams as MS\nimport Database.MySQL.Simple.QueryResults as MS\n\nnewtype DBName = DBName String deriving Eq\n\ndata DBState = DBState {\n    aDBConn :: Maybe Connection\n  , bDBConn :: Maybe (Connection, DBName)\n}\n\nclass MonadResource m =&gt; MonadDB m where\n  liftDB :: DBAction a -&gt; m a\n\nrunB :: DBName -&gt; BQuery a -&gt; DBAction a\nrunB dbname (BQuery q p f) = BAction dbname q p f\n\nrunA :: AQuery a -&gt; DBAction a\nrunA (AQuery q p f) = AAction q p f\n\ninstance (MonadState DBState m, MonadResource m, MonadIO m) =&gt; MonadDB m where\n  liftDB (AAction q p f) = f &lt;$&gt; do\n    (aDBConn &lt;$&gt; get) &gt;&gt;= \\case\n      Nothing -&gt; do\n        newconn &lt;- snd &lt;$&gt; allocate (MS.connect (undefined :: ConnectInfo)) MS.close\n        modify (\\dbs -&gt; dbs { aDBConn = Just newconn })\n        liftIO (MS.query newconn q p)\n      Just aconn -&gt; liftIO (MS.query aconn q p)\n  liftDB (BAction newdbname q p f) = f &lt;$&gt; do\n    (bDBConn &lt;$&gt; get) &gt;&gt;= \\case\n      Nothing -&gt; undefined\n      Just (bconn, dbname) -&gt; if dbname == newdbname\n        then liftIO (MS.query bconn q p)\n        else do\n          -- MS.query \"use newdbname\"\n          liftIO (MS.query bconn q p)\n\ndata DBAction a =\n    forall r p. AAction Query p ([r] -&gt; a)\n  | forall r p. BAction DBName Query p ([r] -&gt; a)\n\ninstance Functor DBAction where\n  fmap f (AAction q p fr) = AAction  q p (f . fr)\n  fmap f (BAction dbname q p fr) = BAction dbname q p (f . fr)\n\n-- TODO\ninstance Applicative DBAction\ninstance Monad DBAction\n\ndata BQuery a = forall r p. BQuery Query p ([r] -&gt; a)\ndata AQuery a = forall r p. AQuery Query p ([r] -&gt; a)\n</code></pre>\n\n<p>This allows me to write code like this</p>\n\n<pre><code>data UID\ndata Password\n\nme :: AQuery (UID, DBName)\nme = AQuery \"select uid,customerdb from users where user_name rlike 'me@blah.com'\" () undefined\n\nfriends :: UID -&gt; BQuery Int\nfriends uid = BQuery \"select count(*) from friends where uid = ?\" uid undefined\n\nuserCount :: AQuery Int\nuserCount = AQuery \"select count(*) from users\" () toCount\n  where\n    toCount ((Only i):_) = i\n    toCount _ = error \"userCount should not occur\"\n\nuserAuth :: UID -&gt; Password -&gt; AQuery Bool\nuserAuth uid pass = AQuery \"select count(*) from users where uid = ? and password = ?\" (uid, pass)\n  (\\c -&gt; head c &gt; (0 :: Int))\n</code></pre>\n\n<p>and also compose actions of different databases into procedures that I can run liftDB on.  This finds a user on a primary database, then queries said database for more in depth info about that user.</p>\n\n<pre><code>myFriends :: DBAction Int\nmyFriends = do\n  (uid, dbname) &lt;- runA me\n  runB dbname (friends uid)\n</code></pre>\n\n<p>The problem is that the <code>msyql/postgresql-simple</code> libraries both have very similar <code>query</code> functions with the following types</p>\n\n<pre><code>query :: (ToRow q, FromRow r) =&gt; Connection -&gt; Query -&gt; q -&gt; IO [r]\nquery :: (QueryParams q, QueryResults r) =&gt; Connection -&gt; Query -&gt; q -&gt; IO [r]\n</code></pre>\n\n<p>which causes the <code>ToRow/QueryParams/FromRow/QueryResults</code> to propagate up into the <code>MonadDB</code> class, which probably shouldn't happen, but I can't figure out how to prevent it.  I feel like <code>DBAction</code> should somehow contain the logic necessary to run the query and update some state...</p>\n"}, {"tags": ["python", "haskell"], "comments": [{"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1477410498, "post_id": 40244055, "comment_id": 67750855, "body": "Looks like you&#39;re not familiar with handling lists. Google. Then, if neccesary, ask a real question."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1477410596, "post_id": 40244055, "comment_id": 67750925, "body": "Look up the function <code>maximum</code> and see if you can do the same thing using a Haskell list comprehension: <code>[(f x, x) | x &lt;- values]</code>.  How would you handle returning the Haskell equivalent of <code>None</code> if the <code>values</code> list is empty?  What would be the full type of your <code>argmax</code> function in Haskell?"}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 1, "creation_date": 1477410927, "post_id": 40244055, "comment_id": 67751154, "body": "The equivalent of python&#39;s <code>None</code> would be using a <code>Maybe</code>m yet how do I sort tuples according to their first parameter ?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477411006, "post_id": 40244055, "comment_id": 67751207, "body": "The <code>maximumBy</code> solution in <a href=\"http://stackoverflow.com/q/40209169/2751851\">this question</a> generalises to lists of arbitrary size. There is also an <code>argmax</code> provided by a library mentioned there."}, {"owner": {"reputation": 49388, "user_id": 6779307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7O3q.jpg?s=128&g=1", "display_name": "Patrick Haugh", "link": "https://stackoverflow.com/users/6779307/patrick-haugh"}, "edited": false, "score": 0, "creation_date": 1477411010, "post_id": 40244055, "comment_id": 67751211, "body": "Hint: use <code>map</code>"}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "reply_to_user": {"reputation": 49388, "user_id": 6779307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7O3q.jpg?s=128&g=1", "display_name": "Patrick Haugh", "link": "https://stackoverflow.com/users/6779307/patrick-haugh"}, "edited": false, "score": 0, "creation_date": 1477412016, "post_id": 40244055, "comment_id": 67751880, "body": "@PatrickHaugh, I fail to get that hint"}], "answers": [{"comments": [{"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1477411181, "post_id": 40244521, "comment_id": 67751327, "body": "can <code>[(fst arg, f $ snd arg) | arg &lt;- zip l l]</code> be replaced with <code>[(x, f x) | x &lt;- l]</code> for brevity ?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1477411193, "post_id": 40244521, "comment_id": 67751337, "body": "<code>maximumBy (comparing f) l</code> is equivalent to your <code>otherwise</code> case."}, {"owner": {"reputation": 641, "user_id": 2711654, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cntf6.jpg?s=128&g=1", "display_name": "Spidey", "link": "https://stackoverflow.com/users/2711654/spidey"}, "reply_to_user": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1477411754, "post_id": 40244521, "comment_id": 67751696, "body": "@UriGoren I think your suggestion would work as well but duplode&#39;s suggestion is cleaner."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1477416374, "post_id": 40244521, "comment_id": 67754417, "body": "You can lose the first clause, too. <code>maximumBy</code> errors if the list is empty."}, {"owner": {"reputation": 641, "user_id": 2711654, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cntf6.jpg?s=128&g=1", "display_name": "Spidey", "link": "https://stackoverflow.com/users/2711654/spidey"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1477421007, "post_id": 40244521, "comment_id": 67757052, "body": "@BenjaminHodgson I agree. One of the comments in the question asked &quot;how would you handle the situation if the list is empty..&quot; so I added it for no particular reason."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477429067, "post_id": 40244521, "comment_id": 67761634, "body": "Three other ways of handling that situation: returning a <code>Maybe</code>-value, taking the first value to be compared as a separate argument, using <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List-NonEmpty.html\" rel=\"nofollow noreferrer\"><code>NonEmpty</code></a> instead of a plain old list."}], "tags": [], "owner": {"reputation": 641, "user_id": 2711654, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cntf6.jpg?s=128&g=1", "display_name": "Spidey", "link": "https://stackoverflow.com/users/2711654/spidey"}, "is_accepted": true, "score": 2, "last_activity_date": 1477411376, "last_edit_date": 1477411376, "creation_date": 1477410981, "answer_id": 40244521, "question_id": 40244055, "link": "https://stackoverflow.com/questions/40244055/implementing-argmax-in-haskell/40244521#40244521", "title": "Implementing argmax in Haskell", "body": "<p>Disclaimer -- I've been learning Haskell (functional paradigm in general) for a week now so it's likely there are better solutions.</p>\n\n<pre><code>import Data.Ord\nimport Data.List\n\nargmax f l \n    | null l = error \"Given list is empty\"\n    | otherwise = maximumBy (comparing f) l\n</code></pre>\n"}], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 842, "favorite_count": 0, "accepted_answer_id": 40244521, "answer_count": 1, "score": 0, "last_activity_date": 1477411376, "creation_date": 1477409607, "last_edit_date": 1477410056, "question_id": 40244055, "link": "https://stackoverflow.com/questions/40244055/implementing-argmax-in-haskell", "title": "Implementing argmax in Haskell", "body": "<p>Given a list <code>L</code> , and a function <code>f</code>, I want to return an item <code>x</code> from <code>L</code> that maximizes the value of <code>f(x)</code></p>\n\n<p>I cam up with this code for 2 variables:</p>\n\n<pre><code>argmax f x y = if (f x) &gt; (f y) then x else y\n</code></pre>\n\n<p>How can this be generalized to</p>\n\n<pre><code>argmax f [x,y,z]\n</code></pre>\n\n<p>(With an arbitrary number of items in the list)</p>\n\n<p>This is what I would do in <code>Python</code>:</p>\n\n<pre><code>argmax = lambda f,L: max([(f(x),x) for x in L])[1] if len(L)&gt;0 else None\n</code></pre>\n\n<p>How can I apply the same logic in <code>Haskell</code> ?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 10, "last_activity_date": 1477412250, "last_edit_date": 1477412250, "creation_date": 1477409703, "answer_id": 40244088, "question_id": 40244010, "link": "https://stackoverflow.com/questions/40244010/meaning-of-the-colon-with-ampersand-in-haskell/40244088#40244088", "title": "Meaning of the colon with ampersand in Haskell (:&amp;)", "body": "<p>That <em>is</em> the definition. The <code>Stream</code> type defines a single infix data constructor called <code>:&amp;</code>. Compare to</p>\n\n<pre><code>data Stream a = StreamCons a (Stream a)\n</code></pre>\n\n<p>which would define the same type, but creates <code>StreamCons</code> instead of <code>:&amp;</code> as the data constructor.</p>\n\n<p>Infix data constructors, unlike regular infix operators, <em>must</em> begin with a colon.</p>\n\n<hr>\n\n<p>With the <code>StreamCons</code> constructor, your <code>constStream</code> function would look like</p>\n\n<pre><code>constStream :: a -&gt; Stream a\n-- constStream x = x :&amp; (constStream x)\nconstStream x = StreamCons x (constStream x)\n</code></pre>\n\n<p>The same function to return an infinite <em>list</em> would look like</p>\n\n<pre><code>constList :: a -&gt; [a]\nconstList x = x : (constList x)\n</code></pre>\n\n<p><code>:&amp;</code> serves the same purpose as <code>:</code>, but for a <code>Stream a</code> instead of a <code>[a]</code>. In fact, the only difference between <code>Stream</code> and <code>[]</code> is that <code>Stream a</code> only contains values representing <em>infinite</em> sequences of <code>a</code>s, while <code>[a]</code> also contains finite lists.</p>\n"}], "owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "accepted_answer_id": 40244088, "answer_count": 1, "score": 3, "last_activity_date": 1477412250, "creation_date": 1477409496, "question_id": 40244010, "link": "https://stackoverflow.com/questions/40244010/meaning-of-the-colon-with-ampersand-in-haskell", "title": "Meaning of the colon with ampersand in Haskell (:&amp;)", "body": "<p>Implementation of Stream from <a href=\"https://anton-k.github.io/ru-haskell-book/files/ru-haskell-book.pdf\" rel=\"nofollow\">Haskell book (author Anton Kholomiov)</a> (page 70)</p>\n\n<pre><code>data Stream a = a :&amp; Stream a\n</code></pre>\n\n<p>I understand what meant to do <code>:&amp;</code>, but can't find it`s defenition</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "is_accepted": true, "score": 18, "last_activity_date": 1477491292, "last_edit_date": 1477491292, "creation_date": 1477390660, "answer_id": 40237310, "question_id": 40237270, "link": "https://stackoverflow.com/questions/40237270/how-do-you-hide-an-operator-when-importing/40237310#40237310", "title": "How do you hide an operator when importing?", "body": "<p>Recall how you query <code>ghci</code> for type of a function:</p>\n\n<pre><code>:t read\n:t show\n</code></pre>\n\n<p>About operator:</p>\n\n<p>Do you type <code>:t +</code>?</p>\n\n<p>No, you would receive a parse error then.</p>\n\n<p>You do <code>:t (+)</code>.</p>\n\n<p>As for your case, you hide it with additional brackets: <code>((*))</code></p>\n\n<pre><code>import Prelude hiding ((*))\n\n(*) :: Int -&gt; Int -&gt; Int\nx * 0 = 0\nx * y = x + x*(y-1)\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 7068848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae921ac103b887e9d9d43562d863baa?s=128&d=identicon&r=PG&f=1", "display_name": "J.Kujvji", "link": "https://stackoverflow.com/users/7068848/j-kujvji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 1, "accepted_answer_id": 40237310, "answer_count": 1, "score": 8, "last_activity_date": 1477491292, "creation_date": 1477390567, "last_edit_date": 1592644375, "question_id": 40237270, "link": "https://stackoverflow.com/questions/40237270/how-do-you-hide-an-operator-when-importing", "title": "How do you hide an operator when importing?", "body": "<p>Here's my code, trying to redefine <code>*</code>. It could be achieved only when <code>*</code> previously hided:</p>\n<pre><code>import Prelude hiding (*)\n\n(*) :: Int -&gt; Int -&gt; Int\nx * 0 = 0\nx * y = x + x*(y-1)\n</code></pre>\n<p>But it doesn't work:</p>\n<pre><code>$ ghci test.hs\n</code></pre>\n<blockquote>\n<p>GHCi, version 8.0.1: <a href=\"http://www.haskell.org/ghc/\" rel=\"noreferrer\">http://www.haskell.org/ghc/</a>  :? for help</p>\n<p>test.hs:1:24: error: parse error on input \u2018*\u2019</p>\n<p>Failed, modules loaded: none.</p>\n<p>Prelude&gt;</p>\n</blockquote>\n<p>I could hide other function as:</p>\n<pre><code>import Prelude hiding (read)\n\nimport Prelude hiding (show)\n</code></pre>\n<p>while it doesn't work for operator like <code>*</code>, <code>+</code>, <code>-</code>.</p>\n<p>How do I hide them?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1825, "user_id": 2671214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v464b.jpg?s=128&g=1", "display_name": "Tomasz Lewowski", "link": "https://stackoverflow.com/users/2671214/tomasz-lewowski"}, "edited": false, "score": 0, "creation_date": 1477386334, "post_id": 40235697, "comment_id": 67733730, "body": "have you tried to run <code>stack ghci</code> as root ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1477386348, "post_id": 40235697, "comment_id": 67733744, "body": "Using sudo should work. The code above is wrong since <code>&gt;</code> is not an executable name, that&#39;s shell syntax."}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "reply_to_user": {"reputation": 1825, "user_id": 2671214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v464b.jpg?s=128&g=1", "display_name": "Tomasz Lewowski", "link": "https://stackoverflow.com/users/2671214/tomasz-lewowski"}, "edited": false, "score": 0, "creation_date": 1477386361, "post_id": 40235697, "comment_id": 67733754, "body": "@TomaszLewowski: Yes, but it didn&#39;t seem to work."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1477386639, "post_id": 40235697, "comment_id": 67733942, "body": "<code>sudo &#47;opt&#47;ghc&#47;7.10.3&#47;bin&#47;ghc -e &#39;System.Process.readProcessWithExitCode &quot;&#47;usr&#47;bin&#47;env&quot; [] &quot;&quot; &gt;&gt;= \\(_, out, _) -&gt; putStrLn out&#39;</code> works fine and shows that <code>env</code> has been invoked as <code>root</code>. How did you actually check this code? Could you add all steps?"}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1477386780, "post_id": 40235697, "comment_id": 67734028, "body": "Changing the command to <code>truncate -s 0 filename</code> seems to have done the trick."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1477387404, "post_id": 40236041, "comment_id": 67734418, "body": "&quot;understoof&quot;? Either way, while <code>tee</code> provides the functionality, <code>truncate --size 0</code> or even <code>cp &#47;dev&#47;null</code> might seem feasible. But that being said, I don&#39;t see any reason not to use <code>writeFile path &quot;&quot;</code> instead and propagate <code>sudo</code> &quot;one level up&quot;. But that&#39;s just my 2&#162;."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1477388619, "last_edit_date": 1477388619, "creation_date": 1477387071, "answer_id": 40236041, "question_id": 40235697, "link": "https://stackoverflow.com/questions/40235697/how-to-execute-commands-from-haskell-as-root/40236041#40236041", "title": "How to execute commands from Haskell as root?", "body": "<p>As already pointed out in the comments, you can just run the entire stack/ghc under root, but I daresay that's a bad idea. Preferrably, I'd just invoke <code>sudo</code> as a process from within your program. The particular command \u2013 <em>emptying</em> a file, if I have understood that correctly? \u2013 is then easiest done with <a href=\"https://en.wikipedia.org/wiki/Tee_(command)\" rel=\"nofollow\"><code>tee</code></a>:</p>\n\n<pre><code>  do let cmd' = \"sudo\" \n         args' = [\"tee\", \"/path/to/file/\" ++ basename :: String]\n     (exitcode', stdout', stderr') &lt;- readProcessWithExitCode cmd' args' \"\"\n</code></pre>\n\n<p>As Zeta remarks, <code>truncate --size 0</code> would probably be a cleaner command.</p>\n\n<p>To get around password entering, you probably also want to make an exception in the <a href=\"https://www.digitalocean.com/community/tutorials/how-to-edit-the-sudoers-file-on-ubuntu-and-centos#what-is-visudo\" rel=\"nofollow\"><code>sudoers</code> file</a>. It's a hairy matter; of course the really best thing would be if you could avoid needing root permissions altogether.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 40236041, "answer_count": 1, "score": 0, "last_activity_date": 1477388619, "creation_date": 1477386094, "question_id": 40235697, "link": "https://stackoverflow.com/questions/40235697/how-to-execute-commands-from-haskell-as-root", "title": "How to execute commands from Haskell as root?", "body": "<p>Consider the following Haskell function:</p>\n\n<pre><code>eraseFile :: FilePath -&gt; IO ()\neraseFile basename = \n  do let cmd' = \"&gt;\" \n         args' = (\"/path/to/file/\" ++ basename) :: String\n     (exitcode', stdout', stderr') &lt;- readProcessWithExitCode cmd' [args'] \"\"\n     return ()\n</code></pre>\n\n<p>When I try to run this in a <code>stack ghci</code> repl, or from the main function, I get a <code>permission denied</code> error from the console. Normally, in a bash console, you could just run this command as <code>sudo</code>, but this doesn't seem to work when invoked from Haskell.</p>\n\n<p><strong>Question:</strong> How to execute system commands in Haskell as root?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1477384951, "post_id": 40234447, "comment_id": 67732803, "body": "Avoid <code>if x then True else False</code>, it redundant. Just use <code>x</code>. Also turn on warnings with <code>-Wall</code> to catch these errors early."}], "answers": [{"tags": [], "owner": {"reputation": 12359, "user_id": 1173513, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d690004dc97e147f64c8ce8408adeba9?s=128&d=identicon&r=PG", "display_name": "tomahh", "link": "https://stackoverflow.com/users/1173513/tomahh"}, "is_accepted": true, "score": 4, "last_activity_date": 1477382735, "creation_date": 1477382735, "answer_id": 40234578, "question_id": 40234447, "link": "https://stackoverflow.com/questions/40234447/non-exhaustive-functions-in-haskell/40234578#40234578", "title": "Non-exhaustive functions in Haskell", "body": "<p><code>[s]</code> matches a list with only one element, <code>s</code>.</p>\n\n<p>If you want to match any list, use a simple identifier, <code>l</code> for example:</p>\n\n<pre><code>recognize [] x [s] = False\nrecognize gr x l = if elem True (map (\\state -&gt; elem state (takeSteps gr x l))(enders gr)) then True else False\n                                               -- note the usage of l here ^\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7068344, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gUhG33-KUBU/AAAAAAAAAAI/AAAAAAAAABQ/_jp8_jxCCQM/photo.jpg?sz=128", "display_name": "Nora", "link": "https://stackoverflow.com/users/7068344/nora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 40234578, "answer_count": 1, "score": -2, "last_activity_date": 1477382735, "creation_date": 1477382359, "last_edit_date": 1477382598, "question_id": 40234447, "link": "https://stackoverflow.com/questions/40234447/non-exhaustive-functions-in-haskell", "title": "Non-exhaustive functions in Haskell", "body": "<p>I wrote a function in Haskell: </p>\n\n<pre><code>recognize :: [GrammarRule] -&gt; State -&gt; [String] -&gt; Bool\nrecognize [] x [s] = False\nrecognize gr x [s] = if elem True (map (\\state -&gt; elem state (takeSteps gr x [s]))(enders gr)) then True else False\n</code></pre>\n\n<p>this is non-exhaustive. What's the problem with the recognize function?\nThanks a lot!!</p>\n\n<pre><code>--the function takesteps is here: \ntakeSteps :: [GrammarRule] -&gt; State -&gt; [String] -&gt; [State]\ntakeSteps g s []     = [s]\ntakeSteps g s (w:ws) = concatMap (\\nextState -&gt; takeSteps g nextState ws) (successors g s w)\n\n--the function enders is here:\nenders :: [GrammarRule] -&gt; [State]\nenders [] = []\nenders (r:rs) =\n    let resultFromRest = enders rs in\n    case r of\n    End x -&gt; x : resultFromRest\n    Step x w' y -&gt; resultFromRest\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 12359, "user_id": 1173513, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d690004dc97e147f64c8ce8408adeba9?s=128&d=identicon&r=PG", "display_name": "tomahh", "link": "https://stackoverflow.com/users/1173513/tomahh"}, "is_accepted": false, "score": 1, "last_activity_date": 1477381005, "creation_date": 1477381005, "answer_id": 40234025, "question_id": 40232116, "link": "https://stackoverflow.com/questions/40232116/haskell-in-append-few-list-together/40234025#40234025", "title": "Haskell in append few list together", "body": "<p>In GHCI, you can use <code>:t somefunction</code> to get the type of <code>somefunction</code>.</p>\n\n<p>Here, the problem is with <code>(:)</code>, lets see what GHCI tells us.</p>\n\n<pre><code>Prelude \u03bb&gt; :t (:)\n(:) :: a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>So <code>(:)</code> takes an <code>a</code>, a list of <code>a</code>s and returns a new list. Specialized for the use case at hand, <code>(:)</code> has type <code>[Char] -&gt; [[Char]] -&gt; [[Char]]</code> (because <code>a = [Char]</code>). But <code>[\".\"]</code> has type <code>[[Char]]</code>, so it does not match what's expected for <code>(:)</code>.</p>\n\n<p>Now, if you use <code>take (x-1) rowelement ++ (\".\" : (drop (x) rowelement))</code> (note the missing <code>[]</code> around <code>\".\"</code>), the function should compile fine.</p>\n"}, {"comments": [{"owner": {"reputation": 12359, "user_id": 1173513, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d690004dc97e147f64c8ce8408adeba9?s=128&d=identicon&r=PG", "display_name": "tomahh", "link": "https://stackoverflow.com/users/1173513/tomahh"}, "edited": false, "score": 1, "creation_date": 1477393418, "post_id": 40235278, "comment_id": 67738277, "body": "<code>[</code> <code>]</code> are actually necessary in the first example."}], "tags": [], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "is_accepted": false, "score": 1, "last_activity_date": 1477394165, "last_edit_date": 1477394165, "creation_date": 1477384858, "answer_id": 40235278, "question_id": 40232116, "link": "https://stackoverflow.com/questions/40232116/haskell-in-append-few-list-together/40235278#40235278", "title": "Haskell in append few list together", "body": "<p>Either use:</p>\n\n<pre><code>(take (x-1) rowelement) ++ [\".\"] ++ (drop x rowelement)\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>(take (x-1) rowelement) ++ (\".\" : (drop x rowelement))\n</code></pre>\n\n<p>The <code>[</code> and <code>]</code> are not necessary</p>\n"}], "owner": {"reputation": 11, "user_id": 7067750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a5066e31ccaa05c92e273c3776acb07?s=128&d=identicon&r=PG&f=1", "display_name": "Kunshan Li", "link": "https://stackoverflow.com/users/7067750/kunshan-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1477397707, "creation_date": 1477373958, "last_edit_date": 1477397707, "question_id": 40232116, "link": "https://stackoverflow.com/questions/40232116/haskell-in-append-few-list-together", "title": "Haskell in append few list together", "body": "<p>I want to the value of one element in a List , So I did the</p>\n\n<pre><code>changePoint :: (Int,Int) -&gt; [[[Char]]] -&gt; [[Char]]\n\nchangePoint (x,y) maze = let \n\n          linelement = maze !! (y-1) \n\n-- value [\"X\",\" \",\" \",...,\" \",\"X\"]\n\n          rowelement = chunksOf 1 $ head linelement \n-- type:[[a]]; value [\"X\",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\"X\"]\n\n          l = length rowelement\n          list = take (x-1) rowelement\n\n--          in take (x-1) rowelement  -- [\"X\"]  \n\n           in take (x-1) rowelement ++ ([\".\"] : (drop (x) rowelement))\n</code></pre>\n\n<p>I want to append the list  \"take (x-1) rowelement\" and \"[\".\"]\" and \"drop (x) rowelement\",  the type of list will be  [[a]]</p>\n\n<pre><code>Couldn't match expected type \u2018Char\u2019 with actual type \u2018[Char]\u2019\n  In the expression: \".\"\n  In the first argument of \u2018(:)\u2019, namely \u2018[\".\"]\u2019\n  In the second argument of \u2018(++)\u2019, namely\n    \u2018([\".\"] : (drop (x) rowelement))\u2019 Failed, modules loaded: none.\n\nx = 2 .\n</code></pre>\n\n<p>I know the problem is \"[\".\"]\",but I really don't how to fix it .</p>\n\n<p>The true return should be <code>[\"X\",\".\",\" \",\" \",..,\"X\" ]</code></p>\n"}, {"tags": ["haskell", "mathjax", "haskell-diagrams"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1477352330, "post_id": 40229189, "comment_id": 67721451, "body": "Put <code>$</code> before and after the Latex code instead of <code>`</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1477352502, "post_id": 40229189, "comment_id": 67721493, "body": "The lexical error is easy to fix: escape your backslashes, as in <code>&quot;&#39;2 + \\\\sqrt{\\\\pi}`:math:&quot;</code>. No idea whether that&#39;s enough to reach your goal, though; probably not."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1477354163, "post_id": 40229189, "comment_id": 67721890, "body": "I don&#39;t think there&#39;s any supported way to get LaTeX formul&#230; in diagrams. What the <a href=\"http://projects.haskell.org/diagrams/doc/tutorials.html\" rel=\"nofollow noreferrer\">diagrams tutorial</a> says about LaTeX is only meta, about <i>this particular documentation</i>, i.e. it says you can include LaTeX if you&#39;re editing <code>projects.haskell.org&#47;diagrams&#47;doc</code>, which as a browser-displayed page supports MathJax easily. I reckon it would <i>in principle</i> also be possible to import math stuff as some MathJax-rendered SVG back into generic diagrams, but this is certainly not as simple as writing something like <code>textSVG &quot;$2 + \\\\sqrt{\\\\pi}$&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "edited": false, "score": 0, "creation_date": 1494012968, "post_id": 42235518, "comment_id": 74664423, "body": "Is that <code>text</code> function defined within <code>diagrams-pgf</code>? I don&#39;t see one there."}, {"owner": {"reputation": 1943, "user_id": 305559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc113924265dbeb535c8b2fefe4e33ee?s=128&d=identicon&r=PG", "display_name": "Brent Yorgey", "link": "https://stackoverflow.com/users/305559/brent-yorgey"}, "reply_to_user": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "edited": false, "score": 0, "creation_date": 1494024325, "post_id": 42235518, "comment_id": 74668893, "body": "No, <code>text</code> is from <code>diagrams-lib</code>."}, {"owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "edited": false, "score": 0, "creation_date": 1494085679, "post_id": 42235518, "comment_id": 74683090, "body": "I see it <a href=\"https://hackage.haskell.org/package/diagrams-lib-1.4.0.1/docs/Diagrams-TwoD-Text.html\" rel=\"nofollow noreferrer\">there</a>. Thank you!"}], "tags": [], "owner": {"reputation": 1943, "user_id": 305559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc113924265dbeb535c8b2fefe4e33ee?s=128&d=identicon&r=PG", "display_name": "Brent Yorgey", "link": "https://stackoverflow.com/users/305559/brent-yorgey"}, "is_accepted": true, "score": 2, "last_activity_date": 1487103847, "creation_date": 1487103847, "answer_id": 42235518, "question_id": 40229189, "link": "https://stackoverflow.com/questions/40229189/how-to-place-latex-like-mathematical-formulas-e-g-via-mathjax-in-haskell-diag/42235518#42235518", "title": "How to place latex-like mathematical formulas (e.g. via mathjax) in Haskell Diagrams?", "body": "<p>You can do this using the <code>diagrams-pgf</code> backend. Just use the <code>text</code> function and put dollar signs around your text.  Also, see here for an explanation of how to include diagrams in a LaTeX document: <a href=\"http://projects.haskell.org/diagrams/doc/latex.html\" rel=\"nofollow noreferrer\">http://projects.haskell.org/diagrams/doc/latex.html</a> .</p>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 1, "accepted_answer_id": 42235518, "answer_count": 1, "score": 2, "last_activity_date": 1487103847, "creation_date": 1477352041, "last_edit_date": 1483409565, "question_id": 40229189, "link": "https://stackoverflow.com/questions/40229189/how-to-place-latex-like-mathematical-formulas-e-g-via-mathjax-in-haskell-diag", "title": "How to place latex-like mathematical formulas (e.g. via mathjax) in Haskell Diagrams?", "body": "<p>I am attempting to place latex-style math formulas into a haskell diagram.</p>\n\n<p>The documentation pages\n<a href=\"http://projects.haskell.org/diagrams/doc/manual.html#essential-concepts\" rel=\"nofollow\">http://projects.haskell.org/diagrams/doc/manual.html#essential-concepts</a>\nand\n<a href=\"http://projects.haskell.org/diagrams/doc/tutorials.html\" rel=\"nofollow\">http://projects.haskell.org/diagrams/doc/tutorials.html</a>\nsuggest that one can use something called 'mathjax' to achieve this.</p>\n\n<p>Is there an explanation or example somewhere of how to actually code this?</p>\n\n<hr>\n\n<p>Attempting to follow the documentation at those links, my best guess for how would be something like:</p>\n\n<pre><code>mathDiagram :: Diagram B\nmathDiagram = stroke $ textSVG \"`2 + \\sqrt{\\pi}`:math:\" 1\n</code></pre>\n\n<p>But this of course gives an error:</p>\n\n<pre><code>induction.hs:13:35: error:\n    lexical error in string/character literal at character 's'\n</code></pre>\n"}, {"tags": ["haskell", "pandoc"], "comments": [{"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477379357, "post_id": 40228608, "comment_id": 67729420, "body": "this seems like a bug in the pandoc docx writer. if it still occurs in the newest pandoc version, you should <a href=\"https://github.com/jgm/pandoc/issues\" rel=\"nofollow noreferrer\">report it</a>. also, you might want to use the <a href=\"https://github.com/jgm/pandoc-types/blob/master/Text/Pandoc/Builder.hs\" rel=\"nofollow noreferrer\">builder functions</a> instead of writing the data structures by hand..."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 1901888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdbde26068be6276a92de3a7acb4c55?s=128&d=identicon&r=PG", "display_name": "jkr", "link": "https://stackoverflow.com/users/1901888/jkr"}, "is_accepted": false, "score": 0, "last_activity_date": 1477436328, "creation_date": 1477436328, "answer_id": 40251086, "question_id": 40228608, "link": "https://stackoverflow.com/questions/40228608/spaces-in-multi-characters-variable-name-in-pandoc-export-to-docx/40251086#40251086", "title": "Spaces in multi characters variable name in pandoc export to docx", "body": "<p>It's actually <a href=\"https://github.com/jgm/texmath\" rel=\"nofollow\">texmath</a> that takes care of the latex->omml conversion (OMML is the xml format that docx uses). So you should post a bug there.</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477436328, "creation_date": 1477348311, "question_id": 40228608, "link": "https://stackoverflow.com/questions/40228608/spaces-in-multi-characters-variable-name-in-pandoc-export-to-docx", "title": "Spaces in multi characters variable name in pandoc export to docx", "body": "<p>I'm writing a Haskell program to export some mathematics formula to <code>docx</code> and I have noted that variable names with multiple character are written with a blank white space between each letter and I don't understand why ?</p>\n\n<p>My basic code is : </p>\n\n<pre><code>import Text.Pandoc\nimport Data.Map (fromList)\nimport qualified Data.ByteString.Lazy as B\n\nmain = do\n  document &lt;- writeDocx WriterOptions{ writerStandalone=False\n                                     , writerReferenceDocx=Nothing\n                                     , writerUserDataDir=Nothing\n                                     , writerHighlight= False\n                                     }  pandoc\n  B.writeFile \"document.docx\" document\n\npandoc = Pandoc ( Meta {unMeta = fromList []})\n                           [ Para  [Str \"A small Math example\"]\n                           , Plain [Math InlineMath \"A_e = var + 5\"]\n                           , HorizontalRule\n                           ]\n</code></pre>\n\n<p>and the result is : </p>\n\n<p><a href=\"https://i.stack.imgur.com/fP0pC.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/fP0pC.png\" alt=\"enter image description here\"></a></p>\n\n<p>and I would like to get : </p>\n\n<p><a href=\"https://i.stack.imgur.com/EUN9H.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/EUN9H.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried to modify the string defining my equation  to </p>\n\n<pre><code>Math InlineMath \"A_e = {var} + 5\"\n</code></pre>\n\n<p>but It didn't change anything</p>\n\n<p>I also tried : </p>\n\n<pre><code>Math InlineMath \"A_e = \\\\{var\\\\} + 5\"\n</code></pre>\n\n<p>But It gave : </p>\n\n<p><a href=\"https://i.stack.imgur.com/Ro95B.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/Ro95B.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Do you know how to remove these boring white spaces ?</strong></p>\n"}, {"tags": ["haskell", "docx", "pandoc"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1477356881, "post_id": 40228433, "comment_id": 67722518, "body": "See <a href=\"http://stackoverflow.com/q/28346388/246886\">stackoverflow.com/q/28346388/246886</a>"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477379106, "post_id": 40228433, "comment_id": 67729290, "body": "there&#39;s nothing fundamentally different you can do with pandoc as a library than pandoc the commandline utility, it&#39;s always about the pandoc AST/internal document model which doesn&#39;t hold layout information."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477394422, "post_id": 40228433, "comment_id": 67738873, "body": "@mb21 note that JeanJoux is writing data that are somehow generated from a haskell program."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1477394783, "post_id": 40228433, "comment_id": 67739123, "body": "This will have to be handled by the reference docx, which contains all references to e.g. font sizes and other non-semantic material; pandoc&#39;s representation doesn&#39;t know anything about this. If the section in question is to get a different font size it will have to be semantically different in a way the reference docx can understand."}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1477424692, "creation_date": 1477347367, "last_edit_date": 1495542801, "question_id": 40228433, "link": "https://stackoverflow.com/questions/40228433/modify-font-name-and-size-when-exportng-to-docx-with-pandoc", "title": "Modify font name and size when exportng to docx with Pandoc", "body": "<p>I'm writing a <code>Haskell</code> program to export data to <code>docx</code> fileformat with <code>pandoc</code> and by default, the font size is 12pt and I would like to set it to 10pt.</p>\n\n<p>Is it possible with <code>pandoc</code> to set the font size and the font name when exporting a pandoc document to <code>docx</code> (and by extension to <code>odt</code>) ?</p>\n\n<p>Is it possible to modify these values just for a paragraph a not only for the whole document?</p>\n\n<hr>\n\n<p><em>Note : My question is different from <a href=\"https://stackoverflow.com/questions/28346388/changing-the-pandoc-monospace-font-size-or-style-in-docx-output\">this one</a> because I want to make a <code>docx</code> document from a Haskell program and not from command line.</em></p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1477397484, "post_id": 40227262, "comment_id": 67740978, "body": "There are several problems with the source you are providing, which should include imports. The problem will quickly be resolved if you specialise <code>sourceWS</code> to <code>sourceWSText :: MonadIO m =&gt; ConduitM i Text (WebSocketsT m) (); sourceWSText = sourceWS</code>"}], "answers": [{"comments": [{"owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "edited": false, "score": 0, "creation_date": 1477391882, "post_id": 40229257, "comment_id": 67737370, "body": "I see. Do you know how I could fix this, to allow passing the <code>Text</code>?"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 2, "creation_date": 1477397899, "post_id": 40229257, "comment_id": 67741285, "body": "If you really intend to ignore <code>msg</code> you can force it to have a type with <code>\\(msg :: Text) -&gt; ...</code> using <code>ScopedTypeVariables</code>. Or you can put a specialized <code>sourceWSText :: MonadIO m =&gt; ConduitM i Text (WebSocketsT m) (); sourceWSText = sourceWS</code> somewhere in the file and use <code>sourceWSText</code> instead. The compiler doesn&#39;t know what sort of <code>WebSocketsData</code> <code>sourceWS</code> is producing. If you had used <code>msg</code>, e.g. appending it to &quot;someText&quot;, the compiler would know what it was dealing with and could choose the right instance for <code>sourceWS</code>"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1477398595, "post_id": 40229257, "comment_id": 67741821, "body": "You could also write, e.g. <code>(msg `asTypeOf` &quot;someText&quot; :: Text)</code>"}, {"owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "edited": false, "score": 0, "creation_date": 1477418804, "post_id": 40229257, "comment_id": 67755804, "body": "Specializing the types is indeed working, thank you!"}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 2, "last_activity_date": 1477352635, "creation_date": 1477352635, "answer_id": 40229257, "question_id": 40227262, "link": "https://stackoverflow.com/questions/40227262/using-text-causes-an-error-even-though-the-compiler-suggests-it/40229257#40229257", "title": "Using Text causes an error even though the compiler suggests it", "body": "<pre><code>sourceWS :: (MonadIO m, WebSocketsData a) =&gt; Producer (WebSocketsT m) a \n</code></pre>\n\n<p>I presume that <code>$$</code> and <code>mapM_C</code> somehow attach the output <code>a</code> to the argument <code>msg</code> of the lambda <code>\\msg -&gt; ...</code>. But, you never use <code>msg</code>, so there is no way for the compiler to determine the type <code>a</code> it should choose for <code>sourceWS</code>, as it said:</p>\n\n<blockquote>\n<pre><code>No instance for (websockets-0.9.7.0:Network.WebSockets.Types.WebSocketsData\n               a0)\n  arising from a use of \u2018sourceWS\u2019\nThe type variable \u2018a0\u2019 is ambiguous\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477352635, "creation_date": 1477341988, "last_edit_date": 1477346328, "question_id": 40227262, "link": "https://stackoverflow.com/questions/40227262/using-text-causes-an-error-even-though-the-compiler-suggests-it", "title": "Using Text causes an error even though the compiler suggests it", "body": "<p>I am probably misreading the suggestion of the compiler, but when I try to pass it a <code>Text</code> value, it complains.</p>\n\n<p>Adapting the websocket <a href=\"https://github.com/yesodweb/yesod/blob/e2e546df4d062e182da79a20115d1334055ee1a9/yesod-websockets/chat.hs#L31-L34\" rel=\"nofollow\">example</a> I try to pass an encoded object. I've simplified my example to the following, where I try to just pass <code>\"someText\" :: Text</code>:</p>\n\n<pre><code>race_\n    (forever $ atomically (readTChan readChan) &gt;&gt;= sendTextData)\n    (sourceWS $$ mapM_C (\\msg -&gt; atomically $ writeTChan writeChan (\"someText\" :: Text)))\n</code></pre>\n\n<p>However, I get this error message:</p>\n\n<pre><code>No instance for (websockets-0.9.7.0:Network.WebSockets.Types.WebSocketsData\n                   a0)\n  arising from a use of \u2018sourceWS\u2019\nThe type variable \u2018a0\u2019 is ambiguous\nNote: there are several potential instances:\n  instance websockets-0.9.7.0:Network.WebSockets.Types.WebSocketsData\n             Text\n    -- Defined in \u2018websockets-0.9.7.0:Network.WebSockets.Types\u2019\n  instance websockets-0.9.7.0:Network.WebSockets.Types.WebSocketsData\n             Data.Text.Internal.Lazy.Text\n    -- Defined in \u2018websockets-0.9.7.0:Network.WebSockets.Types\u2019\n  instance websockets-0.9.7.0:Network.WebSockets.Types.WebSocketsData\n             ByteString\n    -- Defined in \u2018websockets-0.9.7.0:Network.WebSockets.Types\u2019\n  ...plus one other\nIn the first argument of \u2018($$)\u2019, namely \u2018sourceWS\u2019\nIn the second argument of \u2018race_\u2019, namely\n  \u2018(sourceWS\n    $$\n      mapM_C\n        (\\ msg -&gt; atomically $ writeTChan writeChan (\"someText\" :: Text)))\u2019\nIn a stmt of a 'do' block:\n  race_\n    (forever $ atomically (readTChan readChan) &gt;&gt;= sendTextData)\n    (sourceWS\n     $$\n       mapM_C\n         (\\ msg -&gt; atomically $ writeTChan writeChan (\"someText\" :: Text)))\n</code></pre>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 1207, "user_id": 2884502, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d817ec525df88f7a149bc9186e1a31f3?s=128&d=identicon&r=PG&f=1", "display_name": "lightandlight", "link": "https://stackoverflow.com/users/2884502/lightandlight"}, "edited": false, "score": 0, "creation_date": 1477348525, "post_id": 40226232, "comment_id": 67720382, "body": "Can you add the error you&#39;re getting to the question please"}, {"owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "reply_to_user": {"reputation": 1207, "user_id": 2884502, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d817ec525df88f7a149bc9186e1a31f3?s=128&d=identicon&r=PG&f=1", "display_name": "lightandlight", "link": "https://stackoverflow.com/users/2884502/lightandlight"}, "edited": false, "score": 0, "creation_date": 1477349834, "post_id": 40226232, "comment_id": 67720810, "body": "Oh, sorry, I&#39;ve added the error message."}], "answers": [{"tags": [], "owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "is_accepted": false, "score": 1, "last_activity_date": 1477393395, "creation_date": 1477393395, "answer_id": 40238259, "question_id": 40226232, "link": "https://stackoverflow.com/questions/40226232/run-monad-operations-wrapped-by-another-monad/40238259#40238259", "title": "Run Monad operations wrapped by another Monad", "body": "<p>The answer is to use <code>lift</code> and not <code>liftIO</code></p>\n\n<p><code>users &lt;- lift $ (runDB $ selectList [] [] :: Handler [Entity User])</code></p>\n"}], "owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1477393395, "creation_date": 1477338019, "last_edit_date": 1477349804, "question_id": 40226232, "link": "https://stackoverflow.com/questions/40226232/run-monad-operations-wrapped-by-another-monad", "title": "Run Monad operations wrapped by another Monad", "body": "<p>Given the <a href=\"https://github.com/yesodweb/yesod/blob/e2e546df4d062e182da79a20115d1334055ee1a9/yesod-websockets/chat.hs#L22-L23\" rel=\"nofollow\">websockets example</a> how can I have <code>Handler</code> related operations such as <code>runDB</code> inside (e.g. <code>runDB $ selectList ...</code>)</p>\n\n<p>Here's a non working example of what I want to do:</p>\n\n<pre><code>chatStream :: WebSocketsT Handler ()\nchatStream = do\n    users &lt;- liftIO $ runDB $ selectList [] [] :: Handler [Entity User] -- This line is not working\n    sendTextData (\"Welcome to the chat server, please enter your name.\" :: Text)\n     -- ....\n</code></pre>\n\n<p>Here's the error:</p>\n\n<pre><code>Couldn't match type \u2018HandlerT App IO [Entity User]\u2019\n               with \u2018ReaderT\n                       websockets-0.9.7.0:Network.WebSockets.Connection.Connection\n                       Handler\n                       t0\u2019\nExpected type: ReaderT\n                 websockets-0.9.7.0:Network.WebSockets.Connection.Connection\n                 Handler\n                 t0\n  Actual type: Handler [Entity User]\nIn a stmt of a 'do' block:\n  users &lt;- liftIO $ runDB $ selectList [] [] :: Handler [Entity User]\n</code></pre>\n"}, {"tags": ["haskell", "types", "typeclass"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1477322435, "post_id": 40221184, "comment_id": 67707296, "body": "<code>precioe :: (Fractional d) =&gt; a -&gt; d</code> promises to work for <i>any</i> <code>d</code> at all, chosen by the code <i>calling</i> <code>precioe</code>. Your implementations don&#39;t give the caller th at freedom, instead forcing <code>d</code> to be the type baked into your <code>Partida</code> and <code>Factura</code> types."}], "answers": [{"tags": [], "owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "is_accepted": true, "score": 3, "last_activity_date": 1477323220, "last_edit_date": 1477323220, "creation_date": 1477322459, "answer_id": 40221990, "question_id": 40221184, "link": "https://stackoverflow.com/questions/40221184/can-not-match-expected-type-d-with-actual-type-b/40221990#40221990", "title": "Can not match expected type d with actual type b", "body": "<p>The problem is <code>precioe</code> is supposed to return any <code>Fractional</code> <code>d</code> (<code>Double</code>, <code>Rational</code> etc.). The caller of <code>precioe</code> gets to decide what it is.</p>\n\n<p>Your instances of <code>Preciable</code> return something that is <code>Fractional</code> (<code>b</code>), but not necessarily the <code>Fractional</code> that the caller of <code>precioe</code> wanted (<code>d</code>). Fortunately there's a way to create any <code>Fractional</code> number <code>d</code> using <code>fromRational :: Fractional d =&gt; Rational -&gt; d</code></p>\n\n<p>You can turn your <code>b</code> to a <code>Rational</code> using the <code>Real</code> class:</p>\n\n<pre><code>class (Num a, Ord a) =&gt; Real a where\n  toRational :: a -&gt; Rational\n</code></pre>\n\n<p>There's a function that combines these two that also uses rewrite rules for faster conversions between certain types:</p>\n\n<pre><code>realToFrac :: (Real a, Fractional b) =&gt; a -&gt; b\nrealToFrac = fromRational . toRational\n</code></pre>\n\n<p>Adding a <code>Real</code> constraint to <code>b</code> lets your write the instances using <code>realToFrac</code>:</p>\n\n<pre><code>instance (Integral a, Real b) =&gt; Preciable (Partida a b c) where\n  precioe (ParMult n b) = fromIntegral n * realToFrac (precio b)\n  precioe (ParUnit b)   = realToFrac (precio b)\n\ninstance (Integral a, Real b) =&gt; Preciable (Factura a b c) where\n  precioe f = sum [precioe x | x &lt;- f]\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 6310668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a36aa2c2375dd6e6d2bbd47929f6616?s=128&d=identicon&r=PG&f=1", "display_name": "Javi Hernandez", "link": "https://stackoverflow.com/users/6310668/javi-hernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "accepted_answer_id": 40221990, "answer_count": 1, "score": 0, "last_activity_date": 1477329107, "creation_date": 1477319926, "last_edit_date": 1477329107, "question_id": 40221184, "link": "https://stackoverflow.com/questions/40221184/can-not-match-expected-type-d-with-actual-type-b", "title": "Can not match expected type d with actual type b", "body": "<p>Hello I am new in Haskell and I am having problems.</p>\n\n<p>I want to create a method that is valid for a Partida and for a list of Partidas (Facturas) to do so we have this code:</p>\n\n<pre><code>data Bebida a b where {\n        Bebida::(Integral a, Fractional b)=&gt;{codigo::a, nombre::[Char], precio::b } -&gt; Bebida a b\n    } \n\ndata Partida a b c where {\n    ParMult:: (Integral a, Integral c, Fractional b) =&gt; {cantidad::c, bebida::Bebida a b} -&gt; Partida a b c;\n    ParUnit:: (Integral a, Integral c, Fractional b) =&gt; {bebida::Bebida a b} -&gt; Partida a b c\n    }\n\ntype Factura a b c = [Partida a b c]\n\nclass Preciable a where\n precioe :: (Fractional d) =&gt; a -&gt; d\n\ninstance (Integral a, Fractional b, Integral c) =&gt; Preciable (Partida a b c) where\n precioe (ParMult n b) = (fromIntegral(n)*(precio b))\n precioe (ParUnit b) = (precio b)\n\ninstance (Integral a, Integral c, Fractional b, Eq b) =&gt; Preciable (Factura a b c) where\n precioe f = sum [precioe x | x&lt;-f]\n</code></pre>\n\n<p>I don't know why is giving me this mistake. Can anyone help me telling me why is Haskell giving me this mistake? </p>\n\n<p>Thank you for your help!!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1477316329, "post_id": 40219246, "comment_id": 67703012, "body": "You&#39;re aware that your type <code>Some</code> is unrelated to the data constructor <code>Some</code> defined as part of <code>Optional</code>, right?"}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 4, "last_activity_date": 1477314637, "creation_date": 1477314637, "answer_id": 40219362, "question_id": 40219246, "link": "https://stackoverflow.com/questions/40219246/define-print-format-for-custom-datatype/40219362#40219362", "title": "Define print format for custom datatype", "body": "<p>You can just use <code>deriving (Show)</code> on your data type:</p>\n\n<pre><code>data Optional a = Some a | None deriving (Show)\n</code></pre>\n\n<p>Also, your <code>Optional</code> type is basically the same as <code>Maybe</code>, which is what is used throughout most libraries.</p>\n"}], "owner": {"reputation": 15768, "user_id": 3122885, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/fe1eced7899a319fb446e04b63ac7eea?s=128&d=identicon&r=PG&f=1", "display_name": "octavian", "link": "https://stackoverflow.com/users/3122885/octavian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 40219362, "answer_count": 1, "score": 0, "last_activity_date": 1477314637, "creation_date": 1477314307, "question_id": 40219246, "link": "https://stackoverflow.com/questions/40219246/define-print-format-for-custom-datatype", "title": "Define print format for custom datatype", "body": "<p>For the exercise that I'm doing, I implemented a datatype that is similar to <code>Maybe</code>:</p>\n\n<pre><code>type Some a = a\ndata Optional a = Some a | None\n</code></pre>\n\n<p>And a function:</p>\n\n<pre><code>safeRoot :: Double -&gt; Optional Double\nsafeRoot x =\n  if x &gt;= 0\n    then Some (sqrt x)\n  else None\n</code></pre>\n\n<p>However, if I try to run the function from ghci like this:</p>\n\n<pre><code>safeRoot 4\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>No instance for (Show (Optional Double))\n  arising from a use of \u2018print\u2019\nIn a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>So how can I define a print format for <code>Optional</code>?</p>\n"}, {"tags": ["haskell", "numbers"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1477314308, "post_id": 40217854, "comment_id": 67701610, "body": "Please check that my edit actually fulfills your needs. Otherwise <a href=\"https://stackoverflow.com/posts/40217854/edit\">edit</a> the post yourself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7064250"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1477314384, "post_id": 40217854, "comment_id": 67701666, "body": "IT&#39;s amazing! Thank you!!"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1477314957, "post_id": 40217854, "comment_id": 67702037, "body": "This isn&#39;t solving the problem with your algorithm, but I would probably just pipe it through <code>Data.Set.toList . Data.Set.fromList</code> and be done with it."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7064250"}, "edited": false, "score": 0, "creation_date": 1477318962, "post_id": 40219817, "comment_id": 67705011, "body": "Thanks for the reply, very helpfull!"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 0, "last_activity_date": 1477315961, "creation_date": 1477315961, "answer_id": 40219817, "question_id": 40217854, "link": "https://stackoverflow.com/questions/40217854/how-can-i-create-non-repeating-palindromic-numbers/40219817#40219817", "title": "How can I create non-repeating palindromic numbers?", "body": "<p>Well, you have to make sure that every number is unique. There exist multiple representations for all numbers with at least three prime factors (<code>x * y * z = (x * y) * z = x * (y * z)</code>). So one way we could tacke this would be prime factor analysis and reasoning about them. But that's probably an overkill.</p>\n\n<p>Instead, we can use a function that makes sure that every number in our sorted list is unique:</p>\n\n<pre><code>unique :: Eq a =&gt; [a] -&gt; [a]\nunique (x:y:xs) = if x == y then unique (y:xs) else x : unique (y:xs)\nunique xs       = xs\n</code></pre>\n\n<p>(Alternatively, use <code>unique = map head . group</code>)</p>\n\n<p>Now you can use <code>sort</code> from <code>Data.List</code> and you end up with your actual <code>calUniuqe</code>:</p>\n\n<pre><code>calcUnique :: Int -&gt; [Int]\ncalcUnique = unique . sort . calc\n</code></pre>\n\n<p>However, we can make <code>calc</code> a lot easier to read if we move the palindrome check into its own function:</p>\n\n<pre><code>isPalindrome :: Int -&gt; Bool\nisPalindrome n = n &gt; 10 &amp;&amp; reverse n' == n'\n  where n' = show n\n\ncalc :: Int -&gt; [Int]\ncalc n = [a * b | a &lt;- [1..n-1], b &lt;- [a..n-1], isPalindrome (a * b)]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7064250"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 40219817, "answer_count": 1, "score": 0, "last_activity_date": 1477315961, "creation_date": 1477310404, "last_edit_date": 1477310843, "question_id": 40217854, "link": "https://stackoverflow.com/questions/40217854/how-can-i-create-non-repeating-palindromic-numbers", "title": "How can I create non-repeating palindromic numbers?", "body": "<p>So I'm trying to do something and it's almost there I think but I can't solve the last part of it. I have to make a code where someone gives a number (let's make it 22) an I need to find all the palindromic numbers there is when I multiply two numbers smaller than 22:</p>\n\n<blockquote>\n  <p>Find all the palindromic numbers of <code>a*b</code> but <code>a &lt; n &amp;&amp; b &lt; n</code>. but they can't repeat themselves.</p>\n</blockquote>\n\n<p>I got this</p>\n\n<pre><code>calc :: Int -&gt; [Int]\ncalc n = [a*b|a&lt;-[1..n-1], b&lt;-[a..n-1], a*b&gt;10, reverse(show(a*b))==show(a*b)]\n</code></pre>\n\n<p>If we do <code>calc 22</code> the result should be    </p>\n\n<pre><code>[11,22,33,44,55,66,77,88,99,171,121,252,272,323] \n</code></pre>\n\n<p>but I'm getting</p>\n\n<pre><code>[11,22,33,44,55,66,77,88,99,171,121,252,252,272,323]\n</code></pre>\n\n<p>because 14x18 = 12x21 = 252.</p>\n\n<p>Where did I go wrong?</p>\n"}, {"tags": ["mysql", "haskell", "hdbc"], "comments": [{"owner": {"reputation": 445, "user_id": 2102854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PeSJn.png?s=128&g=1", "display_name": "jpvillaisaza", "link": "https://stackoverflow.com/users/2102854/jpvillaisaza"}, "edited": false, "score": 0, "creation_date": 1477314323, "post_id": 40217702, "comment_id": 67701623, "body": "Did you install <a href=\"https://hackage.haskell.org/package/HDBC-sqlite3\" rel=\"nofollow noreferrer\">HDBC-sqlite3</a>, which is the one exporting the Database.HDBC.Sqlite3 module? I see you&#39;re trying to import that module but mentioned installing HDBC-mysql instead."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1477315173, "post_id": 40217702, "comment_id": 67702167, "body": "The command must have been <code>:module Database.HDBC Database.HDBC.MySQL</code> . Meanwhile, though, you are opening <code>ghci</code> or <code>cabal repl</code> inside the main directory of the <code>HDBC-mysql</code> source, so it is looking to the local file <code>.&#47;Database&#47;HDBC&#47;MySQL.hs</code>, as the message says. You should just install <code>HDBC-mysql</code> one way or another, and stay out of the source for it."}, {"owner": {"reputation": 41, "user_id": 6927415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25347417d08ee4c9423b59b6d63b561e?s=128&d=identicon&r=PG&f=1", "display_name": "andrew_j", "link": "https://stackoverflow.com/users/6927415/andrew-j"}, "reply_to_user": {"reputation": 445, "user_id": 2102854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PeSJn.png?s=128&g=1", "display_name": "jpvillaisaza", "link": "https://stackoverflow.com/users/2102854/jpvillaisaza"}, "edited": false, "score": 0, "creation_date": 1477315235, "post_id": 40217702, "comment_id": 67702212, "body": "@jpvillaisaza ooops, that&#39;s a mistake in my question. of course, not. I&#39;m trying exporting Database.HDBC.MySQL, it could be seen from error, which I receiving"}, {"owner": {"reputation": 41, "user_id": 6927415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25347417d08ee4c9423b59b6d63b561e?s=128&d=identicon&r=PG&f=1", "display_name": "andrew_j", "link": "https://stackoverflow.com/users/6927415/andrew-j"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1477315317, "post_id": 40217702, "comment_id": 67702263, "body": "@Michael please, see my previous comment. I still have a problem"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1477315538, "post_id": 40217702, "comment_id": 67702418, "body": "Right, I saw what you had done. This particular problem entails that you are opening ghci inside the source directory for <code>HDBC-mysql</code> - how else would <code>ghci</code> <i>know</i> that it is near a file called <code>(.&#47;Database&#47;HDBC&#47;MySQL.hs)</code>. It might make sense to do this if you are developing <code>HDBC-mysql</code>, otherwise not. My sense is that you should install  <code>HDBC-mysql</code> and get the source off of the computer, since it is confusing."}, {"owner": {"reputation": 41, "user_id": 6927415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25347417d08ee4c9423b59b6d63b561e?s=128&d=identicon&r=PG&f=1", "display_name": "andrew_j", "link": "https://stackoverflow.com/users/6927415/andrew-j"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 1, "creation_date": 1477315606, "post_id": 40217702, "comment_id": 67702471, "body": "@Michael thanks, I&#39;ve got it! Everything works!"}], "answers": [{"tags": [], "owner": {"reputation": 26881, "user_id": 432903, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/YCgsh.jpg?s=128&g=1", "display_name": "prayagupd", "link": "https://stackoverflow.com/users/432903/prayagupd"}, "is_accepted": false, "score": 0, "last_activity_date": 1540794732, "last_edit_date": 1540794732, "creation_date": 1540793634, "answer_id": 53039725, "question_id": 40217702, "link": "https://stackoverflow.com/questions/40217702/error-while-connecting-to-mysql-database-haskell/53039725#53039725", "title": "Error while connecting to mysql database, haskell", "body": "<p>I could solve the problem installing mysql on MacOS, </p>\n\n<pre><code>brew install mysql\nmysql.server start ## mysqld\n</code></pre>\n\n<p>Followed by </p>\n\n<pre><code>cabal install HDBC\ncabal install HDBC-mysql\n</code></pre>\n\n<p>Then could I create MySQL connection, </p>\n\n<pre><code>import Control.Monad\nimport Database.HDBC\nimport Database.HDBC.MySQL\n\nmain = do conn &lt;- connectMySQL MySQLConnectInfo { \n                    mysqlHost = \"localhost\", \n                    mysqlUser = \"root\", \n                    mysqlPassword = \"\", \n                    mysqlDatabase = \"chat_server\", \n                    mysqlPort = 3306, \n                    mysqlUnixSocket = \"/tmp/mysql.sock\", \n                    mysqlGroup = Just \"test\"\n                  }\n\n          rows &lt;- quickQuery' conn \"SELECT 1 + 1\" []\n          forM_ rows $ \\row -&gt; putStrLn $ show row\n</code></pre>\n\n<p>Note: you might need to update <code>mysqlUnixSocket</code> based on where is it located which can be found with following command:</p>\n\n<pre><code>sudo find / -type s \n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6927415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25347417d08ee4c9423b59b6d63b561e?s=128&d=identicon&r=PG&f=1", "display_name": "andrew_j", "link": "https://stackoverflow.com/users/6927415/andrew-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1540794732, "creation_date": 1477309970, "last_edit_date": 1477315251, "question_id": 40217702, "link": "https://stackoverflow.com/questions/40217702/error-while-connecting-to-mysql-database-haskell", "title": "Error while connecting to mysql database, haskell", "body": "<p>I'm absolutely newbie to haskell, but I need to write a simple application to work with DB. I'm reading realworldhaskell book, chapter about using databases: <a href=\"http://book.realworldhaskell.org/read/using-databases.html\" rel=\"nofollow\">http://book.realworldhaskell.org/read/using-databases.html</a>.\nI've installed HDBC and HDBC-mysql and trying to run: </p>\n\n<pre><code>ghci&gt; :module Database.HDBC Database.HDBC.MySQL\n</code></pre>\n\n<p>but receive error   </p>\n\n<pre><code>attempting to use module \u2018Database.HDBC.MySQL\u2019 (./Database/HDBC/MySQL.hs) which is not loaded.\n</code></pre>\n\n<p>Does someone have some idea how to fix it and by what is is caused? Thanks!</p>\n"}, {"tags": ["haskell", "ghc-generics"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1477306673, "post_id": 40214267, "comment_id": 67696860, "body": "I&#39;m not sure this will all work, or at least not as nicely as you imagine. Note that <code>FooC { x = someEnvInt &quot;someX&quot; , y = someEnvText &quot;someY&quot;  }</code> won&#39;t compile by itself. If you change <code>someEnv___</code> to have signature <code>Data.Functor.Compose IO Maybe ___</code> you might have a chance then. But at that point, I&#39;m not sure it would be worth it at all anymore..."}, {"owner": {"reputation": 9119, "user_id": 180258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8b3779ca7c73166d7016272086c6282f?s=128&d=identicon&r=PG", "display_name": "ron", "link": "https://stackoverflow.com/users/180258/ron"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1477309849, "post_id": 40214267, "comment_id": 67698704, "body": "@Alec: wrapping in Compose (or <code>generics-sop</code>&#39;s equivalent) is acceptable."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477318153, "post_id": 40214267, "comment_id": 67704430, "body": "You don&#39;t need generics .. just write a function <code>(Applicative g, Applicative f) =&gt; FooC (Compose f g) -&gt; f (FooC g)</code> (this function is essentially just <code>sequence</code>) - then change the type of <code>someEnvInt</code> to <code>Compose IO Maybe Int</code>. If you want you can do the &#39;uncomposition&#39; using type families which would save you changing the type of <code>someEnvInt</code> but I personally don&#39;t think it&#39;s worth the effort."}, {"owner": {"reputation": 9119, "user_id": 180258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8b3779ca7c73166d7016272086c6282f?s=128&d=identicon&r=PG", "display_name": "ron", "link": "https://stackoverflow.com/users/180258/ron"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477756299, "post_id": 40214267, "comment_id": 67897440, "body": "@user2407038: I want to avoid hand-rolling the function, since &#39;Foo&#39; can have a lot of fields, and then this is just boilerplate. That&#39;s why I wanted Generics."}], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1477344161, "last_edit_date": 1477344161, "creation_date": 1477343811, "answer_id": 40227704, "question_id": 40214267, "link": "https://stackoverflow.com/questions/40214267/implement-applicative-builder-style-with-generics/40227704#40227704", "title": "Implement Applicative builder style with Generics", "body": "<blockquote>\n  <p>But I don't know how to write a type signature for the I removal /\n  addition function, which communicates that the types of the respective\n  hlist elements change consistently by losing/gaining the outer type.\n  Is this even possible?</p>\n</blockquote>\n\n<p>I don't know how to do that either. A possible workaround (at the cost of some boilerplate) would be to use <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#record-pattern-synonyms\" rel=\"nofollow\">record pattern synonyms</a> to construct the sum-of-products representation directly, while still being able to use named fields:</p>\n\n<pre><code>{-# language DeriveGeneric #-}\n{-# language TypeFamilies #-}\n{-# language TypeOperators #-}\n{-# language PatternSynonyms #-}\n\nimport Data.Text\nimport qualified GHC.Generics as GHC\nimport Generics.SOP\nimport Text.Read\n\ndata Foo = Foo { x :: Int, y :: Text } deriving (Show, GHC.Generic)\n\ninstance Generic Foo\n\npattern Foo' :: t Int -&gt; t Text -&gt; SOP t (Code Foo)\npattern Foo' {x', y'} = SOP (Z (x' :* y' :* Nil))\n\nreadFooMaybe :: SOP (IO :.: Maybe) (Code Foo)\nreadFooMaybe = Foo'\n             {\n                x' = Comp (fmap readMaybe getLine)\n             ,  y' = Comp (fmap readMaybe getLine)\n             }\n</code></pre>\n\n<p>Testing it on ghci:</p>\n\n<pre><code>ghci&gt; hsequence' readFooMaybe &gt;&gt;= print\n12\n\"foo\"\nSOP (Z (Just 12 :* (Just \"foo\" :* Nil)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23816, "user_id": 572606, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c20a126ad0dce40e8fc4a43456107919?s=128&d=identicon&r=PG", "display_name": "shang", "link": "https://stackoverflow.com/users/572606/shang"}, "is_accepted": false, "score": 0, "last_activity_date": 1477404633, "creation_date": 1477404633, "answer_id": 40242305, "question_id": 40214267, "link": "https://stackoverflow.com/questions/40214267/implement-applicative-builder-style-with-generics/40242305#40242305", "title": "Implement Applicative builder style with Generics", "body": "<p>The problem with Generics is that your <code>FooC</code> type has the kind <code>(* -&gt; *) -&gt; *</code> and, as far as I know, it's not possible to automatically derive a <code>GHC.Generics</code> instance for such a type. If you are open to a solution using Template Haskell it's relatively easy to write the TH code needed to automatically handle any record type.</p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE TemplateHaskell #-}\n\nmodule AppCon where\n\nimport Control.Applicative\nimport Control.Compose ((:.), unO)\nimport Language.Haskell.TH\n\nclass AppCon t where\n  appCon :: Applicative f =&gt; t (f :. g) -&gt; f (t g)\n\nderiveAppCon :: Name -&gt; Q [Dec]\nderiveAppCon name = do\n  (TyConI (DataD _ _ _ _ [RecC con fields] _)) &lt;- reify name\n\n  let names = [mkName (nameBase n) | (n,_,_) &lt;- fields]\n      apps = go [|pure $(conE con)|] [[|unO $(varE n)|] | n &lt;- names] where\n        go l [] = l\n        go l (r:rs) = go [|$l &lt;*&gt; $r|] rs\n\n  [d|instance AppCon $(conT name) where\n      appCon ($(conP con (map varP names))) = $apps\n    |]\n</code></pre>\n\n<p>I use the type composition operator from the <a href=\"https://hackage.haskell.org/package/TypeCompose\" rel=\"nofollow\"><code>TypeCompose</code></a> package to define a type-class that can \"unwrap\" a single applicative layer from a record type. I.e if you have a <code>FooC (IO :. Maybe)</code> you can turn it into a <code>IO (FooC Maybe)</code>.</p>\n\n<p>The <code>deriveAppCon</code> lets you automatically derive an instance for any basic record type.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nimport Control.Compose ((:.)(..))\n\nimport AppCon\n\ndata FooC f = FooC { x :: f Int, y :: f Text }\ntype Foo = FooC Maybe\n\nderiveAppCon ''FooC\n\nmyfoo :: IO Foo\nmyfoo = appCon $ FooC\n    { x = O $ someEnvInt \"someX\"\n    , y = O $ someEnvText \"someY\"\n    }\n</code></pre>\n\n<p>The <code>O</code> constructor from <code>TypeCompose</code> is used to wrap the function result <code>IO (Maybe a)</code> into a composite <code>((IO .: Maybe) a)</code>.</p>\n"}], "owner": {"reputation": 9119, "user_id": 180258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8b3779ca7c73166d7016272086c6282f?s=128&d=identicon&r=PG", "display_name": "ron", "link": "https://stackoverflow.com/users/180258/ron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 2, "answer_count": 2, "score": 7, "last_activity_date": 1477404633, "creation_date": 1477299142, "question_id": 40214267, "link": "https://stackoverflow.com/questions/40214267/implement-applicative-builder-style-with-generics", "title": "Implement Applicative builder style with Generics", "body": "<h2>Context</h2>\n\n<p>If we have</p>\n\n<pre><code>data Foo = Foo { x :: Maybe Int, y :: Maybe Text }\n</code></pre>\n\n<p>we can already build it up applicative-style in an Applicative context (here IO) as</p>\n\n<pre><code>myfoo :: IO Foo\nmyfoo = Foo &lt;$&gt; getEnvInt \"someX\" &lt;*&gt; getEnvText \"someY\"\n</code></pre>\n\n<h2>Problem</h2>\n\n<p>What if one prefers to build with explicitly writing out the record field names? Such as:</p>\n\n<pre><code>myfoo = Foo { x = getEnvInt \"someX\", y = getEnvText \"someY\" }\n</code></pre>\n\n<p>This won't typecheck. One solution is</p>\n\n<pre><code>{-# LANGUAGE RecordWildCards #-}\nmyfoo = do\n    x &lt;- getEnvInt \"someX\"\n    y &lt;- getEnvText \"someY\"\n    return $ Foo {..}\n</code></pre>\n\n<p>Which is not bad. But I wonder (at this point only for the sake of itself) if the following could work:</p>\n\n<pre><code>data FooC f = FooC { x :: f Int, y :: f Text }\ntype Foo = FooC Maybe\n\nmyfoo :: IO Foo\nmyfoo = genericsMagic $ FooC\n    { x = someEnvInt \"someX\"\n    , y = someEnvText \"someY\"\n    }\n</code></pre>\n\n<p>I believe it can be done with bare <code>GHC.Generics</code> pattern matching, but that wouldn't have type safety, so I was looking for a stronger approach. I encountered <code>generics-sop</code>, which converts the record into a heterogeneous list, and comes with a seemingly handy <code>hsequence</code> operation.</p>\n\n<h2>Point where I'm stuck</h2>\n\n<p><code>generics-sop</code> stores the Applicative's type in a separate type parameter of its heterogeneous list, and that is always <code>I</code> (Identity) when using the generated conversion. So I would need to map the hlist and remove the <code>I</code> from the elements which would effectively move the Applicative under <code>I</code> to the mentioned type parameter (it would be <code>Comp IO Maybe</code>), so I could use <code>hsequence</code>, and finally add back the <code>I</code>s so I can covert back to record.</p>\n\n<p>But I don't know how to write a type signature for the <code>I</code> removal / addition function, which communicates that the types of the respective hlist elements change consistently by losing/gaining the outer type. Is this even possible?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1477369745, "post_id": 40212288, "comment_id": 67725467, "body": "Try compiling and running it instead of loading it into ghci."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7062994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399dbef07ad51b9f1fee348765d4de07?s=128&d=identicon&r=PG&f=1", "display_name": "HongJian Huang", "link": "https://stackoverflow.com/users/7062994/hongjian-huang"}, "edited": false, "score": 0, "creation_date": 1477318617, "post_id": 40213549, "comment_id": 67704756, "body": "Thanks  for your help. I tried this way , but &lt;interactive&gt;:2:175:     Not in scope: \u2018main\u2019     Perhaps you meant \u2018min\u2019 (imported from Prelude)"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 2, "last_activity_date": 1477296651, "creation_date": 1477296651, "answer_id": 40213549, "question_id": 40212288, "link": "https://stackoverflow.com/questions/40212288/haskell-use-main-load-a-file-how-to-write-address/40213549#40213549", "title": "Haskell use main load a file , how to write address", "body": "<p>Under <code>:help</code>, you can see documentation for the <code>:main</code> command:</p>\n\n<blockquote>\n<pre><code>  :main [&lt;arguments&gt; ...]     run the main function with the given arguments\n</code></pre>\n</blockquote>\n\n<p>Example:</p>\n\n<pre><code>ghci&gt; :main /Users/Documents/Programming/test.txt\n...\ncontents of test.txt\n...\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7062994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399dbef07ad51b9f1fee348765d4de07?s=128&d=identicon&r=PG&f=1", "display_name": "HongJian Huang", "link": "https://stackoverflow.com/users/7062994/hongjian-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 40213549, "answer_count": 1, "score": 0, "last_activity_date": 1478636220, "creation_date": 1477291963, "last_edit_date": 1478636220, "question_id": 40212288, "link": "https://stackoverflow.com/questions/40212288/haskell-use-main-load-a-file-how-to-write-address", "title": "Haskell use main load a file , how to write address", "body": "<p>Here I have text file, I want to load it in Haskell, and read it in a List.</p>\n\n<pre><code>import qualified System.Environment\n\nmain :: IO ()\nmain = do\n    [path] &lt;- System.Environment.getArgs\n    g &lt;- readFile path\n    putStr g\n</code></pre>\n\n<p>But I don't know how to give the address. (Example: the file is <code>/Users/Documents/Programming/test.txt</code>)</p>\n\n<p>After I load this Haskell file:</p>\n\n<pre><code>*Main&gt; main -- How can I write the address?\n</code></pre>\n"}, {"tags": ["haskell", "testing"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1477292290, "post_id": 40210445, "comment_id": 67688698, "body": "Please include relevant code in your question, as you might close your GitHub repository and thus make your question invalid. Also, your question is kind of open-ended. You&#39;re almost asking for a tutorial, which is off-topic. A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> can tackle down your problem to a fraction of its size (which can easily answered) and still provide valuable information for you and future readers."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1477292697, "post_id": 40210445, "comment_id": 67688944, "body": "@Zeta You are right.. i have included two functions and i am now asking for right way to structure this code .. Is this fine ?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1477297910, "post_id": 40210445, "comment_id": 67691762, "body": "I guess. Note that, <b>if</b> your code works, your question is eligible for <a href=\"https://codereview.stackexchange.com\">Code Review</a>, which is suitable for questions with a lot of code. But that&#39;s an aside. Note that your example isn&#39;t what I would call &quot;minimal&quot;, by the way. But it&#39;s probably hard to come up with something that shows your problem in  a short way."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477318889, "post_id": 40210445, "comment_id": 67704959, "body": "You are using the <code>IO</code> to manage state which makes testing stateful code difficult. You should use something like <code>StateT Server IO</code> instead of <code>IO</code>. Your issue, however, seems to be testing user interaction in particular - the difficulty will likely be writing to the appropriate handle at the exact correct time, to e.g. disconnect a user before they complete connecting. If this is the case, you should abstract out the user interaction code into a typeclass, e.g. <code>class UserInteractionMonad m where pollMsg :: m Message; sendMsg :: Message -&gt; m ()</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477319065, "post_id": 40210445, "comment_id": 67705089, "body": "Furthermore, the question &quot;How can i structure my code such that workflow logic in runClient and playClient can be separated ?&quot; isn&#39;t exactly clear, and it doesn&#39;t seem to be the same question as &quot;How can i test my workflows ?&quot; - you should limit yourself to one question per question."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477320653, "post_id": 40210445, "comment_id": 67706165, "body": "@user2407038 Thanks for suggestions. i would read about <code>StateT Server IO</code>. About 2 questions : i would say that i want to <code>separate out workflow logic</code> with the aim to be able to test it."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477323730, "post_id": 40210445, "comment_id": 67708119, "body": "@AshishNegi I see, you think you have a mixing of concerns and you would like to reason about each separately. Your issue is that everything is just <code>IO</code> - so you can&#39;t distinguish it. Make separate classes for everything which you consider a &#39;separate logic&#39; - for your actual game, you instantiate everything with <code>IO</code>, and for testing, you have a custom type which allows you to test each &#39;logic&#39; as you wish (or perhaps multiple custom types!). See my prev. comment and <code>UserInteractionMonad</code> - and <a href=\"http://okmij.org/ftp/tagless-final/\" rel=\"nofollow noreferrer\">this</a> may interest you."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477323950, "post_id": 40210445, "comment_id": 67708266, "body": "Also note that you&#39;ll have to change your datatype - <code>Chan</code> and <code>TChan</code> only work with actual <code>IO</code> and testing these is much too much work (especially in conjunction with async. IO over the network). You can have e.g <code>class MonadChan m c | m -&gt; c where newChan :: m (c a); ...</code> and then make the &#39;chan&#39; a parameter in the type: <code>data Server chan tchan = Server { ..., serverChan :: tchan InMessage, clientsChan :: chan OutMessage, ... }</code>"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1477332154, "post_id": 40210445, "comment_id": 67712813, "body": "You can test code that lives in IO. It&#39;s not clear to me what you&#39;re asking"}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1477332855, "post_id": 40210445, "comment_id": 67713170, "body": "@jberryman i am asking for the strategies that can help me in moving logic out of <code>IO</code> .. user2407038 has given some suggestions.. if you have any other pattern that i can follow that can help in separating things out at higher level, it would be helpful."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "edited": false, "score": 0, "creation_date": 1477811497, "post_id": 40210445, "comment_id": 67908769, "body": "hi.. i tried the suggestions; but i found that it was either too much work and also little orthogonal to what i wanted. I did not wanted to abstract network/chans but test workflow.. finally i moved (most of) workflow logic out in a pure function and wrote tests for that..  <a href=\"https://github.com/ashishnegi/tronkell/commit/dbbe8b5da98eb11c73bca009553dd31cb33cc696#diff-e093df5fb77651bca1f325e5e2d15f69R239\" rel=\"nofollow noreferrer\">github.com/ashishnegi/tronkell/commit/&hellip;</a> and tests : <a href=\"https://github.com/ashishnegi/tronkell/commit/c23211851f8cb83b8dcfdb3d3e88c14620ebe5f6#diff-1c8164ce9e43c5b4494524dd89ad4e03R26\" rel=\"nofollow noreferrer\">github.com/ashishnegi/tronkell/commit/&hellip;</a> Does it look OK ? or is it <code>poor man&#39;s</code> state mangment."}], "owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1477321088, "creation_date": 1477281200, "last_edit_date": 1477321088, "question_id": 40210445, "link": "https://stackoverflow.com/questions/40210445/testing-haskell-code-separating-state", "title": "Testing Haskell code : separating state", "body": "<p>I am writing a online game in haskell..\nMy GameEngine is in <code>statemonad</code> so it is simple to test and we have written properties for it. It's just bliss.</p>\n\n<p>However, server has a list of users which is in <code>MVar</code>. <a href=\"https://github.com/nilenso/tronkell/blob/master/src/Tronkell/Server/Server.hs\" rel=\"nofollow\">Server.hs</a> There are a lot of threads running around. One game thread, tcp and websocket threads, each client on its own thread etc. All of them talks with Channels.</p>\n\n<p>The problem is with <code>testing some user workflow</code> ; like </p>\n\n<ol>\n<li>user joins and quits immediately even before game starts</li>\n<li>user leaves in between of game; </li>\n<li>user quits the game and so on..</li>\n</ol>\n\n<p>User workflow is coupled with all the threads which are in <code>IO()</code>.\nI tried writing unit tests on functions by passing channels (prefilled with values). But they looked very fragile. Every time i change the code, its hard to understand why test failed. Its not very bad but i am in search of better way.</p>\n\n<p>How can i test my workflows ? Can i use some other kind of programming abstractions ?</p>\n\n<p>I am open to all kind of suggestions (FRP / free monads : I do not know any of them.. but if they solve the problem i am ready to learn.).</p>\n\n<p>Relevant code :</p>\n\n<pre><code>data Server = Server { serverGameConfig :: Game.GameConfig\n                 , serverUsers      :: MVar (M.Map UserID User)\n                 , networkChans     :: NetworkChans\n                 , serverChan       :: TChan InMessage\n                 , clientsChan      :: Chan OutMessage\n                 , internalChan     :: Chan ServerSignals\n}\n\nrunClient :: UserID -&gt; Chan InMessage -&gt; Server -&gt; IO ()\nrunClient uId clientChan server@Server{..} = do\n  let (_, clientSpecificOutChan) = networkChans\n  writeChan clientSpecificOutChan $ (uId, ServerMsg \"Take a nick name : \")\n  msg &lt;- readChan clientChan\n  let nick = case msg of\n               PlayerName _ name -&gt; Just name\n               _ -&gt; Nothing\n\n  case nick of\n    Nothing -&gt; runClient uId clientChan server\n    Just _ -&gt; do\n      let user = User uId nick Waiting\n      failedToAdd &lt;- modifyMVar serverUsers $ \\users -&gt;\n        -- for player we still have name as id ; so keep it unique.\n        if isNickTaken users nick\n        then return (users, True)\n        else return (M.insert uId user users, False)\n\n      if failedToAdd\n      then runClient uId clientChan server\n      else do atomically $ writeTChan serverChan $ PlayerJoined uId\n              writeChan clientSpecificOutChan $ (uId, ServerMsg $ \"Hi.. \" ++ T.unpack (fromJust nick) ++ \".. Type ready when you are ready to play.. quit to quit.\")\n              fix $ \\loop -&gt; do m &lt;- readChan clientChan\n                                case m of\n                                 PlayerReady _ -&gt; playClient uId clientChan server\n                                 PlayerExit  _ -&gt; atomically $ writeTChan serverChan $ PlayerExit uId\n                                 _ -&gt; loop\n  where\n    isNickTaken users nick = any (\\u -&gt; nick == userNick u) users\n\ncleanString :: String -&gt; String\ncleanString = reverse . dropWhile (\\c -&gt; c == '\\n' || c == '\\r') . reverse\n\nplayClient :: UserID -&gt; Chan InMessage -&gt; Server -&gt; IO ()\nplayClient clientId inChan Server{..} = do\n    -- because every client wants same copy of the message, duplicate channel.\n  outClientChan &lt;- dupChan clientsChan\n  writeChan outClientChan $ ServerMsg \"Waiting for other players to start the game...!!!\"\n\n  let (_, clientSpecificOutChan) = networkChans\n  writer &lt;- forkIO $ forever $ do\n    outMsg &lt;- readChan outClientChan\n    writeChan clientSpecificOutChan (clientId, outMsg)\n\n  clientInternalChan &lt;- dupChan internalChan\n\n  -- otherwise gameready msg for this second client joining is lost.\n  atomically $ writeTChan serverChan $ PlayerReady clientId\n\n  -- block on ready-signal from server-thread to start the game.\n  signal &lt;- readChan clientInternalChan\n  case signal of\n    GameReadySignal config players -&gt; writeChan outClientChan $ GameReady config players\n\n  writeList2Chan outClientChan [ ServerMsg \"Here.. you go!!!\"\n                               , ServerMsg \"Movements: type L for left , R for right, Q for quit... enjoy.\" ]\n\n  -- todo: for this functionality we would need to use TChan for userChan/inChan\n  -- hFlush clientHdl\n\n  fix $ \\loop -&gt;\n    do\n      msg &lt;- readChan inChan\n      case msg of\n        PlayerExit _ -&gt; void $ writeChan outClientChan $ ServerMsg \"Sayonara !!!\"\n        _ -&gt; atomically (writeTChan serverChan msg) &gt;&gt; loop\n\n  killThread writer\n\n  atomically $ writeTChan serverChan (PlayerExit clientId)\n</code></pre>\n\n<p>As you can see, users are in MVar.. (TVar does not matter as only one thread writes). The problem is testing. </p>\n\n<p>How can i structure my code such that <code>workflow logic</code> in <code>runClient</code> and <code>playClient</code> can be separated for testing ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 5, "creation_date": 1477269613, "post_id": 40209169, "comment_id": 67682858, "body": "<code>maximize f x y = maximumBy (comparing f) [x,y]</code>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 5, "creation_date": 1477270544, "post_id": 40209169, "comment_id": 67683024, "body": "Note that the <code>Eq a</code> constraint doesn&#39;t do anything useful for you. You don&#39;t need to check if the arguments are equal, all you need to compare is the results, so you might as well omit that constraint. You could however make it also polymorphic on the <i>result</i> of the function, and then you&#39;d need such a constraint there \u2013 but <code>Eq</code> is not enough, you&#39;d need <code>Ord b =&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; a</code>."}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1477477789, "post_id": 40209169, "comment_id": 67780473, "body": "Where are we on this question ? did you receive your answer ?"}, {"owner": {"reputation": 23, "user_id": 7062034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eed4bf80c5af01d541658ffc5ab451d?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah.S", "link": "https://stackoverflow.com/users/7062034/sarah-s"}, "edited": false, "score": 0, "creation_date": 1478116631, "post_id": 40209169, "comment_id": 68029040, "body": "I did, thank you! Managed to get the function working"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1477293582, "post_id": 40209345, "comment_id": 67689394, "body": "<code>comparing = (compare `on`)</code>, a pattern that can be used much more generally."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 6, "last_activity_date": 1477270728, "last_edit_date": 1477270728, "creation_date": 1477270380, "answer_id": 40209345, "question_id": 40209169, "link": "https://stackoverflow.com/questions/40209169/maximizing-according-to-a-function/40209345#40209345", "title": "Maximizing according to a function", "body": "<p>Your problem is that <code>max (f x) (f y)</code> gives back either <code>f x</code> or <code>f y</code>, as opposed to either <code>x</code> or <code>y</code>. You have to compare the former pair of values and then return one of the latter. One way of doing that is using <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:compare\" rel=\"nofollow\"><code>compare</code></a> and then pattern matching on its result, like this:</p>\n\n<pre><code>-- You don't actually need the `Eq a` constraint here.\nmaximize :: (a -&gt; Int) -&gt; a -&gt; a -&gt; a\nmaximize f x y = case compare (f x) (f y) of\n    -- etc. (I will let you fill in the details.)\n</code></pre>\n\n<p>One shortcut for writing that is using <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Ord.html#v:comparing\" rel=\"nofollow\"><code>comparing</code></a> from <code>Data.Ord</code>, which allows you to replace <code>compare (f x) (f y)</code> with <code>comparing f x y</code>. A further shortcut, suggested above by user2407038, uses <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:maximumBy\" rel=\"nofollow\"><code>maximumBy</code></a> from <code>Data.List</code> to reduce it all to the one-liner <code>maximumBy (comparing f) [x,y]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1477333205, "post_id": 40224628, "comment_id": 67713341, "body": "Nice one. This is, of course, exactly equivalent to the <code>compare</code> solution, given that <code>(&gt;)</code> can be expressed in terms of a case analysis of the result of <code>compare</code> and that if-then-else is just syntax sugar over case analysis on <code>Bool</code> -- and yet this way of writing it might look a little more intuitive to an absolute beginner. That no one else had event mentioned it yet shows how much instinctive bias against if-then-else there is around here :)"}], "tags": [], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "is_accepted": false, "score": 6, "last_activity_date": 1477332458, "last_edit_date": 1477332458, "creation_date": 1477332001, "answer_id": 40224628, "question_id": 40209169, "link": "https://stackoverflow.com/questions/40209169/maximizing-according-to-a-function/40224628#40224628", "title": "Maximizing according to a function", "body": "<p>How about the straightforward implementation:</p>\n\n<pre><code>maximize f x y = if (f x) &gt; (f y) then x else y\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "is_accepted": false, "score": 1, "last_activity_date": 1477418822, "last_edit_date": 1477418822, "creation_date": 1477348617, "answer_id": 40228663, "question_id": 40209169, "link": "https://stackoverflow.com/questions/40209169/maximizing-according-to-a-function/40228663#40228663", "title": "Maximizing according to a function", "body": "<p>Another option is</p>\n\n<pre><code>maximize f x y = argmax f [x,y]\n</code></pre>\n\n<p>but this requires installing the <a href=\"https://hackage.haskell.org/package/list-extras-0.4.1.4/docs/Data-List-Extras-Argmax.html\" rel=\"nofollow\">list-extras package</a>. </p>\n\n<p>However, I think the other answers are more idiomatic (@duplode) and simpler (@Uri Goren). </p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1479084908, "post_id": 40578355, "comment_id": 68396697, "body": "The <code>Ord a</code> constraint is redundant. Use <code>Ord b</code> and <code>a -&gt; b</code> as leftaroundabout suggests."}], "tags": [], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "is_accepted": false, "score": 0, "last_activity_date": 1479085586, "last_edit_date": 1479085586, "creation_date": 1479068196, "answer_id": 40578355, "question_id": 40209169, "link": "https://stackoverflow.com/questions/40209169/maximizing-according-to-a-function/40578355#40578355", "title": "Maximizing according to a function", "body": "<p>A different, yet very simple, approach using guards:</p>\n\n<pre><code>maxiM :: (Ord b) =&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; a\nmaxiM func v1 v2\n  | (func v1) &lt; (func v2)       = (func v2)\n  | otherwise                   = (func v1)\n</code></pre>\n\n<p>I suggest looking at learnyouahaskell.</p>\n"}], "owner": {"reputation": 23, "user_id": 7062034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eed4bf80c5af01d541658ffc5ab451d?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah.S", "link": "https://stackoverflow.com/users/7062034/sarah-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 1, "answer_count": 4, "score": 2, "last_activity_date": 1479085586, "creation_date": 1477268755, "last_edit_date": 1477347602, "question_id": 40209169, "link": "https://stackoverflow.com/questions/40209169/maximizing-according-to-a-function", "title": "Maximizing according to a function", "body": "<p>I am trying to write a function that accepts a function and two inputs, and returns the argument that maximizes the function. This is the setup I want to use:</p>\n\n<pre><code>max :: Eq a =&gt; (a -&gt; Int) -&gt; a -&gt; a -&gt; a \n</code></pre>\n\n<p>For example, the function should work as follows:</p>\n\n<pre><code>maximize (+3) 5 10 = 10\n</code></pre>\n\n<p>Because (3+5) &lt; (3+10)</p>\n\n<p>I am thinking I need to do something like this:</p>\n\n<pre><code>maximize :: Eq a =&gt; (a -&gt; Int) -&gt; a -&gt; a -&gt; a\nmaximize f x y = max (f x) (f y)\n</code></pre>\n\n<p>This approach doesn't seem to be working though. Thank you for any help!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1477260130, "post_id": 40208225, "comment_id": 67680990, "body": "Nitpick: In the first paragraph, I guess you mean shortest, as opposed to &quot;longest&quot;?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477260287, "post_id": 40208225, "comment_id": 67681020, "body": "Also: What is <code>Str</code>? If <code>Str a</code> is just a synonym for <code>[a]</code>, you probably should drop it and just write <code>[a]</code>."}, {"owner": {"reputation": 29, "user_id": 6908903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ce6a8bf87ee04a52f226e670755797?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/6908903/curious"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477260392, "post_id": 40208225, "comment_id": 67681048, "body": "Right, I corrected it to &quot;shortest&quot; and changed it to [a]"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477261516, "post_id": 40208225, "comment_id": 67681339, "body": "You accidentally replaced it with <code>a</code>, so I changed it to <code>[a]</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6908903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ce6a8bf87ee04a52f226e670755797?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/6908903/curious"}, "edited": false, "score": 1, "creation_date": 1477261852, "post_id": 40208390, "comment_id": 67681429, "body": "Thank you so much! This really helps. This solution is ultimately what I wanted this function to do"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477264650, "post_id": 40208390, "comment_id": 67681958, "body": "This is simply wrong - even with a correct <code>overlap</code> function. Consider the expression <code>foldr overlap [] [&quot;aaab&quot;,&quot;xaaa&quot;,&quot;aaax&quot;]</code>. Clearly we have the following: <code>&quot;aaab&quot; + (&quot;xaaa&quot; + &quot;aaax&quot;) = &quot;aaab&quot; + &quot;xaaax&quot; = &quot;aaabxaaax&quot;</code> (or <code>&quot;xaaaxaaab&quot;</code>!!). A simple fold cannot see that <code>&quot;aaaxaaa&quot;</code> is longer than <code>&quot;xaaax&quot;</code> but allows you to make a shorter final string by combing the first two that way. <code>foldl overlap [][&quot;aaab&quot;,&quot;xaaa&quot;,&quot;aaax&quot;] = &quot;aaaxaaab&quot;</code> , a shorter string containing all the input strings."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477265567, "post_id": 40208390, "comment_id": 67682145, "body": "@user2407038 This is the same limitation I hinted at with the <code>superstring [&quot;fire&quot;, &quot;red&quot;, &quot;blue&quot;, &quot;ire&quot;]</code> example at the end of the answer -- a simple fold cannot rearrange the strings to find the order which gives the most overlaps. Given the reaction of the OP, it might be the case that their requirements are in fact less stringent than what the question says. (By the way, <code>overlap</code> is associative, and so as far as the result string is concerned it doesn&#39;t matter whether you use <code>foldr</code> or <code>foldl</code>.)"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477265612, "post_id": 40208390, "comment_id": 67682151, "body": "@user2407038 I suppose author of question wanted just overlap of neighbor elements. Of course, if you want general version of Shortest Superstring to work on your example as you described, you need to implement much difficult algorithm which involves graphs and solution of NP-hard Traveling salesman problem."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 2, "last_activity_date": 1477261412, "creation_date": 1477261412, "answer_id": 40208390, "question_id": 40208225, "link": "https://stackoverflow.com/questions/40208225/concatenating-a-list-of-strings-while-removing-overlaps/40208390#40208390", "title": "Concatenating a list of strings while removing overlaps", "body": "<p>To begin with, let's assume your <code>overlap</code> function does what you expect. That being so, there is a handful of small issues to deal with. Firstly, if you want <code>superstring</code> to deal with all kinds of lists and not just <code>String</code> and so give it type...</p>\n\n<pre><code>superstring :: Eq a =&gt; [[a]] -&gt; [a]\n</code></pre>\n\n<p>... then you can't use <code>\"\"</code> in its implementation:</p>\n\n<pre><code>GHCi&gt; :t \"\"\n\"\" :: [Char]\n</code></pre>\n\n<p>Just write <code>[]</code> instead. Secondly, the binary operation you use for folding should combine the next element of the list (<code>x</code>) with the accumulated value (<code>acc</code>), as opposed to the input list (<code>xs</code>). Applying both changes, <code>superstring</code> becomes:</p>\n\n<pre><code>superstring :: Eq a =&gt; [[a]] -&gt; [a]\nsuperstring xs = foldr (\\x acc -&gt; x `overlap` acc) [] xs\n</code></pre>\n\n<p>Or, even less verbosely:</p>\n\n<pre><code>superstring :: Eq a =&gt; [[a]] -&gt; [a]\nsuperstring xs = foldr overlap [] xs\n</code></pre>\n\n<p>Thirdly, note that the argument to <code>superstring</code> is a list of lists. Making it a function that takes a variable number of arguments, as you suggest in your usage example...</p>\n\n<pre><code>superstring \"fire\" \"red\" \"blue\"\n</code></pre>\n\n<p>... requires a few rather complicated tricks you probably don't want to bother with right now, so I suggest you just leave it at that:</p>\n\n<pre><code>GHCi&gt; superstring [\"fire\", \"red\", \"blue\"]\n\"firedblue\"\n</code></pre>\n\n<p>Finally, all of what I wrote above assumes that <code>overlap</code> does what it says on the tin and that the <code>superstring</code> you want to write can be expressed as a straightforward fold. Ultimately it's up to you and your requirements, but I'm not entirely sure that is the case. For instance, consider what happens if you try:</p>\n\n<pre><code>superstring [\"fire\", \"red\", \"blue\", \"ire\"]\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6908903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ce6a8bf87ee04a52f226e670755797?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/6908903/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1477261494, "creation_date": 1477260038, "last_edit_date": 1477261494, "question_id": 40208225, "link": "https://stackoverflow.com/questions/40208225/concatenating-a-list-of-strings-while-removing-overlaps", "title": "Concatenating a list of strings while removing overlaps", "body": "<p>I'm having trouble figuring out this code. I want to create a function that takes a list of strings as input and returns the shortest superstring containing all of the strings in the list. For example, </p>\n\n<pre><code>    superstring \"fire\" \"red\" \"blue\" = \"firedblue\",\n</code></pre>\n\n<p>because the \"re\" overlaps in \"fire\" and \"red\".</p>\n\n<p>I am using a helper function \"overlap\" to assist in this function:</p>\n\n<pre><code>    overlap :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\n    x `overlap` y = prefix ++ y\n        where (prefix, _) : _ = filter (\\(_, match) -&gt; match `isPrefixOf` y) $ zip (inits x) (tails x)\n</code></pre>\n\n<p>The helper function above combines strings in the following way:</p>\n\n<pre><code>    overlap \"fire\" \"red\" = \"fired\"\n</code></pre>\n\n<p>I want to use \"foldr\" and my function \"overlap\" in creating my superstring, but I'm not sure how to implement it. So far I have:</p>\n\n<pre><code>    superstring :: Eq a =&gt; [[a]] -&gt; [a]\n    superstring xs = foldr (\\x acc -&gt; x `overlap` xs) \"\" xs \n</code></pre>\n\n<p>I'm not exactly sure how to implement the foldr function to work in this case, so any help would be appreciated! Thanks!</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "edited": false, "score": 0, "creation_date": 1477255877, "post_id": 40207603, "comment_id": 67679863, "body": "If I want to remove all occurrences then what should I do?"}, {"owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "edited": false, "score": 0, "creation_date": 1477255942, "post_id": 40207603, "comment_id": 67679881, "body": "just asking out of curiosity.But thank you for your answer."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1477257079, "last_edit_date": 1477257079, "creation_date": 1477255417, "answer_id": 40207603, "question_id": 40207570, "link": "https://stackoverflow.com/questions/40207570/remove-the-element-from-list/40207603#40207603", "title": "remove the element from list", "body": "<p><code>makeList</code> is a regular function, not a data constructor, so you can't pattern match on it. You need to pattern match on <code>Cons</code> and <code>Nil</code>; the fact that the list was returned by <code>makeList</code> isn't relevant.</p>\n\n<pre><code>removeList :: Eq a =&gt; a -&gt; List a -&gt; List a\nremoveList _ Nil = Nil\nremoveList x (Cons y ys) | x == y = ys -- Don't recurse if you only want to remove the *first* occurrence.\n                         | otherwise = Cons y (removeList x ys)\n</code></pre>\n\n<p>You can work directly with your <code>List</code> type; there is no need to build the result as a built-in list then convert it again.</p>\n\n<p>Compare to the same function implemented on built-in lists, with the type constructor <code>[]</code> and the data constructor <code>(:)</code> used in prefix position rather than infix position.</p>\n\n<pre><code>removeList' :: Eq a =&gt; a -&gt; [] a -&gt; [] a\nremoveList' _ [] = []\nremoveList' x ((:) y ys) | x == y = ys\n                         | otherwise = (:) y (removeList' x ys)\n</code></pre>\n\n<hr>\n\n<p>Just for fun, let's generalize this code so that it can be used as the basis for both <code>removeFirst</code> and <code>removeAll</code>:</p>\n\n<pre><code>removeGeneric :: Eq a =&gt; (List a -&gt; List a) -&gt; a -&gt; List a -&gt; List a\nremoveGeneric _ _ Nil = Nil\nremoveGeneric f x (Cons y ys) | x == y = f y ys\n                              | otherwise = Cons y (removeGeneric f x ys)\n\nremoveFirst = removeGeneric (\\y ys -&gt; ys)\nremoveAll = removeGeneric removeAll\n</code></pre>\n\n<p>The first argument to <code>removeGeneric</code> is the function you call on the list the first time you find a match. To remove the first occurrence, you just call the equivalent of <code>tail</code>. To remove <em>all</em> occurrences, you recurse.</p>\n"}], "owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 40207603, "answer_count": 1, "score": 1, "last_activity_date": 1477872936, "creation_date": 1477255156, "last_edit_date": 1477872936, "question_id": 40207570, "link": "https://stackoverflow.com/questions/40207570/remove-the-element-from-list", "title": "remove the element from list", "body": "<p>I will have to create a recursive function called removeList.Can anyone help me?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 480, "user_id": 1784111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lMlfA.png?s=128&g=1", "display_name": "monk", "link": "https://stackoverflow.com/users/1784111/monk"}, "edited": false, "score": 0, "creation_date": 1477646684, "post_id": 40206135, "comment_id": 67861323, "body": "Which OS does it have? Did you check <a href=\"https://docs.haskellstack.org/en/stable/install_and_upgrade/\" rel=\"nofollow noreferrer\">docs.haskellstack.org/en/stable/install_and_upgrade</a>? Assuming linux, try the <b>Linux</b> section."}], "answers": [{"tags": [], "owner": {"reputation": 899, "user_id": 6910701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tAQFK.jpg?s=128&g=1", "display_name": "Aditya C", "link": "https://stackoverflow.com/users/6910701/aditya-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1478180807, "last_edit_date": 1492086984, "creation_date": 1478109125, "answer_id": 40386583, "question_id": 40206135, "link": "https://stackoverflow.com/questions/40206135/how-do-i-install-haskell-stack-locally/40386583#40386583", "title": "How do I install Haskell Stack locally?", "body": "<p>The Haskell stack is successfully installed using the instructions in <a href=\"https://docs.haskellstack.org/en/stable/install_and_upgrade/#linux\" rel=\"nofollow noreferrer\">Documentation here</a>.</p>\n\n<p>As the case with \"sudo user\", the command <code>sudo</code> grants a user with super user privileges by flipping the <code>mode bit</code>. The details regarding the mechanism can be found <a href=\"https://unix.stackexchange.com/questions/80344/how-do-the-internals-of-sudo-work\">here</a>. </p>\n\n<p>The <strong>problem</strong> in your case might be the reason that in \"<strong>School Networks</strong>\", <strong>users are restricted to use <code>sudo</code></strong> for security purposes and hence, either the administrators must grant your account privileges or they must install the Haskell stack themselves. If this is a part of an assignment, adminstrators should have no problem doing so and <strong>you must inform administrators</strong> regarding this. Thereafter, <strong>you must be able to use it comfortably</strong>. </p>\n\n<p>If the above steps are not possible, I would suggest you to try out Haskell stack in your <strong>personalized account</strong> on a device. You may even try out <strong>Cloud services like Cloud9, Nitrous</strong> and others. An unlikely reason might be that you are not using the Haskell stack properly.</p>\n\n<p><strong>Note</strong>: I have used the Haskell stack for some time, hence, I can conclude that it works. </p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1586727072, "last_edit_date": 1586727072, "creation_date": 1479736850, "answer_id": 40721992, "question_id": 40206135, "link": "https://stackoverflow.com/questions/40206135/how-do-i-install-haskell-stack-locally/40721992#40721992", "title": "How do I install Haskell Stack locally?", "body": "<p>You don't need superuser privileges to install stack; you can as well install it in your own home directory. All you need for this to work is a Linux system with <a href=\"https://gmplib.org/\" rel=\"nofollow noreferrer\">GMP</a> installed (which GHC depends on at a very fundamental level). If GMP is not installed \u2013 the admins really shouldn't have any concerns installing that. (Alternatively, follow <a href=\"https://unix.stackexchange.com/questions/265239/how-to-install-a-custom-gmp-lib-for-just-one-user\">these instructions</a> to install GMP without root permissions.)</p>\n\n<pre><code>#!/bin/bash\n\n# Stack installation script, adapted from:\n# https://github.com/yantonov/install-ghc/blob/af0b968b9e8423efb152ccec4224821e29317710/ubuntu/install-ghc-ubuntu.md\n\nDOWNLOADS_DIR=$HOME/Downloads\nSTACK_INSTALL_DIR=\"$HOME/Development/bin\"\nmkdir -p ${STACK_INSTALL_DIR}\nSTACK_VERSION=\"2.1.3\"  \nSTACK_ARCHITECTURE=\"x86_64\"  \nSTACK_PLATFORM=\"linux\"  \n\n# Check that libgmp is installed. This is the main critical system-level\n# dependency of the Haskell environment that may not be present.\n\nfunction check_lib()\n{\n    echo \"int main(){}\" | gcc -o /dev/null -lgmp -x c -\n    return $?\n}\n\nGMP_OK=false\nif (ldconfig -p | grep -q \"libgmp.so.10\"); then\n    GMP_VERSION_POSTFIX=\"\"\n    if (check_lib -lgmp); then GMP_OK=true; fi\nelif (ldconfig -p | grep -q \"libgmpxx.so.4\"); then\n    GMP_VERSION_POSTFIX=\"-gmp4\"\n    if (check_lib -lgmp); then GMP_OK=true; fi\nfi\n\n\nif [ $GMP_OK = false ]; then\n    echo &gt;&amp;2 \"Haskell requires the GNU multi-precision library (with headers)\"\n    echo &gt;&amp;2 \"in version 4 or 10, but neither can be found. Try\"\n    echo &gt;&amp;2\n    echo &gt;&amp;2 \"$ sudo apt-get install libgmp-dev\"\n    echo &gt;&amp;2\n    echo &gt;&amp;2 \"or https://unix.stackexchange.com/questions/265239/how-to-install-a-custom-gmp-lib-for-just-one-user\"\n    echo &gt;&amp;2\n    exit 1\nfi\n\nSTACK_DIST_FILENAME=\"stack-$STACK_VERSION-$STACK_PLATFORM-$STACK_ARCHITECTURE.tar.gz\"  \nSTACK_DIST_UNZIPPED_DIR=\"stack-$STACK_VERSION-$STACK_PLATFORM-$STACK_ARCHITECTURE\"\nSTACK_DIST_URL=\"https://www.stackage.org/stack/$STACK_PLATFORM-$STACK_ARCHITECTURE\"\nSTACK_TARGET_DIR=\"stack-$STACK_VERSION\"\n\ncd $DOWNLOADS_DIR\n\ncurl -L -o $STACK_DIST_FILENAME $STACK_DIST_URL  \ntar xvfz $STACK_DIST_FILENAME\n\n# in case if error like this: \n#curl: (77) error setting certificate verify locations: CAfile: \n# /etc/pki/tls/certs/ca-bundle.crt CApath: \n# ...\n# create ~/.curlrc file\n# and put this lines to it\n# capath=/etc/ssl/certs/\n# cacert=/etc/ssl/certs/ca-certificates.crt\n\n# move to home development dir  \nrm -rf $STACK_INSTALL_DIR/$STACK_TARGET_DIR  \nmv $STACK_DIST_UNZIPPED_DIR $STACK_INSTALL_DIR/$STACK_TARGET_DIR\n\ncd $STACK_INSTALL_DIR  \n\n# sym link\nrm -rvi stack  \nln -s `pwd`/$STACK_TARGET_DIR stack  \n\n# add to PATH environment  \nSTACK_HOME=$HOME/Development/bin/stack  \nPATH=$STACK_HOME:$PATH\n\n# clean up\ncd $DOWNLOADS_DIR\nrm -rf stack-$STACK_VERSION*\n\n# install ghc\nstack setup\n</code></pre>\n"}], "owner": {"reputation": 1071, "user_id": 1499723, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f839d5da21126e4f14b6518501b1b009?s=128&d=identicon&r=PG", "display_name": "Sugihara", "link": "https://stackoverflow.com/users/1499723/sugihara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 2, "answer_count": 2, "score": 5, "last_activity_date": 1586727072, "creation_date": 1477245646, "last_edit_date": 1479947074, "question_id": 40206135, "link": "https://stackoverflow.com/questions/40206135/how-do-i-install-haskell-stack-locally", "title": "How do I install Haskell Stack locally?", "body": "<p>I am working on my school server and I need to install Haskell's stack. In the <a href=\"https://github.com/commercialhaskell/stack/blob/master/README.md\" rel=\"nofollow\">README</a> file and on the <a href=\"https://docs.haskellstack.org/en/stable/faq/\" rel=\"nofollow\">website</a> I could not find how to install locally. What can I do if I am not a sudo user?</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 6432251, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/06267b11c475261a6c02ee68210807a4?s=128&d=identicon&r=PG&f=1", "display_name": "bfieck", "link": "https://stackoverflow.com/users/6432251/bfieck"}, "edited": false, "score": 0, "creation_date": 1477245650, "post_id": 40206047, "comment_id": 67676588, "body": "So does tabs/spaces not matter? Also: maaaan, I tried that but with <code>Floating</code> instead of <code>Fractional</code> and it just threw up at me. Anyway, thanks for the speedy response."}, {"owner": {"reputation": 9485, "user_id": 20371, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32c7a412ad0caf812ae974df5eb8ffcd?s=128&d=identicon&r=PG", "display_name": "Yawar", "link": "https://stackoverflow.com/users/20371/yawar"}, "reply_to_user": {"reputation": 711, "user_id": 6432251, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/06267b11c475261a6c02ee68210807a4?s=128&d=identicon&r=PG&f=1", "display_name": "bfieck", "link": "https://stackoverflow.com/users/6432251/bfieck"}, "edited": false, "score": 5, "creation_date": 1477245893, "post_id": 40206047, "comment_id": 67676661, "body": "@bfieck please don&#39;t use tabs. Use two spaces per indent. Everyone will be much happier with you :-)"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 711, "user_id": 6432251, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/06267b11c475261a6c02ee68210807a4?s=128&d=identicon&r=PG&f=1", "display_name": "bfieck", "link": "https://stackoverflow.com/users/6432251/bfieck"}, "edited": false, "score": 1, "creation_date": 1477246044, "post_id": 40206047, "comment_id": 67676716, "body": "@bfieck Tabs are not a good way of indenting code for indentation-sensitive languages. There&#39;s <i>plenty</i> of people that have trouble with some error due to that because mixing tabs and spaces when using tab indentation is extremely easy and catastrophic. Also: the compiler considers a tab as 8 spaces, but your editor probably consider it as either 2 or 4, which means what you see in the editor is probably not what the compiler sees which increases the chances of errors. There was even a proposal to completely disallow tabs for indentation in Haskell."}, {"owner": {"reputation": 711, "user_id": 6432251, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/06267b11c475261a6c02ee68210807a4?s=128&d=identicon&r=PG&f=1", "display_name": "bfieck", "link": "https://stackoverflow.com/users/6432251/bfieck"}, "edited": false, "score": 0, "creation_date": 1477248334, "post_id": 40206047, "comment_id": 67677448, "body": "Why would the compiler turn tabs into sequences of spaces? Imo, tabs are inherently superior for indentation. If you like two-space indents, you can set your editor to render them as such; everyone can have their own, preferred layout without causing any physical differences in the files. Obviously that doesn&#39;t work for haskell, cuz the assignments have to be aligned, but if you ask me, haskell just shouldn&#39;t enforce a style guide as part of the language specification."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1477248902, "post_id": 40206047, "comment_id": 67677637, "body": "The use of tabs is discouraged precisely <i>because</i> Haskell does not enforce any particular amount of indentation at any level. Because tabs could be displayed as different amounts of whitespace by different users, the <i>apparent</i> indentation may differ from the <i>actual</i> indentation."}, {"owner": {"reputation": 711, "user_id": 6432251, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/06267b11c475261a6c02ee68210807a4?s=128&d=identicon&r=PG&f=1", "display_name": "bfieck", "link": "https://stackoverflow.com/users/6432251/bfieck"}, "edited": false, "score": 0, "creation_date": 1477249407, "post_id": 40206047, "comment_id": 67677790, "body": "No I get that, but it seems like if you just parse tab characters instead of turning them into spaces, and be a little more stringent about the placement of assignments relative to scoping keywords, the problem disappears. Just read the actual file instead of turning into something other than what I typed."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 711, "user_id": 6432251, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/06267b11c475261a6c02ee68210807a4?s=128&d=identicon&r=PG&f=1", "display_name": "bfieck", "link": "https://stackoverflow.com/users/6432251/bfieck"}, "edited": false, "score": 2, "creation_date": 1477250989, "post_id": 40206047, "comment_id": 67678332, "body": "@bfieck When one mixes tab and spaces, in most editors it is easy to look at code which seems to be properly indented, when it&#39;s not. Historically, the Haskell 98 committee decided that tabs count as 8 spaces when checking indentation. A more stringent requirement would have been better. Today, GHC warns you if you use tabs. There are <a href=\"http://dmwit.com/tabs/\" rel=\"nofollow noreferrer\">good proposals</a> but most of the community decided that avoiding tabs is simpler in the long run."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1477251420, "post_id": 40206047, "comment_id": 67678487, "body": "Using <i>only</i> tabs would be worse, because now my indentation has to be indented by the same amount at each level, with no regard to the construct that initiated the indentation. The second and following lines of a <code>let</code> expression are often indented 4 spaces, while those of a <code>where</code> expression are indented by 6 spaces. Many people align type signatures with one type per line, with the indentation specified by the length of the function name; similar logic is applied to data types defined with record syntax. No fixed tab size will accommodate that style."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1477312033, "post_id": 40206047, "comment_id": 67700103, "body": "Tabs work for <i>indent levels</i>. They work great as long as you <i>only</i> use tabs for indentation, never mixing with spaces. But as soon as you start trying to line things up (such as indent to opening parenthesis) then <i>correct</i> indentation <i>requires</i> mixing tabs and spaces. They&#39;re just a bad idea IMHO even in C or python like syntax; why do we need the ability for each user to independently customise one tiny part of code style when everything else has to be agreed? And Haskell doesn&#39;t use indent levels, it uses alignment, so there&#39;s no getting away from needing a tab/space exchange rate."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 6, "last_activity_date": 1477245507, "last_edit_date": 1477245507, "creation_date": 1477245136, "answer_id": 40206047, "question_id": 40206012, "link": "https://stackoverflow.com/questions/40206012/type-specification-in-a-where-clause/40206047#40206047", "title": "Type Specification in a Where Clause", "body": "<p>Your last example is correct, but the type you wrote doesn't make sense. <code>Num</code> is a <strong>class constraint</strong> not a type. You probably wanted to write:</p>\n\n<pre><code>calcTriangleAreas xs = [triArea x | x&lt;-xs]\n    where triArea:: Num a =&gt; (a, a) -&gt; a\n          triArea (base, height) = base*height/2 \n</code></pre>\n\n<p>The rule is: assignments must be aligned.</p>\n\n<p>Moreover <code>(/)</code> requires the <code>Fractional</code> class:</p>\n\n<pre><code>calcTriangleAreas xs = [triArea x | x&lt;-xs]\n    where triArea:: Fractional a =&gt; (a, a) -&gt; a\n          triArea (base, height) = base*height/2 \n</code></pre>\n\n<hr>\n\n<p>Note that the indentation level is <strong>not</strong> related in any way with the indentation level of the <code>where</code>. For example you could write that code in this way:</p>\n\n<pre><code>calcTriangleAreas xs = [triArea x | x&lt;-xs] where\n    triArea:: Fractional a =&gt; (a, a) -&gt; a\n    triArea (base, height) = base*height/2 \n</code></pre>\n\n<p>The indentation level is defined by the first assignment in a <code>where</code>/<code>let</code> or the first line of a <code>do</code> block. All the other lines must align with that one.</p>\n\n<p>So all of these are correct:</p>\n\n<pre><code>f x = y where\n  a = b\n  y = ...\n\nf x = y\n  where a = b\n        y = ...\n\nf x = y\n  where\n    a = b\n    y = ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1477300597, "creation_date": 1477300597, "answer_id": 40214725, "question_id": 40206012, "link": "https://stackoverflow.com/questions/40206012/type-specification-in-a-where-clause/40214725#40214725", "title": "Type Specification in a Where Clause", "body": "<blockquote>\n  <p>spitting out the utterly incomprehensible error message:</p>\n\n<pre><code>Expecting one more argument to \u2018Num\u2019\n   The first argument of a tuple should have kind \u2018*\u2019,\n     but \u2018Num\u2019 has kind \u2018* -&gt; GHC.Prim.Constraint\u2019\n</code></pre>\n</blockquote>\n\n<p>To complement Bakuriu's answer, let me decode that for you.</p>\n\n<p>The error says that -- line by line:</p>\n\n<ul>\n<li><code>Num</code> is expecting one more argument -- we should write <code>Num a</code> from some <code>a</code></li>\n<li>A tuple type such as <code>(,)</code> expects a type as argument. The statement \"should have kind <code>*</code>\" means \"should be a type\". The kinding system of Haskell associates <code>*</code> as the \"kind of types\". We have e.g. <code>Int :: *</code>, <code>String :: *</code>, and <code>(Maybe Char, [Int]) :: *</code>. Unary type constructors such as <code>Maybe</code> and <code>[]</code> are not types, but functions from types to types. We write <code>Maybe :: *-&gt;*</code> and <code>[] :: *-&gt;*</code>. Their kind <code>*-&gt;*</code> makes it possible to state that, since <code>Maybe :: *-&gt;*</code> and <code>Char :: *</code>, we have <code>Maybe Char :: *</code> (\"is a type\") similarly to ordinary value-level functions. The pair type constructor has kind <code>(,) :: *-&gt;*-&gt;*</code>: it expects two types and provides a type.</li>\n<li><code>Num</code> has kind <code>*-&gt; Constraint</code>. This means that, for every type <code>T</code>, the kind of <code>Num T</code> will be <code>Constraint</code>, which is not <code>*</code> as <code>(,)</code> expects. This triggers a kind error. The kind <code>Constraint</code> is given to typeclass constraints such as <code>Eq Int</code>, <code>Ord Bool</code>, or <code>Num Int</code>. These are not types, but are requirements on types. When we use <code>(+) :: Num a =&gt; a-&gt;a-&gt;a</code> we see that <code>(+)</code> works on any type <code>a</code>, as long as that type satisfies <code>Num a</code>, i.e. is numeric. Since <code>Num T</code> is not a type, we can not write <code>Maybe (Num T)</code> or <code>[Num T]</code>, we can only write e.g. <code>Maybe a</code> and require in the context that <code>a</code> belongs to typeclass <code>Num</code>.</li>\n</ul>\n"}], "owner": {"reputation": 711, "user_id": 6432251, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/06267b11c475261a6c02ee68210807a4?s=128&d=identicon&r=PG&f=1", "display_name": "bfieck", "link": "https://stackoverflow.com/users/6432251/bfieck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 40206047, "answer_count": 2, "score": 3, "last_activity_date": 1477300597, "creation_date": 1477244891, "last_edit_date": 1495541203, "question_id": 40206012, "link": "https://stackoverflow.com/questions/40206012/type-specification-in-a-where-clause", "title": "Type Specification in a Where Clause", "body": "<p>I'm trying to do something very simple as part of a homework. All I need to do is write a function that takes in a list of 2-tuples of numbers representing base and height lengths for triangles, and return a list of the areas corresponding to those triangles. One of the requirements is that I do that by defining a function and declaring its type in a <code>where</code> clause. Everything I've tried so far fails to compile, here's what I've got:</p>\n\n<pre><code>calcTriangleAreas xs = [triArea x | x&lt;-xs]\n    where triArea:: (Num, Num) -&gt; Num --this uses 4 preceding spaces \ntriArea (base, height) = base*height/2\n</code></pre>\n\n<p>This fails with the error <code>The type signature for \u2018triArea\u2019 lacks an accompanying binding</code>, which to me sounds like triArea is not defined inside of the where-clause. Okay, so let's indent it to match the <code>where</code>:</p>\n\n<pre><code>calcTriangleAreas xs = [triArea x | x&lt;-xs]\n    where triArea:: (Num, Num) -&gt; Num --this uses 4 preceding spaces \n    triArea (base, height) = base*height/2 --... and so does this\n</code></pre>\n\n<p>This one fails to compile the particularly uninformative error message <code>parse error on input triArea</code>. Just for fun, let's try indenting it a bit more, because idk what else to do:</p>\n\n<pre><code>calcTriangleAreas xs = [triArea x | x&lt;-xs]\n    where triArea:: (Num, Num) -&gt; Num --this uses 4 preceding spaces \n        triArea (base, height) = base*height/2 --this has 8\n</code></pre>\n\n<p>but, no dice, fails with the same <code>parse error</code> message. I tried replacing the spacing in each of these with equivalent, 4-space tabs, but that didn't\nhelp. The first two produce the same errors with tabs as with spaces, but the last one, shown here:</p>\n\n<pre><code>calcTriangleAreas xs = [triArea x | x&lt;-xs]\n    where triArea:: (Num, Num) -&gt; Num --this uses a preceding tab character \n        triArea (base, height) = base*height/2 --this has 2\n</code></pre>\n\n<p>gives the error message</p>\n\n<pre><code>Illegal type signature: \u2018(Num, Num) -&gt; Num triArea (base, height)\u2019\n  Perhaps you intended to use ScopedTypeVariables\nIn a pattern type-signature\n</code></pre>\n\n<p>and I have no idea what that's trying to say, but it seems to be ignoring newlines all of a sudden. I've been reading through \"Learn You a Haskell\", and I'm supposed to be able to do this with the information presented in the first three chapters, but I've scoured those and they never specify the type of a functioned defined in a <code>where</code> clause in those chapters. For the record, their examples seem to be irreverent of spacing, and I copied the style of one of them:</p>\n\n<pre><code>calcTriangleAreas xs = [triArea x | x&lt;-xs]\n    where triArea:: (Num, Num) -&gt; Num --4 preceding spaces\n          triArea (base, height) = base*height/2 --10 preceding spaces\n</code></pre>\n\n<p>but this also failed to compile, spitting out the utterly incomprehensible error message:</p>\n\n<pre><code>Expecting one more argument to \u2018Num\u2019\n    The first argument of a tuple should have kind \u2018*\u2019,\n      but \u2018Num\u2019 has kind \u2018* -&gt; GHC.Prim.Constraint\u2019\n    In the type signature for \u2018triArea\u2019: triArea :: (Num, Num) -&gt; Num\n    In an equation for \u2018calcTriangleAreas\u2019:\n        calcTriangleAreas xs\n          = [triArea x | x &lt;- xs]\n          where\n              triArea :: (Num, Num) -&gt; Num\n              triArea (base, height) = base * height / 2\n</code></pre>\n\n<p>I can't find anything when I google/hoogle it, and I've looked at <a href=\"https://stackoverflow.com/questions/6928884/type-signature-in-a-where-clause\">this question</a>, but not only is it showing haskell far too\nadvanced for me to read, but based on the content I don't believe they're having the same problem as me. I've tried specifying the type of <code>calcTriangleAreas</code>, and I've tried aliasing the types in the specification for <code>triArea</code> to be <code>Floating</code> and frankly I'm at the end of my rope. The top line of my file is <code>module ChapterThree where</code>, but beyond that the code I've shown in every example is the entire file. </p>\n\n<p>I'm working on 32-bit Linux Mint 18, and I'm compiling with <code>ghc ChapterThree.hs Chapter3UnitTests.hs -o Test</code>, where ChapterThree.hs is my file and the unit tests are given by my teacher so I can easily tell if my program works (It never gets to the compilation step for ChapterThreeUnitTests.hs, so I didn't think the content would be important), and my ghc version is 7.10.3.</p>\n\n<p>EDIT: Note that if I just remove the type specification altogether, everything compiles just fine, and that function passes all of its associated unit tests.</p>\n\n<p>Please, save me from my madness.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477236477, "post_id": 40204359, "comment_id": 67673694, "body": "not trying to discourage you, but I&#39;m not sure ByteString et. al. is the easiest place to start learning haskell (<a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">learnyouahaskell.com/chapters</a> is a good start though)...  btw, the documentation of <a href=\"https://hackage.haskell.org/package/binary-0.8.4.1/docs/Data-Binary.html\" rel=\"nofollow noreferrer\">Data.Binary states</a>: <code>Values encoded using the Binary class are always encoded in network order (big endian) </code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477236659, "post_id": 40204359, "comment_id": 67673755, "body": "Also, the return value should be as long as necessary to encode the value of the <code>Integer</code> argument, not necessarily fixed by another argument."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477236782, "post_id": 40204359, "comment_id": 67673790, "body": "&quot; In essence, I would like to replicate the semantics of the python call &quot; - what is the semantics of the python function? You could at least provide a link to the documentation, or better yet state the expected semantics yourself. What should your function do for <code>toBytes (10^10) 1</code>? It can&#39;t possible fit in one byte. Finally, just try to produce a <code>[Word8]</code> and then use <code>pack</code> and worry about performance later (if and when you discover it is insufficient) - this will make reasoning about the semantics of your algorithm easier."}, {"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477238566, "post_id": 40204359, "comment_id": 67674264, "body": "@user2407038 my apologies, I wrongly assumed the signature was enough to infer what the function does. It returns a binary representation (big endian) of the number as an array of bytes of the desired <code>length</code> (which needs to be high enough or else the function will throw). Note that because <code>signed=False</code> my <code>length</code> argument need not accommodate a leading <code>0x00</code> byte to differentiate the encoding with that of a negative number in cases when the leading bit is 1. As <code>length</code> gets larger, more <code>0x00</code> bytes are padded to the left."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1477240699, "post_id": 40204359, "comment_id": 67674913, "body": "@SvenWilliamson Take at a look at the source for <a href=\"http://hackage.haskell.org/package/binary-0.5.0.2/docs/src/Data-Binary.html#unroll\" rel=\"nofollow noreferrer\"><code>Data.Binary</code></a> - it actually contains the function you want (<code>unroll :: Integer -&gt; [Word8]</code>) minus the padding, which should be simple. You can also look at the source (and comments) for <code>instance Binary Integer</code> to see why it behaves as it does."}, {"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477240931, "post_id": 40204359, "comment_id": 67674978, "body": "@user2407038 Thank you very much, will check it out!"}, {"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477408064, "post_id": 40204359, "comment_id": 67749070, "body": "@user2407038 Thank your answer works for me. The key idea behind <code>unroll</code>, is to use <code>fromInteger</code> of instance <code>Num Word8</code> to get the first byte. Then use <code>shiftR</code> of instance <code>Bits Integer</code> and glue everything together with with <code>unfoldr</code>. And yes, I will use <code>pack</code> and <code>unpack</code> for now."}, {"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477408240, "post_id": 40204359, "comment_id": 67749188, "body": "@mb21 Thank you, I will work with <code>[Word8]</code> as suggested elsewhere :)"}, {"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477408417, "post_id": 40204359, "comment_id": 67749315, "body": "@chepner, yes thank you, it is understood that the function should throw if the length argument is too small, while padding of <code>0x00</code> bytes to the left occur if the length argument is large"}, {"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477408875, "post_id": 40204359, "comment_id": 67749664, "body": "@user2407038 needless to say if you were to write an answer I would gladly accept it :)"}, {"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "edited": false, "score": 0, "creation_date": 1477416183, "post_id": 40204359, "comment_id": 67754300, "body": "Actually, I have had to define my own <code>unfold</code> as <code>unfoldr</code> of <code>Data.List</code> leads to the wrong byte ordering"}], "owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 415, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477239460, "creation_date": 1477234890, "last_edit_date": 1495535252, "question_id": 40204359, "link": "https://stackoverflow.com/questions/40204359/unsigned-big-endian-encoding-of-type-integer", "title": "Unsigned Big-endian encoding of type Integer", "body": "<p>I am attempting to follow up on <a href=\"https://stackoverflow.com/questions/2283119/how-to-convert-a-integer-to-a-bytestring-in-haskell\">How to convert a Integer to a ByteString in Haskell</a>. My objective is to create a function <code>toBytes :: Integer -&gt; Int -&gt; ByteString</code> which returns a big-endian encoding of the magnitude of a potentially large <code>Integer</code>. The resulting <code>ByteString</code> (lazy or strict I am not too sure yet) should be of length indicated by the <code>Int</code> argument. In essence, I would like to replicate the semantics of the <code>python</code> call (assuming <code>value</code> is a non-negative integer):</p>\n\n<pre><code>value.to_bytes(numBytes, byteorder='big', signed=False)\n</code></pre>\n\n<p>I do not need to have everything spelt out of course, I am only looking for guidance. For example, I would be very happy to have anything which brings me closer to my end goal with related semantics such <code>java</code>'s <code>toByteArray</code> method on <code>BigInteger</code> (big-endian, two's complement, minimal size) or <code>C#</code>'s <code>ToByteArray</code> on <code>BigInteger</code> (little-endian, two's complement, minimal size). I can take care of endianness, and negative number, and add whatever padding is required...</p>\n\n<p>The post I have indicated recommends packages such as <code>Data.Binary</code> and <code>Data.Serialize</code> but the <code>encode</code> function does not seem to follow a clear encoding standard:</p>\n\n<pre><code>Prelude Data.Binary&gt; encode (0xfffefd :: Integer)\n\"\\NUL\\NUL\\255\\254\\253\" \n\nPrelude Data.Binary&gt; encode (0xfffefdfc :: Integer)\n\"\\SOH\\SOH\\NUL\\NUL\\NUL\\NUL\\NUL\\NUL\\NUL\\EOT\\252\\253\\254\\255\"\n</code></pre>\n\n<p>The type of encoding seems to change as the <code>Integer</code> gets larger, going from big-endian to little-endian for example. So I am wondering, whether it is a wise choice for me to try and build my own function on top of the <code>encode</code> function provided by these packages. I worry my code will rely on implementation details which may be specific to my host endianness and/or package version.</p>\n\n<p>I am only doing this because I want to learn <code>Haskell</code>. So as a simple exercise, I am attempting to create a type with the same API as <code>java</code>'s <code>BigInteger</code> (albeit with a better <code>toByteArray</code>):</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nimport qualified Data.ByteString.Lazy as L\nimport Data.Hashable\n\ntype ByteArray = L.ByteString\nnewtype Sign = Sign Int \nnewtype NumBytes = NumBytes Int \n\n\nnewtype Number = Number Integer\n        deriving (Eq, Ord, Num, Real, Enum, Integral, Hashable)\n\nfromBytes :: Sign   -&gt; ByteArray -&gt; Number\ntoBytes   :: Number -&gt; NumBytes  -&gt; ByteArray\n</code></pre>\n\n<p>Any guidance is warmly appreciated</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1477232878, "post_id": 40203847, "comment_id": 67672599, "body": "I can see this being done with a recursive function with 2 accumulators: 1 to track how many characters have been processed since the last newline, and 1 to track the remaining words. Then you just iterate over the words, counting the letters in each. If a <code>(length word) - 10 &gt; (length nextWord)</code>, add a new line."}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 3, "creation_date": 1477235902, "post_id": 40203847, "comment_id": 67673503, "body": "what have you tried so far? also: is it guaranteed that no single word is longer than 10 chars?"}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 1, "last_activity_date": 1477250570, "creation_date": 1477250570, "answer_id": 40206911, "question_id": 40203847, "link": "https://stackoverflow.com/questions/40203847/how-to-iterate-through-list-of-strings-and-add-new-line-after-certain-count-of-c/40206911#40206911", "title": "How to iterate through list of strings and add new line after certain count of chars in Haskel?", "body": "<p>Couple edge cases you don't specify in your question</p>\n\n<ul>\n<li>What happens if a word is longer than 10 characters? I'm going to assume that word should go on a line of its own</li>\n<li>Should we count the spaces that go between words? I'm going to assume yes again (even if your example seems to say the contrary).</li>\n</ul>\n\n<p>Here is one such solution. The idea is to start by mapping all words with their lengths. Then, we inspect one word at a time and see if we can add it the current line without overflowing that line.</p>\n\n<pre><code>splitLines :: Int -&gt; [String] -&gt; String\nsplitLines n = helper 0 . map (\\w -&gt; (length w,w))\n  where\n    helper :: Int -&gt; [(Int,String)] -&gt; String\n    helper _ [] = \"\"\n    helper lineLength ((wordLength,word):ws)\n      | lineLength == 0 = word ++ helper wordLength ws\n      | lineLength + wordLength + 1 &gt; n = \"\\n\" ++ word ++ helper wordLength ws\n      | otherwise = \" \" ++ word ++ helper (lineLength + wordLength + 1) words\n</code></pre>\n\n<p>At GHCi:</p>\n\n<pre><code>ghci&gt; splitLines 10 (words \"I am new to Haskell and I really want to learn it\")\n\"I am new\\nto Haskell\\nand I\\nreally\\nwant to\\nlearn it\"\n</code></pre>\n"}], "owner": {"reputation": 1436, "user_id": 3633116, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/776562355754015/picture?type=large", "display_name": "Nikas \u017dalias", "link": "https://stackoverflow.com/users/3633116/nikas-%c5%bdalias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1477250570, "creation_date": 1477231928, "question_id": 40203847, "link": "https://stackoverflow.com/questions/40203847/how-to-iterate-through-list-of-strings-and-add-new-line-after-certain-count-of-c", "title": "How to iterate through list of strings and add new line after certain count of chars in Haskel?", "body": "<p>Hy, I am new to Haskell and was wondering how should I iterate through list of strings and add newline after certain amount of characters?</p>\n\n<p>I've got this kind of list:</p>\n\n<pre><code>list1 = [\"I\", \"am\", \"new\", \"to\", \"Haskell\", \"and\", \"I\", \"really\", \"want\", \"to\", \"learn\", \"it\"]\n</code></pre>\n\n<p>and I want to put newline after 10 or less symbols. </p>\n\n<p>One line can't be with more than 10 symbols, and words can't be split.</p>\n\n<p>The output should look like this:</p>\n\n<p><em>I am new to \\n Haskell and \\n I really \\n want to \\n learn it</em></p>\n\n<p>Any ideas how to do this??</p>\n"}, {"tags": ["haskell", "monads", "continuations", "arrows", "haskell-pipes"], "comments": [{"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 2, "creation_date": 1477279223, "post_id": 40203535, "comment_id": 67684749, "body": "This can be viewed as a free monad if it is rewritten <code>data S req rsp r = Done r | Next req (rsp -&gt; S req rsp r)</code> Then it&#39;s effectively the free monad on the functor <code>Compose ((,) req) ((-&gt;) resp)</code> or <code>data Request req resp r = Request req (resp -&gt; r</code>. It is very common to use a constructor of this type in writing a functor for a free monad, as you can see from some of the examples in <a href=\"http://degoes.net/articles/modern-fp\" rel=\"nofollow noreferrer\">degoes.net/articles/modern-fp</a> Note that all four constructors of his <code>HttpF</code> functor, <code>GET</code>, <code>POST</code> etc,  are effectively of this shape."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 1, "creation_date": 1477279227, "post_id": 40203535, "comment_id": 67684750, "body": "In <code>pipes</code>, the <code>Server</code> (or equivalently <code>Client</code>) type is a (monad transformer) version of it. Then we can write say ` let mkRequest :: Monad m =&gt; req -&gt; Client req resp m resp; mkRequest = request` (Here an underlying monad is presupposed, as if you had applied <code>FreeT</code> rather than <code>Free</code> to the request functor)."}], "answers": [{"comments": [{"owner": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "edited": false, "score": 0, "creation_date": 1477230465, "post_id": 40203570, "comment_id": 67671804, "body": "Yep, now that you say it it&#39;s obvious. I was hoping it would be something with a little more structure though :)"}], "tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": true, "score": 6, "last_activity_date": 1477231119, "last_edit_date": 1477231119, "creation_date": 1477230047, "answer_id": 40203570, "question_id": 40203535, "link": "https://stackoverflow.com/questions/40203535/is-there-a-standard-abstraction-for-this-request-response-type/40203570#40203570", "title": "Is there a standard abstraction for this request-response type?", "body": "<p>It's <a href=\"http://hackage.haskell.org/package/free\">Free Monad</a>. \nThe idea is that you have a description of instructions for which you can have multiple interpreters like your <code>eval</code> function. Free Monad abstracts over the pattern that this task has. For details I recommend <a href=\"http://www.haskellforall.com/2012/06/you-could-have-invented-free-monads.html\">this great post</a>.</p>\n\n<p>To adapt your type to <code>Free</code> we can do the following:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\nimport Control.Monad.Free\n\ndata Instruction req rsp next =\n  Respond rsp |\n  Interact req (rsp -&gt; next)\n  deriving (Functor)\n\ntype S req rsp =\n  Free (Instruction req rsp)\n\nrespond :: rsp -&gt; S req rsp ()\nrespond rsp =\n  liftF (Respond rsp)\n\ninteract :: req -&gt; S req rsp rsp\ninteract req =\n  liftF (Interact req id)\n</code></pre>\n\n<p>Now, thanks to <code>Free</code>, <code>S req rsp</code> is a monad, which means that you can now compose your <code>respond</code> and <code>interact</code> functions using <code>Monad</code> API.</p>\n\n<p>There's more to it. The <code>respond</code> and <code>interact</code> functions could be generated using Template Haskell with the following extra code:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nimport Control.Monad.Free.TH\n\nmakeFree ''Instruction\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 5, "last_activity_date": 1477272573, "last_edit_date": 1477272573, "creation_date": 1477231458, "answer_id": 40203780, "question_id": 40203535, "link": "https://stackoverflow.com/questions/40203535/is-there-a-standard-abstraction-for-this-request-response-type/40203780#40203780", "title": "Is there a standard abstraction for this request-response type?", "body": "<p>Your type looks a little bit like <a href=\"http://apfelmus.nfshost.com/articles/operational-monad.html\" rel=\"nofollow\">Apfelmus's <code>operational</code> monad</a>, also known as <a href=\"http://okmij.org/ftp/Haskell/extensible/more.pdf\" rel=\"nofollow\">the <code>Freer</code> monad</a>:</p>\n\n<pre><code>data Program inst a where\n    Return :: a -&gt; Program inst a\n    Bind :: inst a -&gt; (a -&gt; Program inst b) -&gt; Program inst b\n\ninstance Monad (Program inst) where\n    return = Return\n    Return x &gt;&gt;= f = f x\n    Bind i next &gt;&gt;= f = Bind i (fmap (&gt;&gt;= f) next)\n\n-- plus the usual Functor and Applicative boilerplate\n</code></pre>\n\n<p><code>Program :: (* -&gt; *) -&gt; * -&gt; *</code> represents a sequence of <em>instructions</em> <code>inst</code>, which use their type parameter to indicate the \"return type\" of running that instruction in an interpreter. The <code>Bind</code> constructor takes an instruction and a continuation which can be run after the result of the instruction has been received from the interpreter. Note how <code>a</code> is existentially quantified, reflecting the fact that the types of all the intermediate steps in a computation are not relevant to the overall type.</p>\n\n<p>The important difference between <code>Program</code> and your type is that the type of the response is determined by the instruction, rather than being fixed over the whole computation. This allows us to make more fine-grained guarantees about the response that each request expects to provoke.</p>\n\n<p>For example, here's the state monad written as a <code>Program</code>:</p>\n\n<pre><code>data StateI s r where\n    Get :: StateI s s\n    Put :: s -&gt; StateI s ()\n\ntype State s = Program (StateI s)\n\nget :: State s s\nget = Bind Get Return\nput :: s -&gt; State s ()\nput s = Bind (Put s) Return\n\nmodify :: (s -&gt; s) -&gt; State s ()\nmodify f = do\n    x &lt;- get\n    put (f x)\n\nrunState :: State s a -&gt; s -&gt; (s, a)\nrunState (Return x) s = (s, x)\nrunState (Bind Get next) s = runState (next s) s\nrunState (Bind (Put s) next) _ = runState (next ()) s\n</code></pre>\n\n<p>The co-Yoneda lemma tells us that <code>Program</code> is isomorphic to <code>Free</code>. Intuitively, it's a free monad based on <code>-&gt;</code>'s <code>Functor</code> instance. For certain operations like left-associative binds, <code>Program</code> can be more efficient than <code>Free</code>, because its <code>&gt;&gt;=</code> is based on function composition, rather than possibly-expensively <code>fmap</code>ping an arbitrary <code>Functor</code>.</p>\n"}], "owner": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 1, "accepted_answer_id": 40203570, "answer_count": 2, "score": 3, "last_activity_date": 1477272573, "creation_date": 1477229804, "last_edit_date": 1477256041, "question_id": 40203535, "link": "https://stackoverflow.com/questions/40203535/is-there-a-standard-abstraction-for-this-request-response-type", "title": "Is there a standard abstraction for this request-response type?", "body": "<p>I have the following type:</p>\n\n<pre><code>data S req rsp = Done rsp | Next req (rsp -&gt; S req rsp)\n</code></pre>\n\n<p>The idea is to use it as a pure representation for network communication, i.e:</p>\n\n<pre><code>... Next GetUser $ \\uid -&gt; Next (Login uid) $ \\success -&gt; Done success\n</code></pre>\n\n<p>Which would then be evaluated by some impure function <code>eval</code>.</p>\n\n<p>Now, what is this (if anything?) It's not a monad, neither an arrow, as far as I can see. It seems to be something between a stream/pipe/automaton/fsm and the continuation monad. This makes me think that there might be a better representation for this type of thing, but what?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1477246450, "post_id": 40202960, "comment_id": 67676870, "body": "Mark your code. Perhaps list things you&#39;ve tried to investigate?"}], "answers": [{"comments": [{"owner": {"reputation": 10341, "user_id": 2309581, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/10436db746e1d57fbdb861fc4a155481?s=128&d=identicon&r=PG", "display_name": "fisherman", "link": "https://stackoverflow.com/users/2309581/fisherman"}, "edited": false, "score": 0, "creation_date": 1477230115, "post_id": 40202999, "comment_id": 67671707, "body": "hi,@ Manmeet Gill, i Replace defaultTimeLocale with Data.Time.Format.defaultTimeLocale,this time, i ran &quot;ghc --make site.hs&quot; successfully. but after i ran &quot;./site build&quot;,it shows: &quot; [ERROR] Hakyll.Core.UnixFilter.unixFilterWith: lessc - --yui-compress -O2 gave exit code 1&quot;, how to fix it?tks"}], "tags": [], "owner": {"reputation": 964, "user_id": 5284221, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aGNpvYLJrrE/AAAAAAAAAAI/AAAAAAAAAD4/2VPyfW3ex0c/photo.jpg?sz=128", "display_name": "haboutnnah", "link": "https://stackoverflow.com/users/5284221/haboutnnah"}, "is_accepted": false, "score": 0, "last_activity_date": 1477226365, "creation_date": 1477226365, "answer_id": 40202999, "question_id": 40202960, "link": "https://stackoverflow.com/questions/40202960/ghc-make-site-hs-encounter-error/40202999#40202999", "title": "&quot;ghc --make site.hs&quot; encounter error", "body": "<p>Replace defaultTimeLocale with System.Locale.defaultTimeLocale or Data.Time.Format.defaultTimeLocale, depending on which you're using.</p>\n"}], "owner": {"reputation": 10341, "user_id": 2309581, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/10436db746e1d57fbdb861fc4a155481?s=128&d=identicon&r=PG", "display_name": "fisherman", "link": "https://stackoverflow.com/users/2309581/fisherman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1477226365, "creation_date": 1477226090, "question_id": 40202960, "link": "https://stackoverflow.com/questions/40202960/ghc-make-site-hs-encounter-error", "title": "&quot;ghc --make site.hs&quot; encounter error", "body": "<p>root@AR:/usr/local# git clone <a href=\"https://github.com/CleverCloud/clever-cloud.com\" rel=\"nofollow\">https://github.com/CleverCloud/clever-cloud.com</a></p>\n\n<p>root@AR:/usr/local# cd clever-cloud.com</p>\n\n<p>root@AR:/usr/local/clever-cloud.com# ghc --make site.hs</p>\n\n<p>[1 of 4] Compiling Utils ( Utils.hs, Utils.o )</p>\n\n<p>[2 of 4] Compiling CustomTags ( CustomTags.hs, CustomTags.o )</p>\n\n<p>[3 of 4] Compiling RouteFactories ( RouteFactories.hs, RouteFactories.o )</p>\n\n<p>[4 of 4] Compiling Main ( site.hs, site.o )</p>\n\n<p>site.hs:192:26: error:\nAmbiguous occurrence \u2018defaultTimeLocale\u2019</p>\n\n<p>It could refer to either \u2018Data.Time.Format.defaultTimeLocale\u2019,</p>\n\n<p>imported from \u2018Data.Time.Format\u2019 at site.hs:10:1-33</p>\n\n<p>(and originally defined in \u2018time-1.6.0.1:Data.Time.Format.Locale\u2019)</p>\n\n<p>or \u2018System.Locale.defaultTimeLocale\u2019,</p>\n\n<p>imported from \u2018System.Locale\u2019 at site.hs:12:1-30</p>\n\n<p>root@AR:/usr/local/clever-cloud.com#</p>\n\n<p>how to fix it?</p>\n\n<p>Tks</p>\n"}, {"tags": ["scala", "haskell", "f#", "functional-programming"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477232850, "post_id": 40202840, "comment_id": 67672583, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4597262/complex-data-structures-in-haskell-how-do-they-work\">Complex data structures in Haskell - how do they work?</a>"}, {"owner": {"reputation": 5679, "user_id": 870815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/r2Qyo.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/870815/john"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1477234742, "post_id": 40202840, "comment_id": 67673127, "body": "@duplode You didn&#39;t really read the question, did you?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 4, "creation_date": 1477235467, "post_id": 40202840, "comment_id": 67673350, "body": "You are right, indeed: it is not a duplicate, and I retracted my close vote. There is no need for making passive-aggressive edits to the question though -- all it takes is pointing out the mistake (in this case, my mistake) clearly. In any case: (1) You might find the reference in the question I linked to useful if you want to learn more about why &quot;[the trick you mention] is not necessary for some other reason&quot;. (2) There are currently three &quot;too broad&quot; close votes, which I don&#39;t think are appropriate either (perhaps a more specific title would help avoiding further misunderstandings)."}, {"owner": {"reputation": 5679, "user_id": 870815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/r2Qyo.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/870815/john"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477235833, "post_id": 40202840, "comment_id": 67673476, "body": "@duplode Good suggestion with the title."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1477275318, "post_id": 40202840, "comment_id": 67683957, "body": "Your claim that &quot;That means that in C++, one can actually take any mutable efficient data structure and convert it to having an immutable api that can be used in a purely functional way just as efficiently as the imperative version would be&quot; is patently false as soon as you need persistence. What are you really trying to say?"}], "answers": [{"comments": [{"owner": {"reputation": 5679, "user_id": 870815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/r2Qyo.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/870815/john"}, "edited": false, "score": 0, "creation_date": 1477229713, "post_id": 40203265, "comment_id": 67671556, "body": "I know, it&#39;s what I talk about at the beginning of the question (see the list example). I added the <i>persistent data structure</i> buzzword to make that more clear. In any case, this question is about using non-persistent data structures in a functional way and their support in functional languages."}], "tags": [], "owner": {"reputation": 14006, "user_id": 3798102, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100002464470905/picture?type=large", "display_name": "pamu", "link": "https://stackoverflow.com/users/3798102/pamu"}, "is_accepted": false, "score": 1, "last_activity_date": 1477227967, "creation_date": 1477227967, "answer_id": 40203265, "question_id": 40202840, "link": "https://stackoverflow.com/questions/40202840/can-non-persistent-data-structures-be-used-in-a-purely-functional-way/40203265#40203265", "title": "Can non-persistent data structures be used in a purely functional way?", "body": "<p>1) Functional programming languages support persistent data structures. When a data structure is transformed into another or any operation is done on the data structure which produces a new data structure, unchanged parts of the data structure are reused by linking especially in case of lists.</p>\n\n<blockquote>\n  <p>In computing, a persistent data structure is a data structure that always preserves the previous version of itself when it is modified. Such data structures are effectively immutable, as their operations do not (visibly) update the structure in-place, but instead always yield a new updated structure.</p>\n</blockquote>\n\n<p>2) In purely lazy functional languages computation is deferred and evaluation is only done when expression's result is used for the final value/result. This mechanism will help avoid unnecessary computation.</p>\n"}, {"comments": [{"owner": {"reputation": 5679, "user_id": 870815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/r2Qyo.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/870815/john"}, "edited": false, "score": 0, "creation_date": 1477234487, "post_id": 40204095, "comment_id": 67673053, "body": "Thanks for the answer - it&#39;s a bit how I expected it to be. Interestingly, this means that in a way C++ allows a somewhat more functional style of programming than functional languages themselves in that regard, although it&#39;s more of an academic observation as no one would use C++ in that way."}, {"owner": {"reputation": 5679, "user_id": 870815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/r2Qyo.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/870815/john"}, "edited": false, "score": 0, "creation_date": 1477235964, "post_id": 40204095, "comment_id": 67673519, "body": "My main concern isn&#39;t memory by the way, but <i>locality of reference</i>. Persistent data structures are usually some form of tree with nodes individually living on the heap, and those suck at that. It&#39;s why hash tables are better than search trees, and I suspect functional languages will then in practice be considerably slower for that reason."}, {"owner": {"reputation": 4143, "user_id": 3008323, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9996de35545430d1d78c155dfccb546?s=128&d=identicon&r=PG", "display_name": "jacks", "link": "https://stackoverflow.com/users/3008323/jacks"}, "reply_to_user": {"reputation": 5679, "user_id": 870815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/r2Qyo.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/870815/john"}, "edited": false, "score": 2, "creation_date": 1477237083, "post_id": 40204095, "comment_id": 67673863, "body": "John, depending on the use case, Scala (again, for example) has structures which are designed with locality in mind. <code>Vector</code>, for example, is an immutable shallow tree of arrays of 32 elements. Operations can be carried out in chunks of 32, which happens to coincide with the size of a cache line in modern processors. So access will be fairly fast for bulk operation like <code>map</code>. For structures, like <code>List</code>, locality is a consideration, as you say, since each cell just points to the next which can be anywhere. For recursive operationss, <code>List</code> will usually be faster than a <code>Vector</code> however."}, {"owner": {"reputation": 5679, "user_id": 870815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/r2Qyo.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/870815/john"}, "edited": false, "score": 0, "creation_date": 1477237383, "post_id": 40204095, "comment_id": 67673939, "body": "That&#39;s an interesting point. I just looked up that Scala&#39;s <code>immutable.HashMap</code> is similarly optimized."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 5679, "user_id": 870815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/r2Qyo.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/870815/john"}, "edited": false, "score": 0, "creation_date": 1477238277, "post_id": 40204095, "comment_id": 67674172, "body": "@John Also, there are things similar to what Nio describes going on, for instance, in <a href=\"https://hackage.haskell.org/package/unordered-containers-0.2.7.1\" rel=\"nofollow noreferrer\"><i>unordered-containers</i></a>, Haskell&#39;s <i>de facto</i> standard implementation of immutable hash maps."}], "tags": [], "owner": {"reputation": 4143, "user_id": 3008323, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9996de35545430d1d78c155dfccb546?s=128&d=identicon&r=PG", "display_name": "jacks", "link": "https://stackoverflow.com/users/3008323/jacks"}, "is_accepted": true, "score": 3, "last_activity_date": 1477233586, "last_edit_date": 1477233586, "creation_date": 1477233215, "answer_id": 40204095, "question_id": 40202840, "link": "https://stackoverflow.com/questions/40202840/can-non-persistent-data-structures-be-used-in-a-purely-functional-way/40204095#40204095", "title": "Can non-persistent data structures be used in a purely functional way?", "body": "<p>I'm pretty sure that a feature like <em>alias analysis</em> (checking if data is used elsewhere) is not part of the Scala compiler (nor part of other FP languages like Haskell and Clojure). The collections API in Scala (for example) is explicitly split into <code>immutable</code> and <code>mutable</code> packages. The <code>immutable</code> data structures use the concept of <em>structural sharing</em> to negate the need to copy data and therefore reduce the overhead (in terms of the amount of temporal data) of working with immutable structures.</p>\n\n<p>As you already pointed out, methods like cons <code>::</code> create a new immutable structure which, under the hood, contains a reference to any existing immutable data (rather than making a copy of it).</p>\n\n<p>Conversions between <code>mutable</code> and <code>immutable</code> types (in Scala for example) make a copy of the <code>mutable</code> data (usually in a lazy fashion), rather than using any mechanisms such as checking whether the <code>mutable</code> structure is not referred to anywhere else and allowing it to be mutated. </p>\n\n<p>When I first moved over from Java to Scala I initially thought that the (often) great deal of temporal data that must get created when working with immutable structures might be a performance constraint and involve some clever techniques to actually allow mutation where it was safe to do so but this is not so because the idea is that immutable data never points to younger values. Since younger values do not exist at the time when an old value is created, it cannot be pointed to at the time of creation, and since values are never modified, neither can it be pointed to later. The outcome is that FP languages like Scala/Haskell are able to generate all this temporal data since the garbage collectors are able to remove it in a very short time frame.</p>\n\n<p>In a nutshell, Scala/Haskell (I'm not sure about F#) do not allow mutation of immutable structures because the state of runtime environments like the current JVM's have very efficient garbage collection and therefore temporal data can be removed very quickly. Of course, as I'm sure you are aware, an immutable structure containing mutable elements is perfectly possible in FP languages like Scala but although the mutable elements can be changed, the immutable container cannot ie. elements can neither be added/removed.</p>\n"}, {"comments": [{"owner": {"reputation": 5679, "user_id": 870815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/r2Qyo.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/870815/john"}, "edited": false, "score": 0, "creation_date": 1477246054, "post_id": 40205662, "comment_id": 67676722, "body": "I know and appreciate those design goals of functional languages. My question about good move semantics in typical functional languages would support that goal, not contradict it. Done properly, I believe it could allow a purely functional style of programming that translates exactly as the corresponding imperative program would, and execute just as fast."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1477265562, "post_id": 40205662, "comment_id": 67682141, "body": "You can even have mutation of various sorts in Haskell. The sanctioned versions are in <code>IO</code>, <code>ST</code>, and <code>STM</code>, but those are not the only ones available. If you&#39;re sufficiently careful, you can use things like <code>unsafePerformIO</code> to implement seemingly immutable structures with mutation under the hood. If you want to live extremely dangerously, you can even crack open the <code>IO</code> or <code>ST</code> types and manually handle state tokens with <code>realWorld#</code> or even <code>runRW#</code>. Such code can be safe, but requires great care and attention."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 6, "last_activity_date": 1477243085, "creation_date": 1477243085, "answer_id": 40205662, "question_id": 40202840, "link": "https://stackoverflow.com/questions/40202840/can-non-persistent-data-structures-be-used-in-a-purely-functional-way/40205662#40205662", "title": "Can non-persistent data structures be used in a purely functional way?", "body": "<p>It is true that persistent data structures are slower than their mutable counterparts. There is no dispute about that. Sometimes the difference is negligible (iterating over a linked list versus an array), other times it can be big (iterating in reverse), but that's not the point. The choice to use immutable data is (or should be) a conscious one: we're trading performance for stability.</p>\n\n<p>Consider this point: <em>for most (not all) modern programs, local performance is not a concern</em>. For today's programs, the real performance bottleneck is in parallelization - both on local machine with shared memory, as well as across different machines. With the amounts of data we're processing these days, squeezing every last bit out of memory locality and branch prediction isn't going to cut it. We need scale. And guess the number one source of bugs in parallel programs? That's right - mutation.</p>\n\n<p>Another big concern for modern programs is <em>stability</em>. Long gone are the days when a program could crash on you, and you just restarted it and kept working. Today's programs need to work on headless servers, without human intervention at all, for months or years. Today's program can't just throw up its digital arms and expect a human to figure out what went wrong. In this setting, local performance is so much less important than stability and parallelization: it's much cheaper to buy (or rent) another ten servers than to hire a human for restarting the program every now and then.</p>\n\n<p>It is true that one can make a parallelizable and stable program using mutation. It is theoretically possible. It's just way harder. With immutable data, you have to actually <em>aim</em> at your foot first.</p>\n\n<p>And then, here's some perspective: we've already been there. How often do you use the <code>goto</code> instruction in your code? Have you considered why that is? You can do all kinds of neat performance tricks with <code>goto</code>, and yet we choose not to. At some point in programming history, we have decided that <code>goto</code> was more trouble than it was worth. Same thing happened with raw pointers: many languages don't have them at all, others have them closely guarded, and even in those languages that have unrestricted access to raw pointers, it's now considered kind of a bad form to use them. Today, we're in the middle of the next stage: first we gave up <code>goto</code>, then we gave up raw pointers, now we're slowly giving up mutation.</p>\n\n<p><em>However</em>, if you really find yourself pushing the envelope of local performance for a legitimate reason, and you have determined that the immutable data is indeed the bottleneck (remember: first measure, then optimize), then most functional languages (except Haskell and Elm) will let you get away with mutation, albeit reluctantly. Just like raw pointers in C#, you can have mutation, you just have to be explicit (and careful) about it. In F#, for example, you can have mutable variables, raw arrays, mutable records, classes, interfaces, etc. It is possible, just not recommended. And the general consensus so far is that it's OK to employ mutation as long as it's localized (i.e. does not leak to outside), and you really know what you're doing, and you've documented it, and tested it to the death.</p>\n\n<p>A common case for this is \"value construction\", where your have a function that ultimately produces an immutable value, but does all kinds of messy stuff while doing it. One example is how F# core library implements <code>List.map</code>: normally, because lists are iterated front-to-back, but constructed back-to-front, one would need to first construct the transformed list by iterating, and then reverse it. So the F# compiler cheats here and mutates the list as it's being constructed in order to avoid the extra reversal.</p>\n\n<p>And another note on the \"locality\" concern. Remember how I mentioned that you could do all kinds of neat performance tricks with <code>goto</code>? Well, that's not quite true anymore. Since the programmers started writing programs without <code>goto</code>, the binary code became more predictable, because jumps are now generated by compilers, not coded by humans. This made it possible for CPUs to, well, predict them, and optimize processing based on these predictions. The end result is that now you're actually likely to get <em>worse</em> performance by indiscriminate use of <code>goto</code> than by using accepted higher-level tools like loops. Back in the day, CPUs couldn't afford to be that smart, so that the choice to not use <code>goto</code> was purely a stability measure. But now it turned out to be actually helpful with performance, who would have thought?</p>\n\n<p>I submit that the same thing will happen with immutability as well. I'm not sure exactly <em>how</em> it will happen, but I'm sure that it will. Even today, without special hardware, it is still possible to do some optimization at compile time: for example, if the compiler knows that a variable is immutable, it may decide to cache it in a register for a long period, or even promote it to a constant altogether. It is true that most actual compilers today don't perform <em>all</em> of these possible optimizations (though they do perform <em>some</em>), but they will. We're only just beginning. :-)</p>\n"}, {"tags": [], "owner": {"reputation": 26323, "user_id": 108915, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a00512b12118ebd20d2043802b38bd02?s=128&d=identicon&r=PG", "display_name": "ziggystar", "link": "https://stackoverflow.com/users/108915/ziggystar"}, "is_accepted": false, "score": 0, "last_activity_date": 1477261729, "creation_date": 1477261729, "answer_id": 40208433, "question_id": 40202840, "link": "https://stackoverflow.com/questions/40202840/can-non-persistent-data-structures-be-used-in-a-purely-functional-way/40208433#40208433", "title": "Can non-persistent data structures be used in a purely functional way?", "body": "<p>The <code>ST</code> (state thread) monad in Haskell is a way to ensure that certain actions are called in sequence (no modification outside of that sequence is possible). In <code>ST</code> you can use imperative, mutable data structures within Haskell. Note that Haskell is considered one of the few purely functional languages.</p>\n"}], "owner": {"reputation": 5679, "user_id": 870815, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/r2Qyo.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/870815/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "accepted_answer_id": 40204095, "answer_count": 4, "score": 6, "last_activity_date": 1477261729, "creation_date": 1477225372, "last_edit_date": 1477235586, "question_id": 40202840, "link": "https://stackoverflow.com/questions/40202840/can-non-persistent-data-structures-be-used-in-a-purely-functional-way", "title": "Can non-persistent data structures be used in a purely functional way?", "body": "<p>This is a general question about functional programming but I'm also interested what answer it has in specific languages.</p>\n\n<p>I only have beginner's knowledge about functional languages, so bear with me.</p>\n\n<p>It is my understanding that functional languages put a focus on different data structures than imperative languages, as they like immutability: The <em>persistent data structures</em>.</p>\n\n<p>For example, they all have an immutable list concept where you can form a new lists <code>x :: l</code> and <code>y :: l</code> from an existing list <code>l</code> and two new items <code>x</code> and <code>y</code> without all elements of <code>l</code> needing to be copied. This is likely implemented by the new list object internally pointing to the old one as the tail.</p>\n\n<p>In imperative languages, such a data structure is rarely used, as they don't provide as good locality of reference as c-style arrays do.</p>\n\n<p>In general, finding data structures that support the functional style is an endeavor of it's own, so it would be great if one wouldn't always have to do that.</p>\n\n<p>Now here's an idea how one could use all classical data structures in functional programming if there's the right language support for it.</p>\n\n<p>In general, a data structure in an imperative language has modifying operations defined on it (in pseudo-code):</p>\n\n<pre><code>data.modify(someArgument)\n</code></pre>\n\n<p>The functional way of writing this is</p>\n\n<pre><code>newData = modified(data, someArgument)\n</code></pre>\n\n<p>The general problem is that this normally requires copying the data structure - except if the language could know that <code>data</code> will in fact not be used by anything else: Then, the modification could be done in the form of mutating the original and no one could tell the difference.</p>\n\n<p>There is a large class of cases where the language could infer that property of \"never used elsewhere\": When the first argument to <code>modified</code> is an unbound value, as in this example:</p>\n\n<pre><code>newData = modified(modified(data, someArgument))\n</code></pre>\n\n<p>Here, <code>data</code> may be used elsewhere, but <code>modified(data, someArgument)</code> clearly isn't.</p>\n\n<p>This is what in C++ is called an \"rvalue\", and in the latest incarnation of C++, which ironically isn't functional at all otherwise, one can overload on such rvalues.</p>\n\n<p>For example, one can write:</p>\n\n<pre><code>Data modified(Data const&amp; data) { // returns a modified copy }\nData modified(Data &amp;&amp; data) { // returns the modified original }\n</code></pre>\n\n<p><em>That means that in C++, one can actually take any mutable efficient data structure and convert it to having an immutable api that can be used in a purely functional way just as efficiently as the imperative version would be.</em></p>\n\n<p>(There's the caveat that in C++ still sometimes casting is necessary to force the rvalue overload. And of course care need to be taken on implementing such data structures, ie. when using the rvalue overloads. That could probably be improved on though.)</p>\n\n<p>Now my question:</p>\n\n<p>Do actual functional languages have a similar mechanism? Or is this not necessary for some other reason?</p>\n\n<p>(I tagged some specific languages I'm particularly interested in.)</p>\n"}, {"tags": ["haskell", "tree", "state", "monads"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1477220495, "post_id": 40201679, "comment_id": 67669136, "body": "Although you haven&#39;t shown the implementation of <code>instance Monad State&#39;</code> I can almost guarantee it doesn&#39;t satisfy the monad laws; counting <code>return</code>s and <code>bind</code>s is incompatible with the laws <code>return x &gt;&gt;= f = f x</code> and <code>m &gt;&gt;= return = m</code>. (Not that it&#39;s related to your problem at all!)"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 33, "user_id": 6335545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3faa7dbe473d4319fba87dbc11944545?s=128&d=identicon&r=PG&f=1", "display_name": "D. Ondor", "link": "https://stackoverflow.com/users/6335545/d-ondor"}, "edited": false, "score": 1, "creation_date": 1477219695, "post_id": 40201780, "comment_id": 67668935, "body": "@D.Ondor Turning on warnings using <code>-Wall</code> would have spotted the double binding of <code>x</code>. Many pitfalls are similarly detected by warnings, so it&#39;s generally recommended to turn them on."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 2, "last_activity_date": 1477217622, "creation_date": 1477217622, "answer_id": 40201780, "question_id": 40201679, "link": "https://stackoverflow.com/questions/40201679/modifying-monad-state/40201780#40201780", "title": "Modifying monad state", "body": "<p>The problem is in</p>\n\n<pre><code>put x = State' (\\(x, counts) -&gt; ((), x, counts &lt;&gt; onePut))\n</code></pre>\n\n<p>Here you're supposed to put <code>x</code> into a state, but it gets shadowed in the <code>(x, counts)</code> pattern. Make it</p>\n\n<pre><code>put x = State' (\\(_, counts) -&gt; ((), x, counts &lt;&gt; onePut))\n</code></pre>\n\n<p>and you should be fine as long as you don't care about monad laws, because your task forces you to violate them:</p>\n\n<blockquote>\n  <p>count the number of monadic actions</p>\n</blockquote>\n\n<p>One of the laws is <code>(return x &gt;&gt;= f) ~ f x</code>, but the former expression has additional <code>return</code> and <code>(&gt;&gt;=)</code> in it.</p>\n"}, {"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 2, "last_activity_date": 1506553546, "last_edit_date": 1506553546, "creation_date": 1477232421, "answer_id": 40203935, "question_id": 40201679, "link": "https://stackoverflow.com/questions/40201679/modifying-monad-state/40203935#40203935", "title": "Modifying monad state", "body": "<p>I know it's an assignment, but I want to point out that GHC can write almost all of this code for you! The magic words are <code>deriving Traversable</code>.</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor, DeriveFoldable, DeriveTraversable #-}\ndata Tree a = Leaf\n            | Node (Tree a) a (Tree a)\n            deriving (Functor, Foldable, Traversable)\n</code></pre>\n\n<p>The <code>Traversable</code> class abstracts the notion of performing an action on each element of a structure. <code>traverse :: (Traversable t, Applicative f) =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)</code> takes a function which performs an <code>Applicative</code> effect on elements <code>a</code> and runs it over the whole structure <code>t</code>, sequencing the effects to produce a <code>t</code> in an <code>Applicative</code> context.</p>\n\n<p>So all we have to do is say how to act on a single element,</p>\n\n<pre><code>inc :: a -&gt; State Int (Int, a)\ninc x = do\n    counter &lt;- get\n    put (counter + 1)\n    return (counter, x)\n</code></pre>\n\n<p>and the <code>Traversable</code> machinery will do the heavy lifting of running the action across the whole tree.</p>\n\n<pre><code>label :: Tree a -&gt; Tree (Int, a)\nlabel t = evalState (traverse inc t) 0\n</code></pre>\n\n<p>The layout of the <code>Node</code> constructor determines the traversal order; in this case <code>traverse</code> will perform an in-order traversal.</p>\n"}], "owner": {"reputation": 33, "user_id": 6335545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3faa7dbe473d4319fba87dbc11944545?s=128&d=identicon&r=PG&f=1", "display_name": "D. Ondor", "link": "https://stackoverflow.com/users/6335545/d-ondor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 40201780, "answer_count": 2, "score": 3, "last_activity_date": 1506553546, "creation_date": 1477216817, "question_id": 40201679, "link": "https://stackoverflow.com/questions/40201679/modifying-monad-state", "title": "Modifying monad state", "body": "<p>For a programming exercise, I am supposed to take a Tree of data type</p>\n\n<pre><code>data Tree a = Branch (Tree a) a (Tree a) | Leaf\n    deriving (Eq, Ord, Show)\n</code></pre>\n\n<p>and label each <code>a</code> with an <code>Int</code>, increasingly, depth-first in-order, using a state monad, and count the number of monadic actions. For example, the expression</p>\n\n<pre><code>let tree = Branch (Branch Leaf \"B\" Leaf) \"A\" Leaf\nin run (label tree) 42\n</code></pre>\n\n<p>should evaluate to</p>\n\n<pre><code>(Branch (Branch Leaf (42, \"B\") Leaf) (43, \"A\") Leaf\n, Counts {binds = 10,returns = 5, gets = 4, puts = 2})\n</code></pre>\n\n<p>The type of the state is:</p>\n\n<pre><code>newtype State' s a = State' { runState' :: (s, Counts) -&gt; (a, s, Counts) }\n</code></pre>\n\n<p>Here are my implementations of <code>label</code> and <code>run</code></p>\n\n<pre><code>label :: MonadState m Int =&gt; Tree a -&gt; m (Tree (Int, a))\nlabel Leaf                      = return Leaf\nlabel (Branch left value right) = do\n                                  newLeft  &lt;- label left\n                                  int &lt;- get\n                                  put (int + 1)\n                                  newRight &lt;- label right\n                                  return (Branch newLeft (int, value) newRight)\n\n\nrun :: State' s a -&gt; s -&gt; (a, Counts)\nrun s ns = let (a, _, counts) = runState' s (ns, Counts 0 0 0 0) in (a, counts)\n</code></pre>\n\n<p>However, when I run the test case, my result is</p>\n\n<pre><code>(Branch (Branch Leaf (42,\"B\") Leaf) (42,\"A\") Leaf\n, Counts {binds = 12, returns = 5, gets = 6, puts = 2})\n</code></pre>\n\n<p>It seems the <code>Int</code> isn't being updated at all. This is strange because there are seperate test cases for each part of the assignment, and everything except this is correct. In any case, here are the get and put implementations:</p>\n\n<pre><code>-- get :: State' s s\nget = State' (\\(s, counts) -&gt; (s, s, counts &lt;&gt; oneGet))\n\n-- put :: s -&gt; State' s ()\nput x = State' (\\(x, counts) -&gt; ((), x, counts &lt;&gt; onePut))\n</code></pre>\n\n<p>I am really at a loss here. I have no idea why the <code>Int</code>s are not affected at all. Any help is greatly appreciated.</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1477215645, "post_id": 40201477, "comment_id": 67667876, "body": "The last pattern is too specific: it doesn&#39;t catch any list that has two or more elements."}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 1, "creation_date": 1477215647, "post_id": 40201477, "comment_id": 67667878, "body": "what exactly do you mean with &quot;error/not working&quot; ? btw, hint: the last line should probably start with <code>maxList (Cons x xs) = </code> where <code>xs</code> matches any list no matter how long it is..."}, {"owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "edited": false, "score": 0, "creation_date": 1477215787, "post_id": 40201477, "comment_id": 67667912, "body": "I&#39;m posting the error exactly."}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477216351, "post_id": 40201477, "comment_id": 67668068, "body": "@AliToto that error says that <code>Cons 8</code> doesn&#39;t match the definition of <code>List</code> you gave since the <code>Cons</code> constructor takes two argument, e.g. <code>Cons 8 Nil</code>. A good intro to Haskell lists is <a href=\"http://learnyouahaskell.com/starting-out#an-intro-to-lists\" rel=\"nofollow noreferrer\">learnyouahaskell.com/starting-out#an-intro-to-lists</a>"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1477216417, "post_id": 40201477, "comment_id": 67668090, "body": "It looks to me as if the type error is not in the program, but rather in the interactive attempt to test the program. The sample list has not been finished properly with <code>Nil</code>. Once that problem has been fixed, the error in the implementation will reveal itself."}, {"owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477216815, "post_id": 40201477, "comment_id": 67668191, "body": "@mb21 I tried this now: maxList Cons x xs = if xs == Nil then x else max x (maxList xs _)"}, {"owner": {"reputation": 444, "user_id": 1554137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb537e77e97db2071395a0b2a4c8a593?s=128&d=identicon&r=PG", "display_name": "Alexander VoidEx Ruchkin", "link": "https://stackoverflow.com/users/1554137/alexander-voidex-ruchkin"}, "edited": false, "score": 0, "creation_date": 1477219957, "post_id": 40201477, "comment_id": 67668997, "body": "Error is that <code>Cons</code> has two arguments, and in your expression <code>(Cons 3 (Cons 5 (Cons 8)))</code> mentioned in error message, specifically in <code>Cons 8</code> only one is passed. Error is not about your <code>maxList</code> function implementation.  In different try you have to add braces: <code>maxList (Cons x y)</code>"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477222094, "post_id": 40201477, "comment_id": 67669533, "body": "you&#39;re making progress :) the <code>Equations for maxList have different numbers of arguments</code> is because <code>maxList Cons x xs</code> should be <code>maxList (Cons x xs)</code>. btw, you won&#39;t need the <code>if xs == Nil</code> since you already have the <code>maxList Nil = </code>"}, {"owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477223361, "post_id": 40201477, "comment_id": 67669863, "body": "@mb21 I did it!"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1477230715, "post_id": 40201477, "comment_id": 67671884, "body": "@AliToto congrats :) btw, the <code>Non type-variable argument in the constraint: Eq (List a)</code> was because you used <code>==</code> in <code>xs == Nil</code>, so you&#39;d have to write <code>data List ... deriving (Show, Eq)</code> to generate the <code>==</code> function for your data type in addition to the <code>show</code> function..."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "is_accepted": false, "score": 3, "last_activity_date": 1477872843, "last_edit_date": 1477872843, "creation_date": 1477223429, "answer_id": 40202569, "question_id": 40201477, "link": "https://stackoverflow.com/questions/40201477/a-function-to-get-maximum/40202569#40202569", "title": "a function to get maximum", "body": "<p>My problem was in understanding pattern matching.I did it finally:</p>\n\n<pre><code>data Lan a = Nan | Can a (Lan a) deriving Show\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1477872843, "creation_date": 1477215173, "last_edit_date": 1477872785, "question_id": 40201477, "link": "https://stackoverflow.com/questions/40201477/a-function-to-get-maximum", "title": "a function to get maximum", "body": "<p>I am new in Haskell.I am trying to do the following: </p>\n\n<p>The given List datatype structure is:<code>data Lan a = Nan | Can a (Lan a) deriving Show</code></p>\n\n<p>And finally I did it!</p>\n\n<pre><code>data Lan a = Nan | Can a (Lan a) deriving Show\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1477214548, "post_id": 40201126, "comment_id": 67667614, "body": "Perhaps you could give a small example of the kind of complex logic for which tuples won&#39;t suffice."}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1477215304, "post_id": 40201126, "comment_id": 67667782, "body": "@danidiaz - I&#39;m struggling to think of a good example. But suppose I have <code>10</code> variables I want to assign-- although it&#39;s possible to do the assignment using tuples, I feel that it is somehow poor practice and messy to have it spread out over 10 lines. I like the approach of assigning variables one-by-one because I find it easier to read and understand."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1477218040, "post_id": 40201126, "comment_id": 67668501, "body": "At that point, perhaps the better approach would be to define a record with named fields to hold the parsed options, and also to use some of the existing argument-parsing libraries, like &quot;optparse-generic&quot; or the (more complex and full-featured) &quot;optparse-applicative&quot;."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477235028, "post_id": 40201126, "comment_id": 67673212, "body": "I wanted to suggest a wrapper like <code>with_default pos dflt = either (const def) id &lt;$&gt; tryIOError ((!! pos) &lt;$&gt; getArgs)</code>, but apparently I cannot figure out how to correctly catch whatever exception <code>!!</code> raises."}], "answers": [{"comments": [{"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1477212815, "post_id": 40201159, "comment_id": 67667230, "body": "I wanted to avoid grouping them into a tuple, because in general the conditional behaviour could be much more complex than just a handful of variable assignments. Is there an alternative way? Is there no option for flow control within the <code>do</code> block?"}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1477213216, "post_id": 40201159, "comment_id": 67667317, "body": "Also, this produces a parse error: <code>possible incorrect indentation or mismatched brackets</code> on the line with the <code>case</code> statement. I can&#39;t see an issue with indentation, though."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1477217307, "post_id": 40201159, "comment_id": 67668314, "body": "What I provided is a fragement - you need to embed it in the <code>do</code> block at the proper indentation.  WRT &quot;control flow&quot; what I am getting is that you want mutable variables or some sort of variables that escape their syntactic scope.  You can make mutable references but that is not as useful as you might hope Variables can not escape their scope.  You can declare variables &quot;one-by-one&quot; simply via <code>let numDice = expr1 ; numFaces = expr2 ; ...</code> but it seems those exprs will share a fair amount of logic in your case."}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1477222028, "post_id": 40201159, "comment_id": 67669514, "body": "I did embed it in the <code>do</code> block and there is still an indentation problem. I indented the <code>case</code> line by just one more space and the compiler stopped grumbling."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1477237812, "post_id": 40201159, "comment_id": 67674043, "body": "Ah yes, the expression must be indented further than the variable name and I failed to do that - edited now."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1477237784, "last_edit_date": 1477237784, "creation_date": 1477212701, "answer_id": 40201159, "question_id": 40201126, "link": "https://stackoverflow.com/questions/40201126/haskell-assign-variables-with-case-in-do-block/40201159#40201159", "title": "Haskell - Assign variables with `case` in `do` block", "body": "<p>You need to let bind your variables to an expression and have the expression determine the value, not assume you can do some pathalogical variable declaration:</p>\n\n<pre><code>let (numDice,numFaces,offset) =\n     case (length args) of\n      3 -&gt;   (toNaturalP $ read $ args!!0\n             ,toNaturalP $ read $ args!!1\n             ,read $ args!!2)\n      2 -&gt;   (toNaturalP $ read $ args!!0\n             ,toNaturalP $ read $ args!!1\n             ,0)\n      1 -&gt;   (1\n             ,toNaturalP $ read $ args!!0\n             ,0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1477214017, "post_id": 40201259, "comment_id": 67667518, "body": "I like this; it&#39;s useful to know about the <code>ViewPatterns</code>. I know how to use <code>PatternGuards</code> and <code>case</code> and <code>if</code> statements for expression flow control, but are there any such flow control options inside a <code>do</code> block?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1477214302, "post_id": 40201259, "comment_id": 67667574, "body": "@Myridium You can use <code>case</code> and <code>if</code> in do-blocks, no problem. Notice that in your example the <code>let</code>s are inside the branches of the <code>case</code>. In my answer, the let  binds the result of the whole pattern-match, and the values are available in  the rest of the do-block. Theres a subtlety: inside do-blocks the <code>let</code>s do not have <code>in</code>s."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 4, "last_activity_date": 1477214032, "last_edit_date": 1477214032, "creation_date": 1477213557, "answer_id": 40201259, "question_id": 40201126, "link": "https://stackoverflow.com/questions/40201126/haskell-assign-variables-with-case-in-do-block/40201259#40201259", "title": "Haskell - Assign variables with `case` in `do` block", "body": "<p>Instead of switching of the length of the list and then indexing, I would rather pattern-match directly on the list while also using <a href=\"https://ocharles.org.uk/blog/posts/2014-12-02-view-patterns.html\" rel=\"nofollow\"><code>ViewPatterns</code></a>:</p>\n\n<pre><code>main :: IO ()\nmain = do \n    args  &lt;- getArgs\n    let (arg1,arg2) = case args of\n                        [] -&gt; (1::Int,\"default\")\n                        [read -&gt; arg1, read -&gt; arg2] -&gt; (arg1,arg2)\n    print (arg1,arg2)    \n</code></pre>\n\n<p>If a tuple isn't enough  because the extraction logic is complex, I would define a custom datatype holding the possible alternatives.</p>\n\n<p>You can also use <a href=\"https://wiki.haskell.org/Pattern_guard\" rel=\"nofollow\">guards</a> and the <a href=\"https://www.schoolofhaskell.com/school/to-infinity-and-beyond/pick-of-the-week/guide-to-ghc-extensions/pattern-and-guard-extensions#patternguards\" rel=\"nofollow\"><code>PatternGuards</code></a> extension to impose complex conditions on each match.</p>\n"}], "owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1573, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477237784, "creation_date": 1477212382, "last_edit_date": 1477214189, "question_id": 40201126, "link": "https://stackoverflow.com/questions/40201126/haskell-assign-variables-with-case-in-do-block", "title": "Haskell - Assign variables with `case` in `do` block", "body": "<p>I have a small Haskell program whose behaviour needs to vary slightly depending on the number of arguments provided. I can't work out how to assign three variables in a neat way based on the number of arguments provided, though.</p>\n\n<p>I want to use something like a <code>case</code> expression, or the equivalent of <code>switch</code> in other programming languages, but can't work out how.</p>\n\n<p>Here is my current (faulty) code which relies on a <code>Dice.Base</code> module for random number generation:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\nimport Dice.Base\nimport System.Environment\nimport Data.List\n\nmain :: IO()\n\n--Expected argument formats:\n--(number of dice, number of faces on each die, number to add to total)\n--(number of dice, number of faces on each die) \n--(number of faces on a single die)\nmain = do\n        args  &lt;- getArgs\n\n        --Set the number of dice, number of faces on each die,\n          --and number to add to sum of rolls.\n        case (length args) of\n          3 -&gt;   let (numDice ::NaturalP) = toNaturalP $ read $ args!!0;\n                 let (numFaces::NaturalP) = toNaturalP $ read $ args!!1;\n                 let (offset  ::Integer ) = read $ args!!2;\n          2 -&gt;   let (numDice ::NaturalP) = toNaturalP $ read $ args!!0;\n                 let (numFaces::NaturalP) = toNaturalP $ read $ args!!1;\n                 let (offset  ::Integer ) = 0;\n          1 -&gt;   let (numDice ::NaturalP) = 1;\n                 let (numFaces::NaturalP) = toNaturalP $ read $ args!!0;\n                 let (offset  ::Integer ) = 0;\n\n        -- 'dc' is a structure capturing the Dice Configuration.\n        let dc = NumSidesPlus numDice numFaces offset\n        outcomeInteger &lt;- roll dc\n\n        putStrLn(\"Dice configuration:     \" ++ (show dc))\n        putStrLn(\"Outcome:                \" ++ (show outcomeInteger))\n</code></pre>\n\n<p>This doesn't work of course because <code>case</code> produces an expression; it isn't designed to work in the <code>do</code> block.</p>\n\n<p>I know it's possible to do <code>let (a,b,c) = case ...</code> and assign the three values as a tuple, but I consider this a workaround because it really doesn't help me for more complex projects. What are the methods of flow control within a <code>do</code> block? Is there anything analogous to <code>switch</code> like in an imperative language?</p>\n\n<p>How do I accomplish this dependent variable assignment?</p>\n"}, {"tags": ["haskell", "haddock"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1477191407, "post_id": 40199042, "comment_id": 67663874, "body": "Potential close voters: please don&#39;t use the &quot;general computing&quot; close reason if you have absolutely no clue about what the question is about."}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477191579, "post_id": 40199042, "comment_id": 67663900, "body": "Hi man, I&#39;m a bit new to stackoverflow, and I didn&#39;t understand what you meant... Does my question breaks any kind of rule? I can&#39;t make haddock run and I&#39;m trying..."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477191625, "post_id": 40199042, "comment_id": 67663910, "body": "It&#39;s been a while since I used Haskell on Windows, but I&#39;m pretty much sure it is compatible. Are you using <i>cabal</i> or <i>stack</i> to manage your packages?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477191662, "post_id": 40199042, "comment_id": 67663914, "body": "(And don&#39;t worry, your question is fine. I wrote that because someone used the system to complain about your question for a spurious reason.)"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477191783, "post_id": 40199042, "comment_id": 67663925, "body": "I&#39;m using WinGHCi it allows me to do what i need without no commands basiclly... I do my .hs on sublime and open in winGHCi... I dont really Know what i&#39;m using (cabal or stack)... I&#39;m just starting programming so I have not my knowledge sorry"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477192125, "post_id": 40199042, "comment_id": 67663961, "body": "That&#39;s fine. Just one more question, to see if we are on the same page: what do you need Haddock for?"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477192369, "post_id": 40199042, "comment_id": 67663988, "body": "I need it to generate one HTML doc of my program..  I need to use this command, but i can&#39;t for now :  haddock -h -o doc/html Main.hs   And it creats an HTML file"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1477192633, "post_id": 40199042, "comment_id": 67664010, "body": "I assume you are running this command in the Windows command prompt, and not in WinGHCi, right?"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477192992, "post_id": 40199042, "comment_id": 67664052, "body": "Oh, I&#39;m so retarded you&#39;re right, It runs on command prompt... I was trying to use it from ghci.exe... Damn I&#39;m stupid. Thank you man"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477193249, "post_id": 40199042, "comment_id": 67664089, "body": "No worries. By the way, I should mention that <i>cabal</i> (and/or <i>stack</i>) are tools used to build and install Haskell-powered software. If you really didn&#39;t have Haddock, <code>cabal install haddock</code> would probably be enough to get it installed. (Given that you mentioned WinGHCi, though, odds are you have the Haskell Platform of which it is a part installed in your computer, and so it would be surprising if you didn&#39;t have the other command-line tools included in it, such as <code>ghc</code>, <code>cabal</code>, <code>haddock</code>, etc.)"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477193581, "post_id": 40199042, "comment_id": 67664130, "body": "I did download it anyway, but i didn&#39;t had haddock in the lib folder(where cabal is for example) so maybe i didn&#39;t had it installed, anyway, my problem was using the command on the wrong place, so dumb...       Thank you a lot, i was here losing almost one hour already trying to find what i was doing wrong, and it was so simple."}], "owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477190867, "creation_date": 1477190867, "question_id": 40199042, "link": "https://stackoverflow.com/questions/40199042/install-haddock-on-windows-ghci-8-0-1", "title": "install haddock on windows GHCi 8.0.1", "body": "<p>My question is very simple, how do I install haddock?</p>\n\n<p>I'm using GHCi version 8.0.1 in windows.. Is haddock compatible with windows GHCI?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1477190304, "post_id": 40198965, "comment_id": 67663713, "body": "&quot;Can anyone explain to me what is going on with my new version of quickSort2&quot; -- Nothing to be worried about. If you read the error again (and you should add the error to the question here and in such cases -- it makes things easier for everyone!), you will probably find out (I am guessing) it is basically saying that it doesn&#39;t know which type the empty list should have. If I am right, <code>print $ quickSort2 ([] :: [Int])</code> will not lead to an error, and your function will work just fine when you use it in the rest of your program, as long as you give things type signatures."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477191313, "post_id": 40198965, "comment_id": 67663862, "body": "By the way, which version of GHC you are using? (Run <code>ghc --version</code> in the terminal if you don&#39;t know.)"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1477192828, "post_id": 40198965, "comment_id": 67664029, "body": "on a side note - I hope you are aware that your implementation of quick-sort is incorrect <code>quicksort1 [10,9..1] &#47;= [1..10]</code>, same goes for <code>quicksort1 [5,5,5]</code>. I am using ghc 8.0.1 and 7.10.3 and I cannot reproduce any error! for your second quicksort version"}, {"owner": {"reputation": 437, "user_id": 5775622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/64YBh.png?s=128&g=1", "display_name": "1234", "link": "https://stackoverflow.com/users/5775622/1234"}, "edited": false, "score": 0, "creation_date": 1477203002, "post_id": 40198965, "comment_id": 67665421, "body": "The Glorious Glasgow Haskell Compilation System, version 7.10.3"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1477207915, "post_id": 40198965, "comment_id": 67666254, "body": "1) Your quickSort does not have any recursive calls. This is surely wrong. 2) Never say &quot;I got an error&quot; without posting the error! It might be useless to you but precious to potential answerers. 3) Why Maybe? I&#39;d expect sorting to always returns a list..."}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 3, "last_activity_date": 1477195056, "last_edit_date": 1477195056, "creation_date": 1477194642, "answer_id": 40199325, "question_id": 40198965, "link": "https://stackoverflow.com/questions/40198965/write-quick-sort-in-haskell-and-need-help-to-resolve-the-issue/40199325#40199325", "title": "Write Quick Sort in Haskell and need help to resolve the issue", "body": "<p>I assume you use a file <code>foo.hs</code> and in it</p>\n\n<pre><code>main = print $ quicksort []\n\nquicksort = ... - as defined above in quickSort2\n</code></pre>\n\n<p>then you get two error messages when you <code>runghc foo.hs</code></p>\n\n<pre><code>foo.hs:3:8: error:\n    \u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018print\u2019\n      prevents the constraint \u2018(Show a0)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n      These potential instances exist:\n        instance Show Ordering -- Defined in \u2018GHC.Show\u2019\n        instance Show Integer -- Defined in \u2018GHC.Show\u2019\n        instance Show a =&gt; Show (Maybe a) -- Defined in \u2018GHC.Show\u2019\n        ...plus 22 others\n        ...plus 11 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the expression: print $ quicksort []\n      In an equation for \u2018main\u2019: main = print $ quicksort []\n</code></pre>\n\n<p>one telling you that ghc cannot tell what <code>Show</code> instance to use and ghc 8 already tells you how to solve this:</p>\n\n<p>add a type annotation (as @duplode already suggested)</p>\n\n<pre><code>main = print $ quicksort ([] :: [Int])\n</code></pre>\n\n<p>Quite similar but slightly different is the second error message</p>\n\n<pre><code>foo.hs:3:16: error:\n    \u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018quicksort\u2019\n      prevents the constraint \u2018(Ord a0)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n      These potential instances exist:\n        instance Ord Ordering -- Defined in \u2018GHC.Classes\u2019\n        instance Ord Integer\n          -- Defined in \u2018integer-gmp-1.0.0.1:GHC.Integer.Type\u2019\n        instance Ord a =&gt; Ord (Maybe a) -- Defined in \u2018GHC.Base\u2019\n        ...plus 22 others\n        ...plus five instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the second argument of \u2018($)\u2019, namely \u2018quicksort []\u2019\n      In the expression: print $ quicksort []\n      In an equation for \u2018main\u2019: main = print $ quicksort []\n</code></pre>\n\n<p>Where in the first message the <code>print</code> function demanded a <code>Show</code> instance - here you promised the <code>quicksort</code> to supply a list of orderables - but did not say which to use, so GHC complains about what <code>Ord</code> to use.</p>\n\n<p>Both messages are due to the fact that <code>[]</code> is too polymorphic it could be a list of anything - <code>[Int]</code> is good, but it could also be something like <code>[Int -&gt; Bool]</code> which is neither <code>Show</code>able nor <code>Ord</code>erable.</p>\n\n<p>You could as well supply <code>quicksort</code> with something weird like a</p>\n\n<pre><code>newtype HiddenInt = HI Int deriving (Ord) --but not Show\n</code></pre>\n\n<p>which would work for the <code>quicksort</code> function but not for <code>print</code>.</p>\n\n<p><strong>Side Note</strong></p>\n\n<p>Your <code>quicksort</code> functions need to be recursive in order to really be correct - as I pointed out in my comments - there is a logical problem in your algorithm - be sure to test your functions properly e.g.</p>\n\n<pre><code>import Data.List (sort)\n\nmain :: IO ()\nmain = do print $ \"quicksort [10,9..1] == Just (sort [10,9..1]) is: \"\n           ++ show $ quicksort ([10,9..1]::Int]) == Just (sort ([10,9..1]::Int]))\n          print $ \"quicksort [5,5,5] == Just (sort [5,5,5]) is: \"\n           ++ show $ quicksort ([5,5,5] :: [Int]) == Just (sort ([5,5,5] :: [Int]))\n\nquicksort :: (Ord a) =&gt; [a] -&gt; Maybe [a]\nquicksort = ...\n</code></pre>\n\n<p>or if you are interested take a look at <a href=\"https://hackage.haskell.org/package/QuickCheck\" rel=\"nofollow\">QuickCheck</a> - which is a bit more advanced, but a step in the right direction for verifying your algorithms/functions work the way you expect them.</p>\n"}], "owner": {"reputation": 437, "user_id": 5775622, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/64YBh.png?s=128&g=1", "display_name": "1234", "link": "https://stackoverflow.com/users/5775622/1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 40199325, "answer_count": 1, "score": 1, "last_activity_date": 1477195056, "creation_date": 1477189920, "question_id": 40198965, "link": "https://stackoverflow.com/questions/40198965/write-quick-sort-in-haskell-and-need-help-to-resolve-the-issue", "title": "Write Quick Sort in Haskell and need help to resolve the issue", "body": "<p>I try to write a quick sort in Haskell and I knew there are many versions out there.</p>\n\n<p>This one is pretty simple for Int type</p>\n\n<pre><code>quickSort1::[Int]-&gt;[Int]\nquickSort1 [] = []\nquickSort1 (x:xs) = [l | l &lt;- xs, l &lt; x] ++ [x] ++ [ r | r &lt;- xs, r &gt; x]\n</code></pre>\n\n<p>I can print on Main as following </p>\n\n<pre><code>print $ quickSort1 []   -- output []\nprint $ quickSort1 [2, 1] -- output [1, 2]\n</code></pre>\n\n<p>I modified the above quickSort1 to \"more general\" type with (Ord a) instead of Int</p>\n\n<pre><code>quickSort2::(Ord a)=&gt;[a]-&gt;Maybe [a]\nquickSort2 [] = Nothing \nquickSort2 (x:xs)  = Just $ [ l | l &lt;- xs, l &lt; x] ++ [x] ++ [ r | r &lt;- xs, r &gt; x] \n</code></pre>\n\n<p>On my Main, I can run</p>\n\n<p>it works</p>\n\n<pre><code>print $ quickSort2 [2, 1] -- output [1, 2]\n</code></pre>\n\n<p>I got compiler error when I run following</p>\n\n<pre><code>print $ quickSort2 [] -- got error \n</code></pre>\n\n<p>Can anyone explain to me what is going on with my new version of quickSort2</p>\n"}, {"tags": ["haskell", "types", "idris"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1477172861, "post_id": 40197310, "comment_id": 67660618, "body": "Though it is a trick I have merely heard about, I suspect you might be looking for <a href=\"http://stackoverflow.com/q/28690448/2751851\">indexed monads</a>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1477178313, "post_id": 40197310, "comment_id": 67661732, "body": "If you want, you can always also use <code>RebindableSyntax</code> to get <code>do</code> without having to make an actual <code>Monad</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "edited": false, "score": 0, "creation_date": 1477205790, "post_id": 40199858, "comment_id": 67665864, "body": "Thanks for the detailed and very helpful answer. I suspect that I could use <code>RebindableSyntax</code> to actually get <code>do</code>-notation in the case of type-aligned list."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 2, "creation_date": 1477216958, "post_id": 40199858, "comment_id": 67668222, "body": "Note that the use of indexed monads in this (Bob Atkey) sense is good while all operations have a predictable effect on the state of the door. If you ever want to give some control away, e.g. to the people on the other side of the door (who might choose to open it or not), you&#39;ll benefit from something more flexible."}, {"owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "edited": false, "score": 0, "creation_date": 1477218854, "post_id": 40199858, "comment_id": 67668705, "body": "Indeed. I have read this other SO post on indexed monads: <a href=\"http://stackoverflow.com/questions/28690448/what-is-indexed-monad\" title=\"what is indexed monad\">stackoverflow.com/questions/28690448/what-is-indexed-monad</a> and currently tackling your paper :) Is it possible to get same behaviour without HSE preprocessor? I should try by myself of course, but did not find time to do it yet and I suspect the answer is yes."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1477222052, "post_id": 40199858, "comment_id": 67669523, "body": "Sure. All SHE does is conceal the singleton encoding, to make things appear more like dependently typed programming."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "edited": false, "score": 0, "creation_date": 1477227852, "post_id": 40199858, "comment_id": 67670995, "body": "@insitu yeah, I guess you could abuse <code>RebindableSyntax</code> like that. But from an engineering perspective I don&#39;t think it&#39;s a very good idea to use <code>do</code> notation for things that aren&#39;t monads."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1477228211, "post_id": 40199858, "comment_id": 67671109, "body": "@pigworker Out of curiosity, what do you make of <a href=\"https://www.eyrie.org/~zednenem/2012/07/29/paramonads\" rel=\"nofollow noreferrer\">this post</a> claiming that your and Atkey&#39;s indexed monads are equally powerful? I guess it&#39;s just a question of which is more natural to use in a given application?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 2, "creation_date": 1477228461, "post_id": 40199858, "comment_id": 67671167, "body": "I note that the translation from monads on indexed sets to indexed monads on sets goes via continuations: i.e., by the introduction of extra control operators. When you use monads on indexed sets, you can stick with an &quot;algebraic effects&quot; style for more operations."}, {"owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "edited": false, "score": 1, "creation_date": 1477235885, "post_id": 40199858, "comment_id": 67673496, "body": "@BenjaminHodgson Interestingly, that&#39;s the route taken by Idris: &quot;Abused&quot; do notations abound in the examples given in &quot;Type Driven Development with Idris&quot;. I agree that, in Haskell, do-notation is so tightly knitted with monads that using it for something different might be asking for maintenance troubles."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 8, "last_activity_date": 1478010711, "last_edit_date": 1478010711, "creation_date": 1477200465, "answer_id": 40199858, "question_id": 40197310, "link": "https://stackoverflow.com/questions/40197310/how-to-encode-possible-state-transitions-in-type/40199858#40199858", "title": "How to encode possible state transitions in type?", "body": "<p>What you're looking for is indeed Atkey's <a href=\"http://bentnib.org/paramnotions-jfp.pdf\" rel=\"nofollow\"><em>parameterised monad</em></a>, now more commonly known as the <em>indexed monad</em>.</p>\n\n<pre><code>class IFunctor f where\n    imap :: (a -&gt; b) -&gt; f i j a -&gt; f i j b\nclass IFunctor m =&gt; IMonad m where\n    ireturn :: a -&gt; m i i a\n    (&gt;&gt;&gt;=) :: m i j a -&gt; (a -&gt; m j k b) -&gt; m i k b\n</code></pre>\n\n<p><code>IMonad</code> is the class of monad-like things <code>m :: k -&gt; k -&gt; * -&gt; *</code> describing paths through a directed graph of types belonging to the kind <code>k</code>. <code>&gt;&gt;&gt;=</code> binds a computation which takes the type-level state from <code>i</code> to <code>j</code> into a computation which takes it from <code>j</code> to <code>k</code>, returning a bigger computation from <code>i</code> to <code>k</code>. <code>ireturn</code> allows you to lift a pure value into a monadic computation which doesn't change the type-level state.</p>\n\n<p>I'm going to use the <em>indexed free monad</em> to capture the structure of this sort of request-response action, largely because I don't want to have to figure out how to write the <code>IMonad</code> instance for your type myself:</p>\n\n<pre><code>data IFree f i j a where\n    IReturn :: a -&gt; IFree f i i a\n    IFree :: f i j (IFree f j k a) -&gt; IFree f i k a\n\ninstance IFunctor f =&gt; IFunctor (IFree f) where\n    imap f (IReturn x) = IReturn (f x)\n    imap f (IFree ff) = IFree $ imap (imap f) ff\ninstance IFunctor f =&gt; IMonad (IFree f) where\n    ireturn = IReturn\n    IReturn x &gt;&gt;&gt;= f = f x\n    IFree ff &gt;&gt;&gt;= f = IFree $ imap (&gt;&gt;&gt;= f) ff\n</code></pre>\n\n<p>We can build your <code>Door</code> monad for free from the following functor:</p>\n\n<pre><code>data DoorState = Opened | Closed\ndata DoorF i j next where\n    Open :: next -&gt; DoorF Closed Opened next\n    Close :: next -&gt; DoorF Opened Closed next\n    Ring :: next -&gt; DoorF Closed Closed next\n\ninstance IFunctor DoorF where\n    imap f (Open x) = Open (f x)\n    imap f (Close x) = Close (f x)\n    imap f (Ring x) = Ring (f x)\n\ntype Door = IFree DoorF\n\nopen :: Door Closed Opened ()\nopen = IFree (Open (IReturn ()))\nclose :: Door Opened Closed ()\nclose = IFree (Close (IReturn ()))\nring :: Door Closed Closed ()\nring = IFree (Ring (IReturn ()))\n</code></pre>\n\n<p>You can <code>open</code> a door, which causes a currently-closed door to become open, <code>close</code> a currently-open door, or <code>ring</code> the bell of a door which remains closed, presumably because the house's occupant doesn't want to see you.</p>\n\n<p>Finally, the <code>RebindableSyntax</code> language extension means we can replace the standard <code>Monad</code> class with our own custom <code>IMonad</code>.</p>\n\n<pre><code>(&gt;&gt;=) = (&gt;&gt;&gt;=)\nm &gt;&gt; n = m &gt;&gt;&gt;= const n\nreturn = ireturn\nfail = undefined\n\ndoor :: Door Open Open ()\ndoor = do\n    close\n    ring\n    open\n</code></pre>\n\n<hr>\n\n<p>However I notice that you're not really using the binding structure of your monad. None of your building blocks <code>Open</code>, <code>Close</code> or <code>Ring</code> return a value. So I think what you really need is the following, simpler <em>type-aligned list</em> type:</p>\n\n<pre><code>data Path g i j where\n    Nil :: Path g i i\n    Cons :: g i j -&gt; Path g j k -&gt; Path g i k\n</code></pre>\n\n<p>Operationally, <code>Path :: (k -&gt; k -&gt; *) -&gt; k -&gt; k -&gt; *</code> is like a linked list, but it has some extra type-level structure, once again describing a path through a directed graph whose nodes are in <code>k</code>. The elements of the list are edges <code>g</code>. <code>Nil</code> says you can always find a path from a node <code>i</code> to itself and <code>Cons</code> reminds us that a journey of a thousand miles begins with a single step: if you have an edge from <code>i</code> to <code>j</code> and a path from <code>j</code> to <code>k</code>, you can combine them to make a path from <code>i</code> to <code>k</code>. It's called a <em>type-aligned list</em> because the ending type of one element must match the starting type of the next.</p>\n\n<p>On the other side of Curry-Howard Street, if <code>g</code> is a binary logical relation then <code>Path g</code> constructs its <em>reflexive transitive closure</em>. Or, categorically, <code>Path g</code> is the type of morphisms in the <em>free category</em> of a graph <code>g</code>. Composing morphisms in the free category is just (flipped) appending type-aligned lists.</p>\n\n<pre><code>instance Category (Path g) where\n    id = Nil\n    xs . Nil = xs\n    xs . Cons y ys = Cons y (xs . ys)\n</code></pre>\n\n<p>Then we can write <code>Door</code> in terms of <code>Path</code>:</p>\n\n<pre><code>data DoorAction i j where\n    Open :: DoorAction Closed Opened\n    Close :: DoorAction Opened Closed\n    Ring :: DoorAction Closed Closed\n\ntype Door = Path DoorAction\n\nopen :: Door Closed Opened\nopen = Cons Open Nil\nclose :: Door Opened Closed\nclose = Cons Close Nil\nring :: Door Closed Closed\nring = Cons Ring Nil\n\ndoor :: Door Open Open\ndoor = open . ring . close\n</code></pre>\n\n<p>You don't get <code>do</code> notation (though I <em>think</em> <code>RebindableSyntax</code> does allow you to overload list literals), but building computations with <code>(.)</code> looks like sequencing of pure functions, which I think is a rather good analogy for what you're doing anyway. For me it requires extra brainpower - a rare and precious natural resource - to use indexed monads. It's better to avoid the complexity of monads when a simpler structure will do.</p>\n"}], "owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 2, "accepted_answer_id": 40199858, "answer_count": 1, "score": 8, "last_activity_date": 1478010711, "creation_date": 1477172200, "question_id": 40197310, "link": "https://stackoverflow.com/questions/40197310/how-to-encode-possible-state-transitions-in-type", "title": "How to encode possible state transitions in type?", "body": "<p>I am trying to replicate in Haskell this piece of Idris code, which enforces correct sequencing of actions through types:</p>\n\n<pre><code> data DoorState = DoorClosed | DoorOpen\n data DoorCmd : Type -&gt;\n                DoorState -&gt;\n DoorState -&gt;\n                Type where\n      Open : DoorCmd     () DoorClosed DoorOpen\n      Close : DoorCmd    () DoorOpen   DoorClosed\n      RingBell : DoorCmd () DoorClosed DoorClosed\n      Pure : ty -&gt; DoorCmd ty state state\n      (&gt;&gt;=) : DoorCmd a state1 state2 -&gt;\n              (a -&gt; DoorCmd b state2 state3) -&gt;\n              DoorCmd b state1 state3\n</code></pre>\n\n<p>Thanks to overloading of <code>(&gt;&gt;=)</code> operator, one can write monadic code like:</p>\n\n<pre><code>do Ring \n   Open \n   Close\n</code></pre>\n\n<p>but compiler rejects incorrect transitions like:</p>\n\n<pre><code>do Ring\n   Open \n   Ring\n   Open\n</code></pre>\n\n<p>I have tried to follow this pattern in the following Haskell fragment:</p>\n\n<pre><code> data DoorState = Closed | Opened\n\n data DoorCommand (begin :: DoorState) (end :: DoorState) a where\n   Open  :: DoorCommand 'Closed 'Opened ()\n   Close :: DoorCommand 'Opened 'Closed ()\n   Ring  :: DoorCommand 'Closed 'Closed ()\n\n   Pure  :: x -&gt; DoorCommand b e x\n   Bind  :: DoorCommand b e x -&gt; (x -&gt; DoorCommand e f y) -&gt; DoorCommand b f y\n\n instance Functor (DoorCommand b e) where\n   f `fmap` c = Bind c (\\ x -&gt; Pure (f x))\n\n -- instance Applicative (DoorCommand b e) where\n --    pure    = Pure\n --    f &lt;*&gt; x = Bind f (\\ f' -&gt; Bind x (\\ x' -&gt; Pure (f' x')))\n\n -- instance Monad (DoorCommand b e) where\n --   return = Pure\n --   (&gt;&gt;=) = Bind\n</code></pre>\n\n<p>But of course this fails: The <code>Applicative</code> and <code>Monad</code> instances cannot be defined correctly as they require two different instances to properly sequence operations. The constructor <code>Bind</code> can be used to enforce proper sequencing but I cannot manage to use the \"nicer\" do-notation. </p>\n\n<p>How could I write this code to be able to use do-notation, e.g. to prevent invalid sequences of <code>Command</code>s ?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1477169165, "post_id": 40196713, "comment_id": 67659600, "body": "Is there any particular reason why the resolver in your global project is <code>ghc-7.10.3</code>? (I think that may be the source of your issue.)"}], "answers": [{"comments": [{"owner": {"reputation": 7984, "user_id": 1398282, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/51ad9dc5224b0b292b820eeb71d17c9a?s=128&d=identicon&r=PG", "display_name": "foki", "link": "https://stackoverflow.com/users/1398282/foki"}, "edited": false, "score": 0, "creation_date": 1477215246, "post_id": 40196883, "comment_id": 67667762, "body": "Thank you. It makes sense but a bit different than standard build tools in other ecosystems I&#39;ve seen so far. <code>hindent</code> version that is installed through <code>lts-6.23</code> or even <code>lts-7.5</code> is version &lt;5 but I need 5&gt;. I&#39;ve switched to nightly to get what I need. Is my reason correct according to stack philosophy or I should specify a particular version of single package (<code>hindent</code>) somewhere?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 7984, "user_id": 1398282, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/51ad9dc5224b0b292b820eeb71d17c9a?s=128&d=identicon&r=PG", "display_name": "foki", "link": "https://stackoverflow.com/users/1398282/foki"}, "edited": false, "score": 1, "creation_date": 1477217913, "post_id": 40196883, "comment_id": 67668470, "body": "You can try specifying a version of hindent on the command line, but choosing a nightly snapshot with the desired version is a good call."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 4, "last_activity_date": 1477169190, "creation_date": 1477169190, "answer_id": 40196883, "question_id": 40196713, "link": "https://stackoverflow.com/questions/40196713/fail-with-basic-usage-of-haskell-stack/40196883#40196883", "title": "Fail with basic usage of haskell stack", "body": "<p>It's not generally recommended to use a ghc version as a resolver, for the reason you've discovered: you need to manually specify lots of package versions. Instead, I'd recommend switching to lts-6.23, or something else similar.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2913694"}, "is_accepted": false, "score": 0, "last_activity_date": 1477169766, "creation_date": 1477169766, "answer_id": 40196974, "question_id": 40196713, "link": "https://stackoverflow.com/questions/40196713/fail-with-basic-usage-of-haskell-stack/40196974#40196974", "title": "Fail with basic usage of haskell stack", "body": "<p>Not sure. If you just wanna get moving fast:</p>\n\n<pre><code>stack upgrade --git  &amp;&amp; \\\nrm -rf ~/.stack      &amp;&amp; \\\nstack setup          &amp;&amp; \\\nstack install hindent\n</code></pre>\n\n<p>Why not use GHC 8.X and a fresh new Stack? ;)</p>\n"}], "owner": {"reputation": 7984, "user_id": 1398282, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/51ad9dc5224b0b292b820eeb71d17c9a?s=128&d=identicon&r=PG", "display_name": "foki", "link": "https://stackoverflow.com/users/1398282/foki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "accepted_answer_id": 40196883, "answer_count": 2, "score": 3, "last_activity_date": 1477169766, "creation_date": 1477167982, "question_id": 40196713, "link": "https://stackoverflow.com/questions/40196713/fail-with-basic-usage-of-haskell-stack", "title": "Fail with basic usage of haskell stack", "body": "<p>I'm learning Haskell and trying to setup my Emacs development environment (reading <a href=\"https://github.com/serras/emacs-haskell-tutorial/blob/master/tutorial.md\" rel=\"nofollow\">this</a>).<br>\nOne of things I should do is to install <code>hindent</code>.<br>\nRecommended method <a href=\"https://github.com/chrisdone/hindent#install\" rel=\"nofollow\">here</a> is just <code>stack install hindent</code>. I guess it should be installed in stack's <code>global-project</code> space. My global stack yaml at <code>$HOME/.stack/global-project/stack.yaml</code> is:</p>\n\n<pre><code>flags: {}\nextra-package-dbs: []\npackages: []\nextra-deps: []\nresolver: ghc-7.10.3\n</code></pre>\n\n<p>I don't use any system <code>ghc</code> (there is no <code>ghc</code> or <code>ghci</code> on my <code>$PATH</code>).<br>\nOn <code>stack install hindent</code> it adviced me to extend <code>extra-deps</code>:</p>\n\n<pre><code>Run from outside a project, using implicit global project config\nUsing resolver: ghc-7.10.3 from implicit global project's config file: /home/me/.stack/global-project/stack.yaml\n\nWhile constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for hindent-5.2.1:\n    descriptive must match &gt;=0.7 &amp;&amp; &lt;0.10, but the stack configuration has no specified version\n                (latest applicable is 0.9.4)\n    exceptions must match -any, but the stack configuration has no specified version (latest applicable is 0.8.3)\n    haskell-src-exts must match &gt;=1.18, but the stack configuration has no specified version\n                     (latest applicable is 1.18.2)\n    monad-loops must match -any, but the stack configuration has no specified version (latest applicable is 0.4.3)\n    mtl must match -any, but the stack configuration has no specified version (latest applicable is 2.2.1)\n    path must match -any, but the stack configuration has no specified version (latest applicable is 0.5.9)\n    path-io must match -any, but the stack configuration has no specified version (latest applicable is 1.2.0)\n    text must match -any, but the stack configuration has no specified version (latest applicable is 1.2.2.1)\n    unix-compat must match -any, but the stack configuration has no specified version (latest applicable is 0.4.2.0)\n    utf8-string must match -any, but the stack configuration has no specified version (latest applicable is 1.0.1.1)\n    yaml must match -any, but the stack configuration has no specified version (latest applicable is 0.8.20)\n\nRecommended action: try adding the following to your extra-deps in /home/me/.stack/global-project/stack.yaml:\n- descriptive-0.9.4\n- exceptions-0.8.3\n- haskell-src-exts-1.18.2\n- monad-loops-0.4.3\n- mtl-2.2.1\n- path-0.5.9\n- path-io-1.2.0\n- text-1.2.2.1\n- unix-compat-0.4.2.0\n- utf8-string-1.0.1.1\n- yaml-0.8.20\n</code></pre>\n\n<p>When I do what is proposed it suggests some new dependencies (which are probably dependencies of those which are added before) etc. At the end it results in situatuation where some two dependencies have unmet versions.  </p>\n\n<p>I presume that something is wrong with my configuration (or understanding of stack) since I think that obtaining implicit dependencies is job of a build tool.  </p>\n\n<p>Does someone more experienced can infer what is my beginner fault?</p>\n"}, {"tags": ["haskell", "time", "gloss"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477161788, "post_id": 40195580, "comment_id": 67657269, "body": "Not an answer: one thing to make absolutely clear is that the <code>time</code> in <code>main</code> and the <code>time</code> in <code>timeHandler</code> have nothing to do with each other -- in fact, they don&#39;t even have the same type. The former is a local value you got by executing <code>getPosixTime</code>, while the latter is a parameter in an independent function definition. They just happen to have the same name."}, {"owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477162265, "post_id": 40195580, "comment_id": 67657415, "body": "I&#39;m aware of this @duplode ! However, according to the <code>play</code> function description, <code>timeHandler</code> should be given the time in seconds.."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1477163112, "post_id": 40195580, "comment_id": 67657706, "body": "Okay -- it&#39;s just that your phrasing in &quot;given to timeHandler in the <code>main</code> function&quot; confused me a bit. (You don&#39;t give the <code>time</code> to ` timeHandler` yourself; rather, Gloss picks it up by itself somewhere in the <code>play</code> implementation.)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477163317, "post_id": 40195580, "comment_id": 67657769, "body": "In any case, if I am understanding <a href=\"https://hackage.haskell.org/package/gloss-1.10.2.3/docs/Graphics-Gloss-Interface-Pure-Game.html#v:play\" rel=\"nofollow noreferrer\">the docs</a> correctly, the expected behaviour for your program would be rotating the picture one degree per second (i.e. 1/60 of a degree per frame), right?"}, {"owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1477163386, "post_id": 40195580, "comment_id": 67657798, "body": "Exactly, that&#39;s what I&#39;m expecting it to do."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477163396, "post_id": 40195580, "comment_id": 67657800, "body": "What is <code>draw</code> doing? You should include all your code. Also this example doesn&#39;t seem minimal - <code>seed</code> is unused in <code>initial</code> so you should just remove it. Minimizing the example more may help you see the mistake."}, {"owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "edited": false, "score": 0, "creation_date": 1477163771, "post_id": 40195580, "comment_id": 67657938, "body": "You&#39;re right, I&#39;ve updated my post including the draw function!"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "edited": false, "score": 0, "creation_date": 1477166301, "post_id": 40196254, "comment_id": 67658742, "body": "Tanks for your answer! The only thing I&#39;m a bit confused about: according to the docs of <code>play</code>, <code>updateWorld</code> should receive the time in seconds. In your code, you create your own time variable with <code>time &lt;- getCurrentTime</code>. How is this being passed to <code>updateWorld</code>?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "edited": false, "score": 1, "creation_date": 1477170417, "post_id": 40196254, "comment_id": 67659978, "body": "Where did you get that idea? I linked to the docs and I copy pasted the relevant bit - the step function <b>does not</b> get the time in seconds since the start of the simulation, or any other time, but the amount of time the simulation should be stepped (i.e. a <i>time delta</i>). In any case, the initial <code>startTime</code> and <code>time</code> declared in <code>main</code> are in the initial state - <code>play ... World{..} ...</code> - which is equivalent to <code>World{field1 = field1, field2 = field2, &lt;etc&gt;}</code> - this is <code>RecordWildCards</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "edited": false, "score": 2, "creation_date": 1477171010, "post_id": 40196254, "comment_id": 67660156, "body": "RecordWildCards can indeed be confusing if you are not familiar with it, and isn&#39;t relevant to the problem, so I got rid of it and used regular record syntax."}, {"owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "edited": false, "score": 0, "creation_date": 1477217898, "post_id": 40196254, "comment_id": 67668465, "body": "That makes sense. Keeping track of time in a state in a language like Haskell is only logical. Thanks!"}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 3, "last_activity_date": 1477170951, "last_edit_date": 1477170951, "creation_date": 1477165054, "answer_id": 40196254, "question_id": 40195580, "link": "https://stackoverflow.com/questions/40195580/haskell-gloss-time-variable-stays-constant/40196254#40196254", "title": "Haskell Gloss: time variable stays constant", "body": "<p>Naturally it doesn't work, <code>timeHandler</code> receives a number which, in practice, is close to the time delta since the previous frame - the <a href=\"https://hackage.haskell.org/package/gloss-1.10.2.3/docs/Graphics-Gloss-Interface-Pure-Game.html#t:Event\" rel=\"nofollow\">docs</a> say: \"A function to step the world one iteration. It is passed the period of time (in seconds) needing to be advanced.\" - and presumably frame time is about constant, so naturally one would expect the output to be about constant (and a number very close to 0).</p>\n\n<p>You need to collect all the deltas and add them up. If you are just concerned with time since the start of your simulation, then you don't need <code>getCurrentTime</code> in <code>main</code> - just add the deltas. This means you <em>must</em> store the time in your state. If you do need to deal with real time, I suggest you stick with <code>UTCTime</code> or another abstraction which makes it clear what quantity you are manipulating: </p>\n\n<pre><code>import Graphics.Gloss \nimport Graphics.Gloss.Interface.Pure.Game\nimport Data.Time.Clock\n\ndata World = World \n  { startTime \n  , time :: UTCTime \n  } \n\n-- make explicit what units are being used\nseconds2DiffTime :: Float -&gt; NominalDiffTime\nseconds2DiffTime = realToFrac \ndiffTime2seconds :: NominalDiffTime -&gt; Float \ndiffTime2seconds = realToFrac \n\ndisplayWorld World{time,startTime} = \n  Rotate rot $ color red $ Polygon[(-10, 100), (10, 100), (0, 125)]\n    where rot = diffTime2seconds $ diffUTCTime time startTime \n\nupdateWorld dt w = w {time = addUTCTime (seconds2DiffTime dt) $ time w}\n\nmain = do \n  t0 &lt;- getCurrentTime\n  let initialState = World { time = t0, startTime = t0 }\n  play (InWindow \"\" (400,400) (400,400)) \n       white\n       30 \n       intialState \n       displayWorld \n       (const id) \n       updateWorld\n</code></pre>\n\n<p>This gets you both the elapsed time since the start of the simulation, as well as the real clock time. </p>\n\n<p>Note that you should not place picture drawing code inside of <code>timeHandler</code> - this function could be called much more frequently than is needed to redraw the picture, resulting in a lot of extra work. Instead do your drawing in <code>displayWorld</code> as above. </p>\n"}], "owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 40196254, "answer_count": 1, "score": 1, "last_activity_date": 1477170951, "creation_date": 1477160767, "last_edit_date": 1477163711, "question_id": 40195580, "link": "https://stackoverflow.com/questions/40195580/haskell-gloss-time-variable-stays-constant", "title": "Haskell Gloss: time variable stays constant", "body": "<p>I'm trying to rotate a Picture in Haskell, using the current time as a value for a rotate function. I've got the following <code>main</code> function:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    args &lt;- getArgs\n    time &lt;- round &lt;$&gt; getPOSIXTime\n    let initial'        = initial time\n    let (w, h, display) = chooseDisplay args\n    let background      = black\n    let fps             = 60\n    play display background fps initial' (draw w h) eventHandler timeHandler\n</code></pre>\n\n<p>The triangle (=player) is stored inside a 'World' data type:\n    module Model where</p>\n\n<pre><code>data World = World {\n        -- all kinds of World properties --\n        player           :: Picture\n    }\n</code></pre>\n\n<p>Then I have a function <code>initial</code> which initializes the World, and a function <code>playerBody</code> which, given a rotation value, returns a picture of <code>player</code>:</p>\n\n<pre><code>initial :: Int -&gt; World\ninitial _ = World{player = playerBody 0}\n\nplayerBody :: Float -&gt; Picture\nplayerBody rot = Rotate rot $ color red $ Polygon[(-10, 100), (10, 100), (0, 125)]\n</code></pre>\n\n<p>The draw function is defined as follows:</p>\n\n<pre><code>draw :: Float -&gt; Float -&gt; World -&gt; Picture\ndraw _ _ world = player world\n</code></pre>\n\n<p>It currently simply returns the <code>player</code>Picture.</p>\n\n<p>Now, in my timeHandler module, I want to use the time (given to timeHandler in the <code>main</code> function) to rotate <code>player</code> as follows:</p>\n\n<pre><code>timeHandler :: Float -&gt; World -&gt; World\ntimeHandler time = (\\world -&gt; world {player = playerBody time} )\n</code></pre>\n\n<p>This doesn't work. I replaced <code>time</code> with a constant value (in the timeHandler function), and that did rotate the Picture. So it seems like <code>time</code> is not being updated.. what am I doing wrong? </p>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1477155830, "post_id": 40194679, "comment_id": 67655394, "body": "Applicative composition is what you need. Lookup <code>liftA2</code> or <code>&lt;*&gt;</code> and <code>&lt;$&gt;</code> in Hoogle."}, {"owner": {"reputation": 165, "user_id": 5456966, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8dc04bf934c404853fcf447efe2dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "ols", "link": "https://stackoverflow.com/users/5456966/ols"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1477210874, "post_id": 40194679, "comment_id": 67666818, "body": "Thanks very much for your answer !"}], "answers": [{"tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": false, "score": 3, "last_activity_date": 1477157137, "last_edit_date": 1477157137, "creation_date": 1477156489, "answer_id": 40194887, "question_id": 40194679, "link": "https://stackoverflow.com/questions/40194679/checking-maybe-values/40194887#40194887", "title": "Checking Maybe values", "body": "<p>You can use the <code>Maybe</code> monad to chain together a sequence of operations that should only happen if the value is a <code>Just</code>.  If the value is a <code>Nothing</code>, then the chain will stop:</p>\n\n<pre><code>hexToInt :: String -&gt; Maybe Int\nhexToInt (x:y:[]) = do\n    a &lt;- nibbleToInt x  -- chain will end if nibbleToInt evaluates to Nothing\n    b &lt;- nibbleToInt y  -- chain will end if nibbleToInt evaluates to Nothing\n    return (a * 16 + b) -- chain completed successfully\nhexToInt _ = Nothing\n\nhexToInts :: String -&gt; Maybe [Int]\nhexToInts [] = return []\nhexToInts (n1:n2:ns) = do\n    i &lt;- hexToInt (n1:[n2]) -- chain will end if hexToInt evaluates to Nothing\n    is &lt;- hexToInts ns      -- chain will end if hexToInts evaluates to Nothing\n    return (i:is)           -- chain completed successfully\nhexToInts _ = Nothing\n</code></pre>\n\n<p>You could also use <code>Applicative</code> style which does the same thing in a more functional style:</p>\n\n<pre><code>hexToInt :: String -&gt; Maybe Int\nhexToInt (x:y:[]) = f &lt;$&gt; nibbleToInt x &lt;*&gt; nibbleToInt y where\n    f a b = a * 16 + b\nhexToInt _ = Nothing\n\nhexToInts :: String -&gt; Maybe [Int]\nhexToInts [] = return []\nhexToInts (n1:n2:ns) = (:) &lt;$&gt; hexToInt (n1:[n2]) &lt;*&gt; hexToInts ns\nhexToInts _ = Nothing\n</code></pre>\n\n<p>Note that <code>hexToInts</code> can use <code>splitAt</code> to break the list:</p>\n\n<pre><code>hexToInts :: String -&gt; Maybe [Int]\nhexToInts [] = return []\nhexToInts ns = (:) &lt;$&gt; hexToInt a &lt;*&gt; hexToInts as where\n    (a, as) = splitAt 2 ns\n</code></pre>\n\n<p>Or write a helper function to pair-up the elements of the list, and use <code>mapM</code> to apply the monadic function over the pairs:</p>\n\n<pre><code>toPairs :: [a] -&gt; [[a]]\ntoPairs [] = []\ntoPairs xs = a : toPairs as where\n    (a, as) = splitAt 2 xs\n\nhexToInts :: String -&gt; Maybe [Int]\nhexToInts = mapM hexToInt . toPairs\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 5456966, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8dc04bf934c404853fcf447efe2dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "ols", "link": "https://stackoverflow.com/users/5456966/ols"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1001, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477157137, "creation_date": 1477155262, "last_edit_date": 1477156069, "question_id": 40194679, "link": "https://stackoverflow.com/questions/40194679/checking-maybe-values", "title": "Checking Maybe values", "body": "<p>I am just a beginner in Haskell, and I try to do <a href=\"http://cryptopals.com\" rel=\"nofollow\">cryptopals</a> crypto challenges in Haskell.</p>\n\n<p>I wrote the following code:</p>\n\n<pre><code>import Data.Char\n\nnibbleToInt :: Char -&gt; Int\nnibbleToInt c\n    | ('0' &lt;= c &amp;&amp; c &lt;= '9') = (ord c) - 48\n    | ('a' &lt;= c &amp;&amp; c &lt;= 'f') = (ord c) - 87\n    | ('A' &lt;= c &amp;&amp; c &lt;= 'F') = (ord c) - 55\n    | otherwise = error \"Boom\"\n\n\nhexToInt :: String -&gt; Int\nhexToInt (x:y:[]) = nibbleToInt x * 16 + nibbleToInt y\nhexToInt _ = error \"Boom\"\n\nhexToInts :: String -&gt; [Int]\nhexToInts [] = []\nhexToInts (n1:n2:ns) = [hexToInt $ [n1] ++ [n2]] ++ (hexToInts ns)\nhexToInts _ = error \"Boom\"\n\nmain = do\n    print $ hexToInts \"49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d\"\n</code></pre>\n\n<p>This code seems to work, but I am sure that it can be improved!</p>\n\n<p>I refactored the <code>nibbleToInt</code> function to use a <code>Maybe</code>:</p>\n\n<pre><code>nibbleToInt :: Char -&gt; Maybe Int\nnibbleToInt c\n    | ('0' &lt;= c &amp;&amp; c &lt;= '9') = Just ((ord c) - 48)\n    | ('a' &lt;= c &amp;&amp; c &lt;= 'f') = Just ((ord c) - 87)\n    | ('A' &lt;= c &amp;&amp; c &lt;= 'F') = Just ((ord c) - 55)\n    | otherwise = Nothing\n</code></pre>\n\n<p>However, then, I do not know how to rewrite the function hexToInt, as it calls the <code>nibbleToInt</code> function twice, which returns the <code>Maybe Int</code>. I do not know how to test those two values.</p>\n\n<p>Any help is welcome, as I do not know any Haskell programmer around me...</p>\n"}, {"tags": ["haskell", "catamorphism", "recursion-schemes"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477148554, "post_id": 40193154, "comment_id": 67653134, "body": "What is <code>run</code>? Is it <code>eval</code>, or <code>eval . parse</code>, or something else? (in general your question should contain code which one can actually compile and run, not just example type signatures). It seems like <code>run</code> is parsing and evaluating in one step, which is a mistake - the expression &quot;3+x&quot; is <i>not</i> a parse error, it is a semantic error. (you only find out the error when parsing is finished and you are trying to eval). Abandon this idea, as it gains you nothing over separate parsing and evaluation."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477148903, "post_id": 40193154, "comment_id": 67653244, "body": "Furthermore, switching to <code>Cofree</code> again seems to gain you nothing. What is wrong with <code>Fix (Expr :+: K ParsePositions)</code> or <code>data (:&amp;) f x a = f x :&amp; a; Fix (Expr :&amp; ParsePositions)</code>? These are isomorphic to <code>Cofree Expr ParsePositions</code> but it doesn&#39;t require you change the underlying type everywhere in your code. Is there a compelling reason for switching to <code>Cofree</code>? Are you looking to use some advanced feature of <code>Cofree</code>? If so, which one?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1477233371, "post_id": 40193154, "comment_id": 67672769, "body": "I think this question is more or less a duplicate of <a href=\"https://stackoverflow.com/questions/38462563/how-to-work-with-ast-with-cofree-annotation\"><i>How to work with AST with Cofree annotation?</i></a>. In my answer to that question I point out that <code>Cofree</code> isn&#39;t necessarily the best choice for labelling syntax trees and that a plain old functor product will do the job."}], "owner": {"reputation": 1259, "user_id": 1846272, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8c6a913c20ee6f2001ce85198b887bac?s=128&d=identicon&r=PG", "display_name": "Golly", "link": "https://stackoverflow.com/users/1846272/golly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1477146194, "creation_date": 1477145668, "last_edit_date": 1477146194, "question_id": 40193154, "link": "https://stackoverflow.com/questions/40193154/how-to-mix-cofree-into-a-f-algebra-catamorphism", "title": "How to mix CoFree into a F-algebra catamorphism?", "body": "<p>Firstly, this builds on <a href=\"https://www.schoolofhaskell.com/user/bartosz/understanding-algebras\" rel=\"nofollow\">https://www.schoolofhaskell.com/user/bartosz/understanding-algebras</a>\nso please read for context if unfamiliar with algebras and recursion schemes.</p>\n\n<p>Say I have a simple expression parser:</p>\n\n<pre><code>data Expr a = ... -- whatever\nparse :: String -&gt; Fix Expr\neval :: Algebra Expr (Either String Int)\n</code></pre>\n\n<p>It may or may not succeed. Example:</p>\n\n<pre><code>cata eval $ parse \"3+4\" -- Right 7\ncata eval $ parse \"3+x\" -- Left \"x not defined\"\n</code></pre>\n\n<p>My question is, if one were to</p>\n\n<p>1) update the <code>parse</code> function to annotate nodes with parse positions</p>\n\n<p>2) prefix error messages with the parsing positions</p>\n\n<p>how could I integrate these new functions below, with those above?</p>\n\n<pre><code>type ParsePositions = (Int,Int)\nparse' :: String -&gt; Cofree Expr ParsePositions\nprefixError :: ParsePositions -&gt; String -&gt; String\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>run \"3+4\" -- Right 7\nrun \"3+x\" -- Left \"Error parsing [2,2]: x not defined\"\n</code></pre>\n\n<p>Would this be a zygomorphism? Maybe a histomorphism? Both would need some type contortion.</p>\n\n<p>Bonus points: should I be using an elgot algebra to short-circuit on failure seeing evaluation can return <code>Left String</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1477122401, "post_id": 40189518, "comment_id": 67645962, "body": "Change <code>[[(a,b)]|b&lt;-[0..y-1],a&lt;-[0..x-1]]</code> into <code>[[(a,b)|a&lt;-[0..x-1]]|b&lt;-[0..y-1]]</code>"}, {"owner": {"reputation": 17, "user_id": 6032856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SWffB.jpg?s=128&g=1", "display_name": "ergoforce", "link": "https://stackoverflow.com/users/6032856/ergoforce"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1477123781, "post_id": 40189518, "comment_id": 67646274, "body": "Thank you! I see what you did there, it looks so easy now, I can&#39;t believe I&#39;ve been breaking my head over this."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1477127538, "post_id": 40189518, "comment_id": 67647203, "body": "No worries! Glad to have helped. :)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1477147972, "post_id": 40189518, "comment_id": 67652979, "body": "@Alec that should have been an answer\u2026"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1477157738, "post_id": 40189518, "comment_id": 67655965, "body": "@Zeta I disagree. An answer is accompanied with an explanation.  Like what you just did. :)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1477218614, "post_id": 40189518, "comment_id": 67668637, "body": "@Alec: Yeah, but my answer missed the nested list comprehension."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6032856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SWffB.jpg?s=128&g=1", "display_name": "ergoforce", "link": "https://stackoverflow.com/users/6032856/ergoforce"}, "edited": false, "score": 0, "creation_date": 1477210839, "post_id": 40193510, "comment_id": 67666810, "body": "I think you&#39;ve misunderstood the question, look at Alec&#39;s comment because that does what i wanted."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 17, "user_id": 6032856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SWffB.jpg?s=128&g=1", "display_name": "ergoforce", "link": "https://stackoverflow.com/users/6032856/ergoforce"}, "edited": false, "score": 0, "creation_date": 1477218594, "post_id": 40193510, "comment_id": 67668632, "body": "@ergoforce Whoops. You&#39;re right. I was somewhat in a hurry yesterday and missed the nested list comprehension."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 1, "last_activity_date": 1477218551, "last_edit_date": 1477218551, "creation_date": 1477147944, "answer_id": 40193510, "question_id": 40189518, "link": "https://stackoverflow.com/questions/40189518/how-do-i-create-a-list-of-lists-of-pairs-ordered-and-grouped-by-the-second-eleme/40193510#40193510", "title": "How do I create a list of lists of pairs ordered and grouped by the second elements?", "body": "<p>You can think of list comprehensions as <code>[[(a, b) | b &lt;- [0..y-1]]| a&lt;-[0..x-1]]</code> like this:</p>\n\n<pre><code>for every b &lt;- [0..y-1]       \n   xs &lt;- for every a &lt;- [0..x-1]\n      add (a, b) to the resulting list\n   add xs to the resulting list\n</code></pre>\n\n<p>So if <code>a</code> in <code>(a, b)</code> should change faster, you need to swap those lines:</p>\n\n<pre><code>for every a &lt;- [0..x-1]\n   xs &lt;- for every b &lt;- [0..y-1]\n      add (a, b) to the resulting list\n   add xs to the resulting list\n</code></pre>\n\n<p>which directly results in <code>[[(a,b) | a &lt;- [0..x-1]]| b &lt;- [0..y-1]]</code>.</p>\n"}], "owner": {"reputation": 17, "user_id": 6032856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SWffB.jpg?s=128&g=1", "display_name": "ergoforce", "link": "https://stackoverflow.com/users/6032856/ergoforce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 40193510, "answer_count": 1, "score": 1, "last_activity_date": 1477220330, "creation_date": 1477121461, "last_edit_date": 1477220330, "question_id": 40189518, "link": "https://stackoverflow.com/questions/40189518/how-do-i-create-a-list-of-lists-of-pairs-ordered-and-grouped-by-the-second-eleme", "title": "How do I create a list of lists of pairs ordered and grouped by the second elements?", "body": "<pre><code>sorteerOpY :: (Int, Int) -&gt; [[(Int, Int)]]\nsorteerOpY (x,y) = [[(a,b)]|b&lt;-[0..y-1],a&lt;-[0..x-1]]\n</code></pre>\n\n<p>This is what I have right now, <code>sorteerOpY (2,3)</code> results in:</p>\n\n<pre><code>[[(0,0)],[(1,0)],[(0,1)],[(1,1)],[(0,2)],[(1,2)]]\n</code></pre>\n\n<p>But this is what I want it to result in:</p>\n\n<pre><code>[[(0,0),(1,0)],[(0,1),(1,1)],[(0,2),(1,2)]]\n</code></pre>\n\n<p>What do I need to change so that my list gets created correctly?</p>\n"}, {"tags": ["haskell", "types", "lambda", "functional-programming", "unfold"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1477096028, "post_id": 40187112, "comment_id": 67641743, "body": "Hint: replace <code>b</code> with <code>(b, c)</code> in the type signature of <code>unfoldr</code> and see what happens."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6880689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4937fb16b43430464a92ecb346d7daa6?s=128&d=identicon&r=PG", "display_name": "Reminia Scarlet", "link": "https://stackoverflow.com/users/6880689/reminia-scarlet"}, "is_accepted": false, "score": -1, "last_activity_date": 1477096641, "creation_date": 1477096641, "answer_id": 40187184, "question_id": 40187112, "link": "https://stackoverflow.com/questions/40187112/how-lambda-function-in-unfoldr-can-be-used-with-two-arguments-in-haskell/40187184#40187184", "title": "How lambda function in unfoldr can be used with two arguments in Haskell?", "body": "<p>First, unforldr aplied to func ((a,b) -> Just (a, (b, a+b)))</p>\n\n<p>returns a function b -> [a]. This is a currying.</p>\n\n<p>Then the result function is applied to the second argument (0, 1)</p>\n\n<p>which ends a final result.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 6, "last_activity_date": 1477145452, "last_edit_date": 1477145452, "creation_date": 1477098520, "answer_id": 40187356, "question_id": 40187112, "link": "https://stackoverflow.com/questions/40187112/how-lambda-function-in-unfoldr-can-be-used-with-two-arguments-in-haskell/40187356#40187356", "title": "How lambda function in unfoldr can be used with two arguments in Haskell?", "body": "<p>This is your function:</p>\n\n<pre><code>GHCi&gt; let foo = \\(a,b) -&gt; Just(a,(b,a+b))\n</code></pre>\n\n<p>While we can certainly interpret it in our heads as a function of two arguments, as far as Haskell is concerned it only takes one argument...</p>\n\n<pre><code>foo :: Num t =&gt; (t, t) -&gt; Maybe (t, (t, t))\n</code></pre>\n\n<p>... a <em>pair</em> of type <code>(t, t)</code> for some <code>t</code> in the <code>Num</code> class. All that is going on in your example, then, is that the <code>b</code> in <code>unfoldr</code>'s signature is being replaced by <code>Num t =&gt; (t, t)</code>, and <code>a</code> by <code>Num t =&gt; t</code>, resulting in:</p>\n\n<pre><code>Num t =&gt; ((t, t) -&gt; Maybe (t, (t, t))) -&gt; (t, t) -&gt; [t]\n</code></pre>\n\n<p>Some extra evidence of that:</p>\n\n<pre><code>GHCi&gt; :t unfoldr (\\(a,b) -&gt; Just (a,(b,a+b)))\nunfoldr (\\(a,b) -&gt; Just (a,(b,a+b))) :: Num a =&gt; (a, a) -&gt; [a]\n</code></pre>\n\n<hr>\n\n<p>With your immediate question answered, here is a little digression. Another way of passing two arguments to a Haskell function is passing them separately, as opposed to in a pair:</p>\n\n<pre><code>GHCi&gt; let foo2 a b = Just(a,(b,a+b))\nGHCi&gt; :t foo2\nfoo2 :: Num t =&gt; t -&gt; t -&gt; Maybe (t, (t, t))\n</code></pre>\n\n<p>Obviously, if you still have <code>foo</code> around you don't even need to rewrite the implementation:</p>\n\n<pre><code>GHCi&gt; let foo2 a b = foo (a, b)\nGHCi&gt; :t foo2\nfoo2 :: Num t =&gt; t -&gt; t -&gt; Maybe (t, (t, t))\n</code></pre>\n\n<p>In fact, this transformation -- which in jargon is called <em>currying</em> -- is <em>always</em> possible, and there is even a function for doing that...</p>\n\n<pre><code>GHCi&gt; let foo2 = curry foo\nGHCi&gt; :t foo2\nfoo2 :: Num t =&gt; t -&gt; t -&gt; Maybe (t, (t, t))\n</code></pre>\n\n<p>... as well as another one for going in the opposite direction:</p>\n\n<pre><code>GHCi&gt; :t uncurry foo2\nuncurry foo2 :: Num t =&gt; (t, t) -&gt; Maybe (t, (t, t))\n</code></pre>\n\n<p>What might be surprising in all that, however, is how even <code>foo2</code>, which looks even more like a function of two arguments than <code>foo</code>, still is a function of one argument! The trick is that a signature like that of <code>foo2</code>...</p>\n\n<pre><code>foo2 :: Num t =&gt; t -&gt; t -&gt; Maybe (t, (t, t))\n</code></pre>\n\n<p>... has some omitted, optional parentheses. The omission conceals the fact that the function arrow, <code>-&gt;</code>, is right-associative. If we add them, we get:</p>\n\n<pre><code>foo2 :: Num t =&gt; t -&gt; (t -&gt; Maybe (t, (t, t)))\n</code></pre>\n\n<p>That is, <code>foo2</code> takes one argument (that is, our first argument) and returns another function which also takes one argument (that is, <em>our</em> second argument).</p>\n\n<hr>\n\n<p>The main takeaway, then, is that <strong>all Haskell functions take just one argument</strong>. Fortunately, it is very easy to write functions that work as if they took two arguments. More often than not, that is done by writing the function in a curried way (that is, as a function like <code>foo2</code> that returns another function), but sometimes it is necessary or convenient to pass multiple values in a pair, as you had to do in your example. </p>\n"}], "owner": {"reputation": 8046, "user_id": 1774391, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/96ec1a791090d470daa3338f3dfdf996?s=128&d=identicon&r=PG", "display_name": "MainstreamDeveloper00", "link": "https://stackoverflow.com/users/1774391/mainstreamdeveloper00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 40187356, "answer_count": 2, "score": 1, "last_activity_date": 1477149500, "creation_date": 1477095854, "last_edit_date": 1477149500, "question_id": 40187112, "link": "https://stackoverflow.com/questions/40187112/how-lambda-function-in-unfoldr-can-be-used-with-two-arguments-in-haskell", "title": "How lambda function in unfoldr can be used with two arguments in Haskell?", "body": "<p>When reading <a href=\"https://wiki.haskell.org/The_Fibonacci_sequence#With_unfoldr\" rel=\"nofollow\">this article</a> I found example of generating Fibonacci sequence with <code>unfoldr</code> function:</p>\n\n<pre><code>fibs = unfoldr (\\(a,b) -&gt; Just (a,(b,a+b))) (0,1)\n</code></pre>\n\n<p>But when I looked at <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:unfoldr\" rel=\"nofollow\">documentation</a> I found that lambda in <code>unfoldr</code> function takes only one argument <code>b</code>:</p>\n\n<pre><code>unfoldr :: (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]\n</code></pre>\n\n<p>Examples in the doc also demonstrate only one argument usage:</p>\n\n<pre><code>unfoldr (\\b -&gt; if b == 0 then Nothing else Just (b, b-1)) 10\n</code></pre>\n\n<p>So, I'm interested how can it be applied to two arguments as in Fibonacci example?</p>\n"}, {"tags": ["windows", "haskell", "cabal", "portability"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1477084196, "post_id": 40185235, "comment_id": 67638561, "body": "Your best bet will probably be to use <code>stack</code>, which seems to be pretty well arranged for this kind of thing. But I don&#39;t know enough to tell you <i>how</i>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1477086438, "post_id": 40185235, "comment_id": 67639458, "body": "I agree with @dfeuers suggestion. Without finding a global project config, stack will check the environment for <code>STACK_ROOT</code> and put all of its stuff in that directory. You could write a simple shell script which locates the directory of the script and sets <code>STACK_ROOT</code> appropriately. Since this is windows, I suppose you would have to use batch (this is where my expertise ends). Copying said script would theoretically still work, if it is looking for the directory in which it actually resides. No Haskell installation I know of does this, though."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477091075, "post_id": 40185235, "comment_id": 67640753, "body": "@user2407038 and dfeuer&#39;s plan sounds like a sensible one. It seems to be possible to achieve a similar effect with <i>cabal-install</i> sandboxes rather than <i>stack</i>, as suggested <a href=\"http://christiaanb.github.io/posts/relocatable-sandboxes/\" rel=\"nofollow noreferrer\">in this blog post</a>. I have never actually trying doing that, or anything like it, though."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1477113873, "post_id": 40185235, "comment_id": 67644268, "body": "@duplode, I believe stack is likely to be better at sticking the rest of the Haskell stuff (like GHC itself) in the same box."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1477114239, "post_id": 40185235, "comment_id": 67644319, "body": "@dfeuer Yup, that is likely."}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 4194142, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4caa70e31bd77d2e91d0f819abe682f9?s=128&d=identicon&r=PG&f=1", "display_name": "Glaukon", "link": "https://stackoverflow.com/users/4194142/glaukon"}, "is_accepted": false, "score": 2, "last_activity_date": 1477858602, "last_edit_date": 1495540989, "creation_date": 1477400757, "answer_id": 40240822, "question_id": 40185235, "link": "https://stackoverflow.com/questions/40185235/truly-portable-haskell-installation-on-windows/40240822#40240822", "title": "Truly portable Haskell installation on Windows", "body": "<p>Follow the process as described below:</p>\n\n<ol>\n<li><p>Use <em>portable install</em> to install <a href=\"https://www.haskell.org/platform/\" rel=\"nofollow noreferrer\">Haskell Platform</a> in e.g. <code>h:\\dev\\hp</code>. Select <em>Do not create shortcuts</em>. For <em>Haskell Stack Setup</em>, choose <code>h:\\dev\\hp\\local\\bin</code> as the destination folder. <strong>De</strong>select <em>Add to user %PATH%</em>.</p></li>\n<li><p>You should get the following (first level) directory structure:</p>\n\n<pre><code>dev\n  hp\n    8.0.1\n    local\n      bin (this where stack.exe gets installed)\n</code></pre></li>\n<li><p>Create additional subfolders:</p>\n\n<pre><code>mkdir projects\nmkdir user\ncd user\nmkdir AppData\nmkdir AppData\\Roaming\n\ndev\n  hp\n    projects\n    user\n      AppData\n        Roaming\n</code></pre></li>\n<li><p>Download and extract <a href=\"https://technet.microsoft.com/en-us/sysinternals/bb896768.aspx\" rel=\"nofollow noreferrer\">junction</a> utility in the <code>user</code> folder. Create <code>user\\create-symlink.bat</code> with the following contents. Then run it.</p>\n\n<pre><code>%~dp0junction -nobanner -accepteula -d \"%~dp0Application Data\"\n%~dp0junction -nobanner -accepteula \"%~dp0Application Data\" %~dp0AppData\\Roaming\njunction \"Application Data\" AppData\\Roaming\n</code></pre></li>\n<li><p>Create <code>haskell.bat</code> in the <code>h:\\dev\\hp</code> folder with the following contents:</p>\n\n<pre><code>@ECHO OFF\nset HSROOT=%~dp08.0.1\nSET USERPROFILE=%~dp0user\nSET Path=%HSROOT%\\bin;%HSROOT%\\winghci;%~dp0local\\bin;%HSROOT%\\mingw\\bin;%HSROOT%\\msys\\usr\\bin;%HSROOT%\\lib;%HSROOT%\\lib\\extralibs\\bin;%Path%\nCMD /k \"cd %~dp0projects\"\n</code></pre></li>\n<li><p>Run <code>haskell.bat</code> and in the command line type these commands. This should create additional folder structure under <code>user\\AppData\\Roaming</code></p>\n\n<pre><code>cabal update\ncabal user-config init\nstack setup\n</code></pre></li>\n<li><p>To make cabal's config file (<code>user\\AppData\\Roaming\\cabal\\config</code>) relocatable, edit it and change the tags as follows:</p>\n\n<pre><code>remote-repo-cache: $prefix\\..\\..\\user\\AppData\\Roaming\\cabal\\packages\nworld-file: $prefix\\..\\..\\user\\AppData\\Roaming\\cabal\\world\nextra-prog-path: $prefix\\..\\msys\\usr\\bin\nextra-lib-dirs: $prefix\\..\\mingw\\lib\nextra-include-dirs: $prefix\\..\\mingw\\include\nbuild-summary: $prefix\\..\\..\\user\\AppData\\Roaming\\cabal\\logs\\build.log\n</code></pre></li>\n<li><p>Using your favourite text editor do multi-file search and replace on the following files: <code>user\\AppData\\Roaming\\ghc\\i386-mingw32-8.0.1\\package.conf.d\\*.conf</code></p>\n\n<ul>\n<li>Search for absolute paths and replace them using <code>$topdir</code> (It evaluates to a directory under <code>8.0.1</code>, I think it is <code>h:\\dev\\hp\\8.0.1\\lib</code>). So, for example if you see <code>h:\\\\dev\\\\hp\\user\\\\Application Data</code> replace it with <code>$topdir\\\\..\\\\..\\\\user\\\\AppData\\\\Roaming</code>. Or, if you see <code>h:\\dev\\hp\\8.0.1</code>, then replace it with <code>$topdir\\..</code>.</li>\n</ul></li>\n<li><p>Do the same search and replace process in the stack's snapshot folders, e.g. <code>user\\AppData\\Roaming\\stack\\snapshots\\XXX\\pkgdb</code>:</p></li>\n<li><p>Update the global and user and stack package cache:</p>\n\n<pre><code>`ghc-pkg recache --global`\n`ghc-pkg recache --user`\n`ghc-pkg recache --package-db=\"h:\\dev\\hp\\user\\AppData\\Roaming\\stack\\snapshots\\XXX\\pkgdb\"`\n</code></pre></li>\n<li><p>If you install new packages, you might need to repeat the search&amp;replace step. Or you can try <code>cabal install --enable-relocatable &lt;package&gt;</code> and see if that works instead. </p></li>\n<li><p>You should be able to rename the installation folder, copy it to new location on the same machine, or on the different machine altogether and it should all work. Just use the <code>haskell.bat</code> to set up the environment and get a command prompt from which you should be able to run <code>ghc</code>, <code>cabal</code>, <code>stack</code>, <code>winghci</code>, etc. </p></li>\n<li><p><strong>There is one issue still remaining.</strong> If you try to install a package that requires <code>gcc</code> to be built, you might get the following error:</p>\n\n<pre><code>Configuring network-2.6.3.1...\nbash.exe: warning: could not find /tmp, please create!\nconfigure: WARNING: unrecognized options: --with-compiler\nchecking build system type... bash.exe: warning: could not find /tmp, please create!\nbash.exe: warning: could not find /tmp, please create!\ni686-pc-mingw32\nchecking host system type... i686-pc-mingw32\nchecking for gcc... h:\\dev\\hp\\80227D~1.1\u0102\u00e9\u00b4\u00c9\u0150\u0102\u0151\u00fd\u017d\u00c7\u252c\u0107\u00fd\u0141\u017b\u252c\u00ee\u0143\u0105\u00c7\u0102\u00e9\u0148\u017c\u00f6\u252c\u0142\u0143\u017d\u00ab\u0102\u00e9\u0143\u0105\u00c7\u0102\u00e9\u0148\u013a\u015f\u00a4\u0165O\nchecking whether the C compiler works... no\nconfigure: error: in `/cygdrive/c/DOCUME~1/UserName/LOCALS~1/Temp/stack4268/network-2.6.3.1':\nconfigure: error: C compiler cannot create executables\nSee `config.log' for more details\n</code></pre>\n\n<p>The reason is that <code>configure</code> script gets passed the wrong path to <code>gcc</code> (<code>h:\\dev\\hp\\80227D~1.1\u0102\u00e9\u00b4\u00c9\u0150\u0102\u0151\u00fd\u017d\u00c7\u252c\u0107\u00fd\u0141\u017b\u252c\u00ee\u0143\u0105\u00c7\u0102\u00e9\u0148\u017c\u00f6\u252c\u0142\u0143\u017d\u00ab\u0102\u00e9\u0143\u0105\u00c7\u0102\u00e9\u0148\u013a\u015f\u00a4\u0165O</code>). I know how to build the offending package <a href=\"https://stackoverflow.com/questions/37354416/stack-cannot-build-network-wheres-config-log\">manually</a>, but don't know how to install it:</p>\n\n<pre><code>stack unpack network-2.6.3.1\ncd network-2.6.3.1\nstack init\n# edit `configure` script and put `CC=` on the first line to kill system supplied path to `gcc`\nstack build\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8781247, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/66d580c7cc83dd40d638a068c80805cc?s=128&d=identicon&r=PG", "display_name": "Antonio Marcos Barbosa de S&#225;", "link": "https://stackoverflow.com/users/8781247/antonio-marcos-barbosa-de-s%c3%a1"}, "is_accepted": false, "score": -3, "last_activity_date": 1508113269, "last_edit_date": 1508113269, "creation_date": 1508102653, "answer_id": 46760148, "question_id": 40185235, "link": "https://stackoverflow.com/questions/40185235/truly-portable-haskell-installation-on-windows/46760148#46760148", "title": "Truly portable Haskell installation on Windows", "body": "<p><strong>Try:</strong> </p>\n\n<pre><code>penultimo :: [Int] -&gt; Int\npenultimo l = head(tail(reverse l))\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4194142, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4caa70e31bd77d2e91d0f819abe682f9?s=128&d=identicon&r=PG&f=1", "display_name": "Glaukon", "link": "https://stackoverflow.com/users/4194142/glaukon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2089, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1508113269, "creation_date": 1477082986, "last_edit_date": 1495535655, "question_id": 40185235, "link": "https://stackoverflow.com/questions/40185235/truly-portable-haskell-installation-on-windows", "title": "Truly portable Haskell installation on Windows", "body": "<p>Is it possible to have a truly portable Haskell installation on Windows so everything Haskell related happens under a single directory. I want to be able to have Haskell installation on a USB stick so I can use it on any other Windows computer just by plugging it in.</p>\n\n<p>That would mean when I say <code>cabal install somePackage</code> everything happens locally and relative to that single directory (n.b. for different computers there might be a different drive letter assigned to the USB drive). I would like to be able to run that <code>cabal install somePackage</code> on any Windows computer. Also, it would be nice if I could copy the contents of the USB stick to a local hard disk and it still works from there (on some Windows machines USB sticks are mounted read only).</p>\n\n<p>I am aware of the following related StackOverflow questions <a href=\"https://stackoverflow.com/questions/19007105/portable-package-installation-on-haskell-platform-with-cabal-on-windows\">here</a> and <a href=\"https://stackoverflow.com/questions/14368401/how-to-change-path-of-cabal-config-file\">here</a>. Can I setup cabal's config file in such a way it uses relative paths? What about other Haskell tools (e.g. winghci)?</p>\n\n<p>So, how should I do it? Install Haskell Platform in a portable mode and then do what?</p>\n"}, {"tags": ["haskell", "ffi"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1477080684, "post_id": 40184691, "comment_id": 67636992, "body": "Bit of example code please... it doesn&#39;t really make much sense to me what you&#39;re asking; a pointer is something quite different from the value it&#39;s pointing to."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 3, "creation_date": 1477081186, "post_id": 40184691, "comment_id": 67637207, "body": "Are you actually, y\u2019know, allocating the pointer with <code>malloc</code>? The question of where you\u2019re getting the pointer from is sort of important if you\u2019re getting issues when you try to <code>free</code> it."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1477081218, "post_id": 40184691, "comment_id": 67637229, "body": "All haskell code (except for unboxed types) is pass by reference, if such a distinction is even meaningful in a non-strict language (because it implies an expression is always either a value or a reference). The docs say: &quot;Free a block of memory that was allocated with malloc, mallocBytes, realloc, reallocBytes, new&quot; - was your pointer created by one of these methods? If not, expect a core dump. (Your actual issue could be any number of things - you should post the actual code. This is just the most likely explanation in my experience)."}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1477082802, "post_id": 40184691, "comment_id": 67637937, "body": "@Alexis: See my comment sepp2k&#39;s answer. I was indeed trying to free non-malloced memory. Lesson learned!"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1477120420, "post_id": 40184691, "comment_id": 67645481, "body": "By reference and by value are only two of the <i>many</i> types of arguments passing... sure they are the most common but remember that &quot;&#172; by reference \u2260 by value&quot; and &quot;&#172; by value \u2260 by reference&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 1, "creation_date": 1477082749, "post_id": 40185005, "comment_id": 67637910, "body": "My pointer was created with the haskell function <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Foreign-Marshal-Utils.html#v:with\" rel=\"nofollow noreferrer\">with</a>, which takes care of the termination on its end. This explains why calling <code>free</code> caused a core dump. Lesson learned!"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1477081935, "creation_date": 1477081935, "answer_id": 40185005, "question_id": 40184691, "link": "https://stackoverflow.com/questions/40184691/are-haskell-pointers-pass-by-value/40185005#40185005", "title": "Are Haskell Pointers Pass by Value?", "body": "<p>You don't free pointers, you free memory, specifically malloc (and co.)-allocated memory. If you free a pointer to something other than malloc-allocated memory, it fails. If you free a pointer to malloc-allocated memory that has already been freed, it also fails.</p>\n\n<blockquote>\n  <p>When f is passed p, does it do so by value or by reference?</p>\n</blockquote>\n\n<p>Usually values are in Haskell are boxed, unless you specifically use unboxed types. They're also usually lazy, so what you get is a box inside a thunk. I suppose that qualifies as passing by reference. That said, this isn't at all relevant to your problem. Pointers wouldn't behave any differently if you just passed their unboxed, strict, numeric values by value<sup>1</sup>.</p>\n\n<blockquote>\n  <p>Does Haskell delete p by the time the function returns?</p>\n</blockquote>\n\n<p>Absolutely not. Haskell does not automatically call <code>free</code> on any <code>Ptr</code>s. In the absence of garbage collection<sup>2</sup>, there's no way it could even know when it's safe to call <code>free</code> on a given pointer.</p>\n\n<hr>\n\n<p><sup>1</sup> With regards to your question that is.</p>\n\n<p><sup>2</sup> Now, of course, Haskell <em>is</em> garbage collected, but this doesn't apply to the values that you can have <code>Ptr</code>s to.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 40185005, "answer_count": 1, "score": 0, "last_activity_date": 1477081935, "creation_date": 1477080463, "question_id": 40184691, "link": "https://stackoverflow.com/questions/40184691/are-haskell-pointers-pass-by-value", "title": "Are Haskell Pointers Pass by Value?", "body": "<p>I have constructed a function of type <code>f :: Ptr Int -&gt; IO (Int)</code>.</p>\n\n<p>When I pass <code>f</code> some pointer <code>p</code>, and then try to <code>free p</code>, I get a core dump.</p>\n\n<p>My conclusion is that Haskell passes pointers by reference and automatically deletes them after a value is returned from a function!</p>\n\n<p><strong>Question:</strong> When <code>f</code> is passed <code>p</code>, does it do so by value or by reference? Does Haskell delete <code>p</code> by the time the function returns?</p>\n"}, {"tags": ["haskell", "types", "agda", "dependent-type", "idris"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1477074068, "post_id": 40183084, "comment_id": 67633659, "body": "So that would be the type whose only member is <code>add</code>?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 6, "creation_date": 1477074185, "post_id": 40183084, "comment_id": 67633724, "body": "It&#39;s certainly easy to do with inductively defined nats. You can even do it in Haskell. Are you particularly attached to Church numerals? If so, I recommend becoming unattached to them."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1477074309, "post_id": 40183084, "comment_id": 67633791, "body": "@leftroundabout That would depend on how intensional we&#39;re being. Idris and Agda allow the definition of highly intensional properties, e.g., the type whose only member is <i>that implementation</i> of <code>add</code>."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1477074446, "post_id": 40183084, "comment_id": 67633860, "body": "@leftaroundabout how so? If you reorder the arguments (<code>add x y t s z = y t s (x t s z)</code>) you still have that <code>add x y == add y z</code>, but that is a different function."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1477075133, "post_id": 40183084, "comment_id": 67634228, "body": "@pigworker numbers are either church encoded, scott encoded or primitives... primitives hide all the hard work through syntax sugars, so, if you want to learn what is under the hoods, then there aren&#39;t many options, right?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 6, "creation_date": 1477076076, "post_id": 40183084, "comment_id": 67634699, "body": "What&#39;s your notion of equality? <a href=\"http://lpaste.net/288742\" rel=\"nofollow noreferrer\">Here</a> are four variants."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1477077007, "post_id": 40183084, "comment_id": 67635145, "body": "@Viclib I&#39;m not sure I see why the specific representation matters, actually... What about just <code>plus : (n : CNat) -&gt; (m : CNat) -&gt; (r : CNat ** r = add n m)</code>? It seems like that sort of thing should work regardless of the representation."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1477077049, "post_id": 40183084, "comment_id": 67635164, "body": "@DavidYoung Because propositional equality isn&#39;t extensional. At least, not in Idris"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1477077102, "post_id": 40183084, "comment_id": 67635190, "body": "@BenjaminHodgson I was wondering about that right after I commented actually, but Idris seems to accept this type with the definition <code>plus n m = (add n m ** Refl)</code>. Maybe its because you end up with a syntactic equality with that specific definition if you expand it out though?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 6, "creation_date": 1477077349, "post_id": 40183084, "comment_id": 67635302, "body": "@Viclib, what caused you to believe such falsehoods? Inductively defined numbers have an <i>induction principle</i>; Church-encoded numbers, per se, do not. They&#39;re not the same thing. And if you want to use types depending on numbers, you need induction, not just iteration. The idea that Church-encoded data are just like actual data is popular, but deeply unhelpful."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1477077712, "post_id": 40183084, "comment_id": 67635484, "body": "@DavidYoung Yes, I think it&#39;s just alpha-comparing <code>add n m</code> with <code>add n m</code>. Try flipping the arguments! You can&#39;t prove <code>add n m = add m n</code> for Church numerals with propositional equality, cos you don&#39;t know anything about <code>n</code> and <code>m</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1477079326, "post_id": 40183084, "comment_id": 67636347, "body": "@pigworker, I have not, sadly, been able to find an explanation of the word &quot;intensional&quot; that I can understand. Do you think you could help? For the type in question, do you mean something like <code>isMyAdd f = (f = myAdd)</code>?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1477080530, "post_id": 40183084, "comment_id": 67636918, "body": "@pigworker what the heck are you talking about? Whatever you think I &quot;claimed&quot; about datatypes is wrong. Re-read my comment, all I said is that using built-in primitive datatypes wouldn&#39;t allow me to see the actual underlying expressions because Idris has so many layers of syntax sugars that it is hard (for me) to map the high-level syntax to the core calculus. That is why I chose the church encoding and there is no more to it than that."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 5, "creation_date": 1477080751, "post_id": 40183084, "comment_id": 67637024, "body": "@dfeuer Intensional equality is one which does not admit extensionality, i.e. <code>\u2200 x . f x = g x  ==&gt; f = g</code>, and without this it is very hard to produce a proof that any <code>CNat</code> is equal to any other. @Viclib That is precisely your issue, the lack of extensionality, so you will need to define a proper equivalence for <code>CNat</code> or use inductive naturals (as already stated). You seem to want to avoid &#39;primitive&#39; numerals (i.e. machine words?) but nobody is suggesting you use those - <code>data Nat = Zero | Succ Nat</code> is not &#39;primitive&#39; and has no syntactic sugar involved."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477082076, "post_id": 40183084, "comment_id": 67637603, "body": "@user2407038 it is a syntax, I&#39;m often interested in understanding how those things map to a core calculus, i.e., just lambdas, foralls, vars, etc."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 4, "creation_date": 1477083097, "post_id": 40183084, "comment_id": 67638080, "body": "@Viclib Read your own comment. It makes a rather prescriptive false statement about the possible encodings of numbers, and then appears to presume incorrectly the equivalence of those encodings."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1477083371, "post_id": 40183084, "comment_id": 67638214, "body": "@pigworker <i>&quot;seems to presume the equivalence&quot;</i> - that is not on my comment, it didn&#39;t even cross my mind. I don&#39;t even know what equivalence means in that context. Again, I said those are the 3 ways I know how to encode datatypes, and the church-encoding makes it easier to translate what I&#39;m doing on Idris to a simpler core such as Morte."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 7, "creation_date": 1477083378, "post_id": 40183084, "comment_id": 67638218, "body": "&quot;intensional&quot; means &quot;characteristic of the implementation&quot;; &quot;extensional&quot; means &quot;characteristic of the observable behaviour&quot;; so mergeSort is extensionally equal to and intensionally different from bubbleSort."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1477083544, "post_id": 40183084, "comment_id": 67638292, "body": "@Viclib It can only be &quot;simpler&quot; because it achieves less. Moreover, higher-order encodings of first-order things count as simplifications only in a world that is entirely on its head."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1477084767, "post_id": 40183084, "comment_id": 67638800, "body": "@Viclib It is not just a syntax - inductive datatypes (and generalizations of such) are given formal semantics just as lambdas, foralls, etc are given them. Yes, there are equivalent formulizations of the things we do with inductive datatypes, but just the same all these systems of computation are &#39;equivalent&#39; because they are turing complete. Why are you not attempting to model this in terms of a universal turing machine, which is much more &#39;simple&#39;, or &#39;fundamental&#39; than any other formalism for computation? (answer: you pick the tool for the job, which is what makes your life easiest)"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1477095167, "post_id": 40183084, "comment_id": 67641595, "body": "I&#39;m not sure what you&#39;re arguing for, but the introduction on <a href=\"https://fermat.github.io/document/papers/rta-tlca.pdf\" rel=\"nofollow noreferrer\">this</a> paper explains most of the reasons I think it is valuable to have a simpler core language and to understand concepts w.r.t that core. It also proposes self types which give the induction principle you mentioned."}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1477073846, "creation_date": 1477073846, "question_id": 40183084, "link": "https://stackoverflow.com/questions/40183084/is-it-possible-to-express-the-type-of-functions-that-receive-2-nats-and-return", "title": "Is it possible to express the &quot;type of functions that receive 2 nats and return their sum&quot;?", "body": "<p>Given the following types:</p>\n\n<pre><code>CNat : Type\nCNat = (a:Type) -&gt; (a -&gt; a) -&gt; a -&gt; a\n\nadd : CNat -&gt; CNat -&gt; CNat\nadd x y t s z = x t s (y t s z)\n</code></pre>\n\n<p>Is it possible to express the \"type of functions that receive two nats, <code>x</code> and <code>y</code>, and return another nat <code>z</code>, such that <code>add x y == z</code>?</p>\n"}, {"tags": ["haskell", "yesod", "yesod-forms"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1477204737, "post_id": 40182004, "comment_id": 67665713, "body": "I think you want to use the checkM function instead."}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 4118267, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xIgkR.jpg?s=128&g=1", "display_name": "oriaj", "link": "https://stackoverflow.com/users/4118267/oriaj"}, "is_accepted": true, "score": 1, "last_activity_date": 1477277541, "creation_date": 1477277541, "answer_id": 40210062, "question_id": 40182004, "link": "https://stackoverflow.com/questions/40182004/validate-field-from-database-yesod/40210062#40210062", "title": "validate field from database Yesod", "body": "<p>thanks @Michael Snoyman you are rigth I just have to use checkM</p>\n\n<pre><code>demoForm :: Maybe Demo -&gt; AForm Handler Demo\ndemoForm   demo = Demo \n                &lt;$&gt; areq nitField (bfs (MsgName)) (demoFieldOne &lt;$&gt; demo)\n                &lt;*&gt; areq intField (bfs (MsgName)) (demoFieldTwo &lt;$&gt; demo)\n           where \n            nitField = checkM validateNit textField\n            validateNit input = do\n              mbNit &lt;- runDB $ selectList [CompanyName ==. input] []\n              return $ case null mbNit of\n                True  -&gt; Left (MsgErrNit :: AppMessage)\n                False -&gt; Right input          \n</code></pre>\n"}], "owner": {"reputation": 716, "user_id": 4118267, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xIgkR.jpg?s=128&g=1", "display_name": "oriaj", "link": "https://stackoverflow.com/users/4118267/oriaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 40210062, "answer_count": 1, "score": 1, "last_activity_date": 1477277541, "creation_date": 1477069391, "question_id": 40182004, "link": "https://stackoverflow.com/questions/40182004/validate-field-from-database-yesod", "title": "validate field from database Yesod", "body": "<p>Hi i want create a file that only accept values that exist in a table (with more that 20000 rows) so i have the following code</p>\n\n<pre><code>demoForm :: Maybe Demo -&gt; AForm Handler Demo\ndemoForm   demo = Demo \n                &lt;$&gt; areq nitField (bfs (MsgName)) (demoFieldOne &lt;$&gt; demo)\n                &lt;*&gt; areq intField (bfs (MsgName)) (demoFieldTwo &lt;$&gt; demo)\n\n           where \n             errorMessage :: Text\n             errorMessage = \"the company no exist!\"                 \n\n             nitField = check validateNit textField\n\n             validateNit nit\n                | companiesMatch nit  = Left errorMessage\n                | otherwise = Right nit\n\n             companiesMatch name = do\n                  entities &lt;- runDB $ selectList [CompanyName ==. name] []\n                  return (null entities)\n</code></pre>\n\n<p>but I get the error <code>Couldn't match expected type \u2018Bool\u2019with actual type \u2018m0 (HandlerT site0 IO Bool)\u2019</code> so how can get the bool value from the monad or exist a better way to do this validations? </p>\n"}, {"tags": ["haskell", "fibonacci"], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 2, "last_activity_date": 1477067951, "creation_date": 1477067951, "answer_id": 40181632, "question_id": 40181567, "link": "https://stackoverflow.com/questions/40181567/simple-haskell-fibonacci-function-gets-stuck/40181632#40181632", "title": "Simple Haskell Fibonacci function gets stuck", "body": "<p>By typing the declarations separately into ghci, each one is read as a separate definition of <code>fib</code>, shadowing its predecessors. In other words, you're effectively running</p>\n\n<pre><code>fib n = fib (n-1) + fib (n-2)\nfib 5  -- infinite recursion here\n</code></pre>\n\n<p>The easiest way to avoid this problem is to put the definition of <code>fib</code> into a file.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1477067965, "creation_date": 1477067965, "answer_id": 40181633, "question_id": 40181567, "link": "https://stackoverflow.com/questions/40181567/simple-haskell-fibonacci-function-gets-stuck/40181633#40181633", "title": "Simple Haskell Fibonacci function gets stuck", "body": "<p>At the console, you haven't defined a single function <code>fib</code> with 3 different cases; you first defined <code>fib 0 = 0</code>, then overwrite that with a <em>new</em> function <code>fib 1 = 1</code>, then finally with a third function <code>fib n = fib (n-1) + fib (n-2)</code> that has no base case. You can use</p>\n\n<pre><code>&gt; fib 0 = 1; fib 1 = 1; fib n = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>to correctly define a single, 3-case function.</p>\n\n<p>Note this is primarily a problem starting with GHCi 8, since in previous versions you would have to use <code>let</code> to start the definition and would get a parse error on the second line:</p>\n\n<pre><code>&gt; let fib 0 = 0\n&gt; fib 1 = 1\n\n&lt;interactive&gt;:3:7: parse error on input '='\n</code></pre>\n"}], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 40181633, "answer_count": 2, "score": 1, "last_activity_date": 1477071149, "creation_date": 1477067722, "question_id": 40181567, "link": "https://stackoverflow.com/questions/40181567/simple-haskell-fibonacci-function-gets-stuck", "title": "Simple Haskell Fibonacci function gets stuck", "body": "<p>I am running the GHCi console, and typing</p>\n\n<pre><code>fib 0 = 0\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>fib 5\n</code></pre>\n\n<p>and the console hangs and dies with:</p>\n\n<blockquote>\n  <p>: Out of memory</p>\n</blockquote>\n\n<p>What am I doing wrong ?</p>\n"}, {"tags": ["haskell", "haskell-stack", "nix", "ghcjs"], "comments": [{"owner": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "edited": false, "score": 0, "creation_date": 1477108751, "post_id": 40181360, "comment_id": 67643549, "body": "Under the &quot;try-reflex&quot; environment included (and described) in the <a href=\"https://github.com/reflex-frp/reflex-platform\" rel=\"nofollow noreferrer\">github.com/reflex-frp/reflex-platform</a> repository, I was able to compile and link the project you link to using just ghcjs.  The &quot;try-reflex&quot; command is, I believe, a wrapper around nix.  So, while not &quot;stack, nix, and ghcjs&quot;, this &quot;nix and ghcjs&quot; combo does not include cabal and might be a solution for you."}, {"owner": {"reputation": 375, "user_id": 4232796, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42912716b8f59e0f6cfd0cbbe6a74bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle McKean", "link": "https://stackoverflow.com/users/4232796/kyle-mckean"}, "reply_to_user": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "edited": false, "score": 0, "creation_date": 1477272994, "post_id": 40181360, "comment_id": 67683506, "body": "Yea. I convinced my boss to let me just use cabal but previously I had to use stack. Sad they removed the feature though it worked flawlessly."}], "owner": {"reputation": 375, "user_id": 4232796, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42912716b8f59e0f6cfd0cbbe6a74bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle McKean", "link": "https://stackoverflow.com/users/4232796/kyle-mckean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1477066965, "creation_date": 1477066965, "question_id": 40181360, "link": "https://stackoverflow.com/questions/40181360/how-to-use-haskell-stack-1-2-nix-and-ghcjs", "title": "How to use haskell stack 1.2, nix, and ghcjs", "body": "<p>When I try to build this <a href=\"https://github.com/mckeankylej/ghcjs-typeahead\" rel=\"nofollow\">repo</a> with the latest version of stack:</p>\n\n<pre><code>\u03bb ~/repos/ghcjs-typeahead/src/Typeahead/ master* stack --version                      ~/repos/ghcjs-typeahead/src/Typeahead\nVersion 1.2.0 x86_64\n</code></pre>\n\n<p>I get this error: </p>\n\n<pre><code>\u03bb ~/repos/ghcjs-typeahead/src/Typeahead/ master* stack build                          ~/repos/ghcjs-typeahead/src/Typeahead\nOnly GHC is supported by now by stack --nix\n</code></pre>\n\n<p>This is because my stack.yaml looks like this:</p>\n\n<pre><code>resolver: nightly-2016-08-26\ncompiler: ghcjs-0.2.0.820160826_ghc-8.0.1\ncompiler-check: match-exact\nsetup-info:\n  ghcjs:\n    source:\n      ghcjs-0.2.0.820160826_ghc-8.0.1:\n        url: \"http://tolysz.org/ghcjs/ghc-8.0-2016-08-26-nightly-2016-08-26-820160826.tar.gz\"\n        sha1: \"2ecd8523cafe22b3033726363b4acc5356117970\"\nnix:\n  enable: true\n  shell-file: shell.nix\npackages:\n- location: '.'\n- location:\n    git:  https://github.com/ryantrinkle/reflex.git\n    commit: a63aba90bdea5ae5b3e1506d468613bdfedcdfa3\n  extra-dep: true\n- location:\n    git: https://github.com/ryantrinkle/reflex-dom.git\n    commit: ed3b790f81f8396324fc9a3495de9c911119facc\n  extra-dep: true\nextra-deps:\n- ghcjs-dom-0.2.4.0\n- ref-tf-0.4.0.1\n- zenc-0.1.1\n</code></pre>\n\n<p>It is very unfortunate that they removed support for the method I was using is there any other way to use stack, nix, and ghcjs? Do I have to go back to using cabal?</p>\n"}, {"tags": ["haskell", "naming-conventions", "traversable"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 9, "last_activity_date": 1477068039, "last_edit_date": 1477068039, "creation_date": 1477066163, "answer_id": 40181158, "question_id": 40181086, "link": "https://stackoverflow.com/questions/40181086/what-does-the-a-stand-for-in-sequencea/40181158#40181158", "title": "what does the A stand for in sequenceA?", "body": "<p>The \"A\" stands for <code>Applicative</code>, as in the constraint in <code>sequenceA</code>'s type:</p>\n\n<pre><code>sequenceA :: (Traversable t, Applicative f) =&gt; t (f a) -&gt; f (t a)\n</code></pre>\n\n<p>That the \"A\" is there is fruit of a historical accident. Once upon a time, neither <code>Applicative</code> nor <code>Traversable</code> existed in Haskell. Nonetheless, a function exactly like <code>sequenceA</code> already existed -- except that it had a much more specific type:</p>\n\n<pre><code>sequence :: Monad m =&gt; [m a] -&gt; m [a]\n</code></pre>\n\n<p>When <code>Applicative</code> and <code>Traversable</code> were introduced, the function was generalised from lists to any <code>Traversable</code> [1]:</p>\n\n<pre><code>sequence :: (Traversable t, Monad m) =&gt; t (m a) -&gt; m (t a)\n</code></pre>\n\n<p><code>sequence</code>'s <code>Monad</code> constraint is unnecessarily restrictive. Back then, however, generalising it further to <code>Applicative</code> was not an option. The problem was that until early last year <code>Applicative</code> was not a superclass of <code>Monad</code> as it is supposed to be, and therefore generalising the signature to <code>Applicative</code> would break any use of <code>sequence</code> with monads that lacked an <code>Applicative</code> instance. That being so, an extra \"A\" was added to the name of the general version.</p>\n\n<hr>\n\n<p>[1]: Note, however, that the Prelude continued to carry the list-specific version until quite recently.</p>\n"}], "owner": {"reputation": 668, "user_id": 2187783, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9373b537548d00467361580d1367f21f?s=128&d=identicon&r=PG", "display_name": "diminishedprime", "link": "https://stackoverflow.com/users/2187783/diminishedprime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 40181158, "answer_count": 1, "score": 4, "last_activity_date": 1477068039, "creation_date": 1477065897, "last_edit_date": 1477066301, "question_id": 40181086, "link": "https://stackoverflow.com/questions/40181086/what-does-the-a-stand-for-in-sequencea", "title": "what does the A stand for in sequenceA?", "body": "<p>What does <code>sequenceA</code> from Traversable stand for? Why is there capital A at the end? I've been learning Haskell for a few months now and this is one of those things that's been bugging me for a while. </p>\n"}, {"tags": ["haskell", "types", "synonym"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1477060563, "post_id": 40179221, "comment_id": 67625972, "body": "So, what exactly is your question here?"}, {"owner": {"reputation": 1, "user_id": 5679651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207043036928084/picture?type=large", "display_name": "Jacob Dub&#233;-Ross", "link": "https://stackoverflow.com/users/5679651/jacob-dub%c3%a9-ross"}, "edited": false, "score": 0, "creation_date": 1477060838, "post_id": 40179221, "comment_id": 67626182, "body": "I got this error when i&#39;m trying to launch it TP1.hs:116:66: error:     * Couldn&#39;t match type <code>Acteur&#39; with </code>Acteur -&gt; Bool&#39;       Expected type: Critere         Actual type: Acteur     * In the second argument of <code>(==)&#39;, namely </code>y&#39;       In the expression: x == y       In a stmt of a list comprehension: x == y"}, {"owner": {"reputation": 1, "user_id": 5679651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207043036928084/picture?type=large", "display_name": "Jacob Dub&#233;-Ross", "link": "https://stackoverflow.com/users/5679651/jacob-dub%c3%a9-ross"}, "edited": false, "score": 0, "creation_date": 1477060940, "post_id": 40179221, "comment_id": 67626260, "body": "I thinks its when i&#39;m comparing acteur with critere... it doesn&#39;t work with my =="}, {"owner": {"reputation": 1, "user_id": 5679651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207043036928084/picture?type=large", "display_name": "Jacob Dub&#233;-Ross", "link": "https://stackoverflow.com/users/5679651/jacob-dub%c3%a9-ross"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1477061381, "post_id": 40179221, "comment_id": 67626602, "body": "It work thanks! i&#39;m so use with OO, haskell is weird for me ahah! thanks for your help!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1477063109, "post_id": 40179221, "comment_id": 67627829, "body": "Please add error messages you&#39;re asking about to the question, in the future."}], "owner": {"reputation": 1, "user_id": 5679651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207043036928084/picture?type=large", "display_name": "Jacob Dub&#233;-Ross", "link": "https://stackoverflow.com/users/5679651/jacob-dub%c3%a9-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477061330, "creation_date": 1477060029, "last_edit_date": 1477060464, "question_id": 40179221, "link": "https://stackoverflow.com/questions/40179221/how-to-compare-a-synonym-type-with-a-custom-type-in-haskell", "title": "How to compare a synonym type with a custom type in haskell?", "body": "<p>I'm trying to learn haskell for a class, an I have a homework that requires me to compare a synonym type: <code>Critere = Acteur -&gt; Bool</code> with the custom one <code>Acteur</code>.\nI need to compare every acteur on a list to be sure they match every <code>Critere</code> on an other list... that's my code so far</p>\n\n<pre><code>data Acteur = Acteur Nom Sexe RevenuMinimum Date' Restriction ListeFilms\ntype Critere = Acteur -&gt; Bool \ninstance Ord Acteur where\n  compare x y\n   | nomActeur x == nomActeur y = EQ\n   | nomActeur x &lt; nomActeur y = LT\n   | otherwise = GT\neqActeur (Acteur nom1 _ _ _ _ _) (Acteur nom2 _ _ _ _ _ ) = nom1 == nom2\ninstance Eq Acteur where\n  (==)  = eqActeur\n</code></pre>\n\n<p>This is what the teacher gave me realate to the type Acteur... that's my answer so far:</p>\n\n<pre><code>selectionActeursCriteres :: [Critere] -&gt; [Acteur] -&gt; [Acteur]\nselectionActeursCriteres [] (x:xs) = (x:xs)\nselectionActeursCriteres (x:xs) [] = []\nselectionActeursCriteres (x:xs) (y:ys) = t where\n      t = selectionActeursCriteres tail (x:xs) [z | z &lt;- ys, x == y]\n</code></pre>\n\n<p>I've tried to join the teacher like two days ago, and I'm still waiting...\nThanks you for your help in advance!</p>\n"}, {"tags": ["function", "haskell", "syntax", "tree", "function-signature"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1477058326, "post_id": 40178443, "comment_id": 67624272, "body": "<code>treeunzipped :: NewTree -&gt; (Tree, Tree)</code>.  The type doesn&#39;t care about function names used to implement the function."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1477058393, "post_id": 40178443, "comment_id": 67624322, "body": "Also, you don&#39;t need two separate types if you parameterize the original type. <code>data Tree a = Leaf | Node a (Tree a) (Tree a)</code>, then <code>treeunzipped :: Tree (a,b) -&gt; (Tree a, Tree b)</code>."}, {"owner": {"reputation": 319, "user_id": 4834745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/447b4a70326df5c9f1c830b52ba4a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "BourbonCreams", "link": "https://stackoverflow.com/users/4834745/bourboncreams"}, "edited": false, "score": 0, "creation_date": 1477060478, "post_id": 40178443, "comment_id": 67625904, "body": "Ok I think I&#39;m going to study some more theory because all I understood from your comments was that a function only contains data types and not function calls. Not sure what parameterizing means.  Thank you though."}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 4834745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/447b4a70326df5c9f1c830b52ba4a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "BourbonCreams", "link": "https://stackoverflow.com/users/4834745/bourboncreams"}, "edited": false, "score": 0, "creation_date": 1477061495, "post_id": 40179184, "comment_id": 67626683, "body": "Ok adding the line:      treeunzip t = (treeunzipL t, treeunzipR t)  Made it work. That was the trick I was looking for."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1477059914, "creation_date": 1477059914, "answer_id": 40179184, "question_id": 40178443, "link": "https://stackoverflow.com/questions/40178443/in-haskell-can-you-have-a-signature-of-a-function-that-calls-other-functions-bu/40179184#40179184", "title": "In Haskell, can you have a signature of a function that calls other functions but doesn&#39;t have an implementation?", "body": "<p>Your problem seems to be that you are trying to imply the definition in the type. The two are separate and must be provided separately. (The compiler can infer a type from a definition, but it cannot infer the definition from the type.)</p>\n\n<pre><code>treeunzip :: NewTree -&gt; (Tree, Tree)\ntreeunzip t = (treeunzipL t, treeunzipR t)\n</code></pre>\n\n<p>However, you should parameterize your original type to</p>\n\n<pre><code>data Tree a = Leaf | Node a (Tree a) (Tree a)\n</code></pre>\n\n<p>so that you only need one <code>treeunzip</code> function:</p>\n\n<pre><code>treeunzip :: Tree (a, b) -&gt; (Tree a, Tree b)\ntreeunzip Leaf = (Leaf, Leaf)\ntreeunzip (Node (a, b) left right) = ((Node a left' right'),\n                                      (Node b left'' right''))\n    where (left', left'') = treeunzip left\n          (right', right'')  treeunzip right\n\n&gt; treeunzip (Node (1,2) (Node (3,4) Leaf Leaf) (Node (5,6) Leaf Leaf))\n(Node 1 (Node 3 Leaf Leaf) (Node 5 Leaf Leaf),Node 2 (Node 4 Leaf Leaf) (Node 6 Leaf Leaf))\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 4834745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/447b4a70326df5c9f1c830b52ba4a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "BourbonCreams", "link": "https://stackoverflow.com/users/4834745/bourboncreams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 40179184, "answer_count": 1, "score": 1, "last_activity_date": 1477059914, "creation_date": 1477057878, "last_edit_date": 1477058266, "question_id": 40178443, "link": "https://stackoverflow.com/questions/40178443/in-haskell-can-you-have-a-signature-of-a-function-that-calls-other-functions-bu", "title": "In Haskell, can you have a signature of a function that calls other functions but doesn&#39;t have an implementation?", "body": "<p>So I'm learning Haskell and I have to implement a treeunzip function that takes a tree of the type (Tree (a,b)) where 'a' and 'b' are integers and returns a list of the two trees unzipped, that is (Tree a, Tree b).</p>\n\n<p>I can get one of the two trees but I can't put them together in a list. What I came up with is this:</p>\n\n<pre><code>treeunzip :: (NewTree) -&gt; (treeunzipL, treeunzipR)\n</code></pre>\n\n<p>NewTree is defined as:</p>\n\n<pre><code>data NewTree = NewLeaf | NewNode Int Int NewTree NewTree deriving Show\n</code></pre>\n\n<p>Tree is defined as:</p>\n\n<pre><code>data Tree = Leaf | Node Int Tree Tree deriving Show\n</code></pre>\n\n<p>Here are the treeunzipL and treeunzipR functions, I don't know if it matters.</p>\n\n<pre><code>treeunzipL :: (NewTree) -&gt; (Tree)\ntreeunzipL NewLeaf = (Leaf)\ntreeunzipL (NewNode x y lSubTree rSubTree) = (Node x (treeunzipL (lSubTree)) (treeunzipL (rSubTree)))\n\n\ntreeunzipR :: (NewTree) -&gt; (Tree)\ntreeunzipR NewLeaf = (Leaf)\ntreeunzipR (NewNode x y lSubTree rSubTree) = (Node y (treeunzipR (lSubTree)) (treeunzipR (rSubTree)))\n</code></pre>\n\n<p>Now that obviously gives me an error when loading the module because treeunzip has a signature but not an implementation. Is there any way to get around this?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1477054114, "post_id": 40176850, "comment_id": 67621324, "body": "Please <b>1.</b> always add the definition for all nonstandard data types you&#39;re talking about (it&#39;s pretty obvious here what <code>Cons</code> and <code>Nil</code> are, but in general it might not be clear) <b>2.</b> show that you&#39;ve actually tried to solve the task yourself, and where you got stuck."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1477057441, "post_id": 40176850, "comment_id": 67623634, "body": "Kaliba, I can tell you so much: your function will have two cases. One for the empty list, and one for any non-empty list. Please try to come up with the first case at least! (We know you&#39;re smart, as you use SO.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6288471"}, "edited": false, "score": 0, "creation_date": 1477198567, "post_id": 40176850, "comment_id": 67664780, "body": "follow this link:<a href=\"http://www.willamette.edu/~fruehr/haskell/lectures/tutorial6.html#@sli@39\" rel=\"nofollow noreferrer\">willamette.edu/~fruehr/haskell/lectures/tutorial6.html#&zwnj;&#8203;@sli@39</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6288471"}, "is_accepted": true, "score": 3, "last_activity_date": 1477198525, "creation_date": 1477198525, "answer_id": 40199678, "question_id": 40176850, "link": "https://stackoverflow.com/questions/40176850/create-a-recursive-function-that-takes-a-list-and-uses-it-to-create-a-list/40199678#40199678", "title": "Create a recursive function that takes a list and uses it to create a List", "body": "<p>Do the following:</p>\n\n<pre><code>data List a = Nil | Cons a (List a) deriving Show\n\nfunction [] = Nil\n\nfunction (x:xs) = Cons x (makeList xs) \n</code></pre>\n\n<p>Go to this link to learn related skills that you are lacking:<a href=\"http://www.willamette.edu/~fruehr/haskell/lectures/tutorial6.html#@sli@39\" rel=\"nofollow\">http://www.willamette.edu/~fruehr/haskell/lectures/tutorial6.html#@sli@39</a></p>\n"}], "owner": {"reputation": 381, "user_id": 7053083, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/13Ouf.jpg?s=128&g=1", "display_name": "Kalia Dona", "link": "https://stackoverflow.com/users/7053083/kalia-dona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 40199678, "answer_count": 1, "score": -2, "last_activity_date": 1477198525, "creation_date": 1477053350, "question_id": 40176850, "link": "https://stackoverflow.com/questions/40176850/create-a-recursive-function-that-takes-a-list-and-uses-it-to-create-a-list", "title": "Create a recursive function that takes a list and uses it to create a List", "body": "<p>I am very new in haskell and functional programming.I am trying to creat a recursive function that takes a list and uses it to create a List in the following way:</p>\n\n<pre><code>function [3,4,2] = Cons 3 (Cons 4 (Cons 2 Nil))\n</code></pre>\n\n<p>This function will take a list and return it as Cons.I will very much appreciate help and explanation. </p>\n"}, {"tags": ["haskell", "dependencies", "ghc", "gloss"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1477053413, "post_id": 40176722, "comment_id": 67620820, "body": "I guess you are using ghc-8.0.x which is requiring/providing base-4.9 - if you want to use base 4.8  you have  to switch to ghc 7.10.3, or you can modify the gloss cabal file to allow base -4.9 or call cabal with <code>--allow-newer</code>."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1477053918, "post_id": 40176722, "comment_id": 67621156, "body": "also don&#39;t install libraries like gloss globally, this is just a first step into problems - try using stack instead of cabal. I personally try to compile stuff using stack - and removing all build-depends boundaries in the project I want to compile. Note I would not do that with cabal only!"}, {"owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1477054349, "post_id": 40176722, "comment_id": 67621503, "body": "Thanks for your comment! Using --allow-newer allowed me to configure the project, however, running it gave me the following error: <code>lambda-wars[6771:36510] GLUT Fatal Error: pixel format with necessary capabilities not found.</code> .. Is this also due to the fact that I used cabal instead of stack?"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "edited": false, "score": 0, "creation_date": 1477055476, "post_id": 40177313, "comment_id": 67622247, "body": "I haven&#39;t tried this yet! How can I change the GHC compiler? I downloaded the GHC 7.8.2 package, but I&#39;m not sure what to do next.."}], "tags": [], "owner": {"reputation": 560, "user_id": 2608413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPuqZ.png?s=128&g=1", "display_name": "Michal Gajda", "link": "https://stackoverflow.com/users/2608413/michal-gajda"}, "is_accepted": false, "score": 1, "last_activity_date": 1477054712, "creation_date": 1477054712, "answer_id": 40177313, "question_id": 40176722, "link": "https://stackoverflow.com/questions/40176722/haskell-gloss-missing-dependencies/40177313#40177313", "title": "Haskell Gloss: missing dependencies", "body": "<p>I would try to install it in a Cabal sandbox first:</p>\n\n<pre><code>$ cabal sandbox init\n$ cabal install LambdaWars\n</code></pre>\n\n<p>But here it looks like you have a version of <code>base</code> package that is incompatible with it. Did you try the older GHC 7.8 compiler with <code>base-4.8</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1477070969, "last_edit_date": 1477070969, "creation_date": 1477067389, "answer_id": 40181480, "question_id": 40176722, "link": "https://stackoverflow.com/questions/40176722/haskell-gloss-missing-dependencies/40181480#40181480", "title": "Haskell Gloss: missing dependencies", "body": "<ul>\n<li>install stack <a href=\"https://docs.haskellstack.org/en/stable/install_and_upgrade/#mac-os-x\" rel=\"nofollow\">osx installation docs</a></li>\n<li>then you can use this</li>\n</ul>\n\n<blockquote>\n  <h2>stack.yaml</h2>\n\n<pre><code>resolver: lts-7.4 # for ghc 8.0.1\n#resolver: lts-6.22 # for ghc 7.10.3\npackages:\n    - '.'\n\nextra-deps:\n- AC-Angle-1.0\n- AC-Vector-Fancy-2.4.0\n\n\nflags: {}\n\nextra-package-dbs: []\n</code></pre>\n</blockquote>\n\n<p>in addition you need to modify a small bit in <code>src/Engines.hs</code></p>\n\n<p>add <code>{-# LANGUAGE CPP -#}</code> on top of the file, delete the <code>import Data.Label.Pure</code> in line 26. And change the other <code>import Data.Label.Pure</code> to the following</p>\n\n<pre><code>#if MIN_VERSION_fclabels(2,0,0) \nimport Data.Label \n#else \nimport Data.Label.Pure \n#endif\n</code></pre>\n\n<p>I could not test this due to glut not working - but it compiles with ghc-8.0.1, I will file a <a href=\"https://github.com/andreyLevushkin/LambdaWars/pull/18\" rel=\"nofollow\">pull request</a> at the <a href=\"https://github.com/andreyLevushkin/LambdaWars\" rel=\"nofollow\">git repo</a></p>\n\n<p>to build lambdawars you need to run</p>\n\n<pre><code>&gt; stack build\n&gt; stack exec -- LambdaWars\n</code></pre>\n\n<p>Note: on on linux you need something like <code>sudo apt-get install freeglut3-dev</code> in order to run it.</p>\n"}], "owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1408, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477070969, "creation_date": 1477052931, "question_id": 40176722, "link": "https://stackoverflow.com/questions/40176722/haskell-gloss-missing-dependencies", "title": "Haskell Gloss: missing dependencies", "body": "<p>As uni assignment, I need to enhance a given Haskell framework with certain features. Since this framework uses the Gloss library, I installed Gloss using <code>cabal install gloss</code>. This gave me no errors, however, when trying to configure the Setup file of the framework (<code>runghc Setup configure</code>), I get the following error message:</p>\n\n<pre><code>Configuring lambda-wars-0.1.0.0...\nSetup: Encountered missing dependencies:\ngloss &gt;=1.8 &amp;&amp; &lt;1.10, random ==1.0.*, time &gt;=1.4 &amp;&amp; &lt;1.6\n</code></pre>\n\n<p>Trying to install these dependencies (e.g. <code>cabal install 'gloss &gt;=1.8 &amp;&amp; &lt;1.10</code>) gives me other error messages:</p>\n\n<pre><code>Resolving dependencies...\ncabal: Could not resolve dependencies:\nnext goal: gloss (user goal)\nrejecting: gloss-1.10.2.3/installed-3mE..., gloss-1.10.2.3, gloss-1.10.2.2,\ngloss-1.10.2.1, gloss-1.10.1.1 (constraint from user target requires &gt;=1.8 &amp;&amp;\n&lt;1.10)\ntrying: gloss-1.9.4.1\nnext goal: base (dependency of gloss-1.9.4.1)\nrejecting: base-4.9.0.0/installed-4.9... (conflict: gloss =&gt; base==4.8.*)\nrejecting: base-4.9.0.0, base-4.8.2.0, base-4.8.1.0, base-4.8.0.0,\nbase-4.7.0.2, base-4.7.0.1, base-4.7.0.0, base-4.6.0.1, base-4.6.0.0,\nbase-4.5.1.0, base-4.5.0.0, base-4.4.1.0, base-4.4.0.0, base-4.3.1.0,\nbase-4.3.0.0, base-4.2.0.2, base-4.2.0.1, base-4.2.0.0, base-4.1.0.0,\nbase-4.0.0.0, base-3.0.3.2, base-3.0.3.1 (constraint from non-upgradeable\npackage requires installed instance)\nDependency tree exhaustively searched.\n</code></pre>\n\n<p>After some research, I figured that this means that my GHC is of a different version then what is required for the project. However, I can't seem to figure out how to actually solve this!</p>\n\n<p>I work on Mac OS X version 10.10.5. </p>\n"}, {"tags": ["haskell", "haskell-vector"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1477055535, "post_id": 40176678, "comment_id": 67622281, "body": "I swear I ranted about this somewhere, but I cannot find it anymore :( I&#39;m not aware of any performance difference between <code>Unboxed</code> and <code>Storable</code> vectors. You may find <a href=\"http://stackoverflow.com/a/21897900/925978\">this answer</a> helpful, as well as my comment on the OP."}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1477057099, "post_id": 40176678, "comment_id": 67623388, "body": "Hmm ... &quot;everyone wants unboxed without knowing why&quot; comment seem appropriate."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1477060058, "post_id": 40176678, "comment_id": 67625604, "body": "Haha, it <i>was</i> in there! I suppose I&#39;m interested in an answer to this question, since it was essentially posed in my (linked) answer as well."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477079930, "post_id": 40176678, "comment_id": 67636647, "body": "<code>Storable</code> vectors are just <code>ForeignPtr</code>s, so it has all the same properties: running a finalizer, not movable by GC, etc. Furthermore, <code>Storable</code> instances should lay out arrays of the type in a way that should be recognized as an array by C (i.e. contiguous, correct alignment) - however, <code>Unbox</code> allows you to write custom instances which do whatever the hell you want! e.g. you may read every <code>k</code>th element more frequently than the rest, so you may decide to store those elements in a contiguous block, or as you mentioned, store tuples separately for fewer cache misses."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477080022, "post_id": 40176678, "comment_id": 67636686, "body": ".. I think the doc states quite clearly why <code>Unbox</code> exists: &quot;Data.Vector.Unboxed: Unboxed vectors with an <b>adaptive representation</b> based on data type families.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 1, "creation_date": 1477207466, "post_id": 40198950, "comment_id": 67666174, "body": "Hmm... Didn&#39;t knew there are tutorials on the haskell-lang page. Maybe a paragraph like that should be added to the vector documentation."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 0, "creation_date": 1477214292, "post_id": 40198950, "comment_id": 67667572, "body": "Maybe send them a PR? Coming from a user who was confused about the library it&#39;s more likely to be merged in."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 19, "last_activity_date": 1477189743, "creation_date": 1477189743, "answer_id": 40198950, "question_id": 40176678, "link": "https://stackoverflow.com/questions/40176678/differences-between-storable-and-unboxed-vectors/40198950#40198950", "title": "Differences between Storable and Unboxed Vectors", "body": "<p>Cribbed from <a href=\"https://haskell-lang.org/library/vector\" rel=\"noreferrer\">https://haskell-lang.org/library/vector</a></p>\n\n<p>Storable and unboxed vectors both store their data in a byte array, avoiding\npointer indirection. This is more memory efficient and allows better usage of\ncaches. The distinction between storable and unboxed vectors is subtle:</p>\n\n<ul>\n<li>Storable vectors require data which is an instance of the <a href=\"http://haddock.stackage.org/lts-3.11/base-4.8.1.0/Foreign-Storable.html#t:Storable\" rel=\"noreferrer\"><code>Storable</code> type\nclass</a>.\nThis data is stored in <code>malloc</code>ed memory, which is <em>pinned</em> (the garbage\ncollector can't move it around). This can lead to memory fragmentation, but\nallows the data to be shared over the C FFI.</li>\n<li>Unboxed vectors require data which is an instance of the <a href=\"http://haddock.stackage.org/lts-3.11/primitive-0.6.1.0/Data-Primitive-Types.html\" rel=\"noreferrer\"><code>Prim</code> type\nclass</a>.\nThis data is stored in GC-managed <em>unpinned</em> memory, which helps avoid memory\nfragmentation. However, this data cannot be shared over the C FFI.</li>\n</ul>\n\n<p>Both the <code>Storable</code> and <code>Prim</code> typeclasses provide a way to store a value as\nbytes, and to load bytes into a value. The distinction is what type of\nbytearray is used.</p>\n\n<p>As usual, the only true measure of performance will be benchmarking. However,\nas a general guideline:</p>\n\n<ul>\n<li>If you don't need to pass values to a C FFI, and you have a <code>Prim</code> instance,\nuse unboxed vectors.</li>\n<li>If you have a <code>Storable</code> instance, use a storable vector.</li>\n<li>Otherwise, use a boxed vector.</li>\n</ul>\n\n<p>There are also other issues to consider, such as the fact that boxed vectors\nare instances of <code>Functor</code> while storable and unboxed vectors are not.</p>\n"}, {"tags": [], "owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "is_accepted": false, "score": 0, "last_activity_date": 1616893380, "creation_date": 1616893380, "answer_id": 66837560, "question_id": 40176678, "link": "https://stackoverflow.com/questions/40176678/differences-between-storable-and-unboxed-vectors/66837560#66837560", "title": "Differences between Storable and Unboxed Vectors", "body": "<p>Another difference is memory overhead:</p>\n<p>As per my measurements:</p>\n<ul>\n<li><code>Data.Vector.Storable.Vector Int</code> has 64 Bytes overhead</li>\n<li><code>Data.Vector.Unboxed.Vector Int</code> has 48 Bytes overhead.</li>\n</ul>\n<p>Source:</p>\n<ul>\n<li><a href=\"https://github.com/nh2/blog/blob/master/posts/Haskell-Storable-Vector-overhead.md#bonus-info-storable-vs-unboxed-vectors\" rel=\"nofollow noreferrer\">https://github.com/nh2/blog/blob/master/posts/Haskell-Storable-Vector-overhead.md#bonus-info-storable-vs-unboxed-vectors</a></li>\n<li><a href=\"https://github.com/haskell/vector/issues/250#issuecomment-808825417\" rel=\"nofollow noreferrer\">https://github.com/haskell/vector/issues/250#issuecomment-808825417</a></li>\n</ul>\n"}], "owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1257, "favorite_count": 4, "accepted_answer_id": 40198950, "answer_count": 2, "score": 12, "last_activity_date": 1616893380, "creation_date": 1477052791, "last_edit_date": 1477056817, "question_id": 40176678, "link": "https://stackoverflow.com/questions/40176678/differences-between-storable-and-unboxed-vectors", "title": "Differences between Storable and Unboxed Vectors", "body": "<p>So ... I've used unboxed vectors (from the <code>vector</code> package) preferably now without giving it much consideration. <code>vector-th-unbox</code> makes creating instances for them a breeze, so why not.</p>\n\n<p>Now I ran into an instance where it is not possible for me to automatically derive those instances, a data type with phantom type parameters (as in <code>Vector (s :: Nat) a</code>, where <code>s</code> encodes the length).</p>\n\n<p>This made me think about the differences between <code>Storable</code> and <code>Unboxed</code> vectors. Things I figured out on my own:</p>\n\n<ul>\n<li><code>Unboxed</code> will store eg tuples as separate vectors leading to better cache locality, by not wasting bandwidth when only one of those values is needed.</li>\n<li><code>Storable</code> will still be compiled to simple (and probably efficient) <code>readArray#</code>s that return unboxed values (as evident by reading core).</li>\n<li><code>Storable</code> allows direct pointer access which allows interoperability with foreign code. <code>Unboxed</code> doesn't.</li>\n<li>[edit] <code>Storable</code> instances are actually easier to write by hand than <code>Unbox</code> (that is <code>Vector</code> and <code>MVector</code>) ones.</li>\n</ul>\n\n<p>That alone doesn't make it evident to me why <code>Unboxed</code> even exists, there seem to be little benefit to it. Probably I am missing something there?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming"], "comments": [{"owner": {"reputation": 42360, "user_id": 389146, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/zGYUq.jpg?s=128&g=1", "display_name": "Karl Bielefeldt", "link": "https://stackoverflow.com/users/389146/karl-bielefeldt"}, "edited": false, "score": 0, "creation_date": 1477054232, "post_id": 40176390, "comment_id": 67621397, "body": "FYI, haskell has built in <code>even</code> and <code>odd</code> functions."}], "answers": [{"comments": [{"owner": {"reputation": 2350, "user_id": 2227168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77294e1343dbf7edc9d308fd966d8d87?s=128&d=identicon&r=PG", "display_name": "pishpish", "link": "https://stackoverflow.com/users/2227168/pishpish"}, "edited": false, "score": 1, "creation_date": 1477054059, "post_id": 40176549, "comment_id": 67621269, "body": "I don&#39;t believe his teacher will accept this as a recursive solution."}, {"owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "reply_to_user": {"reputation": 2350, "user_id": 2227168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77294e1343dbf7edc9d308fd966d8d87?s=128&d=identicon&r=PG", "display_name": "pishpish", "link": "https://stackoverflow.com/users/2227168/pishpish"}, "edited": false, "score": 0, "creation_date": 1477054633, "post_id": 40176549, "comment_id": 67621699, "body": "@changed Can you provide an alternative recursive solution if possible?"}, {"owner": {"reputation": 444, "user_id": 1554137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb537e77e97db2071395a0b2a4c8a593?s=128&d=identicon&r=PG", "display_name": "Alexander VoidEx Ruchkin", "link": "https://stackoverflow.com/users/1554137/alexander-voidex-ruchkin"}, "reply_to_user": {"reputation": 2350, "user_id": 2227168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77294e1343dbf7edc9d308fd966d8d87?s=128&d=identicon&r=PG", "display_name": "pishpish", "link": "https://stackoverflow.com/users/2227168/pishpish"}, "edited": false, "score": 0, "creation_date": 1477056259, "post_id": 40176549, "comment_id": 67622792, "body": "@changed, well, i agree :) it&#39;s not recursive"}], "tags": [], "owner": {"reputation": 444, "user_id": 1554137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb537e77e97db2071395a0b2a4c8a593?s=128&d=identicon&r=PG", "display_name": "Alexander VoidEx Ruchkin", "link": "https://stackoverflow.com/users/1554137/alexander-voidex-ruchkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1477056544, "last_edit_date": 1477056544, "creation_date": 1477052453, "answer_id": 40176549, "question_id": 40176390, "link": "https://stackoverflow.com/questions/40176390/recursively-report-the-sum-of-the-list-if-it-contains-exactly-3-odd-numbers/40176549#40176549", "title": "Recursively report the sum of the list if it contains exactly 3 odd numbers", "body": "<p>List comprehension has another syntax:</p>\n\n<pre><code>[expr | x &lt;- xs, ...]\n</code></pre>\n\n<p>So in your case:</p>\n\n<pre><code>function xs = if length xs' == 3 then sum xs else (length xs' - length xs'') where\n    xs' = [x | x &lt;- xs, mod x 2 == 1]\n    xs'' = [x | x &lt;- xs, mod x 2 == 0]\n</code></pre>\n\n<p>But you can use function <code>partition</code> to get <code>xs'</code> and <code>xs''</code> at once:</p>\n\n<pre><code>(xs', xs'') = partition (\\x -&gt; mod x 2 == 1) xs\n</code></pre>\n\n<p>As mentioned in comments, it's not recursive. The idea of solution is in @michal-gajda answer: go over list and collect number of odds, evens and sum. At the end make a decision:</p>\n\n<pre><code>function = go 0 0 0 where -- same as function xs = go 0 0 0 xs\n    go odds evens s [] = if odds == 3 then s else odds - evens\n    go odds evens s (x:xs)\n        | odd x = go (odds + 1) evens (s + x) xs\n        | otherwise = go odds (evens + 1) (s + x) xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 560, "user_id": 2608413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPuqZ.png?s=128&g=1", "display_name": "Michal Gajda", "link": "https://stackoverflow.com/users/2608413/michal-gajda"}, "is_accepted": false, "score": 2, "last_activity_date": 1477054976, "creation_date": 1477054976, "answer_id": 40177395, "question_id": 40176390, "link": "https://stackoverflow.com/questions/40176390/recursively-report-the-sum-of-the-list-if-it-contains-exactly-3-odd-numbers/40177395#40177395", "title": "Recursively report the sum of the list if it contains exactly 3 odd numbers", "body": "<p>You should probably use internal function <code>go</code>, that recursively accumulates three results:</p>\n\n<ol>\n<li>Number of odds in the list.</li>\n<li>Number of evens in the list.</li>\n<li>Sum of the list.</li>\n</ol>\n\n<p>Then, when the list is empty, you decide what to return:</p>\n\n<pre><code>finalStep (odds, evens, sum) | odds == 3 = sum\n                             | otherwise = odds-evens\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 1, "accepted_answer_id": 40176549, "answer_count": 2, "score": 0, "last_activity_date": 1477873062, "creation_date": 1477051941, "last_edit_date": 1477873062, "question_id": 40176390, "link": "https://stackoverflow.com/questions/40176390/recursively-report-the-sum-of-the-list-if-it-contains-exactly-3-odd-numbers", "title": "Recursively report the sum of the list if it contains exactly 3 odd numbers", "body": "<p>I am new to haskell.I am trying to create a function that recursively report the sum of the list.Can sb help me?</p>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1477051289, "post_id": 40176004, "comment_id": 67619303, "body": "You can&#39;t. <code>fmap</code> only takes a single function as an argument, and there is no way for that function to make a distinction between the two values wrapped by <code>Cow</code> and <code>Dog</code>. If you redefine your type as a <code>Bifunctor</code>, you can apply separate functions via <code>bimap</code>."}, {"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477052842, "post_id": 40176004, "comment_id": 67620387, "body": "@chepner Understood, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1477055910, "post_id": 40177620, "comment_id": 67622533, "body": "&quot;The only drawback to this approach is that your type no longer constrains the two values wrapped by the data constructors to have the same type&quot; - just work with <code>type Animals&#39; a = Animals a a</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1477063327, "post_id": 40177620, "comment_id": 67627947, "body": "You can even use <code>newtype Animals a = Animals (Animals&#39; a a)</code>, which is itself a <code>Functor</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1477063994, "post_id": 40177620, "comment_id": 67628393, "body": "@dfeuer You need the type alias so that you can still use <code>bimap</code>, no?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1477064635, "post_id": 40177620, "comment_id": 67628748, "body": "@chepner, well, only if you want to use it directly. You could always unwrap, bimap, rewrap. <code>bimapAnimals f g (Animals x) = Animals (bimap f g x)</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1477064897, "post_id": 40177620, "comment_id": 67628894, "body": "@chepner, maybe my prejudice is showing. I greatly dislike using type synonyms for almost any purpose. The one place I&#39;ve seen them look really useful is for wrapping up higher-rank types, as in <code>lens</code>. I also don&#39;t mind the <code>Simple</code> type synonym in <code>lens</code>; I think that&#39;s probably because a simple lens tends to stay simple unless you do something a bit weird to it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1477067736, "post_id": 40177620, "comment_id": 67630402, "body": "I try to avoid type synonyms, too (or at least to the extent that 90% of my Haskell programming, alas, is cherry-picking the easier questions posted here). I was thinking about a wrapper along the lines you posted, but didn&#39;t have a chance to actually think through what it would be."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1477062445, "last_edit_date": 1477062445, "creation_date": 1477055601, "answer_id": 40177620, "question_id": 40176004, "link": "https://stackoverflow.com/questions/40176004/separating-custom-type-values-using-functors/40177620#40177620", "title": "Separating custom type values using functors?", "body": "<p>The type of <code>fmap</code> for your data type would be <code>(a -&gt; b) -&gt; Animals a -&gt; Animals b</code>. This very tightly constrains the possible implementations of <code>fmap</code>, so much that there <em>is</em> only one possible implementation that obeys the functor laws (<code>fmap id == id</code>, <code>fmap (f . g) == fmap f . fmap g</code>).</p>\n\n<pre><code>instance Functor Animals where\n  fmap f (Cow a b) = ???\n  fmap f (Dog a b) = ???\n</code></pre>\n\n<p>First, you don't know anything about the function <code>f</code> other than it can be applied to each of the values wrapped by the data constructors, so that's all we can do with it.</p>\n\n<p>Second, we know that the return value must be of type <code>Animals b</code>, and that we can't switch from <code>Cow</code> to <code>Dog</code> or vice versa (otherwise, <code>fmap id == id</code> would not hold). From this, we know the instance must look like</p>\n\n<pre><code>instance Functor Animals where\n  fmap f (Cow a b) = Cow (f a) (f b)\n  fmap f (Dog a b) = Dog (f a) (f b)\n</code></pre>\n\n<p>There is no room in the type signature to specify a second function <code>g</code>, and there is no way for <code>f</code> to know which \"half\" of the <code>Animals</code> value it is applied to for it to simulate two different functions.</p>\n\n<hr>\n\n<p>If you instead redefine your type with</p>\n\n<pre><code>data Animals' a b = Cow a b | Dog a b\ntype Animal a = Animals' a a\n</code></pre>\n\n<p>you can define an instance of <code>Bifunctor</code> for <code>Animals'</code>, which defines a function <code>Bimap</code> that <em>can</em> apply a different function to each half.</p>\n\n<pre><code>instance Bifunctor Animals' where\n  bimap f g (Cow a b) = Cow (f a) (g b)\n  bimap f g (Dog a b) = Dog (f a) (g b)\n</code></pre>\n\n<p>You also get two additional functions <code>first</code> and <code>second</code> which apply a single function to only the first and second types wrapped by the type constructor. They have default implementations of <code>first f = bimap f id</code> and <code>second g = bimap id g</code>, so you don't need to define if you defined <code>bimap</code>. (Likewise, <code>bimap f g = first f . second g</code> by default, so it\nwould be sufficient to define the pair <code>first</code> and <code>second</code> instead of <code>bimap</code>.)</p>\n\n<p>Make sure you never use <code>Animals'</code> directly to ensure that none of your functions will accept a chimaera like <code>Cow 3 \"c\"</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1477144990, "last_edit_date": 1477144990, "creation_date": 1477115494, "answer_id": 40188804, "question_id": 40176004, "link": "https://stackoverflow.com/questions/40176004/separating-custom-type-values-using-functors/40188804#40188804", "title": "Separating custom type values using functors?", "body": "<p>As chepner aptly demonstrated in their answer, you have a trilemma to deal with. There is no way of having <code>Animals</code> with fields of necessarily equal types while being able to map different functions over each field <em>and</em> enjoying the advantages of a well-known and widespread functor class -- you have to drop one of the three:</p>\n\n<ul>\n<li><p>You can keep the original type and write a <code>Functor</code> instance that does the same thing to fields homogeneously, which is what you are trying to avoid...</p></li>\n<li><p>... or change <code>Animals a</code> to <code>Animals a b</code>, sacrificing one of your invariants in order to make a <code>Bifunctor</code> instance possible, which is chepner's solution...</p></li>\n<li><p>... or content yourself with a mapping function specific to <code>Animals</code>, which has no generality but at least implements exactly what you want:</p></li>\n</ul>\n\n\n\n<pre><code>animalMap :: (a -&gt; b) -&gt; (a -&gt; b) -&gt; Animals a -&gt; Animals b\nanimalMap f g ani = case ani of\n    Cow x y -&gt; Cow (f x) (g y)\n    Dog x y -&gt; Dog (f x) (g y)\n</code></pre>\n\n<p>On the balance of things I have a slight preference for the third solution, however disappointing it may be.</p>\n\n<hr>\n\n<p>The remainder of this answer is a long footnote in which I will show a way of making the third solution a little nicer. I am not suggesting that you actually use it -- it is almost certainly overkill for your use case -- but it is a nice possibility to be aware of.</p>\n\n<p>As you know, one of the great things about functions in Haskell is that they can be composed:</p>\n\n<pre><code>GHCi&gt; ((2+) . (3*) . (4+)) 1\n17\n</code></pre>\n\n<p>Composition allows us to think about functions independently from the concrete data they affect. Being able to compose in a clean and easy way is beneficial in many ways, perhaps too many to list here.</p>\n\n<p>Now, if you look again at <code>animalMap</code> and consider how similar it is to <code>fmap</code>, you would be justified in thinking that each <em>pair</em> of functions <code>a -&gt; b</code> specifies a way to transform (via <code>animalMap</code>) an <code>Animals</code> just as much as any single function specifies a way to transform a list or any other <code>Functor</code> value (via <code>fmap</code>):</p>\n\n<pre><code>GHCi&gt; let rex = Dog 2 5\nGHCi&gt; let ff = ((2*) . (1+), (3*) . (4+))\nGHCi&gt; (\\(f, g) -&gt; animalMap f g) ff rex\nDog 6 27\nGHCi&gt; -- Or, equivalently:\nGHCi&gt; uncurry animalMap ff rex\nDog 6 27\nGHCi&gt; -- A different pair:\nGHCi&gt; let gg = ((1+), subtract 3)\nGHCi&gt; uncurry animalMap gg rex\nDog 3 2\n</code></pre>\n\n<p>That being so, it would be reasonable to want to compose pairs of functions meant to be used with <code>animalMap</code>, just like regular functions are composed. Doing that in the immediately obvious way, however, is very messy:</p>\n\n<pre><code>GHCi&gt; uncurry animalMap ((\\(h, k) (f, g) -&gt; (h . f, k . g)) gg ff) rex -- yuck\nDog 7 24\n</code></pre>\n\n<p>You can, of course, avoid writing that ugly lambda explicitly by using it to define a separate composition function, analogous to <code>(.)</code> but specific to your use case. That doesn't brighten things all that much, though.</p>\n\n<p>The twist in this story is that there actually is a standard type class that generalises <code>(.)</code> beyond functions to other things that can be composed. That class is called <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Category.html\" rel=\"nofollow\"><code>Category</code></a>. If we define a new type for the paired functions, we can give it an instance of <code>Category</code> like this:</p>\n\n<pre><code>import Control.Category\nimport Prelude hiding (id, (.))\n\nnewtype Duof a b = Duof { runDuof :: (a -&gt; b, a -&gt; b) }\n\ninstance Category Duof where\n    id = Duof (id, id)\n    (Duof (h, k)) . (Duof (f, g)) = Duof (h . f, k . g)\n</code></pre>\n\n<p>Next, we might as well redefine <code>animalMap</code> in terms of <code>Duof</code>:</p>\n\n<pre><code>animalMap :: Duof a b -&gt; Animals a -&gt; Animals b\nanimalMap (Duof (f, g)) ani = case ani of\n    Cow x y -&gt; Cow (f x) (g y)\n    Dog x y -&gt; Dog (f x) (g y)\n</code></pre>\n\n<p>The net result is that composition is much neater:</p>\n\n<pre><code>GHCi&gt; let ff = Duof ((2*) . (1+), (3*) . (4+))\nGHCi&gt; let gg = Duof ((1+), subtract 3)\nGHCi&gt; animalMap (gg . ff) rex\nDog 7 24\n</code></pre>\n\n<p>Do note that this new <code>animalMap</code> looks an awful lot like <code>fmap</code> for <code>Animals</code>, except that it takes a <code>Duof</code> instead of a function. In fact, there is nothing stopping us from defining a new type class called <code>DuofFunctor</code> with a method <code>duofmap :: Duof a b -&gt; f a -&gt; f b</code> and making <code>Animals</code> an instance of it -- nothing, that is, except that it is kind of pointless to define a new general-purpose class if you only need it for one instance. In any case, this <code>DuofFunctor</code> would correspond exactly to how you wanted to write the <code>Functor</code> instance before you realised it was impossible.</p>\n\n<hr>\n\n<p>P.S.: A remark on naming conventions, unrelated to the question itself. Usually we would name your data type as <code>Animal</code>, rather than <code>Animals</code>. Even though your data type covers several species of animals, data types almost always have names in the singular, as these names are meant as a description of an individual value of that type (e.g. a cow is an <code>Animal</code>, and so is a dog).</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 40177620, "answer_count": 2, "score": 1, "last_activity_date": 1477144990, "creation_date": 1477050654, "question_id": 40176004, "link": "https://stackoverflow.com/questions/40176004/separating-custom-type-values-using-functors", "title": "Separating custom type values using functors?", "body": "<p>I have the below type:</p>\n\n<pre><code>data Animals a = Cow a a | Dog a a deriving (Show, Eq, Ord)\n</code></pre>\n\n<p>I've trying to apply different functions to each of the 'a' values associate with the animal instances.</p>\n\n<p>E.g. </p>\n\n<pre><code>myCow = \"Big\" \"White\"\n\nfunction1 :: Animals a -&gt; Animals a\nfunction1 cow = --do something with \"Big\", then something else with \"White\"\n</code></pre>\n\n<p>This won't work with my functor definition:</p>\n\n<pre><code>instance Functor Animals where\n  fmap f (Cow a b) = Cow (f a) (f b) --I want to apply different functions to 'a' and 'b'! \n</code></pre>\n\n<p>How can I define my functor to enable this?</p>\n"}, {"tags": ["haskell", "functor", "applicative", "custom-data-type"], "comments": [{"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 1, "creation_date": 1477045199, "post_id": 40173864, "comment_id": 67615447, "body": "There is a kind mis-match, a Functor instance must have kind <code>* -&gt; *</code> whereas your <code>User</code> type is of kind <code>* -&gt; * -&gt; *</code>. What you want is a <a href=\"http://hackage.haskell.org/package/profunctors-5.2/docs/Data-Profunctor.html#t:Profunctor\" rel=\"nofollow noreferrer\">Profunctor</a>."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 3, "creation_date": 1477046087, "post_id": 40173864, "comment_id": 67616051, "body": "As well as the kind error, your <code>pure</code> implementation won&#39;t work because there&#39;s no variable <code>b</code> in the definition. How would you expect to be able to write the function <code>a -&gt; User a b</code>?"}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 2, "creation_date": 1477048537, "post_id": 40173864, "comment_id": 67617533, "body": "@baxbaxwalanuksiwe Do you mean <code>Bifunctor</code>?"}, {"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1477058898, "post_id": 40173864, "comment_id": 67624687, "body": "@ThreeFx yes, sorry."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 1, "creation_date": 1477058944, "post_id": 40173864, "comment_id": 67624730, "body": "@baxbaxwalanuksiwe Profunctor is <i>cofunctorial</i> in it&#39;s first argument. The arrow goes the other way around: <code>dimap :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; p b c -&gt; p a d</code> as opposed to <code>bimap :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d</code>."}, {"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1477058969, "post_id": 40173864, "comment_id": 67624750, "body": "@ThreeFx just noticed this, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1477049576, "post_id": 40175445, "comment_id": 67618200, "body": "You can probably derive the pair&#39;s instance by using a <code>newtype</code> for <code>User</code> and use the extension <code>GeneralizedNewtypeDeriving</code>."}], "tags": [], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "is_accepted": true, "score": 5, "last_activity_date": 1477049704, "last_edit_date": 1477049704, "creation_date": 1477049055, "answer_id": 40175445, "question_id": 40173864, "link": "https://stackoverflow.com/questions/40173864/using-functors-applicatives-on-custom-data-types-with-multiple-type-classes/40175445#40175445", "title": "Using functors/applicatives on custom data types with multiple type classes?", "body": "<p>Have a look at <a href=\"https://hackage.haskell.org/package/bifunctors-5/docs/Data-Bifunctor.html\" rel=\"nofollow\"><code>Data.Bifunctor</code></a> for a type class for ADTs which are functorial in both arguments. <code>User</code> is then just a fancy name for tuple, and this already supports such an instance. Deriving a bifunctor instance is possible in Haskell.</p>\n\n<p>@Bakuriu suggests defining <code>User</code> as a <code>newtype</code> and the using the extension <code>GeneralizedNewtypeDeriving</code>.</p>\n\n<p>For the second one, see <a href=\"https://hackage.haskell.org/package/bifunctors-3.2.0.1/docs/Data-Biapplicative.html\" rel=\"nofollow\"><code>Biapplicative</code></a>. As to be expected, its instance for <code>(,)</code> is:</p>\n\n<pre><code>instance Biapplicative (,) where\n  pure = (,)\n  ap (f, g) (a, b) = (f a, g b)\n</code></pre>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 1, "accepted_answer_id": 40175445, "answer_count": 1, "score": 3, "last_activity_date": 1477049704, "creation_date": 1477044575, "last_edit_date": 1477048620, "question_id": 40173864, "link": "https://stackoverflow.com/questions/40173864/using-functors-applicatives-on-custom-data-types-with-multiple-type-classes", "title": "Using functors/applicatives on custom data types with multiple type classes?", "body": "<p>Consider a Users type with two parameters, a and b. Clearly, this enables User to be composed of two different types:</p>\n\n<pre><code>data Users a b = User a b deriving (Show, Eq, Ord)\n</code></pre>\n\n<p>How can we declare functors and applicative for this instance? </p>\n\n<p>I've tried these approaches won't compile: </p>\n\n<pre><code>instance Functor Users where\n   fmap f(User a b) = User (f a) (f b) \n\ninstance Applicative Users where\n   pure a b = User a b\n   (&lt;*&gt;) User a b = (fmap a) (fmap b)\n</code></pre>\n\n<p>What's the reason these won't compile? </p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1477039039, "post_id": 40171466, "comment_id": 67611590, "body": "Do you really have to test those? I think their implementation is forced by their type (by their associated free theorem)."}, {"owner": {"reputation": 17, "user_id": 4483177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cffee33bb27f0cd1eaccd6579fac5a76?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Chen", "link": "https://stackoverflow.com/users/4483177/jeremy-chen"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1477039744, "post_id": 40171466, "comment_id": 67611980, "body": "Actually this is an exercise from <a href=\"http://haskellbook.com/\" rel=\"nofollow noreferrer\">haskellBook</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1477040675, "post_id": 40171466, "comment_id": 67612561, "body": "I see, so it&#39;s an exercise just for the sake of it. I have no idea about what a meaningful test could be for those, though. I mean, I could compare test them against their own definitions, which feels weird."}], "answers": [{"tags": [], "owner": {"reputation": 560, "user_id": 2608413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPuqZ.png?s=128&g=1", "display_name": "Michal Gajda", "link": "https://stackoverflow.com/users/2608413/michal-gajda"}, "is_accepted": false, "score": 0, "last_activity_date": 1477055158, "creation_date": 1477055158, "answer_id": 40177457, "question_id": 40171466, "link": "https://stackoverflow.com/questions/40171466/how-to-write-tests-using-quickcheck-for-the-definition-of/40177457#40177457", "title": "How to write tests using QuickCheck for the definition of ($)", "body": "<p>QuickCheck works only on concrete types, so you first need to instantiate the type:</p>\n\n<pre><code>($) :: (Int -&gt; String) -&gt; Int -&gt; String\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4483177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cffee33bb27f0cd1eaccd6579fac5a76?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Chen", "link": "https://stackoverflow.com/users/4483177/jeremy-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1477055158, "creation_date": 1477037370, "question_id": 40171466, "link": "https://stackoverflow.com/questions/40171466/how-to-write-tests-using-quickcheck-for-the-definition-of", "title": "How to write tests using QuickCheck for the definition of ($)", "body": "<p>And also for composing function.</p>\n\n<pre><code>f $ a = f a\nf . g = \\x -&gt; f (g x)\n</code></pre>\n"}, {"tags": ["scala", "haskell", "group-by", "functional-programming"], "comments": [{"owner": {"reputation": 979, "user_id": 806261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be401772aab83e8c0d7fd8bbdcbc7e7a?s=128&d=identicon&r=PG", "display_name": "Mustafa Simav", "link": "https://stackoverflow.com/users/806261/mustafa-simav"}, "edited": false, "score": 0, "creation_date": 1477038964, "post_id": 40171415, "comment_id": 67611538, "body": "Does your project have a functional programming library dependency such as <code>Scalaz</code> or <code>cats</code>? If not, do you mind adding one? Because this can be solved with a <code>Monoid</code> and <code>foldMap</code>."}, {"owner": {"reputation": 4237, "user_id": 3891342, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FVJOq.jpg?s=128&g=1", "display_name": "Daniel Shin", "link": "https://stackoverflow.com/users/3891342/daniel-shin"}, "reply_to_user": {"reputation": 979, "user_id": 806261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be401772aab83e8c0d7fd8bbdcbc7e7a?s=128&d=identicon&r=PG", "display_name": "Mustafa Simav", "link": "https://stackoverflow.com/users/806261/mustafa-simav"}, "edited": false, "score": 0, "creation_date": 1477039424, "post_id": 40171415, "comment_id": 67611809, "body": "@MustafaSimav Yes, my project depends on <code>Scalaz</code>!"}, {"owner": {"reputation": 35368, "user_id": 5344058, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-stTbjZ7x-P8/AAAAAAAAAAI/AAAAAAAAAAo/Sd95DB3qdzQ/photo.jpg?sz=128", "display_name": "Tzach Zohar", "link": "https://stackoverflow.com/users/5344058/tzach-zohar"}, "edited": false, "score": 0, "creation_date": 1477039815, "post_id": 40171415, "comment_id": 67612017, "body": "Shouldn&#39;t <code>multiGroupBy</code> return a <code>Map[K, Seq[A]]</code> and not <code>Map[K, A]</code>?"}, {"owner": {"reputation": 4237, "user_id": 3891342, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FVJOq.jpg?s=128&g=1", "display_name": "Daniel Shin", "link": "https://stackoverflow.com/users/3891342/daniel-shin"}, "reply_to_user": {"reputation": 35368, "user_id": 5344058, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-stTbjZ7x-P8/AAAAAAAAAAI/AAAAAAAAAAo/Sd95DB3qdzQ/photo.jpg?sz=128", "display_name": "Tzach Zohar", "link": "https://stackoverflow.com/users/5344058/tzach-zohar"}, "edited": false, "score": 0, "creation_date": 1477041564, "post_id": 40171415, "comment_id": 67613100, "body": "@TzachZohar Thanks. Corrected. Actually <code>groupBy</code> had to return <code>Map[K, Seq[A]]</code> as well."}], "answers": [{"comments": [{"owner": {"reputation": 4237, "user_id": 3891342, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FVJOq.jpg?s=128&g=1", "display_name": "Daniel Shin", "link": "https://stackoverflow.com/users/3891342/daniel-shin"}, "edited": false, "score": 0, "creation_date": 1477041747, "post_id": 40172234, "comment_id": 67613217, "body": "Thanks for your answer. But what I wanted to know was not the implementation of such operation (I implemented it already using similar implementation as scala&#39;s <code>groupBy</code>), but rather there is already a method for such operation. I&#39;m pretty sure there isn&#39;t an equivalent in scala std but I was curious if there is a common terminology for it in general functional programming community."}, {"owner": {"reputation": 4237, "user_id": 3891342, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FVJOq.jpg?s=128&g=1", "display_name": "Daniel Shin", "link": "https://stackoverflow.com/users/3891342/daniel-shin"}, "edited": false, "score": 0, "creation_date": 1477041815, "post_id": 40172234, "comment_id": 67613267, "body": "So that I can name my new method better than <code>multiGroupBy</code> ;)"}], "tags": [], "owner": {"reputation": 979, "user_id": 806261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be401772aab83e8c0d7fd8bbdcbc7e7a?s=128&d=identicon&r=PG", "display_name": "Mustafa Simav", "link": "https://stackoverflow.com/users/806261/mustafa-simav"}, "is_accepted": false, "score": 1, "last_activity_date": 1477040734, "last_edit_date": 1477040734, "creation_date": 1477039825, "answer_id": 40172234, "question_id": 40171415, "link": "https://stackoverflow.com/questions/40171415/is-there-a-term-for-groupby-that-returns-multiple-groups/40172234#40172234", "title": "Is there a term for groupBy that returns multiple groups?", "body": "<p>If you have <code>Scalaz</code> dependency, you can do it with a <code>foldMap</code>.    </p>\n\n<pre><code>import scalaz._\nimport Scalaz._\n\ncase class Animal(name: String, traits: Seq[String])\n\nval animals = List(\n  Animal(\"cat\", Seq(\"nocturnal\", \"feline\")),\n  Animal(\"dog\", Seq(\"canine\")),\n  Animal(\"wolf\", Seq(\"nocturnal\", \"canine\"))\n)\n\nval r1 = animals.foldMap(a =&gt; a.traits.map(t =&gt; t -&gt; List(a)).toMap)\nprintln(r1)\n// Map(nocturnal -&gt; List(Animal(cat,List(nocturnal, feline)), Animal(wolf,List(nocturnal, canine))), feline -&gt; List(Animal(cat,List(nocturnal, feline))), canine -&gt; List(Animal(dog,List(canine)), Animal(wolf,List(nocturnal, canine))))\n\nval r2 = animals.foldMap(a =&gt; a.traits.map(t =&gt; t -&gt; List(a.name)).toMap)\nprintln(r2)\n// Map(nocturnal -&gt; List(cat, wolf), feline -&gt; List(cat), canine -&gt; List(dog, wolf))\n</code></pre>\n\n<p>What we did here is that we created a <code>Map[String, List[Animal]]</code> for each animal in animals list and let <code>Monoid[Map[String, List[Animal]]]</code> to merge each maps.</p>\n\n<p>For example <code>Animal(\"cat\", Seq(\"nocturnal\", \"feline\"))</code> turned into <code>Map(\"nocturnal\" -&gt; List(Animal(\"cat\", Seq(\"nocturnal\", \"feline\"))), \"feline\" -&gt; List(Animal(\"cat\", Seq(\"nocturnal\", \"feline\"))))</code>.</p>\n\n<p>For furhter reading about monoid: <a href=\"http://eed3si9n.com/learning-scalaz/Monoid.html\" rel=\"nofollow\">http://eed3si9n.com/learning-scalaz/Monoid.html</a></p>\n"}], "owner": {"reputation": 4237, "user_id": 3891342, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FVJOq.jpg?s=128&g=1", "display_name": "Daniel Shin", "link": "https://stackoverflow.com/users/3891342/daniel-shin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1477041911, "creation_date": 1477037231, "last_edit_date": 1477041911, "question_id": 40171415, "link": "https://stackoverflow.com/questions/40171415/is-there-a-term-for-groupby-that-returns-multiple-groups", "title": "Is there a term for groupBy that returns multiple groups?", "body": "<p>Type signature of <code>groupBy</code> is (in scala language, but really language-agnostic):</p>\n\n<pre><code>def groupBy[K](f: A =&gt; K): Map[K, Seq[A]]\n</code></pre>\n\n<p>I implemented a <code>groupBy</code> that returns multiple <code>K</code>, so that each <code>A</code> can be put into multiple groups at the same time. Something like this:</p>\n\n<pre><code>def multiGroupBy[K](f: A =&gt; Seq[K]): Map[K, Seq[A]]\n</code></pre>\n\n<p>I do something like:</p>\n\n<pre><code>case class Animal(name: String, traits: Seq[String])\n\nList(\n  Animal(\"cat\", Seq(\"nocturnal\", \"feline\")),\n  Animal(\"dog\", Seq(\"canine\")),\n  Animal(\"wolf\", Seq(\"nocturnal\", \"canine\"))\n).multiGroupBy(animal =&gt; animal.traits)\n\n// Map(nocturnal -&gt; List(cat, wolf), feline -&gt; List(cat), canine -&gt; List(dog, wolf))\n</code></pre>\n\n<p>Name <code>multiGroupBy</code> works but I'm wondering if there is already a term (perhaps in haskell world?) for operation like above.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1477062217, "post_id": 40171037, "comment_id": 67627204, "body": "&quot;Is this idea better represented with an extensible records library?&quot; There is a library called &quot;generics-sop&quot; that lets you do something like it. See these other questions: <a href=\"http://stackoverflow.com/questions/39020787/is-there-a-way-to-apply-maybe-constructor-to-each-field-of-record-with-generics\" title=\"is there a way to apply maybe constructor to each field of record with generics\">stackoverflow.com/questions/39020787/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/38248692/whats-a-better-way-of-managing-large-haskell-records\" title=\"whats a better way of managing large haskell records\">stackoverflow.com/questions/38248692/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1477038448, "post_id": 40171268, "comment_id": 67611246, "body": "What&#39;s the easiest way to get a <code>ProductWithRegularFields</code> from a <code>Product Identity</code> at the value-level (i.e. runtime)?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1477038919, "post_id": 40171268, "comment_id": 67611512, "body": "@SaurabhNanda You don&#39;t have to do anything, they are exactly the same type. Above I used type synonyms <code>type T = </code> instead of declaring new types <code>data T = ...</code>."}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1477039083, "post_id": 40171268, "comment_id": 67611614, "body": "let me rephrase. How to get a <code>Product</code> value where each field is NOT an <code>Identity x</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 1, "creation_date": 1477040379, "post_id": 40171268, "comment_id": 67612363, "body": "In this approach, every field has type <code>k x</code> for some <code>k</code>. It can&#39;t have type <code>x</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 1, "creation_date": 1477055076, "post_id": 40171268, "comment_id": 67621972, "body": "@SaurabhNanda chi is right. On the other hand, an <code>Identity a</code> value <i>is</i> an <code>a</code> value, except for the annoying <code>Identity</code> wrapper. You can either pretend the wrapper isn&#39;t there while using <code>(&lt;$&gt;)</code> and <code>(&lt;*&gt;)</code> to manipulate the underlying value, or get rid of the wrapper with <code>runIdentity</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1477055893, "post_id": 40171268, "comment_id": 67622519, "body": "@SaurabhNanda Indeed, you can convert any <code>x</code> into <code>Identity x</code> using the constructor <code>Identity :: x -&gt; Identity x</code>, and you can convert things in the other direction using the inverse function <code>runIdentity :: Identity x -&gt; x</code>. It <i>is</i> a bit inconvenient to have to wrap/unwrap things, but it can be done."}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1477061801, "post_id": 40171268, "comment_id": 67626908, "body": "Can <code>runIdentity</code> be used to convert a <code>Product Identity</code> (from your example) to a <code>Product</code> (from my original question)? Basically, what&#39;s the easiest way to go from <code>{id :: Identity ProductID, name :: Identity Text} -&gt; {id :: ProductID, name :: Text}</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1477063335, "post_id": 40171268, "comment_id": 67627954, "body": "You can define (or derive) a <code>Functor</code> instance for <code>Product</code>, then define <code>identity2regular = fmap runIdentity</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1477089072, "post_id": 40171268, "comment_id": 67640211, "body": "(@SaurabhNanda) @chepner This <code>Product</code> has fields with types different from each other, though, which rules <code>Functor</code> out. It seems to me that having with two separate <code>Product</code> types might end up being more annoying overall than just removing the <code>Identity</code> wrappers at usage point... unless, perhaps, if you take a generics-based approach, like danidiaz suggests in a comment to the question."}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1477100363, "post_id": 40171268, "comment_id": 67642489, "body": "Edited the question to give usage context. See if that helps clarify the answer."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1477113267, "post_id": 40171268, "comment_id": 67644164, "body": "@SaurabhNanda, I think chi&#39;s approach is likely the one you want. You can write a function <code>mapProd :: (forall a . j a -&gt; k a) -&gt; Product j -&gt; Product k</code> to, for instance, &quot;upgrade&quot; <code>Product Identity</code> to <code>Product Omittable</code>. Your actual use case may call for a similar zipping function: <code>zipProd :: (forall a . j a -&gt; k a -&gt; m a) -&gt; Product j -&gt; Product k -&gt; Product m</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1477036733, "creation_date": 1477036733, "answer_id": 40171268, "question_id": 40171037, "link": "https://stackoverflow.com/questions/40171037/apply-a-function-to-all-fields-in-a-record-at-the-type-level/40171268#40171268", "title": "Apply a function to all fields in a record at the type-level", "body": "<p>A possible way:</p>\n\n<pre><code>import Control.Functor.Identity\n\ndata Product k = Product {\n    id :: k ProductId\n  , name :: k Text\n  , sku :: k SKU\n  , quantity :: k Int\n  , description :: k (Maybe Text)\n  }\n\ndata Omittable a = Omit | Present a\ntype ProductWithOmittableFields = Product Omittable\ntype ProductWithRegularFields = Product Identity\n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>testOmit :: ProductWithOmittableFields\ntestOmit = Product\n     { id = Present someProductId\n     , name = Omit\n     ... }\n\ntestReg :: ProductWithRegularFields\ntestReg = Product\n     { id = Identity someProductId\n     , name = Identity someText\n     ... }\n</code></pre>\n\n<p>This approach only has the minor inconvenience of wrapping each field with an <code>Identity</code> in the regular case.</p>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1477100326, "creation_date": 1477035864, "last_edit_date": 1477100326, "question_id": 40171037, "link": "https://stackoverflow.com/questions/40171037/apply-a-function-to-all-fields-in-a-record-at-the-type-level", "title": "Apply a function to all fields in a record at the type-level", "body": "<p>Is there a way to do the following in the type system easily?</p>\n\n<pre><code>data Product = Product {\n    id :: ProductId\n  , name :: Text\n  , sku :: SKU, quantity :: Int\n  , description :: Maybe Text\n  }\n\ndata Omittable a = Omit | Present a\ntype ProductWithOmittableFields = Omittable Product\n\n-- ProductWithOmittableFields is now equivalent to:\\\n--\n-- data ProductWithOmittableFields = ProductWithOmmitableFields { \n--     id :: Omittable ProductId\n--    ,name :: Omittable Text\n--    ,sku : : Omittable SKU\n--    ,quantity :: Omittable Int\n--    ,desciption :: Omittable (Maybe Text)\n--  }\n</code></pre>\n\n<p>It\u2019s basically some sort of a container (functor?) which is applied to every field of a record at the type-level.</p>\n\n<p>Is this idea better represented with an extensible records library?</p>\n\n<p><strong>edit</strong> the use case is that we will get a <code>ProductWithOmittableFields</code> from the UI layer, representing the set of fields that have been changed by the user; we will get a <code>Product</code> from the DB, and we will merge them to get the new value of <code>Product</code></p>\n"}, {"tags": ["haskell", "haskell-snap-framework"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1477077526, "post_id": 40170698, "comment_id": 67635391, "body": "<code>put</code> takes one argument, but you give it two (the error clearly states this -  &quot;The function \u2018put\u2019 is applied to two arguments&quot; - did you read it?). You probably want <code>put (App { _test = 2 })</code>, or use lenses."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6307701"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477079778, "post_id": 40170698, "comment_id": 67636570, "body": "wow. it was that simple. Thanks a million!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6307701"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1477080443, "post_id": 40170698, "comment_id": 67636870, "body": "Yes, I read the warning, but didn&#39;t even pay attention to it. I was focusing on the first part. I promise, I am not that stupid as it appears :D"}], "owner": {"user_type": "does_not_exist", "display_name": "user6307701"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1477034676, "creation_date": 1477034676, "question_id": 40170698, "link": "https://stackoverflow.com/questions/40170698/haskell-snap-transient-per-request-state", "title": "Haskell &amp; Snap: Transient per request state", "body": "<p>How do I set per request transient-state in Snap?</p>\n\n<p>Looking at <a href=\"http://snapframework.com/docs/tutorials/snaplets-tutorial\" rel=\"nofollow\">http://snapframework.com/docs/tutorials/snaplets-tutorial</a> it says </p>\n\n<blockquote>\n  <p>Handler b v has a MonadState v instance. This means that you can access all your snaplet state through the get, put, gets, and modify functions that are probably familiar from the state monad.</p>\n</blockquote>\n\n<p>So I am trying the following:</p>\n\n<pre><code>data App = App\n    { _test :: Int\n    }\n</code></pre>\n\n<p>And then in the handler:</p>\n\n<pre><code>someHandler :: Handler App App ()\nsomeHandler = do\n    test &lt;- gets _test\n    liftIO $ print test\n    put ( 2 :: Int _test\n</code></pre>\n\n<p>However I get the error:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018()\u2019 with \u2018Handler App App a0\u2019\n  Expected type: (App -&gt; Int) -&gt; Handler App App a0\n    Actual type: (App -&gt; Int) -&gt; ()\n\u2022 The function \u2018put\u2019 is applied to two arguments,\n  its type is \u2018s0 -&gt; m0 ()\u2019,\n  it is specialized to \u2018Int -&gt; (App -&gt; Int) -&gt; ()\u2019\n  In a stmt of a 'do' block: put (2 :: Int) _test\n  In the expression:\n    do { test &lt;- gets _test;\n         liftIO $ print test;\n         put (2 :: Int) _test;\n</code></pre>\n\n<p>Any ideas how to achieve that?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "hsc2hs"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1477030985, "post_id": 40169514, "comment_id": 67607325, "body": "Does your setup work with cabal (+sandbox) ? Can you show us your cabal and stack file?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1477032496, "post_id": 40169514, "comment_id": 67608086, "body": "What version of sack, cabal, ghc do you use? And what os are you working with"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1477032558, "post_id": 40169514, "comment_id": 67608112, "body": "Possibly related <a href=\"https://github.com/commercialhaskell/stack/issues/1718\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/1718</a>"}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1477051622, "post_id": 40169514, "comment_id": 67619540, "body": "Have you seen <a href=\"http://stackoverflow.com/questions/37572628/statically-link-c-library-with-a-haskell-library/37643200#37643200\">this answer</a>? You might be able to workaround by not using hsc2hs."}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 407, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1477030216, "creation_date": 1477030216, "question_id": 40169514, "link": "https://stackoverflow.com/questions/40169514/using-stack-with-hsc2hs-for-working-with-haskell-and-c-ffi", "title": "Using stack with hsc2hs for working with Haskell and C FFI?", "body": "<p>I have a <code>file.hsc</code> in my stack project that would ordinarily need to be pre-processed via <code>hsc2hs file.hsc</code>.</p>\n\n<p>Running <code>stack build</code> instead causes the file to be read as a normal haskell file, without preprocessing.</p>\n\n<p><strong>Question:</strong> Is there a way to use stack and <code>hsc2hs</code> concurrently? Ideally, one would just run <code>stack build</code> and everyting would just \"work\".</p>\n"}, {"tags": ["haskell", "recursion", "binary"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1477003944, "post_id": 40165734, "comment_id": 67600310, "body": "I don&#39;t understand the question."}, {"owner": {"reputation": 71, "user_id": 7050429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8655b32dc31bcdfe86c7d76669dbdc?s=128&d=identicon&r=PG&f=1", "display_name": "Tepes", "link": "https://stackoverflow.com/users/7050429/tepes"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1477046350, "post_id": 40165734, "comment_id": 67616209, "body": "@melpomene I wanted to know what happend each time <code>repBinario</code> was being called, this recursion was a little bit confusing for a newbie like me. The answers below we&#39;re really useful though."}, {"owner": {"reputation": 71, "user_id": 7050429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8655b32dc31bcdfe86c7d76669dbdc?s=128&d=identicon&r=PG&f=1", "display_name": "Tepes", "link": "https://stackoverflow.com/users/7050429/tepes"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1477046787, "post_id": 40165734, "comment_id": 67616485, "body": "The answers we&#39;re very helpful, I did not choose just one because some people might not be looking for the same thing that I was, anyway, I decided to upvote each reply since all of them structured the problem in a different way and so the question resulted in diversed solutions, all equally interesting. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 6, "last_activity_date": 1477059421, "last_edit_date": 1477059421, "creation_date": 1477005029, "answer_id": 40165925, "question_id": 40165734, "link": "https://stackoverflow.com/questions/40165734/converting-decimal-to-binary-in-haskell/40165925#40165925", "title": "Converting Decimal to Binary in Haskell", "body": "<p>In short, it multiplies the accumulated result by <code>10</code> on each iteration.</p>\n\n<p>To get a clearer understanding of what's going on we can divide your function into two simpler ones. The first one will convert an integer into a list of binary digits. The other will then do exactly the thing that bothers you: concat a list of binary digits into an integer.</p>\n\n<pre><code>extractBinDigits :: Int -&gt; [Int]\nextractBinDigits =\n  unfoldr (\\x -&gt; if x == 0 then Nothing else Just (mod x 2, div x 2))\n\nconcatDigits :: [Int] -&gt; Int\nconcatDigits =\n  foldr (\\a b -&gt; a + b * 10) 0\n</code></pre>\n\n<p>As you see we simply fold the list multiplying the accumulator by <code>10</code> on each step and adding each digit to it.</p>\n\n<p>Then your original function becomes just this:</p>\n\n<pre><code>repBinario :: Int -&gt; Int\nrepBinario =\n  concatDigits . extractBinDigits\n</code></pre>\n\n<p>Division now lets us inspect and reuse the finer pieces of our program providing us with greater flexibility. E.g., by adding another simple function you can now convert the integer into a string in one go:</p>\n\n<pre><code>showDigits :: [Int] -&gt; String\nshowDigits =\n  reverse . map (chr . (+ 48))\n\nrepStringyBinario :: Int -&gt; String\nrepStringyBinario =\n  showDigits . extractBinDigits\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 5, "last_activity_date": 1477005361, "creation_date": 1477005361, "answer_id": 40165987, "question_id": 40165734, "link": "https://stackoverflow.com/questions/40165734/converting-decimal-to-binary-in-haskell/40165987#40165987", "title": "Converting Decimal to Binary in Haskell", "body": "<p>Let\u2019s go through an example, then:</p>\n\n<pre><code>repBinario 5\n</code></pre>\n\n<p>Substitute definition of <code>repBinario 5</code>:</p>\n\n<pre><code>10 * repBinario (5 `div` 2) + 5 `mod` 2\n</code></pre>\n\n<p>Reduce <code>div</code> and <code>mod</code>:</p>\n\n<pre><code>10 * repBinario 2 + 1\n                    ^\n</code></pre>\n\n<p>Here we have produced our first digit, marked with <code>^</code>.</p>\n\n<p>Substitute definition of <code>repBinario 2</code>:</p>\n\n<pre><code>10 * (10 * repBinario (2 `div` 2) + 2 `mod` 2) + 1\n                                                 ^\n</code></pre>\n\n<p>Reduce <code>div</code> and <code>mod</code>:</p>\n\n<pre><code>10 * (10 * repBinario 1 + 0) + 1\n                          ^    ^\n</code></pre>\n\n<p>Substitute definition of <code>repBinario 1</code>:</p>\n\n<pre><code>10 * (10 * (10 * repBinario (1 `div` 2) + 1 `mod` 2) + 0) + 1\n                                                       ^    ^\n</code></pre>\n\n<p>Reduce <code>div</code> and <code>mod</code>:</p>\n\n<pre><code>10 * (10 * (10 * repBinario 0 + 1) + 0) + 1\n                                ^    ^    ^\n</code></pre>\n\n<p>Substitute definition of <code>repBinario 0</code>:</p>\n\n<pre><code>10 * (10 * (10 * 0 + 1) + 0) + 1\n                     ^    ^    ^\n</code></pre>\n\n<p>Reduce:</p>\n\n<pre><code>101\n</code></pre>\n\n<p>At each step, <code>(`mod` 2)</code> gets the least significant binary digit, and <code>(`div` 2)</code> shifts the number <em>rightward</em>, discarding the digit and passing the rest of the number recursively to <code>divBinario</code>. At the end, we do the opposite process: <code>(+ d)</code> adds the current digit to the result, and <code>(* 10)</code> shifts the number <em>leftward</em> so we can add more digits.</p>\n\n<p>What you get is a decimal number that <em>looks</em> identical to the binary representation of the original input.</p>\n\n<p>If you remove the multiplication by <code>10</code>, you get <code>popCount</code>, a function that gives you the <em>population count</em> of a number\u2014the number of <code>1</code> bits in its binary representation:</p>\n\n<pre><code>popCount 0 = 0\npopCount x = popCount (x `div` 2) + x `mod` 2\n\npopCount 5  ==  2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 5, "last_activity_date": 1477005615, "creation_date": 1477005615, "answer_id": 40166016, "question_id": 40165734, "link": "https://stackoverflow.com/questions/40165734/converting-decimal-to-binary-in-haskell/40166016#40166016", "title": "Converting Decimal to Binary in Haskell", "body": "<p>I think it would be best to calculate this function for a small value by hand - this is possible since this is a pure function therefore you can replace left hand side with its definition (i.e. right hand side) - the fancy computer science word for this feature is \"referential transparency\".</p>\n\n<pre><code>repBinario 24 = 10 * repBinario (24 `div` 2) + 24 `mod` 2\n              = 10 * repBinario 12 + 0\n              = 10 * (10 * repBinario (12 `div` 2) + 12 `mod` 2)\n              = 100 * repBinario 6 + 0\n              = 100 * (10 * repBinario (6 `div` 2) + 6 `mod` 2)\n              = 1000 * repBinario 3 + 0\n              = 1000 * (10 * repBinario (3 `div` 2) + 3 `mod` 2)\n              = 10000 * repBinario 1 + 1000 * 1\n              = 10000 (10 * repBinario (1 `div` 2) + 1 `mod` 2) + 1000\n              = 10000 (10 * repBinario 0 + 1) + 1000\n              = 10000 (10 * 0 + 1) + 1000\n              = 10000 * 1 + 1000\n              = 11000\n</code></pre>\n\n<p>in those steps I just evaluated the function by its definition and used the fact that integer-addition/multiplication obey the law of distribution.</p>\n"}], "owner": {"reputation": 71, "user_id": 7050429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8655b32dc31bcdfe86c7d76669dbdc?s=128&d=identicon&r=PG&f=1", "display_name": "Tepes", "link": "https://stackoverflow.com/users/7050429/tepes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1678, "favorite_count": 0, "answer_count": 3, "score": 7, "last_activity_date": 1477059421, "creation_date": 1477003730, "question_id": 40165734, "link": "https://stackoverflow.com/questions/40165734/converting-decimal-to-binary-in-haskell", "title": "Converting Decimal to Binary in Haskell", "body": "<p>I found out this snippet of code which works, but I do not understand why it does. It converts an Int to its representation in binary.</p>\n\n<pre><code>repBinario::Int -&gt; Int\nrepBinario 0 = 0\nrepBinario x = 10 * repBinario (x `div` 2) + x `mod` 2\n</code></pre>\n\n<p>I know what <code>div</code> and <code>mod</code> do. However, how does it place each number that comes from <code>mod</code> together?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1476992537, "post_id": 40162935, "comment_id": 67595221, "body": "Also related: <a href=\"http://stackoverflow.com/q/17045941/791604\">How to compare two functions for equivalence?</a>"}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1477020406, "post_id": 40162935, "comment_id": 67604005, "body": "Short answer: no, there is not."}], "owner": {"reputation": 95, "user_id": 3551808, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/455b18d6eb28a60afea25a32dd9dcb8c?s=128&d=identicon&r=PG&f=1", "display_name": "user3551808", "link": "https://stackoverflow.com/users/3551808/user3551808"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "closed_date": 1476992581, "answer_count": 0, "score": 0, "last_activity_date": 1476991657, "creation_date": 1476991657, "question_id": 40162935, "link": "https://stackoverflow.com/questions/40162935/haskell-check-what-operator-was-used", "closed_reason": "Duplicate", "title": "Haskell check what operator was used", "body": "<p>Hello I need to make function that will do something based on entered operator.</p>\n\n<p>Is there way to check what operator was used? for example (>=) or (+)</p>\n\n<p>something like</p>\n\n<pre><code>check op | op == (+) = \"Entered + operator\"\n         | op == (==) = \"Entered == operator\"\n         | otherwise = \"Something else\"\n</code></pre>\n\n<p>so</p>\n\n<pre><code> check (+)\n</code></pre>\n\n<p>will return: Entered + operator</p>\n"}, {"tags": ["haskell", "frp", "netwire"], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 0, "last_activity_date": 1477002585, "creation_date": 1477002585, "answer_id": 40165541, "question_id": 40161442, "link": "https://stackoverflow.com/questions/40161442/is-there-a-netwire-equivalent-of-stepper/40165541#40165541", "title": "Is there a netwire equivalent of stepper?", "body": "<p>I can only guess why netwire doesn't provide that. Everything in <code>Control.Wire.Event</code> keeps the results in <code>Event</code>s preserving the knowledge of when they are happening.</p>\n\n<p>You can get out of <code>Event</code>s by using one of the methods of switching in <a href=\"https://hackage.haskell.org/package/netwire-5.0.2/docs/Control-Wire-Switch.html\" rel=\"nofollow\"><code>Control.Wire.Switch</code></a>. You're looking for <a href=\"https://hackage.haskell.org/package/netwire-5.0.2/docs/Control-Wire-Switch.html#v:rSwitch\" rel=\"nofollow\"><code>rSwitch</code></a>.</p>\n\n<pre><code>-- Beware: untested, untype-checked code\nstepper :: (Monad m) =&gt; a -&gt; Wire s e m (Event a) a\nstepper init = switcher . source\n  where\n     -- source :: Wire s e m (Event a) ((), Event (Wire s e m () a))\n     source = arr (\\e -&gt; ((), pure &lt;$&gt; e))\n     -- switcher :: Wire s e m ((), Event (Wire s e m () a)) a\n     switcher = rSwitch (pure init)\n</code></pre>\n\n<p>In the code above <code>pure</code> is used as <code>a -&gt; Wire s e m () a</code> to create trivial wires.</p>\n"}, {"tags": [], "owner": {"reputation": 5734, "user_id": 394796, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aad9f3d17d0679d81841dc6d83a03ea3?s=128&d=identicon&r=PG", "display_name": "Cameron Martin", "link": "https://stackoverflow.com/users/394796/cameron-martin"}, "is_accepted": true, "score": 2, "last_activity_date": 1477002943, "creation_date": 1477002943, "answer_id": 40165606, "question_id": 40161442, "link": "https://stackoverflow.com/questions/40161442/is-there-a-netwire-equivalent-of-stepper/40165606#40165606", "title": "Is there a netwire equivalent of stepper?", "body": "<p>The function I was looking for is called <a href=\"https://hackage.haskell.org/package/netwire-5.0.2/docs/Control-Wire-Interval.html#v:hold\" rel=\"nofollow\"><code>hold</code>, in <code>Control.Wire.Interval</code></a>.</p>\n\n<p>This does not need an initial value, because the wire inhibits until the first event is received. If this behaviour is needed, it can be implemented like so</p>\n\n<pre><code>stepper init = hold &lt;|&gt; pure init\n</code></pre>\n"}], "owner": {"reputation": 5734, "user_id": 394796, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aad9f3d17d0679d81841dc6d83a03ea3?s=128&d=identicon&r=PG", "display_name": "Cameron Martin", "link": "https://stackoverflow.com/users/394796/cameron-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 1, "accepted_answer_id": 40165606, "answer_count": 2, "score": 4, "last_activity_date": 1477002943, "creation_date": 1476986517, "last_edit_date": 1476996966, "question_id": 40161442, "link": "https://stackoverflow.com/questions/40161442/is-there-a-netwire-equivalent-of-stepper", "title": "Is there a netwire equivalent of stepper?", "body": "<p>Reactive-banana has a function named <code>stepper</code> (of type <code>MonadMoment m =&gt; a -&gt; Event a -&gt; m (Behavior a)</code>), which converts an event into a behaviour where the behaviour's value is the value of the last event, or the initial value if no event has occurred yet.</p>\n\n<p>In a talk by Conal Elliott, the name of which I cannot remember, he presents this as being one of the fundamental operations on events and behaviours. However, I cannot find a similar function in netwire. With my limited understanding of netwire, I would expect it to have type:</p>\n\n<p><code>a -&gt; Wire s e m (Event a) a</code></p>\n\n<ul>\n<li>Does netwire have an equivalent function?</li>\n<li>If not, is there any reason why this is not possible?</li>\n<li>Is anything similar possible, i.e. ways of converting events into behaviours?</li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1476982437, "post_id": 40160181, "comment_id": 67589331, "body": "What do you mean by &#39;do a square&#39;? Do you just want to write a representation to the console? How are you representing the location of the values?"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1476982536, "post_id": 40160181, "comment_id": 67589389, "body": "Its just so you would know that the &#39;map&#39; would be allways a square, so that&#39;s why i can build the map just from the dimension and the limitations i wrote before..  I need this function to calculate the &#39;v&#39; s because building the map i need to take x values from a list of Int&#39;s that latter will replace those &#39;v&#39;s..."}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1476982870, "post_id": 40160181, "comment_id": 67589569, "body": "Also, the dimension is allways &gt;= 5 and an odd number."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1476983127, "post_id": 40160181, "comment_id": 67589696, "body": "Welcome to stackoverflow! Please consider reading the <a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>. Here Stackoverflow we answer questions that are related to concrete errors/bugs/programming problems. Also tell us what you have tried to implement your &quot;map&quot; and what you have thought of doing, in short where you are stuck. Could you implement this problem in a language that is not haskell or is formulating the problem per se where you are stuck."}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1476984085, "post_id": 40160181, "comment_id": 67590193, "body": "Hi, i have to do this in haskell..  I have started this by doing: calcv :: Int -&gt; Int calcv d = (d<i>d) - (d*2) - (2*(d-6))  --d</i>d gives me full square --d*2 takes first and last lines --d-6 takes second and penultimate lines...  I really dont know how to take the middle #&#39;s... :s"}, {"owner": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1476984858, "post_id": 40160181, "comment_id": 67590662, "body": "Sounds a lot like an interview programming quiz. From Portland, OR."}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1476984962, "post_id": 40160181, "comment_id": 67590731, "body": "I&#39;m doing a school project actually man... :D"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1476989621, "post_id": 40160181, "comment_id": 67593570, "body": "I added how i did it, its giving a error but i think it should be working..."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1476998989, "post_id": 40164731, "comment_id": 67598498, "body": "Thank you, i will be doing this since it can improve the code i have for now, i was able to make the calcv function by dividing it into 4 functions, one for second and penultime lines, one for third and antepenultime lines and one for odd lines and other for even lines, it works for all dimensions i can have(tested it over 1000 so i&#39;m sure its ok). But the map can improve a lot with your sugestions, thanks a lot man"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1477016897, "post_id": 40164731, "comment_id": 67603202, "body": "I just finished this code of you and its great, the map is well done and the calcV works perfectly..."}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1477016971, "post_id": 40164731, "comment_id": 67603218, "body": "The code is now smaller then what i had, and has a best presentation, thanks a lot man, but i have some doubts, i don&#39;t really understand the countV function, can you explain more or less what is happening in this function?"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1477017125, "post_id": 40164731, "comment_id": 67603248, "body": "Oh, and it had an error, in the function cellAt i had to add one new Int, the n so the comparasion was possible.. So i added an Int in that function and on the makeMap function i changed one line: | otherwise = [[cellAt n row col | col &lt;- [1 .. n]] | row &lt;- [1 .. n]] Just added the n so i could make the map using the n has a value.."}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1477017256, "post_id": 40164731, "comment_id": 67603282, "body": "Also change to this:  calcV :: Int -&gt; Int calcV n = contV (makeMap n) where     contV grelha = sum [sum [1 | &#39;v&#39; &lt;- row] | row &lt;- grelha]  Even less code lines, i think its better this way right?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1477021089, "post_id": 40164731, "comment_id": 67604162, "body": "@Dost: The <i>inner</i> list comprehension, <code>sum [1 | &#39;v&#39; &lt;- row]</code> returns the number of cells in <code>row</code> that are equal to <code>&#39;v&#39;</code>, equivalent to <code>length (filter (== &#39;v&#39;) row)</code>. The <i>outer</i> list comprehension, <code>sum [... | row &lt;- rows]</code> makes a list of the sum for each row, then takes <i>their</i> sum to return the total."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1477021858, "post_id": 40164731, "comment_id": 67604362, "body": "@Dost: As for your other questions: if <code>cellAt</code> is defined in the <code>where</code> clause of <code>makeMap</code>, it can see <code>n</code> in scope. Putting <code>contV</code> in the <code>where</code> clause of <code>calcV</code> makes sense, too. You can also write <code>calcV = contV . makeMap</code> using the composition operator <code>.</code>, which is very common."}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 1, "creation_date": 1477065937, "post_id": 40164731, "comment_id": 67629428, "body": "thanks a lot man, i already had the contV inside calcV, now i just placed the cellAt in the where clause of makeMap, now i do what i want with 2 very easy to understand functions, its very good, small and easy to read. Thank you for helping me not just do but to understand what i&#39;m doing! ;)"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 0, "last_activity_date": 1476998288, "creation_date": 1476998288, "answer_id": 40164731, "question_id": 40160181, "link": "https://stackoverflow.com/questions/40160181/haskell-building-a-square-map-with-s-in-especific-cells-and-calculate-empty/40164731#40164731", "title": "Haskell building a &#39;square&#39; map with &#39;#&#39;s in especific cells and calculate empty cells", "body": "<p>When faced with a problem like this, try to break it down into smaller pieces, and see how to express it with Haskell\u2019s existing tools (like list comprehensions, <code>map</code>, <code>filter</code>, and <code>foldr</code>) before writing a recursive function.</p>\n\n<p>First, you want to generate a square list of lists of length <code>n</code>, where every cell is some function of the row and column indices:</p>\n\n<pre><code>makeMap :: Int -&gt; [[Char]]\nmakeMap n\n  | even n || n &lt; 5\n  = error \"makeMap: invalid size\"\n\n  | otherwise = [[cellAt row col | col &lt;- [1 .. n]] | row &lt;- [1 .. n]]\n</code></pre>\n\n<p>You could also define this with type <code>Int -&gt; [Char]</code> if you don\u2019t care about separating the rows, or if you want a single index into the whole map. You can also define it in terms of <code>map</code> rather than list comprehensions. I\u2019ll leave those as exercises.</p>\n\n<p>Now you can define the cell at a particular position by providing an implementation of <code>cellAt</code>:</p>\n\n<pre><code>  where\n    cellAt :: Int -&gt; Int -&gt; Char\n</code></pre>\n\n<p>I won\u2019t enumerate all the cases, since this is a homework problem, but here are a couple to get you started:</p>\n\n<pre><code>    -- Produce a border whenever row=1, col=1, row=n, or col=n.\n    cellAt 1 _ = '#'\n    cellAt _ 1 = '#'\n    cellAt row col\n      | row == n || col == n\n      = '#'\n\n    -- Handle other cases here.\n      | ...\n</code></pre>\n\n<p>Then it looks like you want to count the number of <code>v</code> cells, which you can do by iterating over the map:</p>\n\n<pre><code>countV :: [[Char]] -&gt; Int\ncountV rows = sum [sum [1 | 'v' &lt;- row] | row &lt;- rows]\n\ncalcV :: Int -&gt; Int\ncalcV n = countV (makeMap n)\n</code></pre>\n\n<p>If your instructor wants a single function, a good exercise would be to manually inline the definitions of <code>countV</code> and <code>makeMap</code> into <code>calcV</code>. But it\u2019s generally easier to write small, simple functions that you can compose to solve larger problems.</p>\n"}], "owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1477039502, "creation_date": 1476982306, "last_edit_date": 1477039502, "question_id": 40160181, "link": "https://stackoverflow.com/questions/40160181/haskell-building-a-square-map-with-s-in-especific-cells-and-calculate-empty", "title": "Haskell building a &#39;square&#39; map with &#39;#&#39;s in especific cells and calculate empty cells", "body": "<p>I'm doing a game for a class, and in one task I need to do a square (it's the 'map') that all I know is the dimension (size of each side) and then I want to calculate the cells I need to replace with a 'value'.</p>\n\n<p>For example, a square with dimension 9 will look like this:</p>\n\n<pre><code> # # # # # # # # #\n\n # _ _ v v v _ _ #\n\n # _ # V # v # _ #\n\n # v v v v v v v #\n\n # v # v # v # v #\n\n # v v v v v v v #\n\n # _ # v # v # _ #\n\n # _ _ v v v _ _ #\n\n # # # # # # # # #\n</code></pre>\n\n<ul>\n<li>First and last lines allways full with <code>#</code> (walls)</li>\n<li>Second line and penultimate lines: allways begins with <code>#</code> and two empty spaces <code>_</code>.</li>\n<li>Third and antepenultimate lines: empty space in 2nd and before the last column, and <code>#</code> at every 2nd column.</li>\n<li>Then I have always one line without <code>#</code> in middle, and one with those <code>#</code> in every 2 spaces.</li>\n</ul>\n\n<p>So, I need to build a function that calculate the <code>v</code>s. I have on that map, just receiving the <code>Dimension :: Int</code> (in this case was 9 and the function <code>calcV</code> (example of name to the function) would return 28).. </p>\n\n<p>Below is my code that I tried. The square always has odd dimensions and equal or higher then 5, so I did the 5 case, and then a function that I expected would calculate what I want to all other possible values.<br>\nBut it gives me: </p>\n\n<blockquote>\n  <p>Exception: stack overflow in ghci</p>\n</blockquote>\n\n<p>Does anyone know what I did wrong in this code?</p>\n\n<pre><code>calcv :: Int -&gt; Int -&gt; Int -&gt; Int\n\ncalcv 5 _ _ = 0\n\ncalcv d l c    -- the l and c will be given has 1(first line/first column) (d will be the dimension)\n\n        | (l==1) = 0 + calcv d (l+1) 1\n        | (l==(d-1)) || (l==2) &amp;&amp; (c==1) || (c==2) || (c==3) || (c==(d-2)) || (c==(d-1)) = 0 + calcv d l (c+1)\n        | (l==(d-1)) || (l==2) &amp;&amp; (c&gt;3) &amp;&amp; (c&lt;(d-2)) = if even c then 1 + calcv d l (c+1) else calcv d l (c+1) \n        | (l==(d-1)) || (l==2) &amp;&amp; (c==d) = calcv d (l+1) 1\n        | (l==3) || (l==(d-2)) &amp;&amp; (c==1) || (c==2) || (c==3) || (c==(d-2)) || (c==(d-1)) = calcv d l (c+1)\n        | (l==3) || (l==(d-2)) &amp;&amp; (c&gt;3) &amp;&amp; (c&lt;(d-2)) = if even c then 1 + calcv d l (c+1) else calcv d l (c+1)\n        | (l==3) || (l==(d-2)) &amp;&amp; (c==d) = calcv d (l+1) 1\n        | (l==d) = 0\n</code></pre>\n"}, {"tags": ["haskell", "compression", "gzip"], "comments": [{"owner": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "edited": false, "score": 1, "creation_date": 1476962403, "post_id": 40152675, "comment_id": 67574674, "body": "The pipes package may be what you need. You can create streams of data from Producers to Consumer, and transform the data in between (with Pipes). I do not know the package enough to write an answer about it, though."}, {"owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "reply_to_user": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "edited": false, "score": 2, "creation_date": 1476963452, "post_id": 40152675, "comment_id": 67575485, "body": "The Pipes/Conduit <i>could</i> be a solution. It may have extra complexity related to &quot;forking&quot; though: assume that one &quot;generator&quot; wants to write into 5 different files (different data, different rate), therefore there is 1 producer and 5 consumers... Not sure if it will model it nice.  Also looks a bit overkill for such a simple (as it seems) requirement?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1476964000, "post_id": 40152675, "comment_id": 67575927, "body": "What opens the handle you are writing to? <i>That</i> is where you want to insert the &quot;pipe&quot; through your compressor, just like in your Java example."}, {"owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1476964827, "post_id": 40152675, "comment_id": 67576523, "body": "@chepner I do control opening the handle. And that would be ideal if I could &quot;pipe&quot; it through the compressor, but can you point me at <i>how</i> it can be done?"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1476965095, "post_id": 40152675, "comment_id": 67576718, "body": "All of the streaming libraries support familiar forms of compression, see e.g. <a href=\"https://hackage.haskell.org/package/io-streams-1.3.5.0/docs/System-IO-Streams-Zlib.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/io-streams-1.3.5.0/docs/&hellip;</a> since it is somewhat java-inspired. But I guess you understand this. It is impossible to give advice because you don&#39;t say enough about the way &#39;many files&#39; is coming into the picture."}, {"owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1476966620, "post_id": 40152675, "comment_id": 67577716, "body": "@Michael &quot;many files&quot; is simply a decision that is made by the program. When the computation is running it sometimes can make a decision to write into one of the file handles based on its own internal logic. Say, you anallyze bunch of sources and run a prediction writing your steps and results related to &quot;Trump&quot; and &quot;Clinton&quot; to different files in different formats: <code>trump.xml</code>, <code>trump.json</code>, <code>clinton.xml</code> and <code>clinton.json</code>. Something like that. Now you want these files to be compressed."}, {"owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1476966957, "post_id": 40152675, "comment_id": 67577951, "body": "@Michael No, not really. It is much simpler: the computation is provided with a number of &quot;sinks&quot; (file handles): and it &quot;knows&quot; when it needs to write to one sink or another while running."}], "answers": [{"comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 2, "creation_date": 1476968382, "post_id": 40154951, "comment_id": 67578954, "body": "I didn&#39;t see the comments before, I was just answering the original question. If that&#39;s really what the questioner is looking for, it would involve something like <code>ZipSink</code> in conduit, <i>or</i> this other approach that I&#39;m writing up right now as a proof of concept."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 3, "creation_date": 1476968972, "post_id": 40154951, "comment_id": 67579364, "body": "Also, generally speaking, even if something is &quot;simple,&quot; a working example is usually much easier to grok for someone new to the library."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 4, "last_activity_date": 1476973692, "last_edit_date": 1476973692, "creation_date": 1476967700, "answer_id": 40154951, "question_id": 40152675, "link": "https://stackoverflow.com/questions/40152675/how-to-compress-the-output-when-writing-to-a-file/40154951#40154951", "title": "How to compress the output when writing to a file?", "body": "<p>Doing this with conduit is fairly straightforward, though you'd need to adjust your code a bit. I've put together an example of before and after code to demonstrate it. The basic idea is:</p>\n\n<ul>\n<li>Replace <code>hPutStr h</code> with <code>yield</code></li>\n<li>Add some <code>liftIO</code> wrappers</li>\n<li>Instead of using <code>withBinaryFile</code> or the like, use <code>runConduitRes</code>, <code>gzip</code>, and <code>sinkFile</code></li>\n</ul>\n\n<p>Here's the example:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-6.21 --install-ghc runghc --package conduit-extra\n{-# LANGUAGE OverloadedStrings #-}\nimport Control.Monad.IO.Class (MonadIO, liftIO)\nimport Data.ByteString (ByteString, hPutStr)\nimport Data.Conduit (ConduitM, (.|), yield, runConduitRes)\nimport Data.Conduit.Binary (sinkFile)\nimport Data.Conduit.Zlib (gzip)\nimport System.IO (Handle)\n\n-- Some helper function you may have\nsomeAction :: IO ByteString\nsomeAction = return \"This is a string\\n\"\n\n-- Original version\nproducerHandle :: Handle -&gt; IO ()\nproducerHandle h = do\n    str &lt;- someAction\n    hPutStr h str\n\n-- Conduit version\nproducerConduit :: MonadIO m =&gt; ConduitM i ByteString m ()\nproducerConduit = do\n    str &lt;- liftIO someAction\n    yield str\n\nmain :: IO ()\nmain = runConduitRes $ producerConduit\n                    .| gzip\n                    .| sinkFile \"some-file.txt.gz\"\n</code></pre>\n\n<p>You can learn more about conduit in <a href=\"https://haskell-lang.org/library/conduit\" rel=\"nofollow\">the conduit tutorial</a>.</p>\n\n<p>Your Java idea is interesting, give me a few more minutes, I'll add an answer that looks more like that.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Here's a version that's closer to your Java style approach. It relies on a <code>SinkFunc.hs</code> module which is available as a Gist at: <a href=\"https://gist.github.com/snoyberg/283154123d30ff9e201ea4436a5dd22d\" rel=\"nofollow\">https://gist.github.com/snoyberg/283154123d30ff9e201ea4436a5dd22d</a></p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-6.21 --install-ghc runghc --package conduit-extra\n{-# LANGUAGE OverloadedStrings #-}\n{-# OPTIONS_GHC -Wall -Werror #-}\nimport Data.ByteString (ByteString)\nimport Data.Conduit ((.|))\nimport Data.Conduit.Binary (sinkHandle)\nimport Data.Conduit.Zlib (gzip)\nimport System.IO (withBinaryFile, IOMode (WriteMode))\nimport SinkFunc (withSinkFunc)\n\n-- Some helper function you may have\nsomeAction :: IO ByteString\nsomeAction = return \"This is a string\\n\"\n\nproducerFunc :: (ByteString -&gt; IO ()) -&gt; IO ()\nproducerFunc write = do\n    str &lt;- someAction\n    write str\n\nmain :: IO ()\nmain = withBinaryFile \"some-file.txt.gz\" WriteMode $ \\h -&gt; do\n    let sink = gzip .| sinkHandle h\n    withSinkFunc sink $ \\write -&gt; producerFunc write\n</code></pre>\n\n<p><strong>EDIT 2</strong> One more for good measure, actually using <code>ZipSink</code> to stream the data to multiple different files. There are <em>lots</em> of different ways of slicing this, but this is one way that works:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-6.21 --install-ghc runghc --package conduit-extra\n{-# LANGUAGE OverloadedStrings #-}\nimport Control.Monad.Trans.Resource (MonadResource)\nimport Data.ByteString (ByteString)\nimport Data.Conduit (ConduitM, (.|), yield, runConduitRes, ZipSink (..))\nimport Data.Conduit.Binary (sinkFile)\nimport qualified Data.Conduit.List as CL\nimport Data.Conduit.Zlib (gzip)\n\ndata Output = Foo ByteString | Bar ByteString\n\nfromFoo :: Output -&gt; Maybe ByteString\nfromFoo (Foo bs) = Just bs\nfromFoo _ = Nothing\n\nfromBar :: Output -&gt; Maybe ByteString\nfromBar (Bar bs) = Just bs\nfromBar _ = Nothing\n\nproducer :: Monad m =&gt; ConduitM i Output m ()\nproducer = do\n    yield $ Foo \"This is going to Foo\"\n    yield $ Bar \"This is going to Bar\"\n\nsinkHelper :: MonadResource m\n           =&gt; FilePath\n           -&gt; (Output -&gt; Maybe ByteString)\n           -&gt; ConduitM Output o m ()\nsinkHelper fp f\n    = CL.mapMaybe f\n   .| gzip\n   .| sinkFile fp\n\nmain :: IO ()\nmain = runConduitRes\n     $ producer\n    .| getZipSink\n            (ZipSink (sinkHelper \"foo.txt.gz\" fromFoo) *&gt;\n             ZipSink (sinkHelper \"bar.txt.gz\" fromBar))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": false, "score": 3, "last_activity_date": 1476972487, "creation_date": 1476972487, "answer_id": 40156821, "question_id": 40152675, "link": "https://stackoverflow.com/questions/40152675/how-to-compress-the-output-when-writing-to-a-file/40156821#40156821", "title": "How to compress the output when writing to a file?", "body": "<p>For incremental compression, I think you could make use of <code>compressIO</code>/<code>foldCompressStream</code> in <code>Codec.Compression.Zlib.Internal</code>.</p>\n\n<p>If you're able to represent your producer action as an <code>IO (Maybe a)</code> (such as an <code>MVar</code> take or <code>InputStream</code>/<code>Chan</code> read) where  <code>Nothing</code> signifies end of input, something like this should work:</p>\n\n<pre><code>import System.IO (Handle)\nimport qualified Data.ByteString as BS\nimport qualified Codec.Compression.Zlib.Internal as ZLib\n\ncompressedWriter :: Handle -&gt; (IO (Maybe BS.ByteString)) -&gt; IO ()\ncompressedWriter handle source =\n  ZLib.foldCompressStream\n    (\\next -&gt; source &gt;&gt;= maybe (next BS.empty) next)\n    (\\chunk next -&gt; BS.hPut handle chunk &gt;&gt; next)\n    (return ())\n    (ZLib.compressIO ZLib.rawFormat ZLib.defaultCompressParams)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": false, "score": 5, "last_activity_date": 1477058134, "last_edit_date": 1477058134, "creation_date": 1476974823, "answer_id": 40157701, "question_id": 40152675, "link": "https://stackoverflow.com/questions/40152675/how-to-compress-the-output-when-writing-to-a-file/40157701#40157701", "title": "How to compress the output when writing to a file?", "body": "<p>All the streaming libraries support compression. If I understand the particular problem and the way you are thinking about it, <code>io-streams</code> might be the simplest for your purposes. Here I alternate between writing to <code>trump</code> and <code>clinton</code> output streams, which are written as compressed files. I follow by showing the <code>pipes</code> equivalent of Michael's <code>conduit</code> program</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-6.21 --install-ghc runghc --package io-streams\n{-# LANGUAGE OverloadedStrings #-}\n\nimport qualified System.IO.Streams as IOS\nimport qualified System.IO as IO\nimport Data.ByteString (ByteString)\n\nanalyzer :: IOS.OutputStream ByteString -&gt; IOS.OutputStream ByteString -&gt; IO ()\nanalyzer clinton trump = do \n  IOS.write (Just \"This is a string\\n\") clinton\n  IOS.write (Just \"This is a string\\n\") trump\n  IOS.write (Just \"Clinton string\\n\") clinton\n  IOS.write (Just \"Trump string\\n\") trump   \n  IOS.write (Just \"Another Clinton string\\n\") clinton\n  IOS.write (Just \"Another Trump string\\n\") trump   \n  IOS.write Nothing clinton\n  IOS.write Nothing trump\n\nmain:: IO ()\nmain = \n  IOS.withFileAsOutput \"some-file-clinton.txt.gz\" $ \\clinton_compressed -&gt;\n  IOS.withFileAsOutput \"some-file-trump.txt.gz\" $ \\trump_compressed -&gt; do\n     clinton &lt;- IOS.gzip IOS.defaultCompressionLevel clinton_compressed\n     trump &lt;- IOS.gzip IOS.defaultCompressionLevel trump_compressed\n     analyzer clinton trump\n</code></pre>\n\n<p>Obviously you can mix all kinds of <code>IO</code> in <code>analyzer</code> between acts of writing to the two output streams - I'm just show in the <code>write</code>s, so to speak. In particular, if <code>analyzer</code> is understood as depending on an input stream, the <code>write</code>s can depend on <code>read</code>s from the input stream. <a href=\"http://sprunge.us/ajHR\" rel=\"nofollow\">Here's</a> a (slightly!) more complicated program that does that.  If I run the program above I see</p>\n\n<pre><code>$ stack gzip_so.hs  \n$ gunzip some-file-clinton.txt.gz \n$ gunzip some-file-trump.txt.gz \n$ cat some-file-clinton.txt \nThis is a string\nClinton string\nAnother Clinton string\n$ cat some-file-trump.txt \nThis is a string\nTrump string\nAnother Trump string\n</code></pre>\n\n<p>With pipes and conduit there are various ways of achieving the above effect, with a higher level of decomposition of parts. Writing to separate files will however be a little more subtle. Here in any case is the pipes equivalent of Michael S's conduit program:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-6.21 --install-ghc runghc  --package pipes-zlib \n{-# LANGUAGE OverloadedStrings #-}\nimport Control.Monad.IO.Class (MonadIO, liftIO)\nimport Data.ByteString (ByteString, hPutStr)\nimport System.IO  (IOMode(..), withFile, Handle)\nimport Pipes  \nimport qualified Pipes.ByteString as PB\nimport qualified Pipes.GZip as P\n\n-- Some helper function you may have\nsomeAction :: IO ByteString\nsomeAction = return \"This is a string\\n\"\n\n-- Original version\nproducerHandle :: Handle -&gt; IO ()\nproducerHandle h = do\n    str &lt;- someAction\n    hPutStr h str\n\nproducerPipe :: MonadIO m =&gt; Producer ByteString m ()\nproducerPipe = do\n    str &lt;- liftIO someAction\n    yield str\n\nmain :: IO ()\nmain =  withFile \"some-file-pipes.txt.gz\"  WriteMode $ \\h -&gt; \n     runEffect $ P.compress P.defaultCompression producerPipe  &gt;-&gt; PB.toHandle h \n</code></pre>\n\n<p>-- Edit</p>\n\n<p>Here for what it's worth is yet another way of superimposing several producers on a single thread with pipes or conduit, to add to the different approaches Michael S and <code>danidiaz</code> mentioned: </p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-6.21 --install-ghc runghc --package pipes-zlib\n{-# LANGUAGE OverloadedStrings #-}\nimport Pipes\nimport Pipes.GZip\nimport qualified Pipes.Prelude as P\nimport qualified Pipes.ByteString as Bytes\nimport System.IO\nimport Control.Monad (replicateM_)\n\nproducer = replicateM_ 50000 $ do\n    marie  \"This is going to Marie\\n\"  -- arbitary IO can be interspersed here\n    arthur \"This is going to Arthur\\n\" -- with liftIO\n    sylvia \"This is going to Sylvia\\n\" \n  where \n    marie = yield; arthur = lift . yield; sylvia = lift . lift . yield\n\nsinkHelper h p = runEffect (compress bestSpeed p &gt;-&gt; Bytes.toHandle h)\n\nmain :: IO ()\nmain =  \n   withFile \"marie.txt.gz\" WriteMode $ \\marie -&gt;\n   withFile \"arthur.txt.gz\"  WriteMode $ \\arthur -&gt; \n   withFile \"sylvia.txt.gz\"  WriteMode $ \\sylvia -&gt;\n      sinkHelper sylvia\n      $ sinkHelper arthur\n      $ sinkHelper marie\n      $ producer\n</code></pre>\n\n<p>It is quite simple and fast, and can be written in conduit with the obvious alterations - but finding it natural involves a higher level of buy-in with the 'monad transformer stack' point of view. It would be the most natural way of writing such a program from the point of view of something like the <a href=\"https://hackage.haskell.org/package/streaming\" rel=\"nofollow\"><code>streaming</code></a> library.</p>\n"}, {"comments": [{"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 1, "creation_date": 1477159641, "post_id": 40170028, "comment_id": 67656619, "body": "I added a <code>Streaming.Zip</code> with a <code>gzip</code>  <a href=\"https://github.com/michaelt/streaming-utils/blob/master/Streaming/Zip.hs#L185\" rel=\"nofollow noreferrer\">github.com/michaelt/streaming-utils/blob/master/Streaming/&hellip;</a>"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1477163504, "post_id": 40170028, "comment_id": 67657842, "body": "@Michael That&#39;s great, thanks. I wasn&#39;t aware of the existence of &quot;streaming-utils&quot;."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1477034331, "last_edit_date": 1477034331, "creation_date": 1477032366, "answer_id": 40170028, "question_id": 40152675, "link": "https://stackoverflow.com/questions/40152675/how-to-compress-the-output-when-writing-to-a-file/40170028#40170028", "title": "How to compress the output when writing to a file?", "body": "<p>This solution is similar to Michael Snoyman's <strong>EDIT 2</strong>, but uses the <a href=\"http://hackage.haskell.org/package/foldl\" rel=\"nofollow\"><em>foldl</em></a>, <em>pipes</em>, <a href=\"http://hackage.haskell.org/package/pipes-zlib\" rel=\"nofollow\"><em>pipes-zlib</em></a> and <a href=\"http://hackage.haskell.org/package/streaming-eversion\" rel=\"nofollow\"><em>streaming-eversion</em></a> packages.</p>\n\n<pre><code> {-# language OverloadedStrings #-}\nmodule Main where\n\n-- cabal install bytestring foldl pipes pipes-zlib streaming-eversion\nimport Data.Foldable\nimport Data.ByteString\nimport qualified Control.Foldl as L \nimport Pipes \nimport qualified Pipes.Prelude\nimport Pipes.Zlib (compress,defaultCompression,defaultWindowBits)\nimport Streaming.Eversion.Pipes (transvertMIO)\nimport System.IO\n\ntype Tag = String\n\nproducer :: Monad m =&gt; Producer (Tag,ByteString) m ()\nproducer = do\n    yield $ (\"foo\",\"This is going to Foo\")\n    yield $ (\"bar\",\"This is going to Bar\")\n\nfoldForTag :: Handle -&gt; Tag -&gt; L.FoldM IO (Tag,ByteString) ()\nfoldForTag handle tag = \n      L.premapM (\\(tag',bytes) -&gt; if tag' == tag then Just bytes else Nothing)\n    . L.handlesM L.folded\n    . transvertMIO (compress defaultCompression defaultWindowBits)\n    $ L.mapM_ (Data.ByteString.hPut handle)\n\nmain :: IO ()\nmain = do\n    withFile \"foo.txt\" WriteMode $ \\h1 -&gt;\n        withFile \"bar.txt\" WriteMode $ \\h2 -&gt;\n            let multifold = traverse_ (uncurry foldForTag) [(h1,\"foo\"),(h2,\"bar\")] \n            in  L.impurely Pipes.Prelude.foldM multifold producer\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1477061404, "creation_date": 1477061404, "answer_id": 40179708, "question_id": 40152675, "link": "https://stackoverflow.com/questions/40152675/how-to-compress-the-output-when-writing-to-a-file/40179708#40179708", "title": "How to compress the output when writing to a file?", "body": "<p>This solution is similar to Michael Snoyman's <strong>EDIT 2</strong>, but uses the <a href=\"http://hackage.haskell.org/package/streaming\" rel=\"nofollow\">streaming</a>, <a href=\"http://hackage.haskell.org/package/streaming-bytestring\" rel=\"nofollow\">streaming-bytestring</a>, pipes and <a href=\"http://hackage.haskell.org/package/pipes-zlib\" rel=\"nofollow\">pipes-zlib</a> packages.</p>\n\n<pre><code>{-# language OverloadedStrings #-}\nmodule Main where\n\n-- cabal install bytestring streaming streaming-bytestring pipes pipes-zlib \nimport Data.ByteString\nimport qualified Data.ByteString.Streaming as B\nimport Streaming\nimport qualified Streaming.Prelude as S\nimport Pipes (next)\nimport qualified Pipes.Prelude \nimport Pipes.Zlib (compress,defaultCompression,defaultWindowBits)\nimport System.IO\n\ntype Tag = String\n\nproducer :: Monad m =&gt; Stream (Of (Tag,ByteString)) m ()\nproducer = do\n    S.yield (\"foo\",\"This is going to Foo\")\n    S.yield (\"bar\",\"This is going to Bar\")\n\n-- I couldn't find a streaming-zlib on Hackage, took a pipes detour\ncompress' :: MonadIO m \n          =&gt; Stream (Of ByteString) m r -&gt; Stream (Of ByteString) m r \ncompress' = S.unfoldr Pipes.next\n          . compress defaultCompression defaultWindowBits\n          . Pipes.Prelude.unfoldr S.next     \n\nkeepTag :: Monad m \n        =&gt; Tag -&gt; Stream (Of (Tag,ByteString)) m r -&gt; Stream (Of ByteString) m r \nkeepTag tag = S.map snd . S.filter ((tag==) . fst)\n\nmain :: IO ()\nmain = runResourceT \n     . B.writeFile \"foo.txt\" . B.fromChunks . compress' .  keepTag \"foo\"  \n     . B.writeFile \"bar.txt\"  . B.fromChunks . compress' . keepTag \"bar\"  \n     $ S.copy producer\n</code></pre>\n\n<p>I make use of the <a href=\"http://hackage.haskell.org/package/streaming-0.1.4.3/docs/Streaming-Prelude.html#v:copy\" rel=\"nofollow\">copy</a> function from <a href=\"http://hackage.haskell.org/package/streaming-0.1.4.3/docs/Streaming-Prelude.html\" rel=\"nofollow\">Streaming.Prelude</a>, that allows you to</p>\n\n<blockquote>\n  <p>Duplicate the content of stream, so that it can be acted on twice in\n  different ways, but without breaking streaming.</p>\n</blockquote>\n"}], "owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 4, "accepted_answer_id": 40154951, "answer_count": 5, "score": 6, "last_activity_date": 1477061404, "creation_date": 1476961578, "last_edit_date": 1476966157, "question_id": 40152675, "link": "https://stackoverflow.com/questions/40152675/how-to-compress-the-output-when-writing-to-a-file", "title": "How to compress the output when writing to a file?", "body": "<p>I have a computation that along with other things generates some data (a lot of it) and I want to write into a file.</p>\n\n<p>The way the code is structured now is (simplified):</p>\n\n<pre><code>writeRecord :: Handle -&gt; Record -&gt; IO ()\nwriteRecord h r = hPutStrLn h (toByteString r)\n</code></pre>\n\n<p>This function is then called periodically during a bigger computation. It is almost like a log, and in fact, multiple files are being written simultaneously. </p>\n\n<p>Now I want the output file to be compressed with <code>Gzip</code>.\nIn languages like Java I would do something like:</p>\n\n<pre><code>outStream = new GzipOutputStream(new FileOutputStream(path)) \n</code></pre>\n\n<p>and then would just write into that wrapped output stream.</p>\n\n<p>What is the way of doing it in Haskell?\nI think writing something like </p>\n\n<pre><code>writeRecord h r = hPut h ((compressed . toByteString) r)\n</code></pre>\n\n<p>is not correct because compressing each small bit individually isn't efficient (I even tried it and the size of the compressed file is bigger than uncompressed this way).</p>\n\n<p>I also don't think that I can just produce a lazy <code>ByteString</code> (or even a list of chunks) and then write it with <code>compressed . fromChunks</code> because this will require my \"generator\" building the full thing in memory. And the fact that more than one file is produced at the same time makes it even more complicated.</p>\n\n<p>So what would be a way to solve this in Haskell? Writing to file(s) and have them gzipped?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1476951904, "post_id": 40147128, "comment_id": 67567437, "body": "I think the latter is more readable. I also make <i>many</i> functions in imperative languages, if it&#39;ll result in immediately understandable and well-named functions. However, this question is too opinion-based to result in good answers."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1476957455, "post_id": 40147128, "comment_id": 67571378, "body": "I use the latter if I can assign meaningful names to the <code>result_i</code> variables. Otherwise I tend to use the first form, possibly on multiple lines, and often using <code>.</code> instead of <code>$</code> for all but the last one."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1476963804, "post_id": 40147128, "comment_id": 67575754, "body": "Just a semantic note: Haskell doesn&#39;t have statements that can occur in the body of a function, only expressions."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1476960790, "creation_date": 1476960790, "answer_id": 40152393, "question_id": 40147128, "link": "https://stackoverflow.com/questions/40147128/formatting-statements-within-functions-rules/40152393#40152393", "title": "Formatting statements within functions - rules?", "body": "<p>First off, these aren't actually equivalent. <code>f $ x $ y</code> is parsed as <code>f $ (x $ y)</code> (because <code>infixr 0 $</code>), hence you'd actually need to write the first version as</p>\n\n<pre><code>myFunction v1 v2 = (statement_1.. $ statement_2...) $ statement_3...\n</code></pre>\n\n<p>or, if <code>statement_1</code> is actually just a single symbol, I'd actually prefer</p>\n\n<pre><code>myFunction v1 v2 = statement_1 (statement_2...) (statement_3...)\n</code></pre>\n\n<p>Really, your question is whether it makes sense to give these intermediate results names of their own. Well, that's a question that has little to do with Haskell \u2013 it can apply to most programming languages, though few give you the possibility to write as much in a single expression as Haskell does. It can only be answered as: give them names if it makes the code easier to understand. Perhaps it's hard to see what <code>statement_2 ...</code> is supposed to be good for, but a \u201csingle-word comment\u201d would clear it up? Well, then give it a name! If instead it's just a short expression and it's clear what it means anyway, I wouldn't bother.</p>\n\n<p>Note that in some cases, it may affect performance (even complexity) whether or not you define something as a named entity. For example, if <code>result_1</code> is a lengthy computation that does not depend on <code>v2</code>, it makes sense to write it this way:</p>\n\n<pre><code>myFunction v1 = \\v2 -&gt; statement_1 result_1 $ statement_3..\n where result_1 = statement_2\n</code></pre>\n\n<p>This allows you to apply the function partially, to only the <code>v1</code> argument, and thus share a lot of the computational effort for multiple calls over <code>v2</code>, e.g. with <code>map (myFunction v1\u2080) listOfV2s</code>.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "closed_date": 1476991002, "accepted_answer_id": 40152393, "answer_count": 1, "score": 3, "last_activity_date": 1476960790, "creation_date": 1476945543, "last_edit_date": 1476946528, "question_id": 40147128, "link": "https://stackoverflow.com/questions/40147128/formatting-statements-within-functions-rules", "closed_reason": "Opinion-based", "title": "Formatting statements within functions - rules?", "body": "<p>Consider:</p>\n\n<pre><code>myFunction :: (Eq a) =&gt; a -&gt; a -&gt; [a]\nmyFunction v1 v2 = statement_1.. $ statement_2... $ statement_3...\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>myFunction :: (Eq a) =&gt; a -&gt; a -&gt; [a]\nmyFunction v1 v2 = statement_1 result_1 result_2\n    where\n      result_2 = statement_2\n      result_3 = statement_3\n</code></pre>\n\n<p>Is there a rule of thumb as to which format is preferred in Haskell? Are there any specific rules as to when to use each version? </p>\n"}, {"tags": ["haskell", "math", "data-structures", "computer-science", "infinite-recursion"], "comments": [{"owner": {"reputation": 15429, "user_id": 308668, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1760ce981f53c8ccc1ef62493d3805cc?s=128&d=identicon&r=PG&f=1", "display_name": "mike3996", "link": "https://stackoverflow.com/users/308668/mike3996"}, "edited": false, "score": 1, "creation_date": 1476937420, "post_id": 40145318, "comment_id": 67560392, "body": "Good question, I like! But maybe it belongs to cstheory or cs.se."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 4, "creation_date": 1476937717, "post_id": 40145318, "comment_id": 67560474, "body": "bottom vs. true in this context are equally valid answers for slightly different questions. Both are mathematically correct for the question they answer."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1476942772, "post_id": 40145318, "comment_id": 67562209, "body": "What does &quot;mathematically correct&quot; mean? By the time you have answered that question carefully, you will have answered your own as well."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1476944266, "post_id": 40145318, "comment_id": 67562936, "body": "The <code>all</code> function doesn&#39;t prove statements like \u2200 <i>x</i> \u2208 <i>X</i> . P( <i>x</i> ) for infinite sets <i>X</i>. It is impossible to produce such a proof mechanically. For finite sets it&#39;s trivial, just check whether P holds for each element of <i>X</i>. That&#39;s what <code>all</code> does."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 4, "creation_date": 1476947810, "post_id": 40145318, "comment_id": 67564923, "body": "The proper way to think about this is that the list type does not properly represent cyclic lists, in a way that one can observe the cycle. If you define a datatype which allows one to observe a cycle, then you will not find it too difficult to write an <code>all</code> which checks infinite cyclic lists in finite time. In certain languages with different semantics than Haskell, such a datatype may be simple to define, e.g. due to pointer equality - perhaps this is what causes your intuition to fail here."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 15429, "user_id": 308668, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1760ce981f53c8ccc1ef62493d3805cc?s=128&d=identicon&r=PG&f=1", "display_name": "mike3996", "link": "https://stackoverflow.com/users/308668/mike3996"}, "edited": false, "score": 0, "creation_date": 1476957642, "post_id": 40145318, "comment_id": 67571509, "body": "@progo CS.SE may indeed be appropriate for this. TCS.SE instead is not, since it only focuses on research-level questions."}, {"owner": {"reputation": 15429, "user_id": 308668, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1760ce981f53c8ccc1ef62493d3805cc?s=128&d=identicon&r=PG&f=1", "display_name": "mike3996", "link": "https://stackoverflow.com/users/308668/mike3996"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1476962397, "post_id": 40145318, "comment_id": 67574669, "body": "@chi: yes. Sorry, I always forget which one is which"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1476979845, "post_id": 40145318, "comment_id": 67587769, "body": "@user2407038 Recognizing cycles only gets you part of the way there, and doesn&#39;t seem very satisfying to me. What about <code>all (&gt; 0) [1..]</code>? That &quot;should&quot; be <code>True</code>, but the list is infinite, and has no cycle you can detect to figure things out more easily."}], "answers": [{"tags": [], "owner": {"reputation": 15429, "user_id": 308668, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1760ce981f53c8ccc1ef62493d3805cc?s=128&d=identicon&r=PG&f=1", "display_name": "mike3996", "link": "https://stackoverflow.com/users/308668/mike3996"}, "is_accepted": false, "score": 2, "last_activity_date": 1476937723, "creation_date": 1476937723, "answer_id": 40145496, "question_id": 40145318, "link": "https://stackoverflow.com/questions/40145318/what-is-the-mathematical-significance-of-all-1-1-1-not-terminating/40145496#40145496", "title": "What is the mathematical significance of &quot;all (==1) [1,1..]&quot; not terminating?", "body": "<p>I don't know enough about computability to answer this properly, but I do draw comfort from the simplicity in the language design. In this case, I find it simple and elegant that <code>all</code> doesn't have to know anything about the input it's given. It's arguably easier for human to reason about the snippet that you have given. </p>\n\n<p>Sure, now it would be good for the infinite list comprehension to somehow tell <code>all</code> that it's an infinite list of ones. But... that's what it says \"by being of that value\". Having a bit more generic metadata about the repeated sequence would be more successful for optimization purposes, but I think the simplicity would be reduced, and complexity introduced. </p>\n"}, {"comments": [{"owner": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "edited": false, "score": 0, "creation_date": 1476950440, "post_id": 40146359, "comment_id": 67566559, "body": "How strict is it? Does optimization technique, while replacing <code>all (==1) [1,1..]</code> with <code>True</code> will broke something important?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "edited": false, "score": 4, "creation_date": 1476957797, "post_id": 40146359, "comment_id": 67571627, "body": "@AlexeyBirukov 1) Would you also be OK with the optimizer replacing <code>let x = True &amp;&amp; x in x</code> with <code>True</code>? or <code>let x=x in x</code> with <code>True</code>? 2) The optimizer can not spot all these cases since the problem is undecidable. Having your code that suddenly stops working because some optimization no longer kick in looks quite fragile."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "edited": false, "score": 1, "creation_date": 1476975168, "post_id": 40146359, "comment_id": 67584402, "body": "@AlexeyBirukov: as chi says, it wouldn&#39;t make sense for the optimiser to do that kind of thing. The few cases in which this is possible are trivial like the given example, and thus wouldn&#39;t gain you much."}, {"owner": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "edited": false, "score": 0, "creation_date": 1477073818, "post_id": 40146359, "comment_id": 67633542, "body": "Ok, but what about &quot;Loop-invariant code motion&quot; family of optimizations? It proved to be useful, at least for C-like laguages. Can compiler do guessing beyond the denotational semantics internally, to do something like <code>map (2*) [1,1..]</code> --&gt; <code>[2,2..]</code>?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "edited": false, "score": 0, "creation_date": 1477446256, "post_id": 40146359, "comment_id": 67767053, "body": "@AlexeyBirukov, I don&#39;t know what you mean by &quot;beyond the denotational semantics&quot;. <code>map (2*) [1,1..]</code> and <code>[2,2..]</code> have the same denotation, so there&#39;s no problem with replacing one by the other."}, {"owner": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "edited": false, "score": 0, "creation_date": 1477575079, "post_id": 40146359, "comment_id": 67830201, "body": "@Reid Barton, Let&#39;s better consider <code>filter (&gt;0) [1..]</code> --&gt; <code>[1..]</code>. I mean, to be able to do this code transformation, optimizer probably must use rule like <code>filter the_predicate the_list</code> = if <code>all the_predicate the_list</code> then <code>the_list</code>."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1477581373, "post_id": 40146359, "comment_id": 67834854, "body": "The compiler can use whatever kind of internal logic it wants as long as the output has the same denotation as the input. It isn&#39;t restricted to &quot;thinking in Haskell&quot;."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 23, "last_activity_date": 1476942328, "creation_date": 1476942328, "answer_id": 40146359, "question_id": 40145318, "link": "https://stackoverflow.com/questions/40145318/what-is-the-mathematical-significance-of-all-1-1-1-not-terminating/40146359#40146359", "title": "What is the mathematical significance of &quot;all (==1) [1,1..]&quot; not terminating?", "body": "<p>The value</p>\n\n<pre><code>all (==1) [1,1..]\n</code></pre>\n\n<p>is the least upper bound of the sequence</p>\n\n<pre><code>all (==1) (\u22a5)\nall (==1) (1 : \u22a5)\nall (==1) (1 : 1 : \u22a5)\n...\n</code></pre>\n\n<p>and all terms of this sequence are \u22a5, so the least upper bound is also \u22a5. (All Haskell functions are continuous: preserve least upper bounds.)</p>\n\n<p>This is using the <a href=\"https://en.wikibooks.org/wiki/Haskell/Denotational_semantics\">denotational semantics</a> for Haskell and doesn't depend (directly) on choosing any particular evaluation strategy.</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 3, "last_activity_date": 1477003359, "last_edit_date": 1477003359, "creation_date": 1476999296, "answer_id": 40164940, "question_id": 40145318, "link": "https://stackoverflow.com/questions/40145318/what-is-the-mathematical-significance-of-all-1-1-1-not-terminating/40164940#40164940", "title": "What is the mathematical significance of &quot;all (==1) [1,1..]&quot; not terminating?", "body": "<p>In programming, we use not classical logic, but intuitionistic (constructive) logic. We can still interpret types as theorems, but we don\u2019t care about the <em>truth</em> of these theorems; instead, we talk about whether they\u2019re <em>constructively provable</em>. Even though <code>all (== 1) [1, 1 ..]</code> is <em>true</em>, we can\u2019t <em>prove</em> it in Haskell, so we get \u22a5 (here, an infinite loop).</p>\n\n<p>In constructive logic, we don\u2019t have the law of the excluded middle, nor double negation elimination as a result. The Haskell function type <code>all (== 1) :: [Int] -&gt; Bool</code> doesn\u2019t represent the theorem [Int] \u2192 Bool, which would be a total function; it represents the theorem [Int] \u2192 \u00ac\u00acBool. If <code>all</code> can prove the theorem by producing a result, then that result will be of type <code>Bool</code>; otherwise, the result is bottom.</p>\n"}], "owner": {"reputation": 6986, "user_id": 877603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ecf2008864ba219bf52317d2ff31ffe2?s=128&d=identicon&r=PG", "display_name": "TheIronKnuckle", "link": "https://stackoverflow.com/users/877603/theironknuckle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 1, "accepted_answer_id": 40146359, "answer_count": 3, "score": 10, "last_activity_date": 1477003359, "creation_date": 1476936529, "last_edit_date": 1476938324, "question_id": 40145318, "link": "https://stackoverflow.com/questions/40145318/what-is-the-mathematical-significance-of-all-1-1-1-not-terminating", "title": "What is the mathematical significance of &quot;all (==1) [1,1..]&quot; not terminating?", "body": "<p>Intuitively, I would expect the \"mathematical\" answer to <code>all (==1) [1,1..]</code> to be <code>True</code> because all of the elements in a list that only contains 1s are equal to 1. However I understand that \"computationally\", the process of evaluating the infinite list in order to check that each element does in fact equal 1 will never terminate, therefore the expression instead \"evaluates\" to bottom or <code>\u22a5</code>. </p>\n\n<p>I find this result counter-intuitive and a little unnerving. I think the fact that the list is an infinite one confuses the issue both mathematically and computationally, and I would love to hear from anyone who has some insight and experience in this area</p>\n\n<p>My question is, which is the most mathematically correct answer? <code>\u22a5</code> or <code>True</code>?\nSome elaboration as to why one answer is more correct than the other would also be much appreciated. </p>\n\n<p>edit: This might indirectly have something to do with the <a href=\"https://en.wikipedia.org/wiki/Curry%E2%80%93Howard_correspondence\">Curry-Howard isomorphism</a> (Programs are proofs and types are theorems) and <a href=\"https://en.wikipedia.org/wiki/G%C3%B6del%27s_incompleteness_theorems\">G\u00f6del's incompleteness theorems</a>. If I remember correctly, one of the incompleteness theorems can be <em>(incredibly roughly)</em> summarised as saying that \"sufficiently powerful formal systems (like mathematics or a programming language) cannot prove all true statements that can be expressed in the system\"</p>\n"}, {"tags": ["haskell", "lambda", "lowercase"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1476925990, "post_id": 40143900, "comment_id": 67557675, "body": "<code>let lowercase = map toLower</code>. Then, call it as <code>lowercase &quot;Hello&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": false, "score": 16, "last_activity_date": 1543245467, "last_edit_date": 1543245467, "creation_date": 1476926165, "answer_id": 40143955, "question_id": 40143900, "link": "https://stackoverflow.com/questions/40143900/how-to-convert-a-string-to-lowercase-using-lambda-expressions/40143955#40143955", "title": "How to convert a String to lowercase using lambda expressions", "body": "<p>It would be easier to not use a lambda expression considering you can eta-reduce to not explicitly name the variable your function accepts. For example you could use a list comprehension:</p>\n\n<pre><code>import Data.Char\n\nlowerString str = [ toLower loweredString | loweredString &lt;- str]\n</code></pre>\n\n<p>Which you would call as:</p>\n\n<pre><code>ghci&gt; lowerString \"Hello\"\nhello\n</code></pre>\n\n<p>Alternatively, you could use <code>map</code>:</p>\n\n<pre><code>lowerString = map toLower\n</code></pre>\n\n<p>If you insist on using a lambda expression, it would look something like this:</p>\n\n<pre><code>import Data.Char\n\nlowerString = \\x -&gt; map toLower x\n</code></pre>\n\n<p>Which again, is not as nice.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1476980819, "post_id": 40154978, "comment_id": 67588336, "body": "Have you tested your code? It looks as it will fail as soon as the end of the string is reached, since you never specify what to do with the empty tail <code>[]</code>."}, {"owner": {"reputation": 494, "user_id": 5447207, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d96199ece7ba3bc4f3c1d97d645f5fad?s=128&d=identicon&r=PG", "display_name": "Bargros", "link": "https://stackoverflow.com/users/5447207/bargros"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1476985419, "post_id": 40154978, "comment_id": 67590993, "body": "should be ok now, I always forget about that when dealing with lists, thank you"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1476988613, "post_id": 40154978, "comment_id": 67592967, "body": "<code>s==[]</code> will always be false, since <code>s = x:xs</code> so it&#39;s not empty."}], "tags": [], "owner": {"reputation": 494, "user_id": 5447207, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d96199ece7ba3bc4f3c1d97d645f5fad?s=128&d=identicon&r=PG", "display_name": "Bargros", "link": "https://stackoverflow.com/users/5447207/bargros"}, "is_accepted": false, "score": 2, "last_activity_date": 1476997833, "last_edit_date": 1476997833, "creation_date": 1476967760, "answer_id": 40154978, "question_id": 40143900, "link": "https://stackoverflow.com/questions/40143900/how-to-convert-a-string-to-lowercase-using-lambda-expressions/40154978#40154978", "title": "How to convert a String to lowercase using lambda expressions", "body": "<p>With a lambda expression you'd still need to recursively check each character of the string, or you could use <strong>map</strong> which is still a recursive function that applies the function <strong>(a -> b)</strong> to every element in the list, for example:</p>\n\n<pre><code>  newList [] = []\n  newList xs = (\\(y:ys) -&gt; if x `elem` ['A'..'Z'] then toLower y : newList ys else y : newList ys) xs\n</code></pre>\n\n<p>With <strong>map</strong> is actually much simpler due to reasons explained in the first paragraph, check mnoronha's answer as he already gave you the answer, but that's if you're thinking of using map in conjunction with toLower.</p>\n\n<p>This is an example without a lambda expression, which requires you to import 2 functions from Data.Char, recursively check the rest of the string and replace each character with its lower case version.</p>\n\n<pre><code>newList :: String -&gt; String\nnewList [] = []\nnewList (x:xs) = if x `elem` ['A'..'Z'] \n               then chr (ord x + 32) : newList xs \n               else x : newList xs  \n</code></pre>\n\n<p>or with guards</p>\n\n<pre><code>newList :: String -&gt; String\nnewList [] = []\nnewList (x:xs)\n    | x `elem` ['A'..'Z'] = chr (ord x + 32) : newList xs \n    | otherwise = x : newList xs \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "is_accepted": false, "score": 0, "last_activity_date": 1477003764, "last_edit_date": 1477003764, "creation_date": 1477003308, "answer_id": 40165667, "question_id": 40143900, "link": "https://stackoverflow.com/questions/40143900/how-to-convert-a-string-to-lowercase-using-lambda-expressions/40165667#40165667", "title": "How to convert a String to lowercase using lambda expressions", "body": "<p>This may be more trouble than it's worth but you can use the fix function to recursively call a lambda function.  </p>\n\n<pre><code>fix :: (a -&gt; a) -&gt; a\nfix f = let x = f x in x\n</code></pre>\n\n<p>The following code uses the same method used on this page : <a href=\"https://www.vex.net/~trebla/haskell/fix.xhtml\" rel=\"nofollow\">https://www.vex.net/~trebla/haskell/fix.xhtml</a> to transition from a non-lambda version to a lambda version to (eventually) using fix to recursively call a lambda function without introducing a new variable</p>\n\n<pre><code>import Data.Char (toLower)\nimport Control.Monad.Fix (fix)\n\nmain :: IO ()\nmain = do \n    -- calling non lambda version\n    let newlist1 s = if null s then [] else toLower (head s) : newlist1 (tail s)\n    print $ newlist1 \"Hello\"\n\n    -- calling lambda version\n    let newlist2 = \\s -&gt; if null s then [] else toLower (head s) : newlist2 (tail s)\n    print $ newlist2 \"Hello\"\n\n    -- defining lambda version locally\n    -- ( at this point the scope of newlist3 is local to the let statement )\n    print $ (let newlist3 = \\s -&gt; if null s then [] else toLower (head s) : newlist3 (tail s) in newlist3 ) \"Hello\"\n\n    -- making function an argument to be called recursively\n    print $ (let newlist3 = (\\v -&gt; \\s -&gt; if null s then [] else toLower (head s) : v (tail s)) newlist3 in newlist3 ) \"Hello\"\n\n    -- isolating function to be \"fixed\".\n    let f = (\\v -&gt; \\s -&gt; if null s then [] else toLower (head s) : v (tail s))\n    print $ (let newlist3 =  f newlist3 in newlist3 ) \"Hello\"\n\n    -- using fix = let x = f x in x\n    print $ (fix f) \"Hello\"\n\n    -- f2 is slightly simpler version of f\n    let f2 = (\\v s -&gt; if null s then [] else toLower (head s) : v (tail s))\n    print $ (fix f2) \"Hello\"\n\n    -- inlining f2 to get recursive call to lambda \n    print $ (fix (\\v s -&gt; if null s then [] else toLower (head s) : v (tail s))) \"Hello\"\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 6368959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b93461c76d260210258aec3817cbb10b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/6368959/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10151, "favorite_count": 1, "answer_count": 3, "score": 7, "last_activity_date": 1543245467, "creation_date": 1476925768, "last_edit_date": 1477024701, "question_id": 40143900, "link": "https://stackoverflow.com/questions/40143900/how-to-convert-a-string-to-lowercase-using-lambda-expressions", "title": "How to convert a String to lowercase using lambda expressions", "body": "<p>I want to know how to convert a string to lowercase using the <code>ToLower</code> function <code>(Char -&gt; Char)</code>.</p>\n\n<p>This is the code I have so far:</p>\n\n<pre><code>let newlist = (\\(h:t) -&gt; c (h) ++ newlist (\\c -&gt; toLower c)\n</code></pre>\n\n<p>I can't see how to do it without using recursion, which I don't know how to use in a lambda expression</p>\n"}]