[{"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": false, "score": 0, "last_activity_date": 1478731583, "creation_date": 1478731583, "answer_id": 40517265, "question_id": 40517016, "link": "https://stackoverflow.com/questions/40517016/set-rts-settings-inside-program/40517265#40517265", "title": "Set RTS settings inside program", "body": "<p>I don't believe such options can be set from within the program itself, but can certainly be set at run-time the configuration parsing just has to be external to the program for which you want the RTS options set. You could write a program/script to read the configuration and run your target program passing the desired options.</p>\n"}, {"tags": [], "owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "is_accepted": false, "score": 3, "last_activity_date": 1478734674, "creation_date": 1478734674, "answer_id": 40517807, "question_id": 40517016, "link": "https://stackoverflow.com/questions/40517016/set-rts-settings-inside-program/40517807#40517807", "title": "Set RTS settings inside program", "body": "<p>You could write some C code and override some GC hooks, but the easiest way might be to have a script set an environment variable.  The GHC Users Guide lists 4 ways RTS options can be set:\n  <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/runtime_control.html#setting-rts-options\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/runtime_control.html#setting-rts-options</a></p>\n\n<p>There are four ways to set RTS options:</p>\n\n<ul>\n<li><p>on the command line between +RTS ... -RTS, when running the program\n(Setting RTS options on the command line)</p></li>\n<li><p>at compile-time, using -with-rtsopts (Setting RTS options at compile\ntime)</p></li>\n<li><p>with the environment variable GHCRTS (Setting RTS options with the\nGHCRTS environment variable)</p></li>\n<li><p>by overriding \u201chooks\u201d in the runtime system (\u201cHooks\u201d to change RTS\nbehaviour)</p></li>\n</ul>\n"}], "owner": {"reputation": 1730, "user_id": 890793, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b22cd8540bf40a30fd85e964a342be2?s=128&d=identicon&r=PG", "display_name": "Sh4pe", "link": "https://stackoverflow.com/users/890793/sh4pe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1478734674, "creation_date": 1478730223, "question_id": 40517016, "link": "https://stackoverflow.com/questions/40517016/set-rts-settings-inside-program", "title": "Set RTS settings inside program", "body": "<p>Is it possible to set <code>RTS</code> options from within the program?</p>\n\n<p>Specifically, I want to achieve the same as</p>\n\n<p><code>./my-prog +RTS -M4G\n</code></p>\n\n<p>I know that with haskell stack, you can decide some RTS options at compile time. But I don't want to fix these options at compile time, since I want my program to read these options from a configuration file and let it be aware of these options.</p>\n\n<p>Is this possible with GHC?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478729618, "post_id": 40516849, "comment_id": 68275442, "body": "If you try to add a type signature to <code>doLoop</code> you will see what the problem is. On one hand, your <code>doLoop</code> expects its third argument to be a <code>UTCTime</code>, but when you call it in <code>main</code>, you give it an <code>IO UTCTime</code>. Try changing main to: <code>main = do { currTime &lt;- getCurrentTime; doLoop &quot;FilePath&quot; &quot;FilePath&quot; currTime }</code> (or just <code>main = doLoop &quot;FilePath&quot; &quot;FilePath&quot; =&lt;&lt; currTime</code> if you are so inclined)."}, {"owner": {"reputation": 38, "user_id": 4477752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d8b581ae4c3a5d93fd90ccb17a3ca91?s=128&d=identicon&r=PG&f=1", "display_name": "Ozan", "link": "https://stackoverflow.com/users/4477752/ozan"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478730065, "post_id": 40516849, "comment_id": 68275625, "body": "Worked like a charm. Thank you very much! Was it because of the lack of a &quot;do&quot; call that Haskell expected a non-monadic argument instead of IO UTCTime, even though the functions I used can only produce monadic results?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1478730202, "post_id": 40516849, "comment_id": 68275681, "body": "@Ozan No, it expected a non-<code>IO</code> argument because you pass it to <code>(&#47;=)</code> along with another non-<code>IO</code> thing. Neither whether you use <code>do</code> syntax nor whether you produce an <code>IO</code> thing in the end is related at all."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1478730781, "post_id": 40516849, "comment_id": 68275872, "body": "Unrelated to your current error, I don&#39;t think that comparison makes a lot of sense. Why would the modification time ever be <i>exactly equal to the current time</i>?"}, {"owner": {"reputation": 38, "user_id": 4477752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d8b581ae4c3a5d93fd90ccb17a3ca91?s=128&d=identicon&r=PG&f=1", "display_name": "Ozan", "link": "https://stackoverflow.com/users/4477752/ozan"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1478731632, "post_id": 40516849, "comment_id": 68276192, "body": "@leftaroundabout I left a huge chunk of the code out.  The current time should never be equal to the modification time of the directory, so the code always runs through then the first time (which also prints a couple of things for me to better understand what the code is doing). At the end, after waiting 5 seconds, it calls <i>doLoop</i> recursively with <i>modified</i>, so in the second run of the loop it is really comparing the modification timestamps of the directory."}], "answers": [{"comments": [{"owner": {"reputation": 38, "user_id": 4477752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d8b581ae4c3a5d93fd90ccb17a3ca91?s=128&d=identicon&r=PG&f=1", "display_name": "Ozan", "link": "https://stackoverflow.com/users/4477752/ozan"}, "edited": false, "score": 0, "creation_date": 1478731260, "post_id": 40517059, "comment_id": 68276043, "body": "I see. I naively expected Haskell to insert the current timestamp as an argument when I call the function like that. Thanks for pointing our my mistake."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1478730460, "creation_date": 1478730460, "answer_id": 40517059, "question_id": 40516849, "link": "https://stackoverflow.com/questions/40516849/haskell-comparing-io-utctime/40517059#40517059", "title": "Haskell comparing IO UTCTime", "body": "<p><code>IO UTCTime</code> is not the type of a timestamp. It's the type of <em>an action that can give you a timestamp</em>. This is a huge difference. It thus doesn't make sense for <code>doLoop</code> to accept an <code>IO UTCTime</code> as its last argument, what you want is probably</p>\n\n<pre><code>doLoop :: FilePath -&gt; FilePath -&gt; UTCTime -&gt; IO ()\n</code></pre>\n\n<p>always write out type signatures like this, to find out where the error is really happening and to document your intent!</p>\n\n<p>What doesn't work then is <code>doLoop \"FilePath\" \"FilePath\" getCurrentTime</code>, because <code>getCurrentTime</code> <em>is</em> an action to <em>obtain</em> timestamps rather than an actual timestamp. (If it were just a single timestamp, it could hardly be <em>current</em> whenever you call it, could it?)</p>\n\n<p>Hence you need to <em>evaluate</em> this action to get an actual timestamp which you can then pass to <code>doLoop</code>. The easiest way is in a <code>do</code> block:</p>\n\n<pre><code>main = do\n   t &lt;- getCurrentTime\n   doLoop \"FilePath\" \"FilePath\" t\n</code></pre>\n\n<p>More concisely, you can also Kleisli-compose these two <code>IO</code> actions:</p>\n\n<pre><code>main = doLoop \"FilePath\" \"FilePath\" =&lt;&lt; getCurrentTime\n</code></pre>\n\n<p>...which is actually what that <code>do</code> syntax desugars to, anyway.</p>\n"}], "owner": {"reputation": 38, "user_id": 4477752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d8b581ae4c3a5d93fd90ccb17a3ca91?s=128&d=identicon&r=PG&f=1", "display_name": "Ozan", "link": "https://stackoverflow.com/users/4477752/ozan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 40517059, "answer_count": 1, "score": 1, "last_activity_date": 1478730460, "creation_date": 1478729368, "last_edit_date": 1478730007, "question_id": 40516849, "link": "https://stackoverflow.com/questions/40516849/haskell-comparing-io-utctime", "title": "Haskell comparing IO UTCTime", "body": "<p>I am completely new to Haskell and I can't find an answer to this problem. Maybe I was searching for the wrong thing.</p>\n\n<p>I am having problems with a small script that's supposed to take two file paths and a <code>IO UTCTime</code> timestamp. The idea is to check every 5 seconds whether the directory was modified or not. I am leaving out the details of the script for simplicity's sake. It boils down to:</p>\n\n<pre><code>import Data.List\nimport Control.Monad\nimport Control.Concurrent\nimport System.Directory\nimport Data.Time.Clock\n\nmain = doLoop \"FilePath\" \"FilePath\" getCurrentTime\n\ndoLoop lastPath currentPath lastModified = do\n     modified &lt;- getModificationTime currentPath\n     if (lastModified /= modified)\n       then print \"Success\"\n       else do threadDelay 5000000\n               doLoop \"FilePath\" \"FilePath\" lastModified\n</code></pre>\n\n<p>I'm getting the compile error:</p>\n\n<pre><code>Couldn't match expected type `UTCTime`\nwith actual type `IO UTCTime`\nIn the third argument of `doLoop`, namely `getCurrentTime`\n</code></pre>\n\n<p>getCurrentTime is supposed to produce a <code>IO UTCTime</code> according to the documentation, just like <code>getCurrentTime</code>. What am I missing here?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1478728774, "post_id": 40516674, "comment_id": 68275112, "body": "If this is purely for debugging purposes, then <a href=\"https://hackage.haskell.org/package/base/docs/Debug-Trace.html#v:traceShowId\" rel=\"nofollow noreferrer\"><code>traceShowId</code></a> from <code>Debug.Trace</code> might help."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1478728828, "post_id": 40516674, "comment_id": 68275132, "body": "@AlexisKing, if they need a monadic context for something else, that seems like overkill, but a relative of a good solution."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1478729186, "post_id": 40516674, "comment_id": 68275267, "body": "What is your question?"}, {"owner": {"reputation": 685, "user_id": 5641333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xQ9JE.jpg?s=128&g=1", "display_name": "JayDepp", "link": "https://stackoverflow.com/users/5641333/jaydepp"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1478730510, "post_id": 40516674, "comment_id": 68275783, "body": "@AlexisKing That seems like a great solution, but this isn&#39;t only for debugging. It&#39;ll be helpful in the future though!"}], "answers": [{"tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": false, "score": 1, "last_activity_date": 1478733615, "creation_date": 1478733615, "answer_id": 40517651, "question_id": 40516674, "link": "https://stackoverflow.com/questions/40516674/haskell-print-and-use-a-value-from-a-monad/40517651#40517651", "title": "Haskell print and use a value from a monad", "body": "<p>You could create some Applicative-style combinators that perform printing if you wanted to make things a little bit shorter:</p>\n\n<pre><code>import Control.Monad.IO.Class (MonadIO(..))\n\n(&lt;*&amp;&gt;) :: (MonadIO m, Show a) =&gt; m (a -&gt; b) -&gt; m a -&gt; m b\nmf &lt;*&amp;&gt; mx = do\n  f &lt;- mf\n  x &lt;- mx\n  liftIO $ print x\n  return $ f x\n\n(&lt;$&amp;&gt;) :: (MonadIO m, Show a) =&gt; (a -&gt; b) -&gt; m a -&gt; m b\nf &lt;$&amp;&gt; mx = pure f &lt;*&amp;&gt; mx\n</code></pre>\n\n<p>(The names probably leave something to be desired, but I\u2019ll leave that up to you.)</p>\n\n<p>With these operators, you could write your original example like this:</p>\n\n<pre><code>main = print $ f &lt;$&amp;&gt; m1 &lt;*&amp;&gt; m2\n</code></pre>\n\n<p>Whether or not you think this is clearer is up to you (and probably up to how frequently you use this pattern).</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 0, "last_activity_date": 1478735458, "creation_date": 1478735458, "answer_id": 40517932, "question_id": 40516674, "link": "https://stackoverflow.com/questions/40516674/haskell-print-and-use-a-value-from-a-monad/40517932#40517932", "title": "Haskell print and use a value from a monad", "body": "<p>You might want this:</p>\n\n<pre><code>main = (liftM2 f `on` (&gt;&gt;= p)) m1 m2 &gt;&gt;= print\n       where f = (++)\n             p x = print x &gt;&gt; return x\n             m1 = getLine\n             m2 = getLine\n</code></pre>\n\n<ul>\n<li><code>liftM2 f</code> creates a version of <code>f</code> whose \"arguments\" are both monadic values.</li>\n<li><code>on</code> creates a function that passes both \"arguments\" through <code>(&gt;&gt;= p)</code> before passing them on to <code>liftM2 f</code>.</li>\n<li>The final result is then bound to <code>print</code>.</li>\n</ul>\n\n<p>As a result, this example</p>\n\n<ol>\n<li>Waits for a line to be entered, then prints that line</li>\n<li>Waits for another line to be entered, then prints <em>that</em> line</li>\n<li>Concatenates the two lines then prints the result.</li>\n</ol>\n"}], "owner": {"reputation": 685, "user_id": 5641333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xQ9JE.jpg?s=128&g=1", "display_name": "JayDepp", "link": "https://stackoverflow.com/users/5641333/jaydepp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 782, "favorite_count": 0, "accepted_answer_id": 40517932, "answer_count": 2, "score": 1, "last_activity_date": 1478735458, "creation_date": 1478728536, "last_edit_date": 1478730319, "question_id": 40516674, "link": "https://stackoverflow.com/questions/40516674/haskell-print-and-use-a-value-from-a-monad", "title": "Haskell print and use a value from a monad", "body": "<p>So, what I'm trying to do is print two values before I use them. Here's two ways which work perfectly, but I feel like there are other ways I could do it. I know the suggested way to do it is likely the do block since its laid out and is least complicated, but why not see how else?</p>\n\n<pre><code>-- 1\nmain = do\n    a &lt;- m1\n    b &lt;- m2\n    print a\n    print b\n    print $ f a b\n\n-- 2\np x = print x &gt;&gt; return x\n\nmain = print =&lt;&lt; liftM2 f (p =&lt;&lt; m1) (p =&lt;&lt; m2)\n</code></pre>\n\n<p>I've also tried these, but they have their problems I'm not quite able to figure out and there never seems to be the right things to chain together.</p>\n\n<pre><code>main = print =&lt;&lt; foldl1 f . mapM p =&lt;&lt; sequence [m1, m2]\nmain = print =&lt;&lt; on f p m1 m2\nmain = print . curry (on f) =&lt;&lt; (uncurry (join (***)) p) m1 m2\n</code></pre>\n\n<p>I think that <code>on</code> from Data.Function is pretty close to what I want to do, but I don't know how to pipe in two monadic values. Thanks in advance for any suggestions.</p>\n\n<p>Edit: The first question is a bit broad: How can I rewrite the first do block? My other question is how can I extract two values from monads into a function that takes two values?<br>\nIf there was a function that did something like <code>(m a, m a) -&gt; m (a, a)</code> then I think could do <code>curry (on f p) =&lt;&lt; thatfunction (m1, m2)</code>, but there could be another way.</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1478724790, "post_id": 40515293, "comment_id": 68273262, "body": "I&#39;m voting to close this question as off-topic because questions generally have to include an attempt or more specificity as to where the road-block lays."}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1478725025, "post_id": 40515293, "comment_id": 68273389, "body": "@Thomas and @Chad: I crafted the type signature of the function and named the arguments, and then outlined the needed specs with an example. I could qualitatively also say that I thought about <code>split</code>ing the multi-line string into different lines and then matching on those lines, but then didn&#39;t know what to do afterwards (eventually, I think we&#39;ll also have to <code>read</code> the number as an Integer). I appreciate your help."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1478725438, "post_id": 40515293, "comment_id": 68273617, "body": "@ThomasM.DuBuisson While this does make the question less good than it might have been, and is an issue worth raising in the comments, I don&#39;t think it makes it off-topic (unless you consider it too broad for asking for too much code without an attempt)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1478728300, "post_id": 40515293, "comment_id": 68274923, "body": "It is too broad. Writing a type signature and documenting the expected output is not an attempt at actually writing the code. That&#39;s just specifying the requirement."}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1478728280, "creation_date": 1478728280, "answer_id": 40516626, "question_id": 40515293, "link": "https://stackoverflow.com/questions/40515293/finding-a-string-and-adding-a-number-to-it-in-haskell/40516626#40516626", "title": "Finding a string and adding a number to it in Haskell", "body": "<p>I don't want to spoil the fun of solving this problem therefore I will only give some advice on how I would go and try solving this problem.</p>\n\n<p>First of all I hope you know about the two functions <code>words</code> and <code>unwords</code> one is for splitting a <code>String</code> into a <code>[String]</code>, and the other does the opposite - i.e. joins a <code>[String]</code> separating two elements by a single <code>' '</code>. You should also know about the functions <code>lines</code> and <code>unlines</code> which do something quite similar - I hope you can guess by their name what they do.</p>\n\n<p>Next thing I would try is building a (helper) transformation function that transforms a <code>String</code> by adding <code>n</code>. Hint: the function <code>show</code> might come in handy.</p>\n\n<pre><code>h :: Int -&gt; String -&gt; String\nh n str = let m = read str\n          in ...\n</code></pre>\n\n<p>If you can furthermore transform <code>[\"x.tally:\", \"10\"]</code> into <code>[\"x.tally:\", \"15\"]</code> with the previous helper function and map every other list to itself, then you are almost done and I hope you can stitch all of my advice together to make the function you desire.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1478728280, "creation_date": 1478722645, "question_id": 40515293, "link": "https://stackoverflow.com/questions/40515293/finding-a-string-and-adding-a-number-to-it-in-haskell", "title": "Finding a string and adding a number to it in Haskell", "body": "<p>Suppose I have a multi-line string <code>multiStr</code>:</p>\n\n<pre><code>line 1\nline 2\nx.tally: 10\nline 4\nline 5\n</code></pre>\n\n<p>How could I write a function </p>\n\n<pre><code>f :: Integer -&gt; String -&gt; String -&gt; String\nf n lineMatcher multiStr = ...\n</code></pre>\n\n<p>that finds the first matching line that starts with <code>lineMatcher</code> and adds <code>n</code> to the number at the end of it.</p>\n\n<p>So for example, in this case, we would have that <code>f 5 \"x.tally\" multiStr</code> evaluates to</p>\n\n<pre><code>line 1\nline 2\nx.tally: 15\nline 4\nline 5\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 4, "creation_date": 1478714701, "post_id": 40513016, "comment_id": 68268359, "body": "Try writing a function <code>isPrime :: Int -&gt; Bool</code> and then map that over the natural numbers like this : <code>map isPrime [0..]</code>. That probably wouldn&#39;t be terribly efficient (depending on how you do it), but it would be a start."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1478715044, "post_id": 40513016, "comment_id": 68268549, "body": "Your attempt doesn&#39;t work because:  1. If it would work it wouldn&#39;t create a list of Bools, but just one Bool. 2. There is no constant (nor function for that matter) <code>prime</code>. You probably mean something like &quot;is this number prime?&quot;. But what number? Look at my comment above for how to express this."}, {"owner": {"reputation": 9, "user_id": 7137639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5084d06ff92dfe8f2a3da330528a2e74?s=128&d=identicon&r=PG&f=1", "display_name": "princess 11", "link": "https://stackoverflow.com/users/7137639/princess-11"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1478715495, "post_id": 40513016, "comment_id": 68268754, "body": "jpath I already have a prime function and it works.   prime :: Integer -&gt; Bool prime n = n &gt; 1 &amp;&amp; and [not(divides x n) | x &lt;- [2..(n-1)]]"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1478718458, "post_id": 40513016, "comment_id": 68270169, "body": "So where exactly is your problem?"}, {"owner": {"reputation": 9, "user_id": 7137639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5084d06ff92dfe8f2a3da330528a2e74?s=128&d=identicon&r=PG&f=1", "display_name": "princess 11", "link": "https://stackoverflow.com/users/7137639/princess-11"}, "edited": false, "score": 0, "creation_date": 1478719044, "post_id": 40513016, "comment_id": 68270464, "body": "ingo  The primeTest function doesn&#39;t work"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1478719452, "post_id": 40513016, "comment_id": 68270659, "body": "It is not a function (it hasn&#39;t an arguments). Have you learned about the <code>map</code> function? Do you know how to produce a list of numbers, such as the list of natural numbers?"}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": false, "score": 1, "last_activity_date": 1490299807, "last_edit_date": 1490299807, "creation_date": 1478728273, "answer_id": 40516622, "question_id": 40513016, "link": "https://stackoverflow.com/questions/40513016/primetest-function-haskell/40516622#40516622", "title": "primeTest function Haskell", "body": "<p>I'm not sure what exactly you're doing with your <code>prime</code> function. As far as I know, there isn't a <code>divides</code> function (at least in Prelude). Let's start by fixing it. For relatively prime numbers <code>a</code> and <code>b</code>:</p>\n\n<pre><code>a `mod` b == 0\n</code></pre>\n\n<p>And a prime number <code>n</code> is relatively prime with all numbers from <code>2</code> to <code>n-1</code>. If this condition is true for each <code>a-b</code> pair with <code>a</code> being the number in question and <code>b</code> being the each number from <code>2</code> to <code>n-1</code>, we'll know the number is prime. You can actually shorten this if you want, but I'll leave that out since our goal isn't efficiency. Thus, we rewrite the <code>primes</code> function:</p>\n\n<pre><code>primes :: Integer -&gt; Bool\nprimes n = n &gt; 1 &amp;&amp; and [ prime n = n &gt; 1 &amp;&amp; and [ (n `mod` x) /= 0 | x &lt;- [2..(n-1)] ]\n</code></pre>\n\n<p>We can then <code>map</code> our function over the the infinite to produce an infinite list of <code>Bools</code>:</p>\n\n<pre><code>map primes [1..]\n</code></pre>\n\n<p>And to check if it's working as expected, we check specific indices in the list:</p>\n\n<pre><code>ghci&gt;&gt; (map primes [1..]) !! 12 --expecting true, since 13 is prime\nTrue\n</code></pre>\n\n<p>To adapt the function to return a list of tuples with the value along with the bool, we can use a list comprehension and our current function:</p>\n\n<pre><code>primeTest :: [(Integer,Bool)]\nprimeTest = [ (x,prime x) | x &lt;- [1..] ]\n</code></pre>\n\n<p>Sample usage:</p>\n\n<pre><code>ghci&gt;&gt; primeTest !! 12 -- expecting (13,True)\n(13,True)\n</code></pre>\n\n<p>At this point because I think the off-by-one index makes things confusing, I'd make <code>primeTest</code> into a function like so:</p>\n\n<pre><code>primeTest :: Int -&gt; (Integer, Bool)\nprimeTest n = [ (x,prime x) | x &lt;- [1..] ] !! (n-1)\n</code></pre>\n\n<p>So we can use it by passing as an argument the number we want to check:</p>\n\n<pre><code>ghci&gt;&gt; primeTest 13\n(13,True)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7137639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5084d06ff92dfe8f2a3da330528a2e74?s=128&d=identicon&r=PG&f=1", "display_name": "princess 11", "link": "https://stackoverflow.com/users/7137639/princess-11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "closed_date": 1480340291, "answer_count": 1, "score": -3, "last_activity_date": 1490299807, "creation_date": 1478713498, "last_edit_date": 1478843920, "question_id": 40513016, "link": "https://stackoverflow.com/questions/40513016/primetest-function-haskell", "closed_reason": "Needs details or clarity", "title": "primeTest function Haskell", "body": "<p>I'm first trying to write a function <code>primeTest :: [Bool]</code> that produces an such that the nth position of the list is True if n is prime, and False otherwise. Then, I want to adapt the function to produce an infinite list such that the nth position is the pair (n; b) where the value b is True if n is prime and False otherwise.</p>\n\n<p>Here is my attempt so far:</p>\n\n<pre><code>primeTest :: [Bool]\nprimeTest = if prime then True else False\n</code></pre>\n"}, {"tags": ["haskell", "pcap", "packet-capture", "packet-sniffers", "packets"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1478697133, "post_id": 40506692, "comment_id": 68257809, "body": "Maybe PCAP is big-endian (&quot;network&quot; order) or little-endian? Check whether you have <code>getInt32BE</code> or <code>LE</code> available in your library."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1478712721, "post_id": 40506692, "comment_id": 68267402, "body": "There actually is a useful blog walk-though of the format, motivated by someone writing a Haskell parser - <a href=\"http://www.kroosec.com/2012/10/a-look-at-pcap-file-format.html\" rel=\"nofollow noreferrer\">kroosec.com/2012/10/a-look-at-pcap-file-format.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5276289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cfd04.jpg?s=128&g=1", "display_name": "Bence Kodaj", "link": "https://stackoverflow.com/users/5276289/bence-kodaj"}, "is_accepted": false, "score": 1, "last_activity_date": 1478716546, "creation_date": 1478716546, "answer_id": 40513757, "question_id": 40506692, "link": "https://stackoverflow.com/questions/40506692/parsing-a-pcap-file-why-does-this-packet-header-timestamp-contains-soh-01/40513757#40513757", "title": "Parsing a PCAP file - Why does this packet header timestamp contains SOH \\01?", "body": "<p>Did you check the magic number at the very beginning of the pcap file? Its purpose is 1. identify the file format; 2. allow you to determine the byte order. Here's a handy reference: <a href=\"https://wiki.wireshark.org/Development/LibpcapFileFormat#File_Format\" rel=\"nofollow noreferrer\">https://wiki.wireshark.org/Development/LibpcapFileFormat#File_Format</a></p>\n"}], "owner": {"reputation": 1185, "user_id": 3228230, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/m9lny.jpg?s=128&g=1", "display_name": "paperduck", "link": "https://stackoverflow.com/users/3228230/paperduck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478716546, "creation_date": 1478693347, "question_id": 40506692, "link": "https://stackoverflow.com/questions/40506692/parsing-a-pcap-file-why-does-this-packet-header-timestamp-contains-soh-01", "title": "Parsing a PCAP file - Why does this packet header timestamp contains SOH \\01?", "body": "<p>I'm extracting the first 4 bytes from a pcap packet header, which should represent a quantity of seconds. Here they are, in order of appearance in the ByteStream (I'm using Haskell):</p>\n\n<pre><code>\\192    (192)\n\\166    (166)\nx       (120)\nSOH     (01) (Start of Header)\n</code></pre>\n\n<p>My understanding is that the four bytes can be read as a 32-bit integer. However, the presence of SOH is throwing me off. If I interpret the 4 bytes as one integer, I get 2 billion, which is invalid (2 billion seconds = 63 years => invalid because UNIX times starts in 1970, about 45 years ago).</p>\n\n<p>The packet header also ends with NUL (00).</p>\n\n<p>I'm also not sure why the four bytes are reversed, maybe a side-effect of how I'm pulling bytes from the stream (using a Get function and getInt32). Shouldn't the SOH come first?</p>\n"}, {"tags": ["haskell", "state", "calculator"], "answers": [{"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": true, "score": 1, "last_activity_date": 1478694892, "creation_date": 1478694892, "answer_id": 40507168, "question_id": 40506510, "link": "https://stackoverflow.com/questions/40506510/implementing-store-recall-features-on-calculator-using-state/40507168#40507168", "title": "Implementing Store/Recall Features on Calculator Using State", "body": "<pre><code>recall = do\n  x &lt;- gets memory\n  modify (\\s -&gt; InternalState (x : stack s) x)\n\nstore = do\n  (x:xs) &lt;- gets stack\n  put $ InternalState xs x\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 7136164, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7058f7625f65cc7249d5150d99e43b5d?s=128&d=identicon&r=PG", "display_name": "Harambe17", "link": "https://stackoverflow.com/users/7136164/harambe17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 40507168, "answer_count": 1, "score": 1, "last_activity_date": 1478696651, "creation_date": 1478692798, "last_edit_date": 1478696651, "question_id": 40506510, "link": "https://stackoverflow.com/questions/40506510/implementing-store-recall-features-on-calculator-using-state", "title": "Implementing Store/Recall Features on Calculator Using State", "body": "<p>The following code is given; it basically is a calculator that contains a stack of numbers and operations (didn't include operations code) and evaluates to the stack through change of state.</p>\n\n<pre><code>data InternalState = InternalState\n    { stack :: [Double]\n    , memory :: Double\n    }\ntype CalcState = State InternalState\ntype Calculation = CalcState ()\npop :: CalcState Double\npop = state $ \\st -&gt; case stack st of\n    [] -&gt; (0.0,st)\n    x:xs -&gt; (x,st { stack = xs })\npush :: Double -&gt; CalcState ()\npush d = modify  $ \\st -&gt; st { stack = d : stack st }\n</code></pre>\n\n<p>I want to implement a function <code>recall :: Calculation</code> and <code>store :: Calculation</code>, such that, given a stack of numbers, <code>store</code> takes the top number and remembers it (changes the InternalState to have <code>memory</code> equal to that top number. <code>recall</code> should push the single stored number onto the top of the stack of numbers. </p>\n\n<p>My problem is, I don't know how I should use the state functions like <code>get</code>, <code>put</code>, etc. in order to modify the state appropriately. I can see that I would want to alter the state so as ONLY to change the memory (which otherwise stays 0.0 for all other operations of type <code>Calculation</code>). I started implementing <code>store</code> with </p>\n\n<pre><code>store = do\n   x &lt;- pop\n   push x\n</code></pre>\n\n<p>because I know I have to take and put back the top value on the stack, but I have no idea how to use this value to change just the memory of the state. </p>\n"}, {"tags": ["parsing", "haskell", "functional-programming", "backtracking", "attoparsec"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1478687698, "post_id": 40503982, "comment_id": 68252518, "body": "Use the <a href=\"https://hackage.haskell.org/package/attoparsec-parsec-0.1.3/docs/Data-Attoparsec-Text-Parsec.html\" rel=\"nofollow noreferrer\"><code>Data.Attoparsec.Text.Parsec</code></a> module which is precisely provided to make code compatible between Attoparsec and Parsec."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1478723575, "post_id": 40503982, "comment_id": 68272652, "body": "I wonder why you want that? It&#39;s often considered the most annoying feat of <code>Parsec</code> that you have to explicitly <code>try</code> everything to get backtracking on failure. The biggest reason not to backtrack seems clearer error messages, but Attoparsec doesn&#39;t give those anyway."}, {"owner": {"reputation": 21, "user_id": 7134987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6827932c89d450757ed5a0ec70efb0a?s=128&d=identicon&r=PG&f=1", "display_name": "askoufis", "link": "https://stackoverflow.com/users/7134987/askoufis"}, "edited": false, "score": 1, "creation_date": 1478750364, "post_id": 40503982, "comment_id": 68280858, "body": "I ended up using <a href=\"https://hackage.haskell.org/package/trifecta\" rel=\"nofollow noreferrer\">trifecta</a> instead. Thanks for your help though."}], "owner": {"reputation": 21, "user_id": 7134987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6827932c89d450757ed5a0ec70efb0a?s=128&d=identicon&r=PG&f=1", "display_name": "askoufis", "link": "https://stackoverflow.com/users/7134987/askoufis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1478685016, "creation_date": 1478685016, "question_id": 40503982, "link": "https://stackoverflow.com/questions/40503982/is-there-a-way-to-force-an-attoparsec-not-to-backtrack", "title": "Is there a way to force an attoparsec not to backtrack?", "body": "<p>I've written some parsers using <a href=\"https://hackage.haskell.org/package/attoparsec\" rel=\"nofollow noreferrer\">Attoparsec</a> but only now realised that I don't always want them to backtrack on failure, but attoparsec parsers always backtrack on failure.</p>\n\n<p>Is there a way to force a parser not to backtrack?</p>\n\n<p>For example, this attoparsec parser will succeed when given the input \"for\":</p>\n\n<pre><code>string \"foo\" &lt;|&gt; string \"for\"\n</code></pre>\n\n<p>A parsec parser would not succeed on that input and I want to emulate this behaviour using an attoparsec parser.</p>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1478667550, "post_id": 40500354, "comment_id": 68244452, "body": "Are you sure you don&#39;t mean to have a list of lists? Right now, you have a list of tuples. That aside, there is no generic way in Haskell for extracting elements from tuples given and index. The best you can do there is <code>map (\\(_,_,_,e,_) -&gt; e) x</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1478667667, "post_id": 40500354, "comment_id": 68244474, "body": "so <code>x !! 3</code> will get the third index of <code>x</code>, not the third index of each element of <code>x</code>?  How do you apply a function to each element of a list?"}, {"owner": {"reputation": 33, "user_id": 6199010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b321d3f42aef58e7ff97f31e639e8c3?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn Smith", "link": "https://stackoverflow.com/users/6199010/shawn-smith"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478669305, "post_id": 40500354, "comment_id": 68244845, "body": "@Alec theres no way to go like through each list and get a certain element?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478669490, "post_id": 40500354, "comment_id": 68244891, "body": "@ShawnSmith There is a way to go through <i>lists</i> to get a certain element (it&#39;s the <code>(!!)</code> operator you already found), but you have a list of tuples. Note the difference between <code>(1,2,3,4,5)</code> and <code>[1,2,3,4,5]</code> (try checking out their types in GHCi)."}, {"owner": {"reputation": 33, "user_id": 6199010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b321d3f42aef58e7ff97f31e639e8c3?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn Smith", "link": "https://stackoverflow.com/users/6199010/shawn-smith"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478670076, "post_id": 40500354, "comment_id": 68245054, "body": "@Alec the data I was supplied with was basically like the only I have in the question. It a big list, I just shortened it. Maybe there no way to get that certain element but can we check if let say 6 is in element 3?"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478672116, "post_id": 40500354, "comment_id": 68245623, "body": "@ShawnSmith Is the list you got exactly as you printed it. Or was it perhaps something like [[1,2,3,4,5],[1,2,3,4,5]...]?"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478672322, "post_id": 40500354, "comment_id": 68245678, "body": "And even if we have a list of tuples, we <i>can</i> access the third element of each, but only by manual pattern matching as @Alec mentioned above."}, {"owner": {"reputation": 33, "user_id": 6199010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b321d3f42aef58e7ff97f31e639e8c3?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn Smith", "link": "https://stackoverflow.com/users/6199010/shawn-smith"}, "reply_to_user": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478674748, "post_id": 40500354, "comment_id": 68246475, "body": "@mnoronha it exactly how its printed. and with what alec posted above, what does the  e mean and how would I use it in my question."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1478710296, "post_id": 40500354, "comment_id": 68266071, "body": "If you don&#39;t want to write your own <code>Data.Tuple.Select</code> has all the tuple element selectors you may need."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1478711847, "post_id": 40500354, "comment_id": 68266931, "body": "Note that you may need to install the <code>tuple</code> library to get the <code>Data.Tuple.Select</code> module."}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": false, "score": 7, "last_activity_date": 1478711778, "last_edit_date": 1478711778, "creation_date": 1478675691, "answer_id": 40501722, "question_id": 40500354, "link": "https://stackoverflow.com/questions/40500354/how-to-print-a-certain-element-in-each-list/40501722#40501722", "title": "How to print a certain element in each list", "body": "<p>What you've provided is not actually a list of lists, but a list of tuples. Tuples have a special type based on the number and type of their elements, so the type of your <code>x</code> above is <code>[(Int,Int,Int,Int,Int)]</code>.</p>\n\n<p>Unlike lists, which allow us to extract values by index with the <code>!!</code> operator (ex. <code>[1,2,3] !! 1 = 2</code>), in order to extract specific values from a tuple we must pattern match the entire tuple, giving some name to the value we wish to extract and using it in our return value. To extract the fourth value from a tuple of holding 5 values, we could write a function like this:</p>\n\n<pre><code>f (a,b,c,d,e) = d\n</code></pre>\n\n<p>Or, as an anonymous function (because, if we are only going to use it when mapping over the list, it's nice to not bother assigning it a name):</p>\n\n<pre><code>(\\(a,b,c,d,e) -&gt; d)\n</code></pre>\n\n<p>Since we only care about the fourth value, we can choose to discard all others (you said third but meant index 3 -> 4th term above?):</p>\n\n<pre><code>(\\(_,_,_,x,_) -&gt; x)\n</code></pre>\n\n<p>Now we have a list of such tuples, and we'll want to apply it to each. We can do this with <code>map</code>, which will apply the function to each and return a list of the third value from each tuple:</p>\n\n<pre><code>f xs = map (\\(_,_,_,x,_) -&gt; x) xs\n</code></pre>\n\n<p>Or, with eta-reduction:</p>\n\n<pre><code>f = map (\\(_,_,_,x,_) -&gt; x)\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>gchi&gt;&gt; f [(1,2,3,4,5),(3,4,5,6,6),(5,6,2,1,1),(1,2,5,6,2)]\n[4,6,1,6]\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6199010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b321d3f42aef58e7ff97f31e639e8c3?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn Smith", "link": "https://stackoverflow.com/users/6199010/shawn-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478711778, "creation_date": 1478667208, "last_edit_date": 1478685093, "question_id": 40500354, "link": "https://stackoverflow.com/questions/40500354/how-to-print-a-certain-element-in-each-list", "title": "How to print a certain element in each list", "body": "<p>I'm coding in haskell and want to know how find a certain element in mutiple list.</p>\n\n<p>Here an example let say:</p>\n\n<pre><code>x = [(1,2,3,4,5),\n      (3,4,5,6,6),\n      (5,6,2,1,1),\n      (1,2,5,6,2)];\n</code></pre>\n\n<p>Let say I want to find the 3rd element of each list. </p>\n\n<p>So the program will print out 4,6,1,6</p>\n\n<p>I know about the !! but when I do something like x !! 3, it prints out the third row(1,2,5,6,2).</p>\n\n<p>I want it so it print out the 3rd element of each list. </p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "edited": false, "score": 2, "creation_date": 1478658533, "post_id": 40499316, "comment_id": 68242834, "body": "Don&#39;t upload screenshots of your code; cut-and-paste the code and the error messages into the body of your question."}, {"owner": {"reputation": 43, "user_id": 7134496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ac9a8707442304ba149659c9e01b67?s=128&d=identicon&r=PG&f=1", "display_name": "Aez", "link": "https://stackoverflow.com/users/7134496/aez"}, "reply_to_user": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "edited": false, "score": 1, "creation_date": 1478659654, "post_id": 40499316, "comment_id": 68243020, "body": "Okay thanks for the tip I am new around here sorry for that I edited it"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7134496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ac9a8707442304ba149659c9e01b67?s=128&d=identicon&r=PG&f=1", "display_name": "Aez", "link": "https://stackoverflow.com/users/7134496/aez"}, "edited": false, "score": 0, "creation_date": 1478659871, "post_id": 40499495, "comment_id": 68243060, "body": "Thankyou so much. I am a beginner at this didn&#39;t even know I could do this thanks alot :)"}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": true, "score": 5, "last_activity_date": 1478682486, "last_edit_date": 1478682486, "creation_date": 1478658849, "answer_id": 40499495, "question_id": 40499316, "link": "https://stackoverflow.com/questions/40499316/confused-about-type-class-constraints/40499495#40499495", "title": "Confused about type class constraints", "body": "<p>Because you compare the value output value with the result of <code>averageThreeNumbers</code>, you need to include the <code>Ord</code> constraint on your <code>howManyBelowAverage</code> function. I also think you meant to check if <code>x</code> is less than the function return value (in the code snippets above, you do the opposite).</p>\n\n<p>Amending the constraint and the comparison check, we end up with this:</p>\n\n<pre><code>howManyBelowAverage :: (Ord a, Floating a) =&gt; (a,a,a) -&gt; [a]\nhowManyBelowAverage (b,c,d) = [ x | x &lt;- [b,c,d], x &lt; averageThreeNumbers(b,c,d)]\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7134496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ac9a8707442304ba149659c9e01b67?s=128&d=identicon&r=PG&f=1", "display_name": "Aez", "link": "https://stackoverflow.com/users/7134496/aez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 1, "accepted_answer_id": 40499495, "answer_count": 1, "score": 2, "last_activity_date": 1478741387, "creation_date": 1478657048, "last_edit_date": 1478741387, "question_id": 40499316, "link": "https://stackoverflow.com/questions/40499316/confused-about-type-class-constraints", "title": "Confused about type class constraints", "body": "<p>I am a beginner in Haskell and I am currently confused I am sure it's something to do with the constraints I used I keep getting errors </p>\n\n<h3>The code</h3>\n\n<pre><code>averageThreeNumbers:: Floating a=&gt; (a, a, a) -&gt; a\naverageThreeNumbers (x,y,z) = ((x+y+z)/3)\n\nhowManyBelowAverage:: Floating a=&gt; (a, a, a) -&gt; [a]\nhowManyBelowAverage (b,c,d) = [x|x &lt;- [b,c,d], x &gt; averageThreeNumbers(b,c,d)]\n</code></pre>\n\n<h3>The error</h3>\n\n<pre><code>Could not deduce (Ord a) arising from a use of `&gt;'\nfrom the context: Floating a\nbound by the type signature for:\nhowManyBelowAverage :: Floating a=&gt; (a, a, a) -&gt; [a]\nPossible fix: add (Ord a) to the context of the type signature\n</code></pre>\n\n<p>Although when I use the same list but with raw floats in the console it works just fine. Am I missing something big here? Any help is appreciated.</p>\n\n<p>This compiles fine:</p>\n\n<pre><code>[x|x &lt;- [1.2, 3.2, 4.6], x &gt; averageThreeNumbers (1.2, 3.2, 4.6)]\n</code></pre>\n"}, {"tags": ["haskell", "function-composition"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7134348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380583402015c6ec5eecd5d06745c080?s=128&d=identicon&r=PG&f=1", "display_name": "Johnylikes3thirty", "link": "https://stackoverflow.com/users/7134348/johnylikes3thirty"}, "edited": false, "score": 0, "creation_date": 1480386620, "post_id": 40498897, "comment_id": 68930128, "body": "hey,  shouldnt the answer actually be 9? since its f^n and f = 2+1?"}, {"owner": {"reputation": 167922, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 1, "user_id": 7134348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380583402015c6ec5eecd5d06745c080?s=128&d=identicon&r=PG&f=1", "display_name": "Johnylikes3thirty", "link": "https://stackoverflow.com/users/7134348/johnylikes3thirty"}, "edited": false, "score": 0, "creation_date": 1480386875, "post_id": 40498897, "comment_id": 68930196, "body": "@Johnylikes3thirty: <code>f</code> is not <code>2 + 1</code>. <code>f</code> is the incrementing function, not a number; <code>f^2</code> is &quot;apply <code>f</code> twice&quot;. Incrementing <code>2</code> twice yields <code>4</code>."}], "tags": [], "owner": {"reputation": 167922, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 2, "last_activity_date": 1478653384, "creation_date": 1478653384, "answer_id": 40498897, "question_id": 40498869, "link": "https://stackoverflow.com/questions/40498869/function-composition-in-haskell-to-calculate-power/40498897#40498897", "title": "Function composition in Haskell to calculate Power", "body": "<p>Your line is invalid: <code>2 ((\\x-&gt;x+1) 2)</code> is malformed (as it is equivalent to <code>2 3</code>).</p>\n\n<pre><code>let pow 0 f = (\\x-&gt;x); pow n f = f.(pow (n-1) f) in (pow 2 (\\x -&gt; x + 1)) 2\n</code></pre>\n\n<p>does produce <code>4</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7134348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380583402015c6ec5eecd5d06745c080?s=128&d=identicon&r=PG&f=1", "display_name": "Johnylikes3thirty", "link": "https://stackoverflow.com/users/7134348/johnylikes3thirty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478654205, "creation_date": 1478653135, "last_edit_date": 1478654205, "question_id": 40498869, "link": "https://stackoverflow.com/questions/40498869/function-composition-in-haskell-to-calculate-power", "title": "Function composition in Haskell to calculate Power", "body": "<p>i am trying to write a power function in haskell that calculates f to the power of n, where f is a function itself, using function composition.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>let pow 0 f = (\\x -&gt; x)\n    pow n f = f . (pow (n-1) f) \nin 2 ((\\x -&gt; x+1) 2)\n</code></pre>\n\n<p>I am expecting it to pass the function <em>f(x)=x+1</em> to power function and return the square of the function. I try passing in the value 2 to the <em>f(x)</em> function, so i thought it would return 4</p>\n\n<p>When I run it on haskell.org I get:</p>\n\n<pre><code>:: (Num a, Num (a -&gt; t)) =&gt; t\n</code></pre>\n"}, {"tags": ["haskell", "double", "fold"], "answers": [{"comments": [{"owner": {"reputation": 4545, "user_id": 3901400, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/gvB8O.jpg?s=128&g=1", "display_name": "Marcus Ruddick", "link": "https://stackoverflow.com/users/3901400/marcus-ruddick"}, "edited": false, "score": 0, "creation_date": 1478649686, "post_id": 40498169, "comment_id": 68240912, "body": "Thank you, that did it.. was looking at the haskell wiki and their first example is <code>fold (+) [1, 2, 3, 4, 5]</code> which is a bit misleading I guess"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 4545, "user_id": 3901400, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/gvB8O.jpg?s=128&g=1", "display_name": "Marcus Ruddick", "link": "https://stackoverflow.com/users/3901400/marcus-ruddick"}, "edited": false, "score": 0, "creation_date": 1478716851, "post_id": 40498169, "comment_id": 68269396, "body": "@MarcusRuddick <code>fold</code> is not <code>foldr</code>."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 4545, "user_id": 3901400, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/gvB8O.jpg?s=128&g=1", "display_name": "Marcus Ruddick", "link": "https://stackoverflow.com/users/3901400/marcus-ruddick"}, "edited": false, "score": 0, "creation_date": 1478717306, "post_id": 40498169, "comment_id": 68269623, "body": "@MarcusRuddick That would still be wrong, the typical definition of <code>fold</code>  from <code>Data.Foldable</code> does not take a function parameter.  Where is this &quot;haskell wiki&quot;.  Google has similar code as you show on the one-off haskell-lang.org site (different from haskell.org, which is usually what people mean by &quot;the haskell wiki&quot;) but the -lang site seems to have deleted their wiki.  If you can point out the resource then we can work to fix it."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1478833718, "post_id": 40498169, "comment_id": 68320297, "body": "Ah, it says explicitly &quot;a hypothetical function&quot;."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 4, "last_activity_date": 1478647684, "creation_date": 1478647684, "answer_id": 40498169, "question_id": 40498107, "link": "https://stackoverflow.com/questions/40498107/how-do-i-foldr-a-list-of-type-double/40498169#40498169", "title": "How do I foldr a list of type Double?", "body": "<blockquote>\n  <p>Probable cause: \u2018foldr\u2019 is applied to too few arguments</p>\n</blockquote>\n\n<p>It's because <code>foldr</code> is applied to too few arguments.  Observed:</p>\n\n<pre><code>foldr (+) [3.3, 1.4, 5.5]\n--     one  two\n</code></pre>\n\n<p>But:</p>\n\n<pre><code>:type foldr\nFoldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\n--              one            two  three\n</code></pre>\n\n<p>You are missing an argument of type <code>b</code>.  In this case you appear to want a sum so perhaps you'd like to start your fold using zero as the accumulator:</p>\n\n<pre><code>foldr (+) 0 ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4545, "user_id": 3901400, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/gvB8O.jpg?s=128&g=1", "display_name": "Marcus Ruddick", "link": "https://stackoverflow.com/users/3901400/marcus-ruddick"}, "edited": false, "score": 0, "creation_date": 1478649581, "post_id": 40498313, "comment_id": 68240889, "body": "thank you, I just posted the hard coded version as an example... actual code is more complex and is indeed passed a varable list of doubles"}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": false, "score": 2, "last_activity_date": 1478650784, "last_edit_date": 1478650784, "creation_date": 1478648690, "answer_id": 40498313, "question_id": 40498107, "link": "https://stackoverflow.com/questions/40498107/how-do-i-foldr-a-list-of-type-double/40498313#40498313", "title": "How do I foldr a list of type Double?", "body": "<p>The <code>foldr</code> function has type <code>Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b</code> which includes includes three arguments (<code>(a -&gt; b -&gt; b)</code>,<code>b</code>,<code>t a</code>) while you've only included two arguments. We can rewrite <code>foldDoubles</code> to hold our computed fold for the single hardcoded list by adding a base case of type <code>b</code> to fix this mistake:</p>\n\n<pre><code>foldDouble = foldr (+) 0 [3.3, 1.4, 5.5]\n</code></pre>\n\n<p>But let's look a bit further. Instead of hardcoding the list <code>[3.3, 1.4, 5.5]</code>, we can make a general purpose function that accepts a list and returns it's sum (this is just the sum function):</p>\n\n<pre><code>foldDouble xs = foldr (+) 0 xs\n</code></pre>\n\n<p>Which we can use on general lists just like our Prelude-defined sum function:</p>\n\n<pre><code>ghci&gt;&gt; foldDouble [3.3, 1.4, 5.5]\n10.2\n</code></pre>\n\n<p>Next, we can eta-reduce this go get a slightly cleaner form:</p>\n\n<pre><code>foldDouble = foldr (+) 0\n</code></pre>\n\n<p>Lastly, there's a handy function <code>foldr1</code> that allows us to get rid of our base case (the last element in the list is presumed to be the base case instead). Using this function, we can get rid of the <code>0</code>:</p>\n\n<pre><code>foldDouble = foldr1 (+)\n</code></pre>\n"}], "owner": {"reputation": 4545, "user_id": 3901400, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/gvB8O.jpg?s=128&g=1", "display_name": "Marcus Ruddick", "link": "https://stackoverflow.com/users/3901400/marcus-ruddick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "accepted_answer_id": 40498169, "answer_count": 2, "score": 0, "last_activity_date": 1478650784, "creation_date": 1478647302, "question_id": 40498107, "link": "https://stackoverflow.com/questions/40498107/how-do-i-foldr-a-list-of-type-double", "title": "How do I foldr a list of type Double?", "body": "<p>I have some code I am writing and I need to fold a list of doubles, however, even this simple line of code gives me errors I dont understand, namely:</p>\n\n<pre><code>Couldn't match expected type \u2018Double\u2019\n            with actual type \u2018t0 [t1] -&gt; [t1]\u2019\nProbable cause: \u2018foldr\u2019 is applied to too few arguments\nIn the expression: foldr (+) [3.3, 1.4, 5.5]\nIn an equation for \u2018foldDoubles\u2019:\n    foldDoubles = foldr (+) [3.3, 1.4, 5.5]\n</code></pre>\n\n<p>for a simple example of:</p>\n\n<blockquote>\n  <p>foldDoubles = foldr (+) [3.3, 1.4, 5.5]</p>\n</blockquote>\n\n<p>examples for integers are the in the same format so I dont understand why there would be \"too few arguments\", do I need to do some kind of conversion?</p>\n"}, {"tags": ["haskell", "reflex"], "comments": [{"owner": {"reputation": 3188, "user_id": 590347, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca28027d24f8a5aacd4d9d9098a09b5?s=128&d=identicon&r=PG", "display_name": "Bartosz", "link": "https://stackoverflow.com/users/590347/bartosz"}, "edited": false, "score": 3, "creation_date": 1478681074, "post_id": 40497229, "comment_id": 68248781, "body": "My answer would be: either the widgets are small enough that performance does not matter, or you need to implement dyn/widgetHold equivalents that use <code>virtual-dom</code> for performant rendering. But I&#39;d like someone more knowledgeable to answer on this so I&#39;m just leaving a comment."}], "answers": [{"tags": [], "owner": {"reputation": 635, "user_id": 860338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/782e20b78bb80f4207cbea38f88c922a?s=128&d=identicon&r=PG", "display_name": "ImAlsoGreg", "link": "https://stackoverflow.com/users/860338/imalsogreg"}, "is_accepted": false, "score": 0, "last_activity_date": 1488766069, "creation_date": 1488766069, "answer_id": 42616450, "question_id": 40497229, "link": "https://stackoverflow.com/questions/40497229/how-can-i-efficiently-branch-on-the-value-inside-a-reflex-dynamic/42616450#42616450", "title": "How can I efficiently branch on the value inside a Reflex.Dynamic?", "body": "<p>The answer depends on exactly what your goals and requirements are. If you want the best possible dom sharing, derived from two separate functions <code>renderState1</code> and <code>renderState2</code>, I think that calls for <code>virtual-dom</code>.</p>\n\n<p>But it actually sounds like you want to have some precise control over what gets added to the DOM when.</p>\n\n<p>Something simple you can do, if you have modified versions of <code>renderState1</code> and <code>renderState2</code> in hand that each take a <code>Maybe State1</code> or <code>Maybe State2</code> argument is to build a pair of these dynamic maybes and use css attributes to hide one or the other:</p>\n\n<pre><code>let mState1 = (\\c -&gt; case c of\n                  s@(State1 _ _) -&gt; Just s\n                  _              -&gt; Nothing\n              ) &lt;$&gt; dynMyState\n    mState2 = (\\c -&gt; case c of\n                  s@(State2 _ _ _) -&gt; Just s\n                  _                -&gt; Nothing\n    nothingHider a m =\n       let atr = bool mempty (\"style\" =: \"displayNone\") . isJust &lt;$&gt; a\n       in  elDynAttr \"div\" atr (m a)\n\nnothingHider mState1 renderMaybeState1\nnothingHider mState2 renderMaybeState2\n</code></pre>\n\n<p>If you <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-TH.html#v:makePrisms\" rel=\"nofollow noreferrer\">derive Prisms</a> then a lot of the awkwardness can be gotten rid of.</p>\n"}], "owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1488766069, "creation_date": 1478642710, "last_edit_date": 1495540439, "question_id": 40497229, "link": "https://stackoverflow.com/questions/40497229/how-can-i-efficiently-branch-on-the-value-inside-a-reflex-dynamic", "title": "How can I efficiently branch on the value inside a Reflex.Dynamic?", "body": "<p>Let's say I have some application state, maintained on some backend system. It looks like this</p>\n\n<pre><code>data MyState = State1 MyState1 | State2 MyState2\n\ndata MyState1 = MyState1 { ms1_text :: Text, ms1_int :: Int }\ndata MyState2 = MyState2 { ms2_bool :: Bool, ms2_maybe_char :: Maybe Char }\n</code></pre>\n\n<p>I also have a function to get the latest state from the backend system</p>\n\n<pre><code>getLatestState :: IO MyState\n</code></pre>\n\n<p>I'm pretty sure I can figure out how to package that up into a Dynamic by repeatedly querying the backend, so that I have</p>\n\n<pre><code>dynMyState :: MonadWidget t m =&gt; Dynamic t MyState\n</code></pre>\n\n<p>I want to render this to html. I want each part of the datastructure to render to a div. However, things that don't exist shouldn't be rendered at all - so, when <code>ms2_maybe_char</code> is <code>Nothing</code>, there should be no div for it, and when <code>MyState</code> is a <code>State1</code>, there should be no div for the <code>State2</code>.</p>\n\n<p>a couple examples for clarity:</p>\n\n<pre><code>State1 (MyState1 \"foo\" 3)\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>&lt;div class=MyState1&gt;\n    &lt;div&gt;foo&lt;/div&gt;\n    &lt;div&gt;3&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>State2 (MyState2 False Nothing)\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>&lt;div class=MyState2&gt;\n    &lt;div&gt;False&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Ideally, each part of the DOM should only be modified if necessary - so if <code>ms2_maybe_char</code> changes from <code>Nothing</code> to <code>Just 'a'</code>, then a new div needs to be created. Or if <code>ms1_text</code> changes from <code>\"foo\"</code> to <code>\"bar\"</code>, then we need to change that string in the DOM. However, changing <code>ms1_text</code> should never cause the sibling or parent nodes to be redrawn.</p>\n\n<p>How should I structure my code? Is this even possible, given the <code>getLatestState</code> api as a building block? Am I entirely missing the point of Reflex by trying to build off of a single <code>Dynamic</code> value, and I need to rethink my approach?</p>\n\n<p>In particular, the very first stumbling block is that I can't easily inspect the Dynamic to know if it contains a State1 or a State2. I could potentially use <code>dyn</code> or <code>widgetHold</code> here, and <code>fmap</code> a function over <code>dynMyState</code> which can treat the state as a simple value and generate a <code>m ()</code> action that draws the whole thing. But, then I lose all sharing - the entire UI will be redrawn from scratch on every single state change.</p>\n\n<p>Note: this is a more detailed followup question to <a href=\"https://stackoverflow.com/questions/40481916/how-can-i-branch-on-the-value-inside-a-reflex-dynamic/40482715#40482715\">How can I branch on the value inside a Reflex Dynamic?</a>. What's different/clearer about this question is the additional desire to not lose efficient updates of everything inside the inspected value. Thanks to everyone who helped on that question as well!</p>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1478658232, "post_id": 40497225, "comment_id": 68242763, "body": "This is totally doable using template Haskell. One would just need to use the approach mentioned by @dfeuer (ie. using a <code>case</code> instead of <code>GHC.Read.choose</code>)."}, {"owner": {"reputation": 1747, "user_id": 343761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cf716ff342bad8a3aa8178ab9b39366d?s=128&d=identicon&r=PG", "display_name": "homam", "link": "https://stackoverflow.com/users/343761/homam"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478699045, "post_id": 40497225, "comment_id": 68258979, "body": "@Alec do you know any example / tutorial for deriving <code>Read</code> instances with template Haskell?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478707371, "post_id": 40497225, "comment_id": 68264352, "body": "<a href=\"https://wiki.haskell.org/Template_haskell/Instance_deriving_example\" rel=\"nofollow noreferrer\">This</a> looks good."}], "answers": [{"comments": [{"owner": {"reputation": 1747, "user_id": 343761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cf716ff342bad8a3aa8178ab9b39366d?s=128&d=identicon&r=PG", "display_name": "homam", "link": "https://stackoverflow.com/users/343761/homam"}, "edited": false, "score": 0, "creation_date": 1478789538, "post_id": 40498140, "comment_id": 68300877, "body": "<code>dependent-sum</code> is an interesting lib. But from its <a href=\"https://github.com/mokus0/dependent-sum/blob/master/examples/FooGADT.hs#L72\" rel=\"nofollow noreferrer\">examples</a> it seems that I still have to define <code>GRead</code> instances (and write some boilerplate for each constructor of the <code>tag</code> type)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1747, "user_id": 343761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cf716ff342bad8a3aa8178ab9b39366d?s=128&d=identicon&r=PG", "display_name": "homam", "link": "https://stackoverflow.com/users/343761/homam"}, "edited": false, "score": 0, "creation_date": 1478805788, "post_id": 40498140, "comment_id": 68310511, "body": "@homam, yes, the <code>DSum</code> approach just imposes a certain structure on the instances; it&#39;s not going to win you much if anything unless you want to use related tools. I just figured it would be worth mentioning."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 6, "last_activity_date": 1478723375, "last_edit_date": 1478723375, "creation_date": 1478647528, "answer_id": 40498140, "question_id": 40497225, "link": "https://stackoverflow.com/questions/40497225/deriving-read-instances-for-gadts/40498140#40498140", "title": "Deriving Read Instances for GADTs", "body": "<p>I don't know of a generic solution. That said, it's a lot easier to write <code>Read</code> instances by defining the <code>readPrec</code> method (see <code>Text.Read</code> especially, <code>Text.ParserCombinators.ReadPrec</code> for some extra functions, and maybe <code>Text.ParserCombinators.ReadP</code> for even more) instead of using <code>Parsec</code> or defining <code>readsPrec</code>. This isn't the absolute fastest you could write, but it should be reasonably fast.</p>\n\n<pre><code>import Text.Read\n\ninstance Read Bar where\n  readListPrec = readListPrecDefault\n\n  readPrec = parens $ do\n    Ident \"Bar\" &lt;- lexP\n    Ident td &lt;- parens lexP\n    case td of\n      \"TypeDecInt\" -&gt; Bar TypeDecInt &lt;$&gt; readPrec\n      \"TypeDecString\" -&gt; Bar TypeDecString &lt;$&gt; readPrec\n      _ -&gt; empty\n</code></pre>\n\n<p>If <code>TypeDec</code> is more complicated, and you have <code>Read</code> instances for <code>TypeDec Int</code> and <code>TypeDec String</code> (using <code>FlexibleInstances</code> or an auxiliary class), then you'll likely want something more modular:</p>\n\n<pre><code>instance Read Bar where\n  readListPrec = readListPrecDefault\n  readPrec = parens $ do\n    Ident \"Bar\" &lt;- lexP\n    (Bar &lt;$&gt; readPrec &lt;*&gt; (readPrec :: ReadPrec Int))\n       &lt;|&gt; (Bar &lt;$&gt; readPrec &lt;*&gt; (readPrec :: ReadPrec String))\n</code></pre>\n\n<p>Note that in the second example, GHC can't figure out by itself what types the alternatives should have, but when we fix the type of the second field, inference propagates that to the first field. So in the first alternative, we'll only look for <code>\"TypeDecInt\"</code> and in the second one we'll only look for <code>\"TypeDecString\"</code>.</p>\n\n<hr>\n\n<p>The <code>dependent-sum</code> package defines a type that generalizes your <code>Bar</code>.</p>\n\n<pre><code>data DSum tag f = forall a . !(tag a) :=&gt; f a\n</code></pre>\n\n<p>It also defines a <code>Read</code> instance for <code>DSum</code> using some extra classes. The general approach looks solid, but I'd recommend two changes. The first is to use <code>ReadPrec</code> instead of fussing with lists. The second is to replace the higher-rank <code>GReadResult</code> type with the following (much simpler) existential one:</p>\n\n<pre><code>data GReadResult t = forall a . GReadResult (t a)\n</code></pre>\n\n<p>Of course, these changes will force you to implement it yourself, but that's okay.</p>\n"}], "owner": {"reputation": 1747, "user_id": 343761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cf716ff342bad8a3aa8178ab9b39366d?s=128&d=identicon&r=PG", "display_name": "homam", "link": "https://stackoverflow.com/users/343761/homam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1478723375, "creation_date": 1478642689, "last_edit_date": 1478645373, "question_id": 40497225, "link": "https://stackoverflow.com/questions/40497225/deriving-read-instances-for-gadts", "title": "Deriving Read Instances for GADTs", "body": "<p>How can I automatically derive a <code>Read</code> instance for this GADTs:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE GADTs, StandaloneDeriving #-}\n\ndata TypeDec a where\n  TypeDecInt    :: TypeDec Int\n  TypeDecString :: TypeDec String\n\nderiving instance Show (TypeDec a)\n\ndata Bar where\n  Bar :: (Show a, Read a) =&gt; TypeDec a -&gt; a -&gt; Bar\n\nderiving instance Show Bar\n</code></pre>\n\n<p>The idea is that <code>Bar</code> is a serializable type.</p>\n\n<p>I can write a <code>Read</code> instance by the following snippet or by Parsec, but considering that I have many similar types to <code>TypeDec</code> and <code>Bar</code> in different modules this is a boilerplate:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Read Bar where\n  readsPrec _ s =\n    let (bar, tup) = second breaks . breaks $ s\n    in if \"Bar\" == bar then uncurry parse tup else []\n    where\n      parse :: String -&gt; String -&gt; [(Bar, String)]\n      parse tdec = case tdec of\n        \"TypeDecInt\"    -&gt; parse' TypeDecInt\n        \"TypeDecString\" -&gt; parse' TypeDecString\n        _               -&gt; const []\n\n      parse' :: (Show a, Read a) =&gt; TypeDec a -&gt; String -&gt; [(Bar, String)]\n      parse' tdec s = [(Bar tdec (read s), \"\")]\n\n      breaks :: String -&gt; (String, String)\n      breaks = second (drop 1) . break (== ' ')\n</code></pre>\n"}, {"tags": ["haskell", "monads", "state-monad"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478640838, "post_id": 40496367, "comment_id": 68237732, "body": "Well what do you expect the monad to do? I don&#39;t think you can make this type into a monad."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1478641005, "post_id": 40496367, "comment_id": 68237794, "body": "Really, the approach is backwards. You should start with the behavior you want, then write down the type you need to implement it. My phrase &quot;make this type into a monad&quot; is a bad one."}, {"owner": {"reputation": 348, "user_id": 2804432, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/96745a610219cefeaac7d6914f526bfc?s=128&d=identicon&r=PG", "display_name": "Rich_Rich", "link": "https://stackoverflow.com/users/2804432/rich-rich"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478641427, "post_id": 40496367, "comment_id": 68237976, "body": "The behaviour I want is to chain functions like this together (semantically seen):  <code>exmpl :: Int -&gt; StdGen -&gt; ([Int], StdGen) exmpl x gen = [y | y &lt;- [x - 3 .. x + randomR (1, 10) gen]</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1478642229, "post_id": 40496367, "comment_id": 68238320, "body": "<code>f :: a -&gt; ST a b</code>, but <code>x :: [a]</code>. You can&#39;t apply <code>f</code> to <code>x</code>, so you either have to pick an element (which one?) or apply it to some or all of the elements and figure out what to do with all the resulting <code>ST a b</code> values."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1478643066, "post_id": 40496367, "comment_id": 68238733, "body": "But what does it <i>mean</i> to &quot;chain functions like [...] together&quot;? If you understood what you meant by that, you&#39;d have no trouble writing <code>(&gt;&gt;=)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1478644345, "post_id": 40497431, "comment_id": 68239258, "body": "<code>newtype ST&#39; a = ST&#39; { runST&#39; :: State -&gt; [(a, State)] }</code> (no brackets on the RHS <code>a</code>)?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1478722367, "post_id": 40497431, "comment_id": 68272048, "body": "isn&#39;t it quite natural to process <code>fs :: [State -&gt; ([b], State)]</code> with <code>g (f:fs) s = let {(bs,s2) = f s ; (rs,sn) = g fs s2} in (bs++rs,sn) ; g [] s = ([],s)</code>?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1478723405, "post_id": 40497431, "comment_id": 68272563, "body": "@WillNess, ah, it&#39;s like &quot;<code>concatM</code>&quot;, very interesting.  I wonder if this leads to <code>ST</code> being a monad."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1478728482, "post_id": 40497431, "comment_id": 68275003, "body": "more like <code>msum</code> applied to <code>map f as</code>, if we define <code>ST f &lt;|&gt; ST g = ST $ \\s -&gt; let (a, r) = f s; (b, q) = g r in (a ++ b, q)</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1478731537, "post_id": 40497431, "comment_id": 68276148, "body": "@WillNess, aka <code>(&lt;|&gt;) = liftM2 (++)</code> in <code>State</code> (modulo newtyping)"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 5, "last_activity_date": 1478722360, "last_edit_date": 1478722360, "creation_date": 1478643698, "answer_id": 40497431, "question_id": 40496367, "link": "https://stackoverflow.com/questions/40496367/state-monad-containing-random-and-list-in-haskell/40497431#40497431", "title": "State Monad containing Random and List in Haskell", "body": "<p>Let's be careful to keep track of all the types (I do this myself when I'm writing tricky code).  First let's add an accessor for your ST type which will make things easier. </p>\n\n<pre><code>newtype ST a = ST { runST :: State -&gt; ([a], State) }\n</code></pre>\n\n<p>Now we have <code>runST :: ST a -&gt; State -&gt; ([a], State)</code>.  When defining monad code, I like to immediately apply <code>runST</code> to all <code>ST</code> values, so I know what types I am really working with.</p>\n\n<pre><code>st &gt;&gt;= f = ST $ \\s -&gt;\n    -- runST st  :: State -&gt; ([a], State)\n    -- f         :: a -&gt; ST b\n    -- runST . f :: a -&gt; State -&gt; ([b], State)\n    -- s         :: State\n    let (as, s') = runST st s in  -- I renamed x to as for readability\n    -- as        :: [a]\n    -- s'        :: State\n</code></pre>\n\n<p>Now we need a <code>([b], State)</code>.  We can get <code>b</code>s by using <code>f</code>.  We have a list of <code>a</code>s so let's try mapping</p>\n\n<pre><code>    -- map (runST . f) as :: [State -&gt; ([b], State)]\n</code></pre>\n\n<p>Hmm, that's not so useful, let's try applying the state we have coming in, too:</p>\n\n<pre><code>    -- map (\\a -&gt; runST (f a) s) as :: [([b], State)]\n</code></pre>\n\n<p>Maybe we can work with this. We have a list of lists of <code>b</code>, and some other stuff.  Let's name this <code>rs</code> (for \"results\"):</p>\n\n<pre><code>    let rs = map (\\a -&gt; runST (f a) s) as in\n</code></pre>\n\n<p>Now we can get a list of <code>b</code>s by concatenating all the result bs:</p>\n\n<pre><code>    let bs = concat (map fst rs) in  -- bs :: [b]\n</code></pre>\n\n<p>So that presumably is what we want to return.  Now which <code>State</code> do we want to go with it?  We have a problem because we have a lot of different <code>State</code>s to choose from.  Do we pick the last one in the list, or the first one?  If the list is empty maybe we just return the <code>State</code> that came in.  These are arbitrary choices -- as a physics professor of mine once said: \"now we have to make a choice, which is a problem, because we're about to make the wrong one\".  This is very much true in functional programming; whenever you have to make an arbitrary choice like this, you're probably messing up.</p>\n\n<p>If we take a step back and think about the meaning intuitively, an <code>ST a</code> computation takes a state and returns a list of choices with a new state to use for future calculations, <em>each of which</em> will produce a list of choices and a new state.  We can combine all the lists together using <code>concat</code>, but we don't have a way to combine all the states together into one.  With the random API we don't have this (we could imagine maybe <code>bitxor</code>ing together all the states...).  </p>\n\n<p>Without a way to combine the states, our monad bind will have to forget most of the data it has, which is a decent sign that it's not going to obey the laws (though with a monad this complicated I fear the complexity of proving the laws).  And as far as I know there is no monad with this type.</p>\n\n<p>There <em>is</em> a monad with <em>this</em> type:</p>\n\n<pre><code>newtype ST' a = ST' { runST' :: State -&gt; [(a, State)] }\n</code></pre>\n\n<p>And it is equivalent to <code>StateT State []</code>.  Now each branch of the computation comes with its own random state, so we don't need to combine many states into one anymore.  You might have better luck defining this monad -- do as I did and write down the types of everything you know, and try to get to what you need in a type-directed way.  Try not to \"forget\" any information, and strive to use each input exactly once in constructing the output.</p>\n\n<p>Sorry, this post was a bit vague and rambly -- I realize that I use a lot of intuitive principles when defining monads and I thought I'd try to share them.  Remember, it's not enough to get definitions that type check (though that does get you a lot of the way there): check the laws, too, otherwise you will get weird stuff happening when you go to use <code>do</code> notation and the like.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1478724214, "last_edit_date": 1495540795, "creation_date": 1478724214, "answer_id": 40515698, "question_id": 40496367, "link": "https://stackoverflow.com/questions/40496367/state-monad-containing-random-and-list-in-haskell/40515698#40515698", "title": "State Monad containing Random and List in Haskell", "body": "<p>Following <a href=\"https://stackoverflow.com/a/40497431/849891\">luqui's lead</a>, we get</p>\n\n<pre><code>st &gt;&gt;= f = ST (g . runST st)\n    -- runST st  :: State -&gt; ([a], State)\n    -- f         :: a -&gt; ST b\n    -- runST . f :: a -&gt; State -&gt; ([b], State)\n\n    where\n        g (a:as,s) = let  (bs, s2) = (runST . f) a s \n                          (rs, sn) = g (as, s2)\n                     in   (bs ++ rs, sn) \n        g ([], s)  = ([], s) \n</code></pre>\n\n<p>(not tested).</p>\n"}], "owner": {"reputation": 348, "user_id": 2804432, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/96745a610219cefeaac7d6914f526bfc?s=128&d=identicon&r=PG", "display_name": "Rich_Rich", "link": "https://stackoverflow.com/users/2804432/rich-rich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 40497431, "answer_count": 2, "score": 7, "last_activity_date": 1478724214, "creation_date": 1478639015, "question_id": 40496367, "link": "https://stackoverflow.com/questions/40496367/state-monad-containing-random-and-list-in-haskell", "title": "State Monad containing Random and List in Haskell", "body": "<p>As I'm learning for my exam Functional Programming, I'm still trying to really <em>understand</em> Monads. What better way than to define one yourself? I defined this:</p>\n\n<pre><code>newtype ST a = ST (State -&gt; ([a], State))\ntype State = StdGen\n</code></pre>\n\n<p>Basically a List Monad and a Random Monad in one.\nThis monad should enable you to work with random functions and lists.\nNow comes the trouble because I was able to define the <code>return</code> function, however <code>&gt;&gt;=</code> does not quite do the trick. </p>\n\n<pre><code>instance Monad ST where\n    return a = ST $ \\g -&gt; ([a], g)\n    -- M a -&gt; (a -&gt; M b) -&gt; M b\n    st &gt;&gt;= f  = ST $ \\s -&gt; \n                let (x,s') = st s \n                in (f x) s'\n</code></pre>\n\n<p>Code is inspired from <a href=\"http://www.staff.science.uu.nl/~hage0101/FP-elec.pdf\" rel=\"noreferrer\" title=\"page 218\">This paper p.218</a></p>\n\n<p>Any explanations?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "owner": {"reputation": 1525, "user_id": 546591, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/33RTK.jpg?s=128&g=1", "display_name": "James Koppel", "link": "https://stackoverflow.com/users/546591/james-koppel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1478635827, "creation_date": 1478635827, "question_id": 40495548, "link": "https://stackoverflow.com/questions/40495548/stack-exec-keeps-running-git-clone", "title": "stack exec keeps running &quot;git clone", "body": "<p>I have a script running which is going to \"stack exec\" my program over a large number of test files. In my logs, I intermittently start seeing things like this appearing:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Running /usr/bin/git clone --recursive git@github.com:dvekeman/language-java.git \"/Users/jkoppel/Dropbox (MIT)/research/compstrat/languages/.stack-work/downloaded/DD9RxfiWfxTw\" in directory /Users/jkoppe\\\r\nl/Dropbox (MIT)/research/compstrat/languages/.stack-work/downloaded/ exited with ExitFailure 128\r\n\r\n\r\nCloning into '/Users/jkoppel/Dropbox (MIT)/research/compstrat/languages/.stack-work/downloaded/DD9RxfiWfxTw'...\r\nfatal: unable to open /Users/jkoppel/Dropbox (MIT)/research/compstrat/languages/.stack-work/downloaded/DD9RxfiWfxTw/.git/objects/pack/tmp_pack_aTga2a: No such file or directory\r\nfatal: index-pack failed</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I do have <code>git@github.com:dvekeman/language-java.git</code> as a dependency in my <code>stack.yaml</code>, but the program is already built. Why does it keep doing this, and how do I make it stop?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1478639070, "creation_date": 1478639070, "answer_id": 40496379, "question_id": 40495530, "link": "https://stackoverflow.com/questions/40495530/executing-external-proccess-in-haskell-inmain-io/40496379#40496379", "title": "executing external proccess in haskell in`main :: IO ()`", "body": "<p>Use the <a href=\"https://hackage.haskell.org/package/process-1.4.2.0/docs/System-Process.html\" rel=\"nofollow noreferrer\"><code>System.Process</code></a> module. An example:</p>\n\n<pre><code>import System.Process\n\nmain = do\n    putStrLn \"before executing\"\n    createProcess (proc \"java\" [\"-jar\", \"my.jar\"])\n    putStrLn \"after executing\"\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 40496379, "answer_count": 1, "score": 0, "last_activity_date": 1478639070, "creation_date": 1478635738, "question_id": 40495530, "link": "https://stackoverflow.com/questions/40495530/executing-external-proccess-in-haskell-inmain-io", "title": "executing external proccess in haskell in`main :: IO ()`", "body": "<p>I have a function of type:<br>\n<code>main :: IO ()</code>.<br>\nI would like to execute external process, something like that:   </p>\n\n<pre><code>main :: IO ()\nmain = do\n  putStln  \"before executing\"\n  execute \"java -jar my.jar\"\n  putStln \"after executing\"  \n</code></pre>\n\n<p>How to do it ?</p>\n"}, {"tags": ["haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1478636091, "post_id": 40495400, "comment_id": 68235361, "body": "I don&#39;t know what your <code>hyp</code> looks like, but you could try <code>c == fromIntegral (round c)</code> in the last statement of the comprehension"}, {"owner": {"reputation": 100, "user_id": 4206409, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000309454768/picture?type=large", "display_name": "Zachary Bechhoefer", "link": "https://stackoverflow.com/users/4206409/zachary-bechhoefer"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1478636657, "post_id": 40495400, "comment_id": 68235655, "body": "That was it, thanks so much! I&#39;ll just have to look into the role of fromIntegral before moving forward."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1478683954, "last_edit_date": 1478683954, "creation_date": 1478637061, "answer_id": 40495862, "question_id": 40495400, "link": "https://stackoverflow.com/questions/40495400/haskell-functions-in-list-comprehensions/40495862#40495862", "title": "Haskell: Functions in list comprehensions", "body": "<p>First of all, include necessary definitions in a question like this.</p>\n\n<pre><code>hyp :: Floating a =&gt; a -&gt; a -&gt; a\nhyp a b = sqrt $ a^2 + b^2\n</code></pre>\n\n<p>Now. <em>You can \u201cembed\u201d functions all right in list comprehensions</em>. Apparently you just chose some unfortunate ones! <code>round</code> has the following type:</p>\n\n<pre><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :t round\nround :: (Integral b, RealFrac a) =&gt; a -&gt; b\n</code></pre>\n\n<p>So, for <code>round c == c</code> to make sense, you'd need to have a number type that's both an instance of <code>Integral</code> and of <code>RealFrac</code>. In other words, this type would contain fractions, yet all its elements would be integers<sup>\u2020</sup>. Well, you can't have your cake and eat it too!</p>\n\n<p>This problem would have been much more evident, like so often in Haskell, if you had actually written out some type signatures. While fooling around like that, it often helps to just select some simple example type. Perhaps the most reasonable thing would seem:</p>\n\n<pre><code>Prelude&gt; [ c | a &lt;- [1..3], b &lt;- [1..4], let c = hyp a b, c == round c] :: [Integer]\n&lt;interactive&gt;:6:41:\n    No instance for (Floating Integer) arising from a use of \u2018hyp\u2019\n    In the expression: hyp a b\n    In an equation for \u2018c\u2019: c = hyp a b\n    In the expression:\n        [c |\n           a &lt;- [1 .. 3], b &lt;- [1 .. 4], let c = hyp a b, c == round c] ::\n          [Integer]\n</code></pre>\n\n<p>Ok, so <code>Integer</code> doesn't work because you're trying to do real arithmetic, with those square roots in <code>hyp</code>. This is not possible with <code>Integer</code>, you need a <code>Floating</code> type like <code>Double</code>. Let's try that:</p>\n\n<pre><code>Prelude&gt; [ c | a &lt;- [1..3], b &lt;- [1..4], let c = hyp a b, c == round c] :: [Double]\n\n&lt;interactive&gt;:8:55:\n    No instance for (Integral Double) arising from a use of \u2018round\u2019\n    In the second argument of \u2018(==)\u2019, namely \u2018round c\u2019\n    In the expression: c == round c\n    In a stmt of a list comprehension: c == round c\n</code></pre>\n\n<p>Ok, this is because as I said, <code>round</code> always gives integral-type results. However, you can always convert such an integral type to a <code>Double</code> again:</p>\n\n<pre><code>Prelude&gt; [ c | a &lt;- [1..3], b &lt;- [1..4], let c = hyp a b, c == fromIntegral (round c)] :: [Double]\n[5.0]\n</code></pre>\n\n<p>Note that this is not really a good solution though: you don't really want the result to be floating point if you go already check that the elements are really integral! I'd recommend in this case not just evaluating <code>hyp</code> as such at all. Better use this comprehension:</p>\n\n<pre><code>Prelude&gt; [ c | a &lt;- [1..3], b &lt;- [1..4], let c\u00b2 = a^2 + b^2; c = round . sqrt $ fromIntegral c\u00b2, c^2==c\u00b2] :: [Integer]\n[5]\n</code></pre>\n\n<p>One big argument for this version is that it does the comparison in <code>Integer</code>, not in <code>Double</code>. Floating-point equality comparison is something you should best stay away from entirely if you can help it; in this case it's <em>mostly</em> harmless because the interesting thing is the integer subset, which can in fact be represented exactly (unlike decimal fractions like <code>0.1</code>). Still you ca get wrong results this way: in particular, for sufficiently large floating-point numbers, <code>c == fromInteger (round c)</code> will <em>always</em> be true, because above a certain threshold all values are integral after all.</p>\n\n<pre><code>Prelude&gt; [ c | a &lt;- take 4 [1000000000000..], b &lt;- take 5 [1000000000000..], let c = hyp a b, c == fromIntegral (round c)] :: [Float]\n[1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12,1.4142135e12]\n</code></pre>\n\n<p>But none of these are actually correct integral hypothenuses, as you can see with the version that does the comparison in <code>Integer</code>:</p>\n\n<pre><code>Prelude&gt; [ c | a &lt;- take 4 [1000000000000..], b &lt;- take 5 [1000000000000..], let c\u00b2 = a^2 + b^2; c = round . sqrt $ fromIntegral c\u00b2, c^2==c\u00b2] :: [Integer]\n[]\n</code></pre>\n\n<p>Strictly speaking, this improved version is also not safe though \u2013 it doesn't give false positives, but may not find actual Pythagorean triples because the lossy floating-point steps can already destroy equality. To do it real properly, you need an all-integral</p>\n\n<pre><code>intSqrt :: Integral a =&gt; a -&gt; Maybe a\n</code></pre>\n\n<p>This could probably done quite efficiently by taking the float <code>sqrt</code> as a starting value for a few rounds of pseudo <a href=\"https://en.wikipedia.org/wiki/Newton-Raphson_method\" rel=\"nofollow noreferrer\">Newton-Raphson</a> in integer arithmetic.</p>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>In principle, the <code>round</code> function could also have a more relaxed signature.</sub></p>\n\n<pre><code>round' :: (Num b, RealFrac a) =&gt; a -&gt; b\nround' = fromInteger . round\n</code></pre>\n\n<p><sub>With that version, your original code would work.</sub></p>\n"}], "owner": {"reputation": 100, "user_id": 4206409, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000309454768/picture?type=large", "display_name": "Zachary Bechhoefer", "link": "https://stackoverflow.com/users/4206409/zachary-bechhoefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 854, "favorite_count": 0, "accepted_answer_id": 40495862, "answer_count": 1, "score": 1, "last_activity_date": 1478683954, "creation_date": 1478635217, "question_id": 40495400, "link": "https://stackoverflow.com/questions/40495400/haskell-functions-in-list-comprehensions", "title": "Haskell: Functions in list comprehensions", "body": "<p>I am teaching myself Haskell, and playing with list comprehensions. I wrote this list comprehension:</p>\n\n<pre><code>[ c | a &lt;- [1..3], b &lt;- [1..4], let c = hyp a b, c == round c]\n</code></pre>\n\n<p>I hoped it would produce the list of values c where c is an integer (c == round c), which would be only 5, but it does not compile. Playing around some more, I've found I can't really embed any functions in a list comprehension, I'm sure there is a way, I just don't know how.</p>\n\n<p>Here's the error code:</p>\n\n<pre><code>&lt;interactive&gt;:158:1: error:\n    \u2022 Ambiguous type variable \u2018t0\u2019 arising from a use of \u2018it\u2019\n      prevents the constraint \u2018(Floating t0)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018t0\u2019 should be.\n      These potential instances exist:\n        instance Floating Double -- Defined in \u2018GHC.Float\u2019\n        instance Floating Float -- Defined in \u2018GHC.Float\u2019\n    \u2022 In the first argument of \u2018print\u2019, namely \u2018it\u2019\n      In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["scala", "haskell", "functional-programming", "free-monad"], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1478684714, "post_id": 40496349, "comment_id": 68250664, "body": "Thanks for pointing out the design flaw, and for the nice example on the use of GADT&#39;s! The problem I see is that you are still deciding at the free monad what a <code>Site</code> and a <code>Project</code> are. What I was looking for is deferring this decision to the interpreter.   On the other hand, giving Scala lack of support for GADT&#39;s and considering that the alternative is to write the DSL OO style, I wonder how serious this design flaw is (Java won&#39;t offer better type safety I think)."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1478696201, "post_id": 40496349, "comment_id": 68257222, "body": "I guess I don&#39;t understand your use case. It seems reasonable to me that if your application layer (<code>CommandF</code>) knows that there exist two entities called <code>Site</code> and <code>Project</code> then it probably ought to know what they look like"}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1478698823, "post_id": 40496349, "comment_id": 68258852, "body": "Well, it is like I stated in my question: if I implement the creation of entities via a rest call, it might be that these entities (<code>Project</code> and <code>Site</code>) are futures. If I just want to mock the behavior these entities could be random strings instead. That is why I want to defer the selection of the particular entities. If for instance I choose <code>data Project = Project {uuid :: String}</code> it seems I&#39;m making too many assumptions (but for all practical purposes this might not be practical...). For instance the choice above means that I cannot pass <code>Future</code> or <code>Try</code> around ..."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1478704447, "post_id": 40496349, "comment_id": 68262361, "body": "Don&#39;t let implementation details bleed into the application logic. The whole point of the free monad approach is to write business logic in the free monad, and deal with implementation details in the interpreter. So if you&#39;re calling a web service and dealing with futures, <i>awaiting the future is the interpreter&#39;s job</i>. So if you&#39;re running a <code>Create</code> instruction, the interpreter sends the request, awaits the response, turns it into a <code>Project</code>, and then continues the computation. (That&#39;s more or less what I wrote in <code>interp</code>.)"}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1478707239, "post_id": 40496349, "comment_id": 68264271, "body": "But that means that you cannot add asynchronous behavior to the language right? If you maintain the types abstract, the interpreter is still dealing with futures, and the business logic still doesn&#39;t need to know about this. I think this should be possible, albeit I&#39;m not sure it is good practice."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 1, "creation_date": 1478716850, "post_id": 40496349, "comment_id": 68269395, "body": "Do you <i>really</i> need concurrency support in your embedded language? If you decide that you do, just add a new constructor to the base functor: <code>Concurrently :: r -&gt; r -&gt; CommandF r</code>. The interpreter will be responsible for deciding how to run the two sub-computations concurrently."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 1, "creation_date": 1478719793, "post_id": 40496349, "comment_id": 68270804, "body": "At the end of the day, an embedded language isn&#39;t very useful if it can&#39;t actually do anything with the objects it&#39;s meant to be manipulating. Your application logic has to know about <code>Site</code>s and <code>Project</code>s because it&#39;s the job of the application to manipulate <code>Site</code>s and <code>Project</code>s! Likewise it&#39;s the job of the interpreter to deal with HTTP and concurrency and all that messy real-world stuff."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 3, "last_activity_date": 1478729581, "last_edit_date": 1478729581, "creation_date": 1478638969, "answer_id": 40496349, "question_id": 40495304, "link": "https://stackoverflow.com/questions/40495304/abstract-result-types-in-free-monads/40496349#40496349", "title": "Abstract result types in Free Monads", "body": "<p>Right now you have <code>test :: Free (TestCommand e) ()</code>. This means that the type of the entity <code>e</code> can be anything the caller wants, but it's fixed throughout the computation.</p>\n\n<p>But that's not right! In the real world, the type of the entity that's created in response to a <code>Create</code> command depends on the command itself: if you created a <code>Project</code> then <code>e</code> should be <code>Project</code>; if you created a <code>Site</code> then <code>e</code> should be <code>Site</code>. So <code>e</code> shouldn't be fixed over the whole computation (because I might want to create <code>Project</code>s <em>and</em> <code>Site</code>s), and it shouldn't be up to the caller to pick an <code>e</code>.</p>\n\n<p>Here's a solution in which the type of the entity depends on the value of the command.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Site = Site { {- ... -} }\ndata Project = Project { {- ... -} }\n\ndata EntityType e where\n    SiteTy :: EntityType Site\n    ProjectTy :: EntityType Project\n</code></pre>\n\n<p>The idea here is that pattern-matching on an <code>EntityType e</code> tells you what its <code>e</code> is. In the <code>Create</code> command we'll existentially package up an entity <code>e</code> along with a bit of GADT evidence of the form <code>EntityType e</code> which you can pattern-match on to learn what <code>e</code> was.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data CommandF r where\n    Create :: EntityType e -&gt; (e -&gt; r) -&gt; CommandF r\n    Select :: EntityType e -&gt; e -&gt; r -&gt; CommandF r\n\ninstance Functor CommandF where\n    fmap f (Create t next) = Create t (f . next)\n    fmap f (Select t e next) = Select t e (f next)\n\ntype Command = Free CommandF\n\ncreate :: EntityType e -&gt; Command e\ncreate t = Free (Create t Pure)\n\nselect :: EntityType e -&gt; e -&gt; Command ()\nselect t e = Free (Select t e (Pure ()))\n\nmyComputation :: Command ()\nmyComputation = do\n    p &lt;- create ProjectTy  -- p :: Project\n    select ProjectTy p\n    s &lt;- create SiteTy  -- s :: Site\n    return ()\n</code></pre>\n\n<p>When the interpreter reaches a <code>Create</code> instruction, its job is to return an entity of the type that matches the wrapped <code>EntityType</code>. It has to inspect the <code>EntityType</code> in order to know what <code>e</code> is and behave appropriately.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- assuming createSite :: IO Site and createProject :: IO Project\n\ninterp :: CommandF a -&gt; IO a\ninterp (Create SiteTy next) = do\n    site &lt;- createSite\n    putStrLn \"created a site\"\n    return (next site)\ninterp (Create ProjectTy next) = do\n    project &lt;- createProject\n    putStrLn \"created a project\"\n    return (next project)\n-- plus clauses for Select\n</code></pre>\n\n<p>I don't know how this would translate into Scala exactly, but that's the gist of it in Haskell.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 2, "accepted_answer_id": 40496349, "answer_count": 1, "score": 3, "last_activity_date": 1478729581, "creation_date": 1478634761, "last_edit_date": 1478686233, "question_id": 40495304, "link": "https://stackoverflow.com/questions/40495304/abstract-result-types-in-free-monads", "title": "Abstract result types in Free Monads", "body": "<p>Suppose we want to define a simple DSL for defining UI interactions where we can create objects and then select them:</p>\n\n<pre><code>object TestCommand {\n\n  sealed trait EntityType\n  case object Project extends EntityType\n  case object Site extends EntityType\n\n  sealed trait TestCommand[A, E]\n  case class Create[A, E](entityType: EntityType, withEntity: E =&gt; A) extends  TestCommand[A, E]\n  case class Select[A, E](entity: E, next: A) extends TestCommand[A, E]\n\n} \n</code></pre>\n\n<p>The problem I have is that I wouldn't want to specify what the return type of the creation command should be (<code>E</code> above). I would like to let this decision up to the interpreter. For instance, <code>E</code> could be a string, or a <code>Future</code> if we are creating objects with asynchronous REST calls.</p>\n\n<p>If I try to define the DSL in the usual way using <code>liftF</code> as shown below:</p>\n\n<pre><code>object TestDSL {\n\n  def create[E](entityType: EntityType): Free[TestCommand[?, E], E] =\n    Free.liftF(Create(entityType, identity: E =&gt; E): TestCommand[E, E])\n\n  def select[E](entity: E): Free[TestCommand[?, E], Unit] =\n    Free.liftF(Select[Unit, E](entity, ()))\n\n}\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Error:(10, 10) no type parameters for method liftF: (value: S[A])scalaz.Free[S,A] exist so that it can be applied to arguments (dsl.TestCommand.TestCommand[E,E])\n --- because ---\nargument expression's type is not compatible with formal parameter type;\n found   : dsl.TestCommand.TestCommand[E,E]\n required: ?S[?A]\n    Free.liftF(Create(entityType, identity: E =&gt; E): TestCommand[E, E])\n</code></pre>\n\n<p>I cannot understand what is going wrong in the code above, but a more important question is whether this is the right way to abstract over the types appearing in free monads. If not, what is the right (functional) approach?</p>\n\n<p><em>EDIT</em>:</p>\n\n<p>In Haskell the approach described above works without a problem:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n-- |\n\nmodule TestDSL where\n\nimport           Control.Monad.Free\n\ndata EntityType = Project | Site\n\ndata TestCommand e a = Create EntityType (e -&gt; a) | Select e a\n  deriving Functor\n\n-- | The DSL\ncreate :: EntityType -&gt; Free (TestCommand e) e\ncreate et = liftF $ Create et id\n\nselect :: e -&gt; Free (TestCommand e) ()\nselect e = liftF $ Select e ()\n\n\n-- | A sample program:\ntest :: Free (TestCommand e) ()\ntest = do\n  p &lt;- create Project\n  select p\n  _ &lt;- create Site\n  return ()\n\n-- | A trivial interpreter.\ninterpTestCommand :: TestCommand String a -&gt; IO a\ninterpTestCommand (Create Project withEntity) = do\n  putStrLn $ \"Creating a project\"\n  return (withEntity \"Project X\")\ninterpTestCommand (Create Site withEntity) = do\n  putStrLn $ \"Creating a site\"\n  return (withEntity \"Site 51\")\ninterpTestCommand (Select e next) = do\n  putStrLn $ \"Selecting \" ++ e\n  return next\n\n-- | Running the interpreter\nrunTest :: IO ()\nrunTest = foldFree interpTestCommand test\n</code></pre>\n\n<p>Running the test will result in the following output:</p>\n\n<pre><code>\u03bb&gt; runTest\nCreating a project\nSelecting Project X\nCreating a site\n</code></pre>\n"}, {"tags": ["haskell", "dynamic"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1478626428, "post_id": 40492860, "comment_id": 68230300, "body": "One way (much frowned upon) is existential types. Another one (better regarded but ultimately equivalent to the former) is storing manually assembled method dictionaries. These correspond not to downcasts but to virtual functions/late bound methods in OO."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 9, "creation_date": 1478628102, "post_id": 40492860, "comment_id": 68231248, "body": "I find such questions usually can&#39;t be answered well in Haskell without more details about what you want to represent and what directions you want to generalize in."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1478629184, "post_id": 40492860, "comment_id": 68231776, "body": "You may or may not find inspiration in <a href=\"https://userpages.uni-koblenz.de/~laemmel/TheEagle/\" rel=\"nofollow noreferrer\">userpages.uni-koblenz.de/~laemmel/TheEagle</a> and <a href=\"http://okmij.org/ftp/tagless-final/course/\" rel=\"nofollow noreferrer\">okmij.org/ftp/tagless-final/course</a>"}, {"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478629929, "post_id": 40492860, "comment_id": 68232166, "body": "@dfeuer I think my example is pretty clear (LifeForms) if you have some example closed to it, will be great!"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1478635222, "post_id": 40492860, "comment_id": 68234937, "body": "Your LifeForm data type is perfectly clear indeed. What&#39;s not clear at all is what you wish you could do with it."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1478677360, "post_id": 40492860, "comment_id": 68247408, "body": "Why not create separate types and make all of them an instance of <code>class LifeForm</code>? You can then choose to appropriate instances for every data type / newtype as you need."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1478679278, "post_id": 40492860, "comment_id": 68248100, "body": "... I don&#39;t what you want. If you want an extensible <code>LifeForm</code> then make <code>LifeForm</code> a class and <i>not</i> a data type..."}, {"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1478708312, "post_id": 40492860, "comment_id": 68264947, "body": "@Bakuriu, can you provide some example?"}], "owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1478676051, "creation_date": 1478625585, "last_edit_date": 1478676051, "question_id": 40492860, "link": "https://stackoverflow.com/questions/40492860/strategies-to-deal-with-problems-when-downcasting-looks-like-the-best-fit", "title": "Strategies to deal with problems when downcasting looks like the best fit", "body": "<p>Usually, use sum types is pretty straightforward and works very well in many cases</p>\n\n<pre><code>data LifeForm = Grass | Sheep | Wolf\n</code></pre>\n\n<p>but when I want open my \"LifeForm\" on my problems I fall in heterogeneus containers, <code>Data.Dynamic</code>, <code>Data.Typeable</code> and so on (<a href=\"https://gist.github.com/josejuan/2f0cd749d07130c8570b40d835824ad0\" rel=\"nofollow noreferrer\">here a silly example using a simple String to discover the \"type\" at runtime</a>).</p>\n\n<p>I'll like extend my \"LifeForm\" in a manner that new \"life forms\" can interact and <strong>restrict</strong> between them with <strong>their own</strong> and new properties (classes).</p>\n\n<p>Typically downcast at runtime is the simplest way in many languages.</p>\n\n<p>I'm looking for useful strategies I could use to extend (without change the \"core\") containers when their elements may know or not optional properties of the others (eg. <code>class Vegetable a</code>, <code>class Runner a</code>, ...).</p>\n\n<p>How do you deal with it?</p>\n\n<p>Are <a href=\"https://hackage.haskell.org/package/constrained-dynamic-0.1.0.0/docs/Data-MultiConstrainedDynamic.html\" rel=\"nofollow noreferrer\">Data.MultiConstrainedDynamic</a> and others the best way?</p>\n\n<p>Is preferable try to avoid this extensibility?</p>\n\n<p>Thk!</p>\n\n<p><strong>UPDATED</strong> to clarify <em>\"What's not clear at all is what you wish you could do with it. \"</em></p>\n\n<p>Once I've my <em>\"lifeforms core\"</em>:</p>\n\n<ol>\n<li>I like add the <em>\"wind\"</em> defining a new <code>class AffectedByTheWind a</code>, now any lifeform could be affected by the wind (for every <em>\"world step\"</em> the <em>\"Wind life form\"</em> will check all <code>AffectedByTheWind</code>).</li>\n<li>I like add the <strong>Dodo</strong> bird instancing <code>class Fly a</code>, <code>class IsMeat a</code>, <code>class Might a</code>, ... and automatically other <em>\"life forms\"</em> can interact with it.</li>\n<li>I like add a <em>\"watcher life form\"</em> (a <em>\"spirit form\"</em>) reporting how many life forms can run (instance <code>class Runner a</code>).</li>\n<li>I like add a <em>\"behavior life form\"</em> (a <em>\"element form\"</em>) that check how many <code>IsMeat</code> forms exists and reduce their vital energy.</li>\n<li>...</li>\n</ol>\n\n<p>All of this can be achieved using sum types or fixed type class hierarchy but is not extensible in the <em>\"expression problem\"</em> sense.</p>\n"}, {"tags": ["haskell", "functional-programming", "inorder"], "answers": [{"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 2, "last_activity_date": 1506553416, "last_edit_date": 1506553416, "creation_date": 1478620589, "answer_id": 40491261, "question_id": 40490599, "link": "https://stackoverflow.com/questions/40490599/flattening-a-tree-in-haskell-using-in-order-traversal/40491261#40491261", "title": "Flattening a tree in haskell using in-order traversal", "body": "<p>Look at the type of <code>foldTree</code>.</p>\n\n<pre><code>foldTree :: (b -&gt; a -&gt; b -&gt; b) -&gt; (a -&gt; b) -&gt; Tree a -&gt; b\n</code></pre>\n\n<p>You can see that <code>b</code> is the result type of the catamorphism. <code>foldTree</code> works by folding each sub-tree to obtain a result <code>b</code> for each, then combining them using the folding function.</p>\n\n<p>Since you want the result to be a flattened list of the tree's elements, let's set <code>b ~ [a]</code>.</p>\n\n<pre><code>foldTree :: ([a] -&gt; a -&gt; [a] -&gt; [a]) -&gt; (a -&gt; [a]) -&gt; Tree a -&gt; [a]\n</code></pre>\n\n<p>So the second argument of <code>foldTree</code> should be something which injects a single element <code>a</code> into a list <code>[a]</code>, and the first should be one that combines two lists with an element to make a bigger list.</p>\n\n<pre><code>flatTree = foldTree (\\xs x ys -&gt; xs ++ x : ys) (\\x -&gt; [x])\n</code></pre>\n\n<hr>\n\n<p>Incidentally, GHC is able to write your <code>flatTree</code> function for you, just by looking at the structure of the type. <code>flatTree :: Tree a -&gt; [a]</code> matches the type of <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Foldable.html#v:toList\" rel=\"nofollow noreferrer\"><code>toList :: Foldable f =&gt; f a -&gt; [a]</code></a>, which is part of the <code>Foldable</code> class. All you need to do is say the magic words, <code>deriving Foldable</code>, and GHC will spit out an instance of <code>Foldable</code>.</p>\n\n<pre><code>{-# LANGUAGE DeriveFoldable #-}\n\ndata Tree t = Leaf t\n            | Tree (Tree t) t (Tree t)\n            deriving Foldable\n\nflatTree :: Tree a -&gt; [a]\nflatTree = toList\n</code></pre>\n\n<p>Because of the way the <code>Tree</code> constructor is laid out, <code>toList</code> will perform an in-order traversal. This can be varied by adjusting the definition of the <code>Tree</code> constructor.</p>\n"}], "owner": {"reputation": 43, "user_id": 7122723, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/17a222d892f5c492f4a7210dce19a3ad?s=128&d=identicon&r=PG&f=1", "display_name": "bill williams", "link": "https://stackoverflow.com/users/7122723/bill-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 1, "accepted_answer_id": 40491261, "answer_count": 1, "score": 0, "last_activity_date": 1506553416, "creation_date": 1478618676, "question_id": 40490599, "link": "https://stackoverflow.com/questions/40490599/flattening-a-tree-in-haskell-using-in-order-traversal", "title": "Flattening a tree in haskell using in-order traversal", "body": "<p>I want to implement flattenning a tree using my foldTree function that I defined and in-order traversal.Which should return a list after flattening.</p>\n\n<pre><code>data Tree t = Leaf t\n        | Tree (Tree t) t (Tree t)\n\n\nfoldTree :: (t1 -&gt; t -&gt; t1 -&gt; t1) -&gt; (t -&gt; t1) -&gt; Tree t -&gt; t1\nfoldTree treeFn leafFn tree =\ncase tree of\n  Leaf v -&gt; leafFn v\n  Tree leftTree q rightTree -&gt; treeFn (foldTree treeFn leafFn leftTree) q (foldTree treeFn leafFn rightTree)\n\n\nInput : foldTree (\\t1 t t2-&gt;t1 + 5*t + t2) (\\x-&gt;x+9) (Leaf 5)\nExpected Output : 14\n\nInput : foldTree (\\t1 t t2-&gt;t1 + 3*t + t2) (\\x-&gt;x+5) (Tree (Leaf 3) 2 (Leaf 4))\nExpected Output : 23\n</code></pre>\n\n<p>I tried the following code but it uses recursion.I want to call foldTree from flattenTree to implement the flattening of tree instead of making a recursive call to flatTree.(Using foldTree functions in flattenTree).Can anyone help me on how to integrate it.</p>\n\n<pre><code>flatTree :: Tree a -&gt; [a]\nflatTree tree = \ncase tree of\n    Leaf v -&gt; [v]\n    Tree p v r -&gt; (flatTree p) ++ [v] ++ (flatTree r) \n\nInput: flatTree (Tree (Leaf 5) 3 (Tree (Leaf 3) 2 (Leaf 4)))\nExpected output : [5,3,3,2,4]\n</code></pre>\n"}, {"tags": ["haskell", "reactjs"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1478608638, "post_id": 40487132, "comment_id": 68217723, "body": "You can probably take inspiration from purescript. They have a binding written for react."}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1478608827, "post_id": 40487132, "comment_id": 68217870, "body": "You forgot about <code>this</code> in translating the function types. <code>this</code> provides access to state, props, and refs."}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1478608906, "post_id": 40487132, "comment_id": 68217931, "body": "Hmm... ok, thanks, where would that go ?"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 1, "creation_date": 1478609311, "post_id": 40487132, "comment_id": 68218227, "body": "Here is the PS binding: <a href=\"https://github.com/purescript-contrib/purescript-react/blob/master/src/React.purs\" rel=\"nofollow noreferrer\">github.com/purescript-contrib/purescript-react/blob/master/s&zwnj;&#8203;rc/&hellip;</a>"}], "owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1478608498, "creation_date": 1478608498, "question_id": 40487132, "link": "https://stackoverflow.com/questions/40487132/what-would-be-the-type-of-react-createclass-in-haskell", "title": "What would be the type of `React.createClass` in Haskell?", "body": "<p>I am reading <a href=\"https://gist.github.com/sebmarkbage/fcb1b6ab493b0c77d589#formal-type-definitions\" rel=\"nofollow noreferrer\">this</a> and I wonder what would be the type of <code>React.createClass</code> / <code>ReactClass</code> and <code>ReactComponent</code>  in Haskell ?</p>\n\n<p>I am trying to understand the concepts in React, hence the question.</p>\n\n<p>My guess is that this:</p>\n\n<p><code>type ReactClass&lt;TProps&gt; = (TProps) =&gt; ReactComponent&lt;TProps&gt;;</code></p>\n\n<p>would translate to Haskell like: </p>\n\n<p><code>data ReactClass tprops = data ReactClass ( tProps -&gt; ReactComponent tProps )</code></p>\n\n<p>and </p>\n\n<pre><code>type ReactComponent&lt;TProps&gt; = {\n  props : TProps,\n  render : () =&gt; ReactElement\n};\n</code></pre>\n\n<p>this would translate to Haskell as:</p>\n\n<p><code>data ReactComponent tProps = ReactComponent tProps ReactElement</code></p>\n\n<p>but I am unsure. </p>\n\n<p>Could someone please correct me if this is wrong ?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "edited": false, "score": 1, "creation_date": 1478602906, "post_id": 40484616, "comment_id": 68214066, "body": "It would be useful to know which compiler error you get using <code>whamletFile</code>."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1478617272, "post_id": 40484616, "comment_id": 68224034, "body": "Why not hamletFile? You won&#39;t want most of the functionality of a widget, like CSS and JavaScript."}, {"owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "reply_to_user": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "edited": false, "score": 0, "creation_date": 1478622089, "post_id": 40484616, "comment_id": 68227585, "body": "@gigabytes Sure; I updated my question."}, {"owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1478622331, "post_id": 40484616, "comment_id": 68227739, "body": "@MichaelSnoyman Different compiler error, though just as cryptic to me currently. I&#39;m not sure what a <code>t0</code> is."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1478679705, "post_id": 40484616, "comment_id": 68248280, "body": "You need to provide it with a URL rendering function. You can get it with getUrlRenderParams"}], "owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478622070, "creation_date": 1478601062, "last_edit_date": 1478622070, "question_id": 40484616, "link": "https://stackoverflow.com/questions/40484616/how-do-i-get-a-html-from-a-widgett-site-m", "title": "How do I get a Html from a WidgetT site m ()?", "body": "<p>I'm building up a <code>Mail</code> with <code>import Network.Mail.Mime.SES</code>, and the HTML part of my email needs a <code>Html</code> value.</p>\n\n<p>I can get an <code>Html</code> like this:</p>\n\n<pre><code>import Text.Blaze.Html.Renderer.Utf8 (renderHtml)\n\nemailHtml :: Html\nemailHtml = renderHtml $(shamletFile \"templates/email.hamlet\")\n</code></pre>\n\n<p>However, the template I'm using should have a reference to a static file. I want to reference it with <code>@{StaticR img_myimage_jpg}</code>, but using URLs like this does not work with <em>shamlet</em>. Instead, I think I need to use <em>whamlet</em>, but if I use <code>whamletFile</code> with <code>renderHtml</code>, I get a compiler error.</p>\n\n<p>Using <code>whamletFile</code> produces this compiler error:</p>\n\n<pre><code>Handler/Proxy.hs:71:55:\n    Couldn't match expected type `blaze-markup-0.7.1.0:Text.Blaze.Internal.MarkupM\n                                    ()'\n                with actual type `WidgetT site12 m12 ()'\n    In a stmt of a 'do' block:\n      (asWidgetT GHC.Base.. toWidget)\n        ((blaze-markup-0.7.1.0:Text.Blaze.Internal.preEscapedText\n          GHC.Base.. Data.Text.pack)\n           \"&lt;/pre&gt;\\n\\\n           \\&lt;/td&gt;\\n\\\n           \\&lt;/tr&gt;\\n\\\n           \\&lt;/table&gt;\\n\\\n           \\&lt;/td&gt;\\n\\\n           \\&lt;/tr&gt;\\n\\\n           ... (many more lines)\n</code></pre>\n\n<p>Using <code>hamletFile</code> produces this compiler error:</p>\n\n<pre><code>Handler/Proxy.hs:71:53:\n    Couldn't match expected type `t0\n                                  -&gt; blaze-markup-0.7.1.0:Text.Blaze.Internal.MarkupM ()'\n                with actual type `blaze-markup-0.7.1.0:Text.Blaze.Internal.MarkupM\n                                    ()'\n    The lambda expression `\\ _render_aoYP -&gt; ...' has one argument,\n    but its type `Html' has none\n    In the first argument of `renderHtml', namely\n      `\\ _render_aoYP\n         -&gt; do { GHC.Base.id\n                   ((blaze-markup-0.7.1.0:Text.Blaze.Internal.preEscapedText\n                     GHC.Base.. Data.Text.pack)\n                      \"&lt;!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Transitional//EN\\\" \\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\\\"&gt;\\n\\\n</code></pre>\n"}, {"tags": ["haskell", "reflex"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1478592824, "post_id": 40481916, "comment_id": 68207787, "body": "Which <code>Dynamic</code> are you referring to? <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Dynamic.html\" rel=\"nofollow noreferrer\"><code>Data.Dynamic</code></a> is the usual data type."}], "answers": [{"comments": [{"owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "edited": false, "score": 1, "creation_date": 1478642764, "post_id": 40482715, "comment_id": 68238597, "body": "thanks! I didn&#39;t know about dyn, and that may be what I go with. However, I&#39;m not entirely sure it&#39;s correct, because I do want efficient updates inside my sum type. I&#39;ve posted a more detailed followup here <a href=\"http://stackoverflow.com/questions/40497229/how-can-i-efficiently-branch-on-the-value-inside-a-reflex-dynamic\" title=\"how can i efficiently branch on the value inside a reflex dynamic\">stackoverflow.com/questions/40497229/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3188, "user_id": 590347, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca28027d24f8a5aacd4d9d9098a09b5?s=128&d=identicon&r=PG", "display_name": "Bartosz", "link": "https://stackoverflow.com/users/590347/bartosz"}, "is_accepted": true, "score": 6, "last_activity_date": 1506434717, "last_edit_date": 1506434717, "creation_date": 1478595645, "answer_id": 40482715, "question_id": 40481916, "link": "https://stackoverflow.com/questions/40481916/how-can-i-branch-on-the-value-inside-a-reflex-dynamic/40482715#40482715", "title": "How can I branch on the value inside a Reflex Dynamic?", "body": "<p>If you need to switch the widget you probably need one of:</p>\n\n<pre><code>dyn :: MonadWidget t m =&gt; Dynamic t (m a) -&gt; m (Event t a) Source\n</code></pre>\n\n<p>or</p>\n\n<pre><code>widgetHold :: MonadWidget t m =&gt; m a -&gt; Event t (m a) -&gt; m (Dynamic t a)\n</code></pre>\n\n<p>Since you've mentioned you've got Dynamic at hand, we're gonna use <code>dyn</code>:</p>\n\n<pre><code>app = do\n  switched &lt;- button \"Alternate!\"\n  flag &lt;- foldDyn ($) False (not &lt;$ switched) -- just to have some Dynamic t Bool\n  let w = myWidget &lt;$&gt; flag\n  void $ dyn w\n\nmyWidget :: MonadWidget t m =&gt; Bool -&gt; m ()\nmyWidget False = blank\nmyWidget True = el \"div\" $ blank\n</code></pre>\n\n<p>The basic rule is that, due to the higer-order nature of Reflex, if you want to swap-out something, you need to have Event/Dynamic that yields a widget as a value. That's why <code>dyn</code> takes <code>Dynamic t (m a)</code> as its parameter (and appropriately, <code>widgetHold</code> takes <code>Event t (m a)</code>. And that's why we've mapped over <code>Dynamic t Bool</code> to have a dynamic that has our widget building action as a value.</p>\n\n<p>It's worth mentioning, that neither dynamic/widgetHold does virtual dom/diffing to speed the rendering. With reflex you can be more explicit about what updates what (a Dynamic/Event t Text can affect node text directly, without rerendering whole node) and you should take advantage of that. If not then large portions of page will be swapped and it can yield significant performance hit.</p>\n"}], "owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 40482715, "answer_count": 1, "score": 2, "last_activity_date": 1506434717, "creation_date": 1478592652, "last_edit_date": 1478593649, "question_id": 40481916, "link": "https://stackoverflow.com/questions/40481916/how-can-i-branch-on-the-value-inside-a-reflex-dynamic", "title": "How can I branch on the value inside a Reflex Dynamic?", "body": "<p>in the simplest case, say I have a <code>Dynamic t Bool</code>, and when the value is true, I want a single empty div to exist, and when the value is false, I don't want there to be any dom element.</p>\n\n<p>slightly more generally, if I have a <code>Dynamic t (Either MyA MyB)</code>, and I have functions that know how to render given a <code>Dynamic t MyA</code> or a <code>Dynamic t MyB</code>, how to I call the appropriate function to render?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1478590638, "post_id": 40481314, "comment_id": 68206610, "body": "The two types are completely different. The former allows you to, for example, have a list of <code>BlockedFetch</code> values with <i>different</i> <code>a</code> types (i.e. the type <code>[BlockedFetch r]</code> is valid and does <i>not</i> mention <code>a</code>), while the latter cannot because the type would be <code>[BlockedFetch r a]</code> but now all the <code>a</code>s of the elements must match."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 2, "last_activity_date": 1478592121, "creation_date": 1478592121, "answer_id": 40481781, "question_id": 40481314, "link": "https://stackoverflow.com/questions/40481314/haskell-explicit-forall-with-missing-type-parameter-on-lhs/40481781#40481781", "title": "Haskell explicit forall with &quot;missing&quot; type parameter on lhs", "body": "<p>The difference is that you can (and in fact this happens a little further in the code) make a list of type <code>[BlockedFetch request]</code> where individual <code>BlockedFetch</code> have different <code>a</code> types (which you could not do with <code>[BlockedFetch request a]</code> - the <code>a</code> here has to be the same for the whole list). The comment above the snippet of code explains this nicely:</p>\n\n<pre><code>-- We often want to collect together multiple requests, but they return\n-- different types, and the type system wouldn't let us put them\n-- together in a list because all the elements of the list must have the\n-- same type. So we wrap up these types inside the 'BlockedFetch' type,\n-- so that they all look the same and we can put them in a list.\n--\n-- When we unpack the 'BlockedFetch' and get the request and the 'ResultVar'\n-- out, the type system knows that the result type of the request\n-- matches the type parameter of the 'ResultVar', so it will let us take the\n-- result of the request and store it in the 'ResultVar'.\n</code></pre>\n\n<p>Roughly what happens in Haxl is that you want to have a way of fetching a bunch of values of different types in parallel from some remote store. The way you do this is by making a bunch of <code>MVar</code> which will contain the values you plan on getting. Then, in your code, you freely use these variables. However, and <code>MVar</code> blocks until it is \"filled\".</p>\n\n<p>However, to fill the <code>MVar</code>, you only need to keep a reference to the <code>MVar</code> and a way of filling it - so at the end of the day you don't even need to know what the type is of the stuff the <code>MVar</code> will contain. That is an existential type - there exists some type <code>a</code> which the <code>BlockedFetch</code> is going to try to fill, but it will vary for different <code>BlockedFetch</code>s.</p>\n"}, {"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 1, "last_activity_date": 1478592422, "creation_date": 1478592422, "answer_id": 40481856, "question_id": 40481314, "link": "https://stackoverflow.com/questions/40481314/haskell-explicit-forall-with-missing-type-parameter-on-lhs/40481856#40481856", "title": "Haskell explicit forall with &quot;missing&quot; type parameter on lhs", "body": "<p>Consider a simpler example:</p>\n\n<pre><code>data ShowBox = forall a. Show a =&gt; ShowBox a\n</code></pre>\n\n<p>Read it as</p>\n\n<pre><code>data ShowBox = whatever a. Show a =&gt; ShowBox a\n</code></pre>\n\n<p>and now it's clear that <code>ShowBox</code> can contain a value of any type as long as this type is an instance of <code>Show</code>. E.g.</p>\n\n<pre><code>ex :: [ShowBox]\nex = [ShowBox 'a', ShowBox (), ShowBox [1,2,3]]\n</code></pre>\n\n<p>So you can read</p>\n\n<pre><code>data BlockedFetch r = forall a. BlockedFetch (r a) (ResultVar a)\n</code></pre>\n\n<p>as \"<code>BlockedFetch</code> contains an <code>r a</code> and <code>ResultVar a</code> for whatever <code>a</code>\".</p>\n"}, {"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1478606302, "post_id": 40485408, "comment_id": 68216170, "body": "The point about GADT notation is highly relevant to epsilonhalbe&#39;s question. The use of the <code>forall</code> keyword enabled by <code>ExistentialQuantification</code> is actually quite different from the one enabled by <code>RankNTypes</code>, which is a potential source of confusion. GADT notation makes this difference obvious."}, {"owner": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "edited": false, "score": 0, "creation_date": 1479519810, "post_id": 40485408, "comment_id": 68607121, "body": "<code>+1</code> on GADT syntax, I can&#39;t think of a case where existential quantification looks better with regular ADT syntax."}], "tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": true, "score": 5, "last_activity_date": 1478603548, "creation_date": 1478603548, "answer_id": 40485408, "question_id": 40481314, "link": "https://stackoverflow.com/questions/40481314/haskell-explicit-forall-with-missing-type-parameter-on-lhs/40485408#40485408", "title": "Haskell explicit forall with &quot;missing&quot; type parameter on lhs", "body": "\n\n<p>As others have mentioned, the example from the code is an example of an existential quantification, and so is totally different from the final example in the question.</p>\n\n<p>The first thing to note is that nowadays GADT notation is often preferred for this.  The type in GADT notation is:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>data BlockedFetch r where\n    BlockedFetch :: r a -&gt; ResultVar a -&gt; BlockedFetch r\n</code></pre>\n\n<p>We can explicitly bind <code>a</code> as follows:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>data BlockedFetch r where\n    BlockedFetch :: forall a. r a -&gt; ResultVar a -&gt; BlockedFetch r\n</code></pre>\n\n<p>This would be isomorphic to the following if we had free existential quantification:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>data BlockedFetch r where\n    BlockedFetch :: (exists a. (r a, ResultVar a)) -&gt; BlockedFetch r\n</code></pre>\n\n<p>This, combined with a desire not to introduce new keywords, is what led to the old ExistentialQuantification syntax.  The <code>BlockedFetch</code> data constructor has type </p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>BlockedFetch :: forall r a. r a -&gt; ResultVar a -&gt; BlockedFetch r\n</code></pre>\n\n<p>and this is what is trying to be communicated with the syntax:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>data BlockedFetch r = forall a. BlockedFetch (r a) (ResultVar a)\n</code></pre>\n\n<p>From this perspective the difference from having <code>BlockedFetch r a</code> is then the <code>a</code> would occur in the result of the data constructor type.  Schematically, <code>forall a. F a -&gt; G</code> is logically equivalent to <code>(exists a. F a) -&gt; G</code>, but it is clearly not the case that <code>forall a. F a -&gt; G a</code> is equivalent to <code>(exists a. F a) -&gt; G a</code> as the latter is not even well-scoped.</p>\n\n<p>Returning to</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>BlockedFetch :: forall r a. r a -&gt; ResultVar a -&gt; BlockedFetch r\n</code></pre>\n\n<p>if you don't understand existentials, but you do understand universal quantification, then you can understand what's going on in terms of that.  Here we see that someone <em>calling</em> <code>BlockedFetch</code>, i.e. building a value with the data constructor, is free to choose whichever type they want for <code>a</code>.  Someone <em>consuming</em>, i.e. pattern matching on, a value of type <code>BlockedFetch R</code> is essentially writing a function <code>forall a. R a -&gt; ResultVar a -&gt; X</code> and that function must work for <em>any</em> value of <code>a</code>, i.e. the person calling this function gets to choose <code>a</code> and this function must work with that choice. </p>\n"}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 40485408, "answer_count": 3, "score": 2, "last_activity_date": 1478603548, "creation_date": 1478590349, "last_edit_date": 1478590700, "question_id": 40481314, "link": "https://stackoverflow.com/questions/40481314/haskell-explicit-forall-with-missing-type-parameter-on-lhs", "title": "Haskell explicit forall with &quot;missing&quot; type parameter on lhs", "body": "<p>I was reading the source code of <a href=\"http://hackage.haskell.org/package/haxl-0.4.0.1/docs/src/Haxl-Core-Types.html#BlockedFetch\" rel=\"nofollow noreferrer\">haxl-Haxl.Core</a> I came upon the following piece of code</p>\n\n<pre><code>data BlockedFetch r = forall a. BlockedFetch (r a) (ResultVar a)\n</code></pre>\n\n<p>And realized that I don't fully understand the usage of <code>ExplicitForall</code>/<code>ExistentialQuantification</code>.</p>\n\n<p>In what ways is the snippet above different from</p>\n\n<pre><code>data BlockedFetch r a = BlockedFetch (r a) (ResultVar a)\n</code></pre>\n\n<p>And why can I \"omit\" the type parameter on the lhs of the data declaration.</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1478592160, "post_id": 40480861, "comment_id": 68207437, "body": "Note that <code>tail</code> is best to be avoided, since it can crash your program when you pass it the empty list. You should use (exhaustive) pattern matching instead when possible, which does not have the same problem -- e.g. <code>lengthz (x:xs) = 1 + lengthz xs</code>."}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1478590594, "post_id": 40480934, "comment_id": 68206587, "body": "Why not <code>lengthz :: Num a =&gt; [x] -&gt; a</code> you don&#39;t use the content of the list at all."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1478616153, "post_id": 40480934, "comment_id": 68223155, "body": "A constraint of <code>Integral b</code> would probably be better; what would it mean for a list to have a &quot;length&quot; of 1.5? Let the caller convert the length to a real type (for, say, computing an average) if necessary. (For example, <code>genericLengthz = fromIntegral . lengthz</code>.)"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1478617307, "post_id": 40480934, "comment_id": 68224057, "body": "@chepner Since our definition wouldn&#39;t even lead us to get non-integral types anyways, isn&#39;t this a pretty poor justification? I understand that the prelude <code>length</code> function is constrained this way, but thought that people viewed this as an inconvenience."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1478617844, "post_id": 40480934, "comment_id": 68224432, "body": "<code>Prelude.length</code> is even further constrained; it only returns <code>Int</code>. <code>Data.List.genericLength</code> generalizes to <code>Num b =&gt; b</code>. Since there is no <i>practical</i> purpose to defining <code>lengthz</code>, I figured it was worth differentiating it from the existing functions in some way, namely by providing a type constraint that accurately reflects the possible return values."}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": true, "score": 5, "last_activity_date": 1478591796, "last_edit_date": 1478591796, "creation_date": 1478588949, "answer_id": 40480934, "question_id": 40480861, "link": "https://stackoverflow.com/questions/40480861/defining-a-length-function-using-tail/40480934#40480934", "title": "Defining a length function using tail", "body": "<p>First, you have a typo in your recursive call to <code>lengthZ</code>. Fixing this, we encounter a new type error:</p>\n\n<blockquote>\n  <p>No instance for (Num a)</p>\n</blockquote>\n\n<p>What this tells us is that in order to use the function <code>(+)</code>, we must include the typeclass <code>Num</code> as a constraint in our type declaration. We also include a different type variable for the elements of the list so that the function can be applied to lists containing elements of any type. We thus rewrite the function as follows:</p>\n\n<pre><code>lengthz :: Num b =&gt; [a] -&gt; b\nlengthz [] = 0\nlengthz n = 1 + lengthz (tail n)\n</code></pre>\n\n<p>Which works just as we'd expect:</p>\n\n<pre><code>ghci&gt;&gt; lengthz [1,2,3]\n3\nghci&gt;&gt; lengthz []\n0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1212, "user_id": 2455145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kazBZ.jpg?s=128&g=1", "display_name": "AlexJ136", "link": "https://stackoverflow.com/users/2455145/alexj136"}, "is_accepted": false, "score": 3, "last_activity_date": 1478598308, "creation_date": 1478598308, "answer_id": 40483595, "question_id": 40480861, "link": "https://stackoverflow.com/questions/40480861/defining-a-length-function-using-tail/40483595#40483595", "title": "Defining a length function using tail", "body": "<p>The type for your <code>lengthz</code> function is <code>[a] -&gt; a</code>.</p>\n\n<p>This means you're taking a list of <code>a</code> things and returning a single <code>a</code> thing. What if you had a list of <code>Bool</code>? You don't want the function to output a <code>Bool</code>. You want an <code>Int</code> to be returned, regardless of the type of the thing in the list.</p>\n\n<p>The simplest fix would be to change the type of <code>lengthz</code> to <code>[a] -&gt; Int</code>. This says that the argument can be a list of anything (<code>a</code> is the anything, <code>[]</code> says it's a list) and the return type is an <code>Int</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 7130136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d295bb21adb8f861f6553db64f33a942?s=128&d=identicon&r=PG&f=1", "display_name": "Fred Park", "link": "https://stackoverflow.com/users/7130136/fred-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 40480934, "answer_count": 2, "score": 3, "last_activity_date": 1478598308, "creation_date": 1478588676, "question_id": 40480861, "link": "https://stackoverflow.com/questions/40480861/defining-a-length-function-using-tail", "title": "Defining a length function using tail", "body": "<p>I'm pretty new to Haskell and I am trying to define my own length function as follows:</p>\n\n<p><code>lengthz :: [a] -&gt; a\nlengthz [] = 0\nlengthz n = 1 + length (tail n)</code></p>\n\n<p>Why does this not compile? And or, is there something wrong with my logic?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "recursion", "optimization"], "answers": [{"tags": [], "owner": {"reputation": 3946, "user_id": 4444768, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vVqiI.jpg?s=128&g=1", "display_name": "LmTinyToon", "link": "https://stackoverflow.com/users/4444768/lmtinytoon"}, "is_accepted": false, "score": 2, "last_activity_date": 1478582556, "creation_date": 1478582556, "answer_id": 40479536, "question_id": 40479302, "link": "https://stackoverflow.com/questions/40479302/is-it-possible-to-write-a-factorial-function-as-fast-as-the-textbook-one-in-a/40479536#40479536", "title": "Is it possible to write a factorial function as fast as the &quot;textbook&quot; one in a different way?", "body": "<p>Maybe something like that:</p>\n\n<pre><code>f n = foldl (*) 1 [1..n]\n</code></pre>\n\n<p>You can change foldl on foldr or foldl' it will change speed </p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1478588399, "post_id": 40479539, "comment_id": 68205567, "body": "Fusion, while important, is much <i>less</i> important in this case than the combination of tail-call optimization and strictness analysis. Fusion probably makes it several times faster, but the others keep it from blowing up altogether. Using <code>foldl&#39;</code> avoids such heavy reliance on strictness analysis."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478589643, "post_id": 40479539, "comment_id": 68206120, "body": "@dfeuer I agree, but OP is looking for a reason why the <code>product</code> version is faster. The tail-call optimization is a blessing to the other version, and strictness analysis applies to both variants. That leaves fusion as the main strength of the <code>foldl</code> version."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1478590749, "post_id": 40479539, "comment_id": 68206668, "body": "Their recursive version is not tail recursive. Compare the speed of their recursive version to the faster version with a non-fusing product: <code>{-# NOINLINE product_ni #-} product_ni :: [Integer] -&gt; Integer; product_ni = product</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478590907, "post_id": 40479539, "comment_id": 68206768, "body": "@dfeuer Oh wow yeah - for some reason I had it in my head that they were using an accumulator version. The non-tail recursive-ness is indeed a big deal."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 10, "last_activity_date": 1478591219, "last_edit_date": 1495542271, "creation_date": 1478582563, "answer_id": 40479539, "question_id": 40479302, "link": "https://stackoverflow.com/questions/40479302/is-it-possible-to-write-a-factorial-function-as-fast-as-the-textbook-one-in-a/40479539#40479539", "title": "Is it possible to write a factorial function as fast as the &quot;textbook&quot; one in a different way?", "body": "<p>The first version is easier for GHC to optimize than the second one. In particular, <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/src/GHC.List.html#product\" rel=\"nofollow noreferrer\">product uses <code>foldl</code></a>:</p>\n\n<pre><code>product = foldl (*) 1\n</code></pre>\n\n<p>and when applied to <code>[1..n]</code> (which is just <code>1 `enumFromTo` n</code>) it is subject to <a href=\"https://stackoverflow.com/questions/38905369/what-is-fusion-in-haskell\">fusion</a>. In short, GHC has carefully crafted re-write rules that are meant to optimize away intermediate data structures from pieces of code where the lists created are immediately consumed (in the case of <code>factorial</code>, <code>foldl (*) 1</code> is the consumer and <code>1 `enumFromTo` n</code> the producer).</p>\n\n<p>Note that you can do what GHC does (<code>factorial = foldl (*) 1 . enumFromTo 1</code>) and get the same performance.</p>\n\n<hr>\n\n<p>Also, your second function isn't even tail recursive. That part you could fix pretty easily by passing in an accumulator:</p>\n\n<pre><code>factorial :: (Integral a) =&gt; a -&gt; a\nfactorial n = go n 1\n  where\n    go 0 m = m\n    go n m = go (n-1) (n*m)\n</code></pre>\n\n<p>Hand in hand with this, is the fact that for most numeric types you will want the arithmetic to be strict. That boils down to adding <code>BangPatterns</code> to <code>n</code> and <code>m</code>.</p>\n"}], "owner": {"reputation": 10593, "user_id": 1233320, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qq4JP.jpg?s=128&g=1", "display_name": "markasoftware", "link": "https://stackoverflow.com/users/1233320/markasoftware"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 866, "favorite_count": 1, "accepted_answer_id": 40479539, "answer_count": 2, "score": 11, "last_activity_date": 1478591219, "creation_date": 1478581185, "last_edit_date": 1478581393, "question_id": 40479302, "link": "https://stackoverflow.com/questions/40479302/is-it-possible-to-write-a-factorial-function-as-fast-as-the-textbook-one-in-a", "title": "Is it possible to write a factorial function as fast as the &quot;textbook&quot; one in a different way?", "body": "<p>I see this as the general form of a factorial function in Haskell:</p>\n\n<pre><code>factorial :: (Integral a) =&gt; a -&gt; a\nfactorial n = product [1..n]\n</code></pre>\n\n<p>I understand this is the most elegant way, but when I write my own recursive function to do it, it's significantly slower:</p>\n\n<pre><code>factorial :: (Integral a) =&gt; a -&gt; a\nfactorial 1 = 1\nfactorial n = n * factorial (n - 1)\n</code></pre>\n\n<p>Doesn't the first solution have to do pretty much everything that the first one does, internally? How is it so much faster? Is it possible to write something as fast as the first solution without using the fancy list notation or the product function?</p>\n"}, {"tags": ["haskell", "functional-programming", "pattern-matching"], "comments": [{"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478559602, "post_id": 40476175, "comment_id": 68196979, "body": "What is your expected return type? A list of bools telling telling if the string is an infix of each string in the list?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1478567251, "post_id": 40476175, "comment_id": 68199205, "body": "Minor stylistic note, <code>isInfixOf</code> is usually used... well, infix (not because it is talking about infix things, but because of how it works grammatically).  So you&#39;d usually see <code>&quot;new&quot; `isInfixOf` &quot;I am new to Haskell&quot;</code>.  And in the case of the answers, you might see it used as a section, e.g. <code>any (&quot;new&quot; `isInfixOf`) [...]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1215, "user_id": 5292630, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9xh1qblC2Uk/AAAAAAAAAAI/AAAAAAAAAKM/GTBB97nnbYA/photo.jpg?sz=128", "display_name": "Heman Gandhi", "link": "https://stackoverflow.com/users/5292630/heman-gandhi"}, "is_accepted": true, "score": 4, "last_activity_date": 1478559768, "creation_date": 1478559768, "answer_id": 40476251, "question_id": 40476175, "link": "https://stackoverflow.com/questions/40476175/find-word-within-line-of-lines-in-haskell/40476251#40476251", "title": "find word within line of lines in haskell", "body": "<p>If you expect to get true:</p>\n\n<pre><code>any (isInfixOf \"new\") [\"I am\", \"new to\", \"Haskell too!\"]\n</code></pre>\n\n<p>If you want a list of Bool:</p>\n\n<pre><code>map (isInfixOf \"new\") [\"I am\", \"new to\", \"Haskell too!\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": false, "score": 3, "last_activity_date": 1478560217, "last_edit_date": 1478560217, "creation_date": 1478559780, "answer_id": 40476255, "question_id": 40476175, "link": "https://stackoverflow.com/questions/40476175/find-word-within-line-of-lines-in-haskell/40476255#40476255", "title": "find word within line of lines in haskell", "body": "<p>You do this by mapping the <code>isInfixOf</code> function over a list of <code>Strings</code> like so:</p>\n\n<pre><code>ghci&gt;&gt; map (isInfixOf \"new\") [\"I am\", \"new to\", \"Haskell\"]\n[False, True, False]\n</code></pre>\n\n<p><code>map</code> evaluates the predicate for each element in the list.</p>\n\n<p>Building from this, you can use other functions from <code>Data.List</code> to find out more about the list as a whole:</p>\n\n<pre><code>ghci&gt;&gt; any (isInfixOf \"new\") [\"I am\", \"new to\", \"Haskell\"]\nTrue\nghci&gt;&gt; all (isInfixOf \"new\") [\"I am\", \"new to\", \"Haskell\"]\nFalse\n</code></pre>\n"}], "owner": {"reputation": 986, "user_id": 2953798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47edc9c371f59db2f0620d0ae46d4c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Manvi", "link": "https://stackoverflow.com/users/2953798/manvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 40476251, "answer_count": 2, "score": 3, "last_activity_date": 1478560217, "creation_date": 1478559400, "question_id": 40476175, "link": "https://stackoverflow.com/questions/40476175/find-word-within-line-of-lines-in-haskell", "title": "find word within line of lines in haskell", "body": "<p>I (New to Haskell ) want to find if a word in line (of lines) is present or not. I saw few functions to achieve it like : elem, isInfixOf</p>\n\n<pre><code>Prelude DL&gt; isInfixOf \"new\" \"I am new to Haskell\"\nTrue\n\nPrelude DL&gt; elem \"new\" [\"I am\", \"new to\", \"Haskell\"]\nFalse\n</code></pre>\n\n<p>How can I implement 'isInfixOf' on every string within list of strings. </p>\n"}, {"tags": ["haskell", "menu", "io"], "comments": [{"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 6, "creation_date": 1478559295, "post_id": 40475636, "comment_id": 68196860, "body": "<a href=\"http://codereview.stackexchange.com/\">Code Review</a> might be a better place for your question."}, {"owner": {"reputation": 271, "user_id": 3727064, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/685893932/picture?type=large", "display_name": "Amoz", "link": "https://stackoverflow.com/users/3727064/amoz"}, "reply_to_user": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1479335960, "post_id": 40475636, "comment_id": 68519337, "body": "thank you! @MasterMastic"}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 2, "last_activity_date": 1478589847, "last_edit_date": 1478589847, "creation_date": 1478568371, "answer_id": 40477502, "question_id": 40475636, "link": "https://stackoverflow.com/questions/40475636/making-io-program-more-modular/40477502#40477502", "title": "Making io program more modular", "body": "<p>You're looking for the <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Except.html\" rel=\"nofollow noreferrer\">Exception monad transformer</a>.</p>\n\n<p>An example of how you might use it:</p>\n\n<pre><code>import Control.Monad.Except\n\ndata ExitType = ToMenu | Error String\n\ndeletedb :: ExceptT ExitType IO ()\ndeletedb = do\n    name &lt;- getName\n    fp &lt;- getFile name\n    liftIO $ removeFile fp\n</code></pre>\n\n<p>(or even the equivalent one-liner <code>deletedb = liftIO . removeFile =&lt;&lt; getFile =&lt;&lt; getName</code> !)</p>\n\n<p>Then you can do better exit handling in <code>getName</code> etc:</p>\n\n<pre><code>getName :: ExceptT ExitType IO String\ngetName = do\n    input &lt;- liftIO $ get \"Enter database name or 'b' to go back to the menu.\"\n    case input of\n        \"b\" -&gt; throwError ToMenu\n        _   -&gt; return input\n</code></pre>\n\n<p>A small example of running it:</p>\n\n<pre><code>menu :: IO ()\nmenu = do\n    let action = deletedb -- display menu here to choose action\n    r &lt;- runExcept action\n    case r of\n        Left ToMenu         -&gt; menu\n        Left (Error errmsg) -&gt; putStrLn errmsg &gt;&gt; menu\n        Right result        -&gt; print result\n</code></pre>\n"}], "owner": {"reputation": 271, "user_id": 3727064, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/685893932/picture?type=large", "display_name": "Amoz", "link": "https://stackoverflow.com/users/3727064/amoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "closed_date": 1478606514, "accepted_answer_id": 40477502, "answer_count": 1, "score": 0, "last_activity_date": 1478589847, "creation_date": 1478556905, "question_id": 40475636, "link": "https://stackoverflow.com/questions/40475636/making-io-program-more-modular", "closed_reason": "Needs more focus", "title": "Making io program more modular", "body": "<p>I am attempting to make a program that let's a user manipulate a database (a text file).</p>\n\n<p>In the code I am posting, I show only 2 of the menu choices, namely \"createdb\" and \"deletedb\", and a few functions I made to desperately make the functions more compact. But my problem is that the pattern is similiar for all the other menu options. I ask the user to either enter the name of the database or \"b\" to return to the menu, and then check if the file exists.</p>\n\n<p>Is there a way I can easily separate this to make my code more compact? I tried to do this part in the menu and have the choice functions be of type</p>\n\n<pre><code>FilePath -&gt; IO ()\n</code></pre>\n\n<p>But then my menu looked really terrible. Here is a small part of the code:</p>\n\n<pre><code>type Choice = (String, String, IO ())\n\nchoices :: [Choice]\nchoices =\n    [(\"a\", \"create a database\", createdb),\n    (\"b\", \"delete a database\", deletedb),\n    (\"c\", \"insert an entry to a database\", insert),\n    (\"d\", \"print a database\", selectall),\n    (\"e\", \"select entries from a database\", select),\n    -- more similiar choices\n\nmenu :: IO ()\nmenu = do\n    (mapM_ putStrLn . map showChoice) choices\n    c &lt;- get \"Enter the letter corresonding to the action of choice:\"\n    case filter ((== c) . fst3) choices of\n    [] -&gt; back \"Not a valid choice. Try again\"\n    (_, _, f) : _ -&gt; f\n\n\ncreatedb :: IO ()\ncreatedb = do\n    n &lt;- maybeName\n    if isNothing n then menu else do\n    let name = fromJust n\n    fp &lt;- maybeFile name\n    if isJust fp\n    then back $ \"Error: \\\"\" ++ name ++ \"\\\" already exist.\" \n    else do\n        cols &lt;- get \"Enter unique column names in the form n1,n2,...,n (No spaces):\"\n        let spl = (splitOnComma . toLower') cols\n        case filter (== True) (hasDuplicates spl : map (elem ' ') spl) of\n            [] -&gt; writeFile (name ++ \".txt\") (cols ++ \"\\n\")\n            _  -&gt; back \"Error: Column names must be unique and have no spaces.\"\n\ndeletedb :: IO ()\ndeletedb = do\n    n &lt;- maybeName\n    if isNothing n then menu else do\n        let name = fromJust n\n        fp &lt;- maybeFile name\n        if isJust fp\n        then removeFile (fromJust fp) \n        else back $ \"Error: Could not find \" ++ name\n\nmaybeName :: IO (Maybe String)\nmaybeName = do\n    input &lt;- get \"Enter database name or 'b' to go back to the menu.\"\n    return $ case input of\n        \"b\" -&gt; Nothing\n        _   -&gt; Just input \n\nmaybeFile :: String -&gt; IO (Maybe FilePath)\nmaybeFile name = do\n    let fn = name ++ \".txt\"\n    exists &lt;- doesFileExist fn\n    return $ if exists then Just fn else Nothing\n\nback :: String -&gt; IO ()\nback msg = do\n    putStrLn msg\n    menu\n\nget :: String -&gt; IO String\nget msg = do\n    putStrLn msg\n    getLine\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1478552131, "post_id": 40474036, "comment_id": 68193467, "body": "The first function should be <code>average (x, y, z) = ..</code> or <code>average :: Float -&gt; Float -&gt; Float -&gt; Float</code>. The second function does work.. the average of <code>[1..5]</code> is actually 3. The rational number 3 is printed as <code>3 % 1</code> (or 3 over 1) in Haskell."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1478553363, "post_id": 40474036, "comment_id": 68194093, "body": "@user2407038 That&#39;s an answer, not a comment."}], "answers": [{"tags": [], "owner": {"reputation": 644, "user_id": 400527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e917751deccfa27247406ab6bb6a56e6?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/400527/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1478646898, "creation_date": 1478646898, "answer_id": 40498037, "question_id": 40474036, "link": "https://stackoverflow.com/questions/40474036/writing-average-function-in-haskell/40498037#40498037", "title": "writing Average function in Haskell", "body": "<ol>\n<li><p>There are two different ways you could write a function of 3 numbers:</p>\n\n<ul>\n<li>a function with 3 parameters, each parameter 1 number</li>\n<li>a function with 1 parameter, the parameter is 3 numbers (a <em>tuple</em> of 3 numbers)</li>\n</ul>\n\n<p>Either is fine, but you are mixing them.</p>\n\n<p>a) 3 parameters:</p>\n\n<pre><code>average_3_params :: Float -&gt; (Float -&gt; (Float -&gt; Float))\naverage_3_params x y z = (x+y+z)/3\n</code></pre>\n\n<p>How to read this is: <code>average_3_params</code> is a function from a <code>Float</code> to a function of 2 parameters, and so on (note that the parenthesis in the type are optional, I'm just being pedantic. <code>Float -&gt; Float -&gt; Float -&gt; Float</code> is equivalent).</p>\n\n<p>b) Tuple parameter</p>\n\n<pre><code>average_tuple :: (Float, Float, Float) -&gt; Float \naverage_tuple (x, y, z) = (x+y+z)/3\n</code></pre>\n\n<p>Here, the function has a single parameter, but that parameter contains 3 <code>Float</code>s and we use <em>pattern matching</em> to extract the primitive values.</p></li>\n<li><p><code>3 % 1</code> is the average of <code>[1..5]</code>. Note that your function returns a <code>Rational</code>, not a <code>Float</code>. A <code>Rational</code> is a fraction: read the <code>%</code> as a division bar.</p></li>\n</ol>\n\n<p>A couple side notes. While a) seems a bit odd at first, it turns out to be very handy as it gives you partial application (currying) for free. Regarding <code>Float</code>, you should probably be using <code>Double</code> [0].</p>\n\n<p>[0] <a href=\"https://wiki.haskell.org/Performance/Floating_point\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Performance/Floating_point</a></p>\n"}], "owner": {"reputation": 15, "user_id": 6230499, "user_type": "registered", "profile_image": "https://graph.facebook.com/1539483603013227/picture?type=large", "display_name": "Ham", "link": "https://stackoverflow.com/users/6230499/ham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1341, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1478646898, "creation_date": 1478550644, "question_id": 40474036, "link": "https://stackoverflow.com/questions/40474036/writing-average-function-in-haskell", "title": "writing Average function in Haskell", "body": "<p>1) I am trying to write function that computes the average of three numbers\nI wrote something like </p>\n\n<pre><code>average :: (Float,Float,Float) -&gt; Float \naverage x y z = (x+y+z)/3\n</code></pre>\n\n<p>but it wouldn't work for some reason</p>\n\n<p>can someone guide me how to write a function that takes 3 numbers and compute their average ?</p>\n\n<p>2 ) I got this average function from a textbook but when i tried to run it </p>\n\n<pre><code>    average :: [Int] -&gt; Rational\n    average [] = error \"empty list\"\n    average xs = toRational (sum xs) / toRational(length xs)\n</code></pre>\n\n<p>for example if I entered average [1..5] in the compiler\nthe output become \n3 % 1 , it doesn't print the average of the values.</p>\n"}, {"tags": ["haskell", "syntax", "syntax-error"], "comments": [{"owner": {"reputation": 2678, "user_id": 5699206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b779af6a871be4c7cd891113f722f62?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Young", "link": "https://stackoverflow.com/users/5699206/joseph-young"}, "edited": false, "score": 9, "creation_date": 1478548928, "post_id": 40473597, "comment_id": 68191721, "body": "I don&#39;t think you can use back ticks (```), try using single quotes (<code>&#39;</code>)"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 2678, "user_id": 5699206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b779af6a871be4c7cd891113f722f62?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Young", "link": "https://stackoverflow.com/users/5699206/joseph-young"}, "edited": false, "score": 0, "creation_date": 1479202221, "post_id": 40473597, "comment_id": 68447178, "body": "@JosephYoung since your comment solved the problem, can you post it as an answer so it can be accepted?"}], "answers": [{"tags": [], "owner": {"reputation": 2678, "user_id": 5699206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b779af6a871be4c7cd891113f722f62?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Young", "link": "https://stackoverflow.com/users/5699206/joseph-young"}, "is_accepted": false, "score": 4, "last_activity_date": 1576822383, "last_edit_date": 1576822383, "creation_date": 1479233107, "answer_id": 40616731, "question_id": 40473597, "link": "https://stackoverflow.com/questions/40473597/haskell-displays-a-parse-error/40616731#40616731", "title": "Haskell displays a parse error", "body": "<p>As per the advice in the comments, I have moved my comment to an answer:</p>\n\n<p>I don't think you can use back ticks (<code>`</code>), try using single quotes (<code>'</code>)</p>\n\n<p>So it'd be:</p>\n\n<pre><code>sum' :: [Int] -&gt; Int\nsum' [] = 0\nsum' (x:xs) = x + sum' xs\n\nlength' :: [a] -&gt; Int\nlength' [] = 0\nlength' (x:xs) = 1 + length' xs\n\naverage :: [Int] -&gt; Rational\naverage [] = error \"empty list\"\naverage xs = toRational (sum xs) / toRational(length xs)\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6230499, "user_type": "registered", "profile_image": "https://graph.facebook.com/1539483603013227/picture?type=large", "display_name": "Ham", "link": "https://stackoverflow.com/users/6230499/ham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576854150, "creation_date": 1478548824, "last_edit_date": 1576854150, "question_id": 40473597, "link": "https://stackoverflow.com/questions/40473597/haskell-displays-a-parse-error", "title": "Haskell displays a parse error", "body": "<p>Can someone please help me? I am trying to run the <code>average</code> function but I get an error that reads \"(parse error) on input '::'\" for this code:</p>\n\n<pre><code>sum` :: [Int] -&gt; Int\nsum` [] = 0\nsum` (x:xs) = x + sum` xs\n\nlength` :: [a] -&gt; Int\nlength` [] = 0\nlength` (x:xs) = 1 + length` xs\n\naverage :: [Int] -&gt; Rational\naverage [] = error \"empty list\"\naverage xs = toRational (sum xs) / toRational(length xs)\n</code></pre>\n\n<p>Many thanks</p>\n"}, {"tags": ["javascript", "haskell", "functional-programming", "bind", "monads"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1478548262, "post_id": 40473118, "comment_id": 68191323, "body": "The rule of thumb is: <code>bind(...)(x =&gt; ...)</code> takes the value of the previous computation and binds it to <code>x</code>. Other lambdas <code>x =&gt; ...</code> (not after a bind) instead access the same implicit read-only argument, the one passed to <code>f</code> at the very beginning."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1478548321, "post_id": 40473118, "comment_id": 68191356, "body": "Side note: <code>x =&gt; x &lt;= 5 ? x =&gt; x * 2 : x =&gt; x * 3</code> is unreadable, please use e.g. <code>x =&gt; x &lt;= 5 ? y =&gt; y * 2 : z =&gt; z * 3</code> -- a computer does not care about alpha-equivalence, but humans do ;-)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1478548440, "post_id": 40473118, "comment_id": 68191421, "body": "Because it <i>must</i> - that function is the only valid implementation of a function whose type is <code>forall r a b . (r -&gt; a) -&gt; (a -&gt; (r -&gt; b)) -&gt; r -&gt; b</code> (except undefined, of course). The javascript function can of course do whatever it likes in the abscence of formal types, but then reasoning about it would be much harder (and called it <code>bind</code> would just be wrong)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1478550329, "post_id": 40473118, "comment_id": 68192497, "body": "That is precisely how <code>&gt;&gt;=</code> differs from <code>.</code> in the function monad. With <code>f . g</code>, <code>f</code> doesn&#39;t get any information about what was passed to <code>g</code>, only what <code>g</code> produced. With <code>g &gt;&gt;= f</code>, <code>f</code> gets <i>both</i> the input to <i>and</i> the output from of <code>g</code>."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1478575270, "post_id": 40473118, "comment_id": 68201194, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/5310203/how-to-use-instances-of-monad-and-confusion-about\">How to use (-&gt;) instances of Monad and confusion about (-&gt;)</a>"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1478576895, "post_id": 40473118, "comment_id": 68201548, "body": "Note that if your second function <i>wasn&#39;t</i> getting the output of <code>inc</code>, it would actually return 10. You only get 15 because <code>inc</code> turns the 5 into a 6 before the second function does the <code>x &lt;= 5</code> test, which triggers multiplication of the <i>other</i> parameter by 3 instead of 2. Your <code>f(5)</code> case is actually precisely what you needed to demonstrate that the behaviour is more complicated than <i>either</i> &quot;both functions get the same input&quot; or &quot;the second gets the output of the first&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1478633520, "post_id": 40473118, "comment_id": 68234057, "body": "@Cactus Your link is indeed helpful, still I don&#39;t think my question is a dupe, because it is more specific and more importantly, it is a cross language. I know that the monad concept is language agnostic, but people are not."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1478627257, "post_id": 40473937, "comment_id": 68230809, "body": "OK, I won&#39;t use monadic function anymore, but <i>action</i> or <i>kleisli arrow</i>. Thanks!"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 1, "last_activity_date": 1478550263, "creation_date": 1478550263, "answer_id": 40473937, "question_id": 40473118, "link": "https://stackoverflow.com/questions/40473118/why-does-bind-of-the-function-instance-supply-the-original-value-to-the-next-com/40473937#40473937", "title": "Why does bind of the function instance supply the original value to the next computation?", "body": "<blockquote>\n  <p>More generally, the monadic function along with its corresponding bind\n  operator seems to give us the capability to define what function\n  composition means in a specific computational context.</p>\n</blockquote>\n\n<p>I'm not sure what you mean by the \"monadic function\". Monads (which in Haskell consist of a bind function and a pure function) let you express <strong>how a series of monadic actions can be chained together</strong> (<a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Monad.html#v:-60--61--60-\" rel=\"nofollow noreferrer\"><code>(&lt;=&lt;)</code></a> is the monad equivalent of composition, equivalent to <code>(.)</code> for the <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Functor-Identity.html\" rel=\"nofollow noreferrer\"><code>Identity</code></a> monad). In that sense, you do sort of get composition, but only composition of <em>actions</em> (functions of the form <code>a -&gt; m b</code>).</p>\n\n<p>(This is further abstracted in the <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Arrow.html#t:Kleisli\" rel=\"nofollow noreferrer\"><code>Kleisli</code></a> newtype around functions of the type <code>a -&gt; m b</code>. Its <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/src/Control.Arrow.html#line-151\" rel=\"nofollow noreferrer\">category instance</a> really lets you write the sequencing of monadic actions as composition.)</p>\n\n<blockquote>\n  <p>I'd expect f(2)/f(5) to yield 6/18, similar to normal function composition.</p>\n</blockquote>\n\n<p>Then, you can just use normal function composition! Don't use a monad if you don't need one.</p>\n\n<blockquote>\n  <p>It is all the more surprising that the monadic function doesn't supply\n  the result of the previous computation to the subsequent one. Instead,\n  the original value is passed.   ...   Is this behavior specific to\n  functions as monads?</p>\n</blockquote>\n\n<p>Yes, it it. The monad <code>Monad ((-&gt;) r)</code> is also known as the \"reader monad\" because it only <em>reads</em> from its environment. That said, as far as monads are concerned, you <em>are</em> still passing the monadic result of the previous action to the subsequent one - but those results are themselves functions!</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1478627068, "post_id": 40473938, "comment_id": 68230688, "body": "Thanks for your answer. I guess your last example is rather an unusual use of <code>bind</code>, right?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1478633519, "post_id": 40473938, "comment_id": 68234056, "body": "Not at all! Every <code>Monad</code> instance definition requires, besides <code>bind</code>, another function that puts a pure value in a &quot;neutral&quot; context. In Haskell that other function is (confusingly) named <code>return</code>. <code>return</code> for the function/Reader monads in just the constant function that receives the environment and ignores it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 1, "creation_date": 1478633659, "post_id": 40473938, "comment_id": 68234128, "body": "ah, <code>return</code> of the <code>(-&gt;)</code> instance is just the <code>K</code> combinator. Got it!"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1478551640, "last_edit_date": 1478551640, "creation_date": 1478550265, "answer_id": 40473938, "question_id": 40473118, "link": "https://stackoverflow.com/questions/40473118/why-does-bind-of-the-function-instance-supply-the-original-value-to-the-next-com/40473938#40473938", "title": "Why does bind of the function instance supply the original value to the next computation?", "body": "<p>As already mentioned by chi, this line</p>\n\n<pre><code>const f = bind(inc) (x =&gt; x &lt;= 5 ? x =&gt; x * 2 : x =&gt; x * 3);\n</code></pre>\n\n<p>would be clearer as something like </p>\n\n<pre><code>const f = bind(inc) (x =&gt; x &lt;= 5 ? y =&gt; y * 2 : y =&gt; y * 3);\n</code></pre>\n\n<p>the <code>Monad</code> instance for functions is basically the <code>Reader</code> monad. You have a value <code>x =&gt; x + 1</code> that depends on an enviroment (it adds 1 to the environment).</p>\n\n<p>You also have a function which, depending on its input, returns one value that depends on an environment (<code>y =&gt; y * 2</code>) or another value that depends on an environment (<code>y =&gt; y * 3</code>).</p>\n\n<p>In your <code>bind</code>, you are only using the result of <code>x =&gt; x + 1</code> to <em>choose</em> between these two functions. Your are not returning the previous result <em>directly</em>. But you could, if you returned <em>constant functions</em> which <em>ignored</em> their environments and returned a fixed value depending only on the previous result:</p>\n\n<pre><code>const f = bind(inc) (x =&gt; x &lt;= 5 ? _ =&gt; x * 2 : _ =&gt; x * 3);\n</code></pre>\n\n<p>(not sure about the syntax)</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1478626755, "post_id": 40474144, "comment_id": 68230477, "body": "Great, extensive response, Thanks! <code>r</code> and <code>a</code> can be of different type of course. And with the given type for <code>&gt;&gt;=</code>, no other valid implementation is possible. What I like about <code>(-&gt;)</code> instances of Monads, Applicatives and Functors is that that they are a familiar concept (combinators) applied within another concept, which is quite strange to me. They are a suitable starting point to understand this new concept. Programming to mathematical interfaces is hard, especially in Javascript where you can just make stuff up. I guess I just took another step forward. Thanks again!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1478683418, "post_id": 40474144, "comment_id": 68249957, "body": "Functions can be seen as a kind of type constructor, because they may transform an <code>r</code> in an <code>a</code> of different type. When <code>m a</code>/<code>m b</code> within <code>(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b</code> are functions of type <code>(r -&gt; a)</code>/<code>(r -&gt; b)</code>, there is no alternative for <code>(r -&gt; b)</code> to ignore the result <code>a</code> of the previous operation. Provided that <code>(r -&gt; a)</code> is of type <code>(r -&gt; r)</code> you can use the <code>K</code> combinator to pass the computed value to <code>(r -&gt; b)</code>, because <code>K</code> is <code>return</code> for the function instance. Sorry if I should repeat myself, but I finally understood it."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1478551433, "last_edit_date": 1478551433, "creation_date": 1478551017, "answer_id": 40474144, "question_id": 40473118, "link": "https://stackoverflow.com/questions/40473118/why-does-bind-of-the-function-instance-supply-the-original-value-to-the-next-com/40474144#40474144", "title": "Why does bind of the function instance supply the original value to the next computation?", "body": "<p>I think your confusion arises from using functions that are too simple. In particular, you write</p>\n\n<pre><code>const inc = x =&gt; x + 1;\n</code></pre>\n\n<p>whose type is a function that returns values in the <em>same</em> space as its input. Let's say <code>inc</code> is dealing with integers. Because both its input and output are integers, if you have another function <code>foo</code> that takes integers, it is easy to imagine using the <em>output</em> of <code>inc</code> as an <em>input</em> to <code>foo</code>.</p>\n\n<p>The real world includes more exciting functions, though. Consider the function <code>tree_of_depth</code> that takes an integer and creates a tree of strings of that depth. (I won't try to implement it, because I don't know enough javascript to do a convincing job of it.) Now all of a sudden it's harder to imagine passing the output of <code>tree_of_depth</code> as an input to <code>foo</code>, since <code>foo</code> is expecting integers and <code>tree_of_depth</code> is producing trees, right? The only thing we can pass on to <code>foo</code> is the <em>input</em> to <code>tree_of_depth</code>, because that's the only integer we have lying around, even after running <code>tree_of_depth</code>.</p>\n\n<p>Let's see how that manifests in the Haskell type signature for bind:</p>\n\n<pre><code>(&gt;&gt;=) :: (r -&gt; a) -&gt; (a -&gt; r -&gt; b) -&gt; (r -&gt; b)\n</code></pre>\n\n<p>This says that <code>(&gt;&gt;=)</code> takes two arguments, each functions. The first function can be of any old type you like -- it can take a value of type <code>r</code> and produce a value of type <code>a</code>. In particular, you don't have to promise that <code>r</code> and <code>a</code> are the same at all. But once you pick its type, then the type of the next function argument to <code>(&gt;&gt;=)</code> is constrained: it has to be a function of two arguments whose types are the <em>same</em> <code>r</code> and <code>a</code> as before.</p>\n\n<p>Now you can see why we have to pass the same value of type <code>r</code> to both of these functions: the first function produces an <code>a</code>, not an updated <code>r</code>, so we have no other value of type <code>r</code> to pass to the second function! Unlike your situation with <code>inc</code>, where the first function happened to also <em>produce</em> an <code>r</code>, we may be producing some other very different type.</p>\n\n<p>This explains why bind has to be implemented the way it is, but maybe doesn't explain why this monad is a useful one. There is writing elsewhere on that. But the canonical use case is for configuration variables. Suppose at program start you parse a configuration file; then for the rest of the program, you want to be able to influence the behavior of various functions by looking at information from that configuration. In all cases it makes sense to use the same configuration information -- it doesn't need to change. Then this monad becomes useful: you can have an implicit configuration value, and the monad's bind operation makes sure that the two functions you're sequencing both have access to that information without having to manually pass it in to both functions.</p>\n\n<p>P.S. You say</p>\n\n<blockquote>\n  <p>It is all the more surprising that the monadic function doesn't supply the result of the previous computation to the subsequent one.</p>\n</blockquote>\n\n<p>which I find slightly imprecise: in fact in <code>m &gt;&gt;= f</code>, the function <code>f</code> gets <em>both</em> the result of <code>m</code> (as its first argument) <em>and</em> the original value (as its second argument).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 40474144, "answer_count": 3, "score": 2, "last_activity_date": 1478551640, "creation_date": 1478547137, "last_edit_date": 1478547874, "question_id": 40473118, "link": "https://stackoverflow.com/questions/40473118/why-does-bind-of-the-function-instance-supply-the-original-value-to-the-next-com", "title": "Why does bind of the function instance supply the original value to the next computation?", "body": "<p>As a functional Javascript developer with only a vague understanding of Haskell I really have a hard time to understand Haskell idioms like monads. When I look at <code>&gt;&gt;=</code> of the function instance</p>\n\n<pre><code>(&gt;&gt;=)  :: (r -&gt; a) -&gt; (a -&gt; (r -&gt; b)) -&gt; r -&gt; b\n\ninstance Monad ((-&gt;) r) where\nf &gt;&gt;= k = \\ r -&gt; k (f r) r\n\n// Javascript:\n</code></pre>\n\n<p>and its application with Javascript</p>\n\n<pre><code>const bind = f =&gt; g =&gt; x =&gt; g(f(x)) (x);\n\nconst inc = x =&gt; x + 1;\n\nconst f = bind(inc) (x =&gt; x &lt;= 5 ? x =&gt; x * 2 : x =&gt; x * 3);\n\n\nf(2); // 4\nf(5); // 15\n</code></pre>\n\n<p>the monadic function <code>(a -&gt; (r -&gt; b))</code> (or <code>(a -&gt; m b)</code>) provides a way to choose the next computation depending on the previous result. More generally, the monadic function along with its corresponding <code>bind</code> operator seems to give us the capability to define what function composition means in a specific computational context.</p>\n\n<p>It is all the more surprising that the monadic function doesn't supply the result of the previous computation to the subsequent one. Instead, the original value is passed. I'd expect <code>f(2)</code>/<code>f(5)</code> to yield <code>6</code>/<code>18</code>, similar to normal function composition. Is this behavior specific to functions as monads? What do I misunderstand?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1478547162, "post_id": 40473096, "comment_id": 68190658, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/16811376/haskell-simulate-global-variablefunction\">Haskell - simulate global variable(function)</a>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1478547231, "post_id": 40473096, "comment_id": 68190700, "body": "@Rakete1111 OP doesn&#39;t need to write state, only read."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478547341, "post_id": 40473096, "comment_id": 68190756, "body": "@Alec But you can&#39;t change variables in any case in Haskell, right? Nonetheless, OP needs to write the input from the user into it."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1478547483, "post_id": 40473096, "comment_id": 68190836, "body": "@Rakete1111 Yes, Haskell is immutable. Yes, despite that we still can simulate mutable state. But just initializing a reading store that you pass around doesn&#39;t need the full power of state. I&#39;ll add an answer."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1478547935, "post_id": 40473096, "comment_id": 68191123, "body": "The question is vague about whether the other functions need to change the value of the &quot;global&quot; variable. A <code>State</code> monad <i>might</i> be appropriate."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1478548110, "post_id": 40473096, "comment_id": 68191228, "body": "@chepner Agreed. Also, on second thought this seems like a question that has probably been asked before. Maybe it would be better to find another post with a thorough answer for which this is a duplicate..."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1478548523, "post_id": 40473096, "comment_id": 68191480, "body": "No - &quot;Is there a way to do this other than adding &#39;width&#39; as an argument to every function?&quot; - everything you can possible do to fix this is just that in disguise (state monad, reader monad, etc). Depending on your code, it may be easy or hard to integrate this additional abstraction."}], "answers": [{"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": false, "score": 3, "last_activity_date": 1478611183, "last_edit_date": 1478611183, "creation_date": 1478549327, "answer_id": 40473724, "question_id": 40473096, "link": "https://stackoverflow.com/questions/40473096/make-variable-from-input-accessible-from-the-whole-code/40473724#40473724", "title": "Make variable from input accessible from the whole code", "body": "<p>I'll show a simple example of reader monad usage.</p>\n\n<p>This code:</p>\n\n<pre><code>area :: Double -&gt; Double -&gt; Double\narea height width = height * width\n\nmain = do\n  width &lt;- fmap read getLine\n  let result = area 42 width\n  print result\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code>import Control.Monad.Reader\n\narea :: MonadReader Double m =&gt; Double -&gt; m Double\narea height = do\n  width &lt;- ask\n  return (width * height)\n\nmain :: IO ()\nmain = do\n  width &lt;- fmap read getLine\n  let result = runReader (area 42) width\n  print result\n</code></pre>\n\n<p>This seems more complicated, but it's actually quite nice when you have a lot of \"configuration\" parameters to pass around.</p>\n\n<pre><code>import Control.Monad.Reader\n\ndata Config = Config { width :: Double, color :: String, etc :: String }\n\narea :: MonadReader Config m =&gt; Double -&gt; m Double\narea height = do\n  w &lt;- asks width\n  return (w * height)\n\nmain :: IO ()\nmain = do\n  w &lt;- fmap read getLine\n  c &lt;- undefined -- todo get color param\n  e &lt;- undefined -- todo get etc param\n  let result = runReader (area 42) (Config w c e)\n  print result\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7122528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/23473dff9c157201707b7a8c67debf80?s=128&d=identicon&r=PG&f=1", "display_name": "Hedhed", "link": "https://stackoverflow.com/users/7122528/hedhed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1478611183, "creation_date": 1478547053, "last_edit_date": 1478547171, "question_id": 40473096, "link": "https://stackoverflow.com/questions/40473096/make-variable-from-input-accessible-from-the-whole-code", "title": "Make variable from input accessible from the whole code", "body": "<p>Is this even possible? I have a main that saves an Int (width) given by the user as a variable, but I need that variable in a bunch of other functions... Is there a way to do this other than adding 'width' as an argument to every function? </p>\n"}, {"tags": ["haskell", "haskell-turtle"], "comments": [{"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 2, "creation_date": 1478639607, "post_id": 40472737, "comment_id": 68237201, "body": "You know about <code>System.Process</code>, right? Specifically <code>callProcess &quot;python&quot; []</code>."}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 2, "creation_date": 1478640890, "post_id": 40472737, "comment_id": 68237750, "body": "and in a turtle context: <code>view $ liftIO $ callProcess &quot;python&quot; []</code>"}, {"owner": {"reputation": 5502, "user_id": 350127, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c46a4215e49e00007cd622b75df75f91?s=128&d=identicon&r=PG", "display_name": "yilmazhuseyin", "link": "https://stackoverflow.com/users/350127/yilmazhuseyin"}, "reply_to_user": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1478735692, "post_id": 40472737, "comment_id": 68277583, "body": "That is exactly what I was looking for. Thanks @ja"}, {"owner": {"reputation": 596, "user_id": 1528262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c99f85fbe3fd4389f61ad7c04cf3376?s=128&d=identicon&r=PG", "display_name": "Jan Hrcek", "link": "https://stackoverflow.com/users/1528262/jan-hrcek"}, "edited": false, "score": 0, "creation_date": 1579159178, "post_id": 40472737, "comment_id": 105673747, "body": "Or even better in Turtle (if you don&#39;t want to see the <code>()</code> being printed out after the interactive process exits): <code>sh $ liftIO $ callProcess &quot;python&quot; []</code>"}], "answers": [{"tags": [], "owner": {"reputation": 596, "user_id": 1528262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c99f85fbe3fd4389f61ad7c04cf3376?s=128&d=identicon&r=PG", "display_name": "Jan Hrcek", "link": "https://stackoverflow.com/users/1528262/jan-hrcek"}, "is_accepted": false, "score": 1, "last_activity_date": 1579159440, "creation_date": 1579159440, "answer_id": 59764737, "question_id": 40472737, "link": "https://stackoverflow.com/questions/40472737/running-interactive-commands-with-haskell-turtle-library/59764737#59764737", "title": "Running interactive commands with haskell turtle library", "body": "<p>Here's a complete working example extracted from comments.\nTu run interactive process via Turtle you can do something like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>#!/usr/bin/env stack\n-- stack script --resolver lts-14.20 --package turtle --package process\n{-# LANGUAGE OverloadedStrings #-}\n\nimport System.Process (callProcess)\nimport Turtle (sh, liftIO)\n\nmain :: IO ()\nmain = sh $ liftIO $ callProcess \"python\" []\n</code></pre>\n"}], "owner": {"reputation": 5502, "user_id": 350127, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c46a4215e49e00007cd622b75df75f91?s=128&d=identicon&r=PG", "display_name": "yilmazhuseyin", "link": "https://stackoverflow.com/users/350127/yilmazhuseyin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1579159440, "creation_date": 1478545781, "question_id": 40472737, "link": "https://stackoverflow.com/questions/40472737/running-interactive-commands-with-haskell-turtle-library", "title": "Running interactive commands with haskell turtle library", "body": "<p>I am trying to run an interactive command with haskell turtle library like this:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --install-ghc runghc --package turtle\n{-# LANGUAGE OverloadedStrings #-}\nimport Turtle\nmain = procs \"python\" [] empty\n</code></pre>\n\n<p>(I also tried shells function but it does not work either.)\nWhen I run it nothing hapens:</p>\n\n<pre><code>$ ./turtleTest.hs\n$\n</code></pre>\n\n<p>But if I change \"python\" command to \"ls\" it works.</p>\n\n<p>How can I run an interactive command like python repl with turtle library?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 5, "creation_date": 1478543621, "post_id": 40472079, "comment_id": 68188713, "body": "Imports should come before any other definitions. The <code>forM_ = flip mapM_</code> line in that post is not part of the code, so just delete it."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1478547123, "post_id": 40472079, "comment_id": 68190634, "body": "@duplode That&#39;s an answer, not a comment!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1478547203, "post_id": 40472079, "comment_id": 68190682, "body": "Also, I object to the close votes: this is very much reproducible, and isn&#39;t a typo. This seems like a perfectly cromulent (if simple) question to me."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1478566299, "post_id": 40472079, "comment_id": 68198957, "body": "@DanielWagner Though I was one of the close voters, on second thought there is a decent case for keeping this question, specially given that, perhaps surprisingly, there seem to be no other questions specifically about this error. That being so, I have retracted my vote and will convert the comment into an answer."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 7, "last_activity_date": 1478566871, "creation_date": 1478566871, "answer_id": 40477290, "question_id": 40472079, "link": "https://stackoverflow.com/questions/40472079/haskell-parse-error-on-input-import/40477290#40477290", "title": "Haskell: parse error on input `import&#39;", "body": "<blockquote>\n<pre><code>Test4.hs:2:1: parse error on input `import'\n</code></pre>\n</blockquote>\n\n<p>The error points to the second line of your file. Quoting the first two lines:</p>\n\n<pre><code>forM_ = flip mapM_\nimport Control.Monad.Cont\n</code></pre>\n\n<p>The problem is that an import declaration must be at the beginning of a module, before any definitions (the only things that can come before an import are language pragmas, such as those used to enable GHC extensions, and the module declaration). In your case, the first line of the file is a definition, and so the misplaced import declaration in the second line leads to a parse error. Since that first line wasn't actually part of the code snippet in the post you linked to, you can simply delete it.</p>\n"}], "owner": {"reputation": 762, "user_id": 2155026, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/74f90f8ee0116e12bc6f44d9371ed09b?s=128&d=identicon&r=PG", "display_name": "Omar Shehab", "link": "https://stackoverflow.com/users/2155026/omar-shehab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6675, "favorite_count": 1, "accepted_answer_id": 40477290, "answer_count": 1, "score": 3, "last_activity_date": 1478566887, "creation_date": 1478543454, "last_edit_date": 1478566887, "question_id": 40472079, "link": "https://stackoverflow.com/questions/40472079/haskell-parse-error-on-input-import", "title": "Haskell: parse error on input `import&#39;", "body": "<p>I am trying to recreate the output of <a href=\"https://lotz84.github.io/haskellbyexample/ex/for\" rel=\"nofollow noreferrer\">this Haskell code</a>:</p>\n\n<pre><code>forM_ = flip mapM_\nimport Control.Monad.Cont\n\nmain = do\n    forM_ [1..3] $ \\i -&gt; do\n        print i\n\nforM_ [7..9] $ \\j -&gt; do\n    print j\n\nwithBreak $ \\break -&gt;\n    forM_ [1..] $ \\_ -&gt; do\n        p \"loop\"\n        break ()\n\nwhere\nwithBreak = (`runContT` return) . callCC\np = liftIO . putStrLn\n</code></pre>\n\n<p>The expected output is as follows:</p>\n\n<pre><code>$ runhaskell for.hs\n1\n2\n3\n7\n8\n9\nloop\n</code></pre>\n\n<p>But I am getting the following error:</p>\n\n<pre><code> Test4.hs:2:1: parse error on input `import'\n</code></pre>\n\n<p>Any ideas about what is going wrong?</p>\n"}, {"tags": ["list", "function", "haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1478541286, "post_id": 40471203, "comment_id": 68187372, "body": "Note that the empty list base case is unnecessary here, as <code>map</code> handles empty lists just fine, and in the way you are thinking of. Cf. pdoherty926&#39;s answer."}], "answers": [{"comments": [{"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 1, "creation_date": 1478542788, "post_id": 40471283, "comment_id": 68188263, "body": "Which we can eta-reduce to <code>sqrall = map (^2)</code>"}], "tags": [], "owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "is_accepted": false, "score": 3, "last_activity_date": 1478541247, "last_edit_date": 1478541247, "creation_date": 1478540568, "answer_id": 40471283, "question_id": 40471203, "link": "https://stackoverflow.com/questions/40471203/square-of-list-in-haskell/40471283#40471283", "title": "Square of list in Haskell", "body": "<p>You'll need to remove the square brackets from the non-empty list pattern on the left side of your function definition.</p>\n\n<p>The following will work:</p>\n\n<pre><code>sqrall x = map (^2) x\nsqrall [1,2,3] -- [1,4,9]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7025954"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3324, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1478541332, "creation_date": 1478540262, "last_edit_date": 1478541332, "question_id": 40471203, "link": "https://stackoverflow.com/questions/40471203/square-of-list-in-haskell", "title": "Square of list in Haskell", "body": "<p>I am making function in Haskell to get the square of the list. Here is my code</p>\n\n<pre><code>sqrall :: [Int] -&gt; [Int]\nsqrall [] = []\nsqrall [x] =  map (^2) x\n</code></pre>\n\n<p>But that code is not working.i don't know where i am missing.. Please help me..</p>\n"}, {"tags": ["haskell", "haskell-pipes", "http-conduit"], "answers": [{"comments": [{"owner": {"reputation": 986, "user_id": 2953798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47edc9c371f59db2f0620d0ae46d4c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Manvi", "link": "https://stackoverflow.com/users/2953798/manvi"}, "edited": false, "score": 0, "creation_date": 1478541389, "post_id": 40471412, "comment_id": 68187429, "body": "Thanks Thomas for your reply and explanation of problem. Can you please suggest some link or some example to do what you suggested?"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1478541039, "creation_date": 1478541039, "answer_id": 40471412, "question_id": 40471018, "link": "https://stackoverflow.com/questions/40471018/understanding-error-in-haskell/40471412#40471412", "title": "Understanding error in haskell", "body": "<p><code>simpleHttp WebLink</code> appears to be a monadic action that <em>returns</em> a value, it's not a ByteString itself.  You must run the procedure, obtaining the value, then (assuming it is a bytestring) you can unpack it.</p>\n\n<p>Note that the <a href=\"http://hackage.haskell.org/package/HTTP-4000.3.3/docs/Network-HTTP.html#v:simpleHTTP\" rel=\"nofollow noreferrer\"><code>simpleHttp</code></a> procedure I know of does not return a bytestring.  You'll want to pattern match on the return value to inspect the <code>Either</code> type, if it is a response message instead of a failure then you can further pattern match on the response.</p>\n"}, {"tags": [], "owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "is_accepted": true, "score": 3, "last_activity_date": 1478545968, "last_edit_date": 1478545968, "creation_date": 1478544778, "answer_id": 40472457, "question_id": 40471018, "link": "https://stackoverflow.com/questions/40471018/understanding-error-in-haskell/40472457#40472457", "title": "Understanding error in haskell", "body": "<p><code>simpleHttp \"http://example.com\"</code> is of type <code>m ByteString</code>, for some monad <code>m</code>, so for example of type <code>IO ByteString</code>. Using <code>do</code> notation you can get at the result.</p>\n\n<pre><code>import Network.HTTP.Conduit\nimport qualified Data.ByteString.Lazy.Char8 as LB\n\nmain :: IO ()\nmain = do\n  res &lt;- simpleHttp \"http://example.com\"\n  let string = LB.unpack res\n  putStr string\n</code></pre>\n\n<p>Or in ghci,</p>\n\n<pre><code>ghci&gt; res &lt;- simpleHttp \"http://example.com\"\nghci&gt; LB.unpack res\n</code></pre>\n"}], "owner": {"reputation": 986, "user_id": 2953798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47edc9c371f59db2f0620d0ae46d4c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Manvi", "link": "https://stackoverflow.com/users/2953798/manvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 40472457, "answer_count": 2, "score": 1, "last_activity_date": 1478545968, "creation_date": 1478539618, "question_id": 40471018, "link": "https://stackoverflow.com/questions/40471018/understanding-error-in-haskell", "title": "Understanding error in haskell", "body": "<p>I (New to Haskell) am trying to perform unpack operation on ByteString that I receive from webpage. Basically I want to search few words from webpage so I am trying to tokenize stream, then search word from words.</p>\n\n<pre><code>Prelude Network.HTTP.Conduit LB&gt; LB.unpack (simpleHttp WebLink)\n</code></pre>\n\n<p>But I am getting below error </p>\n\n<pre><code>&lt;interactive&gt;:75:12: error:\n\u2022 Couldn't match expected type \u2018LB.ByteString\u2019\n              with actual type \u2018m0 LB.ByteString\u2019\n\u2022 In the first argument of \u2018LB.unpack\u2019, namely...\n</code></pre>\n\n<p>From hackage I can see that its signature is </p>\n\n<pre><code>unpack :: ByteString -&gt; [Word8] Source\nO(n) Converts a ByteString to a '[Word8]'.\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1478533806, "post_id": 40469033, "comment_id": 68182693, "body": "Why don&#39;t you indeed use <code>filter</code> as a preprocessing step? As in <code>averageBetween list = postProcess $ filter (\\x -&gt; somePredicateOn x) list</code>"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 1, "creation_date": 1478534224, "post_id": 40469206, "comment_id": 68182965, "body": "Thank you, that helped. I consulted the haskell documentation but I guess the &quot;filter&quot; function went over my head. I will take note of this in the future."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 3, "creation_date": 1478534958, "post_id": 40469206, "comment_id": 68183431, "body": "@Rad Perhaps you already know about it, but another option in such cases is <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">Hoogle</a>, which searches not only by name but also by type signature (try <code>(a -&gt; Bool) -&gt; [a] -&gt; [a]</code>). The Hoogle instance at haskell.org defaults to only searching within &quot;standard&quot; libraries. If you need a broader range of packages, you can try <a href=\"https://www.stackage.org/lts\" rel=\"nofollow noreferrer\">Stackage&#39;s Hoogle</a>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1478544537, "post_id": 40469206, "comment_id": 68189214, "body": "Note that it&#39;s easier to read (and probably just as efficient) to compose two calls to <code>filter</code>. <code>averageBetween a b = average . filter (&gt;= (min a b)) . filter (&lt;= (max a b))</code>."}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": true, "score": 1, "last_activity_date": 1478533885, "creation_date": 1478533885, "answer_id": 40469206, "question_id": 40469033, "link": "https://stackoverflow.com/questions/40469033/performing-operation-on-a-sublist-that-passes-a-certain-test/40469206#40469206", "title": "Performing operation on a Sublist that passes a certain test", "body": "<p>The good news is that, aside from a missing closing parenthesis, your <code>average</code> function works as expected and can be used in your <code>averageBetween</code> function. To find the average of values between a given <code>a</code> and <code>b</code> in a list, we'll need to filter the list, as you said, eliminating values greater than <code>max a b</code> and less than <code>min a b</code>. This is important in case we are given our arguments in reverse. Our predicate would thus look something like this:</p>\n\n<pre><code>(\\x -&gt; (x &gt;= (min a b)) &amp;&amp; (x &lt;= (max a b)))\n</code></pre>\n\n<p>We can then call our <code>average</code> function on the filtered list, yielding our final function definitions:</p>\n\n<pre><code>average :: [Int] -&gt; Double\naverage [] = 0\naverage xs = (fromIntegral (sum xs)) / (fromIntegral (length xs))\n\naverageBetween :: Int -&gt; Int -&gt; [Int] -&gt; Double\naverageBetween a b xs = average $ filter (\\x -&gt; (x &gt;= (min a b)) &amp;&amp; (x &lt;= (max a b))) xs\n</code></pre>\n\n<p>Which can be used just like you'd expect:</p>\n\n<pre><code>ghci&gt;&gt; averageBetween 4 8 [1,2,8,2,7,2,4,6]\n6.25\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 40469206, "answer_count": 1, "score": 2, "last_activity_date": 1478533885, "creation_date": 1478533253, "question_id": 40469033, "link": "https://stackoverflow.com/questions/40469033/performing-operation-on-a-sublist-that-passes-a-certain-test", "title": "Performing operation on a Sublist that passes a certain test", "body": "<p>I am trying to write a function that, when giving two numbers and a list that they belong to, would calculate everything between those numbers (in value).</p>\n\n<p>For example:</p>\n\n<p>averageBetween 4 8 [1,2,8,2,7,2,4,6] = average [4,6,7,8] = 6,25</p>\n\n<p>What I've managed to do so far is:</p>\n\n<pre><code>average::[Int]-&gt;Double\naverage [] = 0\naverage xs = (fromIntegral (sum xs)) / (fromIntegral (length xs)\naverageBetween::Int-&gt;Int-&gt;[Int]-&gt;Double\naverageBetween a b xs\n</code></pre>\n\n<p>And now I'm kinda stuck, I can't really figure out a way to \"filter\" my list. Any help would be appreciated.\n~                         </p>\n"}, {"tags": ["haskell", "types", "polymorphism", "overloading", "typeclass"], "answers": [{"tags": [], "owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "is_accepted": true, "score": 4, "last_activity_date": 1478512853, "creation_date": 1478512853, "answer_id": 40462376, "question_id": 40462219, "link": "https://stackoverflow.com/questions/40462219/how-does-frominteger-work/40462376#40462376", "title": "How does fromInteger work?", "body": "<p>It is supposed to take an <code>Integer</code> and return a Fraction. In case of a fraction, it can just be <code>fromInteger n = Fraction n 1</code></p>\n"}], "owner": {"reputation": 173, "user_id": 6900669, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ac12dce0c1fe17b172f3859ee0d3d8c0?s=128&d=identicon&r=PG&f=1", "display_name": "Tibor Bujdo\u0161", "link": "https://stackoverflow.com/users/6900669/tibor-bujdo%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1081, "favorite_count": 0, "accepted_answer_id": 40462376, "answer_count": 1, "score": 1, "last_activity_date": 1478514650, "creation_date": 1478512408, "last_edit_date": 1478514650, "question_id": 40462219, "link": "https://stackoverflow.com/questions/40462219/how-does-frominteger-work", "title": "How does fromInteger work?", "body": "<p>I have this data structure:</p>\n\n<pre><code>data Fraction = Fraction Integer Integer\n          | NaF\n          deriving (Show)\n</code></pre>\n\n<p>Its supposed to represent Fractional numbers and I'm trying to make it Num instance. I didn't have problem with any operations apart from \"fromInteger\". I don't undersand what it is supposed to do and how it should look like. Can i please aks for help?</p>\n"}, {"tags": ["haskell", "minimax"], "comments": [{"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1478513969, "post_id": 40459769, "comment_id": 68170138, "body": "I would try to make minimax a recursive function. i.e map over minimax and not evaluate."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6744061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5271189c8671d9ff9ee098280d23cfa6?s=128&d=identicon&r=PG&f=1", "display_name": "kkkjjj", "link": "https://stackoverflow.com/users/6744061/kkkjjj"}, "edited": false, "score": 0, "creation_date": 1478576925, "post_id": 40476009, "comment_id": 68201553, "body": "Thank you. And a further question, how limit the maximum depth?"}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "reply_to_user": {"reputation": 43, "user_id": 6744061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5271189c8671d9ff9ee098280d23cfa6?s=128&d=identicon&r=PG&f=1", "display_name": "kkkjjj", "link": "https://stackoverflow.com/users/6744061/kkkjjj"}, "edited": false, "score": 0, "creation_date": 1478597511, "post_id": 40476009, "comment_id": 68210485, "body": "@kkkjjj you decrement <code>depth</code> parameter at each recursive call, and don&#39;t call your function anymore when you reach <code>0</code>"}], "tags": [], "owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "is_accepted": true, "score": 3, "last_activity_date": 1478558569, "creation_date": 1478558569, "answer_id": 40476009, "question_id": 40459769, "link": "https://stackoverflow.com/questions/40459769/minimax-in-haskell/40476009#40476009", "title": "Minimax in haskell", "body": "<p>You have multiple problems in your implementation that are more algorithm problems than Haskell.</p>\n\n<p>Minimax is a recursive algorithm, building a score by evaluating all the moves that are possible from a position, up to a certain depth (or the end of the game).</p>\n\n<p>During the recursion, <code>Max</code> player is alternating with <code>Min</code> player.</p>\n\n<p>From this, the <code>minimax</code> function should have the board, the maximum depth and the player type as parameter.</p>\n\n<p>Something like :</p>\n\n<pre><code>minimax :: Board -&gt; Int -&gt; Bool -&gt; Int\nminimax board depth isMax = ...\n</code></pre>\n\n<p><code>minimax</code> should also call itself on all the possible boards generated by moves. Then you apply the <code>maximum</code> or <code>minimum</code>, depending of the <code>isMax</code> parameter.</p>\n\n<p>Another thing is that you are trying to recurse on a tree.\nThe tree that you often see in the literature is nothing more than the recursive calls of the <code>minimax</code> function.</p>\n\n<p>In other words, you don't need a tree as parameter, the tree is implicitly built by successive <code>minimax</code> calls.</p>\n\n<p>As a side note, while abstracting from a particular game, it may be useful to add as a parameter a function do determine if the board is representing a finished game.</p>\n"}], "owner": {"reputation": 43, "user_id": 6744061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5271189c8671d9ff9ee098280d23cfa6?s=128&d=identicon&r=PG&f=1", "display_name": "kkkjjj", "link": "https://stackoverflow.com/users/6744061/kkkjjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1687, "favorite_count": 1, "accepted_answer_id": 40476009, "answer_count": 1, "score": 1, "last_activity_date": 1478558569, "creation_date": 1478503298, "question_id": 40459769, "link": "https://stackoverflow.com/questions/40459769/minimax-in-haskell", "title": "Minimax in haskell", "body": "<p>I'm trying to write a minimax function for connectfour game, here is my unfinished code</p>\n\n<pre><code>minimax:: RT Board -&gt;Int\nminimax (Tree board subtrees) = case subtrees of \n    []                                                                  &gt;evaluate board (get_turn board)  \n    _                                                                  -&gt;case get_turn board of \n            Player_X                                                   -&gt;maximum (next_socres)  \n            Player_O                                                   -&gt;minimum  (next_socres) \n where next_socres = map evaluate (map get_board subtrees) \n\n--get the node from sub trees\nget_board:: RT Board -&gt; Board\nget_board (Tree board subtrees) = board\n\n--evaluate moves(not finished)\nevaluate :: Board -&gt; Player -&gt; Int\nevaluate board me'   \n    |[me,me,me,Blank] `isInfixOf_e` all_stone_lines                         = 10\n    |[opp,opp,opp,Blank] `isInfixOf_e` all_stone_lines                      = -10\n    |otherwise                                                              = 0 \n    where\n        me = get_stone_of me'\n        opp = opponent' me\n        all_stone_lines = combine_list stones_from_rows (combine_list     stones_from_cols (combine_list stones_from_left_dias                  stones_from_right_dias))   \n        stones_from_rows = map (get_from_row board) [1..board_size] \n        stones_from_cols = map (get_from_column board) [1..board_size] \n        stones_from_left_dias = map (get_from_left_diagonal board) [-(board_size-1)..(board_size-1)]\n        stones_from_right_dias = map (get_from_right_diagonal board) [2..(2*board_size)]  \n</code></pre>\n\n<p>I want to use map to evaluate every subtrees before it compute the whole tree, but I don't know how to use map here... And I realised that if my code compiled, it will not be a recursion. Can anyone teach me how to do?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 2, "creation_date": 1478483322, "post_id": 40456441, "comment_id": 68158997, "body": "The parse error results form your guard statement being incorrectly formatted. You shouldn&#39;t place an equal sign before <code>|</code>. You have some other things to deal fix after that, including applying foldTree with the correct number of arguments within the guards."}, {"owner": {"reputation": 43, "user_id": 7122723, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/17a222d892f5c492f4a7210dce19a3ad?s=128&d=identicon&r=PG&f=1", "display_name": "bill williams", "link": "https://stackoverflow.com/users/7122723/bill-williams"}, "reply_to_user": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478486594, "post_id": 40456441, "comment_id": 68159726, "body": "I want to pattern match after the &quot;=&quot; . How can I do that ? :) TIA"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 1, "creation_date": 1478492971, "post_id": 40456441, "comment_id": 68161067, "body": "You&#39;re confusing function/guard syntax. To the right of the guard, you include predicates (functions that evaluation to <code>True</code> or <code>False</code>) and the corresponding value assignments. If you want to pattern match different cases (leaf vs. node), you can do so with a case statement or by manually matching several cases with function declarations. I recommend you read this: <a href=\"http://learnyouahaskell.com/syntax-in-functions\" rel=\"nofollow noreferrer\">learnyouahaskell.com/syntax-in-functions</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6052547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cfa4e5f98e74bd263d1c2ea38988699?s=128&d=identicon&r=PG&f=1", "display_name": "jim", "link": "https://stackoverflow.com/users/6052547/jim"}, "is_accepted": false, "score": 1, "last_activity_date": 1478526764, "last_edit_date": 1478526764, "creation_date": 1478493331, "answer_id": 40457919, "question_id": 40456441, "link": "https://stackoverflow.com/questions/40456441/generates-parse-input-error-in-haskell/40457919#40457919", "title": "Generates parse input error in haskell", "body": "<pre><code>data Tree t = Leaf t\n              | Node (Tree t) t (Tree t)\n\nfoldTree :: (Tree t -&gt; t -&gt; Tree t -&gt; t1) -&gt; (t -&gt; t1) -&gt; Tree t -&gt; t1\nfoldTree treeFn leafFn (Leaf v) = leafFn v\nfoldTree treeFn leafFn (Node left v right) = treeFn left v right\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 494, "user_id": 5447207, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d96199ece7ba3bc4f3c1d97d645f5fad?s=128&d=identicon&r=PG", "display_name": "Bargros", "link": "https://stackoverflow.com/users/5447207/bargros"}, "is_accepted": false, "score": 1, "last_activity_date": 1478616628, "creation_date": 1478616628, "answer_id": 40489930, "question_id": 40456441, "link": "https://stackoverflow.com/questions/40456441/generates-parse-input-error-in-haskell/40489930#40489930", "title": "Generates parse input error in haskell", "body": "<p>I'm guessing this is what you want</p>\n\n<pre><code>data Tree t = Leaf t | Node (Tree t) t (Tree t) deriving Show\n\nfoldTree :: (t1 -&gt; t -&gt; t1 -&gt; t1) -&gt; (t -&gt; t1) -&gt; Tree t -&gt; t1\nfoldTree treeFn leafFn tree \n                | foldTree (Leaf v) = leafFn v\n                | foldTree (Node left v right) = treeFn left v right\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7122723, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/17a222d892f5c492f4a7210dce19a3ad?s=128&d=identicon&r=PG&f=1", "display_name": "bill williams", "link": "https://stackoverflow.com/users/7122723/bill-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1478616628, "creation_date": 1478481020, "last_edit_date": 1478481143, "question_id": 40456441, "link": "https://stackoverflow.com/questions/40456441/generates-parse-input-error-in-haskell", "title": "Generates parse input error in haskell", "body": "<p>The below code sequence is generating a parse error on input <code>|</code>. \nIf the input was a leaf node then call leafFunc with value\nIf the input was a tree node then call TreeFunc with left Subtree,value,right Subtree</p>\n\n<pre><code>data Tree t = Leaf t\n        | Node (Tree t) t (Tree t)\n\nfoldTree :: (t1 -&gt; t -&gt; t1 -&gt; t1) -&gt; (t -&gt; t1) -&gt; Tree t -&gt; t1\nfoldTree treeFn leafFn tree= | foldTree (Leaf v) = leafFn(v)\n                             | foldTree (Node left v right) = treeFn(left v right)\n\n\nInput : foldTree (\\t1 t t2-&gt;t1 + 5*t + t2) (\\x-&gt;x+9) (Leaf 5)\nExpected Output : 14\n\nInput : foldTree (\\t1 t t2-&gt;t1 + 3*t + t2) (\\x-&gt;x+5) (Tree (Leaf 3) 2 (Leaf 4))\nExpected Output : 23\n</code></pre>\n\n<p>I am a newbie in haskell.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6929012"}, "edited": false, "score": 0, "creation_date": 1478480044, "post_id": 40456307, "comment_id": 68158209, "body": "Why do we need the <code>SimpleEnigma</code> to the right of the equal and if I use this type, what does it return?"}, {"owner": {"reputation": 682, "user_id": 4088416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1719bb302e6c3d5a78148083e73b7fc1?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Antonio Riaza Valverde", "link": "https://stackoverflow.com/users/4088416/jos%c3%a9-antonio-riaza-valverde"}, "edited": false, "score": 2, "creation_date": 1478480291, "post_id": 40456307, "comment_id": 68158257, "body": "<code>SimpleEnigma</code> to the left is a type. <code>SimpleEnigma</code> to the right is a value constructor: <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#algebraic-data-types\" rel=\"nofollow noreferrer\">learnyouahaskell.com/&hellip;</a>"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478480409, "post_id": 40456307, "comment_id": 68158282, "body": "The <code>type</code> keyword introduces a type alias, whereas the <code>data</code> constructor introduces new ADTs."}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478480437, "post_id": 40456307, "comment_id": 68158288, "body": "<a href=\"https://wiki.haskell.org/Keywords#data\" rel=\"nofollow noreferrer\">wiki.haskell.org/Keywords#data</a> and <a href=\"https://wiki.haskell.org/Keywords#type\" rel=\"nofollow noreferrer\">wiki.haskell.org/Keywords#type</a> should be helpful."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1478484529, "post_id": 40456307, "comment_id": 68159281, "body": "@mnoronha You know the <code>Maybe</code> type? It&#39;s defined as <code>data Maybe t = Just t | Nothing</code> i.e. <code>Maybe t</code> is the type itself (on the left) and <code>Just t</code> and <code>Nothing</code> define the possible values of that type."}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": true, "score": 2, "last_activity_date": 1478480590, "last_edit_date": 1478480590, "creation_date": 1478479814, "answer_id": 40456307, "question_id": 40456274, "link": "https://stackoverflow.com/questions/40456274/haskell-type-definition/40456307#40456307", "title": "Haskell - type definition", "body": "<pre><code>data SimpleEnigma = SimpleEnigma Rotor Rotor Rotor Reflector\n</code></pre>\n\n<p>We use the <code>data</code> keyword to define a new algebraic data type that holds three values of type <code>Rotor</code> and one value of type <code>Reflector</code>.</p>\n\n<p>Note that you change the name of the value constructor (<code>SimpleEnigma</code> to the right of the equal) to something other than <code>SimpleEnigma</code> and change the order of types <code>Rotor</code> and <code>Reflector</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6929012"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 40456307, "answer_count": 1, "score": 1, "last_activity_date": 1478480590, "creation_date": 1478479527, "question_id": 40456274, "link": "https://stackoverflow.com/questions/40456274/haskell-type-definition", "title": "Haskell - type definition", "body": "<p>I got 2 types </p>\n\n<pre><code>type Rotor = String \ntype Reflector =[(Char, Char)]\n</code></pre>\n\n<p>and I know <code>type SimpleEnigma</code> has exactly 3 <code>Rotor</code> and 1 <code>Reflector</code>. How can I define <code>SimpleEnigma</code>? </p>\n\n<p>Thanks in advance!!</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": false, "score": 4, "last_activity_date": 1478477231, "creation_date": 1478477231, "answer_id": 40456010, "question_id": 40455963, "link": "https://stackoverflow.com/questions/40455963/cannot-justify-constraints-in-explicitly-typed-binding-error-in-haskell/40456010#40456010", "title": "Cannot justify constraints in explicitly typed binding error in Haskell", "body": "<p>In order to make a comparison like <code>d &lt; 0</code>, the thing you are comparing must be a member of the <code>Ord</code> typeclass. Thus, we need to amend our type signature to include the additional constraint <code>Ord</code>:</p>\n\n<pre><code>quadraticRoots :: (Ord t, Floating t) =&gt; t -&gt; t -&gt; t -&gt; (t, t)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1478510060, "creation_date": 1478510060, "answer_id": 40461493, "question_id": 40455963, "link": "https://stackoverflow.com/questions/40455963/cannot-justify-constraints-in-explicitly-typed-binding-error-in-haskell/40461493#40461493", "title": "Cannot justify constraints in explicitly typed binding error in Haskell", "body": "<p>Your type signature says <code>t</code> is in <code>Floating</code> type class, but compiler found it must also be in <code>Ord</code>. </p>\n\n<p>Were <code>Ord</code> a <a href=\"https://www.haskell.org/tutorial/classes.html\" rel=\"nofollow noreferrer\">superclass</a> of <code>Floating</code>, all would be good. But it's not.  </p>\n\n<p>To see the type the compiler derives (<a href=\"https://en.wikipedia.org/wiki/Type_inference\" rel=\"nofollow noreferrer\"><em>infers</em></a>), just omit the explicit type signature. Then, after defining the function in GHCi, ask</p>\n\n<pre><code>~&gt; :t quadraticRoots\nquadraticRoots :: (Ord t, Floating t) =&gt; t -&gt; t -&gt; t -&gt; (t, t)\n</code></pre>\n\n<p><code>&lt;</code> is in <code>Ord</code>, <code>sqrt</code> is in <code>Floating</code>, and <code>/</code> is in <code>Fractional</code>. But <code>Floating</code> is a subclass of <code>Fractional</code>, so specifying it alone is enough for the both of them:</p>\n\n<pre><code>~&gt; :i sqrt\nclass Fractional a =&gt; Floating a where\n  ...\n  sqrt :: a -&gt; a\n  ...\n\n~&gt; :i /\nclass Num a =&gt; Fractional a where\n  (/) :: a -&gt; a -&gt; a\n  ...\ninfixl 7 /\n\n~&gt; :i &lt;\nclass Eq a =&gt; Ord a where\n  ...\n  (&lt;) :: a -&gt; a -&gt; Bool\n  ...\ninfix 4 &lt;\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7124068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3df535a614b28601213a4f254971d521?s=128&d=identicon&r=PG&f=1", "display_name": "geek", "link": "https://stackoverflow.com/users/7124068/geek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1478511977, "creation_date": 1478476877, "last_edit_date": 1478511977, "question_id": 40455963, "link": "https://stackoverflow.com/questions/40455963/cannot-justify-constraints-in-explicitly-typed-binding-error-in-haskell", "title": "Cannot justify constraints in explicitly typed binding error in Haskell", "body": "<pre><code>quadraticRoots :: Floating t =&gt; t -&gt; t -&gt; t -&gt; (t, t)\nquadraticRoots a b c = if d &lt; 0 then error \"0\" else (x, y)\n                          where\n                            x = e + sqrt d / (2 * a)\n                            y = e - sqrt d / (2 * a)\n                            d = b * b - 4 * a * c\n                            e = - b / (2 * a)\n</code></pre>\n\n<p>The above code gives the following error in Hugs: </p>\n\n<pre><code>Cannot justify constraints in explicitly typed binding\n*** Expression    : quadraticRoots\n*** Type          : Floating a =&gt; a -&gt; a -&gt; a -&gt; (a,a)\n*** Given context : Floating a\n*** Constraints   : Ord a\n</code></pre>\n\n<p>Can anyone help me interpret this?</p>\n"}, {"tags": ["haskell", "gadt"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1478472260, "post_id": 40455365, "comment_id": 68156437, "body": "It looks like your question is missing some code. Your error references <code>ContextaPair&#39;</code>, but you don&#39;t mention that. Can you post your actual code?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1478472953, "post_id": 40455365, "comment_id": 68156606, "body": "You still aren&#39;t running the same code that you&#39;ve posted. There are no <code>[Char]</code> values in your code."}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 4, "last_activity_date": 1478473804, "creation_date": 1478473804, "answer_id": 40455616, "question_id": 40455365, "link": "https://stackoverflow.com/questions/40455365/gadt-confusion-with-custom-data-types/40455616#40455616", "title": "GADT confusion with custom data types?", "body": "<pre><code>myFunction :: Generator a -&gt; a\nmyFunction (Success fp) = SecondPair \"21\" \"24\"\nmyFunction (Fail fp) = False\n</code></pre>\n\n<p>The problem is here.  The type signature is shorthand for</p>\n\n<pre><code>myFunction :: forall a. Generator a -&gt; a\n</code></pre>\n\n<p>That is, no matter what type <code>a</code> I pick, if I give <code>myFunction</code> a <code>Generator a</code>, it will give me back an <code>a</code>.  So if I gave it a <code>Generator Int</code>, it should give me back an <code>Int</code>.  </p>\n\n<p>So I can construct</p>\n\n<pre><code>successval :: Generator (SecondPair Int)\nsuccessval = Success (FirstPair 42 42 :: FirstPair Int)\n</code></pre>\n\n<p>And then pass it to <code>myFunction</code>, and according to the type signature I should get</p>\n\n<pre><code>myFunction successVal :: SecondPair Int\n</code></pre>\n\n<p>However, the way <code>myFunction</code> is defined, it will always give back a <code>SecondPair String</code> no matter what type I pass it, and that's the problem it's complaining about.</p>\n\n<p>You need to somehow use the argument you are given if you want this kind of polymorphism.  E.g.</p>\n\n<pre><code>myFunction (Success (FirstPair x y)) = SecondPair x y\n</code></pre>\n\n<p>would do the trick, because the <code>x</code> and <code>y</code> going out are the same type as the <code>x</code> and <code>y</code> coming in (and <code>FirstPair</code> and <code>SecondPair</code> match the way the GADT says they should).</p>\n\n<p>If you need to return a <code>SecondPair String</code> no matter what, then either <code>myFunction</code>'s type signature is wrong, needing to be something like</p>\n\n<pre><code> myFunction :: Generator a -&gt; SecondPair String\n</code></pre>\n\n<p>(which doesn't act correctly in the case of <code>Fail</code> -- I have more to say if this is the route you actually want to go, but it's a bit more involved than I want to write for a shot-in-the-dark guess)</p>\n\n<p>or the GADT needs to say that the result will be a <code>SecondPair String</code>.</p>\n\n<pre><code> data Generator a where\n     Success :: FirstPair a -&gt; Generator (SecondPair String)\n     ...\n</code></pre>\n\n<p>I don't think these are terribly likely scenarios, I just thought they might help your understanding of the problem.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 40455616, "answer_count": 1, "score": 3, "last_activity_date": 1478473804, "creation_date": 1478472004, "last_edit_date": 1478473224, "question_id": 40455365, "link": "https://stackoverflow.com/questions/40455365/gadt-confusion-with-custom-data-types", "title": "GADT confusion with custom data types?", "body": "<p>I have the following custom data types:</p>\n\n<pre><code>data FirstPair' a b = FirstPair a b deriving (Show, Ord, Eq)\ntype FirstPair a = FirstPair' a a \n\ndata SecondPair' a b = SecondPair a b deriving (Show, Ord, Eq)\ntype SecondPair a = SecondPair' a a \n</code></pre>\n\n<p>I'm trying to create a GADT structure for my function:</p>\n\n<pre><code>data Generator a where\n  Success :: FirstPair a -&gt; Generator (SecondPair a)\n  Fail :: FirstPair a -&gt; Generator Bool\n\nmyFunction :: Generator a -&gt; a\nmyFunction (Success fp) = SecondPair \"21\" \"24\"\nmyFunction (Fail fp) = False\n</code></pre>\n\n<p>The role of 'Generator' type is to enable me to force 'myFunction' to return an instance of 'SecondPair' if 'Success' is passed to it, and 'False' if 'Fail' is passed to it.</p>\n\n<p>However, I'm getting this error:</p>\n\n<pre><code>\"Could not deduce: a1 ~ [Char] from the context: a ~ SecondPair' a1 a1 bound by a pattern with constructor: Success :: forall a. FirstPair a -&gt; Generator (SecondPair a)\"\n</code></pre>\n\n<p>What am I doing wrong here? </p>\n"}, {"tags": ["json", "haskell", "aeson"], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 1554137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb537e77e97db2071395a0b2a4c8a593?s=128&d=identicon&r=PG", "display_name": "Alexander VoidEx Ruchkin", "link": "https://stackoverflow.com/users/1554137/alexander-voidex-ruchkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1478477957, "last_edit_date": 1478477957, "creation_date": 1478477434, "answer_id": 40456032, "question_id": 40455255, "link": "https://stackoverflow.com/questions/40455255/writing-custom-instances-for-json-date-data-in-aeson/40456032#40456032", "title": "Writing custom instances for JSON date data in Aeson", "body": "<p>You have convert y/m/d to/from string</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# OPTIONS_GHC -fno-warn-tabs #-}\n\nimport Control.Monad\nimport Data.Aeson\nimport qualified Data.Text as T\nimport Text.Read (readMaybe)\n-- import qualified Data.Attoparsec.Text as A\n\ndata Date = Date Int Int Int deriving (Read, Show)\n\ninstance ToJSON Date where\n    toJSON (Date y m d) = toJSON $ object [\n        \"date\" .= T.pack (str 4 y ++ \"-\" ++ str 2 m ++ \"-\" ++ str 2 d)]\n        where\n            str n = pad . show where\n                pad s = replicate (n - length s) '0' ++ s\n\ninstance FromJSON Date where\n    parseJSON = withObject \"date\" $ \\v -&gt; do\n        str &lt;- v .: \"date\"\n        let\n            ps@(~[y, m, d]) = T.split (== '-') str\n        guard (length ps == 3)\n        Date &lt;$&gt; readNum y &lt;*&gt; readNum m &lt;*&gt; readNum d\n        where\n            readNum = maybe (fail \"not num\") return . readMaybe . T.unpack\n\n    -- -- or with attoparsec\n    -- parseJSON = withObject \"date\" $ \\v -&gt; do\n    --  str &lt;- v .: \"date\"\n    --  [y, m, d] &lt;- either fail return $\n    --      A.parseOnly (A.decimal `A.sepBy` A.char '-') str\n    --  return $ Date y m d\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 7, "last_activity_date": 1478505290, "creation_date": 1478505290, "answer_id": 40460264, "question_id": 40455255, "link": "https://stackoverflow.com/questions/40455255/writing-custom-instances-for-json-date-data-in-aeson/40460264#40460264", "title": "Writing custom instances for JSON date data in Aeson", "body": "<p>Why reinvent the wheel? There is a semi-standard representation for what you call <code>Date</code> in the <a href=\"https://hackage.haskell.org/package/time\" rel=\"noreferrer\"><code>time</code></a> package - it is called <a href=\"https://hackage.haskell.org/package/time/docs/Data-Time-Calendar.html#t:Day\" rel=\"noreferrer\"><code>Day</code></a>. It gets better: not only does that same package even give you the utilities for parsing <code>Day</code> from the format you have, those utilities are even exported to <code>aeson</code>. Yep, there are already <code>ToJSON</code> and <code>FromJSON</code> instances in <code>aeson</code> for <code>Day</code>:</p>\n\n<pre><code>ghci&gt; :set -XOverloadedStrings\nghci&gt; import Data.Time.Calendar\nghci&gt; import Data.Aeson\nghci&gt; fromJSON \"2015-04-12\" :: Result Day\nSuccess 2015-04-12\nghci&gt; toJSON (fromGregorian 2015 4 12)\nString \"2015-04-12\"\n</code></pre>\n\n<p>If you <em>really</em> want to extract the days, months, and years, you can always use <a href=\"https://hackage.haskell.org/package/time-1.6.0.1/docs/Data-Time-Calendar.html#v:toGregorian\" rel=\"noreferrer\"><code>toGregorian :: Day -&gt; (Integer, Int, Int)</code></a>. Sticking to the standard abstraction is probably a good long-term choice though.</p>\n"}], "owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 40456032, "answer_count": 2, "score": 0, "last_activity_date": 1478505290, "creation_date": 1478471141, "question_id": 40455255, "link": "https://stackoverflow.com/questions/40455255/writing-custom-instances-for-json-date-data-in-aeson", "title": "Writing custom instances for JSON date data in Aeson", "body": "<p>I have JSON date data in the following form:</p>\n\n<pre><code>  {\"date\": \"2015-04-12\"}\n</code></pre>\n\n<p>and a corresponding haskell type:</p>\n\n<pre><code>data Date = Date {\n      year   :: Int\n    , month  :: Int\n    , day    :: Int\n    }\n</code></pre>\n\n<p>How can I write the custom <code>FromJSON</code> and <code>ToJSON</code> functions for the \n<a href=\"https://hackage.haskell.org/package/aeson-0.6.1.0/docs/Data-Aeson.html\" rel=\"nofollow noreferrer\">Aeson</a> library?\nDeriving the instances does not work because of the formatting.</p>\n"}, {"tags": ["haskell", "types", "monads", "type-level-computation"], "comments": [{"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1478469050, "post_id": 40454598, "comment_id": 68155489, "body": "e.g. here <a href=\"https://www.youtube.com/watch?v=60gUaOuZZsE\" rel=\"nofollow noreferrer\">youtube.com/watch?v=60gUaOuZZsE</a>, it almost made into a library, but wasn&#39;t worth the complexity."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478474040, "post_id": 40454598, "comment_id": 68156888, "body": "I would expect that applications of indexed monads would more likely be found in total languages, like Agda and Coq. In Haskell, you can get away with using partial functions that you know will be total in context; in those languages you can&#39;t. <i>Needing</i> an indexed monad will go a long way toward convincing you that it&#39;s worth the trouble to work with one."}, {"owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1478502381, "post_id": 40454598, "comment_id": 68164159, "body": "@dfeuer I can imagine various applications of this technique in my current code, like enforcing correct state transitions at the type level in protocols. I agree that you can &quot;know&quot; your functions are total in a context, but when coding for the long term, esp. in a team setting, explicit trumps implicit so I would rather have a mechanism to help people be aware of those assumptions on context. One particular area that springs to my mind is system configuration, like what propellor does."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1478507710, "post_id": 40454598, "comment_id": 68166558, "body": "You may have already seen my question, but Conor tried to model a DVD ejection example here: <a href=\"http://stackoverflow.com/a/28696299/1651941\">stackoverflow.com/a/28696299/1651941</a>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1478532616, "post_id": 40454598, "comment_id": 68181905, "body": "Code that&#39;s actually being used in production? As in, a link to some source code? I think that&#39;s <a href=\"http://stackoverflow.com/help/on-topic\">off-topic</a> (&quot;Questions asking us to recommend or find... [an] off-site resource are off-topic&quot;). Besides, I&#39;d expect most of such applications to be closed-source and therefore not shareable here."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1478532804, "post_id": 40454598, "comment_id": 68182013, "body": "I think you should consider changing your question to ask for self-contained examples of practical uses for indexed monads. Stack Overflow is designed for self-contained code-centric posts. Note that all three of the answers you&#39;ve got so far are answering <i>that</i> question, not the question you directly asked."}, {"owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1478534333, "post_id": 40454598, "comment_id": 68183025, "body": "@BenjaminHodgson I noticed that :) My question is probably badly formulated and all the answers are really interesting potential applications of indexed monads to real-world problems. Actually, I am pretty much sold on the idea of using indexed monads and I was looking for other people&#39;s experience using such kind of &quot;advanced&quot; constructs. In particular, I am interested in how it can be maintained and the ease of onboarding other devs..."}], "answers": [{"comments": [{"owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "edited": false, "score": 1, "creation_date": 1478508603, "post_id": 40460938, "comment_id": 68167018, "body": "I like the example and find it both interesting and enlightening. Is this actual code used in production in a compiler or &quot;just&quot; some potential application of indexed monads? I tried to make my question more precise..."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "edited": false, "score": 1, "creation_date": 1478509166, "post_id": 40460938, "comment_id": 68167314, "body": "Nah I wrote it just for this answer. But I could very easily imagine using it in some prod code."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478541161, "post_id": 40460938, "comment_id": 68187295, "body": "Why not <code>newtype Label i j = Label (Prog i j)</code>?"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478571196, "post_id": 40460938, "comment_id": 68200279, "body": "@dfeuer: I wanted to emphasize that it should be something completely different than an inlined <code>Prog i j</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478585705, "post_id": 40460938, "comment_id": 68204331, "body": "Yeah, that makes sense."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 3, "last_activity_date": 1478508078, "creation_date": 1478508078, "answer_id": 40460938, "question_id": 40454598, "link": "https://stackoverflow.com/questions/40454598/experience-reports-using-indexed-monads-in-production/40460938#40460938", "title": "Experience reports using indexed monads in production?", "body": "<p>I think the below should count as a practical example: statically enforcing \"well-stackedness\" in a compiler. Boilerplate first:</p>\n\n<pre><code>{-# LANGUAGE GADTs, KindSignatures #-}\n{-# LANGUAGE DataKinds, TypeOperators #-}\n{-# LANGUAGE RebindableSyntax #-}\n\nimport qualified Prelude\nimport Prelude hiding (return, fail, (&gt;&gt;=), (&gt;&gt;))\n</code></pre>\n\n<p>Then a simple stack language:</p>\n\n<pre><code>data Op (i :: [*]) (j :: [*]) where\n    IMM :: a -&gt; Op i (a ': i)\n    BINOP :: (a -&gt; b -&gt; c) -&gt; Op (a ': b ': i) (c ': i)\n    BRANCH :: Label i j -&gt; Label i j -&gt; Op (Bool ': i) j\n</code></pre>\n\n<p>and we won't bother with real <code>Label</code>s:</p>\n\n<pre><code>data Label (i :: [*]) (j :: [*]) where\n    Label :: Prog i j -&gt; Label i j\n</code></pre>\n\n<p>and <code>Prog</code>rams are just type-aligned lists of <code>Op</code>s:</p>\n\n<pre><code>data Prog (i :: [*]) (j :: [*]) where\n    PNil :: Prog i i\n    PCons :: Op i j -&gt; Prog j k -&gt; Prog i k\n</code></pre>\n\n<p>So in this setting, we can very easily make a compiler which is an indexed writer monad; that is, an indexed monad:</p>\n\n<pre><code>class IMonad (m :: idx -&gt; idx -&gt; * -&gt; *) where\n    ireturn :: a -&gt; m i i a\n    ibind :: m i j a -&gt; (a -&gt; m j k b) -&gt; m i k b\n\n-- For RebindableSyntax, so that we get that sweet 'do' sugar\nreturn :: (IMonad m) =&gt; a -&gt; m i i a\nreturn = ireturn\n(&gt;&gt;=) :: (IMonad m) =&gt; m i j a -&gt; (a -&gt; m j k b) -&gt; m i k b\n(&gt;&gt;=) = ibind\nm &gt;&gt; n = m &gt;&gt;= const n\nfail = error\n</code></pre>\n\n<p>that allows accumulating a(n indexed) monoid:</p>\n\n<pre><code>class IMonoid (m :: idx -&gt; idx -&gt; *) where\n    imempty :: m i i\n    imappend :: m i j -&gt; m j k -&gt; m i k\n</code></pre>\n\n<p>just like regular <code>Writer</code>:</p>\n\n<pre><code>newtype IWriter w (i :: [*]) (j :: [*]) (a :: *) = IWriter{ runIWriter :: (w i j, a) }\n\ninstance (IMonoid w) =&gt; IMonad (IWriter w) where\n    ireturn x = IWriter (imempty, x)\n    ibind m f = IWriter $ case runIWriter m of\n        (w, x) -&gt; case runIWriter (f x) of\n            (w', y) -&gt; (w `imappend` w', y)\n\nitell :: w i j -&gt; IWriter w i j ()\nitell w = IWriter (w, ())\n</code></pre>\n\n<p>So we just apply this machinery to <code>Prog</code>rams:</p>\n\n<pre><code>instance IMonoid Prog where\n    imempty = PNil\n    imappend PNil prog' = prog'\n    imappend (PCons op prog) prog' = PCons op $ imappend prog prog'\n\ntype Compiler = IWriter Prog\n\ntellOp :: Op i j -&gt; Compiler i j ()\ntellOp op = itell $ PCons op PNil\n\nlabel :: Compiler i j () -&gt; Compiler k k (Label i j)\nlabel m = case runIWriter m of\n    (prog, ()) -&gt; ireturn (Label prog)\n</code></pre>\n\n<p>and then we can try compiling a simple expression language:</p>\n\n<pre><code>data Expr a where\n    Lit :: a -&gt; Expr a\n    And :: Expr Bool -&gt; Expr Bool -&gt; Expr Bool\n    Plus :: Expr Int -&gt; Expr Int -&gt; Expr Int\n    If :: Expr Bool -&gt; Expr a -&gt; Expr a -&gt; Expr a\n\ncompile :: Expr a -&gt; Compiler i (a ': i) ()\ncompile (Lit x) = tellOp $ IMM x\ncompile (And x y) = do\n    compile x\n    compile y\n    tellOp $ BINOP (&amp;&amp;)\ncompile (Plus x y) = do\n    compile x\n    compile y\n    tellOp $ BINOP (+)\ncompile (If b t e) = do\n    labThen &lt;- label $ compile t\n    labElse &lt;- label $ compile e\n    compile b\n    tellOp $ BRANCH labThen labElse\n</code></pre>\n\n<p>and if we omitted e.g. one of the arguments to <code>BINOP</code>, the typechecker will detect this:</p>\n\n<pre><code>compile (And x y) = do\n    compile x\n    tellOp $ BINOP (&amp;&amp;)\n</code></pre>\n\n<blockquote>\n  <ul>\n  <li>Could not deduce: <code>i ~ (Bool : i)</code>\n    from the context: <code>a ~ Bool</code></li>\n  </ul>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "edited": false, "score": 0, "creation_date": 1478530364, "post_id": 40462905, "comment_id": 68180279, "body": "Nice example too... But once again, I am looking for code that&#39;s in production somewhere :)"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "edited": false, "score": 2, "creation_date": 1478541618, "post_id": 40462905, "comment_id": 68187581, "body": "@insitu I&#39;m not aware about use of indexed monad in production. (1) there is not so much Haskell code in production; (2) it requires <code>-XRebindableSyntax</code> if you want to use this monads with <code>do</code> (and you want) but this extension is not so common; (3) there are not so many people who understand such concepts well and not many among them need to write production code which uses such monads. Though maybe in future of Haskell these ideas will become more popular :)"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 2, "last_activity_date": 1478514369, "creation_date": 1478514369, "answer_id": 40462905, "question_id": 40454598, "link": "https://stackoverflow.com/questions/40454598/experience-reports-using-indexed-monads-in-production/40462905#40462905", "title": "Experience reports using indexed monads in production?", "body": "<p>Another nice example is mutexes with lock-unlock check at compile time. You can find this example on Stephen Diehl website:</p>\n\n<p><a href=\"http://dev.stephendiehl.com/hask/#indexed-monads\" rel=\"nofollow noreferrer\">http://dev.stephendiehl.com/hask/#indexed-monads</a></p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478540931, "post_id": 40468548, "comment_id": 68187164, "body": "Are you sure full dependent types are required, and not just McBride-style indexed monads with singletons? Singletons+<code>TypeInType</code> are awfully powerful, though painful."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478542130, "post_id": 40468548, "comment_id": 68187875, "body": "@dfeuer That&#39;s a good question to which I don&#39;t know the answer; I haven&#39;t tried cranking the handle on <a href=\"https://eb.host.cs.st-andrews.ac.uk/drafts/dep-eff.pdf\" rel=\"nofollow noreferrer\">resource-dependent effects</a> in Haskell. I can&#39;t imagine it&#39;ll be pretty"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 4, "last_activity_date": 1478535615, "last_edit_date": 1478535615, "creation_date": 1478531744, "answer_id": 40468548, "question_id": 40454598, "link": "https://stackoverflow.com/questions/40454598/experience-reports-using-indexed-monads-in-production/40468548#40468548", "title": "Experience reports using indexed monads in production?", "body": "<p><em>Session types</em> are an attempt to give type-level descriptions to networking protocols. The idea is that if a client sends a value, the server must be ready to receive it, and vice versa.</p>\n\n<p>So here's a type (using <code>TypeInType</code>) describing sessions consisting of a sequence of values to send and values to receive.</p>\n\n<pre><code>infixr 5 :!, :?\ndata Session = Type :! Session\n             | Type :? Session\n             | E\n</code></pre>\n\n<p><code>a :! s</code> means \"send a value of type <code>a</code>, then continue with the protocol <code>s</code>\". <code>a :? s</code> means \"receive a value of type <code>a</code>, then continue with the protocol <code>s</code>\".</p>\n\n<p>So <code>Session</code> represents a (type-level) list of actions. Our monadic computations will work their way along this list, sending and receiving data as the type demands it. More concretely, a computation of type <code>Chan s t a</code> reduces the remaining work to be done to satisfy the protocol from <code>s</code> to <code>t</code>. I'll build <code>Chan</code> using the <em>indexed free monad</em> that I used in my answer to your other question.</p>\n\n<pre><code>class IFunctor f where\n    imap :: (a -&gt; b) -&gt; f i j a -&gt; f i j b\nclass IFunctor m =&gt; IMonad m where\n    ireturn :: a -&gt; m i i a\n    (&gt;&gt;&gt;=) :: m i j a -&gt; (a -&gt; m j k b) -&gt; m i k b\n\n\ndata IFree f i j a where\n    IReturn :: a -&gt; IFree f i i a\n    IFree :: f i j (IFree f j k a) -&gt; IFree f i k a\n\ninstance IFunctor f =&gt; IFunctor (IFree f) where\n    imap f (IReturn x) = IReturn (f x)\n    imap f (IFree fx) = IFree (imap (imap f) fx)\n\ninstance IFunctor f =&gt; IMonad (IFree f) where\n    ireturn = IReturn\n    IReturn x &gt;&gt;&gt;= f = f x\n    IFree fx &gt;&gt;&gt;= f = IFree (imap (&gt;&gt;&gt;= f) fx)\n</code></pre>\n\n<p>Our base actions in the <code>Chan</code> monad will simply send and receive values.</p>\n\n<pre><code>data ChanF s t r where\n    Send :: a -&gt; r -&gt; ChanF (a :! s) s r\n    Recv :: (a -&gt; r) -&gt; ChanF (a :? s) s r\n\ninstance IFunctor ChanF where\n    imap f (Send x r) = Send x (f r)\n    imap f (Recv r) = Recv (fmap f r)\n\nsend :: a -&gt; Chan (a :! s) s ()\nsend x = IFree (Send x (IReturn ()))\n\nrecv :: Chan (a :? s) s a\nrecv = IFree (Recv IReturn)\n\ntype Chan = IFree ChanF\ntype Chan' s = Chan s E  -- a \"complete\" Chan\n</code></pre>\n\n<p><code>send</code> takes the current state of the session from <code>a :! s</code> to <code>s</code>, fulfilling the obligation to send an <code>a</code>. Likewise, <code>recv</code> transforms a session from <code>a :? s</code> to <code>s</code>.</p>\n\n<p>Here's the fun part. When one end of the protocol sends a value, the other end must be ready to receive it, and vice versa. This leads to the idea of a session type's <em>dual</em>:</p>\n\n<pre><code>type family Dual s where\n    Dual (a :! s) = a :? Dual s\n    Dual (a :? s) = a :! Dual s\n    Dual E = E\n</code></pre>\n\n<p>In a total language <code>Dual (Dual s) = s</code> would be provable, but alas Haskell is not total.</p>\n\n<p>You can connect a pair of channels if their types are dual. (I guess you'd call this an in-memory simulation of connecting a client and a server.)</p>\n\n<pre><code>connect :: Chan' s a -&gt; Chan' (Dual s) b -&gt; (a, b)\nconnect (IReturn x) (IReturn y) = (x, y)\nconnect (IReturn _) (IFree y) = case y of {}\nconnect (IFree (Send x r)) (IFree (Recv f)) = connect r (f x)\nconnect (IFree (Recv f)) (IFree (Send y r)) = connect (f y) r\n</code></pre>\n\n<p>For example, here's a protocol for a server which tests whether a number is greater than 3. The server waits to receive an <code>Int</code>, sends back a <code>Bool</code>, and then ends the computation.</p>\n\n<pre><code>type MyProtocol = Int :? Bool :! E\n\nserver :: Chan' MyProtocol ()\nserver = do  -- using RebindableSyntax\n    x &lt;- recv\n    send (x &gt; 3)\n\nclient :: Chan' (Dual MyProtocol) Bool\nclient = do\n    send 5\n    recv\n</code></pre>\n\n<p>And to test it:</p>\n\n<pre><code>ghci&gt; connect server client\n((),True)\n</code></pre>\n\n<p>Session types are an area of active research. This particular implementation is fine for very simple protocols, but you can't describe protocols where the type of the data being sent over the wire depends on the state of the protocol. For that you need, surprise surprise, dependent types. See <a href=\"https://vimeo.com/128466883#t=1860\" rel=\"nofollow noreferrer\">this talk by Brady</a> for a quick demo of the state of the art of session types.</p>\n"}], "owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 4, "accepted_answer_id": 40460938, "answer_count": 3, "score": 9, "last_activity_date": 1478535615, "creation_date": 1478466832, "last_edit_date": 1495541342, "question_id": 40454598, "link": "https://stackoverflow.com/questions/40454598/experience-reports-using-indexed-monads-in-production", "title": "Experience reports using indexed monads in production?", "body": "<p>In a previous question I discovered the existence of Conor McBride's <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/Kleisli.pdf\" rel=\"nofollow noreferrer\">Kleisli arrows of Outrageous Fortune</a> while looking for ways of encoding <a href=\"https://stackoverflow.com/questions/40197310/how-to-encode-possible-state-transitions-in-type\">Idris examples in Haskell</a>. My efforts to understand McBride's code and make it compile in Haskell led to this gist: <a href=\"https://gist.github.com/abailly/02dcc04b23d4c607f33dca20021bcd2f\" rel=\"nofollow noreferrer\">https://gist.github.com/abailly/02dcc04b23d4c607f33dca20021bcd2f</a> </p>\n\n<p>While searching on Hackage, I discovered several implementations of these concepts, notably by (guess who?) <a href=\"https://hackage.haskell.org/package/indexed\" rel=\"nofollow noreferrer\">Edward Kmett</a> and <a href=\"https://hackage.haskell.org/package/index-core\" rel=\"nofollow noreferrer\">Gabriel Gonzalez</a>. </p>\n\n<p>What experience do people have putting such code in production? In particular, do the expected benefits (runtime safety, self-guiding usage) actually occur IRL? How about maintaining this kind of code over time and onboarding newcomers?</p>\n\n<p><em>EDIT</em>: I changed the title to be more explicit about what I am looking for: Real-world use of indexed monads in the wild. I am interested in using them and I have several use-cases in mind, just wondering if other people have already used them in \"production\" code.</p>\n\n<p><em>EDIT 2</em>: Thanks to the great answers provided so far and helpful comments, I edited that question's title and description again to reflect more precisely what kind of answer I expect, e.g. experience report. </p>\n"}, {"tags": ["parsing", "haskell", "parsec"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1478464228, "post_id": 40454155, "comment_id": 68153739, "body": "What are stem characters? What is the grammar you are trying to parse? It would probably be very helpful if you provided an example input and the output you are trying to get for that example."}, {"owner": {"reputation": 31, "user_id": 2852169, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100005050590421/picture?type=large", "display_name": "N&#225;ndor Z. Papp", "link": "https://stackoverflow.com/users/2852169/n%c3%a1ndor-z-papp"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1478466113, "post_id": 40454155, "comment_id": 68154480, "body": "Done. Characters such as % : \\ \\n \\t \\r are excluded but if the string contains an &#39;\\&#39; it makes it literal (eg &quot; \\%&quot; -&gt; &quot;%&quot; whereas &quot;%&quot; -&gt; &quot;&quot;) ."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2852169, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100005050590421/picture?type=large", "display_name": "N&#225;ndor Z. Papp", "link": "https://stackoverflow.com/users/2852169/n%c3%a1ndor-z-papp"}, "edited": false, "score": 0, "creation_date": 1478465893, "post_id": 40454251, "comment_id": 68154389, "body": "Thanks! It cleared the error... Now my program loops forever. I suspect that many ( noneOf ... Statement"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 31, "user_id": 2852169, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100005050590421/picture?type=large", "display_name": "N&#225;ndor Z. Papp", "link": "https://stackoverflow.com/users/2852169/n%c3%a1ndor-z-papp"}, "edited": false, "score": 0, "creation_date": 1478468889, "post_id": 40454251, "comment_id": 68155432, "body": "@N&#225;ndorZ.Papp More precisely, I belive the problem manifests itself when you try to use <code>many frag</code>. Rather than a loop, here it bails out with <code>&quot;Exception: Text.ParserCombinators.Parsec.Prim.many: combinator &#39;many&#39; is applied to a parser that accepts an empty string.&quot;</code>, which makes sense. If you want to break down the input string in several parts, you need to specify some sort of delimiter or length limit in the <code>frag</code> parser."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1478469020, "last_edit_date": 1478469020, "creation_date": 1478464623, "answer_id": 40454251, "question_id": 40454155, "link": "https://stackoverflow.com/questions/40454155/how-to-correctly-differentiate-between-stem-characters-and-literal-characters-wh/40454251#40454251", "title": "How to correctly differentiate between stem characters and literal characters while parsing in Haskell", "body": "<blockquote>\n<pre><code>frag :: Parser Frag\nfrag = do Lt x &lt;- (many (noneOf ['\\n','\\t','\\r',':','.']))\n          return x\n</code></pre>\n</blockquote>\n\n<p><code>many</code>, here, produces a <code>Parser [Char]</code>. You are trying to match a <code>[Char]</code> result with a <code>Frag</code> pattern, resulting in a type error. Rather, you want...</p>\n\n<pre><code>frag :: Parser Frag\nfrag = do x &lt;- (many (noneOf ['\\n','\\t','\\r',':','.']))\n          return (Lt x)\n</code></pre>\n\n<p>... or simply:</p>\n\n<pre><code>frag :: Parser Frag\nfrag = fmap Lt (many (noneOf ['\\n','\\t','\\r',':','.']))\n</code></pre>\n\n<p>P.S.: In your other definition...</p>\n\n<pre><code>template :: Parser [Frag]\ntemplate = \n    do result &lt;- many frag\n       return result\n</code></pre>\n\n<p>... binding <code>result</code> only for immediately using <code>return</code> on it is redundant. You can just write:</p>\n\n<pre><code>template :: Parser [Frag]\ntemplate = many frag\n</code></pre>\n\n<p>P.P.S.: As you have noticed (and perhaps as you had expected), <code>many frag</code> isn't enough for doing what you want. You will need to specify, in one way or another, how to delimit your fragments.</p>\n"}], "owner": {"reputation": 31, "user_id": 2852169, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100005050590421/picture?type=large", "display_name": "N&#225;ndor Z. Papp", "link": "https://stackoverflow.com/users/2852169/n%c3%a1ndor-z-papp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1478477461, "creation_date": 1478463958, "last_edit_date": 1478477461, "question_id": 40454155, "link": "https://stackoverflow.com/questions/40454155/how-to-correctly-differentiate-between-stem-characters-and-literal-characters-wh", "title": "How to correctly differentiate between stem characters and literal characters while parsing in Haskell", "body": "<p>I am fairly new to Haskell and I'm trying to make a simple Parser and I'm using the Parsec module. The grammar for my parser is: </p>\n\n<pre><code>data Frag\n  = Lt String\n  | St\n  deriving (Eq, Show)\n\ntype Template = [Frag]\n\ntype FileT = Template\ntype CommandT = Template\n\ndata Rule\n  = Rule [FileT] [FileT] [CommandT]\n  deriving (Eq, Show)\n\ntype Makefile = [Rule]\n</code></pre>\n\n<p>I have implemented all the way down to fragments (which would be sets of characters). Here is a snipped of how I'm trying to handle literal characters , i don't know how to handle Stem characters though:      </p>\n\n<pre><code>template :: Parser [Frag]\ntemplate = \n    do result &lt;- many frag\n       return result\nfrag :: Parser Frag\nfrag = do Lt x &lt;- (many (noneOf ['\\n','\\t','\\r',':','.']))\n          return x\n</code></pre>\n\n<p>But I'm getting this error I don't know why:</p>\n\n<pre><code>Parser\\Impl.hs:72:11: error:\n    \u2022 Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018Frag\u2019\n    \u2022 In the pattern: Lt x\n      In a stmt of a 'do' block:\n        Lt x &lt;- (many (noneOf ['\\n', '\\t', '\\r', ':', ....]))\n      In the expression:\n        do { Lt x &lt;- (many (noneOf ['\\n', '\\t', ....]));\n             return x }\n\nParser\\Impl.hs:73:11: error:\n    \u2022 Couldn't match type \u2018[Char]\u2019 with \u2018Frag\u2019\n      Expected type: Text.Parsec.Prim.ParsecT\n                       String () Data.Functor.Identity.Identity Frag\n        Actual type: Text.Parsec.Prim.ParsecT\n                       String () Data.Functor.Identity.Identity String\n    \u2022 In a stmt of a 'do' block: return x\n      In the expression:\n        do { Lt x &lt;- (many (noneOf ['\\n', '\\t', ....]));\n             return x }\n      In an equation for \u2018frag\u2019:\n          frag\n            = do { Lt x &lt;- (many (noneOf ['\\n', ....]));\n                   return x }\n</code></pre>\n\n<p>Input :</p>\n\n<pre><code>\"aaa : bbb ccc\"\n\"\\:aaa : \\%bbb \\\\ccc\n</code></pre>\n\n<p>Output :</p>\n\n<pre><code>[[\"aaa\"] , [\"bbb\"] , [\"ccc\"]]\n[[\":aaa\"] , [\"%bbb\"] , [\"\\ccc\"]]    \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1478456838, "post_id": 40452807, "comment_id": 68151203, "body": "You example <code>A</code> actually generates <code>Hello,.my..Danny.and.I..Haskell</code>. I use points instead of spaces since somehow SO cuts superfluous whitespace in comments (even in code blocks)."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1478465171, "post_id": 40452807, "comment_id": 68154111, "body": "Nice job! Note that <code>drop 1</code> is just <code>tail</code>. Also, you could probably clean up the code a little but by using pattern matching and a <code>where</code> clause. As @ChrisMartin said, <code>Parser</code>s can also be used, especially for more complicated problems."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1478457862, "post_id": 40452901, "comment_id": 68151606, "body": "Thank you for answering (and editing my post, was trying to get that format for ages).  So, the output of s1 should be added to a new list (my guess), or to the end of what is left after s2 has been ran? I have looked at your example of s1, and obviously like mine, it drops the entire rest of the string, and just takes the content before the $, so how would I amend that to get everything after the $ passed to s2?"}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1478457914, "post_id": 40452901, "comment_id": 68151625, "body": "@DannyWilson You&#39;re welcome! To format your code as code use only four spaces, <i>not</i> prefaced with <code>&gt;</code>."}, {"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1478458370, "post_id": 40452901, "comment_id": 68151783, "body": "The main problem I&#39;m having with Haskell is learning the syntax, so with your guard, the first case passes when the parsing is complete (I&#39;m guessing), then the otherwise is what will call the  takeWhile/dropWhile functions?"}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1478458723, "post_id": 40452901, "comment_id": 68151896, "body": "@DannyWilson Yes exactly."}, {"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1478459036, "post_id": 40452901, "comment_id": 68152006, "body": "So, what I&#39;m thinking is, the result of s1 is essentially just the first part of the text. So if I then passed the original string to the dropWhile function, got it to end at the end character, joined that result to the original result and ran through s3 again recursively?   This sounds feasible but the only way I can think of getting it working is using a different end character to the start character, any tip on how to do it with the same character? Because my dropWhile will just cut off at the first $ otherwise?"}, {"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1478462658, "post_id": 40452901, "comment_id": 68153190, "body": "Thank you for all your help, managed to solve (in case you are interested). I will edit it into the main post!"}], "tags": [], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "is_accepted": true, "score": 2, "last_activity_date": 1478459503, "last_edit_date": 1478459503, "creation_date": 1478456605, "answer_id": 40452901, "question_id": 40452807, "link": "https://stackoverflow.com/questions/40452807/cutting-specific-chunks-from-a-haskell-string/40452901#40452901", "title": "Cutting specific chunks from a Haskell String", "body": "<p>Your infinite loop comes from calling <code>s3</code> recursively with no base case:</p>\n\n<pre><code>s3 :: String -&gt; String\ns3 xs = s3 $ s2 $ s1 xs\n</code></pre>\n\n<p>Adding a base case corrects the infinite loop:</p>\n\n<pre><code>s3 xs\n  | '$' `notElem` xs = xs\n  | otherwise = ...\n</code></pre>\n\n<p>This is not the whole answer. Think about what <code>s1</code> actually does and where you use its return value:</p>\n\n<pre><code>s1 \"hello $my name is$ ThreeFx\" == \"hello \"\n</code></pre>\n\n<p>For further reference, see the <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:break\" rel=\"nofollow noreferrer\"><code>break</code></a> function:</p>\n\n<pre><code>break :: (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1478462747, "post_id": 40453824, "comment_id": 68153215, "body": "Thank you for the added solution! The actual libraries I&#39;m working on are parsers, and I really wanted to do it from the bottom up, bringing in more advanced parsing (like your example) later on. Thank you for your solution though! Was an interesting read, and will no doubt help me later in my project!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1478462902, "post_id": 40453824, "comment_id": 68153272, "body": "This is an elegant approach. Maybe adding some comments could also make it more accessible to who never used trifecta. Most of it is self-documenting, to a trained eye, but I had to pause to guess e.g. why <code>&quot;&quot; &lt;$</code> and why <code>fold &lt;$&gt;</code>."}, {"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1478463099, "post_id": 40453824, "comment_id": 68153342, "body": "Some comments would be helpful! (It would help when I come to more advanced parsing)"}, {"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1478463982, "post_id": 40453824, "comment_id": 68153649, "body": "@ChrisMartin That edit helps a lot! Thank you! Would you consider this solution, or my edit to the original post, more efficient?"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1478464056, "post_id": 40453824, "comment_id": 68153681, "body": "I have no idea :)"}], "tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 4, "last_activity_date": 1478468320, "last_edit_date": 1478468320, "creation_date": 1478462015, "answer_id": 40453824, "question_id": 40452807, "link": "https://stackoverflow.com/questions/40452807/cutting-specific-chunks-from-a-haskell-string/40453824#40453824", "title": "Cutting specific chunks from a Haskell String", "body": "<p>This seems like a nice application for parsers. A solution using <a href=\"https://hackage.haskell.org/package/trifecta\" rel=\"nofollow noreferrer\">trifecta</a>:</p>\n\n<pre><code>import Control.Applicative\nimport Data.Foldable\nimport Data.Functor\nimport Text.Trifecta\n\ninput :: String\ninput = \"Hello, my $name is$ Danny and I $like$ Haskell\"\n</code></pre>\n\n<hr>\n\n<pre><code>cutChunk :: CharParsing f =&gt; f String\ncutChunk = \"\" &lt;$ (char '$' *&gt; many (notChar '$') &lt;* char '$')\n</code></pre>\n\n<p><code>cutChunk</code> matches <code>$</code>, followed by 0 or more (<code>many</code>) non-<code>$</code> characters, then another <code>$</code>. Then we use <code>(\"\" &lt;$)</code> to make this parser's value always be the empty string, thus discarding all the characters that this parser matches.</p>\n\n<hr>\n\n<pre><code>includeChunk :: CharParsing f =&gt; f String\nincludeChunk = some (notChar '$')\n</code></pre>\n\n<p><code>includeChunk</code> matches the text that we want to include in the result, which is anything that's not the <code>$</code> character. It's important that we use <code>some</code> (matching one or more characters) and not <code>many</code> (matching zero or more characters) because we're going to include this parser within another <code>many</code> expression next; if this parser matched on the empty string, then that could loop infinitely.</p>\n\n<hr>\n\n<pre><code>chunks :: CharParsing f =&gt; f String\nchunks = fold &lt;$&gt; many (cutChunk &lt;|&gt; includeChunk)\n</code></pre>\n\n<p><code>chunks</code> is the parser for everything. Read <code>&lt;|&gt;</code> as \"or\", as in \"parse either a <code>cutChunk</code> or an <code>includeChunk</code>\". <code>many (cutChunk &lt;|&gt; includeChunk)</code> is a parser that produces a list of chunks e.g. <code>Success [\"Hello, my \",\"\",\" Danny and I \",\"\",\" Haskell\"]</code>, so we <code>fold</code> the output to concatenate those chunks together into a single string.</p>\n\n<hr>\n\n<pre><code>result :: Result String\nresult = parseString chunks mempty input\n</code></pre>\n\n<p>The result:</p>\n\n<pre><code>Success \"Hello, my  Danny and I  Haskell\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "edited": false, "score": 0, "creation_date": 1478463277, "post_id": 40453954, "comment_id": 68153397, "body": "This is interesting, certainly simpler than my approach. I don&#39;t suppose you could explain it a little more so I can use similar logic in the future? The go and single colon part in particular?"}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1478468980, "last_edit_date": 1478468980, "creation_date": 1478462807, "answer_id": 40453954, "question_id": 40452807, "link": "https://stackoverflow.com/questions/40452807/cutting-specific-chunks-from-a-haskell-string/40453954#40453954", "title": "Cutting specific chunks from a Haskell String", "body": "<p>I think your logic is wrong, perhaps easier to write it in an elementary way</p>\n\n<pre><code>Prelude&gt; let pr xs = go xs True\nPrelude|           where go [] _ = []\nPrelude|                 go (x:xs) f | x=='$' = go xs (not f)\nPrelude|                             | f = x : go xs f\nPrelude|                             | otherwise = go xs f\nPrelude|\n\nPrelude&gt; pr \"Hello, my $name is$ Danny and I $like$ Haskell\"\n\"Hello, my  Danny and I  Haskell\"\n</code></pre>\n\n<p><strong>Explanation</strong>  The flag <code>f</code> keeps track of the state (either pass mode or not).  If the current char is a token skip and switch state.</p>\n"}], "owner": {"reputation": 181, "user_id": 4633831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cc93c4479491b84c5a3d1ebcb3fdd68?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Wilson", "link": "https://stackoverflow.com/users/4633831/danny-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 40452901, "answer_count": 3, "score": 2, "last_activity_date": 1501072953, "creation_date": 1478456119, "last_edit_date": 1501072953, "question_id": 40452807, "link": "https://stackoverflow.com/questions/40452807/cutting-specific-chunks-from-a-haskell-string", "title": "Cutting specific chunks from a Haskell String", "body": "<p>I'm trying to cut chunks from a list, with a given predicate. I would have preferred to use a double character, e.g. <code>~/</code>, but have resolved to just using <code>$</code>. What I essentially want to do is this...</p>\n\n<p><code>A: \"Hello, my $name is$ Danny and I $like$ Haskell\"</code></p>\n\n<p>What I want to turn this into is this:</p>\n\n<p><code>B: \"Hello, my Danny and I Haskell\"</code></p>\n\n<p>So I want to strip everything in between the given symbol, <code>$</code>, or my first preference was <code>~/</code>, if I can figure it out. What I tried was this:</p>\n\n<pre><code>s1 :: String -&gt; String\ns1 xs = takeWhile (/= '$') xs\n\ns2 :: String -&gt; String\ns2 xs = dropWhile (/= '$') xs\n\ns3 :: String -&gt; String\ns3 xs = s3 $ s2 $ s1 xs\n</code></pre>\n\n<p>This solution seems to just bug my IDE out (possibly infinite looping).</p>\n\n<p>Solution:</p>\n\n<pre><code>s3 :: String -&gt; String\ns3 xs\n |'$' `notElem` xs = xs\n |otherwise = takeWhile (/= '$') xs ++ (s3 $ s1 xs)\n\ns1 :: String -&gt; String\ns1 xs = drop 1 $ dropWhile (/= '$') $ tail $ snd $ break ('$'==) xs\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "haskell-stack"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520369464, "post_id": 40451621, "comment_id": 85284728, "body": "<a href=\"https://ghc.haskell.org/trac/ghc/ticket/9438\" rel=\"nofollow noreferrer\">Relevant bug report on GHC Trac.</a> The lack of diagnosis there makes me think it would be quite a lot of work to answer this question properly."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1520533203, "post_id": 40451621, "comment_id": 85365247, "body": "For some reason, the original question asker&#39;s answer was deleted, but it looks pretty on-topic and relevant to me. So I quote it here: &quot;Turns out I didn&#39;t compile symengine as a shared library&quot;. It was marked as &quot;not an answer&quot;, but that looks like an answer to me: if other people are getting this error, perhaps try building your foreign libraries as shared libraries and see if that helps the situation."}], "owner": {"reputation": 491, "user_id": 2017673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hr1yg.jpg?s=128&g=1", "display_name": "aqui8", "link": "https://stackoverflow.com/users/2017673/aqui8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1520467134, "creation_date": 1478449461, "last_edit_date": 1478475665, "question_id": 40451621, "link": "https://stackoverflow.com/questions/40451621/haskell-ghc-build-error-loading-archives-not-supported", "title": "Haskell GHC build error: Loading archives not supported", "body": "<p>I'm trying to link a foreign cpp library with haskell. Running <code>stack build</code> seems to build it correctly but when I try to run <code>stack repl</code> I get this error:</p>\n\n<pre><code>ghc: panic! (the 'impossible' happened)\n  (GHC version 8.0.1 for x86_64-unknown-linux):\n    Loading archives not supported\n</code></pre>\n\n<p>app.cabal</p>\n\n<pre><code>executable app-server\n  ...\n  include-dirs: /usr/local/include\n  extra-libraries: symengine stdc++ gmpxx gmp\n  ...\n</code></pre>\n\n<p>stack.yml</p>\n\n<pre><code>flags: {}\npackages:\n- '.'\nextra-include-dirs:\n- /usr/local/include\nextra-lib-dirs:\n- /usr/local/lib\nextra-deps: []\nextra-package-dbs: []\nresolver: lts-7.1\n</code></pre>\n\n<p>I tried it on mac osx sierra and also debian jessie.\nUsing ghc-8.0.1 (from lts-7.1). \nI've installed <code>symengine stdc++ gmpxx gmp</code> on my machine.</p>\n\n<p>Does anyone know what I'm doing wrong here?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478450014, "post_id": 40451233, "comment_id": 68148748, "body": "I do not get indentation errors when I copy, paste and load your code. That almost always is a sign that you are mixing spaces and tabs. If that is indeed the case, replace all tabs in your code with spaces."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7122723, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/17a222d892f5c492f4a7210dce19a3ad?s=128&d=identicon&r=PG&f=1", "display_name": "bill williams", "link": "https://stackoverflow.com/users/7122723/bill-williams"}, "edited": false, "score": 0, "creation_date": 1478454766, "post_id": 40451778, "comment_id": 68150427, "body": "Thank you so much.That is really helpful :)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1478450288, "creation_date": 1478450288, "answer_id": 40451778, "question_id": 40451233, "link": "https://stackoverflow.com/questions/40451233/sum-of-lengths-of-a-line-segment-in-haskell/40451778#40451778", "title": "Sum of lengths of a line segment in haskell", "body": "<p>You forgot to actually add up the zipped list; <code>sum</code> will automatically handle the empty list. <code>zipWith</code> will return an empty list if <code>pts</code> has only one item, since <code>tail pts</code> will be empty. You do, however, need to treat an empty input separately. (I've defined a helper function, using pattern matching, to simplify the code a little).</p>\n\n<pre><code>lengthSum :: Floating a =&gt; [(a,a)] -&gt; a\nlengthSum [] = 0\nlengthSum pts = sum $ zipWith distance pts (tail pts)\n  where distance (x1,y1) (x2,y2) = sqrt ((x1-x2)^2 + (y1-y2)^2)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7122723, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/17a222d892f5c492f4a7210dce19a3ad?s=128&d=identicon&r=PG&f=1", "display_name": "bill williams", "link": "https://stackoverflow.com/users/7122723/bill-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 40451778, "answer_count": 1, "score": 1, "last_activity_date": 1478450288, "creation_date": 1478447188, "question_id": 40451233, "link": "https://stackoverflow.com/questions/40451233/sum-of-lengths-of-a-line-segment-in-haskell", "title": "Sum of lengths of a line segment in haskell", "body": "<p>I want to find the total of the lengths of the line segments between consecutive elements.How can I check if there is only one point and return 0.0 as the output.I am also getting indentation errors when I am executing the above code.</p>\n\n<pre><code>lengthSum :: Floating a =&gt; [(a, a)] -&gt; a\nlengthSum pts = zipWith (sqrt (x'*x' + y'*y')) pts $ tail pts\n    where \n        x' = fst(pts) - fst(head(tail(pts)))\n        y' = snd(pts) - snd(head(tail(pts)))\n\nInput: lengthSum [(0, 0)]\nExpected Output: 0.0\nInput: lengthSum [(0, 0), (0, 1), (3, 5)]\nExpected Output: 7.0\n</code></pre>\n\n<p>Please can anyone help me I am newbie in haskell</p>\n"}, {"tags": ["haskell", "monads", "parsec"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1478453322, "post_id": 40450864, "comment_id": 68149929, "body": "<code>assertEqual</code> and <code>assertBool</code> are from the <a href=\"http://hackage.haskell.org/package/HTF-0.13.1.0/docs/Test-Framework-HUnitWrapper.html\" rel=\"nofollow noreferrer\"><i>HTF</i></a> package, while <code>(|&gt;)</code> is from <a href=\"https://hackage.haskell.org/package/flow-1.0.7/docs/Flow.html\" rel=\"nofollow noreferrer\"><i>flow</i></a> and is just a synonym for <code>flip ($)</code> and <code>(&amp;)</code>. (Mentioning the not-so-well-known packages that you are using makes for clearer questions.)"}, {"owner": {"reputation": 3335, "user_id": 1017211, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/7vlEI.png?s=128&g=1", "display_name": "monnef", "link": "https://stackoverflow.com/users/1017211/monnef"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478505521, "post_id": 40450864, "comment_id": 68165582, "body": "@duplode Oh, thank you (I thought imports were enough). I knew <i>flow</i> isn&#39;t much popular among Haskellers, but <i>HTF</i> isn&#39;t too? Is there some better alternative which can run all unit tests in a module without boilerplate?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478508007, "post_id": 40450864, "comment_id": 68166708, "body": "&quot;I thought imports were enough&quot; -- They are enough in the sense that they provide enough information to search for and eventually find them and the relevant functions. It is just a matter of convenience for readers of the question. (I have nothing to say against any of the packages you have used.)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478523662, "post_id": 40450864, "comment_id": 68175857, "body": "Actually, thinking about what I just said, I think you are right: I was a touch too pedantic/demanding in asking for links to packages that are available from Hackage, given that you correctly mentioned the module names. Your question was just fine. If you feel like making it easier for those who read your question, use explicit import lists (e.g. <code>import Test.Framework (assertEqual, assertBool)</code>). They also have the advantage of making it easier for you to recall which module provided each thing, should you need to read again your code at some point in the future."}, {"owner": {"reputation": 3335, "user_id": 1017211, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/7vlEI.png?s=128&g=1", "display_name": "monnef", "link": "https://stackoverflow.com/users/1017211/monnef"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478545829, "post_id": 40450864, "comment_id": 68189937, "body": "I think you are right, this question is from/for beginners, so stating imports explicitly and having links to packages is IMO a nice touch. I have updated it that way. (That HTF is using some meta magic, couldn&#39;t make explicit imports to work -_-*.)"}], "answers": [{"tags": [], "owner": {"reputation": 3335, "user_id": 1017211, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/7vlEI.png?s=128&g=1", "display_name": "monnef", "link": "https://stackoverflow.com/users/1017211/monnef"}, "is_accepted": false, "score": 0, "last_activity_date": 1478445490, "creation_date": 1478445490, "answer_id": 40450948, "question_id": 40450864, "link": "https://stackoverflow.com/questions/40450864/refactoring-where-clause/40450948#40450948", "title": "Refactoring where clause", "body": "<p>I am still not sure about those monads, but I got it somehow working (those <code>_</code> aka typeholes helped a lot, didn't know about them).</p>\n\n<pre><code>pos_neg_case :: Parser a -&gt; [String -&gt; IO ()]\npos_neg_case parser = [positive, negative]\n  where\n    fullParser = parser &gt;&gt; eof\n    parseIt = parse fullParser \"\"\n    positive str = assertEqual (parseIt str) (Right ())\n    negative str = assertBool (parseIt str |&gt; isLeft)\n</code></pre>\n\n<p>But I had to guess the Parser type, hole was giving me very complex thingy - <code>Text.Parsec.Prim.ParsecT s () Data.Functor.Identity.Identity a -&gt; [s -&gt; IO ()]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3335, "user_id": 1017211, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/7vlEI.png?s=128&g=1", "display_name": "monnef", "link": "https://stackoverflow.com/users/1017211/monnef"}, "edited": false, "score": 0, "creation_date": 1478454526, "post_id": 40452283, "comment_id": 68150347, "body": "Thank you for explanation :)."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 0, "last_activity_date": 1478453408, "last_edit_date": 1478453408, "creation_date": 1478453101, "answer_id": 40452283, "question_id": 40450864, "link": "https://stackoverflow.com/questions/40450864/refactoring-where-clause/40452283#40452283", "title": "Refactoring where clause", "body": "<p>As you have noticed, the problem was the <code>return</code> you added to:</p>\n\n<pre><code>pos_neg_case parser = do\n  return [positive, negative]\n  where -- etc.\n</code></pre>\n\n<p>The type of <code>mapM_</code> is:</p>\n\n<pre><code>GHCi&gt; :t mapM_\nmapM_ :: (Foldable t, Monad m) =&gt; (a -&gt; m b) -&gt; t a -&gt; m ()\n</code></pre>\n\n<p><code>positive</code> and <code>negative</code> are functions which already have appropriate types to be passed to <code>mapM</code>, and so if you want <code>pos_neg_case</code> to give them back as a list you don't need to do anything more than wrapping in a list. <code>return</code> is not a keyword; it is just a function that injects a value into a monadic context. If you don't need to do any such injection, you don't need <code>return</code>.</p>\n\n<p>P.S.: Quoting your answer:</p>\n\n<blockquote>\n  <p>But I had to guess the Parser type, hole was giving me very complex thingy \n  <code>Text.Parsec.Prim.ParsecT s () Data.Functor.Identity.Identity a -&gt; [s -&gt; IO ()]</code>.</p>\n</blockquote>\n\n<p>This is an example of a quite common pattern. <code>ParsecT</code> is a type constructor with quite a few type variables, and <code>Parser</code> is a type synonym for a common set of choices of some of these variables, which allows for tidier type signatures which do not mention them explicitly. If you look for it in the <a href=\"https://hackage.haskell.org/package/parsec-3.1.11/docs/Text-ParserCombinators-Parsec-Prim.html#t:Parser\" rel=\"nofollow noreferrer\">documentation</a> (the index helps a lot in such cases) or use <code>:info</code> in GHCi, you will find that <code>Parser</code> just means...</p>\n\n<pre><code>type Parser = Parsec String ()\n</code></pre>\n\n<p>... and <code>Parsec</code>, in turn is...</p>\n\n<pre><code>type Parsec s u = ParsecT s u Identity\n</code></pre>\n\n<p>... so that expanding the <code>Parser</code> synonym gives <code>ParsecT String () Identity</code>, which is what GHC told you when you introduced the type hole.</p>\n"}], "owner": {"reputation": 3335, "user_id": 1017211, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/7vlEI.png?s=128&g=1", "display_name": "monnef", "link": "https://stackoverflow.com/users/1017211/monnef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 40452283, "answer_count": 2, "score": 3, "last_activity_date": 1478545412, "creation_date": 1478444997, "last_edit_date": 1478545412, "question_id": 40450864, "link": "https://stackoverflow.com/questions/40450864/refactoring-where-clause", "title": "Refactoring where clause", "body": "<p>I am learnig Haskell, so it's probably something pretty trivial, but I would appreciate some pointers on how to rewrite it and how it works.</p>\n\n<p>I have following working code (used packages: <a href=\"http://hackage.haskell.org/package/HTF\" rel=\"nofollow noreferrer\" title=\"HTF\">HTF</a>, <a href=\"http://hackage.haskell.org/package/parsec\" rel=\"nofollow noreferrer\" title=\"Parsec\">Parsec</a> and <a href=\"http://hackage.haskell.org/package/flow\" rel=\"nofollow noreferrer\">Flow</a>):</p>\n\n<pre><code>{-# OPTIONS_GHC -F -pgmF htfpp #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nmodule Main where\n\nimport Test.Framework -- assertEqual, assertBool, htfMain, htf_thisModulesTests\nimport Text.ParserCombinators.Parsec (eof, spaces, parse)\nimport Flow ((|&gt;))\nimport Data.Either (isLeft)\n\nwhiteSpaces = spaces\n\ntest_parse_whitespace = do\n  mapM_ positive [\n      \"\", \" \", \"\\t\", \"\\n\", \"\\r\\n\", \"  \\r\\n  \",\n      \"   \\t   \\r\\n  \\t  \\n   \\r  \\t \"\n    ]\n  mapM_ negative [\"x\",  \" x\",  \"x \",  \" x \",  \"\\t_\\t\"]\n  where\n    parser = whiteSpaces &gt;&gt; eof\n    parseIt = parse parser \"\"\n    positive str = assertEqual (parseIt str) (Right ())\n    negative str = assertBool (parseIt str |&gt; isLeft)\n\nmain :: IO ()\nmain = htfMain htf_thisModulesTests\n</code></pre>\n\n<p>I am adding a new test which have almost same the  where part, so I tried to refactor it like this:</p>\n\n<pre><code>pos_neg_case parser = do\n  return [positive, negative]\n  where\n    fullParser = parser &gt;&gt; eof\n    parseIt = parse fullParser \"\"\n    positive str = assertEqual (parseIt str) (Right ())\n    negative str = assertBool (parseIt str |&gt; isLeft)\n\ntest_parse_whitespace' = do\n  mapM_ positive [\n      \"\", \" \", \"\\t\", \"\\n\", \"\\r\\n\", \"  \\r\\n  \",\n      \"   \\t   \\r\\n  \\t  \\n   \\r  \\t \"\n    ]\n  mapM_ negative [\"x\",  \" x\",  \"x \",  \" x \",  \"\\t_\\t\"]\n  where\n    [positive, negative] = pos_neg_case whiteSpaces\n</code></pre>\n\n<p>Which doesn't work (even when I turn the lang. feature on as compiler suggests).</p>\n\n<pre><code>Couldn't match expected type \u2018[Char] -&gt; m b0\u2019\n            with actual type \u2018[String -&gt; IO ()]\u2019\nRelevant bindings include\n  test_parse_whitespace' :: m () (bound at test/Spec.hs:21:1)\nIn the first argument of \u2018mapM_\u2019, namely \u2018positive\u2019\nIn a stmt of a 'do' block:\n  mapM_ positive [\"\", \" \", \"\\t\", \"\\n\", ....]\n\nCouldn't match expected type \u2018[Char] -&gt; m b1\u2019\n            with actual type \u2018[String -&gt; IO ()]\u2019\nRelevant bindings include\n  test_parse_whitespace' :: m () (bound at test/Spec.hs:21:1)\nIn the first argument of \u2018mapM_\u2019, namely \u2018negative\u2019\nIn a stmt of a 'do' block:\n  mapM_ negative [\"x\", \" x\", \"x \", \" x \", ....]\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "bind"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1478445333, "post_id": 40450789, "comment_id": 68147173, "body": "The definition in your course material defines a different function that does something else. You are right to be suspicious. I challenge you to prove they&#39;re different by calling each with the same arguments and getting different results."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478445729, "post_id": 40450789, "comment_id": 68147329, "body": "I challenge you also to write a <code>do</code>-based version of <code>foldM</code> that&#39;s equivalent to the usual definition."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478448910, "post_id": 40451334, "comment_id": 68148350, "body": "Whereas <code>foldl</code> can be implemented in terms of <code>foldr</code>, I don&#39;t think either <code>foldM</code> or <code>foldMDo</code> can be implemented in terms of the other. A monad with failure allows <code>foldM</code> to terminate with an infinite list (sometimes), while a monad with left-lazy <code>&gt;&gt;=</code> allows <code>foldMDo</code> to terminate with an infinite list (sometimes). Of course, both <code>foldM</code> and <code>foldMDo</code> can be implemented in terms of <code>foldr</code>."}, {"owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "edited": false, "score": 0, "creation_date": 1478450007, "post_id": 40451334, "comment_id": 68148742, "body": "Thanks for your reply. What still confuses me about the foldMDo function is that, taking your &#39;print&#39; function as an example, there is just 1 line that actually prints the ints: <code>f r x</code>. How and when are all 10 ints printed? Is the entire bind chain of <code>r &lt;- foldMDo f z xs</code> evaluated once, or is the do-block recursively called 10 times?"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 2, "last_activity_date": 1478447791, "creation_date": 1478447791, "answer_id": 40451334, "question_id": 40450789, "link": "https://stackoverflow.com/questions/40450789/haskell-define-foldm-in-do-notation/40451334#40451334", "title": "Haskell: define foldM in do-notation", "body": "<p>The latter variant evaluates the actions on the list from right-to-left, whereas the other one evaluates the actions on the list from right-to-left. Let's call the latter <code>foldMDo</code>, so that we can keep them apart:</p>\n\n<pre><code>foldM             :: (Monad m) =&gt; (a -&gt; b -&gt; m a) -&gt; a -&gt; [b] -&gt; m a\nfoldM _ a []      =  return a\nfoldM f a (x:xs)  =  f a x &gt;&gt;= \\fax -&gt; foldM f fax xs\n\nfoldMDo _ z []     = return z\nfoldMDo f z (x:xs) = do r &lt;- foldMDo f z xs\n                      f r x\n</code></pre>\n\n<p>If we use them to print a list, the difference is immediately obvious: </p>\n\n<pre><code>ghci&gt; foldM (\\_ y -&gt; print y) () [1..10]\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\nghci&gt; foldMDo (\\_ y -&gt; print y) () [1..10]\n10\n9\n8\n7\n6\n5\n4\n3\n2\n1\n</code></pre>\n\n<p>So, let's desugar the <code>do</code> variant:</p>\n\n<pre><code>do r &lt;- foldMDo f z xs\n   f r x\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>foldMDo f z xs &gt;&gt;= \\fzxs -&gt; f fzxs x\n</code></pre>\n\n<p>Let's compare this to the other one next to each other:</p>\n\n<pre><code>(1) f a x          &gt;&gt;= \\fax  -&gt; foldM f fax  xs\n(2) foldMDo f z xs &gt;&gt;= \\fzxs -&gt;       f fzxs x\n</code></pre>\n\n<p>We can compare that to <code>foldl</code> and <code>foldr</code> with explicit <code>let...in</code>:</p>\n\n<pre><code>foldr f a (x:xs) = let acc = foldr f a xs\n                   in f a acc\nfoldl f a (x:xs) = let acc = f a x\n                   in foldr f acc xs\n</code></pre>\n\n<p>The uni material looks like <code>foldr</code>, whereas the default one looks like <code>foldl</code>, as it is expected with the order of evaluation.</p>\n\n<p>And for completion, let's add the <code>do</code> version of your <code>foldM</code>:</p>\n\n<pre><code>foldM f a (x:xs) = do fax &lt;- f a x\n                      foldM f fax xs\n</code></pre>\n\n<h1>TL;DR</h1>\n\n<p>Your uni course material doesn't implement <code>foldM</code>, since it doesn't do left-to-right evaluation, but instead right-to-left. Essentially,</p>\n"}], "owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1478447791, "creation_date": 1478444590, "question_id": 40450789, "link": "https://stackoverflow.com/questions/40450789/haskell-define-foldm-in-do-notation", "title": "Haskell: define foldM in do-notation", "body": "<p>I am confused about defining <code>foldM</code> in a do-block, mainly because of its recursion. The standard definition for <code>foldM</code> is as follows:</p>\n\n<pre><code>foldM             :: (Monad m) =&gt; (a -&gt; b -&gt; m a) -&gt; a -&gt; [b] -&gt; m a\nfoldM _ a []      =  return a\nfoldM f a (x:xs)  =  f a x &gt;&gt;= \\fax -&gt; foldM f fax xs\n</code></pre>\n\n<p>I understand this definition; the result of <code>f a x</code> is passed into a new <code>foldM</code> function recursively, until the list is empty. Here is a definition of <code>foldM</code> in a do-block (copied from my uni course material):</p>\n\n<pre><code>foldM _ z []     = return z\nfoldM f z (x:xs) = do r &lt;- foldM f z xs\n                      f r x\n</code></pre>\n\n<p>I know that the definition of a do block is basically syntactic sugar for bind <code>(&gt;&gt;=)</code> operations. However, I can't seem to grasp how this definition works. I find recursion in do-blocks overall very confusing. What is given to <code>r</code>? How can the recursive line <code>r &lt;- foldM f z xs</code> be correct when <code>foldM</code> is passed <code>z</code> every recursive call? Shouldn't it be passed a recursively updated argument like <code>f z x</code>, as in the <code>foldM</code> definition with <code>(&gt;&gt;=)</code>?</p>\n"}, {"tags": ["algorithm", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "edited": false, "score": 0, "creation_date": 1478438323, "post_id": 40449648, "comment_id": 68144891, "body": "Thanks! I made all the changes: (reverse order, fixed the bug, and don&#39;t use length). If I try more than 62 steps, it never finish: <a href=\"http://pastebin.com/0nZeTjVa\" rel=\"nofollow noreferrer\">pastebin.com/0nZeTjVa</a>"}], "tags": [], "owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "is_accepted": true, "score": 2, "last_activity_date": 1478439178, "last_edit_date": 1478439178, "creation_date": 1478437438, "answer_id": 40449648, "question_id": 40449556, "link": "https://stackoverflow.com/questions/40449556/haskell-knight-tour-never-finish-if-i-try-more-than-55-steps/40449648#40449648", "title": "Haskell: Knight tour never finish if I try more than 55 steps?", "body": "<p>It does terminate (it runs for about 1 minute on my computer) and produces a correct answer. </p>\n\n<p>One simple way to speed it up is to add a new move to the front of the list (and reverse the result before printing it). Adding the first element takes constant time, while append an element to the back of the list is linear in its size. </p>\n\n<p>There is also a bug in your code: <code>m3</code> and <code>m7</code> are the same. After fixing this bug and adding the new move to the front of the list, the code runs in under once second:</p>\n\n<pre><code>maxX = 8\nmaxY = 8\nmaxSteps = 60\n\nmove :: [(Int, Int)] -&gt; [( Int, Int)]\nmove list \n   | lastX &gt; maxX || lastY &gt; maxY || lastX &lt;= 0 || lastY &lt;= 0 = []\n   | lastMove `elem` (tail list) = []\n   | length list == maxSteps = list\n   | length m1 == maxSteps = m1\n   | length m2 == maxSteps = m2\n   | length m3 == maxSteps = m3\n   | length m4 == maxSteps = m4\n   | length m5 == maxSteps = m5\n   | length m6 == maxSteps = m6\n   | length m7 == maxSteps = m7\n   | length m8 == maxSteps = m8\n   | otherwise = []\n   where lastMove = head list\n         lastX = fst lastMove\n         lastY = snd lastMove\n         m1 = move ((lastX + 1, lastY + 2) : list)\n         m2 = move ((lastX + 2, lastY + 1) : list)\n         m3 = move ((lastX - 1, lastY + 2) : list)\n         m4 = move ((lastX - 2, lastY + 1) : list)\n         m5 = move ((lastX + 1, lastY - 2) : list)\n         m6 = move ((lastX + 2, lastY - 1) : list)\n         m7 = move ((lastX - 1, lastY - 2) : list)\n         m8 = move ((lastX - 2, lastY - 1) : list)\ny = move [(1, 1)]\nmain = print $ reverse y    \n</code></pre>\n\n<p>I have a made a few more changes. First of all, I got rid of \"manually\" adding 8 possible moves at each step. We can use a list to do that. This approach helps to avoid bugs like this. It also turns out that the execution time depends on the order in which new moves are examined. This version finds an open tour in about a minute (and, in my opinion, it's more readable than the original code):</p>\n\n<pre><code>maxX = 8\nmaxY = 8\nmaxSteps = 64\nshifts = [-1, 1, -2, 2]\n\nmove :: [(Int, Int)] -&gt; [(Int, Int)]\nmove path\n   | lastX &gt; maxX || lastY &gt; maxY || lastX &lt;= 0 || lastY &lt;= 0 = []\n   | lastMove `elem` tail path = []\n   | length path == maxSteps = path\n   | not (null validNewPaths) = head validNewPaths\n   | otherwise = []\n   where lastMove@(lastX, lastY) = head path\n         newPaths = [(lastX + x, lastY + y) : path | x &lt;- shifts, y &lt;- shifts, abs x /= abs y]\n         validNewPaths = filter (\\xs -&gt; length xs == maxSteps) (map move newPaths) \n\nmain = print $ reverse (move [(1, 1)])\n</code></pre>\n"}], "owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 40449648, "answer_count": 1, "score": 1, "last_activity_date": 1478439178, "creation_date": 1478436759, "question_id": 40449556, "link": "https://stackoverflow.com/questions/40449556/haskell-knight-tour-never-finish-if-i-try-more-than-55-steps", "title": "Haskell: Knight tour never finish if I try more than 55 steps?", "body": "<p>This is my code:</p>\n\n<pre><code>maxX=8; maxY=8; \nmaxSteps=60 -- If I change maxSteps=55 I get an answer\nmove :: [(Int, Int)] -&gt; [( Int, Int)]\nmove list \n   | lastX&gt;maxX || lastY&gt;maxY || lastX&lt;=0 || lastY&lt;=0 = []\n   | lastMove `elem` (init list) = []\n   | length list == maxSteps = list\n   | length m1 == maxSteps = m1\n   | length m2 == maxSteps = m2\n   | length m3 == maxSteps = m3\n   | length m4 == maxSteps = m4\n   | length m5 == maxSteps = m5\n   | length m6 == maxSteps = m6\n   | length m7 == maxSteps = m7\n   | length m8 == maxSteps = m8\n   | otherwise = []\n   where lastMove = last list\n         lastX = fst lastMove\n         lastY = snd lastMove\n         m1 = move (list ++ [(lastX+1,lastY+2)])\n         m2 = move (list ++ [(lastX+2,lastY+1)])\n         m3 = move (list ++ [(lastX-1,lastY+2)])\n         m4 = move (list ++ [(lastX-2,lastY+1)])\n         m5 = move (list ++ [(lastX+1,lastY-2)])\n         m6 = move (list ++ [(lastX+2,lastY-1)])\n         m7 = move (list ++ [(lastX-1,lastY+2)])\n         m8 = move (list ++ [(lastX-2,lastY-1)])\ny = move [(1,1)]\nmain = print $ y\n</code></pre>\n\n<p>Do you know why it never finish (Maybe I can wait more...)? Do you have other solution to implement same brute-force algorithm but will work faster?</p>\n"}, {"tags": ["arrays", "haskell", "moving-average", "weighted-average"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1478428751, "post_id": 40448260, "comment_id": 68142502, "body": "Given some magic, I&#39;d like a pony. But seriously, that is horrendously underspecified. What is <code>x</code>? What is <code>w</code> (perhaps you meant <code>weight</code>)? Is <code>length w</code> always  <code>5</code>? Do you have a reference implementation in another language?  <b>What have you tried</b>?"}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1478428848, "post_id": 40448260, "comment_id": 68142531, "body": "X is the input array, w are the weights, y is the resulting array"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1478428998, "post_id": 40448260, "comment_id": 68142580, "body": "Given that we&#39;re in a language without arrays, I assume that you&#39;re a language beginner. Either way, additional information should be <a href=\"https://stackoverflow.com/posts/40448260/edit\">edit</a>ed into the question itself, that way other users don&#39;t have to scavenge information from the comments. I don&#39;t have time to give a complete answer, but this should be feasible with <code>tails</code>, <code>zipWith</code> and a little bit of boundary fiddling."}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1478429712, "post_id": 40448260, "comment_id": 68142778, "body": "I&#39;ve added the <b>solution</b> to my problem in python, I would appreciate it if you would uncast the close vote"}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1478431654, "post_id": 40448561, "comment_id": 68143226, "body": "<code>takeWhile (&gt;= length weights)</code> isn&#39;t very resource friendly. Instead, use <code>l = length weights</code> once and then <code>not . null . drop (l - 1)</code> to check whether the list has at least <code>l</code> elements."}], "tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": true, "score": 2, "last_activity_date": 1478439319, "last_edit_date": 1478439319, "creation_date": 1478430096, "answer_id": 40448561, "question_id": 40448260, "link": "https://stackoverflow.com/questions/40448260/moving-average-in-haskell/40448561#40448561", "title": "Moving average in Haskell", "body": "<p><code>tails</code> gives you a list of the tails of the input list. So <code>tails [1,2,3] = [[1,2,3],[2,3],[3],[]]</code>. Since we don't need the last empty list we use <code>(init.tails)</code> to get everything in the tails list except the last element.</p>\n\n<pre><code>import Data.List (tails)\naverages :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\naverages weights xs = sum . zipWith (*) weights &lt;$&gt; (init.tails) xs\n</code></pre>\n\n<p>Note that this very likely doesn't behave the way you want at the start and end of the list. Especially because it behaves different at the start then at the end. The first element will be the average of the first <code>length weight</code> element, but the last element will only be <code>head weight * last xs</code>.</p>\n\n<p>If you want the behaviour of the end at the start you can use something like this:</p>\n\n<pre><code>import Data.List (tails)\naverages :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\naverages weights xs = sum . zipWith (*) weights &lt;$&gt;\n  (init.tails) (replicate (length weights - 1) 0 ++ xs)\n</code></pre>\n\n<p>If you want the behaviour of the end at the start you can use this:</p>\n\n<pre><code>import Data.List (tails)\naverages :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\naverages weights xs = sum . zipWith (*) weights &lt;$&gt;\n  takeWhile (not . null . drop (l-1)) (tails xs)\n  where l = length weights\n</code></pre>\n\n<p>If you want to start and end with the first/last element being multiplied with the center element of the weights list we have to use a combination of the two above answers:</p>\n\n<pre><code>import Data.List (tails)\naverages :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\naverages weights xs = sum . zipWith (*) weights &lt;$&gt;\n  takeWhile (not . null . drop half) (replicate half 0 ++ xs)\n  where half = length weights `quot` 2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1478460285, "post_id": 40448697, "comment_id": 68152430, "body": "&quot;Then Mealy machine approach will be the only reasonable solution&quot; \u2014 that&#39;s quite a strong claim. Do you have a reference?"}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1478461776, "post_id": 40448697, "comment_id": 68152951, "body": "@user3237465 You end up with something like Mealy machine if you restrict yourself to dealing with single input element at the time. There might be some combinator making moving buffers for you, but it&#39;s Mealy machine itself."}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 4, "last_activity_date": 1478431446, "last_edit_date": 1478431446, "creation_date": 1478430994, "answer_id": 40448697, "question_id": 40448260, "link": "https://stackoverflow.com/questions/40448260/moving-average-in-haskell/40448697#40448697", "title": "Moving average in Haskell", "body": "<p>Moving average can be calculated with a mealy machine, where the internal state is previous values.</p>\n\n<p>I'll show a moving average over three arguments example, you can fiddle yourself to e.g. make it parametrisable in size.</p>\n\n<p>Mealy machine is essentially an initial state, and \"state + input\" to \"new state + output\" function:</p>\n\n<pre><code>Mealy i o ~ (s, s -&gt; i -&gt; (o, s))\n</code></pre>\n\n<p>Let's assume that initial state is all zeros, and write a function for moving average over 3.</p>\n\n<pre><code>type S = (Double, Double)\ntype I = Double\ntype O = Double\n\ninitialState :: S\ninitialState = (0, 0)\n\nweight0, weight1, weight2 :: Double\nweight0 = 0.25\nweight1 = 0.5\nweight2 = 0.25\n\nma :: S -&gt; I -&gt; (O, S)\nma (x0, x1) x2 = (o, s)\n    where\n    s = (x1, x2)\n    o = x0 * weight0 + x1 * weight1 + x2 * weight2\n</code></pre>\n\n<p>Now we got all the pieces, let's run the machine on the input:</p>\n\n<pre><code>runMealy :: (S -&gt; I -&gt; (O, S)) -&gt; S -&gt; [I] -&gt; [O]\nrunMealy _ _ [] = []\nrunMealy f s (x : xs) =\n    let (o, s') = f s x\n    in o : runMealy f s' xs\n</code></pre>\n\n<p>And try it:</p>\n\n<pre><code>\u03bb *Main &gt; runMealy ma initialState [1,2,3,4,5,6,7,8,9]\n[0.25,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0]\n</code></pre>\n\n<hr>\n\n<p>You can drop first produced values, as machine internal state is \"warming up\".</p>\n\n<hr>\n\n<p>For arbitrary sized moving average machine, you could use <code>Data.Sequence</code>, as it's much better data structure when you push to one end, while pop from another, then <em>single linked list</em>, <code>[]</code>.</p>\n\n<hr>\n\n<p>Why I'm talking about Mealy machine? Because at some point you'll most likely run into situation where you need to use some streaming library in Haskell: <code>pipes</code>, <code>conduit</code> or <code>machines</code>. Then Mealy machine approach will be the only reasonable solution.</p>\n\n<p>Also you can make autoregressive models as well!</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1478434007, "creation_date": 1478434007, "answer_id": 40449148, "question_id": 40448260, "link": "https://stackoverflow.com/questions/40448260/moving-average-in-haskell/40449148#40449148", "title": "Moving average in Haskell", "body": "<p>The zipping takes care of the alignment automagically:</p>\n\n<pre><code>wma :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\nwma weights = map (sum . zipWith (*) weights )   -- weighted-moving-average\n                . foldr (zipWith (:)) (repeat []) \n                . take (length weights) \n                . tails \n</code></pre>\n\n<p>(<a href=\"https://stackoverflow.com/questions/24599875/is-there-a-built-in-function-to-get-all-consecutive-subsequences-of-size-n-of-a/24609264#24609264\">see also</a>).</p>\n"}], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "accepted_answer_id": 40448561, "answer_count": 3, "score": 4, "last_activity_date": 1486149994, "creation_date": 1478427940, "last_edit_date": 1486149994, "question_id": 40448260, "link": "https://stackoverflow.com/questions/40448260/moving-average-in-haskell", "title": "Moving average in Haskell", "body": "<p>Given a list of weights:</p>\n\n<pre><code>let weights = [0.1, 0.2, 0.4, 0.2, 0.1]\n</code></pre>\n\n<p>and an array of measurements, I want to implement the weighted average.</p>\n\n<p>This is how I would do it in Python:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>y=[]\nw = length(weights)\nfor n in range(w,len(x)-w):\n    y[n-w/2-1]=sum([a*b for a,b in zip(weights,x[n-w/2:n+w/2+1])])\n    #y[n-3]=W[1]*x[n-2]+W[2]*x[n-1]+W[3]*x[n]+W[4]*x[n+1]+W[5]*x[n+2]\n</code></pre>\n\n<p>I know Haskell doesn't have arrays, what I'm trying to achieve is a <a href=\"https://en.wikipedia.org/wiki/Low-pass_filter\" rel=\"nofollow noreferrer\">low-pass-filter</a>, in which I can define the weights manually.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1478427331, "post_id": 40448128, "comment_id": 68142125, "body": "Try matcing against <code>(x1:x2:xs)</code>."}, {"owner": {"reputation": 1, "user_id": 7120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c86d5d8ba518cc0206efcef5acc47c2?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Metzger", "link": "https://stackoverflow.com/users/7120097/dennis-metzger"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1478427696, "post_id": 40448128, "comment_id": 68142205, "body": "What you mean exactly can you give me the new code?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478440785, "post_id": 40448128, "comment_id": 68145677, "body": "The question is still bad. You should edit the first copy to improve it."}], "answers": [{"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 0, "last_activity_date": 1478433974, "creation_date": 1478433974, "answer_id": 40449144, "question_id": 40448128, "link": "https://stackoverflow.com/questions/40448128/interspace-function-in-haskell/40449144#40449144", "title": "Interspace function in Haskell", "body": "<p>Your program should look like</p>\n\n<pre><code>interspace m n q [] = []\ninterspace m n q (x1:x2:xs) | .... = ....\ninterspace m n q (x:xs) = x : interspace m n q xs\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c86d5d8ba518cc0206efcef5acc47c2?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Metzger", "link": "https://stackoverflow.com/users/7120097/dennis-metzger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "closed_date": 1478440696, "answer_count": 1, "score": 0, "last_activity_date": 1478433974, "creation_date": 1478426892, "last_edit_date": 1478427573, "question_id": 40448128, "link": "https://stackoverflow.com/questions/40448128/interspace-function-in-haskell", "closed_reason": "Duplicate", "title": "Interspace function in Haskell", "body": "<pre><code>insert :: Eq(a) =&gt; a -&gt; a -&gt; [a] -&gt; [a]\ninsert m n [] = []\ninsert m n (x1:x1:xs) | m==x = n : x : insert m n xs  \n    | otherwise = x : insert m n xs\n</code></pre>\n\n<p>The <code>insert</code> function already works. I need help with <code>interspace</code>. The aim is that I want two write an Element between two other Elements that are given. The program is written in Haskell. The <code>interspace</code> function should write a given Element between two other given elements if they are in the list.                  </p>\n\n<pre><code>interspace :: Eq(a) =&gt; a -&gt; a -&gt; a-&gt;[a] -&gt; [a]\ninterspace m n q[] = []\ninterspace m n q (x:xs)| m==x &amp;&amp; q==(head xs)  = n: x : insert m n (headxs)++interspace m n q (xs)\n    | otherwise = x : interspace m n q xs\n</code></pre>\n"}, {"tags": ["haskell", "function-composition"], "answers": [{"comments": [{"owner": {"reputation": 1436, "user_id": 3633116, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/776562355754015/picture?type=large", "display_name": "Nikas \u017dalias", "link": "https://stackoverflow.com/users/3633116/nikas-%c5%bdalias"}, "edited": false, "score": 0, "creation_date": 1478428058, "post_id": 40448195, "comment_id": 68142285, "body": "This doesn&#39;t work as it should be... maybe you didn&#39;t understood my question... when I call my function whit these parameters &quot;ff 26 [2, -3, 4]&quot; I should get the result of value 26, because (2 + 10) + (4 + 10) &lt;= 26.. Your approach just gives me last number increased by 10"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1436, "user_id": 3633116, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/776562355754015/picture?type=large", "display_name": "Nikas \u017dalias", "link": "https://stackoverflow.com/users/3633116/nikas-%c5%bdalias"}, "edited": false, "score": 1, "creation_date": 1478428468, "post_id": 40448195, "comment_id": 68142404, "body": "@Nikas\u017dalias it doesn&#39;t. <code>(\\maxNum -&gt; last . takeWhile (&lt;= maxNum) . scanl (+) 0 . map (+10) . filter (&gt; 0)) 26 [2,-3,4]</code> is 26. Did you really use <code>scanl</code> (<b>and</b> <code>takeWhile</code>?)"}, {"owner": {"reputation": 1436, "user_id": 3633116, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/776562355754015/picture?type=large", "display_name": "Nikas \u017dalias", "link": "https://stackoverflow.com/users/3633116/nikas-%c5%bdalias"}, "edited": false, "score": 0, "creation_date": 1478428939, "post_id": 40448195, "comment_id": 68142560, "body": "sorry, my mistake, somehow haskell wrongly compiled, not everything is fine.. thank you!!!!!!"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1478428538, "last_edit_date": 1478428538, "creation_date": 1478427462, "answer_id": 40448195, "question_id": 40448048, "link": "https://stackoverflow.com/questions/40448048/haskell-how-to-get-sum-of-all-positive-members-using-function-composition/40448195#40448195", "title": "Haskell how to get sum of all positive members using function composition?", "body": "<p>You need a rolling sum, e.g. something like</p>\n\n<pre><code>rollingSum [1..10] = [0,1,3,6,10,15,21,28,36,45,55]\n</code></pre>\n\n<p>After all, <code>sum</code> will only give you the <em>final</em> sum, where you need to check the intermediate ones.</p>\n\n<p>Luckily, <code>scanl (+) 0</code> provides this functionality. Therefore, you can take numbers of that rolling sum as long as they are smaller than <code>maxNum</code> and then the <code>last</code> element:</p>\n\n<pre><code>ff maxNum = last . takeWhile (&lt;= maxNum) . scanl (+) 0 . map (+10) . filter (&gt; 0)\n</code></pre>\n"}], "owner": {"reputation": 1436, "user_id": 3633116, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/776562355754015/picture?type=large", "display_name": "Nikas \u017dalias", "link": "https://stackoverflow.com/users/3633116/nikas-%c5%bdalias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 40448195, "answer_count": 1, "score": 0, "last_activity_date": 1478428538, "creation_date": 1478426249, "question_id": 40448048, "link": "https://stackoverflow.com/questions/40448048/haskell-how-to-get-sum-of-all-positive-members-using-function-composition", "title": "Haskell how to get sum of all positive members using function composition?", "body": "<p>I have to write a function that takes all positive numbers from Integer list, adds to each 10 and then sums all of them until it reaches the maxNum.</p>\n\n<p>I've already wrote something that kinda works :</p>\n\n<pre><code>ff :: Integer -&gt; [Integer] -&gt; Integer\nff maxNum = (&lt;=maxNum) . sum . map(+10) . filter(&gt;0)\n</code></pre>\n\n<p>but the problem is that this function returns true if the sum is not bigger than maxNum and false if sum is bigger... As I understand I am quite close to what I want.. Can someone help me???</p>\n"}, {"tags": ["haskell", "template-haskell", "type-level-computation"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1478421754, "post_id": 40447243, "comment_id": 68140934, "body": "I think the first <code>&#39;&#39;Proxy</code> is supposed to be a data constructor, thus it should only have one tick: <code>&#39;Proxy</code>"}, {"owner": {"reputation": 131, "user_id": 3749167, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056fa9bbc5f8f7a35be7fa3c353a023e?s=128&d=identicon&r=PG&f=1", "display_name": "user3749167", "link": "https://stackoverflow.com/users/3749167/user3749167"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1478430895, "post_id": 40447243, "comment_id": 68143065, "body": "@luqui, it works for me. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 0, "last_activity_date": 1525934945, "creation_date": 1525934945, "answer_id": 50267145, "question_id": 40447243, "link": "https://stackoverflow.com/questions/40447243/how-we-can-use-type-level-string-in-template-haskell/50267145#50267145", "title": "How we can use type level string in template haskell?", "body": "<p>For completeness and future reference, I thought I would add the correct answer for reference.</p>\n\n<pre><code>\u03bb&gt; :set -XTemplateHaskell -XQuasiQuotes -XDataKinds\n\u03bb&gt; import Language.Haskell.TH\n\u03bb&gt; import Data.Proxy\n\u03bb&gt; import GHC.TypeLits\n\n\u03bb&gt; $([| symbolVal (Proxy :: Proxy \"foo\") |])\n\"foo\"\n\n\u03bb&gt; runQ [| symbolVal (Proxy :: 'Proxy \"foo\") |]\nAppE (VarE GHC.TypeLits.symbolVal) (SigE (ConE Data.Proxy.Proxy) (AppT (PromotedT Data.Proxy.Proxy) (LitT (StrTyLit \"foo\"))))\n\n\u03bb&gt; runQ [| symbolVal (Proxy :: Proxy \"foo\") |]\nAppE (VarE GHC.TypeLits.symbolVal) (SigE (ConE Data.Proxy.Proxy) (AppT (ConT Data.Proxy.Proxy) (LitT (StrTyLit \"foo\"))))\n\n\u03bb&gt; $(appE (varE 'symbolVal) (sigE (conE 'Proxy) (appT (conT ''Proxy) (litT (strTyLit \"foo\")))))\n\"foo\"\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 3749167, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056fa9bbc5f8f7a35be7fa3c353a023e?s=128&d=identicon&r=PG&f=1", "display_name": "user3749167", "link": "https://stackoverflow.com/users/3749167/user3749167"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525934945, "creation_date": 1478419770, "question_id": 40447243, "link": "https://stackoverflow.com/questions/40447243/how-we-can-use-type-level-string-in-template-haskell", "title": "How we can use type level string in template haskell?", "body": "<p>I played around with <code>symbolVal</code> and template haskell as follows on ghci.</p>\n\n<pre><code>&gt;&gt;&gt; :set -XTemplateHaskell -XQuasiQuotes -XDataKinds\n&gt;&gt;&gt; import Language.Haskell.TH\n&gt;&gt;&gt; import Data.Proxy\n&gt;&gt;&gt; import GHC.TypeLits\n&gt;&gt;&gt; $([| symbolVal (Proxy :: Proxy \"foo\") |]) -- Code (1)\n\"foo\"\n\n&gt;&gt;&gt; runQ [| symbolVal (Proxy :: Proxy \"foo\") |]\nAppE (VarE GHC.TypeLits.symbolVal) (SigE (ConE Data.Proxy.Proxy) (AppT (ConT Data.Proxy.Proxy) (LitT (StrTyLit \"foo\"))))\n\n&gt;&gt;&gt; $(appE (varE 'symbolVal) (sigE (conE ''Proxy) (appT (conT ''Proxy) (litT (strTyLit \"foo\")))))\n\n&lt;interactive&gt;:9:3: error:\n    \u2022 Type constructor \u2018Proxy\u2019 used where a value identifier was expected\n    \u2022 In the first argument of \u2018symbolVal\u2019, namely\n        \u2018Proxy :: Proxy \"foo\"\u2019\n      In the expression: (symbolVal (Proxy :: Proxy \"foo\"))\n      In an equation for \u2018it\u2019: it = (symbolVal (Proxy :: Proxy \"foo\"))\n</code></pre>\n\n<p>Why this error occurs though <code>Code (1)</code> works well?\nHow we can use type level string in template haskell?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1478406718, "post_id": 40445975, "comment_id": 68138379, "body": "A question about a similar situation: <a href=\"http://stackoverflow.com/q/31503707/2751851\"><i>Strange Haskell expression with type Num &#40;&#91;Char&#93; -&gt; t&#41; =&gt; t</i></a>"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 6, "last_activity_date": 1478408195, "last_edit_date": 1478408195, "creation_date": 1478406610, "answer_id": 40446000, "question_id": 40445975, "link": "https://stackoverflow.com/questions/40445975/is-there-any-difference-between-2x-and-2x/40446000#40446000", "title": "Is there any difference between 2x and 2*x?", "body": "<blockquote>\n  <p>Is there any defference between 2x and 2*x?</p>\n</blockquote>\n\n<p>Yes.  <code>2 * x</code> is the number <code>2</code> multiplied by the variable <code>x</code>.   <code>2 x</code> is the result of applying the function produced by interpreting the literal value <code>2</code> (<code>fromInteger 2</code>) to the variable <code>x</code>.</p>\n\n<p>How can <code>2</code> be a function?  Well, if you have an instance <code>Num (t -&gt; t1)</code> then you can interprete <code>2 :: t -&gt; t1</code> and it is certainly a function.  While this is possible, no commonly used library has such a Num instance.  Basically any time you see such a type signature pop up it is due to a syntactic mistake.</p>\n\n<p>EDIT:</p>\n\n<p>Just as a boring example:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE FlexibleContexts  #-}\n\ninstance (Num a) =&gt; Num (a -&gt; a) where\n  fromInteger n = \\x -&gt; ((fromInteger n) * x)\n</code></pre>\n\n<p>And its use:</p>\n\n<pre><code>*Main&gt; (\\x -&gt; (2 :: Int -&gt; Int) x) 5\n10\n</code></pre>\n\n<p>There are better examples out there.   IIRC, Lennart has one here on S.O. that provides machinery for expressions such as <code>2 seconds * 5 hours</code>.</p>\n"}], "owner": {"reputation": 986, "user_id": 6819040, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/IJDZr.jpg?s=128&g=1", "display_name": "AurevoirXavier", "link": "https://stackoverflow.com/users/6819040/aurevoirxavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 40446000, "answer_count": 1, "score": 4, "last_activity_date": 1478408195, "creation_date": 1478406351, "last_edit_date": 1478406820, "question_id": 40445975, "link": "https://stackoverflow.com/questions/40445975/is-there-any-difference-between-2x-and-2x", "title": "Is there any difference between 2x and 2*x?", "body": "<pre><code>Prelude&gt; :t fmap (\\x  -&gt; 2x) []\nfmap (\\x  -&gt; 2x) [] :: Num (t -&gt; b) =&gt; [b]\n\nPrelude&gt; :t fmap (\\x -&gt; 2 * x) []\nfmap (\\x -&gt; 2 * x) [] :: Num b =&gt; [b]\n\nPrelude&gt; :t 1 1\n1 1 :: (Num (t -&gt; t1), Num t) =&gt; t1\n\nPrelude&gt; :t 1 * 1\n1 * 1 :: Num a =&gt; a\n</code></pre>\n\n<p>Is there any difference between <code>2x</code> and <code>2*x</code>?</p>\n\n<p>What is the meaning of <code>Num (t -&gt; t1) =&gt; t1</code>?</p>\n"}, {"tags": ["haskell", "types", "lambda"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 8, "creation_date": 1478402688, "post_id": 40445672, "comment_id": 68137843, "body": "Good intuition that these should be the same.  This is a special case called the monomorphism restriction which you can read about by googling"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478402919, "post_id": 40445672, "comment_id": 68137889, "body": "Presumably you are using a version of ghci before 7.8.1?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1478426021, "post_id": 40445672, "comment_id": 68141825, "body": "@luqui: There&#39;s a <a href=\"http://stackoverflow.com/q/32496864/1139697\">very exhaustive answer by Bakuriu</a>, so feel free to close questions like this as duplicate of theirs."}], "owner": {"reputation": 121, "user_id": 4943599, "user_type": "registered", "profile_image": "https://graph.facebook.com/1653054538262523/picture?type=large", "display_name": "Luster", "link": "https://stackoverflow.com/users/4943599/luster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1478425925, "answer_count": 0, "score": 2, "last_activity_date": 1478404080, "creation_date": 1478402546, "last_edit_date": 1478404080, "question_id": 40445672, "link": "https://stackoverflow.com/questions/40445672/why-does-using-lambda-notation-in-haskell-result-in-a-different-type-signature", "closed_reason": "Duplicate", "title": "Why does using lambda notation in Haskell result in a different type signature?", "body": "<p>I wrote what I think is the same function in the following three ways:</p>\n\n<pre><code>addThree x y z = x + y + z\naddThree' = \\x y z -&gt; x + y + z\naddThree'' = \\x -&gt; \\y -&gt; \\z -&gt; x + y + z \n</code></pre>\n\n<p>Yet when I load and check their types in GHCi using <code>:t</code>, it gives me a very weird answer:</p>\n\n<pre><code>addThree :: Num a =&gt; a -&gt; a -&gt; a -&gt; a\naddThree' :: Integer -&gt; Integer -&gt; Integer -&gt; Integer\naddThree'' :: Integer -&gt; Integer -&gt; Integer -&gt; Integer\n</code></pre>\n\n<p>Why do the lambdas have different, specialized types while the normal one has the correct type?</p>\n"}, {"tags": ["algorithm", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 5, "last_activity_date": 1478400828, "creation_date": 1478400828, "answer_id": 40445549, "question_id": 40445481, "link": "https://stackoverflow.com/questions/40445481/why-doesnt-the-knight-cover-all-the-table/40445549#40445549", "title": "Why doesn&#39;t the knight cover all the table?", "body": "<p>I am assuming you're attempting to solve the <a href=\"https://en.wikipedia.org/wiki/Knight%27s_tour\" rel=\"noreferrer\" title=\"Wikipedia\">knight's tour</a> problem in Haskell. In that case, your problem is that you're using the greedy algorithm, which fails for the knight's tour problem. If you remove the <code>length</code> from your <code>y</code> function, you can see the path your algorithm chose.</p>\n\n<pre><code>[(1,1),(2,3),(3,5),(4,7),(6,8),(5,6),(7,7),(5,8),(4,6),(6,7),\n (8,8),(7,6),(5,7),(7,8),(6,6),(8,7),(7,5),(6,3),(8,4),(6,5),\n (8,6),(7,4),(5,5),(3,6),(4,8),(2,7),(1,5),(3,4),(2,6),(3,8),\n (1,7),(2,5),(3,7),(1,8)]\n-- From (1,8), we can go to either (4,6) or (3,5).\n-- But we've already been to both of those positions.\n</code></pre>\n\n<p>Simply put, your knight made a \"wrong\" turn at some point and got itself stuck in a position where it couldn't get out without repeating a position. To circumvent this, you'll need to use some kind of backtracking algorithm, so that when the knight makes a mistake like this, it can undo its moves and try something else. Fortunately for you, Haskell makes this relatively easy with the List monad. If you're not familiar with monads, they're integral to Haskell, and you can learn about them <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"noreferrer\" title=\"LYAH Book\">here</a>.</p>\n"}], "owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478411916, "creation_date": 1478400029, "last_edit_date": 1478411916, "question_id": 40445481, "link": "https://stackoverflow.com/questions/40445481/why-doesnt-the-knight-cover-all-the-table", "title": "Why doesn&#39;t the knight cover all the table?", "body": "<p>I want the knight to start at <code>(1,1)</code> and to try to move all over the table. This is my code:</p>\n\n<pre><code>canMove :: (Int  -&gt; Int) -&gt; (Int  -&gt; Int) -&gt; [(Int,Int)] -&gt; Bool\n\ncanMove (x) (y) list \n        | (x (fst lastMove),y (snd lastMove)) `elem` list = False\n        | newX&gt; 8 || newY&gt; 8 || newX&lt;=0 || newY&lt;=0 = False\n        | otherwise = True\n        where lastMove = last list\n              newX = x (fst lastMove)\n              newY = y (snd lastMove)\n\nmove :: [(Int, Int)] -&gt; [( Int, Int)]\nmove list \n  | length list == 64 = list\n  | canMove (+1) (+2) list = move (list ++ [(x+1,y+2)])\n  | canMove (+2) (+1) list = move (list ++ [(x+2,y+1)])\n  | canMove (subtract 1) (+2) list = move (list ++ [(x-1,y+2)])\n  | canMove (subtract 2) (+1) list = move (list ++ [(x-2,y+1)])\n  | canMove (subtract 1) (subtract 2) list = move (list ++ [(x-1,y-2)])\n  | canMove (subtract 2) (subtract  1) list = move (list ++ [(x-2,y-1)])\n  | canMove (+1) (subtract 2) list = move (list ++ [(x+1,y-2)])\n  | canMove (+2) (subtract 1) list = move (list ++ [(x+2,y-1)])\n  | otherwise = list\n   where lastMove = last list\n         x = fst lastMove\n         y = snd lastMove\n\ny=length (move [(1,1)])\n\nmain = print $ y\n</code></pre>\n\n<p>Why does the knight stop after <code>34</code> steps?</p>\n"}, {"tags": ["mongodb", "haskell", "elasticsearch", "io", "functional-programming"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478405358, "post_id": 40445090, "comment_id": 68138186, "body": "This question is too broad to be answered in an useful way through the Stack Overflow format. You will likely get better results here by distilling what you are having trouble to achieve at this moment into a small, self-contained piece of code, and then asking a question about it."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 3740447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8997b5d326c0196feb3c7ac92c3105b0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Tidemann", "link": "https://stackoverflow.com/users/3740447/nicholas-tidemann"}, "edited": false, "score": 0, "creation_date": 1478440957, "post_id": 40448369, "comment_id": 68145737, "body": "Thanks, this is a great answer. As you point out in the end, what to do when updating the Elasticsearch update fails is one of the things I need to figure out. I come from Python, and the way you describe it the exception handling sounds similar to how it&#39;s done in Python, which I didn&#39;t think was the case in Haskell.  Also, when running it forever in the manner you describe, how does it handle waiting when the Mongo database is empty and there is nothing to consume?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 55, "user_id": 3740447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8997b5d326c0196feb3c7ac92c3105b0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Tidemann", "link": "https://stackoverflow.com/users/3740447/nicholas-tidemann"}, "edited": false, "score": 0, "creation_date": 1478442473, "post_id": 40448369, "comment_id": 68146251, "body": "@Nicholas Tidemann Haskell has two flavor for signalling errors: exceptions and sum types like <code>Either</code> or <code>Maybe</code>. <a href=\"http://book.realworldhaskell.org/read/error-handling.html\" rel=\"nofollow noreferrer\">book.realworldhaskell.org/read/error-handling.html</a> As for waiting, you can implement a simple polling mechanism using <code>threadDelay :: Int -&gt; IO ()</code> from <code>Control.Concurrent</code>. <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Concurrent.html#v:threadDelay\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.9.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 55, "user_id": 3740447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8997b5d326c0196feb3c7ac92c3105b0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Tidemann", "link": "https://stackoverflow.com/users/3740447/nicholas-tidemann"}, "edited": false, "score": 0, "creation_date": 1478443656, "post_id": 40448369, "comment_id": 68146622, "body": "Right, I&#39;m at least familiar with both <code>Either</code> and <code>Maybe</code> by having read a lot about them, and I&#39;ll see if I can work it out. As for waiting, I also arrived at <code>threadDelay</code> being the preferred way, working similarly to <code>time.sleep</code> in Python, but since it&#39;s concurrent I guess it works a bit differently. I&#39;ll see if I can maky any progress, thanks for the help."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478477240, "post_id": 40448369, "comment_id": 68157601, "body": "It seems you have demonstrated my comment to this question was wrong. This is a nice, perceptive answer."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 5, "last_activity_date": 1478440402, "last_edit_date": 1478440402, "creation_date": 1478428834, "answer_id": 40448369, "question_id": 40445090, "link": "https://stackoverflow.com/questions/40445090/how-can-i-move-something-from-one-database-to-another-using-haskell/40448369#40448369", "title": "How can I move something from one database to another using Haskell?", "body": "<blockquote>\n  <p>I like the idea of keeping pure functions for transforming the data\n  and the parts of the program actually performing IO separate.</p>\n</blockquote>\n\n<p>If you are starting with Haskell I would advise you to leave this in the back burner and just build a solution that works even if it has <code>IO</code> everywhere. As you gain confidence, you'll learn to see ways to restructure the code.</p>\n\n<blockquote>\n  <p>I'm completely stumped as to how I would piece things together,\n  especially while ensuring that the relevant items only get deleted\n  from Mongo after having been successfully added to Elasticsearch.</p>\n</blockquote>\n\n<p>Unless I'm missing somehting, that seems like pretty straightforward program logic!</p>\n\n<p>If you have the following (completely invented, grossly simplified) functions</p>\n\n<pre><code>getDocumentFromMongo :: MongoGonnection -&gt; IO Document\n\ndeleteFromMongo :: MongoConnection -&gt; Document -&gt; IO ()\n\nisPresentInElastic :: ElasticConnection -&gt; Document -&gt; IO Bool\n\ninsertInElastic :: ElasticConnection -&gt; Document -&gt; IO ()\n</code></pre>\n\n<p>You could write an infinite loop like:</p>\n\n<pre><code>loader :: MongoConnection -&gt; ElasticConnection -&gt; IO r -- runs forever\nloader mongoConn elasticConn = forever (do\n    document &lt;- getDocumentFromMongo mongoConn\n    existsInElastic &lt;- isPresentInElastic elasticConn document\n    if existsInElastic\n       then return ()\n       else insertInElastic elasticConn document\n    deleteFromMongo mongoConn document)\n</code></pre>\n\n<p>Of course, there are more things to consider. What to do if an <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Exception.html#g:3\" rel=\"nofollow noreferrer\">exception</a> is thrown while inserting in Elastic Search? You'll presumably need to use functions like <code>try</code>,<a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Exception.html#v:bracket\" rel=\"nofollow noreferrer\"><code>bracket</code></a>,<a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Exception.html#v:finally\" rel=\"nofollow noreferrer\"><code>finally</code></a> and <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Exception.html#v:onException\" rel=\"nofollow noreferrer\"><code>onException</code></a> from <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Exception.html\" rel=\"nofollow noreferrer\"><code>Control.Exception</code></a>.</p>\n\n<p>Also, perhaps some level of concurrency is desired. There are <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Concurrent.html\" rel=\"nofollow noreferrer\">many</a> <a href=\"http://hackage.haskell.org/package/stm\" rel=\"nofollow noreferrer\">good</a> <a href=\"http://hackage.haskell.org/package/async\" rel=\"nofollow noreferrer\">libraries</a> for that, too.</p>\n"}], "owner": {"reputation": 55, "user_id": 3740447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8997b5d326c0196feb3c7ac92c3105b0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Tidemann", "link": "https://stackoverflow.com/users/3740447/nicholas-tidemann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 1, "closed_date": 1479202246, "answer_count": 1, "score": 3, "last_activity_date": 1478440402, "creation_date": 1478395367, "last_edit_date": 1478396102, "question_id": 40445090, "link": "https://stackoverflow.com/questions/40445090/how-can-i-move-something-from-one-database-to-another-using-haskell", "closed_reason": "Needs more focus", "title": "How can I move something from one database to another using Haskell?", "body": "<p>I'm fairly new to Haskell; I've read countless tutorials and other resources on it, but whenever I decide to try to write programs doing anything remotely useful, I usually don't even know where to begin. I was recently listening to a podcast where Gabriel Gonzalez talked about how the best way to stay motivated is to actually use it for projects and just get writing, so I really want to use it for a task I have at hand.</p>\n\n<p>So, I have a Mongo database which is constantly getting updated with items being scraped regularly, and an Elasticsearch database. The former will frequently get updated with items I have already scraped before, while the latter is populated with unique items. To achieve this I have a script (1000 lines of Node.js) which is constantly running and consuming the items in the Mongo database one by one, doing some checks to see if it's already in the Elasticsearch database, and adding it if it's not; afterwards, it's deleted from Mongo. This script is however a total mess.</p>\n\n<p>I've been wanting to do this in Haskell, since Haskell is great for managing IO in a controlled manner from what I've read and heard, and since I like the idea of keeping pure functions for transforming the data and the parts of the program actually performing IO separate. I also assume a working Haskell solution would be more concise, and easier to reason about when changing things later.</p>\n\n<p>So far I've managed to use the mongoDB package to do CRUD operations in Mongo by following the tutorial, but there are still a lot of things I don't understand about how it works. I find it harder to work with the bloodhound package for doing the same things in Elasticsearch, and I'm completely stumped as to how I would piece things together, especially while ensuring that the relevant items only get deleted from Mongo after having been successfully added to Elasticsearch.</p>\n\n<p>I know this is a very broad question, but if anyone knows anything about this, or simply are able to give me some direction, I would appreciate it. In fact, all help would be very much appreciated.</p>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478391743, "post_id": 40444687, "comment_id": 68135939, "body": "Wouldn&#39;t you always get an empty list for 10 pairs? AFAICT all your coordinates are greater than or equal to <code>1</code>, so the sum of the products of components would be at least <code>1*1 + 1*1 + ... + 1*1 = 10</code>."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1478392155, "post_id": 40444756, "comment_id": 68136023, "body": "While this solves the problem this does not assist the OP in understanding anything.  Esp with use of things like replicateM and liftA2 which are quite advanced concepts relative to OP&#39;s level."}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": true, "score": 0, "last_activity_date": 1478391745, "creation_date": 1478391745, "answer_id": 40444756, "question_id": 40444687, "link": "https://stackoverflow.com/questions/40444687/haskell-how-to-change-algorithm-to-work-on-any-size-of-list/40444756#40444756", "title": "Haskell: How to change algorithm to work on any size of list?", "body": "<p>Here:</p>\n\n<pre><code>project n =\n  [ x\n  | x &lt;- replicateM n $ liftA2 (,) [1..5] [1..3]\n  , sum (map (uncurry (*)) x) &lt; 6\n  , sum (map fst x) == 5\n  , any ((==3) . snd) x\n  ]\nmain = print $ take 1 $ project 3\n</code></pre>\n\n<p>Or like so:</p>\n\n<pre><code>project n\n  = filter (any ((==3) . snd))\n  $ filter ((==5) . sum . map fst)\n  $ filter ((&lt;6) . sum . map (uncurry (*)))\n  $ replicateM n\n  $ liftA2 (,) [1..5] [1..3]\n</code></pre>\n"}], "owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 40444756, "answer_count": 1, "score": 1, "last_activity_date": 1478391745, "creation_date": 1478391214, "last_edit_date": 1478391558, "question_id": 40444687, "link": "https://stackoverflow.com/questions/40444687/haskell-how-to-change-algorithm-to-work-on-any-size-of-list", "title": "Haskell: How to change algorithm to work on any size of list?", "body": "<p>I have this code:</p>\n\n<pre><code>project= [ \n  [(a,b),(c,d),(e,f)] \n  | \n    a&lt;-[1..5],\n    b&lt;-[1..3],\n    c&lt;-[1..5],\n    d&lt;-[1..3],\n    e&lt;-[1..5],\n    f&lt;-[1..3]\n\n  , a*b + c*d + e*f &lt;6\n  , a + c + e == 5\n  , b == 3 || d==3 || f==3\n  ]\n\nx=take 1 project\nmain = print $  x\n</code></pre>\n\n<p>it is return a list of 3 pairs [(x,y),(x,y),(x,y)] .\nThere are 3 conditions:</p>\n\n<ul>\n<li>If you sum all the x you must get 5.</li>\n<li>If you sum all the <code>x*y</code> you will get less than 6. </li>\n<li>There is at least one <code>y</code> that equal to 3.</li>\n</ul>\n\n<p>Now, I want exactly the same algorithm to work for any longer list for example 10 pairs. How should I do that?</p>\n"}, {"tags": ["haskell", "accessor"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1478389911, "post_id": 40444501, "comment_id": 68135498, "body": "I don&#39;t believe this is possible. Haskell records are a bit of a pain point in general (especially the fact they are partial, which is sort of what you are getting at). If you are interested in records, you will probably end up checking out <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\"><code>lens</code></a> at some point (where this partiality is dealt with using a <code>Prism</code> abstraction)."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 1, "creation_date": 1478392885, "post_id": 40444501, "comment_id": 68136223, "body": "This is not possible, but it is also an indicator of non-idiomatic Haskell. Consider making heavier use of pattern matching when you use <code>SVertex</code> instances to deal with these defaults, rather than making a global rule (the latter approach feels very Java-esque)."}, {"owner": {"reputation": 471, "user_id": 1005892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef2f0619aaf338b9d9fbbe636e714c3f?s=128&d=identicon&r=PG", "display_name": "Tristan Lorach", "link": "https://stackoverflow.com/users/1005892/tristan-lorach"}, "edited": false, "score": 0, "creation_date": 1478395948, "post_id": 40444501, "comment_id": 68136811, "body": "I didn&#39;t realize accessing &#39;records&#39; are so flawed in Haskell. Thanks for the confirmation on how I should be aware of this. It seems like some people are trying to improve things in this scope: <a href=\"http://nikita-volkov.github.io/record/\" rel=\"nofollow noreferrer\">nikita-volkov.github.io/record</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 4, "last_activity_date": 1478475218, "last_edit_date": 1478475218, "creation_date": 1478396731, "answer_id": 40445225, "question_id": 40444501, "link": "https://stackoverflow.com/questions/40444501/haskell-accessors-for-non-existing-records/40445225#40445225", "title": "Haskell accessors for non-existing records", "body": "<p>As you have just found out, records don't mix very well with sum types (that is, types with multiple constructors), as they lead to unpleasant partial accessors that you can't get rid of. One alternative is using a sum type only for the fields that actually require it, rather than making <code>SVertex</code> as a whole a sum type. That way, you get as many nice accessors as possible while avoiding the partial ones.</p>\n\n<pre><code>data VertexPaint = VertexC Int | VertexTC (Float, Float)\n    deriving (Show)\n\ndata SVertex = SVertex\n    { position :: (Float, Float)\n    , paintjob :: VertexPaint\n    } deriving (Show)\n</code></pre>\n\n<p>If you want a <code>color</code> function, you still have to define it separately, as in your first attempt. (Here I will use a <code>Maybe Int</code> result, as that is more often than not a safer bet than returning an arbitrary default.)</p>\n\n<pre><code>color :: SVertex -&gt; Maybe Int\ncolor v = case paintjob v of\n    VertexC c -&gt; Just c\n    VertexTC _ -&gt; Nothing\n</code></pre>\n\n<p>As Alec suggests, the <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\"><em>lens</em></a> library provides plenty of tools to deal with this sort of situation in more convenient ways. In any case, the types defined in this answer would work well with <em>lens</em>.</p>\n"}], "owner": {"reputation": 471, "user_id": 1005892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef2f0619aaf338b9d9fbbe636e714c3f?s=128&d=identicon&r=PG", "display_name": "Tristan Lorach", "link": "https://stackoverflow.com/users/1005892/tristan-lorach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 40445225, "answer_count": 1, "score": 4, "last_activity_date": 1478475218, "creation_date": 1478389560, "question_id": 40444501, "link": "https://stackoverflow.com/questions/40444501/haskell-accessors-for-non-existing-records", "title": "Haskell accessors for non-existing records", "body": "<p>I am learning Haskell and I am currently discovering 'accessors' for data members.\nLet's assume I have some dummy 2D vertex information, one type that has some color, the other than has some texture coordinate (tc):</p>\n\n<pre><code>data SVertex = VertexC (Float, Float) Int\n         | VertexTC (Float, Float) (Float, Float)\n         deriving(Show)\n</code></pre>\n\n<p>One tedious way to create accessors to records is to write functions with patterns:</p>\n\n<pre><code>position (VertexC (x,y) c ) = (x,y)\nposition (VertexTC (x,y) c ) = (x,y)\ntc (VertexTC _ tc) = tc\ncolor :: SVertex -&gt; Int\ncolor (VertexC _ c) = c\n</code></pre>\n\n<p>Now, a positive feature is that I could add accessors ('color' and 'tc') for the ones that don't have 'color' or 'tc' :</p>\n\n<pre><code>position (VertexC (x,y) c ) = (x,y)\nposition (VertexTC (x,y) c ) = (x,y) -- no header, here... still works\ntc (VertexTC _ tc) = tc\ntc (VertexC _ _) = (0,0) -- to returns something even if the field doesn't exist\ncolor :: SVertex -&gt; Int\ncolor (VertexC _ c) = c\ncolor (VertexTC _ _) = 0 -- return something even if field doesn't exist\n</code></pre>\n\n<p>It allows me to give default 0 values to the vertices that don't have any texture-coords or color 0 to the vertices that don't have color...\nAll good...</p>\n\n<p>Now, my question: I am currently reading that there is a nice way to give accessor names right into the data declaration.\nIn my case here is what I would get (using 'prime' to avoid name conflict):</p>\n\n<pre><code>data SVertex' = VertexC' {\n    position'   :: (Float, Float),\n    color'      :: Int\n    }\n    | VertexTC' {\n    position'   :: (Float, Float),\n    tc'         :: (Float, Float)\n    } deriving(Show)\n</code></pre>\n\n<p>This allows me to reach the same goal: the \"position' \", \"tc' \" and \"color' \" accessors are created for me!</p>\n\n<p><em>However</em>: I didn't find a way to give default accessor for the fields that don't exist. For example when requesting for tc on 'VertexC'; or requesting color on VertexTC...\nOn the first approach, I could make it happen. In this convenient second approach, I fear it is not possible.\nWhen I try to add other function pattern like </p>\n\n<pre><code>color' (VertexTC' _ _) = 0\n</code></pre>\n\n<p>the compiler tells me <em>\"Multiple declarations of \u2018color\u2019 etc.\"</em>. And it seems like it is because this second declaration is not done following the previous implicit one created by the compiler...</p>\n\n<p>Do you know a workaround ?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1478389453, "creation_date": 1478389272, "last_edit_date": 1478389453, "question_id": 40444469, "link": "https://stackoverflow.com/questions/40444469/exporting-a-static-haskell-library-using-stack", "title": "Exporting a Static Haskell Library using Stack", "body": "<p>Suppose one is using the Stack build tool to make a Haskell library (with external dependencies from Hackage). I understand how to build a Haskell program using <code>stack build</code> which can be used to execute the Haskell's <code>Main</code> function. </p>\n\n<p><strong>Question:</strong> But how does one export a single static library (i.e., a single <code>*.o</code> or <code>*.so</code>) -- that includes ALL of the dependencies of the project -- to be consumed by another ghc program? </p>\n"}, {"tags": ["haskell", "ffi", "haskell-stack"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478389079, "post_id": 40444010, "comment_id": 68135325, "body": "&quot;one way to solve this problem would be to use Stack as usual, but migrate your C/C++ main function to Haskell.&quot; -- This sounds highly suboptimal. I don&#39;t think this possibility makes your original question any less relevant."}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478389123, "post_id": 40444010, "comment_id": 68135334, "body": "suboptimal in the performance sense?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478389348, "post_id": 40444010, "comment_id": 68135386, "body": "&quot;suboptimal in the performance sense?&quot; -- In that sense, I genuinely don&#39;t know. I just meant suboptimal in terms of project organisation."}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1480945632, "post_id": 40940784, "comment_id": 69160525, "body": "Recompiling GHC just to get this working on Linux seems pretty daunting. Do you have any thoughts about force-migrating a C++ project into a Stack project (with Main located in Haskell)? Are there any intrinsic performance hits that this incurs or other problems I should be aware of?"}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1480946030, "post_id": 40940784, "comment_id": 69160796, "body": "Perhaps it might also be a better approach to manually compile all haskell files yourself with GHC (even the libraries that you download from upstream Hackage; i.e., you&#39;ll have to download them yourself and add them to your <code>Makefile</code>). This is, after all, how a typicall C++ project is organized with its own files. So why not extend this practice to Haskell within a C++ project?"}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1480946089, "post_id": 40940784, "comment_id": 69160843, "body": "Basically: does your experience with the Galua project offer any hints at some best practices here? Or are you satisficed with the approach you took by recompiling GHC with PIC support and then using stack to output a <code>libgalua.a</code>?"}], "tags": [], "owner": {"reputation": 1020, "user_id": 500060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c122862374667042520953c02df7d7ed?s=128&d=identicon&r=PG", "display_name": "glguy", "link": "https://stackoverflow.com/users/500060/glguy"}, "is_accepted": true, "score": 4, "last_activity_date": 1480712563, "creation_date": 1480712563, "answer_id": 40940784, "question_id": 40444010, "link": "https://stackoverflow.com/questions/40444010/how-to-use-haskells-stack-build-tool-to-export-a-library-to-be-consumed-by-c-c/40940784#40940784", "title": "How to Use Haskell&#39;s Stack Build Tool to Export a Library to Be Consumed by C/C++?", "body": "<p>Stack can't really do this on its own.</p>\n\n<p>There's support for generating so called \"foreign libraries\" added to Cabal, but it's not in a released version, yet. See commit <a href=\"https://github.com/haskell/cabal/commit/382143aa7322605d1a9f0480e383490e186c7ea0\" rel=\"nofollow noreferrer\">382143</a> This will produce a shared library that dynamically links against the dynamic versions of each Haskell package used.</p>\n\n<p>You can build your package with stack and then after the fact you can assemble a single native library. In the <a href=\"https://github.com/GaloisInc/galua\" rel=\"nofollow noreferrer\">Galua</a> project we do this with a custom <a href=\"https://github.com/GaloisInc/galua/blob/master/galua/Setup.hs\" rel=\"nofollow noreferrer\">Setup.hs</a> and a separate <a href=\"https://github.com/GaloisInc/galua/blob/master/galua-c/build\" rel=\"nofollow noreferrer\">linking script</a>.</p>\n\n<p>The result of this linking process is that you get a standalone statically linked library suitable for inclusion in a C project: <code>libgalua.a</code>.</p>\n\n<p>Do note that for creating standalone libraries on Linux suitable for being linked into a shared library that you'll need to recompile GHC to generate PIC static libraries (macOS does this by default).</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 2, "accepted_answer_id": 40940784, "answer_count": 1, "score": 7, "last_activity_date": 1480712563, "creation_date": 1478385728, "last_edit_date": 1478388934, "question_id": 40444010, "link": "https://stackoverflow.com/questions/40444010/how-to-use-haskells-stack-build-tool-to-export-a-library-to-be-consumed-by-c-c", "title": "How to Use Haskell&#39;s Stack Build Tool to Export a Library to Be Consumed by C/C++?", "body": "<p>Suppose one is using the <code>stack</code>build tool to make a Haskell library (importing packages from Hackage, and so forth) <strong>to be used with a C/C++ project in which <code>main</code> is located in C/C++</strong>.</p>\n\n<p>Supposing your project is named <code>Lib.hs</code> (which uses external libraries from hackage), is there a way to use stack to export your <code>Lib.o</code>, <code>Lib.hi</code>, and <code>Lib_stub.h</code> to be consumed by a C/C++ compiler like <code>gcc</code> or <code>g++</code>?</p>\n\n<p><strong>EDIT:</strong> A related question might be: \"how can one use Stack as a build tool to be used with a Haskell &amp; C/C++ project in which <code>main</code> is located in C/C++?</p>\n\n<p><strong>EDIT2:</strong> Upon reflection, one way to solve this problem would be to use Stack as usual, but migrate your C/C++ main function to Haskell. Is this the best way to do it? Are there huge performance costs to this or anything I should be aware of?</p>\n"}, {"tags": ["haskell", "instance", "typeclass", "unification"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 6, "last_activity_date": 1478380367, "creation_date": 1478380367, "answer_id": 40443260, "question_id": 40443235, "link": "https://stackoverflow.com/questions/40443235/specifying-that-a-type-can-only-exist-in-one-class-if-it-already-exists-in-other/40443260#40443260", "title": "Specifying that a type can only exist in one class if it already exists in other classes in Haskell", "body": "<p>The class definition can contain constraints, just like a function.</p>\n\n<pre><code>class (Eq a, Substitutable a) =&gt; Unifiable a where\n    unify :: a -&gt; a -&gt; Maybe (Subst a)\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6946322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b746cb456e851751731df0e14235956?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn24", "link": "https://stackoverflow.com/users/6946322/jenn24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 40443260, "answer_count": 1, "score": 2, "last_activity_date": 1478380367, "creation_date": 1478380222, "question_id": 40443235, "link": "https://stackoverflow.com/questions/40443235/specifying-that-a-type-can-only-exist-in-one-class-if-it-already-exists-in-other", "title": "Specifying that a type can only exist in one class if it already exists in other classes in Haskell", "body": "<p>I am working on a problem involving unification, with a user-defined type Subst a. The problem reads: </p>\n\n<p>\"Define a type class Unifiable that specifies that a function unify::a -> a -> Maybe\n(Subst a) must be defined for any type a inside this class. A type a can only be in the\nUnifiable class if it is already in the Eq and Substitutable classes, and this should\nbe represented in your definition.\"</p>\n\n<p>This is how I have defined Substitutable and Unifiable so far: </p>\n\n<pre><code>class Substitutable a where\nsubst :: Subst a -&gt; a -&gt; a\n\nclass Unifiable a where\nunify :: a -&gt; a -&gt; Maybe (Subst a)\n</code></pre>\n\n<p>However, I'm not sure how to go about specifying that type a can be in the Unifiable class only if it is already in Eq and Substitutable classes.</p>\n\n<p>I'm not looking for an answer to this specific problem, but in general, how would I go about specifying a type can only be in one class if it is already in other classes?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1478373789, "post_id": 40442203, "comment_id": 68131102, "body": "Its not clear what you are asking. Presumably &quot;n&quot; should be inserted whenever the sequence &quot;[m,q]&quot; appears in the list. So what are you getting when you try it? You do appear to be thinking along the right lines, but &quot;insert&quot; is not necessary, and &quot;headxs&quot; is wrong. Perhaps you need to consider the pattern &quot;(x1:x2:xs)&quot;"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1478376038, "post_id": 40442203, "comment_id": 68131718, "body": "Create a new array in length <code>2n-1</code> whereas <code>n</code> is the length of the <code>sourceArray</code> and map it as follows; if index is odd insert the intersperse item; if even insert <code>sourceArray[i&#47;2]</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478378236, "post_id": 40442203, "comment_id": 68132408, "body": "Can you explain clearly, in English, what each function is expected to do, and give several examples of arguments and results (including corner cases)? I have no idea what <code>insert</code> and <code>interspace</code> are supposed to mean in this context, and reading incorrect code for implementing <code>interspace</code> seems unlikely to help me figure that out."}, {"owner": {"reputation": 1, "user_id": 7120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c86d5d8ba518cc0206efcef5acc47c2?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Metzger", "link": "https://stackoverflow.com/users/7120097/dennis-metzger"}, "edited": false, "score": 0, "creation_date": 1478378867, "post_id": 40442203, "comment_id": 68132612, "body": "The insert function replaces one element in the list with another element. The insert is just the name of the function. The interspace function should add an element in the list of different number between m and q"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c86d5d8ba518cc0206efcef5acc47c2?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Metzger", "link": "https://stackoverflow.com/users/7120097/dennis-metzger"}, "edited": false, "score": 0, "creation_date": 1478379111, "post_id": 40442977, "comment_id": 68132679, "body": "Non-exhaustive patterns in function interspace error"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "reply_to_user": {"reputation": 1, "user_id": 7120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c86d5d8ba518cc0206efcef5acc47c2?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Metzger", "link": "https://stackoverflow.com/users/7120097/dennis-metzger"}, "edited": false, "score": 0, "creation_date": 1478379568, "post_id": 40442977, "comment_id": 68132833, "body": "What is your input? If you paste this into a blank haskell file, do you still encounter the same non-exhaustive patterns error?"}, {"owner": {"reputation": 1, "user_id": 7120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c86d5d8ba518cc0206efcef5acc47c2?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Metzger", "link": "https://stackoverflow.com/users/7120097/dennis-metzger"}, "edited": false, "score": 0, "creation_date": 1478379831, "post_id": 40442977, "comment_id": 68132910, "body": "interspace.hs:1:2: error:     Illegal type signature: \u2018Eq a =&gt;                              a -&gt; a -&gt; a -&gt; [a] -&gt; [a] interspace m n q []\u2019       Type signatures are only allowed in patterns with ScopedTypeVariables  interspace.hs:3:2: error:     Multiple declarations of \u2018interspace\u2019     Declared at: interspace.hs:1:2                  interspace.hs:3:2"}, {"owner": {"reputation": 1, "user_id": 7120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c86d5d8ba518cc0206efcef5acc47c2?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Metzger", "link": "https://stackoverflow.com/users/7120097/dennis-metzger"}, "edited": false, "score": 0, "creation_date": 1478379950, "post_id": 40442977, "comment_id": 68132948, "body": "parse error on input \u2018=\u2019     Perhaps you need a &#39;let&#39; in a &#39;do&#39; block?     e.g. &#39;let x = 5&#39; instead of &#39;x = 5&#39; now"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "reply_to_user": {"reputation": 1, "user_id": 7120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c86d5d8ba518cc0206efcef5acc47c2?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Metzger", "link": "https://stackoverflow.com/users/7120097/dennis-metzger"}, "edited": false, "score": 0, "creation_date": 1478380221, "post_id": 40442977, "comment_id": 68133042, "body": "So you&#39;re only encountering the parse error now? And what is your input? ex. <code>interspace 1 2 1 [1,1]</code> Also, what are you expecting as output for something like <code>interspace 1 2 1 [1,1,1]</code>? Can the middle <code>1</code> be part of a pair twice?"}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": false, "score": 1, "last_activity_date": 1478379949, "last_edit_date": 1478379949, "creation_date": 1478378427, "answer_id": 40442977, "question_id": 40442203, "link": "https://stackoverflow.com/questions/40442203/interspace-program-in-haskell/40442977#40442977", "title": "Interspace program in Haskell", "body": "<p>Since you will only be adding values to the front of the list, your <code>insert</code> function is unnecessary. <code>(:)</code> will suffice instead. Much like in <code>insert</code>, we pass recursively over the list. Since we want to check if two values match at a time and will also call the function recursively on different lists based on whether or not we find a match, it's a good idea to pattern match <code>(x1:x2:xs)</code> rather than just <code>(x:xs)</code>.</p>\n\n<p>If <code>m</code> matches <code>x1</code> and <code>q</code> matches <code>x2</code>, we place the onto the head of the list and call <code>interspace</code> recursively on the rest of the list. If they do not mach, we call <code>interspace</code> on <code>(x2:xs)</code>.</p>\n\n<pre><code> interspace :: Eq a =&gt; a -&gt; a -&gt; a-&gt; [a] -&gt; [a]\n interspace m n q []         = []\n interspace m n q [x]        = [x]\n interspace m n q (x1:x2:xs) | m == x1 &amp;&amp; q == x2 = m : n : q : interspace m n q xs\n                             | otherwise          = x1 : interspace m n q (x2:xs)\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>ghci&gt;&gt; interspace 1 2 1 [1,1,2,1,1]\n[1,2,1,2,1,2,1]\nghci&gt;&gt; interspace 1 2 1 [1,1,3]\n[1,2,1,3]\nghci&gt;&gt; interspace 1 2 1 [1,2,4,2]\n[1,2,4,2]\nghci&gt;&gt; interspace 1 2 1 [1]\n[1]\nghci&gt;&gt; interspace 1 2 1 []\n[]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c86d5d8ba518cc0206efcef5acc47c2?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Metzger", "link": "https://stackoverflow.com/users/7120097/dennis-metzger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1478403673, "creation_date": 1478373309, "last_edit_date": 1478403673, "question_id": 40442203, "link": "https://stackoverflow.com/questions/40442203/interspace-program-in-haskell", "title": "Interspace program in Haskell", "body": "<pre><code>insert :: Eq(a) =&gt; a -&gt; a -&gt; [a] -&gt; [a]\ninsert m n [] = []\ninsert m n (x:xs) | m==x = n : x : insert m n xs  \n                 | otherwise = x : insert m n xs\n</code></pre>\n\n<p>The <code>insert</code> function above is a working function that inserts a value <code>n</code> into a list before all instances of a value <code>m</code>. </p>\n\n<p>I need help writing an <code>interspace</code> function that inserts a value <code>n</code> between all values <code>m</code> and <code>q</code> in a list. This is what I have so far:</p>\n\n<pre><code> interspace :: Eq(a) =&gt; a -&gt; a -&gt; a-&gt;[a] -&gt; [a]\n\n interspace m n q[] = []\n\n interspace m n q (x:xs)| m==x &amp;&amp; q==(head xs)  = n: x : insert m n (headxs)++interspace m n q (xs)\n\n                         | otherwise = x : interspace m n q xs\n</code></pre>\n"}, {"tags": ["haskell", "gcc", "linker", "cabal", "ffi"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478370581, "post_id": 40441556, "comment_id": 68130186, "body": "The <code>*** C Compiler:</code> and following output comes from ghc. How is cabal invoking ghc?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478370911, "post_id": 40441556, "comment_id": 68130293, "body": "(If you just run <code>cabal build -v</code>, the last line will tell you.)"}, {"owner": {"reputation": 428, "user_id": 1520657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599f6ac58a187b4e89ad8cb576304166?s=128&d=identicon&r=PG", "display_name": "MichaelO", "link": "https://stackoverflow.com/users/1520657/michaelo"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478371330, "post_id": 40441556, "comment_id": 68130434, "body": "This is the output: <a href=\"https://gist.github.com/anonymous/41dd5f00401ce897e5cc7f190bc276ae\" rel=\"nofollow noreferrer\">gist link</a>"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478371868, "post_id": 40441556, "comment_id": 68130582, "body": "There are a few things I don&#39;t understand in what you have presented, but I&#39;m pretty sure that the <code>--with-gcc</code> flag is actually immaterial here. Do you have some secret <code>ghc-options</code> set perhaps?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478371995, "post_id": 40441556, "comment_id": 68130636, "body": "At any rate, you need the flags <code>-pgml &#47;opt&#47;gcc-3.3.6&#47;bin&#47;gcc</code> to get ghc to use <code>&#47;opt&#47;gcc-3.3.6&#47;bin&#47;gcc</code> for the link step."}, {"owner": {"reputation": 428, "user_id": 1520657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599f6ac58a187b4e89ad8cb576304166?s=128&d=identicon&r=PG", "display_name": "MichaelO", "link": "https://stackoverflow.com/users/1520657/michaelo"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478372925, "post_id": 40441556, "comment_id": 68130888, "body": "Ok, it cleared up a bit, I had the -pgmc in the ghc-options but not pgml. But now I get a message from ghc: could not execute /opt/gcc-3.3.6/bin/gcc (added full output to the gist above). That&#39;s really weird, because it executed it before."}, {"owner": {"reputation": 428, "user_id": 1520657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599f6ac58a187b4e89ad8cb576304166?s=128&d=identicon&r=PG", "display_name": "MichaelO", "link": "https://stackoverflow.com/users/1520657/michaelo"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478373160, "post_id": 40441556, "comment_id": 68130957, "body": "A small add: I had to create a small wrapper script because cabal was sending illegal options to the old gcc, so the gcc binary itself is a wrapper script which just filters out the -fno-stack-protector switch and then calls the real gcc with the changed options. Still it works properly in all other situations I call it."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478375217, "post_id": 40441556, "comment_id": 68131482, "body": "There is a telling comma at the very end of your gist."}, {"owner": {"reputation": 428, "user_id": 1520657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599f6ac58a187b4e89ad8cb576304166?s=128&d=identicon&r=PG", "display_name": "MichaelO", "link": "https://stackoverflow.com/users/1520657/michaelo"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478376433, "post_id": 40441556, "comment_id": 68131833, "body": "You are right. That&#39;s it. Still getting link errors, but they are from a different reason. Thank you a lot! Could you convert your comment with the pgml to an answer so that I can flag it?"}], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 2, "last_activity_date": 1478376227, "creation_date": 1478376227, "answer_id": 40442653, "question_id": 40441556, "link": "https://stackoverflow.com/questions/40441556/cabal-selects-wrong-linker/40442653#40442653", "title": "Cabal selects wrong linker", "body": "<p>This apparently had nothing to do with Cabal, which does not instruct GHC to use the C compiler specified by the Cabal option <code>--with-gcc</code>.</p>\n\n<p>Use <code>-pgml</code> to select the linker as documented on the GHC man page.</p>\n\n<p>(One point that may cause confusion for others and is worth mentioning. GHC always uses a <strong>C compiler</strong> to do the final link step. That means <code>-pgml</code> must refer to something like <code>gcc</code>, not something like <code>ld</code>. Consequently flags intended to be consumed by <code>ld</code> such as <code>-rpath</code> must be prefixed by <code>-Wl,</code> before being fed to <code>-optl</code>.)</p>\n"}], "owner": {"reputation": 428, "user_id": 1520657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599f6ac58a187b4e89ad8cb576304166?s=128&d=identicon&r=PG", "display_name": "MichaelO", "link": "https://stackoverflow.com/users/1520657/michaelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 40442653, "answer_count": 1, "score": 1, "last_activity_date": 1478376227, "creation_date": 1478369267, "question_id": 40441556, "link": "https://stackoverflow.com/questions/40441556/cabal-selects-wrong-linker", "title": "Cabal selects wrong linker", "body": "<p>I am working on a Haskell program which is linked to some old C++ code. I created a C interface and got it working with ghc only. Now I tried to convert the used Makefile into a Cabal project and now cabal on the last step selects the wrong linker.</p>\n\n<p>Because of some dependencies I have to use a quite old ghc and gcc. So what I am doing is calling cabal (1.24.0.0.) like this:</p>\n\n<pre><code>cabal install --with-ghc=ghc-7.6.3 --with-gcc=/opt/gcc-3.3.6/bin/gcc  --with-ld=/opt/gcc-3.3.6/bin/gcc\n</code></pre>\n\n<p>For the compile- and intermediate configure linking all is ok, with <code>-v3</code> I get the following lines:</p>\n\n<pre><code>Using gcc version 3.3.6 given by user at: /opt/gcc-3.3.6/bin/gcc\nUsing ghc version 7.6.3 given by user at: /home/oswald/ghcs/bin/ghc-7.6.3\n...\nUsing ld given by user at: /opt/gcc-3.3.6/bin/gcc\n</code></pre>\n\n<p>All works fine until the final linking step:</p>\n\n<pre><code>Linking dist/dist-sandbox-c45ed4c7/build/MISCconfig/MISCconfig ...\n*** C Compiler:\n'/opt/gcc-3.3.6/bin/gcc' '-c' '/tmp/ghc28340_0/ghc28340_0.c' '-o' ...               \n*** C Compiler:\n'/opt/gcc-3.3.6/bin/gcc' '-c' '/tmp/ghc28340_0/ghc28340_0.s' '-o' ...    \n*** Linker:\n'/usr/bin/gcc' '-fno-stack-protector' '-Wl,--hash-size=31' '-W\n</code></pre>\n\n<p>So the last line specifies <code>/usr/bin/gcc</code> as the linker, which is the system one and therefore I get link errors where it should be <code>/opt/gcc-3.3.6/bin/gcc</code> (have to use a pre-3.4.0 gcc because of link compatibility for one of the used C++ libraries and gcc 3.3.6 is the latest with the old ABI).</p>\n\n<p>So what I am doing wrong? Cabal says it selects the linker from the old gcc but then actually uses the newer one from the system?</p>\n\n<p>When I just use ghc with the <code>-pgmc /opt/gcc-3.3.6/bin/gcc</code> switch in a makefile all works but I would prefer to get a cabal sandbox working...</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1478365612, "post_id": 40440949, "comment_id": 68128642, "body": "what about <code>[x==2,x==3,y==2,y==3]</code>"}, {"owner": {"reputation": 1, "user_id": 6442115, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SYTb1HO5zDQ/AAAAAAAAAAI/AAAAAAAAABs/qnf1WphR3R0/photo.jpg?sz=128", "display_name": "Rama krishna", "link": "https://stackoverflow.com/users/6442115/rama-krishna"}, "edited": false, "score": 0, "creation_date": 1478365914, "post_id": 40440949, "comment_id": 68128738, "body": "You could find answer for your question here. <a href=\"http://stackoverflow.com/a/2917186/6442115\">Return multiple values in JavaScript</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1478365931, "post_id": 40440949, "comment_id": 68128746, "body": "Where exactly are the checks coming from? This is too broad to recommend anything in particular except the code for your exact example that epsilonhalbe provides."}, {"owner": {"reputation": 1, "user_id": 4930457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c62891be1878c50b1ef0b524a8fd24?s=128&d=identicon&r=PG&f=1", "display_name": "luxuriousTruckers", "link": "https://stackoverflow.com/users/4930457/luxurioustruckers"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1478366273, "post_id": 40440949, "comment_id": 68128849, "body": "@epsilonhalbe, thanks! Exactly what I was looking for"}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1478367092, "creation_date": 1478367092, "answer_id": 40441194, "question_id": 40440949, "link": "https://stackoverflow.com/questions/40440949/how-to-return-an-array-with-each-element-responding-to-a-certain-check/40441194#40441194", "title": "How to return an array with each element responding to a certain check", "body": "<p>you can always use</p>\n\n<pre><code>f :: (Eq a, Num a,Eq b, Num b) =&gt; a -&gt; b -&gt; [Bool]\nf x y = [x == 2, x == 3, y == 2, y == 3]\n</code></pre>\n\n<p>if you have only one parameter and multiple predicates you can do something like </p>\n\n<pre><code>f x = map ($ x) [p1,p2,p3,p4]\n where p1 = odd\n       p2 = even\n       p3 = (==3)\n       p4 = (==4)\n</code></pre>\n\n<p>which lends itself good to creating the checks programmatically another trick is to use it the other way around</p>\n\n<pre><code>f x = map (==x) [1..10]\n</code></pre>\n\n<p>or when you have a list of <code>xs</code> you can use <code>zipWith (==) xs [1..]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1478367511, "creation_date": 1478367511, "answer_id": 40441259, "question_id": 40440949, "link": "https://stackoverflow.com/questions/40440949/how-to-return-an-array-with-each-element-responding-to-a-certain-check/40441259#40441259", "title": "How to return an array with each element responding to a certain check", "body": "<pre><code>x=5\ny=3\n</code></pre>\n\n<p>elementary</p>\n\n<pre><code>zipWith (==) [x,x,y,y] [2,3,2,3]\n[False,False,False,True]\n</code></pre>\n\n<p>or with magic</p>\n\n<pre><code>import Control.Monad (liftM2)\nliftM2 (==) [x,y] [2,3]\n[False,False,False,True]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4930457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c62891be1878c50b1ef0b524a8fd24?s=128&d=identicon&r=PG&f=1", "display_name": "luxuriousTruckers", "link": "https://stackoverflow.com/users/4930457/luxurioustruckers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1478367511, "creation_date": 1478365528, "question_id": 40440949, "link": "https://stackoverflow.com/questions/40440949/how-to-return-an-array-with-each-element-responding-to-a-certain-check", "title": "How to return an array with each element responding to a certain check", "body": "<p>I would like to return a list of Bools where each responds to a certain check, here is a javascript example:</p>\n\n<pre><code>if(x == 2)\n    a = false;\nif(x == 3)\n    b = false;\nif(y == 2)\n    c = false;\nif(y == 3)\n    d = false;\n\nreturn [a, b, c, d];\n</code></pre>\n\n<p>Dirty example, I know. Just wondering what a good approach might be.</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1478361885, "post_id": 40439153, "comment_id": 68127442, "body": "Note that <code>map (2^) [1..] == [2,4,8,16,...]</code> and <code>iterate (*2) 1 == [1,2,4,8,16,...]</code> are slightly different. The <code>map</code> version can include <code>2^0</code> by mapping over <code>[0..]</code> instead; the iterate version can exclude it by starting with 2 instead of 1."}], "tags": [], "owner": {"reputation": 682, "user_id": 4088416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1719bb302e6c3d5a78148083e73b7fc1?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Antonio Riaza Valverde", "link": "https://stackoverflow.com/users/4088416/jos%c3%a9-antonio-riaza-valverde"}, "is_accepted": true, "score": 1, "last_activity_date": 1478354847, "creation_date": 1478354847, "answer_id": 40439153, "question_id": 40439030, "link": "https://stackoverflow.com/questions/40439030/haskell-2n-functional-programming/40439153#40439153", "title": "Haskell 2^n functional programming", "body": "<p><code>powerOf2</code> signature must be <code>powerOf2 :: [Int]</code>. <code>numsFrom</code> returns a list to be mapped, so the function to map is <code>(2^)</code>:</p>\n\n<pre><code>powerOf2 :: [Int]\npowerOf2 = map (2^) (numsFrom 1)\n</code></pre>\n\n<p>PD: Note that you don't need <code>numsFrom</code> function:</p>\n\n<pre><code>powerOf2 :: [Int]\npowerOf2 = map (2^) [1..]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5618242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84421b56686003cf15449002ec3473f8?s=128&d=identicon&r=PG&f=1", "display_name": "POC", "link": "https://stackoverflow.com/users/5618242/poc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 40439153, "answer_count": 1, "score": 0, "last_activity_date": 1478354847, "creation_date": 1478354001, "question_id": 40439030, "link": "https://stackoverflow.com/questions/40439030/haskell-2n-functional-programming", "title": "Haskell 2^n functional programming", "body": "<p>I am trying to do <strong>Haskell</strong> version of <strong>2^n integer list</strong>. numsFrom generate infinite sequence, I want to map this sequence into number 2, but I have an error message: </p>\n\n<blockquote>\n  <p>Possible cause: \u2018map\u2019 is applied to too many arguments.</p>\n</blockquote>\n\n<pre><code>numsFrom :: Int -&gt; [Int]\nnumsFrom n = n : numsFrom (n+1)\n\npowerOf2 :: Int -&gt; [Int]\npowerOf2 = map(^numsFrom 1) 2\n</code></pre>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1478364605, "post_id": 40438679, "comment_id": 68128335, "body": "What is <code>eleveConstr</code> ?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1478364851, "post_id": 40438679, "comment_id": 68128413, "body": "What is <code>GHC.Show.Show</code>? You probably want the TH splice representing the name - <code>&#39;&#39;Show</code> or <code>showCon &lt;- mkName &quot;Show&quot;</code>"}, {"owner": {"reputation": 93, "user_id": 2327789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/urJdc.png?s=128&g=1", "display_name": "Echologie", "link": "https://stackoverflow.com/users/2327789/echologie"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1478369950, "post_id": 40438679, "comment_id": 68129970, "body": "@Sibi I corrected the code. I changed the original code to self document the example, but forgot that."}, {"owner": {"reputation": 93, "user_id": 2327789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/urJdc.png?s=128&g=1", "display_name": "Echologie", "link": "https://stackoverflow.com/users/2327789/echologie"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1478370112, "post_id": 40438679, "comment_id": 68130021, "body": "@user2407038 I&#39;ll try it tonight. Looks that it will fix the first definition! But I still don&#39;t understand the problem with the second version."}], "answers": [{"tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": true, "score": 1, "last_activity_date": 1478370230, "creation_date": 1478370230, "answer_id": 40441701, "question_id": 40438679, "link": "https://stackoverflow.com/questions/40438679/generate-a-data-declaration-with-templatehaskell/40441701#40441701", "title": "Generate a data declaration with TemplateHaskell", "body": "<p>You can use <code>''Show</code> to get the <code>Type</code> with the name that is in scope.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nmodule Constant where\n\nimport Language.Haskell.TH\n\ncreateConstant constantName = do\n    tname &lt;- newName constantName\n    cname &lt;- newName constantName\n    return [DataD [] tname [] [NormalC cname []] [''Show]]\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 2327789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/urJdc.png?s=128&g=1", "display_name": "Echologie", "link": "https://stackoverflow.com/users/2327789/echologie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 40441701, "answer_count": 1, "score": 3, "last_activity_date": 1478370230, "creation_date": 1478351791, "last_edit_date": 1478369775, "question_id": 40438679, "link": "https://stackoverflow.com/questions/40438679/generate-a-data-declaration-with-templatehaskell", "title": "Generate a data declaration with TemplateHaskell", "body": "<p>I wonder how to generate a bunch of constants based on a list of names.</p>\n\n<p>I started with this working example:</p>\n\n<p><code>ConstantCreation.hs</code></p>\n\n<pre><code>module ConstantCreation where\n\nimport Language.Haskell.TH\n\ncreateConstant :: String -&gt; Q [Dec]\ncreateConstant constantName = do constantType   &lt;- newName constantName\n                                 constant       &lt;- newName constantName\n                                 return [ DataD []\n                                          constantType []\n                                          [NormalC constant []]\n                                          []                       ]\n</code></pre>\n\n<p><code>MyConstants.hs</code></p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nmodule MyConstants where\n\nimport ConstantCreation\n\n$(do constantsDeclarations &lt;- mapM createConstant\n                                       [ \"MyFirstCustomConstant\"  ,\n                                         \"MySecondCustomConstant\"   ]\n     return $ mconcat constantsDeclarations)\n</code></pre>\n\n<p>But things get tricky when I try to add a <code>deriving Show</code>.</p>\n\n<p>I first tried changing the function <code>createConstant</code> like this:</p>\n\n<pre><code>createConstant constantName = do constantType   &lt;- newName constantName\n                                 constant       &lt;- newName constantName\n                                 return [ DataD []\n                                          constantType []\n                                          [NormalC constant []]\n                                          [GHC.Show.Show]          ]\n</code></pre>\n\n<p>as suggested if I run the command <code>runQ [d|data MyConstant = MyConstant deriving Show|]</code> in GHCi, but it throws the error <code>Not in scope: data constructor \u2018GHC.Show.Show\u2019</code></p>\n\n<p>So I tried do define my function like this :</p>\n\n<pre><code>createConstant constantName = [d|data $(ConT $ newName constantName) = $(NormalC (newName constantName) []) deriving Show|]\n</code></pre>\n\n<p>but then I had the following error:</p>\n\n<pre><code>Cannot parse data constructor in a data/newtype declaration: $(NormalC\n                                                                 (newName constantName) [])\n</code></pre>\n\n<p>It would really be a pitty to have to define Show instances by hand, so I wonder what's going badly.</p>\n\n<p>Thanks for any advice or explanation.</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "higher-order-functions"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1478352046, "post_id": 40438591, "comment_id": 68124511, "body": "You stated the depth of an empty tree and that of a leaf. That already gives you the first two cases of your function definition (though specifying the depth for leaves is techically redundant). But what is the depth of a node with children? Once you write that down formally, it should become apparent what the last case of the function definition should be."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1478352744, "post_id": 40438591, "comment_id": 68124676, "body": "Note that you do not need your second case for <code>insertTree</code>; the general case <code>Node b left right</code> reduces to the base case <code>Empty</code> when the subtree you recurse on is empty."}], "answers": [{"tags": [], "owner": {"reputation": 682, "user_id": 4088416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1719bb302e6c3d5a78148083e73b7fc1?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Antonio Riaza Valverde", "link": "https://stackoverflow.com/users/4088416/jos%c3%a9-antonio-riaza-valverde"}, "is_accepted": false, "score": 4, "last_activity_date": 1478352980, "creation_date": 1478352980, "answer_id": 40438862, "question_id": 40438591, "link": "https://stackoverflow.com/questions/40438591/writing-a-recursive-function-to-count-the-depth-of-a-tree/40438862#40438862", "title": "writing a recursive function to count the depth of a tree", "body": "<p>An empty tree has depth <code>0</code>, and a node has depth <code>1</code> plus the maximum depth of its child nodes:</p>\n\n<pre><code>depth :: Tree a -&gt; Int\ndepth Empty = 0\ndepth (Node _ l r) = 1 + max (depth l) (depth r)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 682, "user_id": 4088416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1719bb302e6c3d5a78148083e73b7fc1?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Antonio Riaza Valverde", "link": "https://stackoverflow.com/users/4088416/jos%c3%a9-antonio-riaza-valverde"}, "edited": false, "score": 3, "creation_date": 1478358520, "post_id": 40439631, "comment_id": 68126379, "body": "That is not the depth of a tree, but the number of nodes its has."}, {"owner": {"reputation": 494, "user_id": 5447207, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d96199ece7ba3bc4f3c1d97d645f5fad?s=128&d=identicon&r=PG", "display_name": "Bargros", "link": "https://stackoverflow.com/users/5447207/bargros"}, "reply_to_user": {"reputation": 682, "user_id": 4088416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1719bb302e6c3d5a78148083e73b7fc1?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Antonio Riaza Valverde", "link": "https://stackoverflow.com/users/4088416/jos%c3%a9-antonio-riaza-valverde"}, "edited": false, "score": 0, "creation_date": 1478361051, "post_id": 40439631, "comment_id": 68127192, "body": "Yep you guys where right, my bad, is fixed now although is pointless since you already gave the answer"}], "tags": [], "owner": {"reputation": 494, "user_id": 5447207, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d96199ece7ba3bc4f3c1d97d645f5fad?s=128&d=identicon&r=PG", "display_name": "Bargros", "link": "https://stackoverflow.com/users/5447207/bargros"}, "is_accepted": false, "score": 0, "last_activity_date": 1478360998, "last_edit_date": 1478360998, "creation_date": 1478357801, "answer_id": 40439631, "question_id": 40438591, "link": "https://stackoverflow.com/questions/40438591/writing-a-recursive-function-to-count-the-depth-of-a-tree/40439631#40439631", "title": "writing a recursive function to count the depth of a tree", "body": "<p>Here you go, is very simple, recursing through a list and a Tree is about the same, only the data types differ. Where you add 1 every time you hit a branch of the tree in question:</p>\n\n<pre><code>tDepth :: Tree a -&gt; Int\ntDepth Empty = 0\ntDepth (Node _ left right) = 1 + max (tLength left)  (tLength right)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7117463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29032f7489ff2539bc469771eea157e4?s=128&d=identicon&r=PG&f=1", "display_name": "Nazim Gul", "link": "https://stackoverflow.com/users/7117463/nazim-gul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1478475111, "creation_date": 1478351194, "last_edit_date": 1478475111, "question_id": 40438591, "link": "https://stackoverflow.com/questions/40438591/writing-a-recursive-function-to-count-the-depth-of-a-tree", "title": "writing a recursive function to count the depth of a tree", "body": "<p>I have to write a recursive function that, Given a Tree\ndatatype,will return the depth of the tree. An empty tree should return\n0. A single root node Tree should return 1.</p>\n\n<p>expected output:</p>\n\n<pre><code>let treeCons x = (\\x -&gt; foldl (flip insertTree) Empty x) x\ndepth (treeCons []) -&gt; 0\ndepth (treeCons [5,4,6,3,7,1]) -&gt; 4\ndepth (treeCons [1,2,5,8,9,4,7]) -&gt; 5\ndepth (treeCons [5,4,6,3,7,1,2,5,8,9,4,7,8,5,3,4]) -&gt; 6\n</code></pre>\n\n<p>I wrote the following datatype and insert function:</p>\n\n<pre><code>data Tree a = Node a (Tree a) (Tree a) | Empty deriving (Show, Eq)\ninsertTree :: (Ord a) =&gt; a -&gt; Tree a -&gt; Tree a\ninsertTree a Empty = Node a Empty Empty\ninsertTree a (Node b Empty Empty) = if (a &lt;= b) then (Node b (Node a Empty Empty) Empty) else (Node b Empty (Node a Empty Empty))\ninsertTree a (Node b left right) = if (a &lt;= b) then (Node b (insertTree a left) right ) else (Node b left (insertTree a right))\n</code></pre>\n\n<p>However, I'm not getting how to write depth function.I'm very new in haskell and I'll appreciate if someone helps me.</p>\n"}, {"tags": ["haskell", "type-level-computation"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1478352759, "post_id": 40437504, "comment_id": 68124682, "body": "This code looks like it&#39;s unnecessarily complicated. What exactly are you trying to do? Why do you want a &quot;hash with type level keys&quot;?"}, {"owner": {"reputation": 131, "user_id": 3749167, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056fa9bbc5f8f7a35be7fa3c353a023e?s=128&d=identicon&r=PG&f=1", "display_name": "user3749167", "link": "https://stackoverflow.com/users/3749167/user3749167"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1478357246, "post_id": 40437504, "comment_id": 68126038, "body": "Thanks for the comment. I added my motivation of it in my question."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1478367799, "post_id": 40437504, "comment_id": 68129324, "body": "The instance <code>HasKey (Proxy k&#39;) (NamedVal v k :. b)</code> does not know that <code>k</code> and <code>k&#39;</code> are distinct types, so it does not know that the first pattern of <code>ValueType</code> does not match. There are several libraries implementing heterogenous collections - you should check those out as a starting point."}, {"owner": {"reputation": 131, "user_id": 3749167, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056fa9bbc5f8f7a35be7fa3c353a023e?s=128&d=identicon&r=PG&f=1", "display_name": "user3749167", "link": "https://stackoverflow.com/users/3749167/user3749167"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1478394183, "post_id": 40437504, "comment_id": 68136491, "body": "@user2407038 , I think so, too.  Is there any recommend library it actually do it in type level manner? I have already surveyed a bit about the implementation of the value level heterogeneous collections."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 3749167, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056fa9bbc5f8f7a35be7fa3c353a023e?s=128&d=identicon&r=PG&f=1", "display_name": "user3749167", "link": "https://stackoverflow.com/users/3749167/user3749167"}, "is_accepted": true, "score": 0, "last_activity_date": 1478437771, "creation_date": 1478437771, "answer_id": 40449697, "question_id": 40437504, "link": "https://stackoverflow.com/questions/40437504/how-to-compile-heterogeneous-hash-map-like-object-using-type-level-keys-in-haske/40449697#40449697", "title": "How to compile heterogeneous hash map like object using type level keys in Haskell?", "body": "<p>I've found that following code works well and released <a href=\"http://hackage.haskell.org/package/type-level-kv-list\" rel=\"nofollow noreferrer\">type-level-kv-list</a> module using this.</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeInType #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE InstanceSigs #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE IncoherentInstances #-}\n\nmodule Type where\n\nimport Data.Proxy (Proxy(..))\nimport Data.Typeable (Typeable)\nimport GHC.TypeLits (KnownSymbol, symbolVal)\n\n{- | A value with type level index.\n -}\ntype NamedVal v key = (Proxy key, v)\n\n{- | Type level list cons\n -}\ndata a :. b = a :. b\n    deriving (Typeable, Eq, Show)\ninfixr 8 :.\n\n{- | Type level @[]@\n -}\ndata Null = Null\n    deriving (Typeable, Eq, Show)\n\ntype family Lookup pkey list where\n  Lookup pk ((pk, v) :. b) = v\n  Lookup pk ((px, v) :. b) = Lookup pk b\n  Lookup pk Null = Null\n\nclass HasKey list pkey value where\n  get' :: pkey -&gt; list -&gt; value\n\ninstance (KnownSymbol k) =&gt;\n  HasKey (NamedVal v k :. b) (Proxy k) v where\n  get' :: forall b0 k0 v0\n      .  (KnownSymbol k0)\n      =&gt; Proxy k0 -&gt; NamedVal v0 k0 :. b0 -&gt; v0\n  get' _ ((_, a) :. _) = a\n\ninstance (NamedList b, KnownSymbol k, HasKey b (Proxy k) v) =&gt;\n  HasKey (a :. b) (Proxy k) v where\n  get' _ (_ :. b) = get' (Proxy :: Proxy k) b\n\ninstance (KnownSymbol k, v ~ Null) =&gt;\n  HasKey Null (Proxy k) v where\n  get' _ Null = Null\n\nget :: (HasKey list pkey (Lookup pkey list))\n    =&gt; pkey -&gt; list -&gt; Lookup pkey list\nget (pkey :: pkey) (list :: list) =\n  get' pkey list :: Lookup pkey list\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 3749167, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056fa9bbc5f8f7a35be7fa3c353a023e?s=128&d=identicon&r=PG&f=1", "display_name": "user3749167", "link": "https://stackoverflow.com/users/3749167/user3749167"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 40449697, "answer_count": 1, "score": 1, "last_activity_date": 1478437771, "creation_date": 1478344117, "last_edit_date": 1478357182, "question_id": 40437504, "link": "https://stackoverflow.com/questions/40437504/how-to-compile-heterogeneous-hash-map-like-object-using-type-level-keys-in-haske", "title": "How to compile heterogeneous hash map like object using type level keys in Haskell?", "body": "<p>I want to use something like \"heterogeneous hash map using type level keys\".\nAfter struggling, I wrote a code bellow (though in fact, it is just a list like structure rather than hash map), but it does not be successfully complied.</p>\n\n<p>The error message is as follows.</p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018ValueType\n                                  (Proxy k') (NamedVal v k :. b)\u2019\n              with actual type \u2018ValueType (Proxy k') b\u2019\n  NB: \u2018ValueType\u2019 is a type function, and may not be injective\n\u2022 In the expression: get (Proxy :: Proxy k') b\n</code></pre>\n\n<p>It seems type family declaration is not understood by compiler as I meant.\nHow do I compile this code?</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeInType #-}\n{-# LANGUAGE InstanceSigs #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE IncoherentInstances #-}\n\nmodule TypeLevelKV where\n\n{- | The goal of this module is to get the value with a type level key.\n\n&gt;&gt;&gt; get (Proxy :: Proxy \"foo\") sampleList\n\"str\"\n\n&gt;&gt;&gt; get (Proxy :: Proxy \"bar\") sampleList\n34\n-}\n\nimport Data.Proxy (Proxy(..))\nimport Data.Typeable (Typeable)\nimport GHC.TypeLits (KnownSymbol, symbolVal)\n\nsampleList =\n  (namedVal \"str\"   :: NamedVal String \"foo\") :.\n  (namedVal 34      :: NamedVal Int \"bar\") :.\n  (namedVal True    :: NamedVal Bool \"baz\") :. Null\n\n{- | A value with type level index.\n -}\ntype NamedVal v key = (Proxy key, v)\n\n{- | Type level list cons\n -}\ndata a :. b = a :. b\n    deriving (Typeable, Eq, Show)\ninfixr 8 :.\n\n{- | Type level @[]@\n -}\ndata Null = Null\n    deriving (Typeable, Eq, Show)\n\ntype family ValueType pkey list where\n  ValueType (Proxy k) (NamedVal v k :. b) = v\n  ValueType (Proxy k') (NamedVal v k :. b) = ValueType (Proxy k') b\n  ValueType (Proxy k) Null = Null\n\nclass HasKey pkey list where\n  get :: pkey -&gt; list -&gt; (ValueType pkey list)\n\ninstance (KnownSymbol k) =&gt;\n  HasKey (Proxy k) (NamedVal v k :. b) where\n  get _ ((_, a) :. _) = a\n\ninstance (KnownSymbol k, KnownSymbol k', HasKey (Proxy k') b) =&gt;\n  HasKey (Proxy k') (NamedVal v k :. b) where\n  get _ (_ :. b) = get (Proxy :: Proxy k') b\n\ninstance (KnownSymbol k) =&gt;\n  HasKey (Proxy k) Null where\n  get _ Null = Null\n\nnamedVal :: forall k v\n         . (KnownSymbol k)\n         =&gt; v -&gt; NamedVal v k\nnamedVal a = (Proxy, a)\n</code></pre>\n\n<h2>Followings are reply for the @Benjamin Hodgson 's comment</h2>\n\n<p>One of the reason I need this is that I want to use it with template haskell as follows and ensure that all the variables required by <code>sampleQ</code> is same type as needed.</p>\n\n<pre><code>withDict :: [String] -&gt; Q Exp -&gt; Q Exp\nwithDict keys q = undefined\n-- e.g., `withDict (Proxy :: Proxy MyType) sampleQ` generates\n-- \\(dict :: MyType) -&gt;\n--   let\n--     foo = get (Proxy :: Proxy \"foo\") dict\n--     bar = get (Proxy :: Proxy \"bar\") dict\n--     baz = get (Proxy :: Proxy \"baz\") dict\n--     defaultValue = \"If no \\\"defaultValue\\\" key exists, this default value is provided to sampleQ\"\n--   in\n--     $(sampleQ)\n\ntype MyType =\n  NamedVal String \"foo\" :.\n  NamedVal Int \"bar\" :.\n  NamedVal Bool \"baz\" :. Null\n</code></pre>\n\n<p>After defining this, we can inject any values with variable name into a <code>Q Exp</code> such as Shakespearen template.</p>\n\n<pre><code>renderWith :: IO ()\nrenderWith = do\n  foo &lt;- getLine\n  bar &lt;- readLn\n  baz &lt;- readLn\n  let\n    sampleList :: MyType\n    sampleList =\n      (namedVal foo   :: NamedVal String \"foo\") :.\n      (namedVal bar   :: NamedVal Int \"bar\") :.\n      (namedVal baz   :: NamedVal Bool \"baz\") :. Null\n  putStrLn $ $(withDict (Proxy :: Proxy MyType) renderSomeFile) sampleList\n</code></pre>\n"}, {"tags": ["json", "parsing", "haskell", "binary"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478342802, "post_id": 40436978, "comment_id": 68121844, "body": "Some sort of minimal example of what you want to do would be nice, but I think you are looking for something like <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\"><code>lens</code></a> and <a href=\"https://hackage.haskell.org/package/lens-aeson\" rel=\"nofollow noreferrer\"><code>lens-aeson</code></a>."}, {"owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478343227, "post_id": 40436978, "comment_id": 68121951, "body": "Yes... somebody already recommended me lens. Unforunately I&#39;m not studied them yet. Just got over functors, applicatives, monads, transformers. There is so many stuff to learn to start producing something practical in haskell..."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478343880, "post_id": 40436978, "comment_id": 68122144, "body": "Well if you want something simpler to start with, you could map your JSON onto Haskell data using <a href=\"https://hackage.haskell.org/package/aeson\" rel=\"nofollow noreferrer\"><code>aeson</code></a>. Then you can do the usual transformations on that. The <code>lens</code> bit just makes it really nice to operate on nested data."}, {"owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478345306, "post_id": 40436978, "comment_id": 68122584, "body": "To map JSON on Haskell data I have to have that data structure beforehand. But I only read that structure from json file."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478346356, "post_id": 40436978, "comment_id": 68122901, "body": "Well if you don&#39;t even know that you can at least manipulate the parsed JSON structure (<a href=\"https://hackage.haskell.org/package/aeson-1.0.2.1/docs/Data-Aeson.html#t:Value\" rel=\"nofollow noreferrer\"><code>Value</code></a> in aeson)."}, {"owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478348163, "post_id": 40436978, "comment_id": 68123456, "body": "Yeah thats I can do only. To repeat pythons code in some cumbersome way... What I did expected from haskell is to porvide me with really nice and concise solutions for such a &quot;functional&quot; task. There are lots of examples out there with mindblowing haskel code doing really complicated stuff in couple of lines of code, deriving class instances on the fly for you etc. Maybe aeson-lenses suggested earlier is a way to go. I&#39;ll try to check."}, {"owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478348245, "post_id": 40436978, "comment_id": 68123471, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/127433/discussion-between-aliko-and-alec\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "is_accepted": true, "score": 0, "last_activity_date": 1479120400, "creation_date": 1479120400, "answer_id": 40586893, "question_id": 40436978, "link": "https://stackoverflow.com/questions/40436978/map-over-json-data-with-haskell/40586893#40586893", "title": "map over json data with haskell", "body": "<p>Well this is my solution.\nIt uses Control.Lens, Data.Aeson.Lens, Control.Lens.Plated</p>\n\n<p>One can use transform from Uniplate or Lens.Plated to transform values.</p>\n\n<p>for example to substitute each number with list of key values of length of that number:</p>\n\n<pre><code>n2k :: T.Text -&gt; Value -&gt; Value --import qualified Data.Text as T\nn2k s (Number x)\n  | isInteger x = case toBoundedInteger x of\n    Just n    -&gt; Array (V.replicate n (String s)) -- import qualified Data.Vector as V\n    _         -&gt; Number x\n  | otherwise =  Number x\nn2k _ v = v\n\nf (Object o) = Object $ imap n2k o --imap from Data.Map.Lens\nf x          = x\n\nj2 = transform f j --transform JSON j using function f\n</code></pre>\n\n<p>to substitute string with data with same key:</p>\n\n<pre><code>-- o is hashmap where we are looking for keys to substitute strings\nh (String s) = fromMaybe (String s) (H.lookup s o) --import qualified Data.HashMap.Lazy as H\nh x          = x\n\nj2 = transform h j \n</code></pre>\n\n<p>just get all numbers into list:</p>\n\n<pre><code>l = [x | Number x &lt;- universe j]\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 40586893, "answer_count": 1, "score": 0, "last_activity_date": 1479120400, "creation_date": 1478340605, "last_edit_date": 1478345232, "question_id": 40436978, "link": "https://stackoverflow.com/questions/40436978/map-over-json-data-with-haskell", "title": "map over json data with haskell", "body": "<p>I'm just learning a haskell and seems like all is good even scary monads are not a big deal for me. But I can't get to real practiacal stuff at all.</p>\n\n<p>My first practical task for haskell I choosed as follows:\nGiven a JSON describing some binary file's format to parse that file.</p>\n\n<p>JSON has some deeply nested structure with lists of assocoative lists (dictionaries) of lists etc with endpoints as numbers or strings.\nSo first of all I want to be able to map other those endpoints (to have functor class for jsons data) converting some strings to numbers in particular. Also it would be nice to be able to fold all those endpoints as well. </p>\n\n<p>I came up with some python code easily. But can't go any far with haskell.\nSo what your suggestions for implementing things in haskell? It really would be nice to hear some advise for solutions using libraries to greatest extent and not handwrite all the stuff from scratch.</p>\n\n<p>Thanks in advance!</p>\n\n<p>added---\nexample of what I have in python</p>\n\n<p>Some helper functions:</p>\n\n<pre><code>islist = lambda l: isinstance(l, collections.Iterable) and not isinstance(l, (str, bytes))\nisdict = lambda d: isinstance(d, collections.Mapping)\nisiter = lambda i: islist(i) or isdict(i)\n\ndef iterable(d):\n    if isdict(d):\n        i = d.items()\n    elif islist(d):\n        i = enumerate(d)\n    else:\n        raise ValueError\n    return i\n</code></pre>\n\n<p>Iterator over nested json data:</p>\n\n<pre><code>def nested_iter(nested, f = lambda *args: None):\n    for key, value in iterable(nested):\n        if not isiter(value):\n            f(nested, key)\n            yield key, value\n        else:\n            yield from nested_iter(value, f)\n</code></pre>\n\n<p>now I can substitute some numbers with lists of keys:</p>\n\n<pre><code>def list_from_num(d, k):\n    if type(d[k]) == int:\n        d[k] = [k]*d[k]\nlist(nested_iter(typedef, list_from_num))\n</code></pre>\n\n<p>or I can substitute some strings with some other nested data with the same key name</p>\n\n<pre><code>def nest_dicts(defs, d, k):\n    if d[k] in defs.keys():\n        d[k] = deepcopy(defs[d[k]])\n        if isiter(d[k]):\n            list(nested_iter(d[k], partial(nest_dicts, defs)))\nlist(nested_iter(typedef, partial(nest_dicts, typedef)))\n</code></pre>\n\n<p>or can just flatten data</p>\n\n<pre><code>list(nested_iter(d))\n</code></pre>\n\n<p>parsing binary is a bit more evolved but it is nothing more as passing to iterator one more function</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 0, "last_activity_date": 1478320766, "last_edit_date": 1478320766, "creation_date": 1478320368, "answer_id": 40434785, "question_id": 40434698, "link": "https://stackoverflow.com/questions/40434698/how-to-find-occurrences-of-char-in-an-input-string-in-haskell/40434785#40434785", "title": "How to find occurrences of char in an input string in Haskell", "body": "<p>you can use <code>elemIndex</code> to walk through the list, or simply write your own</p>\n\n<pre><code>indexOf x = map fst . filter (\\(_,s) -&gt; s==x) . zip [0..]\n\nindexOf 'a' \"haskell is hard\"\n[1,12]\n</code></pre>\n\n<p>or with <code>findIndices</code></p>\n\n<pre><code>import Data.List(findIndices)\nfindIndices (\\x -&gt; x=='a') \"haskell is hard\"\n[1,12]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7117853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa57d53c5a0666e10d66da9be3d1d730?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/7117853/diana"}, "edited": false, "score": 0, "creation_date": 1478321932, "post_id": 40434831, "comment_id": 68117770, "body": "Thanks a lot dreamcrash"}], "tags": [], "owner": {"reputation": 35454, "user_id": 1366871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3ec9d9128a25ba6eae8a1d42c2eb04a?s=128&d=identicon&r=PG", "display_name": "dreamcrash", "link": "https://stackoverflow.com/users/1366871/dreamcrash"}, "is_accepted": false, "score": 0, "last_activity_date": 1478320842, "creation_date": 1478320842, "answer_id": 40434831, "question_id": 40434698, "link": "https://stackoverflow.com/questions/40434698/how-to-find-occurrences-of-char-in-an-input-string-in-haskell/40434831#40434831", "title": "How to find occurrences of char in an input string in Haskell", "body": "<p>Here is a simpler but less sophisticated solution that the one post by karakfa:</p>\n\n<pre><code>stringCount :: String -&gt; Char -&gt; Integer -&gt; [Integer]\nstringCount [] c _ = []\nstringCount (x:xs) c pos | x == c = pos:(stringCount xs c (pos+1))\n                         | otherwise = stringCount xs c (pos+1)\n</code></pre>\n\n<p>The idea is that you go through the string char by char using recursion and then compare the actual caracter (head at the moment) with the char passed as argument. To keep track of the position I am using a counter called pos, and increment it for each recursion call.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7117853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa57d53c5a0666e10d66da9be3d1d730?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/7117853/diana"}, "edited": false, "score": 0, "creation_date": 1478321604, "post_id": 40434836, "comment_id": 68117737, "body": "Thanks a lot Michael Kohl and How can I do it with elemIndex ?"}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "reply_to_user": {"reputation": 1, "user_id": 7117853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa57d53c5a0666e10d66da9be3d1d730?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/7117853/diana"}, "edited": false, "score": 0, "creation_date": 1478332691, "post_id": 40434836, "comment_id": 68119513, "body": "Sorry, it&#39;s <code>elemIndices</code>, not <code>elemIndex</code> (the latter only gives you the index of the first occurrence only). <code>elemIndices &#39;a&#39; &quot;haskell is hard&quot;</code> gives you the desired result, so you&#39;d just have to flip argument order."}], "tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": true, "score": 2, "last_activity_date": 1478332838, "last_edit_date": 1478332838, "creation_date": 1478320883, "answer_id": 40434836, "question_id": 40434698, "link": "https://stackoverflow.com/questions/40434698/how-to-find-occurrences-of-char-in-an-input-string-in-haskell/40434836#40434836", "title": "How to find occurrences of char in an input string in Haskell", "body": "<p>There are many ways to do this, but since you mention you're a Haskell beginner, a list comprehension may be easiest to understand (I'm assuming this is homework, so you have to implement it yourself, not use <code>elemIndices</code>):</p>\n\n<pre><code>stringCount str ch = [ y | (x, y) &lt;- zip str [0..], x == ch ]\nstringCount \"haskell is hard\" 'a'\n-- [1,12]\nstringCount \"haskell is hard\" 'h'\n-- [0,11]\n</code></pre>\n\n<p>Here we <code>zip</code>, the string <code>str</code> with the infinite list starting from 0, producing the tuples <code>('h', 0), ('a', 1), ('s', 2)</code>, etc. We then only select the tuples where the character (bound to <code>x</code>) equals the argument <code>ch</code> and return the index (bound to <code>y</code>) for each of them.</p>\n\n<p>If you wanted to keep your current argument order but use <code>elementIndices</code> you can use the following:</p>\n\n<pre><code>stringCount' = flip elemIndices \nstringCount' \"haskell is hard\" 'h'\n-- [0,11]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7117853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa57d53c5a0666e10d66da9be3d1d730?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/7117853/diana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2615, "favorite_count": 0, "accepted_answer_id": 40434836, "answer_count": 3, "score": -5, "last_activity_date": 1478332838, "creation_date": 1478319351, "last_edit_date": 1478319833, "question_id": 40434698, "link": "https://stackoverflow.com/questions/40434698/how-to-find-occurrences-of-char-in-an-input-string-in-haskell", "title": "How to find occurrences of char in an input string in Haskell", "body": "<p>I am trying to write a function that will take a <code>String</code> and a <code>Char</code> and output the indexes where the char occurs in the string.</p>\n\n<pre><code>stringCount str ch = \nInput : \"haskell is hard\" `h`\nOutput:[0,11]\nInput : \"haskell is hard\" `a`\nOutput:[1,12]\n</code></pre>\n\n<p>Please help me I'm struggling to understand Haskell.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1478318988, "post_id": 40434603, "comment_id": 68117416, "body": "Is this a homework problem? What have you tried so far?"}, {"owner": {"reputation": 11, "user_id": 7115486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2c601c24e9e2a7179a6df2eba39fc4?s=128&d=identicon&r=PG&f=1", "display_name": "amanda", "link": "https://stackoverflow.com/users/7115486/amanda"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1478319223, "post_id": 40434603, "comment_id": 68117450, "body": "No I am not a student.I am getting lots of type errors . I am not understanding how to implement the logic."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1478319485, "post_id": 40434603, "comment_id": 68117479, "body": "I&#39;m voting to close this question as off-topic because you can&#39;t learn the bare basics of a new programming language by asking questions on SO. You should use a tutorial or textbook."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1478319520, "post_id": 40434603, "comment_id": 68117485, "body": "Lots of people like Learn You A Haskell."}, {"owner": {"reputation": 11, "user_id": 7115486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2c601c24e9e2a7179a6df2eba39fc4?s=128&d=identicon&r=PG&f=1", "display_name": "amanda", "link": "https://stackoverflow.com/users/7115486/amanda"}, "edited": false, "score": 0, "creation_date": 1478320558, "post_id": 40434603, "comment_id": 68117625, "body": "Can you please suggest me any good reference books for a beginner."}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 2, "creation_date": 1478326614, "post_id": 40434603, "comment_id": 68118449, "body": "Link: <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">learnyouahaskell.com/chapters</a>"}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 0, "last_activity_date": 1478319318, "creation_date": 1478319318, "answer_id": 40434692, "question_id": 40434603, "link": "https://stackoverflow.com/questions/40434603/how-to-find-sadsum-of-absolute-differences-in-list-haskell/40434692#40434692", "title": "How to find SAD(sum-of-absolute-differences) in list haskell", "body": "<p>Here are some hints, you can write the program almost translated from the spec</p>\n\n<p>differences in elements</p>\n\n<pre><code> diff xs = zipWith (-) xs $ tail xs\n</code></pre>\n\n<p>absolute value and sum functions are <code>abs</code> and <code>sum</code>.  To take the absolute value of all elements of a list, you need to <code>map</code></p>\n"}], "owner": {"reputation": 11, "user_id": 7115486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2c601c24e9e2a7179a6df2eba39fc4?s=128&d=identicon&r=PG&f=1", "display_name": "amanda", "link": "https://stackoverflow.com/users/7115486/amanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 40434692, "answer_count": 1, "score": -3, "last_activity_date": 1478319318, "creation_date": 1478318402, "last_edit_date": 1478319260, "question_id": 40434603, "link": "https://stackoverflow.com/questions/40434603/how-to-find-sadsum-of-absolute-differences-in-list-haskell", "title": "How to find SAD(sum-of-absolute-differences) in list haskell", "body": "<p>I need help in finding SAD between elements in a list using haskell.The program should take the a list of numbers and perform absolute difference and sum all of the absolute differences.</p>\n\n<pre><code>sumDiff:: Num a =&gt; [a] -&gt; a\nInput : sumDiff [1, 4, -6, 6]\nExpected output : 25\n</code></pre>\n\n<p>I am new to haskell and I dont know how to work with lists.Please help me :/</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1478317332, "post_id": 40434150, "comment_id": 68117254, "body": "Why do you want to rebuild the list?"}, {"owner": {"reputation": 75, "user_id": 5253667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/890e3bd77ad4732cbd662370a6e6fee8?s=128&d=identicon&r=PG&f=1", "display_name": "nav", "link": "https://stackoverflow.com/users/5253667/nav"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1478327838, "post_id": 40434150, "comment_id": 68118648, "body": "It was just an example to illustrate what I was asking for, it was the first thing that came to my head."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1478328503, "post_id": 40434150, "comment_id": 68118777, "body": "Does rebuilding a list seem fundamental to the problem you are working on though? I ask because the compiler often just eliminates any &quot;rebuilding&quot; of a structure like a list and just uses the original list instead of building a new one. It can do this because of immutability. So, you would probably have to find a way to trick the optimizer to get it to rebuild a list. Also, because of immutability, there really isn&#39;t a reason to ever rebuild a list in the first place so you might have some misconceptions about how you are approaching the implementation of the solution to your problem."}, {"owner": {"reputation": 75, "user_id": 5253667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/890e3bd77ad4732cbd662370a6e6fee8?s=128&d=identicon&r=PG&f=1", "display_name": "nav", "link": "https://stackoverflow.com/users/5253667/nav"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1478329644, "post_id": 40434150, "comment_id": 68118976, "body": "No, there&#39;s no rebuilding.  To be specific, I&#39;m working on a school assignment involving simple  non deterministic finite state machines where most of the stuff is supposed to be defined recursively.  Some of the results have duplicates which don&#39;t provide any value and so need to be removed with nub from Data.List."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 4, "last_activity_date": 1478313176, "creation_date": 1478313176, "answer_id": 40434200, "question_id": 40434150, "link": "https://stackoverflow.com/questions/40434150/applying-a-function-to-a-recursively-built-list-within-the-definition-of-the-rec/40434200#40434200", "title": "Applying a function to a recursively built list within the definition of the recursive function in haskell", "body": "<p>delegate the recursion to the worker function and call sort at the top level</p>\n\n<pre><code>import Data.List(sort)\n\nrbsort :: [Int] -&gt; [Int]\nrbsort = sort . go\n     where go [] = []\n           go (x:xs) = x: go xs  -- here you should be doing something useful\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5253667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/890e3bd77ad4732cbd662370a6e6fee8?s=128&d=identicon&r=PG&f=1", "display_name": "nav", "link": "https://stackoverflow.com/users/5253667/nav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 40434200, "answer_count": 1, "score": 0, "last_activity_date": 1478313176, "creation_date": 1478312511, "question_id": 40434150, "link": "https://stackoverflow.com/questions/40434150/applying-a-function-to-a-recursively-built-list-within-the-definition-of-the-rec", "title": "Applying a function to a recursively built list within the definition of the recursive function in haskell", "body": "<p>This isn't a great example, but easy enough to get across what I'm asking.  Say I want to rebuild a list recursively and then apply the sort function to it after the list has been built.  Here's one implementation that gets the right answer, but not the way I'd like.</p>\n\n<pre><code>import Data.List\nrebuild_and_sort :: [Int] -&gt; [Int]\nrebuild_and_sort [] = []\nrebuild_and_sort (b:bs) = sort (b:rebuild_and_sort bs)\n</code></pre>\n\n<p>The problem is that sort would be called for every element in the argument list.  Is there some way to make it so that sort would only be called once after the list has been fully reconstructed without changing the arguments needed?</p>\n"}, {"tags": ["haskell", "lisp", "late-binding"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1478336069, "post_id": 40433535, "comment_id": 68120216, "body": "That is <i>not</i> late binding... Late binding is about <i>scope</i>. Consider <code>function h() {function f() {[this]}; function g() {f();}; return g;}</code> late binding means that if you do <code>function f() {[other]}; g = h(); g()</code> the call to <code>g</code> will call the function <code>f</code> with <code>[other]</code> instead of the one with <code>[this]</code>."}, {"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1478337289, "post_id": 40433535, "comment_id": 68120491, "body": "@Bakuriu You&#39;re thinking of <a href=\"https://en.wikipedia.org/wiki/Scope_(computer_science)#Dynamic_scoping\" rel=\"nofollow noreferrer\"><i>dynamic</i> scoping</a> which is sometimes called &quot;late binding&quot;.  &quot;Late binding&quot; <a href=\"https://en.wikipedia.org/wiki/Late_binding\" rel=\"nofollow noreferrer\">has other meanings</a>, for example, it&#39;s sometimes used for <a href=\"https://en.wikipedia.org/wiki/Dynamic_dispatch\" rel=\"nofollow noreferrer\">dynamic dispatch</a>.  It&#39;s ultimately a bit of an ambiguous and amorphous term vaguely referring to techniques that delay when decisions need to be made, which includes dynamic scoping."}], "answers": [{"comments": [{"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 6, "creation_date": 1478307762, "post_id": 40433630, "comment_id": 68115927, "body": "The repeated let binding thing isn&#39;t even really a side effect, it&#39;s not limited to (or related to) <code>IO</code>, and it&#39;s not late binding. Anything <i>else</i> you defined that used the name <code>a</code> before still refers to <code>+</code>. All you&#39;ve done is declare a <i>new</i> variable with a new scope. Since it has the same name as an existing variable in an outer score, it shadows the first definition and makes it impossible to refer to in the new scope. But it hasn&#39;t changed the earlier definition in any way. You can do this with <code>let ... in</code> in pure non-monadic expressions (or anything else that binds a name)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1478308231, "post_id": 40433630, "comment_id": 68116013, "body": "To see why this is not late binding, try <code>let a = 1; let x = a; let a = 2; print x</code>. This will produce the output <code>1</code> (as expected from lexical scoping), not <code>2</code> (as would be expected if late-binding allowed <code>a</code> to be actually modified). (And indeed it has nothing to do with <code>IO</code>: <code>let ... in ...</code> is an expression that is by no means restricted to having a type with <code>IO</code> in it.)"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1478306365, "creation_date": 1478306365, "answer_id": 40433630, "question_id": 40433535, "link": "https://stackoverflow.com/questions/40433535/does-haskell-have-something-analogous-to-late-binding-or-can-we-change-the-def/40433630#40433630", "title": "Does Haskell have Something Analogous to Late Binding (or, can we change the definition of functions of an ongoing Haskell program)?", "body": "<p>To my knowledge haskell cannot support this unless you count wrapping this function in a IO or state monad.</p>\n\n<p>But in a pure program reassigning the definition of <code>func</code> would break referential transparency - which is one of the things that makes haskell such a safe language. Furthermore breaking referential transparency would make lazy evaluation impossible, because evaluating a function - before or after the update would yield two different results and make the program non-deterministic.</p>\n\n<p>Now if you look into <code>GHCi</code>, then you see that you can reassign variables - if you try out</p>\n\n<pre><code>$ &gt; ghci\n...\nPrelude &gt; let a = (+)\nPrelude &gt; let a = (*)\n</code></pre>\n\n<p>is valid, but this <code>let</code> binding lives in <code>IO</code> I believe - which allows for having side effects like reassigning.</p>\n"}, {"tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": false, "score": 7, "last_activity_date": 1478336848, "last_edit_date": 1478336848, "creation_date": 1478336475, "answer_id": 40436435, "question_id": 40433535, "link": "https://stackoverflow.com/questions/40433535/does-haskell-have-something-analogous-to-late-binding-or-can-we-change-the-def/40436435#40436435", "title": "Does Haskell have Something Analogous to Late Binding (or, can we change the definition of functions of an ongoing Haskell program)?", "body": "<p>A good way to understand declarative programming is to think of it as being timeless.  So there is no \"the next time the program makes a call to <code>func</code>\".  If the program behaved different the \"next time\" in some low-level, operational sense, this would be a violation of purity.  Keeping our FP colored lenses firmly in place as we step outside of the program, we note that you can't \"change the definition of <code>func</code>\", instead what you are doing is making a new program with a different definition of <code>func</code>.  So really what you are talking about doing when you \"change the definition of <code>func</code>\" is abandoning the current program and running a new one.  There are Haskell libraries that work just this way such as <a href=\"https://hackage.haskell.org/package/halive\" rel=\"noreferrer\">halive</a> and <a href=\"http://hackage.haskell.org/package/dyre\" rel=\"noreferrer\">dyre</a>. </p>\n\n<p>The <code>IO</code> monad does let us model a \"before\" and \"after\", so within it, we can talk about \"changing\" something.  Changing \"the\" program still has the same concerns as above, but we can certainly have a reference cell that holds a bunch of code that we update.  Effectively, this is what's happening in (naive implementations of) Lisp.  You can actually do this manually, e.g. define an <code>IORef</code> or <code>MVar</code> holding the function you want to change and updating it as appropriate.  Now the problem is you usually want to update to brand new functions, so we need to either have a way to describe new functions or to load functions on the fly.  The former corresponds to having an interpreter available which nominally is what <a href=\"http://hackage.haskell.org/package/hint\" rel=\"noreferrer\">hint</a> and <a href=\"https://hackage.haskell.org/package/mueval\" rel=\"noreferrer\">mueval</a> do (though they actually work more like the following).  Doing the latter is dynamic code loading and libraries like <a href=\"http://hackage.haskell.org/package/plugins\" rel=\"noreferrer\">plugins</a>, <a href=\"http://hackage.haskell.org/package/rts-loader\" rel=\"noreferrer\">rts-loader</a>, and <a href=\"http://hackage.haskell.org/package/dynamic-loader\" rel=\"noreferrer\">dynamic-loader</a> do this.</p>\n\n<p>Alternatively, you can take the view (or actually structure it so) that parts of your code are running as a coprocess.  At this point, you can use standard IPC mechanisms.  \"Calling a function\" in this context would merely mean sending a message.</p>\n\n<p>Ultimately, none of these provide an experience like a Lisp.  The Haskell language itself provides no mechanism or notion of a \"place\" where a definition is \"stored\" that could then be updated.  Again, conceptually in a Lisp, every definition is stored in a mutable cell and every function call first dereferences that mutable cell to get the current definition.  The upshot is every library and technique I've mentioned requires you to plan ahead of time where the change points are or what you want to reload or, at the very least, <em>that</em> you want to reload.  There is no notion of \"attaching\" to a running Haskell process or \"breaking\" into a debugger.  Technically, though, with the technique dyre uses you could relaunch into an executable written in a totally different language, let alone an arbitrarily changed Haskell executable.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1478336848, "creation_date": 1478305612, "question_id": 40433535, "link": "https://stackoverflow.com/questions/40433535/does-haskell-have-something-analogous-to-late-binding-or-can-we-change-the-def", "title": "Does Haskell have Something Analogous to Late Binding (or, can we change the definition of functions of an ongoing Haskell program)?", "body": "<p>AFAIK, this is a hallmark feature of LISP dialects: For example, suppose we launch an ongoing LISP program that makes repeated calls to some function named <code>func</code>.  We are then able to go inside the lisp REPL, change the definition of <code>func</code>, and then the next time the program makes a call to <code>func</code>, the behavior of the program will be appropriately changed live.</p>\n\n<p>I believe this property is called <strong>late binding</strong>, although I'm not sure if I'm correct.</p>\n\n<p>The benefit of late binding is that it allows you refactor or even completely change a program while it is still running.  This \u0456s analogous in biology to the fact that, as we age, almost every cell in our body gets replaced by a new one over a long enough time horizon (but of course we never notice). It can make systems incredibly flexible.</p>\n\n<p><strong>Question:</strong> Is there any way to do something analogously in Haskell? If Haskell doesn't allow this, is there a good reason for it to (i.e., is it making some greater trade-off that makes it all worth it)?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "higher-order-functions"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1478304914, "post_id": 40433425, "comment_id": 68115353, "body": "Questions asking for homework help must include a summary of the work you&#39;ve done so far to solve the problem, and a description of the difficulty you are having solving it. <a href=\"http://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a>"}, {"owner": {"reputation": 57819, "user_id": 1615483, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7962ef5ee5f1f24fd3da8b068a73ba4a?s=128&d=identicon&r=PG", "display_name": "Paul S.", "link": "https://stackoverflow.com/users/1615483/paul-s"}, "edited": false, "score": 1, "creation_date": 1478305003, "post_id": 40433425, "comment_id": 68115367, "body": "Break down the problem; a, what is the minimum value in a list? b, given a value, what is it&#39;s index in a list? c, given an index in a list, how can you create another list with everything except the item at that index?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478316521, "post_id": 40433425, "comment_id": 68117142, "body": "The function you&#39;re writing isn&#39;t the insertion <i>sort</i> but rather the <i>insertion</i>. You should probably call it <code>insert</code>."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1478308322, "last_edit_date": 1478308322, "creation_date": 1478305377, "answer_id": 40433515, "question_id": 40433425, "link": "https://stackoverflow.com/questions/40433425/write-a-recursive-function-that-adds-elements-in-ascending-order/40433515#40433515", "title": "write a recursive function that adds elements in ascending order", "body": "<p>Since this may be homework I'll just give hints. Start with the signature</p>\n\n<pre><code>isort :: Ord  a =&gt;  [a] -&gt; a -&gt; [a]\n</code></pre>\n\n<p>base case is trivial</p>\n\n<pre><code>isort [] x = [x]\n</code></pre>\n\n<p>the recursive case</p>\n\n<pre><code>isort (x:xs) y | y &lt;= x =    -- what should happen here since it's at right place\n               | otherwise = -- or here, when it's not?\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7117463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29032f7489ff2539bc469771eea157e4?s=128&d=identicon&r=PG&f=1", "display_name": "Nazim Gul", "link": "https://stackoverflow.com/users/7117463/nazim-gul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1479884015, "answer_count": 1, "score": -2, "last_activity_date": 1478376716, "creation_date": 1478304702, "last_edit_date": 1478376716, "question_id": 40433425, "link": "https://stackoverflow.com/questions/40433425/write-a-recursive-function-that-adds-elements-in-ascending-order", "closed_reason": "Needs more focus", "title": "write a recursive function that adds elements in ascending order", "body": "<p>I have to write the recursive function insertSort. Given a list of\ntype x and an element of type x insert the element into the list such\nthat the list is in ascending order. Duplicates are allowed. The input\nlist will be properly sorted.</p>\n\n<p>expected output:</p>\n\n<pre><code> insertSort [] 3 -&gt; [3]\n    insertSort \"btt\" \u2019u\u2019 -&gt; \"bttu\"\n    foldl insertSort [] [] -&gt; []\n    foldl insertSort [] [3,1,5,5,3,0,1,8,4] -&gt;\n    [0,1,1,3,3,4,5,5,8]\n</code></pre>\n\n<p>I'm new in haskell.I know how to add element but I don't know how to add in ascending order.Please someone help me</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478306164, "post_id": 40433370, "comment_id": 68115620, "body": "Wild guess: would <code>system-ghc: true</code> and <code>resolver: ghc-8.0.1</code> (or whatever the relevant version is) work? Otherwise, it sounds very unlikely."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 2, "creation_date": 1478348662, "post_id": 40433370, "comment_id": 68123583, "body": "There&#39;s <a href=\"https://github.com/commercialhaskell/stack/issues/1594\" rel=\"nofollow noreferrer\">an open issue to add a <code>--offline</code> flag</a>, which sounds like what you would like to have. As a workaround I&#39;d suggest wrapping the stack command in some kind of script that prevents it from accessing the network."}], "owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1478304241, "creation_date": 1478304241, "question_id": 40433370, "link": "https://stackoverflow.com/questions/40433370/how-can-i-force-stack-haskell-stack-to-never-download-anything", "title": "how can I force stack (haskell-stack) to never download anything?", "body": "<p>my workflow uses <code>system-ghc: true</code> exclusively. I want stack to fail hard anytime it would otherwise access the network to download anything. Is this possible to configure (either globally or per project would do)?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "higher-order-functions"], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1478305689, "creation_date": 1478305689, "answer_id": 40433546, "question_id": 40433222, "link": "https://stackoverflow.com/questions/40433222/write-the-recursive-function-adjuster/40433546#40433546", "title": "Write the recursive function adjuster", "body": "<p>You are trying to construct a list within lists within lists and so on and so forth \u2026</p>\n\n<h2>Why is this?</h2>\n\n<pre><code>(:) :: a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>The colon operator takes an element and a list of such elements as an argument and constructs a list from that (by prepending that element).</p>\n\n<p>In your case if <code>(adjuster ...)</code> had type <code>[a]</code> then <code>b</code> must be of type <code>[[a]]</code>, by line 4 which is the same as the end result, but line 3 says the type is <code>[a]</code> - which is different. This is what GHC tries to tell you.</p>\n\n<h2>How to fix it?</h2>\n\n<p>First of all, it is always a good advice to add a type signature to every top level function:</p>\n\n<pre><code>adjuster :: [a] -&gt; Int -&gt; a -&gt; [a]\n</code></pre>\n\n<p>which should clean up your error-message and keep you honest, when implementing your function.</p>\n\n<p>So how to fix this: - you could use <code>b:adjuster xs (count-1) b</code> but this would yield a result in the wrong order - so</p>\n\n<p>choose a different operator: <code>(++)</code> and wrap the <code>b</code> inside a list.</p>\n\n<pre><code>    | otherwise             = (adjuster xs (count-1) b)++[b]\n</code></pre>\n\n<p>Now a few more hints:</p>\n\n<ul>\n<li>turn on <code>-Wall</code> when you compile your file - this will show you that you missed the case of <code>adjuster [] ..</code>.</li>\n<li>using <code>length</code> is a relatively expensive operation - as it needs to traverse the full list to be calculated.</li>\n<li>As an exercise - try to modify your function to not use <code>length</code> but only work with the base cases <code>[]</code> for list and <code>0</code> for <code>count</code> (here the function <code>replicate</code> might be helpful).</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 0, "last_activity_date": 1478353115, "last_edit_date": 1478353115, "creation_date": 1478315296, "answer_id": 40434357, "question_id": 40433222, "link": "https://stackoverflow.com/questions/40433222/write-the-recursive-function-adjuster/40434357#40434357", "title": "Write the recursive function adjuster", "body": "<p>Here is another approach, without error handling</p>\n\n<pre><code>adjuster xs n v = tnr n $ (++) (replicate n v) $ tnr n xs\n      where tnr n r = take n $ reverse r\n</code></pre>\n\n<p>if you play with the signature, perhaps cleaner this way</p>\n\n<pre><code>adjuster n v = tnr . (++) (replicate n v) . tnr\n             where tnr = take n . reverse\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7117402, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9defe9d5ff11d790b92c34b306312c2c?s=128&d=identicon&r=PG&f=1", "display_name": "Haga Dhorse", "link": "https://stackoverflow.com/users/7117402/haga-dhorse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "accepted_answer_id": 40434357, "answer_count": 2, "score": 1, "last_activity_date": 1478353115, "creation_date": 1478303038, "last_edit_date": 1478303346, "question_id": 40433222, "link": "https://stackoverflow.com/questions/40433222/write-the-recursive-function-adjuster", "title": "Write the recursive function adjuster", "body": "<p>Write the recursive function adjuster. Given a list of type\nx, an int and an element of type x, either remove from the front of the\nlist until it is the same length as int, or append to the end of the list\nuntil it is the same length as the value specified by the int.</p>\n\n<p>expected:</p>\n\n<pre><code>adjuster [1..10] (-2) 2 -&gt; *** Exception: Invalid Size\nadjuster [1..10] 0 2 -&gt; []\nadjuster \"apple\" 10 \u2019b\u2019 -&gt; \"applebbbbb\"\nadjuster \"apple\" 5 \u2019b\u2019 -&gt; \"apple\"\nadjuster \"apple\" 2 \u2019b\u2019 -&gt; \"le\"\nadjuster [] 3 (7,4) -&gt; [(7,4),(7,4),(7,4)]\n</code></pre>\n\n<p>What i did:</p>\n\n<pre><code>adjuster (x:xs) count b \n        | count &lt; 0             = error \"Invalid Size\"\n        | count == 0            = []\n        | count &lt; length xs     = adjuster xs (count-1) b\n        | otherwise             = (adjuster xs (count-1) b):b\n</code></pre>\n\n<p>the error that I'm getting:</p>\n\n<pre><code> * Occurs check: cannot construct the infinite type: t ~ [t]\n      Expected type: [t]\n        Actual type: [[t]]\n    * In the expression: (adjuster xs (count - 1) b) : b\n      In an equation for `adjuster':\n          adjuster (x : xs) count b\n            | count &lt; 0 = error \"Invalid Size\"\n            | count == 0 = []\n            | count &lt; length xs = adjuster xs (count - 1) b\n            | otherwise = (adjuster xs (count - 1) b) : b\n    * Relevant bindings include\n        b :: [[t]] (bound at code01.hs:21:23)\n        adjuster :: [a] -&gt; Int -&gt; [[t]] -&gt; [t] (bound at code01.hs:21:1)\n</code></pre>\n\n<p>I'm new in haskell.I'll really appreciate some help.</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1478300338, "post_id": 40432743, "comment_id": 68114201, "body": "Have you tried breaking the problem up into smaller pieces? Where exactly are you having trouble? I assume this is homework, but in real life if you encountered this problem you would first consider whether <code>Set</code> or some other data structure is more appropriate"}, {"owner": {"reputation": 71, "user_id": 6904246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a599e1abb05cda9aa32f22d485b2409?s=128&d=identicon&r=PG&f=1", "display_name": "Henk", "link": "https://stackoverflow.com/users/6904246/henk"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1478303298, "post_id": 40432743, "comment_id": 68114985, "body": "This actually already is broken down of what i actually want. I&#39;m finding it hard as how you need to loop with one list over the other and then return a [Integer] list. I often end up getting a [[Integer]] list where I only removed one element per list. Haven&#39;t used any other data structures in Haskell besides lists and tupels, i&#39;ll have a look and see of any work better, thanks for the tip."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1478370351, "post_id": 40432743, "comment_id": 68130094, "body": "Here&#39;s an example of what I mean about breaking the problem into smaller pieces for your example: you might define the following functions: <code>unionLists :: [Int] -&gt; [Int] -&gt; [Int]</code> (this returns the elements in common between two lists), <code>delete :: Int -&gt; [Int] -&gt; [Int]</code> (which returns a list with the element you passed as the first parameter removed). Then if you have trouble defining <code>unionLists</code> in one go, you might break that down further into <code>elem :: Int -&gt; [Int] -&gt; Bool</code> and <code>filter</code>, or perhaps <code>merge</code> and <code>sort</code> if you&#39;re feeling clever."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1478302944, "post_id": 40432822, "comment_id": 68114884, "body": "<code>Data.Foldable.notElem</code> and sections make this a bit cleaner: <code>(`notElem` b)</code> vs. <code>not . flip elem b</code>."}, {"owner": {"reputation": 71, "user_id": 6904246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a599e1abb05cda9aa32f22d485b2409?s=128&d=identicon&r=PG&f=1", "display_name": "Henk", "link": "https://stackoverflow.com/users/6904246/henk"}, "edited": false, "score": 1, "creation_date": 1478303808, "post_id": 40432822, "comment_id": 68115108, "body": "What exactly does flip do? According to hoogle its type is ` (a\u2192 b \u2192 c) \u2192 (b \u2192 a \u2192c) ` would ` (not.flip (elem) b) ` then not be the same as  ` ( not . b (elem)) ` ?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 71, "user_id": 6904246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a599e1abb05cda9aa32f22d485b2409?s=128&d=identicon&r=PG&f=1", "display_name": "Henk", "link": "https://stackoverflow.com/users/6904246/henk"}, "edited": false, "score": 2, "creation_date": 1478307971, "post_id": 40432822, "comment_id": 68115961, "body": "@Henk No, <code>flip</code> flips the arguments of a function. So, for instance, <code>flip elem x y</code> is the same as <code>elem y x</code>."}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": true, "score": 1, "last_activity_date": 1478303153, "last_edit_date": 1478303153, "creation_date": 1478300277, "answer_id": 40432822, "question_id": 40432743, "link": "https://stackoverflow.com/questions/40432743/remove-commen-elements-from-two-lists/40432822#40432822", "title": "Remove commen elements from two lists", "body": "<p>You could filter the lists with with the predicate <code>not.flip (elem)</code>:</p>\n\n<pre><code>f :: Eq a =&gt; [a] -&gt; [a] -&gt; ([a],[a])\nf a b = (filter (not.flip (elem) b) a,filter (not.flip(elem) a) b)\n</code></pre>\n\n<p>If we import <code>Data.Foldable</code>, we can use <code>nonElem</code> to simplify this a bit further:</p>\n\n<pre><code>f a b = (filter (`notElem` b) a,filter (`notElem` a) b)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6904246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a599e1abb05cda9aa32f22d485b2409?s=128&d=identicon&r=PG&f=1", "display_name": "Henk", "link": "https://stackoverflow.com/users/6904246/henk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 40432822, "answer_count": 1, "score": -3, "last_activity_date": 1478303153, "creation_date": 1478299592, "question_id": 40432743, "link": "https://stackoverflow.com/questions/40432743/remove-commen-elements-from-two-lists", "title": "Remove commen elements from two lists", "body": "<p>I'm trying to make a function that, given two lists, removes from both lists the elements they have in commen. I've been breaking My Head over this but I haven't been able to come up with a decent solution.</p>\n\n<p>For example, given:</p>\n\n<pre><code>` let a = [1,2,3,4,5] `\n` let b = [1,3,5,7,9] `\n` f a b `\n</code></pre>\n\n<p>Then f should return something like:</p>\n\n<pre><code>` ( [2,4], [7,9] ) `\n</code></pre>\n"}, {"tags": ["haskell", "polymorphism", "type-inference", "type-systems"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1478299807, "post_id": 40432690, "comment_id": 68114059, "body": "&quot;why it doesn&#39;t work as expected by intuition?&quot; -- The million dollar question here is: <i>which</i> intuition? (Fortunately, it is not at all necessary to formally understand Hindley-Milner to get comfortable with your examples. Perhaps it is more a question of getting rid of some preconceptions, as I predict the forthcoming answers will demonstrate.)"}, {"owner": {"reputation": 1251, "user_id": 3973371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb6b82669e037ed73e47d6532ef2c246?s=128&d=identicon&r=PG&f=1", "display_name": "bmaderbacher", "link": "https://stackoverflow.com/users/3973371/bmaderbacher"}, "edited": false, "score": 6, "creation_date": 1478299957, "post_id": 40432690, "comment_id": 68114100, "body": "Your confusion seems to be with type classes and not so much with Hindley-Milner."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1478302199, "post_id": 40432690, "comment_id": 68114687, "body": "I have a super-secret type, an instance of <code>Num</code>, called <code>TomsAwesomeNumType</code>.  Your <code>f3</code> type signature says that, despite not knowing anything else about my type, you can convert it to an <code>Int</code>.  Your <code>f4</code> signature says that despite this lack of knowledge you can convert any <code>Int</code> to my super secret type (or any other type that is an instance of Num).  Your implementations, on the other hand, are another issue I&#39;ll leave to whomever answers."}, {"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 0, "creation_date": 1478304286, "post_id": 40432690, "comment_id": 68115206, "body": "From OOP&#39;s perspective let&#39;s take <code>Java</code> to compare <code>f2</code>. Assuming <code>Number x2 = new Integer(1);</code>, <code>f2(x2)</code> won&#39;t work straightly; instead, we have to explicitly subcast <code>x2</code> then <code>f2((Integer)x2)</code> does. This kind of discrepancy makes me wonder how the type system on <code>Haskell</code> rolls, thus <code>Typeclass</code> and <code>HM</code> etc."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478304714, "post_id": 40432690, "comment_id": 68115301, "body": "The key point is that it rolls in a very different way from OOP. Hopefully my answer will help to clarify that."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1478304716, "post_id": 40432690, "comment_id": 68115302, "body": "The closest Java concept is generic methods. <code>f1 :: Num a =&gt; a -&gt; a</code> could something like <code>&lt;A extends Num&gt; A f1(A a1, A a2)</code> where <code>Num</code> is some interface. Crucially, in Haskell you can never have a variable of type <code>Num</code> since that&#39;s not a type in Haskell, unlike Java. In Haskell, you can use <code>Num a</code> only to constrain universal quantification like the Java <code>&lt;A extends Num&gt;</code>."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1478305452, "post_id": 40432690, "comment_id": 68115451, "body": "@chi: It would be just <code>&lt;A extends Num&gt; A f1(A)</code>, but your point stands."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1478305689, "post_id": 40432690, "comment_id": 68115502, "body": "@JonPurdy Oops. Right, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 4, "creation_date": 1478306960, "post_id": 40433403, "comment_id": 68115771, "body": "Thanks for the thorough answer. Not only does it help clarify this very puzzle but also conveys the keywords such as <code>polymorphic, constraint, typeclass, typevar, monomorphic, instance, type, specializing, unification</code> that shed light on my further quest for knowing the type system on Haskell better."}, {"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 1, "creation_date": 1478313025, "post_id": 40433403, "comment_id": 68116730, "body": "One follow-up question, a monomorphic typed value is trival to define, e.g. <code>data Ordering = LT | EQ | GT</code>; how is a polymorphic typed value defined such as the number  <code>1</code>?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 4, "creation_date": 1478319154, "post_id": 40433403, "comment_id": 68117438, "body": "@sof [1/2] A typical polymorphic (algebraic) data type can be defined much in the same manner. In <code>data Maybe a = Nothing | Just a</code>, the <code>Just</code> constructor can be used to wrap a value of arbitrary type. <code>Maybe</code> on its own is an example of a <i>type constructor</i>, because it makes a different type out of an existing one (e.g. from <code>Int</code> to <code>Maybe Int</code>)."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 4, "creation_date": 1478319164, "post_id": 40433403, "comment_id": 68117442, "body": "@sof [2/2] Numbers are different, though. The trick is that, for instance, <code>1</code> actually stands for <code>fromInteger (1 :: Integer)</code>. <code>Integer</code> is used as a &quot;default&quot; type for integer literals, and <code>fromInteger</code> (which is a method of <code>Num</code>) is used to convert to the appropriate type. That is specified by <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch6.html#x13-1350006.4\" rel=\"nofollow noreferrer\">Section 6.4.1 of the Haskell Report</a>. As for what <code>Integer, </code>Double`, etc. are under the hood, implementations are free to use whatever is convenient/efficient as long as it meets the Report spec."}, {"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 0, "creation_date": 1478364230, "post_id": 40433403, "comment_id": 68128199, "body": "thanks. I can follow your comment [1/2] that described the so called <code>parametric polymorphic</code> typed value. [2/2] is about <code>ad-hoc polymorphic</code> aka <code>overloading</code>, right? Does it mean that the numeric literal <code>1</code> is recognized thus translated into <code>fromInteger (1 :: Integer)</code> by the compiler? Are overloaded values restricted in built-in constructs? How to make a user defined version if allowed too?  Sorry for the lengthy follow-ups, hopefully they will complement your applauded answer perfectly."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 4, "creation_date": 1478371441, "post_id": 40433403, "comment_id": 68130468, "body": "@sof Adding more polymorphic literal constructs is a matter for language extensions (for instance, <code>OverloadedStrings</code> is a commonly used GHC extension, and there is also <code>OverloadedLists</code>), though there is always the option of simulating a syntax extension through Template Haskell (i.e. compile-time meta programming). (In any case, if you have a <code>Foo</code> type that you have defined and a function <code>fromFoo :: FooLike a =&gt; Foo -&gt; a</code>, you can use <code>fromFoo</code> for overloaded creation of values, and only the syntactical convenience of the literals would be missing in comparison with the <code>Num</code> example.)"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 17, "last_activity_date": 1478381472, "last_edit_date": 1478381472, "creation_date": 1478304596, "answer_id": 40433403, "question_id": 40432690, "link": "https://stackoverflow.com/questions/40432690/how-to-comfortably-deal-with-the-type-system-on-haskell/40433403#40433403", "title": "How to comfortably deal with the type system on Haskell?", "body": "<blockquote>\n  <p>why can't <code>Int</code> be converted to <code>Num</code> on <code>x3</code></p>\n</blockquote>\n\n<ol>\n<li><p><code>Int</code> cannot be converted to <code>Num</code> because <code>Int</code> is a type and <code>Num</code> is a <em>type class</em>. The difference between these two kinds of entities will hopefully become clear in what follows.</p></li>\n<li><p><code>Int</code> cannot be converted to anything else because Haskell has no conversions in the sense you are using here. There are no implicit casts. What does happen is a polymorphic type getting <em>specialised</em> to some definite type; however, a definite type never becomes something else automatically.</p></li>\n</ol>\n\n\n\n<p>With that in mind, let's consider your examples.</p>\n\n<pre><code>Prelude&gt; let x1 = 1\nPrelude&gt; :t x1\nx1 :: Num a =&gt; a\n</code></pre>\n\n<p><code>x1</code> here is <em>polymorphic</em>, which means it can assume different types depending on how you use it. This indeterminacy can be recognised by the presence of the type variable <code>a</code> (type variables, unlike concrete types, are not capitalised). The type of <code>x1</code>, though polymorphic, is to some extent restricted by the <em>constraint</em> <code>Num a</code>. <code>Num a =&gt; a</code> can be read as \"any type that has an instance of the <em>type class</em> <code>Num</code>\", while a plain <code>a</code> would mean \"any type whatsoever\". </p>\n\n<pre><code>Prelude&gt; let x2 = 1 :: Int\nPrelude&gt; :t x2\nx2 :: Int\n</code></pre>\n\n<p>Introducing the type annotation <code>:: Int</code> means requesting <code>Int</code> to be <em>unified</em> with the type of <code>1</code>, <code>Num a =&gt; a</code>. In this case, that simply means replacing the type variable <code>a</code> with <code>Int</code>. Given that <code>Int</code> does have an instance of <code>Num</code>, that is a valid move, and the type checker happily accepts it. The type annotation <em>specialises</em> the polymorphic type of <code>1</code> to <code>Int</code>.</p>\n\n<pre><code>Prelude&gt; let x3 = (1 :: Int) :: Num a =&gt; a\nCouldn't match expected type \u2018a1\u2019 with actual type \u2018Int\u2019\n</code></pre>\n\n<p>The type of <code>1 :: Int</code> is <code>Int</code>. The second annotation demands unifying it with <code>Num a =&gt; a</code>. That, however, is impossible. Once a type is specialised, you can't \"forget\" the type and revert the specialisation just by providing a type annotation. Perhaps you are thinking of OOP upcasting; this is not at all the same thing. By the way, if the type checker accepted <code>x3</code>, you would be able to write <code>x4 = ((1 :: Int) :: Num a =&gt; a) :: Double</code>, thus converting an <code>Int</code> to a <code>Double</code>. In the general case, though, there is no way this conversion can happen like that, as you didn't tell <em>how</em> the conversion is to be done; as for the special cases, there aren't any. (Converting an <code>Int</code> to a <code>Double</code> is certainly possible, but it requires an appropriate function. For instance, you may find it relevant to consider how the type of <code>fromIntegral</code> relates to what it does.)</p>\n\n<pre><code>Prelude&gt; let f1 :: Num a =&gt; a -&gt; a; f1 = id\nPrelude&gt; :t f1 (1 :: Int)\nf1 (1 :: Int) :: Int\n</code></pre>\n\n<p>The principles here remain the same. The only difference is that you have to consider how the types of argument and result are related to each other. The type of <code>id</code> is <code>a -&gt; a</code>. It specialises just fine to <code>Num a =&gt; a -&gt; a</code>. Passing an <code>Int</code> argument further specialises it to <code>Int -&gt; Int</code>, and so you get a result of type <code>Int</code>.</p>\n\n<pre><code>Prelude&gt; let f2 :: Int -&gt; Int; f2 = id\nPrelude&gt; :t f2 1\nf2 1 :: Int\n</code></pre>\n\n<p><code>f1</code> had a polymorphic type that you specialised by feeding it an <code>Int</code> argument, while <code>f2</code> has a monomorphic type, and so there is no need to specialise it. <code>id</code> is specialised from <code>a -&gt; a</code> directly to <code>Int -&gt; Int</code>, while <code>1</code> is specialised from <code>Num a =&gt; a</code> to <code>Int</code> because you are feeding it to a function that expects an <code>Int</code> argument.</p>\n\n<pre><code>Prelude&gt; let f3 :: Num a =&gt; a -&gt; Int; f3 = id\nCouldn't match type \u2018a\u2019 with \u2018Int\u2019\n</code></pre>\n\n<p>Here, you want to unify <code>a -&gt; a</code>, the type of <code>id</code>, with <code>Num a =&gt; a -&gt; Int</code>. However, if you replace <code>a</code> with, for instance, <code>Double</code> in <code>Num a =&gt; a -&gt; Int</code>, you get <code>Double -&gt; Int</code>, which can't possibly unify with <code>a -&gt; a</code>, because it changes types while <code>a -&gt; a</code> doesn't. (That is the point of Thomas M. DuBuisson's comment above: the type of your implementations is not compatible with that of <code>id</code>, because <code>id</code> can't change the type of anything.)</p>\n\n<pre><code>Prelude&gt; let f4 :: Num a =&gt; Int -&gt; a; f4 = id\nCouldn't match type \u2018a\u2019 with \u2018Int\u2019\n</code></pre>\n\n<p>Finally, this is just like <code>f3</code>, except that the mismatch happens on the result type rather than on that of the argument. Putting a different spin on it this time, you can't implement a <code>Num a =&gt; Int -&gt; a</code> function by settling on a specific type with a <code>Num</code> instance (be it <code>Int</code>, <code>Double</code>, etc.) and then \"upcasting\" it to <code>Num a =&gt; a</code>, because there is no such thing as upcasting. Rather <code>Num a =&gt; Int -&gt; a</code> must work for <em>any</em> choice of <code>a</code> whatsoever that has an instance of <code>Num</code>.</p>\n"}], "owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 40433403, "answer_count": 1, "score": 3, "last_activity_date": 1478890857, "creation_date": 1478299262, "last_edit_date": 1495539925, "question_id": 40432690, "link": "https://stackoverflow.com/questions/40432690/how-to-comfortably-deal-with-the-type-system-on-haskell", "title": "How to comfortably deal with the type system on Haskell?", "body": "<p>Haskell's type system is powerful and liked for its mathematical rigorousness and logical soundness, on the other side something as naive as below makes me wonder why it doesn't work as expected by intuition? </p>\n\n<p>E.g. why can't <code>Int</code> be converted to <code>Num</code> on <code>x3</code> but <code>f1</code> accept <code>Int</code> against the signature <code>Num</code>? </p>\n\n<pre><code>Prelude&gt; let x1 = 1\nPrelude&gt; :t x1\nx1 :: Num a =&gt; a\n\nPrelude&gt; let x2 = 1 :: Int\nPrelude&gt; :t x2\nx2 :: Int\n\nPrelude&gt; let x3 = (1 :: Int) :: Num a =&gt; a\nCouldn't match expected type \u2018a1\u2019 with actual type \u2018Int\u2019\n\nPrelude&gt; let f1 :: Num a =&gt; a -&gt; a; f1 = id\nPrelude&gt; :t f1 (1 :: Int)\nf1 (1 :: Int) :: Int\n\nPrelude&gt; let f2 :: Int -&gt; Int; f2 = id\nPrelude&gt; :t f2 1\nf2 1 :: Int\n\nPrelude&gt; let f3 :: Num a =&gt; a -&gt; Int; f3 = id\n\nPrelude&gt; let f4 :: Num a =&gt; Int -&gt; a; f4 = id\nCouldn't match type \u2018a\u2019 with \u2018Int\u2019\n</code></pre>\n\n<p>I knew that one should finally learn the underlying theory e.g. <a href=\"https://en.wikipedia.org/wiki/Hindley%E2%80%93Milner_type_system\" rel=\"nofollow noreferrer\">HM type system</a> to comfortably deal with the type system, and even found some nice writings e.g. <a href=\"https://stackoverflow.com/questions/12532552/what-part-of-milner-hindley-do-you-not-understand\">1</a>, <a href=\"http://akgupta.ca/blog/2013/05/14/so-you-still-dont-understand-hindley-milner/\" rel=\"nofollow noreferrer\">2</a>, <a href=\"http://dev.stephendiehl.com/fun/006_hindley_milner.html\" rel=\"nofollow noreferrer\">3</a> and <a href=\"https://www7.in.tum.de/um/courses/seminar/sove/SS2013/final/hindley-milner.slides.pdf\" rel=\"nofollow noreferrer\">4</a> for demystifying it. What else would you like to recommend if you ever came cross and overcame this challenge?</p>\n\n<p><strong>@EDIT</strong></p>\n\n<pre><code>Prelude&gt; let f5 x5 = x5::Int\nPrelude&gt; :t f5\nf5 :: Int -&gt; Int\n\nPrelude&gt; let f6 x6 = x6::Num a =&gt; a\nCouldn't match expected type \u2018a1\u2019 with actual type \u2018t\u2019\n</code></pre>\n\n<p>First, <code>x6</code> must have been a supertype of <code>Num</code> that is <code>Num</code> itself when <code>x6</code> is type annotated with <code>Num</code>. However, the concatenate type annotations for <code>Num</code> after <code>Int</code> of <code>(x6::Int)::Num a =&gt; a</code> won't be united if we then downcast <code>x6</code> from <code>Num</code> to <code>Int</code>. Hence,\nthe first inferred type <code>Num</code> of <code>x6</code> is unsatisfied here.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1478296154, "post_id": 40432108, "comment_id": 68112862, "body": "&quot;I haven&#39;t been able to formulate this case without getting syntax errors.&quot; -- Which errors, and how you got to them? Please edit that into your question. (A question which tells the full story leads to less work for everyone and to better answers.)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1478297935, "post_id": 40432108, "comment_id": 68113495, "body": "Please post the <i>full</i> code you&#39;ve tried, and the full error message it caused."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478298403, "post_id": 40432108, "comment_id": 68113639, "body": "Something not directly related to the immediate problem: what is supposed to happen if the discriminant is negative?"}, {"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 0, "creation_date": 1478298734, "post_id": 40432108, "comment_id": 68113722, "body": "I was thinking of asking about that here as well, but figured that if I could find out the a = 0 problem then perhaps I&#39;ll be able to figure out the negative case by myself. I was thinking of it just returning an empty list or display an error message: Not possible in R."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478299135, "post_id": 40432108, "comment_id": 68113866, "body": "@Rad Returning an empty list is fine. If your function is supposed to give back &quot;the real solution<b>s</b>&quot; and does that through a list, returning an empty list if there are no solutions is reasonable and unsurprising."}, {"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478301540, "post_id": 40432108, "comment_id": 68114511, "body": "@duplode Sorry, could you please show me the technicalities of it? I tried:      quadSols::Double-&gt;Double-&gt;Double-&gt;[Double]     quadSols a b c = [x1,x2]         where           x1 = (-b - sqrt d) / (2 * a)           x2 = (-b + sqrt d) / (2 * a)           d = (b * b) - 4 * a * c       if d &lt; 0 then quadSols a b c = []       else quadSols a b c = [x] || [x1,x2]  I get: Prelude&gt; :load a.hs [1 of 1] Compiling Main             ( a.hs, interpreted )  a.hs:9:12 parse error on input \u2018if\u2019 Failed, modules loaded: none   Perhaps something is wrong with the indentation or is my logic wrong?"}, {"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 0, "creation_date": 1478301594, "post_id": 40432108, "comment_id": 68114526, "body": "Oops, that format looks messed up in the comment. I hope you are able to understand it."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1478302216, "post_id": 40432108, "comment_id": 68114689, "body": "@Rad If I am not misunderstanding the non-formatted code, the problem is that <code>if ... then ... else</code> is just a normal expression, and should go as a whole after the equals sign (something like <code>foo = if bar then baz else quux</code>). If you are familiar with ternary operators in other languages, it works very much like them. In any case, the second implementation in Jon Purdy&#39;s answer provides a nice model for fixing your code."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478302503, "post_id": 40432108, "comment_id": 68114764, "body": "@Rad <a href=\"http://stackoverflow.com/q/23463132/2751851\">What I have just said about <code>if</code> in a less compressed way</a> (feel free to ignore the code around the if-then-else if it confuses you)."}, {"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 0, "creation_date": 1478302678, "post_id": 40432108, "comment_id": 68114810, "body": "Thank you! I fixed it by managing the whole thing in guards. Thank you for your patience."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 0, "creation_date": 1478298600, "post_id": 40432504, "comment_id": 68113696, "body": "Thank you! I will take note of this in the future."}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": true, "score": 2, "last_activity_date": 1478298034, "creation_date": 1478298034, "answer_id": 40432504, "question_id": 40432108, "link": "https://stackoverflow.com/questions/40432108/assigning-special-cases-when-certain-variables-have-certain-values/40432504#40432504", "title": "Assigning special cases when certain variables have certain values?", "body": "<p>You can simply pattern match for the case where <code>a == 0</code>:</p>\n\n<pre><code>quadSols :: Double -&gt; Double-&gt; Double-&gt; [Double]\nquadSols 0 b c = [x]\n      where x = -c / b\nquadSols a b c = [x1,x2]\n      where\n          x1 = (-b - sqrt d) / (2 * a)\n          x2 = (-b + sqrt d) / (2 * a)\n          d = (b * b) - 4 * a * c\n</code></pre>\n\n<p>Note that you <strong>must</strong> include the first case before the second, since cases are matched in the order they are declared.</p>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "edited": false, "score": 0, "creation_date": 1478302728, "post_id": 40432505, "comment_id": 68114827, "body": "Thank you for your input."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1478298043, "creation_date": 1478298043, "answer_id": 40432505, "question_id": 40432108, "link": "https://stackoverflow.com/questions/40432108/assigning-special-cases-when-certain-variables-have-certain-values/40432505#40432505", "title": "Assigning special cases when certain variables have certain values?", "body": "<p>You can add another equation to <code>quadSols</code>:</p>\n\n<pre><code>quadSols 0 b c = [x]\n  where\n    x = (-c) / b\n\nquadSols a b c = [x1,x2]\n  where\n    \u2026\n</code></pre>\n\n<p>Or use a guard:</p>\n\n<pre><code>quadSols a b c\n  | a == 0 = [x]\n  | otherwise = [x1,x2]\n  where\n    x = (-c) / b\n    \u2026\n</code></pre>\n\n<p>Due to laziness, the definitions in the <code>where</code> clause won\u2019t be evaluated unless necessary to produce a result.</p>\n"}], "owner": {"reputation": 141, "user_id": 7091266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4c7265b02e328b183b28bdaf2d77ecb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rad", "link": "https://stackoverflow.com/users/7091266/rad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 40432504, "answer_count": 2, "score": 2, "last_activity_date": 1478298043, "creation_date": 1478295645, "last_edit_date": 1478296545, "question_id": 40432108, "link": "https://stackoverflow.com/questions/40432108/assigning-special-cases-when-certain-variables-have-certain-values", "title": "Assigning special cases when certain variables have certain values?", "body": "<p>for my functional programming homework I am instructed to write a function that gives back the real solutions of a quadratic equation in a list, I used the discriminant to find them out.</p>\n\n<p>So, my code looks something like this:</p>\n\n<pre><code>quadSols::Double-&gt;Double-&gt;Double-&gt;[Double]\nquadSols a b c = [x1,x2]\n      where\n          x1 = (-b - sqrt d) / (2 * a)\n          x2 = (-b + sqrt d) / (2 * a)\n          d = (b * b) - 4 * a * c\n</code></pre>\n\n<p>Now, the problem is in the case a = 0, for which the solution would be simply x = -c / b.\nI tried something like this, it sounds completely wrong but I don't really know what to do.</p>\n\n<pre><code>if a == 0 then quadSols a b c = [x]\n</code></pre>\n\n<p>and then added to the \"where\" part:</p>\n\n<pre><code>x = -c / b\n</code></pre>\n\n<p>when trying to load it with ghci I get:</p>\n\n<pre><code>parse error on input \u2018=\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Can anyone provide me with some guidance?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "higher-order-functions"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1478294338, "post_id": 40431728, "comment_id": 68112141, "body": "You should add type signatures to your functions."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478294346, "post_id": 40431728, "comment_id": 68112144, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3642277/haskell-what-is-the-source-of-error-ambiguous-type-variable-integral-t\">Haskell: What is the source of error &quot;Ambiguous type variable ... `Integral t&#39; ... `RealFrac t&#39; ...&quot; in this code?</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1478294751, "post_id": 40431728, "comment_id": 68112302, "body": "@duplode: I think it&#39;s not really a duplicate. That other question has a <i>contradicting</i> type, this one is in principle sound but has a monomorphism-restriction problem. Same error message, but quite different underlying problem."}, {"owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478295037, "post_id": 40431728, "comment_id": 68112417, "body": "@duplode the question you alluded to as being duplicate of that of mine does not really address my problem,although they have the same error message.Please re-read my question. Thank you."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1478295052, "post_id": 40431728, "comment_id": 68112421, "body": "@leftaroundabout Indeed. Close vote retracted, then."}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478295313, "post_id": 40431728, "comment_id": 68112519, "body": "Are you not allowed to write helper functions, or not use them at all?"}, {"owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "reply_to_user": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478295437, "post_id": 40431728, "comment_id": 68112563, "body": "@mnoronha Yes.that&#39;s why I&#39;m finding this difficult given my little haskell knowledge."}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478295462, "post_id": 40431728, "comment_id": 68112573, "body": "@AliToto That&#39;s yes to the latter? Changing my answer below."}, {"owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "reply_to_user": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478295547, "post_id": 40431728, "comment_id": 68112614, "body": "@mnoronha the assignment says: &quot;Do not create a helper function for this. You will want to use a where statement.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1478294534, "post_id": 40431864, "comment_id": 68112219, "body": "Right, but <b>a)</b> this is definitely not the order of preference for the solution <b>b)</b> the answer could use some more explanation."}, {"owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "edited": false, "score": 0, "creation_date": 1478294609, "post_id": 40431864, "comment_id": 68112248, "body": "putting {-# LANGUAGE NoMonomorphismRestriction #} still giving error."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "edited": false, "score": 1, "creation_date": 1478296317, "post_id": 40431864, "comment_id": 68112929, "body": "@AliToto no it&#39;s not. Well, at least it&#39;s not giving the error that <i>you&#39;ve asked about</i>."}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1478299083, "post_id": 40431864, "comment_id": 68113851, "body": "I seem to forgot a <code>-</code>. It&#39;s  <code>{-# LANGUAGE NoMonomorphismRestriction #-}</code>."}], "tags": [], "owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "is_accepted": false, "score": 0, "last_activity_date": 1478299452, "last_edit_date": 1495540845, "creation_date": 1478294405, "answer_id": 40431864, "question_id": 40431728, "link": "https://stackoverflow.com/questions/40431728/a-function-that-returns-maximum-of-list-and-count-of-occurrences/40431864#40431864", "title": "A function that returns maximum of list and count of occurrences", "body": "<p>You hit the dreaded Monomorphism Restriction.</p>\n\n<p>You can fix the type error by</p>\n\n<ul>\n<li>using <code>mxAdC x = go 0 x</code></li>\n<li>putting <code>{-# LANGUAGE NoMonomorphismRestriction #-}</code> at the beginning of your file</li>\n<li>adding the type signature</li>\n</ul>\n\n<p>Your function is still wrong, but now it typechecks.</p>\n\n<p>Haskell prohibits polymorphic functions that look like top-level constants (don't have parameters before the <code>=</code> sign). So in general you cannot eta-reduce (replace <code>foo x = bar x</code> with <code>foo = bar</code>). The full  explanation is rather long - see this answer: <a href=\"https://stackoverflow.com/a/32496865/805266\">https://stackoverflow.com/a/32496865/805266</a></p>\n"}, {"comments": [{"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "reply_to_user": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "edited": false, "score": 0, "creation_date": 1478295927, "post_id": 40432075, "comment_id": 68112762, "body": "What was your input?"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "reply_to_user": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "edited": false, "score": 0, "creation_date": 1478296248, "post_id": 40432075, "comment_id": 68112904, "body": "That&#39;s strange, unable to replicate it pasting the exact code above into a blank file. Are you sure the compiler errors relate to these lines? Try pasting into a blank file."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1478297276, "post_id": 40432075, "comment_id": 68113273, "body": "I&#39;d remark that this is not an efficient solution, as it requires a quite needless extra round of equality comparisons plus <code>length</code> (which is generally a bit of a code smell). Also, it evaluates <code>maximum xs</code> twice. The OP&#39;s original approach is thus actually better, albeit somewhat pedestrian with its manual recursion. (Thinking about it, this solution is not <i>too bad</i> actually \u2013 just the re-use of <code>maximum xs</code> should be avoided)."}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 0, "creation_date": 1478297670, "post_id": 40432075, "comment_id": 68113405, "body": "Removed the duplicate computation of <code>maximum</code>. What do you mean by extra round of equality comparisons?"}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1478298827, "post_id": 40432075, "comment_id": 68113756, "body": "It is little unfair to provide full solutions for assignments"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478317126, "post_id": 40432075, "comment_id": 68117216, "body": "The remaining problem is that it traverses the list twice, when once will do. The OP&#39;s general approach is better able to accommodate the necessary changes than this one is. I&#39;d probably go for a <code>foldl&#39;</code> myself, either letting the count double as a tag or (eschewing <code>undefined</code>) accumulating a <code>Maybe</code>. Another option would be a higher-order <code>foldr</code> of the type used to implement <code>foldl1</code>."}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": true, "score": 0, "last_activity_date": 1478297469, "last_edit_date": 1478297469, "creation_date": 1478295427, "answer_id": 40432075, "question_id": 40431728, "link": "https://stackoverflow.com/questions/40431728/a-function-that-returns-maximum-of-list-and-count-of-occurrences/40432075#40432075", "title": "A function that returns maximum of list and count of occurrences", "body": "<p>A fairly straightforward implementation would use <code>filter</code>:</p>\n\n<pre><code>mxAdC :: Ord a =&gt; [a] -&gt; (a,Int)\nmxAdC xs = (mx,length $ filter (\\x -&gt; x == mx) xs) where mx = maximum xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1478316255, "creation_date": 1478316255, "answer_id": 40434434, "question_id": 40431728, "link": "https://stackoverflow.com/questions/40431728/a-function-that-returns-maximum-of-list-and-count-of-occurrences/40434434#40434434", "title": "A function that returns maximum of list and count of occurrences", "body": "<p>Others have explained the type error. Let's look at the more interesting mistakes.</p>\n\n<pre><code>  | null ((x:xs))   = error \"The list is empty\"\n</code></pre>\n\n<p>What's wrong? <code>x : xs</code> is never null. It can't possibly be, because its first element is <code>x</code>! What you meant to do here was</p>\n\n<pre><code>mxAdC ys\n  | null ys = error \"mxAdC: the list is empty\"\n  | otherwise = go 0 ys\n  where ...\n</code></pre>\n\n<p>The next problem is</p>\n\n<pre><code>  | count /= 0      = (mx, count)\n</code></pre>\n\n<p>This says that as soon as the count is non-zero, you're done. So you'll never get above 1. You recognized that your recursion needed a base case, so you tried to put one in, but you missed the mark. The base case you need is to deal with the empty list:</p>\n\n<pre><code>go count [] = ?\ngo count (x:xs)  \n  | x == mx         = go (count+1) xs\n</code></pre>\n\n<p>Something is still missing from <code>go</code>, however. What do you want to happen when <code>x /= mx</code>? You need to add one more case (I've left question marks for you to fill in):</p>\n\n<pre><code>go count [] = ?\ngo count (x:xs)  \n  | x == mx         = go (count+1) xs\n  | otherwise       = ?\n</code></pre>\n\n<p>The final major problem is that you defined <code>mx</code> within the <code>go</code> function. This will calculate the maximum of whatever piece of the list <code>go</code> was handed, each time. What you want to do is define <code>mx</code> in <code>mxAdC</code></p>\n\n<pre><code>mxAdc ys\n  | ....\n  where\n    go ...\n    mx = maximum ys\n</code></pre>\n\n<hr>\n\n<p>There are still two big efficiency problems to deal with. One problem is that <code>go</code> no longer forces calculation of the accumulator in the recursive call, which may lead to a space leak. This is easily fixed using the <code>BangPatterns</code> language extension with</p>\n\n<pre><code>go !count [] = ?\ngo !count (x:xs)  \n  | x == mx         = go (count+1) xs\n  | otherwise       = ?\n</code></pre>\n\n<p>The last problem is that you still traverse the list twice: once to calculate the maximum and then again to count how many times it occurs. It's possible to do it in just one pass. I won't give you all the details, but the basic trick is to change your <code>go</code> function to take the greatest element seen thus far as well as the number of times it's been seen. You'll have to adjust the rest of <code>mxAdC</code> to fit, using a pattern match to get things going instead of <code>null</code>.</p>\n"}], "owner": {"reputation": 63, "user_id": 7053036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db2fcf4f318f925e784fbf8e2fdafae5?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Toto", "link": "https://stackoverflow.com/users/7053036/ali-toto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 40432075, "answer_count": 3, "score": 0, "last_activity_date": 1478316255, "creation_date": 1478293720, "last_edit_date": 1478294405, "question_id": 40431728, "link": "https://stackoverflow.com/questions/40431728/a-function-that-returns-maximum-of-list-and-count-of-occurrences", "title": "A function that returns maximum of list and count of occurrences", "body": "<p>I'm writing a recursive function <code>mxAndC</code>. When I give it a list, it should return a tuple. The tuple will have the maximum of the given list as its first element and the second element will be the number of times the element occurs in the list. Assignment does not allow me to create a helper function. I'm expecting following output:</p>\n\n<pre><code>mxAdC \"bananas\" = (s,1)\n\nmxAdC \"banana\" =(n,2)\n\nmxAdC [mod x 4 | x &lt;- [1..50]] -&gt; (3,12)\n</code></pre>\n\n<p>I did the following:</p>\n\n<pre><code>mxAdC = go 0\n where go count (x:xs)  \n           | count /= 0      = (mx, count)\n           | null ((x:xs))   = error \"The list is empty\"\n           | x == mx         = go (count+1) xs\n         where mx = maximum (x:xs)\n</code></pre>\n\n<p>And I'm getting error:</p>\n\n<pre><code>* Ambiguous type variable `a0' arising from a use of `go'\n      prevents the constraint `(Ord a0)' from being solved.\n      Relevant bindings include\n        mxAdC :: [a0] -&gt; (a0, Integer) (bound at hw06.hs:24:1)\n      Probable fix: use a type annotation to specify what `a0' should be.\n      These potential instances exist:\n        instance (Ord a, Ord b) =&gt; Ord (Either a b)\n          -- Defined in `Data.Either'\n        instance Ord Ordering -- Defined in `GHC.Classes'\n        instance Ord Integer\n          -- Defined in `integer-gmp-1.0.0.1:GHC.Integer.Type'\n        ...plus 23 others\n        ...plus 38 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    * In the expression: go 0\n      In an equation for `mxAdC':\n          mxAdC\n            = go 0\n            where\n                go count (x : xs)\n                  | count /= 0 = (mx, count)\n                  | null ((x : xs)) = error \"The list is empty\"\n                  | x == mx = go (count + 1) xs\n                  where\n                      mx = maximum (x : xs)\n</code></pre>\n\n<p>I'm very new in Haskell. Would any benevolent expert out there like to reach out and help out this newbie?</p>\n"}, {"tags": ["haskell", "exception-handling", "monads", "either"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1478278097, "post_id": 40427855, "comment_id": 68104292, "body": "<code>Either</code> / <code>ExceptT</code> / <code>ErrorT</code> are inherently designed to be short-circuiting, so the answer is \u201cno\u201d. If you want to accumulate multiple errors, though, you should use a different monad/monad transformer, in this case probably <code>WriterT</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1478278533, "post_id": 40427855, "comment_id": 68104532, "body": "Is it difficult to replace ErrorT with WriterT ?  At this moment I have &quot;tower: of monad (StateT, ErrorT, IO)"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 2, "creation_date": 1478278908, "post_id": 40427855, "comment_id": 68104774, "body": "It\u2019s not difficult in the sense that it\u2019s mechanically difficult, but it could be difficult in the sense that <code>ErrorT</code> and <code>WriterT</code> have extremely different semantics. The whole point of <code>ErrorT</code> is that it allows computations to fail. If you want to accumulate more than one error, then that means you probably want computation to keep going. Consider what implications that has for your code\u2014can you really keep going after a failure? If the answer is \u201csometimes\u201d, you might need a mixture of <code>WriterT</code> and <code>ExceptT</code> (<code>ErrorT</code> is deprecated by the way, use <code>ExceptT</code> instead)."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1478279173, "post_id": 40427855, "comment_id": 68104920, "body": "So what do you mean by &quot;accumulate more than one error&quot;? The idea of an error is that execution ends immediately, so once you have a single error you can&#39;t have any more."}], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 8, "last_activity_date": 1478280171, "last_edit_date": 1478280171, "creation_date": 1478279551, "answer_id": 40428310, "question_id": 40427855, "link": "https://stackoverflow.com/questions/40427855/accumulating-errors-using-errort/40428310#40428310", "title": "Accumulating errors using ErrorT", "body": "<p>You can use the <code>Errors</code> Applicative from <a href=\"http://hackage.haskell.org/package/transformers-0.5.2.0/docs/Control-Applicative-Lift.html\" rel=\"noreferrer\"><code>Control.Applicative.Lift</code></a> from <em>transformers</em>:</p>\n\n<pre><code>ghci&gt; import Control.Applicative\nghci&gt; import Control.Applicative.Lift\nghci&gt; failure ['a'] *&gt; pure () &lt;* failure ['b']\nOther (Constant \"ab\")\n</code></pre>\n\n<p>It returns the list of errors, if there are any, or the successful result.</p>\n\n<p>This type is usually known as the \"Validation\" Applicative. There are <a href=\"http://hackage.haskell.org/package/validation\" rel=\"noreferrer\">other implementations</a> of it available on Hackage. One posible improvement is to relax the requirement for the failure container to be a <code>Monoid</code>, allowing <code>Semigroup</code>s as well.</p>\n\n<p>Notice that the <code>Errors</code> type is not a <code>Monad</code>. But you can combine it with other <code>Applicative</code>s using <code>Data.Functor.Compose</code>.</p>\n\n<hr>\n\n<p>The <code>MonadPlus</code> instance for <code>ExceptT</code> has a related but not identical behaviour: it returns the first success, if there is any, or a list of errors:</p>\n\n<pre><code>ghci&gt; throwE ['a'] `mplus` return () `mplus` throwE ['b'] :: ExceptT [Char] Identity ()\nExceptT (Identity (Right ()))\nghci&gt; throwE ['a'] `mplus` throwE ['b'] :: ExceptT [Char] Identity ()\nExceptT (Identity (Left \"ab\"))\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1478280171, "creation_date": 1478277928, "last_edit_date": 1478278830, "question_id": 40427855, "link": "https://stackoverflow.com/questions/40427855/accumulating-errors-using-errort", "title": "Accumulating errors using ErrorT", "body": "<p>Is it possible to accumulate error messages in the ErrorT monad? I would like to accumulate more that one error.</p>\n"}, {"tags": ["javascript", "haskell", "functional-programming", "purely-functional"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 6, "creation_date": 1478274631, "post_id": 40426446, "comment_id": 68102080, "body": "Global state is simulated by 1) passing the state as an additional argument to every 2) returning the (possibly updated) state as an additional return value, and 3) ensuring that all consumers of the state are properly sequenced, so that the updated state from one function is passed to the next function. In Haskell, this is encapsulated by the <code>State</code> monad."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1478274807, "post_id": 40426446, "comment_id": 68102210, "body": "@chepner That is pretty much an answer already."}, {"owner": {"reputation": 113, "user_id": 6009952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4cea08b1f7f5b366914060313fa534a?s=128&d=identicon&r=PG&f=1", "display_name": "Colton Voege", "link": "https://stackoverflow.com/users/6009952/colton-voege"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1478274831, "post_id": 40426446, "comment_id": 68102231, "body": "Hey @chepner! Thanks for the info! Could you provide a StackOverflow answer perhaps that would display this idea in practice using the example I gave above? If you do and it works I&#39;d be glad to accept the answer!"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1478277443, "post_id": 40426446, "comment_id": 68103876, "body": "Related: the &quot;concurrent-supply&quot; package provides splittable identifier generators useful in more advanced scenarios dealing with multiple threads: <a href=\"http://hackage.haskell.org/package/concurrent-supply\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/concurrent-supply</a>"}, {"owner": {"reputation": 243, "user_id": 13679816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b02acae66c6a347786eb93e8cbead85?s=128&d=identicon&r=PG", "display_name": "atravers", "link": "https://stackoverflow.com/users/13679816/atravers"}, "edited": false, "score": 0, "creation_date": 1600130199, "post_id": 40426446, "comment_id": 112984420, "body": "Possibly related: <a href=\"https://stackoverflow.com/questions/6311512/creating-unique-labels-in-haskell\" title=\"creating unique labels in haskell\">stackoverflow.com/questions/6311512/&hellip;</a> ."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6009952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4cea08b1f7f5b366914060313fa534a?s=128&d=identicon&r=PG&f=1", "display_name": "Colton Voege", "link": "https://stackoverflow.com/users/6009952/colton-voege"}, "edited": false, "score": 1, "creation_date": 1478276816, "post_id": 40427024, "comment_id": 68103487, "body": "But isn&#39;t this kinda exactly not a pure function since generateRandom() returns a different result with the same parameters?"}, {"owner": {"reputation": 4351, "user_id": 1083314, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000982192072/picture?type=large", "display_name": "Vivek Pradhan", "link": "https://stackoverflow.com/users/1083314/vivek-pradhan"}, "reply_to_user": {"reputation": 113, "user_id": 6009952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4cea08b1f7f5b366914060313fa534a?s=128&d=identicon&r=PG&f=1", "display_name": "Colton Voege", "link": "https://stackoverflow.com/users/6009952/colton-voege"}, "edited": false, "score": 0, "creation_date": 1478276952, "post_id": 40427024, "comment_id": 68103572, "body": "Yes you are right. <code>generateRandom()</code> returns a different value everytime but that is what you want the random number generator to do right? I gathered that you want to have a functional implementation of the random number generator. The function here saves the state internally which enables it to generate random numbers in the first place"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1478278607, "post_id": 40427024, "comment_id": 68104572, "body": "All this implementation does is changing the scope of the mutable variable; therefore, it doesn&#39;t answer the question at all (though at least you are upfront about that)."}, {"owner": {"reputation": 113, "user_id": 6009952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4cea08b1f7f5b366914060313fa534a?s=128&d=identicon&r=PG&f=1", "display_name": "Colton Voege", "link": "https://stackoverflow.com/users/6009952/colton-voege"}, "edited": false, "score": 1, "creation_date": 1478294649, "post_id": 40427024, "comment_id": 68112268, "body": "@VivekPradhan I think I should clarify, I don&#39;t want a single pure function to do this, that would not be possible, but a system by which you can get similar functionality to this using only pure functions."}], "tags": [], "owner": {"reputation": 4351, "user_id": 1083314, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000982192072/picture?type=large", "display_name": "Vivek Pradhan", "link": "https://stackoverflow.com/users/1083314/vivek-pradhan"}, "is_accepted": false, "score": -1, "last_activity_date": 1478275174, "creation_date": 1478275174, "answer_id": 40427024, "question_id": 40426446, "link": "https://stackoverflow.com/questions/40426446/pure-functional-approach-to-generate-a-unique-id/40427024#40427024", "title": "Pure Functional approach to generate a unique id", "body": "<p>You could use closures to save the state of the counter like so:</p>\n\n<pre><code> var generateRandom = (function seed(){\n          var start = 0;\n            return function(){\n             return start++;\n            }\n         })();\n</code></pre>\n\n<p>To generate random numbers use just go:</p>\n\n<pre><code> generateRandom(); //logs 0\n generateRandom(); //logs 1\n generateRandom(); //logs 2 and so on..\n</code></pre>\n\n<p>Although this seems like you are calling a pure function, it is still a hack I would say. I am basically the seed() function once as you can see in the IIFE and then basically storing the returned function in the variable <code>generateRandom</code>. So, it is not purely functional so to speak.</p>\n\n<p>But, I hope it gets you started in the right direction.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1478279045, "post_id": 40427335, "comment_id": 68104865, "body": "Nicely put. For even more safety, one can write a module with a <code>newtype</code> wrapper around <code>State Int</code>, <code>deriving Monad</code>, and export only <code>getNextId, get</code> and little else. In such way, the user is further prevented to reset the counter, not having access to <code>put</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1478278282, "last_edit_date": 1478278282, "creation_date": 1478276251, "answer_id": 40427335, "question_id": 40426446, "link": "https://stackoverflow.com/questions/40426446/pure-functional-approach-to-generate-a-unique-id/40427335#40427335", "title": "Pure Functional approach to generate a unique id", "body": "<p>In Haskell, you might write something like</p>\n\n<pre><code>import Control.Monad.State\n\ndata Component  = Component Int String deriving (Show)\n\ngetNextId :: State Int Int\ngetNextId = do x &lt;- get\n               put (x + 1)\n               return x\n\nmakeComponent :: String -&gt; State Int Component\nmakeComponent name = do x &lt;- getNextId\n                        return (Component x name)\n\ncomponents = evalState (traverse makeComponent [\"alice\", \"bob\"]) 0\n\nmain = print $ components\n</code></pre>\n\n<p>The above script would output</p>\n\n<pre><code>[Component 0 \"alice\",Component 1 \"bob\"]\n</code></pre>\n\n<p>as each \"call\" to <code>getNextId</code> would \"return\" the next number in line. The <code>traverse</code> function is something like <code>map</code>, but it ensures that the effect of each monad takes place during the course of applying <code>makeComponent</code> to each value.</p>\n\n<p><a href=\"http://www.codeproject.com/Tips/801173/State-Monad-in-javascript\" rel=\"nofollow noreferrer\">This link</a> may provide some assistance in adapting this to Javascript.</p>\n\n<hr>\n\n<p>The <code>State</code> type constructor itself is just a wrapper around a function, here of type <code>Int -&gt; (Int, Int)</code>. The <code>Monad</code> instance for this type lets you avoid writing code that looks like this:</p>\n\n<pre><code>getNextID :: Int -&gt; (Int, Int)\ngetNextID x = (x, x+1)\n\nmakeComponent :: String -&gt; Int -&gt; (Int, Int)\nmakeComponent name x = let (now, then) = getNextID x\n                       in  (then, Component now name)\n\ncomponents = let state_0 = 0\n                 (state_1, c1) = makeComponent \"alice\" state_0\n                 (state_2, c2) = makeComponent \"bob\" state_1\n             in [c1, c2]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44043, "user_id": 1565698, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7dace33805b9dcdec5aa63308daf88dc?s=128&d=identicon&r=PG", "display_name": "Sylwester", "link": "https://stackoverflow.com/users/1565698/sylwester"}, "is_accepted": false, "score": 1, "last_activity_date": 1478285472, "last_edit_date": 1478285472, "creation_date": 1478285007, "answer_id": 40429796, "question_id": 40426446, "link": "https://stackoverflow.com/questions/40426446/pure-functional-approach-to-generate-a-unique-id/40429796#40429796", "title": "Pure Functional approach to generate a unique id", "body": "<p>Pure function would imply you don't mutate state. Thus this will work:</p>\n\n\n\n<pre class=\"lang-js prettyprint-override\"><code>function idGenerator(fnNext, aInit) {\n  function Gen(value){this.value = value}\n  Gen.prototype.next = function() {\n      return new Gen(fnNext(this.value));\n  };\n  return new Gen(aInit);\n}\n\nconst evenGen = idGenerator(function(n){return n+2;}, 2);\nevenGen.value                     //==&gt; 2\nconst evenGen2 = evenGen.next();\nevenGen2.value                    //==&gt; 4\n\nconst loop = function (seq, acc) {\n  return seq.value &gt; 16 ?\n         acc : \n         loop(seq.next(), seq.value+acc);\n}\nconst sumEven = loop(evenGen, 0);\nconsole.log(sumEven);             //==&gt;  72\n</code></pre>\n\n<p>For you example you need to changeit slightly so that state can be passed:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>const seq = idGenerator(function(n){return n+1;}, 1);\n\nfunction MyComponent(seq) {\n  this.id = seq.value;\n  this.seq = seq;\n\n  // Code which uses id\n}\n\nlet c1 = new MyComponent(seq);\n// c1.id === 1\nlet c2 = new MyComponent(c1.seq.next());\n// c2.id === 2\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6009952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4cea08b1f7f5b366914060313fa534a?s=128&d=identicon&r=PG&f=1", "display_name": "Colton Voege", "link": "https://stackoverflow.com/users/6009952/colton-voege"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 0, "accepted_answer_id": 40427335, "answer_count": 3, "score": 3, "last_activity_date": 1478285472, "creation_date": 1478273481, "question_id": 40426446, "link": "https://stackoverflow.com/questions/40426446/pure-functional-approach-to-generate-a-unique-id", "title": "Pure Functional approach to generate a unique id", "body": "<p>This is more of a theoretical question but I feel like there must be a way to do this.</p>\n\n<p>I have JS components for which, when they are created, they need to assign a unique id to an html element, one that hasn't been used in any other component. This is pretty trivial normally:</p>\n\n<pre><code>let currentId = 0;\nfunction getNextId() {\n  currentId += 1;\n  return currentId;\n}\n\nfunction MyComponent() {\n  this.id = getNextId();\n\n  // Code which uses id\n}\n\nlet c1 = new MyComponent();\n// c1.id === 1\nlet c2 = new MyComponent();\n// c2.id === 2\n</code></pre>\n\n<p>I'm wondering if there's any way to do this kind of thing using just pure functions, as I'm trying to wrap my head around some more advanced pure functional ideas. As far as I can tell it would require Monads or something of that variety to accomplish, but I don't know how to do so.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "edited": false, "score": 3, "creation_date": 1478270379, "post_id": 40425113, "comment_id": 68099040, "body": "multiples n = [0,n..]"}, {"owner": {"reputation": 11, "user_id": 7115486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2c601c24e9e2a7179a6df2eba39fc4?s=128&d=identicon&r=PG&f=1", "display_name": "amanda", "link": "https://stackoverflow.com/users/7115486/amanda"}, "reply_to_user": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "edited": false, "score": 0, "creation_date": 1478278133, "post_id": 40425113, "comment_id": 68104313, "body": "Thanks a lot No_signal :) Thats even compact"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7115486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2c601c24e9e2a7179a6df2eba39fc4?s=128&d=identicon&r=PG&f=1", "display_name": "amanda", "link": "https://stackoverflow.com/users/7115486/amanda"}, "edited": false, "score": 0, "creation_date": 1478270804, "post_id": 40425389, "comment_id": 68099370, "body": "Thanks a lot epsilonhalbe"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1478270333, "creation_date": 1478270333, "answer_id": 40425389, "question_id": 40425113, "link": "https://stackoverflow.com/questions/40425113/multiples-of-a-number-using-haskell/40425389#40425389", "title": "Multiples of a number using Haskell", "body": "<p>You need to negate <code>x</code> in the negative version:</p>\n\n<pre><code>result1 = [-x | x &lt;- [0..], x `mod`(- n) == 0]\n</code></pre>\n\n<p>Of course this only solves your immediate problem @chepner's answer is much more elegant</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7115486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2c601c24e9e2a7179a6df2eba39fc4?s=128&d=identicon&r=PG&f=1", "display_name": "amanda", "link": "https://stackoverflow.com/users/7115486/amanda"}, "edited": false, "score": 0, "creation_date": 1478270794, "post_id": 40425399, "comment_id": 68099364, "body": "Thats a classic just one line of code :) . Thank you so much"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 11, "user_id": 7115486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2c601c24e9e2a7179a6df2eba39fc4?s=128&d=identicon&r=PG&f=1", "display_name": "amanda", "link": "https://stackoverflow.com/users/7115486/amanda"}, "edited": false, "score": 0, "creation_date": 1478273335, "post_id": 40425399, "comment_id": 68101105, "body": "Make sure you saw @no_signal&#39;s comment; that&#39;s an even shorter approach."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 5, "last_activity_date": 1478270365, "creation_date": 1478270365, "answer_id": 40425399, "question_id": 40425113, "link": "https://stackoverflow.com/questions/40425113/multiples-of-a-number-using-haskell/40425399#40425399", "title": "Multiples of a number using Haskell", "body": "<p>You can avoid branching if you just multiply the argument by successive natural numbers:</p>\n\n<pre><code>multiples n = map (* n) [0..]\n</code></pre>\n\n<p>This works for all <code>n</code>, positive or negative. (And zero, if you don't mind an infinite list of 0s.)</p>\n"}], "owner": {"reputation": 11, "user_id": 7115486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2c601c24e9e2a7179a6df2eba39fc4?s=128&d=identicon&r=PG&f=1", "display_name": "amanda", "link": "https://stackoverflow.com/users/7115486/amanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 995, "favorite_count": 0, "accepted_answer_id": 40425399, "answer_count": 2, "score": 1, "last_activity_date": 1478636041, "creation_date": 1478269539, "last_edit_date": 1478636041, "question_id": 40425113, "link": "https://stackoverflow.com/questions/40425113/multiples-of-a-number-using-haskell", "title": "Multiples of a number using Haskell", "body": "<p>I have wrote the following function for finding the multiples of an input number.\nWhen I try to give negative numbers the output is only positive list.How can I modify my code to allow negative numbers to be listed in the output?</p>\n\n<p>My Try :</p>\n\n<pre><code>multiples n = if n&lt;0 then result1 else result2\nwhere\n   result1 = [x | x &lt;- [0..], x `mod` (-n) == 0]        \n   result2 = [x | x &lt;- [0..], x `mod` n == 0]\n\n  Input : take 5 $ multiples (-3)\n  Output: [0,3,6,9,12]\n  Expected Output: [0,-3,-6,-9,-12]\n</code></pre>\n"}, {"tags": ["haskell", "lazy-evaluation"], "answers": [{"tags": [], "owner": {"reputation": 6787, "user_id": 549641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97f3ebc820da8f94f4495a7ba8dc9b6?s=128&d=identicon&r=PG", "display_name": "jmg", "link": "https://stackoverflow.com/users/549641/jmg"}, "is_accepted": false, "score": 0, "last_activity_date": 1478269477, "creation_date": 1478269477, "answer_id": 40425094, "question_id": 40424872, "link": "https://stackoverflow.com/questions/40424872/how-is-this-infinite-list-computed/40425094#40425094", "title": "How is this infinite list computed?", "body": "<p>That is more or less correct. In which order the substitutions happen depends on the code that prints out the results. The substitutions in the 2. and 3. line could be swapped.</p>\n"}, {"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 2, "last_activity_date": 1478271710, "creation_date": 1478271710, "answer_id": 40425835, "question_id": 40424872, "link": "https://stackoverflow.com/questions/40424872/how-is-this-infinite-list-computed/40425835#40425835", "title": "How is this infinite list computed?", "body": "<p>You are pretty much correct. It might help if you de-sugared the list comprehension into a function call. The equivalent is</p>\n\n<pre><code>dollars = 100.0 : map (* 1.05) dollars\n</code></pre>\n\n<p>This then evaluates to</p>\n\n<pre><code>= 100.0 : let dollars1 = 100 * 1.05 : map (*1.05) dollars1 in dollars1\n= 100.0 : 105.0 : let dollars2 = 105 * 1.05 : map (*1.05) dollars2 in dollars2\n</code></pre>\n\n<p>and so on. I'm using <code>dollars1</code>, <code>dollars2</code> as identifiers, even though they don't really exist.</p>\n"}], "owner": {"reputation": 59, "user_id": 6510186, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1e883a7cd35b122b66991b4a3142fe4e?s=128&d=identicon&r=PG&f=1", "display_name": "fornit", "link": "https://stackoverflow.com/users/6510186/fornit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1478272861, "creation_date": 1478268835, "last_edit_date": 1478272861, "question_id": 40424872, "link": "https://stackoverflow.com/questions/40424872/how-is-this-infinite-list-computed", "title": "How is this infinite list computed?", "body": "<p>The problem is the following:</p>\n\n<blockquote>\n  <p>Define a Haskell variable dollars that is the infinite list of amounts\n  of money you have every year, assuming you start with $100 and get\n  paid 5% interest, compounded yearly. (Ignore inflation, deflation,\n  taxes, bailouts, the possibility of total economic collapse, and other\n  such details.) So dollars should be equal to: [100.0, 105.0, 110.25,\n  ...].</p>\n</blockquote>\n\n<p>My solution is the following and it works:</p>\n\n<pre><code> dollars::[Double]\n dollars = 100.0 : [1.05 * x | x&lt;- dollars ] \n</code></pre>\n\n<p>The problem is that I have trouble understanding how the list is computed practically:</p>\n\n<pre><code>dollars= 100.0 : [1.05 * x | x&lt;- dollars ] \n= 100.0 : [1.05 * x | x&lt;- 100.0 : [1.05 * x | x&lt;- dollars ]   ]\n= 100.0 : (1.05 * 100.0) : [1.05 * x | x&lt;- [1.05 * x | x&lt;- dollars ]    ]\n= 100.0 : 105.0 : [1.05 * x | x&lt;- [1.05 * x | x&lt;- dollars ]   ]\n= 100.0 : 105.0 : [1.05 * x | x&lt;- [1.05 * x | x&lt;-  100.0 : [1.05 * x | x&lt;- dollars ]  ]  ]\n= 100.0 : 105.0 : [1.05 * x | x&lt;- 105.0:[1.05 * x | x&lt;-[1.05 * x | x&lt;- dollars ]  ]  ]\n= 100.0 : 105.0 : 110.25 :[1.05 * x | x&lt;-[1.05 * x | x&lt;-[1.05 * x | x&lt;- dollars ]  ]  ]\n</code></pre>\n\n<p>etc.</p>\n\n<p>Is that how it is computed? If not then how? If yes, is there a simpler way to conceptualize these kinds of computations? </p>\n"}, {"tags": ["haskell", "template-haskell", "type-level-computation"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1478265606, "post_id": 40423176, "comment_id": 68095605, "body": "Even though I have not used it myself - but did you take a look at <a href=\"https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Data.html\" rel=\"nofollow noreferrer\">Data.Data</a> maybe it provides enough information."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1478267166, "post_id": 40423176, "comment_id": 68096679, "body": "<a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Typeable.html#v:typeRep\" rel=\"nofollow noreferrer\"><code>typeRep</code></a> seems to be close enough."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 1, "last_activity_date": 1478276473, "creation_date": 1478276473, "answer_id": 40427411, "question_id": 40423176, "link": "https://stackoverflow.com/questions/40423176/how-to-bring-type-information-into-value-level-in-haskell/40427411#40427411", "title": "How to bring type information into value level in Haskell?", "body": "<p>I boils down to finding what you want to do with that type information. In either case, the modules you will probably be looking at are <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Typeable.html\" rel=\"nofollow noreferrer\"><code>Data.Typeable</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Data.html\" rel=\"nofollow noreferrer\"><code>Data.Data</code></a>. At the center of these modules are the two typeclasses (deriveable via <code>-XDeriveDataTypeable</code>)</p>\n\n<pre><code>class Typeable a where {...}\nclass Typeable a =&gt; Data a where {..}\n</code></pre>\n\n<p>As @chi mentions, the former of these lets you poke a type to find out information about it. That said there is the caveat that you need instances of <code>Typeable</code> for this to work (although you can start making orphan instances of these if you really need to...). In particular, there is <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Typeable.html#v:typeRep\" rel=\"nofollow noreferrer\"><code>typeRep</code></a>:</p>\n\n<pre><code>ghci&gt; import Data.Typeable\nghci&gt; typeRep (Proxy :: Proxy (Either (Maybe [Integer]) ((), Bool, Int)))\nEither (Maybe [Integer]) ((), Bool, Int)\n</code></pre>\n\n<p>However, if you ever decide you want to use the type information to try to lookup the value representations (ie. constructors) it has, you'll want to look at <code>Data.Data</code>.</p>\n"}], "owner": {"reputation": 131, "user_id": 3749167, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056fa9bbc5f8f7a35be7fa3c353a023e?s=128&d=identicon&r=PG&f=1", "display_name": "user3749167", "link": "https://stackoverflow.com/users/3749167/user3749167"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 40427411, "answer_count": 1, "score": 4, "last_activity_date": 1478278965, "creation_date": 1478263953, "last_edit_date": 1478278965, "question_id": 40423176, "link": "https://stackoverflow.com/questions/40423176/how-to-bring-type-information-into-value-level-in-haskell", "title": "How to bring type information into value level in Haskell?", "body": "<p>I'm looking for ways of way to bring type information into value level in Haskell.</p>\n\n<p>One way I know to represent any type information as a value is the <code>Language.Haskell.TH.Type</code>.\nIs there any way to implement a function that takes <code>Proxy a</code> and returns <code>Language.Haskell.TH.Type</code> (or alternative type to represent any type) of the <code>a</code> type as follows?</p>\n\n<p>If you have a better idea to bring type information as a value that does not use <code>Language.Haskell.TH.Type</code>, please tell me that, too.</p>\n\n<pre><code>import Data.Proxy (Proxy)\nimport Language.Haskell.TH (Type, TypeQ)\n\n-- |\n-- &gt;&gt;&gt; amazing (Proxy :: Proxy Bool)\n-- ConT GHC.Types.Bool\n--\n-- &gt;&gt;&gt; amazing (Proxy :: Proxy [String])\n-- AppT ListT (ConT GHC.Base.String)\namazing :: Proxy a -&gt; Type\namazing p = undefined\n\n-- |\n-- Or if above is impossible, how about this?\namazingQ :: Proxy a -&gt; TypeQ\namazingQ p = undefined\n</code></pre>\n"}, {"tags": ["haskell", "syntax"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1478230562, "post_id": 40414785, "comment_id": 68079608, "body": "They are not identical. Function application is left-associative, and so <code>sin sin 0.5</code> is actually <code>(sin sin) 0.5</code>, which is not what you meant and leads to a type error."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1478230569, "post_id": 40414785, "comment_id": 68079609, "body": "Partial duplicate of <a href=\"http://stackoverflow.com/questions/17243075/understanding-how-haskell-precedence-rules-work-with-multiple-partial-applicatio\">Understanding how Haskell precedence rules work with multiple partial application</a>"}], "answers": [{"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 10, "last_activity_date": 1478238840, "last_edit_date": 1478238840, "creation_date": 1478230157, "answer_id": 40414819, "question_id": 40414785, "link": "https://stackoverflow.com/questions/40414785/whats-the-difference-between-the-sin-sin-0-5-and-the-sin-sin-0-5-in-haske/40414819#40414819", "title": "What&#39;s the difference between the `sin sin 0.5` and the `sin (sin 0.5)` in haskell?", "body": "<p>Short answer: <code>sin sin 0.5</code> parses as <code>(sin sin) 0.5</code></p>\n\n<p>Long answer: The expression <code>sin sin 0.5</code> parses as <code>(sin sin) 0.5</code>. Now, the sine function works on any <code>Floating</code> type. So Haskell, trying to deduce the type of your expression, determines that <code>sin :: Floating a =&gt; a -&gt; a</code> must be floating, so <code>Floating a =&gt; a -&gt; a</code> is a floating point type. But Haskell doesn't allow complex types like <code>a -&gt; a</code> to appear in context expressions, so you get that error. If Haskell allowed such expressions (or if you enabled FlexibleContexts, as the error suggests), you would get an uglier error when the types failed to unify later.</p>\n"}], "owner": {"reputation": 113, "user_id": 5448549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55e09f85241547a3d2332a1c53862be9?s=128&d=identicon&r=PG&f=1", "display_name": "wxw", "link": "https://stackoverflow.com/users/5448549/wxw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 40414819, "answer_count": 1, "score": 2, "last_activity_date": 1478238840, "creation_date": 1478229896, "last_edit_date": 1478232341, "question_id": 40414785, "link": "https://stackoverflow.com/questions/40414785/whats-the-difference-between-the-sin-sin-0-5-and-the-sin-sin-0-5-in-haske", "title": "What&#39;s the difference between the `sin sin 0.5` and the `sin (sin 0.5)` in haskell?", "body": "<pre><code>*&gt; sin sin 0.5  \n&lt;interactive&gt;:10:1:\nNon type-variable argument in the constraint: Floating (a -&gt; a)\n(Use FlexibleContexts to permit this)\nWhen checking that \u2018it\u2019 has the inferred type\n  it :: forall a. (Floating a, Floating (a -&gt; a)) =&gt; a\n</code></pre>\n\n<p>but <code>sin (sin 0.5)</code> works. <br/>\nI think they are identical, and I can't understand the error message.<br/>\nI want to know why?</p>\n"}, {"tags": ["haskell", "segment-tree"], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "edited": false, "score": 0, "creation_date": 1478476839, "post_id": 40417057, "comment_id": 68157515, "body": "Can you help me with understanding the blog article?"}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 5, "last_activity_date": 1478242953, "creation_date": 1478242953, "answer_id": 40417057, "question_id": 40414514, "link": "https://stackoverflow.com/questions/40414514/haskell-frequent-values/40417057#40417057", "title": "Haskell: Frequent values", "body": "<p>I'd do it as</p>\n\n<pre><code>f = neighbors . prefixSums . counts\n  where\n    counts = map length . group . sort\n    prefixSums = scanl (+) 0\n    neighbors xs = zip xs (tail xs)\n</code></pre>\n\n<p>This starts by computing the <code>counts</code> of elements, so your (arbitrary permutation of) <code>[-1, -1, 1, 1, 1, 1, 3, 10, 10, 10]</code> becomes <code>[2, 4, 1, 3]</code>. </p>\n\n<p>Then, <code>prefixSums</code> computes the sums of prefixes, and so we get <code>[0, 2, 6, 7, 10]</code> for our running example.</p>\n\n<p>To get the end result, we simply take the consecutive <code>neighbors</code> of this list. </p>\n"}], "owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1484927396, "creation_date": 1478227647, "last_edit_date": 1484927396, "question_id": 40414514, "link": "https://stackoverflow.com/questions/40414514/haskell-frequent-values", "title": "Haskell: Frequent values", "body": "<p>I am trying to solve <a href=\"https://www.bnuoj.com/v3/problem_show.php?pid=14333\" rel=\"nofollow noreferrer\">frequent values</a> using Segment Tree</p>\n\n<p><a href=\"http://andrew-algorithm.blogspot.com/2014/09/uva-problem-11235-frequent-values.html\" rel=\"nofollow noreferrer\">This</a> blog article uses a similar approach</p>\n\n<p>I want to split a list into intervals as:</p>\n\n<p><code>-1 -1 1 1 1 1 3 10 10 10</code> becomes <code>(0, 2) (2, 6) (6, 7), (7, 10)</code></p>\n\n<p>I have a code as: </p>\n\n<pre><code>g s = map (\\x-&gt;(head x, length x)) . group . sort $ s\n</code></pre>\n\n<p>But it does not give the correct output.</p>\n\n<p>Is it possible with frequent values too?</p>\n"}, {"tags": ["haskell", "text", "utf-8", "ghc", "bytestring"], "answers": [{"comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 2, "creation_date": 1478241927, "post_id": 40415319, "comment_id": 68082791, "body": "The longest UTF-8 encoding is 4 bytes.  5 and 6 byte encodings are invalid and have been invalid for many years.  No characters were ever assigned which would have had 5 or 6 byte encodings."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1478242008, "post_id": 40415319, "comment_id": 68082820, "body": "@DietrichEpp: thanks. My argument only needs the longest UTF-8 encoding to be a finite number :)"}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 0, "last_activity_date": 1478241755, "last_edit_date": 1495535271, "creation_date": 1478233922, "answer_id": 40415319, "question_id": 40414452, "link": "https://stackoverflow.com/questions/40414452/get-a-char-from-a-bytestring/40415319#40415319", "title": "Get a `Char` from a `ByteString`", "body": "<p><a href=\"https://stackoverflow.com/a/35027139/477476\">The longest UTF-8 encoding is 6 bytes</a>, so if we try 1, 2, ... bytes, it will finish at least at the 6th step, thereby being <em>O(1)</em>:</p>\n\n<pre><code>import Data.Text as Text\nimport Data.Text.Encoding as Text\nimport Data.ByteString as BS\n\nsplitUtf8 :: ByteString -&gt; (Char, ByteString)\nsplitUtf8 bs = go 1\n  where\n    go n | BS.null slack = (Text.head t, bs')\n         | otherwise = go (n + 1)\n      where\n        (bs1, bs') = BS.splitAt n bs\n        Some t slack _ = Text.streamDecodeUtf8 bs1\n</code></pre>\n\n<p>For example, here's splitting a 2+3-byte <code>ByteString</code>:</p>\n\n<pre><code>*SO_40414452&gt; splitUtf8 $ BS.pack[197, 145, 226, 138, 162]\n('\\337',\"\\226\\138\\162\")\n</code></pre>\n\n<p>and here a 3+2-byte one:</p>\n\n<pre><code>*SO_40414452&gt; splitUtf8 $ BS.pack[226, 138, 162, 197, 145]\n('\\8866',\"\\197\\145\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478244208, "post_id": 40417008, "comment_id": 68083718, "body": "I did not know this package existed, but this is exactly what I was looking for. This means I can completely eliminate any dependency on <code>text</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1478244806, "post_id": 40417008, "comment_id": 68083961, "body": "Wow! This tiny library has precisely the functionality I need for my lexer. Thanks a ton."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1478264079, "post_id": 40417008, "comment_id": 68094642, "body": "Just keep in mind these functions are partial; they are undefined on <code>Data.ByteString.empty</code>."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 4, "last_activity_date": 1478243224, "last_edit_date": 1478243224, "creation_date": 1478242752, "answer_id": 40417008, "question_id": 40414452, "link": "https://stackoverflow.com/questions/40414452/get-a-char-from-a-bytestring/40417008#40417008", "title": "Get a `Char` from a `ByteString`", "body": "<p>You want the <a href=\"https://hackage.haskell.org/package/utf8-string-1.0.1.1/docs/Data-ByteString-UTF8.html\" rel=\"nofollow noreferrer\">Data.Bytestring.UTF8</a> module in the utf8-string package.  It contains an <code>uncons</code> function with the following signature:</p>\n\n<pre><code>uncons :: ByteString -&gt; Maybe (Char, ByteString)\n</code></pre>\n\n<p>You can then define:</p>\n\n<pre><code>headUtf8 :: ByteString -&gt; Char\nheadUtf8 = fst . fromJust . uncons\n\ntailUtf8 :: ByteString -&gt; ByteString\ntailUtf8 = snd . fromJust . uncons\n</code></pre>\n"}], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 40417008, "answer_count": 2, "score": 4, "last_activity_date": 1478243224, "creation_date": 1478227150, "last_edit_date": 1478241807, "question_id": 40414452, "link": "https://stackoverflow.com/questions/40414452/get-a-char-from-a-bytestring", "title": "Get a `Char` from a `ByteString`", "body": "<p>Is there a way to get the first UTF-8 <code>Char</code> in a <code>ByteString</code> in O(1) time? I'm looking for something like</p>\n\n<pre><code>headUtf8 :: ByteString -&gt; Char\ntailUtf8 :: ByteString -&gt; ByteString\n</code></pre>\n\n<p>I'm not yet constrained to use strict or lazy <code>ByteString</code>, but I'd prefer strict. For lazy <code>ByteString</code>, I can cobble something together via <code>Text</code>, but I'm not sure how efficient (especially space-complexity wise) this is.</p>\n\n<pre><code>import qualified Data.Text.Lazy as T\nimport Data.Text.Lazy.Encoding (decodeUtf8With, encodeUtf8)\nimport Data.Text.Encoding.Error (lenientDecode)\n\nheadUtf8 :: ByteString -&gt; Char\nheadUtf8 = T.head . decodeUtf8With lenientDecode\n\ntailUtf8 :: ByteString -&gt; ByteString\ntailUtf8 = encodeUtf8 . T.tail . decodeUtf8With lenientDecode\n</code></pre>\n\n<p>In case anyone is interested, this problem arises when using Alex to make a lexer that supports UTF-8 characters<sup>1</sup>.</p>\n\n<hr>\n\n<p><sup>1</sup> I am aware that since Alex 3.0 you only need to provide <code>alexGetByte</code> (and that is great!) but I still need to be able to get characters in other code in the lexer.</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1478227553, "post_id": 40414449, "comment_id": 68078950, "body": "I recommend you reconsider the type of <code>getFooFromBar</code> - it looks poised for an <code>Ambiguous type variable</code> error."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1478228349, "post_id": 40414449, "comment_id": 68079144, "body": "@Alec The full error indeed says <code>The type variable \u2018f0\u2019 is ambiguous</code>."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1478235388, "post_id": 40414449, "comment_id": 68080687, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/21220655/understanding-a-case-of-haskell-type-ambiguity\">Understanding a case of Haskell Type-Ambiguity</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 5, "last_activity_date": 1478230949, "last_edit_date": 1478230949, "creation_date": 1478230127, "answer_id": 40414814, "question_id": 40414449, "link": "https://stackoverflow.com/questions/40414449/haskell-class-dependencies/40414814#40414814", "title": "Haskell class dependencies", "body": "<blockquote>\n  <p>But I would prefer if I didnt have to add <code>f</code> to all the instance signatures of <code>Bar</code>.</p>\n</blockquote>\n\n<p>Technically speaking, you don't need to do that to make your example compile. You can use a type annotation to specify which instance of <code>Foo</code> you are using in <code>someFunction</code>, solving the ambiguous type variable error. However, you have a deeper problem:</p>\n\n<pre><code>class Foo f where\n  getInt :: f -&gt; Int\n\nclass Bar b where\n  getFooFromBar :: Foo f =&gt; b -&gt; f\n</code></pre>\n\n<p>That is, for all practical purposes, impossible. The type of <code>getFooFromBar</code> says you can use it to produce a result of <em>any</em> type <code>f</code> that has an instance of <code>Foo</code>. But how will you materialise this value for any <code>f</code>? It is no use reaching for any specific instance when defining <code>getFooFromBar</code>, as all you will get from that is a <code>Couldn't match type \u2018f\u2019 with \u2018Blah\u2019</code> type error. The immediate solution to that is the one you suggested, for a different reason, in the question: specifying the instance of <code>Foo</code> to use through the <code>Bar</code> instance. You might find it nicer to do with a type family, rather than a multi-parameter type class:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nclass Foo f where\n  getInt :: f -&gt; Int\n\nclass Foo (FooBar b) =&gt; Bar b where\n  type FooBar b :: *\n  getFooFromBar :: b -&gt; FooBar b\n\ninstance Foo Char where\n   getInt = const 99\n\ninstance Bar Char where\n  type FooBar Char = Char\n  getFooFromBar = const 'a'\n\nsomeFunction :: Bar b =&gt; b -&gt; Int\nsomeFunction = getInt . getFooFromBar\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; someFunction 'z'\n99 \n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 1560138, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/370b89d2b931def9f3df67326283b295?s=128&d=identicon&r=PG", "display_name": "tmortiboy", "link": "https://stackoverflow.com/users/1560138/tmortiboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 40414814, "answer_count": 1, "score": 3, "last_activity_date": 1478230949, "creation_date": 1478227141, "question_id": 40414449, "link": "https://stackoverflow.com/questions/40414449/haskell-class-dependencies", "title": "Haskell class dependencies", "body": "<p>The following code doesnt compile:</p>\n\n<pre><code>class Foo f where\n  getInt :: f -&gt; Int\n\nclass Bar b where\n  getFooFromBar :: Foo f =&gt; b -&gt; f\n\nsomeFunction :: Bar b =&gt; b -&gt; Int\nsomeFunction bar = getInt $ getFooFromBar bar\n</code></pre>\n\n<p>The error is <code>Could not deduce (Foo f) arising from a use of 'getInt' from the context (Bar b)</code></p>\n\n<p>I know I can fix the error by changing the class for <code>Bar</code> as follows:</p>\n\n<pre><code>class Foo f =&gt; Bar f b where\n  getFooFromBar :: b -&gt; f\n</code></pre>\n\n<p>But I would prefer if I didnt have to add <code>f</code> to all the instance signatures of <code>Bar</code>.</p>\n\n<p>Is there a way to do this by only keeping the <code>Foo f</code> constraint only on the <code>getFooFromBar</code> signature, rather than the whole class?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 5, "creation_date": 1478221456, "post_id": 40413635, "comment_id": 68077282, "body": "It seems you are trying to imitate an imperative loop from some other language. Don&#39;t do that, it will only lead to more confusion. In particular, unless you defined them somewhere else <code>while</code> and <code>notEmpty</code> don&#39;t exist at all."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7112701, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E7H1f7A5ybQ/AAAAAAAAAAI/AAAAAAAAYWw/Wzqjkl5qIoU/photo.jpg?sz=128", "display_name": "Mary Counts", "link": "https://stackoverflow.com/users/7112701/mary-counts"}, "edited": false, "score": 1, "creation_date": 1478221969, "post_id": 40413718, "comment_id": 68077429, "body": "Thanks a lot! I am just starting to learn so I&#39;m definitely getting used to Haskell after working mostly with object-oriented languages, so my tendency to use while is strong! I knew I needed some kind of loop here, so this helps me understand how I can do it in Haskell with recursion instead. Thanks again!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1478221981, "post_id": 40413718, "comment_id": 68077432, "body": "&quot;Note that the first implementation is much more efficient.&quot; -- Indeed. The second implementation is quadratic, as <code>length</code> and <code>last</code> are linear in the length of the list."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 23, "user_id": 7112701, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E7H1f7A5ybQ/AAAAAAAAAAI/AAAAAAAAYWw/Wzqjkl5qIoU/photo.jpg?sz=128", "display_name": "Mary Counts", "link": "https://stackoverflow.com/users/7112701/mary-counts"}, "edited": false, "score": 1, "creation_date": 1478222345, "post_id": 40413718, "comment_id": 68077529, "body": "@MaryCounts One bonus exercise you might want to try later is implementing <code>isPalindrome</code> without the predefined list manipulation functions (<code>reverse</code>, <code>last</code>, etc.). There is a nice solution for that in the middle of the answer to <a href=\"http://codereview.stackexchange.com/q/64798\">this Code Review question</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1478245844, "post_id": 40413718, "comment_id": 68084397, "body": "Note that <code>if x then y else False</code> is an antipattern which can be replaced by <code>x &amp;&amp; y</code>. The latter reads better: <code>xs</code> is a palindrome iff its tail equals its head <i>and</i> after removing head and tail the result is still palindrome."}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": true, "score": 2, "last_activity_date": 1478279165, "last_edit_date": 1478279165, "creation_date": 1478221131, "answer_id": 40413718, "question_id": 40413635, "link": "https://stackoverflow.com/questions/40413635/haskell-if-error/40413718#40413718", "title": "Haskell if error", "body": "<p>The easiest way to check if a string is a palindrome would probably be to check if it's equal to the reversed version of itself:</p>\n\n<pre><code>isPalindrome :: String -&gt; Bool\nisPalindrome str = str == reverse str\n</code></pre>\n\n<p>But since you said you have to use <code>head</code> and <code>tail</code>, I'll demonstrate an implementation using these functions:</p>\n\n<pre><code>palindrome2::String -&gt; Bool\npalindrome2 [] = True\npalindrome2 xs = head xs == last xs &amp;&amp; palindrome2 (take (length xs - 2) (tail xs))\n</code></pre>\n\n<p>I'm not sure what you were trying to do with <code>while</code>. Perhaps some sort of confusion coming from an imperative language? This implementation works recursively, checking if the head of the list is equal to the last term and nesting in to the list if they are equal. Evaluation terminates if the first and last terms are not equal (the string is not a palindrome), or once the base case is reached (the string is a palindrome).</p>\n\n<p>Note that the first implementation is much more efficient.</p>\n"}], "owner": {"reputation": 23, "user_id": 7112701, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E7H1f7A5ybQ/AAAAAAAAAAI/AAAAAAAAYWw/Wzqjkl5qIoU/photo.jpg?sz=128", "display_name": "Mary Counts", "link": "https://stackoverflow.com/users/7112701/mary-counts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 40413718, "answer_count": 1, "score": 2, "last_activity_date": 1478279165, "creation_date": 1478220538, "question_id": 40413635, "link": "https://stackoverflow.com/questions/40413635/haskell-if-error", "title": "Haskell if error", "body": "<p>I'm working on a palindrome checker in Haskell, but we must use head and last. My error is about the if statement, but I've tried many variations of this and I can't figure out why the if is a problem. Please help! Thank you!</p>\n\n<pre><code>palindrome2::String-&gt;Bool\npalindrome2 xs = while xs==notEmpty if head xs == last xs then True else False\n</code></pre>\n"}, {"tags": ["haskell", "monads", "io-monad", "traversable"], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1478211563, "post_id": 40412163, "comment_id": 68074509, "body": "So in my example I <i>am</i> guaranteed that &quot;1&quot; will print before &quot;2&quot; will print before &quot;3&quot; since &quot;1&quot; is left of &quot;2&quot; is left of &quot;3&quot; and printing is an effect?"}, {"owner": {"reputation": 14609, "user_id": 667648, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mTpbt.jpg?s=128&g=1", "display_name": "Dair", "link": "https://stackoverflow.com/users/667648/dair"}, "reply_to_user": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1478211619, "post_id": 40412163, "comment_id": 68074529, "body": "Yes. The order that they are printed is preserved."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1478212059, "post_id": 40412163, "comment_id": 68074696, "body": "Good answer you&#39;ve linked to. What I don&#39;t understand is, <i>why didn&#39;t you upvote it</i>?"}], "tags": [], "owner": {"reputation": 14609, "user_id": 667648, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mTpbt.jpg?s=128&g=1", "display_name": "Dair", "link": "https://stackoverflow.com/users/667648/dair"}, "is_accepted": false, "score": 7, "last_activity_date": 1478211470, "last_edit_date": 1495540124, "creation_date": 1478211470, "answer_id": 40412163, "question_id": 40412068, "link": "https://stackoverflow.com/questions/40412068/order-of-execution-with-haskells-mapm/40412163#40412163", "title": "Order of execution with Haskell&#39;s `mapM`", "body": "<p>There is no guarantee on the order of the evaluation but there is a guarantee on the order of the effects. For more information see <a href=\"https://stackoverflow.com/a/29754668/667648\">this answer that discusses <code>forM</code>.</a></p>\n\n<blockquote>\n  <p>You need to learn to make the following, tricky distinction:</p>\n  \n  <ol>\n  <li>The order of evaluation</li>\n  <li>The order of effects (a.k.a. \"actions\")</li>\n  </ol>\n  \n  <p>What\n  forM, sequence and similar functions promise is that the effects will\n  be ordered from left to right. So for example, the following is\n  guaranteed to print characters in the same order that they occur in\n  the string...</p>\n</blockquote>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Traversable.html#v:forM\" rel=\"nofollow noreferrer\">Note</a>: \"<code>forM</code> is <code>mapM</code> with its arguments flipped. For a version that ignores the results see <code>forM_</code>.\"</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478284851, "post_id": 40412361, "comment_id": 68107812, "body": "I prefer to break it down as far as <code>print = putStrLn . show</code>. You could go a bit further, but that at least explains the role of <code>Show</code>."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 10, "last_activity_date": 1478212441, "creation_date": 1478212441, "answer_id": 40412361, "question_id": 40412068, "link": "https://stackoverflow.com/questions/40412068/order-of-execution-with-haskells-mapm/40412361#40412361", "title": "Order of execution with Haskell&#39;s `mapM`", "body": "<p>If you evaluate <code>mapM print [\"1\", \"2\", \"3\"]</code> by expanding the definition of <code>mapM</code> you will arrive at (ignoring some irrelevant details)</p>\n\n<pre><code>print \"1\" &gt;&gt; print \"2\" &gt;&gt; print \"3\"\n</code></pre>\n\n<p>You can think of <code>print</code> and <code>&gt;&gt;</code> as abstract constructors of IO actions that cannot be evaluated any further, just as a data constructor like <code>Just</code> cannot be evaluated any further.</p>\n\n<p>The interpretation of <code>print s</code> is the action of printing <code>s</code>, and the interpretation of <code>a &gt;&gt; b</code> is the action that first performs <code>a</code> and then performs <code>b</code>. So, the interpretation of</p>\n\n<pre><code>mapM print [\"1\", \"2\", \"3\"] = print \"1\" &gt;&gt; print \"2\" &gt;&gt; print \"3\"\n</code></pre>\n\n<p>is to first print 1, then print 2, and finally print 3.</p>\n\n<p>How this is <em>actually</em> implemented in GHC is entirely a different matter which you shouldn't worry about for a long time.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1478285397, "post_id": 40417451, "comment_id": 68108093, "body": "Implementing the <code>Traversable</code> instance for <code>Data.Functor.Reverse</code> is not such a trivial exercise, and relies essentially on <code>Backwards</code>. It may bear mention that there can be nothing like <code>Backwards</code> for the <code>Monad</code> class."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478286580, "post_id": 40417451, "comment_id": 68108695, "body": "@dfeuer [1] Indeed. (What makes it a little trickier is that in the general <code>(Traversable f) =&gt; Traversable (Reverse f)</code> case you can&#39;t play with neither <code>(&lt;*&gt;)</code> nor the structure of the (unknown) <code>Traversable</code>.) By the way, I will add a link to <code>Data.Functor.Reverse</code>. [2] That is definitely worth mentioning; I will add a note about it. (I had chosen not to include an extra paragraph about <code>Monad</code>, and that remark was supposed to be made somewhere in it.) Useful reminders, thanks."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1478290678, "last_edit_date": 1495542798, "creation_date": 1478244831, "answer_id": 40417451, "question_id": 40412068, "link": "https://stackoverflow.com/questions/40412068/order-of-execution-with-haskells-mapm/40417451#40417451", "title": "Order of execution with Haskell&#39;s `mapM`", "body": "<p>Preliminary note: The answers by Reid Barton and Dair are entirely correct and fully cover your practical concerns. I mention that because partway through this answer one might have the impression that it contradicts them, which is not the case, as will be clear by the time we get to the end. That being clear, it is time to indulge in some language lawyering.</p>\n\n<blockquote>\n  <p>Is there any guarantee that [<code>mapM print</code>] will [print the list elements in order]?</p>\n</blockquote>\n\n<p>Yes, there is, as explained by the other answers. Here, I will discuss what might justify this guarantee.</p>\n\n<p>In this day and age, <code>mapM</code> is, by default, merely <code>traverse</code> specialised to monads:</p>\n\n<pre><code>traverse\n  :: (Traversable t, Applicative f) =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\nmapM\n  :: (Traversable t, Monad m) =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)\n</code></pre>\n\n<p>That being so, in what follows I will be primarily concerned with <code>traverse</code>, and how our expectations about the sequencing of effects relate to the <code>Traversable</code> class.</p>\n\n<p>As far as the production of effects is concerned, <code>traverse</code> generates an <code>Applicative</code> effect for each value in the traversed container and combines all such effects through the relevant <code>Applicative</code> instance. This second part is clearly reflected by the type of <code>sequenceA</code>, through which the applicative context is, so to say, factored out of the container:</p>\n\n<pre><code>sequenceA :: (Traversable t, Applicative f) =&gt; t (f a) -&gt; f (t a)\n\n-- sequenceA and traverse are interrelated by:\ntraverse f = sequenceA . fmap f\nsequenceA = traverse id\n</code></pre>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/src/Data.Traversable.html#line-184\" rel=\"nofollow noreferrer\">The <code>Traversable</code> instance for lists</a>, for example, is:</p>\n\n<pre><code>instance Traversable [] where\n    {-# INLINE traverse #-} -- so that traverse can fuse\n    traverse f = List.foldr cons_f (pure [])\n      where cons_f x ys = (:) &lt;$&gt; f x &lt;*&gt; ys\n</code></pre>\n\n<p>It is plain to see that the combining, and therefore the sequencing, of effects is done through <code>(&lt;*&gt;)</code>, so let's focus on it for a moment. Picking the <code>IO</code> applicative functor as an illustrative example, we can see <code>(&lt;*&gt;)</code> sequencing effects from left to right:</p>\n\n<pre><code>GHCi&gt; -- Superfluous parentheses added for emphasis.\nGHCi&gt; ((putStrLn \"Type something:\" &gt;&gt; return reverse) &lt;*&gt; getLine) &gt;&gt;= putStrLn\nType something:\nWhatever\nrevetahW\n</code></pre>\n\n<p><code>(&lt;*&gt;)</code>, however, sequences effects from left-to-right <a href=\"https://stackoverflow.com/a/14259453/2751851\">by convention, and not for any inherent reason</a>. As witnessed by <a href=\"https://hackage.haskell.org/package/transformers-0.5.2.0/docs/Control-Applicative-Backwards.html\" rel=\"nofollow noreferrer\">the <code>Backwards</code> wrapper from <em>transformers</em></a>, it is, in principle, always possible to implement <code>(&lt;*&gt;)</code> with right-to-left sequencing and still get a lawful <code>Applicative</code> instance. Without using the wrapper, it is also possible to take advantage of <code>(&lt;**&gt;)</code> from <code>Control.Applicative</code> to invert the sequencing:</p>\n\n<pre><code>(&lt;**&gt;) :: Applicative f =&gt; f a -&gt; f (a -&gt; b) -&gt; f b\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; import Control.Applicative\nGHCi&gt; (getLine &lt;**&gt; (putStrLn \"Type something:\" &gt;&gt; return reverse)) &gt;&gt;= putStrLn\nWhatever\nType something:\nrevetahW\n</code></pre>\n\n<p>Given that it is so easy to flip the sequencing of <code>Applicative</code> effects, one might wonder whether this trick might transfer to <code>Traversable</code>. For instance, let's say we implement...</p>\n\n<pre><code>esrevart :: Applicative f =&gt; (a -&gt; f b) -&gt; [a] -&gt; f [b]\n</code></pre>\n\n<p>... so that it is just like <code>traverse</code> for lists save for using <code>Backwards</code> or <code>(&lt;**&gt;)</code> to flip the sequencing of effects (I will leave that as an exercise for the reader). Would <code>esrevart</code> be a legal implementation of <code>traverse</code>? While we might figure it out by trying to prove the <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Traversable.html\" rel=\"nofollow noreferrer\">identity and composition laws of <code>Traversable</code></a> hold, that is actually not necessary: given that <code>Backwards f</code> for any applicative <code>f</code> is also applicative, an <code>esrevart</code> patterned after any lawful <code>traverse</code> will also follow the <code>Traversable</code> laws. <a href=\"https://hackage.haskell.org/package/transformers-0.5.2.0/docs/Data-Functor-Reverse.html\" rel=\"nofollow noreferrer\">The <code>Reverse</code> wrapper</a>, also part of <em>transformers</em>, offers a general implementation of this reversal.</p>\n\n<p>We have thus concluded that there can be legal <code>Traversable</code> instances that differ in the sequencing of effects. In particular, a list <code>traverse</code> that sequences effects from tail to head is conceivable. That doesn't make the possibility any less strange, though. To avoid utter bewilderment, <code>Traversable</code> instances are conventionally implemented with plain <code>(&lt;*&gt;)</code> and following the natural order in which the constructors are used to build the traversable container, which in the case of lists amounts to the expected head-to-tail sequencing of effects. One place where this convention shows up is in the automatic generation of instances by <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Compiler/DeriveFunctor#DeriveTraversable\" rel=\"nofollow noreferrer\">the <code>DeriveTraversable</code> extension</a>.</p>\n\n<p>A final, historical note. Couching this discussion, which is ultimately about <code>mapM</code>, in terms of the <code>Traversable</code> class would be a move of dubious relevance in a not so distant past. <code>mapM</code> was effectively subsumed by <code>traverse</code> only last year, but it has existed for much longer. For instance, the <a href=\"https://wiki.haskell.org/Language_and_library_specification#Historic_development_of_Haskell\" rel=\"nofollow noreferrer\">Haskell Report 1.3</a> from 1996, years before <code>Applicative</code> and <code>Traversable</code> came into being (not even <code>ap</code> is there, in fact), provides the following specification for <code>mapM</code>:</p>\n\n<pre><code>accumulate        :: Monad m =&gt; [m a] -&gt; m [a]\naccumulate        =  foldr mcons (return [])\n                     where mcons p q = p &gt;&gt;= \\x -&gt; q &gt;&gt;= \\y -&gt; return (x:y)\n\nmapM              :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]\nmapM f as         =  accumulate (map f as)\n</code></pre>\n\n<p>The sequencing of effects, here enforced through <code>(&gt;&gt;=)</code>, is left-to-right, for no other reason than it being the sensible thing to do.</p>\n\n<p>P.S.: It is worth emphasising that, while it is possible to write a right-to-left <code>mapM</code> in terms of the <code>Monad</code> operations (in the Report 1.3 implementation quoted here, for instance, it merely requires exchanging <code>p</code> and <code>q</code> in the right-hand side of <code>mcons</code>), there is no such thing as a general <code>Backwards</code> for monads. Since <code>f</code> in <code>x &gt;&gt;= f</code> is a <code>Monad m =&gt; a -&gt; m b</code> function which creates effects from values, the effects associated with <code>f</code> depend on <code>x</code>. As a consequence, a simple inversion of sequencing like that possible with <code>(&lt;*&gt;)</code> is not even guaranteed to be meaningful, let alone lawful.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 40412361, "answer_count": 3, "score": 4, "last_activity_date": 1478290678, "creation_date": 1478210939, "last_edit_date": 1478245693, "question_id": 40412068, "link": "https://stackoverflow.com/questions/40412068/order-of-execution-with-haskells-mapm", "title": "Order of execution with Haskell&#39;s `mapM`", "body": "<p>Consider the following Haskell statement:</p>\n\n<pre><code>mapM print [\"1\", \"2\", \"3\"]\n</code></pre>\n\n<p>Indeed, this prints \"1\", \"2\", and \"3\" in order.</p>\n\n<p><strong>Question:</strong> How do you know that <code>mapM</code> will <em>first</em> print \"1\", and <em>then</em> print \"2\", and <em>finally</em> print \"3\". Is there any guarantee that it will do this? Or is it a coincidence of how it is implemented deep within GHC?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1478209438, "post_id": 40411645, "comment_id": 68073686, "body": "In support of this type of refactoring, your <code>Change</code> type is a re-invention of the <code>Endo</code> type in <code>Data.Monoid</code>: <code>newtype Endo a = Endo { appEndo :: a -&gt; a }</code>."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 3, "creation_date": 1478212101, "post_id": 40411645, "comment_id": 68074708, "body": "@RussAbbott I would put the &quot;current state&quot; in a separate slot of the datatype instead of bundling it with one of the lists. It is natural to assume that there will always be a &quot;current state&quot;, after all."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1478221707, "post_id": 40411645, "comment_id": 68077353, "body": "@chepner, but <code>Endo</code> is actually useful, because <code>Endo a</code> has a <code>Monoid</code> instance. Less usefully, perhaps, <code>Endo</code> is an exponential functor. The <code>Change</code> type synonym, on the other hand, seems to do little more than obfuscate. But that&#39;s my opinion of most type synonyms."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1478222883, "post_id": 40411645, "comment_id": 68077657, "body": "@dfeuer That could be the kernel of an answer. The idea expressed in the question is very good, but a <code>type</code> synonym doesn&#39;t let you do anything interesting with it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478261283, "post_id": 40411645, "comment_id": 68092849, "body": "@dfeuer I never said it was an <i>identical</i> type; my point was that there is already a standard (and as you mentioned, a more useful) wrapper around functions of type <code>a -&gt; a</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 2, "last_activity_date": 1478252572, "creation_date": 1478252572, "answer_id": 40419437, "question_id": 40411645, "link": "https://stackoverflow.com/questions/40411645/is-it-useful-to-create-a-collection-of-generic-function-types-in-haskell/40419437#40419437", "title": "Is it useful to create a collection of generic function types in Haskell", "body": "<p>As it was mentioned earlier, you can use <code>Endo a</code> newtype from <code>Data.Monoid</code> instead of your <code>Change</code> type alias. It may be inconvenient sometimes to deal with wrapping/unwrapping. But you can find something useful in it's <code>Monoid</code> instance if you want composable <em>changes</em>.</p>\n\n<p>Regarding your <code>History</code> data type: it is well-known <code>ListZipper</code> in Haskell world. You can read about this concept in different places. But in your code you can already use existing package on hackage: <a href=\"http://hackage.haskell.org/package/ListZipper\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/ListZipper</a></p>\n\n<p>It has your functions and some others that you may find helpful.</p>\n\n<p><code>ToString</code> type alias is basically a type of <code>show</code> function without <code>Show</code> constraint. I don't know how you can convert something generic to <code>String</code> without <code>Show</code> type bound but I can't say more without looking at your code. So, my point here, is that you basically don't need <code>ToString</code> type alias. It is better to use standard functions and type classes.</p>\n"}], "owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1478252572, "creation_date": 1478209000, "last_edit_date": 1478221390, "question_id": 40411645, "link": "https://stackoverflow.com/questions/40411645/is-it-useful-to-create-a-collection-of-generic-function-types-in-haskell", "title": "Is it useful to create a collection of generic function types in Haskell", "body": "<p>This is a question about Haskell style.</p>\n\n<p>As a tutorial example, I created a little program that supports <code>undo</code> and <code>redo</code> operations. It uses a data structure with two stacks.</p>\n\n<pre><code>data History a = History [a] [a]\n</code></pre>\n\n<p>The first stack is a history of, say a game. The second stack stores states that were popped by <code>undo</code>. So</p>\n\n<pre><code>undo (History (x:xs) redoStack) = History xs (x:redoStack)\nundo history = history -- in case there is nothing to undo\n</code></pre>\n\n<p>and</p>\n\n<pre><code>redo (History hStack (x:redoStack)) = History (x:hStack) redoStack \nredo history = history -- in case there is nothing to redo\n</code></pre>\n\n<p>There is also a generic operation that applies a change to the current state.</p>\n\n<pre><code>applyAChange change (History (x:xs) _) = History ((change x):x:xs) []\n</code></pre>\n\n<p>The type of <code>applyAChange</code> is</p>\n\n<pre><code>applyAChange :: (a -&gt; a) -&gt; History a -&gt; History a\n</code></pre>\n\n<p>I decided to define a <code>Change</code> type:</p>\n\n<pre><code>type Change a = a -&gt; a\n</code></pre>\n\n<p>Then the type of <code>applyAChange</code> becomes</p>\n\n<pre><code>applyAChange :: Change a -&gt; Change (History a)\n</code></pre>\n\n<p>That seemed useful, and I used the <code>Change</code> type elsewhere in the code.</p>\n\n<hr>\n\n<p>In defining the <code>String</code> <strong>instance</strong> I found myself defining a number of functions with types like:</p>\n\n<pre><code>convertASomethingToString :: Something -&gt; String\n</code></pre>\n\n<p>So I defined a <code>ToString</code> type</p>\n\n<pre><code>type ToString a = a -&gt; String\n</code></pre>\n\n<p>This allowed me to write the preceding functions with types</p>\n\n<pre><code>convertASomethingToString :: ToString &lt;Something&gt;\n</code></pre>\n\n<p>All that seems nice and makes the code more informative. My questions are </p>\n\n<ol>\n<li>How much of this sort of thing is worth doing?</li>\n<li>As long as one does it, does it make sense to create a module that consists of these sorts of type definitions and import it? Is that a standard thing to do?</li>\n<li>Is there already a widely-used module of this sort with useful types?</li>\n</ol>\n\n<p>Thanks.</p>\n"}, {"tags": ["linux", "haskell", "system-calls", "ffi"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 2, "creation_date": 1478207153, "post_id": 40411122, "comment_id": 68072697, "body": "I&#39;d recommend returning a <code>ByteString</code> instead of a <code>String</code>, as the latter will imply a character encoding which may not be true. In order to create the <code>ByteString</code>, you&#39;ll likely want to <code>malloc</code> the buffer instead of using <code>allocaBytes</code>, and then reuse that pointer for the <code>ByteString</code>."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1478208410, "post_id": 40411122, "comment_id": 68073294, "body": "Your peek line is overly simplistic, actually incorrect since you are using <code>size</code> as the index from which to start reading.  Consider <a href=\"http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#v:packCStringLen\" rel=\"nofollow noreferrer\"><code>packCStringLen</code></a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1478208468, "post_id": 40411122, "comment_id": 68073324, "body": "Also, this API seems terribly dangerous.  At the least you should probably check <code>bytes &gt;= len</code> so users can&#39;t say <code>read fd 0 5000</code>, right?  EDIT: Actually it&#39;s trickier than that.   <code>fromIntegral bytes :: some type &gt;= fromIntegralLen :: that type</code> where the types match your casts / c binding."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1478208543, "post_id": 40411122, "comment_id": 68073359, "body": "@ThomasM.DuBuisson Yeah, I know. I want to make it work and then worry about correctness. :)"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1478210182, "post_id": 40411122, "comment_id": 68073972, "body": "@MichaelSnoyman Is this a reasonable start: <a href=\"https://gist.github.com/psibi/e01ae8e9fe760488685253916b27efbb\" rel=\"nofollow noreferrer\">gist.github.com/psibi/e01ae8e9fe760488685253916b27efbb</a> ? I&#39;m using <code>CString</code> as an intermediate type."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478212533, "post_id": 40411122, "comment_id": 68074878, "body": "You shouldn&#39;t use <code>packCString</code> because the data you read might contain null characters."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478213146, "post_id": 40411122, "comment_id": 68075133, "body": "@ReidBarton In that case, will replacing <code>packCString</code> with <code>packCStringLen ((castPtr ptr), fromIntegral size)</code> reasonable ?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478213608, "post_id": 40411122, "comment_id": 68075271, "body": "Then it looks okay, though you could perhaps avoid the extra allocation and copy by working with bytestring internals. But unrelatedly, you should not make an unsafe foreign call to <code>read</code>, which can block!"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478213946, "post_id": 40411122, "comment_id": 68075382, "body": "@ReidBarton Thanks, that was helpful."}], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 1, "last_activity_date": 1478209000, "creation_date": 1478209000, "answer_id": 40411646, "question_id": 40411122, "link": "https://stackoverflow.com/questions/40411122/writing-haskell-ffi-for-read-system-call/40411646#40411646", "title": "Writing Haskell FFI for read system call", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Foreign-C-String.html\" rel=\"nofollow noreferrer\">Foreign.C.String</a> is the traditional solution here.</p>\n"}, {"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 1, "last_activity_date": 1478299106, "last_edit_date": 1478299106, "creation_date": 1478239856, "answer_id": 40416369, "question_id": 40411122, "link": "https://stackoverflow.com/questions/40411122/writing-haskell-ffi-for-read-system-call/40416369#40416369", "title": "Writing Haskell FFI for read system call", "body": "<p>As per the suggestions of Michael Snoyman and Reid Barton, I finally came up with this solution as a start:</p>\n\n<pre><code>foreign import ccall safe \"read\" c_read :: CInt -&gt; Ptr () -&gt; CSize -&gt; IO CSsize\n\nread :: Int -- ^ file descriptor\n     -&gt; Int64 -- ^ Bytes to allocate\n     -&gt; Word64 -- ^ Read upto this many bytes\n     -&gt; IO (ByteString, Int64)\nread fd bytes len = do\n  (ptr :: Ptr ()) &lt;- mallocBytes (fromIntegral bytes)\n  size &lt;- c_read (fromIntegral fd) ptr (fromIntegral len)\n  bstring &lt;- packCStringLen (castPtr ptr, fromIntegral size) \n  free ptr\n  return (bstring, (fromIntegral size))\n</code></pre>\n"}], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 40416369, "answer_count": 2, "score": 1, "last_activity_date": 1478299106, "creation_date": 1478206725, "question_id": 40411122, "link": "https://stackoverflow.com/questions/40411122/writing-haskell-ffi-for-read-system-call", "title": "Writing Haskell FFI for read system call", "body": "<p>The <code>read</code> function is defined like this:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n\nssize_t read(int fd, void *buf, size_t len)\n</code></pre>\n\n<p>I want to write a Haskell FFI for this. This is my attempt (which doesn't compile):</p>\n\n<pre><code>foreign import ccall unsafe \"read\" c_read :: CInt -&gt; Ptr () -&gt; CSize -&gt; IO CSsize\n\nread :: Int -- ^ file descriptor\n     -&gt; Int64 -- ^ Bytes to allocate\n     -&gt; Word64 -- ^ Read upto this many bytes\n     -&gt; IO (String, Int64)\nread fd bytes len = do\n  allocaBytes (fromIntegral bytes) (\\ptr -&gt; do\n                       size &lt;- c_read (fromIntegral fd) ptr (fromIntegral len)\n                       dat &lt;- peekByteOff (castPtr ptr) (fromIntegral size) :: IO String\n                       return (dat, (fromIntegral size))\n                    )\n</code></pre>\n\n<p>It doesn't compile because there is no instance of <code>String</code> for Storable. Any hints on how to write a FFI for this ? </p>\n"}, {"tags": ["haskell", "increment"], "comments": [{"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1478221167, "post_id": 40410280, "comment_id": 68077216, "body": "This can be simplified by the way if you write <code>unless (null line) $ do ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": true, "score": 0, "last_activity_date": 1478205113, "creation_date": 1478205113, "answer_id": 40410724, "question_id": 40410280, "link": "https://stackoverflow.com/questions/40410280/make-a-total-in-an-haskell-main/40410724#40410724", "title": "Make a total in an haskell (main)", "body": "<p>Somehow you need to add the accumulation. The simplest change would probably be to factor out the recursive action and parameterize over the total, which is initially 0. Something like this:</p>\n\n<pre><code>inner n = do\n  putStrLn \"Enter your line\"\n  line &lt;- getLine\n  if line == \"\"\n     then return ()\n  else do\n      let v = n + nume line\n      inner v\n      print v\n\nmain = inner 0\n\nnume [] = 0\nnume (x:xs)\n |x == 'e' = 1 + nume xs\n | otherwise = nume xs\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 5438702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-vaDVG8z3zjs/AAAAAAAAAAI/AAAAAAAAAA8/qMa4mRUPOLU/photo.jpg?sz=128", "display_name": "Sartigan", "link": "https://stackoverflow.com/users/5438702/sartigan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 40410724, "answer_count": 1, "score": 0, "last_activity_date": 1478205113, "creation_date": 1478203438, "question_id": 40410280, "link": "https://stackoverflow.com/questions/40410280/make-a-total-in-an-haskell-main", "title": "Make a total in an haskell (main)", "body": "<p>Basically, I have a loop that checks how many 'e' a user entered in one line. The thing is, I want it to show the total of e's entered total after every lines. Let's say he enters one line with 1 'e' in it the result will be 1, then after he enters the 2nd line that has 2 'e' in it, the total would be 3\u2026 and so on until the line is empty.</p>\n\n<p>Here is my code so far. The problem with it: I don't know how to make a \"total\". I'm not sure if I'm clear... The current code will give the amount of 'e' found in each lines but not the total.</p>\n\n<pre><code>main = do\n  putStrLn \"Enter your line\"\n  line &lt;- getLine\n  if line == \"\"\n     then return ()\n  else do\n      let v = nume line\n      main\n      print v\n\nnume [] = 0\nnume (x:xs)\n |x == 'e' = 1 + nume xs\n | otherwise = nume xs\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Enter your line\nthere is 3 e\nEnter your line\nthere are 4 e\nEnter your line\nonly 1 e\nEnter your line\n\n1 &lt;&lt;-- Should be 8 (3+4+1)\n4 &lt;&lt;-- Should be 7 (4+3)\n3 &lt;&lt;-- ok\n</code></pre>\n"}, {"tags": ["haskell", "optimization"], "comments": [{"owner": {"reputation": 1051, "user_id": 713303, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sbOcy.png?s=128&g=1", "display_name": "modular", "link": "https://stackoverflow.com/users/713303/modular"}, "edited": false, "score": 0, "creation_date": 1478199523, "post_id": 40409184, "comment_id": 68068630, "body": "I tried <code>{-# NOINLINE append #-}</code>, to no effect."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1478200617, "post_id": 40409184, "comment_id": 68069194, "body": "I think you&#39;re misreading the output of the profiler. Your cost centre is the condition of the <code>if</code> statement, which is evaluated every time you call <code>append</code>, hence the hits to the cost centre. But the thunk that the <code>outer</code> variable points to is only evaluated once. If you put your cost centre inside <code>arg == &quot;outer&quot;</code> then you should see it only being hit once."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1478200804, "post_id": 40409184, "comment_id": 68069287, "body": "If you don&#39;t want the <code>if</code> condition to be evaluated multiple times, you could manually float it to the outside of the loop. <code>joinLists outer = go (if outer then (:) else flip const)</code> and redefine <code>go</code> to take an extra argument for <code>append</code>, rather than referring to its closure. I can&#39;t predict whether that&#39;d be faster for your inputs."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1478201030, "post_id": 40409184, "comment_id": 68069404, "body": "What happens if you define append like this: <code>append = if outer then (:) else flip const</code>? (I would test it myself, but I don&#39;t have GHC here right now.)"}, {"owner": {"reputation": 1051, "user_id": 713303, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sbOcy.png?s=128&g=1", "display_name": "modular", "link": "https://stackoverflow.com/users/713303/modular"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1478201687, "post_id": 40409184, "comment_id": 68069729, "body": "@BenjaminHodgson and duplode thanks for your comments, they practically answer my question (see the edits)."}, {"owner": {"reputation": 1051, "user_id": 713303, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sbOcy.png?s=128&g=1", "display_name": "modular", "link": "https://stackoverflow.com/users/713303/modular"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1478201705, "post_id": 40409184, "comment_id": 68069741, "body": "@duplode see above"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478203841, "post_id": 40409184, "comment_id": 68070884, "body": "If your actual goal is to make <code>joinLists</code> efficient, then you certainly don&#39;t want a call to the unknown function <code>append</code> in your inner loop."}, {"owner": {"reputation": 1051, "user_id": 713303, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sbOcy.png?s=128&g=1", "display_name": "modular", "link": "https://stackoverflow.com/users/713303/modular"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478204682, "post_id": 40409184, "comment_id": 68071360, "body": "@ReidBarton I suppose the only way to not use <code>append</code> function is to have two separate definitions for <code>go</code>, e.g. <code>goInner</code> and <code>goOuter</code>? That would be too premature optimization in my case, especially since in &quot;real world&quot; case I have both <code>outerLeft</code> and <code>outerRight</code>."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478204974, "post_id": 40409184, "comment_id": 68071526, "body": "Yes, you&#39;d have to manually &quot;specialize&quot; and create two (or four) copies of <code>joinLists</code>. Since you are already looking at this with the profiler, it seems like mature optimization to me."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478205386, "post_id": 40409184, "comment_id": 68071748, "body": "Actually, I lied. You could write <code>joinListsGeneric</code> which takes the <code>append</code> function as a parameter, have two cases in <code>joinLists</code> that pass the two possible functions in, and rely on inlining."}, {"owner": {"reputation": 1051, "user_id": 713303, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sbOcy.png?s=128&g=1", "display_name": "modular", "link": "https://stackoverflow.com/users/713303/modular"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1478206537, "post_id": 40409184, "comment_id": 68072397, "body": "@ReidBarton thanks for <code>joinListsGeneric</code> suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1478206671, "post_id": 40410541, "comment_id": 68072461, "body": "As an aside, <code>\\k -&gt; (k :)</code> is just <code>(:)</code>, but I like the symmetry with <code>\\k -&gt; id</code> (rather than <code>const id</code>)."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1478204377, "creation_date": 1478204377, "answer_id": 40410541, "question_id": 40409184, "link": "https://stackoverflow.com/questions/40409184/how-to-force-ghc-to-evaluate-static-expression-only-once/40410541#40410541", "title": "How to force GHC to evaluate static expression only once", "body": "<p>I would try pushing lambdas inwards:</p>\n\n<pre><code>append = if {-# SCC \"isOuter\" #-} outer then \\k -&gt; (k :) else \\k -&gt; id\n</code></pre>\n\n<p>The original code is essentially <code>\\k -&gt; if outer ...</code> which takes the argument first, and tests the guard later. The code above instead tests the guard <em>before</em> taking the argument.</p>\n\n<p>Alternative:</p>\n\n<pre><code>append | outer     = \\k -&gt; (k :) \n       | otherwise = \\k -&gt; id\n</code></pre>\n\n<p>One can further simplify those lambdas to a more readable form.</p>\n"}], "owner": {"reputation": 1051, "user_id": 713303, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sbOcy.png?s=128&g=1", "display_name": "modular", "link": "https://stackoverflow.com/users/713303/modular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "accepted_answer_id": 40410541, "answer_count": 1, "score": 7, "last_activity_date": 1478204377, "creation_date": 1478199170, "last_edit_date": 1478201555, "question_id": 40409184, "link": "https://stackoverflow.com/questions/40409184/how-to-force-ghc-to-evaluate-static-expression-only-once", "title": "How to force GHC to evaluate static expression only once", "body": "<p>I have a trivial example of SQL-like <code>join</code> for ordered lists: if <code>outer</code> parameter is <code>True</code> then it's union; otherwise it's intersection:</p>\n\n<pre><code>import System.Environment\n\nmain = do\n  [arg] &lt;- getArgs\n  let outer = arg == \"outer\"\n  print $ length $ joinLists outer [1..1000] [1,3..1000]\n\njoinLists :: (Ord a, Num a) =&gt; Bool -&gt; [a] -&gt; [a] -&gt; [a]\njoinLists outer xs ys = go xs ys\n  where\n  go [] _ = []\n  go _ [] = []\n  go xs@(x:xs') ys@(y:ys') = case compare x y of\n    LT -&gt; append x $ go xs' ys\n    GT -&gt; append y $ go xs ys'\n    EQ -&gt; x : go xs' ys'\n  append k = if {-# SCC \"isOuter\" #-} outer then (k :) else id\n</code></pre>\n\n<p>When I profile it, I see that <code>isOuter</code> condition is evaluated every time when <code>append</code> is called:</p>\n\n<pre><code>stack ghc -- -O2 -prof example.hs &amp;&amp; ./example outer +RTS -p &amp;&amp; cat example.prof \n\n                                                     individual      inherited\nCOST CENTRE MODULE                no.     entries  %time %alloc   %time %alloc\nMAIN        MAIN                   44          0    0.0   34.6     0.0  100.0\n isOuter    Main                   88        499    0.0    0.0     0.0    0.0\n</code></pre>\n\n<p>But I'd like the condition to be evaluated only once, so <code>append</code> in <code>go</code> loop is replaced with either <code>(k :)</code> or <code>id</code>. Can I force it somehow? Is it related to memoization?</p>\n\n<p>EDIT: Seems like I misinterpreted the profiler output. I added trace to <code>append</code> definition:</p>\n\n<pre><code>append k = if trace \"outer\" outer then (k :) else id\n</code></pre>\n\n<p>And <code>outer</code> is printed only once.</p>\n\n<p>EDIT2: If I replace <code>append</code> with point-free definition, then <code>if</code> condition is evaluated only once:</p>\n\n<pre><code> append = if outer then (:) else flip const\n</code></pre>\n"}]