[{"tags": ["performance", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 464, "user_id": 3435730, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b4cad01be7d94b2182896e7e9d241d3?s=128&d=identicon&r=PG&f=1", "display_name": "asg0451", "link": "https://stackoverflow.com/users/3435730/asg0451"}, "edited": false, "score": 0, "creation_date": 1500403023, "post_id": 45151070, "comment_id": 77317410, "body": "hey thanks for the response! i actually tried cassava in my first few iterations but it was just so, so much slower..."}, {"owner": {"reputation": 1336, "user_id": 794944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b885541101d504bbd39901d5d7fc1766?s=128&d=identicon&r=PG", "display_name": "Jack Henahan", "link": "https://stackoverflow.com/users/794944/jack-henahan"}, "reply_to_user": {"reputation": 464, "user_id": 3435730, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b4cad01be7d94b2182896e7e9d241d3?s=128&d=identicon&r=PG&f=1", "display_name": "asg0451", "link": "https://stackoverflow.com/users/3435730/asg0451"}, "edited": false, "score": 0, "creation_date": 1500405469, "post_id": 45151070, "comment_id": 77318950, "body": "Aww, that&#39;s disappointing. I was thinking about <code>pipes-csv</code>, too, maybe trying to exploit some streaming property so you can do your main operation on smaller sets of data. It looks like you&#39;re making one huge vector of vectors and then reordering the whole thing before writing it back to a ByteString. You might get better performance by only considering a single row at a time and streaming your results to the builder at the end rather than building a matrix only to break it down again."}, {"owner": {"reputation": 464, "user_id": 3435730, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b4cad01be7d94b2182896e7e9d241d3?s=128&d=identicon&r=PG&f=1", "display_name": "asg0451", "link": "https://stackoverflow.com/users/3435730/asg0451"}, "edited": false, "score": 0, "creation_date": 1500408027, "post_id": 45151070, "comment_id": 77320513, "body": "yeah. i also tried that approach. still very slow. benchmark showed that all of the computation time was in cassava, hence me cutting it out and resorting to raw vectors, which still incurs a construction cost but a lesser one.  I havent tried pipes-csv because cassava was my biggest bottleneck when i was using it."}, {"owner": {"reputation": 464, "user_id": 3435730, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b4cad01be7d94b2182896e7e9d241d3?s=128&d=identicon&r=PG&f=1", "display_name": "asg0451", "link": "https://stackoverflow.com/users/3435730/asg0451"}, "edited": false, "score": 0, "creation_date": 1500408082, "post_id": 45151070, "comment_id": 77320551, "body": "what i&#39;m really looking for I guess is a way to create vectors fast and cheap by splitting input lines... I don&#39;t suppose you know of such magic?"}], "tags": [], "owner": {"reputation": 1336, "user_id": 794944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b885541101d504bbd39901d5d7fc1766?s=128&d=identicon&r=PG", "display_name": "Jack Henahan", "link": "https://stackoverflow.com/users/794944/jack-henahan"}, "is_accepted": false, "score": 1, "last_activity_date": 1500339325, "last_edit_date": 1500339325, "creation_date": 1500315582, "answer_id": 45151070, "question_id": 44813575, "link": "https://stackoverflow.com/questions/44813575/fastest-way-to-parse-a-csv-file-into-a-vector-of-vectors-and-then-spit-it-back-o/45151070#45151070", "title": "Fastest way to parse a csv file into a vector of vectors and then spit it back out?", "body": "<p>I feel like you're working too hard. Manually building up and transforming all this data is error-prone and difficult to reason about (at least for me). <a href=\"https://hackage.haskell.org/package/cassava-0.5.0.0\" rel=\"nofollow noreferrer\"><code>cassava</code></a> is made for this kind of task.</p>\n\n<p>I can't totally unwrap the structure of your data from the code you've presented, so I'm going to use a trivial example to demonstrate how to achieve the goal \"reorder such and such column(s)\".</p>\n\n<p>Suppose you have a CSV describing a list of people and their ages.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE DeriveGeneric #-}\n\nimport Data.Text\nimport Data.Csv\nimport Data.Vector\n\ndata Person = Person { name :: !Text , age :: !Int } deriving (Generic, Show)\n\n-- We want to read and write TSVs\n\ndecodeOpt :: DecodeOptions\ndecodeOpt = defaultDecodeOptions { decDelimiter = fromIntegral (ord '\\t') }\n\nencodeOpt :: EncodeOptions\nencodeOpt = defaultEncodeOptions { encDelimiter = fromIntegral (ord '\\t') }\n\n-- NB: Ideally, your encode and decode should be inverses, but these aren't\ndec :: FromRecord a =&gt; HasHeader -&gt; ByteString -&gt; Either String (Vector a)\ndec = decodeWith decodeOpt\n\nenc :: ToRecord a =&gt; [a] -&gt; ByteString\nenc = encodeWith encodeOpt\n</code></pre>\n\n<p>Now we're gonna do some magic:</p>\n\n<pre><code>instance FromRecord Person\n\ninstance ToRecord Person where\n  toRecord (Person name age) = record [ toField age, toField name ]\n</code></pre>\n\n<p>And now we can take</p>\n\n<pre><code>dec NoHeader \"Roy\\t30\\r\\nJim\\t32\" :: Either String (Vector Person)\n</code></pre>\n\n<p>and get</p>\n\n<pre><code>Right [Person {name = \"Roy\", age = 30}\n      ,Person {name = \"Jim\", age = 32}]\n</code></pre>\n\n<p>And then reserialize them</p>\n\n<pre><code>enc [Person \"Roy\" 30, Person \"Jim\" 32]\n</code></pre>\n\n<p>with our result</p>\n\n<pre><code>\"30\\tRoy\\r\\n32\\tJim\\r\\n\"\n</code></pre>\n\n<p>So, this is all well and good assuming you're interested in just index-based column manipulation. If your CSV has column-names, you can be even more direct about things.</p>\n\n<pre><code>instance ToNamedRecord Person\ninstance DefaultOrdered Person\ninstance FromNamedRecord Person\n\n-- NB: Ideally, your encode and decode should be inverses, but these aren't\ndecName ::FromNamedRecord a =&gt; ByteString -&gt; Either String (Header, Vector a)\ndecName = decodeByNameWith decodeOpt\n\nencName :: ToNamedRecord a =&gt; [a] -&gt; ByteString\nencName = encodeByNameWith encodeOpt (header [\"age\", \"name\"])\n</code></pre>\n\n<p>Now we can do this</p>\n\n<pre><code>encName [Person \"Roy\" 30, Person \"Jim\" 32]\n</code></pre>\n\n<p>and get</p>\n\n<pre><code>\"age\\tname\\r\\n30\\tRoy\\r\\n32\\tJim\\r\\n\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>decName \"name\\tage\\r\\nRoy\\t30\\r\\nJim\\t32\" :: Either String (Header, Vector Person)\n</code></pre>\n\n<p>to get</p>\n\n<pre><code>Right ( [\"name\",\"age\"]\n      , [Person { name = \"Roy\", age = 30 }\n      , Person { name = \"Jim\", age = 32 }] )\n</code></pre>\n\n<p>Finally, if you really don't want any structure, <code>cassava</code> can deal with that, too.</p>\n\n<pre><code>dec NoHeader \"Roy\\t30\\r\\nJim\\t32\\r\\n\" :: Either String (Vector (Vector ByteString))\n</code></pre>\n\n<p>Which gives us</p>\n\n<pre><code>Right [[\"Roy\",\"30\"],[\"Jim\",\"32\"]]\n</code></pre>\n\n<p>And</p>\n\n<pre><code>enc [[\"Roy\",\"30\"],[\"Jim\",\"32\"]]\n</code></pre>\n\n<p>gives us</p>\n\n<pre><code>\"Roy\\t30\\r\\nJim\\t32\\r\\n\"\n</code></pre>\n\n<p>In this case, they're just regular lists, so you can do whatever transformations you like on the sublists to rearrange columns as you please.</p>\n"}], "owner": {"reputation": 464, "user_id": 3435730, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b4cad01be7d94b2182896e7e9d241d3?s=128&d=identicon&r=PG&f=1", "display_name": "asg0451", "link": "https://stackoverflow.com/users/3435730/asg0451"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1500339325, "creation_date": 1498689204, "question_id": 44813575, "link": "https://stackoverflow.com/questions/44813575/fastest-way-to-parse-a-csv-file-into-a-vector-of-vectors-and-then-spit-it-back-o", "title": "Fastest way to parse a csv file into a vector of vectors and then spit it back out?", "body": "<p>I'm trying to find the fastest method to reorder columns of a csv file (using the simple csv subset where there are no commas in cells). The reordering I'm doing through Vector.backpermute and that is fine; the bottleneck as indicated by RTS -p is the constructing of the vector of vectors that I do this operation on. The code below is the fastest version I could come up with. Anyone have any ideas?</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Main where\n\nimport           Control.Applicative\nimport           Control.Monad\nimport qualified Data.ByteString            as B\nimport qualified Data.ByteString.Builder    as BB\nimport qualified Data.ByteString.Lazy       as BL\nimport qualified Data.ByteString.Lazy.Char8 as BL8\nimport           Data.Char\nimport           Data.Foldable\nimport           Data.Monoid\nimport qualified Data.Vector                as V\nimport           Data.Word\nimport           Debug.Trace\nimport           System.Environment\nimport           System.IO\n\ndata Args = Args { cols :: V.Vector Int, filePath :: FilePath } deriving (Show)\n\n--\nw8 = fromIntegral . ord\nmconcat' :: (Foldable t, Monoid a) =&gt; t a -&gt; a\nmconcat' = foldl' (&lt;&gt;) mempty\n\nparseArgs :: [String] -&gt; Args\nparseArgs [colStr, filePath] = Args ((\\n -&gt; n-1) . read &lt;$&gt; V.fromList (split ',' colStr)) filePath\n  where split :: Char -&gt; String -&gt; [String]\n        split d str = gosplit d str []\n        gosplit d \"\" acc = reverse acc\n        gosplit d str acc = gosplit d (drop 1 $ dropWhile (/= d) str) $ takeWhile (/= d) str : acc\n\nreorder :: Args -&gt; BL.ByteString -&gt; BB.Builder\nreorder (Args cols _ ) bstr =\n  -- transform to vec matrix\n  let rows = V.filter (not . BL.null) $ V.fromList $ BL.split (w8 '\\n') bstr\n      m = (V.fromList . BL.split (w8 ',')) &lt;$&gt; rows -- n^2\n  -- reorder\n      m' = (flip V.backpermute) cols &lt;$&gt; m\n  -- build back to bytestring\n      numRows = length m'\n      numCols = length cols\n      builderM = mconcat' . V.imap (\\i v -&gt; BB.lazyByteString v &lt;&gt; (if i &lt; numCols - 1 then \",\" else \"\")) &lt;$&gt; m'\n      builderM' = mconcat' . V.imap (\\i v -&gt; v &lt;&gt; (if i &lt; numRows - 1 then \"\\n\" else \"\")) $ builderM\n  in builderM'\n\nmain :: IO ()\nmain = do\n  args &lt;- parseArgs &lt;$&gt; getArgs\n\n  withFile (filePath args) ReadMode $ \\h -&gt; do\n    csvData &lt;- BL.hGetContents h\n    BB.hPutBuilder stdout $ reorder args csvData\n</code></pre>\n\n<p>The program is invoked like: <code>$ reorder 2,1 x.csv</code> which says give me the second and then the first column for all the rows of that csv, so you can ignore the argument parsing bit.</p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"tags": [], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "is_accepted": true, "score": 0, "last_activity_date": 1498753984, "last_edit_date": 1498753984, "creation_date": 1498686714, "answer_id": 44813121, "question_id": 44812874, "link": "https://stackoverflow.com/questions/44812874/could-not-find-module-network-cgi-it-is-a-member-of-the-hidden-package-cgi-30/44813121#44813121", "title": "Could not find module \u2018Network.CGI\u2019 It is a member of the hidden package \u2018cgi-3001.3.0.2@cgi-3001.3.0.2-6aj81ZorTUo7RA61f0LJa8\u2019", "body": "<p>I was trying to import liftIO from the wrong module.</p>\n\n<p>A <a href=\"https://www.haskell.org/hoogle/?hoogle=liftIO\" rel=\"nofollow noreferrer\">hoogle search</a> for <code>liftIO</code> led me to Network.CGI, but the <code>liftIO</code> that I was looking for resides in <a href=\"https://hackage.haskell.org/package/transformers-0.4.2.0/docs/Control-Monad-IO-Class.html\" rel=\"nofollow noreferrer\"><code>Control.Monad.IO.Class</code></a>.</p>\n\n<p>The import command</p>\n\n<pre><code>&gt; :m Control.Monad.IO.Class\n</code></pre>\n\n<p>worked to import the appropriate <code>liftIO</code> for me.</p>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 44813121, "answer_count": 1, "score": 0, "last_activity_date": 1498753984, "creation_date": 1498685502, "question_id": 44812874, "link": "https://stackoverflow.com/questions/44812874/could-not-find-module-network-cgi-it-is-a-member-of-the-hidden-package-cgi-30", "title": "Could not find module \u2018Network.CGI\u2019 It is a member of the hidden package \u2018cgi-3001.3.0.2@cgi-3001.3.0.2-6aj81ZorTUo7RA61f0LJa8\u2019", "body": "<p>I am trying to use the <code>liftIO</code> function in the ghci repl.</p>\n\n<p><code>liftIO</code> appears to be defined in cgi's <a href=\"http://hackage.haskell.org/package/cgi-3001.3.0.2/docs/Network-CGI.html#v:liftIO\" rel=\"nofollow noreferrer\">Network.CGI module</a>. I attempt to import that, entering <code>:m Network.CGI</code> or <code>import Network.CGI</code>, and get the following error</p>\n\n<pre><code>&gt; :m Network.CGI\n\n&lt;no location info&gt;: error:\n    Could not find module \u2018Network.CGI\u2019\n    It is a member of the hidden package \u2018cgi-3001.3.0.2@cgi-3001.3.0.2-6aj81ZorTUo7RA61f0LJa8\u2019.\nPrelude Api.PesticideApplicationLog&gt; import Network.CGI\n</code></pre>\n\n<p><strong>How do I import <code>liftIO</code> for use in ghci?</strong></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498685996, "post_id": 44812528, "comment_id": 76606577, "body": "If by &quot;*-form&quot; you mean the module which precedes the prompt (i.e. <code>A</code> is the &quot;*-form&quot; in <code>*A&gt;</code>) then you can explicitly add such a module at any point after it&#39;s loaded with <code>:m + *A</code>; the &quot;most recently loaded module&quot; part refers to the mere convenience of GHCi automatically adding the most recent module to the context after you executed a <code>:load</code>. And indeed, it seems that is the first module passed to load which is automatically added to the context, not the most recent loaded one. I think that&#39;s a mistake in the docs. Regardless, it isn&#39;t relevant to your problem."}], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": false, "score": 3, "last_activity_date": 1498684605, "creation_date": 1498684605, "answer_id": 44812671, "question_id": 44812528, "link": "https://stackoverflow.com/questions/44812528/is-it-possible-join-two-modules-as-top-level-in-ghci/44812671#44812671", "title": "Is it possible join two modules as top-level in GHCI?", "body": "<p>When I'm developing and I want to use two or more modules at once in GHCi, here's what I do. Let's say I want to use <code>Control.Monad</code> and <code>Control.Lens</code>, and my own module which I'm programming with called <code>Main</code>:</p>\n\n<pre><code>&gt; :m Control.Lens Control.Monad\n</code></pre>\n\n<p>Now both <code>Control.Lens</code> and <code>Control.Monad</code> are in scope.</p>\n\n<p>Now at this point, it seems I forgot to add <code>Main</code>, so I can easily put a <code>+</code> which will add modules. This is so handy, I usually <strong>always</strong> use it, I was showing you the above solely so you could see how to import multiple modules at once.</p>\n\n<pre><code>&gt; :m + Main\n</code></pre>\n\n<p>Or, what I'd ordinarily do, as I just described:</p>\n\n<pre><code>&gt; :m + Main Control.Lens Control.Monad\n</code></pre>\n\n<p>I think <code>Main</code> is usually included by default, but you get the picture :)</p>\n\n<p>As to reloading, I use the <code>:r</code> command to reload, and yeah, it can suck that bindings are lost, but usually I put them into the code I'm writing in, sometimes temporarily, or I use the readline support of the OS to \"go up\" through the historical backscroll to find previous definitions.</p>\n\n<p>Happy Haskelling!</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498684605, "creation_date": 1498683893, "question_id": 44812528, "link": "https://stackoverflow.com/questions/44812528/is-it-possible-join-two-modules-as-top-level-in-ghci", "title": "Is it possible join two modules as top-level in GHCI?", "body": "<p>I discovered that changing order or paths given to <code>:load</code> changes visible bindings and it seems impossible to debug multiple modules at the same time. It is especially annoying as I lose bindings every time I <code>:load</code>.</p>\n\n<p>It seems there can be only one module in <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#ghci-scope\" rel=\"nofollow noreferrer\"><code>*-form</code></a> as suggested by wording of \"<a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#ghci-cmd-:load\" rel=\"nofollow noreferrer\">the most recently successfuly loaded module</a>\". Despite that, the top level module seems to one given as first argument to <code>:load</code>.</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "bytestring"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498683677, "post_id": 44812329, "comment_id": 76605552, "body": "Is converting to and from a strict bytestring, or copying the definition of <code>breakSubstring</code> (it uses <code>take</code> and <code>isPrefixOf</code> which are available for Lazy bytestrings) a suitable solution?"}, {"owner": {"reputation": 63, "user_id": 8053130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba9966601e4914c1df717d47a3bbbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn Rijkeboer", "link": "https://stackoverflow.com/users/8053130/martijn-rijkeboer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498721006, "post_id": 44812329, "comment_id": 76617503, "body": "@user2407038 Converting to and from strict is not an option. I&#39;m currently using a strict bytestring and trying to switch to a lazy bytestring because of memory usage. The <a href=\"https://github.com/haskell/bytestring/blob/master/Data/ByteString.hs#L1350\" rel=\"nofollow noreferrer\">breakSubString</a> function uses a number of <code>unsafeX</code> functions that are not available for lazy bytestrings. Maybe I can use the normal functions."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 8053130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba9966601e4914c1df717d47a3bbbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn Rijkeboer", "link": "https://stackoverflow.com/users/8053130/martijn-rijkeboer"}, "is_accepted": false, "score": 2, "last_activity_date": 1498739106, "creation_date": 1498739106, "answer_id": 44825099, "question_id": 44812329, "link": "https://stackoverflow.com/questions/44812329/split-lazy-bytestring-with-another-bytestring/44825099#44825099", "title": "Split lazy bytestring with another bytestring", "body": "<p>Answering my own question: I have created a <a href=\"https://github.com/haskell/bytestring/pull/129\" rel=\"nofollow noreferrer\">pull request</a> that adds <code>breakSubstring</code> to <code>Data.ByteString.Lazy</code> (adapted from the strict version).</p>\n\n<p>Until the pull request is merged, the following code can be used:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\nmodule Lib (breakSubstring) where\n\nimport Data.Bits (finiteBitSize, shiftL, (.|.), (.&amp;.))\nimport Data.Word (Word32)\nimport Prelude\n\nimport qualified Data.ByteString.Lazy as BSL\n\n\nbreakSubstring\n  :: BSL.ByteString\n  -&gt; BSL.ByteString\n  -&gt; (BSL.ByteString, BSL.ByteString)\nbreakSubstring pat =\n  case lp of\n    0 -&gt; \\src -&gt; (BSL.empty, src)\n    1 -&gt; BSL.break (== BSL.head pat)\n    _ -&gt; if lp * 8 &lt;= fromIntegral (finiteBitSize (0 :: Word))\n             then shift\n             else karpRabin\n  where\n    lp = BSL.length pat\n    karpRabin :: BSL.ByteString -&gt; (BSL.ByteString, BSL.ByteString)\n    karpRabin src\n        | BSL.length src &lt; lp = (src, BSL.empty)\n        | otherwise = search (rollingHash $ BSL.take lp src) lp\n      where\n        k           = 2891336453 :: Word32\n        rollingHash = BSL.foldl' (\\h b -&gt; h * k + fromIntegral b) 0\n        hp          = rollingHash pat\n        m           = k ^ lp\n        get = fromIntegral . BSL.index src\n        search !hs !i\n            | hp == hs &amp;&amp; pat == BSL.take lp b = u\n            | BSL.length src &lt;= i              = (src, BSL.empty)\n            | otherwise                        = search hs' (i + 1)\n          where\n            u@(_, b) = BSL.splitAt (i - lp) src\n            hs' = hs * k +\n                  get i -\n                  m * get (i - lp)\n    {-# INLINE karpRabin #-}\n\n    shift :: BSL.ByteString -&gt; (BSL.ByteString, BSL.ByteString)\n    shift !src\n        | BSL.length src &lt; lp = (src, BSL.empty)\n        | otherwise           = search (intoWord $ BSL.take lp src) lp\n      where\n        intoWord :: BSL.ByteString -&gt; Word\n        intoWord = BSL.foldl' (\\w b -&gt; (w `shiftL` 8) .|. fromIntegral b) 0\n        wp   = intoWord pat\n        mask = (1 `shiftL` fromIntegral (8 * lp)) - 1\n        search !w !i\n            | w == wp             = BSL.splitAt (i - lp) src\n            | BSL.length src &lt;= i = (src, BSL.empty)\n            | otherwise           = search w' (i + 1)\n          where\n            b  = fromIntegral (BSL.index src i)\n            w' = mask .&amp;. ((w `shiftL` 8) .|. b)\n    {-# INLINE shift #-}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 8053130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba9966601e4914c1df717d47a3bbbc5?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn Rijkeboer", "link": "https://stackoverflow.com/users/8053130/martijn-rijkeboer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1498739106, "creation_date": 1498683051, "question_id": 44812329, "link": "https://stackoverflow.com/questions/44812329/split-lazy-bytestring-with-another-bytestring", "title": "Split lazy bytestring with another bytestring", "body": "<p>How can I split a <strong>lazy</strong> bytestring with another bytestring (e.g. <code>\"\\r\\n\"</code>)? I'm looking for a function like the following:</p>\n\n<pre><code>BSL.ByteString -&gt; BSL.ByteString -&gt; [BSL.ByteString]\n</code></pre>\n\n<p>I know about <code>breakSubstring</code> but that function is only available for strict bytestrings. I also saw this <a href=\"https://stackoverflow.com/questions/1398322/split-bytestring-on-a-bytestring-instead-of-a-word8-or-char\">question</a>, but the solution is using a strict bytestring.</p>\n"}, {"tags": ["haskell", "types", "functor", "instances"], "comments": [{"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1498671759, "post_id": 44808885, "comment_id": 76598771, "body": "Two issues. Your good <code>fmap</code> has the property that <code>fmap (+2) (MyFunctor &quot;fred&quot; 5) = MyFunctor &quot;fred&quot; 7</code>. What&#39;s to become of <code>&quot;fred&quot;</code>? Also, a good <code>fmap</code> has the property that <code>fmap id x = x</code>, so this swapping business is wickedness."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1498679386, "post_id": 44808885, "comment_id": 76603161, "body": "I think <a href=\"https://stackoverflow.com/a/44139690/383200\">stackoverflow.com/a/44139690/383200</a> is relevant and can help to understand why things work this particular way, but this question isn&#39;t exactly a duplicate of that one."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1498671621, "creation_date": 1498671621, "answer_id": 44809265, "question_id": 44808885, "link": "https://stackoverflow.com/questions/44808885/defining-your-own-functor/44809265#44809265", "title": "Defining your own Functor", "body": "<p>The error message is quite verbose, and tells the whole story.</p>\n\n<p>First, it tells us that the type of <code>fmap</code>, in that instance should be</p>\n\n<pre><code>fmap :: forall a1 b. (a1 -&gt; b) -&gt; MyFunctor a a1 -&gt; MyFunctor a b\n</code></pre>\n\n<p>Hence, if <code>f</code> is any function <code>a1 -&gt; b</code>, we must make <code>fmap f</code> to have type <code>MyFunctor a a1 -&gt; MyFunctor a b</code>. </p>\n\n<p>Note how the return type is <code>MyFunctor a b</code>. Indeed, that's what GHC expected:</p>\n\n<pre><code>Expected type: MyFunctor a b\n</code></pre>\n\n<p>But instead it found something else:</p>\n\n<pre><code>Actual type: MyFunctor a1 b\n</code></pre>\n\n<p>How could that be? Well, <code>fmap</code> returns <code>MyFunctor b (g b)</code> and <code>g b</code> has type <code>b</code> (correct, as expected), but <code>b</code> (the value) has type <code>a1</code>, instead of the expected <code>a</code>.</p>\n\n<p>More practically, <code>fmap</code> can only alter the <code>b</code> component in <code>MyFunctor a b</code>, it can not affect the <code>a</code> component. This can be seen from the type signature of <code>fmap</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 0, "last_activity_date": 1498671649, "creation_date": 1498671649, "answer_id": 44809268, "question_id": 44808885, "link": "https://stackoverflow.com/questions/44808885/defining-your-own-functor/44809268#44809268", "title": "Defining your own Functor", "body": "<p>I don't think you can swap the values around like that. You've declared <code>MyFunctor</code> to contain two values of the generic types <code>a</code> and <code>b</code>. <strong>These are not necessarily of the same type.</strong> You could, for example, create a value like this:</p>\n\n<pre><code>MyFunctor \"foo\" 42\n</code></pre>\n\n<p>When you declare an instance of <code>Functor (MyFunctor a)</code>, you've basically said that for any generic type <code>a</code>, you can map <code>MyFunctor a b</code> to <code>MyFunctor a c</code>.</p>\n\n<p>For example, if <code>a</code> is <code>String</code>, as in the above example, you can map <code>MyFunctor String b</code> to <code>MyFunctor String c</code> if you have a function <code>b -&gt; c</code>.</p>\n\n<p>You can't swap the arguments, because the first value must retain its type.</p>\n\n<p>It can't do that in the above example if <code>c</code> is any other type than <code>String</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1498672620, "post_id": 44809360, "comment_id": 76599270, "body": "It would be also good to suggest proper abstraction of doing similar things \u2014 update value preserving the old one, if you&#39;re aware of it."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1498672792, "post_id": 44809360, "comment_id": 76599375, "body": "Are you referring to anything in particular? Such an abstraction probably exists (you can do similar things if you&#39;re working in State, for example), but I don&#39;t know of anything terribly common that maps to this idea."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1498672868, "post_id": 44809360, "comment_id": 76599414, "body": "I also can&#39;t propose something very common from head. Something with <code>State</code> or maybe some <code>lens</code>y solution might fit. But I&#39;m not sure."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1498672979, "post_id": 44809360, "comment_id": 76599483, "body": "Certainly you could write <code>data Weird a b = Weird a b</code> and define <code>weirdMap :: (a -&gt; b) -&gt; Weird x a -&gt; Weird a b</code>. I&#39;m not sure that a good typeclass for such a thing could be written, though, since it would at leas require multiparameter type classes."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 5, "last_activity_date": 1498671915, "creation_date": 1498671915, "answer_id": 44809360, "question_id": 44808885, "link": "https://stackoverflow.com/questions/44808885/defining-your-own-functor/44809360#44809360", "title": "Defining your own Functor", "body": "<blockquote>\n  <p>I then want to have the left value be replace with the right value before the operation.</p>\n</blockquote>\n\n<p>This is an illegal thing for a Functor to do: GHC is correctly telling you that the types don't work out. In particular, the left part of your <code>MyFunctor</code> value may have a different type than the right part, as in <code>MyFunctor 5 \"hello\"</code>. And since <code>fmap</code> must operate on only the last type parameter of your type, it must therefore leave the first part alone. Let's look at a more specific example.</p>\n\n<p>Recall that the type of <code>fmap</code> is </p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>And suppose you have an object you'd like to <code>fmap</code> over:</p>\n\n<pre><code>obj :: MyFunctor Int String\n</code></pre>\n\n<p>What, then, must be the type of <code>f</code> to call <code>fmap f obj</code>? To unify the involved types, we must have</p>\n\n<pre><code>f :: (String -&gt; a)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>fmap f obj :: MyFunctor Int a\n</code></pre>\n\n<p>So you can see that it is impossible to \"replace\" the first, Int, field with the previous value of the second, String field: the only thing allowed in that place is what was there before, an Int!</p>\n\n<p>Now, you might imagine that you could make the types work out if you changed your MyFunctor definition so that the two fields have the same type:</p>\n\n<pre><code>data MyFunctor a = MyFunctor a a\n\n-- Also illegal\ninstance Functor MyFunctor where\n  fmap f (MyFunctor a b) = MyFunctor b (f b)\n</code></pre>\n\n<p>But you can't do this either, because <code>b</code> and <code>f b</code> may be of different types, and the caller gets to choose what <code>f</code> to use, so your implementation of <code>fmap</code> may not assume they are the same.</p>\n\n<p>In fact, for any given data type, there is at most one legal definition of Functor: if you find one which is legal, you can be certain that any other definition is illegal: either the types won't match up, or it will break one of the two Functor laws:</p>\n\n<pre><code>fmap id == id\nfmap f . fmap g == fmap (f . g)\n</code></pre>\n\n<p>How might you break one of these laws while still having the types line up? By operating on some piece of the structure that is not part of the structure being <code>fmap</code>ed over. For example, often someone writes a (bad!) Functor like this:</p>\n\n<pre><code>data Counter a = Counter Int a\n\ninstance Functor Counter where\n  fmap f (Counter n x) = Counter (n + 1) (f x)\n</code></pre>\n\n<p>But this breaks both of the Functor laws, because it allows you to count how many times <code>fmap</code> has been called, which is supposed to be a detail which is not exposed. </p>\n\n<pre><code>fmap id (Counter 0 0) == Counter 1 0\n(fmap tail . fmap tail) /= fmap (tail . tail)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": false, "score": 2, "last_activity_date": 1498733807, "last_edit_date": 1498733807, "creation_date": 1498685981, "answer_id": 44812973, "question_id": 44808885, "link": "https://stackoverflow.com/questions/44808885/defining-your-own-functor/44812973#44812973", "title": "Defining your own Functor", "body": "<p>First up, it's really good you're trying to understand this. It's one of the underpinnings of all the amazing things in Haskell.</p>\n\n<p>Second up, I think there are better ways to understand <code>Functor</code> than trying to create an instance yourself. One of the best ways is to first up <strong>use</strong> <code>fmap</code> on as many existing <code>Functor</code> instances are you can find. There are already a bunch in the Prelude. Look at <strong>the source code</strong> of them to see how they're instantiated. This will give you an intuition for what they are.</p>\n\n<p>The type you've \"created\" above is actually already in the prelude, for example. It's called <code>(,)</code>. (Made a mistake of saying this was <code>Either</code> earlier - it's not, as that type is <code>data Either a b = Left a | Right b</code> sorry about that.)</p>\n\n<p>What you want to do is get a feeling for the roughly ten <code>Functor</code>s that are in Prelude first. But don't just get a feeling for the <code>Functor</code> part. Make sure you understand the underlying data type and structure. For this reason, this is going to be a bit of a futile exercise unless you truly understand types, algebraic data types (both sum and product), multi-parameter types and typeclasses (not how to use or instantiate typeclasses, just what they are, and how the mechanism works).</p>\n\n<p>If you want a good intuitive introducion to using the basics of these things, I'd say work through the book I helped work on to do this: <a href=\"http://happylearnhaskelltutorial.com\" rel=\"nofollow noreferrer\">http://happylearnhaskelltutorial.com</a>)</p>\n\n<p>There is a big difference between <strong>using</strong> <code>Functor</code> instances, and creating them. I think you'll get a much better intuition of what they mean and are if you use a bunch of them. Only then, IMHO, should you approach instantiating one yourself. At that point, also, it's a good idea to look up the laws, because they matter. This should clear up any misconceptions you have of what they are or what they could be.</p>\n\n<p>To put you on the path, though, they are about applying a function within the most shallow level of some structure. That structure <em>is</em> the structure of the type in question. So, in a <code>List</code>, it'll be all the \"values within the list\" (for want of a better way to describe lists), because if you look at the defined type of <code>List</code>, you'll see that that's actually the most shallow level of a list. To understand why, though, you need to really understand the type of lists in Haskell.</p>\n\n<p>So, I would check out how the following types work as <code>Functor</code>s: <code>Maybe</code>, <code>List</code> (aka <code>[]</code>), <code>Either</code>, <code>Data.Map</code>, <code>(-&gt;)</code>, <code>(,)</code>. <code>Data.Tree</code> (rose trees), the <code>Identity</code> type in <code>Control.Monad.Identity</code> (just about the simplest parameterized algebraic data type you can have, it wraps its value: <code>data Identity a = Identity a</code>). Do a search for more (there are heaps!)</p>\n\n<p>I wish you a happy time!</p>\n"}], "owner": {"reputation": 315, "user_id": 4175994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iLwio.jpg?s=128&g=1", "display_name": "IDon&#39;tUnderstandOOP", "link": "https://stackoverflow.com/users/4175994/idontunderstandoop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 44809360, "answer_count": 4, "score": 2, "last_activity_date": 1498733807, "creation_date": 1498670228, "last_edit_date": 1498671192, "question_id": 44808885, "link": "https://stackoverflow.com/questions/44808885/defining-your-own-functor", "title": "Defining your own Functor", "body": "<p>I've been trying to understand what a Functor is in Haskell, and for that I've want an example of a Functor, without any other properties.</p>\n\n<p>The working example I came up with was</p>\n\n<pre><code>data MyFunctor a b = MyFunctor a b deriving Show\ninstance Functor (MyFunctor a) where\n  fmap g (MyFunctor a b) = MyFunctor a $ g (b)\n</code></pre>\n\n<p>which I guess is a semi-practical Functor as the left value can be stored safely while the right value operated on. I then want to have the left value be replaced with the right value before the operation. So that...</p>\n\n<pre><code>Main&gt; fmap (+2) MyFunctor 2 5\nMyFunctor 5 7\n</code></pre>\n\n<p>Changing the instance declaration to do that however, yields an error.</p>\n\n<pre><code>data MyFunctor a b = MyFunctor a b deriving Show\ninstance Functor (MyFunctor a) where\n  fmap g (MyFunctor a b) = MyFunctor b $ g (b)\n</code></pre>\n\n<p>Which I don't understand, or know what to search to find a similar enough question to help me.</p>\n\n<pre><code>C:\\Haskell\\func.hs:3:28: error:\n    * Couldn't match type `a1' with `a'\n      `a1' is a rigid type variable bound by\n        the type signature for:\n          fmap :: forall a1 b. (a1 -&gt; b) -&gt; MyFunctor a a1 -&gt; MyFunctor a b\n        at C:\\Haskell\\func.hs:3:3\n      `a' is a rigid type variable bound by\n        the instance declaration at C:\\Haskell\\func.hs:2:10\n      Expected type: MyFunctor a b\n        Actual type: MyFunctor a1 b\n    * In the expression: MyFunctor b $ g (b)\n      In an equation for `fmap':\n          fmap g (MyFunctor a b) = MyFunctor b $ g (b)\n      In the instance declaration for `Functor (MyFunctor a)'\n    * Relevant bindings include\n        b :: a1 (bound at C:\\Haskell\\func.hs:3:23)\n        a :: a (bound at C:\\Haskell\\func.hs:3:21)\n        g :: a1 -&gt; b (bound at C:\\Haskell\\func.hs:3:8)\n        fmap :: (a1 -&gt; b) -&gt; MyFunctor a a1 -&gt; MyFunctor a b\n          (bound at C:\\Haskell\\func.hs:3:3)\n</code></pre>\n"}, {"tags": ["haskell", "functor", "category-theory"], "comments": [{"owner": {"reputation": 767, "user_id": 1004209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a54755a618402efbb59b68327aa89003?s=128&d=identicon&r=PG", "display_name": "shotor", "link": "https://stackoverflow.com/users/1004209/shotor"}, "edited": false, "score": 2, "creation_date": 1498663649, "post_id": 44806585, "comment_id": 76593489, "body": "The laws and those categories come from a branch of mathematics called Category Theory. Asking why that specific law has been chosen is kind of tricky. A definition is really just something someone came up with that they thought would be useful and other people agreed. So somebody thought of the idea of a <code>Functor</code>; a mapping between categories. The way you describe something mathematically is by defining laws it should confirm to (behavior)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 7, "creation_date": 1498663792, "post_id": 44806585, "comment_id": 76593604, "body": "<code>Monoid</code>, <code>Functor</code> etc. aren&#39;t categories. They&#39;re <i>type classes</i>. A mathematician would say, they&#39;re <i>definitions</i> of a concept, and then give <a href=\"https://en.wikipedia.org/wiki/Axiom\" rel=\"nofollow noreferrer\">axioms</a> to describe what&#39;s meant. These axioms correspond to the laws you&#39;re asking about. \u2014 It so happens that many of these laws actually come from category theory. In any case I recommend <a href=\"https://www.youtube.com/watch?v=I8LbkfSSR58\" rel=\"nofollow noreferrer\">Bartosz Milewski&#39;s lectures</a>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1498670402, "post_id": 44806585, "comment_id": 76597974, "body": "a certain set of laws w.r.t. a certain construction gets called by a certain name, in maths. that&#39;s all."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498683906, "post_id": 44806585, "comment_id": 76605662, "body": "&quot;why does id+compose define a functor&quot; - because &quot;functor&quot; is just a word for &quot;a structure which supports id+compose with such and such laws&quot;. It&#39;s like asking &quot;why is red called red?&quot;. The answer is tautological. The question you should ask instead, is why is id+compose such a useful and common idiom. To get the answer, read any intro to category theory text."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498676520, "post_id": 44808593, "comment_id": 76601600, "body": "I hate <code>mconcat</code> as an example, TBH, because in practice you usually <i>do</i> care how a fold associates, for efficiency reasons. This is really a problem for both <code>mconcat</code> and <code>foldMap</code>: in each case you only know one of the two (actually more than two) important facts you&#39;d need to implement the operation efficiently. In practice, <code>foldMap</code> is a bit better because you can kind of hack around its weaknesses with <code>Endo</code>, or in some cases more horribly with magmas posing as monoids. But I think we really just don&#39;t have a really great way to handle the problem yet."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498676848, "post_id": 44808593, "comment_id": 76601786, "body": "A particularly nasty example is <code>mconcat</code> for snoc lists. There&#39;s no clearly optimal implementation."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498681800, "post_id": 44808593, "comment_id": 76604610, "body": "@dfeuer yeah the fact that it&#39;s a method of the class for efficiency doesn&#39;t support my argument very well does it"}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 6, "last_activity_date": 1498672228, "last_edit_date": 1498672228, "creation_date": 1498669237, "answer_id": 44808593, "question_id": 44806585, "link": "https://stackoverflow.com/questions/44806585/how-laws-help-to-validate-the-meaning-of-categories-in-haskell/44808593#44808593", "title": "How laws help to validate the meaning of categories in haskell", "body": "<p>leftaroundabout corrected your terminology a bit, but to elaborate: a <em>category</em> in category theory is an abstraction that consists of objects, transformations between those objects, and the ability to compose those transformations (where this composition is associative). We don't very often talk about categories themselves in haskell, but some of the abstractions we use which come from category theory we talk about as living more or less <em>in the category we call <a href=\"https://wiki.haskell.org/Hask\" rel=\"nofollow noreferrer\">Hask</a></em>. There is a representation of the <em>category</em> abstraction in <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Category.html\" rel=\"nofollow noreferrer\">Control.Category</a>; it's a more general version of <code>(.)</code>.</p>\n\n<p>But I would forget about the abstraction called <em>category</em> for now. The important thing to understand is that that the way we express abstractions like <em>category</em> in haskell is with <em>type classes</em>.</p>\n\n<p>You ask why the laws are the way they are. The hallmark of a good abstraction is that it is <em>general enough to be widely applicable</em>, while still <em>giving us something useful</em>.</p>\n\n<p>I think <code>Monoid</code> is the best example to consider. Lists, sets, the integers with respect to addition (and with respect to multiplication), functions from a thing to a monoid, etc. all form a monoid: that is we can define implementations for <code>mempty</code> and <code>mappend</code> which satisfy the laws you can read about <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html\" rel=\"nofollow noreferrer\">here</a>, so it's clearly widely applicable.</p>\n\n<p>But what do the laws give us? The laws let us write more useful code that is <em>generic in the choice of monoid</em>. For instance knowing that <code>mappend</code> is associative lets us define a single:</p>\n\n<pre><code>mconcat :: [a] -&gt; a\n</code></pre>\n\n<p>and our users don't need to care about whether this is implemented with a <code>foldr</code> or a <code>foldl</code> or something else. It also means the compiler is free to choose the optimal order of our fold based on the context. The fact that we have an identity object means that this function can be safely called on the empty list.</p>\n\n<p>The monoid laws are also essential  in the context of distributed computing too, e.g. you have the map-reduce pattern, in which a monoidal reduce operation may be freely applied in parallel over your distributed \"list\".</p>\n\n<p>So when you ditch the laws you get something less useful. But why <em>these laws</em>? I think the simple answer is that because people have found them useful. It's also the case that relaxing or removing laws can create something <em>more general</em> and also useful in different contexts. For instance in haskell we have the <code>Semigroup</code> class, or in mathematics you have non-euclidean geometries.</p>\n"}, {"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 4, "last_activity_date": 1498673137, "last_edit_date": 1498673137, "creation_date": 1498672313, "answer_id": 44809455, "question_id": 44806585, "link": "https://stackoverflow.com/questions/44806585/how-laws-help-to-validate-the-meaning-of-categories-in-haskell/44809455#44809455", "title": "How laws help to validate the meaning of categories in haskell", "body": "<h2>A Long Rambling Ode to Functors</h2>\n\n<blockquote>\n  <p>Categories, functors, natural transformations, limits and colimits appeared almost out of nowhere in a paper by Eilenberg &amp; Mac\u2009Lane (1945) entitled \u201cGeneral Theory of Natural Equivalences.\u201d We say \u201calmost,\u201d because their earlier paper (1942) contains specific functors and natural transformations at work, limited to groups. A desire to clarify and abstract their 1942 results led Eilenberg &amp; Mac\u2009Lane to devise category theory. The central notion at the time, as their title indicates, was that of natural transformation. In order to give a general definition of the latter, they defined functor, borrowing the term from Carnap, and in order to define functor, they borrowed the word \u2018category\u2019 from the philosophy of Aristotle, Kant, and C. S. Peirce, but redefining it mathematically.</p>\n</blockquote>\n\n<p>Thus speaks the <a href=\"https://plato.stanford.edu/entries/category-theory/#2\" rel=\"nofollow noreferrer\">Stanford Encyclopedia of Philosophy</a>, an exceptionally wonderful resource if you want to dive into some citations into early CT papers. This paper, \"General Theory of Natural Equivalences,\" is (I would say) a must-read for you. (<a href=\"http://www.ams.org/journals/tran/1945-058-00/S0002-9947-1945-0013131-6/S0002-9947-1945-0013131-6.pdf\" rel=\"nofollow noreferrer\">You can circumvent the academic paywalls by searching for the title on Google, but here's a link that may or may not die soon.</a>)</p>\n\n<p>Let's take <code>Functor</code> as an example. The three laws are</p>\n\n<ul>\n<li>There exists an <code>f a -&gt; f b</code> for every <code>a -&gt; b</code> (we express this as a theorem with the type <code>(a -&gt; b) -&gt; f a -&gt; f b</code> and we prove it by defining the function in Haskell value terms)</li>\n<li><code>fmap id = id</code></li>\n<li><code>fmap (f . g) = fmap f . fmap g</code></li>\n</ul>\n\n<p>The typeclass <code>Functor</code> is meant to represent categorical functors in this way: if an instance <code>Functor f</code> exists, then we can treat <code>f</code> as a functor <code>F</code> from <strong>Hask</strong> to <strong>F(Hask)</strong>. This alone is not useful, but category theory has this way of luring you into proving powerful, general results from simple, trivial properties about mathematical objects.</p>\n\n<p>These three laws follow directly from Eilenberg and Mac Lane's original definition:</p>\n\n<p><img src=\"https://i.imgur.com/CX8kzCB.png\" alt=\"screenshot\"></p>\n\n<p>The notation is antiquated but the ideas are the same.</p>\n\n<p>But, again, <em>why</em>? Why did we rest this foundational idea in category theory on these notions of objects, arrows, identity, composition, and distribution? A helpless answer is that they \"work.\" Functors, once defined like this, appear everywhere: groups, vector spaces, topologies, graphs, <code>Reader/State/IO</code>, self-referentially within CT itself. They are <em>just</em> specific enough to allow the proof of various properties and <em>just</em> general enough to allow these proved properties to be interesting and useful.</p>\n\n<p>A more helpful answer might be to read the introduction to Eilenberg and Mac Lane's paper, where they carefully carve out space for the work (which appeared almost out of nowhere!) that they are about to do. They take a vector space <code>L</code> and its conjugate space <code>T(L)</code>; they notice that you can prove an isomorphism between the two but only if you can fix a basis. Then they take <code>L</code> and its iterated conjugate space <code>T(T(L))</code>; now here is an isomorphism that exists for all finite <code>L</code> <em>without any special basis</em>. This they call \"naturality,\" a notion of elegance attached to a notion of equality. Once you notice this you begin to see it everywhere.</p>\n\n<p>But to begin talking about this you first need to give a name to the thing that maps from <code>L</code> to <code>T(L)</code> to <code>T(T(L))</code>. And that name and its definition must be broad enough to apply to groups and topologies and whatever else you have on hand. So that's a functor. And its laws are adopted from pre-existing laws in each field. In software engineering terms, we might say that a functor is the refactoring of mathematical laws.</p>\n\n<p>The analogy here to Haskell programming is that there are functions that show up all the time in other languages. You will see a <code>mapMaybe :: (a -&gt; b) -&gt; Maybe a -&gt; Maybe b</code> or <code>mapPromise :: (a -&gt; b) -&gt; Promise a -&gt; Promise b</code> or <code>mapState :: (a -&gt; b) -&gt; State r a -&gt; State r b</code>. Perhaps not in those exact forms; perhaps as methods on a generic class instead if you're stuck in OOP land. There is something being duplicated in each of these library functions. There appears to be a natural equivalence between the universe of all the types and then the universe of <code>Maybe</code>/<code>State r</code>/<code>Promise</code> applied to all these types. You might even note that a language with algebraic data types can, as Ed Kmett points out, <a href=\"https://www.reddit.com/r/haskell/comments/2w05a0/edward_kmett_the_free_theorem_for_fmap/compdc8/\" rel=\"nofollow noreferrer\">automatically generate these functions</a>.</p>\n\n<p>So, for example, why do we insist that identity be preserved in the mapping? Well it lets you automatically generate the one unique <code>fmap</code> per each ADT. And it makes equational reasoning easier because if you see <code>fmap id</code> you can automatically substitute <code>id</code>. Or maybe the reverse, where if you see <code>id</code> you can automatically substitute <code>fmap id</code>. And it works well with the free theorems for <code>fmap</code>. And a litany of other reasons. It was a guess made by mere mortals that paid off.</p>\n\n<p>So, in another language, we would document or blog about this collection of same-looking <code>map*</code> functions as a curio of a mysterious life unled. But with typeclasses and strong types and, heck I'll see it, parametricity we can actually encode the idea in a language like Haskell. And that's the wonderful thing about Haskell.</p>\n"}], "owner": {"reputation": 1055, "user_id": 4071245, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/XCJqT.jpg?s=128&g=1", "display_name": "Aravindh S", "link": "https://stackoverflow.com/users/4071245/aravindh-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1498673137, "creation_date": 1498663086, "question_id": 44806585, "link": "https://stackoverflow.com/questions/44806585/how-laws-help-to-validate-the-meaning-of-categories-in-haskell", "title": "How laws help to validate the meaning of categories in haskell", "body": "<p>All categories in haskell (Monoid, Functor, Monad etc) have corresponding laws which an instance must satisfy in order to guarantee the category works as expected. What I am not able to understand is that how a specific law has been chosen for a category? For example, what is the reasoning behind choosing id &amp; composition laws for functor?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 1, "creation_date": 1498661362, "post_id": 44805608, "comment_id": 76591676, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/44797426/counting-getting-level-of-a-hierarchical-data\">Counting/Getting &quot;Level&quot; of a hierarchical data</a>"}, {"owner": {"reputation": 1649, "user_id": 3684713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qo7tw.jpg?s=128&g=1", "display_name": "overactor", "link": "https://stackoverflow.com/users/3684713/overactor"}, "edited": false, "score": 0, "creation_date": 1498665006, "post_id": 44805608, "comment_id": 76594526, "body": "Maybe you made a mistake when copying your code, but your parentheses appear to be unbalanced."}, {"owner": {"reputation": 1649, "user_id": 3684713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qo7tw.jpg?s=128&g=1", "display_name": "overactor", "link": "https://stackoverflow.com/users/3684713/overactor"}, "edited": false, "score": 0, "creation_date": 1498665097, "post_id": 44805608, "comment_id": 76594604, "body": "Regardless, you can&#39;t just add an Interview to a Maybe Int, you&#39;ll have to use fmap."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "reply_to_user": {"reputation": 1649, "user_id": 3684713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qo7tw.jpg?s=128&g=1", "display_name": "overactor", "link": "https://stackoverflow.com/users/3684713/overactor"}, "edited": false, "score": 0, "creation_date": 1498668112, "post_id": 44805608, "comment_id": 76596584, "body": "@overactor autocorrect strikes again"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498680374, "post_id": 44805608, "comment_id": 76603753, "body": "@JoeSteel If someone&#39;s answer doesn&#39;t work for you the best thing to do is ask for clarification (with a specific error message, or some expected/actual output) in a comment to the answer. Don&#39;t edit your question to ask follow-up questions"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498677603, "post_id": 44808099, "comment_id": 76602193, "body": "You seem to have missed a (ridiculous, of course) teacher-imposed rule in the question: &quot;I am <i>not</i> allowed to use any helper functions&quot;."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498716390, "post_id": 44808099, "comment_id": 76614875, "body": "@dfeuer, the second part of that very sentence says, &quot;and I am supposed to use the maybe function&quot;.  Not sure what other function you&#39;re talking about.  The reference to fmap was just to show how to do it more succinctly.  Of course, technically speaking, even <code>+</code> and <code>.</code> are functions."}], "tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": false, "score": 0, "last_activity_date": 1498667980, "last_edit_date": 1498667980, "creation_date": 1498667538, "answer_id": 44808099, "question_id": 44805608, "link": "https://stackoverflow.com/questions/44805608/haskell-function-for-checking-if-element-is-in-tree-returning-depth/44808099#44808099", "title": "Haskell Function for checking if element is in Tree, returning Depth", "body": "<p>This function doesn't need to be a lambda:</p>\n\n<pre><code>contains x t =\n</code></pre>\n\n<p>Adding <code>x</code> to the case serves no purpose, since you only match it back to <code>x</code>.  You can instead use pattern matching in the function head:</p>\n\n<pre><code>contains _ Empty = Nothing\n</code></pre>\n\n<p>The <code>Node</code> case has three sub-cases, where the value being searched for is less-than, greater-than, or equal to the value in the <code>Node</code>.  If you order them that way, you get a symmetry from the less-than and greater-than tests, and can handle the equal case with an <code>otherwise</code>.</p>\n\n<p>When recusring, you are going to get a <code>Maybe Int</code>, to which you want to add one.  You can't do that directly because the <code>Int</code> is inside the <code>Maybe</code>.  Normally, you would lift the addition, but I suspect that this is where the required call to <code>maybe</code> should go (however unnatural it may seem):</p>\n\n<pre><code>contains x (Node x' l r) | x &lt; x' = maybe Nothing (Just . (+1)) $ contains x l\n                         | x &gt; x' = maybe Nothing (Just . (+1)) $ contains x r\n                         | otherwise = Just 0\n</code></pre>\n\n<p>Instead of using <code>maybe</code>, the <code>(+1)</code> could have been lifted into the <code>Maybe</code> with <code>fmap</code> (or <code>&lt;$&gt;</code>):</p>\n\n<pre><code>... = fmap (+1) $ contains ...\n</code></pre>\n\n<p>Using <code>maybe</code> is unnatural because it has to explicitly pass the <code>Nothing</code>, and also re-wrap the <code>Just</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 8226044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f335b3aead6b12030d0f2fb3b04da7?s=128&d=identicon&r=PG&f=1", "display_name": "JoeSteel", "link": "https://stackoverflow.com/users/8226044/joesteel"}, "edited": false, "score": 0, "creation_date": 1498676805, "post_id": 44808275, "comment_id": 76601756, "body": "Thanks! This is almost correct. You need to add &quot;heap&quot; when the contains functions is called,  so the correct version would be: &quot;contains heap x l&quot; and &quot;contains heap x r&quot; (only figuered it out after finding a working implementation)  However this somehow does not deliver correct answeres for ALL cases."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498677432, "post_id": 44808275, "comment_id": 76602090, "body": "The tree&#39;s meant to be a min heap, isn&#39;t it? Not a binary search tree. The ordering invariant of a min heap is &quot;the current node is smaller than either of its children&quot;, not &quot;the left subtree contains elements smaller than the current node, and the right subtree contains elements greater than the current node&quot;. Picking a child by comparing <code>x</code> with <code>x1</code> isn&#39;t right."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 43, "user_id": 8226044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f335b3aead6b12030d0f2fb3b04da7?s=128&d=identicon&r=PG&f=1", "display_name": "JoeSteel", "link": "https://stackoverflow.com/users/8226044/joesteel"}, "edited": false, "score": 0, "creation_date": 1498677940, "post_id": 44808275, "comment_id": 76602376, "body": "@JoeSteel The heap is the tree, right? It&#39;s the second parameter (<code>t</code>). The <code>contains</code> function should not take three parameters."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498678035, "post_id": 44808275, "comment_id": 76602420, "body": "@BenjaminHodgson Drat, I skipped that part of the question and just fixed the obvious problem for a <code>contains</code> function in an ordered tree. Yes, the algorithm is plain wrong for a Heap."}], "tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": false, "score": 0, "last_activity_date": 1498668133, "creation_date": 1498668133, "answer_id": 44808275, "question_id": 44805608, "link": "https://stackoverflow.com/questions/44805608/haskell-function-for-checking-if-element-is-in-tree-returning-depth/44808275#44808275", "title": "Haskell Function for checking if element is in Tree, returning Depth", "body": "<blockquote>\n  <p>This does not work, since I get a parse error on input <code>|</code></p>\n</blockquote>\n\n<p>Your previous line misses a closing parenthesis.</p>\n\n<blockquote>\n  <p>I got a Typ error about <code>(1+ (contains x l))</code>, so this probably is not correct.</p>\n</blockquote>\n\n<p>The idea is totally correct, the issue is that <code>contains x l</code> returns a <code>Maybe Int</code> instead of an <code>Int</code> so you cannot directly add to that. You can only add to the result when it's a <code>Just</code>. There's a helper function that does exactly that, do something to <code>Just</code>s and keep <code>Nothing</code>s: <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Maybe.html#v:fmap\" rel=\"nofollow noreferrer\"><code>fmap</code></a> (from <code>Functor</code>).</p>\n\n<pre><code>contains = \\x t -&gt; case (x,t) of \n(x,Empty)-&gt; Nothing\n(x,tx@(Node x1 l1 r1)) \n    |x==x1 -&gt; Just 0 \n    |x&gt;x1  -&gt; fmap (1+) (contains x l)\n    |x&lt;x1  -&gt; fmap (1+) (contains x r)\n</code></pre>\n\n<p>Btw, I'd write this as</p>\n\n<pre><code>contains x Empty        = Nothing\ncontains x (Node v l r) = if x == v \n    then Just 0\n    else fmap (+1) $ contains x $ if x &gt; v then l else r\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498677285, "post_id": 44808389, "comment_id": 76602026, "body": "While newcomers probably find <code>foldr</code> a little easier to think about, I think it&#39;s much easier to get the definitions right if you define <code>foldMap</code> instead. With <code>foldr</code>, it&#39;s much too easy to get the order all mixed up. The only exceptions are for things that are really list-like, or (like <code>LogicT</code>) very closely related to lists."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498677531, "post_id": 44808389, "comment_id": 76602153, "body": "@dfeuer Yeah, I find <code>foldMap</code> easier to work with too. I went with <code>foldr</code> in this instance, at risk of getting things in the wrong order in my code (I <i>think</i> I got it right), because the answer is already pretty dense and I didn&#39;t want to digress into an explanation of <code>Monoid</code>."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 2, "last_activity_date": 1506552498, "last_edit_date": 1506552498, "creation_date": 1498668480, "answer_id": 44808389, "question_id": 44805608, "link": "https://stackoverflow.com/questions/44805608/haskell-function-for-checking-if-element-is-in-tree-returning-depth/44808389#44808389", "title": "Haskell Function for checking if element is in Tree, returning Depth", "body": "<p>One way of structuring <code>contains :: Eq a =&gt; a -&gt; Tree a -&gt; Maybe Integer</code> is to first <em>label</em> each element in your tree with its depth, using something like <a href=\"https://stackoverflow.com/a/36480067/1523776\">this</a>, then <em>fold</em> the tree to find the element you're looking for, pulling its depth out with it. You can do this without very much code!</p>\n\n<p>Jumping right in where <a href=\"https://stackoverflow.com/a/36480067/1523776\">this answer</a> left off, here's <code>contains</code>.</p>\n\n<pre><code>contains :: Eq a =&gt; a -&gt; Tree a -&gt; Maybe Integer\ncontains x = fmap fst . find ((== x) . snd) . labelDepths\n</code></pre>\n\n<p>That's the whole function! This is classic functional programming style: rather than hand-crank a bespoke recursive tree traversal function I've structured the code as a <em>pipeline</em> of reusable operations. In Haskell pipelines are constructed using the <em>composition</em> operator <code>(.)</code> and are read from left to right. The result of <code>labelDepths</code> is passed to <code>find ((== x) . snd)</code>, whose result is then passed to <code>fmap fst</code>.</p>\n\n<p><code>labelDepths :: Tree a -&gt; Tree (Integer, a)</code>, which I've explained in detail in <a href=\"https://stackoverflow.com/a/36480067/1523776\">the answer I linked above</a>, attaches an <code>Integer</code> depth to each element of the input tree.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Foldable.html#v:find\" rel=\"nofollow noreferrer\"><code>find :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a</code></a> is a standard function which extracts the first element of a container (like a tree, or a list) that satisfies a predicate. In this instance, the <code>Foldable</code> structure in question is a <code>Tree</code>, so <code>t ~ Tree</code> and <code>find :: (a -&gt; Bool) -&gt; Tree a -&gt; Maybe a</code>. The predicate I've given to <code>find</code> is <code>((== x) . snd)</code>, which returns <code>True</code> if the second element of its input tuple equals <code>x</code>: <code>find ((== x) . snd) :: Tree (Integer, a) -&gt; Maybe (Integer, a)</code>. <code>find</code> works by <em>folding</em> the input structure - testing its elements one at a time until it finds one that matches the predicate. The order in which elements are processed is defined by the container's <code>Foldable</code> instance, of which more below.</p>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Functor.html#v:fmap\" rel=\"nofollow noreferrer\"><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code></a> is another standard function. It applies a <em>mapping</em> function uniformly to each element of a container, transforming its elements from type <code>a</code> to type <code>b</code>. This time the container in question is the return value of <code>find</code>, which is a <code>Maybe</code>, so <code>fmap :: (a -&gt; b) -&gt; Maybe a -&gt; Maybe b</code>. The mapping function I've supplied is <code>fst</code>, which extracts the first element of a tuple: <code>fmap fst :: Maybe (Integer, a) -&gt; Maybe Integer</code>.</p>\n\n<p>So putting it all together, you can see that this is a fairly direct implementation of my English description of the process above. First we label every element in the tree with its depth, then we find an element which matches the item we're looking for, then we extract the depth with which the element was previously labelled.</p>\n\n<hr>\n\n<p>I mentioned above that <code>Tree</code> is a <code>Foldable</code> container. In fact, this isn't the case quite yet - there's no instance of <code>Foldable</code> for <code>Tree</code>. The easiest way to get a <code>Foldable</code> instance for <code>Tree</code> is to turn on the <code>DeriveFoldable</code> GHC extension and utter the magic words <code>deriving Foldable</code>.</p>\n\n<pre><code>{-# LANGUAGE DeriveFoldable #-}\ndata Tree x = Empty | Node x (Tree x) (Tree x) deriving Foldable\n</code></pre>\n\n<p>This automatically-implemented instance of <code>Foldable</code> will perform a preorder traversal, processing the tree in a top-down fashion. (<code>x</code> is considered to be \"to the left of\" <code>l</code> and <code>r</code> in the expression <code>Node x l r</code>.) You can adjust the derived traversal order by adjusting the layout of the <code>Node</code> constructor.</p>\n\n<p>That said, I'm guessing that this is an assignment and you're not allowed to modify the definition of <code>Tree</code> or apply any language extensions. So you'll need to hand-write your own instance of <code>Foldable</code>, following the template at the bottom of this post. Here's an implementation of <code>foldr</code> which performs a preorder traversal.</p>\n\n<pre><code>instance Foldable Tree where\n    foldr f z Empty = z\n    foldr f z (Node x l r) = f x (foldr f (foldr f z r) l)\n</code></pre>\n\n<p>The <code>Node</code> case is the interesting one. We fold the tree from right to left (since this is a <code>foldr</code>) and from bottom to top. First we fold the right subtree, placing <code>z</code> at the rightmost leaf. Then we use the aggregated result of the right subtree as the seed for folding the left subtree. Finally we use the result of folding all of the <code>Node</code>'s children as the aggregator to apply to <code>f x</code>.</p>\n\n<hr>\n\n<p>Hopefully you didn't find this answer too advanced! (Happy to answer any questions you have.) While the other answers do a good job of showcasing how to write recursive tree traversal functions, I really wanted to give you a glimpse of the real power of functional programming. When you think at a higher level - breaking down a problem into its component parts, structuring operations as pipelines, and learning to spot common patterns like <em>zipping</em>, <em>folding</em> and <em>mapping</em> - you can be very productive and solve problems with very little code.</p>\n\n<hr>\n\n<hr>\n\n<p><strong>An instance of Foldable for a binary tree</strong></p>\n\n<p>To instantiate <code>Foldable</code> you need to provide a definition for at least <code>foldMap</code> or <code>foldr</code>.</p>\n\n<pre><code>data Tree a = Leaf\n            | Node (Tree a) a (Tree a)\n\ninstance Foldable Tree where\n    foldMap f Leaf = mempty\n    foldMap f (Node l x r) = foldMap f l `mappend` f x `mappend` foldMap f r\n\n    foldr f acc Leaf = acc\n    foldr f acc (Node l x r) = foldr f (f x (foldr f acc r)) l\n</code></pre>\n\n<p>This implementation performs an <a href=\"https://en.wikipedia.org/wiki/Tree_traversal#In-order\" rel=\"nofollow noreferrer\">in-order traversal</a> of the tree.</p>\n\n<pre><code>ghci&gt; let myTree = Node (Node Leaf 'a' Leaf) 'b' (Node Leaf 'c' Leaf)\n\n--    +--'b'--+\n--    |       |\n-- +-'a'-+ +-'c'-+\n-- |     | |     |\n-- *     * *     *\n\nghci&gt; toList myTree\n\"abc\"\n</code></pre>\n\n<p>The <code>DeriveFoldable</code> extension allows GHC to generate <code>Foldable</code> instances based on the structure of the type. We can vary the order of the machine-written traversal by adjusting the layout of the <code>Node</code> constructor.</p>\n\n<pre><code>data Inorder a = ILeaf\n               | INode (Inorder a) a (Inorder a)  -- as before\n               deriving Foldable\n\ndata Preorder a = PrLeaf\n                | PrNode a (Preorder a) (Preorder a)\n                deriving Foldable\n\ndata Postorder a = PoLeaf\n                 | PoNode (Postorder a) (Postorder a) a\n                 deriving Foldable\n\n-- injections from the earlier Tree type\ninorder :: Tree a -&gt; Inorder a\ninorder Leaf = ILeaf\ninorder (Node l x r) = INode (inorder l) x (inorder r)\n\npreorder :: Tree a -&gt; Preorder a\npreorder Leaf = PrLeaf\npreorder (Node l x r) = PrNode x (preorder l) (preorder r)\n\npostorder :: Tree a -&gt; Postorder a\npostorder Leaf = PoLeaf\npostorder (Node l x r) = PoNode (postorder l) (postorder r) x\n\nghci&gt; toList (inorder myTree)\n\"abc\"\nghci&gt; toList (preorder myTree)\n\"bac\"\nghci&gt; toList (postorder myTree)\n\"acb\"\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8226044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f335b3aead6b12030d0f2fb3b04da7?s=128&d=identicon&r=PG&f=1", "display_name": "JoeSteel", "link": "https://stackoverflow.com/users/8226044/joesteel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1226, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1506552498, "creation_date": 1498660674, "last_edit_date": 1498678078, "question_id": 44805608, "link": "https://stackoverflow.com/questions/44805608/haskell-function-for-checking-if-element-is-in-tree-returning-depth", "title": "Haskell Function for checking if element is in Tree, returning Depth", "body": "<p>I am currently doing an assigment for a class in which I have to implement a function which checks if an element is in a tree.</p>\n\n<p>It is supposed to return <code>Nothing</code> when the element is not in the tree and <code>Just</code> (depth at which it was found) when it is.</p>\n\n<p>An example:</p>\n\n<pre><code>sample1  \n##1\n#3 2\n###7 5   6 4\n\n - contains 6 sample1 returns Just 2 \n - contains 1 sample1 returns Just 0  \n - contains 2 sample1 returns Just 1 \n - contains 8 sample1 returns Nothing\n</code></pre>\n\n<p>Here is what we are given:</p>\n\n<p>Heap functional data structure:</p>\n\n<pre><code>module Fdata.Heap where\n\n-- A signature for min-heaps\ndata Heap e t = Heap {\n  empty :: t e,\n  insert :: e -&gt; t e -&gt; t e,\n  findMin :: t e -&gt; Maybe e,\n  deleteMin :: t e -&gt; Maybe (t e),\n  merge :: t e -&gt; t e -&gt; t e,\n  contains :: e -&gt; t e -&gt; Maybe Int\n}\n</code></pre>\n\n<p>An implementation of self-adjusting heaps:</p>\n\n<pre><code>import Fdata.Heap\nimport Fdata.Tree\n\n-- An implementation of self-adjusting heaps\nheap :: (Eq e, Ord e) =&gt; Heap e Tree\nheap = Heap {\n  empty = Empty,\n  insert = \\x t -&gt; merge' (Node x Empty Empty) t,\n  findMin = \\t -&gt; case t of\n    Empty -&gt; Nothing\n    (Node x _ _) -&gt; Just x,\n  deleteMin = \\t -&gt; case t of\n    Empty -&gt; Nothing\n    (Node _ l r) -&gt; Just (merge' r l), \n  merge = \\l r -&gt; case (l, r) of\n    (Empty, t) -&gt; t\n    (t, Empty) -&gt; t\n    (t1@(Node x1 l1 r1), t2@(Node x2 l2 r2)) -&gt;\n      if x1 &lt;= x2\n        then Node x1 (merge' t2 r1) l1\n        else Node x2 (merge' t1 r2) l2,\n  contains = \\x t -&gt; case (x,t) of \n    (x,Empty)-&gt; Nothing\n    (x,tx@(Node x1 l1 r1) -&gt; \n      |x==x1 = Just 0 \n      |x&gt;x1  = (1+ (contains x l)\n      |x&lt;x1  = (1+ (contains x r)\n\n\n}\n    where \n        merge' = merge heap\n</code></pre>\n\n<p>The tree implementation</p>\n\n<pre><code>module Fdata.Tree where\n\nimport Fdata.Heap\n\ndata Tree x\n  = Empty\n  | Node x (Tree x) (Tree x)\n    deriving (Eq, Show)\n\nleaf x = Node x Empty Empty\n\n-- Convert a list to a heap\nlist2heap :: Heap x t -&gt; [x] -&gt; t x\nlist2heap i = foldl f z\n  where\n    f = flip $ insert i\n    z = empty i\n\n-- Convert a heap to a list\nheap2list :: Heap x t -&gt; t x -&gt; [x]\nheap2list i t\n  = case (findMin i t, deleteMin i t) of\n      (Nothing, Nothing) -&gt; []\n      (Just x, Just t') -&gt; x : heap2list i t'\n</code></pre>\n\n<p>I am supposed to implement the <code>contains</code> function in the implementation for self-adjusting heaps.</p>\n\n<p>I am <em>not</em> allowed to use any helper functions and I am supposed to use the <code>maybe</code> function.</p>\n\n<p>My current implementation:</p>\n\n<pre><code>contains = \\x t -&gt; case (x,t) of \n(x,Empty) -&gt; Nothing\n(x,tx@(Node x1 l1 r1))  \n    |x==x1 -&gt; Just 0 \n    |x&gt;x1  -&gt; (1+ (contains x l1)\n    |x&lt;x1  -&gt; (1+ (contains x r1)\n</code></pre>\n\n<p>This does not work, since I get a parse error on input <code>|</code>. \nI really dont know how to fix this since I did use 4 spaces instead of tabs and according to this: <a href=\"https://wiki.haskell.org/Case\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Case</a>\nthe syntax is correct...</p>\n\n<p>I once managed to fix this, but I got a type error about <code>(1+ (contains x l)</code>, so this probably is not correct.</p>\n\n<p>Any hint would be appreciated.</p>\n\n<p>EDIT: \nThanks to everyone who answered!\nReally appreciate that everyone took the time to explain their answers in great detail.</p>\n\n<p>First of all: \nthere were some smaller mistakes, as pointed out by some of you in the comments: </p>\n\n<p>I missed one closing parenthesis and accidentially named one argument <code>l1</code> and another <code>r1</code> and afterwards used <code>r</code> and <code>l</code>. \nFixed both mistakes.</p>\n\n<p>Someone wrote that I do not need to use a lambda function. The problem is when I use something like:</p>\n\n<pre><code>contains _ Empty = Nothing\n</code></pre>\n\n<p>I get the error:</p>\n\n<blockquote>\n  <p>parse Error on input '_'.</p>\n</blockquote>\n\n<p>However, lambda functions do not give me any errors about the input arguments.</p>\n\n<p>Currently the only function that works without any errors is:</p>\n\n<pre><code>contains = \\e t -&gt; case (e,t) of\n(_,Empty) -&gt; Nothing\n(e , Node x t1 t2) -&gt;\n    if e == (head (heap2list heap (Node x t1 t2)))\n        then Just 0\n        else if (fmap (+1) (contains heap e t1))== Nothing\n                    then (fmap (+1) (contains heap e t2))\n                    else (fmap (+1) (contains heap e t1))\n</code></pre>\n\n<p>Found at:\n<a href=\"https://stackoverflow.com/questions/44797426/counting-getting-level-of-a-hierarchical-data\">Counting/Getting &quot;Level&quot; of a hierarchical data</a></p>\n\n<p>Found by:Krom</p>\n"}, {"tags": ["haskell", "existential-type", "repa"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1498660451, "post_id": 44805467, "comment_id": 76590978, "body": "You&#39;ll have to use an actual <code>data</code> declaration, but you can do <code>data Tile p a = forall d. Tile { _array :: Array d Dim2 a }</code>."}, {"owner": {"reputation": 1620, "user_id": 643684, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sGlFM.jpg?s=128&g=1", "display_name": "Colin Woodbury", "link": "https://stackoverflow.com/users/643684/colin-woodbury"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1498661010, "post_id": 44805467, "comment_id": 76591402, "body": "That&#39;s closer to what I need, yeah. But woops, turns out that <code>d</code> has some typeclass constraints elsewhere :S"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1498683203, "post_id": 44805467, "comment_id": 76605304, "body": "You can also put the constraints in the <code>data</code> declaration. <code>data Showable= forall a. Show a =&gt; SomeShow a</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1620, "user_id": 643684, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sGlFM.jpg?s=128&g=1", "display_name": "Colin Woodbury", "link": "https://stackoverflow.com/users/643684/colin-woodbury"}, "is_accepted": false, "score": 1, "last_activity_date": 1498662106, "last_edit_date": 1498662106, "creation_date": 1498661657, "answer_id": 44805997, "question_id": 44805467, "link": "https://stackoverflow.com/questions/44805467/variable-inner-types-for-wrapped-repa-array/44805997#44805997", "title": "Variable inner types for wrapped Repa array", "body": "<p>I was able to get around the issue by forcing the wrapped <code>Array</code> to always contain the <code>D</code> type param by using the <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html#v:delay\" rel=\"nofollow noreferrer\"><code>delay</code> function</a>.</p>\n\n<p>This also allowed me to keep <code>Tile</code> as a <code>newtype</code> and also define a <code>Functor</code> instance for it.</p>\n"}], "owner": {"reputation": 1620, "user_id": 643684, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sGlFM.jpg?s=128&g=1", "display_name": "Colin Woodbury", "link": "https://stackoverflow.com/users/643684/colin-woodbury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498706377, "creation_date": 1498660254, "last_edit_date": 1498706377, "question_id": 44805467, "link": "https://stackoverflow.com/questions/44805467/variable-inner-types-for-wrapped-repa-array", "title": "Variable inner types for wrapped Repa array", "body": "<p>I'm attempting to write a thin wrapper around <a href=\"https://hackage.haskell.org/package/repa\" rel=\"nofollow noreferrer\">repa</a> to provide extra constraints for some domain-specific work I'm doing. I have the type:</p>\n\n<pre><code>newtype Tile p r a = Tile { _array :: Array r DIM2 a }\n</code></pre>\n\n<p>where <code>Array</code> comes from <code>repa</code>. I'd like to hide the <code>r</code> because it adds noise to type signatures and makes <code>Tile</code> a leaky abstraction:</p>\n\n<pre><code>newtype Tile p a = Tile { _array :: Array ? DIM2 a }  -- what should `?` be?\n</code></pre>\n\n<p>Unfortunately, that <code>r</code> can change between repa operations. Most of the time it's <code>D</code> (for \"delayed representation\"), but when the data is first created from a list or vector it would be <code>U</code> (\"unboxed vector\") or <code>V</code> (\"boxed vector\"). These are used as type hints to help repa optimize its operations.</p>\n\n<p>Is there a way for me to hide the <code>r</code> as I'd like, but allow it to vary naturally internally without affecting typechecking with my wrapper <code>Tile</code> type? Is this the domain of <code>RankNTypes</code> and friends? I'll admit I don't understand them very well. To be the most clear, I'd like to be able to write:</p>\n\n<p><code>foo :: Tile p a -&gt; Tile p b -&gt; Tile p c\n</code></p>\n\n<p>where the two <code>Tile</code> arguments contain (for instance) an <code>Array U DIM2 Int</code> and <code>Array D DIM2 Int</code> respectively. Is this a bad thing to desire?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1498659644, "post_id": 44805103, "comment_id": 76590332, "body": "Would <code>mappend x y = Data.Monoid.&lt;&gt; x y</code> work?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1498660070, "post_id": 44805103, "comment_id": 76590693, "body": "Do you even need <code>Data.Monoid</code> imported? All it really brings into scope that isn&#39;t already in the Prelude is a bunch of newtypes and its version of <code>&lt;&gt;</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1498670191, "post_id": 44805103, "comment_id": 76597852, "body": "Note that this annoying situation is temporary. In GHC 8.4 or 8.6 (don&#39;t remember which), <code>Semigroup</code> will be a superclass of <code>Monoid</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1498660504, "last_edit_date": 1498660504, "creation_date": 1498660039, "answer_id": 44805388, "question_id": 44805103, "link": "https://stackoverflow.com/questions/44805103/refer-to-either-semigroup-or-monoid/44805388#44805388", "title": "Refer to either Semigroup or Monoid", "body": "<p>Normally, you'd just</p>\n\n<pre><code>import Data.Monoid hiding ((&lt;&gt;))\n</code></pre>\n\n<p>(Or simply not import <code>Data.Monoid</code> at all \u2013 as Alec commented, the <code>Monoid</code> class itself is already exported from <code>Prelude</code> anyway.)\nThen it's unambiguous that <code>x &lt;&gt; y</code> means <code>x Data.Semigroup.&lt;&gt; y</code>, because the <code>Data.Monoid</code> version is not in scope.</p>\n\n<p>Alternatively, you can import one of the modules qualified, like</p>\n\n<pre><code>import qualified Data.Semigroup as SG\nimport Data.Monoid\nimport Test.QuickCheck\n\ndata Trivial = Trivial deriving (Eq, Show)\n\ninstance SG.Semigroup Trivial where\n  _ &lt;&gt; _ = Trivial\n\ninstance Monoid Trivial where\n  mempty = Trivial\n  mappend x y = x SG.&lt;&gt; y\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 44805388, "answer_count": 1, "score": 2, "last_activity_date": 1498660504, "creation_date": 1498659405, "question_id": 44805103, "link": "https://stackoverflow.com/questions/44805103/refer-to-either-semigroup-or-monoid", "title": "Refer to either Semigroup or Monoid", "body": "<p>I try to solve the exercises from the haskellbook and created following module:  </p>\n\n<pre><code>module Exercises where\n\nimport Data.Semigroup\nimport Data.Monoid\nimport Test.QuickCheck\n\ndata Trivial = Trivial deriving (Eq, Show)\n\ninstance Semigroup Trivial where\n  _ &lt;&gt; _ = Trivial\n\ninstance Monoid Trivial where\n  mempty = Trivial\n  mappend x y = x &lt;&gt; y   \n</code></pre>\n\n<p>And the compiler complains:</p>\n\n<pre><code>file: 'file:///d%3A/haskell/chapter15/src/Exercises.hs'\nseverity: 'Error'\nmessage: 'Ambiguous occurrence `&lt;&gt;'\nIt could refer to either `Data.Semigroup.&lt;&gt;',\n                         imported from `Data.Semigroup' at src\\Exercises.hs:3:1-21\n                      or `Data.Monoid.&lt;&gt;',\n                         imported from `Data.Monoid' at src\\Exercises.hs:4:1-18'\nat: '14,19'\nsource: ''\n</code></pre>\n\n<p>How to solve the problem?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "is_accepted": true, "score": 8, "last_activity_date": 1498653725, "creation_date": 1498653725, "answer_id": 44802785, "question_id": 44802606, "link": "https://stackoverflow.com/questions/44802606/how-does-haskell-convert-integer-literals-to-different-types/44802785#44802785", "title": "How does Haskell convert integer literals to different types?", "body": "<p>When Haskell sees an integer literal such as <code>56</code>, it interprets it as <code>fromInteger 56</code>. The type of <code>fromInteger</code> is <code>Num a =&gt; Integer -&gt; a</code>, so the type of this code is <code>Num a =&gt; a</code>. (Any type, here called <code>a</code>, which is a member of the <code>Num</code> class.)</p>\n\n<p>This means that when you use it in a context where a member of <code>Num</code> is expected (<code>Sum</code> in your case), it will \"set\" <code>a</code> to <code>Sum</code>, and pick the version of <code>fromInteger</code> of type <code>Integer -&gt; Sum</code>. Thus <code>fromInteger 56 :: Sum</code>.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 44802785, "answer_count": 1, "score": 5, "last_activity_date": 1498654064, "creation_date": 1498653321, "last_edit_date": 1498654064, "question_id": 44802606, "link": "https://stackoverflow.com/questions/44802606/how-does-haskell-convert-integer-literals-to-different-types", "title": "How does Haskell convert integer literals to different types?", "body": "<p>I have following anonymous function:</p>\n\n<pre><code>*Exercises&gt; g = \\(Sum n) -&gt; Sum (n - 1)\n</code></pre>\n\n<p>I use it like:</p>\n\n<pre><code>*Exercises&gt; g (Sum 56)\nSum {getSum = 55}\n*Exercises&gt; g 56\nSum {getSum = 55}\n</code></pre>\n\n<p>The second example, how does the compiler convert <code>56</code> to <code>Sum 56</code>? </p>\n\n<p>In the prelude, I saw that <code>Sum</code> is an instance of <code>Num</code>, but it not clear about the conversion.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1498688107, "post_id": 44802341, "comment_id": 76607431, "body": "It doesn\u2019t work for exactly the reason the error message says: you wrote a type signature for <code>o</code> but didn\u2019t write a definition such as <code>o x f g = g (f x)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1649, "user_id": 3684713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qo7tw.jpg?s=128&g=1", "display_name": "overactor", "link": "https://stackoverflow.com/users/3684713/overactor"}, "is_accepted": true, "score": 2, "last_activity_date": 1498655406, "creation_date": 1498655406, "answer_id": 44803455, "question_id": 44802341, "link": "https://stackoverflow.com/questions/44802341/can-i-create-my-own-function-composition-operator-in-haskell/44803455#44803455", "title": "Can I create my own function composition operator in Haskell?", "body": "<p>Your function <code>o</code> is very similar to function composition <code>.</code>:</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nf . g = \\x -&gt; f (g x)\n</code></pre>\n\n<p>you could rewrite the definition of <code>.</code> and just slightly rearrange the arguments:</p>\n\n<pre><code>o :: a -&gt; (a -&gt; b) -&gt; (b -&gt; c) -&gt; c\no x f g = g (f x)\n</code></pre>\n\n<p>or you could try to create <code>o</code> by shuffling around the arguments of <code>.</code>:</p>\n\n<pre><code>o = (flip .) . flip . (flip .) $ (.)\n</code></pre>\n\n<p>In this definition, we are using <code>flip</code> to swap the first and second argument of <code>(.)</code> and <code>(flip .)</code> to swap the second and third argument. For a function <code>a -&gt; b -&gt; c -&gt; d</code> that would give us:</p>\n\n<pre><code>a -&gt; b -&gt; c -&gt; d\n-- swap b and c with (flip .)\na -&gt; c -&gt; b -&gt; -&gt;d\n-- swap a and c with (.)\nc -&gt; a -&gt; b -&gt; -&gt; d\n-- swap a and b\nc -&gt; b -&gt; a -&gt; d with (flip .)\n</code></pre>\n\n<p>If you're wondering why <code>(flip .)</code> swaps the second and third argument, I recommend you read <a href=\"https://stackoverflow.com/a/12131896/3684713\">this answer</a> and <a href=\"http://conal.net/blog/posts/semantic-editor-combinators\" rel=\"nofollow noreferrer\">the blog post that was linked in it</a>. it boils down to <code>.</code> making sure that <code>flip</code> gets applied to the result of whatever function you pass to <code>(flip .)</code> and swapping the first and second argument of the result of a function is the same as swapping its second and third argument.</p>\n\n<hr>\n\n<p>To be perfectly honest though, I don't see the need for your <code>o</code> function since you could just rewrite <code>f</code> as:</p>\n\n<pre><code> f :: Int -&gt; String\n f x = g . h $ x\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>f = g . h\n</code></pre>\n"}], "owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 44803455, "answer_count": 1, "score": 0, "last_activity_date": 1498676419, "creation_date": 1498652639, "last_edit_date": 1498676419, "question_id": 44802341, "link": "https://stackoverflow.com/questions/44802341/can-i-create-my-own-function-composition-operator-in-haskell", "title": "Can I create my own function composition operator in Haskell?", "body": "<p>The function composition operator in Haskell is defined as:</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>When I try to create my own function composition operator, <code>o</code> in Haskell, it does not work, what am I doing wrong?</p>\n\n<pre><code>o :: a -&gt; (a -&gt; b) -&gt; (b -&gt; c) -&gt; c\n\ng :: Double -&gt; String\ng x = show x \n\nh :: Int -&gt; Double\nh x = fromIntegral x\n\nf :: Int -&gt; String\nf x = o x h g       -- can it also be written like this: f = o h g \n</code></pre>\n\n<p><strong>Error message:</strong></p>\n\n<pre><code>C:\\Users\\August\\Desktop\\Haskell\\Template\\Ex.hs:36:1: error:\n    The type signature for `o' lacks an accompanying binding\nFailed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["haskell", "garbage-collection"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1498655759, "post_id": 44801359, "comment_id": 76587055, "body": "Have you checked the <code>.prof</code> yet?"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1498656909, "post_id": 44801359, "comment_id": 76587975, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3276240/tools-for-analyzing-performance-of-a-haskell-program\">Tools for analyzing performance of a Haskell program</a>"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1498657025, "post_id": 44801359, "comment_id": 76588064, "body": "<a href=\"https://wiki.haskell.org/Performance\" rel=\"nofollow noreferrer\">this</a> might be helpful too"}, {"owner": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1498657849, "post_id": 44801359, "comment_id": 76588762, "body": "@Zeta: yes, that&#39;s how I discovered that GC is taking 80% of the time; my problem is that I don&#39;t know how to reduce that time consumption."}, {"owner": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1498657899, "post_id": 44801359, "comment_id": 76588819, "body": "@Krom my question was more related to specific techniques to reduce the GC time, rather than profiling the code"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1498658081, "post_id": 44801359, "comment_id": 76589009, "body": "@DiegoVicente the <code>.prof</code> should show where you allocate memory, unless you forgot to add cost centers. Did you use <code>{-# SCC ... #-}</code> or <code>-auto-all</code>? The generic technique is: &quot;make your code allocate less and remove space leaks&quot;."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1498658299, "post_id": 44801359, "comment_id": 76589207, "body": "There is no way around profiling, what is putting such pressure on GC and solve this. That is done by profiling. Are you stacking thunks? -&gt; Restructure code, use strictness annotations. Are you creating an unreasonable amount of garbage due to immutable data structures? Use mutable ones."}, {"owner": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1498658299, "post_id": 44801359, "comment_id": 76589209, "body": "@Zeta oh, I didn&#39;t try to add my own cost centers; thank you! I&#39;ll try to find the leak that way."}, {"owner": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1498658361, "post_id": 44801359, "comment_id": 76589274, "body": "@Krom Ok, I&#39;ll try to use all those tips tackle the problem down. Thank you!"}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1498668300, "post_id": 44801359, "comment_id": 76596706, "body": "Chapter 7 (and 8.2) of the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/\" rel=\"nofollow noreferrer\">GHC Users Guide</a>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498684567, "post_id": 44801359, "comment_id": 76605931, "body": "Any question about operational semantics should include the code in question. You begin looking for the problem by analyzing the code - without the code, nobody can actually tell you what might need to be done.   Furthermore, certain programs create a lot of garbage (and hence spend a lot of time doing GC) because that is what maximizes the speed of the program. That is, time and space complexity are very often tradeoffs for each other. But without seeing the program, its impossible to know."}, {"owner": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1499096153, "post_id": 44801359, "comment_id": 76756791, "body": "@user2407038 I was able to spot the problem and asked a <a href=\"https://stackoverflow.com/questions/44889398/priority-queue-based-on-heap-causes-a-lot-of-garbage-collection-in-haskell\">new question with the code</a>. Sorry for the inconvenience"}], "owner": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 0, "score": 6, "last_activity_date": 1498657764, "creation_date": 1498649922, "last_edit_date": 1498657764, "question_id": 44801359, "link": "https://stackoverflow.com/questions/44801359/reducing-haskells-garbage-collection-time", "title": "Reducing Haskell&#39;s garbage collection time", "body": "<p>I am working on a heuristic search project and once I got a working example, I started to benchmark it just to discover that it was not fast enough. I started profiling it (not really an expert on how to do that for a project either) and discovered that it spends 80% of the time in garbage collection.</p>\n\n<p>I tried to find on the internet how to reduce this time, but I have not been able to find something general. Can someone recommend some literature on the topic, or give some general guidelines on how garbage collection works? How should I try to look for the problem and what can be causing it? </p>\n\n<p><strong>Edit</strong>: I'm not talking that much about tools to profile the code, for which it's true that <a href=\"https://stackoverflow.com/questions/3276240/tools-for-analyzing-performance-of-a-haskell-program\">Krom's suggested question</a> is on point  Rather than that I'm looking for general tips and practices to make (specifically) garbage collection take less time, since the abstractions in the language make it harder to think about what can be going on exactly. Is there something like that?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 8212844, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/236833266ffeedd6f562a9f5e4f2fae4?s=128&d=identicon&r=PG", "display_name": "IPiiro", "link": "https://stackoverflow.com/users/8212844/ipiiro"}, "edited": false, "score": 0, "creation_date": 1498652929, "post_id": 44801891, "comment_id": 76584747, "body": "I actually dont get any information if it should be breadth-first or another algorithm. The conditions are that some given testcases should work and that I am not allowed to use any other selfwriten functions.. your code looks good btw, I will look at it later when I&#39;m home. Thank you for the answer"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1498653235, "post_id": 44801891, "comment_id": 76584983, "body": "Thats a point I assumed, that every element in the heap is unique."}, {"owner": {"reputation": 1677, "user_id": 4105099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/383350df3cda0186e32237dfc271490e?s=128&d=identicon&r=PG&f=1", "display_name": "jan.vogt", "link": "https://stackoverflow.com/users/4105099/jan-vogt"}, "edited": false, "score": 0, "creation_date": 1498653452, "post_id": 44801891, "comment_id": 76585148, "body": "Then I guess breath first is a reasonable solution. In its current form, the code still walks the whole tree for all branches without the element looked for. In a breadth-first scenario, it might be interesting to check all branches only to the current depth without any match - if you are looking for a challenge. I didn&#39;t have an immediate idea how to do this elegantly."}], "tags": [], "owner": {"reputation": 1677, "user_id": 4105099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/383350df3cda0186e32237dfc271490e?s=128&d=identicon&r=PG&f=1", "display_name": "jan.vogt", "link": "https://stackoverflow.com/users/4105099/jan-vogt"}, "is_accepted": true, "score": 2, "last_activity_date": 1498651425, "creation_date": 1498651425, "answer_id": 44801891, "question_id": 44797426, "link": "https://stackoverflow.com/questions/44797426/counting-getting-level-of-a-hierarchical-data/44801891#44801891", "title": "Counting/Getting &quot;Level&quot; of a hierarchical data", "body": "<p>The problem is, that the specification is currently incomplete. Should the solution be a breadth-first or a left/right biased depth-first algorithm?</p>\n\n<p>A breadth first solution using only Prelude functionality would be</p>\n\n<pre><code>-- Example data structure\ndata Tree e = Node e (Tree e) (Tree e) | Empty\n\n-- Actual definition\ncontains e (Node c _ _)\n | e == c = Just 0\ncontains e (Node _ l r) = fmap (+ 1) $ case (contains e l, contains e r) of\n                                            (Just a, Just b) -&gt; Just $ min a b\n                                            (Just a, _) -&gt; Just a\n                                            (_, b) -&gt; b\ncontains _ Empty = Nothing\n\n-- Given testdata:\nx = Node 2 (Node 3 (Node 6 Empty Empty) (Node 7 Empty Empty)) (Node 4 Empty (Node 5 Empty Empty))\n\ncontains 2 x -- Just 0\ncontains 6 x -- Just 2\ncontains 42 x -- Nothing\n\n-- unspecified example:\n--          1\n--      1       1\n--    1   2        1\n-- 2                  1\n--                       2\n\nx = Node 1 (Node 1 (Node 1 (Node 2 Empty Empty) Empty) (Node 2 Empty Empty)) (Node 1 Empty (Node 1 Empty (Node 1 Empty (Node 2 Empty Empty))))\ncontains 2 x -- Just 2 = breath-first\ncontains 2 x -- Just 3 = left biased depth-first\ncontains 2 x -- Just 4 = rigth biased depth-first\n</code></pre>\n\n<p>Any biased depth-first should be easily derived.</p>\n"}], "owner": {"reputation": 97, "user_id": 8212844, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/236833266ffeedd6f562a9f5e4f2fae4?s=128&d=identicon&r=PG", "display_name": "IPiiro", "link": "https://stackoverflow.com/users/8212844/ipiiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 44801891, "answer_count": 1, "score": 2, "last_activity_date": 1498651425, "creation_date": 1498638672, "last_edit_date": 1498641803, "question_id": 44797426, "link": "https://stackoverflow.com/questions/44797426/counting-getting-level-of-a-hierarchical-data", "title": "Counting/Getting &quot;Level&quot; of a hierarchical data", "body": "<p>Well I really don't know if this is the right title but I don't know how to call it else.\nMy question is about my homework, I worked for a couple of hours now.The topic is \"functional data structures\" and I am kinda stuck at a point and I have no idea how to continue.</p>\n\n<p>So I need to write a function with this signature:</p>\n\n<pre><code>data Heap e t = Heap {\ncontains :: e -&gt; t e -&gt; Maybe Int\n}\n</code></pre>\n\n<p>To illustrate it, I got some variable like this:</p>\n\n<pre><code> x =   2\n    3     4\n  6   7     5\n\n x = Node 2 (Node 3 (Node 6 Empty Empty) (Node 7 Empty Empty)) (Node 4 Empty (Node 5 Empty Empty))\n</code></pre>\n\n<p>So it is some \"tree\"-thing data.</p>\n\n<pre><code>  contains heap 2 x  returns  Just 0\n  contains heap 6 x  returns  Just 2\n  contains heap 42 x  returns  Nothing\n</code></pre>\n\n<p>So if the integer behind \"heap\" exists in x, \"contains\" will return \"Just y\", where y is the \"Level\" of the tree. In my example: 2 got the Level 0, 3 and 4 are Level 1 and so on.\nAnd thats exactly where my problem is. I've got a function which can say if the integer is in the tree or not, but I have no idea how to get that \"Level\"(I don't know how to call it else).</p>\n\n<p>My function looks like this:</p>\n\n<pre><code>contains = \\e t -&gt; case (e,t) of\n   (_,Empty) -&gt; Nothing\n   (e , Node x t1 t2) -&gt;\n        if e == (head (heap2list heap (Node x t1 t2)))\n            then Just 0\n            else if ((contains heap e t1) == Just 0)\n                     then Just 0\n                     else contains heap e t2\n</code></pre>\n\n<p>With that if the integer is in, it will return \"Just 0\" and else \"Nothing\".\nBy the way, I am not allowed to use any \"helper\" functions written by myself. The function I am allowed to use are:</p>\n\n<pre><code>empty :: t e                --Just returns an empty heap\ninsert :: e -&gt; t e -&gt; t e   --insert an element into a heap\nfindMin :: t e -&gt; Maybe e   --find Min in a heap\ndeleteMin :: t e -&gt; Maybe (t e)   -- delete the Min in a heap\nmerge :: t e -&gt; t e -&gt; t e        -- merges 2 heaps\nlist2heap :: Heap x t -&gt; [x] -&gt; t x   -- converts a list into a heap\nheap2list :: Heap x t -&gt; t x -&gt; [x]   -- converts a heap into a list\n</code></pre>\n\n<p>these functions are given. map, foldl, foldr... are also allowed. I tried to keep the question short, so if any information lacking I'm ready to edit it.</p>\n\n<p>I would be very thankful for any help. Please keep in my mind that this is a homework and I want really to do it on my own and asking this question here is my very last option.</p>\n\n<p>Working Code: </p>\n\n<pre><code>   contains = \\e t -&gt; case (e,t) of\n(_,Empty) -&gt; Nothing\n(e , Node x t1 t2) -&gt;\n    if e == (head (heap2list heap (Node x t1 t2)))\n        then Just 0\n        else if (fmap (+1) (contains heap e t1))== Nothing\n                    then (fmap (+1) (contains heap e t2))\n                    else (fmap (+1) (contains heap e t1))\n</code></pre>\n\n<p>Now the code is working and all the \"homework-conditions\" are fulfilled,but it looks like pretty ugly code in my opinion.. Can I refurbish it somehow ? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1498640598, "post_id": 44796668, "comment_id": 76576272, "body": "<code>unCombine (f &lt;&gt; g) $ 0</code> applies <code>f</code> with <code>0</code> and <code>g</code> with <code>0</code> and then applies the inferred <code>Semigroup</code> operation with the result of both functions. For <code>unCombine (f &lt;&gt; g) $ 0</code> the codomains of <code>f</code>/<code>g</code> are of type <code>Sum Num</code> and the corresponding binary operation is just <code>+</code>."}], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1498638555, "post_id": 44796768, "comment_id": 76574957, "body": "Could you please explain more in detail about <code>library instance for functions</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 2, "creation_date": 1498639351, "post_id": 44796768, "comment_id": 76575440, "body": "The <code>Data.Semigroup</code> contains exactly the <a href=\"https://www.stackage.org/haddock/lts-8.20/base-4.9.1.0/Data-Semigroup.html\" rel=\"nofollow noreferrer\">instance above</a>. So, when you use <code>&lt;&gt;</code> between functions, that instance gets called."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1498636723, "creation_date": 1498636723, "answer_id": 44796768, "question_id": 44796668, "link": "https://stackoverflow.com/questions/44796668/semigroup-with-data-type-that-contains-function/44796768#44796768", "title": "Semigroup with data type that contains function", "body": "<p><code>f &lt;&gt; g</code> is calling the library instance for functions:</p>\n\n<pre><code>instance Semigroup b =&gt; Semigroup (a -&gt; b) where\n   f &lt;&gt; g = \\x -&gt; f x &lt;&gt; g x\n</code></pre>\n\n<p>So, it is defined pointwise.</p>\n\n<p>Perhaps using generalized newtype deriving would have been better here, since <code>Combine</code> has exactly the same instance. One might even wonder if <code>Combine</code> is needed at all.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 44796768, "answer_count": 1, "score": 2, "last_activity_date": 1498637417, "creation_date": 1498636437, "last_edit_date": 1498637417, "question_id": 44796668, "link": "https://stackoverflow.com/questions/44796668/semigroup-with-data-type-that-contains-function", "title": "Semigroup with data type that contains function", "body": "<p>I have following data type and <code>Semigroup</code> instance of it:</p>\n\n<pre><code>newtype Combine a b = \n  Combine { unCombine :: a -&gt; b }\n\ninstance (Semigroup b) \n  =&gt; Semigroup (Combine a b) where \n  Combine {unCombine=f} &lt;&gt; Combine {unCombine=g} = Combine (f &lt;&gt; g)\n</code></pre>\n\n<p>What does <code>Combine (f &lt;&gt; g)</code> mean? I pass the function <code>f</code> and <code>g</code> to the binary operator <code>&lt;&gt;</code> what is the output of it? </p>\n\n<p>To figure out how it works, I try to play a bit in prelude:</p>\n\n<pre><code>Prelude&gt; let f = Combine $ \\n -&gt; Sum (n + 1)\nPrelude&gt; let g = Combine $ \\n -&gt; Sum (n - 1)\nPrelude&gt; unCombine (f &lt;&gt; g) $ 0\nSum {getSum = 0}\n</code></pre>\n\n<p>For me it looks like a function composition <code>f</code> after <code>g</code>, but am I not sure, how does exactly work. Could someone tell me, how does it work?   </p>\n\n<p>Another example(maybe it does not make sense):  </p>\n\n<pre><code>*Exercises Data.Semigroup&gt; data Zoo a b = Zoo (a -&gt; b)\n*Exercises Data.Semigroup&gt; x = Zoo (+23)\n*Exercises Data.Semigroup&gt; :t x\nx :: Num b =&gt; Zoo b b\n</code></pre>\n\n<p>How to use <code>x</code>? </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 7, "last_activity_date": 1498632887, "creation_date": 1498632887, "answer_id": 44795532, "question_id": 44795243, "link": "https://stackoverflow.com/questions/44795243/how-to-use-a-data-type-contains-function/44795532#44795532", "title": "How to use a data type contains function", "body": "<pre><code>Prelude Data.Monoid&gt; unCombine f 1\nSum {getSum = 2}\nPrelude Data.Monoid&gt; unCombine f 42\nSum {getSum = 43}\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 44795532, "answer_count": 1, "score": 3, "last_activity_date": 1498632887, "creation_date": 1498631881, "question_id": 44795243, "link": "https://stackoverflow.com/questions/44795243/how-to-use-a-data-type-contains-function", "title": "How to use a data type contains function", "body": "<p>I have following data type definition:</p>\n\n<pre><code>newtype Combine a b = \n  Combine { unCombine :: a -&gt; b }\n</code></pre>\n\n<p>and then I can defined as follow: </p>\n\n<pre><code>Prelude&gt; let f = Combine $ \\n -&gt; Sum (n + 1)\n</code></pre>\n\n<p>My question is, how to use <code>f</code>?</p>\n"}, {"tags": ["haskell", "grid"], "comments": [{"owner": {"reputation": 1677, "user_id": 4105099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/383350df3cda0186e32237dfc271490e?s=128&d=identicon&r=PG&f=1", "display_name": "jan.vogt", "link": "https://stackoverflow.com/users/4105099/jan-vogt"}, "edited": false, "score": 0, "creation_date": 1498654973, "post_id": 44794402, "comment_id": 76586409, "body": "Please provide some more context. Your question is currently unclear."}], "answers": [{"tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": false, "score": 0, "last_activity_date": 1499109057, "creation_date": 1499109057, "answer_id": 44892512, "question_id": 44794402, "link": "https://stackoverflow.com/questions/44794402/hasekll-choice-of-matrix-using-replicate/44892512#44892512", "title": "Hasekll choice of matrix using replicate", "body": "<p>First of all, I assume that you want a 9-by-9 grid with a list in each entry, and that the definition of <code>Matrix</code> looks like the following:</p>\n\n<pre><code>type Matrix a = [[a]]\n</code></pre>\n\n<p>Now, the function <code>replicate :: Int -&gt; a -&gt; [a]</code> takes an <code>Int</code> and some type <code>a</code>, repeating it that many times.</p>\n\n<p>Thus something we can try first is: how do we create a list with <code>[1..9]</code> in every element?</p>\n\n<pre><code>Prelude&gt; replicate 9 [1..9]\n[[1,2,3,4,5,6,7,8,9]\n,[1,2,3,4,5,6,7,8,9]\n,[1,2,3,4,5,6,7,8,9]\n,[1,2,3,4,5,6,7,8,9]\n,[1,2,3,4,5,6,7,8,9]\n,[1,2,3,4,5,6,7,8,9]\n,[1,2,3,4,5,6,7,8,9]\n,[1,2,3,4,5,6,7,8,9]\n,[1,2,3,4,5,6,7,8,9]]\n</code></pre>\n\n<p>The output is edited slightly to display each element in its own row, but this is effectively a single row in the matrix, isn't it? Why don't we just repeat it 9 more times?</p>\n\n<pre><code>Prelude&gt; replicate 9 $ replicate 9 [1..9]\n[[[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9]]\n,[[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9]]\n,[[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9]]\n,[[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9]]\n,[[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9]]\n,[[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9]]\n,[[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9]]\n,[[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9]]\n,[[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9],[1,2,3,4,5,6,7,8,9]]]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8192114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2b3de39da82bf7879a8f3f5f9641401?s=128&d=identicon&r=PG&f=1", "display_name": "adoudouzhao", "link": "https://stackoverflow.com/users/8192114/adoudouzhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499109057, "creation_date": 1498628392, "last_edit_date": 1498653539, "question_id": 44794402, "link": "https://stackoverflow.com/questions/44794402/hasekll-choice-of-matrix-using-replicate", "title": "Hasekll choice of matrix using replicate", "body": "<p>I am trying to solve a problem that I don't know how to approach: how would you use <code>replicate</code> to define a matrix <code>choice :: Matrix [Int]</code> that contains <code>[1 .. 9]</code> in every cell?</p>\n"}, {"tags": ["haskell", "biginteger"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1498622793, "post_id": 44793155, "comment_id": 76567402, "body": "Since <code>Integer</code> is arbitrarily large I don&#39;t think you can avoid having some sort of loop... <code>FiniteBits</code> is the right abstraction for O(1) counting of trailing zeroes."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1498629479, "post_id": 44793155, "comment_id": 76569771, "body": "<code>countTrailingZeros</code> in a binary or decimal sense?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498684813, "post_id": 44793155, "comment_id": 76606048, "body": "Why would a loop be slower than any other method of implementing this? If speed is the goal, write the code, profile, then decide if it needs to be improved."}, {"owner": {"reputation": 707, "user_id": 2406646, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f4d1ed3be14ad3be27e124c781a49662?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/2406646/jake"}, "edited": false, "score": 0, "creation_date": 1498684925, "post_id": 44793155, "comment_id": 76606108, "body": "The sense is Binary as in FiniteBits. A loop over the bits of an integer is worse than a loop over the limbs of a integer"}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1498806606, "post_id": 44793155, "comment_id": 76661484, "body": "I don&#39;t know much about Haskell, sorry, but I do know that there are clever algorithms to count the trailing zeros of a 32 bit integer that are faster than looping and shifting repeatedly. Take a look on the Hacker&#39;s Delight website. You only need to do that for the last non-zero limb, of course."}, {"owner": {"reputation": 707, "user_id": 2406646, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f4d1ed3be14ad3be27e124c781a49662?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/2406646/jake"}, "edited": false, "score": 0, "creation_date": 1498834960, "post_id": 44793155, "comment_id": 76679617, "body": "Unfortunately I&#39;m not sure there&#39;s a way to get access to the limbs otherwise I would have already done that."}], "owner": {"reputation": 707, "user_id": 2406646, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f4d1ed3be14ad3be27e124c781a49662?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/2406646/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498620443, "creation_date": 1498620443, "question_id": 44793155, "link": "https://stackoverflow.com/questions/44793155/counttrailingzeros-for-integer", "title": "countTrailingZeros for Integer", "body": "<p>I was wondering if there was a fast way to calculate the number of trailing zeros of an Integer in Haskell. This operation makes sense for Integer but is unfortunately wrapped up with other operations that don't make sense in FiniteBits. The only way I know to do this is with a loop. Isn't there a faster way to do this?</p>\n"}, {"tags": ["haskell", "dependency-management", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 60183, "user_id": 66475, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/BPKeb.png?s=128&g=1", "display_name": "Bjorn", "link": "https://stackoverflow.com/users/66475/bjorn"}, "edited": false, "score": 0, "creation_date": 1498621424, "post_id": 44793194, "comment_id": 76567044, "body": "Thanks! I ran ` stack solver --update-config` and did just this and now it build without errors. Thank you again!"}, {"owner": {"reputation": 60183, "user_id": 66475, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/BPKeb.png?s=128&g=1", "display_name": "Bjorn", "link": "https://stackoverflow.com/users/66475/bjorn"}, "edited": false, "score": 0, "creation_date": 1498621564, "post_id": 44793194, "comment_id": 76567076, "body": "I actually prefer 0.5.10.2 as it has new functions I find convenient so I did not want to reduce the version."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 5, "last_activity_date": 1501917308, "last_edit_date": 1501917308, "creation_date": 1498620752, "answer_id": 44793194, "question_id": 44793106, "link": "https://stackoverflow.com/questions/44793106/how-do-i-make-the-containers-package-match-in-stack-for-the-version-i-want/44793194#44793194", "title": "How do I make the containers package match in stack for the version I want?", "body": "<p>Try putting the following in <code>stack.yaml</code>:</p>\n\n<pre><code>extra-deps:\n- containers-0.5.10.2\n</code></pre>\n\n<p>Another way to make it work is change your cabal constraints. Making it something like this should make it work:</p>\n\n<pre><code> build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5,\n                      containers &gt;= 0.5.7 &amp;&amp; &lt; 0.6\n</code></pre>\n\n<p>Note that right now only 0.5.7.1 is available in lts in Stackage.</p>\n"}, {"tags": [], "owner": {"reputation": 60183, "user_id": 66475, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/BPKeb.png?s=128&g=1", "display_name": "Bjorn", "link": "https://stackoverflow.com/users/66475/bjorn"}, "is_accepted": false, "score": 1, "last_activity_date": 1498621649, "creation_date": 1498621649, "answer_id": 44793322, "question_id": 44793106, "link": "https://stackoverflow.com/questions/44793106/how-do-i-make-the-containers-package-match-in-stack-for-the-version-i-want/44793322#44793322", "title": "How do I make the containers package match in stack for the version I want?", "body": "<p>In addition to @Sibi's great answer, I figured out that this command would automatically have resolved my dependency issue:</p>\n\n<pre><code>stack solver --update-config\n</code></pre>\n"}], "owner": {"reputation": 60183, "user_id": 66475, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/BPKeb.png?s=128&g=1", "display_name": "Bjorn", "link": "https://stackoverflow.com/users/66475/bjorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "accepted_answer_id": 44793194, "answer_count": 2, "score": 2, "last_activity_date": 1501917308, "creation_date": 1498620132, "last_edit_date": 1498620639, "question_id": 44793106, "link": "https://stackoverflow.com/questions/44793106/how-do-i-make-the-containers-package-match-in-stack-for-the-version-i-want", "title": "How do I make the containers package match in stack for the version I want?", "body": "<p>In my cabal file I have the following build-depends:</p>\n\n<pre><code>  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5,\n                       containers &gt;= 0.5.10 &amp;&amp; &lt; 0.6\n</code></pre>\n\n<p>When I try to run <code>stack build</code> I get the following error:</p>\n\n<pre><code>Error: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for server-0.1.0.0:\n    containers-0.5.7.1 must match &gt;=0.5.10 &amp;&amp; &lt;0.6 (latest applicable is 0.5.10.2)\n</code></pre>\n\n<p>I had this problem with <code>cabal</code> I resolved it by using cabals's sandboxes. I don't know how to resolve this problem with stack by looking at the <code>--help</code> documentation, the error, the stack documentation and searching. How do I tell stack I want the newer version of containers if not via the cabal file?</p>\n\n<p>I also tried running <code>stack install containers-0.5.7.1</code> which did not do what I expected it to. I see a containers in my list of installs. I noticed the <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#adding-dependencies\" rel=\"nofollow noreferrer\">documentation</a> says stack is sandboxed by default, but it's been very painful getting it to build this simple source file due to the containers dependency.</p>\n\n<p>I noticed that this command reports the old version of containers, not the version I want:</p>\n\n<pre><code>$ stack list-dependencies\narray 0.5.1.1\nbase 4.9.1.0\ncontainers 0.5.7.1\ndeepseq 1.4.2.0\nghc-prim 0.5.0.0\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1498623734, "post_id": 44793085, "comment_id": 76567691, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37144229/how-can-i-use-getline-or-getchar-in-haskell\">How can I use getLine or getChar in haskell?</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1498635827, "post_id": 44793085, "comment_id": 76573236, "body": "<code>main = do x &lt;- readLn ; print (x+100)</code>"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1498676007, "post_id": 44793085, "comment_id": 76601265, "body": "You could define a free monad to model the interaction... <a href=\"https://hackage.haskell.org/package/transformers-free-1.0.1/docs/Control-Monad-Trans-Free.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/transformers-free-1.0.1/docs/&hellip;</a>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498685021, "post_id": 44793085, "comment_id": 76606152, "body": "You state that a GUI is overkill for your purposes; but you&#39;ve posted images of a GUI. To clarify, do you want a GUI or do you want a command line program? To clarify further, is this question about creating an abstraction to model questions/answers, or about how one creates a GUI popup with a textbox/how one reads input from the user on the command line?"}, {"owner": {"reputation": 640, "user_id": 4934536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-FH3r_zUz8aI/AAAAAAAAAAI/AAAAAAAAAg4/jLT4QUBRzi0/photo.jpg?sz=128", "display_name": "Kurt Ludikovsky", "link": "https://stackoverflow.com/users/4934536/kurt-ludikovsky"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498811059, "post_id": 44793085, "comment_id": 76663940, "body": "@user2407038 To answer your second question first: its the second: GUI pop-ups. A complete GUI would go into the FRP direction. I dont need/want to have a predefined GUI with reactions to clicks or inputs. I seek for a improved readLn in a question/answer cycles. So somewhat: &quot;What are you? hungry / dursty&quot;, &quot;What would you like to dink? water/non-alk/alk&quot;, etc. So after a start some questions are asked and based on the inputs conclusions are drawn and new questions arise. Most of the questions allow just a yes/no, a number, or some predefined options as responses."}], "answers": [{"comments": [{"owner": {"reputation": 640, "user_id": 4934536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-FH3r_zUz8aI/AAAAAAAAAAI/AAAAAAAAAg4/jLT4QUBRzi0/photo.jpg?sz=128", "display_name": "Kurt Ludikovsky", "link": "https://stackoverflow.com/users/4934536/kurt-ludikovsky"}, "edited": false, "score": 0, "creation_date": 1499063971, "post_id": 44856786, "comment_id": 76736443, "body": "thank you for your clarification. Your solution is what I have found so far as well, apart from some others like  Gtk2Hs, Haskell/GUI or Threepenny-gui, Autoforms. Glade will help also with designing GUIs and doing RFP&#39;s. But all of them put some unnecessary overhead to what I am looking for. It seems that WxHaskell is actuallythat what comes closes - in sense of what I try to achieve and required effort."}], "tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": true, "score": 1, "last_activity_date": 1498875297, "creation_date": 1498875297, "answer_id": 44856786, "question_id": 44793085, "link": "https://stackoverflow.com/questions/44793085/what-is-the-easiest-way-to-query-some-input-values-in-haskell/44856786#44856786", "title": "What is the easiest way to query some input values in Haskell", "body": "<p>It feels a little bit like your assumption is that Haskell is like Javascript here.</p>\n\n<p>That is, it's very simple in Javascript to get a \"popup\" to display in a browser such as Chrome by using <code>prompt(\"Are you hungry or thirsty?\")</code>, but that's only because the prompt function is built on top of the <code>window</code> object which the browser provides to allow developers to hook into the windowing stack of the operating system that the browser is built in.</p>\n\n<p>Haskell, by default, provides far less functionality \"for free\". That is, if you want to display a pop up, you'll have to use some library that allows you to display some pop-up.</p>\n\n<p>This is a much bigger question than it possibly seems. It's very similar to the same question in any other batch-style programming language. How would you do this in Java, or in Ruby? Well, you need to find a library that supports it.</p>\n\n<p>One such library for many languages and that is cross platform across operating systems is wxWidgets. It's built in C++, but there are bindings/libraries for Haskell and many other languages. The Haskell library is called wxhaskell: <a href=\"https://wiki.haskell.org/WxHaskell\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/WxHaskell</a></p>\n\n<p>Good luck, and don't expect it to be an easy path necessarily.</p>\n\n<p>If you have interest in learning Haskell basics, feel free to take a look at this tutorial I helped author: <a href=\"http://happylearnhaskelltutorial.com\" rel=\"nofollow noreferrer\">http://happylearnhaskelltutorial.com</a></p>\n"}], "owner": {"reputation": 640, "user_id": 4934536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-FH3r_zUz8aI/AAAAAAAAAAI/AAAAAAAAAg4/jLT4QUBRzi0/photo.jpg?sz=128", "display_name": "Kurt Ludikovsky", "link": "https://stackoverflow.com/users/4934536/kurt-ludikovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 44856786, "answer_count": 1, "score": 0, "last_activity_date": 1498875297, "creation_date": 1498619985, "last_edit_date": 1498659918, "question_id": 44793085, "link": "https://stackoverflow.com/questions/44793085/what-is-the-easiest-way-to-query-some-input-values-in-haskell", "title": "What is the easiest way to query some input values in Haskell", "body": "<p>What is the easiest way to get some values (yes/no, numbers) into a Haskell program. The values should be bound to some variables and other questions should be asked based on previous inputs.</p>\n\n<p>I am trying to solve a little problem for which I think Haskell is best suited. Especially for extending the functionality afterwards. An addition I am also trying to learn this language (I am new to Haskell but have some experience with Prolog, so have some idea about functional programming).</p>\n\n<p>I was checking all he stuff relatd to GUI development, but this is actually an overkill to what I need. The input should be in response to some questions which are dependent on the state of the execution.</p>\n\n<p>I hope this is clear enough.</p>\n\n<p>EDIT:</p>\n\n<p>I would like to have some \"po-ups\" like these. Not all at once, but just as a pop-up when needed.</p>\n\n<p><a href=\"https://i.stack.imgur.com/h6Nwb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h6Nwb.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1498600387, "post_id": 44789794, "comment_id": 76561924, "body": "I guess &quot;the common traits of random access&quot; can not be defined precisely, so it would be hard to reach consensus among all the library contributors. You can propose your own class, of course."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1498650344, "post_id": 44790747, "comment_id": 76582779, "body": "+1 to final paragraph.  Sometimes when doing this miraculous new structures arise that allow me to generalize my program beyond what I originally imagined."}, {"owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1498692029, "post_id": 44790747, "comment_id": 76608568, "body": "@luqui &amp; @KABuhr: Let&#39;s say I have written a function that uses vectors. Let&#39;s say the function uses only the <code>length</code> and <code>(!)</code> (indexing) functions. Are you guys advocating that I put those two functions into a separate typeclass <code>HasLengthAndIndexing</code>? Or maybe even two typeclasses <code>WithLength</code> and <code>Indexable</code>? That&#39;s general as hell. But I guess one can take things too far. Can you add some thoughts on this?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 1, "creation_date": 1498835610, "post_id": 44790747, "comment_id": 76680003, "body": "I had in mind application-specific typeclasses containing coherent sets of operations, not per-function typeclasses containing minimum required sets of operations.  (The latter approach is useful in some situations, but it wasn&#39;t what I was suggesting.)  Taking a step back, I would advocate against premature abstraction for most Haskell programming.  If you have a function that uses vectors, I&#39;d suggest writing it to use <code>Vector</code>s.  If you later discover it would be helpful to generalize, then refactor it to use a <code>RandomAccess</code> typeclass tailored to your program."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1499611293, "post_id": 44790747, "comment_id": 76969104, "body": "@K.A.Buhr yes!  Haskell programming is a conversational art.  Write some, refactor &amp; abstract when you notice a pattern (or when it is aesthetically pleasing), write more, abstract more -- uncover the balance like an archaeologist rather than egoistically willing the optimal design into existence."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 13, "last_activity_date": 1498602086, "last_edit_date": 1498602086, "creation_date": 1498601407, "answer_id": 44790747, "question_id": 44789794, "link": "https://stackoverflow.com/questions/44789794/if-i-need-a-data-structure-with-random-access-is-vector-my-only-good-choice/44790747#44790747", "title": "If I need a data structure with random access, is Vector my only good choice?", "body": "<p>No, <code>Vector</code> is not your only \"good\" choice, depending on what you mean by \"good\".  For example, <code>Array</code> is a similar data structure with a slightly more cumbersome API, but it also allows a richer set of choices for the indexing set and differs in implementation details in ways that might be helpful in some cases (e.g., an <code>Array</code> of <code>Bool</code>s is a bitmap, while a <code>Vector</code> of <code>Bool</code>s uses one byte per element).</p>\n\n<p>Also, if there is much adding and removing of elements on the ends, then the <code>Seq</code> type from <code>Data.Sequence</code> might be a good choice (though its random access performance varies from <code>O(1)</code> at the ends to <code>O(log n)</code> in the middle, roughly speaking).</p>\n\n<p>It's hard to say definitely why there is no standard library typeclass for a random access API, but note that Haskell typically does not have data structure API typeclasses of this level of specificity in the standard library.  There are no standard typeclasses for the base <code>Map</code> and <code>Set</code> data structures APIs either, for example, even though these would also apply to the various hash-based maps and sets that are available.</p>\n\n<p>The standard library typeclasses that <em>are</em> available are typically higher-level abstractions, like <code>Foldable</code> and <code>Traversable</code>.</p>\n\n<p>However, the <code>lens</code> package provides a collection of indexed typeclass abstractions, so for example there are <code>Ixed</code> instances for <code>Vector</code>, <code>Array</code>, and <code>Seq</code> such that:</p>\n\n<pre><code>v ^? ix 2\n</code></pre>\n\n<p>gets you <code>Just</code> the element with index 2, if <code>v</code> is any one of the above types (or a list or a host of other indexable collections).  The possible downside of using these typeclasses is that you kind of have to buy into the whole <code>lens</code> ecosystem and its syntactic approach to use them effectively.</p>\n\n<p>As an alternative, for a particular application, it's often a reasonable approach to write application-specific typeclasses that encapsulate the operations performed on key data structures and then implement the data structures as instances of those typeclasses.  This can realize many of the benefits of the generic typeclasses you're imagining, but can be more flexible than pre-fabricated typeclasses and instances without being that much more work to implement.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 44790747, "answer_count": 1, "score": 2, "last_activity_date": 1498602086, "creation_date": 1498597264, "question_id": 44789794, "link": "https://stackoverflow.com/questions/44789794/if-i-need-a-data-structure-with-random-access-is-vector-my-only-good-choice", "title": "If I need a data structure with random access, is Vector my only good choice?", "body": "<p>And if there are other good choices, why isn't there a typeclass yet that has all the common traits of random access? Then Vector and other random access data structures would have instances of that typeclass.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": true, "score": 4, "last_activity_date": 1498598121, "creation_date": 1498598121, "answer_id": 44790031, "question_id": 44789752, "link": "https://stackoverflow.com/questions/44789752/count-3-in-readp-parses-3-occurrences-how-do-i-parse-between-3-and-8-occurren/44790031#44790031", "title": "&quot;count 3&quot; in ReadP parses 3 occurrences. How do I parse between 3 and 8 occurrences?", "body": "<pre><code>count_between a b p = (++) &lt;$&gt; count a p &lt;*&gt; count_upto (b - a) p\n\ncount_upto 0 _ = pure []\ncount_upto b p = ((:) &lt;$&gt; p &lt;*&gt; count_upto (b-1) p) +++ pure []\n</code></pre>\n\n<p>Note the similarity to <code>many</code>. A <code>munch</code>ing variant would use <code>&lt;++</code> instead of <code>+++</code>.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 44790031, "answer_count": 1, "score": 3, "last_activity_date": 1498598121, "creation_date": 1498597097, "question_id": 44789752, "link": "https://stackoverflow.com/questions/44789752/count-3-in-readp-parses-3-occurrences-how-do-i-parse-between-3-and-8-occurren", "title": "&quot;count 3&quot; in ReadP parses 3 occurrences. How do I parse between 3 and 8 occurrences?", "body": "<p>ReadP has this function:</p>\n\n<pre><code>count :: Int -&gt; ReadP a -&gt; ReadP [a]\n\n-- Usage:\ncount 3 $ satisfy (== 'c')\n</code></pre>\n\n<p>I'm wondering if there is a similar function to parse between 3 and 8 occurrences:</p>\n\n<pre><code>count_between 3 8 $ satisfy (== 'c')\n</code></pre>\n\n<p>If I have to create my own, how would you do that?</p>\n"}, {"tags": ["algorithm", "haskell", "recursion", "tree", "functional-programming"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1498579815, "post_id": 44784899, "comment_id": 76550920, "body": "Can you clarify exactly what your question is? What went wrong when you tried, or what don&#39;t you understand that you think would help you make progress?"}, {"owner": {"reputation": 165, "user_id": 3504447, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bHSFo.jpg?s=128&g=1", "display_name": "Teaman", "link": "https://stackoverflow.com/users/3504447/teaman"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1498580115, "post_id": 44784899, "comment_id": 76551078, "body": "I edited it and added question to the bottom."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1498581892, "post_id": 44784899, "comment_id": 76552164, "body": "Do you know you can derive <code>Traversable</code>? Do you know how to use a state monad?"}, {"owner": {"reputation": 165, "user_id": 3504447, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bHSFo.jpg?s=128&g=1", "display_name": "Teaman", "link": "https://stackoverflow.com/users/3504447/teaman"}, "edited": false, "score": 0, "creation_date": 1498584304, "post_id": 44784899, "comment_id": 76553509, "body": "No, I&#39;m still novice haskeller."}, {"owner": {"reputation": 165, "user_id": 3504447, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bHSFo.jpg?s=128&g=1", "display_name": "Teaman", "link": "https://stackoverflow.com/users/3504447/teaman"}, "edited": false, "score": 0, "creation_date": 1498586271, "post_id": 44784899, "comment_id": 76554539, "body": "Could you please look at my aswer and give any hints how to deal with it for n-ary case?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1498588942, "post_id": 44784899, "comment_id": 76555975, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/41522422/whats-the-most-standard-generic-way-to-zip-a-traversable-with-a-list\">What&#39;s the most standard/generic way to zip a traversable with a list?</a>"}, {"owner": {"reputation": 165, "user_id": 3504447, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bHSFo.jpg?s=128&g=1", "display_name": "Teaman", "link": "https://stackoverflow.com/users/3504447/teaman"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1498590509, "post_id": 44784899, "comment_id": 76556799, "body": "@amalloy How is that duplicate question? Its using something I don&#39;t understand, it is like somebody is asking about basic Java program architecture, and you present them some intricate framework. I just want to learn on SIMPLE examples, not using heavy guns like that."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 3504447, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bHSFo.jpg?s=128&g=1", "display_name": "Teaman", "link": "https://stackoverflow.com/users/3504447/teaman"}, "is_accepted": false, "score": 1, "last_activity_date": 1498584931, "last_edit_date": 1498584931, "creation_date": 1498584233, "answer_id": 44786343, "question_id": 44784899, "link": "https://stackoverflow.com/questions/44784899/how-to-write-function-for-n-ary-tree-traversal-in-haskell/44786343#44786343", "title": "How to write function for N-ary tree traversal in Haskell", "body": "<p>I'll update this answer as soon as I get some progress.</p>\n\n<p>Right now I reduced problem from n-ary tree to binary tree.</p>\n\n<pre><code>data T a = Leaf a | N (T a) a (T a) deriving Show\n\nnumberNodes:: T a -&gt; T (a,Int)\nnumberNodes tree = snd $ numberNodes2 tree 0\n\nnumberNodes2:: T a -&gt; Int -&gt; (Int,  T (a,Int))\nnumberNodes2 (Leaf a) time = (time,Leaf (a,time))\nnumberNodes2 (N left nodeVal right) time = (rightTime, N leftTree (nodeVal,time) rightTree  )\nwhere (leftTime,leftTree) = numberNodes2 left (time+1)\n      (rightTime,rightTree) = numberNodes2 right (leftTime+1)\n</code></pre>\n\n<p>Function numberNodes creates from this tree:</p>\n\n<pre><code>let bt = N (N (Leaf \"anna\" ) \"leo\" (Leaf \"laura\")) \"eric\" (N (Leaf \"john\")  \"joe\" (Leaf \"eddie\"))\n</code></pre>\n\n<p>following tree:</p>\n\n<pre><code>N (N (Leaf (\"anna\",2)) (\"leo\",1) (Leaf (\"laura\",3))) (\"eric\",0) (N (Leaf (\"john\",5)) (\"joe\",4) (Leaf (\"eddie\",6)))\n</code></pre>\n\n<p>And now just rewrite it for n-ary tree...( which I don't know how to do, any hints? )</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 11685973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc516c735793e23786b5b2f07a724f0?s=128&d=identicon&r=PG&f=1", "display_name": "jrp", "link": "https://stackoverflow.com/users/11685973/jrp"}, "edited": false, "score": 0, "creation_date": 1561229959, "post_id": 44802556, "comment_id": 99998094, "body": "The program can be further simplified to <code>result :: NT a -&gt; NT (a, Int) result nt = evalState (traverse (\\ a -&gt;  gets (a,) &lt;* modify (1+)) nt) 0</code> if you switch on  <code>TupleSections</code>."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 25, "last_activity_date": 1498658101, "last_edit_date": 1498658101, "creation_date": 1498653188, "answer_id": 44802556, "question_id": 44784899, "link": "https://stackoverflow.com/questions/44784899/how-to-write-function-for-n-ary-tree-traversal-in-haskell/44802556#44802556", "title": "How to write function for N-ary tree traversal in Haskell", "body": "<h2>First Attempt: Hard Work</h2>\n\n<p>For the case of n-ary trees, there are <em>three</em> things going on: numbering elements, numbering trees, and numbering <em>lists</em> of trees. It would help to treat them separately. Types first:</p>\n\n<pre><code>aNumber   :: a                -- thing to number\n          -&gt; Int              -- number to start from\n          -&gt; ( (a, Int)       -- numbered thing\n             , Int            -- next available number afterwards\n             )\n\nntNumber  :: NT a             -- thing to number\n          -&gt; Int              -- number to start from\n          -&gt; ( NT (a, Int)    -- numbered thing\n             , Int            -- next available number afterwards\n             )\n\nntsNumber :: [NT a]           -- thing to number\n          -&gt; Int              -- number to start from\n          -&gt; ( [NT (a, Int)]  -- numbered thing\n             , Int            -- next available number afterwards\n             )\n</code></pre>\n\n<p>Notice that all three types share the same pattern. When you see that there is a pattern that you are following, apparently by coincidence, you know you have an opportunity to learn something. But let's press on for now and learn later.</p>\n\n<p>Numbering an element is easy: copy the starting number into the output and return its successor as the next available.</p>\n\n<pre><code>aNumber a i = ((a, i), i + 1)\n</code></pre>\n\n<p>For the other two, the pattern (there's that word again) is</p>\n\n<ol>\n<li>split the input into its top-level components</li>\n<li>number each component in turn, threading the numbers through</li>\n</ol>\n\n<p>It's easy to do the first with pattern matching (inspecting the data visually) and the second with <code>where</code> clauses (grabbing the two parts of the output).</p>\n\n<p>For trees, a top level split gives us two components: an element and a list. In the where clause, we call the appropriate numbering functions as directed by those types. In each case, the \"thing\" output tells us what to put in place of the \"thing\" input. Meanwhile, we thread the numbers through, so the starting number for the whole is the starting number for the first component, the \"next\" number for the first component starts the second, and the \"next\" number from the second is the \"next\" number for the whole.</p>\n\n<pre><code>ntNumber (N a ants) i0  = (N ai aints, i2) where\n  (ai,    i1) = aNumber   a    i0\n  (aints, i2) = ntsNumber ants i1\n</code></pre>\n\n<p>For lists, we have two possibilities. An empty list has no components, so we return it directly without using any more numbers. A \"cons\" has two components, we do exactly as we did before, using the appropriate numbering functions as directed by the type.</p>\n\n<pre><code>ntsNumber []           i  = ([], i)\nntsNumber (ant : ants) i0 = (aint : aints, i2) where\n  (aint,  i1) = ntNumber  ant  i0\n  (aints, i2) = ntsNumber ants i1\n</code></pre>\n\n<p>Let's give it a go.</p>\n\n<pre><code>&gt; let ntree = N \"eric\" [N \"lea\" [N \"kristy\" [],N \"pedro\" [] ,N \"rafael\" []],N \"anna\" [],N \"bety\" []]\n&gt; ntNumber ntree 0\n(N (\"eric\",0) [N (\"lea\",1) [N (\"kristy\",2) [],N (\"pedro\",3) [],N (\"rafael\",4) []],N (\"anna\",5) [],N (\"bety\",6) []],7)\n</code></pre>\n\n<p>So we're there. But are we happy? Well, I'm not. I have the annoying sensation that I wrote pretty much the same type three times and pretty much the same program twice. And if I wanted to do more element-numbering for differently organised data (e.g., your binary trees), I'd have to write the same thing again again. Repetitive patterns in Haskell code are <em>always</em> missed opportunities: it's important to develop a sense of self-criticism and ask whether there's a neater way.</p>\n\n<h2>Second Attempt: Numbering and Threading</h2>\n\n<p>Two of the repetitive patterns we saw, above, are\n  1. the similarity of the types,\n  2. the similarity of the way the numbers get threaded.</p>\n\n<p>If you match up the types to see what's in common, you'll notice they're all</p>\n\n<pre><code>input -&gt; Int -&gt; (output, Int)\n</code></pre>\n\n<p>for different inputs and outputs. Let's give the largest common component a name.</p>\n\n<pre><code>type Numbering output = Int -&gt; (output, Int)\n</code></pre>\n\n<p>Now our three types are</p>\n\n<pre><code>aNumber   :: a      -&gt; Numbering (a, Int)\nntNumber  :: NT a   -&gt; Numbering (NT (a, Int))\nntsNumber :: [NT a] -&gt; Numbering [NT (a, Int)]\n</code></pre>\n\n<p>You often see such types in Haskell:</p>\n\n<pre><code>             input  -&gt; DoingStuffToGet output\n</code></pre>\n\n<p>Now, to deal with the threading, we can build some helpful tools to work with and combine <code>Numbering</code> operations. To see which tools we need, look at how we combine the outputs after we've numbered the components. The \"thing\" parts of the outputs are always built by applying some functions which don't get numbered (data constructors, usually) to some \"thing\" outputs from numberings.</p>\n\n<p>To deal with the functions, we can build a gadget that looks a lot like our <code>[]</code> case, where no actual numbering was needed.</p>\n\n<pre><code>steady :: thing -&gt; Numbering thing\nsteady x i = (x, i)\n</code></pre>\n\n<p>Don't be put off by the way the type makes it look as if <code>steady</code> has only one argument: remember that <code>Numbering thing</code> abbreviates a function type, so there really is another <code>-&gt;</code> in there. We get</p>\n\n<pre><code>steady [] :: Numbering [a]\nsteady [] i = ([], i)\n</code></pre>\n\n<p>just like in the first line of <code>ntsNumber</code>.</p>\n\n<p>But what about the other constructors, <code>N</code> and <code>(:)</code>? Ask <code>ghci</code>.</p>\n\n<pre><code>&gt; :t steady N\nsteady N :: Numbering (a -&gt; [NT a] -&gt; NT a)\n&gt; :t steady (:)\nsteady (:) :: Numbering (a -&gt; [a] -&gt; [a])\n</code></pre>\n\n<p>We get numbering operations with <em>functions</em> as outputs, and we want to generate the arguments to those function by more numbering operations, producing one big overall numbering operation with the numbers threaded through. One step of that process is to feed a numbering-generated function one numbering-generated input. I'll define that as an infix operator.</p>\n\n<pre><code>($$) :: Numbering (a -&gt; b) -&gt; Numbering a -&gt; Numbering b\ninfixl 2 $$\n</code></pre>\n\n<p>Compare with the type of the explicit application operator, <code>$</code></p>\n\n<pre><code>&gt; :t ($)\n($) :: (a -&gt; b) -&gt; a -&gt; b\n</code></pre>\n\n<p>This <code>$$</code> operator is \"application for numberings\". If we can get it right, our code becomes</p>\n\n<pre><code>ntNumber  :: NT a -&gt; Numbering (NT (a, Int))\nntNumber  (N a ants)   i = (steady N $$ aNumber a $$ ntsNumber ants) i\n\nntsNumber :: [NT a] -&gt; Numbering [NT (a, Int)]\nntsNumber []           i = steady [] i\nntsNumber (ant : ants) i = (steady (:) $$ ntNumber ant $$ ntsNumber ants) i\n</code></pre>\n\n<p>with <code>aNumber</code> as it was (for the moment). This code just does the data reconstruction, plugging together the constructors and the numbering processes for the components. We had better give the definition of <code>$$</code> and make sure it gets the threading right.</p>\n\n<pre><code>($$) :: Numbering (a -&gt; b) -&gt; Numbering a -&gt; Numbering b\n(fn $$ an) i0 = (f a, i2) where\n  (f, i1) = fn i0\n  (a, i2) = an i1\n</code></pre>\n\n<p>Here, our old threading <em>pattern</em> gets done <em>once</em>. Each of <code>fn</code> and <code>an</code> is a function, expecting a starting number, and the whole of <code>fn $$ sn</code> is a function, which gets the starting number <code>i0</code>. We thread the numbers through, collecting first the function, then the argument. We then do the actual application and hand back the final \"next\" number.</p>\n\n<p>Now, notice that in every line of code, the <code>i</code> input is fed in as the argument to a numbering process. We can simplify this code by just talking about the <em>processes</em>, not the <em>numbers</em>.</p>\n\n<pre><code>ntNumber  :: NT a -&gt; Numbering (NT (a, Int))\nntNumber  (N a ants)   = steady N $$ aNumber a $$ ntsNumber ants\n\nntsNumber :: [NT a] -&gt; Numbering [NT (a, Int)]\nntsNumber []           = steady []\nntsNumber (ant : ants) = steady (:) $$ ntNumber ant $$ ntsNumber ants\n</code></pre>\n\n<p>One way to read this code is to filter out all the <code>Numbering</code>, <code>steady</code> and <code>$$</code> uses.</p>\n\n<pre><code>ntNumber  :: NT a -&gt; ......... (NT (a, Int))\nntNumber  (N a ants)   = ...... N .. (aNumber a) .. (ntsNumber ants)\n\nntsNumber :: [NT a] -&gt; ......... [NT (a, Int)]\nntsNumber []           = ...... []\nntsNumber (ant : ants) = ...... (:) .. (ntNumber ant) .. (ntsNumber ants)\n</code></pre>\n\n<p>and you see it just looks like a preorder traversal, reconstructing the original data structure after processing the elements. We're doing the right thing with the <em>values</em>, provided <code>steady</code> and <code>$$</code> are correctly combining the <em>processes</em>.</p>\n\n<p>We could try to do the same for <code>aNumber</code></p>\n\n<pre><code>aNumber  :: a -&gt; Numbering a\naNumber a = steady (,) $$ steady a $$ ????\n</code></pre>\n\n<p>but the <code>????</code> is where we actually need the number. We could build a numbering process that fits in that hole: a numbering process that <em>issues the next number</em>.</p>\n\n<pre><code>next :: Numbering Int\nnext i = (i, i + 1)\n</code></pre>\n\n<p>That's the essence of numbering, the \"thing\" output is the number to be used now (which is the starting number), and the \"next\" number output is the one after. We may write</p>\n\n<pre><code>aNumber a = steady (,) $$ steady a $$ next\n</code></pre>\n\n<p>which simplifies to</p>\n\n<pre><code>aNumber a = steady ((,) a) $$ next\n</code></pre>\n\n<p>In our filtered view, that's</p>\n\n<pre><code>aNumber a = ...... ((,) a) .. next\n</code></pre>\n\n<p>What we've done is to bottle the idea of a \"numbering process\" and we've built the right tools to do <em>ordinary functional programming</em> with those processes. The threading pattern turns into the definitions of <code>steady</code> and <code>$$</code>.</p>\n\n<p>Numbering is not the only thing that works this way. Try this...</p>\n\n<pre><code>&gt; :info Applicative\nclass Functor f =&gt; Applicative (f :: * -&gt; *) where\n  pure :: a -&gt; f a\n  (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>...and you also get some more stuff. I just want to draw attention to the types of <code>pure</code> and <code>&lt;*&gt;</code>. They're a lot like <code>steady</code> and <code>$$</code>, but they are not just for <code>Numbering</code>. <code>Applicative</code> is the type class for <em>every</em> kind of process which works that way. I'm not saying \"learn <code>Applicative</code> now!\", just suggesting a direction of travel.</p>\n\n<h2>Third Attempt: Type-Directed Numbering</h2>\n\n<p>So far, our solution is directed towards one particular data structure, <code>NT a</code>, with <code>[NT a]</code> showing up as an auxiliary notion because it's used in <code>NT a</code>. We can make the whole thing a bit more plug-and-play if we focus on one layer of the type at a time. We defined numbering a list of trees in terms of numbering trees. In general, we know how to number a list of <em>stuff</em> if we know how to number each item of <em>stuff</em>.</p>\n\n<p>If we know how to number an <code>a</code> to get <code>b</code>, we should be able to number a <em>list</em> of <code>a</code> to get a <em>list</em> of <code>b</code>. We can abstract over \"how to process each item\".</p>\n\n<pre><code>listNumber :: (a -&gt; Numbering b) -&gt; [a] -&gt; Numbering [b]\nlistNumber na []       = steady []\nlistNumber na (a : as) = steady (:) $$ na a $$ listNumber na as\n</code></pre>\n\n<p>and now our old list-of-trees-numbering function becomes</p>\n\n<pre><code>ntsNumber :: [NT a] -&gt; Numbering [NT (a, Int)]\nntsNumber = listNumber ntNumber\n</code></pre>\n\n<p>which is hardly worth naming. We can just write</p>\n\n<pre><code>ntNumber :: NT a -&gt; Numbering (NT (a, Int))\nntNumber (N a ants) = steady N $$ aNumber a $$ listNumber ntNumber ants\n</code></pre>\n\n<p>We can play the same game for the trees themselves. If you know how to number stuff, you know how to number a tree of stuff.</p>\n\n<pre><code>ntNumber' :: (a -&gt; Numbering b) -&gt; NT a -&gt; Numbering (NT b)\nntNumber' na (N a ants) = steady N $$ na a $$ listNumber (ntNumber' na) ants\n</code></pre>\n\n<p>Now we can do things like this</p>\n\n<pre><code>myTree :: NT [String]\nmyTree = N [\"a\", \"b\", \"c\"] [N [\"d\", \"e\"] [], N [\"f\"] []]\n\n&gt; ntNumber' (listNumber aNumber) myTree 0\n(N [(\"a\",0),(\"b\",1),(\"c\",2)] [N [(\"d\",3),(\"e\",4)] [],N [(\"f\",5)] []],6)\n</code></pre>\n\n<p>Here, the node data is now itself a list of things, but we've been able to number those things individually. Our equipment is more adaptable because each component aligns with one layer of the type.</p>\n\n<p>Now, try this:</p>\n\n<pre><code>&gt; :t traverse\ntraverse :: (Applicative f, Traversable t) =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\n</code></pre>\n\n<p>It's an awful lot like the thing we just did, where <code>f</code> is <code>Numbering</code> and <code>t</code> is sometimes lists and sometimes trees.</p>\n\n<p>The <code>Traversable</code> class captures what it means to be a type-former that lets you thread some sort of process through the stored elements. Again, the pattern you're using is very common and has been anticipated. Learning to use <code>traverse</code> saves a lot of work.</p>\n\n<h2>Eventually...</h2>\n\n<p>...you'll learn that a thing to do the job of <code>Numbering</code> already exists in the library: it's called <code>State Int</code> and it belongs to the <code>Monad</code> class, which means it must also be in the <code>Applicative</code> class. To get hold of it,</p>\n\n<pre><code>import Control.Monad.State\n</code></pre>\n\n<p>and the operation which kicks off a stateful process with its initial state, like our feeding-in of <code>0</code>, is this thing:</p>\n\n<pre><code>&gt; :t evalState\nevalState :: State s a -&gt; s -&gt; a\n</code></pre>\n\n<p>Our <code>next</code> operation becomes</p>\n\n<pre><code>next' :: State Int Int\nnext' = get &lt;* modify (1+)\n</code></pre>\n\n<p>where <code>get</code> is the process that accesses the state, <code>modify</code> makes a process that changes the state, and <code>&lt;*</code> means \"but also do\".</p>\n\n<p>If you start you file with the language extension pragma</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor, DeriveFoldable, DeriveTraversable #-}\n</code></pre>\n\n<p>you can declare your datatype like this</p>\n\n<pre><code>data NT a = N a [NT a] deriving (Show, Functor, Foldable, Traversable)\n</code></pre>\n\n<p>and Haskell will write <code>traverse</code> for you.</p>\n\n<p>Your program then becomes one line...</p>\n\n<pre><code>evalState (traverse (\\ a -&gt; pure ((,) a) &lt;*&gt; get &lt;* modify (1+)) ntree) 0\n--                  ^ how to process one element ^^^^^^^^^^^^^^^\n--         ^ how to process an entire tree of elements ^^^^^^^^^\n--        ^ processing your particular tree ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-- ^ kicking off the process with a starting number of 0 ^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>...but the journey to that one line involves a lot of \"bottling the pattern\" steps, which takes some (hopefully rewarding) learning.</p>\n"}, {"tags": [], "owner": {"reputation": 1263, "user_id": 532647, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c1caab91478136b1cc442569c7da085?s=128&d=identicon&r=PG", "display_name": "Iarek", "link": "https://stackoverflow.com/users/532647/iarek"}, "is_accepted": false, "score": 1, "last_activity_date": 1604697295, "creation_date": 1604697295, "answer_id": 64721679, "question_id": 44784899, "link": "https://stackoverflow.com/questions/44784899/how-to-write-function-for-n-ary-tree-traversal-in-haskell/64721679#64721679", "title": "How to write function for N-ary tree traversal in Haskell", "body": "<p><a href=\"https://stackoverflow.com/a/44802556/532647\">This answer</a> by @pigworker is excellent, and I learned lots from it.</p>\n<p>However, I believe we can use <code>mapAccumL</code> from <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Traversable.html#v:mapAccumL\" rel=\"nofollow noreferrer\">Data.Traversable</a> to achieve a very similar behaviour:</p>\n<pre><code>{-# LANGUAGE DeriveTraversable #-}\n\nimport           Data.Traversable\nimport           Data.Tuple\n\n-- original data type from the question\ndata NT a = N a [NT a]\n    deriving (Show, Functor, Foldable, Traversable)\n\n-- additional type from @pigworker's answer\ntype Numbering output = Int -&gt; (output, Int)\n\n-- compare this to signature of ntNumber\n-- swap added to match the signature\nntNumberSimple :: (NT a) -&gt; Numbering (NT (a, Int))\nntNumberSimple t n = swap $ mapAccumL func n t\n    where\n        func i x = (i+1, (x, i))\n</code></pre>\n<p>I believe that <code>mapAccumL</code> is using the very same State monad under the hood, but at the very least it's completely hidden from the caller.</p>\n"}], "owner": {"reputation": 165, "user_id": 3504447, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bHSFo.jpg?s=128&g=1", "display_name": "Teaman", "link": "https://stackoverflow.com/users/3504447/teaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1564, "favorite_count": 5, "accepted_answer_id": 44802556, "answer_count": 3, "score": 10, "last_activity_date": 1604697295, "creation_date": 1498579116, "last_edit_date": 1502098896, "question_id": 44784899, "link": "https://stackoverflow.com/questions/44784899/how-to-write-function-for-n-ary-tree-traversal-in-haskell", "title": "How to write function for N-ary tree traversal in Haskell", "body": "<p>I need to traverse N-ary tree and to the each node add number when I visited in in preorder. I have n-ary tree defined like this:</p>\n\n<pre><code>data NT a = N a [NT a] deriving Show\n</code></pre>\n\n<p><strong>Example:</strong>\nIf I have following tree:</p>\n\n<pre><code>let ntree = N \"eric\" [N \"lea\" [N \"kristy\" [],N \"pedro\" [] ,N \"rafael\" []],N \"anna\" [],N \"bety\" []]\n</code></pre>\n\n<p>I want to transform it to </p>\n\n<pre><code>let ntree = N (1,\"eric\") [N (2,\"lea\") [N (3,\"kristy\") [],N (4,\"pedro\") [] ,N (5,\"rafael\") []],N (6,\"anna\") [],N (7,\"bety\") []]\n</code></pre>\n\n<p>\"Preordedness\"  isnt that important.</p>\n\n<p>I want to see how to write a function that <strong>passes values between levels</strong>, like how to pass number down to successor list and how to pass updated number to parent and go with that number to other branches.</p>\n\n<p>So far I has been able to write functions like this: </p>\n\n<pre><code>traverse :: NT String -&gt; String\ntraverse (N val []) =\" \"++val++\" \"\ntraverse (N val list) =val++\" \" ++ (concat $ map  traverse list)\n</code></pre>\n\n<p>which outputs</p>\n\n<pre><code>\"eric lea  kristy  pedro  rafael  anna  bety \"\n</code></pre>\n\n<p><strong>EDIT:</strong> Question is:</p>\n\n<p>How can I write a function </p>\n\n<pre><code>numberNodes :: NT a -&gt; NT (a,Int)\n</code></pre>\n\n<p>that numbers nodes according to the preorder traversal of the tree?</p>\n\n<p>Hard part for me to understand is passing auxilliary data around, could you please elaborate on that ? </p>\n\n<p>In this concrete case it is one Int that means \"time\" or order in which I traverse this tree.</p>\n"}, {"tags": ["ios", "swift", "haskell"], "comments": [{"owner": {"reputation": 486150, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1498577553, "post_id": 44784228, "comment_id": 76549392, "body": "Closures lose their argument labels. It is just <code>return ns.filter{n in pred(n)}</code>"}, {"owner": {"reputation": 486150, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1498577589, "post_id": 44784228, "comment_id": 76549415, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39613272/xcode-8-function-types-cannot-have-argument-label-breaking-my-build\" title=\"xcode 8 function types cannot have argument label breaking my build\">stackoverflow.com/questions/39613272/&hellip;</a> or <a href=\"https://stackoverflow.com/questions/41514014/why-apples-closure-declarations-missing-argument-labels\" title=\"why apples closure declarations missing argument labels\">stackoverflow.com/questions/41514014/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 36913, "user_id": 13000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39e9358c81316d75cff38ec1e0655642?s=128&d=identicon&r=PG", "display_name": "deanWombourne", "link": "https://stackoverflow.com/users/13000/deanwombourne"}, "reply_to_user": {"reputation": 486150, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1498580806, "post_id": 44785314, "comment_id": 76551520, "body": "@MartinR Just realized that - check out my edit! Thought it looked wrong, but couldn&#39;t put my finger on why. That&#39;ll teach me to blindly follow the autofix button in Xcode!"}, {"owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "reply_to_user": {"reputation": 486150, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1498585361, "post_id": 44785314, "comment_id": 76554060, "body": "@Martin R I&#39;m sorry could you explain why I don&#39;t need parameter names if a function is a closure? I am very confused about this whole parameter name thing."}, {"owner": {"reputation": 486150, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "reply_to_user": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "edited": false, "score": 0, "creation_date": 1498585575, "post_id": 44785314, "comment_id": 76554180, "body": "@chibro2: It is a consequence of <a href=\"https://github.com/apple/swift-evolution/blob/master/proposals/0111-remove-arg-label-type-significance.md\" rel=\"nofollow noreferrer\">github.com/apple/swift-evolution/blob/master/proposals/&hellip;</a>. Have a look at the two Q&amp;A&#39;s that I linked-to above."}], "tags": [], "owner": {"reputation": 36913, "user_id": 13000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39e9358c81316d75cff38ec1e0655642?s=128&d=identicon&r=PG", "display_name": "deanWombourne", "link": "https://stackoverflow.com/users/13000/deanwombourne"}, "is_accepted": true, "score": 3, "last_activity_date": 1498580750, "last_edit_date": 1498580750, "creation_date": 1498580477, "answer_id": 44785314, "question_id": 44784228, "link": "https://stackoverflow.com/questions/44784228/using-higher-order-functions-in-swift/44785314#44785314", "title": "Using higher order functions in swift", "body": "<pre><code>func hasMatch(pred: (Int) -&gt; Bool, ns: [Int]) -&gt; [Int] {\n    return ns.filter { n in pred(n) }\n}\n</code></pre>\n\n<p>You don't need parameter names if the function is a closure.</p>\n\n<p><code>@escaping</code> is a keyword in swift which tells the compiler that the passed in function will escape the current scope, so it needs to retain/release the passed in arguments (Swift, like objective-c, uses retain counting for memory management)</p>\n\n<p>However, you don't need it in this case - that error was a red herring thrown by the compiler because it couldn't compile the line with <code>filter</code> in, so it didn't know whether you needed to escape or not. Looks like it plays things safe :) </p>\n\n<p>As soon as you remove the <code>n:</code> and it can work out which <code>filter</code> you are calling, it knows that because <code>filter</code> doesn't need an <code>@escaping</code> closure, your method doesn't either so that error goes away.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10770159, "user_type": "registered", "profile_image": "https://graph.facebook.com/2026573694087146/picture?type=large", "display_name": "Sachin Daingade", "link": "https://stackoverflow.com/users/10770159/sachin-daingade"}, "is_accepted": false, "score": 0, "last_activity_date": 1571043628, "creation_date": 1571043628, "answer_id": 58373327, "question_id": 44784228, "link": "https://stackoverflow.com/questions/44784228/using-higher-order-functions-in-swift/58373327#58373327", "title": "Using higher order functions in swift", "body": "<pre><code>func mapedData(){\nlet bookData = [\"book1\":120, \"book2\": 150]\nlet mapedData = bookData.map({(key,value) in return value + 40 })\nprint(mapedData)\n}\n</code></pre>\n\n<p>// [160, 190]</p>\n\n<pre><code>func filterData()\n{\n     let bookData = [\"book1\":127, \"book2\": 150 ,\"book3\": 289 ,\"book4\": 190, \"book5\": 950  ]\n    let filterData = bookData.filter({(key,value) in return value &lt; 200})\n    print(filterData)\n}\n</code></pre>\n\n<p>// [\"book2\": 150, \"book4\": 190, \"book1\": 127]</p>\n\n<pre><code>func reducedData()\n{\n    let data = [1,2,3,4,5,6,7,8,9,10]\n    let reducedData = data.reduce(0, { sum , number in return sum + number })\n    print(reducedData)\n}\n</code></pre>\n\n<p>//55</p>\n\n<pre><code>func compactData(){\n       let data = [1,nil,3,4,5,6,7,nil,9,10]\n    let cMap = data.compactMap({return $0})\n    print(cMap)\n}\n// [1, 3, 4, 5, 6, 7, 9, 10]\n\nfunc flatMappedData(){\n    let data = [\"sachin\"]\n    let characters = data.flatMap({return $0})\n    print(characters)        \n}\n</code></pre>\n\n<p>// [\"s\", \"a\", \"c\", \"h\", \"i\", \"n\"]</p>\n"}], "owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 1, "accepted_answer_id": 44785314, "answer_count": 2, "score": 1, "last_activity_date": 1571386759, "creation_date": 1498577273, "question_id": 44784228, "link": "https://stackoverflow.com/questions/44784228/using-higher-order-functions-in-swift", "title": "Using higher order functions in swift", "body": "<p>I am learning swift coming from a Haskell background, I would like to translate this bit into swift:</p>\n\n<pre><code>match :: Int -&gt; Bool\nmatch = (&gt;) 3\n\nhasMatch :: (Int -&gt; Bool) -&gt; [Int] -&gt; [Int]\nhasMatch pred ns = filter pred ns\n\nhasMatch match [1..5] = [4,5]\n</code></pre>\n\n<p>Silly example I know. This is what I have with swift:</p>\n\n<pre><code>func hasMatch(pred : (Int) -&gt; Bool, ns : [Int]) -&gt; [Int]{\n    return ns.filter{n in pred(n:n)}\n}\n\n\nfunc match(n: Int) -&gt; Bool{\n    return n &gt; 3\n}\n\nlet os = hasMatch(pred : match, ns: [1,2,3,4,5])\n</code></pre>\n\n<p>Which does not compile. This is the error message:</p>\n\n<pre><code>let os = hasMatch(pred : match, ns: [1,2,3,4,5])\n\n    ./hello-swift.swift:48:28: error: extraneous argument label 'n:' in call\n        return ns.filter{n in pred(n:n)}\n                                  ^~~\n\n./hello-swift.swift:48:24: error: closure use of non-escaping parameter 'pred' may allow it to escape\n        return ns.filter{n in pred(n:n)}\n                              ^\n./hello-swift.swift:47:15: note: parameter 'pred' is implicitly non-escaping\nfunc hasMatch(pred : (Int) -&gt; Bool, ns : [Int]) -&gt; [Int]{\n              ^\n                     @escaping \n</code></pre>\n\n<p>I have two questions:</p>\n\n<ol>\n<li><p>I have <code>pred(n:n)</code> but this assumes that <code>pred</code> names its input as <code>n</code>, which does not make sense. Do all functions have to have named inputs?</p></li>\n<li><p>How would I change to the code so that it compiles</p></li>\n</ol>\n"}, {"tags": ["haskell", "functional-programming", "monoids"], "comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1498575077, "post_id": 44783269, "comment_id": 76547587, "body": "What happens if you follow the advice given in the error message?"}, {"owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1498575228, "post_id": 44783269, "comment_id": 76547689, "body": "I&#39;m guessing it means that you would need a wrapper for this function, in the form of a data constructor or newtype. However, even then, Monoids such as this one exist: <a href=\"https://stackoverflow.com/a/44344821/2704964\">stackoverflow.com/a/44344821/2704964</a>. How were they able to use a function type in the instance?"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1498575384, "post_id": 44783269, "comment_id": 76547815, "body": "They are parametric, if you start mixing concrete types in, you either need to wrap your type or try allowing the <code>FlexibleInstances</code> extension."}, {"owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1498576558, "post_id": 44783269, "comment_id": 76548651, "body": "I tried the following and it somehow compiles, but I don&#39;t understand why: I declared <code>newtype Wrapper a = Wrapper (a -&gt; ([a], [a]))</code> and then I have my <code>transition :: State -&gt; ([State], [State])</code>. Doing this compiles: <code>transition &#39;mappend&#39; transition</code>. How did Haskell know to delegate to the appropriate <code>mappend</code>?"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1498576751, "post_id": 44783269, "comment_id": 76548790, "body": "Did it? as the question you linked suggests, there is an instance of <code>Monoid</code> for the arrow type as long as the return type is <code>Monoid</code>. You can see that <code>(a, b)</code> is Monoid if both <code>a</code> and <code>b</code> are Monoids, and thus maybe Haskell still could pick a different instance from what you think it picked."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1498620617, "post_id": 44783269, "comment_id": 76566859, "body": "The compositions of such functions would be a monadic bind. You might consider creating an instance of <code>Monad</code> for a <code>newtype</code> wrapper of <code>([a],[a])</code>. Composition of functions like <code>a -&gt; m a</code> (where <code>m</code> is your wrapper type) would then be handled by <code>&gt;=&gt;</code>."}, {"owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "edited": false, "score": 0, "creation_date": 1498635678, "post_id": 44783269, "comment_id": 76573133, "body": "Thanks for the help! I managed to make a <code>Monad</code> version of it as well after some tweaking."}], "answers": [{"comments": [{"owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "edited": false, "score": 0, "creation_date": 1498605610, "post_id": 44784025, "comment_id": 76563565, "body": "I&#39;m reflecting on this much later now, and after trying several things out, it suddenly makes a lot of sense: you can only use <code>mappend</code> on &quot;wrapped&quot; objects (such as <code>newtype</code>), which means that you can&#39;t arbitrarily do: <code>transition `mappend` transition</code>. Those get delegated to one of the <code>Monoid</code> implementations that come with the Prelude. Rather, you have to do, as you wrote: <code>(TransitionT transition) `mappend` (TransitionT transition)</code>. Thank you!"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 7, "last_activity_date": 1498576692, "creation_date": 1498576692, "answer_id": 44784025, "question_id": 44783269, "link": "https://stackoverflow.com/questions/44783269/function-types-as-monoid-instances/44784025#44784025", "title": "Function Types as Monoid Instances", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/src/GHC.Base.html#line-268\" rel=\"noreferrer\">Functions are <em>already</em> instances of monoids in a different way</a>. How do you expect Haskell to decide to use that instance or your instance? The usual way of solving your problem is to declare a <code>newtype</code> wrapper such as</p>\n\n<pre><code>newtype Transition a = Transition { runTransition :: a -&gt; ([a], [a]) }\n</code></pre>\n\n<p>Then, you can make your monoid instance just fine:</p>\n\n<pre><code>instance Monoid (Transition a) where\n  mempty  = ...\n  mappend = ...\n</code></pre>\n\n<p>After you are done this, you can may even find <code>foldMap</code> useful. Instead of writing something like</p>\n\n<pre><code>runTransition (Transition  transition `chain`\n               Transition  transition `chain`\n               ...\n               Transition  transition)\n</code></pre>\n\n<p>You can use <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Foldable.html#v:foldMap\" rel=\"noreferrer\"><code>foldMap</code></a></p>\n\n<pre><code>runTransition (foldMap Transition [transition, transition, ... transition])\n</code></pre>\n"}], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 44784025, "answer_count": 1, "score": 3, "last_activity_date": 1498576692, "creation_date": 1498574689, "question_id": 44783269, "link": "https://stackoverflow.com/questions/44783269/function-types-as-monoid-instances", "title": "Function Types as Monoid Instances", "body": "<p>I have a function that looks like this</p>\n\n<pre><code>transition :: State -&gt; ([State], [State])\n</code></pre>\n\n<p>Given the particular domain of my problem, I know how to chain together two successive <code>transition</code> function calls, something like this:</p>\n\n<pre><code>transition `chain` trainsition ... `chain` transition\n</code></pre>\n\n<p>However, I would like to express this as a <code>Monoid</code> and perform chaining with <code>&lt;&gt;</code> and <code>mappend</code>. Unfortunately, I cannot seem to get the following, or similar variants of, to work:</p>\n\n<pre><code>instance Monoid (State -&gt; ([State], [State])) where\n    mempty  = ...\n    mappend = ...\n</code></pre>\n\n<p>The error returned is as follows:</p>\n\n<pre><code>\u2022 Illegal instance declaration for\n    \u2018Monoid (State -&gt; ([State], [State]))\u2019\n    (All instance types must be of the form (T a1 ... an)\n     where a1 ... an are *distinct type variables*,\n     and each type variable appears at most once in the instance head.\n     Use FlexibleInstances if you want to disable this.)\n\u2022 In the instance declaration for\n    \u2018Monoid (State -&gt; ([State], [State]))\u2019\n</code></pre>\n\n<p>In general, how can functions be expressed as instances of <code>Monoid</code>?</p>\n"}, {"tags": ["haskell", "tree", "binary-search-tree", "equality"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1498572525, "post_id": 44782376, "comment_id": 76545597, "body": "If these are binary <i>search</i> trees, than usually one will obtain a sorted list."}, {"owner": {"reputation": 113, "user_id": 8138142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1d0687a43f80c2caebe125dae26844?s=128&d=identicon&r=PG&f=1", "display_name": "Vajk", "link": "https://stackoverflow.com/users/8138142/vajk"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498572715, "post_id": 44782376, "comment_id": 76545739, "body": "I thought the same and tried it (edited the code) but it doesn&#39;t work. The inOrder and isBinarySearchTree are implemented of course."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498572783, "post_id": 44782376, "comment_id": 76545805, "body": "but the <code>not (isBinarySearchTree t1 &amp;&amp; isBinarySearchTree t2) = False</code> line is just weird: <code>Eq</code> defines two functions: <code>(==)</code> and <code>(&#47;=)</code>."}, {"owner": {"reputation": 113, "user_id": 8138142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1d0687a43f80c2caebe125dae26844?s=128&d=identicon&r=PG&f=1", "display_name": "Vajk", "link": "https://stackoverflow.com/users/8138142/vajk"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498572921, "post_id": 44782376, "comment_id": 76545926, "body": "I didn&#39;t know how to check if it is a bst with the equality operators that&#39;s why I did it like that. I guess that&#39;s the mistake isn&#39;t it?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1498599076, "post_id": 44782376, "comment_id": 76561321, "body": "@Vajk The idea is that you should already know these trees are BSTs, because you will only allow insertions that maintain the BST requirements. You shouldn&#39;t have to test for it."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498591310, "post_id": 44788160, "comment_id": 76557258, "body": "Stream fusion isn&#39;t used for lists in GHC. Fold/build fusion is used for those. Fold/build could be used to fuse the equality test with <i>one</i> of its arguments, but I failed to get that to perform well, so it doesn&#39;t fuse at all.  That said, I still don&#39;t know of a better solution than the one you present."}, {"owner": {"reputation": 113, "user_id": 8138142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1d0687a43f80c2caebe125dae26844?s=128&d=identicon&r=PG&f=1", "display_name": "Vajk", "link": "https://stackoverflow.com/users/8138142/vajk"}, "edited": false, "score": 0, "creation_date": 1498591650, "post_id": 44788160, "comment_id": 76557440, "body": "I solved the problem myself, that&#39;s why I just accepted so people can see no further help is needed, but thanks for your answer."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 113, "user_id": 8138142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1d0687a43f80c2caebe125dae26844?s=128&d=identicon&r=PG&f=1", "display_name": "Vajk", "link": "https://stackoverflow.com/users/8138142/vajk"}, "edited": false, "score": 1, "creation_date": 1498593067, "post_id": 44788160, "comment_id": 76558218, "body": "@Vajk We appreciate your effort to avoid wasting anyone else&#39;s time. But actually, Stack Overflow is as much about helping future visitors who find a question via Google as it is about helping you, the person who originally asked the question. Therefore, it is best only to accept an answer if it is a good answer to the question: it&#39;s great that you found another solution, and you could even answer your own question to explain the solution, but don&#39;t accept a wrong answer just to indicate that you don&#39;t need help anymore."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 2, "last_activity_date": 1498590957, "creation_date": 1498590957, "answer_id": 44788160, "question_id": 44782376, "link": "https://stackoverflow.com/questions/44782376/test-if-two-trees-are-equal-and-binary-search-trees-in-haskell/44788160#44788160", "title": "Test if two trees are equal and binary search trees in Haskell", "body": "<p>The accepted answer looks wrong to me, since you say you want to compare based on the conceptual contents of the trees, not their exact structure. That is, you want the following to be true:</p>\n\n<pre><code>K 1 L (K 2 L L) == K 2 (K 1 L L) L\n</code></pre>\n\n<p>Two BSTs with the same two elements, ordered correctly but structured differently. Comparing them structurally, as in severij's answer, yields <code>False</code>, but you want it to be <code>True</code>.</p>\n\n<p>So, how to compare by contents instead of by structure? Well, any two BSTs with the same set of items will have the same in-order traversal. So, you can do exactly as you said in your question: convert them to lists, and compare the lists. But you don't have to sort them: because they are BSTs you are guaranteed that you can traverse them in the same order. And it's not terribly expensive to convert them to lists, so don't worry about that: laziness and stream fusion make it cost about the same as writing the traversals by hand.</p>\n\n<p>It will be much easier if you have a Foldable instance for your tree type, which is a good thing for a tree to have anyway. To define Foldable, you need only define <code>foldr</code>, which is easy enough:</p>\n\n<pre><code>import Prelude hiding (foldr)\nimport Data.Foldable (Foldable, foldr, toList)\n\ninstance Foldable BB where\n  foldr f init L = init\n  foldr f init (K x left right) = foldr f (f x (foldr f init right)) left\n</code></pre>\n\n<p>And then you can define Eq in terms of toList:</p>\n\n<pre><code>instance Eq (BB a) where\n  x == y = toList x == toList y\n</code></pre>\n\n<p>After which you have, as desired, </p>\n\n<pre><code>*Main&gt; (K 1 L (K 2 L L)) == (K 2 (K 1 L L) L)\nTrue\n</code></pre>\n\n<p>But this was rather a lot of work, wasn't it? And I got the definition of <code>foldr</code> wrong several times while writing this answer. It turns out, there is a way to avoid having to write it yourself: the <code>DeriveFoldable</code> language extension lets GHC derive Foldable for you as easily as it derives Show. But since it folds up fields in your data type in order, you will have to change it a bit so that the left subtree appears before the root node:</p>\n\n<pre><code>{-# LANGUAGE DeriveFoldable #-}\n\nimport Prelude hiding (foldr)\nimport Data.Foldable (Foldable, foldr, toList)\n\ndata BB a = L | K (BB a) a (BB a) deriving (Show, Foldable)\n\ninstance Eq (BB a) where\n  x == y = toList x == toList y\n</code></pre>\n\n<p>And indeed, we still have the desired equality property (though we must write the nodes differently because we changed field order):</p>\n\n<pre><code>*Main&gt; (K L 1 (K L 2 L)) == (K (K L 1 L) 2 L)\nTrue\n</code></pre>\n\n<p>There remains one final improvement to be made: the Eq definition can be simpler too, if you import <code>Data.Function.on</code>. Rather than spelling it all out by hand, with <code>on</code> you can simply say \"to compare two trees for equality, convert each to a list and compare those lists for equality\". Leaving the tree definitions and other imports intact, we at last at last obtain a quite succinct definition of the desired features, with all the real work done by already-written library functions:</p>\n\n<pre><code>{-# LANGUAGE DeriveFoldable #-}\n\nimport Prelude hiding (foldr)\nimport Data.Foldable (Foldable, foldr, toList)\nimport Data.Function (on)\n\ndata BB a = L | K (BB a) a (BB a) deriving (Show, Foldable)\n\ninstance Eq a =&gt; Eq (BB a) where\n  (==) = (==) `on` toList\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 8138142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1d0687a43f80c2caebe125dae26844?s=128&d=identicon&r=PG&f=1", "display_name": "Vajk", "link": "https://stackoverflow.com/users/8138142/vajk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 1, "accepted_answer_id": 44788160, "answer_count": 1, "score": 0, "last_activity_date": 1498590957, "creation_date": 1498572247, "last_edit_date": 1498572623, "question_id": 44782376, "link": "https://stackoverflow.com/questions/44782376/test-if-two-trees-are-equal-and-binary-search-trees-in-haskell", "title": "Test if two trees are equal and binary search trees in Haskell", "body": "<p>I am kinda stuck on implementing an Eq instance for binary search trees. I want to check if the values in the two trees are the same, but I don't really know how to do that correctly. Because of the possibly different structures of two binary search trees I can't just compare the nodes directly. My idea was to convert them into a list, sort the lists and compare them but that seems pretty complicated and I wondered if there is another way to do that. Here is what I got so far:</p>\n\n<pre><code>data BB a = L | K a (BB a) (BB a) deriving (Show)\n\ninstance Eq BB where\n  not (isBinarySearchTree t1 &amp;&amp; isBinarySearchTree t2) = False\n  inOrder t1 == inOrder t2 = True\n</code></pre>\n"}, {"tags": ["haskell", "tuples"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 3, "creation_date": 1498566230, "post_id": 44780065, "comment_id": 76540837, "body": "Oh, it gets worse! Pairs are also <code>Foldable</code>: <a href=\"https://stackoverflow.com/a/36461185/126014\">stackoverflow.com/a/36461185/126014</a>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1498566839, "post_id": 44780065, "comment_id": 76541238, "body": "I don&#39;t think a 2-tuple itself has that much of a special status. The point is that usually 2-tuples are more &quot;applicable&quot; than 3-tuples. If you have a &quot;dictionary&quot;, then you can obtain a list of key-values, a third value has no meaning here. The problem is: what to do with the third element."}, {"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "edited": false, "score": 0, "creation_date": 1498566949, "post_id": 44780065, "comment_id": 76541309, "body": "Yes I see that, I just wonder what the <code>Applicative</code> instance would be useful for, as it requires the first argument be a <code>Monoid</code> instance."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1498567616, "post_id": 44780065, "comment_id": 76541793, "body": "The <code>((,) a)</code> applicative is equivalent to the <a href=\"http://hackage.haskell.org/package/transformers-0.5.4.0/docs/Control-Monad-Trans-Writer-Lazy.html#t:Writer\" rel=\"nofollow noreferrer\">writer monad</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1498567842, "post_id": 44780065, "comment_id": 76541994, "body": "<code>fmap (*) (&quot;a&quot;, 2) &lt;*&gt; (&quot;b&quot;, 3) == (&quot;ab&quot;, 6)</code> seems to be a reasonable behavior. The effect of an applicative tuple is that the last element is applied to the action, whereas the other elements have no relation to the last one (or to each other). They are merely appended."}, {"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1498568221, "post_id": 44780065, "comment_id": 76542292, "body": "@leftaroundabout Ah I see, it seems that the <code>Applicative</code> instance doesn&#39;t make a lot of sense by itself, but in the context of this monad! Thank you"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1498597022, "post_id": 44780065, "comment_id": 76560271, "body": "@flawr I wouldn&#39;t say that \u2013 basically all monads are also useful as mere applicatives. Just \u2013 for some reason I don&#39;t know \u2013 <code>Applicative</code> appears to be less intuitive and its use cases less evident than <code>Monad</code>."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1522586176, "post_id": 44780065, "comment_id": 86203366, "body": "The 2-tuple also has a <code>Comonad</code> and <code>ComonadEnv</code> instances (not int base) <a href=\"http://hackage.haskell.org/package/comonad-5.0.3/docs/Control-Comonad.html#t:Comonad\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/comonad-5.0.3/docs/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 6, "last_activity_date": 1498571759, "creation_date": 1498571759, "answer_id": 44782190, "question_id": 44780065, "link": "https://stackoverflow.com/questions/44780065/what-is-the-special-status-of-the-2-tuple/44782190#44782190", "title": "What is the special status of the 2-tuple?", "body": "<p>There's nothing preventing us from writing an instance for triples or arbitrary n-tuples:</p>\n\n<pre><code>instance Functor ((,,) a b) where\n  fmap f (x,y,z) = (x,y,f z)\n\ninstance (Monoid a, Monoid b) =&gt; Applicative ((,,) a b) where\n  pure z              = (mempty,        mempty,          z)\n  (a,b,f) &lt;*&gt; (x,y,z) = (a `mappend` x, b `mappend` y, f z)\n</code></pre>\n\n<p>Pairs aren't special therefore in the sense that you can implement the instance for any n-tuple. But since those instances have to be written somewhere, it begs the question how far we should go. For example, <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html\" rel=\"noreferrer\"><code>Monoid</code></a> instances are defined up to 5-tuples. It's certainly possible to write them for 10-tuples, but we're just copying boiler-plate code at that point.</p>\n\n<p>That being said, <strong>pairs are special</strong> since their collection provide a natural way to describe a relation. One example is a dictionary, which relates  a term and its definition:</p>\n\n<pre><code>dictionary :: [(String, String)]\ndictionary =\n  [(\"cat\", \"animal that likes strings; not Strings, though\")\n  ,(\"dog\", \"animal that likes you; yes you\")\n  ,(\"foo\", \"a strange word used by programmers in examples\")\n  ]\n</code></pre>\n\n<p>The other way to show that relation (if the first parts of all pairs would be unique) would be</p>\n\n<pre><code>partialDictionaryEntry :: String -&gt; String\n</code></pre>\n\n<p>if we limit the input domain to <code>\"cat\"</code>, <code>\"dog\"</code> and <code>\"foo\"</code>, or</p>\n\n<pre><code>dictionaryEntry :: String -&gt; Maybe String\n</code></pre>\n\n<p>which is exactly what <code>\\s -&gt; lookup s dictionary</code> would be. And with pairs you can model any other n-tuple:</p>\n\n<pre><code>(a,b,z)   = ((a,b),z)\n(a,b,c,z) = ((a,b,c),z) = (((a,b),c),z)\n</code></pre>\n\n<p>In that sense they are the smallest container that provides this functionality. We can build all other tuples types from pairs. Heck, theoretically we don't even need to write our <code>Applicative ((,,) a b)</code> instance, since it's already provided for <code>(,) (a,b)</code> due to  the <code>Monoid</code> instance.</p>\n\n<p>That being said, why does it even have a <code>Applicative</code> instance? It's the simplest <code>Writer</code> implementation:</p>\n\n<pre><code>log :: (Show a) =&gt; a -&gt; (String, a)\nlog x = (show x ++ \"\\n\", x)\n\nfivePlusThree = (+) &lt;$&gt; log 3 &lt;*&gt; log 5\n\nmain = do\n  let (logs, result) = fivePlusThree\n  putStrLn logs\n  print result\n</code></pre>\n\n\n\n<pre><code>3\n5\n\n8\n</code></pre>\n\n<p>This provides an easy way to add additional information to functions or values, although you will probably use <code>Writer</code> and its <code>writer</code> method, since they are more pleasant to use and provide a strict variant.</p>\n"}], "owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1281, "favorite_count": 0, "accepted_answer_id": 44782190, "answer_count": 1, "score": 5, "last_activity_date": 1522585341, "creation_date": 1498565747, "last_edit_date": 1522585341, "question_id": 44780065, "link": "https://stackoverflow.com/questions/44780065/what-is-the-special-status-of-the-2-tuple", "title": "What is the special status of the 2-tuple?", "body": "<p>Reading <em>Real World Haskell</em> and the <a href=\"https://wiki.haskell.org/Typeclassopedia\" rel=\"nofollow noreferrer\"><em>Typeclassopedia</em></a> I get the impression that 2-tuples <code>(a,b)</code> can have very special roles in Haskell.</p>\n\n<p>The first use that I came across is with <code>lookup</code> where we use a list of 2-tuples as a dictionary.</p>\n\n<p>Then I also came across the fact that <code>((,) e)</code> is an instance of a functor (but no other n-tuple), which makes sense for example in the above example of <code>(key,value)</code>.</p>\n\n<p>Now the most recent case - which is the one I actually want to ask about - is in chapter 4.3 of the Typeclassopedia. There it says that <code>((,) a)</code> is an instance of <code>Applicative</code> <em>if</em> <code>a</code> is a monoid. When do you actually make use of that? What are applications where you use the <code>Applicative</code> instance of <code>(a,b)</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1498565080, "post_id": 44779756, "comment_id": 76540069, "body": "What are the types of <code>a</code> and <code>b</code> in the repl?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1498566432, "post_id": 44779756, "comment_id": 76540976, "body": "What do you hope to accomplish by typing <code>Two a b &lt;&gt; Two c d = Two (a &lt;&gt; c) (b &lt;&gt; d)</code> in the REPL? That&#39;s a <i>declaration</i>, i.e. you define a new <code>&lt;&gt;</code> operator there (which is not connected to the one from the <code>Semigroup</code> class). Why?"}], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": true, "score": 5, "last_activity_date": 1498568024, "last_edit_date": 1498568024, "creation_date": 1498565438, "answer_id": 44779949, "question_id": 44779756, "link": "https://stackoverflow.com/questions/44779756/it-could-refer-to-either-data-monoid/44779949#44779949", "title": "It could refer to either `Data.Monoid.&lt;&gt;&#39;", "body": "<p>Try it with something that's an instance of Semigroup, like <code>List</code>.</p>\n\n<p>For example:</p>\n\n<pre><code>&gt; (Two \"1\" \"2\") &lt;&gt; (Two \"3\" \"4\")\n\nTwo \"13\" \"24\"\n</code></pre>\n\n<p>In your attempt / example, <code>a</code> and <code>b</code>, <code>c</code> and <code>d</code> are not defined, so Haskell sees them as variables. Because you're using <code>=</code> between them, it's assuming you want to do pattern matching, so it's trying to match them to themselves, which is causing an infinite loop (as that is perfectly valid Haskell \u2014 to define values in terms of themselves). This is causing an error, though, because it would imply an infinite <em>type</em>, which it definitely seems is not what you want.</p>\n\n<p>It might be worth starting with some simpler things, possibly. A good basic book which I helped author is <a href=\"http://happylearnhaskelltutorial.com\" rel=\"nofollow noreferrer\">http://happylearnhaskelltutorial.com</a> but that doesn't deal with instantiating your own typeclasses. Having said that it'll give you a reasonably good understanding of pattern matching, variables, types and values which you'll need before you move on to understanding typeclasses enough to build your own instances.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 44779949, "answer_count": 1, "score": 0, "last_activity_date": 1498568024, "creation_date": 1498564767, "question_id": 44779756, "link": "https://stackoverflow.com/questions/44779756/it-could-refer-to-either-data-monoid", "title": "It could refer to either `Data.Monoid.&lt;&gt;&#39;", "body": "<p>I have following declaration: </p>\n\n<pre><code>data Two a b = Two a b deriving (Eq, Show)\n\ninstance (Semigroup a, Semigroup b) =&gt; Semigroup (Two a b) where\n  (Two a b) &lt;&gt; (Two c d) = Two (a &lt;&gt; c) (b &lt;&gt; d)\n</code></pre>\n\n<p>And tried it in the prelude:</p>\n\n<pre><code>*Main First Lib MonoidLaws Semi&gt;   (Two a b) &lt;&gt; (Two c d) = Two (a &lt;&gt; c) (b &lt;&gt; d)\n\n&lt;interactive&gt;:10:3: error:\n    * Occurs check: cannot construct the infinite type: t1 ~ Two t1 t1\n      Expected type: t1 -&gt; t -&gt; b\n        Actual type: Two t1 t1 -&gt; Two t t -&gt; Two b b\n    * Relevant bindings include\n        (&lt;&gt;) :: t1 -&gt; t -&gt; b (bound at &lt;interactive&gt;:10:3)\n</code></pre>\n\n<p>How can I use <code>mappend</code> function from <code>Semigroup</code> for <code>Two</code> datatype in prelude?</p>\n"}, {"tags": ["haskell", "ghc", "xmonad", "nix"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1498562136, "post_id": 44778404, "comment_id": 76538193, "body": "Isn&#39;t that particular <code>xmonad.hs</code> part of your configuration and should therefore get compiled &quot;within&quot; nix (from a configuration management point of view)?"}, {"owner": {"reputation": 2373, "user_id": 3335288, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qfxhh.jpg?s=128&g=1", "display_name": "Zimm i48", "link": "https://stackoverflow.com/users/3335288/zimm-i48"}, "edited": false, "score": 0, "creation_date": 1498566165, "post_id": 44778404, "comment_id": 76540784, "body": "I&#39;m not a xmonad user myself but here is the xmonad config file of @Ptival on NixOS: <a href=\"https://github.com/Ptival/config/blob/master/xmonad.nix\" rel=\"nofollow noreferrer\">github.com/Ptival/config/blob/master/xmonad.nix</a>"}, {"owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "edited": false, "score": 0, "creation_date": 1498589133, "post_id": 44778404, "comment_id": 76556101, "body": "Possibly xmonad.hs would be better managed &quot;within&quot; nix, but I&#39;m not yet competent to achieve that, and as shown with nixOS, it should be possible to choose not to but still work (whether or not it is wise)."}, {"owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "edited": false, "score": 0, "creation_date": 1498589166, "post_id": 44778404, "comment_id": 76556118, "body": "Thanks for the link - but that configuration is for a nixOS installation, rather than nix on top of ubuntu."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 2236367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7d7a8bf8ed616a7bc66500d25f2c32f?s=128&d=identicon&r=PG", "display_name": "A.P.", "link": "https://stackoverflow.com/users/2236367/a-p"}, "edited": false, "score": 1, "creation_date": 1522337020, "post_id": 44787766, "comment_id": 86127429, "body": "Just to point out that after this one should install xmonad with <code>nix-env -iA nixpkgs.xmonad</code>, which wasn&#39;t clear until I read through the code in the question."}], "tags": [], "owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "is_accepted": false, "score": 6, "last_activity_date": 1498589478, "creation_date": 1498589478, "answer_id": 44787766, "question_id": 44778404, "link": "https://stackoverflow.com/questions/44778404/xmonad-on-nix-cannot-find-xmonad-contrib/44787766#44787766", "title": "XMonad on Nix - cannot find xmonad-contrib", "body": "<p>A friend solved this for me offline, I reproduce this here for others with the same issue.</p>\n\n<p>Essentially, we need to use xmonad-with-packages, and list the packages, rather than ghc-with-packages.</p>\n\n<p>To achieve this, we provide our own xmonad, referenced from within <code>~/.nixpkgs/config.nix</code>:</p>\n\n<pre><code>{\n  packageOverrides = pkgs_: with pkgs_; {\n    xmonad            = import ./xmonad { nixpkgs = pkgs_; };\n  };\n}\n</code></pre>\n\n<p>And fill out <code>~/.nixpkgs/xmonad/default.nix</code> thus:</p>\n\n<pre><code>{ nixpkgs ? import &lt;nixpkgs&gt; {} }:\n\nnixpkgs.xmonad-with-packages.override {\n  packages = hPkgs: with hPkgs; [ xmonad-contrib ];\n}\n</code></pre>\n\n<p>This installs an xmonad that knows where to find its libraries, and everything's good!</p>\n"}], "owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 2, "answer_count": 1, "score": 5, "last_activity_date": 1499777128, "creation_date": 1498560503, "question_id": 44778404, "link": "https://stackoverflow.com/questions/44778404/xmonad-on-nix-cannot-find-xmonad-contrib", "title": "XMonad on Nix - cannot find xmonad-contrib", "body": "<p>I am trying to use nix on ubuntu, with XMonad as my window manager.\nI have this working well on one host using nixOS, but I have a second device that isn't yet ready for nixOS.  nix on top of Ubuntu is mostly working well there, but xmonad cannot find contributory libraries.</p>\n\n<p>The relevant packages are installed:</p>\n\n<pre><code>$ nix-env -q | grep xmonad\nxmonad-0.13\nxmonad-contrib-0.13\nxmonad-extras-0.12.1\n</code></pre>\n\n<p>But recompiling my xmonad.hs, it cannot find the contrib libs:</p>\n\n<pre><code>$ xmonad --recompile\nError detected while loading xmonad configuration file: /home/martyn/.xmonad/xmonad.hs\n\nxmonad.hs:32:1: error:\nFailed to load interface for \u2018XMonad.Layout.NoBorders\u2019\nUse -v to see a list of the files searched for.\n\n...\n\nPlease check the file for errors.\n</code></pre>\n\n<p>The relevant files are installed:</p>\n\n<pre><code>$ ls /nix/store/*xmonad-contrib*/lib/**/NoBorders*\n/nix/store/4xrrwsm6362xkn9jn1b17kd891kv9z3a-xmonad-contrib-0.13/lib/ghc-8.0.2/xmonad-contrib-0.13/XMonad/Actions/NoBorders.dyn_hi\n/nix/store/4xrrwsm6362xkn9jn1b17kd891kv9z3a-xmonad-contrib-0.13/lib/ghc-8.0.2/xmonad-contrib-0.13/XMonad/Actions/NoBorders.hi\n/nix/store/4xrrwsm6362xkn9jn1b17kd891kv9z3a-xmonad-contrib-0.13/lib/ghc-8.0.2/xmonad-contrib-0.13/XMonad/Layout/NoBorders.dyn_hi\n/nix/store/4xrrwsm6362xkn9jn1b17kd891kv9z3a-xmonad-contrib-0.13/lib/ghc-8.0.2/xmonad-contrib-0.13/XMonad/Layout/NoBorders.hi\n</code></pre>\n\n<p>By adding xmonad-contrib to my nixpkgs config.nix, I have gotten these libs added to the ghc package registry:</p>\n\n<pre><code>$ cat ~/.config/nixpkgs/config.nix \nwith (import &lt;nixpkgs&gt; {});\n{\n  packageOverrides = pkgs: with pkgs; {\n\n    myHaskellEnv = pkgs.haskellPackages.ghcWithPackages (haskellPackages: with haskellPackages; [ xmonad-contrib ]);\n  };\n}\n$ nix-env -iA nixpkgs.myHaskellEnv\n$ ghc-pkg list | grep xmonad\n  xmonad-0.13\n  xmonad-contrib-0.13\n$\n</code></pre>\n\n<p>with this, this ghc(i) works well:</p>\n\n<pre><code>$ /nix/store/7mkxsq7ydqcgnjbs59v1v47wfxpwrav5-ghc-8.0.2-with-packages/bin/ghc ~/.xmonad/xmonad.hs\n[1 of 1] Compiling Main             ( /home/martyn/.xmonad/xmonad.hs, /home/martyn/.xmonad/xmonad.o ) [flags changed]\nLinking /home/martyn/.xmonad/xmonad ...\n</code></pre>\n\n<p>But even the version of xmonad in that dir cannot find the libs:</p>\n\n<pre><code>$ /nix/store/7mkxsq7ydqcgnjbs59v1v47wfxpwrav5-ghc-8.0.2-with-packages/bin/xmonad --recompile\nError detected while loading xmonad configuration file: /home/martyn/.xmonad/xmonad.hs\n\nxmonad.hs:32:1: error:\n  Failed to load interface for \u2018XMonad.Layout.NoBorders\u2019\n  Use -v to see a list of the files searched for.\n</code></pre>\n\n<p>I can work around this by compiling using the ghc as above, and moving the output by hand to ~/.xmonad/xmonad-x86_64-linux, and running that.  But this is a wee bit hacky, and surely shouldn't be necessary?</p>\n"}, {"tags": ["haskell", "plugins", "haskell-stack", "template-haskell"], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": false, "score": 2, "last_activity_date": 1498555678, "creation_date": 1498555678, "answer_id": 44776724, "question_id": 44775871, "link": "https://stackoverflow.com/questions/44775871/structure-a-haskell-project-for-user-friendly-handling-of-plugins/44776724#44776724", "title": "Structure a Haskell project for user-friendly handling of &quot;plugins&quot;", "body": "<p>It would be very beneficial for you to look at the <strong>Snap</strong> framework, because they have dealt with this exact problem using their <em>snaplets</em> framework. Snaplets are developed externally, and Snap is developed externally. When you want to make a Snap website, you import both Snap <em>and</em> the snaplets into your application, then instantiate them together.</p>\n\n<p><a href=\"http://snapframework.com\" rel=\"nofollow noreferrer\">http://snapframework.com</a></p>\n"}], "owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1498555678, "creation_date": 1498553187, "question_id": 44775871, "link": "https://stackoverflow.com/questions/44775871/structure-a-haskell-project-for-user-friendly-handling-of-plugins", "title": "Structure a Haskell project for user-friendly handling of &quot;plugins&quot;", "body": "<p>The question\u00a0is how to structure a Haskell project in order to allow the user of a library to provide own <em>plugins</em> without having to mix her own code into the library's source code. Let me elaborate...</p>\n\n<p>Suppose I have a library called <code>foolib</code> that</p>\n\n<ul>\n<li>provides plugins via a <code>Plugin</code> type class</li>\n<li>provides some (many) types that are instances of the <code>Plugin</code> class</li>\n<li>shall allow the user to create own plugins</li>\n</ul>\n\n<p>Of course the user of <code>foolib</code> could just add more plugins inside <code>foolib/</code>. But <code>foolib</code> is developed independently of the application that uses <code>foolib</code>, and both are under separate SCM. In this case mixing in the user's plugins under <code>foolib/</code> violates separation and complicates source control. In short: Mixing in users' plugins in <code>foobar/</code> is feasible, of course, but can't be maintained.</p>\n\n<p>The obvious alternative is depicted below. The user maintains <code>my-project</code>, adds <code>foolib/</code> as a git submodule (let's say we're using <em>git</em>), and keeps his plugins in a separate <code>Plugins/</code> directory. Now here comes the dilemma: All the plugins, i.e. both the user's plugins and the ones in <code>foolib</code>, are used  deep down in <code>foolib/src/Core/</code> and re-exposed to the user - not directly, but in disguise. (Suppose the plugins are <em>blocks</em> in a CMS where the plugin renders some HTML and makes some keywords available that the end-user can use in his content, and that are understood by a HTML template engine.)</p>\n\n<p><img src=\"https://imgur.com/KZDDhLT.jpg\" alt=\"file structure\"></p>\n\n<p>One issue is how to make Haskell <code>stack</code> deal with this setup while keeping up with the separation of <code>my-project/</code> and <code>foolib/</code>.</p>\n\n<p>To make matters worse, there is some template Haskell (\"TH\") going on that discovers all plugins in <code>foobar/src/Plugins</code> at compile-time and uses the class functions of the many plugins in many places in the source code of <code>foolib</code>. (This isn't perfect either since, to my knowledge, imports cannot be templatized - but that's another issue.)</p>\n\n<p>I think it's clear that the structure I presented here isn't working and I don't see a nice way out. The central problem is that either I sacrifice the separation of <code>foolib</code> and <code>my-project</code>, or I end up with convolution of template Haskell, <code>sed</code>, <code>awk</code> and other scripts, which is ultimately counter-productive. </p>\n\n<p>Any guidance would be very much appreciated.</p>\n"}, {"tags": ["haskell", "concurrency", "functional-programming"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1498553137, "post_id": 44775537, "comment_id": 76532207, "body": "What \u201cMutex structure\u201d are you referring to? There certainly is none in <i>the Haskell language</i> itself. Of course, lots of external libraries (generally written in C) do use mutexes and if you call those from Haskell you also need some way to represent them. But that&#39;s hardly to blame on Haskell, is it?"}, {"owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1498553496, "post_id": 44775537, "comment_id": 76532421, "body": "@leftaroundabout I am not trying to blame anything. But the fact that there is a mutex defined in Haskell (Data.Mutex, I&#39;m not sure if its part of the core of the language) is a bit confusing for me. Isn&#39;t immutability supposed to solve problems that a mutex is used to solve?"}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 1, "creation_date": 1498555415, "post_id": 44775537, "comment_id": 76533630, "body": "It&#39;s actually not a library for use in Haskell. It&#39;s a library written <i>in</i> Hakell for implementing locks in the <b>Fay</b> language (which is written in Haskell, is Haskell-like and targets JS)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1498570136, "post_id": 44775537, "comment_id": 76543677, "body": "Saying &quot;everything in Haskell is immutable&quot; is actually a half-truth. It is true for the vast majority of cases, yes. However, it may be more beneficial to say &quot;data can be mutable in Haskell, but only if their type states that they can mutate&quot;. An <code>Int</code> is immutable. A <code>STRef s Int</code>, <code>IORef Int</code>, etc. are references to mutable values (which can be changed only in their related monads)."}], "answers": [{"comments": [{"owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "edited": false, "score": 0, "creation_date": 1498553268, "post_id": 44775708, "comment_id": 76532282, "body": "And what if even contents of references are immutable (transitive immutability)?"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "edited": false, "score": 1, "creation_date": 1498553417, "post_id": 44775708, "comment_id": 76532366, "body": "No, that&#39;s mean you should not to use references, because it&#39;s model for impure variables."}, {"owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "edited": false, "score": 0, "creation_date": 1498553542, "post_id": 44775708, "comment_id": 76532448, "body": "Does &quot;No&quot; mean we won&#39;t need Mutex in such case?"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "edited": false, "score": 1, "creation_date": 1498553780, "post_id": 44775708, "comment_id": 76532608, "body": "Yes! Because it never will be changed. You can read it many times from many threads and all be fine."}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 8, "last_activity_date": 1498727558, "last_edit_date": 1498727558, "creation_date": 1498552696, "answer_id": 44775708, "question_id": 44775537, "link": "https://stackoverflow.com/questions/44775537/do-we-still-need-mutex-if-everything-is-immutable/44775708#44775708", "title": "Do we still need mutex if everything is immutable?", "body": "<p>Indeed, all variables are immutable. But they can represent, for example, references to objects and there is a class of functions that allow you to describe the process of changing the contents of these references. If a similar process is in another thread, then there will be a problem.</p>\n\n<p>You can say that Haskell is a language for modeling. And it's clean. But it allows you to model not pure calculations, but actual work on impure calculations makes runtime (or by FFI). And we need to design something like a mutex into our model for multithreaded programming.</p>\n\n<hr>\n\n<p><strong>ADDITION</strong></p>\n\n<p>I think, if you really want to understand why there is something like mutex in Haskell, first of all, you should understand how Haskell can have a function, for example, like <code>readFile</code> which takes a file path and returns its content? Problem is that <code>readFile</code> must be pure and impure, which is paradoxical. So, how in Haskell this paradox solved? Try to answer on this question and I believe you will understand more things by this way.</p>\n"}, {"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": false, "score": 3, "last_activity_date": 1498554777, "creation_date": 1498554777, "answer_id": 44776391, "question_id": 44775537, "link": "https://stackoverflow.com/questions/44775537/do-we-still-need-mutex-if-everything-is-immutable/44776391#44776391", "title": "Do we still need mutex if everything is immutable?", "body": "<p>I'm not too sure where you're finding a structure called Mutex, but if you're talking about Data.Mutex, that's for the Fay language, which is a javascript-targetting language.</p>\n\n<p>If you're talking about Control.Concurrent.Lock, that's what freestyle said which is that it's modelling a locking mechanism.</p>\n\n<p>The more usual way of doing inter-process concurrency, though, uses what's called <strong>Software Transactional Memory</strong> and this uses the Control.Monad.STM module which uses a form of transactional memory that has a kind of automatic locking mechanism where most of the time you don't have to worry about manual locking. This is comparatively amazing when you consider manual locking.</p>\n\n<p>Rich Hickey has been responsible for pushing this idea further into the mainstream by making an implementation of it in the Clojure language, but essentially this mechanism allows the application level programmer to not worry about the extreme pain of manual locking and synchronisation mechanisms. Reads are extremely fast because of immutability and writes get replayed automatically. Simon Peyton Jones has a paper on it and here's a link to a video of him talking about it at an o'reilly conference called \"Transactional Memory for Concurrent Programming\": <a href=\"https://www.youtube.com/watch?v=4caDLTfSa2Q\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=4caDLTfSa2Q</a></p>\n"}], "owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 1, "accepted_answer_id": 44775708, "answer_count": 2, "score": 3, "last_activity_date": 1498727558, "creation_date": 1498552113, "question_id": 44775537, "link": "https://stackoverflow.com/questions/44775537/do-we-still-need-mutex-if-everything-is-immutable", "title": "Do we still need mutex if everything is immutable?", "body": "<p>I noticed there is a Mutex structure in Haskell. I did not understand how it works as I am not a Haskell developer, but If every variable is immutable (as FP is advocating), why do we still need a mutex?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "edited": false, "score": 0, "creation_date": 1498551762, "post_id": 44775289, "comment_id": 76531340, "body": "What was the error message?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1498552049, "post_id": 44775289, "comment_id": 76531508, "body": "That error message is a red herring."}, {"owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "edited": false, "score": 0, "creation_date": 1498552179, "post_id": 44775289, "comment_id": 76531588, "body": "<code>3</code> and <code>45</code> are not getting pattern matched into your <code>mappend</code> at all, it&#39;s going to a <code>Num</code>."}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 4, "last_activity_date": 1498552429, "creation_date": 1498552429, "answer_id": 44775636, "question_id": 44775289, "link": "https://stackoverflow.com/questions/44775289/how-does-it-pattern-match/44775636#44775636", "title": "How does it pattern match?", "body": "<p>You've declared <code>mappend</code> to be part of an instance of <code>Monoid (First' a)</code>, so the type of <code>mappend</code> is</p>\n\n<pre><code>First' a -&gt; First' a -&gt; First' a\n</code></pre>\n\n<p>Notice that all three <code>mappend</code> patterns are indented to the right of the instance declaration. This means that they're <em>scoped</em> to that instance, with that type.</p>\n\n<p><code>mappend _ _</code> is a <em>pattern</em>, but its <em>type</em> is <code>First' a -&gt; First' a -&gt; First' a</code>. The wildcards only indicate that the arguments could be any <code>First' a</code> values.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 44775636, "answer_count": 1, "score": 1, "last_activity_date": 1498553367, "creation_date": 1498551243, "last_edit_date": 1498551903, "question_id": 44775289, "link": "https://stackoverflow.com/questions/44775289/how-does-it-pattern-match", "title": "How does it pattern match?", "body": "<p>I have a data type, that uses monoid implementation:</p>\n\n<pre><code>newtype First' a = \n  First' {getFirst' :: Optional a} \n  deriving (Eq, Show)\n\ninstance Arbitrary a =&gt; Arbitrary (First' a) where\n  arbitrary = do\n    x &lt;- arbitrary\n    frequency [ (1, return (First'(Only x)))\n              , (1, return (First' Nada))]   \n\ninstance Monoid (First' a) where\n  mempty = First' Nada\n  mappend (First' (Only x)) _ = First' (Only x)\n  mappend (First' Nada) (First' (Only x)) = First' (Only x)\n  mappend _ _ = First' Nada\n</code></pre>\n\n<p>The last implementation of <code>mappend</code> says, if it does not pattern match two previous <code>mappend</code> function, then the third would be taken.   </p>\n\n<p>The last <code>mappend</code> function is not obvious for me, that I have to pass <code>First'</code> datatype. It seems for me, I could pass any datatype because of the underscore.  </p>\n\n<p>How does the haskell know, when I use the function as:  </p>\n\n<pre><code>mappend (First' Nada) (First' Nada)\n</code></pre>\n\n<p>that the last is pattern matched<code>(mappend _ _)</code>? </p>\n\n<p>Out of curiosity I tried: </p>\n\n<pre><code>*Main First Lib MonoidLaws&gt; mappend 3 45\n</code></pre>\n\n<p>But haskell compiler complains.</p>\n\n<pre><code>&lt;interactive&gt;:14:1: error:\n    * Ambiguous type variable `a0' arising from a use of `print'\n      prevents the constraint `(Show a0)' from being solved.\n      Probable fix: use a type annotation to specify what `a0' should be.\n      These potential instances exist:\n        instance [safe] Show Args -- Defined in `Test.QuickCheck.Test'\n        instance [safe] Show Result -- Defined in `Test.QuickCheck.Test'\n        instance Show All -- Defined in `Data.Monoid'\n        ...plus 35 others\n        ...plus 22 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    * In a stmt of an interactive GHCi command: print it\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 7065821, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/iLZC7.png?s=128&g=1", "display_name": "Challenger5", "link": "https://stackoverflow.com/users/7065821/challenger5"}, "edited": false, "score": 0, "creation_date": 1498549573, "post_id": 44774775, "comment_id": 76530095, "body": "Is there any way to constrain <code>(&gt;&gt;=)</code> so that its type signature is <code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m a) -&gt; m a</code>?"}, {"owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "reply_to_user": {"reputation": 769, "user_id": 7065821, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/iLZC7.png?s=128&g=1", "display_name": "Challenger5", "link": "https://stackoverflow.com/users/7065821/challenger5"}, "edited": false, "score": 1, "creation_date": 1498549781, "post_id": 44774775, "comment_id": 76530213, "body": "I am not sure, but I think one approach would be to modify <code>Failure</code> to something like <code>data Effect a = Failure FailMsg | ...</code>. This allows you to essentially then propagate some data of type <code>FailMsg</code> through the <code>&gt;&gt;=</code> operators. Because <code>FailMsg</code> does not depend on type variable <code>a</code>, you don&#39;t have the problem you hit with the <code>&gt;&gt;=</code> operator&#39;s type."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 769, "user_id": 7065821, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/iLZC7.png?s=128&g=1", "display_name": "Challenger5", "link": "https://stackoverflow.com/users/7065821/challenger5"}, "edited": false, "score": 1, "creation_date": 1498551305, "post_id": 44774775, "comment_id": 76531111, "body": "@Challenger5 no this wouldn&#39;t be a monad. If you want to preserve a type parameter throughout a chain of monadic operations, it should be <i>another</i> type parameter. Something like <code>data Effect s a = Failure s | Effect s a [Int]</code> and <code>instance Monad (Effect s) where...</code> but I have no idea how to continue with this. Perhaps give a couple of use cases."}, {"owner": {"reputation": 769, "user_id": 7065821, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/iLZC7.png?s=128&g=1", "display_name": "Challenger5", "link": "https://stackoverflow.com/users/7065821/challenger5"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498628365, "post_id": 44774775, "comment_id": 76569311, "body": "@n.m. I actually only ever want <code>Effect</code> to be used with a single type."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 769, "user_id": 7065821, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/iLZC7.png?s=128&g=1", "display_name": "Challenger5", "link": "https://stackoverflow.com/users/7065821/challenger5"}, "edited": false, "score": 0, "creation_date": 1498629267, "post_id": 44774775, "comment_id": 76569655, "body": "@Challenger5 You don&#39;t have or need a monad then. Perhaps a monoid"}], "tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": false, "score": 2, "last_activity_date": 1498549946, "last_edit_date": 1498549946, "creation_date": 1498549380, "answer_id": 44774775, "question_id": 44774655, "link": "https://stackoverflow.com/questions/44774655/haskell-type-error-when-defining-monad/44774775#44774775", "title": "Haskell Type Error when Defining Monad", "body": "<p>As of GHC 7.10, you unfortunately need to implement <code>Monad</code>, <code>Applicative</code>, and <code>Functor</code> due to the <a href=\"https://wiki.haskell.org/Functor-Applicative-Monad_Proposal\" rel=\"nofollow noreferrer\">Functor-Applicative-Monad Proposal</a>.</p>\n\n<p>The reason you get the type error is because the type of <code>&gt;&gt;=</code> is:</p>\n\n<pre><code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>This means that the function you pass in <strong>gives back</strong> type <code>m b</code>. However, because you give back <code>Failure debugS</code>, this is of type <code>m a</code>, which is a type mismatch, because it essentially forces the <code>&gt;&gt;=</code> to conform as:</p>\n\n<pre><code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m a) -&gt; m a  -- Wrong!\n</code></pre>\n\n<p>The <code>debugS</code> that you return will have to be different.</p>\n"}], "owner": {"reputation": 769, "user_id": 7065821, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/iLZC7.png?s=128&g=1", "display_name": "Challenger5", "link": "https://stackoverflow.com/users/7065821/challenger5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498549946, "creation_date": 1498549015, "question_id": 44774655, "link": "https://stackoverflow.com/questions/44774655/haskell-type-error-when-defining-monad", "title": "Haskell Type Error when Defining Monad", "body": "<p>I have a type <code>Effect</code> which represents an effect on a stack. An <code>Effect</code> can either be a successful effect which modifies a stack and optionally generates output, or it can be an error that remembers how the stack looked when it failed.</p>\n\n<pre><code>data Effect a = Failure a | Effect a [Int]\ninstance Monad Effect where\n    return s = Effect s []\n    (Failure debugS) &gt;&gt;= _ = Failure debugS\n    (Effect oldS oldO) &gt;&gt;= f =\n        case f oldS of\n            (Failure debugS) -&gt; Failure debugS\n            (Effect newS newO) -&gt; Effect newS (newO ++ oldO)\n</code></pre>\n\n<p>Binding should concatenate the results (in reverse order, I am aware). However, at the moment GHC gives me the following error message:</p>\n\n<pre><code>example.hs:2:10:\n    No instance for (Applicative Effect)\n      arising from the superclasses of an instance declaration\n    In the instance declaration for \u2018Monad Effect\u2019\n\nexample.hs:4:38:\n    Couldn't match expected type \u2018b\u2019 with actual type \u2018a\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n          the type signature for\n            (&gt;&gt;=) :: Effect a -&gt; (a -&gt; Effect b) -&gt; Effect b\n          at example.hs:4:22\n      \u2018b\u2019 is a rigid type variable bound by\n          the type signature for\n            (&gt;&gt;=) :: Effect a -&gt; (a -&gt; Effect b) -&gt; Effect b\n          at example.hs:4:22\n    Relevant bindings include\n      debugS :: a (bound at example.hs:4:14)\n      (&gt;&gt;=) :: Effect a -&gt; (a -&gt; Effect b) -&gt; Effect b\n        (bound at example.hs:4:5)\n    In the first argument of \u2018Failure\u2019, namely \u2018debugS\u2019\n    In the expression: Failure debugS\n</code></pre>\n\n<p>I am new to Haskell and unused to GHC's error messages. How should I correct this error?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1498547403, "post_id": 44773452, "comment_id": 76528821, "body": "I think part of the confusion may be resulting from the unorthodox formatting of your code. What you&#39;ve written as <code>head.group &quot;1234&quot;</code> would normally be written equivalently as <code>head . group &quot;1234&quot;</code>. Also, just in case this isn&#39;t already clear, it&#39;s important to understand that <code>.</code> is not a special construct in the language; it is <a href=\"https://www.stackage.org/haddock/lts-8.20/base-4.9.1.0/Prelude.html#v:.\" rel=\"nofollow noreferrer\">an ordinary function</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1498550881, "post_id": 44773452, "comment_id": 76530890, "body": "@ChrisMartin But as soon as <code>.</code> is in infix position, it is evaluated as an operator, right? And normal function application has precedence over operators. So <code>(.) head group &quot;1234&quot;</code> would work."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1498629368, "post_id": 44773452, "comment_id": 76569704, "body": "@ftor right, because <code>(.) head group &quot;1234&quot;</code> is the same as <code>(((.) head) group) &quot;1234&quot; = ((.) head group) &quot;1234&quot; = (head . group) &quot;1234&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 6581912, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/5f01ffd293668d9f604ab20986d4b247?s=128&d=identicon&r=PG&f=1", "display_name": "mc.robin", "link": "https://stackoverflow.com/users/6581912/mc-robin"}, "edited": false, "score": 0, "creation_date": 1498545370, "post_id": 44773581, "comment_id": 76527707, "body": "Thank you. A anthor question, why let f = head.group, f  [1,2, 3] get a error"}, {"owner": {"reputation": 149, "user_id": 6581912, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/5f01ffd293668d9f604ab20986d4b247?s=128&d=identicon&r=PG&f=1", "display_name": "mc.robin", "link": "https://stackoverflow.com/users/6581912/mc-robin"}, "edited": false, "score": 0, "creation_date": 1498545846, "post_id": 44773581, "comment_id": 76527957, "body": "this is the error info: &lt;interactive&gt;:4:4:     No instance for (Num ()) arising from the literal <code>1&#39;     Possible fix: add an instance declaration for (Num ())     In the expression: 1     In the first argument of </code>f&#39;, namely `[1, 2, 3]&#39;     In the expression: f [1, 2, 3]"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 149, "user_id": 6581912, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/5f01ffd293668d9f604ab20986d4b247?s=128&d=identicon&r=PG&f=1", "display_name": "mc.robin", "link": "https://stackoverflow.com/users/6581912/mc-robin"}, "edited": false, "score": 0, "creation_date": 1498546247, "post_id": 44773581, "comment_id": 76528176, "body": "That&#39;s the <a href=\"https://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\">monomorphism restriction</a>. It should not happen in GHCi. Please not that interpreted code slightly differs from compiled one."}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1498548563, "post_id": 44773581, "comment_id": 76529513, "body": "Maybe mentioning the term <a href=\"https://www.stackage.org/haddock/lts-8.20/base-4.9.1.0/Prelude.html#v:.\" rel=\"nofollow noreferrer\">composition</a> in your answer would be informative."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 4, "last_activity_date": 1498544945, "creation_date": 1498544945, "answer_id": 44773581, "question_id": 44773452, "link": "https://stackoverflow.com/questions/44773452/confused-about-dot-operator-in-haskell/44773581#44773581", "title": "confused about dot-operator in haskell", "body": "<p>Because</p>\n\n<pre><code>(head . group) \"1234\" = f \"12345\"\n  where\n    f = head . group\n</code></pre>\n\n<p>whereas</p>\n\n<pre><code>head . group \"1234\" = head . (group \"1234\") \n                    = head . f\n  where\n    f = group \"1234\"\n</code></pre>\n\n<p>but <code>group \"1234\"</code> isn't a function. Remember, function application binds stronger than operators.</p>\n"}], "owner": {"reputation": 149, "user_id": 6581912, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/5f01ffd293668d9f604ab20986d4b247?s=128&d=identicon&r=PG&f=1", "display_name": "mc.robin", "link": "https://stackoverflow.com/users/6581912/mc-robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498547200, "creation_date": 1498544457, "last_edit_date": 1498547200, "question_id": 44773452, "link": "https://stackoverflow.com/questions/44773452/confused-about-dot-operator-in-haskell", "title": "confused about dot-operator in haskell", "body": "<pre><code>(head.group) \"1234\"\n</code></pre>\n\n<p>It work.</p>\n\n<pre><code>head.group \"1234\"\n</code></pre>\n\n<p>I get errors:</p>\n\n<pre><code>&lt;interactive&gt;:8:6:\nCouldn't match expected type `a0 -&gt; [c0]'\n            with actual type `[[Char]]'\nIn the return type of a call of `group'\nProbable cause: `group' is applied to too many arguments\nIn the second argument of `(.)', namely `group \"1234\"'\nIn the expression: head . group \"1234\"\n</code></pre>\n\n<p>I think (head.group) is same as head.group, why (head.group) work and head.group not.</p>\n"}, {"tags": ["haskell", "web", "yesod"], "comments": [{"owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "edited": false, "score": 0, "creation_date": 1498556968, "post_id": 44770844, "comment_id": 76534779, "body": "Are you using <code>stack</code>? If so, did you run <code>stack setup</code>? I sometimes forget to run this and it results in a similar error."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 6255674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1f08713330e67540f83a3d95c7c8d9?s=128&d=identicon&r=PG&f=1", "display_name": "Pranay Sashank", "link": "https://stackoverflow.com/users/6255674/pranay-sashank"}, "is_accepted": true, "score": 1, "last_activity_date": 1499098096, "creation_date": 1499098096, "answer_id": 44889992, "question_id": 44770844, "link": "https://stackoverflow.com/questions/44770844/yesod-add-handler-results-in-error/44889992#44889992", "title": "yesod add-handler results in error", "body": "<p>As pointed in the issue, add-handler is broken in the scaffolding update.</p>\n\n<p>However, you can add routes yourself. Let us say you want to add a route for GET requests at /NewRoute and name the resource NewRouteR</p>\n\n<ul>\n<li><p>On a new line add the new route in the <code>config/routes</code> file</p>\n\n<pre><code>/NewRoute NewRouteR GET\n</code></pre></li>\n<li><p>Create a new file in Handler directory - NewRoute.hs with this default content</p>\n\n<pre><code>module NewRoute where\nimport Import\n\ngetNewRoute :: Handler Html\ngetNewRoute = error \"Route not implemented : NewRoute\"\n</code></pre></li>\n<li><p>Add this to list of imports in <code>Application.hs</code></p>\n\n<pre><code>import Handler.NewRoute\n</code></pre></li>\n<li><p>Also add it to the list of exposed modules in the .cabal file</p>\n\n<pre><code>exposed-modules:\n    Handler.NewRoute\n</code></pre></li>\n<li><p>also depending on whether you need the authentication provided by the scaffolding, add this route to the list of patterns in the <code>Yesod App</code> instance in <code>Foundation.hs</code></p>\n\n<pre><code>isAuthorized NewRouteR _ = return Authorized -- No authentication\n-- or --\nisAuthorized NewRouteR _ = isAuthenticated\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 1491, "user_id": 3923882, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f8d4455db0f00ed542fb86deda730d11?s=128&d=identicon&r=PG&f=1", "display_name": "arcticmatt", "link": "https://stackoverflow.com/users/3923882/arcticmatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 44889992, "answer_count": 1, "score": 0, "last_activity_date": 1499098096, "creation_date": 1498525232, "last_edit_date": 1498529720, "question_id": 44770844, "link": "https://stackoverflow.com/questions/44770844/yesod-add-handler-results-in-error", "title": "yesod add-handler results in error", "body": "<p>I followed the 6 steps outlined here <a href=\"http://www.yesodweb.com/page/quickstart\" rel=\"nofollow noreferrer\">http://www.yesodweb.com/page/quickstart</a> (except the first step, b/c I already had stack), and everything works. However, when I attempt to run <code>stack exec -- yesod add-handler</code>, I get the following output: </p>\n\n<pre><code>Name of route (without trailing R): A\nEnter route pattern (ex: /entry/#EntryId): /a\nEnter space-separated list of methods (ex: GET POST): GET\nyesod: Application.hs: openFile: does not exist (No such file or directory)\n</code></pre>\n\n<p>I also tried it with the <code>yesod-postgres</code> stack template, and got the same result. Any ideas?</p>\n\n<p>EDIT: Looks like this was already an issue <a href=\"https://github.com/yesodweb/yesod/issues/1413\" rel=\"nofollow noreferrer\">https://github.com/yesodweb/yesod/issues/1413</a>. </p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1498521551, "post_id": 44770317, "comment_id": 76521497, "body": "<code>runReader (do { s1 &lt;- r &quot;This&quot;; s2 &lt;- r s1; r s2 }) m</code> does it. Although for this sort of stuff, you are probably more interested in the <code>&gt;=&gt;</code> operator and <code>Kleisli</code> newtype. For example, <code>runReader ((r &gt;=&gt; r &gt;=&gt; r) &quot;This&quot;) m</code> does the same thing."}], "answers": [{"tags": [], "owner": {"reputation": 760, "user_id": 8009379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c808a3b5c059f2b448f39970d384fd33?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8009379/alex"}, "is_accepted": false, "score": 2, "last_activity_date": 1498522299, "last_edit_date": 1498522299, "creation_date": 1498521656, "answer_id": 44770401, "question_id": 44770317, "link": "https://stackoverflow.com/questions/44770317/sugaring-monadic-code-from-reader-monad/44770401#44770401", "title": "Sugaring monadic code from Reader monad", "body": "<p>The <code>do</code>-notation is just:</p>\n\n<pre><code>runReader r' m\n    where r' = do\n        x &lt;- r \"This\"\n        y &lt;- r x\n        z &lt;- r y\n        return z\n</code></pre>\n\n<p>But using <code>(&gt;&gt;=)</code> makes way more sense there.</p>\n"}, {"tags": [], "owner": {"reputation": 1677, "user_id": 4105099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/383350df3cda0186e32237dfc271490e?s=128&d=identicon&r=PG&f=1", "display_name": "jan.vogt", "link": "https://stackoverflow.com/users/4105099/jan-vogt"}, "is_accepted": true, "score": 3, "last_activity_date": 1498524389, "last_edit_date": 1498524389, "creation_date": 1498523171, "answer_id": 44770589, "question_id": 44770317, "link": "https://stackoverflow.com/questions/44770317/sugaring-monadic-code-from-reader-monad/44770589#44770589", "title": "Sugaring monadic code from Reader monad", "body": "<p>You could do</p>\n\n<pre><code>runReader threeRs m where\n  threeRs = do\n   a &lt;- r \"This\"\n   b &lt;- r a\n   r b\n</code></pre>\n\n<p>although I would not recommend this. In this case using the bind (<code>&gt;&gt;=</code>) operator fits the actual chaining quite well. </p>\n\n<p>IMHO do notation is most useful when sequencing monadic operations where not all results are needed, results should be combined, or pure functions are used inbetween. See also <a href=\"https://stackoverflow.com/questions/16726659/should-do-notation-be-avoided-in-haskell\">Should do-notation be avoided in Haskell?</a></p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 44770589, "answer_count": 2, "score": 2, "last_activity_date": 1498524389, "creation_date": 1498521096, "question_id": 44770317, "link": "https://stackoverflow.com/questions/44770317/sugaring-monadic-code-from-reader-monad", "title": "Sugaring monadic code from Reader monad", "body": "<p>I wrote some monadic code using a reader monad and I wonder if there is any way to write using the do-notation:</p>\n\n<pre><code>m = Map.fromList [(\"This\",\"is\"), (\"is\",\"the\"), (\"the\",\"secret\")]\nf x m = fromMaybe \"default\" $ Map.lookup x m\n\nr :: String -&gt; Reader (Map String String) String)\nr x = reader $ \\m1 -&gt; f x m1\n\nrunReader ((r \"This\") &gt;&gt;= r &gt;&gt;= r) m\n-- \"secret\"\n</code></pre>\n\n<p>Now how would you write the last statement in do notation.</p>\n\n<p>I have a feeling all the \"expanded monads\" using <code>runX</code> functions don't really lend to do-notation.</p>\n"}, {"tags": ["windows", "haskell", "windows-10", "symlink"], "owner": {"reputation": 21, "user_id": 7957562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d4b88e48143c091ca8b53bab16d41b?s=128&d=identicon&r=PG&f=1", "display_name": "Spivee Forever", "link": "https://stackoverflow.com/users/7957562/spivee-forever"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1498545020, "creation_date": 1498519060, "last_edit_date": 1498545020, "question_id": 44770026, "link": "https://stackoverflow.com/questions/44770026/haskell-directory-creates-invalid-symlink-on-windows", "title": "Haskell Directory creates invalid symlink on Windows", "body": "<p>This year System.Directory was updated to include <code>createFileLink</code> and <code>createDirectoryLink</code> actions, and for me on Windows 10 both work fine for relative paths.</p>\n\n<p>When I use either on an absolute path (of about 50 character length, so I suppose in unicode it exceeds 260) it prepends <code>\\\\?\\</code> (i.e. <code>\"\\\\\\\\?\\\\\"</code>) to the paths, which can be seen from <code>DIR</code> as follows</p>\n\n<pre><code>&lt;SYMLINKD&gt;     source [\\\\?\\T:\\Code\\hLink\\binaries\\dest]\n&lt;SYMLINK&gt;      source.txt [\\\\?\\T:\\Code\\hLink\\binaries\\dest\\source.txt]\n</code></pre>\n\n<p>The directory link works fine, but the file link doesn't do anything, it doesn't even say that the target file is missing.</p>\n\n<p>When I create a file link using <code>MKLINK</code> without <code>\\\\?\\</code> in the absolute path it works fine as well, and when I create either link using <code>MKLINK</code>with <code>\\\\?\\</code> it has the same result.</p>\n\n<p>Is this a Windows problem? Can I make Haskell use short path format instead? (Using Win10 so apparently I can enable long paths via registry)\nShould the Windows api be passing the <code>\\\\?\\</code> header to symlinks at all?</p>\n\n<p><strong>References:</strong></p>\n\n<ul>\n<li><p>MaxPath and the meaning of <code>\\\\?\\</code>, plus disabling path limitations on Win10\n<a href=\"https://msdn.microsoft.com/en-us/library/aa365247(VS.85).aspx#maxpath\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/aa365247(VS.85).aspx#maxpath</a></p></li>\n<li><p>Changelog reporting the addition of <code>\\\\?\\</code> to win32 calls <a href=\"https://hackage.haskell.org/package/directory-1.3.1.1/changelog\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/directory-1.3.1.1/changelog</a></p></li>\n</ul>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1498517632, "post_id": 44769443, "comment_id": 76520517, "body": "Import <code>Control.Monad.Trans.Reader</code> instead of <code>Control.Monad.Reader</code>. The latter exposes a more general interface which sometimes makes more concise code, but also sometimes causes ambiguity messages like the one you got. To find out more about this particular sort of stuff, read up on the difference between <code>transformers</code> and <code>mtl</code>."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 3, "last_activity_date": 1498518945, "creation_date": 1498518945, "answer_id": 44770003, "question_id": 44769443, "link": "https://stackoverflow.com/questions/44769443/haskell-non-type-variable-argument/44770003#44770003", "title": "Haskell non type variable argument", "body": "<p>The immediate problem is due to the <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">monomorphism restriction</a>. The hand-waving explanation for this case is that <code>r = reader lookup'</code> looks like you are defining some concrete <code>r</code>, so Haskell will try to infer a monomorphic type signature for it (one without type variables).</p>\n\n<p>Since you imported <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Reader.html#v:reader\" rel=\"nofollow noreferrer\"><code>reader :: MonadReader r m =&gt; (r -&gt; a) -&gt; m a</code></a>, the Haskell infers that <code>reader lookup' :: MonadReader [Char] m =&gt; m [Char]</code>. Unfortunately, this is <em>not</em> monomorphic - Haskell doesn't know exactly what you want <code>m</code> to be. That is what the error message is saying: the type variable <code>m</code> is ambiguous.</p>\n\n<p>Adding an explicit type annotation like <code>reader lookup' :: Reader String String</code> removes this problem; it is now possible to infer that <code>m ~ Reader String</code>.</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1498518945, "creation_date": 1498515221, "question_id": 44769443, "link": "https://stackoverflow.com/questions/44769443/haskell-non-type-variable-argument", "title": "Haskell non type variable argument", "body": "<p>I try to work with the Reader Monad</p>\n\n<pre><code>m = Map.fromList [(\"a\",\"b\"), (\"b\",\"c\"), (\"c\",\"d\"), (\"d\",\"e\")]\nf x m = fromMaybe \"default value\" $ Map.lookup x m\n\nlookup' x = f x m\n</code></pre>\n\n<p>Now I wanted to create a reader monad:</p>\n\n<pre><code>r = reader lookup'\n-- Non type variable argument:\n--   in the constraint MonadReader [Char] m\n-- When checking the inferred type:\n--   b :: forall (m :: * -&gt; *). MonadReader [Char] m =&gt; m [Char]\n</code></pre>\n\n<p>The solution was to define the type:</p>\n\n<pre><code>r = reader lookup' :: Reader String String\n</code></pre>\n\n<p>Why does this solve the problem?</p>\n"}, {"tags": ["javascript", "haskell", "xmlhttprequest", "haskell-wai", "haskell-warp"], "comments": [{"owner": {"reputation": 10771, "user_id": 2427065, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/f0RVn.jpg?s=128&g=1", "display_name": "Sagar V", "link": "https://stackoverflow.com/users/2427065/sagar-v"}, "edited": false, "score": 0, "creation_date": 1498723593, "post_id": 44767107, "comment_id": 76619103, "body": "@Sacheie , try adding an <code>onerror</code> event handler which should alert the error. And let me know"}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "reply_to_user": {"reputation": 10771, "user_id": 2427065, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/f0RVn.jpg?s=128&g=1", "display_name": "Sagar V", "link": "https://stackoverflow.com/users/2427065/sagar-v"}, "edited": false, "score": 0, "creation_date": 1498743741, "post_id": 44767107, "comment_id": 76633846, "body": "@SagarV, I&#39;m not sure onerror() provides any extra error info - it looks to me just like a callback so you don&#39;t have to explicitly check the xhr properties to detect an error. I don&#39;t know how I might get more detailed error info than the fact that xhr.responseText is blank, and the xhr.status is 0."}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "reply_to_user": {"reputation": 1481, "user_id": 3762229, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/elF8y.jpg?s=128&g=1", "display_name": "Ryad Boubaker", "link": "https://stackoverflow.com/users/3762229/ryad-boubaker"}, "edited": false, "score": 0, "creation_date": 1498743774, "post_id": 44767107, "comment_id": 76633874, "body": "@Ryad The URL is not using SSL. And if it were, why would the request work on desktop browsers (and Chrome for Android).  I have the internet access permission in the Manifest (otherwise why would the page even load?) - <i>is there another permission I need for AJAX?</i>"}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 1, "creation_date": 1498746603, "post_id": 44767107, "comment_id": 76636253, "body": "Might be worthing trying another endpoint, something like <a href=\"http://httpbin.org/anything\" rel=\"nofollow noreferrer\">httpbin.org/anything</a> and see what the response is."}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "reply_to_user": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1498747664, "post_id": 44767107, "comment_id": 76637117, "body": "@ChrisStryczynski, with another endpoint it works. So my problem is server-side, surely... any suggestions what could be wrong with it? Like I said, other browsers query its endpoints just fine."}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 1, "creation_date": 1498752401, "post_id": 44767107, "comment_id": 76640681, "body": "I would try add the headers in just to see if they make a difference."}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "reply_to_user": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1498754848, "post_id": 44767107, "comment_id": 76642041, "body": "@ChrisStryczynski, I tried adding:  xhr.setRequestHeader(&#39;Cache-Control&#39;, &#39;no-cache&#39;); xhr.setRequestHeader(&#39;Accept&#39;, &#39;text/plain&#39;); xhr.setRequestHeader(&#39;Accept-Charset&#39;, &#39;utf-8&#39;);  But still, same failed result."}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "edited": false, "score": 0, "creation_date": 1498755361, "post_id": 44767107, "comment_id": 76642312, "body": "I also tried adding xhr.setRequestHeader(&#39;Connection&#39;, &#39;close&#39;) to the above list. No luck. Any other headers anyone suggest I try?"}, {"owner": {"reputation": 14587, "user_id": 5724303, "user_type": "registered", "profile_image": "https://graph.facebook.com/1100229700001875/picture?type=large", "display_name": "Kosh", "link": "https://stackoverflow.com/users/5724303/kosh"}, "edited": false, "score": 0, "creation_date": 1498775672, "post_id": 44767107, "comment_id": 76652539, "body": "Could you please do the ajax request and update your question with <code>Request Headers</code> and <code>Response Headers</code>? It may help."}], "answers": [{"comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1498839489, "post_id": 44837749, "comment_id": 76682576, "body": "Yeah, generally always use domain names unless you have a special reason not to. The problem in your case was probably a missing or incorrect Host field in the request header."}], "tags": [], "owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "is_accepted": true, "score": 1, "last_activity_date": 1498790136, "creation_date": 1498790136, "answer_id": 44837749, "question_id": 44767107, "link": "https://stackoverflow.com/questions/44767107/haskell-warp-wai-server-fails-to-respond-to-ajax-calls-from-android-embedded-web/44837749#44837749", "title": "Haskell WARP/WAI server fails to respond to AJAX calls from Android embedded WebView", "body": "<p>It turns out the problem was that the <em>WebView</em> was loading the page by IP address, while the JavaScript referred to it by domain name. For all I know, it might be common sense not to do that; but the way non-<em>WebView</em> clients handled it OK made me rule it out early as a possible problem.</p>\n"}], "owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 44837749, "answer_count": 1, "score": 0, "last_activity_date": 1498790136, "creation_date": 1498504579, "last_edit_date": 1498750117, "question_id": 44767107, "link": "https://stackoverflow.com/questions/44767107/haskell-warp-wai-server-fails-to-respond-to-ajax-calls-from-android-embedded-web", "title": "Haskell WARP/WAI server fails to respond to AJAX calls from Android embedded WebView", "body": "<p><strong><em>UPDATE 3</em></strong> When hitting the endpoint <em><a href=\"http://httpbin.org/user-agent\" rel=\"nofollow noreferrer\">http://httpbin.org/user-agent</a></em>, the request returns successfully. So something is wrong with my Haskell Warp+WAI application server.</p>\n\n<p>Any ideas what could make a server API call work for most browsers, but not for Android WebView?</p>\n\n<hr>\n\n<p>Just to clarify, I <strong>am not doing any cross-domain requests.</strong> I see hundreds of questions on here about that, but my AJAX request is to the same domain the WebView has loaded.</p>\n\n<p><strong><em>UPDATE 2</em></strong> Instead of jQuery I used the more basic <em>xhr</em> method, like so:</p>\n\n<pre><code>function pingServer()\n{\n  var xhr = new XMLHttpRequest();\n  xhr.open('get', URL + 'ping');\n\n  // Track the state changes of the request.\n  xhr.onreadystatechange = function()\n  {\n    var DONE = 4; // readyState 4 means the request is done.\n    var OK   = 200; // status 200 is a successful return.\n\n    if (xhr.readyState === DONE)\n    {\n      if (xhr.status === OK)\n      {\n        $('#submitDialog p').text(xhr.responseText + ' : ' + xhr.status);\n      }\n      else\n      {\n        $('#submitDialog p').text(xhr.responseText + ' : ' + xhr.status);\n      }\n    }\n  };\n  xhr.send(null);\n}\n</code></pre>\n\n<p>Still no luck. The <em>xhr.responseText</em> is blank, and the <em>xhr.status</em> is 0.</p>\n\n<p>I'm wondering if something is wrong with my server? I'm using an unusual server, the Haskell-based WARP with WAI. ...but then why does everything work fine in every other browser?</p>\n\n<hr>\n\n<p><strong><em>UPDATE</em></strong> I did some debugging and this is the error I'm getting on the AJAX call shown below (a basic 'is server up?' GET query):</p>\n\n<blockquote>\n  <p><em>error: NetworkError: Failed to execute 'send' on 'XMLHttpRequest': Failed to load '<a href=\"http://www.example.net:2753/ping\" rel=\"nofollow noreferrer\">http://www.example.net:2753/ping</a>'</em></p>\n</blockquote>\n\n<p>Needless to say the exact URL (the real one I'm using, not the example) loads fine in any mobile or desktop browser - only the Android WebView has this problem!</p>\n\n<hr>\n\n<p>I have a simple Android app; just a WebView that loads a remote URL (not a local resource). It works fine, except that all of my AJAX calls immediately invoke their error callback. I'm testing on a Samsung Galaxy S6, and building the app to SDK 21.</p>\n\n<p>Here is what my first AJAX call (which fails) looks like; the others use the same properties:</p>\n\n<pre><code>$.ajax(\n{\n  url: URL + 'ping',\n  cache: false,\n  async: false,\n  timeout: 5000,\n  error: fail,\n  success: transmitScore\n});\n</code></pre>\n\n<p>Of course, <em>transmitScore()</em> and <em>fail()</em> are defined elsewhere within scope.</p>\n\n<p>Here is what the setup of my WebView looks like:</p>\n\n<pre><code>import android.app.Activity;\nimport android.content.pm.ActivityInfo;\nimport android.os.Bundle;\nimport android.webkit.WebView;\nimport android.webkit.WebViewClient;\n\nimport java.util.Locale;\n\npublic class Example extends Activity\n{\n    /** Called when the activity is first created. */\n    @Override\n    public void onCreate(Bundle savedInstanceState)\n    {\n        super.onCreate(savedInstanceState);\n\n        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);\n        setContentView(R.layout.main);\n\n        WebView wv = (WebView) findViewById(R.id.webview);\n\n        wv.setWebViewClient(new WebViewClient()\n        {\n            public void onPageFinished(WebView v, String s)\n            {\n                v.loadUrl(\"javascript: setLang('\" +\n                    Locale.getDefault().getLanguage() + \"')\");\n            }\n        });\n        wv.getSettings().setJavaScriptEnabled(true);\n        wv.loadUrl(\"http://example_url_for_privacy:2753/application\");\n    }\n}\n</code></pre>\n\n<p>Any ideas what is going wrong? The AJAX calls work fine in desktop Chrome and Android Chrome.</p>\n\n<p>I have seen a lot of questions on here about AJAX calls to <em>local resource files</em> requiring cross-domain permissions, but that's not my situation. All resources are on the remote server, and all AJAX calls go to it.</p>\n\n<p>I've also tried setting my <em>WebView</em> to use <em>WebChromeClient</em>, but it made no difference. I believe nowadays it is the default for <em>WebViews</em>. In the AJAX calls, I've tried the four possible combinations of <em>async</em> and <em>cache</em>; none work.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498503286, "post_id": 44766698, "comment_id": 76514441, "body": "The second argument <i>is not per se</i> called. If the first argument is for instance <code>const False</code>, then Haskell does not care about the second function or the input at all."}, {"owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498503408, "post_id": 44766698, "comment_id": 76514509, "body": "Willem Van Onsem,  I understand that but my question is really: How to interpret functions in Haskell, from my experience so far, I have to read input-arguments from right to left in order for them to make sence"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1498503495, "post_id": 44766698, "comment_id": 76514551, "body": "Did you mix up the order of arguments in your type signature vs. the line below it? If the type signature is <code>(b -&gt; c) -&gt; (a -&gt; b) -&gt; c</code>, then the first argument would have type <code>b -&gt; c</code>, not <code>a -&gt; b</code>. Beyond that I have a hard time understanding what you&#39;re asking."}, {"owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "edited": false, "score": 0, "creation_date": 1498503669, "post_id": 44766698, "comment_id": 76514630, "body": "sepp2k, no I did not make a mistake, because in Haskell my type signature would actually work, and the only way it would work is if a -&gt; b -&gt; b -&gt; c is true"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1498503872, "post_id": 44766698, "comment_id": 76514750, "body": "@AugustJelemson No, there are absolutely no restrictions on function types. There&#39;s nothing that stops you from writing a <code>g :: (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c</code> function. There&#39;s nothing that even says that function parameters would need to be functions. It&#39;s just a convention to use infix function composition this way."}, {"owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1498503975, "post_id": 44766698, "comment_id": 76514817, "body": "@Bergi, is it because of type inference?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1498504009, "post_id": 44766698, "comment_id": 76514834, "body": "I have no idea what you mean by &quot;<i>for this function definition to be true the types have to line up</i>&quot;."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1498504029, "post_id": 44766698, "comment_id": 76514842, "body": "Btw, you seem to be missing an <code>a</code> parameter somewhere in the signature of <code>f</code>."}, {"owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "edited": false, "score": 0, "creation_date": 1498504073, "post_id": 44766698, "comment_id": 76514864, "body": "if the types line up we have: a -&gt; b -&gt; b -&gt; c if they don&#39;t line up we have : b -&gt; c -&gt; a-&gt; b"}, {"owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "edited": false, "score": 0, "creation_date": 1498504176, "post_id": 44766698, "comment_id": 76514915, "body": "@AugustJelemson what makes you think they have to line up that way? <code>f</code> could do anything with those function arguments and then return anything. You seem to be confusing higher order functions with function composition."}, {"owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "edited": false, "score": 0, "creation_date": 1498504706, "post_id": 44766698, "comment_id": 76515217, "body": "@AugustJelemson yes, if you try to compose functions then the input and output types must line up. I (and apparently not just me) still don&#39;t understand what that has to do with what you wrote. If I use concrete instead of generic types and say <code>f :: (String -&gt; Int) -&gt; (Bool -&gt; String) -&gt; Int</code> then what I have is a &#39;function which takes a function from string to int and yields a function that takes a function from bool to string and yields and int. Which is invalid because...?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1498508296, "post_id": 44766698, "comment_id": 76517025, "body": "I&#39;d advice you to implement some of these <a href=\"https://hackage.haskell.org/package/data-aviary-0.4.0/docs/Data-Aviary-Birds.html\" rel=\"nofollow noreferrer\">birds</a> to get a better feel for type signatures and the corresponding combinator implementations. There are a lot of birds flying around, not only bluebirds."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1498510116, "post_id": 44766698, "comment_id": 76517908, "body": "This question has so many terminology mistakes and so much vagueness that it is very difficult to tell what you currently believe to be true; this makes it next to impossible to identify the mistake(s) in your current beliefs. I&#39;m voting to close -- but I encourage you to try to crystallize your claims here to be more precise. The following phrases appear to be unexplained (and not using their standard meaning, where one exists): &quot;first&quot;/&quot;second&quot; argument, &quot;function definition&quot;, a function definition that is &quot;true&quot;, type equivalence, &quot;composed functions&quot;, &quot;read functions left to right&quot;."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1498526642, "post_id": 44766698, "comment_id": 76522667, "body": "If I&#39;m reading the question right the answer is: No, it&#39;s not fundamental that you &quot;have to read arguments from right to left for functions to make sense&quot;, and you shouldn&#39;t try to read everything that way. The <code>.</code> operator could easily have been defined the other way around, we weren&#39;t <i>forced</i> to write it that way. It has the useful property that in <code>(f . g . h) x</code> the argument <code>x</code> &quot;moves through&quot; the functions in the same order as in ordinary application like <code>f (g (h x))</code>. But that&#39;s <i>just</i> function composition; many other functions do things differently (such as <code>&gt;&gt;=</code> for example)."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1498527029, "post_id": 44766698, "comment_id": 76522767, "body": "I&#39;m nominating this for reopening; it could certainly be worded <i>better</i>, but I think I understand what the OP&#39;s question is. They&#39;ve seen some functions (like <code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; c</code>) that seem to make more sense to them when they consider the arguments in right-to-left order (so in <code>f . g</code>, thinking of <code>g</code> as the &quot;first&quot; argument of <code>(.)</code> and <code>f</code> as the second), and are wondering if that&#39;s a property of Haskell functions more generally."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1498534519, "post_id": 44766698, "comment_id": 76524216, "body": "@Ben, I disagree. I believe the OP will have a much better chance of resolving their confusion through other paths than this question, and I doubt that other users will find this question helpful."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1498556632, "post_id": 44766698, "comment_id": 76534493, "body": "It worries me that this question is closed, because that&#39;s will just make OP have a negative reaction about Haskell, which is really not what we want. A careful reading of the first few chapters of the tutorial I helped author would clear this up: <a href=\"http://happylearnhaskelltutorial.com\" rel=\"nofollow noreferrer\">happylearnhaskelltutorial.com</a>"}, {"owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "reply_to_user": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1498566686, "post_id": 44766698, "comment_id": 76541132, "body": "@JulianLeviston the question is closed because it does not meet the requirements of a stack overflow question, numerous people asked for but didn&#39;t get clarification from the OP, etc. Haskell is not the issue, although you&#39;re right that it doesn&#39;t make for good marketing that very issue has been beaten to death on meta."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "edited": false, "score": 0, "creation_date": 1498567857, "post_id": 44766698, "comment_id": 76542002, "body": "@JaredSmith it&#39;s nothing to do with <i>marketing</i> and everything to do with helping someone and others that are looking for similar answers, but don&#39;t necessarily have the skills to ask the right quesiton, or in the right way. It&#39;s quite possible to answer this in a way that covers of all of the kinds of questions it could possibly mean while educating this person as well as others like the OP."}, {"owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "reply_to_user": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1498570026, "post_id": 44766698, "comment_id": 76543595, "body": "@JulianLeviston I applaud your devotion to helping others. And don&#39;t disparage marketing, presenting a good face is not inherently <i>bad</i>. As for not having the skills to ask the right question, that&#39;s pretty common, and thus the requests for feedback (which were unfortunately ignored)."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "edited": false, "score": 0, "creation_date": 1498603245, "post_id": 44766698, "comment_id": 76562872, "body": "@JaredSmith fair enough... personally I&#39;ve been in similarly flummoxed places. I just wish I could write the answer I wish I could have had when in the OP&#39;s situation... which steps me through from nothing what&#39;s missing... because it&#39;s obvious that something&#39;s missing, but OP is probably finding it tricky threading through what&#39;s missing. All good, though. Hopefully they&#39;ll stick with it like I did."}], "answers": [{"tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": true, "score": 6, "last_activity_date": 1498504026, "creation_date": 1498504026, "answer_id": 44766959, "question_id": 44766698, "link": "https://stackoverflow.com/questions/44766698/are-all-arguments-in-haskell-read-from-left-to-right/44766959#44766959", "title": "Are all arguments in haskell read from left to right?", "body": "<p>I think you might be confusing things a little. In your example, replicated below:</p>\n\n<pre><code>f :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; c\n</code></pre>\n\n<p>Here <code>f</code> is a <a href=\"https://wiki.haskell.org/Higher_order_function\" rel=\"noreferrer\">higher order function</a>, which means that it can take other functions as parameters. As a matter of fact, its first parameter is a function of type <code>(b -&gt; c)</code>. Its second argument is a function of type <code>(a -&gt; b)</code>.</p>\n\n<p><strong>The parameters of a function do not have to be related to each other at all</strong>. In your case, it was simply a coincidence. We could have easily done something like this:</p>\n\n<pre><code>g :: (Int -&gt; Double) -&gt; (Char -&gt; Bool) -&gt; String\ng func1 func2 = \"three\"\n</code></pre>\n\n<p>Another thing to be aware of is that all functions in Haskell are <a href=\"https://wiki.haskell.org/Currying\" rel=\"noreferrer\">curried</a>. Think back to a language like C:</p>\n\n<pre><code>char foo (int a, double b) { ... } \n</code></pre>\n\n<p>The function takes <code>(int, double)</code> and returns a <code>char</code>. We might even write its type signature like this:</p>\n\n<pre><code>(int, double) -&gt; char\n</code></pre>\n\n<p>In Haskell, we don't require all parameters to be fed in at once, and it is expressed as this:</p>\n\n<pre><code>int -&gt; double -&gt; char\n</code></pre>\n\n<p>Why in the world would you want this? Consider the following scenario:</p>\n\n<pre><code>add :: Int -&gt; Int -&gt; Int\nadd a b = a + b\n</code></pre>\n\n<p>Check this out:</p>\n\n<pre><code>addFive :: Int -&gt; Int\naddFive = add 5\n</code></pre>\n\n<p>Applying <strong>less</strong> arguments than the function's parameter requires allows you to create new functions that are somewhat \"customized\". Pretty cool, huh? :)</p>\n"}], "owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "closed_date": 1498524214, "accepted_answer_id": 44766959, "answer_count": 1, "score": 0, "last_activity_date": 1498504026, "creation_date": 1498503012, "last_edit_date": 1498503906, "question_id": 44766698, "link": "https://stackoverflow.com/questions/44766698/are-all-arguments-in-haskell-read-from-left-to-right", "closed_reason": "Needs details or clarity", "title": "Are all arguments in haskell read from left to right?", "body": "<p>For example:</p>\n\n<pre><code>f :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; c\n        g           h\n</code></pre>\n\n<p>he function f takes two functions (lets call them g and h) as input-arguments, and returns a value of type c</p>\n\n<p>First argument: <code>(a -&gt; b)</code>\nSecond argument: <code>(b -&gt; c)</code>\nReturns: a value of type <code>c</code></p>\n\n<p>In order for this function definition to be true the types have to line up, like this: <code>(a -&gt; b) -&gt; (b -&gt; c)</code> &lt;=equivalent to=> <code>a -&gt; c</code></p>\n\n<p>and the only way for this to work is if the second argument is used as input for the first argument, like this g(h(x)), where x is of type a, is this true for all functions in Haskell? In other words\nis the right argument always going to be defined as the input for its left argument? And is this the general case for all composed functions in Haskell?\nAnd if so should I always read and interpret function-arguments from right to left instead of left to right?</p>\n\n<p>OBS:\nThis question is not the same question as:\n<a href=\"https://stackoverflow.com/questions/29878545/why-does-the-dot-compose-from-right-to-left-in-haskell\">Why does the dot compose from right to left in haskell</a>\nBecause my question is more general for all functions, also I already know that a function composed of other functions is called function compositon, and I know about the dot-function etc.</p>\n"}, {"tags": ["haskell", "math", "monoids"], "comments": [{"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 3, "creation_date": 1498487619, "post_id": 44761991, "comment_id": 76505153, "body": "It depends on how would you like implement <code>mappend</code>."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 14, "last_activity_date": 1498488525, "last_edit_date": 1592644375, "creation_date": 1498487593, "answer_id": 44762149, "question_id": 44761991, "link": "https://stackoverflow.com/questions/44761991/what-is-the-identity-of-the-type/44762149#44762149", "title": "What is the identity of the type?", "body": "<p><strong>Short answer</strong>: It <strong>depends on the <code>mappend</code> function</strong>.</p>\n<blockquote>\n<p>What would be the identity of <code>Bull</code> type? What is the identity of <code>Bool</code> type?</p>\n</blockquote>\n<p>A type has <strong>no &quot;inherent&quot; identity</strong>, an <em>identity</em> element only exists <em>with respect to a binary function</em> (here <code>mappend</code>), like the <a href=\"https://en.wikipedia.org/wiki/Identity_element\" rel=\"noreferrer\"><em>Wikipedia article says</em></a>:</p>\n<blockquote>\n<p>In mathematics, an identity element or neutral element is a special type of element of a set <strong>with respect to a binary operation</strong> on that set, which leaves other elements unchanged when combined with them.</p>\n</blockquote>\n<p>So it depends on what opperation <code>mappend</code> is.</p>\n<p>In case of <code>Bool</code> if we define <code>mappend = (&amp;&amp;)</code>, then the <em>identity</em> element is <code>mempty = True</code>. But if we pick <code>mappend = (||)</code>, then <code>mempty = False</code>.</p>\n<p>Your <code>instance Moniod Bull</code> is <strong>incorrect</strong>. Since it cannot satisfy the property:</p>\n<pre><code>mappend mempty x = x\n</code></pre>\n<p>If we pick <code>Fools</code> as the <code>mempty = Fools</code>, then <code>mappend Fools Twoo</code> should be <code>Twoo</code>. And if we pick <code>mempty = Twoo</code>, then <code>mappend Twoo Twoo</code> is still not <code>Twoo</code>.</p>\n<p>The point of a <code>Monoid</code> is that you have to design the <em>binary operator</em> carefully. Like the <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html\" rel=\"noreferrer\">Haskell documentation on <code>Monoid</code></a> says, it should satisfy the following rues:</p>\n<blockquote>\n<pre><code>mappend mempty x = x\n\nmappend x mempty = x\n\nmappend x (mappend y z) = mappend (mappend x y) z\n\nmconcat = foldr mappend mempty\n</code></pre>\n</blockquote>\n<p>These rules are not &quot;invented&quot; for Haskell: a <em>monoid</em> is a well known <a href=\"https://en.wikipedia.org/wiki/Monoid\" rel=\"noreferrer\">algebraic structure</a>. Usually in mathematics, a monoid is denoted as a 3-tuple. For instance <em>(N, +, 0)</em> with <em>N</em> the set here (for instance the natural numbers), <em>+</em> the binary function, and <em>0</em> the identity element.</p>\n"}, {"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1498506216, "post_id": 44762286, "comment_id": 76516027, "body": "It is just a show case from the haskellbook. Thanks for answer."}], "tags": [], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "is_accepted": false, "score": 3, "last_activity_date": 1498488402, "last_edit_date": 1498488402, "creation_date": 1498488044, "answer_id": 44762286, "question_id": 44761991, "link": "https://stackoverflow.com/questions/44761991/what-is-the-identity-of-the-type/44762286#44762286", "title": "What is the identity of the type?", "body": "<p>There isn't a single monoid for a given set (or type, in Haskell). In fact, the identity in a monoid is not determined by the set on which it is defined, but rather by the operation (which is called <code>mappend</code> in Haskell). For example, a monoid on integers could be defined on addition (with identity <code>0</code>) or on product (with identity <code>1</code>).</p>\n\n<p>This is why the <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#v:Sum\" rel=\"nofollow noreferrer\"><code>Sum</code></a> and the <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#v:Product\" rel=\"nofollow noreferrer\"><code>Product</code></a> types exist: since there are multiple possible implementation of the <code>Monoid</code> typeclass on the set of <code>Num a =&gt; a</code>, we prefer to wrap it into a <code>newtype</code> and define the <code>Monoid</code> implementation on the wrapped type.</p>\n\n<p>There are similar constructs for the <code>Bool</code> type, with <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#t:All\" rel=\"nofollow noreferrer\"><code>All</code></a> , monoid on booleans under conjuction (<code>(&amp;&amp;)</code>) with identity <code>True</code>, and <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#t:Any\" rel=\"nofollow noreferrer\"><code>Any</code></a> , monoid on booleans under disjunction (<code>(||)</code>) with identity <code>False</code>. In fact, booleans can form monoids on lots of other operations (e.g. XOR and XNOR gates).</p>\n\n<p>Since the <code>Bull</code> type is isomorphic to the <code>Bool</code> type (both have exactly two nullary constructors), you can inspire yourself from the implementations of <code>Monoid</code> on <code>Bool</code>, but we cannot decide which implementation fits best in your case with further context.</p>\n\n<p>Also, as Anton Xue mentionned, even if you <em>could</em> define a monoid for <code>Bull</code>, does it really make sense ? What is your type supposed to represent?</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1498495735, "creation_date": 1498495735, "answer_id": 44764627, "question_id": 44761991, "link": "https://stackoverflow.com/questions/44761991/what-is-the-identity-of-the-type/44764627#44764627", "title": "What is the identity of the type?", "body": "<p>This is a great question, and one that I have played with several times before. In fact, it was one of the first uses of <a href=\"http://hackage.haskell.org/package/universe\" rel=\"noreferrer\">universe</a> that I ever came up with, and I still think it's a neat one. So let me show you!</p>\n\n<p>Here's the idea: we're going to use the universe package to enumerate <em>all</em> possible implementations of <code>mempty</code> and <code>mappend</code>, and then check which ones satisfy the laws. First, some boilerplate:</p>\n\n<pre><code>import Data.Universe\nimport Data.Universe.Instances.Reverse\n\ndata Bull = Fools | Twoo deriving (Bounded, Enum, Eq, Ord, Read, Show)\ninstance Universe Bull\ninstance Finite Bull\n</code></pre>\n\n<p>This just imports the appropriate bits of the package and defines your type. Now, let's code up the monoid laws. We want our <code>mappend</code> to be associative; writing <code>(+)</code> for <code>mappend</code>, we can demand:</p>\n\n<pre><code>associative        (+) = all (\\(x,y,z) -&gt; (x+y)+z == x+(y+z)) universe\n</code></pre>\n\n<p>The identity laws are very similar to each other, and connect our <code>mappend</code> to our <code>mempty</code> (which we'll call <code>(+)</code> and <code>zero</code> here):</p>\n\n<pre><code>leftIdentity  zero (+) = all (\\x -&gt; zero+x == x) universe\nrightIdentity zero (+) = all (\\x -&gt; x+zero == x) universe\n</code></pre>\n\n<p>A monoid should satisfy all three laws:</p>\n\n<pre><code>monoid (zero, (+)) = associative (+) &amp;&amp; leftIdentity zero (+) &amp;&amp; rightIdentity zero (+)\n</code></pre>\n\n<p>And now we can construct the list of all monoids just by filtering out the ones that meet the laws:</p>\n\n<pre><code>monoidsOnBull :: [(Bull, Bull -&gt; Bull -&gt; Bull)]\nmonoidsOnBull = filter monoid universe\n</code></pre>\n\n<p>Let's check it in ghci:</p>\n\n<pre><code>&gt; mapM_ print monoidsOnBull\n(Twoo,[(Fools,[(Fools,Fools),(Twoo,Fools)]),(Twoo,[(Fools,Fools),(Twoo,Twoo)])])\n(Fools,[(Fools,[(Fools,Fools),(Twoo,Twoo)]),(Twoo,[(Fools,Twoo),(Twoo,Fools)])])\n(Twoo,[(Fools,[(Fools,Twoo),(Twoo,Fools)]),(Twoo,[(Fools,Fools),(Twoo,Twoo)])])\n(Fools,[(Fools,[(Fools,Fools),(Twoo,Twoo)]),(Twoo,[(Fools,Twoo),(Twoo,Twoo)])])\n</code></pre>\n\n<p>(Aside: how should we read this output? Well, the universe package shows functions of type <code>a -&gt; b</code> by showing its graph of type <code>[(a, b)]</code>, that is, lists of pairs of inputs and outputs. Each line of the above output is a tuple with a suitable <code>mempty</code> in the first part and a suitable <code>mappend</code> in the second part.)</p>\n\n<p>So what do these monoids <em>do</em>? Let's take them one at a time:</p>\n\n<pre><code>(Twoo,[(Fools,[(Fools,Fools),(Twoo,Fools)]),(Twoo,[(Fools,Fools),(Twoo,Twoo)])])\n</code></pre>\n\n<p>Here the <code>mappend</code> outputs <code>Fools</code> unless both inputs are <code>Twoo</code>. That is, this is the <code>Bull</code> equivalent of <code>(&amp;&amp;)</code>. The identity for <code>(&amp;&amp;)</code> is <code>True</code> -- or <code>Twoo</code>, in <code>Bull</code>'s case.</p>\n\n<pre><code>(Fools,[(Fools,[(Fools,Fools),(Twoo,Twoo)]),(Twoo,[(Fools,Twoo),(Twoo,Fools)])])\n</code></pre>\n\n<p>This <code>mappend</code> outputs <code>Fools</code> if its two inputs are equal, and <code>Twoo</code> otherwise. You can think of this as kind of like xor on <code>Bool</code>, or two's complement addition on 1-bit numbers. Its identity is <code>Fools</code> (or zero).</p>\n\n<pre><code>(Twoo,[(Fools,[(Fools,Twoo),(Twoo,Fools)]),(Twoo,[(Fools,Fools),(Twoo,Twoo)])])\n</code></pre>\n\n<p>This one is just like the last one, but negated everywhere.</p>\n\n<pre><code>(Fools,[(Fools,[(Fools,Fools),(Twoo,Twoo)]),(Twoo,[(Fools,Twoo),(Twoo,Twoo)])])\n</code></pre>\n\n<p>This one is just like the first one, but negated everywhere. It also happens to be just like <code>(||)</code> on <code>Bool</code>, which has identity <code>False</code>.</p>\n\n<p>This ends the lecture, but there are two other fun notes worth adding.</p>\n\n<p>First, <code>base</code> offers the <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#t:All\" rel=\"noreferrer\"><code>All</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#t:Any\" rel=\"noreferrer\"><code>Any</code></a> monoids for when you want your <code>mappend</code> to be <code>(&amp;&amp;)</code> and <code>(||)</code>, respectively. As far as I know, there isn't a suitable newtype to get xor or its negation as a <code>Monoid</code>; but you can fake it by declaring a <code>Num</code> instance for <code>Bool</code> (using the <code>Word1</code> intuition that <code>False</code> is 0 and <code>True</code> is 1) to get it via <code>Sum Bool</code>.</p>\n\n<p>And second, another answer here asks: what monoid is there for <code>data Color = Red | Green | Blue</code>? We have all the machinery to answer that question now and affirm that there are in fact quite a few monoids:</p>\n\n<pre><code>&gt; length monoidsOnColor\n33\n</code></pre>\n\n<p>I encourage you to try to construct the code that will list them all and poke through them to see what insights you can gain!</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 1, "accepted_answer_id": 44762149, "answer_count": 3, "score": 3, "last_activity_date": 1498495735, "creation_date": 1498487138, "last_edit_date": 1498488600, "question_id": 44761991, "link": "https://stackoverflow.com/questions/44761991/what-is-the-identity-of-the-type", "title": "What is the identity of the type?", "body": "<p>I have following data type:</p>\n\n<pre><code>data Bull = Fools\n  | Twoo\n  deriving (Eq, Show)\n</code></pre>\n\n<p>and use Monoid to implement it:</p>\n\n<pre><code>instance Monoid Bull where\n  mempty = Fools\n  mappend _ _ = Fools\n</code></pre>\n\n<p>As you can see, <code>mempty</code> is the identity function the identity laws does not hold:</p>\n\n<pre><code>*Main&gt; x = Twoo\n*Main&gt; mappend mempty x == x\n</code></pre>\n\n<p>What would be the identity of <code>Bull</code> type?\nWhat is the identity of <code>Bool</code> type?</p>\n"}, {"tags": ["haskell", "functional-programming", "monoids"], "comments": [{"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 1, "creation_date": 1498479600, "post_id": 44759470, "comment_id": 76499693, "body": "Note that associativity and commutativity aren&#39;t really specific to functional programming, Haskell or monoids... they&#39;re general concepts for operations."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1498532414, "post_id": 44759470, "comment_id": 76523782, "body": "You are wondering the difference between <code>a+(b+c) == (a+b)+c</code> and <code>a+b == b+a</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1498479809, "post_id": 44759552, "comment_id": 76499844, "body": "what is exactly associative? I was thinking all the time, that associative is commutative."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1498480406, "last_edit_date": 1498480406, "creation_date": 1498479512, "answer_id": 44759552, "question_id": 44759470, "link": "https://stackoverflow.com/questions/44759470/difference-between-associative-and-commutative/44759552#44759552", "title": "Difference between associative and commutative", "body": "<p>If the monoid operation were commutative, we would have <code>\"a\"&lt;&gt;\"b\" \u2261 \"b\"&lt;&gt;\"a\"</code>. But clearly, <code>\"ab\"</code> and <code>\"ba\"</code> aren't the same string.</p>\n\n<p>Associativity is a rather weaker property, in fact people often consider it as \u201cobvious/trivial\u201d for about <em>any</em> operation. So let's look at an operation that's <em>not</em> associative \u2013 in fact that's simple enough to find, e.g. <em>subtraction</em>:</p>\n\n<pre><code>5 - (3 - 1) = 3\n(5 - 3) - 1 = 1\n</code></pre>\n\n<p>Most operations are neither associative nor commutative. Many operations are associative but not commutative. You'll seldom find an operation that's commutative but not associative though again it's easy to construct this; <a href=\"https://math.stackexchange.com/questions/160945/does-commutativity-imply-associativity\">an example from Maths.SE</a>:</p>\n\n<pre><code>(&amp;) :: Int -&gt; Int -&gt; Int\nx &amp; y = x*y + 1\n</code></pre>\n\n<p>This inherits commutativity from the multiplication, but is not associative because of the offset <code>1</code>.</p>\n\n<pre><code>Prelude&gt; 0 &amp; (1 &amp; 2)\n1\nPrelude&gt; (0 &amp; 1) &amp; 2\n3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1498479720, "post_id": 44759554, "comment_id": 76499775, "body": "Haskell uses <code>++</code> for concatenation of strings/lists, or <code>&lt;&gt;</code> which works for any monoid. (Just FTR)"}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1498479882, "post_id": 44759554, "comment_id": 76499889, "body": "@leftaroundabout: I was trying to give an example which would be familiar to programmers of multiple languages, as there&#39;s nothing really specific to monoids or Haskell here. Will edit the answer."}], "tags": [], "owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "is_accepted": true, "score": 12, "last_activity_date": 1498479917, "last_edit_date": 1498479917, "creation_date": 1498479524, "answer_id": 44759554, "question_id": 44759470, "link": "https://stackoverflow.com/questions/44759470/difference-between-associative-and-commutative/44759554#44759554", "title": "Difference between associative and commutative", "body": "<p>Take string concatenation as an example. Suppose you're using a language which uses <code>+</code> for string concatenation. That's naturally associative, as the grouping doesn't matter:</p>\n\n<pre><code>(\"a\" + \"b\") + \"c\" == \"abc\"\n\"a\" + (\"b\" + \"c\") == \"abc\"\n</code></pre>\n\n<p>But the operand order definitely matters:</p>\n\n<pre><code>\"a\" + \"b\" = \"ab\"\n\"b\" + \"a\" = \"ba\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": false, "score": 8, "last_activity_date": 1498480232, "creation_date": 1498480232, "answer_id": 44759793, "question_id": 44759470, "link": "https://stackoverflow.com/questions/44759470/difference-between-associative-and-commutative/44759793#44759793", "title": "Difference between associative and commutative", "body": "<p><strong>Associative but not Commutative:</strong></p>\n\n<p>Matrix multiplication is associative, but not commutative.</p>\n\n<pre><code>(AB)C = A(BC)\n</code></pre>\n\n<p>But:</p>\n\n<pre><code>AB != BA\n</code></pre>\n\n<p><strong>Commutative but not Associative:</strong></p>\n\n<p>The absolute value of the difference between two numbers is commutative, but not associative.</p>\n\n<pre><code>|a - b| = |b - a|\n</code></pre>\n\n<p>But:</p>\n\n<pre><code>||a - b| - c| != |a - |b - c||\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "accepted_answer_id": 44759554, "answer_count": 3, "score": 5, "last_activity_date": 1498480406, "creation_date": 1498479237, "question_id": 44759470, "link": "https://stackoverflow.com/questions/44759470/difference-between-associative-and-commutative", "title": "Difference between associative and commutative", "body": "<p>I am trying to understand associative in monoid.</p>\n\n<p>From the book, it says:</p>\n\n<blockquote>\n  <p>Associativity simply says that you can associate the arguments of your\n  operation differently and the result will be the same.</p>\n</blockquote>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; (1 + 9001) + 9001\n18003\nPrelude&gt; 1 + (9001 + 9001)\n18003\n</code></pre>\n\n<p>And about commutative:</p>\n\n<blockquote>\n  <p>This is not as strong a property as an operation that commutes or is\n  commutative. Commutative means you can reorder the arguments and still\n  get the same result. Addition and multiplication are commutative, but\n  (++) for the list type is only associative.</p>\n</blockquote>\n\n<p>The example above is associative and commutative but what is the difference? \nI can not see the difference.</p>\n"}, {"tags": ["haskell", "winapi"], "comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1498558526, "post_id": 44759086, "comment_id": 76535822, "body": "What about some error checking?"}, {"owner": {"reputation": 258, "user_id": 2064205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40e5c973f239d062814c831d66e5f79?s=128&d=identicon&r=PG", "display_name": "PleaseTwo", "link": "https://stackoverflow.com/users/2064205/pleasetwo"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1498561706, "post_id": 44759086, "comment_id": 76537938, "body": "Win32 has error checking functionality, if something went wrong it raises an exception. During the execution of this function, I didn&#39;t get exceptions."}, {"owner": {"reputation": 1304, "user_id": 231299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66dff0c4f2df2394109a0b09fa59dce1?s=128&d=identicon&r=PG", "display_name": "beerboy", "link": "https://stackoverflow.com/users/231299/beerboy"}, "edited": false, "score": 0, "creation_date": 1498604651, "post_id": 44759086, "comment_id": 76563298, "body": "The actual error checking performed in <code>createBMPFile</code> is... sub-par: see <a href=\"https://github.com/haskell/win32/blob/master/cbits/dumpBMP.c\" rel=\"nofollow noreferrer\">github.com/haskell/win32/blob/master/cbits/dumpBMP.c</a>"}], "owner": {"reputation": 258, "user_id": 2064205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40e5c973f239d062814c831d66e5f79?s=128&d=identicon&r=PG", "display_name": "PleaseTwo", "link": "https://stackoverflow.com/users/2064205/pleasetwo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498477864, "creation_date": 1498477864, "question_id": 44759086, "link": "https://stackoverflow.com/questions/44759086/screen-capture-in-haskell-with-win32-library", "title": "Screen capture in Haskell with Win32 library", "body": "<p>I'm trying to create an app which takes the screenshot of running application.\nI've used code from this answer <a href=\"https://stackoverflow.com/a/11966931/2064205\">https://stackoverflow.com/a/11966931/2064205</a>.\nI have a problem with the createBMPFile function, it saves black images. I've tried to create the similar app in C++, also has the same problem.\nI'm new in Haskell, do not pay attention to the code.</p>\n\n<pre><code>import Graphics.Win32.Window\nimport Graphics.Win32.GDI.Bitmap\nimport Graphics.Win32.GDI.HDC\nimport Graphics.Win32.GDI.Graphics2D\nimport Graphics.Win32.Window.ForegroundWindow\nimport Graphics.Win32.GDI.Types (HWND)\nimport Foreign.Ptr\n\n    getValueFromMaybe :: Maybe HWND -&gt; HWND\n    getValueFromMaybe mx = \n        case mx of\n            Just value -&gt; value\n            Nothing -&gt;  nullPtr\n\n    main = do \n          desktop   &lt;- findWindowByName \"slack\" -- Grab the Hwnd of the window with title \"slack\", GetDC 0, GetDC NULL etc all work too\n          setForegroundWindow . getValueFromMaybe $ desktop\n          desktop   &lt;- findWindowByName \"slack\"\n          hdc       &lt;- getWindowDC desktop -- Get the dc handle of the desktop\n          (x,y,r,b) &lt;- getWindowRect . getValueFromMaybe $ desktop -- Find the size of the desktop so we can know which size the destination bitmap should be\n                                             -- (left, top, right, bottom)\n          newDC     &lt;- createCompatibleDC (Just hdc) -- Create a new DC to hold the copied image. It should be compatible with the source DC\n          let width  = r - x -- Calculate the width\n          let height = b - y -- Calculate the Height\n          newBmp    &lt;- createCompatibleBitmap hdc width height -- Create a new Bitmap which is compatible with the newly created DC\n          selBmp    &lt;- selectBitmap newDC newBmp -- Select the Bitmap into the DC, drawing on the DC now draws on the bitmap as well\n          bitBlt newDC 0 0 width height hdc 0 0 sRCCOPY -- use SRCCOPY to copy the desktop DC into the newDC\n          createBMPFile \"Foo.bmp\" newBmp newDC  -- Write out the new Bitmap file to Foo.bmp\n          putStrLn \"Bitmap image copied\" -- Some debug message\n          deleteBitmap selBmp -- Cleanup the selected bitmap\n          deleteBitmap newBmp -- Cleanup the new bitmap\n          deleteDC newDC      -- Cleanup the DC we created.\n</code></pre>\n"}, {"tags": ["list", "haskell", "matrix", "functional-programming", "submatrix"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498472608, "post_id": 44757419, "comment_id": 76495771, "body": "Does it work correctly? In your example you only obtain <i>full</i> rows and <i>full</i> columns."}, {"owner": {"reputation": 21, "user_id": 6335108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296c18cc373a920819975bcfff1e8e8b?s=128&d=identicon&r=PG&f=1", "display_name": "TomBombadil", "link": "https://stackoverflow.com/users/6335108/tombombadil"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498472795, "post_id": 44757419, "comment_id": 76495877, "body": "I forgot to add that submatrices should start from (1,1) to (x,y), and I added another example."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498472840, "post_id": 44757419, "comment_id": 76495904, "body": "Furthermore with <i>positive</i> submatrices, do you mean all the elements should be positive? Or only the sum itself?"}, {"owner": {"reputation": 21, "user_id": 6335108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296c18cc373a920819975bcfff1e8e8b?s=128&d=identicon&r=PG&f=1", "display_name": "TomBombadil", "link": "https://stackoverflow.com/users/6335108/tombombadil"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498472953, "post_id": 44757419, "comment_id": 76495968, "body": "Yes, I mean all elements, I added it to specification."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 0, "last_activity_date": 1498476354, "last_edit_date": 1498476354, "creation_date": 1498474946, "answer_id": 44758238, "question_id": 44757419, "link": "https://stackoverflow.com/questions/44757419/maximal-positive-submatrices-using-haskell/44758238#44758238", "title": "Maximal positive submatrices using haskell", "body": "<h1>Proposed algorithm</h1>\n\n<p>I think that in order to solve the problem, we first better perform a dimension reduction:</p>\n\n<pre><code>reduce_dim :: (Num a,Ord a) =&gt; [[a]] -&gt; [Int]\nreduce_dim = map (length . takeWhile (&gt;0))  -- O(m*n)\n</code></pre>\n\n<p>Here for every row, we calculate the number of items - starting from the left - that are positive. So for the given matrix:</p>\n\n<pre><code> 1   2   3   4  | 4\n 5   6   7   8  | 4\n 9  10 -11  12  | 2\n13  14  15  16  | 4\n</code></pre>\n\n<p>The second row thus maps to 2, since the third element is -11.</p>\n\n<p>Or for your other matrix:</p>\n\n<pre><code> 1   2   3  -4  | 3\n 5   6   7   8  | 4\n-9  10 -11  12  | 0\n13  14  15  16  | 4\n</code></pre>\n\n<p>Since the first row has a -4 at column 4, and the third one at column 1.</p>\n\n<p>Now we can obtain a <code>scanl1 min</code> over these rows:</p>\n\n<pre><code>Prelude&gt; scanl1 min [4,4,2,4] -- O(m)\n[4,4,2,2]\nPrelude&gt; scanl1 min [3,4,0,4] -- O(m)\n[3,3,0,0]\n</code></pre>\n\n<p>Now each time the number decreases (and at the end), we know we have found a maximal submatrix at the row above. Since that means we now work with a row from where on, the number of columns is less. Once we reach zero, we know that further evaluation has no sense, since we are working with a matrix with 0 columns.</p>\n\n<p>So based on that list, we can simply generate a <strong>list of tuples of the sizes of the maximal submatrices</strong>:</p>\n\n<pre><code>max_sub_dim :: [Int] -&gt; [(Int,Int)]\nmax_sub_dim = msd 1  -- O(m)\n    where msd r []             = []\n          msd r (0:_)          = []\n          msd r [c]            = [(r,c)]\n          msd r (c1:cs@(c2:_)) | c2 &lt; c1 = (r,c1) : msd (r+1) cs\n                               | otherwise = msd (r+1) cs\n</code></pre>\n\n<p>So for your two matrices, we obtain:</p>\n\n<pre><code>*Main&gt; max_sub_dim $ scanl1 min $ reduce_dim [[1,2,3,4],[5,6,7,8],[9,10,-11,12],[13,14,15,16]]\n[(2,4),(4,2)]\n*Main&gt; max_sub_dim $ scanl1 min $ reduce_dim [[1,2,3,-4],[5,6,7,8],[-9,10,-11,12],[13,14,15,16]]\n[(2,3)]\n</code></pre>\n\n<p>Now we only need to obtain these submatrices themselves. We can do this by using <code>take</code> and a <code>map</code> over <code>take</code>:</p>\n\n<pre><code>construct_sub :: [[a]] -&gt; [(Int,Int)] -&gt; [[[a]]]\nconstruct_sub mat = map (\\(r,c) -&gt; take r (map (take c) mat))  -- O(m^2*n)\n</code></pre>\n\n<p>And now we only need to link it all together in a <code>solve</code>:</p>\n\n<pre><code>-- complete program\n\nreduce_dim :: (Num a,Ord a) =&gt; [[a]] -&gt; [Int]\nreduce_dim = map (length . takeWhile (&gt;0))\n\nmax_sub_dim :: [Int] -&gt; [(Int,Int)]\nmax_sub_dim = msd 1\n    where msd r []             = []\n          msd r (0:_)          = []\n          msd r [c]            = [(r,c)]\n          msd r (c1:cs@(c2:_)) | c2 &lt; c1 = (r,c1) : msd (r+1) cs\n                               | otherwise = msd (r+1) cs\n\nconstruct_sub :: [[a]] -&gt; [(Int,Int)] -&gt; [[[a]]]\nconstruct_sub mat = map (\\(r,c) -&gt; take r (map (take c) mat))\n\nsolve :: (Num a,Ord a) =&gt; [[a]] -&gt; [[[a]]]\nsolve mat = construct_sub mat $ max_sub_dim $ scanl1 min $ reduce_dim mat\n</code></pre>\n\n<p>Which then generates:</p>\n\n<pre><code>*Main&gt; solve [[1,2,3,4],[5,6,7,8],[9,10,-11,12],[13,14,15,16]]\n[[[1,2,3,4],[5,6,7,8]],[[1,2],[5,6],[9,10],[13,14]]]\n*Main&gt; solve [[1,2,3,-4],[5,6,7,8],[-9,10,-11,12],[13,14,15,16]]\n[[[1,2,3],[5,6,7]]]\n</code></pre>\n\n<h1>Time complexity</h1>\n\n<p>The algorithm runs in <em>O(m&times;n)</em> with <em>m</em> the number of rows and <em>n</em> the number of columns, to construct the <strong>dimensions</strong> of the matrices. For every defined function, I wrote the time complexity in comment.</p>\n\n<p>It will take <em>O(m<sup>2</sup>&times;n)</em> to <em>construct</em> all submatrices. So the algorithm runs in <em>O(m<sup>2</sup>&times;n)</em>.</p>\n\n<p>We can <em>transpose</em> the approach and run on columns instead of rows. So in case we are working with matrices where the number of rows differs greatly from the number of columns, we can first calculate the minimum, optionally transpose, and thus make <em>m</em> the smallest of the two.</p>\n\n<h1>Point of potential optimization</h1>\n\n<p>we can make the algorithm faster by constructing submatrices while constructing <code>max_sub_dim</code> saving some work.</p>\n"}], "owner": {"reputation": 21, "user_id": 6335108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296c18cc373a920819975bcfff1e8e8b?s=128&d=identicon&r=PG&f=1", "display_name": "TomBombadil", "link": "https://stackoverflow.com/users/6335108/tombombadil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499956183, "creation_date": 1498471990, "last_edit_date": 1499956183, "question_id": 44757419, "link": "https://stackoverflow.com/questions/44757419/maximal-positive-submatrices-using-haskell", "title": "Maximal positive submatrices using haskell", "body": "<p>I have following problem:</p>\n\n<p>You are given matrix m*n and you have to find maximal positive ( all elements of submatrix should be > 0) submatrices from <strong>(1,1) to (x,y)</strong>.</p>\n\n<p>What do I mean by maximal is, when you have following matrix:</p>\n\n<pre><code> [[1,2,3,4],[5,6,7,8],[9,10,-11,12],[13,14,15,16]]\n</code></pre>\n\n<p>then maximal positive submatrices are:</p>\n\n<pre><code>[[[1,2,3,4],[5,6,7,8]],[[1,2],[5,6],[9,10],[13,14]]]\n</code></pre>\n\n<p>i.e. first two rows is one solution and first two columns is second solution.</p>\n\n<p>Another example: matrix is </p>\n\n<pre><code>[[1,2,3,-4],[5,6,7,8],[-9,10,-11,12],[13,14,15,16]]\n</code></pre>\n\n<p>and solution is: </p>\n\n<pre><code>[[[1,2,3],[5,6,7]]]\n</code></pre>\n\n<p>This is my Haskell program which solves it:</p>\n\n<pre><code>import Data.List hiding (insert)\n\nimport qualified Data.Set as Set\n\nunique :: Ord a =&gt; [a] -&gt; [a]\nunique = Set.toList . Set.fromList\n\n\nsubList::[[Int]] -&gt;[[[Int]]]\nsubList matrix = filter (allPositiveMatrix) $  [ (submatrix matrix 1 1 x y) |   x&lt;-[1..width(matrix)], y&lt;-[1..height(matrix)]]\n\n\nmaxWidthMat::[[[Int]]] -&gt; Int\nmaxWidthMat subList =length ((foldl (\\largestPreviousX nextMatrix -&gt; if (length (nextMatrix!!0)) &gt;(length (largestPreviousX !!0)) then nextMatrix  else largestPreviousX ) [[]] subList)!!0)\n\n\nmaxWidthSubmatrices:: [[[Int]]] -&gt; Int -&gt;[[[Int]]]\nmaxWidthSubmatrices subList maxWidth = filter (\\x -&gt; (length $x!!0)==maxWidth) subList\n\nheight matrix = length matrix\n\nwidth matrix = length (matrix!!0)\n\nmaximalPositiveSubmatrices matrix =  maxWidthSubmatrices (subList matrix) (maxWidthMat   (filter (\\x -&gt; (length $x!!0)==( maxWidthMat $ subList matrix )) (subList matrix)))\n\n\nallPositiveList list = foldl (\\x y -&gt; if (y&gt;0)&amp;&amp;(x==True) then True else False) True list\n\nallPositiveMatrix:: [[Int]] -&gt; Bool\nallPositiveMatrix matrix = foldl (\\ x y -&gt; if (allPositiveList y)&amp;&amp;(x==True) then True else False  )  True matrix\n\n\nsubmatrix matrix x1 y1 x2 y2 = slice ( map (\\x -&gt; slice x x1 x2) matrix) y1 y2\n\nslice list x y = drop (x-1)  (take y list)\n\n\n\nmaximalWidthSubmatrix mm =  maximum $ maximalPositiveSubmatrices mm\nmaximalHeigthSubmatrix mm = transpose $ maximum $ maximalPositiveSubmatrices $ transpose mm\n\n-- solution\nsolution matrix =unique $ [maximalWidthSubmatrix matrix]++[maximalHeigthSubmatrix matrix]\n</code></pre>\n\n<p>As you can see it's extremely lengthy and ugly.\nIt problably isn't fastest too.</p>\n\n<p>Could you show me more <strong>elegant</strong>, <strong>faster</strong> and <strong>shorter</strong> solution ( possibly with explantions) ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498471529, "post_id": 44757186, "comment_id": 76495200, "body": "Do you return the result of the function calls?"}, {"owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498471704, "post_id": 44757186, "comment_id": 76495296, "body": "yeah , I will set the function return types accordingly. I am using this code as a part of some function."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1498471805, "post_id": 44757186, "comment_id": 76495349, "body": "<code>if</code> in Haskell can only use the Boolean conditions: <code>if (var1 == 1) then ... else ...</code> or <code>if (var1 == 0) then ... else ...</code>. <code>==</code> is testing the equality and returns a Boolean value, either <code>True</code> or <code>False</code>."}, {"owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "edited": false, "score": 0, "creation_date": 1498471884, "post_id": 44757186, "comment_id": 76495385, "body": "Any alternate to if statement for my case, which may be a better approach  ?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1498532669, "post_id": 44757186, "comment_id": 76523837, "body": "Haskell doesn&#39;t really have function calls"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1498534859, "post_id": 44757186, "comment_id": 76524285, "body": "@immibis, yeah <i>functional</i> languages typically don&#39;t have those  (sarcasm).   Maybe you meant &quot;procedure&quot;?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1498536080, "post_id": 44757186, "comment_id": 76524561, "body": "@luqui In Haskell functions are &quot;applied&quot;. They don&#39;t get called and they don&#39;t return. Calls and returns are kinds of control flow which do not exist in Haskell."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1498649468, "post_id": 44757186, "comment_id": 76582178, "body": "@immibis oh \ud83d\ude44."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1498471792, "post_id": 44757337, "comment_id": 76495342, "body": "or <code>==</code>, which deals with <code>Eq</code> ."}, {"owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "edited": false, "score": 0, "creation_date": 1498471985, "post_id": 44757337, "comment_id": 76495439, "body": "Any alternate to if statement for my case, which may be a better approach ?"}, {"owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "edited": false, "score": 0, "creation_date": 1498472128, "post_id": 44757337, "comment_id": 76495510, "body": "Pattern matching as Daniel Sanchez wrote or writing your own function that wrap around <code>if</code>"}], "tags": [], "owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "is_accepted": false, "score": 1, "last_activity_date": 1498471728, "creation_date": 1498471728, "answer_id": 44757337, "question_id": 44757186, "link": "https://stackoverflow.com/questions/44757186/using-if-else-in-haskell-to-take-decision-based-on-int-value/44757337#44757337", "title": "using if -else in haskell to take decision based on Int value", "body": "<p>The type signature for <code>if</code> is <code>Bool -&gt; a -&gt; a -&gt; a</code>. This means that you must give a boolean as the first argument. In other languages (like C or Python) an <code>if</code> statement tries to convert the argument given to it to a boolean. In Haskell, this fails because of the type system that doesn't let you reference a memory location as some other type.</p>\n\n<p>To do your example you will have to use a (>)/(&lt;) operators which can convert to instances of Ord a to a Bool.</p>\n"}, {"comments": [{"owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "edited": false, "score": 1, "creation_date": 1498691213, "post_id": 44757416, "comment_id": 76608339, "body": "What if I am expecting a string, instead of 0,1 : That is either &quot;&quot; or &quot;Some String&quot; .Will <code>case var of     &quot;&quot;         -&gt; callF     _         -&gt; callOtherF</code> this work ?"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "edited": false, "score": 0, "creation_date": 1498714462, "post_id": 44757416, "comment_id": 76614105, "body": "@crystal it will, just change the type signature"}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": true, "score": 5, "last_activity_date": 1498472786, "last_edit_date": 1498472786, "creation_date": 1498471981, "answer_id": 44757416, "question_id": 44757186, "link": "https://stackoverflow.com/questions/44757186/using-if-else-in-haskell-to-take-decision-based-on-int-value/44757416#44757416", "title": "using if -else in haskell to take decision based on Int value", "body": "<p>I would use pattern matching:</p>\n\n<pre><code>case var of\n    0         -&gt; callF\n    1         -&gt; callOtherF\n    otherwise -&gt; handleNot0or1\n</code></pre>\n\n<p>You can even create your own checker:</p>\n\n<pre><code>validate :: Int -&gt; Bool\nvalidate 0  = False\nvalidate 1  = True\nvalidate _  = whatever_you_decide\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": false, "score": 0, "last_activity_date": 1498479566, "last_edit_date": 1498479566, "creation_date": 1498473037, "answer_id": 44757726, "question_id": 44757186, "link": "https://stackoverflow.com/questions/44757186/using-if-else-in-haskell-to-take-decision-based-on-int-value/44757726#44757726", "title": "using if -else in haskell to take decision based on Int value", "body": "<p>Since pattern matching has already been mentioned, I would like to mention guards:</p>\n\n<pre><code>myFunc a | (a == 0)  = fooCall\n         | (a == 1)  = barCall\n         | otherwise = etcCall\n</code></pre>\n\n<p>Of course there is always the simple if-then-else:</p>\n\n<pre><code>myFunc a = if (a == 0)\n               then fooCall\n               else if (a == 1)\n                   then barCall\n                   else etcCall\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "is_accepted": false, "score": 1, "last_activity_date": 1498473059, "creation_date": 1498473059, "answer_id": 44757729, "question_id": 44757186, "link": "https://stackoverflow.com/questions/44757186/using-if-else-in-haskell-to-take-decision-based-on-int-value/44757729#44757729", "title": "using if -else in haskell to take decision based on Int value", "body": "<p>Depending on the return value, should suffice with pattern matching like this</p>\n\n<pre><code>boolSwitch 1 = 3+3\nboolSwitch 0 = 3.0*2.5\nboolSwitch _ = undefined\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 4325709, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004846143898/picture?type=large", "display_name": "Severi J&#228;&#228;skel&#228;inen", "link": "https://stackoverflow.com/users/4325709/severi-j%c3%a4%c3%a4skel%c3%a4inen"}, "is_accepted": false, "score": 1, "last_activity_date": 1498495553, "creation_date": 1498495553, "answer_id": 44764586, "question_id": 44757186, "link": "https://stackoverflow.com/questions/44757186/using-if-else-in-haskell-to-take-decision-based-on-int-value/44764586#44764586", "title": "using if -else in haskell to take decision based on Int value", "body": "<p>If you want to use the if-else structure, you have to put it as a part of function definition, like so</p>\n\n<pre><code>function :: Int -&gt; ...\nfunction i =\n    if i == 1\n        then ...\n        else ...\n</code></pre>\n\n<p>However, I don't see why you want to use <code>Int</code> instead of <code>Bool</code>. If <code>0</code> and <code>1</code> are the only integers you want to use, more 'haskellish' way of doing the thing you probably want to do is making a function with return type of <code>Maybe a</code>, in case of something else than <code>0</code> or <code>1</code> is given as an input, and using pattern matching:</p>\n\n<pre><code>function :: Int -&gt; Maybe ...\nfunction 0 = ... -- Has to return either 'Just ...' or 'Nothing'\nfunction 1 = ... -- Same as above\nfunction _ = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 0, "accepted_answer_id": 44757416, "answer_count": 5, "score": -2, "last_activity_date": 1498495553, "creation_date": 1498471191, "last_edit_date": 1498490973, "question_id": 44757186, "link": "https://stackoverflow.com/questions/44757186/using-if-else-in-haskell-to-take-decision-based-on-int-value", "title": "using if -else in haskell to take decision based on Int value", "body": "<p>I am new to Haskell. I have something like this</p>\n\n<pre><code>var1::Int\nvar1 = 1;\nif var1\n    then // call some fumction\n    else // call some other function\n</code></pre>\n\n<p>What is the way to do this in Haskell? What I am doing is calling different functions depending on the value of variable <code>var</code> (note that it is an <code>Int</code>). <code>var1</code> can only take <code>1</code> or <code>0</code> as values. Note that I cannot use bool for my conditions.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": true, "score": 5, "last_activity_date": 1498468881, "creation_date": 1498468881, "answer_id": 44756516, "question_id": 44756204, "link": "https://stackoverflow.com/questions/44756204/monoid-how-to-use-mempty/44756516#44756516", "title": "Monoid how to use mempty", "body": "<p>The <code>mempty</code> in a <code>Monoid</code> defines the \"unit\" element. One particular scenario in which it might be used is if we had a function that aggregates over a list of <code>Monoid</code>s:</p>\n\n<pre><code>aggregate :: (Monoid a) =&gt; [a] -&gt; a\naggregate [] = mempty\naggregate (x:xs) = x `mappend` aggregate xs\n</code></pre>\n\n<p>Remember that <code>Monoid</code>s are an abstraction over common forms of computation. When you write general functions for <code>Monoid</code>s, that's where <code>mempty</code> may show up.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 44756516, "answer_count": 1, "score": 2, "last_activity_date": 1498468881, "creation_date": 1498467766, "question_id": 44756204, "link": "https://stackoverflow.com/questions/44756204/monoid-how-to-use-mempty", "title": "Monoid how to use mempty", "body": "<p>I have following datatype, that is implemented in <code>Monoid</code> typeclass:</p>\n\n<pre><code>data Optinal a = \n    Nada\n  | Only a\n  deriving (Eq, Show)\n\ninstance Monoid a =&gt; Monoid (Optinal a) where\n  mempty = Nada\n  mappend Nada (Only a) = Only a\n  mappend (Only a) Nada = Only a\n  mappend Nada Nada = Nada\n  mappend (Only a) (Only b) = Only (mappend a b)  \n</code></pre>\n\n<p>My question is, how to use <code>mempty</code> function?</p>\n"}, {"tags": ["haskell", "generics", "typeclass"], "comments": [{"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 3, "creation_date": 1498464132, "post_id": 44754977, "comment_id": 76491285, "body": "See <a href=\"https://stackoverflow.com/questions/7438600/datatypecontexts-deprecated-in-latest-ghc-why\" title=\"datatypecontexts deprecated in latest ghc why\">stackoverflow.com/questions/7438600/&hellip;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 4, "last_activity_date": 1498499451, "last_edit_date": 1498499451, "creation_date": 1498464935, "answer_id": 44755490, "question_id": 44754977, "link": "https://stackoverflow.com/questions/44754977/haskell-how-to-use-type-class-with-generic-datatype/44755490#44755490", "title": "Haskell: How to use type class with generic datatype?", "body": "<p>A GADT can capture a dictionary for a constraint in a constructor.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata Sortable a where\n    Sortable :: Ord a =&gt; [a] -&gt; Sortable a\n--     ^          ^\n--  constructor   |\n--                |\n--  captures an Ord dictionary\n</code></pre>\n\n<p>The dictionary is reintroduced when you pattern match on the constructor</p>\n\n<pre><code>sortSortable :: Sortable a -&gt; Sortable a\nsortSortable (Sortable xs) = Sortable (sort xs)\n--               ^                     ^\n-- match constructor                   |\n--                                     |\n-- reintroduces `Ord a` dictionary so it can be used in sort\n</code></pre>\n\n<p><code>Sortable a</code> can be constructed when <code>a</code> has an <code>Ord a</code> instance</p>\n\n<pre><code>{-# LANGUAGE StandaloneDeriving #-}\n\nderiving instance Show a =&gt; Show (Sortable a)\n\nmain = print . sortSortable $ Sortable \"Hello, world!\"\n</code></pre>\n\n<p>But not when it doesn't</p>\n\n<pre><code>data Z = Z\n  deriving (Show)\n\nmain = print . sortSortable $ Sortable [Z]\n</code></pre>\n\n<p>This results in an error because <code>Sortable</code> can't capture an <code>Ord Z</code> dictionary, because one doesn't exist.</p>\n\n<pre><code>No instance for (Ord Z) arising from a use of \u2018Sortable\u2019\nIn the second argument of \u2018($)\u2019, namely \u2018Sortable [Z]\u2019\nIn the expression: print . sortSortable $ Sortable [Z]\nIn an equation for \u2018main\u2019:\n    main = print . sortSortable $ Sortable [Z]\n</code></pre>\n"}], "owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 44755490, "answer_count": 1, "score": 0, "last_activity_date": 1498499451, "creation_date": 1498462750, "question_id": 44754977, "link": "https://stackoverflow.com/questions/44754977/haskell-how-to-use-type-class-with-generic-datatype", "title": "Haskell: How to use type class with generic datatype?", "body": "<p>Suppose that I have defined a list like this:</p>\n\n<pre><code>data List a = Nil | Cons a (List a)\n</code></pre>\n\n<p>Now I want to make sure a <code>List</code> is only instantiated with a generic type which conforms to a specific type class (e.g. <code>Ord</code>). How can I do this?</p>\n\n<p>I know it is possible to define type class constraint on a generic function which is going to work with <code>List</code> instances but is there a way to define such a constraint on the data type itself?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498501569, "post_id": 44755025, "comment_id": 76513496, "body": "It may also help to consider <code>a -&gt; b</code> to be an <code>a</code>-ary product of <code>b</code>s. For instance, <code>Bool -&gt; b</code> is isomorphic to <code>(b, b)</code>."}], "tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": true, "score": 5, "last_activity_date": 1498463452, "last_edit_date": 1498463452, "creation_date": 1498462936, "answer_id": 44755025, "question_id": 44754715, "link": "https://stackoverflow.com/questions/44754715/monoid-of-larger-type/44755025#44755025", "title": "Monoid of larger type", "body": "<p>I think the author means this: a tuple may contain some <code>Monoid</code> instance <code>a</code>, <code>b</code>, and <code>c</code>. However, we can view the <code>Monoid</code> instances in those tuples collectively, and thus define a new <code>Monoid</code> of type <code>(a, b, c)</code>. Thus, from 3 smaller <code>Monoid</code> instances grouped together in a tuple give rise to a \"larger\" <code>Monoid</code> instance over <code>(a, b, c)</code>.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 44755025, "answer_count": 1, "score": 1, "last_activity_date": 1498463452, "creation_date": 1498461543, "question_id": 44754715, "link": "https://stackoverflow.com/questions/44754715/monoid-of-larger-type", "title": "Monoid of larger type", "body": "<p>I am trying to learn haskell and reading the haskellbook.  </p>\n\n<p>In the book, the author mentioned larger type as follow:  </p>\n\n<pre><code>instance Monoid b =&gt; Monoid (a -&gt; b)\ninstance (Monoid a, Monoid b) =&gt; Monoid (a, b)\ninstance (Monoid a, Monoid b, Monoid c) =&gt; Monoid (a, b, c)\n</code></pre>\n\n<blockquote>\n  <p>What these Monoids have in common is that they are giving you a new\n  Monoid for a larger type by reusing the Monoid instances of types that\n  represent components of the larger type.</p>\n</blockquote>\n\n<p>What does he mean with larger datatype? </p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1498423129, "post_id": 44750323, "comment_id": 76481749, "body": "Have you tried writing <code>madd</code> in terms of <code>&gt;&gt;=</code>, desugaring the <code>do</code>? You should see that the function passed to <code>&gt;&gt;=</code> is more complex than <code>+</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 4, "creation_date": 1498425719, "post_id": 44750323, "comment_id": 76482348, "body": "I&#39;m not sure I&#39;d recommend studying this Monad example, since it breaks the law that <code>(x &gt;&gt;= return) == x</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1498430882, "post_id": 44750323, "comment_id": 76483538, "body": "@amalloy I agree. It seems easy to fix, though: just drop the <code>+1</code> in the definition of <code>(&gt;&gt;=)</code>. Seems the interesting content of the question would be basically unchanged from this fix, too."}], "answers": [{"tags": [], "owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "is_accepted": false, "score": 0, "last_activity_date": 1498423642, "creation_date": 1498423642, "answer_id": 44750461, "question_id": 44750323, "link": "https://stackoverflow.com/questions/44750323/the-haskell-monad-example-explanation-of-how-it-works/44750461#44750461", "title": "The Haskell monad example: explanation of how it works", "body": "<p>When desugared your <code>do</code> expression in <code>madd</code> becomes</p>\n\n<pre><code>a &gt;&gt;= \\aa -&gt; b &gt;&gt;= \\bb -&gt; return (a + b)\n</code></pre>\n\n<p>So you get 43 plus 1 from first and second counter plus two, each for each bind in madd</p>\n\n<p>When learning monads it is good idea to avoid do notation and always remember specific definitions of bind (>>=) for monad we are analyzing</p>\n"}, {"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498474020, "post_id": 44751518, "comment_id": 76496523, "body": "I downvoted this answer because of the &quot;tl;dr&quot; part. <code>&gt;&gt;=</code> is not an implementation detail! It(&#39;s signature) is the essential abstraction for the notion of sequencing effectful computations; if you sit down and think hard enough about what sequencing means you&#39;ll eventually come up with <code>&gt;&gt;=</code>. While one can be somewhat productive using <code>do</code> without thought to what it means, sooner or later you do have to learn about <code>&gt;&gt;=</code>. This question and your answer are evidence of that!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498495250, "post_id": 44751518, "comment_id": 76510081, "body": "@BenjaminHodgson thanks for dropping the note. I realized that it&#39;ll  be a highly controversial remark. :) I&#39;m just in search of something to make it more accessible and less intimidating for the newbies. It is after all true that <code>do { v &lt;- m ; f v }  ===  join $ do { v &lt;- m ; return (f v) }  ===  f =&lt;&lt; m</code> (and <code>do { v &lt;- m ; return (f v) }  ===  f &lt;$&gt; m</code>), so one can pick a notation that&#39;s more to their liking; the types of course stay the same."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498496900, "post_id": 44751518, "comment_id": 76510955, "body": "@BenjaminHodgson so, some like it <i>bind</i>, some like <i>programmable semicolon</i> better; and some even prefer <i>MonadComprehensions</i>! Any one of the three could be the starting point..."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498502752, "post_id": 44751518, "comment_id": 76514138, "body": "You have to start somewhere, of course. I was just put off by the implication that one shouldn&#39;t think about bind at all."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 1, "last_activity_date": 1498496571, "last_edit_date": 1498496571, "creation_date": 1498433487, "answer_id": 44751518, "question_id": 44750323, "link": "https://stackoverflow.com/questions/44750323/the-haskell-monad-example-explanation-of-how-it-works/44751518#44751518", "title": "The Haskell monad example: explanation of how it works", "body": "<p><em>tl;dr</em>&#8202;: Embrace the <code>do</code>, eschew the <em>bind</em>&#8202;! It's an implementational detail anyway. <code>do</code> could really be treated as an axiomatic, primary notation, being as <em>\"monads\"</em> are a fancy way to say <a href=\"https://stackoverflow.com/questions/44117197/why-does-haskells-bind-function-take-a-function-from-non-monadic-to-monadic/44118041#44118041\"><em>\"programs\"</em></a> in the first place (<em>insert a hedging qualifier here</em>).</p>\n\n<hr>\n\n<p>The <code>do</code> notation is desugared into the <em>bind</em>&#8202;-based code,</p>\n\n<pre><code>do { v &lt;- m ; f v }  ===  m &gt;&gt;= f\n</code></pre>\n\n<p>Conversely, going in the reverse direction, </p>\n\n<pre><code>Counter a i &gt;&gt;= f  ===  do { v &lt;- Counter a i ; f v }\n</code></pre>\n\n<p>Thus your Monad instance's <em>bind</em> definition,</p>\n\n<pre><code>Counter a i &gt;&gt;= f  =  Counter b (i + j + 1)  where\n                      Counter b j = f a\n</code></pre>\n\n<p>can be informally re-written as</p>\n\n<p><pre><code>instance Monad Counter where\n  return <b>x</b>      =  Counter <b>x</b> 0\n  do { v &lt;- Counter <b>x</b> <i>i</i>\n     ; f v }    =  Counter y (<i>i</i> + j + 1)  where        -- the <em>bind</em> transformation\n                   Counter y j = f v\n                   v           = <strong>x</strong></pre></code></p>\n\n<p>Now we can manipulate your <code>do</code> code directly, to see what's going on:</p>\n\n<p><pre><code>madd (Counter <b>10</b> <em>43</em>) (Counter <b>32</b> <em>1</em>)\n= do { aa &lt;- Counter <b>10</b> <em>43</em>\n     ; bb &lt;- Counter <b>32</b> <em>1</em>\n     ; return (aa + bb)\n     }\n= do { aa &lt;- Counter <b>10</b> <em>43</em>\n     ; do { bb &lt;- Counter <b>32</b> <em>1</em>                         -- by Monad Laws\n          ; return (aa + bb)\n          }}\n= do { aa &lt;- Counter <b>10</b> <em>43</em>\n     ; f aa } where f aa = do { bb &lt;- Counter <b>32</b> <em>1</em>     -- abstraction\n                              ; return (aa + bb)\n                              }\n= Counter y (<em>43</em> + j + 1)                               -- the <em>bind</em> transformation\n  where Counter y j = f <b>10</b>\n                    = do { bb &lt;- Counter <b>32</b> <em>1</em>\n                         ; return (<b>10</b> + bb)\n                         }\n                    = do { bb &lt;- Counter <b>32</b> <em>1</em>\n                         ; (return . (<b>10</b> +)) bb\n                         }\n                    = Counter y (<em>1</em> + j + 1)            -- the <em>bind</em> transformation\n                      where Counter y j = (return . (<b>10</b> +)) <b>32</b>\n                                        =  return 42\n                                        = Counter 42 0\n                    = Counter 42 (<em>1</em> + 0 + 1)\n                    = Counter 42 2\n= Counter 42 (<em>43</em> + 2 + 1)\n= Counter 42 46 </pre></code></p>\n\n<p>that is, <code>madd (Counter a i) (Counter b j)</code> produces <code>Counter (a+b) (i+j+2)</code>,  <em>2</em> being the number of <em>bind</em> transformation applications.</p>\n"}], "owner": {"reputation": 29, "user_id": 8213038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db9a6b558d601b533dd3fe84e76fa3fc?s=128&d=identicon&r=PG&f=1", "display_name": "NCL", "link": "https://stackoverflow.com/users/8213038/ncl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 44751518, "answer_count": 2, "score": 2, "last_activity_date": 1498496571, "creation_date": 1498422596, "last_edit_date": 1498434968, "question_id": 44750323, "link": "https://stackoverflow.com/questions/44750323/the-haskell-monad-example-explanation-of-how-it-works", "title": "The Haskell monad example: explanation of how it works", "body": "<pre><code>madd a b = do aa &lt;- a\n              bb &lt;- b\n              return (aa + bb)\n\ndata Counter a = Counter a Int\n    deriving (Show,Eq)\n\ninstance Functor Counter where\n  fmap f (Counter a i) = Counter (f a) i\n\ninstance Applicative Counter where\n  pure x = Counter x 0\n  Counter f i &lt;*&gt; Counter x j = Counter (f x) (i + j)\n\ninstance Monad Counter where\n  return x = Counter x 0\n  Counter a i &gt;&gt;= f = \n    let Counter b j = f a\n     in Counter b (i + j + 1)\n</code></pre>\n\n<p>So suppose for this code one runs:</p>\n\n<pre><code> madd (Counter 10 43) (Counter 32 1)\n</code></pre>\n\n<p>and one gets <code>Counter 42 46</code>.</p>\n\n<p>I do not get how this produces this result. So <code>madd</code> \"calls\" monad <code>Counter</code>, then passes <code>+</code> function to <code>&gt;&gt;=</code> part of the monad instance. But then I find how the monad instance calls/passes functions/results very puzzling.</p>\n\n<p>Can anyone explain in detail how intermediate calculations work?</p>\n"}, {"tags": ["c++", "haskell", "boost", "ffi"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498403765, "post_id": 44747472, "comment_id": 76476291, "body": "Boost is a collection of libraries. It is normally split between several dozens library files. It is unlikely that your system has a single library named boost. Telling which functions you want to call could help."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498404002, "post_id": 44747472, "comment_id": 76476354, "body": "@n.m. Ok, thank you. I want to call <code>owens_t</code> in <code>boost&#47;math&#47;special_functions</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498405106, "post_id": 44747472, "comment_id": 76476667, "body": "owens_t is a template-only function and is not in any linkable library."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498405326, "post_id": 44747472, "comment_id": 76476728, "body": "That means it&#39;s not possible ? Sad, I can call it from <code>R</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498405385, "post_id": 44747472, "comment_id": 76476742, "body": "No, this means you don&#39;t have any library to link against. You only need to specify <code>extra-include-dirs</code>."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498405659, "post_id": 44747472, "comment_id": 76476815, "body": "Ok thanks, I&#39;m going to try."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1498427238, "post_id": 44747472, "comment_id": 76482713, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/147574/discussion-between-n-m-and-stephane-laurent\">continue this discussion in chat</a>."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504285728, "post_id": 44747472, "comment_id": 78971026, "body": "@n.m. This works with ghc 8.2.1 !! :-)"}], "answers": [{"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": false, "score": 0, "last_activity_date": 1504286048, "creation_date": 1504286048, "answer_id": 46005108, "question_id": 44747472, "link": "https://stackoverflow.com/questions/44747472/using-a-c-library-boost-with-inline-c-cpp/46005108#46005108", "title": "Using a C++ library (boost) with inline-c-cpp", "body": "<p>The code posted in the <strong>Edit</strong> works in GHCi with <code>ghc 8.2.1</code>.</p>\n\n<pre><code>Prelude Main&gt; main 0.5 0.5\nHello, Owen! 0.0644886\n</code></pre>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1504286048, "creation_date": 1498401984, "last_edit_date": 1498427133, "question_id": 44747472, "link": "https://stackoverflow.com/questions/44747472/using-a-c-library-boost-with-inline-c-cpp", "title": "Using a C++ library (boost) with inline-c-cpp", "body": "<p>In Haskell, I would like to call a function from the <a href=\"http://www.boost.org/\" rel=\"nofollow noreferrer\">boost C++ library</a> with the help of <a href=\"https://hackage.haskell.org/package/inline-c-cpp\" rel=\"nofollow noreferrer\">inline-c-cpp</a>.</p>\n\n<p>After downloading the <code>boost</code> library, how should I configure the <code>cabal</code> file and the fields <code>extra-lib-dirs</code> and <code>extra-include-dirs</code> in <code>stack.yaml</code> ?</p>\n\n<p>In the <code>cabal</code> file, I write: <code>extra-libraries: boost</code>, and I have tried several folders in <code>extra-lib-dirs</code> and <code>extra-include-dirs</code>, but I always get <code>Missing C library: boost</code>.</p>\n\n<h2>Edit</h2>\n\n<p>This is my attempt after @n.m.'s comments. In <code>stack.yaml</code>:</p>\n\n<pre><code>extra-include-dirs:\n- U:\\Data\\C\\boost_1_64_0\n</code></pre>\n\n<p>In the cabal file:</p>\n\n<pre><code>  extra-libraries:     stdc++\n  c-sources:           src/Main.cpp\n</code></pre>\n\n<p>My module:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE QuasiQuotes #-}\n{-# LANGUAGE ForeignFunctionInterface #-}\n\nmodule Main\n  where\nimport qualified Language.C.Inline.Cpp as C\n\nC.context C.cppCtx\n\nC.include \"&lt;iostream&gt;\"\nC.include \"&lt;boost/math/special_functions/owens_t.hpp&gt;\"\n\nmain :: C.CDouble -&gt; C.CDouble -&gt; IO ()\nmain h a = do\n  [C.block| void {\n      std::cout &lt;&lt; \"Hello, Owen! \" &lt;&lt; boost::math::owens_t($(double h), $(double a)) &lt;&lt; std::endl;\n    } |]\n</code></pre>\n\n<p>The code compiles without issue. However, when I run <code>main 1 1</code> in <code>GHCi</code>, I get the error </p>\n\n<pre><code>ghc.exe: C:\\HaskellProjects\\inlinecpp\\.stack-work\\install\\e77882c1\\lib\\x86_64-windows-ghc-8.0.2\\inlinecpp-0.1.0.0-IWaed3tDnUhE52nToDO1Sq\\HSinlinecpp-0.1.0.0-IWaed3tDnUhE52nToDO1Sq.o: unknown symbol `_Unwind_Resume'\n</code></pre>\n\n<h2>Edit</h2>\n\n<p>This works if I do and run an executable file. But I'd like to use it in GHCi.</p>\n"}, {"tags": ["haskell", "transliteration"], "answers": [{"comments": [{"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 1, "creation_date": 1498393609, "post_id": 44746332, "comment_id": 76473523, "body": "Great. I tried along with your edit and now it works :)"}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1498394972, "post_id": 44746332, "comment_id": 76473868, "body": "I was aware that <code>String</code> is <code>[Char]</code> and was actually expecting a function of the type <code>:: (a -&gt; [a]) -&gt; [a] -&gt; [a]</code> maybe I should edit the question"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1498394566, "last_edit_date": 1498394566, "creation_date": 1498393296, "answer_id": 44746332, "question_id": 44746296, "link": "https://stackoverflow.com/questions/44746296/map-from-char-to-string-in-haskell/44746332#44746332", "title": "map from Char to String in Haskell", "body": "<p>Yes, what you are looking for is <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:concatMap\" rel=\"noreferrer\"><strong><code>concatMap :: Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]</code></strong></a>, that concatenates the output after mapping. Since <code>[]</code> is a <code>Foldable</code>, it thus can <em>specialize</em> in <code>concatMap :: (a -&gt; [b]) -&gt; [a] -&gt; [b]</code>, and further (with <code>a ~ Char</code> and <code>b ~ Char</code>) into <code>concatMap :: (Char -&gt; [Char]) -&gt; [Char] -&gt; [Char]</code>. Note that <code>String</code> is an alias for <code>type String = [Char]</code> so, a <code>String</code> is nothing more that a list of <code>Char</code>acters.</p>\n\n<p>You can thus use:</p>\n\n<pre><code>myTranslit :: String -&gt; String\nmyTranslit = <b>concatMap</b> toAsciiStr</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1498459775, "post_id": 44751327, "comment_id": 76489442, "body": "...interesting option especially in my case, the integration into Pandoc has to be changed anyway."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1498431372, "creation_date": 1498431372, "answer_id": 44751327, "question_id": 44746296, "link": "https://stackoverflow.com/questions/44746296/map-from-char-to-string-in-haskell/44751327#44751327", "title": "map from Char to String in Haskell", "body": "<p>You can make the entire thing as concise as</p>\n\n<pre><code>myTranslit :: String -&gt; String\nmyTranslit = concatMap $ \\c -&gt; case c of\n  '\u00c4' -&gt; \"Ae\"\n  '\u00d6' -&gt; \"Oe\"\n  '\u00dc' -&gt; \"Ue\"\n  '\u00e4' -&gt; \"ae\"\n  '\u00f6' -&gt; \"oe\"\n  '\u00fc' -&gt; \"ue\"\n  '\u00df' -&gt; \"ss\"\n  _ | isAscii c  = [c]\n    | otherwise  = \"\"\n</code></pre>\n"}], "owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 44746332, "answer_count": 2, "score": 3, "last_activity_date": 1498431372, "creation_date": 1498393104, "last_edit_date": 1498424118, "question_id": 44746296, "link": "https://stackoverflow.com/questions/44746296/map-from-char-to-string-in-haskell", "title": "map from Char to String in Haskell", "body": "<p>I'm trying to figure out how to <a href=\"https://github.com/jgm/pandoc/issues/3757\" rel=\"nofollow noreferrer\">improve the transliteration</a> from German umlauts to ASCII for <code>id</code> identifiers in Pandoc. Currently there is only a mapping <code>Char -&gt; Maybe Char</code>, that converts <code>\u00e4</code> into <code>a</code> and <code>\u00df</code> into <code>Nothing</code> etc., but the most common convention maps <code>\u00e4</code> into <code>ae</code> and <code>\u00df</code> into <code>ss</code> and so on. Here is what I have so far:</p>\n\n<pre><code>import Data.Char (isAscii)\nimport qualified Data.Map as M\n\nasciiMap' :: M.Map Char String\nasciiMap' = M.fromList\n  [('\\196',\"Ae\")\n  ,('\\214',\"Oe\")\n  ,('\\220',\"Ue\")\n  ,('\\223',\"ss\")\n  ,('\\228',\"ae\")\n  ,('\\246',\"oe\")\n  ,('\\252',\"ue\")\n  ]\n\ntoAsciiStr :: Char -&gt; String\ntoAsciiStr c | isAscii c = [c]\n             | otherwise = M.findWithDefault \"\" c asciiMap'\n\nmyTranslit :: String -&gt; String\nmyTranslit [] = []\nmyTranslit (x:xs) = toAsciiStr x ++ myTranslit xs\n</code></pre>\n\n<p>My question is about <code>myTranslit</code>.</p>\n\n<p>Is there maybe already a built-in <em>map</em>-like function <code>someMap :: (a -&gt; [a]) -&gt; [a] -&gt; [a]</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1498394044, "post_id": 44746253, "comment_id": 76473619, "body": "<code>Heap e t</code> does not look as a type to represent a heap, but to represent a heap implementation. That is, it is a bunch of functions to operate on heaps, or rather, on some generic container."}, {"owner": {"reputation": 55, "user_id": 8046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c67d44ba4bb1ea25f7a7707f31e3dec?s=128&d=identicon&r=PG&f=1", "display_name": "itonva", "link": "https://stackoverflow.com/users/8046509/itonva"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1498401901, "post_id": 44746253, "comment_id": 76475732, "body": "@chi oh well ok I got it now. That wasn&#39;t that hard :D"}], "answers": [{"comments": [{"owner": {"reputation": 9946, "user_id": 467754, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3rEtR.png?s=128&g=1", "display_name": "Nikos Baxevanis", "link": "https://stackoverflow.com/users/467754/nikos-baxevanis"}, "edited": false, "score": 0, "creation_date": 1498468310, "post_id": 44746365, "comment_id": 76493407, "body": "True. +1. That&#39;s how most (well-written) Haskell libraries look like; (e.g. QuickCheck, Hedgehog, and others) Just types and functions working on these types, bundled together in modules, if possible without using type classes (one reason for this is because of the <a href=\"https://wiki.haskell.org/Orphan_instance\" rel=\"nofollow noreferrer\">orphan instances</a>)."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 1, "last_activity_date": 1498393611, "creation_date": 1498393611, "answer_id": 44746365, "question_id": 44746253, "link": "https://stackoverflow.com/questions/44746253/understanding-data-structure-in-haskell/44746365#44746365", "title": "understanding data structure in Haskell", "body": "<p><code>Heap</code> is a record with six elements. In order to create a value of that type, you must supply all six elements. Assuming that you have appropriate values and functions, you can create a value like this:</p>\n\n<pre><code>myHeap = Heap myEmpty myInsert myFindMin myDeleteMin myMerge myContains\n</code></pre>\n\n<p>The doesn't seem like idiomatic Haskell design, however. Why not define generic functions independent of the data, or, if they must be bundled together, a typeclass?</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 8046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c67d44ba4bb1ea25f7a7707f31e3dec?s=128&d=identicon&r=PG&f=1", "display_name": "itonva", "link": "https://stackoverflow.com/users/8046509/itonva"}, "edited": false, "score": 0, "creation_date": 1498404208, "post_id": 44747198, "comment_id": 76476414, "body": "Wow that answer is great ! Thank you for taking time for that :) It helps a lot"}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 55, "user_id": 8046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c67d44ba4bb1ea25f7a7707f31e3dec?s=128&d=identicon&r=PG&f=1", "display_name": "itonva", "link": "https://stackoverflow.com/users/8046509/itonva"}, "edited": false, "score": 1, "creation_date": 1498430126, "post_id": 44747198, "comment_id": 76483378, "body": "I&#39;m really glad. It&#39;s the kind of answer <i>I</i> wish <i>I</i> had when I was beginning. People who help often skip things and miss stuff out, or do handy-wavey explanations. This is understandable, but it doesn&#39;t help much. Each of the four topics I outlined above are whole topics on their own that deserve being learnt thoroughly, but a beginner has no way of knowing what they&#39;re missing unless someone tells them. I firmy believe beginners need to <b>read</b> more than most resources allow. Having said that, there are some great books around nowdays."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 1, "creation_date": 1498460014, "post_id": 44747198, "comment_id": 76489534, "body": "&quot;This is a pretty amazingly cool feature of Haskell and some other pure functional languages like Elm, Idris and others.&quot; Minor note, but this isn&#39;t at all limited to pure functional languages, and given Rust I&#39;d say it isn&#39;t just functional languages at all."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1498530351, "post_id": 44747198, "comment_id": 76523385, "body": "@AlexeyRomanov Sure thing. I wasn&#39;t saying which languages <i>didn&#39;t</i> have the feature, I was saying some of the languages that <i>did</i> have the feature. I wasn&#39;t implying the feature doesn&#39;t exist elsewhere. Perhaps I&#39;ll adjust it so that&#39;s clearer."}], "tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": true, "score": 4, "last_activity_date": 1498530496, "last_edit_date": 1592644375, "creation_date": 1498399851, "answer_id": 44747198, "question_id": 44746253, "link": "https://stackoverflow.com/questions/44746253/understanding-data-structure-in-haskell/44747198#44747198", "title": "understanding data structure in Haskell", "body": "<p>If you truly wish to understand that type, you need to understand a few requisites first.</p>\n<h2>types and values (and functions)</h2>\n<p>Firstly, you need to understand what types and values are. I'm going to assume you understand this. You understand, for example, the separation between <code>&quot;hello&quot;</code> as a value and its type, <code>String</code> and you understand clearly what it means when I say <code>a = &quot;hello&quot; :: String</code> and:</p>\n<pre><code>a :: String\na = &quot;hello&quot;\n</code></pre>\n<p>If you don't understand that, then you need to research values and types in Haskell. There are a myriad of books that can help here, such as this one, which I helped to author: <a href=\"http://happylearnhaskelltutorial.com\" rel=\"nofollow noreferrer\">http://happylearnhaskelltutorial.com</a></p>\n<p>I'm also going to assume you understand what <em>functions</em> and <em>currying</em> are, and how to use both of them.</p>\n<h2>polymorphic types</h2>\n<p>Secondly, as your example contains type variables, you'll need to understand what they are. That is, you need to understand what <em>polymoprhic types</em> are. So, for example, <code>Maybe a</code>, or <code>Either a b</code>, and you'll need to understand how <code>Maybe String</code> is different to <code>Maybe Int</code> and what <code>Num a =&gt; [a]</code> and even things like what <code>Num a =&gt; [Maybe a]</code> is.</p>\n<p>Again, there are many free or paid books that can help, the example above covers this, too.</p>\n<h2>algebraic data types</h2>\n<p>Next up is algebraic data types. This is a pretty amazingly cool feature that Haskell has. Haskell-like languages such as Elm and Idris have it as well as others like Rust, too. It lets you define your <strong>own</strong> data types.  These aren't just things like Structs in other languages, and yeah, they can even contain functions.</p>\n<p><code>Maybe</code> is actually an example of an algebraic data types. If you understand these, you'll know that:</p>\n<pre><code>data Direction = North | South | East | West\n</code></pre>\n<p>defines a data type called <code>Direction</code> whose values can only be one of <code>North</code>, <code>South</code>, <code>East</code> or <code>West</code>, and you'll know that you can also use the polymorhpic type variables above to parameterise your types like so:</p>\n<pre><code>data Tree a = EmptyNode | Node (Tree a) (Tree a)\n</code></pre>\n<p>which uses both optionality (as in the <em>sum type</em> of <code>Direction</code> above) as well as parameterization.</p>\n<p>In addition to this, you can also have <em>multiple types</em> in each value. These are called <em>product types</em>, and Haskell's algebraic datatypes can be expressed as a combination of Sum types that can contain Product types. For example:</p>\n<pre><code>type Location = (Float, Float)\ndata ShapeNode = StringNode Location String | CircleNode Location Float | SquareNode Location Float Float\n</code></pre>\n<p>That is, each value can be one of <code>StringNode</code>, <code>CircleNode</code> or <code>SquareNode</code>, and in each case there are a different set of fields given to each value. To create a <code>StringNode</code>, for example, you'd need to pass the values of it constructor like this: <code>StringNode (10.0, 5.3) &quot;A String&quot;</code>.</p>\n<p>Again, the freely available books will go into much more detail about these things, but we're moving in the direction of getting more than a basic understanding of Haskell now.</p>\n<p>Finally, in order to fully understand your example, you'll need to know about...</p>\n<h2>record types</h2>\n<p>Record types are the same as <em>product types</em> above, except that the fields are labelled rather than being anonymous. So, you could define the shape node data type like this, instead:</p>\n<pre><code>type Location = (Float, Float)\n\ndata ShapeNode\n  = StringNode { stringLocation :: Location, stringData :: String }\n  | CircleNode { circleLocation :: Location, radius :: Float }\n  | SquareNode { squareLocation :: Location, length :: Float, height :: Float }\n</code></pre>\n<p>Each field is named, and you can't repeat the same name inside data values.</p>\n<p>All that you need in addition to this to understand the above example is to realise your example contains all of these things together, along with the fact that you have functions as your record field values in the data type you have.</p>\n<p>It's a good idea to thoroughly flesh out your understanding and not skip any steps, then you'll be able to follow these kinds of things much more easily in the future. :) I wish you luck!</p>\n"}], "owner": {"reputation": 55, "user_id": 8046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c67d44ba4bb1ea25f7a7707f31e3dec?s=128&d=identicon&r=PG&f=1", "display_name": "itonva", "link": "https://stackoverflow.com/users/8046509/itonva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 44747198, "answer_count": 2, "score": 2, "last_activity_date": 1498530496, "creation_date": 1498392720, "question_id": 44746253, "link": "https://stackoverflow.com/questions/44746253/understanding-data-structure-in-haskell", "title": "understanding data structure in Haskell", "body": "<p>I have a problem with a homework (the topic is : \"functional data structures\").\nPlease understand that I don't want anyone to solve my homework.\nI just have a problem with understanding the structure of this :</p>\n\n<pre><code>data Heap e t = Heap {\n empty :: t e,\n insert :: e -&gt; t e -&gt; t e,\n findMin :: t e -&gt; Maybe e,\n deleteMin :: t e -&gt; Maybe (t e),\n merge :: t e -&gt; t e -&gt; t e,\n contains :: e -&gt; t e -&gt; Maybe Int\n}\n</code></pre>\n\n<p>In my understanding \"empty\" \"insert\" and so on are functions which can applied to \"Heap\"-type data.\nNow I just want to understand how that \"Heap\"thing looks like.\nSo I was typing things like :</p>\n\n<pre><code>  a = Heap 42 42\n</code></pre>\n\n<p>But I get errors I can't really work with. </p>\n\n<p>Maybe it is a dumb question and I'm just stuck at this point for no reason, but it is killing me at the moment.\nThankful to any help</p>\n"}, {"tags": ["haskell", "logging", "monad-transformers", "cloud-haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498405176, "post_id": 44745740, "comment_id": 76476686, "body": "Have you looked at the section of the page you linked entitled <a href=\"https://hackage.haskell.org/package/monad-control-1.0.1.0/docs/Control-Monad-Trans-Control.html#g:4\" rel=\"nofollow noreferrer\">Defaults</a>? You should begin by copying the code there, replacing <code>B</code> with <code>Process</code>. (Note that &quot;I don&#39;t know how to X&quot; is not a good question format for SO. You should include what you&#39;ve tried and why it didn&#39;t work, or at least what you misunderstand)"}], "owner": {"reputation": 1242, "user_id": 3252252, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/4V81y.jpg?s=128&g=1", "display_name": "Jesuspc", "link": "https://stackoverflow.com/users/3252252/jesuspc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1498398981, "creation_date": 1498388920, "last_edit_date": 1498398981, "question_id": 44745740, "link": "https://stackoverflow.com/questions/44745740/file-logging-in-cloud-haskell-using-monad-logger", "title": "File logging in cloud Haskell using monad-logger", "body": "<p>I am trying to log into a file from inside Cloud Haskell's <a href=\"https://hackage.haskell.org/package/distributed-process-0.6.6/docs/Control-Distributed-Process.html#t:Process\" rel=\"nofollow noreferrer\">processes</a>. In order to do so I have been using the <a href=\"https://hackage.haskell.org/package/monad-logger-0.3.24\" rel=\"nofollow noreferrer\">monad-logger</a> library which exposes <a href=\"https://hackage.haskell.org/package/monad-logger-0.3.24/docs/Control-Monad-Logger.html#v:runFileLoggingT\" rel=\"nofollow noreferrer\">runFileLoggingT</a>. The code I'm using looks like:</p>\n\n<pre><code>mainProcess :: Process ProcessId\nmainProcess = spawnLocal $ runFileLoggingT \"log/application.log\" $ return ()\n</code></pre>\n\n<p>But I'm getting an error:</p>\n\n<blockquote>\n  <p>Could not deduce (Control.Monad.Trans.Control.MonadBaseControl\n                            IO Process)</p>\n</blockquote>\n\n<p>That is because <strong>runFileLoggingT</strong> has to work on a monad that implements <a href=\"https://hackage.haskell.org/package/monad-control-1.0.1.0/docs/Control-Monad-Trans-Control.html#t:MonadBaseControl\" rel=\"nofollow noreferrer\">MonadBaseControl</a>, which is not the case for <strong>Process</strong>. Being a beginner on monad transformers I don't know how to implement the instance myself. </p>\n\n<p>What do I need to do in order to make it work?</p>\n"}, {"tags": ["haskell", "functional-programming", "deriving"], "comments": [{"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 1, "creation_date": 1498382101, "post_id": 44744884, "comment_id": 76470761, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3864647/how-does-deriving-work-in-haskell\">How does deriving work in Haskell?</a>"}, {"owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "reply_to_user": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 1, "creation_date": 1498382223, "post_id": 44744884, "comment_id": 76470781, "body": "No, it is not a duplicate."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1498383032, "post_id": 44744884, "comment_id": 76470963, "body": "It is hard to answer your question because you didn&#39;t set up the context. Your only statement is &quot;I don&#39;t know (this or that)&quot;. Things you don&#39;t know need to be explained in terms of things you do know, and no one has a slightest idea what these are. Should we start from types? Functions?  Classes and instances? No clue. As it is, the question is overly broad."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1498404753, "post_id": 44744884, "comment_id": 76476569, "body": "You can actually just see exactly what it does by passing the flag <code>-ddump-deriv</code> to GHC. This will print the code generated by all <code>deriving</code> clauses. That is all it does - generates some boilerplate for you."}], "answers": [{"tags": [], "owner": {"reputation": 19421, "user_id": 3795501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaeec79535337d9a96f63f2d6ef3e49d?s=128&d=identicon&r=PG", "display_name": "Luka Jacobowitz", "link": "https://stackoverflow.com/users/3795501/luka-jacobowitz"}, "is_accepted": false, "score": 3, "last_activity_date": 1498384419, "last_edit_date": 1498384419, "creation_date": 1498382774, "answer_id": 44744984, "question_id": 44744884, "link": "https://stackoverflow.com/questions/44744884/what-does-deriving-do-mean-in-haskell/44744984#44744984", "title": "What does deriving do/mean in Haskell?", "body": "<p>Deriving means that your data type is automatically able to \"derive\" instances for certain type classes. In this case <code>BaseballPlayer</code> derives <code>Show</code> which means we can use any function that requires an instance of <code>Show</code> to work with <code>BaseballPlayer</code>.</p>\n\n<p>Automatic deriving makes it easier for you to avoid boilerplate. The most common type classes for automatic deriving are <code>Show</code> and <code>Eq</code>, because the compiler can make very sensible values for these typeclasses.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 6, "last_activity_date": 1498450056, "last_edit_date": 1498450056, "creation_date": 1498382820, "answer_id": 44744989, "question_id": 44744884, "link": "https://stackoverflow.com/questions/44744884/what-does-deriving-do-mean-in-haskell/44744989#44744989", "title": "What does deriving do/mean in Haskell?", "body": "<p>In this specific case, it generates a <code>Show</code> instance for your type, as follows:</p>\n\n<pre><code>instance Show BaseballPlayer where\n    show Pitcher    = \"Pitcher\"\n    show Catcher    = \"Catcher\"\n    show Infielder  = \"Infielder\"\n    show Outfielder = \"Outfielder\"\n</code></pre>\n\n<p>In this way, values of type <code>BaseballPlayer</code> can be converted to string, e.g. by <code>print</code>.</p>\n\n<p>The string is chosen so that it is a valid Haskell expression that can reconstruct, once evaluated, the original value.</p>\n\n<p>The general case is a bit more complex, but follows the same idea: converting a value into a Haskell expression-string. For instance</p>\n\n<pre><code>data T = T Int (Maybe Bool) deriving Show\n</code></pre>\n\n<p>will make the instance so that</p>\n\n<pre><code>show (T 1 Nothing) = \"T 1 Nothing\"\nshow (T 2 (Just 3)) = \"T 2 (Just 3)\"\n</code></pre>\n\n<p>Note how the parentheses are also generated in the last case. This is done using the <code>showsPrec</code> class member, but it's not that important.</p>\n"}, {"tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": true, "score": 10, "last_activity_date": 1498391900, "creation_date": 1498391900, "answer_id": 44746124, "question_id": 44744884, "link": "https://stackoverflow.com/questions/44744884/what-does-deriving-do-mean-in-haskell/44746124#44746124", "title": "What does deriving do/mean in Haskell?", "body": "<p><strong>In short:</strong></p>\n\n<p><code>deriving</code> automatically implements functions for a few of Haskell's typeclasses such as <code>Show</code> and <code>Eq</code>. This cannot be done with arbitrary typeclasses, but the ones for which <code>deriving</code> does work for are simple enough for automatic implementation.</p>\n\n<p>The <code>Show</code> typeclass defines functions for how to represent data types as a <code>String</code>.</p>\n\n<p><strong>More extensively:</strong></p>\n\n<p>Are you familiar with typeclasses?</p>\n\n<p><a href=\"https://www.haskell.org/tutorial/classes.html\" rel=\"noreferrer\">https://www.haskell.org/tutorial/classes.html</a></p>\n\n<p>Typeclasses are similar to interfaces in Java: they define a few functions that any data type who wants to use those functions can implement.</p>\n\n<p>For instance, say we have a class like such:</p>\n\n<pre><code>class Comparable a where\n    lessThan :: a -&gt; a -&gt; Bool\n    equalsTo :: a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>Beware of the word <code>class</code>. It means typeclass in the Haskell setting, not a typical \"class\" you would hear about in object oriented languages. The <code>a</code> here is a filler type, similar to how you would expect templates would work in C++ and generics to behave in Java.</p>\n\n<p>Let's say we define a data type as follows:</p>\n\n<pre><code>data Color = Red | Green | Blue\n</code></pre>\n\n<p>To make <code>Comparable</code> work with <code>Color</code>, we implement an <code>instance</code> of <code>Comparable</code>:</p>\n\n<pre><code>instance Comparable Color where\n    lessThan Red   Green = True\n    lessThan Red   Blue  = True\n    lessThan Green Blue  = True\n    lessThan _     _     = False\n\n    equalsTo Red   Red   = True\n    equalsTo Green Green = True\n    equalsTo Blue  Blue  = True\n    equalsTo _     _     = False\n</code></pre>\n\n<p>Roughly speaking, this now allows you to \"compare\" <code>Red</code>, <code>Green</code>, and <code>Blue</code> with each other. But was there any way that GHC could have automagically guessed that this is was the exact \"order\" you wanted?</p>\n\n<p>Taking a step back, the typeclass <code>Show</code> has a similar structure:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/src/GHC.Show.html#Show\" rel=\"noreferrer\">https://hackage.haskell.org/package/base-4.9.1.0/docs/src/GHC.Show.html#Show</a></p>\n\n<pre><code>class  Show a  where\n    showsPrec :: Int -&gt; a -&gt; ShowS\n    show      :: a   -&gt; String\n    showList  :: [a] -&gt; ShowS\n\n    showsPrec _ x s = show x ++ s\n    show x          = shows x \"\"\n    showList ls   s = showList__ shows ls s\n</code></pre>\n\n<p>Something to notice is that functions within a typeclass may be defined in terms of each other. Indeed, we could have also easily done:</p>\n\n<pre><code>class Comparable a where\n    lessThan :: a -&gt; a -&gt; Bool\n    equalsTo :: a -&gt; a -&gt; Bool\n\n    greaterThan :: a -&gt; a -&gt; Bool\n    greaterThan lhs rhs = not (lessThan lhs rhs &amp;&amp; equalsTo lhs rhs)\n</code></pre>\n\n<p>However, the key point is this: for arbitrary user-defined typeclasses, GHC has no idea how their functions should be implemented when you try to associate the typeclass with a data type such as <code>Color</code> or <code>BaseballPlayer</code>. For <strong>some</strong> typeclasses such as <code>Show</code>, <code>Eq</code>, <code>Ord</code>, etc, where the functionality is simple enough, GHC can generate default implementations that you can of course overwrite yourself.</p>\n\n<p>Indeed, let's experiment by trying to compile the following:</p>\n\n<pre><code>data Color = Red | Green | Blue deriving (Comparable)\n</code></pre>\n\n<p>The result I get is this:</p>\n\n<pre><code>test.hs:9:43:\n    Can't make a derived instance of \u2018Comparable Color\u2019:\n      \u2018Comparable\u2019 is not a derivable class\n      Try enabling DeriveAnyClass\n    In the data declaration for \u2018Color\u2019\n</code></pre>\n\n<p>Of course, some GHC extensions can be used to extend the power of <code>deriving</code>, but that's for another day :)</p>\n"}], "owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4039, "favorite_count": 0, "accepted_answer_id": 44746124, "answer_count": 3, "score": 6, "last_activity_date": 1590834255, "creation_date": 1498381924, "last_edit_date": 1590834255, "question_id": 44744884, "link": "https://stackoverflow.com/questions/44744884/what-does-deriving-do-mean-in-haskell", "title": "What does deriving do/mean in Haskell?", "body": "<p>The definition of deriving on stack overflow is:</p>\n\n<blockquote>\n  <p>\"In Haskell, a derived instance is an instance declaration that is\n  generated automatically in conjunction with a data or newtype\n  declaration. The body of a derived instance declaration is derived\n  syntactically from the definition of the associated type.\"</p>\n</blockquote>\n\n<p>I don't really understand any of it to be honest.</p>\n\n<p>The code below is taken from: <a href=\"http://www.newthinktank.com/2015/08/learn-haskell-one-video/\" rel=\"nofollow noreferrer\">Link</a> </p>\n\n<pre><code>data BaseballPlayer = Pitcher \n                        | Catcher\n                        | Infielder\n                        | Outfielder\n                        deriving Show\n\nbarryBonds :: BaseballPlayer -&gt; Bool\nbarryBonds Outfielder = True\n\nbarryInOf = print(barryBonds Outfielder)\n</code></pre>\n\n<p><strong>My question is, what does the deriving-statement do in this specific case, \nand also what does the deriving-statement do in general?.</strong></p>\n"}, {"tags": ["haskell", "types", "existential-type", "higher-rank-types", "church-encoding"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 6, "creation_date": 1498381119, "post_id": 44744667, "comment_id": 76470498, "body": "No, you did it.  It&#39;s just that Haskell does not allow <i>impredicative polymorphism</i>, that is to say type constructors (other than <code>(-&gt;)</code>) with polymorphic types.  You will find the same error if you try to create any value of e.g. type <code>[forall a. a]</code>.  If you wrap <code>Obj</code> in a <code>newtype</code> instead of a type synonym, I think this approach will work.  (Unfortunately it doesn&#39;t buy you anything over the existential approach since you still need to wrap values in a constructor)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498408033, "post_id": 44744667, "comment_id": 76477489, "body": "Technically, this small program will work if you enable <code>ImpredicativeTypes</code>; but this extension <a href=\"https://stackoverflow.com/questions/39220435/why-are-higher-rank-types-so-fragile-in-haskell/39230655#39230655\">doesn&#39;t really work</a> so chances are you will hit a wall sooner or later, and be unable to proceed. You won&#39;t be able to use <code>foldr :: .. -&gt; .. -&gt; [Obj] -&gt; ..</code> or basically any higher order list function."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498408290, "post_id": 44744667, "comment_id": 76477553, "body": "Also note calling this a &#39;heterogenous&#39; list is not really correct; <code>[Obj]</code> is a list which stores values of exactly one type - <code>Obj</code>. <code>Obj</code> itself does not somehow store values of many different types - it is isomorphic to <code>Int -&gt; ShowS</code>, which is the type of <code>showsPrec</code> partially applied to its second argument: <code>showsPrec :: Show a =&gt; Int -&gt; a -&gt; ShowS</code>. This makes <code>[Obj]</code> nothing more than a fancy and inconvenient way to write <code>[Int -&gt; ShowsS]</code> - the latter type is predicative and unfathomably easier to work with."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1498410139, "post_id": 44744667, "comment_id": 76478087, "body": "@luqui I had to look more closely at <i>impredicative polymorphism</i> to understand your comment. Very helpful, thanks!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498410694, "post_id": 44744667, "comment_id": 76478263, "body": "@user2407038 I don&#39;t want to proceed with this approach actually. It just helps me to understand the underlying concepts. Usually it isn&#39;t so hard for me to understand new topics. But with Haskell it&#39;s different. Especially the type system is hard to grasp due to all these abstractions/generalizations."}], "owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1498385008, "creation_date": 1498379935, "last_edit_date": 1498385008, "question_id": 44744667, "link": "https://stackoverflow.com/questions/44744667/can-i-implement-an-heterogeneous-list-based-on-an-existential-with-church-encodi", "title": "Can I implement an heterogeneous list based on an existential with Church encoding and Rank-N types?", "body": "<p>In my attempt to understand existential types I've read that Church encoding along with the Rank-N-types extension would be sufficient to encode them in Haskell without existential quantification. I found this straightforward example:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>type Obj = forall y. (forall x. (Show x) =&gt; x -&gt; y) -&gt; y\n\nobj :: Obj\nobj f = f \"hello\"\n\napp :: Obj -&gt; String\napp obj = obj (\\x -&gt; show x)\n</code></pre>\n\n<p>In the Haskell Wiki I stumbled upon the following example of a heterogeneous list based on an existential type:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>data Obj = forall a. (Show a) =&gt; Obj a\n\nxs :: [Obj]\nxs = [Obj 1, Obj \"foo\", Obj 'c']\n\ndoShow :: [Obj] -&gt; String\ndoShow [] = \"\"\ndoShow ((Obj x):xs) = show x ++ doShow xs\n</code></pre>\n\n<p>Now I tried to express this implementation with Church and failed with an <em>illegal polymorphic type</em> error:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>type Obj = forall y. (forall x. (Show x) =&gt; x -&gt; y) -&gt; y \n\nobj1 :: Obj \nobj1 f = f 1 \n\nobj2 :: Obj \nobj2 f = f \"foo\" \n\nobj3 :: Obj \nobj3 f = f 'c' \n\nxs :: [Obj] \nxs = [obj1, obj2, obj3]\n\ndoShow :: [Obj] -&gt; String \ndoShow [] = \"\" \ndoShow (obj:xs) = obj (\\x -&gt; show x ++ doShow xs)\n</code></pre>\n\n<p>I guess this translation is pretty schematic and just plain wrong. Is it right that existential types can be encoded with Church/Rank-N?\n How is it done properly?</p>\n"}, {"tags": ["haskell", "gtk", "gtk2hs"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1498384796, "post_id": 44742090, "comment_id": 76471395, "body": "You are using <code>print ...</code> as the event handler, but this is supposed to be a function accepting information about which button was pressed,etc. , and returning an <code>IO Bool</code>, where the boolean states whether the handler succeeded."}, {"owner": {"reputation": 63, "user_id": 6112186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSb1f.png?s=128&g=1", "display_name": "hello", "link": "https://stackoverflow.com/users/6112186/hello"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498413713, "post_id": 44742090, "comment_id": 76479219, "body": "I looked at the <a href=\"https://github.com/haskell-gi/gi-gtk-examples/blob/master/hello/World.hs\" rel=\"nofollow noreferrer\">gi-gtk hello world example</a> for help. On line 30, they used <code>onButtonClicked button (putStrLn &quot;Hello World&quot;)</code> for signals.  That code runs without errors.  What is the difference between my code and their code?  I ran <code>:t</code> on both functions in ghci, and the only difference in their type signatures is that one takes a <code>ButtonClickedCallback</code> as a parameter and the other takes a <code>WidgetButtonPressEventCallback</code>.  Changing my print statement to a putStrLn function still gives me the same error."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498417532, "post_id": 44742090, "comment_id": 76480251, "body": "I&#39;m not a gtk+ expert, but I&#39;d guess one reacts to clicks, the other to mouse button presses -- which may or may not be clicks, since we have many buttons on our mice. Consequently, the even handler, in the latter case, takes an argument specifying which button was pressed, etc."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1498385507, "last_edit_date": 1498385507, "creation_date": 1498350532, "answer_id": 44742131, "question_id": 44742090, "link": "https://stackoverflow.com/questions/44742090/using-haskell-gi-gtk-signals/44742131#44742131", "title": "Using haskell-gi GTK signals", "body": "<p>Well the error message already says it: it expects a function of the type <code>EventButton -&gt; IO Bool</code>, and <code>print \"Hello world\"</code> has a type <code>IO ()</code>.</p>\n\n<p>You can however easily transform it into one, with:</p>\n\n<pre><code>onWidgetButtonPressEvent dragevents (<b>const $</b> print \"Hello world\"<b> &gt;&gt; return True</b>)</code></pre>\n\n<p>So by using <code>const $</code> we ignore the <code>EventButton</code> parameter for now (later you can decide to take the event parameters into account), and by using <code>&gt;&gt; return True</code>, we make sure that after printing, we return <code>True</code> (meaning the callback succeeded).</p>\n"}], "owner": {"reputation": 63, "user_id": 6112186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSb1f.png?s=128&g=1", "display_name": "hello", "link": "https://stackoverflow.com/users/6112186/hello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 44742131, "answer_count": 1, "score": 2, "last_activity_date": 1498385507, "creation_date": 1498350063, "last_edit_date": 1498385436, "question_id": 44742090, "link": "https://stackoverflow.com/questions/44742090/using-haskell-gi-gtk-signals", "title": "Using haskell-gi GTK signals", "body": "<p>Haskell Gi-GTK noob here.  And GTK noob in general.</p>\n\n<p>I have an image, which I've wrapped in an Eventbox.  Now, I want to detect when the user presses on the event box (mousedown).  Some Googling points me to using <code>button-press-event</code>.  My code is below.</p>\n\n<pre><code>drag &lt;- imageNewFromFile \"rszh.png\"\ndragevents &lt;- eventBoxNew\ncontainerAdd dragevents drag\nset dragevents [widgetHalign := AlignEnd, widgetValign := AlignEnd]\nonWidgetButtonPressEvent dragevents (print \"Hello world\")\n</code></pre>\n\n<p>And GHC fails to compile this with the following cryptic error message:</p>\n\n<pre><code>panedraggin.hs:30:42: error:\n    \u2022 Couldn't match type \u2018IO ()\u2019\n                     with \u2018GI.Gdk.Structs.EventButton.EventButton -&gt; IO Bool\u2019\n      Expected type: GI.Gtk.Objects.Widget.WidgetButtonPressEventCallback\n        Actual type: IO ()\n    \u2022 Possible cause: \u2018print\u2019 is applied to too many arguments\n      In the second argument of \u2018onWidgetButtonPressEvent\u2019, namely\n        \u2018(print \"Hello world\")\u2019\n      In a stmt of a 'do' block:\n        onWidgetButtonPressEvent dragevents (print \"Hello world\")\n      In the expression:\n        do { Gtk.init Nothing;\n             window &lt;- windowNew WindowTypeToplevel;\n             onWidgetDestroy window mainQuit;\n             windowMaximize window;\n             .... }\n</code></pre>\n\n<p>What am I doing incorrectly?</p>\n"}, {"tags": ["reactjs", "haskell", "functional-programming", "redux", "ghci"], "comments": [{"owner": {"reputation": 6956, "user_id": 3229773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fa824ea09ebb16ba8922518d1dd5de1?s=128&d=identicon&r=PG&f=1", "display_name": "M\u03bc.", "link": "https://stackoverflow.com/users/3229773/m%ce%bc"}, "edited": false, "score": 0, "creation_date": 1498354157, "post_id": 44741870, "comment_id": 76465946, "body": "What do you mean by &#39;write redux app in haskell&#39;? Do you mean writing a redux app front end in javascript with haskell backend? Or writing redux app front end in haskell and also with haskell backend?"}, {"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "reply_to_user": {"reputation": 6956, "user_id": 3229773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fa824ea09ebb16ba8922518d1dd5de1?s=128&d=identicon&r=PG&f=1", "display_name": "M\u03bc.", "link": "https://stackoverflow.com/users/3229773/m%ce%bc"}, "edited": false, "score": 0, "creation_date": 1498372996, "post_id": 44741870, "comment_id": 76468829, "body": "the second, I want to use redux architecture in Haskell. am sold into using the same language for frontend and backend to share code re-use code"}], "answers": [{"comments": [{"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 0, "creation_date": 1498565550, "post_id": 44777329, "comment_id": 76540370, "body": "reflex looks promising and active on GitHub, however, could I know what makes you suggest <code>reflex</code> over other straight forward architecture - what Evan called it First order FRP- such as <code>react-hs</code> and <code>miso</code> <a href=\"https://github.com/dmjio/miso\" rel=\"nofollow noreferrer\">link</a> that are closer to Redux/Elm..."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 0, "creation_date": 1498567692, "post_id": 44777329, "comment_id": 76541862, "body": "He asked for the <b>best</b> way to do this. The best way is continuous-time functions. Of course it depends on one&#39;s definition of best. I was choosing high-quality of result and efficiency over ease of learning for the average programmer. By &quot;Evan&quot; I assume you mean the creator of Elm. Elm is a primarily event driven system which abandons much of Conal Elliot&#39;s work. reflex-dom is <b>amazingly cool</b> in terms of what it&#39;s capable of."}], "tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": true, "score": 2, "last_activity_date": 1498557374, "creation_date": 1498557374, "answer_id": 44777329, "question_id": 44741870, "link": "https://stackoverflow.com/questions/44741870/what-is-the-best-way-to-do-redux-in-haskell/44777329#44777329", "title": "what is the best way to do redux in Haskell", "body": "<p>Well, I think the <strong>best</strong> way to do what you're calling <em>redux</em> here in Haskell is probably to use something that works with Conal Elliott's ideas.</p>\n\n<p>These ideas are pretty strong, and probably one of the nicest implementation of some of them is in reflex-dom... here's the website for it: <a href=\"https://github.com/reflex-frp/reflex-platform\" rel=\"nofollow noreferrer\">https://github.com/reflex-frp/reflex-platform</a></p>\n\n<p>Word of warning, though: you <em>do</em> need to understand Haskell quite well to use it.</p>\n"}], "owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1024, "favorite_count": 0, "accepted_answer_id": 44777329, "answer_count": 1, "score": 0, "last_activity_date": 1498557374, "creation_date": 1498347098, "last_edit_date": 1498478956, "question_id": 44741870, "link": "https://stackoverflow.com/questions/44741870/what-is-the-best-way-to-do-redux-in-haskell", "title": "what is the best way to do redux in Haskell", "body": "<p>I like. haskell and its type system and I find it interesting to write backend in haskell. however, IMO I don't think that switching to another language for the front end is good idea.</p>\n\n<p>I want to share my code between the front end and back and use the validation and type and do not repeat myself.</p>\n\n<p>looking for some architecture about front end I got to know to <code>flux</code> then <code>redux</code> and I liked redux the most.</p>\n\n<p>what is the best way to write redux app in haskell. after some research I found <code>react-flux</code> but any other option that is more like redux</p>\n"}, {"tags": ["haskell", "module", "scope", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498339999, "post_id": 44741131, "comment_id": 76463493, "body": "You cannot simply define a new <code>(&gt;&gt;=)</code> function like that. You should make an <code>instance Monad (Int -&gt; (Int,[Char]))</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1498340198, "post_id": 44741131, "comment_id": 76463541, "body": "Why did you only post half of the error message?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1498340237, "post_id": 44741131, "comment_id": 76463550, "body": "This has nothing to do with monads. The problem is that you&#39;re redefining (in <code>Main</code>) a function that&#39;s already defined in <code>Prelude</code>."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498344442, "post_id": 44741131, "comment_id": 76464464, "body": "@WillemVanOnsem You can&#39;t define a monad instance for that type."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1498344527, "post_id": 44741131, "comment_id": 76464479, "body": "@ThreeFx: yes, but the <code>(&gt;&gt;=)</code> function of the monad clashes with the <code>(&gt;&gt;=)</code> defined in the file, making calls ambiguous."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498344591, "post_id": 44741131, "comment_id": 76464491, "body": "@WillemVanOnsem In that case, just qualify the call of <code>(&gt;&gt;=)</code>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1498374520, "post_id": 44741131, "comment_id": 76469103, "body": "You&#39;re not using any monad at all, you&#39;re just defining a function called <code>(&gt;&gt;=)</code>. There are free books online: <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">Learn You a Haskell for Great Good!</a> and <a href=\"http://book.realworldhaskell.org/read/\" rel=\"nofollow noreferrer\">Real World Haskell</a>. It&#39;s not really a beginners&#39; subject, so I would recommend focusing on the basics."}], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": true, "score": 3, "last_activity_date": 1498385648, "last_edit_date": 1498385648, "creation_date": 1498350020, "answer_id": 44742082, "question_id": 44741131, "link": "https://stackoverflow.com/questions/44741131/error-trying-to-define-custom-bind-operator-in-haskell/44742082#44742082", "title": "Error trying to define custom bind operator in Haskell", "body": "<p>To answer this properly, we have to check that your assumed and actual knowledge match up with the definitions the Haskell community has for this knowledge.</p>\n\n<p>So, to begin, you obviously understand what types are, and it seems like you understand <em>polymorphic types</em> reasonably well.</p>\n\n<p>Because <code>Monad</code> is a typeclass, and typeclasses use <em>polymorphic types</em> and because typeclasses can also use <em>algebraic data types</em>, it's a good idea to make sure you have a firm understanding of those things before attempting to understand <code>Monad</code>. Typeclasses are very similar to interfaces in other langauges - they define an abstract set of mandatory and optional functions (and their types) that a particular typeclass instance must adhere to. Often they also give you \"free\" functionality with default definitions of other functions. They're very very cool :)</p>\n\n<p>There are many good places where you can gain a good understanding of what typeclasses are. I'd point you to <a href=\"http://www.happylearnhaskelltutorial.com/1/output_other_things.html\" rel=\"nofollow noreferrer\">http://www.happylearnhaskelltutorial.com/1/output_other_things.html</a> as a simple introduction (full disclosure, I helped write this), and the typeclassopedia, which will also explain about Monads a bit more, too (and give you the requisite knowledge) <a href=\"https://wiki.haskell.org/Typeclassopedia\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Typeclassopedia</a></p>\n\n<p>I should mention, also, if you have the money and you want good lengthy exercises  to really flesh out your understanding, check out <a href=\"http://haskellbook.com\" rel=\"nofollow noreferrer\">http://haskellbook.com</a> \u2014 it's fairly lengthy, but would probably be very useful for you, also generally to give you a good working understanding of the basics of Haskell.</p>\n\n<p>It's very important to realise that there is a big difference between <strong>using</strong> a <code>Monad</code> instance, of which the prelude contains many common ones, and <strong>making</strong> a <code>Monad</code> instance, which is what it appears you're trying to do above.</p>\n\n<p>Then, also, there's the definition of the <code>Monad</code> typeclass itself, often given as an example in books, and which can help you to understand how <code>Monad</code> instances work.</p>\n\n<p>Eventually you'll need to look up the general definitions of the functions contained in the <code>Monad</code> typeclass anyway to fully understand how it's working, but it's good to keep an understanding that these three things are quite separate and yet often interchangeably described as \"Monad\" by people. (For example the value <code>Just 5</code> could be described as a monadic value, but often people will just say it's a monad, even though that's technically incorrect in a subtle way... because <code>Maybe</code> has a <code>Monad</code> instance defined for it, and <code>Just 5</code> is a <code>Maybe</code> value. You could also talk about the definition of the <code>Monad</code> instance for <code>Maybe</code> and look up how it's implemented, or even define it yourself, so long as you make sure you don't have it in scope when you try to defin it by doing one of the following: hide the default <code>Maybe</code> in the prelude, don't import the prelude, or name your version of <code>Maybe</code> something else, like <code>MyMaybe</code>.</p>\n\n<p>So, I would recommend starting with understanding the difference between these three things. Armed with that knowledge, read the two references I gave you, and start with reading code that uses typeclasses, then read some code that uses <code>Monad</code> instances \u2014 for a few different types to give you an intuition, then move on to reimplementing a prelude <code>Monad</code> or two yourself, then finally trying to create your own version of the <code>Monad</code> typeclass without looking at the prelude one so you can test your own understanding of the functions. Then you'll have a really good understanding of them :)</p>\n\n<p>Also worth noting that it's probably a good idea to tackle the path of typeclasses up to <code>Monad</code> before you get there. You'll probably have to do this anyway, but they are <code>Functor</code>, <code>Applicative</code>, and then finally <code>Monad</code>. You can optionally add <code>Semigroup</code> and <code>Monoid</code> in before <code>Functor</code>, but that's just to give you more typeclass understanding more than a necessity for understanding the <code>Monad</code> typeclass.</p>\n\n<p>Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1498384511, "creation_date": 1498384511, "answer_id": 44745181, "question_id": 44741131, "link": "https://stackoverflow.com/questions/44741131/error-trying-to-define-custom-bind-operator-in-haskell/44745181#44745181", "title": "Error trying to define custom bind operator in Haskell", "body": "<p>You are defining a binding for <code>(&gt;&gt;=)</code> which is already bound by the prelude (as pointed out in the comments above).</p>\n\n<p>So, you need to disambiguate each reference to it.</p>\n\n<p>Give your module a name</p>\n\n<pre><code>module M where\n</code></pre>\n\n<p>and then, instead of writing</p>\n\n<pre><code>h x = (&gt;&gt;=) g f x\n</code></pre>\n\n<p>use either</p>\n\n<pre><code>h x = (M.&gt;&gt;=) g f x\n</code></pre>\n\n<p>or</p>\n\n<pre><code>h x = (Prelude.&gt;&gt;=) g f x\n</code></pre>\n\n<p>to choose which version of <code>&gt;&gt;=</code> you want.</p>\n\n<p><strong>However</strong>, this is not what you actually want to do, I think. This <code>(&gt;&gt;=)</code> will be a binding which has nothing to do with the <code>Monad</code> class.</p>\n"}], "owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 44742082, "answer_count": 2, "score": 2, "last_activity_date": 1498385648, "creation_date": 1498339753, "last_edit_date": 1498377273, "question_id": 44741131, "link": "https://stackoverflow.com/questions/44741131/error-trying-to-define-custom-bind-operator-in-haskell", "title": "Error trying to define custom bind operator in Haskell", "body": "<p>So I have been researching a lot about monads lately and I am very new to the Haskell-programming language.</p>\n\n<p>This is my code:</p>\n\n<pre><code>import Data.List\nimport System.IO\n\nf :: Int -&gt; (Int, [Char])\nf x = (x, ['a'])\n\ng :: Int -&gt; (Int, [Char])\ng y = (y, ['b'])\n\n(&gt;&gt;=) :: (Int -&gt; (Int, [Char])) -&gt; (Int -&gt; (Int, [Char])) -&gt; Int -&gt; (Int, [Char])\n(&gt;&gt;=) f1 f2 a =  f1 (fst (f2 a))\n\nh :: Int -&gt; (Int, [Char])\nh x = (&gt;&gt;=) g f x\n</code></pre>\n\n<p>The GHCI-Compiler displays:\nerror:</p>\n\n<pre><code>Ambiguous occurrence `&gt;&gt;='\nIt could refer to either `Prelude.&gt;&gt;='\n</code></pre>\n\n<p>What am I doing wrong?\nAm I using monads in the correct way?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1498339215, "post_id": 44740467, "comment_id": 76463307, "body": "But its second suggestion, to enable <code>UndecidableInstances</code>, is perfectly fine."}, {"owner": {"reputation": 6890, "user_id": 2140872, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d6527.jpg?s=128&g=1", "display_name": "robertjlooby", "link": "https://stackoverflow.com/users/2140872/robertjlooby"}, "edited": false, "score": 0, "creation_date": 1498365098, "post_id": 44740467, "comment_id": 76467481, "body": "So I can use <code>UndecidableInstances</code> to get the compiler to derive the instance for me, but what about the <code>MaybeT</code> type makes it unable to derive without that while it can handle the <code>IdentityT</code> type just fine? Ex. I would expect it to be able to show <code>MaybeT [Just 1]</code> without any extensions"}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 5, "last_activity_date": 1498334407, "creation_date": 1498334407, "answer_id": 44740467, "question_id": 44740200, "link": "https://stackoverflow.com/questions/44740200/why-cant-the-show-instance-be-derived-for-maybet/44740467#44740467", "title": "Why can&#39;t the Show instance be derived for MaybeT?", "body": "<p>I think we can see the issue by following GHC's suggestions (I'm using 8.2.1) until we hit a dead end:</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| newtype MaybeT m a =\nPrelude|   MaybeT { runMaybeT :: m (Maybe a) }\nPrelude|   deriving (Show)\nPrelude| :}\n\n&lt;interactive&gt;:12:13: error:\n    \u2022 No instance for (Show (m (Maybe a)))\n        arising from the first field of \u2018MaybeT\u2019 (type \u2018m (Maybe a)\u2019)\n      Possible fix:\n        use a standalone 'deriving instance' declaration,\n          so you can specify the instance context yourself\n    \u2022 When deriving the instance for (Show (MaybeT m a))\nPrelude&gt; :set -XStandaloneDeriving \nPrelude&gt; deriving instance Show (m (Maybe a)) =&gt;  Show (MaybeT m a)\n\n&lt;interactive&gt;:17:19: error:\n    \u2022 The constraint \u2018Show (m (Maybe a))\u2019\n        is no smaller than the instance head\n      (Use UndecidableInstances to permit this)\n    \u2022 In the stand-alone deriving instance for\n        \u2018Show (m (Maybe a)) =&gt; Show (MaybeT m a)\u2019\n</code></pre>\n\n<p>Okay, so <code>Show</code> wasn't derivable for <code>MaybeT</code> likely because that constraint would have been disallowed, as it's the sort of constraint the typechecker can't prove termination about. You can read more about what \"no smaller than instance head\" means in this answer: <a href=\"https://stackoverflow.com/a/17866970/176841\">https://stackoverflow.com/a/17866970/176841</a></p>\n"}, {"comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1586376073, "post_id": 44745118, "comment_id": 108109446, "body": "This is great hard to find anwer... Helped me with my today&#39;s problem well after 2 hours of nonsense. :)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1498383983, "creation_date": 1498383983, "answer_id": 44745118, "question_id": 44740200, "link": "https://stackoverflow.com/questions/44740200/why-cant-the-show-instance-be-derived-for-maybet/44745118#44745118", "title": "Why can&#39;t the Show instance be derived for MaybeT?", "body": "<p>GHC uses a heuristics to determine if an instance guarantees search termination.\nBy termination here, we mean that, when searching for an instance we will not loop forever. Concretely,this must be forbidden</p>\n\n<pre><code>instance Show a =&gt; Show a where ...\n</code></pre>\n\n<p>as well as this</p>\n\n<pre><code>instance Show [a] =&gt; Show a where ...\n</code></pre>\n\n<p>GHC roughly requires that constraints in the instance context (the part before the <code>=&gt;</code>) must be \"smaller\" than the constraint in the head (after the <code>=&gt;</code>). So, it accepts this:</p>\n\n<pre><code>instance Show a =&gt; Show [a] where ...\n</code></pre>\n\n<p>since <code>a</code> contains one type constructor less than <code>[a]</code>.</p>\n\n<p>It also accepts this:</p>\n\n<pre><code>instance Show (f a) =&gt; Show (IdentityT f a) where ...\n</code></pre>\n\n<p>since <code>f a</code> contains one type constructor less than <code>IdentityT f a</code>.</p>\n\n<p>However,</p>\n\n<pre><code>instance Show (f (Maybe a)) =&gt; Show (MaybeT f a) where ...\n</code></pre>\n\n<p>uses the same number of constructors! Hence, it is not accepted to be sure it will not cause a loop. After all, later on, we might meet</p>\n\n<pre><code>instance Show (MaybeT f a)) =&gt; Show (f (Maybe a)) where ...\n</code></pre>\n\n<p>and it's clear that at least one of these two instances must be rejected to guarantee termination. GHC chooses to reject both of them.</p>\n\n<p><code>UndecidableInstances</code> relaxes this restriction. GHC will accept both instances, and now the burden is on us to avoid loops.</p>\n"}], "owner": {"reputation": 6890, "user_id": 2140872, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d6527.jpg?s=128&g=1", "display_name": "robertjlooby", "link": "https://stackoverflow.com/users/2140872/robertjlooby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 44745118, "answer_count": 2, "score": 8, "last_activity_date": 1498383983, "creation_date": 1498332584, "question_id": 44740200, "link": "https://stackoverflow.com/questions/44740200/why-cant-the-show-instance-be-derived-for-maybet", "title": "Why can&#39;t the Show instance be derived for MaybeT?", "body": "<p>If I define the monad transformer type for <code>Identity</code>, it is able to derive the <code>Show</code> instance.</p>\n\n<pre><code>newtype IdentityT f a =\n  IdentityT { runIdentityT :: f a }\n  deriving (Show)\n</code></pre>\n\n<p>will derive</p>\n\n<pre><code>instance Show (f a) =&gt; Show (IdentityT f a)\n</code></pre>\n\n<p>But if I define the monad transformer type for <code>Maybe</code></p>\n\n<pre><code>newtype MaybeT m a =\n  MaybeT { runMaybeT :: m (Maybe a) }\n  deriving (Show)\n</code></pre>\n\n<p>I get the error</p>\n\n<pre><code>\u2022 No instance for (Show (m (Maybe a)))\n        arising from the first field of \u2018MaybeT\u2019 (type \u2018m (Maybe a)\u2019)\n</code></pre>\n\n<p>Since <code>Maybe a</code> has a <code>Show</code> instance, I would expect it to work and derive</p>\n\n<pre><code>instance Show (m (Maybe a)) =&gt; Show (MaybeT m a)\n</code></pre>\n\n<p>Why can't it?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1498326389, "post_id": 44737623, "comment_id": 76459841, "body": "I wonder what happens if you remove the explicit <code>forall</code> from <code>modifyWithM</code>. It looks like there were several bugs related to cross-module specialization that were fixed by some changes in 8.2.1 which you might try (if that&#39;s not what you are using): see related tickets on <a href=\"https://ghc.haskell.org/trac/ghc/ticket/13376\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/13376</a> . If you are using 8.2.1 I think you should report a bug"}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1498333762, "post_id": 44737623, "comment_id": 76461926, "body": "@jberryman Thanks for the suggestions. I went ahead and gave GHC 8.2 RC2 a try (I had been using RC1), and it did not fix the issue. I also tried getting rid of the <code>forall</code>, but that did not resolve it either."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1498339653, "post_id": 44737623, "comment_id": 76463412, "body": "Have you tried adding <code>INLINABLE</code> to the definition site? I think that&#39;s almost certainly necessary."}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498340238, "post_id": 44737623, "comment_id": 76463551, "body": "@dfeuer Yes, it is marked as <code>INLINABLE</code> at the definition site."}, {"owner": {"reputation": 756, "user_id": 3710751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c92104b92f86f29098c11fa44b6cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Pickering", "link": "https://stackoverflow.com/users/3710751/matthew-pickering"}, "edited": false, "score": 0, "creation_date": 1507756838, "post_id": 44737623, "comment_id": 80343174, "body": "Is this still a problem? Can you open a ticket on the issue tracker if it is?"}], "owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 608, "favorite_count": 2, "answer_count": 0, "score": 9, "last_activity_date": 1498319273, "creation_date": 1498315791, "last_edit_date": 1498319273, "question_id": 44737623, "link": "https://stackoverflow.com/questions/44737623/specializing-imported-function-in-ghc-haskell", "title": "Specializing Imported Function in GHC Haskell", "body": "<p>I'm working on a project right now where I'm dealing with\nthe <a href=\"http://hackage.haskell.org/package/primitive-0.6.2.0/docs/Data-Primitive-Types.html\" rel=\"noreferrer\"><code>Prim</code></a> typeclass and I need to ensure that a particular\nfunction I've written is specialized. That is, I need to make sure that\nwhen I call it, I get a specialized version of the function in which the\n<code>Prim</code> dictionaries get inlined into the specialized\ndefinition instead of being passed at runtime.</p>\n\n<p>Fortunately, this is a pretty well-understood thing in GHC. You can just\nwrite:</p>\n\n<pre><code>{-# SPECIALIZE foo :: ByteArray Int -&gt; Int #-}\nfoo :: Prim a =&gt; ByteArray a -&gt; Int\nfoo = ...\n</code></pre>\n\n<p>And in my code, this approach is working fine. But, since typeclasses are\nopen, there can be <code>Prim</code> instances that I don't know about yet when\nthe library is being written. This brings me to the problem at hand.\nThe GHC user guide's <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#specialize-pragma\" rel=\"noreferrer\">documentation of <code>SPECIALIZE</code></a>\nprovides two ways to use it. The first is putting <code>SPECIALIZE</code> at the\nsite of the definition, as I did in the example above. The second is\nputting the <code>SPECIALIZE</code> pragma in another module where the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#specialize-for-imported-functions\" rel=\"noreferrer\">function is imported</a>.\nFor reference, the example the user manual provides is:</p>\n\n<pre><code>module Map( lookup, blah blah ) where\n  lookup :: Ord key =&gt; [(key,a)] -&gt; key -&gt; Maybe a\n  lookup = ...\n  {-# INLINABLE lookup #-}\n\nmodule Client where\n  import Map( lookup )\n\n  data T = T1 | T2 deriving( Eq, Ord )\n  {-# SPECIALISE lookup :: [(T,a)] -&gt; T -&gt; Maybe a\n</code></pre>\n\n<p>The problem I'm having is that this is not working in my code. The project\nis <a href=\"https://github.com/andrewthad/btree/tree/109eca9bd234718f286f25f247b20ac34eefb84f\" rel=\"noreferrer\">on github</a>,\nand the relevant lines are:</p>\n\n<ul>\n<li><a href=\"https://github.com/andrewthad/btree/blob/109eca9bd234718f286f25f247b20ac34eefb84f/bench/Main.hs#L24\" rel=\"noreferrer\"><code>bench/Main.hs</code> line 24</a></li>\n<li><a href=\"https://github.com/andrewthad/btree/blob/109eca9bd234718f286f25f247b20ac34eefb84f/src/BTree/Compact.hs#L149\" rel=\"noreferrer\"><code>src/BTree/Compact.hs</code> line 149</a></li>\n</ul>\n\n<p>To run the benchmark, run these commands:</p>\n\n<pre><code>git submodule init &amp;&amp; git submodule update\ncabal new-build bench &amp;&amp; ./dist-newstyle/build/btree-0.1.0.0/build/bench/bench\n</code></pre>\n\n<p>When I run the benchmark as is, there is a part of the output that reads:</p>\n\n<pre><code>Off-heap tree, Amount of time taken to build:\n0.293197796\n</code></pre>\n\n<p>If I uncomment <a href=\"https://github.com/andrewthad/btree/blob/109eca9bd234718f286f25f247b20ac34eefb84f/src/BTree/Compact.hs#L151\" rel=\"noreferrer\">line 151 of BTree.Compact</a>,\nthat part of the benchmark runs fifty times faster:</p>\n\n<pre><code>Off-heap tree, Amount of time taken to build:\n5.626834e-2\n</code></pre>\n\n<p>It's worth pointing out that the function in question, <code>modifyWithM</code>, is enormous.\nIt's implementation is over 100 lines, but I do not think this should make a\ndifference. The docs claim:</p>\n\n<blockquote>\n  <p>... mark the definition of f as INLINABLE, so that GHC guarantees to expose an unfolding regardless of how big it is.</p>\n</blockquote>\n\n<p>So, my understanding is that, if specializing at the definition site works, it\nshould always be possible to instead specialize at the call site. I would appreciate\nany insights from people who understand this machinery better than I do, and I'm\nhappy to provide more information if something is unclear. Thanks.</p>\n\n<p>EDIT: I've realized that in the git commit I linked to in this post, there is a problem with the benchmark code. It repeatedly inserts the same value. However, even after fixing this, the specialization problem is still happening.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1498314042, "post_id": 44737362, "comment_id": 76456212, "body": "That is not how Haskell works... Haskell is a functional and declarative language."}, {"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1498314077, "post_id": 44737362, "comment_id": 76456222, "body": "You mean <code>return something</code> instead of <code>do something</code>?"}, {"owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "edited": false, "score": 0, "creation_date": 1498314161, "post_id": 44737362, "comment_id": 76456245, "body": "yeah exactly , I simply want a check for whether var1 is true or false, and do the needful accordingly."}, {"owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "edited": false, "score": 0, "creation_date": 1498334120, "post_id": 44737362, "comment_id": 76462022, "body": "&quot;do the needful&quot;... the answer to the question probably depends on what the  needful is. Can you give an example of what you want to do/calculate in the 2 cases?"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1498314622, "last_edit_date": 1498314622, "creation_date": 1498314285, "answer_id": 44737414, "question_id": 44737362, "link": "https://stackoverflow.com/questions/44737362/simple-check-in-haskell/44737414#44737414", "title": "Simple check in haskell", "body": "<p>Haskell is a <em>functional</em> and <em>declarative</em> language. That means that usually that there is <em>not much \"do something\"</em>. There is more <em>calculate something and return it</em>.</p>\n\n<p>That may look like nitpicking, but for instance in Haskell one cannot set a variable <em>twice</em>: once you assign it an <em>expression</em> (not per se a value)\n, you cannot set it to a <em>different</em> value.</p>\n\n<p>If you want to return something, you usually work with pattern matching. For instance:</p>\n\n<pre><code>f :: Bool -&gt; String\nf True = \"Yes\"\nf False = \"No\"\n</code></pre>\n\n<p>This would be somewhat <em>equivalent</em> in Java/C#/... to:</p>\n\n<pre><code>public String f (boolean var1) {\n    if(var1) {\n        return \"Yes\";\n    } else {\n        return \"No\";\n    }\n}\n</code></pre>\n\n<p>Note that Haskell works <em>lazy</em> as well: if you return a function call or anything, you do <em>not</em> immediately evaluate that function call: a call is only evaluated if that is necessary.</p>\n\n<p>A problem might arise how to do I/O. For that, there is the concept of an I/O <a href=\"https://en.wikipedia.org/wiki/Monad_(functional_programming)\" rel=\"noreferrer\">monad</a>. A monad is a functional programming technique that enforces a certain order of evaluation.</p>\n\n<p>But <em>functional programming</em> thus requires a different \"mindset\" than <em>imperative programming</em>: you do not think of a program in terms of <em>commands</em> that are done one after another, but more in terms of composing functions together to generate output for a given input. Like usually a mathematician or physicist does. You compose for instance a function that, given the mass and the velocity of something, calculates the kinetic energy of that object.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1498322519, "creation_date": 1498322519, "answer_id": 44738663, "question_id": 44737362, "link": "https://stackoverflow.com/questions/44737362/simple-check-in-haskell/44738663#44738663", "title": "Simple check in haskell", "body": "<p>Haskell has if-then-else conditionals.</p>\n\n<p>The closest code to yours I can write is something like this:</p>\n\n<pre><code>let var = length \"hello\" == 5\nin if var then \"ok\" else \"no\"\n</code></pre>\n\n<p>Note that such conditional is more similar to C or Java's <code>var ? \"ok\" : \"no\"</code> expression than an <code>if()...</code> statement, but this is to be expected since Haskell is functional, so it has no \"statements\", only expressions.</p>\n\n<p>Any Haskell tutorial should cover this. I'd recommend you read one, if you want to learn Haskell. Trying to convert idioms from other languages is a poor strategy.</p>\n"}], "owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 44737414, "answer_count": 2, "score": -1, "last_activity_date": 1498322519, "creation_date": 1498313984, "last_edit_date": 1498314180, "question_id": 44737362, "link": "https://stackoverflow.com/questions/44737362/simple-check-in-haskell", "title": "Simple check in haskell", "body": "<p>I am new to haskel.What would be a good way of doing something like this in haskell?</p>\n\n<pre><code>var1 = //can be true or false \nif(var1==true)\n{\n  //return someething\n}\nelse\n{\n//\n}\n</code></pre>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1498307928, "post_id": 44734967, "comment_id": 76454231, "body": "The bug you linked to says &quot;<i>This is not a bug after all. I needed to use <code>CorePrep.corePrepPgm</code> before trying to use <code>CoreToStg.coreToStg</code>.</i>&quot;."}, {"owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1498310581, "post_id": 44734967, "comment_id": 76455104, "body": "Ah, it works after some struggle :)  Thank you!"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1498311381, "post_id": 44734967, "comment_id": 76455392, "body": "You should post the working code as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498316131, "post_id": 44737152, "comment_id": 76456878, "body": "&quot;-- This is bad practice&quot; - indeed, but the GHC api is filled with historical accidents (like representing a non-empty list with the <code>[]</code> type) which sometimes basically force you to do &quot;bad&quot; things. So don&#39;t feel too bad about it!"}], "tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": true, "score": 1, "last_activity_date": 1518290668, "last_edit_date": 1518290668, "creation_date": 1498312673, "answer_id": 44737152, "question_id": 44734967, "link": "https://stackoverflow.com/questions/44734967/extracting-stg-of-haskell-source/44737152#44737152", "title": "Extracting STG of Haskell Source", "body": "<p>Many thanks to <a href=\"https://stackoverflow.com/users/1848654/melpomene\">melpomene</a> for pointing out something I missed in the documentation.</p>\n\n<p>Here is the modified source of the <code>test.hs</code> that works:</p>\n\n<pre><code>import CorePrep\nimport CoreToStg\nimport GHC\nimport GHC.Paths\nimport GhcMonad\nimport HscTypes\nimport Outputable\nimport StgSyn\nimport System.IO\n\nmkSTG :: FilePath -&gt; FilePath -&gt; IO [StgBinding]\nmkSTG proj src = runGhc (Just libdir) $ do\n        env    &lt;- getSession\n        dflags &lt;- getSessionDynFlags\n        setSessionDynFlags (dflags {importPaths = [proj]})\n        target &lt;- guessTarget src Nothing\n        setTargets [target]\n        load LoadAllTargets\n\n        mod_graph &lt;- getModuleGraph\n        let mod_sum = head mod_graph  -- This is bad practice\n        pmod &lt;- parseModule mod_sum\n        tmod &lt;- typecheckModule pmod\n        dmod &lt;- desugarModule tmod\n        let guts  = coreModule dmod\n        let loc   = ms_location mod_sum\n        let binds = mg_binds guts\n        let tcs   = mg_tcs guts\n        prep &lt;- liftIO $ corePrepPgm env loc binds tcs\n        liftIO $ coreToStg dflags (mg_module guts) prep\n\nmkIOStr :: (Outputable a) =&gt; a -&gt; IO String\nmkIOStr obj = do\n    dflags &lt;- runGhc (Just libdir) getSessionDynFlags\n    let ppr_str = showPpr dflags obj\n    return ppr_str\n\nmain :: IO ()\nmain = do\n    let proj = \"/home/celery/Desktop/hue\"\n    let src  = proj ++ \"/FooBar.hs\"\n    res &lt;- mkIOStr =&lt;&lt; mkSTG proj src\n    putStrLn res\n</code></pre>\n\n<p>I am not sure what the best way to recover a <code>ModSummary</code> (and hence the <code>ModuleName</code>) from a <code>Target</code> is, but I do vaguely remember it being the first element of the <code>ModuleGraph</code>, which is defined as <code>type ModuleGraph = [ModSummary]</code>.</p>\n\n<p>The type signature for <code>corePrepPgm</code> is also different between GHC 7 and 8:</p>\n\n<p><a href=\"https://downloads.haskell.org/~ghc/7.10.1/docs/html/libraries/ghc-7.10.1/CorePrep.html\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/7.10.1/docs/html/libraries/ghc-7.10.1/CorePrep.html</a></p>\n\n<p><a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/ghc-8.0.1/CorePrep.html\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/latest/docs/html/libraries/ghc-8.0.1/CorePrep.html</a></p>\n\n<p>Suggestions for improvement are welcome :)</p>\n\n<p><strong>EDIT</strong>: I have found instances of counter examples to this -- the <code>head</code> of a <code>ModuleGraph</code> is not always the target. My current workaround is to see if any <code>ModSummary</code> within the <code>ModuleGraph</code> contains a location which matches that of the initial source file location.</p>\n"}], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 44737152, "answer_count": 1, "score": 6, "last_activity_date": 1518290668, "creation_date": 1498296848, "last_edit_date": 1498307411, "question_id": 44734967, "link": "https://stackoverflow.com/questions/44734967/extracting-stg-of-haskell-source", "title": "Extracting STG of Haskell Source", "body": "<p>I am trying to extract the STG representation of a Haskell source as a <code>String</code> via <code>Outputable</code>, but it looks like <code>coreToStgArgs</code> is panicing with the following dump:</p>\n\n<pre><code>user@machine ~/Desktop/hue $ runhaskell test.hs \n[foo :: forall a. Num a =&gt; a -&gt; a\n [GblId, Arity=2, Caf=NoCafRefs, Str=DmdType] =\n     \\r srt:SRT:[] [$dNum a1] + $dNum a1 a1;,\n bar :: Int -&gt; Int\n [GblId,test.hs: test.hs: panic! (the 'impossible' happened)\n  (GHC version 7.10.3 for x86_64-unknown-linux):\n    coreToStgArgs I# 3\n\nPlease report this as a GHC bug:  http://www.haskell.org/ghc/reportabug\n</code></pre>\n\n<p>Here is the file <code>FooBar.hs</code> that I want to extract:</p>\n\n<pre><code>module FooBar where\n\nfoo a = a + a\n\nbar :: Int -&gt; Int\nbar b = b + 3\n</code></pre>\n\n<p>Here is the source of <code>test.hs</code> that I used:</p>\n\n<pre><code>import CoreToStg\nimport GHC\nimport GHC.Paths\nimport Outputable\nimport StgSyn\n\nmkDynFlags :: IO DynFlags\nmkDynFlags = runGhc (Just libdir) getSessionDynFlags\n\nmkSTG :: FilePath -&gt; FilePath -&gt; IO [StgBinding]\nmkSTG proj src = do\n    dflags  &lt;- mkDynFlags\n    ghc_core &lt;- runGhc (Just libdir) $ do\n        setSessionDynFlags (dflags {importPaths = [proj]})\n        compileToCoreSimplified src\n        -- compileToCoreModule src\n    coreToStg dflags (cm_module ghc_core) (cm_binds ghc_core)\n\nmkIOStr :: (Outputable a) =&gt; a -&gt; IO String\nmkIOStr obj = do\n    dflags &lt;- mkDynFlags\n    let ppr_str = showPpr dflags obj\n    return ppr_str\n\nmain :: IO ()\nmain = do\n    let proj = \"/home/user/Desktop/hue\"\n    let src  = proj ++ \"/FooBar.hs\"\n    res &lt;- mkIOStr =&lt;&lt; mkSTG proj src\n    putStrLn res\n</code></pre>\n\n<p>It looks like someone several years before me has run into a similar problem:</p>\n\n<p><a href=\"https://ghc.haskell.org/trac/ghc/ticket/7159\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/ticket/7159</a></p>\n\n<p>However, I have no idea what has happened since. I am also not sure if this is the correct way to go about extracting the STG of an arbitrary Haskell source, so if there are better alternatives that work, I would like to hear about them.</p>\n\n<p><strong>EDIT:</strong>\nSTG translation appears successful for the following program where <code>bar b = b + 3</code> is changed to <code>bar b = 3</code>:</p>\n\n<pre><code>module FooBar where\n\nfoo a = a + a\n\nbar :: Int -&gt; Int\nbar b = 3\n</code></pre>\n\n<p>In fact, at first glance, things appear to work if the induced Core Haskell does not force primitive operations to be performed. For instance <code>bar b = 3 + 9</code> fails.</p>\n"}, {"tags": ["parsing", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498315985, "post_id": 44734301, "comment_id": 76456835, "body": "Recommending a fully featured parser for such a simple syntax is a bit silly (like a recommendation to hunt birds with a machine gun). There is no rule that <code>Show</code>/<code>Read</code> can&#39;t be used for customized syntaxes (indeed, any abstract type with a <code>Show</code> instance must use a customized syntax). It is the <i>derived</i> instances which can&#39;t be used to implement a customized syntax, but the OP states they are <i>not</i> using the derived instances."}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1498375590, "post_id": 44734301, "comment_id": 76469286, "body": "I edit to numbering the question, if you answering the <code>1.</code> can you provide a working code?"}], "tags": [], "owner": {"reputation": 116, "user_id": 5504067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ed0a31fdfd82774e60dd6bf45b88db3?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Lehmacher", "link": "https://stackoverflow.com/users/5504067/devin-lehmacher"}, "is_accepted": true, "score": 1, "last_activity_date": 1499803056, "last_edit_date": 1499803056, "creation_date": 1498291332, "answer_id": 44734301, "question_id": 44733857, "link": "https://stackoverflow.com/questions/44733857/understanding-read-instance/44734301#44734301", "title": "Understanding Read instance", "body": "<ol>\n<li>In my opinion the correct way to implement Read is to derive it and otherwise, it is likely better to move on to more sophisticated parsers. Here is answers to all of your questions anyways.\n\n<ul>\n<li>readPrec is a simple parser combinator based approach for that GHC provides. If you are willing to sacrifice portability for your Read instance you can use it and it makes parsing easier.</li>\n<li>I include a small example of how you could use readPrec below</li>\n<li>parsec is different from readPrec, however both are parser combinator like. <a href=\"https://hackage.haskell.org/package/parsec\" rel=\"nofollow noreferrer\">Parsec</a> is a much more complete parser library. Another parser combinator library is <a href=\"https://hackage.haskell.org/package/attoparsec\" rel=\"nofollow noreferrer\">attoparsec</a>  which works very similarly to parsec.</li>\n<li>parsec and attoparsec can't be used with the ordinary Read typeclass (at least directly) but the greater flexibility they offer makes them a good idea for any time you want more complex parsing.</li>\n</ul></li>\n<li>The <code>Int</code> argument to <code>readsPrec</code> is for dealing with precedence when parsing. This might matter when you want to parse arithmetic expressions. You can choose to fail parsing if the precedence is higher than the precedence of the current operator.</li>\n<li>Deriving <code>Read</code> from <code>Show</code> isn't possible unfortunately.</li>\n</ol>\n\n<p>Here are a couple of snippets that show how I would implement <code>Read</code> using <code>ReadPrec</code>.</p>\n\n<p>ReadPrec example: </p>\n\n<pre><code>instance Read Tests where\n  readPrec = choice [pZero, pOne, pTwo] where\n    pChar c = do\n      c' &lt;- get\n      if c == c'\n      then return c\n      else pfail\n    pZero = traverse pChar \"ZERO\" *&gt; pure Zero\n    pOne = One &lt;$&gt; (traverse pChar \"ONE \" *&gt; readPrec)\n    pTwo = Two &lt;$&gt; (traverse pChar \"TWO \" *&gt; readPrec) &lt;*&gt; readPrec\n</code></pre>\n\n<p>In general implementing Read is less intuitive than more heavyweight parsers. Depending on what you want to parse I highly suggest learning parsec or attoparsec since they are extremely useful when you want to parse even more complicated things.</p>\n"}], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 44734301, "answer_count": 1, "score": 3, "last_activity_date": 1499803056, "creation_date": 1498288365, "last_edit_date": 1498376608, "question_id": 44733857, "link": "https://stackoverflow.com/questions/44733857/understanding-read-instance", "title": "Understanding Read instance", "body": "<p>I made <code>Read</code> and <code>Show</code> instances of my data, but did not understand the <code>Read</code> instance</p>\n\n<pre><code>data Tests = Zero\n          | One Int\n          | Two Int Double\n\ninstance Show Tests where\n  show Zero      = \"ZERO\"\n  show (One i)   = printf \"ONE %i\" i\n  show (Two i j) = printf \"TWO %i %f\" i j\n\ninstance Read Tests where\n  readsPrec _ str   = [(mkTests str, \"\")]\n\nmkTests :: String -&gt; Tests\nmkTests = check . words\n\ncheck :: [String] -&gt; Tests\ncheck [\"ZERO\"]      = Zero\ncheck [\"ONE\", i]    = One (read i)\ncheck [\"TWO\", i, j] = Two (read i) (read j)\ncheck _             = error \"no parse\"\n\nmain :: IO ()\nmain = do\n  print Zero\n  print $ One 10\n  print $ Two 1 3.14\n\n  let x = read \"ZERO\" :: Tests\n  print x\n  let y = read \"ONE 2\" :: Tests\n  print y\n  let z = read \"TWO 2 5.5\" :: Tests\n  print z\n</code></pre>\n\n<p>This is output </p>\n\n<pre><code>ZERO         \nONE 10       \nTWO 1 3.14   \nZERO         \nONE 2        \nTWO 2 5.5  \n</code></pre>\n\n<p><strong>Here are questions:</strong></p>\n\n<ol>\n<li><p>What is recommend way to implement <code>Read</code> instance?</p>\n\n<ul>\n<li>The minimal complete definition of <code>Read</code> class is <code>readsPrec | readPrec</code>\nand <code>readPrec :: ReadPrec a</code> description wrote</li>\n</ul>\n\n<blockquote>\n  <p>Proposed replacement for readsPrec using new-style parsers (GHC only).</p>\n</blockquote>\n\n<ul>\n<li>Should I use <code>readPrec</code> instead, How? I can't find any example on the net that I can understand.</li>\n<li>What is the <code>new-style parsers</code>, is it <code>parsec</code>?</li>\n</ul></li>\n<li><p>What is the first <code>Int</code> argument of <a href=\"https://hackage.haskell.org/package/base/docs/Text-Read.html#v:readsPrec\" rel=\"nofollow noreferrer\">readsPrec :: Int -> ReadS a </a>, is using for?</p></li>\n<li><p>Is there anyway to somehow deriving <code>Read</code> from <code>Show</code>?</p></li>\n</ol>\n\n<p>In the past I could use <code>deriving (Show,Read)</code> to most of the job. But this time I want to move to next level.</p>\n"}, {"tags": ["haskell", "clojure", "pattern-matching"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 4, "creation_date": 1498278911, "post_id": 44732138, "comment_id": 76447846, "body": "There is a lot of prior art on this topic. Have you looked at, say, core.match or core.typed to see how they address pattern-matching and type-checking? If not, you should start there."}, {"owner": {"reputation": 958, "user_id": 2041696, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZxyCX.jpg?s=128&g=1", "display_name": "grandinero", "link": "https://stackoverflow.com/users/2041696/grandinero"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1498311449, "post_id": 44732138, "comment_id": 76455417, "body": "Does core.match emit a decision tree that&#39;s both type-checkable and ready to evaluate values at runtime? Part of my objective here is to understand Haskell better. If someone were trying to do this in Haskell, they wouldn&#39;t have the option of circumventing the type system. So how would they implement this algorithm?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498315450, "post_id": 44732138, "comment_id": 76456674, "body": "What makes you think that Haskell type checks and emits running code in precisely the same representation? The Haskell code which actually runs is basically C (a dialect of C called Cmm). The Haskell code which is typechecked is the concrete syntax after expansion of <code>type</code>s and such. In the middle, Haskell code spends its time mainly as core, which is similar to the concrete syntax, but no syntactic sugar and a few other features which make it amenable for program transformations. I suggest you read about GHCs actual typechecker before making assertions about what can and can&#39;t be done."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498315682, "post_id": 44732138, "comment_id": 76456742, "body": "Finally, the question &quot;how do you represent such a vector or stack in a type-checkable way?&quot; seems entirely out of context. You represent such a vector with... a vector. That&#39;s it. There is nothing special about your typechecker other than that there is an eventual code generation step which emits code in precisely the language in which the typechecker is written. That code generation step is <i>entirely seperate</i> from the steps which involve typechecking. So your idea to have an intermediate step is perfectly sound, and is indeed what is done in a host of compilers of statically typed languages"}, {"owner": {"reputation": 958, "user_id": 2041696, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZxyCX.jpg?s=128&g=1", "display_name": "grandinero", "link": "https://stackoverflow.com/users/2041696/grandinero"}, "edited": false, "score": 0, "creation_date": 1498316794, "post_id": 44732138, "comment_id": 76457066, "body": "Thanks. I have no theoretical background, so when I hit an obstacle, I don&#39;t know whether it&#39;s a theoretical one or just something I&#39;m missing. I am aware that Haskell is compiled in C, but surely you can build a compiler in Haskell if you want to. In regards to Maranget&#39;s algorithm and vectors, I&#39;m used to dynamically-typed languages, where it&#39;s easy to work with a vector that holds anything you want, and Maranget seems to be taking such a loose approach, but it&#39;s not clear to me how you would represent such a vector in Haskell."}, {"owner": {"reputation": 958, "user_id": 2041696, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZxyCX.jpg?s=128&g=1", "display_name": "grandinero", "link": "https://stackoverflow.com/users/2041696/grandinero"}, "edited": false, "score": 0, "creation_date": 1498317088, "post_id": 44732138, "comment_id": 76457155, "body": "In other words, Haskell has vectors, but all the elements have to be of the same type. That&#39;s not the case with Maranget&#39;s vectors."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498317110, "post_id": 44732138, "comment_id": 76457162, "body": "In dynamic languages, you work with the vector assuming it contains values of a single &#39;type&#39;, and if it doesn&#39;t, an error happens. Sometimes, that single type is one of <code>k</code> types; that doesn&#39;t change the fact that it is morally a &#39;single&#39; type. In Haskell, this is the <code>Either</code> type, or more generally, sum types. (But why ask about Haskell when you&#39;re implementing this in clojure? again; I&#39;m not sure what the actual question here is)."}, {"owner": {"reputation": 958, "user_id": 2041696, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZxyCX.jpg?s=128&g=1", "display_name": "grandinero", "link": "https://stackoverflow.com/users/2041696/grandinero"}, "edited": false, "score": 0, "creation_date": 1498318267, "post_id": 44732138, "comment_id": 76457508, "body": "That I&#39;m doing this in Clojure is just a detail. I&#39;m really trying to understanding Haskell through a hands-on approach. It&#39;s not really important that I&#39;m implementing pattern-matching, either, I just wanted to give all the background. The main issue is that I&#39;ve encountered a problem that I don&#39;t know how to solve without circumventing typing, which means I wouldn&#39;t be able to solve it in Haskell, so I&#39;ve found something that I need to understand better. I&#39;m familiar with Either and sum types, but I&#39;ll have to put some thought into how they help me with this quandary. Thanks!"}, {"owner": {"reputation": 12070, "user_id": 5044950, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/9yN0x.jpg?s=128&g=1", "display_name": "Sam Estep", "link": "https://stackoverflow.com/users/5044950/sam-estep"}, "edited": false, "score": 0, "creation_date": 1498393414, "post_id": 44732138, "comment_id": 76473476, "body": "Perhaps I&#39;m misunderstanding your intent, but if your goal is to understand how to solve something like this in Haskell rather than in Clojure, why are you using Clojure to write it? Why not just write it in Haskell instead?"}, {"owner": {"reputation": 958, "user_id": 2041696, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZxyCX.jpg?s=128&g=1", "display_name": "grandinero", "link": "https://stackoverflow.com/users/2041696/grandinero"}, "edited": false, "score": 0, "creation_date": 1498447004, "post_id": 44732138, "comment_id": 76486384, "body": "Long story, but I get your point!"}], "owner": {"reputation": 958, "user_id": 2041696, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZxyCX.jpg?s=128&g=1", "display_name": "grandinero", "link": "https://stackoverflow.com/users/2041696/grandinero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1498400876, "creation_date": 1498271033, "last_edit_date": 1498329562, "question_id": 44732138, "link": "https://stackoverflow.com/questions/44732138/implementing-haskell-style-pattern-matching-with-type-checking", "title": "Implementing Haskell-style pattern matching with type checking", "body": "<p>I am working on a project to recreate some of the features of Haskell in Clojure. I have succeeded in implementing Hindley-Milner type inference, and now I am trying to introduce pattern-matching syntax via a macro. My goal is to have the macro first emit valid Clojure code and then type-check that code, but I am finding this hard to do. Since I'm brand new to Haskell and static typing in general, I'm not sure if there's a way to do it that I don't see, or whether it's just not possible.</p>\n\n<p>I'm attempting to follow <a href=\"http://moscova.inria.fr/~maranget/papers/ml05e-maranget.pdf\" rel=\"nofollow noreferrer\">Luc Maranget's algorithm</a>, at least the naive version for now. My understanding is that you take a vector of values (or \"occurrences\" at compile time) and treat it as a stack. After grouping the rows of patterns by the constructors of the first column, you find the group of patterns corresponding to the constructor of the first value in the vector. If the vector is <code>(v1 ... vn)</code>, and <code>v1</code> is <code>c(a1 ... ak)</code>, where <code>c</code> is the constructor and <code>a1 ... ak</code> are the arguments to the constructor, then you drop the constructor <code>c</code> and concatenate the arguments with the vector, creating the new vector <code>(a1 ... ak v2 ... vn)</code>, and run the algorithm recursively.</p>\n\n<p>My question is, how do you represent such a vector or stack in a type-checkable way? Again, my goal is for the Clojure macro to emit code that is both ready to handle runtime values but also ready to be type-checked at compile time. I could introduce an intermediate step, wherein the first macro emits code that is type-checkable but is also itself a macro, and then have the second macro emit the code that will actually run. But even if that works, it's less satisfying because it suggests that I wouldn't be able to accomplish a task like this in Haskell itself. Am I missing something?</p>\n\n<p><strong>-- EDIT --</strong></p>\n\n<p>I now see that my confusion arose from not having encountered a situation in my short experience with static typing in which I had to deal with a heterogeneous collection. My question could have been formulated more clearly, but since I'm mapping out the problem space as I go along, I am not always sure exactly what an obstacle is or how it's related to everything else I'm dealing with.  Thanks to the comments below, I believe that to surmount this particular challenge I just need to have a better understanding of the options available for dealing with heterogeneous collections in Haskell. <a href=\"https://wiki.haskell.org/Heterogenous_collections\" rel=\"nofollow noreferrer\">This article</a> seems to be a good starting point.</p>\n"}, {"tags": ["list", "haskell", "return", "bind", "monads"], "answers": [{"comments": [{"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1498272073, "post_id": 44731489, "comment_id": 76446973, "body": "I was always curious how one could look at any given haskell expression (eg <code>[1..3] &gt;&gt; return &quot;Hey&quot;</code>) and know which implementation a particular function (eg <code>return</code>) is using \u2013 how would I know that the Function Functor&#39;s <code>return</code> was used in this case ?"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 2, "creation_date": 1498272496, "post_id": 44731489, "comment_id": 76447021, "body": "@naomik - looking at the types. From <code>[1..3]</code> we know that the left-hand-side of <code>&gt;&gt;=</code> is of type <code>Num a =&gt; [a]</code>, which means that <code>&gt;&gt;=</code> is defined in <code>instance Monad []</code>, and its right-hand side must be of type <code>Num a =&gt; a -&gt; [b]</code>. We already knew <code>return &quot;Hey&quot; :: Monad m =&gt; m String</code>, so now we can state <code>m String ~ a -&gt; [b]</code>, which we can have match up if we take <code>b ~ Char</code> and <code>m ~ (-&gt;) a</code>, so <code>return</code> must be defined by <code>instance Monad ((-&gt;) a)</code>."}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1498273118, "post_id": 44731489, "comment_id": 76447093, "body": "@rampion there&#39;s a grin on my face as I begin to understand it. I still have two questions tho \u2013 1) how can I precisely interpret <code>~</code> in (eg) <code>m String ~ a -&gt; [b]</code>? and 2) is it possible that multiple <code>return</code> implementations could satisfy the required type?"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1498274303, "post_id": 44731489, "comment_id": 76447231, "body": "1) <code>~</code> is type-level equality. You&#39;ll see it in hand-wavy type inference proofs like the one I gave and in type constraints (e.g. <code>(Show a, Monad m, m a ~ String)</code>). 2) In this specific example, no, because we narrowed <code>m</code> to be <code>Num a =&gt; (-&gt;) a</code> and <code>instance Monad ((-&gt;) a)</code> doesn&#39;t depend on <code>a</code>. If there were separate <code>instance Monad ((-&gt;) Int</code> and <code>instance Monad ((-&gt;) Float)</code> instead, it&#39;d be a different answer though.  Both would match."}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1498279905, "post_id": 44731489, "comment_id": 76447980, "body": "@rampion thank you for your help \u2013 did you ever finish work on <a href=\"http://rampion.blogspot.ca/2011/12/thrill-digger-and-expected-value.html\" rel=\"nofollow noreferrer\">thrill digger assistant</a>? This type of problem is very interesting to me and I&#39;d like to see your work if it&#39;s been open sourced ^_^"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 8, "last_activity_date": 1498263029, "creation_date": 1498263029, "answer_id": 44731489, "question_id": 44731408, "link": "https://stackoverflow.com/questions/44731408/how-does-this-weird-monad-bind-work/44731489#44731489", "title": "How does this weird monad bind work?", "body": "<blockquote>\n  <p>I understand how <code>&gt;&gt;= (\\_ -&gt; return \"Hey\")</code> would yield <code>[\"Hey\", \"Hey\", \"Hey\"]</code></p>\n</blockquote>\n\n<p>right. <code>return \"Hey\"</code> is in this case the same as <code>[\"Hey\"]</code>, because</p>\n\n<pre><code>instance Monad [] where\n  return x = [x]\n</code></pre>\n\n<p>So</p>\n\n<pre><code>([1..3] &gt;&gt;= \\_ -&gt; return \"Hey\")\n  \u2261  ([1..3] &gt;&gt;= \\_ -&gt; [\"Hey\"])\n  \u2261  [\"Hey\"] ++ [\"Hey\"] ++ [\"Hey\"]\n  \u2261  [\"Hey\", \"Hey\", \"Hey\"]\n</code></pre>\n\n<p>Now, <code>&gt;&gt;= (\\_ -&gt; \"Hey\")</code> can also be be written with a list-result in the lambda, because strings are just lists of characters.</p>\n\n<pre><code>([1..3] &gt;&gt;= \\_ -&gt; \"Hey\")\n  \u2261  ([1..3] &gt;&gt;= \\_ -&gt; ['H','e','y'])\n  \u2261  ['H','e','y'] ++ ['H','e','y'] ++ ['H','e','y']\n  \u2261  ['H','e','y','H','e','y','H','e','y']\n  \u2261  \"HeyHeyHey\"\n</code></pre>\n\n<p>As for <code>&gt;&gt;= return \"Hey\"</code>, that's a different beast. The <code>return</code> belongs to a completely different monad here, namely the <em>function functor</em>.</p>\n\n<pre><code>instance Monad (x-&gt;) where\n  return y = const y\n</code></pre>\n\n<p>Hence it's kind of clear that <code>([1..3] &gt;&gt;= const \"Hey\")</code> and <code>([1..3] &gt;&gt;= return \"Hey\")</code> give the same result: in that example, <code>return</code> is just another name for <code>const</code>!</p>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 6, "last_activity_date": 1498263087, "creation_date": 1498263087, "answer_id": 44731498, "question_id": 44731408, "link": "https://stackoverflow.com/questions/44731408/how-does-this-weird-monad-bind-work/44731498#44731498", "title": "How does this weird monad bind work?", "body": "<p>The <code>return</code> being used here is not for the list monad, but for the function monad, in which this definition holds:</p>\n\n<pre><code>return x = \\_ -&gt; x\n</code></pre>\n\n<p>So this is the same as:</p>\n\n<pre><code>[1,2,3] &gt;&gt;= (\\_ -&gt; \"Hey\")\n</code></pre>\n\n<p>and since <code>(&gt;&gt;=)</code> is the same as <code>concatMap</code> for lists, we have:</p>\n\n<pre><code>concatMap (\\_ -&gt; \"Hey\") [1,2,3]\n</code></pre>\n\n<p>Can you see why this yields <code>\"HeyHeyHey\"</code>?</p>\n"}], "owner": {"reputation": 156, "user_id": 5174914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3v-qu6H-Em4/AAAAAAAAAAI/AAAAAAAAALA/fgIsCNJJjDk/photo.jpg?sz=128", "display_name": "Lu&#237;s Hendrix", "link": "https://stackoverflow.com/users/5174914/lu%c3%ads-hendrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 44731489, "answer_count": 2, "score": 1, "last_activity_date": 1498263087, "creation_date": 1498262216, "question_id": 44731408, "link": "https://stackoverflow.com/questions/44731408/how-does-this-weird-monad-bind-work", "title": "How does this weird monad bind work?", "body": "<p>This is probably a very noob question but I was playing around with the bind operator in Haskell and I encountered a way to repeat a string using it.</p>\n\n<pre><code>[1..3] &gt;&gt;= const \"Hey\"\n-- Yields \"HeyHeyHey\"\n[1..3] &gt;&gt;= return \"Hey\"\n-- Also yields the same result\n</code></pre>\n\n<p>I understand how <code>&gt;&gt;= (\\_ -&gt; return \"Hey\")</code> would yield <code>[\"Hey\", \"Hey\", \"Hey\"]</code> but I don't understand why <code>(\\_ -&gt; \"Hey\")</code> repeats the string or why <code>&gt;&gt;= return \"Hey\"</code> does the same thing.</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 3, "last_activity_date": 1498291321, "creation_date": 1498291321, "answer_id": 44734298, "question_id": 44731103, "link": "https://stackoverflow.com/questions/44731103/yesod-redirect-method-get-put-delete-which-one/44734298#44734298", "title": "Yesod Redirect method GET PUT DELETE Which one?", "body": "<p>According to <a href=\"https://en.wikipedia.org/wiki/URL_redirection#HTTP_status_codes_3xx\" rel=\"nofollow noreferrer\">HTTP</a>, the redirect can be performed using either the same method, or simple GET.</p>\n\n<p>And <a href=\"https://www.stackage.org/haddock/lts-8.6/yesod-core-1.4.32/Yesod-Core-Handler.html#v:redirect\" rel=\"nofollow noreferrer\">redirect</a> documentation in Yesod says, that it always uses GET.</p>\n"}], "owner": {"reputation": 234, "user_id": 6475907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-xQd4dCvGOmg/AAAAAAAAAAI/AAAAAAAAABo/WuJS4WB_RNg/photo.jpg?sz=128", "display_name": "WellTyped", "link": "https://stackoverflow.com/users/6475907/welltyped"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 44734298, "answer_count": 1, "score": 3, "last_activity_date": 1498291321, "creation_date": 1498259589, "question_id": 44731103, "link": "https://stackoverflow.com/questions/44731103/yesod-redirect-method-get-put-delete-which-one", "title": "Yesod Redirect method GET PUT DELETE Which one?", "body": "<p>I have the following routes definition:</p>\n\n<pre><code>mkYesod \"App\" [parseRoutes|\n/ ImagesR GET POST\n/image/#ImageId ImageR DELETE\n/static StaticR Static getStatic\n/echo-body EchoBodyR PUT\n|]\n</code></pre>\n\n<p>and in one of the handlers, there is <code>redirect ImagesR</code>. So which GET,POST or DELETE will be called after redirection?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1498254034, "post_id": 44730301, "comment_id": 76443411, "body": "No, because of laziness, the tail is <i>not</i> evaluated until you need it."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 2, "creation_date": 1498254048, "post_id": 44730301, "comment_id": 76443415, "body": "Can&#39;t remember that function specifically, but if it creates a lazy infinite list of random numbers, you can just <code>take</code> from the infinite list to get a few of the elements. Note the function won&#39;t evaluate all at once; it only produces values as needed. Look at the <code>repeat</code> function to see another example of that."}, {"owner": {"reputation": 173, "user_id": 8207187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b449f8641d07135c80cc2c64c4f35c6?s=128&d=identicon&r=PG&f=1", "display_name": "1 -_-", "link": "https://stackoverflow.com/users/8207187/1"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1498254475, "post_id": 44730301, "comment_id": 76443567, "body": "@Carcigenicate But doesn&#39;t the function need to return the control flow to the caller somewhere?"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1498254595, "post_id": 44730301, "comment_id": 76443604, "body": "@1-_- You&#39;re thinking too strictly. Do you know what Python generators are by chance?"}, {"owner": {"reputation": 173, "user_id": 8207187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b449f8641d07135c80cc2c64c4f35c6?s=128&d=identicon&r=PG&f=1", "display_name": "1 -_-", "link": "https://stackoverflow.com/users/8207187/1"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1498254954, "post_id": 44730301, "comment_id": 76443686, "body": "@Carcigenicate I just looked them up, cleared my confusion. Please add your comments as an answer."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1498255142, "post_id": 44730301, "comment_id": 76443742, "body": "@1-_- OK, good. I was just going to say that when working with infinite lists, you can think of it at though the values are being <code>yield</code>ed one at a time instead of the entire list being returned at once. I&#39;d strongly recommend looking deeper into, and getting used to laziness, as Haskell makes extensive use of it."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1498255219, "post_id": 44730301, "comment_id": 76443758, "body": "@1-_- I don&#39;t know if I could write a good explanation, as it&#39;s been awhile since I&#39;ve used Haskell, and it&#39;s a difficult topic to dive into. That&#39;s just the best comparison of could think of that might help shift your perspective."}, {"owner": {"reputation": 173, "user_id": 8207187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b449f8641d07135c80cc2c64c4f35c6?s=128&d=identicon&r=PG&f=1", "display_name": "1 -_-", "link": "https://stackoverflow.com/users/8207187/1"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1498255432, "post_id": 44730301, "comment_id": 76443815, "body": "@Carcigenicate Yes it did help. You can just write what you wrote about Python&#39;s generators in the comment."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1498447313, "post_id": 44730301, "comment_id": 76486456, "body": "Haskell functions <i>don&#39;t</i> return. Function returning is simply <i>not a thing</i> in Haskell. Saying the function never returns is as meaningful as saying the function never eats cheese."}, {"owner": {"reputation": 173, "user_id": 8207187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b449f8641d07135c80cc2c64c4f35c6?s=128&d=identicon&r=PG&f=1", "display_name": "1 -_-", "link": "https://stackoverflow.com/users/8207187/1"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1498458372, "post_id": 44730301, "comment_id": 76488951, "body": "@immibis When I said &quot;returns&quot; I was actually talking about the control flow and return value being returned to the caller."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1498463764, "post_id": 44730301, "comment_id": 76491128, "body": "@1-_- And when I said &quot;eats cheese&quot; I was actually talking about ingesting coagulated bovine lactation. What&#39;s your point?"}], "answers": [{"tags": [], "owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "is_accepted": false, "score": 7, "last_activity_date": 1498254892, "last_edit_date": 1498254892, "creation_date": 1498254590, "answer_id": 44730394, "question_id": 44730301, "link": "https://stackoverflow.com/questions/44730301/how-does-the-randoms-function-in-haskell-work/44730394#44730394", "title": "How does the `randoms` function in Haskell work?", "body": "<p>I think the confusing part might be the use of <code>:</code> in the return value.</p>\n\n<pre><code>value:randoms' newGen \n</code></pre>\n\n<p>This is a list, with the first item of <code>value</code>, and the rest of the list is what is returned by the recursive call to <code>randoms' newGen</code>.</p>\n\n<blockquote>\n  <p>What I don't understand is how the function returns because every time it just calls itself with a new random seed!</p>\n</blockquote>\n\n<p>Because of laziness, it will only call itself if you try to access the second (or later) item of the returned list. This list isn't, and couldn't be in memory, at once. Lists in Haskell are more like recipes... until you try to access an element, Haskell doesn't try to work out what it is.</p>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1498258616, "post_id": 44730559, "comment_id": 76444675, "body": "A related, useful insight for me was that lists in Haskell aren\u2019t great when used as <i>data</i> structures (if you want to store a sequence of elements, a <code>Vector</code> or something is probably better) but they\u2019re excellent <i>control</i> structures, behaving more or less like (memoised) iterators &amp; generators in other languages."}], "tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": true, "score": 5, "last_activity_date": 1498343514, "last_edit_date": 1498343514, "creation_date": 1498255553, "answer_id": 44730559, "question_id": 44730301, "link": "https://stackoverflow.com/questions/44730301/how-does-the-randoms-function-in-haskell-work/44730559#44730559", "title": "How does the `randoms` function in Haskell work?", "body": "<p>As a crude comparison, instead of trying to think of how an infinite list could be returned, consider how a Python generator is capable of \"returning\" an infinite list:  by <code>yield</code>ing one element at a time, as they're required.</p>\n\n<p>The entire list isn't returned at once. Each element is evaluated as it's needed, and the function only recurses as it needs to. </p>\n\n<p>Note, I'm not claiming Haskell's laziness works the same way as Python's generators, but it may be a helpful comparison to keep in mind when thinking about functions like these. </p>\n\n<p>See the other answer to get an explanation of why this is happening. </p>\n"}], "owner": {"reputation": 173, "user_id": 8207187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b449f8641d07135c80cc2c64c4f35c6?s=128&d=identicon&r=PG&f=1", "display_name": "1 -_-", "link": "https://stackoverflow.com/users/8207187/1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 44730559, "answer_count": 2, "score": 2, "last_activity_date": 1498343514, "creation_date": 1498253904, "question_id": 44730301, "link": "https://stackoverflow.com/questions/44730301/how-does-the-randoms-function-in-haskell-work", "title": "How does the `randoms` function in Haskell work?", "body": "<p>I'm following the <a href=\"http://learnyouahaskell.com\" rel=\"nofollow noreferrer\">Learn You A Haskell</a> book to learn Haskell, and I am having trouble understanding the <code>randoms</code> function. The book defines the function as:</p>\n\n<pre><code>randoms' :: (RandomGen g, Random a) =&gt; g -&gt; [a]  \nrandoms' gen = let (value, newGen) = random gen in value:randoms' newGen    \n</code></pre>\n\n<p>Now the way I see this function is that it calls itself recursively and appends the return value to the list <code>value</code>. What I don't understand is how the function returns because every time it just calls itself with a new random seed!</p>\n"}, {"tags": ["haskell", "gadt", "deriving", "infix-operator"], "comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 8, "creation_date": 1498248870, "post_id": 44729223, "comment_id": 76441380, "body": "I never knew you could tell the <code>Show</code> deriver to print a non-symbolic constructor infix."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1498254049, "post_id": 44729686, "comment_id": 76443416, "body": "Perhaps a) should be dropped? If the user specified a fixity, maybe the binary constructor is expected to be used infix, I&#39;d guess."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 13, "last_activity_date": 1498250750, "creation_date": 1498250750, "answer_id": 44729686, "question_id": 44729223, "link": "https://stackoverflow.com/questions/44729223/can-i-make-haskell-gadt-data-constructor-infix-in-derived-show/44729686#44729686", "title": "Can I make haskell GADT data constructor infix in derived Show?", "body": "<p>Not currently. GADT constructors are only flagged as infix <a href=\"https://github.com/ghc/ghc/blob/master/compiler/typecheck/TcTyClsDecls.hs#L1752\" rel=\"noreferrer\">under a specific set of conditions</a>:</p>\n\n<blockquote>\n<pre><code>Note [Infix GADT constructors]\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nWe do not currently have syntax to declare an infix constructor in GADT syntax,\nbut it makes a (small) difference to the Show instance.  So as a slightly\nad-hoc solution, we regard a GADT data constructor as infix if\n  a) it is an operator symbol\n  b) it has two arguments\n  c) there is a fixity declaration for it\nFor example:\n   infix 6 (:--:)\n   data T a where\n     (:--:) :: t1 -&gt; t2 -&gt; T Int\n</code></pre>\n</blockquote>\n\n<p>So for a non-symbolic constructor like <code>W</code>, it looks like you're out of luck, but if you're willing to make it symbolic, you can just add a fixity declaration.</p>\n\n<p>(hat tip to <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11345#comment:8\" rel=\"noreferrer\">this template haskell bug thread</a>)</p>\n"}], "owner": {"reputation": 2670, "user_id": 463086, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39e6e9414db52675a28a06ab429378c4?s=128&d=identicon&r=PG", "display_name": "horsh", "link": "https://stackoverflow.com/users/463086/horsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 1, "accepted_answer_id": 44729686, "answer_count": 1, "score": 13, "last_activity_date": 1498250750, "creation_date": 1498248534, "last_edit_date": 1498248862, "question_id": 44729223, "link": "https://stackoverflow.com/questions/44729223/can-i-make-haskell-gadt-data-constructor-infix-in-derived-show", "title": "Can I make haskell GADT data constructor infix in derived Show?", "body": "<p>Consider two <code>data</code> declarations:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata X = Int `Y` Int deriving Show\n\ndata Z where\n        W :: Int -&gt; Int -&gt; Z  deriving Show\n\nmain = do\n         print (1 `Y` 2)\n         print (3 `W` 4)\n</code></pre>\n\n<p>Running the above program produces:</p>\n\n<pre><code>1 `Y` 2\nW 3 4\n</code></pre>\n\n<p>so the derived <code>show</code> knows that <code>Y</code> is infix and prints it accordingly. The <code>::</code> syntax doesn't seem to allow infixness.</p>\n\n<p>Is there any way to make the compiler derive show for <code>W</code> as infix, (other than explicitly providing a <code>show</code> instance for <code>Z</code>)?\nThe desired output is</p>\n\n<pre><code>1 `Y` 2\n3 `W` 4\n</code></pre>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1498263324, "post_id": 44729207, "comment_id": 76445679, "body": "This example is far from minimal, you should try cutting it down. Presumably (I haven&#39;t looked at all the code) you haven&#39;t done something silly like type the variable <code>bsd_jpg</code> without defining it somewhere, in which case your splices are generating bad code. Use <code>-ddump-splices</code> to see the actual output of the splices, and search for occurences of <code>bsd_jpg</code>. My guess is the splice containing <code>&quot;@{StaticR bsd_jpg}&quot;</code> is the culprit."}], "answers": [{"comments": [{"owner": {"reputation": 234, "user_id": 6475907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-xQd4dCvGOmg/AAAAAAAAAAI/AAAAAAAAABo/WuJS4WB_RNg/photo.jpg?sz=128", "display_name": "WellTyped", "link": "https://stackoverflow.com/users/6475907/welltyped"}, "edited": false, "score": 0, "creation_date": 1498338556, "post_id": 44734366, "comment_id": 76463142, "body": "wow really! I have no idea of the limitation of Template Haskell"}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 3, "last_activity_date": 1498291822, "creation_date": 1498291822, "answer_id": 44734366, "question_id": 44729207, "link": "https://stackoverflow.com/questions/44729207/yesod-static-file-type-safe-route-variable-not-in-scope/44734366#44734366", "title": "Yesod static file type safe route variable not in scope", "body": "<p>I don't see where you do</p>\n\n<pre><code>import Yesod.Static (staticFiles)\n\n-- This generates easy references to files in the static directory at compile time,\n-- giving you compile-time verification that referenced files exist.\n-- Warning: any files added to your static directory during run-time can't be\n-- accessed this way. You'll have to use their FilePath or URL to access them.\n--\n-- For example, to refer to @static/js/script.js@ via an identifier, you'd use:\n--\n--     js_script_js\n--\n-- If the identifier is not available, you may use:\n--\n--     StaticFile [\"js\", \"script.js\"] []\n\nstaticFiles (appStaticDir compileTimeAppSettings)\n</code></pre>\n\n<p>This code is taken from default sqlite-based Yesod scaffold. I'd recommend you to start with it (<code>stack templates</code> + <code>stack new &lt;selected-template&gt;</code>), if you are just starting playing with Yesod.</p>\n\n<p>Note that <code>staticFiles</code> is a Template Haskell function, and there are some limitations when using these. Specifically, you can't use generated code from the same .hs file it was generated.</p>\n"}], "owner": {"reputation": 234, "user_id": 6475907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-xQd4dCvGOmg/AAAAAAAAAAI/AAAAAAAAABo/WuJS4WB_RNg/photo.jpg?sz=128", "display_name": "WellTyped", "link": "https://stackoverflow.com/users/6475907/welltyped"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 1, "accepted_answer_id": 44734366, "answer_count": 1, "score": 2, "last_activity_date": 1498291822, "creation_date": 1498248427, "last_edit_date": 1498283438, "question_id": 44729207, "link": "https://stackoverflow.com/questions/44729207/yesod-static-file-type-safe-route-variable-not-in-scope", "title": "Yesod static file type safe route variable not in scope", "body": "<p>In below code, I have an image in the static folder: bsd.jpg.\nIn the ajax success method I want to point the img src to a static image and show it. I couldn't figure out why I run this code and get an error:</p>\n\n<pre><code>upload.hs:91:22: error: Variable not in scope: bsd_jpg :: Route Static \n\n#!/usr/bin/env stack\n{- stack\n     --resolver lts-8.19\n     --install-ghc\n     runghc\n     --package yesod\n     --package yesod-static\n     --package persistent-sqlite\n -}\n\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE QuasiQuotes #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE ViewPatterns #-}\n\nimport Yesod\nimport Yesod.Static\nimport Data.Time (UTCTime)\nimport System.FilePath\nimport System.Directory (removeFile, doesFileExist, createDirectoryIfMissing)\nimport Control.Applicative ((&lt;$&gt;), (&lt;*&gt;))\nimport Control.Monad.Logger (runStdoutLoggingT)\nimport Data.Conduit\nimport qualified Data.Text as T\nimport Data.Text (unpack)\nimport qualified Data.ByteString.Lazy as DBL\nimport Data.Conduit.List (consume)\nimport Database.Persist\nimport Database.Persist.Sqlite\nimport Data.Time (getCurrentTime)\nimport qualified Data.Conduit.Text as CT\nimport qualified Data.Conduit.List as CL\n\nshare [mkPersist sqlSettings,mkMigrate \"migrateAll\"] [persistUpperCase|\nImage\n    filename String\n    description Textarea Maybe\n    date UTCTime\n    deriving Show\n|]\n\ndata App = App\n    { getStatic :: Static -- ^ Settings for static file serving.\n    , connPool  :: ConnectionPool\n    }\n\nmkYesod \"App\" [parseRoutes|\n/ ImagesR GET POST\n/image/#ImageId ImageR DELETE\n/static StaticR Static getStatic\n/echo-body EchoBodyR PUT\n|]\n\ninstance Yesod App where\n    maximumContentLength _ (Just ImagesR) = Just $ 200 * 1024 * 1024 -- 200 megabytes\n    maximumContentLength _ _ = Just $ 10 * 1024 * 1024 -- 10 megabytes\n\ninstance YesodPersist App where\n    type YesodPersistBackend App = SqlBackend\n    runDB action = do\n        App _ pool &lt;- getYesod\n        runSqlPool action pool\n\ninstance RenderMessage App FormMessage where\n    renderMessage _ _ = defaultFormMessage\n\nuploadDirectory :: FilePath\nuploadDirectory = \"static\"\n\nuploadForm :: Html -&gt; MForm Handler (FormResult (FileInfo, Maybe Textarea, UTCTime), Widget)\nuploadForm = renderBootstrap $ (,,)\n    &lt;$&gt; fileAFormReq \"Image file\"\n    &lt;*&gt; aopt textareaField \"Image description\" Nothing\n    &lt;*&gt; lift (liftIO getCurrentTime)\n\naddStyle :: Widget\naddStyle = do\n    -- Twitter Bootstrap\n    addStylesheetRemote \"http://netdna.bootstrapcdn.com/twitter-bootstrap/2.1.0/css/bootstrap-combined.min.css\"\n    addStylesheetRemote \"https://www.w3schools.com/w3css/4/w3.css\"\n    -- message style\n    toWidget [lucius|.message { padding: 10px 0; background: #ffffed; } |]\n    -- jQuery\n    addScriptRemote \"http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js\"\n    -- delete function\n    toWidget [julius|\n$(function(){\n    function confirmDelete(link) {\n        if (confirm(\"Are you sure you want to delete this image?\")) {\n            deleteImage(link);\n        };\n    }\n    function deleteImage(link) {\n        $.ajax({\n            type: \"DELETE\",\n            url: link.attr(\"data-img-url\"),\n        }).done(function(msg) {\n            var table = link.closest(\"table\");\n            link.closest(\"tr\").remove();\n            var rowCount = $(\"td\", table).length;\n             if (rowCount === 0) {\n                table.remove();\n            }\n        });\n    }\n\n    $(\"#screenshot\").click(function(){\n   $.ajax({\n            // sending a JSON encoded body\n            contentType: \"application/json\",\n            // don't process the body, we'll render data into a valid string\n            processData: false,\n            url: \"@{EchoBodyR}\",\n            type: \"PUT\",\n            // notice the usage of stringify here\n            data: JSON.stringify([{name:\"Alice\",age:25}, {name:\"Bob\",age:30}]),\n            success: function(data) {\n                alert(data.body);\n                $(\"#screenshot-pic\").attr(\"src\",\"@{StaticR bsd_jpg}\");\n\n            },\n            // this only refers to the data type of the *returned* data\n            dataType: \"json\"\n        });\n\n     return false;\n    });\n\n    $(\"a.delete\").click(function() {\n        confirmDelete($(this));\n        return false;\n    });\n});\n|]\nputEchoBodyR :: Handler Value\nputEchoBodyR = do\n    texts &lt;- rawRequestBody $$ CT.decode CT.utf8 =$ CL.consume\n    return $ object [\"body\" .= T.concat texts]\n\n\ngetImagesR :: Handler Html\ngetImagesR = do\n    ((_, widget), enctype) &lt;- runFormPost uploadForm\n    images &lt;- runDB $ selectList [ImageFilename !=. \"\"] [Desc ImageDate]\n    mmsg &lt;- getMessage\n    defaultLayout $ do\n        addStyle\n        [whamlet|$newline never\n$maybe msg &lt;- mmsg\n    &lt;div .message&gt;\n        &lt;div .container&gt;\n            #{msg}\n&lt;div .container&gt;\n    &lt;div .row&gt;\n        &lt;h2&gt;\n            Upload new image\n\n        &lt;button #screenshot class=\"w3-button w3-teal\"&gt;Screenshot\n\n        &lt;img #screenshot-pic class=\"w3-round\"&gt;\n\n        &lt;div .form-actions&gt;\n            &lt;form method=post enctype=#{enctype}&gt;\n                ^{widget}\n                &lt;input .btn type=submit value=\"Upload\"&gt;\n        $if not $ null images\n            &lt;table .table&gt;\n                &lt;tr&gt;\n                    &lt;th&gt;\n                        Image\n                    &lt;th&gt;\n                        Decription\n                    &lt;th&gt;\n                        Uploaded\n                    &lt;th&gt;\n                        Action\n                $forall Entity imageId image &lt;- images\n                    &lt;tr&gt;\n                        &lt;td&gt;\n                            &lt;a href=#{imageFilePath $ imageFilename image}&gt;\n                                #{imageFilename image}\n                        &lt;td&gt;\n                            $maybe description &lt;- imageDescription image\n                                #{description}\n                        &lt;td&gt;\n                            #{show $ imageDate image}\n                        &lt;td&gt;\n                            &lt;a href=# .delete data-img-url=@{ImageR imageId}&gt;\n                                delete\n\n|]\n\npostImagesR :: Handler Html\npostImagesR = do\n    ((result, widget), enctype) &lt;- runFormPost uploadForm\n    case result of\n        FormSuccess (file, info, date) -&gt; do\n            -- TODO: check if image already exists\n            -- save to image directory\n            filename &lt;- writeToServer file\n            _ &lt;- runDB $ insert (Image filename info date)\n            setMessage \"Image saved\"\n            redirect ImagesR\n        _ -&gt; do\n            setMessage \"Something went wrong\"\n            redirect ImagesR\n\ndeleteImageR :: ImageId -&gt; Handler ()\ndeleteImageR imageId = do\n    image &lt;- runDB $ get404 imageId\n    let filename = imageFilename image\n        path = imageFilePath filename\n    liftIO $ removeFile path\n    -- only delete from database if file has been removed from server\n    stillExists &lt;- liftIO $ doesFileExist path\n\n    case (not stillExists) of \n        False  -&gt; redirect ImagesR\n        True -&gt; do\n            runDB $ delete imageId\n            setMessage \"Image has been deleted.\"\n            redirect ImagesR\n\nwriteToServer :: FileInfo -&gt; Handler FilePath\nwriteToServer file = do\n    let filename = unpack $ fileName file\n        path = imageFilePath filename\n    liftIO $ fileMove file path\n    return filename\n\nimageFilePath :: String -&gt; FilePath\nimageFilePath f = uploadDirectory &lt;/&gt; f\n\nopenConnectionCount :: Int\nopenConnectionCount = 10\n\nmain :: IO ()\nmain = do\n    pool &lt;- runStdoutLoggingT $ createSqlitePool \"images.db3\" openConnectionCount\n    runSqlPool (runMigration migrateAll) pool\n    -- Get the static subsite, as well as the settings it is based on\n    createDirectoryIfMissing True uploadDirectory\n    static@(Static settings) &lt;- static uploadDirectory\n    warp 3000 $ App static pool\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1498256103, "post_id": 44729771, "comment_id": 76444030, "body": "First of all, I need to closure this set. Second, I do not need package names, I need a list of libraries in these packages with paths to them. <code>stack list-dependencies</code> it&#39;s just first stem in my script."}, {"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 0, "creation_date": 1498276000, "post_id": 44729771, "comment_id": 76447415, "body": "stack list-dependencies does yield all dependencies, so it shouldn&#39;t be necessary to recurse.  You will indeed need to consult ghc-pkg for the library path."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1498276776, "post_id": 44729771, "comment_id": 76447518, "body": "@freestyle then it&#39;s unclear what you&#39;re asking. &quot;list of libraries in these packages&quot;: do you mean list of modules? Every package has at most one library. Your question doesn&#39;t mention paths at all"}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": true, "score": 0, "last_activity_date": 1498251126, "creation_date": 1498251126, "answer_id": 44729771, "question_id": 44729092, "link": "https://stackoverflow.com/questions/44729092/how-to-transitive-get-a-list-of-libraries-on-which-a-certain-project-depends/44729771#44729771", "title": "How to transitive get a list of libraries on which a certain project depends?", "body": "<pre><code>$ stack list-dependencies\nMonadPrompt 1.0.0.5\nMonadRandom 0.4\nStateVar 1.1.0.1\n...\n</code></pre>\n\n<p>For cabal projects try <code>cabal freeze --help</code></p>\n"}], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 44729771, "answer_count": 1, "score": 1, "last_activity_date": 1498257005, "creation_date": 1498247893, "last_edit_date": 1498257005, "question_id": 44729092, "link": "https://stackoverflow.com/questions/44729092/how-to-transitive-get-a-list-of-libraries-on-which-a-certain-project-depends", "title": "How to transitive get a list of libraries on which a certain project depends?", "body": "<p>I'm primarily interested in this issue for projects built on the basis of the <em>stack</em>.</p>\n\n<p>I managed to solve this problem by writing a script that analyzes the output of the command like <code>ghc-pkg field SOMEPKG hs-libraries</code> etc.</p>\n\n<p>But this approach is rather slow, mainly due to the use of <em>stack</em> command for extract information from a project.</p>\n\n<p>Is there another way to solve this issue without using a lot of tools?</p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<hr>\n\n<p>This is draft of script.</p>\n\n<pre><code>main = do\n    pkgSet &lt;- newIORef . asHashSet $ mempty\n    libSet &lt;- newIORef . asHashSet $ mempty\n    let proc ghcId pkgId = do\n            guard =&lt;&lt; (liftIO . map (pkgId `notMember`) . readIORef $ pkgSet)\n            liftIO . modifyIORef pkgSet $ insertSet pkgId\n\n            libDir1 &lt;- lineToText &lt;$&gt; inproc \"ghc-pkg\"\n                [\"--simple-output\", \"field\", pkgId, \"dynamic-library-dirs\"]\n                (pure \"\")\n            libDir2 &lt;- lineToText &lt;$&gt; inproc \"ghc-pkg\"\n                [\"--simple-output\", \"field\", pkgId, \"library-dirs\"] (pure \"\")\n            libDir &lt;- select . filter (not . null) $ [libDir1, libDir2]\n            lib &lt;- select =&lt;&lt; (map (words . lineToText) $ inproc \"ghc-pkg\"\n                [\"--simple-output\", \"field\", pkgId, \"hs-libraries\"] (pure \"\"))\n            let libPath = asText . repack $ repack libDir\n                      &lt;/&gt; (shlibPrefix ++ repack lib ++ \"-\" ++ repack ghcId)\n                      &lt;.&gt; shlibSuffix\n\n            guard =&lt;&lt; (liftIO . map (libPath `notMember`) . readIORef $ libSet)\n            guard =&lt;&lt; (liftIO . doesFileExist . repack $ libPath)\n            liftIO . modifyIORef libSet $ insertSet libPath\n\n            dep &lt;- select =&lt;&lt; (map (words . lineToText) $ inproc \"ghc-pkg\"\n                [\"--simple-output\", \"field\", pkgId, \"depends\"] (pure \"\"))\n            proc ghcId dep\n    sh $ do\n        ghcPkgPath &lt;- lineToText &lt;$&gt; inshell \"stack path --ghc-package-path\" (pure \"\")\n        export \"GHC_PACKAGE_PATH\" ghcPkgPath\n\n        ghcVer &lt;- lineToText &lt;$&gt; inshell \"stack exec -- ghc --numeric-version\" (pure \"\")\n        let ghcId = \"ghc\" ++ ghcVer\n\n        [pkg, ver] &lt;- words . lineToText &lt;$&gt; inshell \"stack list-dependencies\" (pure \"\")\n        let pkgId = pkg ++ \"-\" ++ ver\n        proc ghcId pkgId\n    -- processing libSet\n</code></pre>\n"}, {"tags": ["haskell", "main", "do-notation"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1498242459, "post_id": 44727803, "comment_id": 76438182, "body": "<code>main</code> - yes. But <code>do</code> is a part of the body, which may or may not be there. See <a href=\"https://www.schoolofhaskell.com/school/starting-with-haskell/basics-of-haskell/2-my-first-program#the-main-function\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 243, "user_id": 13679816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b02acae66c6a347786eb93e8cbead85?s=128&d=identicon&r=PG", "display_name": "atravers", "link": "https://stackoverflow.com/users/13679816/atravers"}, "edited": false, "score": 0, "creation_date": 1613525287, "post_id": 44727803, "comment_id": 117099784, "body": "<code>main = putStrLn &quot;It depends on how large &#39;main&#39; is.&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1498247759, "post_id": 44727955, "comment_id": 76440810, "body": "In Haskell the word &quot;monad&quot; refers to types (like <code>IO</code>), not values (like <code>main</code>)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498263506, "post_id": 44727955, "comment_id": 76445709, "body": "Strictly speaking, the entry point to a Haskell program must not be named <code>main</code> (you can change this by passing <code>-main-is &lt;symbol&gt;</code>) but of course that is not the focus of the question."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498448306, "post_id": 44727955, "comment_id": 76486647, "body": "@user2407038 Strictly speaking, is it still a Haskell program or a not-quite-Haskell program?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551634225, "post_id": 44727955, "comment_id": 96702570, "body": "The main reason to use anything other than <code>()</code> is to communicate that the program only exits either explicitly or by receiving an exception. In that case, it can an be given a polymorphic type, <code>IO a</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 12, "last_activity_date": 1498248012, "last_edit_date": 1498248012, "creation_date": 1498242943, "answer_id": 44727955, "question_id": 44727803, "link": "https://stackoverflow.com/questions/44727803/does-the-main-function-in-haskell-always-start-with-main-do/44727955#44727955", "title": "Does the main-function in Haskell always start with main = do?", "body": "<p><strong>Short answer</strong>: <strong>No</strong>, we have to declare a <code>main =</code>, but <em>not</em> a <code>do</code>.</p>\n\n<p>The <strong><code>main</code> must be an <em>IO monad</em> type</strong> (so <code>IO a</code>) where <code>a</code> is arbitrary (since it is ignored), as is written <a href=\"https://www.haskell.org/tutorial/io.html\" rel=\"noreferrer\">here</a>:</p>\n\n<blockquote>\n  <p>The use of the name <code>main</code> is important: <code>main</code> is defined to be the entry point of a Haskell program (similar to the <code>main</code> function in C), and must <strong>have an <code>IO</code> type</strong>, usually <code>IO ()</code>.</p>\n</blockquote>\n\n<p>But you do not necessary need <code>do</code> notation. Actually <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"noreferrer\"><strong><code>do</code> is <em>syntactical sugar</em></strong></a>. Your <code>main</code> is in fact:</p>\n\n<pre><code>main =\n    putStrLn \"What's your name?\" &gt;&gt; getLine &gt;&gt;= \\n -&gt; putStrLn (\"Hello \" ++ n)\n</code></pre>\n\n<p>Or more elegantly:</p>\n\n<pre><code>main = putStrLn \"What's your name?\" &gt;&gt; getLine &gt;&gt;= putStrLn . (\"Hello \" ++)\n</code></pre>\n\n<p>So here we have written a <code>main</code> without <code>do</code> notation. For more about <em>desugaring</em> <code>do</code> notation, see <a href=\"https://stackoverflow.com/questions/8019670/desugaring-do-notation-for-monads\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1606266160, "post_id": 44728131, "comment_id": 114911071, "body": "Actually do notation supports 3 types of statements: Bindings (the ones with &lt;-), let statements (the ones with let without an &quot;in&quot;) and pure monad expressions (the ones with neither). Only the last of these is permitted as the last statement."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 1, "creation_date": 1606289176, "post_id": 44728131, "comment_id": 114916015, "body": "it says &quot;The <i>simplified</i> <code>do</code>-syntax&quot; in the answer (emphasis added). You do not introduce something with its full specification. Sometimes best way to introduce something is with little lies even (which is also the case here because <code>do</code> works even for non-monadic values in corner cases, like <code>do 1</code>). the <code>do</code> <code>let</code> can always be rewritten as normal <code>let</code>, and the non-binding monadic value <code>do</code> statement, to a <code>_ &lt;-</code> binding one. the answer even says &quot;the <code>_ &lt;-</code> part can be omitted altogether&quot;."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 1, "creation_date": 1606292316, "post_id": 44728131, "comment_id": 114917207, "body": "as for what&#39;s allowed as the last statement in a <code>do</code> block, my answer goes further and suggests always ending it with a <code>return ...</code>, as a <i>simplification</i>. which is always valid, too, thanks to the monad laws. @PaulStelian"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 4, "last_activity_date": 1603455011, "last_edit_date": 1603455011, "creation_date": 1498243682, "answer_id": 44728131, "question_id": 44727803, "link": "https://stackoverflow.com/questions/44727803/does-the-main-function-in-haskell-always-start-with-main-do/44728131#44728131", "title": "Does the main-function in Haskell always start with main = do?", "body": "<p>Yes, <em>if</em> you have more than one line in your <code>do</code> block, and <em>if</em> you are even using the <code>do</code> notation.</p>\n<p>The full <code>do</code>-notation syntax also includes explicit separators -- curly braces and semicolons:</p>\n<pre><code>main = do { putStrLn &quot;What's your name?&quot; \n          ; name &lt;- getLine  \n          ; putStrLn (&quot;Hello &quot; ++ name) \n          }\n</code></pre>\n<p>With them, indentation plays no role other than in coding style (good indentation improves readability; explicit separators ensure code robustness, remove white-space related brittleness). So when you have only one line of IO-code, like</p>\n<pre><code>main = do { print &quot;Hello!&quot; }\n</code></pre>\n<p>there are no semicolons, no indentation to pay attention to, and the curly braces and <code>do</code> keyword itself become redundant:</p>\n<pre><code>main = print &quot;Hello!&quot; \n</code></pre>\n<p>So, no, not always. But very often it does, and uniformity in code goes a long way towards readability.</p>\n<hr />\n<p><code>do</code> blocks translate into monadic code, but you can view this fact as implementational detail, at first. In fact, you should. You can treat the <code>do</code> notation <em>axiomatically</em>, as an embedded language, mentally. Besides, it is that, anyway.</p>\n<p>The simplified <code>do</code>-syntax is:</p>\n<pre><code>   do {  pattern<sub>1</sub> &lt;- action<sub>1</sub>\n      ;  pattern<sub>2</sub> &lt;- action<sub>2</sub>\n      .....................\n      ;  return (.....)\n      }</code></pre>\n<p>Each <code>action<sub>i</sub></code> is a Haskell value of type <code>M a<sub>i</sub></code> for some monad <code>M</code> and some result type <code>a<sub>i</sub></code>. Each <code>action</code> produces its own result type <code>a<sub>i</sub></code> while <em>all</em> <code>action</code>s must belong to the <em>same</em> monad type <code>M</code>.</p>\n<p>Each <code>pattern<sub>i</sub></code> receives the previously &quot;computed&quot; result from the corresponding action.</p>\n<p>Wildcards <code>_</code> can be used to ignore it. If this is the case, the <code>_ &lt;-</code> part can be omitted altogether.</p>\n<hr />\n<p>&quot;Monad&quot; is a scary and non-informative word, but it is really nothing more than EDSL, conceptually. <em>Embedded</em> domain-specific language means that we have native Haskell values standing for (in this case) <em>I/O computations</em>. We write our <em>I/O</em> programs in this language, which become a native Haskell value(s), which we can operate upon as on any other native Haskell value -- collect them in lists, compose them into more complex computation descriptions (programs), etc.</p>\n<p>The <code>main</code> value is one such value computed by our Haskell program. The compiler sees it, and performs the <em>I/O</em> program that it stands for, at run time.</p>\n<p>The point to it is that we can now have a &quot;function&quot; <code>getCurrentTime</code> (impossible, on the face of it, in functional paradigm since it must return different results on separate invocations), because it <em>is not</em> returning the current time -- the action it describes <em>will</em> do so, when the <em>I/O</em> program it <em>describes</em> is run by the run-time system.</p>\n<p>On the type level this is reflected by such values not having just some plain Haskell type <code>a</code>, but a parameterized type, <code>IO a</code>, &quot;tagged&quot; by <code>IO</code> as belonging to this special world of <em>I/O</em> programming.</p>\n<p>See also: <a href=\"https://stackoverflow.com/a/44118041/849891\">Why does haskell's bind function take a function from non-monadic to monadic</a>.</p>\n"}], "owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2622, "favorite_count": 1, "accepted_answer_id": 44727955, "answer_count": 2, "score": 6, "last_activity_date": 1603455011, "creation_date": 1498242359, "last_edit_date": 1551630992, "question_id": 44727803, "link": "https://stackoverflow.com/questions/44727803/does-the-main-function-in-haskell-always-start-with-main-do", "title": "Does the main-function in Haskell always start with main = do?", "body": "<p>In java we always write:</p>\n\n<pre><code>public static void main(String[] args){...}\n</code></pre>\n\n<p>when we want to start writing a program.</p>\n\n<p><strong>My question is, is it the same for Haskell, IE: can I always be sure to declare:\nmain = do, when I want to write code for a program in Haskell?</strong></p>\n\n<p>for example:</p>\n\n<pre><code>main = do  \n    putStrLn \"What's your name?\"  \n    name &lt;- getLine \n    putStrLn (\"Hello \" ++ name) \n</code></pre>\n\n<p>This program is going to ask the user \"What's your name?\"\nthe user input will then be stored inside of the name-variable, and\n\"Hello\" ++ name will be displayed before the program terminates.</p>\n"}, {"tags": ["haskell", "functional-programming", "guard-statement"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 7, "creation_date": 1498235925, "post_id": 44726201, "comment_id": 76434851, "body": "A <i>guard</i> decides who can come in, and who stays out. So the condition decides if the expression &quot;fires&quot;."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1498243869, "post_id": 44726201, "comment_id": 76438917, "body": "On the close votes: the question (&quot;Was Dijkstra the first to use the term &#39;guard&#39;?&quot;) is neither broad nor opinion-based. I&#39;m not sure whether computing history questions are on-topic or not. I&#39;m leaning towards not, but in any case the question clearly is not about general computing hardware and software (and would probably be <i>even more</i> off-topic on SuperUser than it is here). So I squint at all of the close votes that exist so far."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1498244109, "post_id": 44726201, "comment_id": 76439047, "body": "not SASL, KRC ."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1498246226, "post_id": 44726201, "comment_id": 76440045, "body": "guards are not much different from plain conditionals. and these already were in the (largely ignored) Plankalk&#252;l (although Wikipedia says it influenced Algol 58)."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1498287908, "post_id": 44731311, "comment_id": 76449510, "body": "I think it&#39;s pointless to claim that someone&#39;s curiosity is pointless"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1498305479, "post_id": 44731311, "comment_id": 76453643, "body": "<code>(cond ((even? 2) =&gt; (lambda (b) ...)) (else ... ;|b is not in scope here|; ...))</code>. potayto, potahto. :) &quot;not much different&quot; =/= &quot;exactly the same&quot;. --- Looked at from sufficiently afar, everything resembles everything else. (&quot;huh, those hadron-based objects aren&#39;t that much different from one another&quot;, says an energy-based lifeform looking at a human and a tree ...)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1498305654, "post_id": 44731311, "comment_id": 76453689, "body": "(BTW the @ ping does not work from the post body, only from the comments)"}], "tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": false, "score": 0, "last_activity_date": 1498261257, "creation_date": 1498261257, "answer_id": 44731311, "question_id": 44726201, "link": "https://stackoverflow.com/questions/44726201/why-guards-are-called-guards/44731311#44731311", "title": "Why guards are called &#39;guards&#39;?", "body": "<p>I think it's pointless asking where terminology comes from. (For example why does Haskell have 'types' and 'kinds', whereas math has 'sorts'?) The wikipedia article is good.</p>\n\n<p>The style of writing guards to the right does mirror maths (the wikipedia article has an example). That's probably what influenced Dijkstra. And there's the same mathematical style in Strachey 1967 'Fundamental Concepts'. (He doesn't use \"guard\".)</p>\n\n<p>@Will Ness <i>guards are not much different from plain conditionals</i> is not right. So it's good to have a different word than \"condition\". Guards come after pattern-matching:</p>\n\n<pre><code>case x of\n  (Maybe x') | x' &gt; 0 -&gt; ...\n  Nothing {- x' not in scope here -} -&gt; ...\n</code></pre>\n\n<p>In a case branch: first match the pattern, and that binds variables; then apply guards using the variables.</p>\n\n<p>And you can extend the idea to the type level <a href=\"https://github.com/AntC2/ghc-proposals/blob/instance-apartness-guards/proposals/0000-instance-apartness-guards.rst\" rel=\"nofollow noreferrer\">https://github.com/AntC2/ghc-proposals/blob/instance-apartness-guards/proposals/0000-instance-apartness-guards.rst</a></p>\n"}, {"tags": [], "owner": {"reputation": 13920, "user_id": 3404097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e38747633941acae3957fd99b5ebe20?s=128&d=identicon&r=PG&f=1", "display_name": "philipxy", "link": "https://stackoverflow.com/users/3404097/philipxy"}, "is_accepted": false, "score": 0, "last_activity_date": 1508695587, "creation_date": 1508695587, "answer_id": 46877500, "question_id": 44726201, "link": "https://stackoverflow.com/questions/44726201/why-guards-are-called-guards/46877500#46877500", "title": "Why guards are called &#39;guards&#39;?", "body": "<p>Yes, the term is from Dijkstra. <a href=\"http://spinroot.com/courses/summer/Papers/dijkstra_1975.pdf\" rel=\"nofollow noreferrer\">Guarded commands, non-determinacy and formal derivation of programs (CACM 1975)</a></p>\n\n<p>It's ironically hilarious that the <a href=\"https://en.wikipedia.org/wiki/Guard_(computer_science)\" rel=\"nofollow noreferrer\">Wikipedia article Guard (computer science)</a> says \"Guard code provides an early exit from a subroutine, and is a commonly used deviation from structured programming\", lacking a fundamental appreciation of guards &amp; structured programming, since the term became important because Dijkstra's guards were a fundamental &amp; influential contribution to structured programming.</p>\n"}], "owner": {"reputation": 41, "user_id": 8199029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6342d85599b2924b056e24fc155f086?s=128&d=identicon&r=PG&f=1", "display_name": "alex_why", "link": "https://stackoverflow.com/users/8199029/alex-why"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1508695587, "creation_date": 1498235653, "last_edit_date": 1498241008, "question_id": 44726201, "link": "https://stackoverflow.com/questions/44726201/why-guards-are-called-guards", "title": "Why guards are called &#39;guards&#39;?", "body": "<p>Does anyone know what is the origin of the name for the construct called <strong>guards</strong>?</p>\n\n<pre><code>func x\n    | cond1 -&gt; expr1  \n    ...\n    | condN -&gt; exprN\n</code></pre>\n\n<p>Wikipedia article <a href=\"https://en.wikipedia.org/wiki/Guard_(computer_science)\" rel=\"nofollow noreferrer\"> Guard_(computer_science)</a> gives some historical perspective, but lacks explanation for where name came from (it just mentions that SASL was one of the first to use the name).</p>\n\n<p>So far I found references to Edsger Dijkstra and his Guarded Command Language. Was he first to use the term 'guard'?</p>\n"}, {"tags": ["haskell", "garbage-collection", "heap-memory"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498237209, "post_id": 44725809, "comment_id": 76435569, "body": "Just because memory is garbage collected by the Haskell runtime, doesn&#39;t mean your operating system will promptly free those pages (and really, it shouldn&#39;t - unless another process on your system needs that memory, nothing is gained by immediately freeing them); and there is no rule that a page freed by a process must be reused by that process, as opposed to giving that process a brand new page. This has to do with your OS, so you should tag it as such.As for your 2nd question (&quot;how can I keep the resident memory usage down&quot;) - nobody can answer that without access to the program in question."}], "owner": {"reputation": 273, "user_id": 2152666, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eaba144e276b51f8a8b96b3fef0be45a?s=128&d=identicon&r=PG", "display_name": "Charles Cooper", "link": "https://stackoverflow.com/users/2152666/charles-cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498234032, "creation_date": 1498234032, "question_id": 44725809, "link": "https://stackoverflow.com/questions/44725809/haskell-resident-memory-much-higher-than-profiled-heap-memory", "title": "Haskell - Resident memory much higher than profiled heap memory", "body": "<p>I have a program which I am running with something like</p>\n\n<pre><code>stack exec -- foo +RTS -A256M -H256M -M1G -S -RTS\n</code></pre>\n\n<p>The <code>-S</code> flag causes a line like follows to print out</p>\n\n<pre><code>208797032  75072552 114619448  0.356  0.028   12.876   16.122    0    0  (Gen:  1)\n</code></pre>\n\n<p>This apparently means that the RTS thinks the program's live byte usage is around <code>100MB</code>. However, <code>htop</code> reports that the program pegging over <code>1.4GB</code>(!) of resident memory.</p>\n\n<p>First of all, how come the resident memory is going past the max heap size that I set?</p>\n\n<p>Second, what is causing this discrepancy and how can I keep the resident memory usage down?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1498232567, "post_id": 44725206, "comment_id": 76432934, "body": "To explain on \u201cweird <code>Num</code> instance\u201d \u2013 all the standard types in <code>Prelude</code> have commutative addition, hence <code>x + 100</code> is always the same as <code>100 + x</code>, and <code>\\x -&gt; 100 + x</code> is what can be made point-free as <code>(+) 100</code>. However, Haskell allows to define new types with <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#t:Num\" rel=\"nofollow noreferrer\"><code>Num</code> instances</a> that behave entirely different, and not satisfy <code>100 + x \u2261 x + 100</code>. That would usually be a bad idea. For multiplication, <code>x * y \u2260 y * x</code> actually makes sense in some contexts, e.g. <a href=\"https://en.wikipedia.org/wiki/Quaternion\" rel=\"nofollow noreferrer\">quaternions</a>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1498232054, "creation_date": 1498232054, "answer_id": 44725206, "question_id": 44725132, "link": "https://stackoverflow.com/questions/44725132/can-i-write-a-lambda-function-in-pointfree-notation-in-haskell-if-so-how/44725206#44725206", "title": "Can I write a lambda function in pointfree notation in haskell? If so, how?", "body": "<p>You may write any of these, per your taste:</p>\n\n<pre><code>(+100)\n(+) 100 -- not 100% faithful if your Num instance is weird\nflip (+) 100\n</code></pre>\n\n<p>See also <a href=\"http://hackage.haskell.org/package/pointfree\" rel=\"noreferrer\">pointfree</a>, a tool for answering questions of this form automatically.</p>\n"}], "owner": {"reputation": 229, "user_id": 6130072, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01049fe6bbb7e9dc61f30864db556622?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/6130072/programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498232054, "creation_date": 1498231846, "question_id": 44725132, "link": "https://stackoverflow.com/questions/44725132/can-i-write-a-lambda-function-in-pointfree-notation-in-haskell-if-so-how", "title": "Can I write a lambda function in pointfree notation in haskell? If so, how?", "body": "<p>For example, if I want to convert: \\x -> x + 100, how do I write in pointfree notation? \\ -> id + 100 does not seem to work</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498230655, "post_id": 44724662, "comment_id": 76431829, "body": "This has nothing to do with GHCi in particular. The return type of <code>httpJSON</code> is polymorphic. Without additional type information (i.e., a use site for <code>x</code> which constrains it to a monomorphic type, or a type signature on <code>x</code>, or one on <code>httpJSON</code>) there is no way to infer the type. In the example, that information is provided by the fragment <code>(getResponseBody response :: Value)</code>. Try <code>x :: Response Value &lt;- ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "is_accepted": true, "score": 0, "last_activity_date": 1498248794, "creation_date": 1498248794, "answer_id": 44729291, "question_id": 44724662, "link": "https://stackoverflow.com/questions/44724662/using-network-http-simple-httpjson-in-ghci/44729291#44729291", "title": "Using Network.HTTP.Simple.httpJSON in ghci", "body": "<p>Thanks @user2407038's hint I figured out:</p>\n\n<pre><code>\u03bb&gt; :t liftM (\\x -&gt; getResponseBody x :: Value) (httpJSON \"http://httpbin.org/get\")\nliftM (\\x -&gt; getResponseBody x :: Value) (httpJSON \"http://httpbin.org/get\")\n  :: MonadIO m =&gt; m Value                                           \n\u03bb&gt; liftM (\\x -&gt; getResponseBody x :: Value) (httpJSON \"http://httpbin.org/get\")\nObject (fromList [(\"origin\",String \"158.181.77.67\"),(\"args\",Object (fromList [])),(\"url\",String \"http://httpbin.org/get\"),(\"headers\",Obj\ng \"close\"),(\"Host\",String \"httpbin.org\")]))])\n</code></pre>\n"}], "owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 44729291, "answer_count": 1, "score": 0, "last_activity_date": 1498248794, "creation_date": 1498230397, "question_id": 44724662, "link": "https://stackoverflow.com/questions/44724662/using-network-http-simple-httpjson-in-ghci", "title": "Using Network.HTTP.Simple.httpJSON in ghci", "body": "<p>The <a href=\"https://haskell-lang.org/library/http-client\" rel=\"nofollow noreferrer\">Receiving JSON</a> example works fine. But why the execution of <code>httpJSON</code> doesn't work in <code>ghci</code>?</p>\n\n<pre><code>\u03bb&gt; :set -XOverloadedStrings\n\u03bb&gt; import           Network.HTTP.Simple\n\u03bb&gt; :t httpJSON \"http://httpbin.org/get\"\n\u03bb&gt; x &lt;- httpJSON \"http://httpbin.org/get\"\n\n&lt;interactive&gt;:97:6: error:\n    \u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018httpJSON\u2019\n      prevents the constraint \u2018(aeson-1.0.2.1:Data.Aeson.Types.FromJSON.FromJSON\n                                  a0)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n      These potential instances exist:\n        instance aeson-1.0.2.1:Data.Aeson.Types.FromJSON.FromJSON Value\n          -- Defined in \u2018aeson-1.0.2.1:Data.Aeson.Types.FromJSON\u2019\n        instance (aeson-1.0.2.1:Data.Aeson.Types.FromJSON.FromJSON a,\n                  aeson-1.0.2.1:Data.Aeson.Types.FromJSON.FromJSON b) =&gt;\n                 aeson-1.0.2.1:Data.Aeson.Types.FromJSON.FromJSON (Either a b)\n          -- Defined in \u2018aeson-1.0.2.1:Data.Aeson.Types.FromJSON\u2019\n        instance aeson-1.0.2.1:Data.Aeson.Types.FromJSON.FromJSON Ordering\n          -- Defined in \u2018aeson-1.0.2.1:Data.Aeson.Types.FromJSON\u2019\n        ...plus 24 others\n        ...plus 53 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the first argument of \u2018GHC.GHCi.ghciStepIO ::\n                                  forall a. IO a -&gt; IO a\u2019, namely\n        \u2018httpJSON \"http://httpbin.org/get\"\u2019\n      In a stmt of an interactive GHCi command:\n        x &lt;- GHC.GHCi.ghciStepIO :: forall a. IO a -&gt; IO a\n             (httpJSON \"http://httpbin.org/get\")\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498230976, "post_id": 44724119, "comment_id": 76432052, "body": "There is no obvious, natural way to write this function with <code>takeWhile</code> and <code>iterate</code> (in my mind, at least). If anything, this is an exercise in mental gymnastics. Also note your 2nd function is not the same of the first - the first ignore odd values, and the second does not."}, {"owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498232062, "post_id": 44724119, "comment_id": 76432642, "body": "@user2407038 yeah, I misunderstood the nature of the exercise, hence my use of partition and concatenation."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1498229199, "last_edit_date": 1498229199, "creation_date": 1498229019, "answer_id": 44724217, "question_id": 44724119, "link": "https://stackoverflow.com/questions/44724119/idiomatic-haskell-using-takewhile-and-iterate/44724217#44724217", "title": "Idiomatic haskell using takewhile and iterate", "body": "<p>This actually has not much to do with <code>takeWhile</code>. You simply calculate the product here of <code>x-2</code> for every <em>even</em> number <code>x</code> in the given list. Indeed:</p>\n\n<pre><code>fun1 :: [Integer] -&gt; Integer\nfun1 [] = 1 -- the product of an empty list is 1\nfun1 (x:xs)\n  -- if the number is even, we multiply (x-2) with the remaining part\n  | even x = (x - 2) * fun1 xs\n  -- if the number is odd, we ignore x and return the fun1 of the tail\n  | otherwise = fun1 xs\n</code></pre>\n\n<p>So we can write it as:</p>\n\n<pre><code>fun1 :: Integral i =&gt; [i] -&gt; i\nfun1 = product . map (subtract 2) . filter even\n</code></pre>\n\n<p>In case you cannot use <code>product</code>, you can use - like you did in the question - use:</p>\n\n<pre><code>fun1 :: Integral i =&gt; [i] -&gt; i\nfun1 = foldl (*) 1 . map (subtract 2) . filter even\n</code></pre>\n\n<p>This is what we call a <em>pointfree</em> version: there are no parameters in the head of <code>fun1</code> or any lambda expressions. So we do not think in terms of values, but more in terms of functions.</p>\n\n<p>For a list <code>[1,3,4]</code>, this generates:</p>\n\n<pre><code>Prelude&gt; (foldl (*) 1 . map (subtract 2) . filter even) [1,3,4]\n2\n</code></pre>\n"}], "owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 44724217, "answer_count": 1, "score": 1, "last_activity_date": 1498229199, "creation_date": 1498228745, "last_edit_date": 1498228908, "question_id": 44724119, "link": "https://stackoverflow.com/questions/44724119/idiomatic-haskell-using-takewhile-and-iterate", "title": "Idiomatic haskell using takewhile and iterate", "body": "<p>I'm trying to learn Haskell by working my way through <a href=\"http://www.seas.upenn.edu/~cis194/spring13/lectures.html\" rel=\"nofollow noreferrer\">the CIS 194 course at the <em>University of Pennsylvania</em></a> course online. In one of the exercises the student is supposed to re-write a function:</p>\n\n<pre><code>fun1 :: [Integer] -&gt; Integer\nfun1 [] = 1\nfun1 (x:xs)\n  | even x = (x - 2) * fun1 xs\n  | otherwise = fun1 xs\n</code></pre>\n\n<p>Into a more 'idiomatic' haskell. I rewrote the function as</p>\n\n<pre><code>fun1 :: [Integer] -&gt; Integer\nfun1 xs =\n  let spl = partition even xs\n  in foldl (*) 1 ((map (subtract 2) (fst spl)) ++ snd spl)\n</code></pre>\n\n<p>which seems... lispy. It translates almost character for character into how I would write it in clojure. In the assignment it gives the hint to use <code>takeWhile</code> and <code>iterate</code> from Prelude to rewrite the function. While I understand superficially what those functions do, it was not immediately obvious to me how to rewrite that function to use them. How may this be rewritten using <code>takeWhile</code> and <code>iterate</code>?</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "evaluation", "forcing"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1498228662, "post_id": 44724012, "comment_id": 76430531, "body": "What gave you the impression that <code>$</code> forces evaluation? It does no such thing. <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:-36--33-\" rel=\"nofollow noreferrer\"><code>$!</code></a> does force evaluation (and then applies a function to the forced value)."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1498228739, "post_id": 44724012, "comment_id": 76430579, "body": "Also the type signature of thoe functions is quite different"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1498229037, "post_id": 44724012, "comment_id": 76430806, "body": "If you are struggling with lazy evaluation and when something is evaluated, I recommend firing up ghci and playing with <code>:sprint</code> also i think simon marlowe has got an informative section about this in his book <a href=\"http://chimera.labs.oreilly.com/books/1230000000929\" rel=\"nofollow noreferrer\">parallel and concurrent programming in haskell</a>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1498229519, "post_id": 44724012, "comment_id": 76431139, "body": "<code>$</code> does not evaluate anything at all. It is in fact an operator that does not much more than altering the priority of how things bind in Haskell."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1498230357, "post_id": 44724012, "comment_id": 76431681, "body": "<code>$</code> is a normal function which you could define yourself: <code>($) = \\f x -&gt; f x; infixr 0 $</code>. There is nothing special about it; every instance of <code>$</code> can be replaced by function application with no effect on semantics. <code>seq</code> is a deeply magical primitive which establishes an evaluation order (it does not <i>force</i> evaluation - that isn&#39;t a meaningful concept in Haskell)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1498308979, "post_id": 44724012, "comment_id": 76454592, "body": "<a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:seq\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.9.1.0/docs/&hellip;</a> says: &quot;<code>seq</code> is usually introduced to improve performance by avoiding unneeded laziness.  ---    A note on evaluation order: the expression <code>seq a b</code> <b>does not guarantee that <code>a</code> will be evaluated before <code>b</code></b>. The only guarantee given by <code>seq</code> is that both <code>a</code> and <code>b</code> will be evaluated before <code>seq</code> returns a value. In particular, this means that <code>b</code> may be evaluated before <code>a</code>.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "is_accepted": false, "score": 1, "last_activity_date": 1498229722, "creation_date": 1498229722, "answer_id": 44724418, "question_id": 44724012, "link": "https://stackoverflow.com/questions/44724012/what-is-the-difference-between-seq-and-in-haskell/44724418#44724418", "title": "What is the difference between seq and $ in haskell?", "body": "<p><code>seq</code> and <code>($)</code> have different type signatures:</p>\n\n<pre><code>\u03bb&gt; :t seq\nseq :: a -&gt; b -&gt; b\n\u03bb&gt; :t ($)\n($) :: (a -&gt; b) -&gt; a -&gt; b\n\u03bb&gt; (+1) `seq` 2\n2\n\u03bb&gt; (+1) $ 2\n3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "is_accepted": false, "score": 2, "last_activity_date": 1498235354, "last_edit_date": 1498235354, "creation_date": 1498233339, "answer_id": 44725588, "question_id": 44724012, "link": "https://stackoverflow.com/questions/44724012/what-is-the-difference-between-seq-and-in-haskell/44725588#44725588", "title": "What is the difference between seq and $ in haskell?", "body": "<p>Haskell is lazily evaluated by default. So a \"normal\" function with <code>seq</code>'s signature (<code>a -&gt; b -&gt; b</code>) would ignore its first argument and then return its second - it couldn't do anything else with either argument because it doesn't know what they are!</p>\n\n<p>But <code>seq</code> is a bit special and does something slightly different. Instead, it <em>strictly</em> evaluates its first argument and <em>then</em> returns its second argument. This is useful for a variety of purposes, such as forcing the order of side-effects, or for preventing large thunks from accumulating during a calculation. You can find out more info here: <a href=\"https://wiki.haskell.org/Seq\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Seq</a>.</p>\n\n<p>As @palik said, the type signature of <code>$</code> is completely different, and it does something different: it applies a function to an argument. The difference between <code>$</code> and ordinary function application is that it has very low operator precedence, which lets you avoid writing a lot of parentheses.</p>\n"}, {"comments": [{"owner": {"reputation": 229, "user_id": 6130072, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01049fe6bbb7e9dc61f30864db556622?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/6130072/programmer"}, "edited": false, "score": 0, "creation_date": 1498290802, "post_id": 44725853, "comment_id": 76450222, "body": "Thanks. But I am confused about: print $ take 10 $ map (* 2) $ filter even [1..]. If $ has low precedence, then why shouldn&#39;t it end up going to infinite loop, because it should evaluate filter even [1..] first, right?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 229, "user_id": 6130072, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01049fe6bbb7e9dc61f30864db556622?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/6130072/programmer"}, "edited": false, "score": 0, "creation_date": 1498303929, "post_id": 44725853, "comment_id": 76453243, "body": "@Programmer &quot;lower precedence&quot; refers to how an expression is <i>read</i>, or <i>parsed</i>. it means that the expression you&#39;ve shown is read/parsed actually as <code>print (take 10 (map (* 2) (filter even [1..])))</code>. It is <i>not</i> about the evaluation order. That is determined by each of the named entities&#39; <i>definitions</i>. The first is <code>print</code>, and it needs to know its argument, so <code>take 10</code> comes into play. <i>It</i> needs to know first 10 elements of <i>its</i> argument, <code>map (* 2) (filter even [1..])</code>, so <code>map (* 2)</code> comes into play, asking for the 10 first elements of <code>filter even [1..]</code> ... (not exactly,but approx)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 229, "user_id": 6130072, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01049fe6bbb7e9dc61f30864db556622?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/6130072/programmer"}, "edited": false, "score": 0, "creation_date": 1498308502, "post_id": 44725853, "comment_id": 76454434, "body": "@Programmer <code>seq</code> in <code>seq x y</code> (contrasted with <code>y</code>) can be seen as modifying the original <i>need</i> for <code>y</code> (if and when <code>y</code> is needed) to be saying &quot;I additionally need <code>x</code> as well&quot;."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 3, "last_activity_date": 1498234187, "creation_date": 1498234187, "answer_id": 44725853, "question_id": 44724012, "link": "https://stackoverflow.com/questions/44724012/what-is-the-difference-between-seq-and-in-haskell/44725853#44725853", "title": "What is the difference between seq and $ in haskell?", "body": "<p><code>($) :: (a -&gt; b) -&gt; a -&gt; b</code> takes a function and a value. It returns a thunk. When that thunk is forced, it produces the result of applying the function to the value.</p>\n\n<pre><code>&gt; let x = succ $ (2 :: Int)\n\n&gt; :sprint x\nx = _\n\n&gt; x\n3\n\n&gt; :sprint x\nx = 3\n</code></pre>\n\n<p><code>($)</code> is exactly equivalent to ordinary function application, but with lower operator precedence, which can be useful for avoiding some parentheses.</p>\n\n<pre><code>print (take 10 (map (* 2) (filter even [1..])))\n\nprint $ take 10 $ map (* 2) $ filter even [1..]\n</code></pre>\n\n<p><code>seq :: a -&gt; b -&gt; b</code> is very different: it arranges a <em>dependency</em> between its result and its first argument, so that when the result is forced, the first argument is evaluated first:</p>\n\n<pre><code>&gt; let y = succ (1 :: Int)\n\n&gt; :sprint y\ny = _\n\n&gt; let z = y `seq` (3 :: Int)\n\n&gt; :sprint z\nz = _\n\n&gt; z\n3\n\n&gt; :sprint z\nz = 3\n\n&gt; :sprint y\ny = 2\n</code></pre>\n\n<p>Here, <code>y</code> and <code>z</code> are initially unevaluated thunks. But evaluating <code>z</code> has the side effect of also evaluating <code>y</code>, because we\u2019ve arranged a dependency on <code>y</code> using <code>seq</code>. You can also observe the order of evaluation using <code>trace</code> from <code>Debug.Trace</code>:</p>\n\n<pre><code>&gt; import Debug.Trace\n\n&gt; (trace \"a evaluated\" ()) `seq` (trace \"b evaluated\" ())\na evaluated\nb evaluated\n()\n\n&gt; let p = (trace \"a evaluated\" (1 :: Int), trace \"b evaluated\" (2 :: Int))\n\n&gt; :sprint p\np = (_,_)\n\n&gt; snd p\nb evaluated\n2\n\n&gt; :sprint p\np = (_,2)\n\n&gt; fst p\na evaluated\n1\n\n&gt; :sprint p\np = (1,2)\n</code></pre>\n\n<p><code>seq</code> is a low-level operation that\u2019s mainly useful for performance reasons, because it lets you control when a thunk is evaluated. For example, <code>seq</code> is used in the definition of <code>foldl'</code> to ensure that the result of each step of the fold is evaluated before proceeding to the next step. Its lazy cousin <code>foldl</code> doesn\u2019t do this, so it often accumulates a deeply nested series of thunks, which can result in a stack overflow when evaluated.</p>\n"}], "owner": {"reputation": 229, "user_id": 6130072, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01049fe6bbb7e9dc61f30864db556622?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/6130072/programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1498247411, "creation_date": 1498228472, "last_edit_date": 1498247411, "question_id": 44724012, "link": "https://stackoverflow.com/questions/44724012/what-is-the-difference-between-seq-and-in-haskell", "title": "What is the difference between seq and $ in haskell?", "body": "<p>I am unable to understand the difference between <code>seq</code>, which forces evaluation, and <code>$</code>, which also does the same.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1498223537, "post_id": 44722328, "comment_id": 76426803, "body": "Beautiful would be to never have <code>&quot;2.0&quot;</code> as a <i>string</i>, in the first place... \u2014 but, <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Numeric.html#v:readInt\" rel=\"nofollow noreferrer\">both of these functions are</a> <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Numeric.html#v:readFloat\" rel=\"nofollow noreferrer\">available in <code>base</code>, in the <code>Numeric</code> module</a>."}, {"owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1498223725, "post_id": 44722328, "comment_id": 76426939, "body": "@leftaroundabout Are you referring to databases that store 2.0 with an appropriate numeric type? (Plain text csv files don&#39;t have that, but sure, I agree that that ain&#39;t beautiful.)"}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 4, "last_activity_date": 1498225255, "creation_date": 1498225255, "answer_id": 44722916, "question_id": 44722328, "link": "https://stackoverflow.com/questions/44722328/whats-a-good-way-to-convert-the-string-2-0-to-a-generic-fractional-and-2-to/44722916#44722916", "title": "What&#39;s a good way to convert the string &quot;2.0&quot; to a generic Fractional and &quot;2&quot; to a generic Num?", "body": "<p>In GHCI:</p>\n\n<pre><code>\u03bb&gt; read \"2.0\" :: (Read a, Fractional a) =&gt; a\n2.0\n\u03bb&gt; read \"2\" :: (Read a, Num a) =&gt; a\n2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 383, "user_id": 3024170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c69db72fd6a246ba01bc7fc71348835?s=128&d=identicon&r=PG&f=1", "display_name": "YoshikuniJujo", "link": "https://stackoverflow.com/users/3024170/yoshikunijujo"}, "is_accepted": false, "score": 3, "last_activity_date": 1498225403, "creation_date": 1498225403, "answer_id": 44722953, "question_id": 44722328, "link": "https://stackoverflow.com/questions/44722328/whats-a-good-way-to-convert-the-string-2-0-to-a-generic-fractional-and-2-to/44722953#44722953", "title": "What&#39;s a good way to convert the string &quot;2.0&quot; to a generic Fractional and &quot;2&quot; to a generic Num?", "body": "<p>I don't know whether it's beautiful or not. But, We can do as follows.</p>\n\n<pre><code>Prelude&gt; (fromInteger . read) \"2\"\n2\nPrelude&gt; :type it\nit :: Num c =&gt; c\nPrelude&gt; (fromRational . (toRational :: Double -&gt; Rational) . read) \"2.0\"\n2.0\nPrelude&gt; :type it\nit :: Fractional c =&gt; c\n</code></pre>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 44722916, "answer_count": 2, "score": 1, "last_activity_date": 1498225403, "creation_date": 1498223495, "last_edit_date": 1498223585, "question_id": 44722328, "link": "https://stackoverflow.com/questions/44722328/whats-a-good-way-to-convert-the-string-2-0-to-a-generic-fractional-and-2-to", "title": "What&#39;s a good way to convert the string &quot;2.0&quot; to a generic Fractional and &quot;2&quot; to a generic Num?", "body": "<p>In GHCi, we can do</p>\n\n<pre><code>ghci&gt; :t 2.0\n2.0 :: Fractional t =&gt; t\n</code></pre>\n\n<p>So it's natural to ask, how does one convert the string <code>\"2.0\"</code> (parsed from an external data source) into a <code>Fractional t =&gt; t</code>?</p>\n\n<p>Similarly, how to convert <code>\"2\"</code> into <code>Num t =&gt; t</code>?</p>\n\n<p>I guess there are multiple ways to do this. Which is your favorite?\n(As Haskellers, we like beautiful solutions.)</p>\n"}, {"tags": ["scala", "haskell", "functional-programming", "io-monad"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1498224912, "post_id": 44722277, "comment_id": 76427751, "body": "As a Haskeller, I&#39;d tend to agree. However, Scala has Java interoperability as a main selling point, and I&#39;m not surprised if some conventions are inherited (like not marking the <code>IO</code> effects at the type level). I think one could define a custom <code>IO</code> monad in Scala, if wanted -- perhaps it would not be that useful (since IO effects can be performed anywhere), except as a form of documentation. Perhaps such <code>IO</code> would be a glorified identity monad, in Scala, or a &quot;lazy&quot; monad instead?"}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1498233327, "post_id": 44722277, "comment_id": 76433391, "body": "Relevant: <a href=\"https://blog.jle.im/entry/io-monad-considered-harmful.html\" rel=\"nofollow noreferrer\">&quot;IO Monad&quot; considered harmful</a>"}], "answers": [{"comments": [{"owner": {"reputation": 836, "user_id": 7847167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a69ac2b61b2b6bf187ca664f18cce2b?s=128&d=identicon&r=PG&f=1", "display_name": "P. Frolov", "link": "https://stackoverflow.com/users/7847167/p-frolov"}, "edited": false, "score": 0, "creation_date": 1501753977, "post_id": 44722838, "comment_id": 77921924, "body": "Scalaz&#39; ones are <code>scalaz.effect.IO</code> in <code>scalaz-core</code> package and <code>scalaz.concurrent.Task</code> in <code>scalaz-concurrent</code> package for concurrent variant."}], "tags": [], "owner": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "is_accepted": false, "score": 8, "last_activity_date": 1498225033, "creation_date": 1498225033, "answer_id": 44722838, "question_id": 44722277, "link": "https://stackoverflow.com/questions/44722277/what-is-the-io-haskell-monad-equivalent-in-scala-standard-api/44722838#44722838", "title": "What is the IO Haskell Monad equivalent in Scala standard API?", "body": "<p>Scala's standard library has no IO monad.  Libraries like Monix, Scalaz, FS2, and now Cats provide IO monads (or Task with concurrency support).  If you want to haskell type programming you will need one of these libraries, especially Cats or Scalaz which also other useful tools and typeclasses (such as actual functor and monad type classes).</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 1, "last_activity_date": 1498254579, "creation_date": 1498254579, "answer_id": 44730392, "question_id": 44722277, "link": "https://stackoverflow.com/questions/44722277/what-is-the-io-haskell-monad-equivalent-in-scala-standard-api/44730392#44730392", "title": "What is the IO Haskell Monad equivalent in Scala standard API?", "body": "<p>Scala has implicit ambient side-effects, just like C\u266f, Java, C++, Objective-C, Swift, C, Pascal, Basic, Perl, PHP, Python, Ruby, ECMAScript, etc. There is no type for <code>IO</code>.</p>\n\n<p>There are third-party libraries that provide an <code>IO</code> type, but it doesn't give the same guarantees as Haskell's: Haskell has only a very few escape hatches (<code>unsafePerformIO</code>), in Scala, pretty much <em>everything</em> is an escape hatch.</p>\n\n<p>However, there are ideas and I believe even research prototypes for effects systems in Scala, and the streamlined, more powerful, and sound type system of Dotty is probably going to be an even better foundation for that.</p>\n"}], "owner": {"reputation": 567, "user_id": 1765828, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9rVAH.jpg?s=128&g=1", "display_name": "salc2", "link": "https://stackoverflow.com/users/1765828/salc2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 44730392, "answer_count": 2, "score": 6, "last_activity_date": 1498254579, "creation_date": 1498223329, "last_edit_date": 1498231064, "question_id": 44722277, "link": "https://stackoverflow.com/questions/44722277/what-is-the-io-haskell-monad-equivalent-in-scala-standard-api", "title": "What is the IO Haskell Monad equivalent in Scala standard API?", "body": "<p>I know there are some almost identical implementations in Scalaz of IO operators like <code>putStrLn :: String -&gt; IO (</code>) and <code>getLine :: IO String</code> but I mean about Scala standard API why there aren't such equivalents?\nI know Scala is not a pure language as Haskell and there is side effect but I consider that this datatype is so descriptive and useful.\nI don't know if <code>Try</code>, <code>Option</code> or <code>Either</code> would do the job. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1505, "user_id": 3500196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2DzO5.jpg?s=128&g=1", "display_name": "Shivang Agarwal", "link": "https://stackoverflow.com/users/3500196/shivang-agarwal"}, "edited": false, "score": 0, "creation_date": 1498216173, "post_id": 44719944, "comment_id": 76421977, "body": "please explain bit more."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1498245043, "post_id": 44720025, "comment_id": 76439549, "body": "It would be better still to pattern-match <code>originalList</code> when binding it, so that this <code>where</code> is not needed at all, and you don&#39;t have to call the dangerous function <code>tail</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1498245105, "post_id": 44720025, "comment_id": 76439578, "body": "@amalloy: yes, but here I considered <code>tail</code> to be a <i>blackbox</i> function (since it should be applicable to any kind of function)."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1498245170, "post_id": 44720025, "comment_id": 76439608, "body": "Indeed your advice is good for a general function <code>f</code>, but I think it is worth noting, either as a comment or as part of the answer, that it is bad advice for the specific function <code>tail</code>, since that is the one that was asked about."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1498245246, "last_edit_date": 1498245246, "creation_date": 1498216284, "answer_id": 44720025, "question_id": 44719944, "link": "https://stackoverflow.com/questions/44719944/how-do-i-avoid-making-a-function-call-twice/44720025#44720025", "title": "How do I avoid making a function call twice?", "body": "<p>In an <em>imperative programming</em> language, you call the function once, and store it into a variable.</p>\n\n<p>In a functional programming language like Haskell, you use a <code>where</code> or <code>let</code> clause and thus use a variable as well:</p>\n\n<pre><code>func1 originalList = func2 <b>(doSomething t) (doSomethingDifferent t)</b>\n    <b>where t = tail originalList</b></code></pre>\n\n<p>So here you will construct an expression, and the arguments of <code>doSomething</code> and <code>doSomethingDifferent</code> will <em>refer</em> to the same expression tree. Now since Haskell works <em>lazily</em> <code>tail originalList</code> will <em>not</em> be evaluated immediately. </p>\n\n<p>But if it is (partially) evaluated (for instance when evaluating the first operand of the <code>func2</code> call), then that work is <em>not</em> redone when evaluating the expression tree through another way (for instance the second argument). Now in case of a <code>tail</code> there is not much work anyway. But in case it was a more complex function, it would pay off more.</p>\n\n<p>Note that - like <a href=\"https://stackoverflow.com/questions/44719944/how-do-i-avoid-making-a-function-call-twice/44720025?noredirect=1#comment76439549_44720025\">@amalloy says</a> - in case of a <code>tail</code> function, you do not have to use a where clause: simple pattern matching will suffice:</p>\n\n<pre><code>func1 <b>(_:t)</b> = func2 (doSomething t) (doSomethingDifferent t)</code></pre>\n\n<p>Note that the two are not fully equivalent: since now there is a constraint that the line will only <em>fire</em> if you have a list with at least one element. It could be possible that <code>func2</code> simply ignores both arguments, such that obtaining the tail is not necessary (although that is unlikely here).</p>\n"}], "owner": {"reputation": 869, "user_id": 60551, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dd2dae5f96dfbe62de93a411ae0b94df?s=128&d=identicon&r=PG", "display_name": "Confused", "link": "https://stackoverflow.com/users/60551/confused"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 44720025, "answer_count": 1, "score": 1, "last_activity_date": 1498245246, "creation_date": 1498216024, "question_id": 44719944, "link": "https://stackoverflow.com/questions/44719944/how-do-i-avoid-making-a-function-call-twice", "title": "How do I avoid making a function call twice?", "body": "<p>Haskell newbie question: Is there a technique to be more efficient and avoid the call on tail originalList twice</p>\n\n<pre><code>func1 originalList =\n    func2 (doSomething (tail originalList)) (doSomethingDifferent (tail originalList))\n\ndoSomething listA =\n....\n\ndoSomethingDifferent listB =\n....\n\nfunc2 listA listB =\n....\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1498206242, "post_id": 44715886, "comment_id": 76415307, "body": "Add type signatures. For a surprise, just add a type signature to <code>hp</code>, and you will notice what type <code>aRobot</code> has in some contexts."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 3623495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4HQRv.jpg?s=128&g=1", "display_name": "Stefano Cerruti", "link": "https://stackoverflow.com/users/3623495/stefano-cerruti"}, "edited": false, "score": 1, "creation_date": 1498212271, "post_id": 44716585, "comment_id": 76419366, "body": "Thank you! Unfortunately there are many language features of which I&#39;m not aware of at the moment, that&#39;s why I wasn&#39;t be able to figure out the issue. VS code suggested me that kind of type signature, but I didn&#39;t understand why.  I&#39;ll use your answer for future reference :)"}, {"owner": {"reputation": 1649, "user_id": 3684713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qo7tw.jpg?s=128&g=1", "display_name": "overactor", "link": "https://stackoverflow.com/users/3684713/overactor"}, "reply_to_user": {"reputation": 93, "user_id": 3623495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4HQRv.jpg?s=128&g=1", "display_name": "Stefano Cerruti", "link": "https://stackoverflow.com/users/3623495/stefano-cerruti"}, "edited": false, "score": 1, "creation_date": 1498212557, "post_id": 44716585, "comment_id": 76419543, "body": "This might be what @StefanoCerruti asked for, but I doubt it&#39;s what he needs. There is no reason Robot needs to be a function."}, {"owner": {"reputation": 383, "user_id": 3024170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c69db72fd6a246ba01bc7fc71348835?s=128&d=identicon&r=PG&f=1", "display_name": "YoshikuniJujo", "link": "https://stackoverflow.com/users/3024170/yoshikunijujo"}, "edited": false, "score": 0, "creation_date": 1498212772, "post_id": 44716585, "comment_id": 76419699, "body": "Thank you. Maybe he needs ADT."}, {"owner": {"reputation": 383, "user_id": 3024170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c69db72fd6a246ba01bc7fc71348835?s=128&d=identicon&r=PG&f=1", "display_name": "YoshikuniJujo", "link": "https://stackoverflow.com/users/3024170/yoshikunijujo"}, "edited": false, "score": 0, "creation_date": 1498212830, "post_id": 44716585, "comment_id": 76419743, "body": "I will write yet another answer."}, {"owner": {"reputation": 93, "user_id": 3623495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4HQRv.jpg?s=128&g=1", "display_name": "Stefano Cerruti", "link": "https://stackoverflow.com/users/3623495/stefano-cerruti"}, "reply_to_user": {"reputation": 1649, "user_id": 3684713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qo7tw.jpg?s=128&g=1", "display_name": "overactor", "link": "https://stackoverflow.com/users/3684713/overactor"}, "edited": false, "score": 0, "creation_date": 1498213115, "post_id": 44716585, "comment_id": 76419936, "body": "@overactor I know that maybe is silly to use a lamba to handle state, but I&#39;m following a book and experimenting with the examples... I&#39;m not using/learning algebraic data type yet"}, {"owner": {"reputation": 383, "user_id": 3024170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c69db72fd6a246ba01bc7fc71348835?s=128&d=identicon&r=PG&f=1", "display_name": "YoshikuniJujo", "link": "https://stackoverflow.com/users/3024170/yoshikunijujo"}, "reply_to_user": {"reputation": 1649, "user_id": 3684713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qo7tw.jpg?s=128&g=1", "display_name": "overactor", "link": "https://stackoverflow.com/users/3684713/overactor"}, "edited": false, "score": 0, "creation_date": 1498213440, "post_id": 44716585, "comment_id": 76420169, "body": "@overactor Thank you."}, {"owner": {"reputation": 383, "user_id": 3024170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c69db72fd6a246ba01bc7fc71348835?s=128&d=identicon&r=PG&f=1", "display_name": "YoshikuniJujo", "link": "https://stackoverflow.com/users/3024170/yoshikunijujo"}, "reply_to_user": {"reputation": 93, "user_id": 3623495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4HQRv.jpg?s=128&g=1", "display_name": "Stefano Cerruti", "link": "https://stackoverflow.com/users/3623495/stefano-cerruti"}, "edited": false, "score": 0, "creation_date": 1498213834, "post_id": 44716585, "comment_id": 76420416, "body": "@StefanoCerruti Is the book&#39;s example code written by Lisp?"}, {"owner": {"reputation": 93, "user_id": 3623495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4HQRv.jpg?s=128&g=1", "display_name": "Stefano Cerruti", "link": "https://stackoverflow.com/users/3623495/stefano-cerruti"}, "edited": false, "score": 0, "creation_date": 1498221496, "post_id": 44716585, "comment_id": 76425424, "body": "@YoshikuniJujo it&#39;s an Haskell book. In that chapter the author claims that state can be represented and stored by functions using lamba. I don&#39;t know if it&#39;s a Lisp idiomatic form. To be fair the author used <code>damage aRobot amount = aRobot (\\ (n,a,h) -&gt; robot (n,a,h-amount))</code> to damage the robot and that function hadn&#39;t problems. I was just exploring other options"}, {"owner": {"reputation": 383, "user_id": 3024170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c69db72fd6a246ba01bc7fc71348835?s=128&d=identicon&r=PG&f=1", "display_name": "YoshikuniJujo", "link": "https://stackoverflow.com/users/3024170/yoshikunijujo"}, "edited": false, "score": 0, "creation_date": 1498224310, "post_id": 44716585, "comment_id": 76427339, "body": "The author may try to explain CPS (continuation passing style). <a href=\"https://en.wikibooks.org/wiki/Haskell/Continuation_passing_style\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/Continuation_passing_style</a>"}], "tags": [], "owner": {"reputation": 383, "user_id": 3024170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c69db72fd6a246ba01bc7fc71348835?s=128&d=identicon&r=PG&f=1", "display_name": "YoshikuniJujo", "link": "https://stackoverflow.com/users/3024170/yoshikunijujo"}, "is_accepted": true, "score": 1, "last_activity_date": 1498211705, "last_edit_date": 1498211705, "creation_date": 1498206305, "answer_id": 44716585, "question_id": 44715886, "link": "https://stackoverflow.com/questions/44715886/anybody-can-explain-this-error-couldnt-match-type-integer/44716585#44716585", "title": "Anybody can explain this error? Couldn&#39;t match type `Integer&#39;", "body": "<p>This code needs Rank2Types extension.</p>\n\n<p>The Robot Betty has type ((String, Integer, Integer) -> t) -> t.\nThis type should be polymorphic type.</p>\n\n<p>Function damage take Robot (Its type is (String, Integer, Integer) -> t) -> t) as argument.\nSuch function has rank 2 polymorhism.</p>\n\n<pre><code>{-# LANGUAGE Rank2Types #-}\n\ntype Robot = forall t . ((String, Integer, Integer) -&gt; t) -&gt; t\n\nrobot :: (String, Integer, Integer) -&gt; Robot\nrobot (_name,_attack,_hp) = \\ cmd -&gt; cmd (_name,_attack,_hp)\n\nhp :: (String, Integer, Integer) -&gt; Integer\nhp (_,_,h) = h\n\ngetHp :: Robot -&gt; Integer\ngetHp aRobot = aRobot hp\n\nsetHp :: Robot -&gt; Integer -&gt; Robot\nsetHp aRobot newHp = aRobot (\\ (n,a,_) -&gt; robot (n,a,newHp))\n\ndamage :: Robot -&gt; Integer -&gt; Robot\ndamage aRobot amount = let actualHp = getHp aRobot\n                        in\n                        setHp aRobot (actualHp - amount)\n\n\nmakeKiller :: Robot\nmakeKiller = robot (\"Killer\",10,200)\n\nmakeBetty :: Robot\nmakeBetty = robot (\"Betty\",5,300)\n</code></pre>\n\n<p>If no rank 2 types, the robot types which getHp and setHp requires are mismatched. Function getHp requires ((String, Integer, Integer) -> Integer) -> Integer as Robot type. And function setHp requires ((String, Integer, Integer) -> Robot) -> Robot.</p>\n\n<p>Simplified version here.</p>\n\n<pre><code>fun :: (a -&gt; a) -&gt; Char -&gt; Int -&gt; (Char, Int)\nfun f c n = (f c, f n)\n</code></pre>\n\n<p>This definition cause type error.</p>\n\n<pre><code>{-# LANGUAGE Rank2Types #-}\n\nfun :: (forall a . a -&gt; a) -&gt; Char -&gt; Int -&gt; (Char, Int)\nfun f c n = (f c, f n)\n</code></pre>\n\n<p>This definition is OK!</p>\n"}, {"tags": [], "owner": {"reputation": 1649, "user_id": 3684713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qo7tw.jpg?s=128&g=1", "display_name": "overactor", "link": "https://stackoverflow.com/users/3684713/overactor"}, "is_accepted": false, "score": 1, "last_activity_date": 1498213300, "creation_date": 1498213300, "answer_id": 44719031, "question_id": 44715886, "link": "https://stackoverflow.com/questions/44715886/anybody-can-explain-this-error-couldnt-match-type-integer/44719031#44719031", "title": "Anybody can explain this error? Couldn&#39;t match type `Integer&#39;", "body": "<p>You likely don't need robot to be a function, just declare it as a type that's a tuple:</p>\n\n<pre><code>type Robot = (String, Integer, Integer)\n\ngetHp :: Robot -&gt; Integer\ngetHp (_, _, hp) = hp\n\nsetHp :: Robot -&gt; Integer -&gt; Robot\nsetHp (name, attack, _) hp = (name, attack, hp)\n\ndamage :: Robot -&gt; Integer -&gt; Robot\ndamage r dmg = setHp r $ getHp r - dmg\n\nmakeKiller :: Robot\nmakeKiller = (\"Killer\", 10, 200)\n\nmakeBetty :: Robot\nmakeBetty = (\"Betty\", 5, 300)\n\nb = makeBetty\nb1 = damage b 34 \n</code></pre>\n\n<p>Alternatively, you could make Robot an <a href=\"https://wiki.haskell.org/Algebraic_data_type\" rel=\"nofollow noreferrer\">algebraic data type</a>, which would definitely be better than just using a tuple.</p>\n"}], "owner": {"reputation": 93, "user_id": 3623495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4HQRv.jpg?s=128&g=1", "display_name": "Stefano Cerruti", "link": "https://stackoverflow.com/users/3623495/stefano-cerruti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 1, "accepted_answer_id": 44716585, "answer_count": 2, "score": 3, "last_activity_date": 1498213300, "creation_date": 1498204095, "last_edit_date": 1498206167, "question_id": 44715886, "link": "https://stackoverflow.com/questions/44715886/anybody-can-explain-this-error-couldnt-match-type-integer", "title": "Anybody can explain this error? Couldn&#39;t match type `Integer&#39;", "body": "<p>I'm trying to learn haskell and there is a particular error that I'm not able to figure out.</p>\n\n<pre><code>robot (_name,_attack,_hp) = \\ cmd -&gt; cmd (_name,_attack,_hp)\n\nhp (_,_,h) = h\ngetHp aRobot = aRobot hp\n\nsetHp aRobot newHp = aRobot (\\ (n,a,_) -&gt; robot (n,a,newHp))\n\ndamage aRobot amount = let actualHp = getHp aRobot\n                        in\n                        setHp aRobot (actualHp - amount)\n\n\nmakeKiller = robot (\"Killer\",10,200)\nmakeBetty = robot (\"Betty\",5,300)\n\n----- Example of computation in ghci\n\nb = makeBetty\nb1 = damage b 34 \n\n&lt;interactive&gt;:52:14: error:\n    * Couldn't match type `Integer'\n                     with `(([Char], Integer, t1) -&gt; t0) -&gt; t0'\n      Expected type: (([Char], Integer,\n                       (([Char], Integer, t1) -&gt; t0) -&gt; t0)\n                      -&gt; (([Char], Integer, t1) -&gt; t0) -&gt; t0)\n                     -&gt; t1\n        Actual type: (([Char], Integer, Integer) -&gt; t1) -&gt; t1\n    * In the first argument of damage, namely `b'\n      In the expression: damage b 34\n      In an equation for `b1': b1 = damage b 34\n    * Relevant bindings include b1 :: t1 (bound at &lt;interactive&gt;:52:1)\n</code></pre>\n\n<p>There is something in the damage function that's wrong, can anyone explain the error to me please?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1498215575, "post_id": 44715167, "comment_id": 76421557, "body": "Did you check the <a href=\"https://github.com/clash-lang/clash-compiler/wiki/FAQ#how-do-i-run-and-install-clash-using-stack\" rel=\"nofollow noreferrer\">FAQ</a>?"}, {"owner": {"reputation": 121, "user_id": 8203663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679f61b0be59164a74f2616c21334a34?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8203663/james"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1498220576, "post_id": 44715167, "comment_id": 76424840, "body": "Yes, the clash-faq details how to use stack to install clash, and how to use it to run clash interactively/from the command line. What it does not do is answer my question, which is how to get stack to use clash instead of ghc or ghcjs when compiling a stack project."}], "owner": {"reputation": 121, "user_id": 8203663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679f61b0be59164a74f2616c21334a34?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8203663/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 3, "answer_count": 0, "score": 5, "last_activity_date": 1498223873, "creation_date": 1498201614, "last_edit_date": 1498223873, "question_id": 44715167, "link": "https://stackoverflow.com/questions/44715167/how-can-i-get-stack-to-compile-my-codebase-with-clash-ghc", "title": "How can I get stack to compile my codebase with clash-ghc?", "body": "<p>I have a Haskell codebase that currently uses Stack for compilation. Unfortunately as far as I can tell Stack only allows me to compile with GHC or GHCJS. I would like to use Stack to compile with <a href=\"https://www.stackage.org/package/clash-ghc\" rel=\"noreferrer\">clash-ghc</a> which uses GHC as a front end, to generate RTL Circuits (Verilog/VHDL).</p>\n\n<p>Is this possible, and if so how do I do it?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1498257960, "post_id": 44716184, "comment_id": 76444526, "body": "Thanks Shersh, that&#39;s what I was about to say. Current behaviour is a half-way house on the road to what Clinton is looking for. Meantime you could look at he lens package(s)."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 7, "last_activity_date": 1498205053, "creation_date": 1498205053, "answer_id": 44716184, "question_id": 44714711, "link": "https://stackoverflow.com/questions/44714711/silly-duplicated-record-fields-error/44716184#44716184", "title": "Silly duplicated record fields error", "body": "<p><code>-XDuplicateRecordFields</code> currently doesn't infer types from arguments.</p>\n\n<p>See <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#selector-functions\" rel=\"noreferrer\">GHC user guide section about this extension</a>.</p>\n\n<blockquote>\n  <p>However, we do not infer the type of the argument to determine the datatype, or have any way of deferring the choice to the constraint solver. Thus the following is ambiguous:</p>\n</blockquote>\n\n<p>But things are improving. So we might expect and finally get desired behavior: </p>\n\n<p><a href=\"https://prime.haskell.org/wiki/TypeDirectedNameResolution\" rel=\"noreferrer\">https://prime.haskell.org/wiki/TypeDirectedNameResolution</a></p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 1, "accepted_answer_id": 44716184, "answer_count": 1, "score": 10, "last_activity_date": 1498210581, "creation_date": 1498200167, "last_edit_date": 1498210581, "question_id": 44714711, "link": "https://stackoverflow.com/questions/44714711/silly-duplicated-record-fields-error", "title": "Silly duplicated record fields error", "body": "<p>Consider the following:</p>\n\n<pre><code>{-# LANGUAGE DuplicateRecordFields #-}\n\ndata A = A { name :: String }\n\ndata B = B { name :: String }\n\nmain = print $ name (A \"Alice\")\n</code></pre>\n\n<p>When compiled, I get the following message (on GHC 8.0.2)</p>\n\n<pre><code>duplicatedrecords.hs:7:16: error:\n    Ambiguous occurrence \u2018name\u2019\n    It could refer to either the field \u2018name\u2019,\n                             defined at duplicatedrecords.hs:5:14\n                          or the field \u2018name\u2019, defined at duplicatedrecords.hs:3:14\n</code></pre>\n\n<p>But if I modify the <code>main</code> line as follows:</p>\n\n<pre><code>main = print $ name ((A \"Alice\") :: A)\n</code></pre>\n\n<p>Compilation proceeds successfully.</p>\n\n<p>Why is this? The type signature <code>:: A</code> seems redundant to me, as surely the <code>A</code> constructor makes it clear to the compiler that <code>(A \"Alice\")</code> is of type <code>A</code>. But for some reason it makes a difference. Why is this and is there a way I can get this to compile without littering extra type signatures everywhere?</p>\n\n<p><strong>Note:</strong></p>\n\n<p>It's worth noting that the following compiles fine:</p>\n\n<pre><code>data A = A { a_name :: String }\ndata B = B { b_name :: String }\n\nclass Name t where\n  name :: t -&gt; String\n\ninstance Name A where name = a_name\ninstance Name B where name = b_name\n\nmain = print $ name (A \"Alice\")\n</code></pre>\n\n<p>We can even go further as follows, allowing different result types:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\ndata A = A { a_name :: String }\ndata B = B { b_name :: Int }\n\nclass Name t where\n  type family T t\n  name :: t -&gt; T t\n\ninstance Name A where\n  type T A = String\n  name = a_name\n\ninstance Name B where\n  type T B = Int\n  name = b_name\n\nmain = print $ name (A \"Alice\")\n</code></pre>\n\n<p>It seems like GHC just has to mechanically add a class for each unique record name and an instance for each record in each data type. This will mean however that <code>name x == name y</code> not implying that the types of <code>x</code> and <code>y</code> are the same but I'd expect that when using this extension anyway.</p>\n\n<p>Just wondering if there's anything tricky I'm missing here regarding the implementation or that it just needs someone to do it?</p>\n"}, {"tags": ["haskell", "recursion", "types", "html-parsing"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8130537"}, "edited": false, "score": 0, "creation_date": 1498213839, "post_id": 44710542, "comment_id": 76420425, "body": "For to add that the fmap (take 10000) for the ResponseBody is only for testing, so that the I can work with smaller chucks of html code. It will be removed afterwards."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8130537"}, "edited": false, "score": 0, "creation_date": 1498208296, "post_id": 44710710, "comment_id": 76416639, "body": "So the code in itself is gonna work with the IO string? Cause that seems to be a problem/error.. The linkScanner function I mean. Thanks for your help!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498216587, "post_id": 44710710, "comment_id": 76422243, "body": "@M.O It should."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1498173211, "creation_date": 1498173211, "answer_id": 44710710, "question_id": 44710542, "link": "https://stackoverflow.com/questions/44710542/implementing-a-recursive-function-that-recursively-executes-another-function/44710710#44710710", "title": "Implementing a recursive function that recursively executes another function", "body": "<p>You probably want something like</p>\n\n<pre><code>linkScanner result = linkRec [] result where\nlinkRec acc [] = return acc\nlinkRec acc (h:t) = do\n   x &lt;- htmlLinks h\n   linkRec (x : acc) t \n</code></pre>\n\n<p>(which will return the list in the opposite order) or</p>\n\n<pre><code>linkScanner = traverse htmlLinks -- or the analogous with mapM\n</code></pre>\n\n<p>By the way, you should really add type annotations to the top level bindings. It's very hard to think about what's going on otherwise.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8130537"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498180022, "creation_date": 1498172101, "last_edit_date": 1498180022, "question_id": 44710542, "link": "https://stackoverflow.com/questions/44710542/implementing-a-recursive-function-that-recursively-executes-another-function", "title": "Implementing a recursive function that recursively executes another function", "body": "<p>Im trying to put together a link analyzer that goes through a websites html code and returns all links that contain the same base url (refer to a webpage of the same site) and im currently have this code put together. (I am a beginner so please bear with the amateur code ^^):</p>\n\n<pre><code>import Network.HTTP\nimport Data.List\nimport Data.Char\n\nhtmlLinks link = do\n  content &lt;- simpleHTTP (getRequest link) &gt;&gt;= fmap (take 10000) . getResponseBody\n  let string = content\n  let tags = splitOn \"&lt;\" string\n  let links = filter (isInfixOf \"href\") tags\n  let filtered = filter (isInfixOf link) links\n  let url = map (splitOn \"\\\"\") filtered\n  let final = map (filter (isInfixOf \"http\")) url\n  let urlString = map (\\(h:_) -&gt; h)final\n  let result = nub urlString\n  --let result = map head $ group $ sort urlString\n  return result\n</code></pre>\n\n<p>This function goes through the code and returns me a list of all links with the same base url that I want. Now I want to go through each element of that list and apply the same function to them, so I can get the links on each of those sites aswell, ultimately providing me with all the webpages of a given website structure. So for the recursive function I tried this:</p>\n\n<pre><code>linkScanner result = linkRec [] result where\n  linkRec acc [] = acc\n  linkRec acc (h:t) = linkRec ((htmlLinks h) : acc) t \n</code></pre>\n\n<p>This basically takes the list of links applies the htmlLinks to each element and adds the result of that to my accumulator, which in this case is an empty list. Now my problem is that I can't find a way to combine these 2 functions so that they can be executed with a given URL and provide me with a list of all the links I need. I also have a Type Conflict as htmlLinks is of Type IO[String] and the recursive function needs a [String] which results in an error..</p>\n\n<p>I am looking for some advice on how to solve this problem or some tips that I could use to get to my desired result. Any and all help is greatly appreciated!   </p>\n"}, {"tags": ["windows", "haskell", "linker", "ghc", "static-linking"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1498161485, "post_id": 44707958, "comment_id": 76399572, "body": "<code>diagrams</code> isn&#39;t exactly a small dependency, because it incurs a lot of Edward Kmett&#39;s huge tool chain, as it uses the <a href=\"http://hackage.haskell.org/package/linear\" rel=\"nofollow noreferrer\"><code>linear</code> library</a> for its vector spaces and the full <a href=\"http://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\"><code>lens</code> framework</a>. Frankly, I think it would be good to trim those dependencies down a bit again... but then, for most people, a 25 MB executable is nothing to worry about at all."}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 1, "creation_date": 1498171211, "post_id": 44707958, "comment_id": 76403709, "body": "<a href=\"https://stackoverflow.com/a/18636018/15467\">Here&#39;s</a> a &quot;Hello, world&quot; program that, on Windows, gets down to 13K."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1498171560, "post_id": 44707958, "comment_id": 76403807, "body": "What size were you expecting for your program and why?"}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1498188621, "post_id": 44707958, "comment_id": 76407654, "body": "@ja can you elaborate? Using -O2 option makes the executable just a bit bigger (25671KB) and strip is a *nix tool that I can&#39;t find in Windows."}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1498191847, "post_id": 44707958, "comment_id": 76408449, "body": "@leftaroundabout  I was convinced it was a Windows issue but I removed the <code>diagrams</code> dependency, and now the executable is only 1414KB. Please post your comment as answer to accept it."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 1, "creation_date": 1498237095, "post_id": 44707958, "comment_id": 76435494, "body": "You can compress with <a href=\"https://upx.github.io/\" rel=\"nofollow noreferrer\">UPX</a>. It works very well on Windows &amp; Linux. I often use it and the size of the compressed executable is usually about 18% the one of the original file."}, {"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1498293815, "post_id": 44707958, "comment_id": 76450925, "body": "Wow, I&#39;ve just tried UPX, and I am amazed so far. Got an executable of mine from 26MB to 5.6MB. Thanks a lot for recommending it @St&#233;phaneLaurent, I didn&#39;t know about it before."}], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1498165145, "creation_date": 1498160097, "last_edit_date": 1498165145, "question_id": 44707958, "link": "https://stackoverflow.com/questions/44707958/huge-windows-executable-for-a-haskell-program", "title": "Huge Windows executable for a Haskell program", "body": "<p>I did write a small program using Haskell in Windows. The program depends only on base, diagrams-lib and diagrams-rasterific. The generated standalone executable is huge (25633 KB).</p>\n\n<p>I have read several similar questions (<a href=\"https://stackoverflow.com/questions/6115459/small-haskell-program-compiled-with-ghc-into-huge-binary/6115703#6115703\">Small Haskell program compiled with GHC into huge binary</a>), but all of them presume Linux is being used. I think that the problem is that everything used (or not) is statically linked into the executable. This includes (I guess) the libraries that in Linux are taken as granted and in Windows are not available. </p>\n\n<p>Any help for reducing the size of the executable will be welcome.</p>\n\n<p>OS: Windows 7 64 bits Pro,\nHaskell Stack: lts-8.16</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 4, "creation_date": 1498148746, "post_id": 44704809, "comment_id": 76392534, "body": "Which part are you having problems with?"}, {"owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1498148864, "post_id": 44704809, "comment_id": 76392609, "body": "Actually I cannot understand <code>filter (\\(_, (varible1, _))</code> and also the flow in the code"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1498148899, "post_id": 44704809, "comment_id": 76392633, "body": "I think you have to take a closer look at the brackets. <code>(\\(_, (varible1, _)) -&gt; variable1 `notElem` [something1, something2])</code> is a single lambda expression."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498702638, "post_id": 44704809, "comment_id": 76610976, "body": "I&#39;m voting to close this question as off-topic because StackOverflow is not a good place to learn the bare-bones basics of a new programming language. You should use one of the several high-quality tutorials and/or textbooks available both online and in print to get started; SO will always be here for more specific questions."}], "answers": [{"comments": [{"owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "edited": false, "score": 0, "creation_date": 1498149366, "post_id": 44704885, "comment_id": 76392931, "body": "So does it return List of &quot;nested&quot; tupples ?"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "edited": false, "score": 0, "creation_date": 1498149496, "post_id": 44704885, "comment_id": 76393009, "body": "Yes. It would accept a list of something like <code>[(1, (2, 3)), (9, (8, 7))]</code>, and return a list of the same type (potentially with some elements removed). Honestly, the nested tuples here kind of make things messy. I might have <code>map</code>ped the list first to remove the nesting unless you actually needed nested tuples to use later."}, {"owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "edited": false, "score": 0, "creation_date": 1498149615, "post_id": 44704885, "comment_id": 76393080, "body": "Thanks alot for your explanation :D"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "edited": false, "score": 0, "creation_date": 1498149643, "post_id": 44704885, "comment_id": 76393096, "body": "No problem. Always nice to have an excuse to look at Haskell code every once in awhile."}], "tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": true, "score": 7, "last_activity_date": 1498700634, "last_edit_date": 1498700634, "creation_date": 1498148926, "answer_id": 44704885, "question_id": 44704809, "link": "https://stackoverflow.com/questions/44704809/understanding-haskell-code/44704885#44704885", "title": "Understanding haskell code", "body": "<pre><code>-- Filter a list...\nfilter\n\n-- ...of nested tuples where the first element of the second element of the tuple...\n(\\(_, (variable1, _)) -&gt;\n\n-- ...is not an element of [something1, something2]\nvariable1 `notElem` [something1, something2]) \n</code></pre>\n\n<p><code>(_, (varible1, _))</code> deconstructs a nested tuple, and names one of the elements. Look up deconstruction to understand what's going on there.</p>\n"}, {"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 5, "last_activity_date": 1498150487, "creation_date": 1498150487, "answer_id": 44705322, "question_id": 44704809, "link": "https://stackoverflow.com/questions/44704809/understanding-haskell-code/44705322#44705322", "title": "Understanding haskell code", "body": "<p>Let's start at the beginning.</p>\n\n<pre><code>\\p -&gt; e\n</code></pre>\n\n<p>is a <em>lambda abstraction</em> (an anonymous function) where <code>p</code> is a pattern and <code>e</code> is an expression that may use variables that appear in <code>p</code>.</p>\n\n<pre><code>(_, (variable1, _))\n</code></pre>\n\n<p>is a pattern constructed from the constructor <code>(,)</code>, which constructs pairs. Here are some pairs:</p>\n\n<pre><code>(1, 2)\n(\"Hello\", \"world!\")\n(1, (2, 3))\n</code></pre>\n\n<p>Here are some patterns which match pairs, used in lambda abstractions.</p>\n\n<pre><code>\\(x, y) -&gt; x\n\\(x,(y,z)) -&gt; y\n</code></pre>\n\n<p>The second pattern matches a pair like <code>(1, (2, 3))</code> and gives the first element of the second element. In this case, it would give <code>2</code>. Its shape is like the pattern in your question, but what about the <code>_</code> in your pattern?</p>\n\n<p><code>_</code> is a valid variable name (variables can begin with underscores or lower-case letters). It is used to mean \"a variable we don't use\". The pattern <code>(_, (y, _))</code> is like the pattern <code>(x, (y, z))</code> except the only variable that has a name is <code>y</code>. Normally, you aren't allowed to reuse variable names in patterns. <code>(x,x)</code> is in invalid pattern, for instance. You are allowed to reuse <code>_</code> though because Haskell knows you intend to throw that value away.</p>\n\n<p>Now we can understand the expression</p>\n\n<pre><code>\\(_, (variable1, _)) -&gt; variable1\n</code></pre>\n\n<p>It is a function of type <code>(a, (b, c)) -&gt; b</code> which takes a pair whose second element is itself a pair and gives the first element of the second element.</p>\n\n<p>Now we need to understand</p>\n\n<pre><code>variable1 `notElem` [something1, something2]\n</code></pre>\n\n<p>To understand this expression, we need to know what the backticks do. Surrounding an identifier in backticks turns it into an <em>infix</em> operator. Infix operators are usually spelled with symbols, like <code>x + y</code> and <code>xs ++ ys</code>. The backticks let us convert normal identifiers, like <code>notElem</code>, into infix operators. This means that the above expression is the same as</p>\n\n<pre><code>notElem variable1 [something1, something2]\n</code></pre>\n\n<p><code>notElem</code> is a function which takes an item and a list of items of the same type and gives <code>True</code> if the item <em>does not</em> appear in the list and <code>False</code> otherwise. It is the opposite of the <code>elem</code> test for membership.</p>\n\n<p>Finally, <code>filter</code>. <code>filter p xs</code> is a function that takes a <em>predicate</em> <code>p</code> (i.e., a function which returns a <code>Bool</code>) and uses it to filter the list <code>xs</code>. <code>filter</code> gives a new list where elements (call them <code>x</code>) are included if <code>p x</code> is true. This filters the list of <code>xs</code> and gives a new list whose elements are those for which the predicate is true. For example,</p>\n\n<pre><code>&gt; filter even [1,2,3,4]\n[2,4]\n</code></pre>\n\n<p>So, we have</p>\n\n<pre><code>filter                  -- filter a list\n  (\\(_, (variable1, _)) -- by matching on the first element\n                        -- of the second element of a pair\n                        -- and calling it 'variable1'\n     -&gt; variable1 `notElem` [something1, something2])\n                        -- and giving `True` if the element\n                        -- is neither 'something1' nor 'something2'\n</code></pre>\n\n<p>This gives a function which takes a list of pairs whose second element is a pair and filters it to a list of pairs whose second element is a pair whose first element is neither <code>something1</code> nor <code>something2</code>.</p>\n\n<p>We can apply it, calling it <code>f</code> below:</p>\n\n<pre><code>f = filter (\\(_, (varible1, _)) -&gt; variable1 `notElem` [something1, something2])\n\n&gt; f [(1,(something1,2)), (1,(something3,3))]\n[(1,(something3,3))]\n</code></pre>\n"}], "owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 44704885, "answer_count": 2, "score": 0, "last_activity_date": 1498700634, "creation_date": 1498148685, "question_id": 44704809, "link": "https://stackoverflow.com/questions/44704809/understanding-haskell-code", "title": "Understanding haskell code", "body": "<p>I am new to haskell. Can someone explain how I can interpret this line of code in haskell :</p>\n\n<pre><code>filter (\\(_, (varible1, _)) -&gt; variable1 `notElem` [something1, something2])\n</code></pre>\n"}, {"tags": ["haskell", "typescript", "functional-programming", "immutability", "elm"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1498145884, "post_id": 44702694, "comment_id": 76390608, "body": "Your solution seems perfectly reasonable, and performance is likely not a concern for three element arrays. I would argue there is no local mutation here; you cannot refer to the original array which is mutated, so there is no way to observe mutation even if it does occur (a compiler could chose to optimize away the construction of the initial array precisely because there is no possible way to refer to it). Even in Haskell, the runtime can update a value in place if it is used in precisely one place. The takeaway is that &quot;mutation&quot; = &quot;observable mutation&quot;, i.e. &quot;local mutation is ok&quot;."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1498147788, "post_id": 44702694, "comment_id": 76391960, "body": "This is JavaScript. Just use <code>.push</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3488, "user_id": 152711, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c7564ed5b848eda69e4fea42ab2323b5?s=128&d=identicon&r=PG", "display_name": "Freewalker", "link": "https://stackoverflow.com/users/152711/freewalker"}, "edited": false, "score": 0, "creation_date": 1498769440, "post_id": 44702935, "comment_id": 76650096, "body": "Both interesting - I&#39;m going with filter slice essentially as in the OP.  The linked list implementation is such an interesting idea, thank you!  I hadn&#39;t realized the option of using a linked list in an immutable environment,"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1498143374, "creation_date": 1498143374, "answer_id": 44702935, "question_id": 44702694, "link": "https://stackoverflow.com/questions/44702694/how-to-construct-an-array-with-multiple-possible-lengths-using-immutability-and/44702935#44702935", "title": "How to construct an array with multiple possible lengths using immutability and functional programming practices?", "body": "<p>In Haskell, I'd just create an array with three elements and, depending on the condition, pass it on either as-is or pass on just a slice of two elements. Thanks to laziness, no computation effort will be spent on the third element unless it's actually needed. In TypeScript, you probably will get the cost of computing the third element even if it's not needed, but perhaps that doesn't matter.</p>\n\n<p>Alternatively, if you don't need the structure to be an actual array (for <code>String</code> elements, performance probably isn't that critical, and the <em>O</em> (<em>n</em>) direct-access cost isn't an issue if the length is limited to three elements), I'd use a <em>singly-linked list</em> instead. Create the list with two elements and, depending on the condition, append the third. This does <em>not</em> require any mutation: the 3-element list simply contains the unchanged 2-element list as a substructure.</p>\n"}, {"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1498151560, "post_id": 44704992, "comment_id": 76394117, "body": "<code>itemsToSet = catMaybes $ fmap sequenceA values</code> ;)"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498153634, "post_id": 44704992, "comment_id": 76395216, "body": "@BenjaminHodgson Amazing; 20 minutes later, I think that I <i>almost</i> understand that :|"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1498154033, "post_id": 44704992, "comment_id": 76395452, "body": "Haha! Sorry. Didn&#39;t intend to drop a brain-bomb on you! Briefly: <code>sequenceA :: (Applicative f, Traversable t) =&gt; t (f a) -&gt; f (t a)</code> is a general tool to transpose two constructors. Here <code>f ~ Maybe</code> and <code>t ~ (,) String</code>, so <b><code>sequenceA :: (String, Maybe String) -&gt; Maybe (String, String)</code></b>. If we had <code>t ~ []</code>, <code>sequenceA :: Applicative f =&gt; [f a] -&gt; f [a]</code> would sequence <i>many</i> effects to produce a list of results. Here there&#39;s only <i>one</i> effect: the &quot;container&quot; type is the tuple and it &quot;contains&quot; its second element. Then <code>catMaybes</code> just filters out the <code>Nothing</code>s. Hope that explains it! :)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498154456, "post_id": 44704992, "comment_id": 76395683, "body": "If that still doesn&#39;t make sense, feel free to ask another question and I&#39;ll try to explain in more depth in an answer."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498156368, "post_id": 44704992, "comment_id": 76396742, "body": "@BenjaminHodgson Thanks :) What really threw me is that <code>(,)</code> is <code>Foldable</code>. Hardly intuitive, if you ask me, but I found an explanation here: <a href=\"https://stackoverflow.com/a/36461185/126014\">stackoverflow.com/a/36461185/126014</a>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1498157086, "post_id": 44704992, "comment_id": 76397162, "body": "Yep, the <code>Foldable</code>/<code>Traversable</code> instances for <code>(,) x</code> in particular have proven to be quite controversial over the years. I can see both sides of the argument: they do frequently cause learners to trip up, but they&#39;re <i>so useful</i> once you&#39;re familiar with <code>Foldable</code> and <code>Traversable</code>."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498157252, "post_id": 44704992, "comment_id": 76397241, "body": "@BenjaminHodgson BTW, my primary motivation for starting to answer Haskell questions here on SO is an attempt to improve my Haskell skills. Those gems of yours certainly challenges me, so keep them coming :)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498157306, "post_id": 44704992, "comment_id": 76397272, "body": "Next time I&#39;ll be sure to explain myself :)"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1498157370, "post_id": 44704992, "comment_id": 76397307, "body": "@BenjaminHodgson No, please don&#39;t! I learn more by trying to puzzle those things together for myself :)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1498157436, "post_id": 44704992, "comment_id": 76397331, "body": "Haha, OK then! Always happy to help out if you get stuck though (and my email address is in my profile) :D"}, {"owner": {"reputation": 3488, "user_id": 152711, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c7564ed5b848eda69e4fea42ab2323b5?s=128&d=identicon&r=PG", "display_name": "Freewalker", "link": "https://stackoverflow.com/users/152711/freewalker"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498769324, "post_id": 44704992, "comment_id": 76650040, "body": "Really helpful, thank you Mark.  I&#39;m using an accumulator-style implementation, and it&#39;s a good reminder that we can look to recursive implementations in other cases (still overcoming lifetime of OO- and mutable-style thinking).   Gave it a try, but not ready for the @BenjaminHodgson kung fu yet!"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 5, "last_activity_date": 1498149250, "creation_date": 1498149250, "answer_id": 44704992, "question_id": 44702694, "link": "https://stackoverflow.com/questions/44702694/how-to-construct-an-array-with-multiple-possible-lengths-using-immutability-and/44704992#44704992", "title": "How to construct an array with multiple possible lengths using immutability and functional programming practices?", "body": "<p>What's wrong with <code>itemsToSet</code> as given in the OP? It looks functional to me, but it may be because of my lack of knowledge of TypeScript.</p>\n\n<p>In Haskell, there's no <em>null</em>, but if we use <code>Maybe</code> for the second element, I think that <code>itemsToSet</code> could be translated to this:</p>\n\n<pre><code>itemsToSet :: [(String, String)]\nitemsToSet = foldr folder [] values\n  where\n    values = [\n      (jwt_key, jwt),\n      (jwt_expires_key, tokenExpireDate),\n      (refresh_token_key, refreshToken)]\n    folder (key, Just value) acc = (key, value) : acc\n    folder _ acc = acc\n</code></pre>\n\n<p>Here, <code>jwt</code>, <code>tokenExpireDate</code>, and <code>refreshToken</code> are all of the type <code>Maybe String</code>.</p>\n\n<p><code>itemsToSet</code> performs a <em>right fold</em> over <code>values</code>, pattern-matching the <code>Maye String</code> elements against <code>Just</code> and (implicitly) <code>Nothing</code>. If it's a <code>Just</code> value, it cons the <code>(key, value)</code> pair to the accumulator <code>acc</code>. If not, <code>folder</code> just returns <code>acc</code>.</p>\n\n<p><code>foldr</code> traverses the <code>values</code> list from right to left, building up the accumulator as it visits each element. The initial accumulator value is the empty list <code>[]</code>.</p>\n\n<p>You don't need 'local mutation' in functional programming. In general, you can refactor from 'local mutation' to proper functional style by <a href=\"http://blog.ploeh.dk/2015/12/01/recurse\" rel=\"noreferrer\">using recursion and introducing an accumulator value</a>.</p>\n\n<p>While <code>foldr</code> is a built-in function, you could implement it yourself using recursion.</p>\n"}, {"comments": [{"owner": {"reputation": 3488, "user_id": 152711, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c7564ed5b848eda69e4fea42ab2323b5?s=128&d=identicon&r=PG", "display_name": "Freewalker", "link": "https://stackoverflow.com/users/152711/freewalker"}, "edited": false, "score": 0, "creation_date": 1498768462, "post_id": 44709670, "comment_id": 76649569, "body": "Thanks for the response.  In this case I&#39;m not 100% sure it will be 2 or 3 indefinitely into the future so I&#39;m looking to implement a more generalized, FP-style solution."}], "tags": [], "owner": {"reputation": 13635, "user_id": 547365, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ddefbca930fdd39846b698bab7ac3146?s=128&d=identicon&r=PG", "display_name": "w.brian", "link": "https://stackoverflow.com/users/547365/w-brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1498166927, "creation_date": 1498166927, "answer_id": 44709670, "question_id": 44702694, "link": "https://stackoverflow.com/questions/44702694/how-to-construct-an-array-with-multiple-possible-lengths-using-immutability-and/44709670#44709670", "title": "How to construct an array with multiple possible lengths using immutability and functional programming practices?", "body": "<p>Based on the description, I don't think arrays are the best solution simply because you know ahead of time that they contain <em>either</em> 2 values or 3 values depending on some condition. As such, I would model the problem as follows:</p>\n\n<pre><code>type alias Pair = (String, String)\n\ntype TokenState \n  = WithoutRefresh (Pair, Pair)\n  | WithRefresh (Pair, Pair, Pair)\n\nitemsToTokenState: String -&gt; Date -&gt; Maybe String -&gt; TokenState\nitemsToTokenState jwtKey jwtExpiry maybeRefreshToken =\n  case maybeRefreshToken of\n    Some refreshToken -&gt;\n      WithRefresh ((\"JWT_KEY\", jwtKey), (\"JWT_EXPIRES_KEY\", toString jwtExpiry), (\"REFRESH_TOKEN_KEY\", refreshToken))\n\n    None -&gt;\n      WithoutRefresh ((\"JWT_KEY\", jwtKey), (\"JWT_EXPIRES_KEY\", toString jwtExpiry))\n</code></pre>\n\n<p>This way you are leveraging the type system more effectively, and could be improved on further by doing something more ergonomic than returning tuples.</p>\n"}], "owner": {"reputation": 3488, "user_id": 152711, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c7564ed5b848eda69e4fea42ab2323b5?s=128&d=identicon&r=PG", "display_name": "Freewalker", "link": "https://stackoverflow.com/users/152711/freewalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 44704992, "answer_count": 3, "score": 0, "last_activity_date": 1498166927, "creation_date": 1498142689, "question_id": 44702694, "link": "https://stackoverflow.com/questions/44702694/how-to-construct-an-array-with-multiple-possible-lengths-using-immutability-and", "title": "How to construct an array with multiple possible lengths using immutability and functional programming practices?", "body": "<p>We're in the process of converting our imperative brains to a mostly-functional paradigm.  This function is giving me trouble. I want to construct an array that EITHER contains two pairs or three pairs, depending on a condition (whether <code>refreshToken</code> is <code>null</code>).  How can I do this cleanly using a FP paradigm?  Of course with imperative code and mutation, I would just conditionally <code>.push()</code> the extra value onto the end which looks quite clean.</p>\n\n<p>Is this an example of the \"local mutation is ok\" FP caveat?</p>\n\n<p>(We're using <code>ReadonlyArray</code> in TypeScript to enforce immutability, which makes this somewhat more ugly.)  </p>\n\n<pre><code>const itemsToSet = [\n    [JWT_KEY, jwt],\n    [JWT_EXPIRES_KEY, tokenExpireDate.toString()],\n    [REFRESH_TOKEN_KEY, refreshToken /*could be null*/]]\n    .filter(item =&gt; item[1] != null) as ReadonlyArray&lt;ReadonlyArray&lt;string&gt;&gt;;\n\nAsyncStorage.multiSet(itemsToSet.map(roArray =&gt; [...roArray]));\n</code></pre>\n"}, {"tags": ["json", "haskell", "haskell-lens", "aeson"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498141239, "post_id": 44701870, "comment_id": 76386973, "body": "Does <code>\\field -&gt; transform (rewrite&#39; field)</code> do what you want? (Just a guess - I&#39;m no lens expert either)"}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 2, "last_activity_date": 1498196757, "last_edit_date": 1498196757, "creation_date": 1498147364, "answer_id": 44704407, "question_id": 44701870, "link": "https://stackoverflow.com/questions/44701870/how-can-i-rewrite-an-arbitrarily-nested-field-in-a-json-structure-using-haskell/44704407#44704407", "title": "How can I rewrite an arbitrarily nested field in a JSON structure using haskell lenses?", "body": "<p>One approach is to use <a href=\"https://hackage.haskell.org/package/lens-4.15.2/docs/Control-Lens-Plated.html#v:transformOn\" rel=\"nofollow noreferrer\"><code>transformOn</code></a> along with <a href=\"https://hackage.haskell.org/package/lens-4.15.2/docs/Control-Lens-Plated.html#v:deep\" rel=\"nofollow noreferrer\"><code>deep</code></a> to get precise control over the where the transformation is applied.</p>\n\n<pre><code>ghci&gt; let nested = object [ \"foo\" .= 42, \"baz\" .= object [ \"bar\" .= 42 ] ]\nghci&gt; transformOn (deep $ key \"bar\") (const \"XXXXXXXX\") nested\nObject (fromList [(\"foo\",Number 42.0),(\"baz\",Object (fromList [(\"bar\",String \"XXXXXXXX\")]))])\n</code></pre>\n\n<p><code>deep</code> searches a <code>Plated</code> structure for locations where the provided <code>Traversal</code> matches, and <code>transformOn</code> applies a change to each of its targets.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I just realized <code>transformOn</code> is massive overkill for this.  You can get away with just <code>deep</code> and simpler lens combinators:</p>\n\n<pre><code>ghci&gt; deep (key \"bar\") %~ const \"XXXXXXXX\" $ nested\nObject (fromList [(\"foo\",Number 42.0),(\"baz\",Object (fromList [(\"bar\",String \"XXXXXXXX\")]))])\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>ghci&gt; deep (key \"bar\") .~ \"XXXXXXXX\" $ nested\nObject (fromList [(\"foo\",Number 42.0),(\"baz\",Object (fromList [(\"bar\",String \"XXXXXXXX\")]))])\n</code></pre>\n\n<p>The <code>transform*</code> family of functions applies its modifications recursively, which is overkill for the modification you want to make.</p>\n"}], "owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 44704407, "answer_count": 1, "score": 2, "last_activity_date": 1498196757, "creation_date": 1498140570, "question_id": 44701870, "link": "https://stackoverflow.com/questions/44701870/how-can-i-rewrite-an-arbitrarily-nested-field-in-a-json-structure-using-haskell", "title": "How can I rewrite an arbitrarily nested field in a JSON structure using haskell lenses?", "body": "<p>I would like to make the following test pass:</p>\n\n<pre><code>it \"can rewrite a field from an object\" $ do\n  let _42 = 42 :: Int\n      nested =  object [ \"foo\" .= _42, \"baz\" .= object [ \"bar\" .= _42 ] ]\n                                           ]\n  rewrite \"bar\" nested  `shouldBe` object [ \"foo\" .= _42\n                                          , \"baz\" .= object [ \"bar\" .= (\"XXXXXXXX\" :: Text) ]\n                                          ]\n</code></pre>\n\n<p>It seems that what I want is something from <code>Control.Lens.Plated</code> like <a href=\"https://hackage.haskell.org/package/lens-4.15.2/docs/Control-Lens-Plated.html#v:rewrite\" rel=\"nofollow noreferrer\">rewrite</a> like or <a href=\"https://hackage.haskell.org/package/lens-4.15.2/docs/Control-Lens-Plated.html#v:transform\" rel=\"nofollow noreferrer\">transform</a> but I cannot manage to make it work, probably due to missing deep understanding of lenses. </p>\n\n<p>I managed to change a single layer using the following code but would like to leverage that to nested fields.</p>\n\n<pre><code> rewrite' field value = value &amp; key field %~ const \"XXXXXXXX\"\n</code></pre>\n"}, {"tags": ["haskell", "freebsd", "haskell-stack", "happy"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498132805, "post_id": 44698588, "comment_id": 76380279, "body": "1 is almost certainly your best bet. The problem is the linker finds two copies of <code>unix</code> and links against both (obviously this cannot work) - the one in <code>&#47;usr&#47;local&#47;lib&#47;ghc-7.10.2</code> should not be included. What stack command are you running? Do you by chance have a global installation of ghc (which is what the existence of the path <code>&#47;usr&#47;local&#47;lib&#47;ghc-7.10.2&#47;</code> tells me)? That could interfere with the version used by stack."}, {"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498133794, "post_id": 44698588, "comment_id": 76381049, "body": "I usually run <code>&#47;root&#47;.cabal&#47;bin&#47;stack build --system-ghc --compiler ghc-7.10.2</code>. I don&#39;t remember what exactly, but a few years ago when I first started using stack+FreeBSD for builds, IIRC stack didn&#39;t support non-system GHCs. So maybe I can try that again with <code>stack setUp --compiler ghc-7.10.2</code>"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1498134064, "post_id": 44698588, "comment_id": 76381261, "body": "Just a note: Your Stack version seems a little too old."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498134231, "post_id": 44698588, "comment_id": 76381398, "body": "@Wizek I think you could still potentially use your system ghc, but you need to clobber all the packages in the system ghc package database, otherwise you will get these issues. I suggest deleting the system ghc altogether. A few years is a long time for a tool like stack, which has only really existed for a &#39;few&#39; years (5?) - I suggest updating."}, {"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1498204587, "post_id": 44698588, "comment_id": 76414297, "body": "@Wizek, here is <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2017-June/127358.html\" rel=\"nofollow noreferrer\">haskell-cafe thread</a> regarding happy 1.19.5. It seems to be a general issue."}, {"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498251997, "post_id": 44698588, "comment_id": 76442702, "body": "Thanks to the pointers in @user2407038 and @Sibi &#39;s comments I managed to upgrade to stack 1.4.0 and <code>stack setup</code> a separate GHC. <code>happy</code> installed like a charm afterwards, and all is well now. Does either of you want to make your comment into an answer which I can mark accepted?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498262974, "post_id": 44698588, "comment_id": 76445630, "body": "As far as my comment goes, feel free to include any part of it in your own answer of your question."}], "answers": [{"tags": [], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "is_accepted": true, "score": 0, "last_activity_date": 1498389202, "creation_date": 1498389202, "answer_id": 44745780, "question_id": 44698588, "link": "https://stackoverflow.com/questions/44698588/haskell-freebsd-stack-happy-what-can-one-do-if-a-build-tool-in-my-case-hap/44745780#44745780", "title": "Haskell, FreeBSD, Stack, happy: What can one do if a build-tool (in my case `happy-1.19.5`) is failing installation?", "body": "<p>Thanks to the pointers in @user2407038 and @Sibi 's comments I managed to upgrade to stack 1.4.0 from 1.0.1 and <code>stack setup</code> an isolated GHC.</p>\n\n<p><code>happy</code> installed like a charm afterwards, and all is well now.</p>\n"}], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 44745780, "answer_count": 1, "score": 2, "last_activity_date": 1498389202, "creation_date": 1498132192, "question_id": 44698588, "link": "https://stackoverflow.com/questions/44698588/haskell-freebsd-stack-happy-what-can-one-do-if-a-build-tool-in-my-case-hap", "title": "Haskell, FreeBSD, Stack, happy: What can one do if a build-tool (in my case `happy-1.19.5`) is failing installation?", "body": "<p>These are the linker errors I get:</p>\n\n<pre><code>happy-1.19.5: configure\ncpphs-1.20.2: download\nth-reify-many-0.1.6: download\ntime-qq-0.0.1.0: download\nth-reify-many-0.1.6: configure\nth-reify-many-0.1.6: build\ntime-qq-0.0.1.0: configure\ntime-qq-0.0.1.0: build\ncpphs-1.20.2: configure\nth-reify-many-0.1.6: copy/register\ntime-qq-0.0.1.0: copy/register\ncpphs-1.20.2: build\ncpphs-1.20.2: copy/register\nProgress: 4/9\n--  While building package happy-1.19.5 using:\n      /usr/local/bin/ghc --make -odir /tmp/stack1466/happy-1.19.5/.stack-work/dist/x86_64-freebsd/Cabal-1.22.4.0/setup -hidir /tmp/stack1466/happy-1.19.5/.stack-work/dist/x86_64-freebsd/Cabal-1.22.4.0/setup\n -i -i. -package=Cabal-1.22.4.0 -clear-package-db -global-package-db -package-db=/root/.stack/snapshots/x86_64-freebsd/lts-7.14/7.10.2/pkgdb /tmp/stack1466/happy-1.19.5/Setup.lhs -o /tmp/stack1466/happy-1.1\n9.5/.stack-work/dist/x86_64-freebsd/Cabal-1.22.4.0/setup/setup\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /root/project-name/.stack-work/logs/happy-1.19.5.log\n\n    [1 of 1] Compiling Main             ( /tmp/stack1466/happy-1.19.5/Setup.lhs, /tmp/stack1466/happy-1.19.5/.stack-work/dist/x86_64-freebsd/Cabal-1.22.4.0/setup/Main.o )\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:20:1: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:21:1: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:22:1: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:68:1: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:74:1: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:81:19: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:82:23: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:83:26: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:84:26: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:85:30: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:86:33: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:87:32: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:88:36: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:89:39: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:94:14: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:99:13: Warning: Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:100:17: Warning:\n        Tab character\n\n    /tmp/stack1466/happy-1.19.5/Setup.lhs:101:23: Warning:\n        Tab character\n\n    Linking /tmp/stack1466/happy-1.19.5/.stack-work/dist/x86_64-freebsd/Cabal-1.22.4.0/setup/setup ...\n    /usr/local/lib/ghc-7.10.2/unix_A3WgcI5QiHK4PDo4jSYdwQ/libHSunix-2.7.1.0-A3WgcI5QiHK4PDo4jSYdwQ.a(HsUnix.o): In function `__hsunix_rtldNext':\n    HsUnix.c:(.text+0x80): multiple definition of `__hsunix_rtldNext'\n    /root/.stack/snapshots/x86_64-freebsd/lts-7.14/7.10.2/lib/x86_64-freebsd-ghc-7.10.2/unix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS/libHSunix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS.a(HsUnix.o):(.text+0x0): first defined here\n    /usr/local/lib/ghc-7.10.2/unix_A3WgcI5QiHK4PDo4jSYdwQ/libHSunix-2.7.1.0-A3WgcI5QiHK4PDo4jSYdwQ.a(HsUnix.o): In function `__hsunix_rtldDefault':\n    HsUnix.c:(.text+0x90): multiple definition of `__hsunix_rtldDefault'\n    /root/.stack/snapshots/x86_64-freebsd/lts-7.14/7.10.2/lib/x86_64-freebsd-ghc-7.10.2/unix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS/libHSunix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS.a(HsUnix.o):(.text+0x10): first defined here\n    /usr/local/lib/ghc-7.10.2/unix_A3WgcI5QiHK4PDo4jSYdwQ/libHSunix-2.7.1.0-A3WgcI5QiHK4PDo4jSYdwQ.a(HsUnix.o): In function `__hsunix_ptsname':\n    HsUnix.c:(.text+0x130): multiple definition of `__hsunix_ptsname'\n    /root/.stack/snapshots/x86_64-freebsd/lts-7.14/7.10.2/lib/x86_64-freebsd-ghc-7.10.2/unix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS/libHSunix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS.a(HsUnix.o):(.text+0x20): first defined here\n    /usr/local/lib/ghc-7.10.2/unix_A3WgcI5QiHK4PDo4jSYdwQ/libHSunix-2.7.1.0-A3WgcI5QiHK4PDo4jSYdwQ.a(HsUnix.o): In function `__hsunix_grantpt':\n    HsUnix.c:(.text+0x140): multiple definition of `__hsunix_grantpt'\n    /root/.stack/snapshots/x86_64-freebsd/lts-7.14/7.10.2/lib/x86_64-freebsd-ghc-7.10.2/unix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS/libHSunix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS.a(HsUnix.o):(.text+0x30): first defined here\n    /usr/local/lib/ghc-7.10.2/unix_A3WgcI5QiHK4PDo4jSYdwQ/libHSunix-2.7.1.0-A3WgcI5QiHK4PDo4jSYdwQ.a(HsUnix.o): In function `__hsunix_unlockpt':\n    HsUnix.c:(.text+0x150): multiple definition of `__hsunix_unlockpt'\n    /root/.stack/snapshots/x86_64-freebsd/lts-7.14/7.10.2/lib/x86_64-freebsd-ghc-7.10.2/unix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS/libHSunix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS.a(HsUnix.o):(.text+0x40): first defined here\n    /usr/local/lib/ghc-7.10.2/unix_A3WgcI5QiHK4PDo4jSYdwQ/libHSunix-2.7.1.0-A3WgcI5QiHK4PDo4jSYdwQ.a(HsUnix.o): In function `__hsunix_push_module':\n    HsUnix.c:(.text+0x160): multiple definition of `__hsunix_push_module'\n    /root/.stack/snapshots/x86_64-freebsd/lts-7.14/7.10.2/lib/x86_64-freebsd-ghc-7.10.2/unix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS/libHSunix-2.7.2.0-3psvMyG1UoBJLXj9bF7fFS.a(HsUnix.o):(.text+0x50): first defined here\n    collect2: error: ld returned 1 exit status\n</code></pre>\n\n<h3>Misc</h3>\n\n<ul>\n<li>ghc-7.10.2</li>\n<li>FreeBSD 10.3-RELEASE-p18 in a VM</li>\n<li>happy-1.19.5</li>\n<li>Stack Version 1.0.1, Git revision e1c8e2c (3065 commits) x86_64</li>\n</ul>\n\n<h2>Options I'm considering:</h2>\n\n<ol>\n<li><p>Figure out what the linker error is about. Maybe it is easy to fix. Perhaps ask on StackOverflow about it. ;) Any ideas what it is about?</p></li>\n<li><p>Try to find which dependency of my project is using Happy and see if I can do without it. I tried to go about this via <code>stack list-dependencies --depth=100</code> and <code>stack dot --external</code> <a href=\"https://github.com/commercialhaskell/stack/issues/3195#issuecomment-310351499\" rel=\"nofollow noreferrer\">but neither of those helped me unfortunately</a>.<br>\nHow could I find out which of my direct dependencies depend on it (likely indirectly)?</p></li>\n<li><p>Try to persuade <code>stack</code> to use the system-wide available <code>happy</code> binary that I was able to get via <code>pkg install hs-happy</code>. How could I go about this?</p></li>\n<li><p>Cross compile for FreeBSD from linux. Do I suspect correctly that this would likely not be an issue if I had a cross-compiler? And either way, would it be difficult to set up a linux->FreeBSD cross compiler? How could I go about doing that?</p></li>\n<li><p>Try to move away from needing FreeBSD. Unfortunately my hosting provider only supports FreeBSD at the moment, and I really like them for other reasons (value for price and their related philosophy). Perhaps, if all else fails, can you tell me what Linux hosting provider is your favorite for your Haskell projects?</p></li>\n</ol>\n\n<p>I suspect option #1 or #3 might be the most painless.<br>\nOr would any of you have other ideas as well?</p>\n"}, {"tags": ["haskell", "alternative-functor"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1498128401, "post_id": 44696944, "comment_id": 76377291, "body": "You also need <code>pure</code>. Sure, you could have a <code>Pure</code> class providing <code>pure</code>, and a <code>Empty</code> class providing <code>empty</code>, and have <code>Alternative</code> require both. For pragmatic reasons, though, one does not always split a class into single-method classes."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1498131437, "post_id": 44696944, "comment_id": 76379304, "body": "Pragmatic or historic reasons in this case?"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1498131750, "post_id": 44696944, "comment_id": 76379524, "body": "I think it&#39;s because there aren&#39;t types, which can implement <code>empty</code> and can&#39;t implement <code>(&lt;|&gt;)</code>. So, theoretical a type class <code>Stoppable</code> will be equal to <code>Alternative</code> (set of types will be equal)."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1498139017, "post_id": 44696944, "comment_id": 76385143, "body": "@freestyle: funny enough, PureScript defines <code>Alternative</code> via <code>Plus</code> (provides <code>empty</code>), which is based on <code>Alt</code> (provides <code>(&lt;|&gt;)</code>). So they follow the Semigroup/Monoid approach."}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1498139296, "post_id": 44701154, "comment_id": 76385373, "body": "I wouldn&#39;t say it&#39;s an oversight, per se. There&#39;s a legit design tradeoff between granularity and cohesiveness. I personally somewhat prefer the Haskell class hierarchy to the PureScript one. <code>empty</code> and <code>&lt;|&gt;</code> &quot;go together&quot; in a natural way."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1498139518, "post_id": 44701154, "comment_id": 76385566, "body": "@BenjaminHodgson I removed the judgement, it wasn&#39;t really appropriate."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1498218235, "post_id": 44701154, "comment_id": 76423265, "body": "It&#39;s also worth thinking about <code>MonadFail</code>, whose <code>fail</code> is kind of like <code>empty</code>, but which extends emptiness with <code>&gt;&gt;=</code> rather than recovery."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 8, "last_activity_date": 1498139444, "last_edit_date": 1498139444, "creation_date": 1498138908, "answer_id": 44701154, "question_id": 44696944, "link": "https://stackoverflow.com/questions/44696944/why-is-guard-based-on-alternative/44701154#44701154", "title": "Why is guard based on Alternative?", "body": "<p><strong>TL;DR:</strong> Historical reasons. It was envisioned like this in <code>MonadPlus</code>, which got its <code>Applicative</code> variant <code>Alternative</code> later, and no one has proposed to split <code>Alternative</code> into <code>AZero</code> and <code>AChoice</code> or similar.</p>\n\n<hr>\n\n<p><code>Alternative</code> is a <em>relatively</em> new idea, just like <code>Applicative</code>. Back when <code>guard</code> was first envisioned, it was based on <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad.html#t:MonadPlus\" rel=\"noreferrer\"><code>MonadPlus</code></a>, a <code>Monad</code> that should support choice and failure, just like <code>Alternative</code>. Its original type was thus</p>\n\n<pre><code>guard :: MonadPlus m =&gt; Bool -&gt; m ()\n</code></pre>\n\n<p>That was specified in the Haskell 98 report, where <a href=\"https://www.haskell.org/onlinereport/monad.html\" rel=\"noreferrer\"><code>MonadPlus</code></a> was already noted. Haskell 1.0 didn't use monads at all, by the way. When <code>Applicative</code> finally got a superclass of <code>Monad</code>, <code>Alternative</code> got a superclass of <code>MonadPlus</code>, and <code>mzero = empty</code> and <code>mplus = (&lt;|&gt;)</code>.</p>\n\n<p>Well, now we know why <code>guard</code> uses <code>Alternative</code>. Because it was based on <code>MonadPlus</code> beforehand. So why is <code>MonadPlus</code> defined like this?</p>\n\n<p>One would have to write a mail to SPJ or someone else from the committee to get their rationale from 1998, because just one year later, <a href=\"http://www.cs.nott.ac.uk/~pszgmh/pearl.pdf\" rel=\"noreferrer\">Erik Meijer and Graham Hutton wrote their \"Monadic Parsing in Haskell\"</a> paper. If you have a look at the paper, you'll notice that <em>their</em> <code>MonadPlus</code> just works like you intend:</p>\n\n<blockquote>\n<pre><code>class Monad m =&gt; MonadZero m where\n  zero :: m a\n\nclass MonadZero m =&gt; MonadPlus m where\n  (++) :: m a -&gt; m a -&gt; m a\n</code></pre>\n</blockquote>\n\n<p>So it's certainly possible to handle this \"stoppable\" the way you've described it. However, there is simply no <code>base</code> class that currently defines <code>empty</code> without <code>Alternative</code>. There could be one, but it wasn't proposed yet.</p>\n\n<p>Note that this is a recurring theme with Haskell classes. <code>Monoid</code> contains <code>mappend</code> and <code>mempty</code>. After its conception, someone noticed that there are certain types where <code>mappend</code> makes sense, but not <code>mempty</code>. For example</p>\n\n<pre><code>newtype Min a = Min a\n\ncombine :: Ord a =&gt; Min a -&gt; Min a -&gt; Min a\ncombine (Min x) (Min y) = Min (min x y)\n</code></pre>\n\n<p>Here, <code>mappend = combine</code> is clearly associative, whereas an empty <code>Min</code> isn't possible if we just use <code>Ord</code>, we would have to use <code>Bounded</code>. That's why there is now <code>Semigroup</code>, which isn't a base class of <code>Monoid</code> yet, but gives us that associative operation.</p>\n\n<p>To come back to your original question: <code>guard</code> uses <code>Alternative</code>, because <code>Alternative</code> provides <code>empty</code>, and <code>empty</code> \"stops\" the evaluation in certain <code>Alternative</code>'s. There's no other class that contains that, <strong><em>yet</em></strong>. </p>\n\n<p>But with a proposal, there might be at some point, although I'm not sure what's the community's opinion on splitting <code>Alternative</code> is.</p>\n\n<p>By the way, languages like PureScript split <code>Alternative</code>, although they split it the other way round\u2026</p>\n\n<p>For more information about <code>Alternative</code> and why I used <code>Monoid</code> as another example, see <a href=\"https://stackoverflow.com/q/13080606/1139697\">Confused by the meaning of the &#39;Alternative&#39; type class and its relationship to other type classes</a>.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "accepted_answer_id": 44701154, "answer_count": 1, "score": 6, "last_activity_date": 1614318707, "creation_date": 1498127735, "last_edit_date": 1614318707, "question_id": 44696944, "link": "https://stackoverflow.com/questions/44696944/why-is-guard-based-on-alternative", "title": "Why is guard based on Alternative?", "body": "<p>Why is <code>guard</code> based on <code>Alternative</code>?</p>\n\n<pre><code>guard :: Alternative f =&gt; Bool -&gt; f ()\n-- guard b is pure () if b is True,\n-- and empty if b is False.\n</code></pre>\n\n<p>I ask because <code>guard</code> only uses the <code>empty</code> from <code>Alternative</code>. It doesn't use <code>&lt;|&gt;</code> from <code>Alternative</code> at all. So why bother using <code>Alternative</code> in the first place?</p>\n\n<p>I guess this is because there is some unstated idea behind <code>Alternative</code>'s <code>empty</code> that matches perfectly with what we're trying to accomplish with <code>guard</code> (stop on <code>False</code>, continue on <code>True</code>). If this is the case, please enlighten me about this unstated idea.</p>\n\n<p>Yet at the same time, if feels that we're just ignoring <code>&lt;|&gt;</code>. It feels almost as if <code>guard</code> is not \"fully capturing\" what <code>Alternative</code> is all about. I hope that makes sense. To make it more concrete: Why didn't they invent another type class called something like <code>Stoppable</code> (or <code>Abortable</code>) and used that instead of <code>Alternative</code>?</p>\n"}, {"tags": ["haskell", "linker", "read-eval-print-loop", "ffi", "ghci"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498128279, "post_id": 44696563, "comment_id": 76377208, "body": "Try this <a href=\"https://github.com/commercialhaskell/stack/issues/448\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/448</a>"}, {"owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498129467, "post_id": 44696563, "comment_id": 76377952, "body": "ah, that looked so promising, I did earlier have some modules missing from <code>other-modules</code>, but even after adding and doing <code>stack clean &amp;&amp; stack build &amp;&amp; stack ghci</code> it still panics just as before :("}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498129790, "post_id": 44696563, "comment_id": 76378198, "body": "What does <code>nm libtdsodbc.so | grep SQLDriverConnectW</code> show?"}, {"owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498130007, "post_id": 44696563, "comment_id": 76378343, "body": "<code>$ nm libtdsodbc.so\u240d nm: libtdsodbc.so: no symbols</code> but <code>$ strings libtdsodbc.so|grep SQLDriverConnectW\u240d SQLDriverConnectW</code> (and it compiles and runs fine with ghc, just not in ghci)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498130056, "post_id": 44696563, "comment_id": 76378379, "body": "<code>strings</code> is not interesting, use <code>nm -D</code>."}, {"owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498130091, "post_id": 44696563, "comment_id": 76378402, "body": "<code>$ nm -D libtdsodbc.so|grep SQLDriverConnectW\u240d 0000000000012f20 T SQLDriverConnectW</code>"}, {"owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1498130841, "post_id": 44696563, "comment_id": 76378901, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/147358/discussion-between-unhammer-and-n-m\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1498204238, "last_edit_date": 1498204238, "creation_date": 1498203808, "answer_id": 44715808, "question_id": 44696563, "link": "https://stackoverflow.com/questions/44696563/ghci-gives-ghc-panic-when-using-foreign-c-calls/44715808#44715808", "title": "ghci gives ghc panic when using foreign c calls", "body": "<p>The nice folks in <code>#haskell</code> on freenode said maybe I should try passing <code>-fobject-code</code> to ghci. That didn't work. I tried <code>:set</code> and <code>:seti</code> to see if it was already set, but ghci didn't show anything about object code. (Doing <code>:unset -fobject-code</code> just gave <code>Some flags have not been recognized: -fno-object-code</code>.)</p>\n\n<p>Then today I happened to look at my <code>~/.ghci</code> for some other reason, and that <em>did</em> have <code>:set -fobject-code</code>, even though <code>:set</code>/<code>:seti</code> doesn't show that. Removing <code>:set -fobject-code</code> from my <code>~/.ghci</code> took away the panic attacks, and I can now use functions from modules that import the module that defines foreign functions :) </p>\n\n<p>Actually calling any of the foreign functions from ghci leads to a segfault (<a href=\"http://sprunge.us/TEFe\" rel=\"nofollow noreferrer\">catchsegv log</a> for the interested), but at least I can test the pure stuff now \u2026</p>\n"}], "owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498204238, "creation_date": 1498126655, "last_edit_date": 1498133465, "question_id": 44696563, "link": "https://stackoverflow.com/questions/44696563/ghci-gives-ghc-panic-when-using-foreign-c-calls", "title": "ghci gives ghc panic when using foreign c calls", "body": "<p>I'm trying to use ghci / <code>stack repl</code> on a project where one module has foreign calls linked to a C lib <code>tdsodbc</code>, but I keep getting</p>\n\n<pre><code>ghc: panic! (the 'impossible' happened)\n  (GHC version 7.10.3 for x86_64-unknown-linux):\n    Loading temp shared object failed: /tmp/ghc4628_0/libghc_71.so: undefined symbol: SQLPrepareW\n</code></pre>\n\n<p>(where <code>SQLPrepareW</code> is defined in that C lib). Building with stack works fine. This happens even on other modules that just happen to import the foreign-calling module, even without actually calling the foreign functions. It doesn't happen on load, but as soon as I try to fully evaluate any function in the repl. </p>\n\n<p>How can I tell ghci that some of the functions are defined in libs outside of ghc?</p>\n\n<p>I've tried the <code>-l</code> option (e.g. <code>stack exec ghci -- -ltdsodbc</code>), but the only difference then is that a different function from the same lib is in the error message:</p>\n\n<pre><code>ghc: panic! (the 'impossible' happened)\n  (GHC version 7.10.3 for x86_64-unknown-linux):\n        Loading temp shared object failed: /tmp/ghc24107_0/libghc_25.so: undefined symbol: SQLDriverConnectW\n</code></pre>\n\n<p>Note that it's obviously checking for the lib when using <code>-l</code>, since if I misspell it, it'll say it can't find it:</p>\n\n<pre><code>$ stack exec ghci -- -L/usr/lib/x86_64-linux-gnu/odbc  -ltdsodbctypo\nWarning (added by new or init): Specified resolver could not satisfy all dependencies. Some external packages have been added as dependencies.\nYou can suppress this message by removing it from stack.yaml\n\nGHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\n&lt;command line&gt;: user specified .o/.so/.DLL could not be loaded (libtdsodbctypo.so: cannot open shared object file: No such file or directory)\nWhilst trying to load:  (dynamic) tdsodbctypo\nAdditional directories searched:   /usr/lib/x86_64-linux-gnu/odbc\n</code></pre>\n\n<p>This is with  </p>\n\n<pre><code>$ stack --version\nVersion 1.4.0, Git revision e714f1dd3fade19496d91bd6a017e435a96a6bcd (4640 commits) x86_64 hpack-0.17.0\n</code></pre>\n\n<p>I've also tried <code>stack ghci --ghci-options '-ltdsodbc -fobject-code'</code>, but it also panics with <code>undefined symbol: SQLPrepareW</code>.</p>\n"}, {"tags": ["haskell", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1498132477, "post_id": 44696862, "comment_id": 76380031, "body": "You may want to use a <code>Set URL</code> instead of <code>[URL]</code>. Both for efficiency and because this is what you mean when you keep around that list."}, {"owner": {"reputation": 17, "user_id": 8199066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad7e7a474da0a137b795c0f1b4a23f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah K.", "link": "https://stackoverflow.com/users/8199066/sarah-k"}, "edited": false, "score": 1, "creation_date": 1498133314, "post_id": 44696862, "comment_id": 76380671, "body": "I have this code snippet in my filterfunc <code>Set.toList . Set.fromList</code> to get rid of all the duplicates i get. Should i just keep it as a set to make it easier to work with it?"}, {"owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1498134490, "post_id": 44696862, "comment_id": 76381611, "body": "Keeping it as a <code>Set</code> is probably the easiest option, as @gallais has pointed out. Another thing to watch out for is that links with different names may point to the same page, so it is probably wise to also get a canonical representation for them."}, {"owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "edited": false, "score": 0, "creation_date": 1498134794, "post_id": 44696862, "comment_id": 76381860, "body": "If for some reason you need to keep unique representations in <code>List</code> format, one option is to use <code>List.nub</code>: <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html#v:nub\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.9.1.0/docs/&hellip;</a>"}], "tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": false, "score": 1, "last_activity_date": 1498127507, "creation_date": 1498127507, "answer_id": 44696862, "question_id": 44696373, "link": "https://stackoverflow.com/questions/44696373/recursive-list-function-in-haskell/44696862#44696862", "title": "Recursive list function in Haskell", "body": "<p>Link finding is essentially a graph traversal problem, which can be tricky in Haskell because of functional purity: it's hard to explicitly mark nodes (links) as visited or not through the use of an external history table.</p>\n\n<p>Your typical traversal algorithm might look something like this:</p>\n\n<pre><code>function traverse(current_node) {\n    if (current_node.is_visited) {\n        return some_data;\n    } else {\n        current_node.is_visisted = true;          // Hard in Haskell!\n        accumulated_data = ...;\n        for (child in current_node.children()) {\n            accumulated_data += traverse(child);  // Recursion happens here.\n        }\n        return accumulated_data;\n    }\n}\n</code></pre>\n\n<p>Because there is not an easy, direct way to mark a node as visited or not, we can try other solutions. For instance, we might consider something of the sort:</p>\n\n<pre><code>traverse :: ([URL], Data) -&gt; URL -&gt; ([URL], Data)\ntraverse (history, datum) current = let ... in ([new_history], accumulated_data)\n</code></pre>\n\n<p>The idea here is as follows: we keep an explicit list of <code>URL</code>s that we have visited. This allows us to quickly return from the current node (<code>URL</code>) if it appears in our history list (perhaps a <code>Set</code> for optimization? :)). In this case, each subsequent call to a child node using <code>traverse</code> would get the <code>new_history</code> list, effectively keeping track of a list of visited and unvisisted <code>URL</code>s.</p>\n\n<p>One possible way to implement this is using a fold function such as <code>foldl</code>:</p>\n\n<pre><code>foldl :: Foldable t =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n</code></pre>\n\n<p>Here type <code>t a</code> might be <code>[URL]</code>, that denotes the children of the current link, and our <code>traverse</code> function conveniently has the type signature <code>(b -&gt; a -&gt; b)</code>, where <code>type b = ([URL], Data)</code> and <code>type a = URL</code>.</p>\n\n<p>Can you take it from here and figure out how to combine <code>traverse</code> and <code>foldl</code>?</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 8199066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad7e7a474da0a137b795c0f1b4a23f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah K.", "link": "https://stackoverflow.com/users/8199066/sarah-k"}, "edited": false, "score": 0, "creation_date": 1498130194, "post_id": 44697553, "comment_id": 76378484, "body": "I only printed them to make sure everything is working and to see what the outcome is so i know how to work with it. The last step would be to save all the links i get into a file."}, {"owner": {"reputation": 17, "user_id": 8199066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad7e7a474da0a137b795c0f1b4a23f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah K.", "link": "https://stackoverflow.com/users/8199066/sarah-k"}, "edited": false, "score": 0, "creation_date": 1498130394, "post_id": 44697553, "comment_id": 76378618, "body": "And i forget to say that i&#39;m using a Set in my filterfunc (Set.toList . Set.fromList) to get rid of all the duplictaes"}, {"owner": {"reputation": 89, "user_id": 4865672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6239801a1a129824ee01a4edb49284?s=128&d=identicon&r=PG&f=1", "display_name": "gchelfi", "link": "https://stackoverflow.com/users/4865672/gchelfi"}, "reply_to_user": {"reputation": 17, "user_id": 8199066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad7e7a474da0a137b795c0f1b4a23f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah K.", "link": "https://stackoverflow.com/users/8199066/sarah-k"}, "edited": false, "score": 0, "creation_date": 1498135528, "post_id": 44697553, "comment_id": 76382404, "body": "@SarahK. sure, what I meant is that the solution I propose works for everything that fits in an <code>IO ()</code> (including writing for a file), but you may have to adapt it for other usages. Regarding my Set comment, keep in mind that a later page can refer to a former one (for instance a page linking to the home page of the site) and you need to take this into account."}], "tags": [], "owner": {"reputation": 89, "user_id": 4865672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af6239801a1a129824ee01a4edb49284?s=128&d=identicon&r=PG&f=1", "display_name": "gchelfi", "link": "https://stackoverflow.com/users/4865672/gchelfi"}, "is_accepted": false, "score": 0, "last_activity_date": 1498129509, "creation_date": 1498129509, "answer_id": 44697553, "question_id": 44696373, "link": "https://stackoverflow.com/questions/44696373/recursive-list-function-in-haskell/44697553#44697553", "title": "Recursive list function in Haskell", "body": "<p>Simply move your link visiting logic in a separate function which takes a link as a parameter, and then recurse on the links, as you intuited.</p>\n\n<p>Depending on what you want to ultimately do with the links, you can for instance simply fold the links with your function. </p>\n\n<p>For example, slightly modifying your code:</p>\n\n<pre><code>parseHtml = fmap LB.unpack . simpleHttp\nfilterFunc x y = -- damn long line with a lot of filters\n\nvisitLink :: String -&gt; IO ()\nvisitLink site = do\n    url &lt;- parseHtml site\n    let links = filterFunc site url\n    mapM_ print $ take 5 $ links -- or whatever you want to do on your links\n    mapM_ visitLink links -- the recursive call\n\n\nmain :: IO()\nmain = visitLinks \"https://stackoverflow.com/\"\n</code></pre>\n\n<p>If, rather than printing the links as you go, you would rather for instance return them, tweak the return type of the <code>visitLink</code> function (for instance <code>String -&gt; IO [String]</code> and change your last line in <code>visitLink</code> suitably (for instance <code>fmap join $ mapM visitLinks links</code>).</p>\n\n<p>As mentionned in another answer, keep in mind that with such a simple code, you may visit the same link infinitely many times. Consider storing the links you visit in a suitable data structure (such as a set) that you would pass to <code>visitLink</code>.</p>\n"}], "owner": {"reputation": 17, "user_id": 8199066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad7e7a474da0a137b795c0f1b4a23f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah K.", "link": "https://stackoverflow.com/users/8199066/sarah-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1580036400, "creation_date": 1498126197, "last_edit_date": 1580036400, "question_id": 44696373, "link": "https://stackoverflow.com/questions/44696373/recursive-list-function-in-haskell", "title": "Recursive list function in Haskell", "body": "<p>I am currently working on this program in Haskell where I analyze a website and try to find all links (href) that belong to this website. I was already able to extract all the links of the main site but i am struggling with the recursion since i want to follow the links I already found and do the same process again. </p>\n\n<p>This is what i have already:</p>\n\n<pre><code>parseHtml = fmap LB.unpack . simpleHttp\nfilterFunc x y = -- damn long line with a lot of filters\n\nmain :: IO()\nmain = do\n    let site = \"https://stackoverflow.com/\"\n    url &lt;- parseHtml site\n    let links = filterFunc site url\n    mapM_ print $ take 5 $ links\n</code></pre>\n\n<p>And this is my output so far:</p>\n\n<pre><code>\"https://stackoverflow.com/company/about\"\n\"https://stackoverflow.com/company/work-here\"\n\"https://stackoverflow.com/help\"\n\"https://stackoverflow.com/jobs/directory/developer-jobs\"\n\"https://stackoverflow.com/questions/44691577/stream-versus-iterators-in-set\"\n</code></pre>\n\n<p>I just need a hint on how to further proceed and how to visit the already found links again. Should I work with fold?</p>\n"}, {"tags": ["haskell", "authentication", "yesod"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1498125988, "post_id": 44696068, "comment_id": 76375604, "body": "If you are using the Yesod scaffolding, you should use the existing mechanism defined there to achieve this."}, {"owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1498129038, "post_id": 44696068, "comment_id": 76377684, "body": "I&#39;ve looked on Hoogle and could not find such functions, Can you direct me to it? @Sibi"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1498130220, "post_id": 44696068, "comment_id": 76378499, "body": "What I meant to say was that if you using the Yesod template for your web application ? You can create a scaffolding site if you follow the instructions here: <a href=\"https://www.yesodweb.com/page/quickstart\" rel=\"nofollow noreferrer\">yesodweb.com/page/quickstart</a> . It is documented here: <a href=\"http://www.yesodweb.com/book/scaffolding-and-the-site-template\" rel=\"nofollow noreferrer\">yesodweb.com/book/scaffolding-and-the-site-template</a>"}], "owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498125355, "creation_date": 1498125355, "question_id": 44696068, "link": "https://stackoverflow.com/questions/44696068/load-credentials-to-an-instance-from-a-file", "title": "Load credentials to an instance from a file", "body": "<p>I want to use yesod-auth in a website I'm developing, but I don't want to just write my Google credentials in the file as it is public in GitHub. So I wrote some functions to parse the json file you get from google. the problem is that it get stuck in the IO monad and thus I cannot pass it the google oauth function. Does anyone has a solution for this?</p>\n\n<pre><code>import Data.Aeson\nimport qualified Data.ByteString.Lazy as B\n\nclientId = (client_id . web . decode) &lt;$&gt; B.readFile \"D:\\\\cred.json\"\nclientSecret = (client_secret . web . decode) &lt;$&gt; B.readFile \"D:\\\\cred.json\"\n....\ninstance YesodAuth App\n    authPlugins = [ authGoogleEmail clientId clientSecret ]\n    ....\n</code></pre>\n"}, {"tags": ["haskell", "xmonad"], "comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1498105997, "post_id": 44689767, "comment_id": 76363876, "body": "Please provide a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>. I know in this case it might be hard, but I think it would be ok, if the example included xmonad."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1498106049, "post_id": 44689767, "comment_id": 76363891, "body": "Otherwise I suspect, that there is an version of Taffybar installed via cabal or stack, which comes prior to your custom one in the search paths. But that is just a suspicion."}], "owner": {"reputation": 27, "user_id": 3212255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X1B3L.jpg?s=128&g=1", "display_name": "shwsun", "link": "https://stackoverflow.com/users/3212255/shwsun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498104238, "creation_date": 1498103174, "last_edit_date": 1498104238, "question_id": 44689767, "link": "https://stackoverflow.com/questions/44689767/haskell-compile-the-interface-to-load-is-a-member-of-the-hidden-package-which", "title": "Haskell compile: the interface to load is a member of the hidden package (which is itself)", "body": "<p>I hit this when compiling taffybar module. It is very strange that actually claim that I need load this hidden module, which is itself. Error msgs are below:</p>\n\n<pre><code>[~/Public/taffybar]-[myMaster\u2193]\u2500\u2500 - rm -rf ~/.cache/taffybar &amp;&amp; taffybar                                   \nConfiguration '/home/jethros/.config/taffybar/taffybar.hs' changed. \nRecompiling.\nError occurred while loading configuration file.\nError: \n/home/jethros/.config/taffybar/taffybar.hs:26:1: error:\n    Failed to load interface for \u2018System.Taffybar.ToggleMonitor\u2019\n    It is a member of the hidden package \u2018taffybar-0.4.6\u2019.\n    Use -v to see a list of the files searched for.\n</code></pre>\n"}]